./  ADD  SSI=81730759,NAME=IGC0006A
*30740007*************************************************************  29300000
006A     TITLE 'IGC0006A - TEST SVC'                                    29350000
         COPY  IKJEGSIO                                                 29400000
         EJECT                                                          29450000
IGC0006A CSECT                                                          29500000
*C229080,229092,264547,264603                                  @YM02260 29550000
*A229068,264546                                                @YM02260 29600000
*A264544-264545,264672-264684                                  @YM02404 29650000
*A159720-159740,159804                                         @YM03486 29700000
*C265071-265156                                                @YM04131 29750000
*A104008,252040,265151                                         @YM05036 29800000
*A098876,278314                                                @YM04978 29850000
*A152452,152480-152571,278338                                  @YM07115 29900000
*C158821                                                       @YM06810 29950000
*D127000                                                       @YM07131 30000000
*A216500                                                       @ZA01570 30050000
* A 153220,158510,278334                     @ZA07138,@ZA09259,@ZA10462 30100000
* A 015060,265673-265678,265682                                @ZA11389 30150000
* C 265679                                                     @ZA11389 30200000
*********************************************************************** 30250000
*                                                                     * 30300000
* STATUS   --                                                         * 30350000
*    VERSION NO. 01, OS/VS2 RELEASE NO. 2 08/01/73                    * 30400000
*                                                                     * 30450000
* FUNCTION/OPERATION --                                               * 30500000
*    THE TEST SVC (SVC 61-IGC0006A) SAVES INFORMATION ABOUT           * 30550000
*    LOAD MODULES FOR USE BY THE TSO TEST SYMBOL PROCESSOR,           * 30600000
*    MODULE IKJEGSYM AND INFORMS THE AT COMMAND OF THE NAME           * 30650000
*    OF THE MODULE BEING FETCHED SO DEFERRED BREAKPOINTS              * 30700000
*    CAN BE ESTABLISHED.                                              * 30750000
*    SVC 061 IS ISSUED BY FETCH WHEN BRINGING A LOAD MODULE           * 30800000
*    INTO CORE THAT HAS THE TEST ATTRIBUTE IN THE DIRECTORY ENTRY     * 30850000
*    FOR THE MEMBER OR WHEN A LOAD MODULE IS BROUGHT INTO CORE BY     * 30900000
*    TSO TEST.  THIS SVC OPERATES IF THE MODULE IS RUNNING UNDER      * 30950000
*    A TSO TASK                                                       * 31000000
*    IGC0006A BUILDS A INFO BLK REFLECTING THE LOAD MODULE            * 31050000
*    NAME, LOADED ADDRESS, ATTRIBUTES AND, IF AVAILABLE, A DDNAME     * 31100000
*    WHICH IKJEGSYM CAN OPEN A DCB TO READ THE ASSEMBLER'S SYMBOL     * 31150000
*    TABLES AND LINKAGE EDITORS CESD RECORDS.                         * 31200000
*    IF TEST IS RUNNING, THESE INFO BLOCKS ARE CHAINED FROM           * 31250000
*    A WORD IN TCOMTAB.  IF NOT, THEY ARE CHAINED FROM THE TCB        * 31300000
*    TRN FIELD.                                                       * 31350000
*    ALSO, IF TEST IS RUNNING, THE ECB POINTED TO FROM THE            * 31400000
*    ECBTST FIELD IN TCOMTAB IS POSTED WITH A X'44'.                  * 31450000
*    SVC 61 IS ALSO ISSUED BY THE OVERLAY SUPERVISOR IF               * 31500000
*    TEST IS RUNNING AND A NEW SEGMENT OF AN OVERLAY STRUCTURE        * 31550000
*    IS BROUGHT INTO CORE.  IN THIS CASE, SVC 61 WILL PASS THE        * 31600000
*    NAME OF THE LOAD MODULE TO THE AT COMMAND VIA POST-WAIT.         * 31650000
*                                                                     * 31700000
*    NOTE                                                             * 31750000
*    TESTRAN IS NO LONGER SUPPORTED, IE SVC 61 IS ONLY A TSO TEST SVC.* 31800000
*                                                                     * 31850000
*                                                                     * 31900000
* ENTRY POINTS --                                                     * 31950000
*         IGC0006A   ONLY ENTRY TO SVC 61                             * 32000000
*                                                                     * 32050000
* INPUT --                                                            * 32100000
*    REGISTERS POINT TO SYSTEM INFORMATION                            * 32150000
*    -FROM CONTENTS SUPERVISOR                                        * 32200000
*    1 - NEGATIVE ADDRESS OF DCB USED TO FETCH THE MEMBER             * 32250000
*    3 - ADDRESS OF CVT                                               * 32300000
*    4 - ADDRESS OF TCB                                               * 32350000
*    5 - ADDRESS OF MY SVRB                                           * 32400000
*    WKNAME(IHAFETWK) -  ADDR OF BLDL ENTRY FOR MEMBER                * 32450000
*    WKCDADDR(IHAFETWK) -  ADDR OF EXTENT LIST FOR MEMBER             * 32500000
*    -FROM OVERLAY SUPERVISOR                                         * 32550000
*    1 - ZERO                                                         * 32600000
*    80(5) - ADDRESS OF SEGTAB                                        * 32650000
*                                                                     * 32700000
* OUTPUT --                                                           * 32750000
*    SVCINFO BLOCK   FOR TEST SYMBOL PROCESSOR, IKJEGSYM              * 32800000
*    IF TEST IS RUNNING, PASS LOADNAME TO AT COMMAND VIA GENERAL      * 32850000
*    WORK AREA                                                        * 32900000
*                                                                     * 32950000
* EXTERNAL REFERENCES --                                              * 33000000
*         XCTL         TO SECOND LOAD, IF TESTRAN REQUESTED           * 33050000
*         GETMAIN      OBTAIN CORE FOR A SYMINFO BLOCK OR AN ECB      * 33100000
*         POST         MAINLINE SO AT CMD CAN PROCESS                 * 33150000
*         WAIT         FOR AT CMD TO FINISH PROCESSING                * 33200000
*                      OR IF MULTI-TASKING, FOR MAINLINE TO FINISH    * 33250000
*        SYNCH         TO PASS CONTROL TO IKJEGIO OR IKJEGSTA         * 33300000
*                                                                     * 33350000
* EXITS, NORMAL --                                                    * 33400000
*         ISSUE A BRANCH REGISTER ON REGISTER 14                      * 33450000
*                                                                     * 33500000
* EXITS, ERROR --                                                     * 33550000
*        N/A                                                          * 33600000
*                                                                     * 33650000
* TABLES/WORKAREAS --                                                 * 33700000
*    TCOMTAB   IF TEST IS RUNNING                                     * 33750000
*    TCB       TTRN FIELD, TIOT ADDRESS                               * 33800000
*    MY SVRB   WORK AREAS, POINTERS                                   * 33850000
*    BLDL      ENTRY FOR FETCH MEMBER                                 * 33900000
*    XL        FOR FETCHED MEMBER                                     * 33950000
*    DCB       USED TO FETCH MEMBER                                   * 34000000
*    TIOT      IF AVAILABLE, GET DDNAME ALLOCATING PDS                * 34050000
*                                                                     * 34100000
* ATTRIBUTES --                                                       * 34150000
*    REENTRANT AND REFRESHABLE                                        * 34200000
*                                                                     * 34250000
* CHARACTER CODE DEPENDENCY --                                        * 34300000
*    RE-ASSEMBLY IS REQUIRED FOR CHANGE OF CODE                       * 34350000
*                                                                     * 34400000
* NOTES --                                                            * 34450000
*    THE SVC INFO BLOCKS ARE FREED BY MAINLINE AT THE END             * 34500000
*    OF A TEST SESSION.                                               * 34550000
*                                                                       34600000
* CHANGE-ACTIVITY -                                                     34650000
*                 APAR OZ07138 - CHANGES TO PRIVIDE MNL WITH A POINTER  34700000
*                 TO THE POSTING SVRB. ECBPP+1 IN TCOMTAB IS THE        34750000
*                 POINTER. IT IS SERIALIZED AT THE TASK LEVEL VIA ENQ.  34800000
*                 ANY PRIOR POINTER IS SAVED IN THE SVRB WORKAREA AT    34850000
*                 WRKSVRBS AND RESTORED BEFORE DEQ AND RETURN.          34900000
*                 APAR OZ09259 - SAME AS ABOVE.                         34950000
*                 APAR OZ10462 - SAME AS ABOVE.                         35000000
*                 APAR OZ11389 - CHANGE ESTAE/RETRY LINKAGES TO         35050000
*                 CONFORM TO REGISTER CONVENTIONS                       35100000
*                                                                       35150000
*                                                                     * 35200000
         EJECT                                                          35250000
*********************************************************************** 35300000
*                                                                     * 35350000
*        EQUATES                                                      * 35400000
*                                                                     * 35450000
*********************************************************************** 35500000
*                                                                       35550000
*        REGISTER EQUATES                                               35600000
*                                                                       35650000
PARMREG0 EQU   0              REGISTER 0                                35700000
R0       EQU   0              REGISTER 0                                35750000
PARMREG1 EQU   1              REGISTER 1                                35800000
R1       EQU   1              REGISTER 1                                35850000
R2       EQU   2              REGISTER 2                                35900000
DCBPTR   EQU   2              ADDRESS OF DCB                            35950000
ADDRCVT  EQU   3              ADDRESS OF CVT                            36000000
R3       EQU   3              WORK REG                         @ZA04126 36050000
TCBPTR   EQU   4              ADDRESS OF TCB                            36100000
SVRBPTR  EQU   5              ADDRESS OF MY SVRB                        36150000
TSVCBASE EQU   6              BASE REGISTER FOR IGC0006A                36200000
R7       EQU   7              WORK REG 7                                36250000
WORKA    EQU   7              REGISTER 7                                36300000
WORKB    EQU   8              REGISTER 8                                36350000
TCOMTABB EQU   9              WHEN TEST IS RUNNING, ADDRESS OF TCOMTAB  36400000
SVCINFOB EQU   10             ADDR OF ANSWER BLOCK, BASE FOR            36450000
*                             DESCRIPTIVE SEC                           36500000
R10      EQU   10             REG 10                                    36550000
WKPARTB  EQU   11             ADDR OF EXTENDED AREA IN SVRB,            36600000
*                             USE AS WORKAREA                           36650000
SEGTABAD EQU   12             IF ISSUER IS OVLY SUPRVSR,                36700000
*                             ADDRESS OF SEGTAB                         36750000
SOMESAVE EQU   13             REGISTER 13                               36800000
R13      EQU   13             REGISTER 13                               36850000
RETURN   EQU   14             REGISTER 14                               36900000
REG15    EQU   15             REGISTER 15                               36950000
*                                                                       37000000
*        NUMBER EQUATES                                                 37050000
*                                                                       37100000
N1       EQU   1             DECIMAL 1                                  37150000
N2       EQU   2             DECIMAL 2                                  37200000
N0       EQU   0             DECIMAL 0                                  37250000
N4       EQU   4             DECIMAL 4                                  37300000
N8       EQU   8             DECIMAL 8                                  37350000
N12      EQU   12            DECIMAL 12                                 37400000
*                                                                       37450000
*        LENGTH EQUATES                                                 37500000
*                                                                       37550000
L2       EQU   2             LENGTH OF 2                                37600000
L4       EQU   4             LENGTH OF 4                                37650000
L8       EQU   8             LENGTH OF 8                                37700000
*                                                                       37750000
*        CONDITION CODE EQUATES FOR BCR INSTRUCTIONS                    37800000
*                                                                       37850000
EQUAL    EQU   8             BRANCH IF EQUAL                            37900000
ONES     EQU   1             BRANCH IF ONES                             37950000
*                                                                       38000000
*        DISPLACMENT EQUATES                                            38050000
*                                                                       38100000
D0       EQU   0             ZERO DISPLACMENT                           38150000
D3       EQU   3             DISPLACMENT OF 3                           38200000
D4       EQU   4             DISPLACMENT OF 4                           38250000
D8       EQU   8             DISPLACMENT 0F 8                           38300000
D24      EQU   24            DISPLACMENT OF 24                          38350000
D32      EQU   32            DISPLACMENT OF 32                          38400000
D76      EQU   76            DISPLACMENT 0F 76                          38450000
D80      EQU   80            DISPLACMENT 0F 80                          38500000
D96      EQU   96            DISPLACMENT OF 96                          38550000
TIOTDD   EQU   4             OFFSET INTO TIOT ENTRY OF DDNAME           38600000
*                                                                       38650000
*        OTHER EQUATES                                                  38700000
*                                                                       38750000
EXIT     EQU   3             THREE                                      38800000
SP250    EQU   250           SUBPOOL 250, GET CORE IN SUBPOOL 0         38850000
*                                                                       38900000
*        IMMEDIATE OPERANDS                                             38950000
*                                                                       39000000
N00      EQU   X'00'         HEX 00                                     39050000
N01      EQU   X'01'         HEX 01                                     39100000
X80      EQU   X'80'         HEX 80                                     39150000
X74      EQU   X'74'         HEX 74                                     39200000
X40      EQU   X'40'         HEX 40                                     39250000
XFF      EQU   X'FF'         HEX FF                                     39300000
TCBCHAIN EQU   X'80'         SW IN FLAGS, FIRST TIME - CHAIN FROM TCB   39350000
OVLYBLK  EQU   X'40'         SW IN FLAGS, OVLYED A DUPLICATE LOADNAME   39400000
OVLYBIT  EQU   X'20'         OVLY ATTRIBUTE BIT IN BLDL ATTRIBUTE FIELD 39450000
FF       EQU   X'FF'         MASK BYTE                                  39500000
         EJECT                                                          39550000
*********************************************************************** 39600000
*                                                                     * 39650000
*        THIS IS THE ENTRY INITILIZATION ROUTINE                      * 39700000
*                                                                     * 39750000
*********************************************************************** 39800000
S6A01010 EQU   *                                                        39850000
         BALR  TSVCBASE,D0    ADDRESSABILITY                            39900000
         BCTR  TSVCBASE,D0    MAKE BASE EQUAL                           39950000
         BCTR  TSVCBASE,D0    TO ENTRY POINT                            40000000
         USING IGC0006A,TSVCBASE                                        40050000
         USING RBSECT,SVRBPTR ADDRESSABILITY TO THIS SVRB.              40100000
         USING TCB,TCBPTR     ADDRESSABILITY TO TCB.                    40150000
         USING CVT,ADDRCVT    ADDRESSABILITY TO CVT.                    40200000
         USING PSA,PARMREG0   ADDRESSABILITY TO PSA.                    40250000
         LPR   DCBPTR,PARMREG1 POSITIVE ADDRESS OF DCB                  40300000
*********************************************************************** 40350000
* ISSUE A GETMAIN FOR A WORKAREA AND REG SAVE AREA.                     40400000
*********************************************************************** 40450000
         LR    TCOMTABB,RETURN SAVE THE RETURN ADDRESS                  40500000
         LA    PARMREG0,WRKLEN R0= LENGTH OF THE GOTTEN AREA.           40550000
         L     WORKA,PSAAOLD  R7= ADDR OF THE NEW (CURRENT) ASCB        40600000
         GETMAIN RU,LV=(0),BRANCH=YES ISSUE GETMAIN FOR WORKAREA        40650000
         LR    WKPARTB,PARMREG1 R11= ADDR OF THE GOTTEN AREA            40700000
         USING WORKPART,WKPARTB ESTABLISH ADDR'ABILITY TO WORKAREA      40750000
         XC    WRKSTART(WRKLEN),WRKSTART  CLEAR THE WORKAREA            40800000
         MVC   S6ASPL(S6ASPLEN),S6ASPLST  INIT ESTAE PLIST     @ZA11389 40850000
         ST    TCOMTABB,WRKREGRT SAVE THE RETURN ADDRESS                40900000
         L     ADDRCVT,FLCCVT  R3= ADDR OF THE CVT DESTROYED BY GETMAIN 40950000
         SPACE                                                          41000000
**********************************************************************  41050000
*        ISSUE AN ESTAE HERE                                            41100000
**********************************************************************  41150000
         SPACE                                                          41200000
         ESTAE S6AESTAE,CT,PARAM=S6ASPL,XCTL=NO,BRANCH=YES,            *41250000
               SVEAREA=WRKREGSV,MF=(E,WRKESTAE)                         41300000
         SPACE                                                          41350000
S6A01030 EQU   *                                                        41400000
         MVI   S6AFLAGS,N00   CLEAR SVC STATUS FLAGS                    41450000
         LA    TCBPTR,D0(,TCBPTR) ADDR OF LOADNAME'S TCB                41500000
         XC    S6ATCBPT(S6ALEN),S6ATCBPT CLEAR TCB ADDR FOR MNL         41550000
         SPACE                                                          41600000
****     NOW WE CAN SEE IF THE ESTAE WAS OK.....                        41650000
         LTR   REG15,REG15    WAS THE ESTAE OK                          41700000
         BNZ   ESTAFAIL       NO HANDLE THE ESTAE ERROR                 41750000
         SPACE                                                          41800000
         MVC   WRKFLGSV(N1),TCBTSFLG  SAVE THE TCB FLAG STATUS @YM04978 41850000
         OI    TCBTSFLG,TCBATT  DISABLE FOR ATTN THROUGTHOUT SVC61.     41900000
         TM    TCBABF,TCBTCP  IS TEST RUNNING                           41950000
         BZ    S6A07010       NO, GO SAVE FOR LATER USE                 42000000
         L     TCOMTABB,TCBTRN GET ADDR OF TCOMTAB                      42050000
         USING TCOMTAB,TCOMTABB ADDRESSABILITY TO TCOMTAB               42100000
         L     WORKA,WORKAREA ADDR OF AREA TO BE CHANGED                42150000
         LR    WORKB,TCBPTR   SAVE MY TCB ADDR.                         42200000
         L     TCBPTR,TSTTCB    GET THE ADDR OF THE TEST TCB.           42250000
         BAL   RETURN,CHKSTKEY GO CHECK STORAGE KEY                     42300000
         LR    WORKA,TCOMTABB ADDR OF AREA TO BE CHANGED                42350000
         BAL   RETURN,CHKSTKEY GO CHECK STORAGE KEY                     42400000
         L     WORKA,ECBTST   ADDR OF AREA TO BE CHANGED                42450000
         BAL   RETURN,CHKSTKEY GO CHECK STORAGE KEY                     42500000
         LR    TCBPTR,WORKB  RESTORE THE ADDR OF MY TCB.                42550000
         BAL   RETURN,CHKPPRB CHECK OUT THE P. P. FOR VALIDITY          42600000
         LTR   DCBPTR,DCBPTR  IS ISSUER OVLY SUPERVISOR                 42650000
         BZ    S6A06010       YES, GO SEARCH SVCINFO BLKS               42700000
         SPACE                                                          42750000
         BAL   RETURN,GETPARMS  GET THE PARAMETERS             @YM05036 42800000
         SPACE                                                          42850000
         L     R10,PSAAOLD           ADDR OF THE NEW ASCB      @ZA06226 42900000
         L     R10,ASCBASXB-ASCB(R10) ADDR OF THE ASXB         @ZA06226 42950000
         L     R10,ASXBLWA-ASXB(R10)  ADDR OF THE LWA          @ZA06226 43000000
         L     R10,LWATEST-LWA(R10)   ADDR OF SVCINFO BLOCK    @ZA06226 43050000
         ST    SVCINFOB,TSTTRN HEAD OF SVCINFO BLK CHAIN       @ZA06226 43100000
         USING IKJEGSVQ,SVCINFOB                                        43150000
         LTR   SVCINFOB,SVCINFOB IS THEIR A CHAIN                       43200000
         BZ    S6A02030       NO, GO SET UP TO HAVE MAIN                43250000
*                             LINE CREATE A TCB CNTRL                   43300000
*                             CHAIN BLK FOR THIS TCB                    43350000
S6A01050 EQU   *                                                        43400000
         C     TCBPTR,SVQTCBPT IS CNTRL BLK FOR THIS TCB                43450000
         BNE   S6A02010       NO, GO CHECK NEXT CNTRL BLK               43500000
*                                                                       43550000
*        A TCB CONTROL BLOCK AND THE ASSOCIATED SVCINFO BLOCK CHAIN     43600000
*        EXISTS FOR THE TCB THE SVC IS OPERATING UNDER.  CHECK IF THIS  43650000
*        IS A NEW TCB WHOSE ADDR IS THE SAME AS ONE THAT WAS DETACHED   43700000
*                                                                       43750000
         L     WORKA,RBLINK   ADDR OF CALLERS PRB                       43800000
         TM    RBSTAB2-RBSECT(WORKA),RBTCBNXT IS HE ONLY RB ON TCB      43850000
         BZ    S6A02050       NO, TCB NOT NEW, GO                       43900000
         TM    RBCDFLGS-RBSECT(WORKA),RBCDLOAD HAS LOAD BEEN ISSUED     43950000
         BO    S6A02050       YES, TCB NOT NEW, GO                      44000000
         L     WORKA,TCBLLS   ADDR OF LOAD LIST                         44050000
         LTR   WORKA,WORKA    IS THEIR A LOAD LIST                      44100000
         BNZ   S6A02050       YES, TCB NOT NEW, GO                      44150000
*                                                                       44200000
*        THE TCB IS NEW OR THE ONLY RB HAS XCTLED.  START A NEW SVCINFO 44250000
*        BLOCK CHAIN USING THE OLD TCB CONTROL BLOCK                    44300000
*                                                                       44350000
         LA    WORKA,SVQBLKPT ADDR OF SVC CHAIN SLOT IN                 44400000
*                             TCB CONTROL BLOCK                         44450000
         ST    WORKA,S6ASIBCH SAVE FOR CHAINNING                        44500000
         B     S6A03010       GO GET A SVCINFO BLOCK                    44550000
S6A02010 EQU   *                                                        44600000
         L     SVCINFOB,SVQLNKPT NO, ADDR OF NEXT CNTRL BLK             44650000
         LTR   SVCINFOB,SVCINFOB IS THEIR ANY MORE                      44700000
         BNZ   S6A01050       YES, GO SEE IF FOR THIS TCB               44750000
S6A02030 EQU   *                                                        44800000
         ST    TCBPTR,S6ATCBPT ADDR OF TCB FOR MAINLINE                 44850000
         B     S6A03010       GO GET AN SVCINFO BLOCK                   44900000
S6A02050 EQU   *                                                        44950000
         L     SVCINFOB,SVQBLKPT ADDR OF CHAIN FOR CURR TCB             45000000
         DROP  SVCINFOB                                                 45050000
         USING IKJEGSVB,SVCINFOB                                        45100000
         BAL   RETURN,S6A21010 GO SEARCH FOR END OF CHAIN               45150000
*                             OR DUPLICATE ON CHAIN                     45200000
         LR    WORKA,SVCINFOB ADDR OF AREA TO BE CHANGED                45250000
         TM    S6AFLAGS,S6AFOVLY WAS A DUPLICATE FOUND                  45300000
         BO    S6A03030       YES, GO CHECK MULTI-TASK SW               45350000
         LA    WORKA,SVBLNKPT END OF CHAIN, 0 NEXTBLK PTR               45400000
         ST    WORKA,S6ASIBCH SAVE FOR CHAINNING                        45450000
S6A03010 EQU   *                                                        45500000
         BAL   RETURN,S6A11010 GO GET A NEW SVCINFO BLOCK               45550000
         ST    SVCINFOB,S6ASIBPT ADDR OF SVC BLK FOR MAINLNE            45600000
S6A03030 EQU   *                                                        45650000
         LTR   DCBPTR,DCBPTR  IS ISSUER OVLY SUPERVISOR                 45700000
         BZ    S6A04010       YES, GO PROCESS FOR OVLY                  45750000
         BAL   RETURN,S6A31010 GO FILL IN SVCINFO BLOCK                 45800000
         L     WORKA,S6ATCBPT CHAIN STATUS INDICATOR                    45850000
         LTR   WORKA,WORKA    DOES CHAIN EXIST FOR TCB                  45900000
         BNZ   GETCHAIN       NO, GO LET MAINLINE CHAIN        @ZA06226 45950000
         BAL   RETURN,S6A41010 GO CHAIN BLOCK                           46000000
         EJECT                                                          46050000
*********************************************************************** 46100000
*                                                                     * 46150000
*        IF TEST IS RUNNING, POST THE ECB                             * 46200000
*                                                                     * 46250000
*********************************************************************** 46300000
         SPACE 2                                                        46350000
S6A04010 EQU   *                                                        46400000
         L     WORKB,WORKAREA BASE FOR TSTCWORK FROM                    46450000
         USING TSTCWORK,WORKB TCOMTAB                                   46500000
         MVC   CWORKCMD(L'SVBLDNAM),SVBLDNAM LOADNAME TO GENERAL WORK   46550000
*                             AREA FOR AT COMMAND                       46600000
         MVC   CWORKCMD+L'SVBLDNAM(L'SVBATTR1+L'SVBATTR2),SVBATTR1      46650000
*                             ATTRIBUTES FOR AT CMD                     46700000
         DROP  WORKB                                                    46750000
         SPACE                                                          46800000
*********************************************************************** 46850000
*        DO THE FOLLOWING;                                              46900000
*        1) FREE THE LOCAL LOCK, 2)ENQUE ON THE TEST ECB 'TSTSVCNQ'     46950000
*        3) ENABLE FOR ATTN'S, 4) WAIT ON MNL                           47000000
*********************************************************************** 47050000
         DROP  WKPARTB        RELEASE ADDR'ABILITY TO WORKAREA.         47100000
         USING WORKPART,WORKB   REESTABLISH WITH REG 8.                 47150000
         LR    WORKB,WKPARTB  REG 8 = WORKAREA ADDR.                    47200000
S6ALOCKB EQU   *                                                        47250000
         STM   TCOMTABB,WORKA,WRKREGSV  SAVE THE REGS ACROSS THE LOCK.  47300000
         SPACE                                                          47350000
S6ALOCK1 SETLOCK RELEASE,TYPE=LOCAL,RELATED=(LOCAL,IGC0006A(S6ALOCK1))  47400000
         LM    TCOMTABB,WORKA,WRKREGSV  RESTORE THE REGS.               47450000
         TM    TSTFLGS2,TSTLDF IS A LOAD IN PROCESS                     47500000
         BO    S6A04020       YES THEREFORE DO NOT ENQ                  47550000
         OC    DEFERTAB(L'DEFERTAB),DEFERTAB ANY DEFERED BKPTS @ZA06226 47600000
         BZ    S6A05015       NO, DON'T BOTHER MAINLINE        @ZA06226 47650000
         MVC   WRKENQ(L'SVCNQ),SVCNQ MOVE ENQ WORD TO WORKAREA          47700000
         LA    WORKA,WRKENQ   R7= ADDR OF THE ENQ ELEMENT               47750000
         L     R2,CVTPTR      GET CVT ADDRESS               @ZA07137    47800000
         L     R2,CVTTCBP-CVT(R2) GET ADDR OF TCB WORDS     @ZA07137    47850000
         L     R2,N0(R2)      GET ADDRESS OF CURRENT TCB    @ZA07137    47900000
         L     R2,TCBJSCB-TCB(R2) GET JSCB ADDRESS          @ZA07137    47950000
         L     R2,JSCBPSCB-IEZJSCB(R2)     GET PSCB ADDRESS @ZA07137    48000000
         USING PSCB,R2        SET ADDRESSABILITY TO PSCB    @ZA07137    48050000
         MVC   WRKNQRNM(7),PSCBUSER   USE USERID AS RNAME   @ZA07137    48100000
         MVI   WRKNQRNM+7,C' '    BLANK OUT LAST RNAME BYTE @ZA07137    48150000
         DROP  R2             DONE WITH PSCB                @ZA07137    48200000
         LA    R2,WRKNQRNM    POINT TO RNAME                @ZA07137    48250000
         MVC   WRKENQWK(LISTENQE),LISTENQF  SET UP FOR ENQ.             48300000
         LA    SVRBPTR,D0(,SVRBPTR) CLEAR HIGH ORDER BYTE               48350000
         ST    SVRBPTR,WRKECB  PLACE SVRB ADDR IN ECB          @YM07115 48400000
         ENQ   ((7),(2),E,8),ECB=WRKECB,MF=(E,WRKENQWK) ISSUE ENQ       48450000
         LTR   REG15,REG15    IS THE RETURN CODE ZERO          @YM07115 48500000
         BZ    S6A04020       YES THEREFORE CONTINUE           @YM07115 48550000
         SR    PARMREG1,PARMREG1  CLEAR REG 1                  @YM07115 48600000
         IC    PARMREG1,D3(REG15)  PICK UP RETURN CODE         @YM07115 48650000
         LA    WORKA,D4       R7= 4 (FOR COMPARE)              @YM07115 48700000
         CR    PARMREG1,WORKA  WAS THE RETURN CODE A 4         @YM07115 48750000
         BNE   S6A04020       NO THEREFORE CONTINUE            @YM07115 48800000
         NI    TCBTSFLG,FF-TCBATT  DO NOT DEFER ATTNS          @YM07115 48850000
         LA    PARMREG1,WRKECB  R1= ADDR OF THE ECB            @YM07115 48900000
         WAIT  ECB=(1)        WAIT FOR RESOURCE                @YM07115 48950000
S6A04020 DS    0H             CONTINUE BY POSTING MNL                   49000000
         NI    TCBTSFLG,FF-TCBATT  DO NOT DEFER ATTNS ANY LONGER.       49050000
         MVC   WRKSVRBS(3),ECBPP+1 SAVE PRIOR SVRB POINTER     @ZA07138 49100000
*                                                              @ZA09259 49150000
*                                                              @ZA10462 49200000
         ST    SVRBPTR,ECBPP   PTR TO MY SVRB FOR MAINLINE              49250000
         L     PARMREG1,ECBTST ADDR OF ECB TO POST                      49300000
         LA    PARMREG1,D0(,PARMREG1)       ZERO HIGH ORDER BYTE        49350000
         L     PARMREG0,POSTCODE COMPLETION CODE                        49400000
         POST  (1),(0)                      POST TEST ECB               49450000
         WAIT  N1,ECB=ECBPP                 WAIT FOR MAINLINE           49500000
         SPACE                                                          49550000
         SR    REG15,REG15    CLEAR RETURN CODE                         49600000
         EJECT                                                          49650000
*********************************************************************** 49700000
*                                                                     * 49750000
*        RETURN TO ISSUER OF SVC 061                                  * 49800000
*        1) ISSUE THE FREEMAIN, 2)DEQUE THE TSTSVCNQ ELEMENT, 3)RETURN* 49850000
*                                                                     * 49900000
*********************************************************************** 49950000
         DROP  WORKB          RELEASE ADDR'ABILITY TO WORKAREA          50000000
         USING WORKPART,WKPARTB  REESTABLISH WITH R11.                  50050000
         SPACE 2                                                        50100000
S6A05010 EQU   *                                                        50150000
         MVC   ECBPP+1(3),WRKSVRBS RESTORE PRIOR SVRB POINT    @ZA07138 50200000
*                                                              @ZA09259 50250000
*                                                              @ZA10462 50300000
         TM    TSTFLGS2,TSTLDF IS A LOAD IN PROCESS                     50350000
         BO    S6A05015       YES THEREFORE DO NOT DEQ                  50400000
         LA    WORKA,WRKENQ   SETUP THE DEQUE                           50450000
         LA    R2,WRKNQRNM    POINT TO RNAME FOR DEQ       @ZA07137     50500000
         MVC   WRKENQWK(LISTDEQE),LISTDEQF  SET UP FOR DEQ.             50550000
         DEQ   ((7),(2),8),RET=HAVE,MF=(E,WRKENQWK) DEQ ON ECBTST WORD  50600000
         XC    WRKENQ(L'WRKENQ),WRKENQ  CLEAR TEH ENQ ELEMENT           50650000
S6A05015 EQU   *                                                        50700000
*-*-*    SETUP REG 14 FOR THE RETURN                                    50750000
         MVC   TCBTSFLG(N1),WRKFLGSV  RESTORE  TCB FLAG STATUS @YM06810 50800000
         LR    DCBPTR,REG15   SAVE THE RETURN CODE                      50850000
         L     WORKA,WRKREGRT  R7= THE RETRUN ADDRESS                   50900000
         LA    PARMREG0,WRKLEN    R0= LENGTH OF THE FREEMAIN            50950000
         FREEMAIN R,LV=(0),A=(11) ISSUE FREEMAIN OF WORKAREA   @YM04131 51000000
         SPACE                                                          51050000
         ESTAE 0              REMOVE THE ESTAE                          51100000
         TM    TCBABF,TCBTCP  IS TEST RUNNING                  @YM02404 51150000
         BZ    S6A05020       CONTINUE WITH EXIT.              @YM02404 51200000
         NI    TSTFLGS4,FF-TSTRERTN  TURN OFF THE RERTY SW              51250000
S6A05020 EQU   *              EXIT FROM SCV 61.                @YM02404 51300000
         LR    RETURN,WORKA   R14= ADDR OF RETURN                       51350000
         LR    REG15,DCBPTR   RESTORE THE RETURN CODE                   51400000
         LM    PARMREG0,SOMESAVE,RBGRSAVE RESTORE REGS FROM MY SVRB     51450000
         BR    RETURN         RETURN TO ISSUER OF SVC 61                51500000
         EJECT                                                          51550000
*********************************************************************** 51600000
*                                                                     * 51650000
*        SUB ROUTINES FOR MAINSTREAM                                  * 51700000
*                                                                     * 51750000
*********************************************************************** 51800000
         SPACE 2                                                        51850000
*                                                                       51900000
*        GET A SVCINFO BLOCK                                            51950000
*                                                                       52000000
S6A11010 EQU   *                                                        52050000
         USING IKJEGSVB,SVCINFOB                                        52100000
         L     PARMREG0,S6ASVBLV GETMAIN, 36 BYTES IN SP255             52150000
         STM   SEGTABAD,TCOMTABB,WRKREGSV SAVE TEH REGS.                52200000
         L     WORKA,PSAAOLD  R7= ADDR OF THE OLD ASCB.                 52250000
         GETMAIN RU,BRANCH=YES,LV=(0),SP=255    GET AN SVCINFO BLOCK    52300000
         LA    SVCINFOB,D0(,PARMREG1) ADDRESS OF GOTTEN CORE            52350000
         LM    SEGTABAD,TCOMTABB,WRKREGSV RESTORE TEH REGS.             52400000
         XC    SVBLDNAM(SVBLNKPT-SVBLDNAM+L'SVBLNKPT),SVBLDNAM LAST     52450000
*                             NEXT BLK ADDR IS ZERO                     52500000
         BR    RETURN         RETURN TO CALLER                          52550000
         DROP  SVCINFOB                                                 52600000
         EJECT                                                          52650000
*                                                                       52700000
*        SEARCH SVCINFO BLOCK CHAIN FOR THE END OF THE CHAIN OR A       52750000
*        DUPLICATE LOADNAME ON THE CHAIN.  IF THE LOADNAME DOES NOT     52800000
*        EXIST ON THE CHAIN OR THE DUPLICATE IS HUNG OFF OF A           52850000
*        DIFFERENT TCB, SET UP TO ADD ANOTHER SVCINFO BLOCK TO THE      52900000
*        CHAIN.  IF A DUPLICATE EXISTS ON THE SAME TCB, SET UP TO       52950000
*        OVERLAY THE OLD SVCINFO BLOCK.                                 53000000
*                                                                       53050000
         USING IKJEGSVB,SVCINFOB                                        53100000
S6A21010 EQU   *                                                        53150000
         L     WORKA,WRKBLDE  ADDR OF LOADNAME-BLDL ENTRY               53200000
         SR    PARMREG1,PARMREG1 CLEAR REGISTER                         53250000
S6A21030 EQU   *                                                        53300000
         CLC   SVBLDNAM(L'SVBLDNAM),D0(WORKA) IS LOADNAME ON CHAIN      53350000
         BE    S6A21050       YES, GO INDICATE OVLY BLK                 53400000
         C     PARMREG1,SVBLNKPT IS IT END OF CHAIN                     53450000
         BCR   EQUAL,RETURN   YES, GO RETURN TO CALLER                  53500000
         L     SVCINFOB,SVBLNKPT NO, POINT TO NEXT BLK                  53550000
         B     S6A21030       GO SEARCH NEXT BLOCK                      53600000
S6A21050 EQU   *                                                        53650000
         OI    S6AFLAGS,S6AFOVLY YES, INDICATE OVLY-NO CHAIN            53700000
         BR    RETURN         RETURN TO CALLER                          53750000
         DROP  SVCINFOB                                                 53800000
         EJECT                                                          53850000
*                                                                       53900000
*        FILL  IN SVCINFO BLOCK                                         53950000
*                                                                       54000000
S6A31010 EQU   *                                                        54050000
         USING IKJEGSVB,SVCINFOB                                        54100000
         L     WORKA,WRKBLDE  ADDR OF BLDL ENTRY                        54150000
         USING BLDLENTY,WORKA BASE FOR DESCRIPTIVE DSECT                54200000
         MVC   SVBLDNAM(L'SVBLDNAM),MNAME LOAD MODULE NAME              54250000
         ST    TCBPTR,SVBTCBPT ADDRESS OF LOADNAME'S TCB                54300000
         MVC   SVBTTR(L'SVBTTR),MBEGTTR TTR OF BEGINNING OF MEMBER      54350000
         MVC   SVBATTR1(L'SVBATTR1+L'SVBATTR2),MATTRIB ATTRIBUTES       54400000
*                             OF MEMBER                                 54450000
         MVC   SVBCNCAT(L'SVBCNCAT),MCONCAT CONCATENATION NO. OF PDS    54500000
         MVC   SVBDDNAM(L'SVBDDNAM),BLANKS BLANK DDNAME FIELD           54550000
         DROP  WORKA                                                    54600000
         USING IHADCB,DCBPTR                                            54650000
         C     DCBPTR,CVTLINK IS DCB USED, SYSTEM DCB                   54700000
         BE    S6A31070       YES, GO CHECK FOR LINKLIB                 54750000
         OI    SVBFLGS1,SVBDDNME INDICATE DDNAME AVAILABLE              54800000
         L     WORKA,TCBTIO   ADDRESS OF TIOT FROM TCB                  54850000
         USING TIOENTRY,WORKA                                           54900000
         LA    WORKA,D0(,WORKA) CLEAR HIGH ORDER BYTE                   54950000
         AH    WORKA,DCBTIOT  ADDRESS OF DCB DDNAME ENTRY               55000000
         MVC   SVBDDNAM(L'SVBDDNAM),TIOEDDNM DDNAME FROM TIOT ENTRY     55050000
         CLC   SVBDDNAM(L'SVBDDNAM),BLANKS IS DATASET CONCATENATED      55100000
         BNE   S6A31090       NO, DDNAME OK, GET LOAD ADR               55150000
         L     WORKB,TCBTIO   ADDRESS OF TIOT FROM TCB                  55200000
         DROP  WORKA                                                    55250000
         USING IEFTIOT1,WORKB ADDRESSABILITY TO TIOT                    55300000
         LA    WORKB,TIOENTRY ADDRESS OF FIRST ENTRY                    55350000
         DROP  WORKB          RELEASE ADDR'ABILITY TO TIOT              55400000
         USING TIOENTRY,WORKB ESTABLISH ADDR'ABILITY TO DD ENTRY        55450000
S6A31030 EQU   *                                                        55500000
         CR    WORKA,WORKB    IS THIS ENTRY DCB DD ENTRY                55550000
         BE    S6A31090       YES, GOT DDNAME, GO GET LA                55600000
         CLC   BLANKS(L8),TIOEDDNM IS TIOT ENTRY DDNAME BLANK           55650000
         BE    S6A31050       YES, GO POINT TO NEXT ENTRY               55700000
         MVC   SVBDDNAM(L'SVBDDNAM),TIOEDDNM NO, GET DDNAME FROM TIOT   55750000
S6A31050 EQU   *                                                        55800000
         SR    PARMREG1,PARMREG1 CLEAR REGISTER TO ZEROES               55850000
         IC    PARMREG1,TIOELNGH LENGTH OF THIS TIOT ENTRY              55900000
         AR    WORKB,PARMREG1 ADDRESS OF NEXT DD ENTRY                  55950000
         B     S6A31030       GO CHECK FOR END OF LOOP                  56000000
S6A31070 EQU   *                                                        56050000
         XC    SVBDDNAM(L'SVBDDNAM),SVBDDNAM CLEAR DDNAME TO ZEROES     56100000
         CLI   SVBCNCAT,N00   IS DATASET LINKLIB                        56150000
         BNE   S6A31090       NO, CAN DO NOTHING, GO ON                 56200000
         OI    SVBFLGS1,SVBLNKLB INDICATE DATASET IS LINKLIB            56250000
S6A31090 EQU   *                                                        56300000
         L     WORKA,WRKEXTL  ADDR OF EXTENT LIST                       56350000
         USING XTLST,WORKA    ADDR'ABILITY TO EXTLIST                   56400000
         L     WORKB,XTLNRFAC NUMBER OF SCATTERED BLOCKS                56450000
         SLL   WORKB,N2       TIMES NO. BYTES IN A WORD                 56500000
         L     WORKA,XTLMSBLA(WORKB)  PTR TO ADDR OF FIRST BLOCK        56550000
         DROP  WORKA                                                    56600000
         ST    WORKA,SVBEP    LOADED ADDR TO SVCINFO BLK                56650000
         BR    RETURN         RETURN TO CALLER                          56700000
         DROP  WORKB,SVCINFOB,DCBPTR                                    56750000
         EJECT                                                          56800000
*                                                                       56850000
*        IF NOT OVERLAYING A SVCINFO BLOCK, ADD NEW ONE TO CHAIN OR     56900000
*        START THE CHAIN                                                56950000
*                                                                       57000000
S6A41010 EQU   *                                                        57050000
         TM    S6AFLAGS,S6AFOVLY DID WE OVLY A BLOCK                    57100000
         BCR   ONES,RETURN    YES, RETURN TO CALLER                     57150000
         TM    S6AFLAGS,S6ATCBCH START CHAIN FROM TCB                   57200000
         BZ    S6A41030       NO, GO ADD TO EXISTNG CHAIN               57250000
         SR    PARMREG1,PARMREG1 CLEAR REGISTER                         57300000
         ICM   PARMREG1,8,TCBABF FLAG BYTE FROM TCBTRN FIELD   @ZA01570 57350000
         OR    PARMREG1,SVCINFOB FLAGS PLUS HEAD OF CHAIN               57400000
         ST    PARMREG1,TCBTRN INTO TRN FIELD IN TCB                    57450000
         BR    RETURN         RETURN TO CALLER                          57500000
S6A41030 EQU   *                                                        57550000
         L     WORKB,S6ASIBCH ADDR OF 0 NEXTBLK FOR CHAIN               57600000
         ST    SVCINFOB,D0(,WORKB) ADD NEW BLOCK TO CHAIN               57650000
         BR    RETURN         RETURN TO CALLER                          57700000
         EJECT                                                          57750000
*********************************************************************** 57800000
*                                                                     * 57850000
*        COMPARE STORAGE KEY IN TCB TO STORAGE KEY OF ADDRESS PASSED  * 57900000
*        IN WORKA                                                     * 57950000
*                                                                     * 58000000
*********************************************************************** 58050000
         SPACE 2                                                        58100000
CHKSTKEY EQU   *                                                        58150000
         SPACE                                                          58200000
         STM   PARMREG1,RETURN,WRKREGSV  SAVE REGS 1-14                 58250000
         LR    PARMREG1,WORKA  REG1 = ADDR TO BE CHECKED                58300000
         SR    DCBPTR,DCBPTR   CLEAR REG 2 (SECOND ADDR OF RANGE)       58350000
         L     REG15,CVT0VL00   REG 15= ADDR OF VALIDITY CHECK ROUTINE  58400000
         BALR  RETURN,REG15     BRANCH TO VALIDITY CHECK ROUTINE        58450000
         LM    PARMREG1,RETURN,WRKREGSV  RESTORE REGS 1-14              58500000
         BNZ   S6ALOCKA         ERROR THEREFORE RETURN.                 58550000
         BR    RETURN           RETURN BACK TO CALLER                   58600000
         EJECT                                                          58650000
*********************************************************************** 58700000
*                                                                     * 58750000
*        RELEASE THE LOCAL LOCK                                         58800000
*                                                                     * 58850000
*********************************************************************** 58900000
         SPACE                                                          58950000
S6ALOCKA EQU   *                                                        59000000
         LA    WORKB,WRKREGSV R8= ADDR OF REG SAVE AREA        @YM02260 59050000
         STM   TCOMTABB,WORKA,D0(WORKB)  SAVE REGS ACROSS LOCK @YM02260 59100000
         SPACE                                                          59150000
S6ALOCK2 SETLOCK RELEASE,TYPE=LOCAL,RELATED=(LOCAL,IGC0006A(S6ALOCK2))  59200000
         LM    TCOMTABB,WORKA,D0(WORKB)  RESTORE THE REGS.     @YM02260 59250000
         B     S6A05015       RETURN TO CALLER                          59300000
         EJECT                                                          59350000
*********************************************************************** 59400000
*                                                                     * 59450000
*        THIS ROUTINE WILL PASS THE LOADNAME OF A LOAD MODULE LINK    * 59500000
*        EDITTED IN OVERLAY TO THE AT COMMAND WHEN THE OVERLAY        * 59550000
*        SUPERVISOR BRINGS A NEW SEGMENT INTO CORE                    * 59600000
*                                                                     * 59650000
*********************************************************************** 59700000
         SPACE 2                                                        59750000
         USING IKJEGSVQ,SVCINFOB                                        59800000
         SR    REG15,REG15    CLEAR RETURN CODE                         59850000
S6A06010 EQU   *                                                        59900000
         L     SEGTABAD,RBGRS12 ADDRESS OF SEGMENT TABLE                59950000
         LA    SEGTABAD,D0(,SEGTABAD) ADDRESS OF SEGMENT TABLE          60000000
         L     R10,PSAAOLD           ADDR OF THE NEW ASCB      @ZA06226 60050000
         L     R10,ASCBASXB-ASCB(R10) ADDR OF THE ASXB         @ZA06226 60100000
         L     R10,ASXBLWA-ASXB(R10)  ADDR OF THE LWA          @ZA06226 60150000
         L     R10,LWATEST-LWA(R10)   ADDR OF SVCINFO BLOCK    @ZA06226 60200000
         ST    SVCINFOB,TSTTRN HEAD OF SVCINFO BLOCK CHAIN     @ZA06226 60250000
S6A06030 EQU   *                                                        60300000
         LTR   SVCINFOB,SVCINFOB IS THEIR A CHAIN                       60350000
         BZ    S6ALOCKA       NO, GO SET UP RETURN                      60400000
         C     TCBPTR,SVQTCBPT THIS CHAIN FOR CURRENT TCB               60450000
         BE    S6A06050       YES, GO SEARCH CHAIN                      60500000
         L     SVCINFOB,SVQLNKPT ADDR OF NEXT TCB CNTRL BLK             60550000
         B     S6A06030       GO CHECK FOR A CHAIN                      60600000
S6A06050 EQU   *                                                        60650000
         L     SVCINFOB,SVQBLKPT PTR TO FIRST BLK ON CHAIN              60700000
         DROP  SVCINFOB                                                 60750000
         USING IKJEGSVB,SVCINFOB                                        60800000
S6A06070 EQU   *                                                        60850000
         C     SEGTABAD,SVBEP IS SEGTAB FOR THIS SVC BLK                60900000
         BE    S6A06110       YES, GO CHECK FOR OVLY                    60950000
S6A06090 EQU   *                                                        61000000
         C     DCBPTR,SVBLNKPT IS THIS THE LAST BLOCK                   61050000
         BE    S6ALOCKA       YES, GO SET UP RETURN                     61100000
         L     SVCINFOB,SVBLNKPT POINT TO NEXT SVCINFO BLK              61150000
         B     S6A06070       GO CHECK NEXT SVCINFO BLK                 61200000
S6A06110 EQU   *                                                        61250000
         TM    SVBATTR1,SVBOVLY IS LOAD MODULE IN OVERLAY               61300000
         BZ    S6A06090       NO, GO BACK-CONTINUE SEARCH               61350000
         B     S6A03030       YES, GO PASS LOADNAME TO                  61400000
*                             AT COMMAND                                61450000
         DROP  SVCINFOB                                                 61500000
         EJECT                                                          61550000
*********************************************************************** 61600000
*                                                                     * 61650000
*        THIS ROUTINE WILL SAVE THE SVC INFO IF TEST IS NOT RUNNING   * 61700000
*                                                                     * 61750000
*********************************************************************** 61800000
         SPACE 2                                                        61850000
         USING IKJEGSVQ,SVCINFOB                                        61900000
S6A07010 EQU   *                                                        61950000
         SPACE                                                          62000000
         BAL   RETURN,GETPARMS  OBTAIN PARMS FROM CONTENT SUPR @YM05036 62050000
         SPACE                                                          62100000
         BAL   RETURN,CHKPPRB CHECK OUT THE PP TYPE.                    62150000
         L     SVCINFOB,TCBTRN TRN FIELD OF TCB CAN BE                  62200000
*                             HEAD OF SVCINFO BLK CHAIN                 62250000
*                             ZERO                                      62300000
         LA    SVCINFOB,D0(,SVCINFOB) CLEAR TRN FLAGS FIELD             62350000
         LTR   SVCINFOB,SVCINFOB IS IT FIRST TIME                       62400000
         BNZ   S6A07070       NO, GO SET UP TO SEARCH                   62450000
         OI    S6AFLAGS,S6ATCBCH INDICATE CHAIN FROM TCB                62500000
S6A07030 EQU   *                                                        62550000
         BAL   RETURN,S6A11010 GO GET AN SVCINFO BLOCK                  62600000
S6A07050 EQU   *                                                        62650000
         BAL   RETURN,S6A31010 GO FILL IN GOTTEN SVC BLK                62700000
         BAL   RETURN,S6A41010 GO START CHAIN FROM TCBTRN               62750000
         SR    REG15,REG15    CLEAR RETURN CODE                         62800000
         B     S6ALOCKA       GO SET UP RETURN TO ISSUER                62850000
         DROP  SVCINFOB                                                 62900000
         USING IKJEGSVB,SVCINFOB                                        62950000
S6A07070 EQU   *                                                        63000000
         BAL   RETURN,S6A21010 GO SEARCH FOR DUP OR END                 63050000
         LR    WORKA,SVCINFOB ADDRESS OF AREA TO CHANGE                 63100000
         BAL   RETURN,CHKSTKEY GO CHECK STORAGE KEY                     63150000
         TM    S6AFLAGS,S6AFOVLY ARE WE GOING TO OVLY A BLK             63200000
         BO    S6A07050       YES, GO SET UP TO OVLY BLK                63250000
         LA    WORKA,SVBLNKPT LAST 0 NEXTBLK ADDRESS                    63300000
         ST    WORKA,S6ASIBCH SAVE FOR CHAINNING                        63350000
         B     S6A07030       GO SET UP TO GET A SVC BLK                63400000
         EJECT                                                          63450000
*********************************************************************** 63500000
*        THE SVC MUST VARIFY THAT THE PROGRAM IT IS SERVICING IS NOT  * 63550000
*        PRIVILDGED. (P.P. KEY NOT SUPERVISOR STATE, AND NOT AN SVRB) * 63600000
*********************************************************************** 63650000
         SPACE                                                          63700000
CHKPPRB  EQU   *                                                        63750000
         LR    WORKB,SVRBPTR  SAVE MY RB ADDR.                          63800000
         LTR   DCBPTR,DCBPTR  IS IT OVERLAY SUPR?                       63850000
         BZ    CHKTCB         YES IT IS OVERLAY SUPR.                   63900000
         L     SVRBPTR,RBLINK  GET THE ADDR OF PP RB.                   63950000
         TM    RBCDFLGS,RBCDATCH CREATED BY ATTACH?                     64000000
         BO    CHKTCB         YES,GO VERIFY TCB KEY                     64050000
         L     SVRBPTR,RBLINK  GET THE ADDR OF PP RB.                   64100000
         TM    RBSTAB1,RBFTP-RBFTIRB  WHAT KIND OF RB IS IT(PRB OR IRB) 64150000
         BNZ   PPRBFAIL       IT IS NOT A PRB OR IRB.                   64200000
         TM    RBOPSW+N1,PSWBIT  DETERMINE IF IN PP MODE                64250000
         BZ    PPRBFAIL       NOT IN PP MODE.                           64300000
         TM    RBOPSW+N1,PSWPKEYF  IS THE PROTECT KEY ZWRO.             64350000
         BZ    PPRBFAIL       NO IT IS KEY 0-7                          64400000
         LR    SVRBPTR,WORKB  RESTORE MY RB POINTER                     64450000
         BR    RETURN         ALL IS OK THEREFORE EXIT.                 64500000
         SPACE                                                          64550000
PPRBFAIL EQU   *              IF TEST IS RUNNING INDICATE ERROR         64600000
*                             ELSE JUST RETURN DOING NOTHING.           64650000
         LR    SVRBPTR,WORKB  RESTORE MY RB POINTER                     64700000
         TM    TCBABF,TCBTCP  IS TEST RUNNING.                 @YM02404 64750000
         BZ    S6ALOCKA       EXIT WITHOUT ERROR MSG.          @YM02404 64800000
         LA    WORKB,WRKREGSV R8= ADDR OF REG SAVE AREA        @YM02260 64850000
         STM   TCOMTABB,WORKA,D0(WORKB)  SAVE REGS ACROSS LOCK @YM02260 64900000
         SPACE                                                          64950000
S6ALOCK3 SETLOCK RELEASE,TYPE=LOCAL,RELATED=(LOCAL,IGC0006A(S6ALOCK3))  65000000
         LM    TCOMTABB,WORKA,D0(WORKB)  RESTORE THE REGS.     @YM02260 65050000
         L     REG15,IOVCON   R15= ADDR OF IO FOR MSG          @ZA04126 65100000
         MVC   TSTIOPRM(IOPRMLN),IOPRM  PLACE IO PARM LIST IN WORKAREA  65150000
         MVI   TSTIOPRM,MSGINDC PLACE MSG INDICATOR IN LIST             65200000
         LA    PARMREG1,TSTIOPRM    R1= ADDR OF THE IO PARM LIST        65250000
         L     SOMESAVE,REGSAVE6  R13= ADDR OF WORKAREA FOR IO @YM07131 65300000
         BALR  14,REG15       GO TO IO.                        @ZA04126 65350000
         B     S6A05015       EXIT IT AS ERROR WAS HANDLED.             65400000
CHKTCB   TM    TCBPKF,PSWPKEYF IS THIS SUPERVISOR KEY?         @YM02404 65450000
         BZ    PPRBFAIL       YES,ERROR EXIT                   @YM02404 65500000
         TM    TCBFLGS3,TCBFSM  IS IT IN SUPR STATE            @YM02404 65550000
         BO    PPRBFAIL       YES THEREFORE HANDLE ERROR.      @YM02404 65600000
         LR    SVRBPTR,WORKB  RESTORE MY RB POINTER            @YM02404 65650000
         BR    RETURN         ALL IS OK THEREFORE EXIT.        @YM02404 65700000
         EJECT                                                          65750000
********                                                                65800000
*    GET 12 BYTES  OF SP255 STORAGE AND CHAIN THE SVCINFO BLOCKS        65850000
*        FILLING IN THE TCB ADDR AND BLOCK PTR                          65900000
********                                                                65950000
         SPACE 5                                                        66000000
GETCHAIN EQU   *                                                        66050000
         L    R7,PSAAOLD           GET ASCB ADDR               @ZA06226 66100000
         L    R0,CHAINLEN          12 BYTES SP=255             @ZA06226 66150000
         GETMAIN RU,LV=(0),BRANCH=YES,SP=255  GET THE STORAGE @ZA06226  66200000
         XC   N0(N12,R1),N0(R1)     ZERO THE STORAGE           @ZA06226 66250000
         OC   N4(N8,R1),S6ATCBPT   FILL IN TCB AND BLOCK PTR   @ZA06226 66300000
         L    R7,PSAAOLD           GET ASCB ADDR               @ZA06226 66350000
         L    R7,ASCBASXB-ASCB(R7) GET ASXB ADDR               @ZA06226 66400000
         L    R7,ASXBLWA-ASXB(R7) GET LWA ADDR                 @ZA06226 66450000
         MVC  N0(4,R1),LWATEST-LWA(R7) PUSH DOWN THE CHAIN   @ZA06226   66500000
         ST   R1,LWATEST-LWA(R7) DITTO                         @ZA06226 66550000
         ST   R1,TSTTRN          PTR ALSO IN TCOMTAB           @ZA06226 66600000
         XC   S6ATCBPT(L'S6ATCBPT),S6ATCBPT ZERO THIS FIELD    @ZA06226 66650000
*                                TO PREVENT MNL FROM CHAINING  @ZA06226 66700000
         B    S6A04010           GO TO MNL IF REQUIRED         @ZA06226 66750000
        EJECT                                                           66800000
*********************************************************************** 66850000
*        GET THE BLDL ENTRY AND EXTENT LIST FROM THE CALLERS SVRB       66900000
*********************************************************************** 66950000
         SPACE                                                          67000000
GETPARMS EQU   *              GET PARMS FROM CONTENT SUPR SVRB.         67050000
         SPACE                                                          67100000
         L     WORKA,RBLINK      GET THE ADDR OF CALLERS RB             67150000
         L     WORKA,X74(WORKA)  R7= CALLERS WORK AREA                  67200000
         USING WKAREA,WORKA     ESTABLISH ADDR'ABILITY TO CALLERS AREA  67250000
         LA    PARMREG1,WKNAME  ADDR OF THE BLDL NAME                   67300000
         ST    PARMREG1,WRKBLDE PLACE THE ADDR INTO TEMP WORKAREA       67350000
         L     WORKA,WKCDADDR  R7= ADDR OF THE CDE                      67400000
         DROP  WORKA          RELEASE ADDR'ABILITY TO CALLER AREA       67450000
         USING CDENTRY,WORKA  ADDR'ABILITY TO CDE                       67500000
CDESERCH EQU   *              CDE SEARCH LOOP                           67550000
         TM    CDATTR,CDMIN   IS THE CDE A MINOR                        67600000
         L     WORKA,CDXLMJP  ADDR OF THE EXT LIST (OR MAJOR)           67650000
         BO    CDESERCH       LOOP BACK FINDING MAJOR                   67700000
         ST    WORKA,WRKEXTL  SAVE ADDR OF THE EXTLIST..                67750000
         BR    RETURN         EXIT TO CALLER                   @YM05036 67800000
         SPACE                                                          67850000
         DROP  WORKA                                                    67900000
         EJECT                                                          67950000
*********************************************************************** 68000000
*                                                                     * 68050000
*        WE HAVE TO DETERMINE WHAT TO DO WITH THE ESTAE FAILURE.      * 68100000
*              1) IF TEST IS RUNNING END THE SESSION.                 * 68150000
*              2) IF TEST IS NOT RUNNING RETURN WITH 4.               * 68200000
*                                                                     * 68250000
*********************************************************************** 68300000
         SPACE                                                          68350000
ESTAFAIL DS    0H             ESTAE FAILED.                             68400000
         SPACE                                                          68450000
         TM    TCBABF,TCBTCP  IS TEST RUNNING                           68500000
         BZ    S6A08010       NO, RETURN TO CALLER WITH 4.              68550000
         L     TCOMTABB,TCBTRN GET ADDR OF TCOMTAB                      68600000
         USING TCOMTAB,TCOMTABB ADDRESSABILITY TO TCOMTAB               68650000
         OI    TSTFLGS4,TSTSVCAB  INDICATE TO MNL TO TERMINATE          68700000
         B     S6ALOCKB       POST MNL TO END TEST SESSION..            68750000
S6A08010 DS    0H             RETURN WITH 4.                            68800000
         LA    REG15,D4       REGISTER 15 = 4..                         68850000
         B     S6ALOCKA       RETURN.                                   68900000
         EJECT                                                          68950000
*********************************************************************** 69000000
*                                                                     * 69050000
*        THIS ROUTINE IS USED TO SYNCH TO IKJEGSTA FOR HANDLING ABENDS  69100000
*                                                                     * 69150000
*********************************************************************** 69200000
         SPACE                                                          69250000
         SPACE                                                          69300000
S6AESTAE DS    0F             START OF DUMMY STA                        69350000
         USING S6AESTAE,REG15  RE-ESTABLISH ADDR'ABILITY       @YM04131 69400000
         L     TCBPTR,FLCCVT R4= ADDR OF CVT                   @YM04131 69450000
         USING CVT,TCBPTR    ADDR'ABILITY TO CVT               @YM04131 69500000
         L     TCBPTR,CVTTCBP  R4= ADDR OF TCB                 @YM04131 69550000
         L     TCBPTR,D4(,TCBPTR)  R1= ADDR OF THE TCB         @YM04131 69600000
         USING TCB,TCBPTR     ADDRABILITY TO TCB               @YM04131 69650000
         L     TCOMTABB,TCBTRN  R9= ADDR OF TCOMTAB                     69700000
         TM    TCBABF,TCBTCP  IS TEST RUNNING.                          69750000
         BZ    ESTAERR        NO TEST IS NOT IN CONTROL                 69800000
         USING TCOMTAB,TCOMTABB  ADDR'ABILITY TO TCOMTAB                69850000
         L     REG15,STAEVCON    R15= ADDR OF IKJEGSTA         @ZA04126 69900000
         LR    R13,RETURN         SAVE R14 AROUND BALR         @ZA04126 69950000
*                        R13 IS NOT USED BY IKJEGSTA           @ZA04126 70000000
         BALR  RETURN,REG15   TRANSFER CONTROL TO IKJEGSTA     @ZA04126 70050000
         LTR   R1,R1          IS A WORK AREA AVAIL ??          @ZA04126 70100000
         BZR   R13            NO, JUST RETURN                  @ZA04126 70150000
         USING SDWA,R1        YES-SET UP FOR RETRY             @ZA11389 70200000
         L     R3,SDWAPARM    GET W/A ADDRESS FOR RETRY        @ZA11389 70250000
         ST    R3,SDWASR03    SAVE FOR RETRY RTN.              @ZA11389 70300000
         ST    TCOMTABB,SDWASR09   SAVE PTR TO TCOMTAB         @ZA11389 70350000
         L     TSVCBASE,N8(,R3)    GET BASE REG=RTSVCBASE      @ZA11389 70400000
         ST    TSVCBASE,SDWASR06    SAVE FOR RETRY ROUTINE     @ZA11389 70450000
         SETRP RETADDR=(PARMREG0),RECORD=YES,FRESDWA=YES,RC=4,         X70500000
               RETREGS=YES                                     @ZA11389 70550000
         BR    R13            RETURN TO CALL                   @ZA04126 70600000
         DROP  REG15          RELAESE TEMP BASE.                        70650000
         SPACE                                                          70700000
ESTAERR  DS    0H             SOMETHING IS A MESS PERCOLATE..           70750000
         SR    REG15,REG15    CLEAR REG 15..                            70800000
         BR    RETURN         EXIT TO CALLER                            70850000
         EJECT                                                          70900000
*********************************************************************** 70950000
*                                                                     * 71000000
*        THIS ROUTINE IS THE RETRY ROUTINE OF IGC0006A                * 71050000
*        ON ENTRY ALL MY REGISTERS ARE VALID DUE TO SETRP.    @ZA11389* 71100000
*                                                                     * 71150000
*********************************************************************** 71200000
         SPACE                                                          71250000
S6ARETRY DS    0F             THE START OF THE RETRY ROUTINE            71300000
         SR    REG15,REG15    CLEAR RETURN CODE                         71350000
         CLC   SVCNQ(L'SVCNQ),WRKENQ IS THE DEQ IN EFFECT.              71400000
         BE    S6A05010       NO THEREFORE EXIT TO CALLER               71450000
         B     S6A05015       EXIT TO THE CALLER.                       71500000
         EJECT                                                          71550000
*********************************************************************** 71600000
*                                                                     * 71650000
*        CONSTANTS                                                    * 71700000
*                                                                     * 71750000
*********************************************************************** 71800000
         SPACE 2                                                        71850000
         DS    0F                                                       71900000
IOVCON   DC    V(IKJEGIO)     ADDR OF MSG ISSUER FOR BALR      @ZA04126 71950000
STAEVCON DC    V(IKJEGSTA)    ADDR OF ESTAE PROCESSOR          @ZA04126 72000000
SVCNQ    DC    CL8'IKJTMPNM'  THIS IS THE SVC (61, 97) ENQ LOCK@ZA07137 72050000
POSTCODE DC    X'04000000'    COMPLETION CODE FOR ECB                   72100000
ADDRMASK DC    X'00FFF800'    AND FIELD FOR AREA ADDRESS                72150000
KEYMASK  DC    X'000000F0'    AND FIELD FOR AREA KEY                    72200000
S6ASVBLV DC    AL1(0)       GETMAIN PARMS FOR SVC BLK        @ZA06226   72250000
         DC    AL3(36)        GET 36 BYTES IN SP 255                    72300000
CHAINLEN DC   AL1(0)        SUBPOOL NUMBER                   @ZA06226   72350000
        DC   AL3(12)         12 BYTES                          @ZA06226 72400000
BLANKS   DC    8C' '                        BLANKS FOR CLEARING WKAREAS 72450000
ENABLE   DC    X'FF'                        ENABLED SYSTEM MASK         72500000
MSGINDC  EQU   X'02'          MSG INDICATOR FOR LIST FORM.              72550000
PSWBIT   EQU   X'01'          PSW PP MODE BIT.                          72600000
PSWPKEYF EQU   X'80'          PSW PP MODE KEYS.                         72650000
SUPERZAP DC    50C'Z'         SUPERZAP PATCH AREA                       72700000
         SPACE                                                          72750000
S6ASPLST IKJEGSPL RTRY=S6ARETRY,ABNTB=STAETAB,MODNM=IGC0006A,  @ZA11389*72800000
               TNM=TEST-SVC                                    @ZA11389 72850000
S6ASPLEN EQU   *-S6ASPLST                                      @ZA11389 72900000
         SPACE                                                          72950000
STAETAB  DS    0F             ABEND TABLE FOR IKJEGSTA                  73000000
         DC    X'FF'          NO ENTRIES IN TABLE                       73050000
         SPACE 3                                                        73100000
*        ISSUE THE LIST FORM OF THE ENQ..............                   73150000
         SPACE                                                          73200000
LISTENQF ENQ   (LISTENQF,LISTENQF,E,8),ECB=LISTENQF,MF=L                73250000
LISTENQE EQU   *-LISTENQF     LENGTH OF LIST FORM OF ENQ                73300000
         SPACE 3                                                        73350000
*        ISSUE THE LIST FORM OF THE DEQ..............                   73400000
         SPACE                                                          73450000
LISTDEQF DEQ   (LISTDEQF,LISTDEQF,8),RET=HAVE,MF=L                      73500000
LISTDEQE EQU   *-LISTDEQF     LENGTH OF LIST FORM OF DEQ                73550000
         SPACE                                                          73600000
IOPRM    IKJEGSIO  MSG,FIRST=M0053,SECOND=M0217,ID=S6A01,MF=(L)         73650000
IOPRMLN  EQU   *-IOPRM        GET THE LENGTH OF PARM LIST               73700000
         EJECT                                                          73750000
*********************************************************************** 73800000
*                                                                     * 73850000
*        DSECTS                                                       * 73900000
*                                                                     * 73950000
*********************************************************************** 74000000
         SPACE 2                                                        74050000
WORKPART DSECT     ,    THIS DSECT DESCRIBES THE GENERAL SAVE AREA      74100000
*                       GETMAIN USED AS A WORK AREA                     74150000
*                                                                       74200000
WRKSTART DS    0F             START OF WORK AREA                        74250000
*        ***************************************************** @ZA11389 74300000
*        *  UNDER NO CIRCUMSTANCES MAY S6ASPL BE MOVED.      * @ZA11389 74350000
*        *  IT'S POSITION MAKES IT POSSIBLE TO RE-INIT       * @ZA11389 74400000
*        *  REGISTERS NEEDED BY ESTAE/RETRY ROUTINES         * @ZA11389 74450000
*        ***************************************************** @ZA11389 74500000
S6ASPL   DS    XL(S6ASPLEN)   ESTAE PARAMETER LIST             @ZA11389 74550000
WRKREGSV DS    18F            REGISTER SAVE AREA FOR BRANCH ENTRIES     74600000
WRKESTAE DS    4F             ESTAE WORK AREA                           74650000
WRKENQ   DS    CL8            STORAGE AREA FOR THE ENQ CHARACTER STRING 74700000
WRKREGRT DS    1F             SAVE RETURN ADDRESS                       74750000
WRKEXTL  DS    1F             ADDR OF THE EXTLIST                       74800000
WRKBLDE  DS    1F             ADDR OF THE BLD ENTRY                     74850000
WRKFLGSV DS    1X             FLAG SAVE AREA                   @YM04978 74900000
WRKSVRBS DS    3X             SAVE AREA FOR PRIOR SVRB ADDRESS @ZA07138 74950000
*                             FROM ECBPP              @ZA09259,@ZA10462 75000000
WRKECB   DS    1F             WAIT ECB FOR ENQ RESOURCE        @YM07115 75050000
         ORG   WRKREGSV       REESTABLISH TO TOP                        75100000
WRKENQPR DS    1F             PREFIX FOR ECB ADDRESS           @YM07115 75150000
WRKENQWK DS    0F             ENQ WORKAREA                              75200000
WRKENQFG DS    X              FLAG FOR END OF LIST                      75250000
WRKENQTP DS    2X             TPYE INDICATOR                            75300000
WRKENQRC DS    X              RETURN CODE FROM ENQ                      75350000
         ORG                                                            75400000
WRKNQRNM DS    CL8            RNAME FOR ENQ/DEQ                @ZA07137 75450000
WRKLEN   EQU   *-WRKSTART     LENGTH OF GENERAL WORKAREA       @ZA11389 75500000
         EJECT                                                          75550000
         IHASCVT                                                        75600000
         EJECT                                                          75650000
         IHAFETWK                                                       75700000
         EJECT                                                          75750000
         IHACDE                                                         75800000
         EJECT                                                          75850000
         IHAXTLST                                                       75900000
         EJECT                                                          75950000
         IHAPSA                                                         76000000
         EJECT                                                          76050000
         IKJRB                                                          76100000
*                       IN MY SVRB AS USED AS A WORK AREA               76150000
*                                                                       76200000
         ORG   RBEXSAVE                                                 76250000
S6ATCBPT DS    A              TCB ADDRESS FOR MAINLINE                  76300000
S6ASIBPT DS    A              SVC BLK ADDR FOR MAINLINE                 76350000
S6ASIBCH DS    A              ADDR OF 0 NEXTBLK IN CHAIN                76400000
S6ARETRN DS    A              RETURN ADDRESS                            76450000
S6ADUMMY DS    H              HALF WORD OF SPACE                        76500000
AREAKEY  DS    X              STORAGE KEY OF AREA                       76550000
S6AFLAGS DS    X              FLAGS FOR SVC PROCESSING                  76600000
S6ATCBCH EQU   B'10000000'    CHAIN SVB FROM TCB.                       76650000
S6AFOVLY EQU   B'01000000'    DUPLICATE SVB FOUND.                      76700000
*              B'00XXXXXX'    RESERVED BITS.                            76750000
S6ALEN   EQU   *-S6ATCBPT     LENGTH OF SVRB WORKAREA                   76800000
         EJECT                                                          76850000
         IKJEGSVB                                                       76900000
         EJECT                                                          76950000
         IKJEGSVQ                                                       77000000
         EJECT                                                          77050000
BLDLENTY DSECT     ,    THIS DSECT DESCRIBES THE STANDARD PART OF THE   77100000
*                       DIRECTORY ENTRY AS SUPPLIED BY BLDL             77150000
*                                                                       77200000
MNAME    DS    D                            MEMBER NAME                 77250000
MBEGTTR  DS    3X                           TTR OF BEG OF MEMBER        77300000
MCONCAT  DS    X                            CONCATENATION NO. OF PDS    77350000
MLIBRARY DS    X                            TYPE LIBRARY INDICATOR      77400000
*                                                X'01' FOUND IN LINKLIB 77450000
MFILLER  DS    9X                           OTHER INFO NOT PERTINET     77500000
MATTRIB  DS    2X                           MEMBER ATTRIBUTES           77550000
         EJECT                                                          77600000
         TCOMTAB                                                        77650000
         EJECT                                                          77700000
         TSTCWORK                                                       77750000
         EJECT                                                          77800000
         CVT   DSECT=YES                                                77850000
         EJECT                                                          77900000
         IKJTCB LIST=YES                                                77950000
         IEZJSCB                                                        78000000
         IKJPSCB                                                        78050000
         EJECT                                                          78100000
         IHASDWA                                                        78150000
         EJECT                                                          78200000
IHADCB   DCBD  DEVD=DA,DSORG=PO                                         78250000
         EJECT                                                          78300000
IEFTIOT1 DSECT                                                          78350000
         IEFTIOT1                                                       78400000
         EJECT                                                          78450000
         IKJEFLWA                                                       78500000
         EJECT                                                          78550000
         IHAASCB                                                        78600000
         EJECT                                                          78650000
         IHAASXB                                                        78700000
         END   IGC0006A                                                 78750000
./  ADD  SSI=81730760,NAME=IGC0009G
*30740007*************************************************************  42720003
         TITLE 'IGC0009G - BREAKPOINT PROCESSING PORTION'               42730003
         COPY  IKJEGSIO                                                 42760003
         EJECT                                                          42800003
IGC0009G CSECT                                                          42840003
*A390600-391000                                                @YM00583 42850003
*A392600-393777                                                @YM00583 42880003
*A712500-714000                                                @YM04131 42920003
*C742522-742523,742533,783887-783957,784611                    @YM04131 42960003
*A717204-719620                                                @YM04107 42970003
*A361416,361554-361609,361944,36198,367000,793276              @YM07115 43000003
*C784445                                                       @YM06379 43040003
*C401722                                                       @YM07131 43080003
*A334500-335500                                                @ZA00823 43090003
*D212000-212500                                                @ZA00874 43120003
*A196200,196700                                                @ZA00889 43160003
*C447500,449000                                                @ZA02713 43200003
*A15860000,16060000-16070000,28210000,56660000,56670000        @ZA02953 43210003
*C20100000                                                     @ZA03232 43240003
*C274000,276500,515500-515700,517000,557600,557700             @ZA04126 43280003
*C153000                                                       @ZA06203 43320003
*D360000,458500-464000                                         @ZA05688 43330003
*A404510-404920,                                               @ZA05687 43360003
*A77200,448100-448200,496040-496300                            @ZA05687 43400003
*A476510-476940                                               @ZA06226  43440003
*A207340,218700,396100,396200,405700,553440 @ZA07138,@ZA09259,@ZA10462  43450003
*A078100-078200,516100-516420,513600,545600-545910            @ZA10530  43480003
*C078500,516600,531500,519500                                 @ZA10530  43520003
*A181100-181700                                               @ZA11325  43560003
*A395600-395900,416100-416400                                 @ZA11342  43570003
*A476537-476566                                               @ZA11359  43620003
*A767100,773100                                               @ZA17744  43620503
*A681700-681820,682900-683100,746500-746900,750300-750500     @ZA26084  43621003
*C683100,747000,753000,755100,756000-756300,756900,765000     @ZA26084  43621503
*C765900-766200,771300,771900-772500,776700,779100,           @ZA26084  43622003
*A782200-782300                                               @ZA26084  43622503
*A682502-682504,C682524                                       @ZA29216  43623003
*A715900,717400,719200,720700,844600,C772100                  @ZA31527  43623503
*********************************************************************** 43625003
*                                                                     * 43680003
* STATUS --                                                           * 43690003
*                                                                     * 43720003
*    CHANGE LEVEL 00, OS/VS2 RELEASE 2  , 07/06/73                    * 43760003
*                                                                     * 43800003
* FUNCTION --                                                         * 43820003
*                                                                     * 43860003
*    THIS SVC ROUTINE IS A TYPE 3 SVC USED BY TSO TEST FOR TWO        * 43880003
*    PURPOSES -- (1) TO PASS CONTROL FROM THE PROGRAM BEING TESTED    * 43920003
*    TO TSO TEST AT PREDETERMINED LOCATIONS, AND (2) TO MODIFY        * 43940003
*    SYSTEM CONTROL BLOCKS (TCB, RB, ETC.) FOR TSO TEST.  THIS SVC    * 43980003
*    ROUTINE IS DIVIDED INTO TWO LOGICAL PARTS, ONE WHICH PROCESSES   * 44000003
*    A BREAKPOINT AND THE OTHER WHICH ACTS AS A SERVICE ROUTINE       * 44040003
*    FOR TSO TEST.                                                    * 44060003
*                                                                     * 44100003
* ENTRY POINTS --                                                     * 44120003
*                                                                     * 44160003
*         IGC0009G -- ENTRY POINT OF THIS SVC ROUTINE.                * 44180003
*                                                                     * 44220003
* INPUT --                                                            * 44240003
*                                                                     * 44280003
*    BREAKPOINT PROCESSING -- N/A                                     * 44300003
*                                                                     * 44340003
*    SERVICE ROUTINE PROCESSING --  REGISTER 1 POINTS TO A THREE      * 44360003
*    WORD PARAMETER LIST OF THE FOLLOWING FORMAT --                   * 44400003
*                                                                     * 44420003
*              ......................................                 * 44440003
*              .                                    .                 * 44460003
*           +0 . ADDRESS OF A TCB, PRB OR IRB       .                 * 44480003
*              ......................................                 * 44500003
*              .                                    .                 * 44520003
*           +4 . VALUE, OR ADDRESS OF VALUE         .                 * 44540003
*              ......................................                 * 44560003
*              .        .        .                  .                 * 44580003
*           +8 . FLAGS1 . FLAGS2 . REGISTER NUMBER  .                 * 44600003
*              ......................................                 * 44620003
*                                                                     * 44750003
* OUTPUT --                                                           * 44770003
*                                                                     * 44800003
*    BREAKPOINT PROCESSING -- N/A                                     * 44850003
*                                                                     * 44860003
*    SERVICE ROUTINE PROCESSING -- REGISTER 15 ALWAYS CONTAINS        * 44910003
*    A RETRUN CODE.  RETURN CODES ARE --                              * 44920003
*                                                                     * 44950003
*        0 --  SUCCESSFUL COMPLETION (FOR ADDRESS VALIDITY            * 44990003
*              CHECKING, ADDRESS IS BOTH READABLE AND WRITEABLE).     * 45030003
*        4 --  AN ERROR OCCURRED (FOR ADDRESS VALIDITY CHECKING,      * 45040003
*              ADDRESS IS ONLY READABLE).                             * 45070003
*        8 --  FOR ADDRESS VALIDITY CHECKING ONLY, ADDRESS IS         * 45110003
*              INVALID.                                               * 45150003
*        16 --  ONLY WHEN IO IS INVOKED AND AN ATTN OCCURS.           * 45160003
*        20 --  ONLY WHEN AN ABEND HAS OCCURED AND MY RETRY ROUTINE   * 45190003
*               RECOVERED                                             * 45230003
*        24 --  ONLY WHEN THE SVC WAS UNABLE TO ISSUE AN ESTAE.       * 45270003
*                                                                     * 45280003
* EXTERNAL REFERENCES --                                              * 45310003
*                                                                     * 45350003
*         IEA0VL00 - RESIDENT ADDRESS VALIDITY CHECK ROUTINE.         * 45390003
*                                                                     * 45400003
*    MACROS USED --                                                   * 45430003
*                                                                     * 45470003
*         BRKELEM  - BREAKPOINT ELEMENT.                              * 45510003
*         CVT      - COMMUNICATIONS VECTOR TABLE MAPPING MACRO.       * 45520003
*         FREEMAIN - RETURN MEMORY TO OPERATING SYSTEM.               * 45550003
*         GETMAIN  - GET MEMORY FROM OPERATING SYSTEM.                * 45590003
*         IKJEGS9G - INPUT PARAMETER LIST MAPPING MACRO.              * 45630003
*         IKJRB    - REQUEST BLOCK MAPPING MACRO.                     * 45640003
*         IKJTCB   - TASK CONTROL BLOCK MAPPING MACRO.                * 45670003
*         MODESET  - ENABLE/DISABLE INTERRUPTS.                       * 45710003
*         POST     - INDICATE EVENT COMPLETE.                         * 45750003
*         TCOMTAB  - TEST COMMUNICATION TABLE MAPPING MACRO.          * 45760003
*         WAIT     - WAIT ON EVENT TO COMPLETE.                       * 45790003
*                                                                     * 45830003
* EXITS, NORMAL  --                                                   * 45870003
*                                                                     * 45880003
*    FOR BOTH THE BREAKPOINT FUNCTION AND THE SERVICE ROUTINE         * 45910003
*    FUNCTION, RETURN IS MADE BY A BRANCH REGISTER ON REGISTER 14.    * 45950003
*                                                                     * 45990003
* EXITS, ERROR --                                                     * 46000003
*                                                                     * 46030003
*    FOR BOTH THE BREAKPOINT FUNCTION AND THE SERVICE ROUTINE         * 46070003
*    FUNCTION, RETURN IS MADE BY A BRANCH REGISTER ON REGISTER 14.    * 46110003
*                                                                     * 46120003
* TABLES/WORK AREAS --                                                * 46150003
*                                                                     * 46190003
*    THE FOLLOWING FIELDS IN THE TCB ARE UPDATED --                   * 46230003
*              TCBABF (TCBTCP)                                        * 46240003
*              TCBTRNB                                                * 46270003
*              TCBTSFLG (TCBATT)                                      * 46310003
*              TCBFRS                                                 * 46350003
*    THE FOLLOWING FIELDS IN THE USER'S PROGRAM PRB ARE UPDATED --    * 46360003
*              RBOPSW (RESUME ADDRESS PORTION ONLY)                   * 46390003
*              RBWCF                                                  * 46430003
*    THE FOLLOWING FIELDS IN SVC 97'S SVRB ARE UPDATED --             * 46470003
*              RBGRSAVE                                               * 46480003
*    THE FOLLOWING FIELDS IN TCOMTAB ARE UPDATED --                   * 46510003
*              TSTMTASK                                               * 46550003
*              TSTSVCQ                                                * 46590003
*              PPTCB                                                  * 46600003
*              ECBPP                                                  * 46630003
*    THE FOLLOWING FIELDS IN THE BRKELEM ARE UPDATED --               * 46670003
*              BRKCOUNT                                               * 46710003
*              BRKRB                                                  * 46720003
*                                                                     * 46750003
* ATTRIBUTES --                                                       * 46790003
*                                                                     * 46830003
*    PRIVILEGED, ENABLED, REENTRANT, REFRESHABLE                      * 46840003
*                                                                     * 46870003
* CHARACTER CODE DEPENDENCY --                                        * 46910003
*                                                                     * 46950003
*    THIS ROUTINE IS CHARACTER CODE INDEPENDENT.                      * 46960003
*                                                                     * 46990003
* NOTES --                                                            * 47030003
*                                                                     * 47070003
*    THIS SVC IS BROKEN INTO TWO PARTS --                             * 47080003
*    (1) THE BREAKPOINT FUNCTION STARTS AT LABEL 'IGC0009G'           * 47110003
*    (2) THE TEST SERVICE FUNCTION STARTS AT LABEL 'TSTSVC01'         * 47150003
*                                                                       47190003
* CHANGE-ACTIVITY -                                                     47200003
*                 APAR OZ07138 - CHANGES TO PROVIDE MNL A POINTER       47230003
*                 TO THE POSTING SVRB. ECBPP+1 IS THE POINTER.          47270003
*                 IT IS IN TCOMTAB AND SERIALIZED AT THE TASK LEVEL     47310003
*                 VIA ENQ. ANY PRIOR SVRB POINTER IS SAVED IN THE       47320003
*                 SVRB WORKAREA AT WRKSVRBS AND RESTORED BEFORE         47350003
*                 THE DEQ AND RETURN.                                   47390003
*                 APAR OZ09259 - SAME AS ABOVE.                         47430003
*                 APAR OZ10462 - SAME AS ABOVE.                         47440003
*                 APAR OZ10530 - REWORKED ESTAE/RETRY ROUTINES TO       47470003
*                 ADHERE TO SPECIFIED REGISTER CONVENTIONS              47510003
*                 APAR OZ11342 - ADDED VALIDITY CHECKING OF S9GREGNO    47550003
*                 TO DEFEND AGAINST THE ''MALICIOUS'' USER              47560003
*                 APAR OZ11359 - ADDED FUNCTION TO CLEANUP ROUTINE      47590003
*                 WHICH FREEMAINS SP255 STG. IT ALSO WILL ZERO          47630003
*                 TCBTRN FOR ALL TCB'S IN TMP/TEST'S FAMILY.            47670003
*                 APAR OZ17744 - CHANGES TO PREVENT FIRST LENGTH FIELD  47680003
*                 OF FREEMAIN LIST TO BE OVERLAID BY ADDRESS OF THE   * 47710003
*                 126 TH SVB OR SVQ.                                    47720003
*********************************************************************** 47750003
         EJECT                                                          47790003
*********************************************************************** 47800003
*                                                                     * 47830003
*        GENERAL PURPOSE REGISTER EQUATES.                            * 47870003
*                                                                     * 47910003
*********************************************************************** 47920003
         SPACE 2                                                        47950003
R0       EQU   0                                                        47990003
R1       EQU   1                                                        48030003
R2       EQU   2                                                        48040003
R3       EQU   3                                                        48070003
R4       EQU   4                                                        48110003
R5       EQU   5                                                        48150003
R6       EQU   6                                                        48160003
R7       EQU   7                                                        48190003
R8       EQU   8                                                        48230003
R9       EQU   9                                                        48270003
R10      EQU   10                                                       48280003
R11      EQU   11                                                       48310003
R12      EQU   12                                                       48350003
R13      EQU   13                                                       48390003
R14      EQU   14                                                       48400003
R15      EQU   15                                                       48430003
N63      EQU   63          DECIMAL CONSTANT                   @ZA05687  48470003
ONEK     EQU   1000        DECIMAL CONSTANT FOR GETMAIN      @ZA06226   48510003
SVQLEN   EQU   12          LENGTH OF IKJEGSVQ CONT BLK       @ZA06226   48520003
SVBLEN   EQU   36          LENGTH OF IKJEGSVB CONT BLK       @ZA06226   48550003
N500     EQU   500         INDEX VALUE                       @ZA06226   48590003
N4       EQU   4           OFFSET VALUE                      @ZA06226   48630003
N0       EQU   0           OFFSET VALUE                      @ZA06226   48640003
         EJECT                                                          48670003
         BALR  R12,R0         ESTABLISH ADDRESSABILITY FOR THIS         48710003
         BCTR  R12,R0         BASE AND ENTRY POINT MUST      @ZA10530   48750003
         BCTR  R12,R0         COINCIDE FOR ESTAE/RETRY RTNS  @ZA10530   48760003
         USING IGC0009G,R12   SVC ROUTINE                    @ZA10530   48790003
         SPACE 2                                                        48830003
         USING TCB,R4         ESTABLISH ADDRESSABILITY TO TCB.          48870003
         USING RBSECT,R5      ESTABLISH ADDRESSABILITY TO SVRB.         48880003
         USING PSA,R0         ESTABLISH ADDRESSABILITY TO PSA           48910003
         SPACE                                                          48950003
*********************************************************************** 48990003
*        ISSUE A GETMAIN FOR LATER USE AS A REGISTER SAVE AREA          49000003
*********************************************************************** 49030003
         SPACE                                                          49070003
         LR    R9,R14         SAVE REGISTER 14 FOR RETURN               49110003
         LA    R0,WRKLEN      R0= THE  LENGTH FOR THE GETMAIN           49120003
         L     R7,PSAAOLD     R7= ADDR OF THE ASCB                      49150003
         LR    R8,R1          PRESERVE REG 1                            49190003
         GETMAIN RU,LV=(0),BRANCH=YES  ISSUE GETMAIN REGISTER SAVEAREA  49230003
         LR    R3,R1          R3= ADDR'ABILITY TO WORKAREA              49240003
         USING S9GWORKA,R3    ESTABLISH ADDR'ABILITY TO WORKAREA        49270003
         XC    WRKSTART(WRKLEN),WRKSTART  CLEAR WORKAREA                49310003
         ST    R9,WRKREGRT    SAVE R14 ADDRESS                          49350003
         MVC   S9GSPL(S9GSPLEN),S9GSPLST INIT PARMS FOR ESTAE  @ZA10530 49360003
         SPACE                                                          49390003
*********************************************************************** 49430003
*        ISSUE AN ESTAE FOR ABEND RECOVERY                              49470003
*********************************************************************** 49480003
         SPACE                                                          49510003
         ESTAE S9GESTAE,CT,PARAM=S9GSPL,XCTL=NO,BRANCH=YES,            *49550003
               SVEAREA=WRKREGSV,MF=(E,WRKESTAE)                         49590003
         LTR   R15,R15        WAS THE ESTAE OK..                        49600003
         BNZ   ESTAFAIL       NO IT FAILED....                          49630003
         LR    R1,R8          SAVE PARM R1.                             49670003
         OI    TCBTSFLG,TCBATT  DEFER ALLN WHILE THE SVC IS IN CONTROL. 49710003
         SPACE 2                                                        49720003
*********************************************************************** 49750003
*                                                                     * 49790003
*        CHECK THE TEST FLAG TO SEE IF THIS TASK IS UNDER TEST.       * 49830003
*                                                                     * 49840003
*********************************************************************** 49870003
         SPACE                                                          49910003
         SPACE                                                          49950003
         ST    R4,WRKSVTCB    SAVE THE ADDR OF CALLERS TCB              49960003
         TM    TCBABF,TCBTCP  DETERMINE IF THIS TASK UNDER TEST.        49990003
         BZ    TSTSVC01       IF NOT, EXECUTE A TEST SERVICE.           50030003
*                             IF SO, PROCESS BREAKPOINT.                50070003
         SPACE 2                                                        50080003
*********************************************************************** 50110003
*                                                                     * 50150003
*        THIS SECTION, DOWN TO THE LABEL 'TSTSVC01', IS THE LOGIC     * 50190003
*        FOR THE SVC ACTING AS A BREAKPOINT SVC.                      * 50200003
*                                                                     * 50230003
*        TCBTRN FIELD OF TCB CONTAINS ADDRESS OF TCOMTAB.             * 50270003
*                                                                     * 50310003
*       FIRST WE CHECK THE VALIDITY OF THE CALLER.                    * 50320003
*                                                                     * 50350003
*********************************************************************** 50390003
         SPACE 2                                                        50430003
         SPACE                                                          50440003
         L     R13,HIGHBYTE   MASK TO CLEAR HIGH ORDER BYTE.            50470003
         L     R7,TCBTRN      ADDRESS OF TCOMTAB.                       50510003
         BAL   R11,KEYCK      VALIDITY CHECK STORAGE KEYS.              50550003
         L     R7,ECBTST-TCOMTAB(,R7) ADDRESS OF STORAGE BLOCK          50560003
*                             TO BE CHECKED.                            50590003
         BAL   R11,KEYCK      VALIDITY CHECK STORAGE KEYS.              50630003
         L     R9,TCBTRN      BASE FOR TCOMTAB.                         50670003
         USING TCOMTAB,R9     ESTABLISH ADDRESSABILITY TO TCOMTAB.      50680003
         SPACE                                                          50710003
         BAL   R11,CHKPPRB    CHECK THE VALIDITY OF THE CALLERS RB.     50750003
         SPACE                                                          50790003
         L     R11,RBLINK      R11=PRB ADDR,PP IN WHICH BREAK OCCURRED. 50800003
         L     R8,RBOPSW+X4-RBSECT(R11) R8=RESUME ADDR OF PP.           50830003
         NR    R8,R13         CLEAR HIGH BYTE.                          50870003
         BCTR  R8,X0          R8=RESUME ADDR-2                          50910003
         BCTR  R8,X0          *                                         50920003
         LA    R10,RETURN1    R14 ADDRESS IN R10.                       50950003
QPSEUDO  EQU   *              Q. IS IT A PSEUDO BREAKPOINT              50990003
         LA    R1,TSTSVC      NORMAL PSEUDO BREAK CHECK.                51030003
         CR    R1,R8          Q. IS IT A MATCH.                         51040003
         BE    PSEUDO         YES IT IS.                                51070003
         LA    R1,PPEXIT      BR RETURN PSEUDO BREAKPOINT.              51110003
         CR    R1,R8          Q. IS IT A MATCH.                         51150003
         BE    TSTPOST        YES IT IS.                                51160003
         TM    TSTFLGS3,TSTGOSW   Q.IS THIS A SPECIAL BREAKPT.          51190003
         BO    TSTPOST        YES.  POST 'TEST'.                        51230003
         L     R0,BREAKTAB    HEAD OF THE BREAK ELEMENT QUEUE.          51270003
         SPACE 2                                                        51280003
BRKSRCH  EQU   *              BREAK ELEMENT SEARCH.                     51310003
         LTR   R7,R0          MOVE AND TEST FOR LAST.                   51350003
         USING BRKELEM,R7     BREAK ELEMENT ADDRESSABILITY.             51390003
         BCR   Z,R10          NO MORE. GO TO RETURN1.                   51400003
         LA    R6,BRKINST+X6  IF IC MATCHES THIS REPOINT IC & RTRN.     51430003
         CLR   R6,R8          Q. IS IT A MATCH.                         51470003
         BE    BRKRTURN       YES IT IS.  BRANCH.                       51510003
         C     R8,BRKADDR     IF IC MATCHES,A BREAKPT HAS BEEN HIT.     51520003
         L     R0,BRKLINK     GET THE NEXT, MAYBE.                      51550003
         BNE   BRKSRCH        NO MATCH. CHECK NEXT.                     51590003
         SPACE 2                                                        51630003
COUNT    EQU   *              CHECK THE BREAK COUNT.                    51640003
         LH    R8,BRKCOUNT    Q. IS ACCUMULATOR ZERO.                   51670003
         LTR   R8,R8          *                                         51710003
         ST    R11,BRKRB       PRB(IRB) ADDRESS TO BREAK ELEMENT.       51750003
         BNZ   DECREM         NO.DECREMENT AND ALLOW CONTINUATION       51760003
         MVC   BRKCOUNT(X2),BRKCOUNT+X2 YES,RESET ACCUMULATOR.          51790003
         B     TSTPOST        AND POST TEST,WAIT.                       51830003
         SPACE 2                                                        51870003
DECREM   EQU   *                                                        51880003
         BCTR  R8,X0          MINUS ONE.                                51910003
         STH   R8,BRKCOUNT    CONTENTS BACK TO ACCUMULATOR.             51950003
         SPACE 2                                                        51990003
*********************************************************************** 52000003
*                                                                     * 52030003
*        THIS SECTION CAUSES THE EXECUTION OF THE PROBLEM PROGRAM     * 52070003
*        TO RESUME BY POINTING THE RESUME PSW AT THE OVERLAID IN-     * 52110003
*        STRUCTION IN THE BREAK ELEMENT.IF THE INSTRUCTION IS BAL     * 52120003
*        OR BALR THE LINK REGISTER CONTENTS ARE SET IN THE SVRB       * 52150003
*        SAVE AREA.                                                   * 52190003
*                                                                     * 52230003
*********************************************************************** 52240003
         SPACE 2                                                        52270003
         LA    R0,BRKINST     SAVED INSTRUCTION ADDRESS                 52310003
         TM    BRKFLGS,BALSW  Q.WAS ORIGINAL INSTR. BAL OR BALR.        52350003
         BZ    SETIC          SET IC IN RESUME PSW AND RETURN TO PP     52360003
         SPACE 2                                                        52390003
BALBALR  EQU   *              SPECIAL CODE FOR BAL AND BALR             52430003
         SR    R0,R0          R0=ZERO                                   52470003
         TM    BRKINST,XC0    Q.DOES INSTRUCTION LENGTH EQUAL TWO.      52480003
         BZ    BALR           A.YES. HAS TO BE BALR.                    52510003
         SPACE 2                                                        52550003
BAL      EQU   *              A.NO. HAS TO BE BAL.                      52590003
         L     R0,BRKINST     R0=THE BREAK INSTRUCTION                  52600003
         LR    R1,R0          R1=THE BREAK INSTRUCTION                  52630003
         N     R0,DISPMASK    R0=DISPLACEMENT                           52670003
         N     R1,BASEMASK    R1=BASE REGISTER                          52710003
         SRL   R1,N10         BASE REGISTER NUMBER X 4                  52720003
         BZ    BALR           REG 0 IS IGNORED AS A BASE REG.           52750003
         AL    R0,RBGRSAVE(R1)  ADD BASE REGISTER ADDR. TO DISPL.       52790003
         SPACE 2                                                        52830003
BALR     EQU   *              *                                         52840003
         L     R1,BRKINST     R1=ACTUAL BREAK INSTRUCTION               52870003
         N     R1,INDXMASK    R1=INDEX REGISTER OF BREAK INSTR.         52910003
         SRL   R1,N14         (INDEX REG X 4)                           52950003
         BZ    LINKREG        REG 0 IS IGNORED AS AN INDEX REG          52960003
         AL    R0,RBGRSAVE(R1) ADD INDEX REG TO TOTAL.                  52990003
         SPACE 2                                                        53030003
LINKREG  EQU   *              SETUP THE LINK REGISTER.                  53070003
         NR    R0,R13         CLEAR THE HIGH BYTE.                      53080003
         LA    R8,X2          BALR INSTRUCTION LENGTH.                  53110003
         TM    BRKINST,XC0    Q.IS THIS A BALR                          53150003
         BZ    LINKBALR       YES, THIS IS A BALR                       53190003
         SPACE 2                                                        53200003
LINKBAL  EQU   *              *                                         53230003
         AR    R8,R8          BAL INSTRUCTION LENGTH.                   53270003
         L     R11,RBLINK     R11= ADDR OF P. P. RB            @ZA06203 53310003
         LA    R6,RBSECT-RBPREFIX LENGTH OF RB PREFIX.                  53320003
         SR    R11,R6          POINT TO PREFIX.                         53350003
         MVI   RBINLNTH-RBPREFIX(R11),X04 SET INSTRUCTION LENGTH TO 4.  53390003
         AR    R11,R6          POINT TO STANDARD SECTION.               53430003
         SPACE 2                                                        53440003
LINKBALR EQU   *              *                                         53470003
         MVC   RBOPSW+X5-RBSECT(X3,R11),BRKADDR+X1 APPEND TO ILC/CC/    53510003
*                             PROGMASK                                  53550003
         AL    R8,RBOPSW+X4-RBSECT(R11) VALUE FOR THE LINK REGISTER.    53560003
         L     R6,BRKINST     ACTUAL BREAK INSTRUCTIONN                 53590003
         N     R6,LINKMASK    LINK REGISTER NUMBER                      53630003
         ICM   R8,HIBYTE,X80  SET FLAG FOR BAL IN LINK REG              53670003
*                                                             @ZA02953  53680003
         SRL   R6,N18         (LINK REG NUMBER X 4)                     53710003
         ST    R8,RBGRSAVE(R6) STORE LINK REG CONTENTS IN SAVEAREA.     53750003
         TM    BRKINST,XC0    IS THIS A BALR Q.Q.Q.                     53790003
         BNZ   SETIC          NO.                                       53800003
         ICM   R8,HIBYTE,X40  SET FLAG IN LINK REG FOR BALR  @ZA02953   53830003
         ST    R8,RBGRSAVE(R6) STORE LINK REG                @ZA02953   53870003
         TM    BRKINST+X1,X0F IS IT A BALR Q.Q.Q.                       53910003
         BNZ   SETIC          NO.SET THE IC                             53920003
         LR    R0,R8          SETIC WITH LINK ADDRESS.                  53950003
         SPACE 2                                                        53990003
SETIC    EQU   *              SET IC IN RESUME PSW                      54030003
         LR    R1,R0          RESUME ADDRESS.                           54040003
         LA    R1,X0(,R1)     SET HIGH ORDER BYTE TO ZERO.              54070003
         ST    R1,RBOPSW-RBSECT+X4(,R11) RESET PSW IN RB.               54110003
         BR    R10            GO TO RETURN1                             54150003
         SPACE 2                                                        54160003
BRKRTURN EQU   *                                                        54190003
         SH    R8,BACKUP2     R8=BREAK ELEMENT POINTER.                 54230003
         TM    BRKINST-BRKELEM(R8),XC0  TEST FOR BREAK INSTR LENGTH.    54270003
         LA    R6,X6          INSTRUCTION LENGTH OF SIX.                54280003
         BO    OUT            YES IT'S SIX.                             54310003
         LA    R6,X2          INSTRUCTION LENGTH OF TWO.                54350003
         BZ    OUT            YES IT'S TWO                              54390003
         AR    R6,R6          INSTRUCTION LENGTH OF FOUR.               54410003
*                             IT'S FOUR.                                54430003
         SPACE 2                                                        54470003
OUT      EQU   *                                                        54510003
         L     R0,BRKADDR-BRKELEM(R8)  ADDR OF ORIG BRKPOINT.           54520003
         AR    R0,R6          PLUS CLOBBERED INSTR.LENGTH.              54550003
         NR    R0,R13         CLEAR HIGH BYTE.                          54590003
         B     SETIC          GO BACK TO PROBLEM PROGRAM.               54630003
         SPACE 2                                                        54640003
*********************************************************************** 54670003
*                                                                     * 54710003
*        RESTORE THE WAIT COUNT FIELD FOR A PSEUDO BREAKPOINT.        * 54750003
*                                                                     * 54760003
*********************************************************************** 54790003
         SPACE 2                                                        54830003
PSEUDO   EQU   *              IT'S A PSEUDO BREAK.                      54870003
         MVC   RBWCF-RBSECT(X1,R11),TSTGOWCF  DITTO.                    54880003
         TM    TSTFLGS3,TSTSTAI  IS THIS A STAI RETRY.                  54910003
         BZ    TSTPOST        NO.                                       54950003
         OI    WRKFLGS1,WRKPSEUD  INDICATE NO ENQ WANTED    @ZA07137    54990003
         LM    R0,R1,RBGRSAVE GET R0 AND R1 PASSED.                     55000003
         LTR   R0,R0          WAS SDWA PASSED ? Q.Q.Q.                  55030003
         BNZ   PSEUDO1        NO. SKIP FREEMAIN.                        55070003
         STM   R4,R2,WRKREGSV SAVE THE REGISTERS ACROSS FREE            55110003
         L     R0,SDWAIDNT-SDWA(,R1)  GET SPID + LEN OF SDWA  @ZA11325  55120003
         TM    SDWASPID-SDWA(R1),XFF  CHECK SUBPOOL OF SDWA   @ZA11325  55150003
         BNZ   FREESDWA       NOT ZERO USE CORRECT VALUE      @ZA11325  55190003
         O     R0,FOLDZERO    SPID = 0 FOLD TO 250            @ZA11325  55230003
FREESDWA EQU   *                                                        55240003
         L     R7,PSAAOLD     R7= ADDR OF THE ASCB.                     55270003
         FREEMAIN  R,LV=(0),A=(1),BRANCH=YES FREE S.D.W.A.              55310003
         LM    R4,R2,WRKREGSV RESTORE THE REGISTERS                     55350003
         SPACE 2                                                        55360003
PSEUDO1  EQU   *                                                        55390003
         L     R1,REGSAVE2    REGSAVE2 POINTER.                         55430003
         MVC   RBGRSAVE(N64),X0(R1)    RESTORE THE ABENDED REGS.        55470003
         SPACE 2                                                        55480003
TSTPOST  EQU   *                                                        55510003
         L     R1,RBOPSW+X4-RBSECT(R11)  DECREMENT THE IC BY TWO.       55550003
         BCTR  R1,X0          *                                         55590003
         BCTR  R1,X0          *                                         55600003
         ST    R1,RBOPSW+X4-RBSECT(R11)  CHANGE THE IC.                 55630003
GO       EQU   *              POST/WAIT                                 55670003
         TM    TCBTRN,TCBTCP  HAS THE TEST BIT BEEN TURNED OFF.         55710003
         BCR   Z,R10          YES RETURN                                55720003
         NR    R4,R13         CLEAR HIGH BYTE OF CALLERS TCB.           55750003
         NR    R5,R13         CLEAR HIGH BYTE.                          55790003
         LA    R6,ECBPP       R6=PP ECB ADDR.                           55830003
         SPACE                                                          55840003
*********************************************************************** 55870003
*        DO THE FOLLOWING;                                              55910003
*        1) FREE THE LOCAL LOCK, 2) ENQUE ON THE TEST ECB 'IKJTMPNM'    55950003
*           IS QNAME,USERID IS RNAME.                                   55960003
*        3) ENABLE FOR ATTN'S, 4)WAIT ON MNL.                           55990003
*********************************************************************** 56030003
         SPACE                                                          56070003
S9GLOCKA EQU   *                                                        56080003
         ST    R11,R11SAVE    SAVE R11 AROUND BAL              @ZA00889 56110003
         BAL   R11,LOCKRELE   RELEASE THE LOCAL LOCK                    56150003
         L     R11,R11SAVE    RESTORE R11                      @ZA00889 56190003
S9GLOCKB EQU   *                                                        56200003
         NR    R5,R13         CLEAR HIGH BYTE OF MY SVRB ADDR.          56230003
         TM    TSTFLGS2,TSTQUAL  IS QUALIFICATION IN PROCESS            56270003
         BO    NOENQ          DO NOT ENQ ON THE ELEMENT                 56310003
         XC    WRKENQWK(L'WRKENQWK),WRKENQWK ZERO FLAG SECTION          56320003
         MVC   WRKENQ(L'SVCNQ),SVCNQ MOVE IN THE ENQ WORD               56350003
         LA    R2,WRKENQ      R2= ADDR OF THE ENQ ELEMENT               56390003
         L     R6,CVTPTR      GET ADDR OF CVT           @ZA07137        56430003
         L     R6,CVTTCBP-CVT(R6) GET ADDR OF TCB WORDS @ZA07137        56440003
         L     R6,X0(R6)      GET ADDR OF CURRENT TCB   @ZA07137        56470003
         L     R6,TCBJSCB-TCB(R6) GET ADDR OF JSCB      @ZA07137        56510003
         L     R6,JSCBPSCB-IEZJSCB(R6)   PSCB ADDR IN R6@ZA07137        56550003
         USING PSCB,R6        SET ADDRESSABILITY TO PSCB@ZA07137        56560003
         MVC   WRKNQRNM(7),PSCBUSER GET USID FOR RNAME  @ZA07137        56590003
         MVI   WRKNQRNM+7,C' ' CLEAR LAST RNAME BYTE    @ZA07137        56630003
         DROP  R6             DONE WITH PSCB            @ZA07137        56670003
         L     R6,TPLPTR      GET TPL ADDRESS           @ZA07137        56680003
         L     R6,TPLECT-TPL(R6) GET ECT ADDR FROM TPL  @ZA07137        56710003
         TM    ECTSWS2-ECT(R6),ECTTABND   Q - NEED ENQ  @ZA07137        56750003
         BNO   S9GDOENQ                  YES - GOTO ENQ @ZA07137        56790003
         TM    WRKFLGS1,WRKPSEUD       SEE IF PSEUDO BP @ZA07137        56800003
         BO    NOENQ                   YES, SKIP ENQ    @ZA07137        56830003
S9GDOENQ LA    R6,WRKNQRNM    POINT TO ENQ'S RNAME      @ZA07137        56870003
         MVC   WRKENQWK(LISTENQE),LISTENQF  CLEAR THE ENQ ELEMENT       56910003
         ST    R5,WRKECB      PLACE MY SVRB ADDR IN ECB        @ZA03232 56920003
         ENQ   ((2),(6),E,8),ECB=WRKECB,MF=(E,WRKENQWK)  ENQ ON ECBTST  56950003
         NI    TCBTSFLG,XFF-TCBATT  DO NOT DEFER INTERRUPTS             56990003
         LTR   R15,R15        IS THE RETURN CODE ZERO          @YM07115 57030003
         BZ    NOENQ          YES CONTINUE                     @YM07115 57040003
         SR    R1,R1          CLEAR R1                         @YM07115 57070003
         IC    R1,X3(R15)     OBTAIN THE RETURN CODE           @YM07115 57110003
         LA    R2,X4          R2= X4 FOR COMPARE               @YM07115 57150003
         CR    R1,R2          WAS THE RETURN CODE A 4          @YM07115 57160003
         BNE   NOENQ          NO THEREFORE CONTINUE            @YM07115 57190003
         LA    R1,WRKECB      R1= ADDR OF THE ECB              @YM07115 57230003
         WAIT  ECB=(1)        WAIT ON THE ECB                  @YM07115 57270003
NOENQ    DS    0H             CONTINUE BY POSTING MNL                   57280003
         TM    WRKFLGS1,WRKPSEUD  WAS ECT BIT FOR ME@ZA07137            57310003
         BZ    NORESET            NO-LEAVE IT ALONE     @ZA07137        57350003
         L     R6,TPLPTR      GET TPL ADDRESS                @ZA07137   57390003
         L     R6,TPLECT-TPL(R6)  GET ECT ADDR FROM TPL      @ZA07137   57400003
         NI    ECTSWS2-ECT(R6),XFF-ECTTABND    RESET NO ENQ @ZA07137    57430003
NORESET  EQU   *                                            @ZA07137    57470003
         NI    TCBTSFLG,XFF-TCBATT  DO NOT DEFER INTERRUPTS             57510003
         NR    R4,R13         CLEAR HIGH BYTE OF CALLERS TCB.           57520003
         ST    R4,PPTCB       PPTCB=THIS TCB.                           57550003
         NR    R5,R13         CLEAR HIGH BYTE.                          57590003
         LA    R6,ECBPP       R6=PP ECB ADDR.                           57630003
         MVC   WRKSVRBS(3),ECBPP+1 SAVE PRIOR SVRB POINTER     @ZA07138 57640003
*                                                              @ZA09259 57670003
*                                                              @ZA10462 57710003
         ST    R5,X0(R6)      PUT SVRB ADDR INTO ECBPP.                 57750003
         NI    TSTFLGS2,XFF-TSTQUAL TURN OFF QUAL IN PROCESS            57760003
         L     R1,ECBTST      TEST ECB ADDRESS.                         57790003
         LA    R1,X0(,R1)     ZERO HIGH ORDER BYTE                      57830003
*        OI    TSTFLGS2,TOFFDEF  THIS FLAG IS USED TO TELL     @YM07115 57870003
*                             DO NOT SET FLAG PER APAR         @ZM00874 57880003
         POST  (1)            POST TEST ECB COMPLETE.                   57910003
         C     R5,X0(R6)      HAVE WE BEEN POSTED                       57950003
         BNE   NOWAIT         DONT GO INTO WAIT BYTE CLEARED            57990003
         WAIT  ECB=(6)        WAIT ON PP ECB.                           58000003
         SPACE 2                                                        58030003
NOWAIT   EQU   *                                                        58070003
         NI    TSTFLGS2,XFF-TOFFDEF TURN OFF SYNCH FLAG        @YM07115 58110003
         OI    TCBTSFLG,TCBATT  DEFER ATTNS.                            58120003
         STM   R4,R2,WRKREGSV SAVE THE REGS ACCROSS THE LOCK            58150003
S9GLOCK2 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=(LOCAL,         *58190003
               IGC0009G(S9GLOCK2))  OBTAIN THE LOCAL LOCK               58230003
         LM    R4,R2,WRKREGSV RESTORE THE REGISTERS.                    58240003
         MVC   ECBPP+1(3),WRKSVRBS RESTORE OLD 97 RBPTR        @ZA07138 58270003
*                                                              @ZA09259 58310003
*                                                              @ZA10462 58350003
         L     R1,RBOPSW-RBSECT+X4(,R11) GET SECOND WORD OF PSW         58360003
         NR    R1,R13         CLEAR HIGH BYTE.                          58390003
         SH    R1,BACKUP1     BACKUP TO BREAK ELEMENT.                  58430003
         L     R0,BREAKTAB    GET THE FIRST ELEMENT,IF ONE.             58470003
         SPACE 2                                                        58480003
BRKSRCH1 EQU   *              CHECK IF IC POINTS TO BREAK INSTRUCTION.  58510003
*                             IF SO,CHECK AND SEE IF BRKINST IS         58550003
*                             A BAL OR BALR.                            58590003
*                             IF EITHER,TREAT IT SPECIAL.               58600003
*                             IF NOT, GO TO RETRUN1.                    58630003
         LTR   R7,R0          MOVE AND TEST FOR LAST.                   58670003
         BCR   Z,R10          IT'S THE LAST. GO TO RETURN               58710003
         CR    R1,R7          Q.DOES THE IC - 4 = A BREAK ELEMENT.      58720003
         L     R0,BRKLINK     GET THE NEXT ELEMENT ,IF ONE.             58750003
         BNE   BRKSRCH1       NO. LOOP.                                 58790003
         SPACE 2                                                        58830003
FOUND1   EQU   *              GOT A MATCH.                              58840003
         TM    BRKFLGS,BALSW  IS THIS A BAL OR BALR Q.Q.                58870003
         BO    BALBALR        YES. IT IS ONE OF THESE.                  58910003
*                             GO TO SPECIAL PROCESSING OF BAL/BALR.     58950003
         SPACE 1                                                        58960003
*********************************************************************** 58990003
*        RETURN TO THE CALLER; FREE THE LOCK AND RELEASE THE ENQUE      59030003
*********************************************************************** 59070003
         SPACE 1                                                        59080003
RETURN1  EQU   *              *                                         59110003
         BAL   R11,LOCKRELE   RELEASE THE LOCAL LOCK                    59150003
         SPACE                                                          59190003
************************************************************** @YM00583 59200003
*        THE FOLLOWING BRANCH IS TO SEE IF RUN WAS THE LAST    @YM00583 59230003
*        COMMAND ENTERED. IF SO A DIFFERNET EXIT MUST BE TAKEN @YM00583 59270003
************************************************************** @YM00583 59310003
         SPACE                                                          59320003
         TM    TSTFLGS1,RUNSW WAS RUN ENTERED                  @YM00583 59350003
         BO    RUNEXIT        YES THEREFORE USE ALTERNATE EXIT @YM00583 59390003
         SPACE                                                          59430003
         LA    R6,WRKENQ      R6= ADDR OF THE ENQ ELEMENT               59440003
         LA    R2,WRKNQRNM   R2= ADDR OF RNAME FOR DEQ   @ZA07137       59470003
         MVC   WRKENQWK(LISTDEQE),LISTDEQF  CLEAR THE DEQ ELEMENT       59510003
         DEQ   ((6),(2),8),RET=HAVE,MF=(E,WRKENQWK)  DEQ ON ECBTST WORD 59550003
         LA    R0,WRKLEN      R0=LENGTH OF AREA TO FREED                59560003
         L     R2,WRKREGRT    R2= R14 ADDRESS                           59590003
         FREEMAIN R,LV=(0),A=(3) ISSUE FREEMAIN OF WORKAREA             59630003
         ESTAE 0              CLEAR THE ESTAE                           59670003
         NI    TSTFLGS4,XFF-TSTRERTN  TURN OFF ABEND SW                 59680003
         NI    TCBTSFLG,XFF-TCBATT  DO NOT DEFER INTERRUPTS             59710003
         LR    R14,R2         R14= ADDR OF RETURN                       59750003
         L     R15,RBGRS15    RESTORE R15 TO ORIGINAL VALUE             59790003
         LM    R0,R13,RBGRSAVE    RESTORE ALL REGS.                     59800003
         BR    R14            RETURN.                                   59830003
         EJECT                                                          59870003
************************************************************** @YM00583 59910003
*        THE FOLLOWING CODE IS ONLY FOR THE CONDITION WHEN RUN @YM00583 59920003
*        WAS ENTERED AS A SUBCOMMAND. IKJEGMNL IS WAITING ON US@YM00583 59950003
*        TO COMPLETE OUR USE OF TCOMTAB, NOW THAT WE ARE DONE  @YM00583 59990003
*        WITH TCOMTAB WE POST IKJEGMNL SO IKJEGMNL WILL FREE IT@YM00583 60030003
*        AND RETURN TO TMP. THE ESTAE IS REMOVED BEFORE THE POS@YM00583 60040003
*        AND THEREFORE AN ALTERNATE EXIT IS USED.              @YM00583 60070003
************************************************************** @YM00583 60110003
         SPACE                                                          60150003
RUNEXIT  EQU   *              RUN COMMAND EXIT                 @YM00583 60160003
         ESTAE 0              CLEAR THE ESTAE                  @YM00583 60190003
         NI    TSTFLGS4,XFF-TSTRERTN  TURN OFF ABEND SW        @YM00583 60230003
         L     R1,ECBTST      TEST ECB ADDRESS.                @YM00583 60270003
         POST  (1)            POST TEST ECB COMPLETE.          @YM00583 60280003
         SPACE                                                          60310003
         LA    R6,WRKENQ      R6= ADDR OF THE ENQ ELEMENT      @YM00583 60350003
        LA    R2,WRKNQRNM    R2= ADDR OF RNAME FOR DEQ      @ZA07137    60390003
         MVC   WRKENQWK(LISTDEQE),LISTDEQF  CLEAR THE DEQ ELEME@YM00583 60400003
         DEQ   ((6),(2),8),RET=HAVE,MF=(E,WRKENQWK)  DEQ ON    @YM00583 60430003
         LA    R0,WRKLEN      R0=LENGTH OF AREA TO FREED       @YM00583 60470003
         L     R2,WRKREGRT    R2= RETURN ADDRESS               @YM00583 60510003
         FREEMAIN R,LV=(0),A=(3) ISSUE FREEMAIN OF WORKAREA    @YM00583 60520003
         NI    TCBTSFLG,XFF-TCBATT  DO NOT DEFER INTERRUPTS    @YM0058  60550003
         LR    R14,R2         R14= ADDR OF RETURN              @YM00583 60590003
         L     R15,RBGRS15    RESTORE R15 TO ORIGINAL VALUE    @YM00583 60630003
         LM    R0,R13,RBGRSAVE    RESTORE ALL REGS.            @YM00583 60640003
         BR    R14            RETURN.                          @YM00583 60670003
         EJECT                                                          60710003
KEYCK    EQU   *                                                        60750003
         LR    R1,R7          R1= ADDR TO BE CHECKED.                   60760003
         L     R8,FLCCVT      R8= ADDRESS OF THE CVT                    60790003
         USING CVT,R8         ADDR'ABILITY TO THE CVT                   60830003
         L     R15,CVT0VL00   ADDRESS OF RESIDENT VALIDITY CHECK        60870003
*                             ROUTINE.                                  60880003
         DROP  R8             RELEASE ADDR'ABILITY TO CVT               60910003
         SR    R2,R2          R2= ZERO NO RANGE INDICATOR..             60950003
         BALR  R14,R15        BRANCH TO VALIDITY CHECK ROUTINE.         60990003
         BNZ   RETURN1        ADDRESS NOT WRITEABLE, RETURN.            61000003
         BR    R11            RETURN ON LINK REGISTER.                  61030003
         EJECT                                                          61070003
*********************************************************************** 61110003
*        THE SVC MUST VARIFY THAT THE PROGRAM IT IS SERVICING IS NOT  * 61120003
*        PRIVILDGED. (P.P. KEY NOT SUPERVISOR STATE, AND NOT AN SVRB) * 61150003
*********************************************************************** 61190003
         SPACE                                                          61230003
CHKPPRB  EQU   *                                                        61240003
         LR    R7,R5          SAVE THE ADDR OF MY SVRB.                 61270003
         L     R5,RBLINK      OBTAIN THE ADDR OF CALLERS RB.            61310003
         TM    RBSTAB1,RBFTP-RBFTIRB  WHAT KIND OF RB IS IT(PRB OR IRB) 61350003
         BNZ   PPRBFAIL       IT IS NOT A PRB OR IRB.                   61360003
         TM    RBOPSW+X1,PSWPBIT  DETERMINE IF IN PP MODE               61390003
         BZ    PPRBFAIL       NOT IN PP MODE.                           61430003
         TM    RBOPSW+X1,PSWPKEYF  IS THE PROTECT KEY ZWRO.             61470003
         BZ    PPRBFAIL       NO IT IS KEY 0-7                          61480003
         LR    R5,R7          RESTORE MY RB POINTER                     61510003
         BR    R11            ALL IS OK THEREFORE EXIT.                 61550003
         SPACE                                                          61590003
PPRBFAIL EQU   *              IF TEST IS RUNNING INDICATE ERROR         61600003
*                             ELSE JUST RETURN DOING NOTHING.           61630003
         BAL   R11,LOCKRELE   RELEASE THE LOCAL LOCK                    61670003
         LR    R5,R7          RESTORE MY RB POINTER                     61710003
         L     R15,IOVCON     R15= ADDR OF IO FOR MSG          @ZA04126 61720003
         MVC   TSTIOPRM(IOPRMLN),IOPRM  PLACE IO PARM LIST IN WORKAREA  61750003
         MVI   TSTIOPRM,MSGINDC  PLACE MSG INDICATOR IN THE LIST.       61790003
         L     R13,REGSAVE6   R13= SAVEAREA FOR IO.            @YM07131 61830003
         LA    R1,TSTIOPRM    R1= ADDR OF THE IO PARM LIST              61840003
         BALR  R14,R15        GO TO IO.                        @ZA04126 61870003
         OI    TSTFLGS4,TSTSVCAB  INDICATE TO MNL THERE WAS AN ERROR.   61910003
         L     R13,HIGHBYTE   MASK TO CLEAR HIGH ORDER BYTE.            61950003
         B     S9GLOCKB       EXIT AS ERROR WAS HANDLED.                61960003
         EJECT                                                          61990003
LOCKRELE EQU   *              RELE THE LOCAL LOCK                       62030003
         STM   R4,R2,WRKREGSV SAVE THE REGS ACROSS THE LOCK.            62070003
S9GLOCK1 SETLOCK RELEASE,TYPE=LOCAL,RELATED=(LOCAL,IGC0009G(S9GLOCK1))  62080003
         LM    R4,R2,WRKREGSV RESTORE THE REGS.                         62110003
         BR    R11            RETURN TO THE CALLER                      62150003
         EJECT                                                          62190003
MSGINDC  EQU   X'02'          MESSAGE INDICATOR.                        62200003
HIBYTE   EQU   8              MASK FOR ICM INST             @ZA02953    62230003
Z        EQU   8              ZERO CC.                                  62270003
X3       EQU   3              HEXIDECIMAL 3                             62310003
X6       EQU   6              HEXIDECIMAL 6                             62320003
N10      EQU   10             DECIMAL 10                                62350003
N14      EQU   14             FOURTEEN                                  62390003
N18      EQU   18             EIGHTEEN                                  62430003
N64      EQU   64             SIXTY FOUR                                62440003
X0F      EQU   X'0F'          HEXIDECIMAL 0F                            62470003
X04      EQU   X'04'          HEXIDECIMAL 04                            62510003
XC0      EQU   X'C0'          HEXIDECIMAL C0                            62550003
XFF      EQU   X'FF'          HEXIDECIMAL FF                            62560003
         SPACE 2                                                        62590003
         DS    0F                                                       62630003
FOLDZERO DC    AL1(250),AL3(0)   MASK FOR FOLDING SUBPOOL ID   @ZA11325 62670003
QGET     DC    AL1(250),AL3(8)   TSTSVCQ ELEMENT. SP=250 LV=8.          62680003
FB000000 DC    X'FB000000'    RESET MASK FOR TCBTRN            @ZA11359 62710003
DISPMASK DC    X'00000FFF'    DISPLACEMENT MASK.                        62750003
BASEMASK DC    X'0000F000'    BASE REGISTER MASK.                       62790003
INDXMASK DC    X'000F0000'    INDEX REGISTER MASK                       62800003
LINKMASK DC    X'00F00000'    LINK REGISTER MASK                        62830003
HIGHBYTE DC    X'00FFFFFF'    ADDRESS MASK.                             62870003
SVCNQ    DC    CL8'IKJTMPNM'  THIS IS THE SVC (97, 61) ENQ LOCK         62910003
         SPACE 3                                                        62920003
*        ISSUE THE LIST FORM OF THE ENQ..............                   62950003
         SPACE                                                          62990003
LISTENQF ENQ   (LISTENQF,LISTENQF,E,8),ECB=LISTENQF,MF=L                63030003
LISTENQE EQU   *-LISTENQF     LENGTH OF LIST FORM OF ENQ                63040003
         SPACE 3                                                        63070003
*        ISSUE THE LIST FORM OF THE DEQ..............                   63110003
         SPACE                                                          63150003
LISTDEQF DEQ   (LISTDEQF,LISTDEQF,8),RET=HAVE,MF=L                      63160003
LISTDEQE EQU   *-LISTDEQF     LENGTH OF LIST FORM OF DEQ                63190003
         SPACE 2                                                        63230003
LISTFREE FREEMAIN L,SP=255,MF=L                               @ZA06226  63270003
FREELEN  EQU    *-LISTFREE                                    @ZA06226  63280003
         SPACE 2                                                        63310003
IOPRM    IKJEGSIO  MSG,FIRST=M0004,SECOND=M0204,ID=S9G02,MF=(L)         63350003
IOPRMLN  EQU   *-IOPRM        GET THE LENGTH OF PARM LIST               63390003
         TITLE 'IGC0009G - SERVICE ROUTINE PROCESSING'                  63400003
         SPACE 20                                                       63430003
*********************************************************************** 63470003
*                                                                     * 63510003
*        SERVICE ROUTINE FUNCTION.                                    * 63520003
*                                                                     * 63550003
*********************************************************************** 63590003
         EJECT                                                          63630003
TSTSVC01 EQU   *                                                        63640003
         USING IKJEGS9G,R1    ESTABLISH ADDRESSABILITY TO INPUT         63670003
*                             PARAMETER LIST.                           63710003
         USING TCB,R4         ESTABLISH ADDRESSABILITY TO TCB.          63750003
         USING RBSECT,R5      ESTABLISH ADDRESSABILITY TO SVRB.         63760003
         EJECT                                                          63790003
*********************************************************************** 63830003
*                                                                     * 63870003
*        GIVEN THE INPUT PARAMETER OF THE TCB ADDRESS, OR THE ADDRESS * 63880003
*        OF A PRB OR AN IRB, DETERMINE THAT THE PARAMETER IS IN FACT  * 63910003
*        A VALID ADDRESS FOR THE GIVEN TASK STRUCTURE.  AT THE        * 63950003
*        CONCLUSION OF THIS PROCESSING, REGISTER 6 CONTAINS THE       * 63990003
*        ADDRESS OF THE TCB TO BE ALTERED.                            * 64000003
*                                                                     * 64030003
*********************************************************************** 64070003
         SPACE 2                                                        64110003
         SR    R2,R2          CONSTANT ZERO.                            64120003
         L     R6,TCBOTC      ADDRESS OF TMP/TEST TASK MOTHER TCB.      64150003
         DROP  R4                                                       64190003
         USING TCB,R6         ESTABLISH ADDRESSABILITY TO TCB.          64230003
S9G11030 EQU   *                                                        64240003
         C     R2,TCBLTC      DETERMINE IF A DAUGHTER TASK EXISTS       64270003
         BZ    S9G11050       IF NO DAUGHTER TASK, BRANCH TO            64310003
*                             CHECK SISTER TASK.                        64350003
         L     R6,TCBLTC      ADDRESS OF DAUGHTER TASK TCB.             64360003
         B     S9G11070       IF A DAUGHTER TASK EXISTS, BRANCH         64390003
*                             TO CHECK IF ADDRESS MATCHES ADDRESS       64430003
*                             PASSED IN INPUT PARAMETER LIST.           64470003
S9G11050 EQU   *                                                        64480003
         C     R2,TCBNTC      DETERMINE IF A SISTER TASK EXISTS.        64510003
         BZ    S9G11060       IF NO SISTER TASK, BRANCH TO GET          64550003
*                             ADDRESS OF OWNING TCB.                    64590003
         L     R6,TCBNTC      ADDRESS OF SISTER TASK TCB.               64600003
         B     S9G11070       IF A SISTER TASK EXISTS, BRANCH TO        64630003
*                             CHECK IF ADDRESS MATCHES ADDRESS          64670003
*                             PASSED IN INPUT PARAMETER LIST.           64710003
S9G11060 EQU   *                                                        64720003
         L     R6,TCBOTC      ADDRESS OF OWNING TASK WITH RESPECT       64750003
*                             TO CURRENT TCB.                           64790003
         DROP  R6                                                       64830003
         USING TCB,R4         RE-ESTABLISH ADDRESSABILITY TO            64840003
*                             ORIGINAL TCB.                             64870003
         C     R6,TCBOTC      DETERMINE IF ENTIRE TCB QUEUE UNDER       64910003
*                             THE TMP/TEST TASK HAS BEEN SEARCHED       64950003
         BNE   S9G11050       IF SEARCH NOT COMPLETE, BRANCH TO         64960003
*                             CHECK FOR SISTER TASK.                    64990003
         B     S9G12030       WHEN ENTIRE QUEUE HAS BEEN SEARCHED       65030003
*                             WITHOUT A MATCH, RETURN TO CALLER.        65070003
S9G11070 EQU   *                                                        65080003
         SR    R7,R7          ZERO IN ORDER THAT SUBROUTINE MAY         65110003
*                             DETERMINE IF AN RB ADDRESS PASSED.        65150003
         C     R6,S9GTCBPT    DETERMINE IF TCB ADDRESS MATCHES          65190003
*                             THE ADDRESS PASSED IN INPUT               65200003
*                             PARAMETER LIST.                           65230003
         BE    S9G12010       WHEN MATCH FOUND, BRANCH TO HONOR         65270003
*                             REQUEST.                                  65310003
         DROP  R4,R5                                                    65320003
         USING TCB,R6         ESTABLISH ADDRESSABILITY TO TCB           65350003
*                             BEING CHECKED.                            65390003
         USING RBSECT,R7      ESTABLISH ADDRESSABILITY TO RB            65430003
*                             QUEUE FOR TCB BEING CHECKED.              65440003
         L     R7,TCBRBP      ADDRESS OF MOST RECENT REQUEST.           65470003
         LA    R7,0(R7)       ZERO HI BYTE          @ZA00823            65510003
         LTR   R7,R7          HAS TASK COMPLETED ?  @ZA00823            65550003
         BZ    S9G11030       YES, GO CHECK NEXT TCB @ZA00823           65560003
S9G11090 EQU   *                                                        65590003
         CLM   R7,X7,S9GTCBPT+X1 DETERMINE IF RB ADDRESS                65630003
*                             MATCHES THE ADDRESS PASSED IN             65670003
*                             INPUT PARAMETER LIST.                     65680003
         BE    S9G12010       WHEN MATCH FOUND, BRANCH TO HONOR         65710003
*                             REQUEST.                                  65750003
         TM    RBSTAB2,RBTCBNXT DETERMINE IF END OF RB CHAIN.           65790003
         L     R7,RBLINK      ADDRESS OF PREVIOUS REQUEST.              65800003
         BZ    S9G11090       NOT END OF RB CHAIN, BRANCH TO            65830003
*                             CHECK NEXT REQUEST ON CHAIN.              65870003
         B     S9G11030       BRANCH TO CHECK CURRENT TCB.              65910003
         EJECT                                                          65920003
*********************************************************************** 65950003
*                                                                     * 65990003
*        WHEN TCB ADDRESS HAS BEEN VALIDATED, OBTAIN THE FLAGS        * 66030003
*        PASSED TO THE SVC WHICH DETERMINE THE FUNCTION.  BASED       * 66040003
*        UPON THE OPERATION SPECIFIED, BRANCH TO THE APPROPRIATE      * 66070003
*        PROCESSING SECTION TO MAKE THE MODIFICATIONS REQUIRED.       * 66110003
*                                                                     * 66150003
*********************************************************************** 66160003
         SPACE 2                                                        66190003
S9G12010 EQU   *                                                        66230003
         L     R1,RBGRS1-RBSECT(,R5) RELOAD PARAMETER LIST PTR          66270003
         SR    R9,R9          ZERO REGISTER BEFORE INSERT.              66280003
         ICM   R9,X3,S9GFLGS1 OBTAIN BIT SETTINGS FOR                   66310003
*                             FUNCTION TO BE PERFORMED.                 66350003
         LA    R9,X1(R9,R9)   APPEND LOW ORDER ONE BIT TO FLAGS         66390003
         SLL   R9,X14(R0)     AND SHIFT INTO POSITION FOR TEST.         66400003
         BXH   R9,R9,S9G12030 BRANCH TO SET ERROR CODE IF SVC WAS       66430003
*                             NOT INVOKED BY MACRO INSTRUCTION.         66470003
         BXLE  R9,R9,S9G13010 FLAGS = X'C000' - BRANCH TO SET           66510003
*                             TCBTCP BIT TO B'1'.                       66520003
         BXLE  R9,R9,S9G14010 FLAGS = X'A000' - BRANCH TO SET           66550003
*                             TCBTCP BIT TO B'0'.                       66590003
         BXLE  R9,R9,S9G15010 FLAGS = X'9000' - BRANCH TO ALTER         66630003
*                             TCBTRN FIELD.                             66640003
         BXLE  R9,R9,S9G16010 FLAGS = X'8800' - BRANCH TO ALTER         66670003
*                             PROGRAM RESUME ADDRESS                    66710003
         BXLE  R9,R9,S9G17010 FLAGS = X'8400' - BRANCH TO ALTER         66750003
*                             A SPECIFIC GENERAL PURPOSE REIGSTER       66760003
         BXLE  R9,R9,S9G18010 FLAGS = X'8200' - BRANCH TO ALTER         66790003
*                             ALL GENERAL PURPOSE REGISTERS.            66830003
         BXLE  R9,R9,S9G19010 FLAGS = X'8100' - BRANCH TO ALTER         66870003
*                             A SPECIFIC FLOATING POINT REGISTER.       66880003
         BXLE  R9,R9,S9G20010 FLAGS = X'8080' - BRANCH TO SET RB        66910003
*                             WAIT COUNT TO ZERO.                       66950003
         BXLE  R9,R9,S9G21010 FLAGS = X'8040' - BRANCH TO               66990003
*                             VALIDATE ADDRESS SPECIFIED.               67000003
        BXLE   R9,R9,S9G22010 FLAGS = X'8020' - BRANCH TO               67030003
*                             DEQ FOR TCB ADDR SPECIFIED  @ZA07137      67070003
        BXLE   R9,R9,S9G24010 FLAGS = X'8010' - BRANCH  TO    @ZA06226  67110003
*                             FREE SP 255 CORE FOR IGC0006A   @ZA06226  67120003
S9G12030 EQU   *                                                        67150003
         LA    R15,X4(,R0)    SET ERROR RETURN CODE.                    67190003
         B     S9G23020       RETURN TO CALLER.                         67230003
         EJECT                                                          67240003
*********************************************************************** 67270003
*                                                                     * 67310003
*        TCB BELONGS TO A DAUGHTER OF THE TMP/TEST TASK.  INDICATE    * 67350003
*        SO BY SETTING THE TCBTCP BIT IN TCBABF TO '1'B.              * 67360003
*                                                                     * 67390003
*********************************************************************** 67430003
         SPACE 2                                                        67470003
S9G13010 EQU   *                                                        67480003
         OI    TCBABF,TCBTCP  SET TEST CP BIT TO B'1'.                  67510003
         B     S9G23010       BRANCH TO RETURN TO CALLER.               67550003
         SPACE 5                                                        67590003
*********************************************************************** 67600003
*                                                                     * 67630003
*        THE SPECIFIED TCB IS NOLONGER REQUIRED FOR TESTING.          * 67670003
*        INDICATE THE TERMINATION OF THE TEST SESSION BY SETTING      * 67710003
*        THE TCBTCP BIT IN TCBABF TO '0'B.                            * 67720003
*                                                                     * 67750003
*********************************************************************** 67790003
         SPACE 2                                                        67830003
S9G14010 EQU   *                                                        67840003
         NI    TCBABF,X'FF'-TCBTCP SET TEST CP BIT TO B'0'.             67870003
         B     S9G23010       BRANCH TO RETURN TO CALLER.               67910003
         SPACE 5                                                        67950003
*********************************************************************** 67960003
*                                                                     * 67990003
*        FOR TSO, THE TCBTRNB FIELD OF THE TCB IS RESERVED FOR        * 68030003
*        THE TEST COMMAND PROCESSOR.  THROUGHOUT THE TEST SESSION,    * 68070003
*        THIS FIELD IS USED TO POINT TO THE TEST COMMUNICATION        * 68080003
*        TABLE.  THIS FUNCTION WILL PLACE THE ADDRESS OF TCOMTAB      * 68110003
*        IN THE TMP/TEST TCB AND ANY DAUGHTER TCB.                    * 68150003
*        THIS FUMCTION IS ALSO USED TO ZERO THE TCBTRNB FIELD ZA26084 * 68156003
*        WHEN TEST IS GOING AWAY(NORMALLY OR OTHERWISE).IT IS ZA26084 * 68162003
*        CALLED BY TEST RUN OR END SUBCOMMANDS OR BY THE TMP  ZA26084 * 68168003
*        STAE RETRY ROUTINE (IKJEFT07) ON A TMP FAILURE.      ZA26084 * 68174003
*                                                                     * 68190003
*********************************************************************** 68200003
S9G15010 EQU   *                                                        68230003
         MVC   TCBTRNB(L'TCBTRNB),S9GVALUE+X1  MOVE TEST COMM- ZA29216  68234003
*                                TABLE ADDRESS TO TCB.         ZA29216  68238003
         SR    R9,R9           ZERO THE REGISTER               ZA26084  68242003
         ICM   R9,7,TCBTRNB    GET TCOMTAB PTR IF PRESENT      ZA26084  68246003
         LTR   R9,R9           IS TCOMTAB ADDR IN THIS TCB?    ZA26084  68250003
         BZ    S9G23010        BRANCH TO RETURN TO CALLER      ZA29216  68254003
         NI    TSTFLGS4,XFF-TSTRERTN  TURN OFF ABEND SWITCH    ZA26084  68258003
         B     S9G23010       BRANCH TO RETURN TO CALLER.               68270003
*********************************************************************** 68430003
*                                                                     * 68440003
*        THIS FUNCTION IS USED TO MODIFY THE RESUME ADDRESS IN THE    * 68470003
*        PROBLEM PROGRAM PRB.  WHENEVER THE USER SPECIFIES OTHER      * 68510003
*        THAN THE NEXT SEQUENTIAL INSTRUCTION IN A GO, RUN, OR        * 68550003
*        CALL SUBCOMMAND, THIS FUNCTION WILL PLACE THE INDICATED      * 68560003
*        ADDRESS IN THE PRB.                                          * 68590003
*                                                                     * 68630003
*********************************************************************** 68670003
         SPACE 2                                                        68680003
S9G16010 EQU   *                                                        68710003
         BAL   R11,S9G30010   BRANCH TO ISOLATE RB ADDRESS.             68750003
S9G16020 EQU   *                                                        68790003
         MVC   RBOPSW+X4(L'S9GVALUE),S9GVALUE RE-SET RESUME             68800003
*                             ADDRESS.                                  68830003
         B     S9G23010       BRANCH TO RETURN TO CALLER.               68870003
         EJECT                                                          68910003
*********************************************************************** 68920003
*                                                                     * 68950003
*        THIS FUNCTION IS USED TO MODIFY A SPECIFIC GENERAL           * 68990003
*        REGISTER.  THE MODIFICATION IS MADE IN THE SVRB              * 69030003
*        SAVE AREA SO THAT THE REGISTER CHANGE IS EFFECTIVE           * 69040003
*        UPON THIS SVC'S EXIT.                                        * 69070003
*                                                                     * 69110003
*********************************************************************** 69150003
         SPACE 2                                                        69160003
S9G17010 EQU   *                                                        69190003
         LH    R8,S9GREGNO    GET REGISTER NUMBER TO BE CHANGED.        69230003
         SRL   R8,4           REMOVE VALID PORTION OF S9GREGNO @ZA11342 69270003
         OR    R8,R8          CHECK FOR INVALID SPECIFICATION  @ZA11342 69280003
         BNZ   S9G12030       IF INVALID - ERROR,EXIT          @ZA11342 69310003
         LH    R8,S9GREGNO    IF VALID RELOAD REGISTER NUMBER  @ZA11342 69350003
         SLL   R8,X2(R0)      MULTIPLY REGISTER NUMBER BY 4.            69390003
         L     R9,TCBTRN      GET POINTER TO TCOMTAB           @ZA07138 69400003
*                                                              @ZA09259 69430003
*                                                              @ZA10462 69470003
         L     R7,ECBPP       GET POINTER TO SVRB              @ZA07138 69510003
*                                                              @ZA09259 69520003
*                                                              @ZA10462 69550003
         LA    R8,RBGRSAVE(R8) COMPUTE ADDRESS FOR REGISTER IN          69590003
*                             RB SAVE AREA.                             69630003
         MVC   X0(L'S9GVALUE,R8),S9GVALUE UPDATE REGISTER               69640003
*                             CONTENTS.                                 69670003
         B     S9G23010       BRANCH TO RETURN TO CALLER.               69710003
         EJECT                                                          69750003
*********************************************************************** 69760003
*                                                                     * 69790003
*        THIS FUNCTION IS USED TO MODIFY ALL GENERAL REGISTERS        * 69830003
*        FOR THE PROBLEM PROGRAM.  THE MODIFICATION IS MADE TO THE    * 69870003
*        SVRB SAVE AREA SO THAT THE CHANGED REGISTERS ARE EFFECTIVE   * 69880003
*        WHEN THIS SVC EXITS.                                         * 69910003
*                                                                     * 69950003
*********************************************************************** 69990003
         SPACE 2                                                        70000003
S9G18010 EQU   *                                                        70030003
         L     R9,TCBTRN        GET ADDR OF TCOMTAB         @ZA05687    70070003
         OI    TSTFLGS1,S9GINTSW INDICATE INTERNAL REQUEST  @ZA05687    70110003
         BAL   R10,S9G21010     GO TEST FOR READABILITY     @ZA05687    70120003
         LA    R7,N63(R7)       GET ADDR OF END OF BUFFER   @ZA05687    70150003
         BAL   R10,READCHK      TEST END OF BUFF READABILITY@ZA05687    70190003
         SPACE 2                                                        70230003
*    IF WE HAVE GOTTEN THIS FAR THE 64 BYTE BUFFER IS NOT   @ZA05687    70240003
*    IN FETCH PROTECTED STORAGE AND WE CAN CONTINUE.        @ZA05687    70270003
*       FIRST WE HAVE TO GO BACK TO KEY 0 (SET TO 8 BY THE  @ZA05687    70310003
*       VALIDITY CHECKER)                                   @ZA05687    70350003
*         THEN GET THE LOCAL LOCK BACK TO UPDATE THE         @ZA05687   70360003
*         SPECIFIED SVRB                                     @ZA05687   70390003
          SPACE  1                                                      70430003
         BAL   R11,GETLOCK                                   @ZA05687   70470003
         NI    TSTFLGS1,XFF-S9GINTSW TURN OFF FLAG            @ZA05687  70480003
         L     R8,S9GVALUE    ADDRESS OF 64-BYTE SAVE AREA WHICH        70510003
*                             CONTAINS NEW REGISTER VALUES.             70550003
         L     R7,ECBPP       GET POINTER TO SVRB              @ZA07138 70590003
*                                                              @ZA09259 70600003
*                                                              @ZA10462 70630003
         MVC   RBGRSAVE(RBEXSAVE-RBGRSAVE),X0(R8) UPDATE ALL            70670003
*                             GENERAL REGISTERS.                        70710003
         B     S9G23010       BRANCH TO RETURN TO CALLER.               70720003
         EJECT                                                          70750003
*********************************************************************** 70790003
*                                                                     * 70830003
*        THIS FUNCTION IS USED TO MODIFY FLOATING POINT REGISTERS     * 70840003
*        FOR THE PROBLEM PROGRAM.  SINGLE PRECISION REGISTERS ARE     * 70870003
*        DENOTED AS ODD REGISTER NUMBERS (1, 3, 5, 7) WHILE DOUBLE    * 70910003
*        PRECISION REGISTERS ARE DENOTED AS EVEN REGISTER NUMBERS     * 70950003
*        (0, 2, 4, 6).  AFTER IT IS DETERMINED WHICH KIND OF FLOAT-   * 70960003
*        ING POINT REGISTER IS TO BE MODIFIED, THE VALUE PASSED IS    * 70990003
*        PLACED IN THE APPROPRIATE LOCATION IN THE FLOATING POINT     * 71030003
*        REGISTER SAVE AREA, A PREFIX TO THE TCB.                     * 71070003
*                                                                     * 71080003
*********************************************************************** 71110003
         SPACE 2                                                        71150003
S9G19010 EQU   *                                                        71190003
         LH    R8,S9GREGNO    OBTAIN REGISTER NUMBER TO BE              71200003
*                             CHANGED. PREFORM VALIDITY CHECK  @ZA11342 71230003
         SRL   R8,4           REMOVE VALID PORTION OF S9GREGNO @ZA11342 71270003
         OR    R8,R8          CHECK FOR INVALID SPECIFICATION  @ZA11342 71310003
         BNZ   S9G12030       IF INVALID - ERROR,EXIT          @ZA11342 71320003
         LH    R8,S9GREGNO    IF VALID RELOAD REGISTER NUMBER  @ZA11342 71350003
         LA    R9,X1(,R0)     CONSTANT 1.                               71390003
         NR    R9,R8          TEST IF SINGLE OR DOUBLE PRECISION.       71430003
         BNZ   S9G19030       IF SINGLE PRECISION, BRANCH TO            71440003
*                             PROCESS.                                  71470003
         SLL   R8,X2(R0)      MULTIPLY REGISTER NUMBER BY 4.            71510003
         LA    R9,TCB-TCBFIX(,R0) DISPLACEMENT TO FLOATING POINT        71550003
*                             REGISTER SAVE AREA IN TCB.                71560003
         ST    R6,WRKTCBSA    SAVE TCB PTR                     @ZA31527 71570003
         SR    R6,R9          ADDRESS OF TCB PREFIX.                    71590003
         LA    R6,X0(R8,R6)   ADDRESS TO BE UPDATED FOR THIS            71630003
*                             REGISTER.                                 71670003
         L     R9,S9GVALUE    ADDRESS OF NEW VALUE FOR REGISTER.        71680003
         MVC   X0(L'TCBFRS0,R6),X0(R9) UPDATE REGISTER CONTENTS.        71710003
         L     R6,WRKTCBSA    RESTORE TCB PTR                  @ZA31527 71720003
         B     S9G23010       BRANCH TO RETURN TO CALLER.               71750003
S9G19030 EQU   *                                                        71790003
         BCTR  R8,R0          MAKE REGISTER NUMBER EVEN.                71800003
         SLL   R8,X2(R0)      MULTIPLY REIGSTER NUMBER BY 4.            71830003
         LA    R9,TCB-TCBFIX(,R0) DISPLACEMENT TO FLOATING POINT        71870003
*                             REGISTER SAVE AREA IN TCB.                71910003
         ST    R6,WRKTCBSA    SAVE TCB PTR FOR LATER USE       @ZA31527 71920003
         SR    R6,R9          ADDRESS OF TCB PREFIX.                    71930003
         LA    R6,X0(R8,R6)   ADDRESS TO BE UPDATED FOR THIS            71950003
*                             REGISTER.                                 71990003
         L     R9,S9GVALUE    ADDRESS OF NEW VALUE FOR REGISTER.        72030003
         MVC   X0(L'TCBFRS0/X2,R6),X0(R9) UPDATE REGISTER CONTENT       72040003
         L     R6,WRKTCBSA    RESTORE TCB PTR                  @ZA31527 72050003
         B     S9G23010       BRANCH TO RETURN TO CALLER.               72070003
         EJECT                                                          72110003
*********************************************************************** 72150003
*                                                                     * 72160003
*        THIS FUNCTION IS USED TO ZERO THE WAIT COUNT IN THE          * 72190003
*        SPECIFIED PRB.                                               * 72230003
*                                                                     * 72270003
*********************************************************************** 72280003
         SPACE 2                                                        72310003
S9G20010 EQU   *                                                        72350003
         BAL   R11,S9G30010   BRANCH TO ISOLATE RB ADDRESS.             72390003
S9G20020 EQU   *                                                        72400003
         MVI   RBWCF,X0       ZERO WAIT COUNT FIELD.                    72430003
         B     S9G23010       BRANCH TO RETURN TO CALLER.               72470003
         EJECT                                                          72510003
*********************************************************************** 72520003
*                                                                     * 72550003
*        THIS FUNCTION IS USED TO VALIDITY CHECK AN ADDRESS.          * 72590003
*        THE ADDRESS CHECKING FACILITY USED IS THE RESIDENT           * 72630003
*        ADDRESS VALIDITY CHECK ROUTINE POINTED TO BY THE CVT.        * 72640003
*                                                                     * 72670003
*********************************************************************** 72710003
         SPACE 2                                                        72750003
S9G21010 EQU   *                                                        72760003
         L     R7,S9GVALUE    ADDRESS TO BE VALIDITY CHECKED.           72790003
         L     R9,TCBTRN      R9= ADDR OF TCOMTAB                       72830003
         BAL   R11,LOCKRELE   DROP THE LOCAL LOCK.                      72870003
         MODESET EXTKEY=RBT234,SAVEKEY=WRKOLDKY,WORKREG=8   MODESET     72880003
         SPACE                                                          72910003
**********************************************************************  72950003
*        THE SUPPLIED ADDR FAILED IN THE VALIDITY CHECK ROUTINE, SEE    72990003
*        IF THE ADDR IS READ ONLY BY TRYING TO FETCH FROM IT. COVER THE 73000003
*        FETCH WITH AN ABEND INDICATOR AND ABEND TABLE ENTRY.           73030003
**********************************************************************  73070003
READCHK  EQU   *                                                        73110003
         SR    R8,R8          SETUP R8 AS INDICATOR            @YM04107 73120003
         DROP  R6             DROP TCB ADDRESSABILITY.                  73150003
         USING TCB,R4         ESTABLISH TCB ADDRESSABILITY              73190003
         OI    TSTFLGS1,TSTFIRST  TURN ON POSSIBLE ABEND SW.            73230003
         IC    R0,X0(R7)      TRY TO READ FROM THE ADDRESS IN QUESTION. 73240003
*                                                             @ZA02713  73270003
READABND EQU   *              EXPECTED ABEND TABLE ENTRY.               73310003
         TM    TSTFLGS1,S9GINTSW IS THIS AN INTERNAL REQUEST? @ZA05687  73350003
         BOR   R10            YES, RETURN READ ONLY REQUEST   @ZA05687  73360003
         LA    R8,X4          INDICATE AT LEAST READABLE       @YM04107 73390003
         OC    X0(X1,R7),X0(R7) NOW TRY TO WRITE               @ZA02713 73430003
WRITABND EQU   *              EXPECTED ABEND TABLE ENTRY.      @YM04107 73470003
         NI    TSTFLGS1,XFF-TSTFIRST  TURN OFF ABEND SWITCH.            73480003
         SR    R8,R8          SETUP R8  AS INDICATOR           @YM04107 73510003
         B     VLCKEXIT      RETURN CONTROL TO THE SYSTEM               73550003
         SPACE 2                                                        73590003
S9G21050 EQU   *                                                        73600003
         NI    TSTFLGS1,XFF-TSTFIRST  TURN OFF ABEND SWITCH.            73630003
         DROP  R4             DROP TCB ADDRESSABILITY.                  73670003
         USING TCB,R6         ESTABLISH TCB ADDRESSABILITY              73710003
         LA    R1,X4          INDICATE NOT READ OR WRITE.      @YM04107 73720003
         CR    R8,R1          WHAT CAUSED THE ERROR            @YM04107 73750003
         BE    VLCKEXIT       RETURN                           @YM04107 73790003
         LA    R8,X8          INDICATE NOT READ OR WRITE.      @YM04107 73830003
VLCKEXIT EQU   *              EXIT                             @YM04107 73840003
         LR    R2,R8          R2= RETURN CODE.                          73870003
         MODESET KEYADDR=WRKOLDKY,WORKREG=8 MODESET BACK                73910003
         B     S9G23030       EXIT .                                    73950003
         EJECT                                                          73960003
         SPACE 5                                                        73990003
S9G22010 EQU   *                                                        74030003
         EJECT                                                          74070003
*********************************************************************** 74080003
*                                                                     * 74110003
*        EXIT.                                                        * 74150003
*                                                                     * 74190003
*********************************************************************** 74200003
         SPACE 2                                                        74230003
S9G23010 EQU   *                                                        74270003
         SR    R15,R15        SET SUCCESSFUL RETURN CODE.               74310003
S9G23020 EQU   *                                                        74320003
         BAL   R11,LOCKRELE   RELEASE THE LOCAL LOCK                    74350003
S9G23025 EQU   *                                                        74390003
         LR    R2,R15         PRESERVE R15 RETURN CODE                  74430003
S9G23030 EQU   *              WHERE REG 2 CONTAINS RET CODE VAL CK ONLY 74440003
         LA    R0,WRKLEN      R0=LENGTH OF AREA TO FREED                74470003
         SPACE                                                          74510003
         L     R4,WRKREGRT    R4= RETURN ADDRESS                        74550003
         FREEMAIN R,LV=(0),A=(3) ISSUE FREEMAIN OF WORKAREA             74560003
         NI    TCBTSFLG,XFF-TCBATT  NO NEED TO DEFER ATTNS.             74590003
         ESTAE 0              CLEAR THE ESTAE                           74630003
         SR    R9,R9          ZERO REG                         @ZA26084 74670003
         ICM   R9,7,TCBTRNB   R9= ADDR OF TCOMTAB IF THERE     @ZA26084 74675003
         LTR   R9,R9          WAS THERE AN ADDR IN TCB         @ZA26084 74680003
         BZ    S9G23035       NO...DONT CLOBBER PSA ?          @ZA26084 74685003
         NI    TSTFLGS4,XFF-TSTRERTN  TURN OFF ABEND SW                 74690003
S9G23035 EQU   *                                               @ZA26084 74695003
         LR    R14,R4         R14= ADDR OF RETURN                       74710003
         LR    R15,R2         RESTORE R15 RETURN CODE TO CALLER         74750003
         BR    R14            RETURN TO CALLER                          74790003
*********************************************************************** 74830003
*    THIS FUNCTION FREES ALL THE CORE GOTTEN IN SUBPOOL 255    @ZA06226 74870003
*        BY IGC0006A FOR SVB AND SVQ CONTROL BLOCKS            @ZA06226 74910003
*                                                              @ZA06226 74920003
***************************************************************@ZA06226 74950003
         SPACE 2                                                        74990003
S9G24010 EQU   *                   SVC 97 CLEANUP FUNCTION     @ZA06226 75030003
         LR    R4,R6               GET TCB ADDR FOR BASE       @ZA26084 75036003
         DROP  R6                  DROP R6 FOR TIME BEING      @ZA26084 75042003
         USING TCB,R4              REBASE TCB                  @ZA26084 75048003
         LR    R7,R6               ZERO TCBTRN IN ALL TCBS     @ZA11359 75054003
         LA    R7,N0(R7)           SAVE TOP OF FAMILY QUEUE    @ZA11359 75070003
CLEARTRN EQU   *                                                        75110003
         NC    TCBTRN(4),FB000000  ZERO ALL TEST INFO IN TCBTRN@ZA11359 75150003
         L     R8,TCBLTC           GET DAUGHTER IF ANY         @ZA11359 75160003
         LA    R8,N0(R8)           CLEAR HI BYTE               @ZA11359 75190003
         LTR   R8,R8               IS THERE A DAUGHTER         @ZA11359 75230003
         BZ    FINDSIS             NO DO SISTER'S FAMILY       @ZA11359 75270003
         LR    R4,R8               WAS DAUGHTER DO HER FAMILY  @ZA26084 75280003
         B     CLEARTRN            PROCESS NEXT GENERATION     @ZA11359 75310003
FINDSIS  EQU   *                   PROCESS SISTER              @ZA11359 75350003
         L     R8,TCBNTC           GET SISTER'S ADDR IF ANY    @ZA11359 75390003
         LA    R8,N0(R8)           CLEAR HI BYTE               @ZA11359 75400003
         LTR   R8,R8               IS THERE A SISTER           @ZA11359 75430003
         BZ    UPTOMOM             NO-GO UP TO MOTHER'S FAMILY @ZA11359 75470003
         LR    R4,R8               YES-DO SISTER'S FAMILY      @ZA26084 75510003
         B     CLEARTRN            GO PROCESS SISTER'S FAMILY  @ZA11359 75520003
UPTOMOM  L     R8,TCBOTC           GET MOTHER'S ADDRESS        @ZA11359 75550003
         LA    R4,N0(R8)           CLEAR HI BYTE               @ZA26084 75590003
         CR    R4,R7               IS MOTHER HEAD OF FAMILY    @ZA26084 75600003
         BNE   FINDSIS             NO- DO HER SISTER'S FAMILY  @ZA11359 75630003
         SR    R4,R4               CLEAR REG FOR USE           @Z260846 75670003
         L     R8,PSAAOLD          GET PTR TO ASCB             @ZA06226 75710003
         L     R8,ASCBASXB-ASCB(R8) GET ADDR OF AXCB           @ZA06226 75750003
         L     R8,ASXBLWA-ASXB(R8) GET ADDR OF LWA             @ZA06226 75760003
         L     R7,LWATEST-LWA(R8)  GET ADDR OF TEST WORD       @ZA06226 75790003
         LA    R7,0(R7)            ZERO HIGH BYTE              @ZA06226 75830003
         LTR   R7,R7               IS THE A POINTER TO A SVB   @ZA06226 75870003
         ST    R4,LWATEST-LWA(R8)  ZERO LWATEST PTR            @ZA26084 75880003
         BZ    S9G23010            NO, GO TO EXIT PROCESSING   @ZA06226 75910003
* AT THIS POINT WE KNOW THERE IS WORK TO DO                    @ZA06226 75950003
*    FIRST FREE THE LOCAL LOCK SO THAT SVCS CAN BE ISSUED      @ZA06226 75990003
*    THEN GET 1000 BYTES FOR A LIST TYPE FREEMAIN              @ZA06226 76000003
         SPACE 1                                                        76030003
         BAL   R11,LOCKRELE        FREE LOCAL LOCK             @ZA06226 76070003
         SPACE 1                                                        76110003
         GETMAIN RU,LV=ONEK        GET FREEMAIN LIST CORE      @ZA06226 76120003
         EJECT                                                          76150003
         USING IKJEGSVQ,R7         ADDRESSABILITY TO SVQS      @ZA06226 76190003
         USING IKJEGSVB,R8         ADDRESSABILITY TO SVBS      @ZA06226 76230003
         LR    R9,R1               R9= ADDR LIST               @ZA06226 76240003
         SPACE 2                                                        76270003
S9G24020 EQU   *                   SVQ LOOP                    @ZA06226 76310003
         LA    R7,N0(R7)           ZERO HI BYTE              @ZA06226   76350003
         LTR   R7,R7               IS THERE AN ADDR?           @ZA06226 76360003
         LA    R10,S9G24090        SET ADDR FOR RETURN         @ZA06226 76390003
         BZ    S9G24090            NO ADDR GO FREE CORE &      @ZA06226 76430003
*                                  RETURN                      @ZA06226 76470003
         ST    R7,N0(R4,R9)        PUT ADDR OF SVQ IN LIST     @ZA06226 76480003
         LA    R5,SVQLEN           LENGTH OF ONE SVQ BLOCK     @ZA06226 76510003
         ST    R5,N500(R4,R9)      PUT LENGTH OF SVQ IN LIST   @ZA26084 76550003
         LA    R4,N4(R4)           INCREMENT INDEX             @ZA26084 76560003
         CH    R4,FIVEHUND         IS R4 POINTING TO LAST      @ZA26084 76590003
*                                  ENTRY                       @ZA06226 76630003
         LA    R10,S9G24030        GET RETURN ADDR             @ZA06226 76670003
         BE    S9G24090            PAST END? GO FREE           @ZA17744 76710003
S9G24030 EQU   *                                               @ZA06226 76720003
         L     R8,SVQBLKPT         GET ADDR OF SVB BLOCK       @ZA06226 76750003
         LA    R8,N0(R8)           ZERO HI BYTE                @ZA06226 76790003
         LTR   R8,R8               IS THERE AN SVB BLOCK       @ZA06226 76830003
         LA    R11,S9G24040        RETURN ADDR IN R11          @ZA06226 76840003
         BNZ   S9G24050            YES, BRANCH TO PROCESS SVB  @ZA06226 76870003
S9G24040 EQU   *                                               @ZA06226 76910003
         L     R7,SVQLNKPT         GET NEXT SVQ BLOCK          @ZA06226 76950003
         B     S9G24020            ONCE AGAIN FROM THE TOP     @ZA06226 76960003
         SPACE 3                                                        76970003
* THE FOLLOWING CODE WILL SEARCH THE SVB BLOCKS AND FREE THEM  @ZA06226 76990003
S9G24050 EQU   *                                               @ZA06226 77070003
         ST    R8,N0(R4,R9)        STORE ADDR IN LIST          @ZA26084 77110003
         LA    R5,SVBLEN           GET LENGTH OF SVB           @ZA06226 77150003
         ST    R5,N500(R4,R9)      STORE LENGTH IN LIST        @ZA26084 77190003
         LA    R4,N4(R4)           INCREMENT INDEX             @ZA31527 77200003
         CH    R4,FIVEHUND         ARE WE PAST THE END YET     @ZA26084 77230003
         LA    R10,S9G24060        ADDR FOR CORE RETURN        @ZA06226 77270003
         BE    S9G24090            YES, GO FREE THE CORE       @ZA17744 77310003
S9G24060 EQU   *                                               @ZA06226 77320003
         L     R8,SVBLNKPT         GET NEXT SVB BLOCK PTR      @ZA06226 77350003
         LA    R8,N0(R8)           ZERO HIGH BYTE              @ZA06226 77390003
         LTR   R8,R8               IS THE PTR ZERO             @ZA06226 77430003
         BNZ   S9G24050            NO, CONTINUE LOOP           @ZA06226 77440003
         BR    R11                 YES, GO BACK TO LOOK FOR    @ZA06226 77470003
*                                  NEXTSVQ                     @ZA06226 77510003
         EJECT                                                          77550003
S9G24090 LTR   R4,R4               IS THIS FINAL CALL          @ZA26084 77560003
         BZ    S9G24095            YES, GO FREE LIST CORE      @ZA06226 77590003
         S     R4,FOUR             DECREMENT REG BY FOUR       @ZA26084 77630003
         LA    R1,N500(R9)         USE R1 FOR ARITHMETIC       @ZA06226 77670003
         AR    R1,R4               FIND END OF LENGTH LIST     @ZA26084 77680003
         OI    N0(R1),X'80'        TURN ON END OF LIST         @ZA06226 77710003
*                                  INDICATOR                   @ZA06226 77750003
         LA    R2,N500(R9)         GET START OF LENGTH LIST    @ZA06226 77790003
         MVC   WRKFREE(FREELEN),LISTFREE COPY LIST FORM        @ZA06226 77800003
         FREEMAIN LC,LA=(R2),A=(R9),MF=(E,WRKFREE) FREE A BUNCH OF CORE 77830003
         SPACE 1                                                        77870003
         SR    R4,R4               RESET INDEX TO ZERO         @ZA26084 77910003
         BR    10                  RETURN TO CALLER            @ZA06226 77920003
         SPACE 2                                                        77950003
* CLEAN UP LIST CORE AND GO AWAY                               @ZA06226 77990003
         SPACE 1                                                        78030003
S9G24095 EQU   *                                               @ZA06226 78040003
         FREEMAIN RC,LV=ONEK,A=(R9)                            @ZA06226 78070003
         SR    R15,R15             ZERO RETURN CODE            @ZA06226 78110003
         B     S9G23025            GO TO CLEAN UP AND RETURN   @ZA06226 78150003
         DROP  R7                                                       78160003
         DROP  R8                                                       78190003
         DROP  R4                                              @ZA26084 78200003
         USING TCB,R6             REESTABLISH BASE FOR TCB     @ZA26084 78210003
         USING RBSECT,R7          REESTABLISH BASE FOR RB               78230003
*                                 RB'S ARE NOT REF IN PRIOR SECTION     78270003
         EJECT                                                          78280003
*********************************************************************** 78310003
*                                                                     * 78350003
*        THIS SUBROUTINE IS USED TO ISOLATE THE PRB TO BE MODIFIED.   * 78390003
*                                                                     * 78400003
*********************************************************************** 78430003
         SPACE 2                                                        78470003
S9G30010 EQU   *                                                        78510003
         LTR   R7,R7          WAS AN RB ADDRESS OR A TCB ADDRESS        78520003
*                             PASSED AS AN INPUT PARAMETER.             78550003
         BNZ   S9G30070       IF AN RB ADDRESS PASSED, BRANCH TO        78590003
*                             DETERMINE STATUS OF RB.                   78630003
         L     R7,TCBRBP      ADDRESS OF RB CHAIN FOR TCB PASSED.       78640003
S9G30030 EQU   *                                                        78670003
         TM    RBSTAB1,RBFTP   CHECK IF THIS IS A PRB.                  78710003
         BZ    S9G30070        IF A PRB, BRANCH TO DETERMINE            78750003
*                              STATUS.                                  78760003
         TM    RBSTAB1,RBFTP-RBFTIRB IS THIS RB OTHER THAN AN IRB       78790003
         BNZ   S9G30050        IF NOT AN IRB, BRANCH TO GET NEXT        78830003
*                              RB POINTER.                              78870003
         TM    RBSTAB1,RBFTIRB IS THIS RB AN IRB.                       78880003
         BO    S9G30070        IF AN IRB, BRANCH TO DETERMINE           78910003
*                              STATUS.                                  78950003
S9G30050 EQU   *                                                        78990003
         TM    RBSTAB2,RBTCBNXT HAS END OF RB CHAIN BEEN REACHED.       79000003
         L     R7,RBLINK       GET POINTER TO NEXT RB ON CHAIN.         79030003
         BO    S9G12030        IF END OF CHAIN, BRANCH TO SET           79070003
*                              ERROR RETURN CODE AND EXIT.              79110003
         B     S9G30030        BRANCH TO EXAMINE THIS RB.               79120003
S9G30070 EQU   *                                                        79150003
         TM    RBOPSW+X1,PSWPBIT DETERMINE IF PROGRAM IS RUNNING        79190003
*                              IN PROBLEM PROGRAM MODE.                 79230003
         BZ    S9G12030        IF NOT IN PROBLEM PROGRAM MODE,          79240003
*                              BRANCH TO SET ERROR CODE AND EXIT.       79270003
         TM    RBOPSW+X1,PSWPKEYF DETERMINE IF PROGRAM HAS A            79310003
*                              PROTECT KEY OF ZERO.                     79350003
         BZ    S9G12030        IF PROTECT KEY ZERO, BRANCH TO SET       79360003
*                              ERROR CODE AND EXIT.                     79390003
         BR    R11             RETURN TO CALLER.                        79430003
         EJECT                                                          79470003
*********************************************************************   79480003
*                                                           @ZA05687*   79510003
*       HERE WE WILL MODESET TO THE ORIGINAL KEY            @ZA05687*   79550003
*       AND OBTAIN THE LOCAL LOCK FOR THOSE WHO HAVE LOST   @ZA05687*   79590003
*       IT AND ARE DESIROUS OF FINDING IT AGAIN             @ZA05687*   79600003
*                                                           @ZA05687*   79630003
*********************************************************************   79670003
         SPACE  2                                                       79710003
GETLOCK  EQU   *                                            @ZA05687    79720003
         MODESET KEYADDR=WRKOLDKY,WORKREG=8 RETURN TO ORG KEY @ZA05687  79750003
         STM   R4,R2,WRKREGSV    SAVE REGS AROUND SETLOCK     @ZA05687  79790003
GOGETEM  SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,RELATED=(LOCAL,         *79830003
               IGC0009G(GOGETEM)) REOBTAIN THE LOCK           @ZA05687  79840003
         LM    R4,R2,WRKREGSV     RESTORE THE REGS            @ZA05687  79870003
         BR    R11                RETURN TO CALLER            @ZA05687  79910003
         EJECT                                                          79950003
*********************************************************************** 79960003
*                                                                     * 79990003
*        WE HAVE TO DETERMINE WHAT TO DO WITH THE ESTAE FAILURE.      * 80030003
*              1) IF TEST IS NOT RUNNING END THE SESSION.             * 80070003
*              2) IF TEST IS RUNNING RETURN WITH 24.                  * 80080003
*                                                                     * 80110003
*********************************************************************** 80150003
         SPACE                                                          80190003
ESTAFAIL DS    0H             ESTAE FAILLED.                            80200003
         SPACE                                                          80230003
         TM    TCBABF,TCBTCP  IS TEST RUNNING                           80270003
         BZ    S9G08010       YES RETURN TO CALLER WITH 24.             80310003
         L     R9,TCBTRN      GET ADDR OF TCOMTAB                       80320003
         USING TCOMTAB,R9     ADDRESSABILITY TO TCOMTAB                 80350003
         OI    TSTFLGS4,TSTSVCAB  INDICATE TO MNL TO TERMINATE          80390003
         B     S9GLOCKA       POST MNL TO END TEST SESSION..            80430003
S9G08010 DS    0H             RETURN WITH 24.                           80440003
         STC   R15,TSTESTRC   SAVE THE  RETURN CODE.                    80470003
         LA    R15,RC24       REGISTER 15 = 24..                        80510003
         B     S9G23020       RETURN.                                   80550003
         EJECT                                                          80560003
*********************************************************************** 80590003
*                                                                     * 80630003
*        THIS ROUTINE IS USED TO SYNCH TO IKJEGSTA FOR HANDLING ABENDS  80670003
*                                                                     * 80680003
*********************************************************************** 80710003
         SPACE                                                          80750003
S9GESTAE DS    0F             START OF DUMMY STA                        80790003
         USING S9GESTAE,R15   RE-ESTABLISH ADDR'ABILITY        @YM04131 80800003
         L     R6,FLCCVT      R6= ADDR OF CVT                  @YM04131 80830003
         USING CVT,R6         ADDR'ABILITY TO CVT              @YM04131 80870003
         L     R6,CVTTCBP     R6= ADDR OF TCB                  @YM04131 80910003
         L     R6,X4(,R6)     R6= ADDR OF THE TCB              @YM04131 80920003
         USING TCB,R6         ADDRABILITY TO TCB               @YM04131 80950003
         L     R9,TCBTRN      R9= ADDR OF TCOMTAB                       80990003
         LA    R9,N0(R9)      CLEAR FLAG BYTE LEAVING ADDRESS  @ZA11359 81030003
         LTR   R9,R9          IS TEST RUNNING.                          81040003
         BZ    ESTAERR        NO TEST IS NOT IN CONTROL                 81070003
         USING TCOMTAB,R9     ADDR'ABILITY TO TCOMTAB                   81110003
         L     R15,STAEVCON   R15= ADDR OF IKJEGSTA            @ZA04126 81150003
         LR    R13,R14        SAVE RETURN ADDR AROUND BALR     @ZA04126 81160003
         BALR  R14,R15        TRANSFER CONTROL TO IKJEGSTA     @ZA04126 81190003
         LTR   R1,R1          IS A WORK AREA AVAIL??           @ZA04126 81230003
         BZR   R13            NO, RETURN SKIP SETRP            @ZA04126 81270003
         USING SDWA,R1        YES-SET ADDR'ABILITY             @ZA10530 81280003
         L     R3,SDWAPARM    GET WORK AREA FOR RETRY          @ZA10530 81310003
         ST    R3,SDWASR03    UPDTAE REG3 PTR FOR RETRY        @ZA10530 81350003
         ST    R9,SDWASR09    AND THE R9 PTR TO TCOMTAB        @ZA10530 81390003
         L     R12,X8(,R3)    RESET BASE REG 12                @ZA10530 81400003
         ST    R12,SDWASR12   AND UPDATE IN SDWA FOR RETRY     @ZA10530 81430003
         SETRP RETADDR=(R0),RECORD=NO,DUMP=NO,FRESDWA=YES,RC=4,        *81470003
               RETREGS=YES                                     @ZA10530 81510003
         BR    R13            RETURN TO CALLER                 @ZA04126 81520003
         SPACE                                                          81550003
ESTAERR  DS    0H             SOMETHING IS A MESS PERCOLATE..           81590003
         SR    R15,R15        CLEAR REG 15..                            81630003
         BR    R14            EXIT TO CALLER                            81640003
         DROP  R15,R6,R1      RELEASE ADDRABILITY              @YM04131 81670003
         EJECT                                                          81710003
*********************************************************************** 81750003
*                                                                     * 81760003
*        THIS ROUTINE IS THE RETRY ROUTINE OF IGC0009G                * 81790003
*        ON ENTRY ALL MY REGISTERS ARE VALID DUE TO SETRP.    @ZA10530* 81830003
*                                                                     * 81870003
*********************************************************************** 81880003
         SPACE                                                          81910003
S9GRETRY DS    0F             THE START OF THE RETRY ROUTINE            81950003
         SR    R15,R15        CLEAR RETURN CODE                         81990003
         L     R4,WRKSVTCB    R4= ADDR OF CALLERS TCB.                  82000003
         USING TCB,R4         ADDR'ABILITY TO THE TCB.                  82030003
         TM    TCBABF,TCBTCP  DETERMINE IF THIS WAS A SERVICE           82070003
         BZ    SERVFAIL       YES A SERVICE FAILED.                     82110003
         OI    TSTFLGS4,TSTSVCAB  INDICATE ABEND TO MNL.                82120003
         B     S9GLOCKB       POST MNL TO END TEST SESSION.             82150003
SERVFAIL DS    0H             RETURN WITH A 20.                         82190003
         TM    TSTFLGS1,TSTFIRST  WAS THE ABEND EXPECTED.               82230003
         BO    S9G21050       THE ADDR IS BAD.                          82240003
         LA    R15,RC20       R15 = 20, RETRY ROUTINE ENTERED.          82270003
         B     S9G23025       EXIT TO THE CALLER.                       82310003
         EJECT                                                          82350003
S9GSPLST IKJEGSPL RTRY=S9GRETRY,ABNTB=STAETAB,MODNM=IGC0009G,          *82360003
               TNM=BREAKPOINT-SVC                              @ZA10530 82390003
S9GSPLEN EQU   *-S9GSPLST     LENGTH OF ESTAE PARM LIST.       @ZA10530 82430003
         SPACE                                                          82470003
STAETAB  DS    0F             ABEND TABLE FOR IKJEGSTA                  82480003
         DC    X'00'          INDICATE NO MESSAGE                       82510003
         DC    AL3(READABND)  READ ONLY VALIDITY CHECK FAILED           82550003
         DC    X'00'          INDICATE NO MESSAGE                       82590003
         DC    AL3(WRITABND)  WRIT ABEND VALIDITY CHECK FAILED          82600003
         DC    X'FF'          NO ENTRIES IN TABLE                       82630003
         SPACE 2                                                        82670003
DEQLIST  DEQ   (MAJQNAM,,,STEP),MF=L                                    82710003
         DS    0F                                                       82720003
DQLSTLEN EQU   *-DEQLIST         LENGTH OF LIST FORM                    82750003
MAJQNAM  DC    CL8'IKJTMPNM'     MAJOR NAME FOR DEQ           @ZA07137  82790003
         SPACE 5                                                        82830003
EXIT     EQU   3              *                                         82840003
PSWPBIT  EQU   X'01'                                                    82870003
PSWPKEYF EQU   X'80'                                                    82910003
RC20     EQU   20             RETURN CODE 20.                           82950003
RC24     EQU   24             RETURN CODE 24.                           82960003
X0       EQU   0              OFFSET 0                                  82990003
X1       EQU   1              OFFSET 1                                  83030003
X2       EQU   2              OFFSET 2                                  83070003
X4       EQU   4              OFFSET 4                                  83080003
X14      EQU   14             OFFSET 14.                                83110003
X5       EQU   5              OFFSET 5                                  83150003
X7       EQU   7              OFFSET 7                                  83190003
X8       EQU   8              OFFSET 8                                  83200003
SAVELN   EQU   80             LENGTH OF GETMAIN SAVE AREA               83230003
         EJECT                                                          83270003
*******************************************************************     83310003
*        WORKAREA DSECT FOR IGC0009G                                    83320003
*******************************************************************     83350003
S9GWORKA DSECT                                                          83390003
WRKSTART DS    0F             START OF THE WORKAREA                     83430003
*        ***************************************************** @ZA10530 83440003
*        *  THE FOLLOWING CODE TO WRKREGSV MUST REMAIN AT    * @ZA10530 83470003
*        *  OFFSET ZERO INTO THIS WORK AREA DSECT            * @ZA10530 83510003
*        ***************************************************** @ZA10530 83550003
S9GSPL   DS    XL(S9GSPLEN)   ESTAE EXIT PARAMETER LIST        @ZA10530 83560003
WRKREGSV DS    18F            REGISTER SAVE AREA                        83590003
WRKESTAE DS    4F             ESTAE WORKAREA                            83630003
WRKREGRT DS    1F             SAVE AREA FOR R14 REGISTER                83670003
WRKSVTCB DS    1F             SAVE AREA FOR CALLERS TCB ADDR.           83680003
WRKENQ   DS    CL8            ENQ ELEMENT SAVEAREA                      83710003
WRKOLDKY DS    1X             SAVE THE PROTECT KEY                      83750003
WRKRESV  DS    3X             NOT USED.                                 83790003
WRKECB   DS    1F             ECB FOR ENQ RESOURCE WAIT        @YM07115 83800003
         ORG   WRKREGSV       BACK TO TOP OF WORKAREA                   83830003
WRKENQPR DS    1F             PREFIX FOR ECB ADDRESS           @YM07115 83870003
WRKENQWK DS    0F             ENQ PARM LIST START                       83910003
WRKENQFG DS    X              ENQ FLAGS (END OF LIST)                   83920003
WRKENQTP DS    2X             ENQ TYPE INDICATOR                        83950003
WRKENQRC DS    X              ENQ R14 CODE                              83990003
         ORG   WRKREGSV       BACK TO TOP OF WORKAREA         @ZA07137  84030003
WRKDEQPR DS    1F             PREFIX FOR TCB ADDR             @ZA07137  84040003
WRKDEQWK DS    0F             START OF DEQ PARM LIST          @ZA07137  84070003
         ORG                                                            84110003
         ORG   WRKREGSV                                       @ZA06226  84150003
WRKFREE DS    3F             FREEMAIN PARM LIST               @ZA06226  84160003
        ORG                                                             84190003
WRKNQRNM DS    CL8                           RNAME GOES HERE  @ZA07137  84230003
S9GFLGS  DS    0F -                          SVC 97 FLAGS     @ZA07137  84270003
WRKFLGS1 DS    X  -                          1ST FLAG BYTE    @ZA07137  84280003
WRKPSEUD EQU   X'80'  -                      SVC97 IS PSEUDO  @ZA07137  84310003
*                                            BREAKPOINT       @ZA07137  84350003
WRKSVRBS DS    3X -                          PRIOR SVRB ADDR   @ZA07138 84390003
*                             FROM ECBPP IN TCOMTAB            @ZA09259 84400003
*                                                              @ZA10462 84430003
WRKTCBSA DS    1F                     TCB REG SAVE             @ZA31527 84440003
WRKLEN   EQU   *-WRKSTART     LENGTH OF THE SAVE AREA                   84470003
         EJECT                                                          84510003
         IKJEGS9G MF=D                                                  84520003
         EJECT                                                          84550003
         BRKELEM                                                        84590003
IGC0009G CSECT                                                          84630003
BACKUP1  DC    Y(BRKINST-BRKELEM)   VALUE TO BACKUP THE IC.             84640003
BACKUP2  DC    Y(BRKINST-BRKELEM+6)  VALUE TO BACKUP THE IC             84670003
         EJECT                                                          84710003
IOVCON   DC    V(IKJEGIO)            ADDR OF MSG WRITER        @ZA04126 84750003
STAEVCON DC    V(IKJEGSTA)           ADDR OF ESTAE PROCESSOR   @ZA04126 84760003
         IKJTCB                                                         84790003
S        EQU   TCBNTC-TCB     LAST ATTACHED SISTER TCB                  84830003
M        EQU   TCBOTC-TCB     MOTHER TCB                                84870003
D        EQU   TCBLTC-TCB     LAST ATTACHED DAUGHTER TCB                84880003
         EJECT                                                          84910003
         TCOMTAB                                                        84950003
         IKJTPL                                                         84990003
         EJECT                                                          85000003
         IKJRB                                                          85030003
         EJECT                                                          85070003
         CVT   DSECT=YES                                                85110003
         EJECT                                                          85120003
         IHASCVT                                                        85150003
         IEZJSCB                                                        85190003
         IKJPSCB                                                        85230003
         EJECT                                                          85240003
         IKJECT                                                         85270003
         EJECT                                                          85310003
         IHAPSA                                                         85350003
         EJECT                                                          85360003
         IHASDWA                                                        85390003
         EJECT                                                          85430003
         IHAASCB                                                        85470003
         EJECT                                                          85480003
         IHAASXB                                                        85510003
         EJECT                                                          85550003
        IKJEFLWA                                                        85590003
         EJECT                                                          85600003
         SPACE 5                                                        85630003
         IKJEGSVQ                                                       85670003
         EJECT                                                          85710003
         IKJEGSVB                                                       85720003
          EJECT                                                         85750003
IGC0009G CSECT                                                          85790003
X40      DC    X'40'     FLAG FOR BALR LINK REG        @ZA02953         85830003
X80      DC    X'80'     FLAG FOR BAL  LINK REG        @ZA02953         85840003
         DS    0F                                                       85870003
FOUR     DC    F'4'                                                     85910003
FIVEHUND DC    H'500'                                                   85950003
PATCHSP  DC    100C'Z'         PATCH AREA.                              85960003
         END   IGC0009G                                                 85990003
./  ADD  SSI=33180539,NAME=IKJEGASN
         TITLE 'IKJEGASN, ''ASSIGN'' SUBCOMMAND OF TEST'                00050002
         COPY   IKJEGSIO                                                00060002
         EJECT                                                          00070002
         MACRO                                                          00100002
         VALUPDE                                                        00150002
*********************************************************************** 00200002
*                                                                     * 00250002
*        MAPPING DSECT FOR PDES FOR VALUES                            * 00300002
*                                                                     * 00350002
*        STATUS -- VERSION NO. 01 - RELEASE NO. 01                    * 00400002
*                                                                     * 00450002
*        CHANGE LEVEL -- 00 - DATE 03/09/72                           * 00500002
*                                                                     * 00550002
*********************************************************************** 00600002
VALUPDE  DSECT                                                          00650002
VALUPTR  DS    F -                      POINTER TO CHARACTER STRING,    00700002
*                                       FIRST BYTE AFTER QUOTE          00750002
VALULNH  DS    H -                      LENGTH OF CHARACTER STRING,     00800002
*                                       EXCLUDING QUOTES                00850002
VALUFLG  DS    XL1 -                    FLAG                            00900002
VALUBIT  EQU   B'10000000' -            BIT ON MEANS VALUE PRESENT      00950002
VALUTYPE DS    CL1 -                    TYPE CHARACTER (CHARACTER       01000002
*                                       PRECEDING QUOTE)                01050002
VALUCHAI DS    F -                      ADDRESS OF NEXT VALUE           01100002
*                                       PDE ON CHAIN                    01150002
VALUPDL  EQU   *-VALUPDE -              LENGTH OF VALUE PDE             01200002
         MEND                                                           01250002
         EJECT                                                          01300002
*********************************************************************** 01350002
*                                                                     * 01400002
* STATUS--                                                            * 01450002
*    CHANGE LEVEL 00, VERSION NUMBER 02, OS/VS2 (5/17/73)             * 01500002
*                                                                     * 01550002
* FUNCTION--                                                          * 01600002
*    IKJEGASN WILL REPLACE THE CONTENTS OF USER DESIGNATED            * 01650002
*    AREAS OF CORE STORAGE OR REGISTERS WITH VALUES SPECIFIED         * 01700002
*    BY THE USER.  CORE STORAGE AREAS ARE PATCHED BY A MVC            * 01750002
*    INSTRUCTION AND REGISTER CONTENTS ARE MODIFIED BY ISSUING        * 01800002
*    A SUPERVISOR CALL (SVC 97)  WITH THE IKJEGS9G MACRO.             * 01850002
*                                                                     * 01900002
*    CONTROL IS RECEIVED WHEN IKJEGPCH ISSUES A BRANCH INSTRUCTION    * 01950002
*    IKJEGASN MUST DETERMINE WHAT TYPE OF DATA THE USER HAS           * 02000002
*    SPECIFIED AS AN OPERAND.  IF NECESSARY, IKJEGASN WILL            * 02050002
*    BRANCH TO IKJEGCVT TO CONVERT DATA STRINGS TO REQUESTED FORMAT.  * 02100002
*                                                                     * 02150002
*    THE DATA IS MOVED INTO THE ADDRESS SPCEFIED BY THE USER.         * 02200002
*    HOWEVER, IF THE ADDRESS IS A REGISTER, THE ASSIGNED VALUE        * 02250002
*    IS PLACED INTO THE REGISTER BY IKJEGS9G(SVC97).                  * 02300002
*                                                                     * 02350002
*    A RETURN CODE IS SET IN REGISTER 15 AND CONTROL IS RETURNED      * 02400002
*    TO IKJEGMNL BY BRANCHING ON REGISTER 14.                         * 02450002
*                                                                     * 02500002
* ENTRY POINTS--                                                      * 02550002
*         IKJEGASN  MAIN ENTRY POINT, ENTERED FROM IKJEGPCH BY AN XCTL* 02600002
*                                                                     * 02650002
* INPUT--                                                             * 02700002
*    PCHWORK   THE ASSIGNMENT COMMAND WORKAREA INITIALIZED BY         * 02750002
*    MODULE IKJEGPCH AND CONTAINING THE FIRST OR ONLY VALUE PDE AND   * 02800002
*    THE NECESSARY VARIABLES TO PERFORM THE PATCH.                    * 02850002
*    REGISTER NINE POINTS TO THE TCOMTAB                              * 02900002
*                                                                     * 02950002
* OUTPUT--                                                            * 03000002
*    THE CONVERTED VALUE IN THE REQUESTED CORE STORAGE LOCATION OR    * 03050002
*    REGISTER.                                                        * 03100002
*    REGISTER FIFTEEN CONTAINS A RETURN CODE                          * 03150002
*                                                                     * 03200002
* EXTERNAL REFERENCES--                                               * 03250002
*         IKJEGCVT FOR CONVERSION OF ADDRESSES TO BINARY AND VALUES TO* 03300002
*         THE MACHINE FORMAT OF THE TYPE SPECIFIED.                   * 03350002
*         IKJEGI0 FOR OUTPUTTING MESSAGES.                           *  03400002
*                                                                     * 03450002
* EXITS, NORMAL--                                                     * 03500002
*         BRANCH REGISTER 14 RETURNING TO CALLER WITH A CONDITION CODE* 03550002
*         OF ZERO FOR SUCCESSFUL COMPLETION OR DIAGNOSTIC ERROR AND A * 03600002
*         RETURN CODE OF SIXTEEN (16) IF AN ATTENTION HAS BEEN        * 03650002
*         SCHEDULED.                                                  * 03700002
*                                                                     * 03750002
* EXITS, ERROR--                                                      * 03800002
*         BRANCH REGISTER 14 RETURNING TO CALLER WITH A CONDITION CODE* 03850002
*         OF TWENTY (20) FROM THE STAE RETRY ROUTINE AFTER AN ABEND,  * 03900002
*        OF 24 INDICATING THE ESTAE MACRO FAILED, 16 AN ATTN.         * 03910002
*                                                                     * 03950002
* TABLES/WORK AREAS --                                                * 04000002
*    1 TCOMTAB, POINTED AT BY REG 9 IS THE TEST COMMUNICATIONS TABLE  * 04050002
*    2 PCHWORK, A DESECT WHICH DESCRIBES PART OF THE COMMON WORKING   * 04100002
*    CORE MAINTAINED BY TEST AND POINTED AT BY 'WORKAREA' IN TCOMTAB. * 04150002
*    3 PARAMETER DESCRIPTOR LIST (PDL) PREPARED BY IKJPARSE TO        * 04200002
*    DESCRIBE THE VARIOUS FIELDS OF THE PARSED SUBCOMMAND             * 04250002
*                                                                     * 04300002
* ATTRIBUTES--                                                        * 04350002
*    REENTRANT, REFRESHABLE, PROBLEM PROGRAM.                         * 04400002
*                                                                     * 04450002
* CHARACTER CODE DEPENDENCY--                                         * 04500002
*    OPERATION OF THIS MODULE REQUIRES AND DEPENDS ON THE BIT         * 04550002
*    PATTERNS AND BINARY VALUES OF THE EBCDIC CHARACTER SET.          * 04600002
*    THE DEPENDENCY IS IN TABLE 'PCHTRTBL'. OTHER PORTIONS OF         * 04650002
*    THE MODULE REQUIRE ONLY REASSEMBLY FOR CHANGE OF CODE.           * 04700002
*                                                                     * 04750002
* NOTES--                                                             * 04800002
*    THIS MODULE REQUIRES THE STANDARD INSTRUCTION SET.               * 04850002
*                                                                     * 04900002
*********************************************************************** 04950002
IKJEGASN CSECT                                                          05000002
         SPACE                                                          05200002
* REGISTER EQUATES.                                                     05250002
         SPACE                                                          05300002
R0       EQU   0                   REGISTER EQUATE                      05350002
R1       EQU   1                   PARAMETER REGISTER                   05400002
R2       EQU   2                   REGISTER EQUATE                      05450002
R3       EQU   3                   REGISTER EQUATE                      05500002
R4       EQU   4                   REGISTER EQUATE                      05550002
R5       EQU   5                   REGISTER EQUATE                      05600002
R6       EQU   6                   REGISTER EQUATE                      05650002
R7       EQU   7                   REGISTER EQUATE                      05700002
R8       EQU   8                   REGISTER EQUATE                      05750002
R9       EQU   9                   BASE REG FOR TCOMTAB, COMM. DSECT    05800002
R10      EQU   10                  INTERNAL LINK REG FOR THIS MODULE    05850002
R11      EQU   11                  BASE REG FOR THIS PROGRAM.           05900002
R12      EQU   12                  *                                    05950002
R13      EQU   13                  PTR TO CURRENT SAVE AREA.            06000002
R14      EQU   14                                                       06050002
R15      EQU   15                                                       06100002
         SPACE 2                                                        06150002
*  DATA EQUATES FOR OPERANDS OF IMMEDIATE TYPE INSTRUCTIONS.            06200002
         SPACE                                                          06250002
NULL     EQU   0                   USED FOR BALR R,0 AND BCTR R,0.      06300002
ZERO     EQU   0                                                        06350002
ONE      EQU   1                   SYMBOLIC FOR THE NUMBER 1            06400002
THREE    EQU   3                   SYMBOLIC FOR THE QUANTITY '3'        06500002
FOUR     EQU   4                                                        06550002
EIGHT    EQU   8                                                        06600002
SIXTEEN  EQU   16                                                       06700002
TWENTY   EQU   20                  VALUE FOR COMPARE                    06750002
B1       EQU   1                   USED AS A SHIFT VALUE TO DIVIDE BY 2 06800002
PLUS     EQU   C'+'                USED IN IMMEDIATE OPERANDS           06950002
MINUS    EQU   C'-'                USED IN IMMEDIATE OPERANDS           07000002
QUOTE    EQU   C''''               USED FOR SCANNING CHAR STRINGS.      07050002
ODD      EQU   X'01'               FOR TESTING WHETHER AN ADDR IS ODD.  07100002
R10OFF   EQU   60                  OFFSET INTO SAVE AREA FOR R10        07150002
M2OFFSET EQU   80                  OFFSET INTO BUFFER FOR 2ND LEVEL MSG 07200002
LL00IDL  EQU   14                  LENGTH OF LL00 AND ID FLDS OF MSG    07250002
CGRPLEN  EQU   64                  QUANTITY OF CHAR DATA FOR ONE GROUP  07450002
         SPACE                                                          07500002
FOREPTR  EQU   8                   OFFSET TO FOREWARD PTR IN SAVE AREA  07550002
BACKPTR  EQU   4                   OFFSET TO BACKWARD PTR IN SAVE AREA  07600002
CONLNTH  EQU   0                   OFFSET INTO CONVERT OUTPUT FOR LNTH  07650002
CONDATA  EQU   1                   OFFSET INTO CONVERT OUTPUT FOR DATA  07700002
         SPACE                                                          07850002
LOTOHI   EQU   24                  SHIFT VALUE TO GET LOW BYTE TO HIGH  07900002
LOGONBIT EQU   X'40'               FOR TESTING AND ECB FOR LOGON POSTED 07950002
DWBDY    EQU   B'00000111'         USED TO TEST ADDRS FOR DBL WRD BDY.  08000002
FWBDY    EQU   B'00000011'                                FULL          08050002
HWBDY    EQU   B'00000001'                                HALF          08100002
ASNFIRST EQU   B'00010000'         FIRST TIME SWITCH FOR ASSIGN         08160002
         SPACE                                                          08200002
HEXFF    EQU   X'FF'                                                    08250002
ATTNBIT  EQU   B'01000000'                                              08300002
         SPACE                                                          08350002
*  THE FOLLOWING TABLE CONTAINS THE INTERNAL ASSEMBLER TYPE CODES.      08400002
         SPACE                                                          08450002
CHARCODE EQU   X'00'               TYPE ATTRIBUTE =CHAR                 08500002
HEXCODE  EQU   X'04'                ''     ''     =HEXADECIMAL          08550002
BINCODE  EQU   X'08'                ''     ''     =BINARY               08600002
HCODE    EQU   X'14'                ''     ''       ''   '', HALFWORD   08700002
ECODE    EQU   X'18'                ''     ''     =FLT PT, FULLWORD     08750002
PACKCODE EQU   X'30'                ''     ''     =PACKED DECIMAL       09050002
ZONECODE EQU   X'34'                ''     ''     =ZONED DECIMAL        09100002
         SPACE                                                          09150002
*  SYMBOLIC OFFSETS INTO THE MESSAGE CSECT FOR VARIOUS MESSAGE          09200002
         SPACE                                                          09250002
MSG101   EQU   101                 INVALID ADDRESS+                     09300002
MSG280   EQU   280                 **** WORD BOUNDRY REQUIRED           09350002
INST2    EQU   2                   SECOND FIXED INSERT (HALF)           09400002
INST3    EQU   3                   THIRD FIXED INSERT (FULL)            09450002
INST4    EQU   4                   FOURTH FIXED INSERT (DOUBLE)         09500002
MSG011   EQU   11                  LENGTH ERROR FOR VALUE BEGINNING--   09550002
MSG213   EQU   213                 DATA LENGTH EXCEEDS REGISTER         09650002
MSG012   EQU   12                  DATA TYPE ERROR FOR VALUE BEGINNING  09660002
MSG214   EQU   214                 INVALID DATA TYPES ARE X OR E        09670002
MSG215   EQU   215                 INVALID DATA TYPES ARE X OR D        09680002
MSG013   EQU   13                  DATA AREA CONTAINED BREAKPOINTS      09690002
MSG216   EQU   216                 BREAKPOINTS WERE DEACTIVATED---      09692002
MSG014   EQU   14                  UNABLE TO MODIFY CONTAINS OF REG     09694002
MSG283   EQU   283                 SVC97 NONZERO RETURN CODE            09696002
         EJECT                                                          09700002
         TITLE 'IKJEGASN, ''ASSIGN'' SUBCOMMAND OF TEST, INITIALIZE'    09750002
*********************************************************************** 09800002
*                                                                     * 09850002
*  BEGIN WITH ESTABLISHING ADDRABILITY, NOTE WE DO NOT STORE REGS     * 09900002
*  AS WE ARE ONLY BRANCH ENTERED. R13 WAS NOT BACKED UP...            * 09920002
*                                                                     * 09950002
*********************************************************************** 10000002
         LR    R11,R15             PICK UP ENTRY POINT ADDR FOR BASE    10100002
         USING IKJEGASN,R11                                             10150002
         USING TCOMTAB,R9                                               10200002
*        CROSS CHAINNING OF REGISTER SAVE AREAS IS CORRECT.....         10250002
         SPACE                                                          10300002
         STM   R10,R12,R10OFF(R13) SAVE BASE IN CASE OF ABEND           10350002
         SPACE                                                          10450002
         L     R10,WORKAREA        GET PTR TO WORKING CORE              10500002
         USING TSTCWORK,R10                                             10550002
         LA    R10,CWORKCMD        SET UP BASE OF SUB-CMD WORK CORE     10600002
         USING PCHWORK,R10                                              10650002
         MVI   ASNFLGS1,ZERO       INITIALIZE LOCAL FLAGS               10660002
         SPACE                                                          10700002
*********************************************************************** 11650002
*                                                                     * 11700002
*  AT THIS POINT, INITIALIZATION IS COMPLETE. THE PCHWORK DSECT HAS   * 11750002
*  BEEN SET UP BY IKJEGPCH AND PROCESSING MAY BEGIN.                  * 11800002
*        NEXT, TEST FOR THE 3 SPECIAL TYPES OF C, X, AND Z. IF NONE   * 11850002
*        OF THESE, FALL THROUGH AND GO TO CONVERT.                    * 11900002
*********************************************************************** 11950002
PCH020   EQU   *                                                        12000002
         LA    R8,VPDE                                                  12050002
         USING VALUPDE,R8                                               12100002
         CLI   VALUTYPE,HEXCODE    IS THE TYPE HEX                      12150002
         BE    XTYPE               IF HEX, BRANCH                       12200002
         CLI   VALUTYPE,CHARCODE   IS THE TYPE CHARACTER                12250002
         BE    CTYPE               IF CHARACTER, BRANCH                 12300002
         CLI   VALUTYPE,ZONECODE   IS THE TYPE ZONED DECIMAL            12350002
         BE    ZTYPE               IF ZONED, BRANCH                     12400002
         SPACE                                                          12450002
*  TYPE WAS NOT ONE OF THE SPECIAL 3.  NEXT GO CONVERT THE VALUE.       12500002
*  REGISTERS MUST BE SET UP AS FOLLOWS.                                 12550002
*        0     SET TO ZERO TO SHOW CONVERT TO BINARY                    12600002
*        1     POSITIVE ADDR OF THE VALUE PDE                           12650002
*        14    LINK REGISTER                                            12700002
*        15    ENTRY POINT OF CONVERT ROUTINE                           12750002
         SPACE                                                          12800002
         SR    R0,R0               REG 0 TO ZERO                        12850002
         LA    R1,VPDE             REG 1 = ADDR OF VALUE PDE            12900002
         L     R15,TSTCONVT        GET ADDR OF CONVERT ROUTINE          12950002
         SPACE                                                          13000002
         BALR  R14,R15             GO CONVERT A VALUE                   13050002
         LTR   R15,R15             IS RETURN CODE ZERO                  13100002
         BNZ   CVTRC               IF NON ZERO, BRANCH                  13150002
         SPACE                                                          13200002
         IC    R15,VALUTYPE        GET INPUT FORMAT TYPE                13250002
* PLEASE NOTE THAT A BRANCH TABLE HAS BEEN USED IN LIEU OF NUMEROUS   * 13300002
* TESTS FOR INPUT FORMAT TYPE.                                        * 13350002
         B     TYPEBTBL(R15)       GO TO PROPER ADDRESS ANALYSIS RTN    13400002
         SPACE                                                          13450002
         ORG   *-BINCODE           ELIMINATE SPACE FOR C AND X CODES    13500002
TYPEBTBL EQU   *                                                        13550002
         ORG   *+BINCODE           RESET LOCATION CTR FOR BRANCH TABLE  13600002
         B     BTYPE               CODE X'08' FOR BINARY                13650002
         B     XTYPE               CODE X'0C' THIS CODE NOT USED.       13700002
         B     FTYPE               CODE X'10' FOR FULLWORD FIXED PT     13750002
         B     HTYPE               CODE X'14' FOR HALFWORD FIXED PT     13800002
         B     ETYPE               CODE X'18' FOR SHORT FLT PT          13850002
         B     DTYPE               CODE X'1C' FOR LONG FLT PT           13900002
         B     AQTYPE              CODE X'20' FOR A AND Q ADDR CNSTNTS  13950002
         B     YTYPE               CODE X'24' FOR Y ADDR CONSTANTS      14000002
         B     STYPE               CODE X'28' FOR S ADDR CONSTANTS      14050002
         B     VTYPE               CODE X'2C' FOR V ADDR CONSTANTS      14100002
         B     PTYPE               CODE X'30' FOR PACKED DECIMAL        14150002
         TITLE 'IKJEGASN, ''ASSIGN'' SUBCOMMAND OF TEST, MAIN PROCESS'  14200002
PCH038   EQU   *                                                        14250002
BTYPE    EQU   *                                                        14300002
PTYPE    EQU   *                                                        14350002
         TM    A1TYPE,GENR+SFPR+LFPR   IS ADDRESS TYPE REGISTER         14400002
         BNZ   REGADDR             IF ADDR IS REG TYPE, BRANCH          14450002
PCH040   EQU   *                                                        14500002
         SR    R2,R2               CLEAR REG 2                          14550002
         L     R1,CONAREA          GET PTR TO DATA AREA                 14600002
         IC    R2,CONLNTH(R1)      GET LNTH OF DATA TO BE MOVED         14650002
         BAL   R14,PCHMOVE         GO TO MOVE DATA ROUTINE              14700002
PCH044   EQU   *                                                        14750002
         TM    VALUCHAI,HEXFF      IS THERE ANOTHER VALUE TO PROCESS    14800002
         BO    PCHRET1             IF NO MORE VALUES, BRANCH            14850002
         L     R3,A1               GET LAST OUTPUT ADDR                 14900002
         LA    R3,ONE(R2,R3)       INCRE OUTPUT ADDR BY LAST DATA LNTH  14950002
         ST    R3,A1                                                    15000002
         SPACE                                                          15050002
*  IF MORE VALUES, RESET AND GO BACK FOR NEXT                           15100002
         SPACE                                                          15150002
PCH046   EQU   *                                                        15200002
         L     R4,VALUCHAI         GET ADDR OF NEXT VALUE PDE           15250002
         MVC   VPDE(VALUPDL),ZERO(R4)  MOVE NEXT VALUE PDE TO DSECT     15300002
         OI    TSTFLGS1,PCHLSTVL   TURN ON THE LIST OF VALUES SW        15350002
         B     PCH020              GO BACK THROUGH PROCESS              15400002
         SPACE                                                          15450002
*  TURN OFF SWITCHES USED BY PATCH.                                     15500002
         SPACE                                                          15550002
PCHRET1  EQU   *                                                        15600002
         L     R15,PCHRETCD        PICK UP PRESET RETURN CODE.          15610002
PCHRET1A DS    0H                  RETURN WITH WHAT IS IN R15           15620002
         NI    TSTFLGS1,HEXFF-PCHLSTVL-TSTFIRST                         15650002
         NI    ASNFLGS1,HEXFF-ASNFIRST   TURN OFF SWITCH                15660002
         LR    R2,R15              SAVE THE RETURN CODE                 15670002
         ESTAE 0                   REMOVE THE ESTAE                     15710002
         NI    TSTFLGS4,HEXFF-TSTRERTN  TURN OFF RERTY SW.              15720002
         LR    R15,R2              RESTORE THE RETURN CODE              15730002
         L     R13,BACKPTR(R13)    GET ADDR OF PREVIOUS SAVE AREA.      15750002
         RETURN  (14,12),T,RC=(15) RETURN TO THE CALLER                 15800002
         SPACE                                                          15850002
CVTRC    EQU   *                                                        15900002
         CH    R15,HSIXTEEN        IS THE RETURN CODE 16                15950002
         BE    PCHCC16             IF RC=16, BRANCH TO RC=16 RTN.       16000002
         B     PCHRET1             OTHERWISE, BRANCH TO WRAPUP RTN.     16050002
         SPACE                                                          16100002
PCHCC16  EQU   *                                                        16150002
         LA    R15,SIXTEEN         SETUP A RETURN CODE OF 16.           16200002
         ST    R15,PCHRETCD        STORE RETURN CODE IN RC FIELD.       16250002
         B     PCHRET1             GO RETURN TO CALLER                  16300002
         EJECT                                                          16350002
*********************************************************************** 16400002
*                                                                     * 16450002
*  THE ADDRESS HAS NOW BEEN DETERMINED TO BE A CORE TYPE AND THE DATA * 16500002
*  HAS BEEN CONVERTED TO ITS PROPER CORE FORMAT. THE FOLLOWING CODE   * 16550002
*  WILL--                                                             * 16600002
*                                                                     * 16650002
*        1. INITIALIZE THE REGISTERS TO MOVE THE DATA TO ITS PROPER   * 16700002
*           LOCATION.                                                 * 16750002
*        2. TEST FOR AN ATTENTION POSTED.                             * 16800002
*        3. TEST FOR  A SCHEDULED LOGOFF.                             * 16850002
*        4. REMOVE ANY BREAKPOINT SVC'S FROM THE TARGET AREA          * 16900002
*        5. MOVE THE DATA TO THE REQUESTED LOCATION USING AN EX INSTR * 17000002
*                                                                       17050002
*        AT ENTRY,  R1  POINTS TO THE INPUT DATA ADDR MINUS ONE (1).  * 17100002
*                   R2  CONTAINS THE LENGTH OF DATA TO BE MOVED       * 17150002
*                   R14 CONTAINS THE RETURN ADDRESS.                  * 17200002
*                   A1  CONTAINS THE OUTPUT AREA ADDRESS              * 17250002
*                                                                     * 17300002
*********************************************************************** 17350002
PCHMOVE  EQU   *                                                        17400002
         LR    R7,R14              SAVE REG 14                          17450002
         BCTR  R2,NULL             DECREMENT LNTH FOR THE MVC INSTR     17500002
         SPACE                                                          17550002
         L     R3,ECBTMPA          PICKUP ADDR OF ATTENTION ECB.        17600002
         TM    ZERO(R3),ATTNBIT    IS AN ATTENTION POSTED               17650002
         BO    PCHCC16             BRANCH IF AN ATTENTION WAS POSTED    17700002
         L     R3,ECBLOG           GET PTR TO THE LOGON/LOGOFF ECB      17750002
         TM    ZERO(R3),LOGONBIT   IS LOGOFF SCHEDULED                  17800002
         BO    PCHCC16             IF LOGOFF SCHEDULED, BRANCH          17850002
         BAL   R14,ASNBPT          GO REMOVE BREAKPTS AND BRK ELEMENTS  17900002
         LTR   R15,R15             TEST RETURN CODE FROM BRK-PT RTN     17950002
         BNZ   CVTRC               IF RETURN CODE IS NON-ZERO, BRANCH   18000002
         L     R15,A1              GET A PTR TO THE OUTPUT AREA.        18050002
         EX    R2,DATAMVC1         MOVE DATA TO REQUESTED LOCATION.     18100002
         ENTRY PCHABND1            THIS AN ELEMENT OF PCH ABEND TABLE   18110002
PCHABND1 EQU   *                   MARK ADDRESS OF POTENTIAL ABEND      18150002
         SPACE                                                          18200002
         LR    R14,R7              RESTORE REG 14                       18250002
         BR    R14                 RETURN TO CALLER                     18300002
         EJECT                                                          18350002
*********************************************************************** 18400002
*                                                                     * 18450002
*  THE FOLLOWING ROUTINE PROCESSES DATA STRINGS FOR ZONED TYPE VALUES * 18500002
*  THE ROUTINE PROCESSES THE STRINGS AS FOLLOWS.                      * 18550002
*        1. DETERMINE WHETHER A SIGN WAS SPECIFIED AND SET UP TO USE  * 18600002
*           IT.  ADJUST DATA LENGTH AND PTR IF NECESSARY.             * 18650002
*        2. MOVE DATA TO CONAREA AND RETURN TO MAIN ROUTINE.          * 18700002
*                                                                     * 18750002
*********************************************************************** 18800002
         SPACE                                                          18850002
ZTYPE    EQU   *                                                        18900002
         LA    R4,NEGZONE          SET UP PTR TO A NEGATIVE ZONE.       18950002
         LH    R2,VALULNH          GET THE LENGTH OF DATA STRING        19000002
         L     R15,VALUPTR         GET ADDR OF START OF DATA STRING     19050002
         CLI   ZERO(R15),MINUS     DOES STRING BEGIN WITH A MINUS SIGN  19100002
         BE    SIGN                IF SO, GO ADJUST PTRS FOR SIGN.      19150002
         LA    R4,POSZONE          RESET PTR TO A POSITIVE ZONE         19200002
         CLI   ZERO(R15),PLUS      DOES STRING BEGIN WITH A PLUS SIGN   19250002
         BNE   NOSIGN              IF NOT, SKIP SETUP FOR SIGN.         19300002
SIGN     EQU   *                                                        19350002
         LA    R15,ONE(R15)        INCRE DATA PTR PAST SIGN.            19400002
         BCTR  R2,NULL             DECREMENT LENGTH BY 1 FOR SIGN       19450002
         SPACE                                                          19500002
NOSIGN   EQU   *                                                        19550002
         L     R1,CONAREA          GET ADDR OF CONVERT WORK AREA.       19600002
         STC   R2,CONLNTH(R1)      SET LENGTH OF CONVERTED CONSTANT     19650002
         BCTR  R2,NULL             REDUCE LENGTH FOR MVC INSTR.         19700002
         EX    R2,DATAMVC2         MOVE DATA TO CONAREA.                19750002
         LA    R1,CONDATA(R2,R1)   INCREMENT PTR TO LAST BYTE OF CON.   19800002
         MVZ   ZERO(ONE,R1),ZERO(R4)   MOVE CORRECT ZONE (SIGN) TO CON. 19850002
         B     PCH038              GO PERFORM PATCH                     19900002
         EJECT                                                          19950002
*********************************************************************** 20000002
*                                                                     * 20050002
*  THIS ROUTINE CHECKS BOUNDARY ALIGNMENT AND ADDRESS TYPE FOR        * 20100002
*  FULLWORD TYPE CONSTANTS (A, E, F, Q, AND V).                       * 20150002
*                                                                     * 20200002
*********************************************************************** 20250002
         SPACE                                                          20300002
AQTYPE   EQU   *                                                        20350002
ETYPE    EQU   *                                                        20400002
FTYPE    EQU   *                                                        20450002
VTYPE    EQU   *                                                        20500002
         TM    A1TYPE,SFPR         IS ADDR SINGLE PREC FLT PT REG       20550002
         BO    ETYP10              IF YES, GO CHECK THAT TYPE IS 'E'    20600002
         TM    A1TYPE,LFPR         IS ADDR DBL PREC FLT PT REG          20650002
         BO    DTYPE20             IF YES, GO TO ERR RTN.               20700002
         TM    A1TYPE,GENR         IS ADDR A GENERAL REGISTER           20750002
         BNO   BDYFWTST            IF NOT, GO CHECK BDY FOR CORE PATCH  20800002
REGINCRF EQU   *                                                        20850002
         MVC   ADDRINCR,GRDATA     CONSTANTS FOR GEN REGS TO TEST AREA  20900002
         L     R1,CONAREA          ADDR OF CONVERT AREA                 20950002
         L     R2,A1               GPR TO BE PATCHED INTO R2            21000002
         LA    R8,CONDATA(R1)      INCR DATA PTR PAST LENGTH BYTE       21050002
         MVC   REGDATA,0(R8)       PLACE PATCH VALUE IN FULLWORD        21100002
         L     R8,REGDATA          AND THEN INTO REGISTER EIGHT         21150002
         L     R7,PPTCB            TARGET TCB ADDR FOR SVC97            21200002
         BAL   R14,ATNCHK          CHECK FOR ATN OR LOGOFF IN PROGRESS  21250002
         IKJEGS9G GPR,TCBADDR=(R7),VALUE=(R8),REGNO=(R2),MF=(E,ASNSVCL) 21300002
CHKSVC   EQU   *                                                        21350002
         LTR   R15,R15             TEST SVC RETURN CODE                 21400002
         LA    R8,VPDE             INSURE ADDRESSABILITY TO VALUE PDE   21450002
         BNZ   SVCMSG              BRANCH NONZERO                       21500002
         TM    VALUCHAI,HEXFF      ARE THERE MORE VALUES TO PROCESS     21550002
         BO    PCHRET1             IF NO MORE VALUES, BRANCH            21600002
         L     R2,A1               GET REGISTER NUMBER JUST PATCHED     21650002
         AH    R2,ADDRINCR         ADD  THE ADDR INCREMENT              21700002
         CH    R2,MAXRADDR         IS UPDATED REG  NO. GREATER THAN MAX 21750002
         ST    R2,A1               SAVE UPDATED ADDR, ANTICIPATING OK   21800002
         BNH   PCH046              IF REG NO. NOT GT MAX, BRANCH        21850002
         SR    R2,R2               OTHER WISE, RESET ADDR TO ZERO       21900002
         ST    R2,A1               SAVE RESET REG ADDRESS               21950002
         B     PCH046              GO PROCESS NEXT VALUE                22000002
         SPACE                                                          22050002
ETYP10   EQU   *                                                        22100002
         TM    VALUTYPE,ECODE      IS DATA TYPE 'E'                     22150002
         BO    REGINCRE            IF 'E', BRANCH                       22200002
ETYP20   EQU   *                                                        22250002
         LA    R2,MSG012           R2= MSG NO. 12                       22300002
         LA    R3,MSG214           R3= SECOND LEVEL 214                 22350002
         B     MSGOUTV             OUTPUT INDICATED MSG (VPDE INSERT)   22360002
         EJECT                                                          22400002
*********************************************************************** 22450002
*                                                                     * 22500002
*  THE FOLLOWING CODE TESTS FOR AN ATTENTION                          * 22550002
*                                                                     * 22600002
*********************************************************************** 22650002
         SPACE                                                          22700002
ATNCHK   EQU   *                                                        22750002
         L     R3,ECBTMPA          GET ADDR OF ATTENTION ECB.           22800002
         TM    ZERO(R3),ATTNBIT    IS AN ATTENTION POSTED               22850002
         BO    PCHCC16             IF YES, GO TO CLEANUP ROUTINE.       22900002
         L     R3,ECBLOG           GET PTR TO LOGON ECB                 22950002
         TM    ZERO(R3),LOGONBIT   IS LOGOFF SCHEDULED                  23000002
         BO    PCHCC16             IF YES, BRANCH                       23050002
         BR    R14                 RETURN                               23100002
         SPACE                                                          23150002
SVCMSG   EQU   *                                                        23200002
         LA    R2,SIXTEEN          IS THE SVC RETURN CODE 16 OR ABOVE.  23210002
         CR    R15,R2              R15 GREATER THAN 16?                 23220002
         BH    PCHRET1A            EXIT TO MNL.                         23230002
         LA    R2,MSG014           R2= FIRST LEVEL MSG NO 14            23250002
         LA    R3,MSG283           R3= SECOND LEVEL MSG NO 283          23300002
         B     MSGOUT              OUTPUT THE MSG NO INSERT             23350002
         EJECT                                                          23450002
BDYFWTST EQU   *                                                        23500002
         TM    A1+THREE,FWBDY      TEST IF ADDRESS IS A FULL WORD BDY   23550002
         BZ    PCH040              IF BOUNDARY OK, BRANCH               23600002
         TM    TSTFLGS1,PCHLSTVL   IS VALUE PART OF A LIST OF VALUES    23650002
         BZ    FBDYERR             IF ADDR BDY IS WRONG, GO TO ERR RTN. 23700002
         SPACE                                                          23750002
*********************************************************************** 23800002
*                                                                     * 23850002
*  IF VALUE IS PART OF A LIST OF VALUES, ROUND ADDR UP TO NEXT FULL   * 23900002
*  BOUNDARY BY ADDING 3 THEN ROUNDING DOWN TO AN ADDR THAT ENDS WITH  * 23950002
*  TWO BINARY ZERO'S.                                                 * 24000002
*                                                                     * 24050002
*********************************************************************** 24100002
         SPACE                                                          24150002
         L     R15,A1              GET CURRENT ADDRESS                  24200002
         AL    R15,FTHREE          ADD 3 TO INCRE TO OR PAST NXT F BDY  24250002
         ST    R15,A1              REPLACE ADDRESS                      24300002
         NI    A1+THREE,HEXFF-FWBDY  ROUND ADDR DOWN TO EXACT BDY       24350002
         B     PCH040              GO PATCH A CORE LOCATION             24400002
         SPACE 2                                                        24450002
DTYPE    EQU   *                                                        24500002
         TM    A1TYPE,LFPR         IS ADDR DBL PRECISION FLT PT REG     24550002
         BO    REGINCRD            IF YES, GO SET UP CORRECT CONSTANTS  24600002
         TM    A1TYPE,GENR+SFPR    IS ADDR A 4 BYTE REG TYPE            24650002
         BNZ   LENERR              IF 4 BYTE REG TYPE, BRANCH           24700002
         TM    A1+THREE,DWBDY      IS OUTPUT ADDR ON A DBL WORD BDY     24750002
         BZ    PCH040              IF DBL WORD BDY, BRANCH              24800002
         SPACE                                                          24850002
         TM    TSTFLGS1,PCHLSTVL   IS THIS VALUE PART OF A LIST.        24900002
         BZ    DBDYERR             IF NOT, BRANCH TO ERROR ROUTINE.     24950002
         L     R15,A1              GET ADDR TO BE ROUNDED               25000002
         AL    R15,FSEVEN          INCRE IT TO OR PAST NXT DBL WORD BDY 25050002
         ST    R15,A1              REPLACE ORIGINAL ADDRESS             25100002
         NI    A1+THREE,HEXFF-DWBDY  ROUND ADDR DOWN TO EXACT BDY       25150002
         B     PCH040              GO PATCH AREA OF CORE                25200002
         SPACE                                                          25250002
DTYPE20  EQU   *                                                        25300002
         LA    R2,MSG012           R2= FIRST LEVEL MSG NO 12            25350002
         LA    R3,MSG215           R3= SECOND LEVEL MSG NO 215          25400002
         B     MSGOUTV             OUTPT THE MSG (VPDE INSERT)          25410002
         SPACE 2                                                        25450002
REGADDR  EQU   *                                                        25500002
         L     R3,CONAREA          GET ADDR OF CONVERT OUTPUT AREA      25550002
         USING CONAREA1,R3                                              25600002
         SR    R2,R2               CLEAR REG AND                        25650002
         IC    R2,CONLNTH+CONAREA1 GET LENGTH OF CONVERTED DATA         25700002
         TM    A1TYPE,LFPR         IS ADDR DBL PRECISION FLT PT REG     25750002
         BO    REGADDR1            IF REG ADDR IS 'D' TYPE, BRANCH      25800002
         CH    R2,HFOUR            COMPARE CONSTANT LENGTH TO 4.        25850002
         BE    REGADDR2            IF EQUAL, GO DETERMINE REG TYPE      25900002
         BH    LENERR              IF HIGH, GO TO ERROR ROUTINE.        25950002
         LCR   R2,R2               MAKE LENGTH NEGATIVE.                26000002
         L     R4,CONDATA+CONAREA1  GET LEFT JUSTIFIED CONSTANT         26050002
         AH    R2,HFOUR            SUBTRACT LENGTH FROM 4.              26100002
         SLL   R2,THREE            MULTIPLY LENGTH BY 8 TO GET BIT LNTH 26150002
         SRL   R4,ZERO(R2)         RIGHT JUSTIFY CONSTANT.              26200002
         ST    R4,CONDATA+CONAREA1 STORE RIGHT JUSTIFIED CONSTANT       26250002
         MVI   CONLNTH+CONAREA1,FOUR  STORE LENGTH IN LNTH FIELD        26300002
REGADDR2 EQU   *                                                        26350002
         TM    A1TYPE,GENR         IS REG TYPE GENERAL REGISTER         26400002
         BO    REGINCRF            IF GENERAL REG, BRANCH               26450002
         CLI   VALUTYPE,HEXCODE    IS THE DATA TYPE HEX                 26500002
         BE    REGINCRE            IF HEX, BRANCH                       26550002
         B     ETYP20              IF NOT, GO TO ERROR MSG ROUTINE      26600002
         SPACE                                                          26650002
REGADDR1 EQU   *                                                        26700002
         CLI   VALUTYPE,HEXCODE    IS THE DATA TYPE HEX                 26750002
         BNE   DTYPE20             IF NOT, BRANCH TO ERROR MSG RTN      26800002
         CH    R2,HEIGHT               COMPARE LENGTH TO 8.             26850002
         BE    REGINCRD                IF 8, GO TO REG PATCH ROUTINE.   26900002
         BH    LENERR                  IF GREATER THAN 8, GO TO ERROR.  26950002
         SPACE                                                          27000002
*  IF ADDR IS FOR A DBL PRECISION FLOATING PT REG AND LENGTH IS LESS    27050002
*     THAN 8, RIGHT JUSTIFY THE CONSTANT AND PAD WITH ZEROS.            27100002
         SPACE                                                          27150002
         LCR   R2,R2               MAKE CONSTANT LENGTH NEGATIVE,       27200002
         LM    R4,R5,CONDATA+CONAREA1  PICK UP THE CONVERTED DATA       27250002
         SPACE                                                          27300002
*  THE NEXT INSTRUCTION EFFECTIVELY SUBSTRACTS THE LENGTH FROM 8.       27350002
         SPACE                                                          27400002
         AH    R2,HEIGHT           ADD NEG LENGTH TO PLUS 8.            27450002
         SLL   R2,THREE            MULTIPLY NEG LNTH BY 8 FOR BIT LNTH  27500002
         SRDL  R4,ZERO(R2)         RIGHT JUSTIFY THE CONSTANT           27550002
         STM   R4,R5,CONDATA+CONAREA1  JUSTIFIED/PADDED DATA TO CONAREA 27600002
         MVI   ZERO(R3),EIGHT      SET LENGTH FIELD TO 8.               27650002
REGINCRD EQU   *                                                        27700002
         DROP  R3                  FREE BASE USED FOR CVT OUTPUT AREA   27750002
         MVC   ADDRINCR,FPRDATA                                         27800002
         L     R1,CONAREA          ADDRESS OF CONVERT AREA              27850002
         L     R2,A1               FPR REGISTER TO BE PATCHED INTO R2   27900002
         LA    R8,CONDATA(R1)      INCR DATA PTR PAST LENGTH BYTE       27950002
         L     R7,PPTCB            TARGET TCB ADDR FOR SVC97            28000002
         BAL   R14,ATNCHK          CHECK FOR ATN OR LOGOFF IN PROGRESS  28050002
         IKJEGS9G FPR,TCBADDR=(R7),VALUE=(R8),REGNO=(R2),MF=(E,ASNSVCL) 28100002
         B     CHKSVC              CHECK RETURN CODE FROM SVC97         28150002
         SPACE                                                          28200002
REGINCRE EQU   *                                                        28250002
         OI    A1+THREE,ODD        MAKE REG NUMBER ODD FOR 'E' TYPE     28300002
         B     REGINCRD            GO TO REG PATCH ROUTINE              28350002
         EJECT                                                          28400002
*********************************************************************** 28450002
*                                                                     * 28500002
*  HEX PATCH ROUTINE, DATA IS CONVERTED TO HEX BY IKJEGCVT 4 BYTES    * 28550002
*  AT A TIME. THE LAST OR ONLY FIELD MAY BE LESS THAN 4 BYTES.        * 28600002
*                                                                     * 28650002
*********************************************************************** 28700002
         SPACE                                                          28750002
XTYPE    EQU   *                                                        28800002
         MVC   DUMMYPDE(VALUPDL),VPDE  COPY THE PDE FOR MODIFICATION    28850002
         LH    R2,VALULNH          GET LNTH OF INPUT STRING             28900002
         L     R15,VALUPTR         GET PTR TO INPUT STRING              28950002
         LR    R4,R2               SAVE THE LENGTH OF THE STRING.       29000002
         BCTR  R2,NULL             REDUCE LENGTH FOR TR INSTR.          29050002
         EX    R2,PCHTR            TRANSLATE TO UPPER CASE.             29100002
         LA    R2,EIGHT            SET LIMIT FOR FIELD LENGTH           29150002
         CR    R4,R2               IS INPUT LENGTH GREATER THAN 8       29200002
         BNH   XTYPE04             IF NOT GREATER THAN 8, BRANCH        29250002
         STH   R2,DUMMYPDE+(VALULNH-VALUPDE)  IF GT 8, CNVT 8 AT TIME   29300002
         SPACE                                                          29350002
*  INITIALIZE TO CONVERT A VALUE TO HEX.                                29400002
         SPACE                                                          29450002
XTYPE04  EQU   *                                                        29500002
         L     R2,DUMMYPDE+(VALUPTR-VALUPDE)  PICK UP PTR TO DATA       29550002
         LA    R5,HOLDAREA+ONE     R5=ADDR OF TEMPORARY HOLDING AREA    29600002
         SR    R0,R0               R0=0                                 29650002
         LA    R1,DUMMYPDE         SET PTR TO VALUE PDE FOR CONVERT     29700002
HEXCVT   EQU   *                                                        29750002
         L     R15,TSTCONVT        R15=ADDR OF CONVERT ROUTINE          29800002
         BALR  R14,R15             GO TO CONVERT RTN                    29850002
         LTR    R15,R15            TEST RETURN CODE FROM IKJEGCVT       29900002
         BNZ   CVTRC               IF NON-ZERO, GO ANALYZE              29950002
         L     R15,CONAREA         PICK OF ADDR OF CONVET OUTPUT AREA   30000002
         USING CONAREA1,R15                                             30050002
         LH    R3,DUMMYPDE+(VALULNH-VALUPDE)  GET LNTH OF INPUT         30100002
         L     R14,CONAREA1+CONDATA  PICK UP CONVERTED DATA             30150002
         DROP  R15                                                      30200002
         ST    R14,ZERO(R5)        SAVE IT TEMPORARILY IN HOLD AREA     30250002
         SPACE                                                          30300002
*********************************************************************** 30350002
*  IF THERE ARE MORE THAN 8 BYTES OF INPUT, ADJUST THE POINTERS AND   * 30400002
*   CONTINUE IN THIS LOOP UNTIL ALL DATA HAS BEEN PROCESSED.          * 30450002
*********************************************************************** 30500002
         SPACE                                                          30550002
         SR    R4,R3               DECREMENT AMT TO CONVERT BY AMT DONE 30600002
         BZ    XTYPE08             WHEN ALL BYTES ARE CONVERTED, BRANCH 30650002
         AR    R2,R3               INCREMENT PTR TO INPUT DATA FOR NEXT 30700002
         ST    R2,DUMMYPDE+(VALUPTR-VALUPDE)  UPDATED ADDR IN VALUPDE   30750002
         LA    R5,FOUR(R5)         INCREMENT CUR HOLD AREA PTR          30800002
         CH    R4,HEIGHT           IS REMAINDER LESS THAN 8.            30850002
         BNL   HEXCVT              IF MORE TO CONVERT, BRANCH           30900002
         STH   R4,DUMMYPDE+(VALULNH-VALUPDE)  STORE RMNG LNTH IN PDE    30950002
         B     HEXCVT              GO CONVERT REMAINING DATA            31000002
REGHEX   EQU   *                                                        31050002
         CH    R3,HEIGHT           IS LENGTH OF CONVERTED DATA GT 8.    31100002
         BNL   LENERR              IF 8 OR GREATER, GO TO ERROR RTN     31150002
         LM    R14,R15,HOLDAREA+ONE  PICK UP CONVERTED DATA             31200002
         SRDL  R14,FOUR            RIGHT JUSTIFY CONSTANT               31250002
         STM   R14,R15,HOLDAREA+ONE  PLACE DATA BACK INTO HOLDING AREA  31300002
         L     R15,CONAREA         GET ADDR OF CONVERT OUTPUT AREA      31350002
         LA    R3,ONE(R3)          INCRMENT LENGTH OF OUTPUT DATA       31400002
         B     NOTODD              GO TO COMMON HEX PREP ROUTINE.       31450002
         SPACE                                                          31500002
*********************************************************************** 31550002
*                                                                     * 31600002
*  THE FOLLOWING ROUTINE IS ENTERED WHEN ALL INPUT BYTES HAVE BEEN    * 31650002
*  CONVERTED TO HEX.                                                  * 31700002
*  AT ENTRY, REG 5 POINTS TO THE NEXT AREA OF HOLDAREA                * 31750002
*            REG 14 CONTAINS THE LAST CONVERTED BYTES                 * 31800002
*            REG 15 POINTS TO THE CONVERT AREA                        * 31850002
*                                                                     * 31900002
*********************************************************************** 31950002
         SPACE                                                          32000002
XTYPE08  EQU   *                                                        32050002
         LH    R3,VALULNH          GET TOTAL LNTH OF INPUT STRING       32100002
         SRL   R3,B1               DIVIDE LNTH BY 2, DISCARD REMAINDER  32150002
         TM    VALULNH+ONE,ODD     IS LNTH AN ODD NUMBER OF BYTES       32200002
         BZ    NOTODD              IF NOT, BRANCH                       32250002
         SLL   R14,FOUR            ELIMINATE LEADIN HALF BYTE 0         32300002
         ST    R14,ZERO(R5)        STORE LAST DATA AFTER ADJUSTMENT     32350002
         TM    A1TYPE,GENR+SFPR+LFPR   IS ADDRESS REG TYPE              32400002
         BNZ   REGHEX              IF NOT, TRULY REG, BRANCH            32450002
         L     R2,A1               GET RECIEVING ADDRESS                32500002
         LA    R2,ZERO(R3,R2)      POINT TO LAST BYTE OF TARGET AREA    32550002
         LA    R5,HOLDAREA+ONE     PICK UP ADDR OF HOLDING AREA         32600002
         LA    R4,ZERO(R3,R5)      POINT TO LAST BYTE IN HOLDING AREA   32650002
         SPACE                                                          32700002
*  IF THE NUMBER OF HEX CHARACTERS SUPPLIED IS ODD, GET ONE HEX DIGIT   32750002
*     FROM THE LAST BYTE OF THE TARGET AREA TO FILL OUT THE LAST BYTE   32800002
*         OF PATCH DATA.                                                32850002
         SPACE                                                          32900002
         MVN   ZERO(ONE,R4),ZERO(R2)   MOVE IN 2ND HALF.                32950002
         LA    R3,ONE(R3)          INCREMENT COUNT FOR DATA             33000002
NOTODD   EQU   *                                                        33050002
         L     R15,CONAREA         GET PTR TO CONVERT OUTPUT AREA       33100002
         USING CONAREA1,R15                                             33150002
         STC   R3,CONAREA1         STORE DATA COUNT IN CONVERT LEN FLD  33200002
         BCTR  R3,NULL             DECREMENT COUNT FOR MVC INSTR        33250002
         EX    R3,DATAMVC3         MOVE DATA FROM HOLD TO CONVERT AREA  33300002
         B     PCH038              GO PROCESS DATA.                     33350002
         DROP  R15                                                      33400002
         EJECT                                                          33450002
*********************************************************************** 33500002
*                                                                     * 33550002
*  THE FOLLOWING ROUTINE HANDLES THE TWO BYTE CONSTANTS SUCH AS H, S, * 33600002
*  AND Y.  THE ROUTINE FIRST CHECKS WHETHER THE ADDRESS IS REGISTER OR* 33650002
*  CORE. FOR CORE TYPES THE BOUNDARY ALIGNMENT IS CHECKED AND FOR     * 33700002
*  LISTS OF VALUES, ADJUSTED TO A HALF WORD BOUNDARY.  FOR REGISTER   * 33750002
*  ADDRESSES, A FURTHER CHECK IS MADE TO SEE IF THE CONSTANT TYPE IS  * 33800002
*  'H'.FOR H TYPE CONSTANTS, THE DATA IS EXTENDED TO FULLWORD SIZE TO * 33850002
*  ACCOUNT FOR THE SIGN. S OR Y TYPE CONSTANTS ARE HANDLED AS BYTE    * 33900002
*  CONSTANTS.  FLOATING POINT REGISTER ADDRESSES ARE INVALID.         * 33950002
*                                                                     * 34000002
*********************************************************************** 34050002
         SPACE                                                          34100002
HTYPE    EQU   *                                                        34150002
STYPE    EQU   *                                                        34200002
YTYPE    EQU   *                                                        34250002
         TM    A1TYPE,SFPR         IS ADDRESS A SHORT FLT PT REG TYPE   34300002
         BO    ETYP20              IF YES, BRANCH TO ERROR RTN.         34350002
         TM    A1TYPE,LFPR         IS ADDRESS A LONG FLT PT REG TYPE    34400002
         BO    DTYPE20             IF YES, BRANCH                       34450002
         TM    A1TYPE,GENR         IS ADDRESS A GENERAL REGISTER TYPE   34500002
         BO    HREGADDR            IF GENERAL REGISTER TYPE, BRANCH     34550002
         TM    A1+THREE,HWBDY      IS ADDRESS ON A HALFWORD BDY         34600002
         BZ    PCH040              IF HALF WORD BDY, BRANCH             34650002
         TM    TSTFLGS1,PCHLSTVL   IF DATA PART OF A LIST OF VALUES     34700002
         BNO   HBDYERR             IF NOT, GO TO ERROR TRN              34750002
         SPACE                                                          34800002
*  ADDR HAS BEEN FOUND TO BE A BYTE BDY, AND DATA PART OF A LIST OF   * 34850002
*  VALUES.  THE ADDRESS MUST BE ROUNDED UP TO THE NEXT HALFWORD BDY.  * 34900002
         SPACE                                                          34950002
         L     R15,A1              GET CURRENT ADDRESS                  35000002
         AL    R15,FONE            INCREMENT ADDR TO NEXT HALFWORD BDY  35050002
         ST    R15,A1              SAVE UPDATED ADDR                    35100002
         B     PCH040              GO DO PATCH                          35150002
         SPACE 2                                                        35200002
HREGADDR EQU   *                                                        35250002
         CLI   VALUTYPE,HCODE      IS THE CONSTANT TYPE 'H'             35300002
         BNE   REGADDR             IF NOT, BRANCH TO BYTE TYPE RTN.     35350002
         L     R3,CONAREA          PICK UP ADDR OF CONVERT OUTPUT AREA  35400002
         USING CONAREA1,R3                                              35450002
         LH    R4,CONAREA1+ONE     LOAD 2 BYTE CONSTANT INTO 4 BYTE REG 35500002
         ST    R4,CONAREA1+ONE     STORE EXTENDED CONSTANT BACK.        35550002
         MVI   ZERO(R3),FOUR       SET CONSTANTS LENGTH TO 4.           35600002
         B     REGINCRF            GO PROCESS AS A FULLWORD CONSTANT.   35650002
         DROP  R3                                                       35700002
         EJECT                                                          35750002
*********************************************************************** 35800002
*  ROUTINE TO HANDLE CHARACTER TYPE DATA.                             * 35850002
*        THIS DATA HAS NO MAXIMUM LENGTH RESTRICTION, AND IF THE INPUT* 35900002
*        DATA STRING IS LONGER THAN 64 BYTES, IT MUST BE PROCESSED    * 35950002
*        IN GROUPS OF 63 OR 64 CHARACTERS AT A TIME. THE GROUP SIZE   * 36000002
*        VARIES TO ALLOW EACH STRING BEING PROCESSED TO CONTAIN ONLY  * 36050002
*        PAIRS OF SINGLE QUOTES--- SINCE SINGLE QUOTES ARE A SPECIAL  * 36100002
*        CASE.                                                        * 36150002
*********************************************************************** 36200002
CTYPE    EQU   *                                                        36250002
         L     R2,VALUPTR          PTR TO INPUT STRING                  36300002
         LH    R3,VALULNH          LNTH OF INPUT STRING                 36350002
CTYPE04  EQU   *                                                        36400002
         LA    R4,CGRPLEN          SET UP MAX QUANTITY FOR 1 PASS       36450002
         STH   R3,A1L              SAVE ORIGINAL OR REMAINING LENGTH    36500002
         CR    R3,R4               IS LENGTH OF DATA STRING GT MAX      36550002
         BNH   CTYPE20             IF LENGTH NOT GT MAX, BRANCH         36600002
         LR    R3,R4               SET CURRENT LENGTH TO MAX            36650002
         STH   R3,VALULNH          SAVE LNTH TO BE USED FOR THIS GROUP  36700002
         LA    R5,ZERO(R2,R3)      SET UP PTR TO 1ST BYTE OF NXT GROUP  36750002
         CLI   ZERO(R5),QUOTE      IS THAT CHARACTER A SINGLE QUOTE     36800002
         BNE   CTYPE20             IF NOT, BRANCH                       36850002
         BCTR  R5,NULL             BACK UP PTR TO LAST BYTE OF THIS GRP 36900002
         CLI   ZERO(R5),QUOTE      IS THIS CHARACTER A QUOTE            36950002
         BNE   CTYPE20             IF NOT, BRANCH                       37000002
         SPACE                                                          37050002
*  IF QUOTES EXTEND ACROSS GROUPS, THE FOLLOWING CODE ADJUSTS THE       37100002
*     GROUP LENGTH AS NECESSARY TO INSURE THE GROUP TO BE PROCESSED     37150002
*        CONTAINS ONLY PAIRED SINGLQUOTES. (NO. OF QUOTES/GRP NOT ODD)  37200002
         SPACE                                                          37250002
         LR    R5,R2               GET PTR TO START OF DATA STRING      37300002
         SR    R15,R15             INITIALZE QUOTE COUNTER TO ZERO      37350002
CTYPE08  EQU   *                                                        37400002
         CLI   ZERO(R5),QUOTE      IS THIS DATA CHAR A QUOTE            37450002
         BNE   CTYPE12             IF NOT, BRANCH                       37500002
         LA    R15,ONE(R15)        IF CHAR WAS A QUOTE, INCRE COUNTER   37550002
CTYPE12  EQU   *                                                        37600002
         LA    R5,ONE(R5)          INCRE DATA STRING PTR TO NXT CHAR    37650002
         BCT   R4,CTYPE08          IF MORE CHARACTERS TO CHECK, BRANCH  37700002
         LA    R4,ONE              MAKE A MASK TO ISOLATE LOW ORDER BIT 37750002
         NR    R4,R15              ISOLATE LOW ORDER BIT OF QUOTE COUNT 37800002
         SR    R3,R4               SUBTRACT 1 FROM LNTH IF COUNT ODD    37850002
         STH   R3,VALULNH          STORE ADJUSTED LENGTH IN PDE         37900002
         B     CTYPE20             BO PROCESS THIS GROUP                37950002
         EJECT                                                          38000002
*********************************************************************** 38050002
*                                                                     * 38100002
*  THE FOLLOWING ROUTINE SCANS CHARACTER CONSTANTS FOR SINGLE QUOTES. * 38150002
*  USERS MUST SPECIFY TWO SINGLE QUOTES FOR EACH ONE DESIRED IN THE   * 38200002
*  OUTPUT. THIS ROUTINE SQUEEZES OUT THE EXTRA QUOTES AND MOVES THE   * 38250002
*  PROCESSED CONSTANT TO THE TEMPORARY HOLD AREA. THE CONVERT AREA IS * 38300002
*  NOT USED BECAUSE THE CONSTANT AFTER PROCESSING MAY BE UP TO 64     * 38350002
*  BYTES LONG. IN THIS ROUTINE, REGS ARE USED AS FOLLOWS--            * 38400002
*        R1    POINTS TO NEXT AVAILABLE BYTE IN HOLDARA.              * 38450002
*        R2    POINTS TO THE NEXT INPUT BYTE TO BE TESTED.            * 38500002
*        R3    CONTIANS VALUE LENGTH, IT IS DECREMENTED 1 FOR EACH '' * 38550002
*        R4    CONAINS INCREMENT FOR BXLE INSTR                       * 38600002
*        R5    CONTAINS COMPAREND FOR BYLE INSTR (PTR TO END OF INPUT * 38650002
*        R14   USED TO CALCULATE NUMBER OF BYTES SCANED               * 38700002
*        R15   POINTS TO BEGINNING BYTE OF CURRENT SCAN.              * 38750002
*                                                                     * 38800002
*********************************************************************** 38850002
         SPACE                                                          38900002
CTYPE20  EQU   *                                                        38950002
         L     R1,CONAREA          GET PTR TO CONVERTED DATA AREA       39000002
         LA    R5,ZERO(R3,R2)      SET UP BXLE COMPAREND AS INPUT ADDR  39050002
         LA    R4,ONE              SET BXLE INSTR INCRE                 39100002
         SR    R5,R4                   + LENGTH OF DATA - 1.            39150002
         LR    R15,R2              SAVE STARTING POINT IN STRING.       39200002
         SPACE                                                          39250002
CLOOP    EQU   *                                                        39300002
         CLI   ZERO(R2),QUOTE      IS THIS CHARACTER A SINGLE QUOTE     39350002
         BE    QUOTEFND            BRANCH IF CHAR=QUOTE                 39400002
CLOOP1   EQU   *                                                        39450002
         BXLE  R2,R4,CLOOP         INCRE STRING PTR, LOOP IF MORE TO DO 39500002
         SPACE                                                          39550002
         LR    R14,R2              CALCULATE NUMBER OF BYTES SCANNED    39600002
         SR    R14,R15                 AS CUR STRING PTR - BEGIN PTR.   39650002
         BZ    DONE                IS RESULT IS 0, BRANCH AROUND MVC.   39700002
         BCTR  R14,NULL            DECRE COUNT FOR MVC INSTR            39750002
         EX    R14,DATAMVC2        MOVE REMAINING DATA TO HOLDAREA      39800002
DONE     EQU   *                                                        39850002
         L     R1,CONAREA          GET PTR TO CONVERTED DATA AREA       39900002
         STC   R3,CONLNTH(R1)      STORE LNTH IN CONVERTED DATA AREA    39950002
         SPACE                                                          40000002
*  SETUP TO DO PATCH BY DETERMINING WHETHER ADDRESS IS REG OR CORE      40050002
         TM    A1TYPE,GENR+SFPR+LFPR   IS ADDRESS TYPE REGISTER         40100002
         LR    R5,R3               GET ADJUSTED DATA LNTH OF LAST PATCH 40150002
         BNZ   REGADDR             IF REGISTER TYPE, BRANCH             40200002
         LR    R2,R3               SET UP LENGTH FOR  THE PCHMOVE RTN   40250002
         BAL   R14,PCHMOVE         GO MOVE DATA                         40300002
         LH    R3,A1L              GET REMAINING LNTH OF DATA STRING    40350002
         SH    R3,VALULNH          SUBTRACT THE LNTH JUST PROCESSED     40400002
         BZ    PCH044              IF ALL DATA PROCESSED, BRANCH        40450002
         SPACE                                                          40500002
*  UPDATE THE INPUT AND OUTPUT POINTERS FOR THE DATA ALREADY USED.      40550002
         SPACE                                                          40600002
         L     R2,VALUPTR          GET CURRENT OUTPUT ADDRESS           40650002
         L     R4,A1               GET CURRENT OUTPUT ADDRESS           40700002
         AH    R2,VALULNH          INCRE PTR PAST DATA PROCESSED        40750002
         AR    R4,R5               ADD LNTH OF AREA JUST PATCHED        40800002
         ST    R2,VALUPTR          SAVE UPDATED DATA ADDR IN VALUE PDE  40850002
         STH   R3,VALULNH          SAVE UPDATED LNTH IN VALUE PDE       40900002
         ST    R4,A1               STORE UPDATED OUTPUT ADDRESS         40950002
         B     CTYPE04             GO BACK AND PROCESS MORE OF STRING   41000002
         SPACE                                                          41050002
*********************************************************************** 41100002
*                                                                     * 41150002
*  THIS ROUTINE IS ENTERED WHEN THE CHARACTER SCAN ROUTINE FINDS A    * 41200002
*  SINGLE QUOTE. IT MOVES THE SCANNED DATA TO HOLDAREA, ADJUSTS THE   * 41250002
*  NECESSARY PTRS, AND DECREMENTS THE VALUES LENGTH BY 1.             * 41300002
*                                                                     * 41350002
*********************************************************************** 41400002
         SPACE                                                          41450002
QUOTEFND EQU   *                                                        41500002
         LR    R14,R2              CALCULATE NUMBER OF BYTES SCANNED    41550002
         SR    R14,R15                 AS CUR STRING PTR - BEGIN PTR.   41600002
         EX    R14,DATAMVC2        MOVE SCANNED DATA TO CUR HOLD POS.   41650002
         BCTR  R3,NULL             DECREMENT VALUES LENGTH BY 1.        41700002
         AR    R2,R4               INCREMENT STRING PTR PAST QUOTE.     41750002
         LA    R1,ONE(R14,R1)      INCREMENT CUR HOLD AREA PTR          41800002
         LA    R15,ONE(R2)         RESET BEGIN PTR TO ENXT BYTE TO SCAN 41850002
         B     CLOOP1              GO BACK TO SCAN LOOP AT BXLE INSTR.  41900002
         EJECT                                                          41950002
*********************************************************************** 42000002
*                                                                     * 42050002
*    THIS SECTION OF CODE CONTAINS ALL THE CALLS TO IKJEGIO             42100002
*                                                                     * 42450002
*********************************************************************** 42500002
         SPACE                                                          44150002
MSGOUT   DS    0H                  OUTPUT SINGLE MSG NO INSERT          44152002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO PARM AREA        44154002
         IKJEGSIO MSG,FIRST=(R2),SECOND=(R3),ID=ASN03,MF=(E,TSTIOPRM)   44156002
         B     RETABLE(R15)        CHECK IO RETUNR CODES                44158802
         SPACE                                                          44159202
MSGOUTV  DS    0H                  OUTPTU MSG WITH VPDE INSERT (R8)     44159602
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM AREA         44159702
         IKJEGSIO MSG,FIRST=(R2),SECOND=(R3),INST11=(VPDE,(R8)),       *44159802
               ID=ASN03,MF=(E,TSTIOPRM)   INVOKE IO                     44159902
         B     RETABLE(R15)        CHECK IO RETURN CODES                44173202
         SPACE                                                          44183202
MSGOUTAI DS    0H                  MSG APDE INSERT + STATIC INSERT      44185202
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM AREA         44185602
         IKJEGSIO MSG,FIRST=(R2),SECOND=(R3),INST11=(APDE,APDEADDR),   *44186002
               INST21=(NUM,(R4)),ID=ASN03,MF=(E,TSTIOPRM) INVOKE IO     44186402
         B     RETABLE(R15)        CHECK IO RETURN CODES                44186502
         SPACE                                                          44186602
RETABLE  DS    0H                  RETURN CODE CHECK TABLE              44191002
         B     RETMNL00            RETURN TO MNL WITH ZERO IO=0         44193002
         B     RETMNL00            RETURN TO MNL WITH ZERO IO=4         44195402
         B     RETMNL00            RETURN TO MNL WITH ZERO IO=8         44195502
         B     RETMNL00            RETURN TO MNL WITH ZERO IO=12        44209102
         B     PCHRET1A            RETURN TO MNL WITH R C IO=16         44219102
         B     PCHRET1A            RETURN TO MNL WITH R C IO=20         44221102
         B     PCHRET1A            RETURN TO MNL WITH R C IO=24         44221502
         SPACE                                                          44221902
RETMNL00 DS    0H                  RETURN TO MNL WITH A ZERO            44222302
         XC    PCHRETCD(L'PCHRETCD),PCHRETCD CLEAR RETURN CODE          44222702
         B     PCHRET1             RETURN TO MNL WITH ZERO              44227202
         EJECT                                                          44231902
HBDYERR  EQU   *                                                        44236402
         LA    R4,INST2            R4= INSERT NO 2 (HALF)               44386402
         B     SETMSGA             OUTPUT THE MESSAGE                   44436402
         SPACE                                                          44450002
FBDYERR  EQU   *                                                        44500002
         LA    R4,INST3            R4= INSERT NO 3 (FULL)               44550002
         B     SETMSGA             OUTPUT THE MESSAGE                   44600002
         SPACE                                                          44750002
DBDYERR  EQU   *                                                        44800002
         LA    R4,INST4            R4= INSERT NO 4 (DOUBLE)             44810002
         SPACE                                                          44870002
SETMSGA  DS    0H                  SET MSG NO'S.                        44880002
         LA    R2,MSG101           R2= FIRST LEVEL MSG NO 101           44920002
         LA    R3,MSG280           R3= SECOND LEVEL MSG NO 280          44970002
         B     MSGOUTAI            OUTPUT THE MESSAGE                   45020002
         SPACE                                                          45150002
LENERR   EQU   *                                                        45200002
         LA    R2,MSG011           R2= FIRST LEVEL MSG NO 11            45250002
         LA    R3,MSG213           R3= SECOND LEVEL MSG NO 213          45300002
         B     MSGOUTV             OUTPUT MSG WITH VPDE INSERT (R8)     45350002
         SPACE                                                          45400002
         EJECT                                                          47250002
*********************************************************************** 47300002
*                                                                     * 47350002
*  THIS CLOSED SUBROUTINE CALLS THE BRK ELEMENT SRCH ROUTINE TO CHECK * 47400002
*  BREAK POINTS BY SEARCHING THE BREAK ELEMENT QUEUE FOR ADDRESSES    * 47450002
*  WHICH FALL WITHIN THE AREA ABOUT TO BE PATCHED.                    * 47500002
*  WHEN A BREAK POINT IS FOUND WITHIN THE TARGET AREA, THE ORIGINAL   * 47550002
*  DATA IS MOVED FROM THE BREAK ELEMENT BACK TO ITS ORIGINAL LOCATION * 47600002
*  OVERLAYING THE BREAK POINT SVC. THE BREAK ELEMENT IS REMOVED       * 47650002
*  AND A SWITCH IS SET INDICATING A MESSAGE MUST BE ISSUED            * 47700002
*  TO TELL THE USER THAT BREAKPOINTS HAVE BEEN OVERLAYED.             * 47750002
*                                                                     * 47800002
*  INPUT  A1=START ADDRESS OF THE TARGET AREA                         * 47850002
*         R2 CONTAINS THE LENGTH OF THE PATCH DATA                    * 47900002
*         R1 CONTAINS THE ADDRESS OF THE INPUT PATCH DATA             * 47950002
*  OUTPUT R15 CONTAINS A RETURN CODE OF ZERO, OR THE ERROR RETURN     * 48000002
*             CODE FROM IKJEGIO OR IKJEGSRH.                          * 48050002
*                                                                     * 48100002
*********************************************************************** 48150002
ASNBPT   EQU   *                                                        48200002
         SAVE  (14,12)             STANDARD SAVE                        48250002
         L     R15,REGSAVE3        PTR TO 2ND SUB-CMD SAVE AREA         48300002
         ST    R15,FOREPTR(ZERO,R13)   FORWARD AND                      48350002
         ST    R13,BACKPTR(ZERO,R15)       BACKWARD CHAIN SAVE AREAS    48400002
         LR    R13,R15             ESTABLISH NEW SAVE AREA              48450002
         SR    R15,R15             PRESET RETURN CODE TO ZERO           48500002
         L     R3,A1               GET START ADDR OF AREA TO PATCH      48550002
         LA    R4,ZERO(R2,R3)      CALCULATE DATA END ADDRESS           48600002
         LA    R3,ZERO(R3)         CLEAR HIGH ORDER BYTE                48650002
         LA    R1,ASNSVCL          ADDRESS OF PARAMETER LIST            48700002
         LA    R2,EIGHT            INDICATE SEARCH OF RANGE             48750002
         STM   R2,R4,0(R1)         STORE INTO PARAMETER LIST            48800002
         L     R15,TSTSRHRT        ADDRESS OF BREAKPOINT PROCESSOR      48850002
         BALR  R14,R15             BRANCH AND PROCESS BREAKPOINTS       48900002
         LTR   R15,R15             TEST RETURN CODE FROM BRKPT ROUTINE  48950002
         BZ    ASNBPT10            BRANCH IF BRKPTS FOUND AND REMOVED   49000002
         CH    R15,HEIGHT          IS RETURN CODE TWELVE                49050002
         BH    ASNBPT20            BRANCH IF SRH ENTERED STAE RETRY     49100002
         LA    R15,ZERO            TRY PATCH EVEN THO BRKPT NOT FOUND   49150002
         B     ASNBPT30            RETURN TO MAIN LINE OF CODE          49200002
ASNBPT10 TM    ASNFLGS1,ASNFIRST   HAS MESSAGE BEEN ISSUED              49250002
         BZ    ASNBPT50            IF NOT, PLEASE DO SO                 49300002
         B     ASNBPT30            OTHERWISE, RETURN TO CALLER          49350002
ASNBPT20 LA    R15,TWENTY          TELL IKJEGMNL SOMETHINGS AMISS       49400002
         ST    R15,PCHRETCD        SAVE RETURN CODE                     49450002
ASNBPT30 EQU   *                                                        50850002
         L     R13,BACKPTR(ZERO,R13)   GET CALLERS SAVE AREA ADDR       50900002
         RETURN (14,12),RC=(15)    RETURN TO CALLER                     50950002
         SPACE                                                          51000002
*********************************************************************** 51050002
*  IF A BREAK POINT IS FOUND IN THE RANGE, THE FOLLOWING CODE           51100002
*  WILL CALL IO MODULE TO NOTIFY USER THAT BREAKPOINT HAS BEEN RMVD.    51150002
*********************************************************************** 51200002
         SPACE                                                          51250002
ASNBPT50 EQU   *                                                        51850002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM AREA         51900002
         LA    R2,MSG013           R2 = FIRST LEVEL MSG NO 13           51910002
         LA    R3,MSG216           R3 = SECOND LEVEL MSG NO.            51920002
         IKJEGSIO MSG,FIRST=(R2),SECOND=(R3),ID=ASN03,MF=(E,TSTIOPRM)   51950002
         LTR   R15,R15             TEST RC FROM IKJEGIO                 52050002
         BNZ   ASNBPT30            IF RETURN CODE NON-ZERO, BRANCH      52100002
         OI    ASNFLGS1,ASNFIRST   INDICATE MSG HAS BEEN ISSUED         52150002
         B     ASNBPT30            RETURN TO CALLING ROUTINE            52200002
         EJECT                                                          53950002
DATAMVC1 MVC   ZERO(NULL,R15),ONE(R1)  MOVES DATA TO USER CORE          53960002
DATAMVC2 MVC   ONE(ZERO,R1),ZERO(R15)  MOVES DATA INTO CONAREA          53970002
DATAMVC3 MVC   ONE(ZERO,R15),HOLDAREA+ONE MOVES DATA FROM HOLD          53980002
****                               AERA TO CONAREA                      53990002
PCHTR    TR    ZERO(ZERO,R15),PCHTRTBL  FOR TRANSLATION TO UPPER CASE   53992002
         SPACE                                                          53994002
NEGZONE  DC    Z'-1'               BYTE WITH NEGATIVE ZONE FIELD.       54000002
POSZONE  DC    Z'+1'               BYTE WITH POSITIVE ZONE FIELD.       54050002
         SPACE 2                                                        54100002
FONE     DC    F'1'                FOR ROUNDING HALFWORD ADDRS          54150002
FTHREE   DC    F'3'                *            FULLWORD                54200002
FSEVEN   DC    F'7'                *            DBL WORD                54250002
         SPACE                                                          54350002
HFOUR    DC    H'4'                CONSTANT 4 HALF WORD                 54710002
HEIGHT   DC    H'8'                CONSTANT 8 HALF WORD                 54720002
HSIXTEEN DC    H'16'               CONSTANT 16 HALF WORD                54770002
         SPACE                                                          54820002
GRDATA   DS    0F                                                       54830002
GRINCR   DC    H'1'                INCRE VALUE FOR GEN REG ADDRS        54850002
GRLIM    DC    H'15'               MAX GEN REG ADDR                     54900002
         SPACE                                                          54950002
FPRDATA  DS    0F                                                       55000002
FPRINCR  DC    H'2'                INCRE VALUE FOR FL PT REGS.          55050002
         SPACE                                                          55500002
         EJECT                                                          55750002
PCHTRTBL DC    256AL1(*-PCHTRTBL)  LOWER TO UPPER CASE TR TABLE         55800002
         ORG   PCHTRTBL+C'A'-X'40' SET LOCATION CTR TO LOWER CASE 'A'   55850002
         DC    (C'Z'-C'A'+1)AL1(*-PCHTRTBL+X'40')  DEFINES UPPER CASE   55900002
         ORG                                                            55950002
SUPERZAP DC    50C'Z'              MAINTENANCE AREA                     56000002
         EJECT                                                          56050002
*                                                                       62750002
*        FOLLOWING IS A MAP OF THE WORK AREA USED BY THE PATCH MODULES  62800002
*                                                                       62850002
PCHWORK  DSECT                                                          62900002
PPCL     DS    7F                  SPACE FOR PARSE PARM LIST            63100002
         SPACE                                                          63150002
ADDRINCR DS    F                   FULLWORD TO HOLD CONSTANTS FOR REGS  63200002
MAXRADDR EQU   ADDRINCR+2          OFFSET FOR MAX REG NUMBER            63250002
PCHRETCD DS    F                   HOLDS CURRENT RETURN CODE            63300002
VPDE     DS    3F                  HOLDS CURRENT COPY OF THE VALUE PDE  63350002
A1       DS    F                   HLODS CURRENT ADDR TO BE PATCHED     63400002
DUMMYPDE DS    3F                  RESERVE SPACE FOR COPY OF VALUE PDE. 63450002
A1L      DS    H                   HOLDS CURRENT STRING LNTH FOR 'C'    63500002
A1TYPE   DS    X                   CONTAINS TYPE ASSOCIATED WITH VALUE  63550002
         DS    AL3                 RESERVED                             63600002
         DS    XL1                 RESERVED                             63650002
         DS    0D                                                       63700002
         ORG   *-1                 POSITION FOR LENGTH BYTE OF HOLDAREA 63750002
CONAREA1 DS    XL41                USED FOR ADDRESSING PURPOSES ONLY.   63800002
         ORG   CONAREA1            RE-USE SPACE FOR ACTUAL HOLDAREA     63850002
HOLDAREA DS    XL65                TEMP HOLD AREA FOR DATA CONVERSION   63900002
MSGPLIST DS    2F                  PARM LIST FOR CALLING IKJEGIO1.      63950002
TYPESAVE DS    C                   FOR SAVING USER SUPPLIED TYPE CODE   64050002
REGDATA  DS    F                   PATCH VALUE TO BE PLACED IN REGISTER 64100002
ASNSVCL  DS    3F                  FOR SVC97 & IKJEGSRH PARAMETER LIST  64150002
APDEADDR DS    F                   ADDR OF THE ADDR PDE                 64152002
ASNFLGS1 DS    X                   FLAGS FOR EXCLUSIVE USE OF ASSIGN    64160002
LPCHWORK EQU   *-PCHWORK           LENGTH OF TOTAL DSECT.               64200002
         EJECT                                                          64250002
         VALUPDE                                                        64300002
         EJECT                                                          64350002
         BRKELEM                                                        64400002
         SPACE 3                                                        64450002
         TSTCWORK                  EXPAND TEST'S CORE MAPPING DSECT     64500002
         EJECT                                                          64550002
         TCOMTAB                                                        64600002
         EJECT                                                          64650002
         IKJPARMA                  EXPAND THE ADDR PDE MAPPING DSECT    64700002
         EJECT                                                          64750002
CVT      DSECT                                                          64800002
         CVT                                                            64850002
         EJECT                                                          64900002
         IKJTCB                                                         64950002
         END                                                            65000002
./  ADD  SSI=33180099,NAME=IKJEGAT
AT       TITLE 'IKJEGAT - AT SUBCOMMAND OF TSO/TEST'                    00010002
         COPY  IKJEGSIO                                                 00010802
IKJEGAT  CSECT                                                          00480002
         EJECT                                                          00482002
*****************************  PROLOGUE  ****************************** 00490002
*                                                                     * 00500002
* STATUS                                                              * 00510002
*    CHANGE LEVEL 00, RELEASE NUMBER 02, VS2    03/02/73              * 00520002
*                                                                     * 00530002
* FUNCTION/OPERATION                                                  * 00540002
*    THIS MODULE CONTAINS LOGIC FOR THE AT SUBCOMMAND OF THE 'TEST'   * 00550002
*    PACKAGE FOR THE TIME SHARING OPTION (TSO) FOR AOS/2.  IT         * 00560002
*    HAS TWO FUNCTIONS-                                               * 00570002
*    1.  DETERMINE IF AT WAS ISSUED FOR A DEFER REQUEST OR TO MAKE    * 00580002
*    ACTIVE BREAKPOINTS.  IF THE REQUEST IS TO ALTER THE DEFER        * 00590002
*    QUEUE, THIS MODULE XCTL'S TO THE SECOND LOAD OF AT.              * 00600002
*    2.  INSERT BREAKPOINTS AT SPECIFIED LOCATIONS IN THE PROBLEM     * 00610002
*    PROGRAM AND SAVE ANY ASSOCIATED SUBCOMMAND CHAIN FOR THE         * 00620002
*    ADDRESSES SPECIFIED.                                             * 00630002
*                                                                     * 00640002
* ENTRY POINTS                                                        * 00650002
*         IKJEGAT - DETERMINES WHETHER THE MODULE WAS ENTERED         * 00660002
*    BECAUSE OF A USER REQUEST OR BECAUSE A NEW LOAD MODULE           * 00670002
*    HAS BEEN BROUGHT INTO CORE AND IT IS NECESSARY TO SEARCH         * 00680002
*    THE DEFER QUEUE FOR REQUESTS AGAINST THAT MODULE.                * 00690002
*                                                                     * 00700002
* INPUT                                                               * 00710002
*    A FLAG (TSTFLGS1) IN THE COMMUNICATIONS TABLE INDICATES          * 00720002
*    THE TYPE OF ENTRANCE.  WHEN THE AT ROUTINE IS ENTERED BECAUSE    * 00730002
*    A NEW MODULE HAS BEEN BROUGHT INTO CORE, THE FIRST TWO WORDS     * 00740002
*    IN AT'S WORK AREA WILL CONTAIN THE NAME OF THE MODULE.           * 00750002
*                                                                     * 00760002
* OUTPUT                                                              * 00770002
*    OUTPUT CONSISTS OF-                                              * 00780002
*    1.  DIAGNOSTIC MESSAGES.                                         * 00790002
*    2.  A BREAK ELEMENT QUEUE POINTED TO BY BREAKTAB IN TCOMTAB IN   * 00800002
*    THE FORMAT DESCRIBED BY THE BRKELEM DSECT.                       * 00810002
*    3.  RETURN CODES AS LISTED BELOW-                                * 00820002
*                                                                     * 00830002
*    0 - MAINLINE MAY REISSUE TEST MODE MESSAGE TO GET ANOTHER        * 00840002
*    SUBCOMMAND. TSTFLUSH IN TCOMTAB IS ON IF ERROR OCCURRED.         * 00850002
*    4 - RESUME PROBLEM PROGRAM - USED ONLY WHEN ACTIVATING DEFERRED  * 00860002
*    BREAKPOINTS. TSTFLUSH IN TCOMTAB IS ON IF ERROR OCCURRED.        * 00865002
*    16 - ATTENTION HAS BEEN SCHEDULED                                * 00870002
*    20 - INDICATE RETURN FROM RETRY ROUTINE                          * 00880002
*    24 - INDICATES AN ESTAE MACRO FAILURE                            * 00882002
*                                                                     * 00890002
* EXTERNAL REFERENCES                                                 * 00900002
*         1.  IKJPARS - TO SCAN THE INPUT BUFFER FOR SYNTAX CHECKING  * 00910002
*    OF ADDRESSES AND KEYWORDS IF SPECIFIED AND TO PROMPT THE         * 00920002
*    USER FOR VALID INPUT WHEN NECESSARY.  AT ENTRY TO IKJPARS        * 00930002
*    REGISTER ONE POINTS TO A PARAMETER LIST WITH THE                 * 00940002
*    FOLLOWING FORMAT-                                                * 00950002
*                                                                     * 00960002
*         0 - POINTER TO UPT                                          * 00970002
*         4 - POINTER TO ECT                                          * 00980002
*         8 - POINTER TO CP ECB                                       * 00990002
*         12 - POINTER TO PARAMETER DESCRIPTOR CONTROL LIST           * 01000002
*         16 - POINTER TO ANSWER PLACE                                * 01010002
*         20 - POINTER TO COMMAND BUFFER                              * 01020002
*         24 - POINTER TO USER WORK AREA (AT'S SAVE AREA)             * 01030002
*                                                                     * 01040002
*         2.  IKJEGCVT - CONVERTS AN ABSOLUTE ADDRESS, AN EXPRESSION, * 01050002
*    AN INDIRECT ADDRESS, OR A FULLY QUALIFIED ADDRESS TO             * 01060002
*    BINARY.  AT ENTRY, REGISTER ONE CONTAINS THE COMPLEMENT          * 01070002
*    OF THE PDE ADDRESS TO INDICATE AN ADDRESS CONVERSION             * 01080002
*    AND REGISTER ZERO IS SET TO ZERO TO INDICATE A CONVERT           * 01090002
*    TO BINARY. IN MOST CASES A SWITCH MUST BE SET IN TCOMTAB         * 01100002
*    TO TELL CONVERT THAT A RANGE IS POSSIBLE.  FOR A VALUE           * 01110002
*    CONVERSION TO BINARY REGISTER 1 CONTAINS A POINTER TO THE        * 01120002
*    COUNT PDE AND REGISTER 0 CONTAINS ZERO.                          * 01130002
*                                                                     * 01180002
* EXITS, NORMAL                                                       * 01190002
*    IF IT IS DETERMINED THAT AT WAS ISSUED TO PUT A DEFER BREAK      * 01200002
*    ELEMENT ON THE QUEUE, THIS MODULE XCTL'S TO THE SECOND LOAD      * 01210002
*    MODULE OF AT, IKJEGATD.  OTHERWISE, RETURN IS VIA REGISTER       * 01220002
*    14 TO THE CALLER.                                                * 01230002
*                                                                     * 01240002
* EXITS, ERROR                                                        * 01250002
*    RETURN VIA REGISTER 14 TO THE CALLER.                            * 01260002
*                                                                     * 01270002
* TABLES/WORK AREAS                                                   * 01280002
*    THIS MODULE USES WORK AREAS AS DESCRIBED BY THE FOLLOWING DSECTS * 01290002
*    1.  TCOMTAB - TEST'S COMMUNICATION WORK AREA                     * 01300002
*    2.  WORKSP - AT'S WORK AREA, A PART OF TEST'S WORK AREA DEFINED  * 01310002
*    BY THE TSTCWORK DSECT AS CWORKCMD                                * 01320002
*    3.  IKJPARMD - INFORMATION FROM IKJPARS                          * 01330002
*    4.  CONPLACE - INFORMATION FROM IKJEGCVT                         * 01340002
*                                                                     * 01350002
* ATTRIBUTES                                                          * 01360002
*    REENTRANT, REFRESHABLE.                                          * 01370002
*                                                                     * 01380002
* CHARACTER CODE DEPENDENCY                                           * 01390002
*    THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL REPRESEN-  * 01400002
*    TATION OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT TO THE  * 01410002
*    ONE USED AT ASSEMBLY TIME.  THE CODING HAS BEEN ARRANGED SO THAT * 01420002
*    REDEFINITION OF 'CHARACTER' CONSTANTS, BY REASSEMBLY, WILL RESULT* 01430002
*    IN A CORRECT MODULE FOR THE NEW DEFINITIONS.                     * 01440002
*                                                                     * 01450002
* NOTES                                                               * 01460002
*    NONE.                                                            * 01470002
*                                                                     * 01480002
*********************************************************************** 01490002
         EJECT                                                          01500002
*********************************************************************** 01510002
*                                                                     * 01520002
*                   EQUATES                                           * 01530002
*                                                                     * 01540002
*********************************************************************** 01550002
         SPACE                                                          01560002
R0       EQU   0                        REGISTER 0 - PARM REG           01570002
R1       EQU   1                        REGISTER 1 - WORKREG            01580002
R2       EQU   2                        REGISTER 2 - WORKREG            01590002
R3       EQU   3                        REGISTER 3 - RESERVED FOR       01600002
*                                       MAINTENANCE                     01610002
R4       EQU   4                        REGISTER 4 - WORKREG            01620002
R5       EQU   5                        REGISTER 5 - WORKREG - USED     01630002
*                                       FOR BALS TO INTERNAL RTNS       01640002
R6       EQU   6                        REGISTER 6 - WORKREG            01650002
R7       EQU   7                        REGISTER 7 - WORKREG            01660002
R8       EQU   8                        REGISTER 8 - WORKREG - IN ADDR  01670002
*                                       EXITS, SAVES ADDRESS OF WORD    01672002
*                                       TO SEND 2ND LVL MSGS TO PARSE   01674002
R9       EQU   9                        REGISTER 9 - BASE FOR TCOMTAB   01680002
R10      EQU   10                       REGISTER 10 - BASE FOR COMMON   01690002
*                                       WORKAREA                        01700002
R11      EQU   11                       REGISTER 11 - BASE FOR ADDRESS  01710002
*                                       PDE                             01720002
R12      EQU   12                       REGISTER 12 - AT'S BASE         01730002
*                                       REGISTER                        01740002
R13      EQU   13                       REGISTER 13 - SAVE AREA PTR     01750002
R14      EQU   14                       REGISTER 14 - FOR EXTERNAL      01760002
*                                       BALRS                           01770002
R15      EQU   15                       REGISTER 15 - WORKREG, RETURN   01780002
*                                       CODE REG                        01790002
         SPACE                                                          01800002
ZERO     EQU   0                        NUMBER 0                        01810002
ONE      EQU   1                        NUMBER 1                        01820002
TWO      EQU   2                        NUMBER 2                        01830002
THREE    EQU   3                        NUMBER 3                        01840002
FOUR     EQU   4                        NUMBER 4                        01850002
EIGHT    EQU   8                        NUMBER 8                        01860002
TWELVE   EQU   12                       NUMBER 12                       01870002
SIXTEEN  EQU   16                       NUMBER 16                       01880002
TWENTY   EQU   20                       NUMBER 20                       01890002
TWENTY4  EQU   24                       NUMBER 24                       01900002
TWENTY6  EQU   26                       NUMBER 26                       01910002
TWENTY8  EQU   28                       NUMBER 28                       01920002
THIRTY   EQU   30                       NUMBER 30                       01930002
FORTY3   EQU   43                       NUMBER 43                       01940002
FORTY6   EQU   46                       NUMBER 46                       01950002
FORTY7   EQU   47                       NUMBER 47                       01960002
         SPACE                                                          01970002
L1       EQU   1                        LENGTH OF 1                     01980002
L2       EQU   2                        LENGTH OF 2                     01990002
L3       EQU   3                        LENGTH OF 3                     02000002
L4       EQU   4                        LENGTH OF 4                     02010002
L5       EQU   5                        LENGTH OF 5                     02020002
L6       EQU   6                        LENGTH OF 6                     02030002
L25      EQU   25                       LENGTH OF 25                    02040002
L30      EQU   30                       LENGTH OF 30                    02050002
L34      EQU   34                       LENGTH OF 34                    02060002
L46      EQU   46                       LENGTH OF 46                    02070002
L69      EQU   69                       LENGTH OF 69                    02080002
L98      EQU   98                       LENGTH OF 98                    02090002
         SPACE                                                          02100002
D0       EQU   0                        DISPLACEMENT OF 0               02110002
D1       EQU   1                        DISPLACEMENT OF 1               02120002
D2       EQU   2                        DISPLACEMENT OF 2               02130002
D3       EQU   3                        DISPLACEMENT OF 3               02140002
D4       EQU   4                        DISPLACEMENT OF 4               02150002
D6       EQU   6                        DISPLACEMENT OF 6               02160002
D7       EQU   7                        DISPLACEMENT OF 7               02170002
D8       EQU   8                        DISPLACEMENT OF 8               02180002
         SPACE                                                          02190002
FACTOR   EQU   8                        DISPLACEMENT FOR MESSAGE        02200002
*                                       POINTERS                        02210002
BAL      EQU   X'45'                    BAL OP CODE.                    02220002
BALR     EQU   X'05'                    BALR OP CODE.                   02230002
LENBITS  EQU   X'C0'                    LENGTH BITS OF OP CODE.         02260002
HEX00    EQU   X'00'                    BYTE OF ZEROS                   02270002
HEXB2    EQU   X'B2'                    USED IN 370 OP CODE CHECK       02280002
HEXFF    EQU   X'FF'                    END FLAG FOR PARSE'S PARM LIST  02290002
FF       EQU   X'FF'                    TEST MASK FOR KEYWORDS          02300002
BADBOUND EQU   X'01'                    SETTING TO TEST FOR ADDRESS ON  02310002
*                                       HALFWORD BOUNDARY               02320002
BLANK    EQU   C' '                     BLANK                           02330002
PLUS     EQU   C'+'                     CHARACTER PLUS SIGN             02340002
FCODE    EQU   X'10'                    FULLWORD DECIMAL TYPE CODE      02350002
CZERO    EQU   C'0'                     CHARACTER ZERO                  02360002
F0       EQU   X'F0'                    ZERO                            02370002
TESTSVC  EQU   97                       TEST'S SVC NUMBER               02380002
MAXLEN   EQU   255                      MAXIMUM LENGTH OF               02390002
*                                       SUBCOMMAND CHAIN                02400002
OVLYBIT  EQU   X'20'                    FLAG TO INDICATE OVERLAY        02410002
TWOHIGH  EQU   X'13'                    MAXIMUM VALUE OF SECOND         02420002
*                                       BYTE OF VALID TWO-BYTE OP CODE  02430002
SVC10NO  EQU   10            SVC 10 NUMBER-GETMAIN                      02480002
SVC120NO EQU   120           SVC 120 NUMBER-FREEMAIN                    02530002
RC24     EQU   24            RETURN CODE 24                             02540002
         EJECT                                                          02580002
*********************************************************************** 02590002
*                                                                     * 02600002
*                  AT PROCESSING STARTS HERE                          * 02610002
*                                                                     * 02620002
*********************************************************************** 02630002
         USING TCOMTAB,R9               ESTABLISH ADDRESSABILITY TO     02640002
*                                       COMMUNICATION WORK AREA         02650002
         USING TSTCWORK,R10             R10 IS USED AS A BASE FOR       02660002
*                                       COMMON WORKAREA                 02670002
         SPACE                                                          02680002
         SAVE (14,12),,IKJEGAT          SAVE CALLER'S REGISTERS         02690002
         LR    R12,R15                  ESTABLISH ADDRESSABILITY        02700002
         USING IKJEGAT,R12              FOR THIS CSECT                  02710002
         L     R5,REGSAVE2              R5=ADDR OF AT'S SAVE AREA       02720002
         ST    R13,SAVELAST-SAVEAREA(R5)  STORE BACKWARD CHAIN PTR      02730002
         ST    R5,SAVENEXT-SAVEAREA(R13)  STORE FORWARD POINTER         02740002
         LR    R13,R5                   R13=ADDRESS OF AT'S SAVE AREA   02750002
         L     R10,WORKAREA             R10=ADDRESS OF COMMON WORKAREA  02760002
         SPACE                                                          02770002
*********************************************************************** 02780002
*        SET UP AND ISSUE ESTAE FOR ABENDS                            * 02790002
*********************************************************************** 02800002
         XC    STAEL,STAEL   CLEAR ESTAE PARM LIST                      02900002
         L     R15,TSTSTAE   R15=ADDR OF ESTAE EXIT ROUTINE             02902002
         ESTAE (R15),CT,PARAM=ATSPL,XCTL=NO,RECORD=YES,                *02910002
               MF=(E,STAEL) ESTABLISH ESTAE EXIT                        02920002
         LTR   R15,R15                  WAS STAE SUCCESSFUL             02940002
SMTSTAE  BZ    CONTINUE                 YES. CONTINUE.                  02950002
         STC   R15,TSTESTRC  SAVE RETURN CODE FROM ESTAE                02952002
         LA    R15,RC24      SET RETURN CODE TO 24                      02954002
         OI    TSTFLGS4,TSTFLUSH TELL MAINLINE TO FLUSH STACK           02956002
         B     RETMAIN       RETURN TO IKJEGMNL                         02958002
         SPACE                                                          02960002
*********************************************************************** 03070002
*        ESTAE OK. IF AT IS TO ACTIVATE DEFERRED BREAKPOINTS,         * 03080002
*        GO HANDLE THEM.                                              * 03090002
*********************************************************************** 03100002
CONTINUE DS    0H                       PROCESSING AFTER ISSUING STAE   03110002
         TM    TSTFLGS1,TSTBUILD        IS AT LOGIC RECEIVING CONTROL   03120002
*                                       TO CREATE ACTIVE BREAK          03130002
*                                       ELEMENTS FROM THE DEFER         03140002
*                                       QUEUE FOR A NEWLY LOADED        03150002
*                                       MODULE                          03160002
         BO    FROMDEFR                 YES, HANDLE DEFER QUEUE         03170002
         SPACE                                                          03180002
*********************************************************************** 03190002
*        AT WAS ISSUED FROM TERMINAL.                                 * 03200002
* CREATE THE PARAMETER LIST REQUIRED AND LINK TO IKJPARS TO SCAN THE  * 03210002
* SUBCOMMAND AND VALIDITY CHECK THE INPUT.                            * 03220002
*********************************************************************** 03230002
         LM    R4,R6,PARMLIST           PICK UP POINTERS TO UPT, ECT,   03240002
*                                       AND CP ECB                      03250002
         ST    R4,PARMS+PPLUPT-PPL      SAVE PTR TO UPT                 03260002
         ST    R5,PARMS+PPLECT-PPL      SAVE PTR TO ECT                 03270002
         ST    R6,PARMS+PPLECB-PPL      SAVE PTR TO CP'S ECB            03280002
         L     R2,PCLISTA               R2=ADDRESS OF PCL               03290002
         LA    R5,TSTANSPL              R5=POINTER TO ANSWER PLACE      03300002
         L     R4,INBUF                 R4=ADDRESS OF SUBCOMMAND BUFFER 03310002
         ST    R2,PARMS+PPLPCL-PPL      SAVE PTR TO PCL                 03320002
         ST    R5,PARMS+PPLANS-PPL      SAVE PTR TO ANSWER PLACE        03330002
         ST    R4,PARMS+PPLCBUF-PPL     SAVE PTR TO BUFFER              03340002
         ST    R13,PARMS+PPLUWA-PPL     SAVE PTR TO AT'S WORK AREA      03350002
         LA    R1,PARMS                 R1=ADDRESS OF PARAMETER LIST    03360002
         LINK  EP=IKJPARS,ERRET=PARSERR  GO TO PARSE ROUTINE            03370002
SMTPARS  DS    0H                       FOR SMT TEST CASES.             03380002
BLOW5    DS    0H                       RESUME ADDRESS IN CASE LINK     03390002
*                                       FAILS                           03400002
         SPACE                                                          03410002
*********************************************************************** 03420002
*        CHECK PARSE RETURN CODE. IF NONZERO, GO PROCESS              * 03430002
*        IT. PUT PDE ADDRESS IN R11. IF DEFER WAS SPECIFIED IN        * 03440002
*        COMMAND, GO XCTL TO SECOND LOAD OF AT, IKJEGATD.             * 03450002
*********************************************************************** 03460002
         LTR   R15,R15                  WAS PARSE SUCCESSFUL            03470002
         BNZ   CHKCODE(R15)             NO, FIND OUT WHY                03480002
         L     R1,TSTANSPL              R1=POINTER TO PDL               03490002
         USING IKJPARMD,R1              SET UP ADDRESSABILITY TO PDL    03500002
         LA    R11,ADDR                 R11=ADDRESS OF ADDRESS PDE      03510002
         USING IKJPARMA,R11             SET UP ADDRESSABILITY TO        03520002
*                                       ADDRESS PDE                     03530002
         LA    R2,TWO                   R2=TWO                          03540002
         CH    R2,DEFER                 WAS DEFER SPECIFIED ?           03550002
         BE    TRANSFER                 YES, XCTL TO SECOND LOAD OF AT  03560002
         DROP  R1                                                       03570002
         SPACE                                                          03580002
*********************************************************************** 03590002
*        AT WAS ISSUED TO MAKE ACTIVE BREAKPOINTS. CONVERT ALL        * 03600002
*        ADDRESSES IN THE ADDRESS PDES TO BINARY.                     * 03610002
*********************************************************************** 03620002
         SPACE                                                          03630002
         XR    R6,R6                    INITIALIZE INDICATOR FOR        03640002
*                                       CONVERTED PDE'S                 03650002
WASITCVD DS    0H                       MAKE SURE ALL PDE'S ARE         03660002
*                                       CONVERTED                       03670002
         TM    PDEUSER,PDECONVD         HAS PDE BEEN CONVERTED          03680002
         BZ    CONVPDE                  NO, CONVERT PDE                 03690002
         LA    R6,D1(R6)                SET INDICATOR FOR PDE           03700002
*                                       CONVERTED                       03710002
         SPACE                                                          03720002
MOREPDES DS    0H                       ARE THERE MORE PDE'S            03730002
         L     R11,PDE2CHAI             R11=PDE CHAIN CONTENTS          03740002
         LA    R11,D0(R11)              CLEAR HIGH ORDER BYTE           03750002
         LTR   R11,R11                  IS CHAIN FIELD EMPTY            03760002
         BNZ   WASITCVD                 NO, CHECK FOR PDE CONVERTED     03770002
         SPACE                                                          03780002
*********************************************************************** 03790002
*        IF NO ADDRESSES WERE CONVERTED SUCCESSFULLY, RETURN          * 03800002
*        TO MAINLINE.                                                 * 03810002
*********************************************************************** 03820002
         LTR   R6,R6                    WAS AT LEAST ONE PDE            03830002
*                                       CONVERTED                       03840002
         BNZ   BLDBREAK      YES,CONTINUE                               03850002
         SR    R15,R15       SET RETURN CODE TO ZERO                    03852002
         B     RETMAIN       RETURN TO IKJEGMNL                         03854002
         SPACE                                                          03860002
*********************************************************************** 03870002
*        BUILD ACTIVE BREAK ELEMENTS VIA BREAKRTN ROUTINE.            * 03880002
*********************************************************************** 03890002
BLDBREAK DS    0H                       PREPARE TO GO TO SUBROUTINE TO  03900002
*                                       BUILD BREAK ELEMENTS            03910002
         L     R1,TSTANSPL              R1=ADDRESS OF PDL               03920002
         BAL   R14,BREAKRTN             BRANCH TO BUILD BREAK ELEMENT   03930002
         LTR   R15,R15                  WAS BREAK REQUEST HANDLED OK    03940002
         BNZ   NOBREAK                  NO, CHECK FOR ATTN              03950002
         SPACE                                                          03960002
*********************************************************************** 03970002
*        IF SUCCESSFUL, RETURN TO MAINLINE WITH CODE 0.               * 03980002
*********************************************************************** 03990002
CODE0    DS    0H                       SET RETURN CODE TO ZERO         04000002
         XR    R15,R15                  ZERO REGISTER                   04010002
         B     RETMAIN                  PREPARE TO RETURN TO MAINLINE   04020002
         SPACE                                                          04030002
*********************************************************************** 04040002
*        IF UNSUCCESSFUL,SEND RC 16,20,OR 24 TO MAINLINE IF ONE OF THEM 04050002
*        OCCURRED AND TO ZERO OTHERWISE.                                04060002
*        RETURN TO MAINLINE.                                            04070002
*********************************************************************** 04080002
NOBREAK  DS    0H                       SUBROUTINE WAS UNABLE TO        04090002
*                                       ESTABLISH BREAKPOINT            04100002
         C     R15,ATTNCODE  IS RETURN CODE 16,20 OR 24?                04110002
         BNL   RETMAIN       YES,SEND RC TO MAINLINE                    04120002
         B     CODE0         SEND RC=0 TO MAINLINE                      04150002
         SPACE                                                          04160002
*********************************************************************** 04170002
*        THIS SECTION OF CODE CONVERTS THE ADDRESSES IN AN ADDRESS    * 04180002
*        PDE TO BINARY VIA THE IKJEGCVT MODULE. UPON ENTRY            * 04190002
*        TO THIS CODE, R11 POINTS TO THE ADDRESS PDE TO BE            * 04200002
*        CONVERTED. IF THE ADDRESSES IN THE PDE ARE INVALID, A        * 04210002
*        MESSAGE IS SENT TO THE TERMINAL, AND THE NEXT PDE IS         * 04220002
*        PROCESSED. IF THE ADDRESSES ARE VALID, THE ADDRESSES ARE     * 04230002
*        PUT IN THE PDEUSER AND PDE2USER FIELDS OF THE ADDRESS PDE,   * 04240002
*        AND THE NEXT PDE IS PROCESSED.                               * 04250002
*********************************************************************** 04260002
CONVPDE  DS    0H                       ADDRESS PDE MUST BE SENT TO     04270002
*                                       CONVERT TO ESTABLISH A          04280002
*                                       BINARY ADDRESS                  04290002
         LCR   R1,R11                   R1=COMPLEMENT OF ADDRESS OF PDE 04300002
*                                       TO INDICATE ADDRESS CONVERT     04310002
         XR    R0,R0                    R0=ZERO TO INDICATE CONVERT TO  04320002
*                                       BINARY                          04330002
         L     R15,TSTCONVT             R15=ADDRESS OF CONVERT ROUTINE  04340002
         OI    TSTFLGS1,RANGESW         TELL CONVERT A RANGE IS         04350002
*                                       POSSIBLE                        04360002
         BALR  R14,R15                  GO TO CONVERT                   04370002
         LTR   R15,R15                  WAS CONVERT SUCCESSFUL          04380002
         BNZ   WHYNOT                   NO, FIND OUT WHY NOT            04390002
         SPACE                                                          04400002
*********************************************************************** 04410002
*        CONVERSION SUCCESSFUL. BE SURE CONVERTED ADDRESSES ARE       * 04420002
*        WRITABLE AND ARE IN PDEUSER FIELD(S).                        * 04430002
*********************************************************************** 04440002
         TM    PDEFLG5,PDEWRITE         IS FIRST ADDRESS WRITABLE ?     04442002
         BZ    BADADDR                  NO - GO WRITE ERROR MSG         04444002
         TM    PDEUSER,PDESIB           IS ADDRESS IN USERWORD          04450002
         BZ    TRYRANGE                 YES, CHECK FOR RANGE            04460002
         L     R2,PDEUSER               R2=POINTER TO SI BLOCK          04470002
         MVC   PDEUSER,D0(R2)           MOVE BINARY ADDRESS TO USERWORD 04480002
         SPACE                                                          04490002
TRYRANGE DS    0H                       MAKE CERTAIN BINARY ADDRESS IN  04500002
*                                       SECOND HALF OF PDE IF RANGE     04510002
*                                       SPECIFIED                       04520002
         OC    PDE2USER,PDE2USER        WAS RANGE GIVEN                 04530002
         BZ    TESTBND                  NO, CHECK BOUNDARY              04540002
         TM    PDE2FLG5,PDEWRITE        IS SECOND ADDRESS WRITABLE ?    04542002
         BZ    BADRNGE                  NO - GO WRITE ERROR MSG         04544002
         TM    PDE2USER,PDESIB          DOES USERWORD POINT TO A BINARY 04550002
*                                       ADDRESS                         04560002
         BZ    CHKORDER                 NO, TEST FOR FIRST ADDRESS      04570002
*                                       LESS THAN SECOND                04580002
         L     R2,PDE2USER              R2=POINTER TO SI BLOCK          04590002
         MVC   PDE2USER,D0(R2)          MOVE BINARY ADDRESS TO USERWORD 04600002
         SPACE                                                          04610002
*********************************************************************** 04620002
*        A RANGE WAS GIVEN. CHECK FOR FIRST ADDRESS LESS THAN         * 04630002
*        SECOND AND FIRST ADDRESS ON HALFWORD BOUNDARY. IF ERROR,     * 04640002
*        WRITE ERROR MESSAGE AND GET NEXT PDE. IF OK, GO FLAG         * 04650002
*        PDE AS CONVERTED AND GET NEXT PDE.                           * 04660002
*********************************************************************** 04670002
CHKORDER DS    0H                       CHECK FOR FIRST ADDRESS OF      04680002
*                                       RANGE LESS THAN SECOND          04690002
         CLC   PDEUSER+D1(L3),PDE2USER+D1 IS FIRST ADDRESS LOW          04700002
         BH    BADORDER                 NO, PUT OUT MESSAGE             04710002
         TM    PDEUSER+D3,BADBOUND      IS FIRST ADDRESS FOR HALFWORD   04720002
*                                       BOUNDARY                        04730002
         BNO   FLAGOK                   YES, FLAG PDE CONVERTED         04740002
         LA    R1,MSG1       R1=ADDR OF MESSAGE NUMBERS                 04742002
         SPACE                                                          04750002
OFFBOUND DS    0H                       SET UP MESSAGE FOR ADDRESS NOT  04760002
*                                       ON HALFWORD BOUNDARY            04770002
         BAL   R5,IOTYPE2    PUT OUT MESSAGE                            04780002
         BAL   R5,IORC1      TEST IO RC'S                               04808002
         MVI   PDEUSER,HEX00 TURN OFF ALL PDEUSER FLAGS                 04808402
         B     MOREPDES      CHECK FOR MORE PDES                        04808802
         SPACE                                                          04810002
BADADDR  DS    0H                       PDE HAS AN ADDRESS WHICH IS     04812002
*                                       NOT WRITABLE. ISSUE APPROP.     04814002
*                                       ERROR MSG                       04816002
         OC    PDE2USER,PDE2USER        AN ADDRESS RANGE ?              04818002
         BNZ   BADRNGE                  YES - ISSUE BAD RANGE MSG       04818402
         LA    R1,MSG2       R1=ADDR OF MESSAGE NUMBERS                 04818802
         B     FIXSTRNG                 ADD ADDRESS STRING TO MESSAGE   04819602
         SPACE                                                          04819702
BADRNGE  DS    0H                       ADDRESS RANGE IS NOT WRITABLE   04819802
*                                       ISSUE APPROP. ERROR MSG         04819902
         LA    R1,MSG3       R1=ADDR OF MESSAGE NUMBERS                 04821902
         B     FIXSTRNG                 ADD ADDRESS STRING TO MESSAGE   04825602
         SPACE                                                          04826002
BADORDER DS    0H                       SET UP MESSAGE FOR FIRST        04826702
*                                       ADDRESS OF RANGE MUST BE        04830002
*                                       LESS THAN SECOND                04840002
         LA    R1,MSG4       R1=ADDR OF MESSAGE NUMBERS                 04850002
         SPACE                                                          04870002
FIXSTRNG DS    0H                       ADD ADDRESS STRING TO MESSAGE   04880002
         BAL   R5,IOTYPE3    PUT OUT MESSAGE                            04890002
         BAL   R5,IORC1      TEST IO RC'S                               04909202
         MVI   PDEUSER,HEX00            TURN OFF ALL PDEUSER FLAGS      04910002
         B     MOREPDES                 CHECK FOR MORE PDES             04930002
         SPACE                                                          04940002
*********************************************************************** 04950002
*        PDE OK. FLAG IT AS OK, AND GO GET NEXT PDE.                  * 04960002
*********************************************************************** 04970002
FLAGOK   DS    0H                       FLAG PDE CONVERTED              04980002
         MVI   PDEUSER,PDECONVD         SET FLAG                        04990002
         LA    R6,D1(R6)                SET INDICATOR FOR PDE CONVERTED 05000002
         B     MOREPDES                 CHECK FOR MORE PDES             05010002
         SPACE                                                          05020002
*********************************************************************** 05030002
*        ONLY ONE ADDRESS. CHECK IT FOR HALFWORD BOUNDARY.            * 05040002
*        IF OK, GO FLAG PDE CONVERTED AND GET NEXT PDE. IF ERROR,     * 05050002
*        ISSUE ERROR MESSAGE AND GO GET NEXT PDE.                     * 05060002
*********************************************************************** 05070002
TESTBND  DS    0H                       IS SINGLE ADDRESS ON HALFWORD   05080002
*                                       BOUNDARY                        05090002
         TM    PDEUSER+D3,BADBOUND      IS BOUNDARY OK                  05100002
         BNO   FLAGOK                   YES, FLAG PDE CONVERTED         05110002
         LA    R1,MSG5       R1=ADDR OF MESSAGE NUMBERS                 05120002
         B     OFFBOUND      GO ISSUE ERROR MESSAGE                     05130002
         SPACE                                                          05150002
*********************************************************************** 05160002
*        ADDRESS CONVERSION FAILED. IF AN ATTENTION OCCURRED,         * 05170002
*        SET RETURN CODE TO 16 AND RETURN TO MAINLINE.                * 05180002
*        IF AN ABEND OCCURRED, SET RETURN CODE TO 20 AND RETURN TO    * 05190002
*        MAINLINE. OTHERWISE, TURN OFF CONVERTED FLAG IN PDE AND      * 05196002
*        GET NEXT PDE.                                                * 05202002
*********************************************************************** 05210002
WHYNOT   DS    0H                       FIND OUT WHY CONVERT FAILED     05220002
         C     R15,ATTNCODE  IS RETURN CODE=16,20 OR 24?                05230002
         BNL   RETMAIN       YES, SEND IT TO IKJEGMNL                   05240002
         OI    TSTFLGS4,TSTFLUSH        TURN TSTFLUSH ON SO MNL WILL    05254002
*                                       FLUSH INPUT STACK               05255002
         MVI   PDEUSER,HEX00            TURN OFF ALL PDEUSER FLAGS      05260002
         B     MOREPDES                 IKJEGSYM WILL HAVE PUT OUT A    05270002
*                                       MESSAGE IF IT WERE UNABLE       05280002
*                                       TO RESOLVE THE ADDRESS -        05290002
*                                       CHECK FOR MORE PDE'S            05300002
         EJECT                                                          05870002
*********************************************************************** 05880002
*        USER DID NOT ENTER AT COMMAND FROM TERMINAL. A NEW           * 05890002
*        MODULE HAS BEEN BROUGHT INTO CORE. CHECK FOR ENTRIES         * 05900002
*        ON DEFER QUEUE FOR THIS NEW MODULE. THE NAME OF THE NEWLY    * 05910002
*        LOADED MODULE IS IN THE FIRST EIGHT BYTES OF AT'S            * 05920002
*        WORKAREA. THE FIRST BYTE AFTER THE LOAD MODULE NAME IS       * 05930002
*        A FLAG BYTE. IT IS X'20' IF THE MODULE IS AN OVERLAY,        * 05940002
*        AND, IN THIS CASE, A SWITCH IS SET TO TELL SYM NOT TO        * 05950002
*        ISSUE MESSAGES.                                              * 05960002
*********************************************************************** 05970002
FROMDEFR DS    0H                       THIS ROUTINE IS ENTERED TO MAKE 05980002
*                                       ACTIVE BREAKPOINTS FOR A        05990002
*                                       LOAD MODULE BROUGHT INTO        06000002
*                                       CORE                            06010002
         TM    LOADATTR,OVLYBIT         IS LOAD MODULE IN OVERLAY       06020002
         BO    FIXSYMSW                 YES, TELL SYM NOT TO PRINT MSGS 06030002
         SPACE                                                          06040002
*********************************************************************** 06050002
*        IF THE DEFER QUEUE IS EMPTY, RETURN TO MAINLINE              * 06060002
*        WITH A RETURN CODE OF 4. OTHERWISE, GET ADDRESS OF FIRST     * 06070002
*        DME ON DEFERRED QUEUE.                                       * 06080002
*********************************************************************** 06090002
HANDLED  DS    0H                       HANDLE DEFER BREAKPOINTS        06100002
         OC    DEFERTAB,DEFERTAB        IS THE DEFER QUEUE EMPTY        06110002
         BZ    CODE4                    YES, RETURN TO MAINLINE WITH A  06120002
*                                       CODE OF FOUR                    06130002
         L     R8,DEFERTAB              R8=POINTER TO FIRST DME         06140002
         USING DME,R8                   R8 IS BASE FOR DME              06150002
         SPACE                                                          06160002
*********************************************************************** 06170002
*        IF LOADNAME IN DME NOT THE SAME AS NEWLY LOADED MODULE,      * 06180002
*        GO CHECK FOR MORE DMES ON QUEUE. IF SAME, GET ADDRESS OF     * 06190002
*        FIRST DBE QUEUED FROM DME. NOTE - R8 IS BASE FOR BOTH        * 06200002
*        DME'S AND DBE'S.                                             * 06202002
*********************************************************************** 06210002
CHKMATCH DS    0H                       COMPARE LOADNAMES               06220002
         CLC   LOADNAME,DMELOAD         DOES THE DME LOADNAME           06230002
*                                       EQUAL THE INPUT LOADNAME        06240002
         BNE   MOREDMES                 NO, CHECK FOR MORE DME'S        06250002
         L     R8,DMEDBE                R8=POINTER TO FIRST DBE         06260002
         DROP  R8                       R8 WILL BE USED FOR DBE         06262002
*                                       ADDRESSABILITY                  06264002
         USING DBE,R8                   R8 IS BASE FOR DBE              06270002
         SPACE                                                          06280002
*********************************************************************** 06290002
*        GET ADDRESS OF PDL FROM DBE, AND SET UP TO CONVERT ALL       * 06300002
*        ADDRESS PDES IN PDL.                                         * 06310002
*********************************************************************** 06320002
ACCESS   DS    0H                       GET ADDR OF FIRST ADDR PDE      06330002
         L     R1,DBEPDL                R1=POINTER TO PDL               06340002
         USING IKJPARMD,R1              ESTABLISH ADDRESSABILITY TO PDL 06350002
         LA    R11,ADDR                 R11=ADDRESS OF ADDRESS PDE      06360002
         DROP  R1                                                       06370002
         XR    R6,R6                    INITIALIZE INDICATOR FOR        06380002
*                                       CONVERTED PDES                  06390002
         SPACE                                                          06400002
*********************************************************************** 06410002
*        CHECK PDE TO SEE IF OFF HAS TURNED THE PDEYECH FLAG ON.      * 06412002
*        IF SO, SKIP THE PDE AND TRY THE NEXT ONE. (THE PDEYECH FLAG  * 06414002
*        IS OFF'S WAY OF REMOVING DEFERRED BREAKPOINTS.) OTHERWISE,   * 06416002
*        GO TO IKJEGCVT TO CONVERT PDE ADDRESSES TO BINARY.           * 06420002
*********************************************************************** 06430002
CONVDEFR DS    0H                       CONVERT PDE'S ON DEFER QUEUE    06440002
*                                       FOR ONE DBE                     06450002
         TM    PDEUSER,PDEYECH          HAS BRKPT BEEN OFF'D ?          06452002
         BO    ANOTHER                  YES, GO TRY THE NEXT PDE        06454002
         OI    TSTFLGS1,RANGESW         TELL CONVERT A RANGE IS         06460002
*                                       POSSIBLE                        06470002
         LCR   R1,R11                   LOAD COMPLEMENT OF ADDRESS OF   06480002
*                                       PDE FOR ADDRESS CONVERT         06490002
         XR    R0,R0                    INDICATE BINARY CONVERT         06500002
         L     R15,TSTCONVT             R15=ADDRESS OF CONVERT ROUTINE  06510002
         BALR  R14,R15                  CONVERT PDE                     06520002
         LTR   R15,R15                  WAS CONVERSION OK               06530002
         BNZ   SETUSER                  NO, INSURE CONVERTED FLAG IS    06540002
*                                       OFF                             06550002
         TM    PDEFLG5,PDEWRITE         IS FIRST ADDRESS WRITABLE ?     06552002
         BZ    DEFBADAD                 NO - GO WRITE ERROR MSG         06554002
         TM    PDEUSER,PDESIB           IS BINARY ADDR IN USERWORD      06560002
         BZ    ASKRANGE                 YES, CHECK FOR ADDR RANGE       06570002
         L     R4,PDEUSER               R4=POINTER TO SI BLOCK          06580002
         MVC   PDEUSER,D0(R4)           MOVE BINARY ADDRESS TO USERWORD 06590002
         SPACE                                                          06600002
*********************************************************************** 06610002
*        IF A RANGE WAS GIVEN, BE SURE SECOND ADDRESS IS IN PDE.      * 06620002
*********************************************************************** 06630002
ASKRANGE DS    0H                       SEE IF SECOND USERWORD CONTAINS 06640002
*                                       A BINARY ADDRESS                06650002
         OC    PDE2USER,PDE2USER        WAS RANGE GIVEN                 06660002
         BZ    BNDTEST                  NO, CHECK BOUNDARY              06670002
         TM    PDE2USER,PDEWRITE        IS SECOND ADDRESS WRITABLE ?    06672002
         BZ    DEFBADRG                 NO - GO WRITE ERROR MSG         06674002
         TM    PDE2USER,PDESIB          DOES USERWORD POINT TO SI BLOCK 06680002
         BZ    TSTORDER                 NO, TEST FOR FIRST ADDRESS      06690002
*                                       LESS THAN SECOND                06700002
         L     R4,PDE2USER              R4=POINTER TO SI BLOCK          06710002
         MVC   PDE2USER,D0(R4)          MOVE BINARY ADDRESS TO USERWORD 06720002
         SPACE                                                          06730002
*********************************************************************** 06740002
*        A RANGE WAS GIVEN. CHECK FOR FIRST ADDRESS LESS THAN         * 06750002
*        SECOND AND FIRST ADDRESS ON HALFWORD BOUNDARY. IF ERROR,     * 06760002
*        WRITE ERROR MESSAGE AND GET NEXT PDE. IF OK, GO FLAG PDE     * 06770002
*        CONVERTED AND GET NEXT PDE.                                  * 06780002
*********************************************************************** 06790002
TSTORDER DS    0H                       CHECK FOR FIRST ADDRESS OF      06800002
*                                       RANGE LESS THAN SECOND          06810002
         CLC   PDEUSER+D1(L3),PDE2USER+D1  IS FIRST ADDRESS LOW         06820002
         BH    ORDERBAD                 NO, PUT OUT MESSAGE             06830002
         TM    PDEUSER+D3,BADBOUND      IS FIRST ADDRESS FOR HALF-WORD  06840002
*                                       BOUNDARY                        06850002
         BNO   FLAGPDE                  YES, FLAG PDE CONVERTED         06860002
         LA    R1,MSG1       R1=ADDR OF MESSAGE NUMBERS                 06870002
OFFBND   DS    0H                                                       06880002
         BAL   R5,IOTYPE2    PUT OUT MESSAGE                            06882002
         BAL   R5,IORC1      TEST IO RC'S                               06888802
         MVI   PDEUSER,HEX00 TURN OFF ALL PDEUSER FLAGS                 06889202
         B     ANOTHER       CHECK FOR MORE PDES                        06889602
         SPACE                                                          06890002
FIXMSG   DS    0H                       ADD ADDRESS STRING TO MESSAGE   06900002
         BAL   R5,IOTYPE3    PUT OUT MESSAGE                            06910002
         BAL   R5,IORC1      TEST IO RC'S                               06921702
         MVI   PDEUSER,HEX00            TURN OFF ALL FLAGS IN PDEUSER   06922002
         B     ANOTHER                  CHECK FOR MORE PDES             06930002
         SPACE                                                          06940002
DEFBADAD DS    0H                       PDE HAS AN ADDRESS WHICH IS     06942002
*                                       NOT WRITABLE. ISSUE APPROP.     06944002
*                                       ERROR MSG.                      06946002
         OC    PDE2USER,PDE2USER        ADDRESS RANGE ?                 06948002
         BNZ   DEFBADRG                 YES - ISSUE BAD RANGE MSG       06948402
         LA    R1,MSG2       R1=ADDR OF MESSAGE NUMBERS                 06948802
         B     FIXMSG                   ADD ADDRESS STRING TO MESSAGE   06949602
         SPACE                                                          06949702
DEFBADRG DS    0H                       ADDRESS RANGE IS NOT WRITABLE   06949802
*                                       ISSUE APPROP. ERROR MSG         06949902
         LA    R1,MSG3       R1=ADDR OF MESSAGE NUMBERS                 06953202
         B     FIXMSG                   ADD ADDRESS STRING TO MESSAGE   06955602
         SPACE                                                          06956002
ORDERBAD DS    0H                       SET UP MESSAGE FOR FIRST        06956702
*                                       ADDRESS OF RANGE MUST BE        06960002
*                                       LESS THAN SECOND                06970002
         LA    R1,MSG4       R1=ADDR OF MESSAGE NUMBERS                 06980002
         B     FIXMSG                   ADD ADDRESS STRING TO MESSAGE   07000002
         SPACE                                                          07010002
*********************************************************************** 07020002
*        MODULE AN OVERLAY. TURN ON SWITCH TO TELL SYM NOT TO         * 07030002
*        ISSUE MESSAGES.                                              * 07040002
*********************************************************************** 07050002
FIXSYMSW DS    0H                       TELL SYM NOT TO PRINT MSGS      07060002
         OI    TSTFLGS3,SYMMESG         SET SWITCH IN TCOMTAB           07070002
         B     HANDLED                  SET DEFER BREAKPOINTS           07080002
         SPACE                                                          07090002
*********************************************************************** 07100002
*        ONLY ONE ADDRESS GIVEN, CHECK FOR HALFWORD BOUNDARY.         * 07110002
*        IF NOT HALFWORD, ISSUE MESSAGE AND GET NEXT PDE.             * 07120002
*********************************************************************** 07130002
BNDTEST  DS    0H                       IS SINGLE ADDRESS ON HALF-WORD  07140002
*                                       BOUNDARY                        07150002
         TM    PDEUSER+D3,BADBOUND      IS BOUNDARY OK                  07160002
         BNO   FLAGPDE                  YES, FLAG PDE CONVERTED         07170002
         LA    R1,MSG5       R1=ADDR OF MESSAGE NUMBERS                 07180002
         B     OFFBND        GO ISSUE MESSAGE                           07190002
         SPACE                                                          07220002
*********************************************************************** 07230002
*        ADDRESS IS OK. FLAG PDE AS CONVERTED. INCREMENT COUNTER      * 07240002
*        FOR CONVERTED PDES..                                         * 07250002
*********************************************************************** 07260002
FLAGPDE  DS    0H                       FLAG PDE CONVERTED              07270002
         MVI   PDEUSER,PDECONVD         SET FLAG                        07280002
         LA    R6,D1(R6)                SET INDICATOR FOR PDE CONVERTED 07290002
         SPACE                                                          07300002
*********************************************************************** 07310002
*        IF MORE PDES, GO CONVERT THEM. IF NO PDES WERE CONVERTED,    * 07320002
*        GO CHECK FOR MORE DBES. OTHERWISE, BUILD ACTIVE BREAK        * 07330002
*        ELEMENTS VIA THE BREAKRTN ROUTINE FOR THE PDL.               * 07340002
*********************************************************************** 07350002
ANOTHER  DS    0H                       CHECK FOR MORE PDE'S            07360002
         L     R11,PDE2CHAI             R11=PDE CHAIN CONTENTS          07370002
         LA    R11,D0(R11)              CLEAR HIGH ORDER BYTE           07380002
         LTR   R11,R11                  IS CHAIN EMPTY                  07390002
         BNZ   CONVDEFR                 NO, CONVERT NEXT PDE            07400002
         LTR   R6,R6                    IS AT LEAST ONE PDE CONVERTED   07410002
         BZ    DBELINK                  NO, CHECK FOR MORE DBE'S        07420002
         L     R1,DBEPDL                R1=POINTER TO PDL               07430002
         BAL   R14,BREAKRTN             BRANCH TO BUILD BREAK ELEMENTS  07440002
         LTR   R15,R15                  IS BREAKRTN RC ZERO ?           07450002
         BZ    DBELINK                  YES - CHECK FOR MORE DBES       07460002
         C     R15,ATTNCODE  WAS RETURN CODE 16?                        07470002
         BE    RETMAIN       YES,SEND RC=16 TO MAINLINE                 07480002
         BL    DBELINK       RC LESS THAN 16 GET NEXT DBE               07490002
         OI    TSTFLGS4,TSTFLUSH        ABEND OCCURRED, TURN TSTFLUSH   07494002
*                                       ON SO MNL WILL FLUSH INPUT      07495002
         B     CODE4                    RETURN TO MNL WITH RC 4         07496002
         SPACE                                                          07500002
*********************************************************************** 07510002
*        IF THERE ARE MORE DBES ON THE QUEUE, PROCESS THEM. IF NOT,   * 07520002
*        RETURN TO MAINLINE WITH RETURN CODE FOUR.                    * 07530002
*********************************************************************** 07540002
DBELINK  DS    0H                       CHECK FOR MORE DBE'S            07550002
         OC    DBEDBE,DBEDBE            IS DBE LINK FIELD ZERO          07560002
         BZ    CODE4                    YES, RETURN TO MAINLINE WITH    07570002
*                                       CODE OF FOUR                    07580002
         L     R8,DBEDBE                R8=POINTER TO NEXT DBE          07590002
         B     ACCESS                   ACCESS FIRST ADDRESS PDE        07600002
         DROP  R8                       R8 NO LONGER USED FOR           07610002
*                                       DBE ADDRESSABILITY              07620002
         SPACE                                                          07630002
*********************************************************************** 07640002
*        THE PDE WAS NOT CONVERTED. SET PDEUSER FLAGS TO ZERO.        * 07650002
*        IF RETURN CODE WAS 16, ATTN WAS ENTERRED - RETURN TO MNL     * 07660002
*        WITH RETURN CODE OF 16. IF AN ABEND OCCURRED, RETURN TO      * 07670002
*        MNL WITH RETURN CODE 20. OTHERWISE, CHECK FOR MORE PDES.     * 07675002
*********************************************************************** 07680002
SETUSER  DS    0H                       INSURE FLAG FOR PDE CONVERTED   07690002
*                                       IS NOT ON                       07700002
         OI    TSTFLGS4,TSTFLUSH        TURN TSTFLUSH ON SO MNL WILL    07703002
*                                       FLUSH INPUT STACK               07706002
         MVI   PDEUSER,ZERO             INSURE X'FF' MADE ZERO          07710002
         C     R15,ATTNCODE  IS RETURN CODE=16,20 OR 24?                07720002
         BNL   RETMAIN       YES, SEND IT TO IKJEGMNL                   07730002
         B     ANOTHER       NO, CHECK FOR MORE PDE'S                   07740002
         SPACE                                                          07760002
*********************************************************************** 07770002
*        THE LOADNAME IN THE DME WAS NOT THE SAME AS THAT OF          * 07780002
*        THE NEWLY LOADED MODULE. IF THERE ARE NO MORE DMES ON        * 07790002
*        QUEUE, RETURN TO MAINLINE WITH RETURN CODE FOUR.             * 07800002
*        OTHERWISE, GET ADDRESS OF NEXT DME AND GO PROCESS IT.        * 07810002
*        NOTE THAT R8 WILL POINT TO DME.                              * 07812002
*********************************************************************** 07820002
MOREDMES DS    0H                       TEST FOR MORE DME'S             07830002
         USING DME,R8                   R8 IS DME BASE                  07832002
         OC    DMEDME,DMEDME            IS LINK FIELD EMPTY             07840002
         BZ    CODE4                    YES, RETURN WITH CODE OF FOUR   07850002
         L     R8,DMEDME                R8=ADDRESS OF NEXT DME          07860002
         B     CHKMATCH                 BRANCH TO COMPARE DME LOADNAME  07870002
*                                       WITH INPUT                      07880002
         DROP  R8                       R8 NO LONGER USED FOR           07890002
*                                       DME ADDRESSABILITY              07900002
         SPACE                                                          07910002
*********************************************************************** 07920002
*        TURN OFF SYM SWITCH AND TSTBUILD SWITCH.                     * 07930002
*        SET RETURN CODE TO FOUR FOR RETURN TO MAINLINE FROM          * 07940002
*        ACTIVATING DEFERRED BREAKPOINTS.                             * 07950002
*********************************************************************** 07960002
CODE4    DS    0H                       SET RETURN CODE TO FOUR FOR     07970002
*                                       THE PROBLEM PROGRAM TO          07980002
*                                       BE CONTINUED                    07990002
         NI    TSTFLGS3,HEXFF-SYMMESG   TURN OFF SYM MSG SWITCH         08000002
         NI    TSTFLGS1,HEXFF-TSTBUILD  TURN OFF TSTBUILD FLAG          08010002
         LA    R15,FOUR                 SET CODE TO FOUR                08020002
         B     RETMAIN                  RETURN TO MAINLINE              08030002
         EJECT                                                          08040002
*********************************************************************** 08050002
*        THE DEFER KEYWORD WAS SPECIFIED. PUT ADDRESS OF FIRST        * 08060002
*        ADDRESS PDE IN PARM WORD OF WORKAREA. PUT ADDRESS            * 08070002
*        OF TCOMTAB IN R1 AS PARAMETER FOR IKJEGATD. TURN ON XCTL     * 08080002
*        FLAG IN TSTFLGS2 FIELD OF TCOMTAB, AND XCTL TO IKJEGATD.     * 08090002
*********************************************************************** 08100002
TRANSFER DS    0H                                                       08110002
         MVC   XCTLL(XCTLEN),XLIST      MOVE LIST FORM OF XCTL TO WORK  08120002
*                                       AREA                            08130002
         ST    R11,PDEADDR              SAVE ADDRESS OF FIRST ADDR PDE  08140002
         LA    R1,TCOMTAB               R1=ADDRESS OF TCOMTAB           08150002
         LA    R15,XCTLL                R15=ADDRESS OF LIST FORM OF     08160002
*                                       MACRO                           08170002
         L     R13,SAVELAST-SAVEAREA(R13)  RESTORE R13                  08180002
         L     R14,RETURNPT-SAVEAREA(R13)  RESTORE R14                  08190002
         OI    TSTFLGS2,TSTXCTL         SET BIT FOR AT XCTL'S           08220002
         XCTL  (2,12),EP=IKJEGATD,MF=(E,(1)),SF=(E,(15))                08230002
SMTXCTL2 DS    0X                       FOR SMT TEST CASES.             08240002
         EJECT                                                          08250002
*********************************************************************** 08260002
*                                                                     * 08270002
*        THE FOLLOWING INSTRUCTIONS CONSTITUTE A CLOSED SUBROUTINE    * 08280002
*        FOR CREATING ACTIVE BREAKPOINTS FROM PDL'S PASSED TO IT.     * 08290002
*        PDL'S MUST CONTAIN ADDRESS PDE'S WHICH CONTAIN THE ACTUAL    * 08300002
*        BINARY ADDRESSES IN THE USER WORDS OF THE PDE. INPUT WILL    * 08310002
*        CONSIST OF THE PDL ADDRESS IN REGISTER 1, TCOMTAB ADDRESS    * 08320002
*        IN REGISTER 9, THE ADDRESS OF AT'S WORK AREA IN REGISTER 10, * 08330002
*        PROGRAM BASE IN REGISTER 12, A RETURN ADDRESS IN REGISTER 14 * 08340002
*        AND A SAVE AREA ADDRESS IN REGISTER 13.                      * 08350002
*                                                                     * 08360002
*********************************************************************** 08370002
BREAKRTN DS    0H                       BEGINNING OF SUBROUTINE         08380002
         SAVE  (14,12)                  SAVE CALLER'S REGISTERS.        08390002
         LA    R4,BRKSAVE               GET ADDRESS OF BREAKRTN'S       08400002
*                                       SAVEAREA                        08410002
         ST    R4,SAVENEXT-SAVEAREA(R13)  STORE FORWARD POINTER.        08420002
         ST    R13,SAVELAST-SAVEAREA(R4)  STORE BACKWARD POINTER.       08430002
         LR    R13,R4                   R13=NEW SAVE AREA ADDR.         08440002
         SPACE                                                          08450002
*********************************************************************** 08460002
*        SAVE PDL ADDRESS IN WORKAREA, AND GET ADDRESS OF             * 08470002
*        FIRST ADDRESS PDE.                                           * 08480002
*********************************************************************** 08490002
         USING IKJPARMD,R1              PDL ADDRESSABILITY.             08500002
         ST    R1,PDLADDR               SAVE ADDRESS OF PDL FOR         08510002
*                                       LATER USE                       08520002
         LA    R11,ADDR                 R11=ADDRESS PDE ADDR.           08530002
         DROP  R1                                                       08540002
         SPACE                                                          08550002
*********************************************************************** 08560002
*        IF PDE HAS BEEN CONVERTED, GO PROCESS IT IN SUPRLOOP.        * 08570002
*        IF NOT, CHECK FOR MORE PDES. IF MORE, GO CHECK THEM.         * 08580002
*        IF NO MORE, RETURN TO CALLER.                                * 08590002
*********************************************************************** 08600002
TESTCONV DS    0H                       CHECK FOR CONVERTED PDE         08610002
         TM    PDEUSER,PDECONVD         HAS PDE BEEN CONVERTED          08620002
         BO    SUPRLOOP                 YES, BUILD BRKELEM(S) FOR PDE   08630002
         L     R11,PDE2CHAI             R11=CHAIN POINTER FOR ADDR LIST 08640002
         LA    R11,D0(R11)              CLEAR HIGH ORDER BYTE           08650002
         LTR   R11,R11                  Q.IS A LIST POINTER PRESENT     08660002
         BZ    ROUTRTN                  NO, RETURN                      08670002
         B     TESTCONV                 CHECK FOR THIS PDE CONVERTED    08680002
         SPACE                                                          08690002
*********************************************************************** 08700002
*        THE PDE HAS BEEN CONVERTED. CALCULATE NUMBER OF BYTES        * 08710002
*        REQUIRED FOR BREAK ELEMENT AND ASSOCIATED DATA.              * 08720002
*********************************************************************** 08730002
SUPRLOOP DS    0H                                                       08740002
         SR    R1,R1                    CLEAR ACCUMULATOR.              08750002
         SPACE                                                          08760002
*********************************************************************** 08770002
*        GET LENGTH OF LOADNAME.CSECT.                                * 08780002
*********************************************************************** 08790002
         AH    R1,PDELEN2               R1=CSECT NAME LENGTH.           08800002
         BZ    ADDRCHK                  NO LOAD OR CSECT NAME.          08810002
         LA    R1,D1(R1)                BUMP FOR PRECEDING PERIOD.      08820002
         AH    R1,PDELEN1               ADD IN LOAD NAME LENGTH.        08830002
         TM    PDEFLG3,AFLG             Q.ANY ADDRESS.                  08840002
         BZ    CHNCALC                  NO,  COMPUTE CHAIN LENGTH.      08850002
         LA    R1,D1(R1)                YES, BUMP FOR TRAILING PERIOD.  08860002
         SPACE                                                          08870002
*********************************************************************** 08880002
*        IF REGISTER-TYPE ADDRESS, ADD ONE FOR LETTER.                * 08890002
*********************************************************************** 08900002
ADDRCHK  DS    0H                       DETERMINE ADDRESS TYPE          08910002
         TM    PDEFLG4,SYMADDR          IS ADDRESS SYMBOLIC ?           08920002
         BO    ADDADDR                  YES, SKIP BUMP FOR PUNCTUATION  08930002
*                                       OR LETTER                       08940002
         LA    R1,D1(R1)                BUMP FOR PUNCTUATION OR LETTER  08950002
*                                       FOR ABSOLUTE, RELATIVE OR       08960002
*                                       REGISTER TYPE ADDRESS           08970002
         SPACE                                                          08980002
*********************************************************************** 08990002
*        CALCULATE AMOUNT OF CORE NEEDED FOR ADDRESS STRING.          * 09000002
*********************************************************************** 09010002
ADDADDR  DS    0H                       CALCULATE CORE NEEDED           09020002
*                                       FOR ADDR STRING                 09030002
         AH    R1,PDELEN3               ADD ADDRESS STRING LENGTH.      09040002
         L     R7,PDEEXPTR              R7=ADDRESS OF 1ST EXPRESSION.   09050002
         AH    R1,PDEINDCT              R1=(BRK+ADDR+IND.COUNT).        09060002
         SPACE                                                          09070002
CALCLOOP DS    0H                       ADD IN CORE FOR EXPRESSION      09080002
         LA    R7,D0(R7)                CLEAR HIGH ORDER BYTE           09090002
         LTR   R7,R7                    Q.ANY EXPRESSION.               09100002
         BZ    CHNCALC                  NO, CHECK ON CHAIN.             09110002
         USING EXPRPDE,R7               R7 IS BASE FOR EXPRESSION PDE   09120002
         AH    R1,EXPRLNH               R1=(BRK+ADDR+EXP LEN).          09130002
         AH    R1,EXPRINDC              R1=(BRK+ADDR+EXP+IND.COUNT).    09140002
         LA    R1,D1(R1)                R1=(BRK+ADDR+EXP+IND+SIGN LEN). 09150002
         TM    EXPRFLGS,EXPRDEC         IS EXPRESSION DECIMAL VALUE     09160002
         BZ    KEEPON                   NO, CONTINUE                    09170002
         LA    R1,D1(R1)                R1=(BRK+ADDR+EXP+IND+SIGN LEN). 09180002
         SPACE                                                          09190002
KEEPON   DS    0H                       CHECK FOR ANOTHER               09200002
*                                       EXPRESSION PDE                  09210002
         L     R7,EXPRCHAI              R7=NEXT EXPRESSION ADDRESS.     09220002
         B     CALCLOOP                 GET 'EM ALL.                    09230002
         DROP  R7                       R7 NO LONGER USED FOR           09240002
*                                       EXPRESSION PDE ADDRESSABILITY   09250002
         SPACE                                                          09260002
CHNCALC DS    0H                                                        09270002
         LA    R1,BRKLEN(R1)            ADD BREAK ELEMENT LENGTH.       09280002
         CH    R1,MAXLEN2               IS ACCUMULATED LENGTH FOR       09290002
*                                       STRING GREATER THAN 100         09300002
         BH    CHGREG                   YES, LIMIT THE LENGTH           09310002
         SPACE                                                          09320002
*********************************************************************** 09330002
*        CALCULATE AMOUNT OF CORE NEEDED FOR SUBCOMMAND CHAIN.        * 09340002
*********************************************************************** 09350002
CHNCALC2 DS    0H                                                       09360002
         L     R7,PDLADDR               R7=PDL ADDRESS                  09370002
         USING IKJPARMD,R7              R7 USED FOR PDL ADDRESSABILITY  09380002
         LA    R1,D2(R1)                ADD IN ADDR SAVE LENGTH         09390002
*                                       FIELD - 2 BYTES.                09400002
         TM    PDEUSER,PDEADLST         Q.IS THIS A LIST                09410002
*                                       PDE (NOT THE 1ST)               09420002
         BO    GETBRK                   YES, GO GET CORE                09430002
         LA    R1,D7(R1)                NO, ROUND R1 UP TO DBL BOUND.   09440002
         N     R1,DBLBND                                                09450002
         LH    R0,SBCMDCHN+EXPRLNH-EXPRPDE  GET THE CHAIN LENGTH.       09460002
         LTR   R0,R0                    Q. IS THERE A CHAIN.            09470002
         BZ    GETBRK                   NO, GO GET CORE                 09480002
         ALR   R1,R0                    R1=(BRK+ADDR SAVE+CHAIN LEN).   09490002
         LA    R1,D3(R1)                ADD IN CHAIN SAVE LENGTH        09500002
*                                       FIELD 3 BYTES                   09510002
         B     GETBRK                   GO GET CORE                     09520002
         SPACE                                                          09530002
CHGREG   DS    0H                       LIMIT ADDRESS STRING            09540002
*                                       LENGTH TO 100                   09550002
         LH    R1,MAXLEN2               R1=MAXIMUM LENGTH FOR BREAK     09560002
*                                       ELEMENT AND ADDRESS STRING      09570002
         B     CHNCALC2                 CALCULATE NEEDS FOR             09580002
*                                       SUBCOMMAND CHAIN                09590002
         DROP  R7                       R7 NOT USED FOR PDL             09600002
*                                       ADDRESSABILITY FROM NOW ON      09610002
         SPACE                                                          09620002
*********************************************************************** 09630002
*        ADDRESS CHECK AND GETMAIN FOR BRKELEM CORE                   * 09640002
*********************************************************************** 09650002
GETBRK   DS    0H                                                       09660002
         L     R7,PDEUSER               GET ADDRESS OF BREAKPOINT       09662002
TSTLNH1  DS    0H                       NEXT INSTRUCTION MAY ABEND      09662402
         TM    D0(R7),LENBITS           HOW LONG IS INSTRUCTION ?       09664002
TSTLNH2  DS    0H                       PRECEDING INSTRUCTION MAY ABEND 09664402
         BO    CHEKSIX                  GO CHECK SIX BYTES              09666002
         BM    CHEKFOUR                 GO CHECK FOUR BYTES             09668002
CHEKTWO  DS    0H                       NEXT INSTRUCTION MAY ABEND      09668102
         OC    D0(L2,R7),D0(R7)         TRY FOR PROTECTION CHECK        09668402
BLOWTWO  DS    0H                       FOR PROTECTION CHECK STAE ENTRY 09668802
         B     GETELEM                  GO GET CORE FOR BRKELEM         09669202
         SPACE                                                          09669302
CHEKSIX  DS    0H                       INSTRUCTION IS SIX BYTES        09669602
         OC    D0(L6,R7),D0(R7)         TRY FOR PROTECTION CHECK        09669702
BLOWSIX  DS    0H                       FOR PROTECTION CHECK STAE ENTRY 09669802
         B     GETELEM                  GO GET CORE FOR BRKELEM         09669902
         SPACE                                                          09672002
CHEKFOUR DS    0H                       INSTRUCTION IS FOUR BYTES       09673202
         OC    D0(L4,R7),D0(R7)         TRY FOR PROTECTION CHECK        09675202
BLOWFOUR DS    0H                       FOR PROTECTION CHECK STAE ENTRY 09675602
         SPACE                                                          09675702
GETELEM  DS    0H                       CORE IS NOT WRITE-PROTECTED     09676002
         LR    R0,R1                    R1=NUMBER BYTES REQUIRED        09676702
         ST    R0,BYTENUMB              SAVE IN WORKAREA                09690002
         GETMAIN RC,LV=(0),SP=1        GET STORAGE REQUIRED             09700002
*                                       FOR BRK ELEMENT.                09710002
SMTGET01 DS    0H                       FOR SMT TEST CASES.             09720002
         SPACE                                                          09730002
*********************************************************************** 09740002
*        ZERO ENTIRE BREAK ELEMENT.                                   * 09750002
*********************************************************************** 09760002
BLOW2    DS    0H                       HERE'S THE RESUME ADDR          09770002
*                                       IF THE GETMAIN BLOWS            09780002
*                                       FOR LACK OF STORAGE.            09790002
         LTR   R15,R15       WAS GETMAIN SUCCESSFUL?                    09792002
         BZ    BLOW2C        YES, CONTINUE                              09794002
         LA    R1,SVC10NO    R1=SVC 10 NUMBER                           09796002
* ISSUE 'GETMAIN SVC ERROR' MESSAGE                                     09798002
         BAL   R5,GETFREIO   PUT OUT MESSAGE                            09798402
         C     R15,ATTNCODE  IS RETURN CODE=16,20,24?                   09798802
         BNL   RETURNRC      YES, SEND IT TO CALLER                     09799202
         LA    R15,TWENTY    SET RETURN CODE TO 20 TO LOOK LIKE ABEND   09799602
         B     RETURNRC      SEND IT TO CALLER                          09799702
BLOW2C   EQU   *                                                        09799802
         LR    R2,R1                    R2=BREAK ELEMENT ADDR.          09800002
         USING BRKELEM,R2               BREAK ELEMENT ADDRESSABILITY.   09810002
         XC    BRKELEM(BRKLEN),BRKELEM  ZERO BREAK ELEMENT              09820002
         LA    R4,BRKLEN(R2)            R4=ADDR STRING SAVE ADDR.       09830002
         ST    R4,STRNGADR              SAVE ADDRESS OF ADDRESS         09840002
*                                       STRING FOR LATER USE            09850002
         SPACE                                                          09860002
*********************************************************************** 09870002
*        THE FOLLOWING INSTRUCTIONS BUILD THE ADDRESS STRING          * 09880002
*        AS ENTERED BY THE USER INTO THE ADDRESS STRING SAVE AREA     * 09890002
*        FOR THIS BREAKPOINT.                                         * 09900002
*********************************************************************** 09910002
         LA    R1,D2(R4)                R1=SAVE AREA POINTER FOR BUILD. 09920002
         LR    R0,R11                   R0=ADDRESS OF ADDRESS PDE       09970002
         L     R15,TSTADDR              R15=ADDRESS OF ADDRESS          09980002
*                                       STRING BUILD ROUTINE            09990002
         BALR  R14,R15                  GO TO BUILD ROUTINE             10000002
         STH   R0,D0(R4)                SAVE LENGTH OF STRING           10010002
         SPACE                                                          10020002
*********************************************************************** 10030002
*        IF THIS PDE IS PART OF A LIST, GO BUILD THE BREAK            * 10040002
*        ELEMENT FOR IT. IF NOT, MOVE THE SUBCOMMAND CHAIN FOR        * 10050002
*        IT TO THE GETMAIN AREA AND SAVE A POINTER TO IT IN           * 10060002
*        CHNADDR FIELD OF WORKAREA.                                   * 10070002
*********************************************************************** 10080002
CHNSAVE  DS    0H                                                       10090002
         TM    PDEUSER,PDEADLST         Q.IS PDE FLAGGED AS A LIST PDE. 10100002
         BO    GOBUILD                  YES, DON'T CHECK FOR CHAIN      10110002
         LA    R5,D7(R1)                SET CHAIN SAVE ADDRESS REGISTER 10120002
         N     R5,DBLBND                ROUND UP TO DOUBLE              10130002
*                                       WORD FOR FREEMAIN               10140002
         ST    R5,CHNADDR               SAVE IN WORK AREA               10150002
         L     R1,PDLADDR               R1=PDL POINTER                  10160002
         USING IKJPARMD,R1              R1 IS BASE FOR PDL              10170002
         L     R7,SBCMDCHN+EXPRPTR-EXPRPDE  R7=CHAIN STRING ADDRESS.    10180002
         LA    R7,D0(R7)                CLEAR HIGH ORDER BYTE           10190002
         LTR   R7,R7                    Q.IS A CHAIN SPECIFIED.         10200002
         BZ    NOCHAIN                  NO, BUILD THE BREAK ELEMENT.    10210002
         LH    R6,SBCMDCHN+EXPRLNH-EXPRPDE  R6=LENGTH OF COMMAND CHAIN  10220002
         STH   R6,D0(R5)                PLACE CHAIN LNH IN SAVE AREA    10230002
         BCTR  R6,ZERO                  DECREMENT R6 FOR EXECUTE        10240002
         EX    R6,CHNMVC                MOVE CHAIN TO SAVE AREA         10250002
         LA    R6,D3(R6)                R6=LENGTH OF COMMAND            10260002
*                                       CHAIN+LENGTH FIELD              10270002
         ALR   R6,R5                    R6=POINTER TO LAST BYTE         10280002
*                                       OF CHAIN SAVE AREA              10290002
         XC    D0(L1,R6),D0(R6)         ZERO LAST BYTE                  10300002
         B     GOBUILD                  BUILD BREAK ELEMENT             10310002
         SPACE                                                          10320002
CHNMVC   MVC   D2(L1,R5),D0(R7)         EXECUTE MVC FOR COMMAND CHAINS. 10330002
         SPACE                                                          10340002
NOCHAIN  DS    0H                       NO CHAIN SAVE ADDRESS           10350002
         SR    R5,R5                    ZERO REGISTER                   10360002
         ST    R5,CHNADDR               SAVE IN WORK AREA               10370002
         SPACE                                                          10380002
*********************************************************************** 10390002
*                                                                     * 10400002
*        THIS SERIES OF INSTRUCTIONS BUILDS A BREAK ELEMENT AND       * 10410002
*        SETS A BREAK SVC INTO THE PROBLEM PROGRAM.  IF THE PDE       * 10420002
*        PASSED IS ONE OF A RANGE, ALL BREAK ELEMENTS ARE BUILT FOR   * 10430002
*        THE RANGE AND ALL SVC'S INSERTED IN THE PROBLEM PROGRAM.     * 10440002
*                                                                     * 10450002
*********************************************************************** 10460002
GOBUILD  DS    0H                                                       10470002
         L     R5,PDEUSER               GET ADDRESS OF BREAKPOINT       10480002
*                                       INSERTION                       10490002
         LA    R5,D0(R5)                CLEAR HIGH ORDER BYTE OF ADDR   10500002
         LA    R6,BREAKTAB              R6=HEAD OF BREAK ELEMENT CHAIN. 10510002
         L     R7,BREAKTAB              R7=1ST ELEMENT ON CHAIN.        10520002
         SPACE                                                          10530002
*********************************************************************** 10540002
*        BREAK ELEMENT QUEUE IS ARRANGED IN ASCENDING ORDER OF        * 10550002
*        BREAKPOINT ADDRESSES. FIND APPROPRIATE PLACE IN QUEUE        * 10560002
*        FOR THIS ENTRY AND GO PLACE IT IN QUEUE.                     * 10570002
*********************************************************************** 10580002
SEQLOOP  DS    0H                       EXAMINE CURRENT CHAIN           10590002
         LTR   R7,R7                    Q.ANY MORE ELEMENTS ON CHAIN.   10600002
         BZ    ADDL                     NO, ADD CURRENT ELEMENT         10610002
*                                       TO CHAIN                        10620002
         L     R8,BRKADDR-BRKELEM(R7)   R8=BRK ADDR OF EXISTING BRKPT   10630002
         CR    R8,R5                    Q.ADDRESS FOR NEW BREAKPOINT    10640002
*                                       HIGH ?                          10650002
         BE    DUPLICAT                 DUPLICATE BREAK ADDR FOUND      10660002
         BH    ADDL                     HIGH, ADD NEW BREAK ELEM HERE.  10670002
         SPACE                                                          10680002
CONTCHK  DS    0H                       CONTINUE SEARCHING QUEUE        10690002
         LA    R6,BRKLINK-BRKELEM(R7)   R6=NEW LINK FIELD ADDR.         10700002
         L     R7,BRKLINK-BRKELEM(R7)   R7=NEXT BREAK ELEMENT ADDR.     10710002
         B     SEQLOOP                  TRY AGAIN.                      10720002
         SPACE                                                          10730002
*********************************************************************** 10740002
*        ADD BREAK ELEMENT TO CHAIN. SAVE ADDRESS OF PREVIOUS         * 10750002
*        LINK FIELD FOR ERROR RECOVERY. PUT REQUIRED DATA  IN         * 10760002
*        BREAK ELEMENT.                                               * 10770002
*********************************************************************** 10780002
ADDL     DS    0H                       ADJUST POINTERS FOR             10790002
*                                       NEW ELEMENTS                    10800002
         ST    R6,SAVEPTR               SAVE LINK FIELD POINTER         10810002
         ST    R2,D0(R6)                PLACE NEW BRK ELEM ADDR         10820002
*                                       IN CHAIN                        10830002
         ST    R7,BRKLINK               HOOK CHAIN TO NEW BRK           10840002
*                                       LINK FIELD                      10850002
         ST    R5,BRKADDR               PLACE INSTR ADDR IN BRK ELEM.   10860002
         MVC   BRKNAME,STRNGADR         PLACE ADDR SAVE AREA            10870002
*                                       ADDR IN BRKELEM                 10880002
         MVC   BRKCHAIN,CHNADDR         PLACE CHAIN SAVE AREA           10890002
*                                       ADDR IN BRK ELEM                10900002
         L     R1,PDLADDR               R1=ADDR OF PDL                  10910002
         TM    COUNT+D1,FF              Q.IS COUNT SPECIFIED.           10920002
         BZ    SKIPCT                   NO, LEAVE COUNT FIELD ZERO.     10930002
         L     R1,CONAREA               R1=IKJEGCVT OUTPUT AREA ADDR.   10940002
         MVC   BRKCOUNT(L2),CONCOUNT-CONBYTE+D2(R1)  SET COUNT FIELD.   10950002
         MVC   BRKCOUNT+D2(L2),BRKCOUNT                                 10960002
         SPACE                                                          10970002
SKIPCT   DS    0H                       SAVE BREAK INSTRUCTION          10980002
         MVC   BRKINST+D2(L6),INITCON   INITIALIZE INSTR. SAVE FIELD.   10990002
         TM    BRKFLGS,BRKRANGE         IS THIS BREAK ELEMENT           11000002
*                                       PART OF A RANGE ?               11010002
         BZ    SETFLAGS                 NO - DISPLACEMENT OF ZERO IS    11020002
*                                       OK, SO GO SET PARAMETER FLAGS   11030002
         L     R6,PDEUSER               R6=BINARY ADDR FROM PDE.        11040002
         LA    R6,D0(R6)                ZERO HIGH BYTE.                 11050002
         SR    R5,R6                    R5=DISP FROM BEGINNING OF       11060002
*                                       RANGE(IF RANGE)                 11070002
         STH   R5,BRKDISP               PLACE DISPLACEMENT IN BRK ELEM. 11080002
         L     R5,BRKADDR               RESET R5                        11090002
SETFLAGS DS    0H                                                       11100002
         L     R1,PDLADDR               R1=ADDRESS OF PDL.              11110002
         TM    NONOT+D1,TWO             Q.NONOTIFY SPECIFIED.           11120002
         BZ    NOTIFY                   NO, DON'T SET SWITCH.           11130002
         OI    BRKFLGS,BRKNONOT         YES, SET SWITCH.                11140002
         SPACE                                                          11150002
NOTIFY   DS    0H                       CHECK FOR ADDRESS IN A LIST     11160002
         TM    PDEUSER,PDEADLST         Q.IS BREAK ONE OF A LIST.       11170002
         BZ    NOLIST                   NO, DON'T SET SWITCH.           11180002
         OI    BRKFLGS,BRKLIST          YES, DO.                        11190002
         SPACE                                                          11200002
*********************************************************************** 11210002
*        BAL, AND BALR INSTRUCTIONS ARE HANDLED IN A                  * 11220002
*        SPECIAL WAY. IF THE INSTRUCTION AT THE BREAKPOINT IS A       * 11230002
*        BAL OR BALR, SET THE CORRESPONDING FLAG                      * 11240002
*        IN THE BRKFLGS FIELD TO INDICATE THIS.                       * 11250002
*********************************************************************** 11260002
NOLIST   DS    0H                       CHECK FOR BAL OR BALR INSTR.    11270002
         CLI   D0(R5),BAL               Q.IS IT BAL INSTR.              11280002
         BE    BALI                     YES, SET BALSW BIT IN BRK ELEM. 11290002
         CLI   D0(R5),BALR              Q.IS IT BALR INSTR.             11300002
         BNE   LENGTH                   NEITHER, GO CHECK LENGTH        11310002
         SPACE                                                          11320002
BALI     DS    0H                       SET ELEMENT TO INDICATE BAL     11330002
*                                       OR BALR INSTRUCTION             11340002
         OI    BRKFLGS,BALSW            TURN ON BIT.                    11350002
         SPACE                                                          11430002
*********************************************************************** 11440002
*        FIND LENGTH OF INSTRUCTION AT BREAKPOINT AND MOVE IT         * 11450002
*        INTO THE BREAK ELEMENT. TOP TWO BITS IN OP CODE TELL         * 11460002
*        LENGTH OF INSTRUCTION. '00' = 2 BYTES, '01'='10' =           * 11470002
*        4 BYTES, '11' = 6 BYTES.                                     * 11480002
*********************************************************************** 11490002
LENGTH   DS    0H                       DETERMINE INSTRUCTION LENGTH    11500002
         TM    D0(R5),LENBITS           Q.HOW LONG IS INSTRUCTION.      11510002
         BO    SIXBYTE                  SIX BYTES.                      11520002
         BM    FOURBYTE                 FOUR BYTES.                     11530002
         MVC   BRKINST(L2),D0(R5)       SAVE INSTRUCTION.               11540002
         LA    R5,D2(R5)                BUMP INSTR ADDR REGISTER.       11550002
         B     CHECKMOR                 CHECK FOR MORE IN RANGE.        11560002
         SPACE                                                          11570002
FOURBYTE DS    0H                       INSTRUCTION LENGTH=4            11580002
         MVC   BRKINST(L4),D0(R5)       SAVE INSTRUCTION.               11590002
         LA    R5,D4(R5)                BUMP INSTR ADDR REGISTER.       11600002
         B     CHECKMOR                 CHECK FOR MORE IN RANGE.        11610002
         SPACE                                                          11620002
SIXBYTE  DS    0H                       INSTRUCTION LENGTH=6            11630002
         MVC   BRKINST(L6),D0(R5)       SAVE INSTRUCTION.               11640002
         LA    R5,D6(R5)                BUMP INSTR ADDR REGISTER.       11650002
         SPACE                                                          11660002
*********************************************************************** 11670002
*        CHECK TO BE SURE INSTRUCTION AT BREAKPOINT ADDRESS IS        * 11680002
*        VALID. IF NOT, GO PUT OUT MESSAGE.                           * 11690002
*********************************************************************** 11700002
CHECKMOR DS    0H                       DOES INSTR. HAVE VALID OP CODE  11710002
         L     R1,BRKADDR               R1=POINTER TO BREAK INSTR.      11720002
         L     R8,OPCODTAB              R8=POINTER TO TABLE OF OP CODES 11730002
         LR    R4,R1                    PUT ADDRESS OF FIRST BYTE       11740002
*                                       OF OP CODE IN R4                11750002
         LA    R6,L5                    PUT LENGTH OF ONE BYTE OP CODE  11760002
*                                       TABLE ENTRY IN R6               11770002
CKCODE   DS    0H                       CODE LOOP                       11780002
         XR    R7,R7                    ZERO R7                         11790002
         IC    R7,D0(R4)                R7=OP CODE OF INSTRUCTION       11800002
         MR    R6,R6                    GET INDEX FOR OP CODE TABLE     11810002
         LA    R8,D0(R7,R8)             R8=ADDRESS FOR OP CODE TEST     11820002
         TM    D0(R8),FF                WAS OP CODE VALID               11830002
         BNZ   OPCODEOK                 BRANCH IF VALID OP CODE         11840002
         SPACE                                                          11850002
         CR    R1,R4                    WAS SECOND BYTE OF OPCODE       11860002
*                                       CHECKED ?                       11870002
         BNE   BADOPCD                  YES, OP CODE NO GOOD            11880002
         CLI   D0(R1),HEXB2             ELSE CHECK FOR 2 BYTE OP CODE   11890002
         BNE   BADOPCD                  BRANCH IF INVALID OP CODE       11900002
         LA    R4,D1(R1)                PUT ADDRESS OF SECOND BYTE      11910002
*                                       OF 2-BYTE OP CODE IN R4         11920002
         CLI   D0(R4),TWOHIGH           CHECK TO SEE IF SECOND BYTE     11930002
*                                       IS WITHIN RANGE                 11940002
         BH    BADOPCD                  NO, BAD OP CODE                 11950002
         LA    R6,L6                    PUT LENGTH OF 2-BYTE OP CODE    11960002
*                                       TABLE ENTRY IN R6               11970002
         L     R8,TSTOPCD2              POINT TO TABLE OF 2-BYTE OP     11980002
*                                       CODES                           11990002
         B     CKCODE                   GO CHECK SECOND BYTE            12000002
         SPACE                                                          12010002
*********************************************************************** 12020002
*        MOVE SVC97 OP CODE TO REPLACE INSTRUCTION AT BREAKPOINT.     * 12030002
*        IF NO RANGE, OR END OF RANGE, GO CHECK FOR MORE PDES.        * 12040002
*        IF RANGE, SET RANGE FLAG IN BREAKELEMENT, GET CORE           * 12050002
*        FOR ANOTHER BREAK ELEMENT, RESET LINK POINTERS, AND GO       * 12060002
*        PROCESS NEXT INSTRUCTION IN RANGE.                           * 12070002
*********************************************************************** 12080002
OPCODEOK DS    0H                       OP CODE IS VALID                12090002
         MVC   D0(L2,R1),RSVC           SET BREAKPOINT SVC IN INSTR.    12100002
         L     R6,PDE2USER              R6=END OF RANGE(IF RANGE).      12110002
         LA    R6,D0(R6)                CLEAR HIGH ORDER BYTE           12120002
         CR    R5,R6                    Q. IS NEXT INSTRUCTION HIGH     12130002
         BH    NEXTCHAI                 YES, GET NEXT PDE               12140002
         TM    D0(R5),LENBITS           HOW MANY BYTES IN INSTRUCTION ? 12140402
         BO    TRYSIX                   SIX BYTE INSTRUCTION            12141202
         BM    TRYFOUR                  FOUR BYTE INSTRUCTION           12141602
         OC    D0(L2,R5),D0(R5)         TRY FOR PROTECTION CHECK        12142002
BLOW12   DS    0H                       RESUME ADDRESS FOR PROT. CK     12144002
         B     RANGFLAG                 TURN ON RANGE FLAG              12146002
         SPACE                                                          12146402
TRYSIX   DS    0H                       SIX BYTE INSTRUCTION            12148002
         OC    D0(L6,R5),D0(R5)         TRY FOR PROTECTION CHECK        12148402
BLOW16   DS    0H                       RESUME ADDRESS FOR PROT. CK.    12148802
         B     RANGFLAG                 TURN ON RANGE FLAG              12149202
         SPACE                                                          12149602
TRYFOUR  DS    0H                       FOUR BYTE INSTRUCTION           12149702
         OC    D0(L4,R5),D0(R5)         TRY FOR PROTECTION CHECK        12149802
BLOW14   DS    0H                       RESUME ADDRESS FOR PROT. CK.    12149902
         SPACE                                                          12153202
RANGFLAG DS    0H                       TURN ON RANGE FLAG              12155202
         OI    BRKFLGS,BRKRANGE         WE'RE IN A VALID RANGE.         12156702
         LA    R0,BRKLEN                R0=LENGTH FOR GETMAIN           12160002
         ST    R0,BYTENUMB              SAVE IN WORKAREA                12180002
         GETMAIN RC,LV=(0),SP=1                                         12190002
SMTGET02 DS    0H                       FOR SMT TEST CASES.             12200002
BLOW4    DS    0H                       RESUME ADDRESS IN CASE          12210002
*                                       OF GETMAIN FAILURE              12220002
         LTR   R15,R15       WAS GETMAIN SUCCESSFUL?                    12222002
         BZ    BLOW4C        YES, BRANCH TO CONTINUE                    12224002
         LA    R1,SVC10NO    R1=SVC 10 NUMBER                           12226002
* ISSUE 'GETMAIN SVC ERROR' MESSAGE                                     12228002
         BAL   R5,GETFREIO   PUT OUT MESSAGE                            12228402
         C     R15,ATTNCODE  IS RETURN CODE 16,20 OR 24?                12228802
         BNL   RETURNRC      YES, SEND IT TO CALLER                     12229202
         LA    R15,TWENTY    SET RETURN TO ABEND TYPE                   12229602
         B     RETURNRC      SEND IT TO CALLER                          12229702
BLOW4C   EQU   *                                                        12229802
         XC    D0(BRKLEN,R1),D0(R1)     CLEAR NEW BREAK ELEMENT         12230002
         OI    BRKFLGS-BRKELEM(R1),BRKRANGE TURN ON RANGE SWITCH.       12240002
         LA    R6,BRKLINK               R6=LINK FIELD ADDR IN           12250002
*                                       PREVIOUS BRK ELEM.              12260002
         L     R7,BRKLINK               R7=CONTENTS OF THAT LINK FIELD. 12270002
         LR    R2,R1                    R2=ADDR OF NEW BRK ELEM.        12280002
         B     SEQLOOP                  GO BUILD IT.                    12290002
         SPACE                                                          12300002
*********************************************************************** 12310002
*        OP CODE WAS BAD. BUILD MESSAGE IN OUTPUT BUFFER AND SEND     * 12320002
*        TO TERMINAL.                                                 * 12330002
*********************************************************************** 12340002
BADOPCD  DS    0H                       A BAD OP CODE HAS BEEN FOUND    12350002
         OI    TSTFLGS4,TSTFLUSH TURN ON TSTFLUSH SO MNL WILL           12400002
*                                FLUSH INPUT STACK                      12450002
         L     R6,SAVEPTR    R6=PTR TO PREVIOUS LINK FIELD              12500002
         MVC   D0(L4,R6),BRKLINK RESET PREVIOUS LINK FIELD              12550002
         LH    R7,BRKDISP    R7=BREAKPOINT DISPLACEMENT                 12560002
         L     R0,BYTENUMB   R0=NUMBER OF BYTES LAST GOTTEN             12600002
         FREEMAIN RC,LV=(R0),A=(R2),SP=1 FREEMAIN CORE LAST GOTTEN      12650002
         LTR   R15,R15       WAS FREEMAIN SUCCESSFUL?                   12700002
         BZ    BOC1          YES, BRANCH TO CONTINUE                    12710002
         LA    R1,SVC120NO   R1=SVC 120 NUMBER                          12720002
* ISSUE 'FREEMAIN SVC ERROR' MESSAGE                                    12722002
         BAL   R5,GETFREIO   PUT OUT MESSAGE                            12730002
         BAL   R5,IORC2      TEST IO RETURN CODES AND CONTINUE          12740002
BOC1     EQU   *                                                        12742002
         OC    PDE2USER+D1(L3),PDE2USER+D1 IS ADDRESS IN RANGE          12750002
         BNZ   RANGMSG       YES,OUTPUT RANGE MESSAGE                   12800002
         LA    R1,MSG10      R1=ADDR OF MESSAGE NUMBERS                 12850002
         BAL   R5,IOTYPE3    PUT OUT MESSAGE                            12900002
         BAL   R5,IORC2      TEST IO RC'S                               13100002
         B     NEXTCHAI      CHECK FOR MORE BRKELEMS TO BE BUILT        13150002
RANGMSG  DS    0H                                                       13200002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM LIST         13300002
* ISSUE 'NO BREAKPOINTS ESTABLISHED FROM OFFSET OF RANGE BEGINNING'     13350002
* ISSUE 'INVALID OP CODE' MESSAGE                                       13400002
         IKJEGSIO MSG,FIRST=M0037,INST11=(REG,(R7)),ID=AT004,          *13410002
               INST12=(APDE,(R11)),SECOND=M0244,MF=(E,TSTIOPRM)         13414002
         BAL   R5,IORC2      TEST IO RC'S                               13416002
         B     NEXTCHAI      CHECK FOR MORE BRKELEMS TO BE BUILT        13418002
         SPACE                                                          13420002
*********************************************************************** 13430002
*        NORMAL RETURN TO CALLER FROM BREAKRTN. RC = 0.               * 13440002
*********************************************************************** 13450002
ROUTRTN  DS    0H                       NORMAL RETURN TO CALLER.        13460002
         SR    R15,R15                  INDICATE NORMAL RETURN.         13470002
         SPACE                                                          13480002
*********************************************************************** 13490002
*        RETURN TO CALLER FROM BREAKRTN. LEAVE RETURN CODE IN R15.    * 13500002
*********************************************************************** 13510002
RETURNRC DS    0H                       ABNORMAL RETURN TO CALLER.      13520002
         L     R13,SAVELAST-SAVEAREA(R13)  RESET R13 TO RESTORE         13530002
*                                       CALLER'S REGISTERS              13540002
         RETURN (14,12),RC=(15)         RETURN TO CALLER.               13550002
         SPACE                                                          13560002
*********************************************************************** 13570002
*        BREAKPOINT ADDRESS IS A DUPLICATE OF AN EXISTING BREAKPOINT  * 13580002
*        REMOVE EXISTING BREAK ELEMENT AND GO ADD THIS ONE TO         * 13590002
*        THE QUEUE.                                                   * 13600002
*********************************************************************** 13610002
DUPLICAT DS    0H                       DUPLICATE BREAK ADDR FOUND      13620002
         LA    R1,SRHPARMS              R1=ADDRESS OF SRH PARM LIST     13630002
         XC    SRHPARMS(SRHPRMLH),SRHPARMS       ZERO SRH PARM LIST     13680002
         ST    R5,SRHADDR1              PUT BREAKPOINT ADDRESS          13690002
*                                       IN SRH PARM LIST                13700002
         L     R15,TSTSRHRT             GET ADDRESS OF BRKELEM          13710002
*                                       REMOVAL ROUTINE                 13712002
         BALR  R14,R15                  BRANCH TO BRKELEM REMOVAL RTN   13714002
         L     R7,D0(R6)                R6 POINTS TO PREVIOUS LINK      13716002
*                                       FIELD - PUT ADDRESS OF NEXT     13718002
*                                       BRKELEM IN R7                   13718402
         C     R15,ATTNCODE  IS RETURN CODE LESS THAN 16?               13728402
         BNL   RETURNRC      NO,SEND RETURN CODE TO MAIN ROUTINE        13730402
         B     ADDL          GO BUILD A NEW BRKELEM                     13732402
         SPACE                                                          13735802
*********************************************************************** 13737902
*        IF NO MORE CONVERTED PDES, RETURN TO CALLER WITH RC = 0.     * 13740002
*        IF MORE PDES, FLAG THEM AS PART OF A LIST AND GO             * 13750002
*        PROCESS THEM.                                                * 13760002
*********************************************************************** 13770002
NEXTCHAI DS    0H                       EXAMINE CHAIN FIELD             13780002
         L     R11,PDE2CHAI             R11=CHAIN POINTER FOR           13790002
*                                       ADDR LIST                       13800002
         LA    R11,D0(R11)              CLEAR HIGH ORDER BYTE.          13810002
         LTR   R11,R11                  Q.IS A LIST POINTER PRESENT.    13820002
         BZ    ROUTRTN                  NO, ALL DONE, RETURN.           13830002
         TM    PDEUSER,PDECONVD         Q.WAS PDE CONVERTED             13840002
         BZ    NEXTCHAI                 NO, ARE MORE PDE'S CHAINED      13850002
         OI    PDEUSER,PDEADLST         FLAG THE PDE AS A               13860002
*                                       MEMBER OF A LIST                13870002
         B     SUPRLOOP                 CALCULATE SIZE,                 13880002
*                                       BUILD BREAK ELEMENT             13890002
         SPACE                                                          13900002
*********************************************************************** 13910002
*        PARSE RETURNED A NONZERO RETURN CODE. USE THIS BRANCH        * 13920002
*        TABLE TO PROCESS.                                            * 13930002
*********************************************************************** 13940002
         ORG   *-4                      REUSE SPACE FOR IMPOSSIBLE      13950002
*                                       ZERO RETURN CODE                13960002
CHKCODE  DS    0H                       THIS CODE IS ENTERED TO         13970002
*                                       DETERMINE WHY PARSE WAS         13980002
*                                       UNSUCCESSFUL                    13990002
         ORG                                                            14000002
         B     EXITOK1                  USER SPECIFIED NO PROMPT        14010002
         B     SET16                    ATTENTION INTERRUPT             14020002
         B     INVPARM                  AN INVALID PARAMETER WAS USED   14030002
*                                       IN PARSE                        14040002
         B     NOCORE                   INSUFFICIENT CORE               14050002
         B     PICKUP                   GET RETURN CODE FROM WORK AREA  14060002
         SPACE                                                          14070002
*********************************************************************** 14080002
*        PARSE RETURN CODE 4 - USER ENTERED INCOMPLETE/INCORRECT      * 14090002
*        DATA, BUT PROFILE WAS FOR NOPROMPT. SET FLAG IN TCOMTAB      * 14100002
*        TO TELL MAINLINE TO FLUSH INPUT STACK. RETURN TO MAINLINE    * 14110002
*        WITH RC = 0.                                                 * 14120002
*********************************************************************** 14130002
EXITOK1  DS    0H                                                       14140002
         OI    TSTFLGS4,TSTFLUSH        INDICATE FLUSH OF STACK.        14150002
         SR    R15,R15       ZERO RETURN CODE                           14160002
         B     RETMAIN       RETURN TO IKJEGMNL                         14162002
         SPACE                                                          14170002
*********************************************************************** 14180002
*        PARSE RETURN CODE 20 - VALIDITY CHECK ERROR. GET RETURN      * 14190002
*        CODE SAVED BY VALIDITY CHECK ROUTINE AND RETURN TO           * 14200002
*        MAINLINE WITH THAT AS A RETURN CODE.                         * 14210002
*********************************************************************** 14220002
PICKUP   DS    0H                       PICK UP RETURN CODE AND RETURN  14230002
         L     R15,PARSECD              GET RETURN CODE                 14240002
         B     RETMAIN                  RETURN TO MAINLINE              14250002
         SPACE                                                          14260002
*********************************************************************** 14270002
*        PARSE RETURN CODE 16 - NOT ENOUGH CORE. ISSUE MESSAGE,       * 14280002
*        AND RETURN TO MAINLINE WITH RC = 0.                          * 14290002
*********************************************************************** 14300002
NOCORE   DS    0H                       PUT OUT MSG. FOR INSUFFICIENT   14310002
*                                       STORAGE                         14320002
         BAL   R5,IOTYPE1    PUT OUT MESSAGE                            14370002
         BAL   R5,IORC1      TEST IO RC'S                               14376002
         B     CODE0                    SET RETURN CODE TO ZERO AND     14380002
*                                       RETURN TO MAINLINE              14390002
         SPACE                                                          14400002
*********************************************************************** 14410002
*        PARSE RETURN CODE 12 - AN INVALID PARAMETER WAS PASSED       * 14420002
*        TO PARSE. ISSUE MESSAGE AND RETURN TO MAINLINE WITH RC = 0.  * 14430002
*********************************************************************** 14440002
INVPARM  DS    0H                       SET UP MESSAGE FOR UNABLE       14450002
*                                       TO PARSE                        14460002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM LIST         14470002
* ISSUE 'AT FAILED,COMMAND SYSTEM ERROR' MESSAGE                        14480002
* ISSUE 'PARSE ERROR CODE 12' MESSAGE                                   14490002
         IKJEGSIO MSG,FIRST=M0104,INST11=(NUM,I0013),SECOND=M0277,     *14492002
               ID=AT004,MF=(E,TSTIOPRM)                                 14494002
         BAL   R5,IORC1      TEST IO RC'S                               14496002
         B     CODE0         RETURN TO MNL WITH RC=0                    14498002
         SPACE                                                          14500002
*********************************************************************** 14700002
*        PARSE RETURN CODE 8 - AN ATTENTION WAS ENTERRED. SET         * 14710002
*        RC = 16 AND RETURN TO MAINLINE.                              * 14720002
*********************************************************************** 14730002
SET16    DS    0H                       SET RETURN CODE TO 16 FOR       14740002
         LA    R15,SIXTEEN              ATTENTION SCHEDULED             14750002
         B     RETMAIN                  RETURN TO MAINLINE              14760002
         EJECT                                                          14890002
*********************************************************************** 14900002
*                                                                     * 14910002
*               ESTAE EXIT ROUTINE                                    * 14920002
*                                                                     * 14930002
*********************************************************************** 14940002
RETRY    DS    0H                       AT'S RETRY ROUTINE IN CASE OF   14950002
*                                       AN ABEND                        14960002
*********************************************************************** 14970002
*        GET ADDRESS OF TCOMTAB                                       * 14980002
*********************************************************************** 14990002
         L     R5,CVTPTR                R5=ADDRESS OF CVT               15000002
         USING CVT,R5                   ESTABLISH ADDRESSABILITY        15010002
*                                       TO CVT                          15020002
         L     R5,CVTTCBP               R5=POINTER TO DOUBLE WORD       15030002
*                                       OF POINTERS TO NEXT-TO-BE       15040002
*                                       DISPATCHED TCB AND CURRENT      15050002
*                                       TCB                             15060002
         DROP  R5                                                       15070002
         L     R5,D4(R5)                R5=POINTER TO CURRENT TCB       15080002
*                                       (TEST'S TCB)                    15090002
         USING TCB,R5                   ESTABLISH ADDRESSABILITY TO     15100002
*                                       TEST'S TCB                      15110002
         L     R9,TCBTRN                R9=ADDRESS OF TCOMTAB           15120002
         DROP  R5                                                       15130002
         SPACE                                                          15140002
*********************************************************************** 15150002
*        RESTORE AT'S REGISTERS 13 AND 12(BASE).                      * 15160002
*********************************************************************** 15180002
         L     R13,REGSAVE2             R13=ADDRESS OF AT'S SAVE AREA   15190002
         L     R12,GR12-SAVEAREA(R13)   RESTORE BASE REGISTER           15200002
*********************************************************************** 15260002
*        IF AT WAS ENTERED TO ACTIVATE DEFERED BREAK ELEMENTS,        * 15270002
*        SET RETURN CODE TO 4 AND RETURN TO MAINLINE. OTHERWISE,      * 15280002
*        SET RETURN CODE TO 20 AND RETURN TO MAINLINE.                * 15290002
*********************************************************************** 15300002
         TM    TSTFLGS1,TSTBUILD        WAS THIS MODULE ENTERED TO      15320002
*                                       BUILD ACTIVE BREAKPOINTS        15330002
*                                       FROM THE DEFER QUEUE            15340002
         BO    CODE4                    YES, SET CODE TO 4              15350002
         LA    R15,TWENTY               R15=20 - INDICATES RETURN FROM  15360002
*                                       RETRY ROUTINE                   15370002
         B     RETMAIN                  RETURN TO MAINLINE              15380002
         EJECT                                                          15390002
*      ERRET FOR LINK TO IKJPARS                                        15392002
PARSERR  EQU   *                                                        15394002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM LIST         15396002
         LR    R0,R1         LOAD ABEND CODE INTO R0                    15396402
* ISSUE 'LINK TO IKJPARS SVC ERROR' MESSAGE                             15398002
         IKJEGSIO SVCERR,SVC=6,ABENDRG=(R0),RC=(R15),                  *15398402
               INST11=(NUM,I0040),ID=AT004,MF=(E,TSTIOPRM)              15398802
         C     R15,ATTNCODE  IS RETURN CODE 16,20 OR 24?                15399202
         BNL   RETMAIN       YES SEND IT TO IKJEGMNL                    15399602
         LA    R15,TWENTY    MAKE RETURN CODE LOOK LIKE ABEND           15399702
         B     RETMAIN       SEND IT TO MAINLINE                        15399802
         EJECT                                                          15400002
*********************************************************************** 15410002
* THIS SECTION RECEIVES CONTROL FROM IKJPARS ONCE IKJPARS HAS SCANNED * 15420002
* AN ADDRESS AND HAS DETERMINED THAT IT IS SYNTACTICALLY CORRECT.     * 15430002
* FURTHER VALIDITY CHECKING OF THE ADDRESS IS PERFORMED TO ENSURE     * 15440002
* THAT THE ADDRESS IS AN ACCEPTABLE TYPE FOR THE AT SUBCOMMAND.  IF   * 15450002
* AN ADDRESS IS FOUND TO BE UNACCEPTABLE, A MESSAGE IS ISSUED TO THE  * 15460002
* USER BEFORE CONTROL IS RETURNED TO IKJPARS.                         * 15470002
*********************************************************************** 15480002
         SPACE                                                          15490002
AT1ADDVC DS    0H                       VALIDITY CHECK FOR ADDRESS      15500002
         SAVE  (14,12),,AT1ADDVC        SAVE REGISTERS FROM PARSE       15510002
         L     R5,D4(R1)                R5=ADDR OF AT'S SAVE AREA       15520002
         L     R12,GR12-SAVEAREA(R5)    GET ADDRESSABILITY WITH MAIN    15530002
*                                       SECTIONS                        15540002
         L     R9,GR9-SAVEAREA(R5)      R9=ADDR OF TCOMTAB              15550002
         L     R6,REGSAVE3              R6=ADDR OF EXIT ROUTINE'S       15560002
*                                       SAVE AREA                       15570002
         ST    R13,SAVELAST-SAVEAREA(R6)   SAVE ADDR OF PARSE'S         15580002
*                                       SAVE AREA                       15590002
         ST    R6,SAVENEXT-SAVEAREA(R13)  SAVE ADDR OF EXIT'S SAVE AREA 15600002
*                                       IN PARSE'S SAVE AREA            15610002
         LR    R13,R6                   R13=ADDR OF THIS ROUTINE'S SAVE 15620002
*                                       AREA                            15630002
         L     R10,WORKAREA             R10=ADDRESS OF COMMON WORKAREA  15640002
         LA    R8,D8(R1)                R8=ADDR OF LAST WORD OF         15650002
*                                       PARSE'S PARM LIST               15660002
         SPACE                                                          15670002
         L     R11,D0(R1)               R11=ADDRESS OF PDE              15680002
         USING IKJPARMA,R11             ESTABLISH ADDRESSABILITY TO PDE 15690002
         OI    TSTFLGS4,TSTVALCK TURN ON VALIDITY CHECK BIT             15692002
         L     R4,OUTBUF     R4=ADDR OF OUTBUF                          15694002
         XC    D0(L4,R4),D0(R4) ZERO FIRST WORD OF OUTBUF               15696002
         SPACE                                                          15700002
*********************************************************************** 15710002
*        CHECK FOR INVALID ADDRESS TYPE. IF INVALID, GO PUT           * 15720002
*        OUT MESSAGE.                                                 * 15730002
*********************************************************************** 15740002
         XR    R4,R4                    CLEAR REGISTER FOR TESTS        15750002
         CH    R4,PDEINDCT              IS ADDRESS INDIRECT             15760002
         BNE   CHKRANGE                 YES, WAS A RANGE GIVEN          15770002
         TM    PDEFLG4,GENR+LFPR+SFPR   IS ADDRESS REGISTER TYPE ?      15780002
         BM    STORMSG                  YES, PUT OUT ERROR MESSAGE      15790002
         SPACE                                                          15800002
*********************************************************************** 15810002
*        IF A RANGE WAS ENTERED, GO CHECK IT.                         * 15820002
*********************************************************************** 15830002
CHKRANGE DS    0H                       WAS A RANGE SPECIFIED           15840002
         TM    PDE2FLG2,CTNAMFLG        ENTRYNAME GIVEN IN SECOND PDE   15850002
         BO    RANGE                    YES, CHECK FOR VALID ADDRESS    15860002
         TM    PDE2FLG3,AFLG            STRING GIVEN                    15870002
         BO    RANGE                    YES, CHECK FOR VALID ADDRESS    15880002
         SPACE                                                          15890002
*********************************************************************** 15900002
*        RANGE NOT GIVEN. IF LOADNAME AND ADDRESS STRING ARE          * 15910002
*        GIVEN, GO CHECK FOR VALID SYMBOL.                            * 15920002
*********************************************************************** 15930002
NORANGE  DS    0H                       RANGE NOT GIVEN - TEST FOR      15940002
*                                       FULLY QUALIFIED NAME            15950002
         TM    PDEFLG1,LDNAMFLG         LOADNAME GIVEN                  15960002
         BZ    EXITCONV                 NO, CONVERT ADDRESS             15970002
         TM    PDEFLG3,AFLG             STRING GIVEN                    15980002
         BNZ   TESTSYM                  INSURE ADDRESS STRING IS NOT    15990002
*                                       SYMBOL WITH LENGTH GREATER      16000002
*                                       THAN EIGHT                      16010002
         SPACE                                                          16020002
*********************************************************************** 16030002
*        NEITHER LOADNAME NOR ADDRESS STRING WERE GIVEN. CONVERT      * 16040002
*        ADDRESS TO BINARY, BE SURE ADDRESS IS WRITABLE,              * 16050002
*        AND BE SURE CONVERTED ADDRESS IS IN PDEUSER FIELD.           * 16060002
*********************************************************************** 16070002
EXITCONV DS    0H                       SET UP FOR GOING TO CONVERT     16080002
*                                       ROUTINE                         16090002
         LCR   R1,R11                   R1=COMPLEMENT OF ADDRESS OF PDE 16100002
*                                       TO INDICATE ADDRESS CONVERT     16110002
         XR    R0,R0                    R0=ZERO TO INDICATE CONVERT TO  16120002
*                                       BINARY                          16130002
         OI    TSTFLGS1,RANGESW         TELL CONVERT TO EXPECT A RANGE  16140002
         L     R15,TSTCONVT             R15=ADDRESS OF CONVERT ROUTINE  16150002
         BALR  R14,R15                  GET ADDRESS CONVERTED           16160002
         LTR   R15,R15                  WAS CONVERT SUCCESSFUL          16170002
         BNZ   NOTCONV(R15)             NO, SEE IF PDE USELESS          16180002
         TM    PDEFLG5,PDEWRITE         IS ADDRESS WRITABLE ?           16182002
         BZ    ADDRPROT                 NO, CAN'T PUT A BRKPT THERE     16184002
         TM    PDEUSER,PDESIB           IS ADDRESS IN USERWORD          16190002
         BZ    INWORD                   YES, CHECK BOUNDARY             16200002
         L     R6,PDEUSER               R6=ADDRESS OF SI BLOCK          16210002
         MVC   PDEUSER(L4),D0(R6)       MOVE ADDRESS INTO USERWORD      16220002
         SPACE                                                          16230002
*********************************************************************** 16240002
*        IF ADDRESS NOT ON HALFWORD BOUNDARY, GO ISSUE ERROR          * 16250002
*        MESSAGE. OTHERWISE, FLAG PDE AS CONVERTED, SET RETURN C      * 16260002
*        CODE TO 0                                         *            16270002
*********************************************************************** 16280002
INWORD   DS    0H                       ADDRESS IS IN USERWORD          16290002
         TM    PDEUSER+D3,BADBOUND      IS ADDRESS FOR HALF-WORD        16300002
*                                       BOUNDARY                        16310002
         BO    BOUNDMSG                 NO, PUT OUT MESSAGE             16320002
         MVI   PDEUSER,PDECONVD         SET FLAG FOR PDE CONTAINING     16330002
*                                       BINARY ADDRESS                  16340002
         SPACE                                                          16350002
EXITOK   DS    0H                       SET RETURN CODE TO ZERO         16360002
         XR    R15,R15                  ZERO REGISTER                   16370002
         SPACE                                                          16380002
*********************************************************************** 16390002
*              RETURN                                                 * 16400002
*********************************************************************** 16410002
RETPARSE DS    0H                       RETURN FOR PARSE                16420002
         L     R13,SAVELAST-SAVEAREA(R13) RESTORE R13                   16422002
         NI    TSTFLGS4,HEXFF-TSTVALCK TURN OFF VALIDITY CHECK BIT      16422402
         SR    R0,R0         R0=0                                       16422802
         L     R2,OUTBUF     R2=ADDR OF OUTBUF                          16423202
         C     R0,D0(R2)     IS THERE A SECOND LEVEL MESSAGE TO PASS?   16423602
         BE    RETPARS1      NO, JUST GO BACK TO PARSE                  16423702
         L     R1,GR1-SAVEAREA(R13) R1=ADDR OF PARSE PARAMETER LIST     16423802
         MVC   D8(L4,R1),OUTBUF PUT ADDRESS OF SECOND LEVEL MESSAGE     16423902
*                               INTO PARSE PARAMETER LIST               16426202
RETPARS1 EQU   *                                                        16428202
         RETURN (14,12),RC=(15) RETURN                                  16429302
RETMAIN  DS    0H                       RETURN FOR MAINLINE             16431602
         TM    TSTFLGS1,TSTBUILD ARE WE ACTIVATING DEFERED BRKPTS?      16433902
         BO    CODE4         YES, GO GENERATE THE RIGHT RETURN CODE     16436202
         LR    R2,R15        SAVE RETURN CODE                           16438502
         ESTAE 0             REMOVE ESTAE                               16440802
         LR    R15,R2        RESET RETURN CODE                          16443102
         NI    TSTFLGS4,HEXFF-TSTRERTN TURN OFF RETRY BIT               16445402
         L     R13,SAVELAST-SAVEAREA(R13)  RESTORE R13                  16447702
         RETURN (14,12),,RC=(15)        RETURN                          16450002
         SPACE                                                          16460002
*********************************************************************** 16470002
*        CVT RETURNED A NONZERO RETURN CODE. USE THE FOLLOWING        * 16480002
*        BRANCH TABLE TO PROCESS IT.                                  * 16490002
*********************************************************************** 16500002
         ORG   *-4                      REUSE SPACE FOR ZERO COND. CODE 16510002
NOTCONV  DS    0H                                                       16520002
         ORG                                                            16530002
         B     EXIT8                    RETURN CODE 4                   16540002
         B     EXIT8                    RETURN CODE 8                   16550002
         B     EXIT8                    RETURN CODE 12                  16560002
         B     EXIT12                   RETURN CODE 16                  16570002
         B     EXIT12                   RETURN CODE 20                  16580002
         B     EXIT12        RETURN CODE 24                             16582002
         SPACE                                                          16590002
*********************************************************************** 16600002
*        CVT RETURN CODE 16,20,24 EITHER AN ATTENTION WAS ENTERED     * 16610002
*        OR SYM OR CVT BLEW. SAVE RETURN CODE IN WORKAREA, SET        * 16620002
*        RETURN CODE TO 20, AND RETURN TO PARSE.                      * 16630002
*********************************************************************** 16640002
EXIT12   DS    0H                       SET RETURN TO PARSE TO 12 SO    16650002
*                                       THAT IT WILL RETURN TO AT       16660002
         ST    R15,PARSECD              SAVE RETURN CODE IN WORK AREA   16670002
         LA    R15,TWELVE               SET RETURN CODE TO 12           16680002
         B     RETPARSE                 RETURN TO PARSE                 16690002
         SPACE                                                          16700002
*********************************************************************** 16702002
*        ADDRESS IN PDE IS IN WRITE-PROTECTED CORE. ISSUE             * 16704002
*        APPROPRIATE ERROR MESSAGE, SET RETURN CODE TO 8,             * 16706002
*        AND RETURN TO PARSE.                                         * 16708002
*********************************************************************** 16708402
ADDRPROT DS    0H                       WRITE PROTECTED ADDRESS         16708802
         LA    R1,MSG2       R1=ADDR OF MESSAGE NUMBERS                 16709202
         B     SETADDR                  ADD STRING TO MESSAGE           16709702
         SPACE                                                          16709802
*********************************************************************** 16710002
*        INVALID ADDRESS TYPE. ISSUE MESSAGE, SET RETURN CODE         * 16720002
*        TO 8 AND RETURN TO PARSE.                                    * 16730002
*********************************************************************** 16740002
STORMSG  DS    0H                       PUT OUT MESSAGE FOR INVALID     16750002
*                                       ADDRESS - REGISTER SPECIFI-     16760002
*                                       CATION NOT ALLOWED              16770002
         TM    PDE2FLG2,CTNAMFLG        WAS ENTRYNAME OF RANGE GIVEN    16780002
         BO    STMSG2                   YES, PREPARE RANGE MESSAGE      16790002
         TM    PDE2FLG3,AFLG            WAS STRING GIVEN                16800002
         BO    STMSG2                   YES, PREPARE RANGE MESSAGE      16810002
         LA    R1,MSG6       R1=ADDR OF MESSAGE NUMBERS                 16820002
         SPACE                                                          16840002
SETADDR  DS    0H                       ADD ADDRESS STRING TO MSG       16850002
         BAL   R5,IOTYPE3    PUT OUT MESSAGE                            17022002
         BAL   R5,IORC3      TEST IO RC'S                               17058002
         B     EXIT8A        RETURN TO PARSE                            17058402
         SPACE                                                          17060002
*********************************************************************** 17070002
*        CVT RETURN CODE = 4, 8, OR 12. SET RETURN CODE TO 8, RETURN TO 17080002
*        PARSE                                                          17090002
*********************************************************************** 17110002
EXIT8    DS    0H                       SET RETURN CODE TO PARSE TO     17120002
*                                       HAVE PARSE ISSUE 'REENTER'      17130002
EXIT8A   DS    0H                       SET RETURN CODE TO 8            17220002
         LA    R15,EIGHT                SET CODE TO EIGHT               17230002
         B     RETPARSE                 RETURN TO PARSE                 17240002
         SPACE                                                          17250002
*********************************************************************** 17260002
*        LOADNAME AND ADDRESS STRING GIVEN. TEST FOR VALID SYMBOL.    * 17270002
*        IF INVALID, ISSUE MESSAGE AND RETURN TO PARSE WITH RC = 8.   * 17280002
*********************************************************************** 17290002
TESTSYM  DS    0H                       IS STRING A SYMBOL WITH         17300002
*                                       LENGTH GREATER THAN 8           17310002
         CLC   PDELEN3,SYMBLLNH         IS LENGTH GREATER THAN 8        17320002
         BNH   EXITOK                   NO, RETURN TO PARSE WITHOUT     17330002
*                                       CONVERTING ADDR AS DEFER        17340002
*                                       MIGHT BE SPECIFIED              17350002
         TM    PDEFLG4,SYMADDR          IS STRING A SYMBOL              17360002
         BNO   EXITOK                   NO, RETURN TO PARSE             17370002
         LA    R1,MSG7       R1=ADDR OF MESSAGE NUMBERS                 17380002
         B     SETADDR                  ADD ADDRESS STRING TO MSG       17400002
         SPACE                                                          17410002
STMSG2   DS    0H                       SET UP FOR RANGE MESSAGE -      17420002
*                                       INVALID REGISTER NOTATION       17430002
         LA    R1,MSG8       R1=ADDR OF MESSAGE NUMBERS                 17440002
         B     SETADDR                  ADD STRING TO MESSAGE           17460002
         SPACE                                                          17470002
*********************************************************************** 17480002
*        ADDRESS NOT ON HALFWORD BOUNDARY. ISSUE MESSAGE,             * 17490002
*        SET RC = 8 AND RETURN TO PARSE.                              * 17500002
*********************************************************************** 17510002
BOUNDMSG DS    0H                       PREPARE MESSAGE FOR ADDRESS NOT 17520002
*                                       ON HALF-WORD BOUNDARY           17530002
         LA    R1,MSG5       R1=ADDR OF MESSAGE NUMBERS                 17540002
         SPACE                                                          17570002
BNDMSG1  DS    0H                                                       17572002
         BAL   R5,IOTYPE2    PUT OUT MESSAGE                            17574002
         BAL   R5,IORC3      TEST IO RC'S                               17579602
         B     EXIT8A        RETURN TO PARSE                            17579702
*********************************************************************** 17580002
*        A RANGE WAS GIVEN. IF SECOND ADDRESS IN RANGE IS INVALID     * 17590002
*        REGISTER TYPE ADDRESS, GO ISSUE MESSAGE, SET RC = 8, AND     * 17600002
*        RETURN TO PARSE.                                             * 17610002
*********************************************************************** 17620002
RANGE    DS    0H                       AN ADDRESS RANGE WAS GIVEN      17630002
         CH    R4,PDE2INDC              IS SECOND ADDRESS INDIRECT      17640002
         BNE   ISITFULL                 YES, IS FIRST FULLY QUALIFIED   17650002
         TM    PDE2FLG4,GENR+LFPR+SFPR  IS REGISTER SPECIFIED           17660002
         BM    STMSG2                   BUILD MESSAGE FOR ADDRESS       17670002
*                                       REQUIRED TO BE STORAGE          17680002
         SPACE                                                          17690002
*********************************************************************** 17700002
*        CHECK TYPES OF ADDRESSES IN PDE AND GO TO CORRECT            * 17710002
*        PROCESSING CODE.                                             * 17720002
*********************************************************************** 17730002
ISITFULL DS    0H                       CHECK FOR FIRST ADDRESS FULLY   17740002
*                                         QUALIFIED                     17750002
         TM    PDEFLG1,LDNAMFLG         LOADNAME GIVEN                  17760002
         BZ    GOTOCONV                 NO, CONVERT ADDRESSES           17770002
         TM    PDEFLG3,AFLG             STRING GIVEN                    17780002
         BZ    GOTOCONV                 NO, CONVERT ADDRESSES           17790002
         SPACE                                                          17800002
*********************************************************************** 17810002
* FIRST ARGUMENT OF THE RANGE IS A FULLY QUALIFIED ADDRESS.  CHECK    * 17820002
* THE SECOND ARGUMENT.                                                * 17830002
*********************************************************************** 17840002
         SPACE                                                          17850002
         TM    PDE2FLG1,LDNAMFLG        LOADNAME GIVEN                  17860002
         BZ    GOTOCONV                 NO, CONVERT ADDRESSES           17870002
         TM    PDE2FLG3,AFLG            STRING GIVEN                    17880002
         BZ    GOTOCONV                 NO, CONVERT ADDRESSES           17890002
         SPACE                                                          17900002
*********************************************************************** 17910002
*        BOTH ADDRESSES FULLY QUALIFIED. MAY BE A DEFERRED AT.        * 17920002
*        CHECK FOR VALID ADDRESS STRING. IF INVALID, ISSUE MESSAGE    * 17930002
*        SET RC = 8, AND RETURN TO PARSE. OTHERWISE, SET RC = 0 AND   * 17940002
*        RETURN TO PARSE.                                             * 17950002
*********************************************************************** 17960002
         CLC   PDELEN3,SYMBLLNH         IS LENGTH OF STRING GREATER     17970002
*                                       THAN 8                          17980002
         BNH   CHKPDE2                  NO, CHECK SECOND HALF PDE       17990002
         TM    PDEFLG4,SYMADDR          IS STRING A SYMBOL              18000002
         BNO   CHKPDE2                  NO, CHECK SECOND HALF PDE       18010002
         SPACE                                                          18020002
SYMMSG2  DS    0H                       PUT OUT MSG FOR RANGE CONTAINS  18030002
*                                       SYMBOL WITH LENGTH GREATER      18040002
*                                       THAN 8                          18050002
         LA    R1,MSG9       R1=ADDR OF MESSAGE NUMBERS                 18060002
         B     SETADDR                  ADD STRING TO MESSAGE           18080002
         SPACE                                                          18090002
CHKPDE2  DS    0H                       CHECK LAST PART OF RANGE FOR    18100002
*                                       SYMBOL WITH LENGTH GREATER      18110002
*                                       THAN 8                          18120002
         CLC   PDE2LEN3,SYMBLLNH        IS LENGTH GREATER THAN 8        18130002
         BNH   EXITOK                   NO, RETURN WITHOUT CONVERTING   18140002
*                                       REQUEST MAY BE DEFER            18150002
         TM    PDE2FLG4,SYMADDR         IS STRING A SYMBOL              18160002
         BNO   EXITOK                   NO, RETURN TO PARSE             18170002
         B     SYMMSG2                  YES, PUT OUT MESSAGE            18180002
         SPACE                                                          18190002
*********************************************************************** 18200002
*        BOTH ADDRESSES ARE NOT FULLY QUALIFIED. MUST BE ACTIVE       * 18210002
*        BREAKPOINT. CONVERT BOTH ADDRESSES TO BINARY. FIRST          * 18220002
*        ADDRESS MUST BE LESS THAN OR EQUAL TO SECOND, AND MUST       * 18230002
*        BE ON A HALFWORD BOUNDARY. IF BOTH CONDITIONS ARE NOT MET,   * 18240002
*        ISSUE MESSAGE, SET RC = 8, AND RETURN TO PARSE. IF OK,       * 18250002
*        SET RC = 0 AND RETURN TO PARSE.                              * 18260002
*********************************************************************** 18270002
GOTOCONV DS    0H                                                       18280002
         OI    TSTFLGS1,RANGESW         TELL CONVERT TO EXPECT A RANGE  18290002
         LCR   R1,R11                   R1=COMPLEMENT OF ADDRESS OF PDE 18300002
*                                       TO INDICATE ADDRESS CONVERT     18310002
         XR    R0,R0                    R0=ZERO TO INDICATE CONVERT     18320002
*                                       TO BINARY                       18330002
         L     R15,TSTCONVT             R15=ADDRESS OF CONVERT ROUTINE  18340002
         BALR  R14,R15                  GO TO CONVERT                   18350002
         LTR   R15,R15                  WAS CONVERT SUCCESSFUL          18360002
         BNZ   NOTCONV(R15)             NO, SEE IF PDE USELESS          18370002
         SPACE                                                          18380002
*********************************************************************** 18390002
* CONVERT WAS SUCCESSFUL.  THIS ROUTINE MAKES SURE THE BINARY         * 18400002
* ADDRESSES ARE WRITABLE, AND THE CONVERTED ADDRESSES ARE IN          * 18410002
* THE PDEUSER FIELDS.                                                 * 18412002
*********************************************************************** 18420002
         SPACE                                                          18430002
         TM    PDEFLG5,PDEWRITE         IS FIRST ADDR WRITABLE ?        18432002
         BZ    RANGPROT                 NO, CAN'T PUT A BRKPT THERE     18434002
         TM    PDEUSER,PDESIB           IS FIRST ADDRESS IN USERWORD    18440002
         BO    MOVEADR                  NO, PUT IT THERE                18450002
         SPACE                                                          18460002
CHKUSER2 DS    0H                       LOOK AT SECOND PDE OF RANGE     18470002
         TM    PDE2FLG5,PDEWRITE        IS SECOND ADDR WRITABLE ?       18472002
         BZ    RANGPROT                 NO, CAN'T PUT A BRKPT THERE     18474002
         TM    PDE2USER,PDESIB          IS SECOND ADDRESS IN USERWORD   18480002
         BO    MOVADDR2                 NO, PUT IT THERE                18490002
         SPACE                                                          18500002
COMPUSER DS    0H                       COMPARE ADDRESSES               18510002
         CLC   PDEUSER+D1(L3),PDE2USER+D1  IS FIRST ADDRESS GREATER     18520002
*                                       THAN SECOND                     18530002
         BH    FIRSTHI                  YES, PUT OUT ERROR MESSAGE      18540002
         TM    PDEUSER+D3,BADBOUND      IS FIRST ADDRESS FOR HALF-WORD  18550002
*                                       BOUNDARY                        18560002
         BO    BNDMSG2                  NO, PUT OUT MESSAGE             18570002
         MVI   PDEUSER,PDECONVD         FLAG PDE AS CONVERTED           18580002
         B     EXITOK                   RETURN TO PARSE                 18590002
         SPACE                                                          18600002
MOVEADR  DS    0H                       FIRST CONVERTED ADDRESS IN      18610002
*                                       SI BLOCK                        18620002
         L     R5,PDEUSER               R5=ADDRESS OF SI BLOCK          18630002
         L     R5,D0(R5)                R5=CONVERTED ADDRESS            18640002
         ST    R5,PDEUSER               STORE IN FIRST USERWORD         18650002
         B     CHKUSER2                 CHECK FOR CONVERTED ADDRESS IN  18660002
*                                       SECOND USERWORD                 18670002
         SPACE                                                          18680002
*********************************************************************** 18682002
*        ONE OF THE ADDRESSES IN A RANGE IS IN WRITE-PROTECTED CORE.  * 18684002
*        ISSUE MESSAGE, SET RETURN CODE TO 8, AND RETURN TO PARSE.    * 18686002
*********************************************************************** 18688002
RANGPROT DS    0H                       WRITE PROTECTED RANGE           18688402
         LA    R1,MSG3       R1=ADDR OF MESSAGE NUMBERS                 18688802
         B     SETADDR                  ADD STRING TO MESSAGE           18689602
         SPACE                                                          18689702
*********************************************************************** 18690002
*        FIRST ADDRESS OF RANGE NOT ON HALFWORD BOUNDARY. ISSUE       * 18700002
*        MESSAGE, SET RC = 8, AND RETURN.                             * 18710002
*********************************************************************** 18720002
BNDMSG2  DS    0H                       FIRST ADDRESS OF RANGE NOT      18730002
*                                       ON HALF-WORD BOUNDARY           18740002
         LA    R1,MSG1       R1=ADDR OF MESSAGE NUMBERS                 18750002
         B     BNDMSG1       GO OUTPUT MESSAGES                         18760002
         SPACE                                                          18780002
*********************************************************************** 18790002
*        MOVE SECOND ADDRESS OF RANGE INTO PDE2USER FIELD.            * 18800002
*********************************************************************** 18810002
MOVADDR2 DS    0H                       SECOND CONVERTED ADDRESS IN     18820002
*                                       SI BLOCK                        18830002
         L     R5,PDE2USER              R5=ADDRESS OF SI BLOCK          18840002
         L     R5,D0(R5)                R5=CONVERTED ADDRESS            18850002
         ST    R5,PDE2USER              STORE IN SECOND USERWORD        18860002
         B     COMPUSER                 COMPARE ADDRESSES               18870002
         SPACE                                                          18880002
*********************************************************************** 18890002
*        FIRST ADDRESS IN RANGE IS HIGHER THAN SECOND ADDRESS.        * 18900002
*        ISSUE MESSAGE, SET RC = 8, AND RETURN TO PARSE.              * 18910002
*********************************************************************** 18920002
FIRSTHI  DS    0H                       PREPARE TO WRITE MESSAGE FOR    18930002
*                                       FIRST ADDRESS EXCEEDS SECOND    18940002
         LA    R1,MSG4       R1=ADDR OF MESSAGE NUMBERS                 18950002
         B     SETADDR                  ADD ADDRESS STRING TO MSG       18970002
         EJECT                                                          18980002
*********************************************************************** 18990002
* THIS SECTION RECEIVES CONTROL FROM IKJPARS ONCE IKJPARS HAS SCANNED * 19000002
* A PARENTHESIZED STRING (KNOWN AS THE SUB-COMMAND CHAIN) AND HAS     * 19010002
* DETERMINED THAT IT IS SYNTACTICALLY CORRECT.  FURTHER VALIDITY      * 19020002
* CHECKING OF THE SUB-COMMAND CHAIN IS PERFORMED.  IF THE SUB-COMMAND * 19030002
* CHAIN IS FOUND TO BE UNACCEPTABLE, A MESSAGE IS ISSUED TO THE USER  * 19040002
* BEFORE CONTROL IS RETURNED TO IKJPARS.                              * 19050002
*********************************************************************** 19060002
AT1SUBVC DS    0H                       SUB-COMMAND VALIDITY CHECK      19070002
         SAVE (14,12),,AT1SUBVC         SAVE IKJPARS' REGISTERS         19080002
         L     R5,D4(R1)                R5=ADDR OF AT'S SAVE AREA       19090002
         LA    R7,D8(R1)                R7=POINTER TO PARSE'S PARM      19100002
*                                       FOR SECOND LEVEL MSG            19110002
         L     R12,GR12-SAVEAREA(R5)    ESTABLISH ADDRESSABILITY WITH   19120002
*                                       MAINLINE OF AT                  19130002
         L     R9,GR9-SAVEAREA(R5)      R9=ADDR OF TCOMTAB              19140002
         L     R6,REGSAVE3              R6=ADDR OF EXIT'S SAVE AREA     19150002
         ST    R13,SAVELAST-SAVEAREA(R6)  SAVE ADDRESS OF PARSE'S SAVE  19160002
*                                       AREA                            19170002
         ST    R6,SAVENEXT-SAVEAREA(R13)  SAVE ADDRESS OF EXIT'S SAVE   19180002
*                                       AREA IN PARSE'S SAVE AREA       19190002
         LR    R13,R6                   R13=ADDR OF EXIT'S SAVE AREA    19200002
         L     R10,WORKAREA             R10=ADDRESS OF COMMON WORKAREA  19210002
         OI    TSTFLGS4,TSTVALCK TURN ON VALIDITY CHECK BIT             19212002
         L     R4,OUTBUF     R4=ADDR OF OUTBUF                          19214002
         XC    D0(L4,R4),D0(R4) ZERO FIRST WORD OF OUTBUF               19216002
         SPACE                                                          19220002
*********************************************************************** 19230002
* THIS EXIT CHECKS THE LENGTH OF THE SUBCOMMAND STRING FOR A MAXIMUM  * 19240002
* OF 255.  IF IT IS GREATER A MESSAGE IS ISSUED.                      * 19250002
*********************************************************************** 19260002
         SPACE                                                          19270002
         L     R6,D0(R1)                R6=ADDR OF SUB-COMMAND PDE      19280002
         LA    R4,MAXLEN                R4=255                          19290002
         CH    R4,EXPRLNH-EXPRPDE(R6)   IS LENGTH GREATER THAN 255      19300002
         BL    TOOLONG                  YES, PUT OUT ERROR MESSAGE      19310002
         B     EXITOK                   LENGTH OK, RETURN TO IKJPARS    19320002
         SPACE                                                          19330002
*********************************************************************** 19340002
*        SUBCOMMAND CHAIN TOO LONG. ISSUE MESSAGE, SET RC = 8, AND    * 19350002
*        RETURN TO PARSE.                                             * 19360002
*********************************************************************** 19370002
TOOLONG  DS    0H                       PREPARE TO PUT OUT MESSAGE FOR  19380002
*                                       SUB-COMMAND CHAIN LENGTH        19390002
*                                       EXCEEDS 255                     19400002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM LIST         19512002
* ISSUE 'COMMAND CHAIN TO LONG' MESSAGE                                 19514002
* ISSUE 'COMMAND CHAIN LENGTH MAY NOT EXCEED 255 BYTES' MESSAGE         19516002
         IKJEGSIO MSG,FIRST=M0035,SECOND=M0243,ID=AT004,MF=(E,TSTIOPRM) 19522002
         BAL   R5,IORC3      TEST IO RC'S                               19532002
         B     EXIT8A        RETURN TO PARSE                            19534002
         EJECT                                                          19540002
*********************************************************************** 19550002
* THIS SECTION RECEIVES CONTROL FROM IKJPARS ONCE IKJPARS HAS SCANNED * 19560002
* THE KEYWORD COUNT AND ITS SUBFIELD INTEGER AND HAS DETERMINED THAT  * 19570002
* IT IS SYNTACTICALLY CORRECT.  FURTHER VALIDITY CHECKING OF THE      * 19580002
* INTEGER IS PERFORMED.  IF THE INTEGER IS FOUND TO BE UNACCEPTABLE,  * 19590002
* A MESSAGE IS ISSUED TO THE USER BEFORE CONTROL IS RETURNED TO PARSE.* 19600002
*********************************************************************** 19610002
AT1CTVC  DS    0H                       VALIDITY CHECK FOR COUNT        19620002
         SAVE  (14,12),,AT1CTVC         SAVE IKJPARS' REGISTERS         19630002
         L     R5,D4(R1)                R5=ADDR OF AT'S SAVE AREA       19640002
         L     R12,GR12-SAVEAREA(R5)    ESTABLISH ADDRESSABILITY WITH   19650002
*                                       MAINLINE OF AT                  19660002
         L     R9,GR9-SAVEAREA(R5)      R5=ADDR OF TCOMTAB              19670002
         L     R6,REGSAVE3              R6=ADDR OF EXIT'S SAVE AREA     19680002
         ST    R13,SAVELAST-SAVEAREA(R6)  SAVE ADDRESS OF PARSE'S SAVE  19690002
*                                       AREA                            19700002
         ST    R6,SAVENEXT-SAVEAREA(R13)  SAVE ADDRESS OF EXIT'S SAVE   19710002
*                                       AREA IN PARSE'S SAVE AREA       19720002
         LR    R13,R6                   R13=ADDR OF EXIT'S SAVE AREA    19730002
         L     R10,WORKAREA             R10=ADDRESS OF COMMON WORKAREA  19740002
         LA    R7,D8(R1)                R7=POINTER TO PARSE'S PARM      19750002
*                                       FOR SECOND LEVEL MSG            19760002
         OI    TSTFLGS4,TSTVALCK TURN ON VALIDITY CHECK BIT             19762002
         L     R4,OUTBUF     R4=ADDR OF OUTBUF                          19764002
         XC    D0(L4,R4),D0(R4) ZERO FIRST WORD OF OUTBUF               19766002
         SPACE                                                          19770002
*********************************************************************** 19780002
*        USE IKJEGCVT TO CONVERT COUNT TO BINARY.                     * 19790002
*********************************************************************** 19800002
         L     R1,D0(R1)                R1=ADDR OF COUNT PDE            19810002
         LR    R11,R1        SAVE ADDRESS OF PDE                        19812002
         SR    R0,R0                    ZERO REGISTER - CONVERT TO      19820002
*                                       BINARY                          19830002
         MVI   IDENTCVT-IDENTPDE(R1),FCODE  MOVE IN TYPE CODE FOR       19840002
*                                       IKJEGCVT                        19850002
         L     R15,TSTCONVT             R15=EP OF IKJEGCVT              19860002
         BALR  R14,R15                  CONVERT COUNT TO BINARY         19870002
         LTR   R15,R15                  WAS CONVERT SUCCESSFUL          19880002
         BNZ   NOTCONV(R15)             NO, ATTENTION SCHEDULED         19890002
         SPACE                                                          19900002
*********************************************************************** 19910002
*        INSURE THAT COUNT IS LESS THAN OR EQUAL TO MAXIMUM. IF NOT,  * 19920002
*        ISSUE MESSAGE, SET RC = 8, AND RETURN TO PARSE. IF IT        * 19930002
*        IS OK, SET COUNT TO ZERO IF THE COUNT IS ZERO,               * 19940002
*        OR TO ONE LESS THAN THE COUNT IF IT IS GREATER THAN ONE,     * 19950002
*        SET RETURN CODE TO 0 AND RETURN.                             * 19960002
*********************************************************************** 19970002
         L     R4,CONAREA               R4=ADDRESS OF PLACE WHERE       19980002
*                                       CONVERT RETURNS NUMBER          19990002
         USING CONBYTE,R4               GET ADDRESSABILITY TO CONAREA   20000002
         L     R5,COUNTMAX              R5=MAXIMUM COUNT                20010002
         L     R6,CONCOUNT              R6=COUNT GIVEN                  20020002
         LTR   R6,R6                    IS COUNT = ZERO                 20030002
         BZ    EXITOK                   YES, RETURN TO PARSE            20040002
         CLR   R6,R5                    IS COUNT GREATER THAN 65535     20050002
         BH    BADCOUNT                 YES, PUT OUT ERROR MESSAGE      20060002
         BCTR  R6,ZERO                  DECREMENT BY ONE                20070002
         ST    R6,CONCOUNT              STORE BACK IN COUNT AREA        20080002
         B     EXITOK                   COUNT OK - RETURN TO PARSE      20090002
         SPACE                                                          20100002
BADCOUNT DS    0H                       PUT OUT MESSAGE FOR COUNT       20110002
*                                       EXCEEDS MAXIMUM                 20120002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM LIST         20170002
* ISSUE 'INVALID COUNT NNNNNN' MESSAGE                                  20180002
* ISSUE 'COUNT MUST BE BETWEEN 0 AND 65535' MESSAGE                     20190002
         IKJEGSIO MSG,FIRST=M0036,INST11=(VPDE,(R11)),SECOND=M0299,    *20220002
               ID=AT004,MF=(E,TSTIOPRM)                                 20270002
         BAL   R5,IORC3      TEST IO RC'S                               20272002
         B     EXIT8A        RETURN TO PARSE                            20274002
         DROP  R4                                                       20280002
         EJECT                                                          20282002
*********************************************************************   20284002
*  COMMON IO MACRO FORMS                                                20286002
*********************************************************************   20288002
IOTYPE1  DS    0H                                                       20288402
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM LIST         20288802
         IKJEGSIO MSG,FIRST=M0103,ID=AT004,MF=(E,TSTIOPRM)              20289202
         BR    R5            RETURN TO CALLER                           20289602
IOTYPE2  DS    0H                                                       20289702
         STM   R2,R3,SAVE2345 SAVE R2-3 FOR REUSE                       20289802
         LM    R2,R3,D0(R1)  LOAD R2-3 WITH MESSAGE NUMBERS             20289902
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO APRM LIST         20293202
         IKJEGSIO MSG,FIRST=(R2),INST11=(APDE,(R11)),SECOND=(R3),      *20295202
               INST21=(NUM,I0002),ID=AT004,MF=(E,TSTIOPRM)              20295602
         LM    R2,R3,SAVE2345 RESET R2-3                                20296002
         BR    R5            RETURN TO CALLER                           20296402
IOTYPE3  DS    0H                                                       20296502
         STM   R2,R3,SAVE2345 SAVE R2-3 FOR REUSE                       20296602
         LM    R2,R3,D0(R1)  LOAD R2-3 WITH MESSAGE NUMBERS             20299902
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM LIST         20301902
         IKJEGSIO MSG,FIRST=(R2),INST11=(APDE,(R11)),SECOND=(R3),      *20302302
               ID=AT004,MF=(E,TSTIOPRM)                                 20302702
         LM    R2,R3,SAVE2345 RESET R2-3                                20303102
         BR    R5            RETURN TO CALLER                           20303202
GETFREIO EQU   *                                                        20304802
         ST    R2,SAVE2345   SAVE R2 FOR REUSE                          20306802
         LR    R2,R1         R2=SVC NUMBER                              20307202
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM LIST         20307602
         IKJEGSIO SVCERR,SVC=(R2),RC=(R15),ID=AT004,MF=(E,TSTIOPRM)     20308002
         L     R2,SAVE2345   RESET R2                                   20308402
         BR    R5            RETURN TO CALLER                           20308502
*********************************************************************   20308802
*  COMMON IO RETURN CODE CHECKS                                         20310402
*********************************************************************   20313302
IORC1    DS    0H                                                       20317802
         OI    TSTFLGS4,TSTFLUSH HAVE MNL FLUSH INPUT STACK             20319802
         C     R15,ATTNCODE  IS RETURN CODE=16,20,OR 24?                20319902
         BNL   RETMAIN       SEND IT TO MAINLINE                        20322702
         XR    R15,R15       CLEAR RETURN CODE AND CONTINUE             20324702
         BR    R5            RETURN TO CALLER                           20325102
IORC2    DS    0H                                                       20325902
         C     R15,ATTNCODE  IS RETURN CODE 16,20 OR 24?                20326402
         BNL   RETURNRC      YES, GO RETURN THE CODE                    20328002
         XR    R15,R15       CLEAR RETURN CODE AND CONTINUE             20329602
         BR    R5            RETURN TO CALLER                           20331202
IORC3    DS    0H                                                       20334402
         LTR   R15,R15       TEST FOR ZERO RETURN CODE                  20336002
         BZ    D0(R5)        ZERO, RETURN TO CALLER                     20337602
         C     R15,ATTNCODE  IS RETURN CODE 16                          20339202
         BE    EXIT12        YES,GO END PARSE                           20340802
         OI    TSTFLGS4,TSTFLUSH HAVE MAINLINE FLUSH INPUT STACK        20344002
         C     R15,ATTNCODE  IS RETURN CODE 20 OR 24?                   20344402
         BH    EXIT12        YES, END PARSE                             20344802
         XR    R15,R15       ZERO RETURN CODE                           20345202
         B     EXIT12        END PARSE                                  20347202
         EJECT                                                          20348802
*********************************************************************** 20350402
*                                                                     * 20352002
*        CONSTANTS USED IN THE CODE                                   * 20353602
*                                                                     * 20355202
*********************************************************************** 20356802
         SPACE 2                                                        20358402
*********************************************************************** 20360002
*        LIST FORMS OF XCTL MACRO USED.                               * 20370002
*********************************************************************** 20380002
XLIST    DS    0F                       LIST FORM OF XCTL MACRO         20420002
         XCTL  EP=IKJEGATD,SF=L         LIST FORM                       20430002
XCTLEN   EQU  *-XLIST                   LENGTH OF LIST FORM OF MACRO    20440002
         SPACE                                                          20450002
*********************************************************************** 20460002
*        INITIALIZATION CONSTANTS FOR BRKINSTR FIELD                  * 20470002
*        OF BRKELEM                                                   * 20480002
*********************************************************************** 20490002
INITCON  DS    0H                                                       20500002
         NOPR  R1                       PADDING NOP.                    20510002
         NOPR  R1                       PADDING NOP.                    20520002
RSVC     SVC   TESTSVC                  BREAKPOINT SVC.                 20530002
         SPACE                                                          20532002
**********************************************************************  20534002
*  MESSAGE NUMBER CONSTANTS                                             20536002
*       EACH MESSAGE NUMBER AREA HAS THE FOLLOWING FORMAT               20538002
*        WORD1-NUMBER OF FIRST LEVEL MESSAGE                            20538402
*        WORD2-NUMBER OF SECOND LEVEL MESSAGE(ZERO OF NO MESSAGE)       20538802
**********************************************************************  20539602
MSG1     DC    F'73'         INVALID ADDRESS RANGE                      20539702
         DC    F'280'        HALF WORD BOUNDARY REQUIRED                20539802
MSG2     DC    F'101'        INVALID ADDRESS                            20539902
         DC    F'279'        ADDRESS WRITE PROTECTED                    20543202
MSG3     DC    F'73'         INVALID ADDRESS RANGE                      20545202
         DC    F'242'        PART OF RANGE WRITE PROTECTED              20545602
MSG4     DC    F'73'         INVALID ADDRESS RANGE                      20546002
         DC    F'207'        FIRST ADDR MUST NOT BE HIGHER THAN LAST    20546402
MSG5     DC    F'101'        INVALID ADDRESS                            20546502
         DC    F'280'        HALF WORD BOUNDARY REQUIRED                20546602
MSG6     DC    F'101'        INVALID ADDRESS                            20549902
         DC    F'274'        REG. NOTATION MUST BE INDIR.GEN.REG.       20552002
MSG7     DC    F'101'        INVALID ADDRESS                            20552402
         DC    F'281'        SYMBOL LENGTH EXCEEDS 8 CHARS.             20552802
MSG8     DC    F'73'         INVALID ADDRESS RANGE                      20553202
         DC    F'274'        REG. NOTATION MUST BE INDIR.GEN.REG.       20553302
MSG9     DC    F'73'         INVALID ADDRESS RANGE                      20556602
         DC    F'281'        SYMBOL LENGTH EXCEEDS 8 CHARS.             20563302
MSG10    DC    F'38'         NO BRKPT ESTABLISHED AT                    20565302
         DC    F'244'        BAD OP CODE                                20565702
         SPACE                                                          20566802
*********************************************************************** 20570102
*        MISCELLANEOUS CONSTANTS                                      * 20573402
*********************************************************************** 20576702
MAXLEN2  DC    AL2(BRKLEN+100)          MAXIMUM LENGTH FOR BREAK ELE-   20580002
*                                       MENT AND ADDRESS STRING         20590002
SYMBLLNH DC    H'8'                     MAXIMUM LENGTH OF A             20600002
*                                       VALID SYMBOL                    20610002
         DS    0F                       ALIGN SP1 AND DBLBND TO WORD    20620002
DBLBND   DC    X'FFFFFFF8'              MASK FOR ROUNDING TO DBL BOUND  20640002
RETRYA   DC    A(RETRY)                 ADDRESS OF RETRY ROUTINE        20650002
RETRYA1  EQU   RETRYA+1                 SECOND BYTE OF RETRYA           20660002
PCLISTA  DC    V(IKJEGAPL)              ADDRESS OF PCL                  20680002
ATTNCODE DC    F'16'         RETURN CODE=ATTENTION IN PROCESS           20682002
COUNTMAX DC    X'0000FFFF'              MAXIMUM COUNT INTEGER - 65535   20690002
TABLE    DC    C'0123456789ABCDEF'      TRANSLATE TABLE                 20700002
ATSPL    IKJEGSPL RTRY=RETRY,ABNTB=ABENDTAB,MODNM=IKJEGAT,TNM=AT        20702002
ABENDTAB DS    0F                       TABLE FOR ABEND MESSAGES        20710002
*                                       FULLWORD ALIGNMENT              20720002
         DC    AL1(97)                  CODE FOR PROTECTION CHECK       20722002
         DC    AL3(BLOW12)              RESUME ADDRESS FOLLOWING        20724002
*                                       PROTECTION CHECK                20726002
         DC    AL1(97)                  CODE FOR PROTECTION CHECK       20726402
         DC    AL3(BLOW14)              RESUME ADDRESS FOLLOWING        20726802
*                                       PROTECTION CHECK                20727202
         DC    AL1(97)                  CODE FOR PROTECTION CHECK       20727602
         DC    AL3(BLOW16)              RESUME ADDRESS FOLLOWING        20727702
*                                       PROTECTION CHECK                20727802
         DC    AL1(97)                  CODE FOR PROTECTION CHECK       20728002
         DC    AL3(BLOWTWO)             RESUME ADDRESS FOLLOWING        20728402
*                                       PROTECTION CHECK                20728802
         DC    AL1(97)                  CODE FOR PROTECTION CHECK       20729202
         DC    AL3(BLOWFOUR)            RESUME ADDRESS FOLLOWING        20729602
*                                       PROTECTION CHECK                20729702
         DC    AL1(97)                  CODE FOR PROTECTION CHECK       20729802
         DC    AL3(BLOWSIX)             RESUME ADDRESS FOLLOWING        20729902
*                                       PROTECTION CHECK                20733202
         DC    AL1(92)                  CODE FOR INSUFFICIENT STORAGE   20736702
         DC    AL3(BLOW2)               RESUME ADDRESS FOLLOWING        20740002
*                                       INITIAL GETMAIN                 20750002
         DC    AL1(92)                  CODE FOR INSUFFICIENT STORAGE   20760002
         DC    AL3(BLOW4)               RESUME ADDRESS FOLLOWING        20770002
*                                       ADDITIONAL BREAK ELEMENT        20780002
*                                       GETMAIN                         20790002
         DC    AL1(99)                  CODE FOR LINK FAILED            20800002
         DC    AL3(BLOW5)               RESUME ADDRESS FOLLOWING LINK   20810002
*                                       TO IKJPARS                      20820002
         DC    AL1(97)                  CODE FOR PROTECTION CHECK       20822002
         DC    AL3(TSTLNH1)             ADDRESS PRECEDING INSTRUCTION   20824002
*                                       LENGTH CHECK                    20826002
         DC    AL1(97)                  CODE FOR PROTECTION CHECK       20828002
         DC    AL3(TSTLNH2)             ADDRESS FOLLOWING INSTRUCTION   20828402
*                                       LENGTH CHECK                    20828802
         DC    AL1(97)                  CODE FOR PROTECTION CHECK       20829202
         DC    AL3(CHEKTWO)             ADDRESS PRECEDING CHECK         20829602
*                                       FOR TWO BYTE INSTRUCTION        20829702
         DC    AL1(97)                  CODE FOR PROTECTION CHECK       20829802
         DC    AL3(CHEKSIX)             ADDRESS PRECEDING CHECK         20829902
*                                       FOR SIX BYTE INSTRUCTION        20833202
         DC    AL1(97)                  CODE FOR PROTECTION CHECK       20835202
         DC    AL3(CHEKFOUR)            ADDRESS PRECEDING CHECK         20835602
*                                       FOR FOUR BYTE INSTRUCTION       20836002
         DC    X'FF'                    END OF TABLE                    20836702
         EJECT                                                          22500002
*********************************************************************** 22510002
*        PARSE MACROS DESCRIBING COMMAND INPUT                        * 22520002
*********************************************************************** 22530002
IKJEGAPL IKJPARM DSECT=IKJPARMD                                         22540002
ADDR     IKJPOSIT ADDRESS,LIST,RANGE,                                  *22550002
               PROMPT='ADDRESS POSITIONAL PARAMETER',VALIDCK=AT1ADDVC   22560002
SBCMDCHN IKJPOSIT PSTRING,VALIDCK=AT1SUBVC                              22570002
COUNT    IKJKEYWD                                                       22580002
         IKJNAME 'COUNT',SUBFLD=INTEGER                                 22590002
NONOT    IKJKEYWD DEFAULT='NOTIFY'                                      22600002
         IKJNAME 'NOTIFY'                                               22610002
         IKJNAME 'NONOTIFY'                                             22620002
DEFER    IKJKEYWD DEFAULT='NODEFER'                                     22630002
         IKJNAME 'NODEFER'                                              22640002
         IKJNAME 'DEFER'                                                22650002
INTEGER  IKJSUBF                                                        22660002
NUMBER   IKJIDENT 'INTEGER',FIRST=NUMERIC,OTHER=NUMERIC,MAXLNTH=5,     *22670002
               PROMPT='INTEGER',VALIDCK=AT1CTVC                         22680002
         IKJENDP                                                        22690002
         EJECT                                                          22700002
         IKJPPL                                                         22710002
PPLEND   EQU   *                        END OF PPL                      22720002
         EJECT                                                          22730002
TCB      IKJTCB                         TCB EXPANSION                   22740002
         EJECT                                                          22750002
CVT      DSECT                                                          22760002
         CVT                                                            22770002
         EJECT                                                          22780002
         IKJPARMA                       ADDRESS PDE DSECT               22790002
         EJECT                                                          22800002
*********************************************************************** 22812002
*                                                                     * 22814002
*        MAPPING DSECT FOR PDES FOR IDENT-TYPE DATA                   * 22816002
*                                                                     * 22818002
*********************************************************************** 22818402
IDENTPDE DSECT                                                          22818802
IDENTPTR DS    F -                      POINTER TO CHARACTER STIRNG,    22819202
*                                       OR ZERO IF NOT PRESENT          22819602
IDENTLNH DS    H -                      LENGTH OF CHARACTER STRING      22819702
IDENTFLG DS    XL1 -                    FLAGS                           22819802
IDENTBIT EQU   B'10000000' -            BIT ON MEANS STRING PRESENT     22819902
IDENTCVT DS    XL1 -                    RESERVED                        22823202
IDENTPDL EQU   *-IDENTPDE -             LENGTH OF IDENT PDE             22825202
*********************************************************************** 22828702
*                                                                     * 22829102
*        MAPPING DSECT FOR PDES FOR EXPRESSIONS                       * 22829502
*                                                                     * 22829902
*********************************************************************** 22833202
EXPRPDE  DSECT                                                          22835202
EXPRPTR  DS    F -                      POINTER TO CHARACTER STRING,    22835602
*                                       OR ZERO IF NOT PRESENT          22836002
EXPRLNH  DS    H -                      LENGTH OF CHARACTER STRING      22836402
         DS    H -                      RESERVED                        22836502
EXPRFLGS DS    XL1 -                    FLAGS                           22836602
EXPRDEC  EQU   X'04' -                  DECIMAL EXPRESSION FLAG         22839902
EXPRHEX  EQU   X'02' -                  HEX EXPRESSION FLAG             22841902
EXPRSIGN DS    CL1 -                    ARITHMETIC SIGN OR ZERO         22842302
EXPRINDC DS    H -                      INDIRECT COUNT                  22842702
EXPRCHAI DS    F -                      POINTER TO NEXT EXPRESSION      22843102
*                                       PDE OR ZERO                     22843202
EXPRPDL  EQU   *-EXPRPDE -              LENGTH OF EXPRESSION PDE        22843302
         EJECT                                                          22843402
         BRKELEM                        BREAK ELEMENT DSECT.            22846702
         EJECT                                                          22850002
         IKJEGDME                       DEFERED MODULE ELEMENT DSECT    22860002
         SPACE 2                                                        22870002
         IKJEGDBE                       DEFERED BREAK ELEMENT DSECT     22880002
         EJECT                                                          22890002
SAVEAREA DSECT                                                          22902002
SAVEUSER DS    F                        UNUSED                          22904002
SAVELAST DS    F                        PTR TO LAST SAVEAREA (CALLER'S) 22906002
SAVENEXT DS    F                        PTR TO NEXT SAVEAREA (SUBRTN)   22908002
RETURNPT DS    F                        PTR TO CALLER'S RESUME ADDRESS  22908402
ENTRYPT  DS    F                        PTR TO MY ENTRY POINT           22908802
GR0      DS    F                        GENERAL REGISTER 0              22909202
GR1      DS    F                        GENERAL REGISTER 1              22909602
GR2      DS    F                        GENERAL REGISTER 2              22909702
GR3      DS    F                        GENERAL REGISTER 3              22909802
GR4      DS    F                        GENERAL REGISTER 4              22909902
GR5      DS    F                        GENERAL REGISTER 5              22913202
GR6      DS    F                        GENERAL REGISTER 6              22915202
GR7      DS    F                        GENERAL REGISTER 7              22915602
GR8      DS    F                        GENERAL REGISTER 8              22916002
GR9      DS    F                        GENERAL REGISTER 9              22916402
GR10     DS    F                        GENERAL REGISTER 10             22916502
GR11     DS    F                        GENERAL REGISTER 11             22916602
GR12     DS    F                        GENERAL REGISTER 12             22919902
LSAVE    EQU   *-SAVEAREA               LENGTH OF SAVEAREA              22921902
         EJECT                                                          22923402
         TCOMTAB                        COMMUNICATIONS TABLE DSECT      22926702
         EJECT                                                          22930002
         TSTCWORK                       DSECT FOR WORKAREA              22940002
         ORG   CWORKCMD                 GO BACK TO COMMAND WORKAREA     22950002
         SPACE                                                          22970002
WORKSP   DS    0H                                                       22980002
         SPACE                                                          22990002
*********************************************************************** 22993302
*                                                                     * 22995302
*        THIS IS A MAPPING OF THE AREA CALLED CWORKCMD IN TSTCWORK.   * 22995702
*        WHEN AT IS ENTERED TO ACTIVATE DEFERED BREAKPOINTS, THE      * 22996102
*        FIRST 8 CHARACTERS OF THE WORK AREA CONTAIN THE NAME OF THE  * 22996502
*        NEWLY LOADED MODULE. THE NINTH BYTE CONTAINS A FLAG WHICH    * 22996602
*        INDICATES WHETHER OR NOT THE MODULE IS IN OVERLAY. THE       * 22996702
*        LAST 64 BYTES OF THE WORK AREA ARE RESERVED FOR A REGISTER   * 22997802
*        SAVE AREA FOR IKJEGLDF IN THIS CASE.                         * 22999802
*        IF ANY CHANGES ARE MADE TO THE WORK AREA, MAKE THE           * 22999902
*        SAME CHANGES TO IKJEGATD. BOTH MODULES USE THE SAME FORMAT   * 23001902
*        OF WORK AREA.                                                * 23002402
*********************************************************************** 23002702
PDLADDR  DS    A -                      ADDRESS OF PDL BEING            23004702
*                                       PROCESSED BY AT WHEN            23005102
*                                       ACTIVATING DEFERED BREAKPOINTS  23005502
PARSECD  EQU   PDLADDR -                NONZERO SERVICE ROUTINE         23005902
*                                       RETURN CODES SENT TO VALIDITY   23006102
*                                       CHECK ROUTINES ARE STORED HERE  23006502
BYTENUMB DS    F -                      SAVE AREA FOR NUMBER OF BYTES   23006602
*                                       LAST GOTTEN                     23007402
SAVEPTR  DS    A -                      POINTER TO PREVIOUS BREAK       23007802
*                                       ELEMENT LINK FIELD              23008202
CHNADDR  DS    A -                      ADDRESS OF SUBCOMMAND CHAIN     23008602
*                                       FOR BREAKPOINT(S) BEING BUILT   23009002
STAEL    DS    CL16                     ESTAE PARM LIST AREA            23013702
STRNGADR DS    A -                      ADDRESS OF ADDRESS STRING       23014102
*                                       FOR RANGE BEING PROCESSED       23014202
         DS    0F                                                       23014302
PARMS    DS    (PPLEND-PPL)X -          PPL IS BUILT HERE               23015002
         ORG   PARMS                                                    23015402
BRKSAVE  DS    18F -                    SAVE AREA FOR BREAKRTN          23015802
SAVE2345 DS    4F            SAVE AREA FOR R2-5 USED DURING IO          23015902
         ORG   STRNGADR                                                 23016202
PDEADDR  DS    A -                      ADDRESS OF FIRST ADDRESS PDE    23016302
*                                       IN PDL - PASSED AS PARM         23016402
         ORG   WORKSP                                                   23016602
LOADNAME DS    CL8 -                    LOAD NAME OF NEWLY LOADED MOD.  23016702
*                                       FOR WHICH DEFERED BREAK-        23016802
*                                       POINTS MAY BE ACTIVATED, OR     23016902
*                                       LOAD NAME FOR WHICH DEFERED     23017502
*                                       BREAKPOINTS ARE TO BE BUILT     23017902
LOADATTR EQU   * -                      ONE BYTE FLAG INDICATING        23018302
*                                       OVERLAY STATUS FOR NEWLY        23018702
*                                       LOADED MODULE                   23018902
GETCORE  GETMAIN   EC,SP=1,MF=L -       LIST FORM OF GETMAIN            23019302
ADDRCORE EQU   GETCORE+4 -              SECOND WORD OF LIST FORM        23021602
*                                       CONTAINS ADDRESS OF CORE        23023602
         ORG   WORKSP                                                   23023702
XCTLL    XCTL  EP=IKJEGATD,SF=L -       LIST FORM OF XCTL               23023802
         ORG   STAEL                    OVERLAY STAE CONTROL BLOCK      23024102
SRHPARMS DS    0H                       BRKELEM REMOVAL ROUTINE'S       23024502
*                                       PARM LIST                       23024602
SRHFLAGS DC    F'0'                     FLAGS - 0 TO REMOVE BRKELEM     23024702
SRHADDR1 DS    A                        ADDRESS OF BRKPOINT FOR         23025302
*                                       BRKELEM TO BE REMOVED           23025702
SRHADDR2 DS    A                        SECOND ADDRESS OF RANGE OR 0    23026102
SRHPRMLH EQU   *-SRHPARMS               LENGTH OF SRH PARM LIST         23026502
         EJECT                                                          23026802
*********************************************************************** 23027402
*        THIS WEIRD DSECT DESCRIBES THE CONAREA WHERE CVT RETURNS     * 23028502
*        THE BINARY VALUE TRANSLATED FROM THE IDENT PDE FOR THE       * 23030802
*        COUNT. THE FIRST BYTE CONTAINS THE LENGTH OF THE BINARY      * 23033102
*        VALUE - IN THIS CASE IT ALWAYS CONTAINS A FOUR - AND THE     * 23035402
*        NEXT FOUR BYTES, WHICH ARE ALIGNED ON A WORD BOUNDARY,       * 23037702
*        CONTAIN THE BINARY VALUE.                                    * 23040002
*********************************************************************** 23050002
CONPLACE DSECT                          DSECT FOR CONAREA               23060002
         DS    D                        ALIGNMENT                       23070002
         ORG   *-ONE                    BACK UP ONE                     23080002
CONBYTE  DS    X                        LENGTH OF COUNT (FOUR)          23090002
CONCOUNT DS    F                        BINARY COUNT                    23100002
         SPACE                                                          23110002
         EJECT                                                          23112002
IKJEGAT  CSECT                                                          23114002
         DS    0F            FORCE FULLWORD ALIGNMENT                   23116002
ATPATCH  DC    50C'Z'        PATCH AREA                                 23118002
         END                                                            23120002
./  ADD  SSI=33180101,NAME=IKJEGATD
ATD      TITLE 'IKJEGATD - THE SECOND LOAD MODULE OF THE AT SUBCOMMAND' 00010002
         COPY  IKJEGSIO                                                 00010402
IKJEGATD CSECT                                                          00093602
         EJECT                                                          00094002
*****************************  PROLOGUE  ****************************** 00094402
*                                                                     * 00095202
* STATUS                                                              * 00096002
*    CHANGE LEVEL 00, VERSION NUMBER 02, VS2     03/02/73             * 00096802
*                                                                     * 00097602
* FUNCTION/OPERATION                                                  * 00098402
*    THIS MODULE CONSTRUCTS A DEFER QUEUE FOR SAVING REQUESTS FOR     * 00099202
*    ESTABLISHING BREAKPOINTS UNTIL THE CONCERNED MODULE IS BROUGHT   * 00100002
*    INTO CORE.                                                       * 00110002
*                                                                     * 00120002
* ENTRY POINTS                                                        * 00130002
*    IKJEGATD - ENTERED FROM IKJEGAT, THE FIRST LOAD MODULE OF        * 00140002
*    THE AT SUBCOMMAND.  IT FIRST CHECKS TO MAKE CERTAIN ALL          * 00150002
*    ADDRESSES FOR THE DEFER REQUEST ARE FULLY QUALIFIED              * 00160002
*    AND SPECIFY THE SAME LOADNAME. IT THEN BUILDS THE                * 00170002
*    DEFERRED BREAK ELEMENT AND PUTS IT ON THE DEFERRED QUEUE.        * 00180002
*                                                                     * 00190002
* INPUT                                                               * 00200002
*    REGISTER 1 CONTAINS THE ADDRESS OF TCOMTAB. THE FIELD WORKAREA   * 00210002
*    IN TCOMTAB CONTAINS THE ADDRESS OF TSTCWORK. ATD'S WORK AREA     * 00220002
*    IS PART OF TSTCWORK. THE FIELD PDEADDR IN ATD'S WORK AREA        * 00230002
*    CONTAINS THE ADDRESS OF THE FIRST ADDRESS PDE RETURNED BY        * 00240002
*    PARSE. THE FIELD TSTANSPL IN TCOMTAB POINTS TO THE PDL           * 00250002
*    WHICH WAS BUILT BY PARSE.                                        * 00260002
*                                                                     * 00270002
* OUTPUT                                                              * 00280002
*    OUTPUT CONSISTS OF THE FOLLOWING                                 * 00290002
*    1.  DIAGNOSTIC MESSAGES                                          * 00300002
*    2.  A DEFER QUEUE POINTED TO BY DEFERTAB IN TCOMTAB IN THE       * 00310002
*    FORMAT DESCRIBED UNDER THE SYMBOL NEWQ.                          * 00320002
*    3.  RETURN CODES AS LISTED BELOW-                                * 00330002
*                                                                     * 00340002
*    0 - MAINLINE MAY REISSUE THE TEST MODE MESSAGE AND GET ANOTHER   * 00350002
*    SUBCOMMAND. IF AN ERROR OCCURRED, TSTFLUSH IN TCOMTAB IS ON.     * 00360002
*    16 - ATTENTION HAS BEEN SCHEDULED                                * 00370002
*    20 - INDICATES RETURN FROM THE RETRY ROUTINE                     * 00380002
*    24 - INDICATES AN ESTAE MACRO FAILURE                            * 00382002
*                                                                     * 00390002
* EXTERNAL REFERENCES                                                 * 00400002
*    IKJEGIO OUTPUTS ERROR MESSAGES VIA IKJEGSIO MACRO                * 00410002
*                                                                     * 00430002
* EXITS, NORMAL                                                       * 00440002
*    RETURN VIA REGISTER 14 TO THE CALLER                             * 00450002
*                                                                     * 00460002
* EXITS, ERROR                                                        * 00462002
*    RETURN VIA REGISTER 14 TO THE CALLER                             * 00464002
*                                                                     * 00466002
* TABLES/WORK AREAS                                                   * 00470002
*    THIS MODULE USES TWO WORK AREAS                                  * 00480002
*    1.  SUBCOMMAND WORK AREA DESCRIBED BY TSTCWORK AND WORKSP DSECTS * 00490002
*    2.  TEST COMMUNICATION WORK AREA DESCRIBED BY TCOMTAB DSECT      * 00500002
*                                                                     * 00510002
* ATTRIBUTES                                                          * 00520002
*    REENTRANT, REFRESHABLE                                           * 00530002
*                                                                     * 00540002
* CHARACTER CODE DEPENDENCY                                           * 00550002
*    THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL REPRESEN-  * 00560002
*    TATION OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT TO THE  * 00570002
*    ONE USED AT ASSEMBLY TIME.  THE CODING HAS BEEN ARRANGED SO THAT * 00580002
*    REDEFINITION OF 'CHARACTER' CONSTANTS, BY REASSEMBLY, WILL RESULT* 00590002
*    IN A CORRECT MODULE FOR THE NEW DEFINITIONS.                     * 00600002
*                                                                     * 00610002
* NOTES                                                               * 00620002
*    NONE.                                                            * 00630002
*                                                                     * 00640002
*********************************************************************** 00650002
         EJECT                                                          00660002
*********************************************************************** 00670002
*                                                                     * 00680002
*               EQUATES                                               * 00690002
*                                                                     * 00700002
*********************************************************************** 00710002
         SPACE                                                          00720002
R0       EQU   0                        REGISTER 0 - USED ONLY FOR      00730002
*                                       INTERFACING WITH OS             00740002
R1       EQU   1                        REGISTER 1 - PARAMETER AND WORK 00750002
*                                       REGISTER                        00760002
R2       EQU   2                        REGISTER 2 - WORKREG - ALSO     00770002
*                                       USED AS BASE FOR DME            00780002
R3       EQU   3                        REGISTER 3 - RESERVED FOR       00790002
*                                       MAINTENANCE                     00800002
R4       EQU   4                        REGISTER 4 - WORKREG            00810002
R5       EQU   5                        REGISTER 5 - WORKREG            00820002
R6       EQU   6                        REGISTER 6 - WORKREG            00830002
R7       EQU   7                        REGISTER 7 - SWITCH FOR         00840002
*                                       SETTING UP LOAD NAME, AND BASE  00850002
*                                       FOR DBE                         00860002
R8       EQU   8                        REGISTER 8 - WORKREG FOR STAE   00870002
R9       EQU   9                        REGISTER 9 - BASE FOR TCOMTAB   00880002
R10      EQU   10                       REGISTER 10 - BASE FOR TSTCWORK 00890002
R11      EQU   11                       REGISTER 11 - BASE FOR ADDRESS  00900002
*                                       PDES                            00910002
R12      EQU   12                       REGISTER 12 - PROGRAM BASE      00920002
*                                       REGISTER                        00930002
R13      EQU   13                       REGISTER 13 - SAVE AREA POINTER 00940002
R14      EQU   14                       REGISTER 14 - RETURN ADDRESS    00950002
R15      EQU   15                       REGISTER 15 - RETURN CODES,     00960002
*                                       ENTRY ADDRESSES                 00970002
         SPACE                                                          00980002
BLANK    EQU   C' '                     BLANK                           00990002
HEXFF    EQU   X'FF'                    BYTE WITH ALL BITS ON           01000002
         SPACE                                                          01010002
ZERO     EQU   0                        NUMBER 0                        01020002
ONE      EQU   1                        NUMBER 1                        01030002
TWELVE   EQU   12                       NUMBER 12                       01040002
SIXTEEN  EQU   16                       NUMBER 16                       01050002
TWENTY   EQU   20                       NUMBER 20                       01060002
TWENTY8  EQU   28                       NUMBER 28                       01070002
         SPACE                                                          01080002
L0       EQU   0                        LENGTH OF 0                     01090002
L3       EQU   3                        LENGTH OF 3                     01100002
L7       EQU   7                        LENGTH OF 7                     01110002
         SPACE                                                          01120002
D0       EQU   0                        DISPLACEMENT OF 0               01130002
D1       EQU   1                        DISPLACEMENT OF 1               01140002
D4       EQU   4                        DISPLACEMENT OF 4               01150002
         SPACE                                                          01160002
CVTADDR  EQU   X'10'                    ADDRESS OF CVT                  01190002
RC24     EQU   24            RETURN CODE 24                             01192002
         SPACE                                                          01200002
         EJECT                                                          01250002
*********************************************************************** 01260002
*                                                                     * 01270002
*              ATD PROCESSING STARTS HERE                             * 01280002
*                                                                     * 01290002
*********************************************************************** 01300002
         SAVE  (14,12),,IKJEGATD        SAVE CALLER'S REGISTERS         01310002
         LR    R12,R15                  ESTABLISH ADDRESSABILITY FOR    01320002
         USING IKJEGATD,R12             THIS CSECT                      01330002
         LR    R9,R1                    PUT ADDRESS OF TCOMTAB IN R9    01340002
         USING TCOMTAB,R9               ESTABLISH ADDRESSABILITY TO     01350002
*                                       COMMUNICATION WORK AREA         01360002
         L     R5,REGSAVE2              R5=ADDR OF AT'S SAVE AREA       01370002
         ST    R5,SAVENEXT-SAVEAREA(R13)  SAVE FORWARD POINTER          01380002
         ST    R13,SAVELAST-SAVEAREA(R5)  SAVE BACK POINTER             01390002
         LR    R13,R5                   R13=ADDR OF AT'S SAVE AREA      01400002
         SPACE                                                          01410002
*********************************************************************** 01420002
*        TURN OFF XCTL SWITCH IN TCOMTAB. GET ADDRESSABILITY TO       * 01430002
*        WORKAREA, AND ISSUE ESTAE TO INTERCEPT ABENDS.               * 01440002
*********************************************************************** 01450002
         NI    TSTFLGS2,HEXFF-TSTXCTL   TURN OFF XCTL SWITCH            01460002
         STM   R14,R12,RETURNPT-SAVEAREA(R13)  SAVE AT'S REGISTERS      01470002
*                                       IN CASE OF AN ABEND             01480002
         L     R10,WORKAREA             R10=ADDRESS OF COMMON WORK AREA 01490002
         USING TSTCWORK,R10             ESTABLISH ADDRESSABILITY TO IT  01500002
         XC    STAEL,STAEL   CLEAR ESTAE PARM LIST                      01550002
         L     R15,TSTSTAE   R15=ADDR OF ESTAE EXIT ROUTINE             01560002
         ESTAE (R15),CT,PARAM=ATDSPL,XCTL=NO,RECORD=YES,               *01600002
               MF=(E,STAEL)  ESTABLISH ESTAE EXIT                       01602002
         LTR   R15,R15       WAS ESTAE SUCCESSFUL?                      01604002
         BZ    ATD1          YES,CONTINUE                               01606002
         STC   R15,TSTESTRC  SAVE ESTAE RETURN CODE                     01608002
         LA    R15,RC24      SET RETURN CODE TO 24                      01608402
         B     RETMAIN       RETURN TO IKJEGMNL                         01608802
         SPACE                                                          01610002
*********************************************************************** 01620002
*        GET ADDRESS OF FIRST ADDRESS PDE AND SET UP FOR PROCESSING.  * 01630002
*********************************************************************** 01640002
ATD1     EQU   *                                                        01642002
         L     R11,PDEADDR              R11=POINTER TO FIRST ADDRESS    01650002
*                                       PDE                             01660002
         USING IKJPARMA,R11             ESTABLISH ADDRESSABILITY TO PDE 01670002
         XR    R7,R7                    R7=0 INDICATES FIRST VALID      01680002
*                                       PDE YET TO BE ENCOUNTERED       01690002
         SPACE                                                          01700002
*********************************************************************** 01710002
*        CHECK FOR FULLY QUALIFIED ADDRESS. IF A RANGE IS GIVEN,      * 01720002
*        BE SURE BOTH ADDRESSES ARE IN THE SAME LOAD.                 * 01730002
*********************************************************************** 01740002
ISITCONV DS    0H                       CHECK FOR CONVERTED PDE         01750002
         TM    PDEUSER,PDECONVD         HAS PDE BEEN CONVERTED - IF IT  01760002
*                                       HAS NOT, THEN ADDRESS IS        01770002
*                                       FULLY QUALIFIED                 01780002
         BO    DEFERMSG                 PUT OUT MESSAGE FOR DEFER MUST  01790002
*                                       BE USED WITH FULLY QUALIFIED    01800002
*                                       ADDRESS                         01810002
         TM    PDE2FLG1,LDNAMFLG        WAS A RANGE GIVEN               01820002
         BZ    ASKFIRST                 NO, TEST FOR FIRST UNRESOLVED   01830002
*                                       PDE                             01840002
         CLC   PDELEN1,PDE2LEN1         DO LOADNAMES HAVE THE SAME      01850002
*                                       NUMBER OF CHARACTERS            01860002
         BNE   BADLDNM                  NO, PUT OUT ERROR MSG           01870002
         L     R2,PDELDNAM              R2=ADDRESS OF FIRST LOADNAME    01880002
         L     R6,PDE2LDNA              R6=ADDRESS OF SECOND LOADNAME   01890002
         LH    R4,PDELEN1               R4=LENGTH OF LOADNAMES          01900002
         BCTR  R4,ZERO                  DECREMENT FOR EXECUTE INSTR.    01910002
         EX    R4,COMPARE               DO LOADNAMES MATCH              01920002
         BNE   BADLDNM                  LOADNAMES DON'T MATCH - PUT OUT 01930002
*                                       ERROR MESSAGE                   01940002
         SPACE                                                          01950002
*********************************************************************** 01960002
*        IF THIS IS THE FIRST UNCONVERTED PDE, MOVE THE LOAD          * 01970002
*        NAME TO WORK AREA FOR COMPARISON WITH LATER PDE LOAD         * 01980002
*        NAMES. OTHERWISE, CHECK THAT LOAD NAME IS THE SAME           * 01990002
*        AS THAT OF PRECEEDING PDES.                                  * 02000002
*********************************************************************** 02010002
ASKFIRST DS    0H                       IS THIS FIRST UNRESOLVED PDE    02020002
         LTR   R7,R7                    IS THE SWITCH ZERO              02030002
         BZ    MOVELOAD                 YES, MOVE LOADNAME TO WORKAREA  02040002
         LH    R4,PDELEN1               R4=LENGTH OF NEW LOADNAME       02050002
         CLR   R5,R4                    IS LENGTH EQUAL TO LENGTH OF    02060002
*                                       FIRST                           02070002
         BNE   BADLDNM                  NO, PUT OUT MESSAGE - LOADNAMES 02080002
*                                       FOR A DEFER REQUEST MUST        02090002
*                                       BE THE SAME                     02100002
         LA    R6,LOADNAME              R6=POINTER TO LOADNAME IN       02110002
*                                       WORKAREA                        02120002
         L     R2,PDELDNAM              R2=POINTER TO NEW LOADNAME      02130002
         BCTR  R4,ZERO                  DECREMENT FOR EXECUTE INSTR     02140002
         EX    R4,COMPARE               COMPARE LOADNAMES               02150002
         BNE   BADLDNM                  LOADNAMES DON'T MATCH - PUT OUT 02160002
*                                       ERROR MESSAGE                   02170002
         SPACE                                                          02180002
*********************************************************************** 02190002
*        GET CHAIN POINTER TO NEXT PDE. IF NONE, GO INSERT ELEMENT    * 02200002
*        IN DEFERRED QUEUE FOR THIS REQUEST. IF MORE PDES, GO         * 02210002
*        CHECK THEM.                                                  * 02220002
*********************************************************************** 02230002
NAMESOK  DS    0H                       THE LOADNAMES MATCH             02240002
         L     R11,PDE2CHAI             R11=PDE CHAIN                   02250002
         LA    R11,D0(R11)              CLEAR HIGH ORDER BYTE           02260002
         LTR   R11,R11                  IS CHAIN EMPTY                  02270002
         BZ    SEARCHQ                  YES, CHECK FOR DEFER QUEUE      02280002
         B     ISITCONV                 CHECK FOR PDE CONVERTED         02290002
         SPACE                                                          02300002
*********************************************************************** 02310002
*        INSTRUCTION TO BE EXECUTED FOR COMPARISON OF LOAD            * 02320002
*        NAMES FOR PDES.                                              * 02330002
*********************************************************************** 02340002
COMPARE  CLC   D0(L0,R6),D0(R2)         COMPARE INSTRUCTION             02350002
         SPACE                                                          02360002
*********************************************************************** 02370002
*        A FULLY QUALIFIED ADDRESS WAS NOT GIVEN. SEND AN ERROR       * 02380002
*        MESSAGE TO THE TERMINAL, AND RETURN.                         * 02390002
*********************************************************************** 02400002
DEFERMSG DS    0H                       PREPARE TO OUTPUT MESSAGE FOR   02410002
*                                       FULLY QUALIFIED ADDRESS MUST    02420002
*                                       BE GIVEN WITH DEFER             02430002
         LA    R1,MSG2       R1=ADDR OF MESSAGE NUMBERS                 02440002
         B     PUTMSG                   PUT OUT MESSAGE AND RETURN      02460002
         SPACE                                                          02470002
*********************************************************************** 02480002
*        ALL LOADNAMES WERE NOT THE SAME. SEND AN ERROR MESSAGE TO    * 02490002
*        THE TERMINAL AND RETURN.                                     * 02500002
*********************************************************************** 02510002
BADLDNM  DS    0H                       PREPARE TO OUTPUT MESSAGE FOR   02520002
*                                       ALL LOADNAMES ON A DEFER        02530002
*                                       REQUEST MUST BE SAME            02540002
         LA    R1,MSG3       R1=ADDR OF MESSAGE NUMBERS                 02550002
         B     PUTMSG                   PUT OUT MESSAGE AND RETURN      02570002
         SPACE                                                          02580002
*********************************************************************** 02590002
*        WHEN THE FIRST UNCONVERTED PDE IS FOUND, AND IS VALID,       * 02600002
*        THIS CODE IS EXECUTED TO MOVE THE LOADNAME FROM THE PDE      * 02610002
*        TO ATD'S WORKAREA FOR COMPARISON WITH LATER PDES.            * 02620002
*********************************************************************** 02630002
MOVELOAD DS    0H                       FIRST UNRESOLVED PDE FOUND      02640002
         LA    R7,D1(R7)                SET SWITCH FOR FIRST UNRESOLVED 02650002
*                                       PDE                             02660002
         MVI   LOADNAME,BLANK           BLANK OUT LOADNAME FIELD IN     02670002
         MVC   LOADNAME+D1(L7),LOADNAME WORKAREA                        02680002
         L     R6,PDELDNAM              R6=ADDRESS OF LOADNAME          02690002
         LA    R4,LOADNAME              R4=ADDRESS FOR LOADNAME IN      02700002
*                                       WORKAREA                        02710002
         LH    R5,PDELEN1               R5=LENGTH OF LOADNAME STRING    02720002
         BCTR  R5,ZERO                  DECREMENT FOR MOVE INST         02730002
         EX    R5,LOADMVC               MOVE LOADNAME TO WORKAREA       02740002
         LA    R5,D1(R5)                R5=LENGTH OF LOADNAME           02750002
         B     NAMESOK                  CHECK FOR MORE PDE'S            02760002
         SPACE                                                          02770002
*********************************************************************** 02780002
*        THIS INSTRUCTION IS EXECUTED TO MOVE THE LOADNAME FROM       * 02790002
*        THE PDE TO ATD'S WORKAREA.                                   * 02800002
*********************************************************************** 02810002
LOADMVC  MVC   D0(L0,R4),D0(R6)         MOVE LOADNAME TO WORKAREA       02820002
         SPACE                                                          02830002
*********************************************************************** 02840002
*        ALL PDES HAVE BEEN CHECKED AS MUCH AS POSSIBLE AND ARE       * 02850002
*        OK. IF THE DEFERRED QUEUE IS EMPTY, GO BUILD A DEFERRED      * 02860002
*        QUEUE. IF QUEUE IS NOT EMPTY, GET ADDRESS OF FIRST DME ON    * 02870002
*        DEFERRED QUEUE.                                              * 02880002
*********************************************************************** 02890002
SEARCHQ  DS    0H                       ARE ANY DME'S ON THE DEFER      02900002
*                                       QUEUE                           02910002
         OC    DEFERTAB,DEFERTAB        IS THE DEFER QUEUE EMPTY ?      02920002
         BZ    NEWQ                     YES, ESTABLISH THE QUEUE        02930002
         L     R2,DEFERTAB              R2=ADDRESS OF FIRST DME ON THE  02940002
*                                       QUEUE                           02950002
         USING DME,R2                   R2 IS USED FOR DME              02960002
*                                       ADDRESSABILITY                  02970002
         SPACE                                                          02980002
*********************************************************************** 02990002
*        CHECK THE LOADNAME IN THE DME. IF IT IS NOT THE SAME AS      * 03000002
*        THE LOADNAME IN THE PDES, GO TRY THE NEXT DME. IF IT         * 03010002
*        IS THE SAME, GO TO END OF ASSOCIATED DBE CHAIN, AND BUILD    * 03020002
*        A NEW DBE FOR THIS REQUEST.                                  * 03030002
*********************************************************************** 03040002
TESTNAME DS    0H                       COMPARE LOADNAMES               03050002
         CLC   LOADNAME,DMELOAD         IS NEW LOADNAME EQUAL TO ONE    03060002
*                                       IN DME                          03070002
         BNE   NEXTDME                  NO, ARE THERE MORE DME'S        03080002
         L     R7,DMEDBE                R7=POINTER TO FIRST DBE         03090002
         USING DBE,R7                   R7 IS USED FOR DBE              03100002
*                                       ADDRESSABILITY                  03110002
         SPACE                                                          03120002
TRYDBE   DS    0H                       IS THIS LAST DBE FOR DME        03130002
         OC    DBEDBE,DBEDBE            IS DBE LINK FIELD ZERO          03140002
         BZ    GETDBE                   YES, GET CORE FOR NEXT DBE      03150002
         L     R7,DBEDBE                R7=POINTER TO NEXT DBE          03160002
         B     TRYDBE                   IS THIS LAST DBE FROM DME       03170002
         SPACE                                                          03180002
*********************************************************************** 03190002
*        LOADNAME IN DME DID NOT AGREE WITH LOADNAME IN PDES.         * 03200002
*        IF THERE ARE MORE DMES, GET THE ADDRESS OF THE NEXT ONE, AND * 03210002
*        GO CHECK IT. IF NO MORE, GO BUILD ONE FOR THIS REQUEST.      * 03220002
*********************************************************************** 03230002
NEXTDME  DS    0H                       ARE MORE DME'S ON THE QUEUE     03240002
         OC    DMEDME,DMEDME            IS LINK FIELD EMPTY             03250002
         BZ    NEWDME                   YES, GET CORE FOR ANOTHER DME   03260002
         L     R2,DMEDME                R2=POINTER TO NEXT DME          03270002
         B     TESTNAME                 BRANCH TO COMPARE LOADNAMES     03280002
         SPACE                                                          03290002
*********************************************************************** 03300002
*        THE DEFERRED QUEUE WAS EMPTY. BUILD A DME AND DBE FOR        * 03310002
*        THIS REQUEST AND CHAIN THEM TO THE TCOMTAB.                  * 03320002
*********************************************************************** 03330002
NEWQ     DS    0H                                                       03340002
         SPACE                                                          03350002
         MVC   GETCORE(GETLEN),GETL     MOVE LIST FORM OF GETMAIN TO    03360002
*                                          WORKAREA                     03370002
         LA    R1,GETCORE               R1=ADDRESS OF LIST FORM         03380002
         GETMAIN EC,LV=TWENTY8,A=ADDRCORE,SP=ONE,MF=(E,(R1)) GET CORE   03390002
*                                          FOR FIRST DME AND DBE        03400002
         LTR   R15,R15                  WAS CORE GOTTEN                 03410002
SMTGET01 BNZ   NOCORE                   NO. PRINT'INSUFFICIENT CORE'    03420002
         L     R2,ADDRCORE              R2=ADDRESS OF GOTTEN CORE       03430002
         ST    R2,DEFERTAB              SET POINTER IN TCOMTAB          03440002
         SPACE                                                          03450002
BLDELEMS DS    0H                       ACTUAL BUILDING OF ELEMENTS IS  03460002
*                                       DONE HERE                       03470002
         MVC   DMELOAD,LOADNAME         PUT LOADNAME IN DME             03480002
         LA    R7,DME+DMELNH            R7=ADDRESS OF FIRST DBE FROM    03490002
*                                       DME                             03500002
         ST    R7,DMEDBE                PUT ADDRESS OF FIRST DBE INTO   03510002
*                                       DME                             03520002
         XC    DMEDME,DMEDME            ZERO DME LINK FIELD             03530002
BLDDBE   DS    0H                                                       03540002
         MVC   DBEPDL,TSTANSPL          SAVE ADDRESS OF PDL IN DBE      03550002
         XC    TSTANSPL,TSTANSPL        CLEAR POINTER TO PDL            03560002
         MVC   DBEINBUF,INBUF           SAVE INBUF PTR IN DBE           03570002
         XC    INBUF,INBUF              CLEAR INBUF IN TCOMTAB          03580002
         XC    DBEDBE,DBEDBE            ZERO DBE LINK FIELD             03590002
         B     CODE0                    RETURN TO MAINLINE WITH DEFER   03600002
*                                       QUEUE SUCCESSFULLY BUILT        03610002
         SPACE                                                          03620002
*********************************************************************** 03630002
*        NO DME EXISTS FOR LOADNAME. BUILD A DME AND DBE AND          * 03640002
*        CHAIN THEM TO EXISTING QUEUE.                                * 03650002
*********************************************************************** 03660002
NEWDME   DS    0H                       A NEW DME MUST BE ESTABLISHED   03670002
         MVC   GETCORE(GETLEN),GETL     MOVE LIST FORM OF GETMAIN TO    03680002
*                                       WORKAREA                        03690002
         LA    R1,GETCORE               R1=ADDRESS OF LIST FORM         03700002
         GETMAIN EC,LV=TWENTY8,A=ADDRCORE,SP=ONE,MF=(E,(R1)) GET CORE   03710002
*                                       FOR NEW DME                     03720002
         LTR   R15,R15                  WAS CORE GOTTEN                 03730002
SMTGET02 BNZ   NOCORE                   NO. PRINT'INSUFFICIENT CORE'    03740002
         MVC   DMEDME,ADDRCORE          LINK NEW DME TO LAST DME        03750002
         L     R2,ADDRCORE              R2=ADDRESS OF NEW DME           03760002
         B     BLDELEMS                 BRANCH TO FILL IN FIELDS OF     03770002
*                                       DME AND DBE                     03780002
         SPACE                                                          03790002
*********************************************************************** 03800002
*        A DME EXISTS ON THE DEFERRED QUEUE FOR LOADNAME. BUILD A     * 03810002
*        DBE FOR THIS REQUEST AND CHAIN IT TO DBE QUEUE FOR DME.      * 03820002
*********************************************************************** 03830002
GETDBE   DS    0H                       A NEW DEFER BREAK ELEMENT MUST  03840002
*                                       BE ESTABLISHED                  03850002
         MVC   GETCORE(GETLEN),GETL     MOVE LIST FORM OF GETMAIN TO    03860002
*                                       WORK AREA                       03870002
         LA    R1,GETCORE               R1=ADDRESS OF L FORM OF MACRO   03880002
         GETMAIN EC,LV=TWELVE,A=ADDRCORE,SP=ONE,MF=(E,(R1)) GET CORE    03890002
*                                       FOR NEW DBE                     03900002
         LTR   R15,R15                  WAS CORE GOTTEN                 03910002
SMTGET03 BNZ   NOCORE                   NO. PRINT'INSUFFICIENT CORE'    03920002
         MVC   DBEDBE,ADDRCORE          CHAIN NEW DBE TO LAST DBE       03930002
         L     R7,ADDRCORE              PUT ADDRESS OF NEW DBE IN R7    03940002
         B     BLDDBE                   GO BUILD A NEW DBE              03950002
         SPACE                                                          03960002
*********************************************************************** 03970002
*    THERE WAS NOT ENOUGH CORE FOR GETMAIN. ISSUE MESSAGE AND QUIT.   * 03980002
*********************************************************************** 03990002
NOCORE   DS    0H                       THERE IS INSUFFICIENT CORE TO   04000002
*                                       SET UP DEFER ELEMENT            04010002
         LA    R1,MSG1       R1=ADDR OF MESSAGE NUMBERS                 04020002
         SPACE                                                          04040002
PUTMSG   DS    0H                       HAVE IKJEGIO PUT OUT MESSAGE    04050002
         OI    TSTFLGS4,TSTFLUSH        TURN ON TSTFLUSH SO MNL WILL    04053002
*                                       FLUSH THE INPUT STACK           04056002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM LIST         04106002
         LM    R2,R3,D0(R1)  LOAD R2-3 WITH MESSAGE NUMBERS             04156002
         IKJEGSIO MSG,FIRST=(R2),SECOND=(R3),ID=AT004,MF=(E,TSTIOPRM)   04166002
         C     R15,ATTNCODE  IS RETURN CODE 16,20 OR 24?                04176002
         BNL   RETMAIN       YES, PASS IT BACK TO IKJEGMNL              04178002
         SPACE                                                          04180002
*********************************************************************** 04190002
*        SET RETURN CODE TO ZERO AND RETURN.                          * 04200002
*********************************************************************** 04210002
CODE0    DS    0H                       SET RETURN CODE TO ZERO         04220002
         XR    R15,R15                  R15=0                           04230002
         B     RETMAIN                  RETURN TO MAINLINE              04240002
         EJECT                                                          04250002
*********************************************************************** 04260002
*        THIS IS THE ESTAE EXIT FOR ATD.                              * 04270002
*********************************************************************** 04300002
RETRY2   DS    0H                       RETRY ROUTINE IN CASE OF        04310002
*                                       AN ABEND                        04320002
         L     R5,CVTPTR                R5=ADDRESS OF CVT               04330002
         USING CVT,R5                   ESTABLISH ADDRESSABILITY TO IT  04340002
         L     R5,CVTTCBP               R5=POINTER TO DOUBLE WORD OF    04350002
*                                       POINTERS TO NEXT TO BE DIS-     04360002
*                                       PATCHED AND CURRENT TCB'S       04370002
         DROP  R5                                                       04380002
         L     R5,D4(R5)                R5=POINTER TO CURRENT TCB       04390002
*                                       (TEST'S TCB)                    04400002
         USING TCB,R5                   ESTABLISH ADDRESSABILITY TO IT  04410002
         L     R9,TCBTRN                R5=ADDRESS OF TCOMTAB           04420002
         DROP  R5                                                       04430002
         L     R13,REGSAVE2             R13=ADDRESS OF AT'S SAVE AREA   04440002
         L     R12,GR12-SAVEAREA(R13)   RESTORE BASE REGISTER           04450002
         LA    R15,TWENTY               R15=20 - INDICATES RETURN FROM  04530002
*                                       RETRY ROUTINE                   04540002
         SPACE                                                          04550002
RETMAIN  DS    0H                       RETURN TO MAINLINE              04560002
         LR    R2,R15        SAVE RETURN CODE                           04562002
         ESTAE 0             REMOVE ESTAE                               04564002
         LR    R15,R2        RESET RETURN CODE                          04566002
         NI    TSTFLGS4,HEXFF-TSTRERTN TURN OFF RETRY BIT               04568002
         L     R13,SAVELAST-SAVEAREA(R13)  RESTORE R13                  04570002
         RETURN (14,12),,RC=(15)        RETURN                          04580002
         EJECT                                                          04590002
*********************************************************************** 04600002
*                                                                     * 04610002
*              CONSTANTS AND MACROS USED IN ATD.                      * 04620002
*                                                                     * 04630002
*********************************************************************** 04640002
GETL     GETMAIN EC,SP=ONE,MF=L         LIST FORM OF GETMAIN            04650002
GETLEN   EQU   *-GETL                   LENGTH OF LIST FORM             04660002
         SPACE                                                          04700002
* CONSTANTS                                                             04710002
         DS    0F                                                       04720002
DUMMYABT DC    X'FF'         DUMMY ABEND TABLE                          04730002
ATTNCODE DC    F'16'         RC FOR ATTENTION                           04742002
*********************************************************************** 04750002
*              MESSAGE POINTERS                                       * 04752002
*********************************************************************** 04754002
MSG1     DC    F'39'         UNABLE TO ESTABLISH BREAKPOINT             04756002
         DC    F'260'        INSUFFICIENT STORAGE                       04758002
MSG2     DC    F'39'         UNABLE TO ESTABLISH BREAKPOINT             04758402
         DC    F'245'        FULLY QUALIFIED ADDRESS MUST BE GIVEN      04758802
MSG3     DC    F'39'         UNABLE TO ESTABLISH BREAKPOINT             04759202
         DC    F'246'        ALL LOADNAMES MUST BE THE SAME             04759602
         SPACE                                                          04759702
ATDSPL   IKJEGSPL RTRY=RETRY2,ABNTB=DUMMYABT,MODNM=IKJEGATD,TNM=ATD     04809702
         EJECT                                                          05290002
         IKJPARMA                       PDE DSECT                       05300002
         EJECT                                                          05310002
         IKJPPL                                                         05320002
PPLEND   EQU   *                        END OF PPL                      05330002
         EJECT                                                          05340002
SAVEAREA DSECT                                                          05352002
SAVEUSER DS    F                        UNUSED                          05354002
SAVELAST DS    F                        PTR TO LAST SAVEAREA (CALLER'S) 05356002
SAVENEXT DS    F                        PTR TO NEXT SAVEAREA (SUBRTN)   05358002
RETURNPT DS    F                        PTR TO CALLER'S RESUME ADDRESS  05358402
ENTRYPT  DS    F                        PTR TO MY ENTRY POINT           05358802
GR0      DS    F                        GENERAL REGISTER 0              05359202
GR1      DS    F                        GENERAL REGISTER 1              05359602
GR2      DS    F                        GENERAL REGISTER 2              05359702
GR3      DS    F                        GENERAL REGISTER 3              05359802
GR4      DS    F                        GENERAL REGISTER 4              05359902
GR5      DS    F                        GENERAL REGISTER 5              05363202
GR6      DS    F                        GENERAL REGISTER 6              05365202
GR7      DS    F                        GENERAL REGISTER 7              05365602
GR8      DS    F                        GENERAL REGISTER 8              05366002
GR9      DS    F                        GENERAL REGISTER 9              05366402
GR10     DS    F                        GENERAL REGISTER 10             05366502
GR11     DS    F                        GENERAL REGISTER 11             05366602
GR12     DS    F                        GENERAL REGISTER 12             05369902
LSAVE    EQU   *-SAVEAREA               LENGTH OF SAVEAREA              05371902
         EJECT                                                          05373402
         IKJEGDME                                                       05376702
         SPACE 2                                                        05380002
         IKJEGDBE                                                       05390002
         EJECT                                                          05400002
TCB      IKJTCB                         EXPANSION OF TCB                05410002
         EJECT                                                          05420002
CVT      DSECT                                                          05430002
         CVT                                                            05440002
         EJECT                                                          05450002
         TCOMTAB                        COMMUNICATIONS TABLE DSECT      05460002
         EJECT                                                          05470002
         TSTCWORK                       TEST WORK AREA DSECT            05480002
         ORG   CWORKCMD                 RESET TO COMMAND WORK AREA      05490002
WORKSP   DS    0H                                                       05502002
         SPACE                                                          05504002
*********************************************************************** 05506002
*                                                                     * 05508002
*        THIS IS A MAPPING OF THE AREA CALLED CWORKCMD IN TSTCWORK.   * 05508402
*        WHEN AT IS ENTERED TO ACTIVATE DEFERED BREAKPOINTS, THE      * 05508802
*        FIRST 8 CHARACTERS OF THE WORK AREA CONTAIN THE NAME OF THE  * 05509202
*        NEWLY LOADED MODULE. THE NINTH BYTE CONTAINS A FLAG WHICH    * 05509602
*        INDICATES WHETHER OR NOT THE MODULE IS IN OVERLAY. THE       * 05509702
*        LAST 64 BYTES OF THE WORK AREA ARE RESERVED FOR A REGISTER   * 05509802
*        SAVE AREA FOR IKJEGLDF IN THIS CASE.                         * 05509902
*        IF ANY CHANGES ARE MADE TO THE WORK AREA, MAKE THE SAME      * 05519902
*        CHANGES IN IKJEGAT. BOTH MODULES USE THE SAME FORMAT         * 05529902
*        OF WORK AREA.                                                * 05539902
*                                                                     * 05559902
*********************************************************************** 05569902
PDLADDR  DS    A -                      ADDRESS OF PDL BEING            05579902
*                                       PROCESSED BY AT WHEN            05589902
*                                       ACTIVATING DEFERED BREAKPOINTS  05599902
PARSECD  EQU   PDLADDR -                NONZERO SERVICE ROUTINE         05601902
*                                       RETURN CODES SENT TO VALIDITY   05603902
*                                       CHECK ROUTINES ARE STORED HERE  05605902
BYTENUMB DS    F -                      SAVE AREA FOR NUMBER OF BYTES   05607902
*                                       LAST GOTTEN                     05608302
SAVEPTR  DS    A -                      POINTER TO PREVIOUS BREAK       05608702
*                                       ELEMENT LINK FIELD              05609102
CHNADDR  DS    A -                      ADDRESS OF SUBCOMMAND CHAIN     05609502
*                                       FOR BREAKPOINT(S) BEING BUILT   05609602
STAEL    DS    CL16          PARM LIST AREA FOR ESTAE                   05659802
STRNGADR DS    A -                      ADDRESS OF ADDRESS STRING       05669802
*                                       FOR RANGE BEING PROCESSED       05679802
         DS    0F                                                       05689802
PARMS    DS    (PPLEND-PPL)X -          PPL IS BUILT HERE               05699802
         ORG   PARMS                                                    05701802
BRKSAVE  DS    18F -                    SAVE AREA FOR BREAKRTN          05703802
SAVE2345 DS    4F            WORK SAVE AREA FOR R2-5                    05704202
         ORG   STRNGADR                                                 05705802
PDEADDR  DS    A -                      ADDRESS OF FIRST ADDRESS PDE    05707802
*                                       IN PDL - PASSED AS PARM         05708202
         ORG   WORKSP                                                   05708602
LOADNAME DS    CL8 -                    LOAD NAME OF NEWLY LOADED MOD.  05709002
*                                       FOR WHICH DEFERED BREAK-        05709402
*                                       POINTS MAY BE ACTIVATED, OR     05709502
*                                       LOAD NAME FOR WHICH DEFERED     05709602
*                                       BREAKPOINTS ARE TO BE BUILT     05709702
LOADATTR EQU   * -                      ONE BYTE FLAG INDICATING        05759702
*                                       OVERLAY STATUS FOR NEWLY        05769702
*                                       LOADED MODULE                   05779702
GETCORE  GETMAIN   EC,SP=1,MF=L -       LIST FORM OF GETMAIN            05789702
ADDRCORE EQU   GETCORE+4 -              SECOND WORD OF LIST FORM        05799702
*                                       CONTAINS ADDRESS OF CORE        05801702
         ORG   WORKSP                                                   05803702
XCTLL    XCTL  EP=IKJEGATD,SF=L -       LIST FORM OF XCTL               05805702
         ORG   STAEL                    OVERLAY STAE CONTROL BLOCK      05807702
SRHPARMS DS    0H                       BRKELEM REMOVAL ROUTINE'S       05808102
*                                       PARM LIST                       05808502
SRHFLAGS DS    F'0'                     FLAGS - 0 TO REMOVE BRKELEM     05808902
SRHADDR1 DS    A                        ADDRESS OF BRKPOINT FOR         05809302
*                                       BRKELEM TO BE REMOVED           05809402
SRHADDR2 DS    A                        SECOND ADDRESS OF RANGE OR 0    05809502
SRHPRMLH EQU   *-SRHPARMS               LENGTH OF SRH PARM LIST         05809602
         EJECT                                                          05859602
IKJEGATD CSECT                                                          05869602
         DS    0F            FORCE FULLWORD ALIGNMENT                   05879602
ATDPATCH DC    50C'Z'        PATCH AREA                                 05889602
         END                                                            05909602
./  ADD  SSI=63510016,NAME=IKJEGATN
ATN      TITLE 'IKJEGATN - ATTENTION EXIT ROUTINE FOR TSO/TEST'         00100002
IKJEGATN CSECT                                                          00200002
         EJECT                                                          00300002
*********************************************************************** 00400002
*                                                                     * 00500002
* STATUS --                                                           * 00600002
*                                                                     * 00700002
*    CHANGE LEVEL 00, VERSION NO.02, OS/VS2, 03/14/73                 * 00800002
*                                                                     * 00900002
* FUNCTION --                                                         * 01000002
*                                                                     * 01100002
*    THIS ROUTINE PROCESSES AN ATTENTION INTERRUPT FOR THE TEST       * 01200002
*    COMMAND PROCESSOR.  WHEN THE OPERATING SYSTEM DETERMINES THAT    * 01300002
*    THE TERMINAL USER HAS HIT THE TERMINAL ATTENTION KEY TO CAUSE    * 01400002
*    AN INTERRUPT IN TEST, IT SCHEDULES THIS ROUTINE ASYNCHRONOUSLY.  * 01500002
*                                                                     * 01600002
*    AFTER RECEIVING CONTROL FROM THE OPERATING SYSTEM, IKJEGATN      * 01700002
*    DETERMINES IF THE TERMINAL USER HAS ENTERED ANY INPUT IN         * 01800002
*    RESPONSE TO THE TEST MODE MESSAGE.  IF THE INPUT BUFFER          * 01900002
*    LENGTH IS ZERO, CONTROL IS RETURNED TO THE OPERATING SYSTEM      * 02000002
*    WITH A RETURN CODE OF ZERO.                                      * 02100002
*                                                                     * 02200002
*    WHEN THE TERMINAL USER HAS ENTERED SOMETHING IN RESPONSE TO      * 02300002
*    THE TEST MODE MESSAGE, THE PUTGET SERVICE ROUTINE IS INVOKED     * 02400002
*    TO PUT ALL ENQUEUED SECOND LEVEL MESSAGES TO THE TERMINAL        * 02500002
*    USER, AND TO ACQUIRE THE INPUT HE PREVIOUSLY ENTERED.  ALSO,     * 02600002
*    THE SUBCOMMAND CHAIN POINTER (SUBCHAIN) IS ZEROED AND THE        * 02700002
*    CURRENT INPUT BUFFER, IF ANY, IS FREED.  THE NEW INPUT           * 02800002
*    BUFFER ACQUIRED BY PUTGET IS PLACED IN TCOMTAB (INBUF).          * 02900002
*                                                                     * 03000002
*    IF TEST HAS BEEN RUNNING FROM AN IN-CORE PROCEDURE, THE LIST     * 03100002
*    DESCRIPTOR FOR THAT PROCEDURE IS DELETED FROM THE INPUT          * 03200002
*    STACK AND INPUT IS REDIRECTED TO THE TERMINAL.  THE INPUT        * 03300002
*    QUEUES ARE ALSO CLEARED TO ENSURE THAT THE NEXT INPUT RECEIVED   * 03400002
*    FROM THE TERMINAL USER WILL BE SYNCHRONIZED WITH TEST            * 03500002
*    PROCESSING.                                                      * 03600002
*                                                                     * 03700002
*    ADDITIONAL PROCESSING IS PERFORMED DEPENDING ON WHICH OF THE     * 03800002
*    FOLLOWING SITUATIONS EXISTS -- (1) IS THE USER PROGRAM           * 03900002
*    PROCESSING, (2) IS HELP PROCESSING, OR (3) IS TEST PROCESSING.   * 04000002
*        (1)   WHEN THE USER PROGRAM IS PROCESSING, IT IS SET         * 04100002
*              SET NON-DISPATCHABLE AND A BREAKPOINT IS INSERTED      * 04200002
*              IN THE PROGRAM.                                        * 04300002
*        (2)   IF HELP WAS PROCESSING, IT IS SET NON-DISPATCHABLE.    * 04400002
*        (3)   IF TEST WAS PROCESSING, AND IN (1) AND (2) ABOVE,      * 04500002
*              THE ATTENTION ECB IS POSTED COMPLETE WITH A X'48'      * 04600002
*              COMPLETION CODE.                                       * 04700002
*    IN ALL CASES, CONTROL IS RETURNED TO THE OPERATING SYSTEM        * 04800002
*    WITH A RETURN CODE OF ZERO.                                      * 04900002
*                                                                     * 05000002
* ENTRY POINTS --                                                     * 05100002
*                                                                     * 05200002
*         IKJEGATN - ADDRESS OF THE ATTENTION EXIT ROUTINE.           * 05300002
*                                                                     * 05400002
* INPUT --                                                            * 05500002
*                                                                     * 05600002
*    REGISTER 1 POINTS TO A THREE WORD PARAMETER LIST OF THE          * 05700002
*    FOLLOWING FORMAT --                                              * 05800002
*                                                                     * 05900002
*              ..........................................             * 06000002
*              .                                        .             * 06100002
*        +0    .  ADDRESS OF THE TAIE                   .             * 06200002
*              ..........................................             * 06300002
*              .                                        .             * 06400002
*        +4    .  ADDRESS OF THE INPUT BUFFER           .             * 06500002
*              ..........................................             * 06600002
*              .                                        .             * 06700002
*        +8    .  ADDRESS OF TCOMTAB                    .             * 06800002
*              ..........................................             * 06900002
*                                                                     * 07000002
* OUTPUT --                                                           * 07100002
*                                                                     * 07200002
*    REGISTER 15 ALWAYS CONTAINS A RETURN CODE OF ZERO (0).           * 07300002
*                                                                     * 07400002
* EXTERNAL REFERENCES --                                              * 07500002
*                                                                     * 07600002
*         PUTGET   - OBTAINS INPUT FROM TERMINAL.                     * 07700002
*         STACK    - RESETS INPUT STACK.                              * 07800002
*                                                                     * 07900002
*    MACROS USED --                                                   * 08000002
*                                                                     * 08100002
*         ESTAE    - INTERCEPT ABENDS.                                * 08150002
*         FREEMAIN - FREE INPUT BUFFERS.                              * 08200002
*         IKJECT   - ECT MAPPING MACRO.                               * 08300002
*         IKJEGS9G - INTERFACE TO SVC 097.                            * 08400002
*         IKJPGPB  - PUTGET PARAMETER BLOCK MAPPING MACRO.            * 08500002
*         IKJRB    - RB MAPPING MACRO.                                * 08600002
*         IKJSTPL  - STACK PARAMETER LIST MAPPING MACRO.              * 08700002
*         IKJTAIE  - TAIE MAPPING MACRO.                              * 08800002
*         IKJTCB   - TCB MAPPING MACRO.                               * 08900002
*         IKJTPL   - TPL MAPPING MACRO.                               * 09000002
*         POST     - INDICATE ATTENTION INTERRUPT PROCESSED.          * 09100002
*         PUTGET   - INVOKE PUTGET SERVICE ROUTINE.                   * 09200002
*         RETURN   - RESTORE REGISTERS UPON EXIT.                     * 09300002
*         SAVE     - SAVE REGISTERS UPON ENTRY.                       * 09400002
*         STACK    - INVOKE STACK SERVICE ROUTINE.                    * 09500002
*         STATUS   - SET SUBTASKS NONDISPATCHABLE.                    * 09600002
*   ***** TCLEARQ  - FLUSH TERMINAL INPUT QUEUES.**NOT ISSUED @ZA15714* 09650000
*         TCOMTAB  - TEST COMMUNICATION AREA MAPPING MACRO.           * 09800002
*                                                                     * 09900002
* EXITS, NORMAL --                                                    * 10000002
*                                                                     * 10100002
*    RETURN VIA A BRANCH TO THE ADDRESS SPECIFIED IN REGISTER 14.     * 10200002
*                                                                     * 10300002
* EXITS, ERROR --                                                     * 10400002
*                                                                     * 10500002
*    NONE.                                                            * 10600002
*                                                                     * 10700002
* TABLES/WORK AREAS --                                                * 10800002
*                                                                     * 10900002
*    THE FOLLOWING FIELDS IN TCOMTAB ARE UPDATED --                   * 11000002
*         INBUF                                                       * 11100002
*         SUBCHAIN                                                    * 11200002
*         TSTGOWCF                                                    * 11300002
*                                                                     * 11400002
* ATTRIBUTES --                                                       * 11500002
*                                                                     * 11600002
*    REFRESHABLE, ENABLED, NON-PRIVILEGED.                            * 11700002
*                                                                     * 11800002
* CHARACTER CODE DEPENDENCY --                                        * 11900002
*                                                                     * 12000002
*    THIS CSECT HAS NO CHARACTER CODE DEPENDENCIES.                   * 12100002
*                                                                     * 12200002
* NOTES --                                                            * 12300002
*                                                                     * 12400002
*    NONE.                                                            * 12500002
* CHANGE ACTIVITY --                                                  * 12520000
*                                                                     * 12540000
*    APAR 0Z15714 - DO NOT ISSUE TCLEARQ AFTER ATTN HIT. MUST @ZA15714* 12560000
*                   SUPPORT STACK OR COMD. CHAINING.          @ZA15714* 12580000
*                                                                     * 12600002
*********************************************************************** 12700002
         EJECT                                                          12800002
*********************************************************************** 12900002
*                                                                     * 13000002
*        GENERAL REGISTER EQUATES                                     * 13100002
*                                                                     * 13200002
*********************************************************************** 13300002
ZERO     EQU   0              PARAMETER REGISTER                        13400002
PARMREG1 EQU   1              PARAMETER REGISTER                        13500002
WORKE    EQU   2              EVEN WORK REGISTER                        13600002
WORKO    EQU   3              ODD WORK REGISTER                         13700002
REG4     EQU   4              WORK REGISTERS                            13800002
REG5     EQU   5              *                                         13900002
REG6     EQU   6              *                                         14000002
REG7     EQU   7              *                                         14100002
REG8     EQU   8              ADDRESSABILITY TO WORK SPACE              14200002
TCOMADDR EQU   9              ADDRESS OF TCOMTAB                        14300002
REG10    EQU   10             WORK REGISTER                             14400002
REG11    EQU   11             WORK REGISTER                             14500002
BASEREG  EQU   12             BASE REGISTER                             14600002
SAVEREG  EQU   13             SAVE AREA ADDRESS REGISTER                14700002
RETREG   EQU   14             ADDRESS OF RETURN POINT                   14800002
ADDREG   EQU   15             ADDRESS REGISTER                          14900002
RETCODE  EQU   15             RETURN CODE REGISTER                      15000002
ENTRYREG EQU   15             ENTRY POINT ADDRESS.                      15100002
         EJECT                                                          15200002
         SAVE  (14,12),,*     SAVE REGISTERS                            15300002
         LR    BASEREG,ENTRYREG GET ENTRY POINT ADDRESS.                15400002
         USING IKJEGATN,BASEREG ESTABLISH ADDRESSABILITY                15500002
         USING ATNPARMS,PARMREG1 ESTABLISH ADDRESSABILITY TO            15600002
*                             INPUT PARAMETERS                          15700002
         L     TCOMADDR,ATNPTUSR GET POINTER TO TCOMTAB                 15800002
         USING TCOMTAB,TCOMADDR ESTABLISH ADDRESSABILITY                15900002
         L     REG8,WORKAREA  GET POINTER TO WORK AREA                  16000002
         USING TSTCWORK,REG8  ESTABLISH ADDRESSABILITY TO IT            16100002
         LA    REG8,CWORKATN  R8=ADDRESS OF ATTENTION'S WORK            16200002
*                             AREA                                      16300002
         DROP  REG8                                                     16400002
         USING ATNWKARA,REG8  ESTABLISH ADDRESSABILITY TO               16500002
*                             WORK AREA                                 16600002
         XC    ATNWKARA(ATNLEN),ATNWKARA ZERO WORK AREA                 16700002
         ST    SAVEREG,FOUR(,REG8)  SAVE ADDR OF CALLER'S SAVE AREA     16800002
         ST    REG8,EIGHT(,SAVEREG) STORE ATTN'S SAVE AREA POINTER      16900002
*                             IN CALLER'S SAVE AREA                     17000002
         LR    SAVEREG,REG8   R13=ATTN'S SAVE AREA POINTER              17100002
*                             AND WORK AREA POINTER                     17200002
         DROP  REG8                                                     17300002
         SPACE 2                                                        17400002
         LR    REG6,PARMREG1  SAVE REG 1 OVER ESTAE CALL                17410002
         USING ATNWKARA,SAVEREG  ADDRESSABILITY TO ATN WORK AREA        17450002
         L     WORKO,TSTSTAE  ADDRESS OF ESTAE EXIT ROUTINE             17460002
         ESTAE (WORKO),PARAM=LISTESTA,RECORD=YES,MF=(E,ATNESTAE)        17470002
         SR    REG4,REG4      ZERO POST CODE.                           17500002
         LR    PARMREG1,REG6  RESTORE REG 1                             17550002
         L     REG5,ATNPTAIE  R5=POINTER TO TAIE                        17700002
         DROP  PARMREG1                                                 17800002
         USING TAIE,REG5      ESTABLISH ADDRESSABILITY TO THE           17900002
*                             TAIE                                      18000002
         CLI   TAIETGET,ZERO  CHECK FOR NO TERMINAL INPUT               18100002
         BZ    ATN03010       YES, RETURN                               18200002
         DROP  REG5                                                     18300002
         SPACE 2                                                        18400002
         XC    SUBCHAIN(L'SUBCHAIN),SUBCHAIN CLEAR SUBCHAIN FIELD       18500002
         L     REG5,TSTECT    R5=ADDRESS OF ECT                         18600002
         USING ECT,REG5       ESTABLISH ADDRESSABILITY TO IT            18700002
         OI    ECTMSGF,ONBIT  INDICATE SECOND LEVEL MESSAGES            18800002
*                             TO BE CLEARED                             18900002
         DROP  REG5                                                     19000002
         MVC   ATNPGPB(ATNPTGTL),ATNPTGT INITIALIZE PARAM BLOCK.        19100002
         MVC   ATNIOPL(TSTCPECB-TSTUPT+L'TSTCPECB),TSTUPT SET UP        19200002
*                             UPT, ECT, AND ECB POINTERS.               19300002
         PUTGET PARM=ATNPGPB, ADDRESS OF PUTGET PARAMETER BLOCK        *19400002
               MF=(E,ATNIOPL) EXECUTE FORM OF MACRO.                    19500002
         SPACE 2                                                        19600002
         LTR   RETCODE,RETCODE TEST RETURN CODE.                        19700002
         BZ    ATN01010       IF ZERO, BRANCH TO CONTINUE.              19800002
         LA    RETREG,EIGHT   CREATE CONSTANT 8.                        19900002
         CR    RETCODE,RETREG CHECK IF AN ATTENTION OCCURRED.           20000002
         BE    ATN01030       IF ATTENTION, BRANCH TO CLEAN-UP.         20100002
         LA    REG4,ATNPG(,RETCODE) PUTGET ERROR CODE.                  20200002
         B     ATN01090       BRANCH TO POST AND CLEAN-UP.              20300002
         SPACE 2                                                        20400002
ATN01010 EQU   *                                                        20500002
         L     REG5,ATNPGPB+(PGPBIBUF-PGPB) INPUT BUFFER ADDRESS        20600002
         OC    INBUF(L'INBUF),INBUF MUST INBUF BE FREED                 20700002
         BZ    ATN01030       NO, INSERT NEW BUFFER ADDR                20800002
         L     PARMREG1,INBUF R1=ADDR OF CORE TO BE FREED               20900002
         LH    ZERO,ZERO(,PARMREG1) R0=LENGTH OF CORE TO BE FREED       21000002
         O     ZERO,SUBPOOL1  INDICATE SUBPOOL NUMBER.                  21100002
         FREEMAIN R,LV=(0),A=(1) FREE LAST INPUT BUFFER.                21200002
         SPACE 2                                                        21300002
ATN01030 EQU   *                                                        21400002
         ST    REG5,INBUF     SAVE BUFFER ADDR IN TCOMTAB               21500002
         LH    REG5,ZERO(,REG5) GET LENGTH OF INPUT LINE.               21600002
         LA    WORKO,FOUR     CREATE CONSTANT FOUR.                     21700002
         CR    REG5,WORKO     CHECK FOR NULL LINE INPUT.                21800002
         BE    ATN03010       IF NULL LINE, RETURN.                     21900002
         TM    TSTFLGS4,TSTA  Q.RUNNING FROM TERMINAL                   22000002
         BO    ATN01050       YES.DONT FLUSH THE STACK.                 22100002
         MVC   ATNSTCKL(ATNSTLEN),ATNSTCK MOVE L FORM OF STACK MACRO    22200002
*                             TO WORK AREA                              22300002
         STACK PARM=ATNSTCKL, ADDRESS OF STACK PARAMETER BLOCK         *22400002
               MF=(E,ATNIOPL) EXECUTE FORM OF MACRO.                    22500002
         SPACE 2                                                        22600002
         LTR   RETCODE,RETCODE TEST RETURN CODE.                        22700002
         BZ    ATN01050       IF ZERO, BRANCH TO CONTINUE.              22800002
         LA    REG4,ATNST(,RETCODE) STACK ERROR CODE.                   22900002
         B     ATN01090       BRANCH TO POST AND CLEAN-UP.              23000002
         SPACE 2                                                        23100002
ATN01050 EQU   *                                                        23200002
*        TCLEARQ IS DELETED.....                               @ZA15714 23250000
         SPACE 2                                                        23900002
ATN01070 EQU   *                                                        24000002
         TM    TSTFLGS3,TSTHELP WAS HELP RUNNING                        24100002
         BO    ATN02010       YES. STOP IT                              24200002
         L     REG5,ECBTST    R5=ADDRESS OF TEST'S ECB                  24300002
         TM    ZERO(REG5),WAITBIT IS TEST WAITING                       24400002
         BO    ATN02030       YES, PP MODE - SET BREAKPOINT             24500002
         SPACE 2                                                        24600002
ATN01090 EQU   *                                                        24700002
         L     PARMREG1,ECBTMPA GET ADDR OF ATTENTION ECB               24800002
         TM    ZERO(PARMREG1),ATNSET HAS ATTENTION BEEN SET             24900002
         BO    ATN03010       YES, RETURN TO SYSTEM                     25000002
         O     REG4,POSTCODE  R0=POST CODE                              25100002
         POST  (1),(REG4)     POST THE ATTENTION ECB                    25200002
         B     ATN03010       RETURN TO SYSTEM                          25300002
         SPACE 2                                                        25400002
ATN02010 EQU   *                                                        25500002
         STATUS STOP,TCB=TSTHTCB STOP HELP SUBTASK.                     25600002
****                                                                    25700002
****     RETURN CODE CHECK IGNORED -- EITHER TCB WAS STOPPED            25800002
****     SUCCESSFULLY OR TCB WAS NOT A SUBTASK OF TSO/TEST.             25900002
****                                                                    26000002
         B     ATN01090       CONTINUE.                                 26100002
         SPACE 2                                                        26200002
ATN02030 EQU   *                                                        26300002
         OC    TSTGO(L'TSTGO),TSTGO HAS A BREAKPOINT BEEN SET           26400002
         BNZ   ATN03010       YES, RETURN                               26500002
         STATUS STOP          STOP ALL SUBTASKS                         26600002
****                                                                    26700002
****     RETURN CODE CHECK IGNORED -- EITHER TCB WAS STOPPED            26800002
****     SUCCESSFULLY OR TCB WAS NOT A SUBTASK OF TSO/TEST.             26900002
****                                                                    27000002
         L     WORKE,TPLPTR   OBTAIN ADDRESS OF TPL.                    27100002
         USING TPL,WORKE      ADDRESSABILITY TO TPL.                    27200002
         L     WORKE,TPLCTCB  OBTAIN ADDRESS OF TEST'S DAUGHTER TCB     27300002
         DROP  WORKE                                                    27400002
         USING TCB,WORKE      ADDRESSABILITY TO TCB.                    27500002
         L     WORKO,TCBRBP   GET POINTER TO RB QUEUE                   27600002
         USING RBSECT,WORKO   ADDRESSABILITY TO RB.                     27700002
         SPACE 2                                                        27800002
ATN02050 EQU   *                                                        27900002
         TM    RBSTAB1,RBFTSIRB IS RB A PRB OR AN IRB                   28000002
         BZ    ATN02090       YES, CHECK FOR PROBLEM                    28100002
*                             PROGRAM STATE                             28200002
         SPACE 2                                                        28300002
ATN02070 EQU   *                                                        28400002
         L     WORKO,RBLINK   GET ADDR OF NEXT RB                       28500002
         B     ATN02050       CHECK FOR PRB OR IRB                      28600002
         SPACE 2                                                        28700002
ATN02090 EQU   *                                                        28800002
         TM    RBOPSW+1,PSWPBIT IS PROGRAM STATE BIT ON                 28900002
         BZ    ATN02070       NO, TRY NEXT RB                           29000002
         TM    RBOPSW+1,PSWKEY IS THE KEY ZERO                          29100002
         BZ    ATN02070       NO, TRY NEXT RB                           29200002
         MVC   TSTGOPSW(L'TSTGOPSW),RBOPSW+4 MOVE IC TO TSTGO           29300002
         MVC   TSTGOWCF(L'TSTGOWCF),RBWCF MOVE WAIT COUNT TO TSTGO      29400002
         SPACE 2                                                        29500002
         IKJEGS9G WCF,TCBADDR=(WORKO),MF=(E,ATNSVC) TURN OFF WAIT      *29600002
                              ON IN ACTIVE IRB OR PRB.                  29700002
         SPACE 2                                                        29800002
         IKJEGS9G OPSW,TCBADDR=(WORKO),VALUE=TSTSVC,MF=(E,ATNSVC)      *29900002
                              CHANGE RESUME ADDRESS.                    30000002
         SPACE 2                                                        30100002
         STATUS START,TCB=(WORKE) START TEST'S DAUGHTER TASK            30200002
****                                                                    30300002
****     RETURN CODE CHECK IGNORED -- EITHER TCB WAS STOPPED            30400002
****     SUCCESSFULLY OR TCB WAS NOT A SUBTASK OF TSO/TEST.             30500002
****                                                                    30600002
         SPACE 2                                                        30700002
ATN03010 EQU   *                                                        30800002
         ESTAE 0              REMOVE ESTAE REQUEST                      30850002
ATN03020 EQU   *                                                        30860002
         NI    TSTFLGS4,HEXFF-TSTRERTN  SHUT OFF RETRY FLAG             30870002
         XR    RETCODE,RETCODE SET RETURN CODE TO ZERO                  30900002
         L     SAVEREG,FOUR(,SAVEREG) RESTORE ADDR OF CALLER'S SAVE     31000002
*                             AREA                                      31100002
         RETURN (14,12),,RC=(15) RESTORE REGISTERS AND RETURN           31200002
         EJECT                                                          31300002
*********************************************************************** 31400002
*                                                                     * 31500002
*        CONSTANTS, EQUATES, AND OTHER AREAS.                         * 31600002
*                                                                     * 31700002
*********************************************************************** 31800002
ATNSTCK  STACK DELETE=ALL,    RESET THE INPUT STACK                    *31900002
               MF=L           LIST FORM OF MACRO                        32000002
ATNSTLEN EQU   *-ATNSTCK      LENGTH OF MACRO                           32100002
ATNPTGT  PUTGET OUTPUT=(IKJEGMMD,SINGLE,ATTN), MODE MESSAGE ADDRESS    *32200002
               TERMPUT=(EDIT,WAIT,NOHOLD,NOBREAK), OUTPUT OPTIONS      *32300002
               TERMGET=(EDIT,WAIT), INPUT OPTIONS                      *32400002
               MF=L           LIST FORM OF MACRO                        32500002
ATNPTGTL EQU   *-ATNPTGT      PARAMETER BLOCK LENGTH.                   32600002
         DS    0F             ALIGN ON WORD BOUNDARY.                   32700002
SUBPOOL1 DC    X'01000000'    SPECIFIES SUBPOOL 1                       32800002
POSTCODE DC    X'08000000'    POST CODE FOR ATTENTION ECB               32900002
CONSTANT DC    50C'Z'         ZAP AREA                                  32950002
ONE      EQU   1              NUMBER 1                                  33000002
FOUR     EQU   4              NUMBER 4                                  33100002
EIGHT    EQU   8              NUMBER 8                                  33200002
TWELVE   EQU   12             NUMBER 12                                 33300002
RETRY    EQU   0              SIGNIFIES NO RETRY ROUTINE                33350002
L1       EQU   1              LENGTH 1                                  33400002
L3       EQU   3              LENGTH 3                                  33500002
ONBIT    EQU   X'80'          HIGH ORDER BIT ON                         33600002
PSWPBIT  EQU   X'01'          SIGNIFIES P BIT ON IN PSW                 33700002
PSWKEY   EQU   X'F0'          BIT SETTING TO TEST FOR KEY               33800002
*                             ZERO                                      33900002
WAITBIT  EQU   X'80'          ECB WAITING                               34000002
ATNSET   EQU   X'40'          ATTENTION BIT                             34100002
ATNPG    EQU   X'000100'      PUTGET ERROR CODE.                        34200002
ATNST    EQU   X'000200'      STACK ERROR CODE.                         34300002
ATNTQ    EQU   X'000400'      TCLEARQ ERROR CODE.                       34400002
HEXFF    EQU   X'FF'          HEX FF                                    34450002
LISTESTA IKJEGSPL MODNM=IKJEGATN,ABNTB=ABENDTB,RTRY=RETRY,             *34460002
               TNM=ATTENTION  ESTAE PARAMETER LIST                      34470002
         SPACE 1                                                        34480002
ABENDTB  DS    0F             ABEND TABLE FOR IKJEGSTA                  34490002
         DC    X'FF'          END OF TABLE FLAG                         34492002
         TITLE 'IKJEGATM - MESSAGE CONTROL SECTION FOR IKJEGATN'        34500002
IKJEGATM CSECT                                                          34600002
         ENTRY IKJEGMMD       OUTPUT LINE DESCRIPTOR FOR MESSAGE.       34700002
         ENTRY IKJEGMMG                                                 34800002
         ENTRY IKJEGMMT                                                 34900002
IKJEGMMD DC    A(1)           INDICATE ONE SEGMENT.                     35000002
         DC    A(IKJEGMMG)    ADDRESS OF MODE MESSAGE.                  35100002
IKJEGMMG DC    AL2(ATMMODEX-IKJEGMMG) LENGTH OF MODE MESSAGE.           35200002
         DC    AL2(0)         OFFSET TO MODE MESSAGE.                   35300002
         DC    C' '           LEADING BLANK FOR PUTGET.                 35400002
IKJEGMMT DC    CL4'TEST'      TEST MODE MESSAGE.                        35500002
ATMMODEX EQU   *              END OF MESSAGE.                           35600002
         EJECT                                                          35700002
         IKJPGPB                                                        35800002
         EJECT                                                          35900002
         TCOMTAB                                                        36000002
         EJECT                                                          36100002
         IKJTPL                                                         36200002
         EJECT                                                          36300002
         IKJECT                                                         36400002
         EJECT                                                          36500002
         IKJSTPL                                                        36600002
         EJECT                                                          36700002
*********************************************************************** 36800002
*                                                                     * 36900002
*        THIS DSECT DESCRIBES THE WORKAREA USED BY IKJEGATN.          * 37000002
*                                                                     * 37100002
*********************************************************************** 37200002
ATNWKARA DSECT                ATTENTION'S WORK AREA                     37300002
ATNSVARA DS    18F            SAVE AREA                                 37400002
ATNIOPL  DS    4F             IO SERVICE ROUTINE PARAMETER LIST         37500002
ATNSTCKL DS    2F             STACK PARAMETER LIST                      37600002
         ORG   ATNSTCKL       REUSE WORKAREA                            37650002
ATNESTAE DS    4F             PARAMETER LIST FOR ESTAE                  37660002
         ORG   ATNSTCKL       REUSE WORKAREA                            37700002
ATNPGPB  DS    4F             PUTGET PARAMETER BLOCK                    37800002
         ORG   ATNSTCKL       REUSE WORKAREA                            37900002
ATNSVC   DS    3F             PARAMETER LIST FOR BREAKPOINT SVC         38000002
ATNLEN   EQU   *-ATNWKARA     WORK AREA LENGTH                          38100002
         EJECT                                                          38200002
         IKJTAIE                                                        38300002
         EJECT                                                          38400002
         IKJRB                                                          38500002
         EJECT                                                          38600002
         IKJTCB                                                         38700002
         EJECT                                                          38800002
**********************************************************************  38900002
*                                                                     * 39000002
*        THIS DSECT DESCRIBES THE INPUT PARAMETER LIST TO IKJEGATN    * 39100002
*                                                                     * 39200002
**********************************************************************  39300002
ATNPARMS DSECT                DSECT FOR INPUT PARAMETERS                39400002
ATNPTAIE DS    A              ADDR OF TAIE                              39500002
ATNPTIPT DS    A              ADDR OF INPUT BUFFER                      39600002
ATNPTUSR DS    A              USER INFORMATION - ADDRESS                39700002
*                             OF TCOMTAB                                39800002
         TITLE 'IKJEGBLD - ADDRESS STRING CONSTRUCTION SERVICE ROUTINE' 39900002
* REGISTER EQUATES                                                      40000002
R0       EQU   0              REGISTER 0                                40100002
R1       EQU   1              REGISTER 1                                40200002
R2       EQU   2              REGISTER 2                                40300002
R3       EQU   3              REGISTER 3                                40400002
R4       EQU   4              REGISTER 4                                40500002
R5       EQU   5              REGISTER 5                                40600002
R6       EQU   6              REGISTER 6                                40700002
R7       EQU   7              REGISTER 7                                40800002
R8       EQU   8              REGISTER 8                                40900002
R9       EQU   9              REGISTER 9                                41000002
R10      EQU   10             REGISTER 10                               41100002
R11      EQU   11             REGISTER 11                               41200002
R12      EQU   12             REGISTER 12                               41300002
R13      EQU   13             REGISTER 13                               41400002
R14      EQU   14             REGISTER 14                               41500002
R15      EQU   15             REGISTER 15                               41600002
         SPACE                                                          41700002
* OTHER EQUATES                                                         41800002
REGSYM   EQU   C'R'           GENERAL REGISTER SYMBOL                   41900002
DECSYM   EQU   C'N'           SYMBOL FOR DECIMAL VALUE                  42000002
REGD     EQU   C'D'           SYMBOL FOR DOUBLE PRECISION FLOATING      42100002
*                                POINT REGISTER                         42200002
REGE     EQU   C'E'           SYMBOL FOR SINGLE PRECISION FLOATING      42300002
*                                POINT REGISTER                         42400002
DOUBLE   EQU   X'10'          FLAG FOR DOUBLE PRECISION                 42500002
SINGLE   EQU   X'08'          FLAG FOR SINGLE PRECISION                 42600002
DECVAL   EQU   X'04'          DECIMAL EXPRESSION VALUE                  42700002
PERCENT  EQU   C'%'           PERCENT SIGN                              42800002
EXPFLGS5 EQU   8              OFFSET INTO EXPRESSION PDE FOR FLAGS      42900002
NINE     EQU   9              NUMBER 9                                  43000002
TEN      EQU   10             NUMBER 10                                 43100002
THIRTEEN EQU   13             NUMBER 13                                 43200002
TWENTY8  EQU   28             NUMBER 28                                 43300002
MAXLEN   EQU   100            MAXIMUM LENGTH OF STRING                  43400002
ADDRLEN  EQU   26             MAXIMUM LENGTH OF STRING FOR MSG          43500002
         SPACE                                                          43600002
IKJEGBLD CSECT                THIS CSECT BUILDS AN ADDRESS STRING TO A  43700002
* MAXIMUM LENGTH OF 100 BYTES.  AS INPUT IT REQUIRES A POINTER TO THE   43800002
* ADDRESS PDE IN REGISTER ZERO AND A POINTER IN REGISTER ONE TO THE     43900002
* AREA IN WHICH THE STRING IS TO BE BUILT.  AT EXIT REGISTER ZERO WILL  44000002
* CONTAIN THE NUMBER OF BYTES CONSTRUCTED AND REGISTER ONE WILL CONTAIN 44100002
* A POINTER TO THE BYTE FOLLOWING THE LAST ONE IN THE ADDRESS STRING.   44200002
* IF ON INPUT REGISTER 1 IS NEGATIVE IT WILL BE KNOWN THAT THE MAXIMUM  44300002
* LENGTH ALLOWED FOR THE STRING IS 26 BYTES                             44400002
         SPACE                                                          44500002
         SAVE  (14,12),,IKJEGBLD SAVE CALLER'S REGISTERS                44600002
         LR    R12,R15        ESTABLISH ADDRESSABILITY FOR THIS         44700002
         USING IKJEGBLD,R12      CSECT                                  44800002
         LR    R10,R0         R10=POINTER TO ADDRESS PDE                44900002
         USING IKJPARMA,R10   ESTABLISH PDE ADDRESSABILITY              45000002
         LTR   R1,R1          IS THE MAXIMUM STRING LENGTH 26 BYTES     45100002
         BNM   RESET          NO, SET MAXIMUM TO 100                    45200002
         LCR   R1,R1          LOAD COMPLEMENT OF REGISTER ONE           45250002
         LA    R9,ADDRLEN     SET MAXIMUM TO 26                         45300002
CLEAR    EQU   *              CLEAR ACCUMULATOR                         45400002
         SR    R4,R4          CLEAR BYTE ACCUMULATOR                    45500002
         TM    PDEFLG1,LDNAMFLG Q.IS LOAD NAME SPECIFIED.               45600002
         BO    LOADYES        YES, PICK UP EVERYTHING.                  45700002
         TM    PDEFLG2,CTNAMFLG Q.IS ENTRYNAME PRESENT.                 45800002
         BO    CSECTYES       YES, PICK UP ENTRY-ADDRESS.               45900002
         B     ADDRONLY       NO, PICK UP ADDR ONLY.                    46000002
         SPACE                                                          46100002
RESET    EQU   *              SET MAXIMUM LENGTH TO 100                 46200002
         LA    R9,MAXLEN      SET MAXIMUM TO 100                        46400002
         B     CLEAR          BEGIN BUILDING ADDRESS STRING             46500002
LOADYES  EQU   *              LOADNAME GIVEN                            46600002
         L     R7,PDELDNAM    R7=ADDR OF LOAD NAME.                     46700002
         LH    R6,PDELEN1     R6=LOAD NAME LENGTH.                      46800002
         BAL   R11,ADMOVE     MOVE LOAD NAME AND BUMP ACCUMULATORS.     46900002
         SPACE                                                          47000002
CSECTYES EQU   *              CSECTNAME GIVEN                           47100002
         L     R7,PDECTNAM    R7=ADDR OF CSECT NAME.                    47200002
         LH    R6,PDELEN2     R6=CSECT NAME LENGTH.                     47300002
         BCTR  R7,ZERO        PICK UP PRECEDING PERIOD.                 47400002
         LA    R6,ONE(R6)     *                                         47500002
         TM    PDEFLG3,AFLG   Q.ANY ADDRESS.                            47600002
         BZ    MOVE           NO, MOVE CSECT NAME.                      47700002
         LA    R6,ONE(R6)     YES, PICK UP TRAILING PERIOD.             47800002
         SPACE                                                          47900002
MOVE     EQU   *              SAVE CSECT NAME                           48000002
         BAL   R11,ADMOVE     MOVE CSECT NAME & ETC.                    48100002
         SPACE                                                          48200002
ADDRONLY EQU   *              CHECK FOR ADDRESS STRING                  48300002
         TM    PDEFLG3,AFLG   Q.ANY ADDR.                               48400002
         BZ    GOBACK         NO, RETURN TO CALLER                      48500002
         L     R7,PDEADRPT    R7=ADDR OF ADDRESS.                       48600002
         LA    R5,PDEADRPT    R5=ADDR OF POINTER TO ADDRESS             48700002
         LH    R6,PDELEN3     R6=ADDRESS STRING LENGTH.                 48800002
         TM    PDEFLG4,ABSCOMPL Q.IS IT ABSOLUTE                        48900002
         BM    RELCHK         NO, CHECK FOR RELATIVE.                   49000002
         B     BUMP           YES, PICK UP PERIOD.                      49100002
         SPACE                                                          49200002
RELCHK   EQU   *              TEST FOR RELATIVE ADDRESS                 49300002
         TM    PDEFLG4,RELADDR Q.IS IT A RELATIVE.                      49400002
         BZ    NEITHER        NO, MOVE STRING.                          49500002
         BCTR  R7,ZERO        YES, PICK UP PLUS SIGN.                   49600002
         SPACE                                                          49700002
BUMP     EQU   *              INCREMENT LENGTH COUNTER                  49800002
         LA    R6,ONE(R6)     BUMP FOR PUNCTUATION.                     49900002
         SPACE                                                          50000002
NEITHER  EQU   *              ADDR IS NEITHER ABSOLUTE NOR RELATIVE     50100002
         BAL   R11,ADMOVE     MOVE ADDRESS STRING & ETC.                50200002
         TM    PDEFLG4,GENR   IS ADDRESS GENERAL REGISTER TYPE          50300002
         BZ    TRYD           NO, TRY FLOATING POINT REGISTER           50400002
         MVI   ZERO(R1),REGSYM MOVE IN REGISTER SYMBOL                  50500002
         SPACE                                                          50600002
BUMPIT   EQU   *              BUMP POINTER AND ACCUMULATOR              50700002
         LA    R1,ONE(R1)     BUMP THE SAVE AREA POINTER                50800002
         LA    R4,ONE(R4)     BUMP THE ACCUMULATOR                      50900002
         SPACE                                                          51000002
GOIND    EQU   *              HANDLE PERCENT SIGNS                      51100002
         BAL   R11,INDIRECT   WHISTLE THROUGH PERCENT SIGNS.            51200002
         SPACE                                                          51300002
ADDRLOOP EQU   *              HANDLE ADDRESS EXPRESSION                 51400002
         OC    THIRTEEN(L3,R5),THIRTEEN(R5) IS THERE AN                 51500002
*                                EXPRESSION PDE                         51600002
         BZ    GOBACK         NO, RETURN TO CALLER                      51700002
         MVC   ZERO(L1,R1),NINE(R5) MOVE SIGN                           51800002
         L     R5,TWELVE(R5)  R5=ADDR OF NEXT EXPRESSION PDE            51900002
         L     R7,ZERO(R5)    R7=ADDR OF EXPRESSION STRING.             52000002
         LH    R6,FOUR(R5)    R6=EXPRESSION LENGTH.                     52100002
         LA    R1,ONE(R1)     BUMP SAVE POINTER.                        52200002
         LA    R4,ONE(R4)     BUMP THE ACCUMULATOR.                     52300002
         BAL   R11,ADMOVE     MOVE EXPRESSION.                          52400002
         TM    EXPFLGS5(R5),DECVAL IS VALUE DECIMAL                     52500002
         BZ    TRYIND         NO, CHECK FOR PERCENT SIGNS               52600002
         MVI   ZERO(R1),DECSYM MOVE IN SYMBOL FOR DECIMAL               52700002
         LA    R1,ONE(R1)     BUMP SAVE POINTER                         52800002
         LA    R4,ONE(R4)     BUMP THE ACCUMULATOR                      52900002
         SPACE                                                          53000002
TRYIND   EQU   *              HANDLE PERCENT SIGNS                      53100002
         BAL   R11,INDIRECT   ZING THROUGH PERCENT SIGNS.               53200002
         B     ADDRLOOP       CHECK FOR MORE EXPRESSIONS.               53300002
         SPACE                                                          53400002
ADMOVE   EQU   *              SAVE PORTION OF ADDRESS                   53500002
         LR    R8,R4          R8=TOTAL LENGTH SO FAR                    53600002
         AR    R8,R6          R8=POSSIBLE LENGTH                        53700002
         CR    R8,R9          WILL LENGTH BE TOO GREAT                  53800002
         BH    DECR           YES, DECREMENT COUNT FOR MOVE             53900002
         AR    R4,R6          BUMP THE ACCUMULATOR.                     54000002
         LTR   R6,R6          DONT DECREMENT IF SIX ZERO                54050002
         BZ    GOBACK         IF ZERO, LET'S GET OUT OF HERE            54060002
         BCTR  R6,ZERO        DECREMENT R6 FOR EXECUTE.                 54100002
         EX    R6,STRMVC      MOVE THE STRING.                          54200002
         LA    R1,ONE(R6,R1)  BUMP THE SAVE AREA POINTER.               54300002
         CR    R8,R9          IS LENGTH EQUAL TO MAXIMUM                54400002
         BE    GOBACK         YES, RETURN TO CALLER                     54500002
         BR    R11            NO, KEEP GOING                            54600002
         SPACE                                                          54700002
STRMVC   MVC   ZERO(ONE,R1),ZERO(R7) MOVE STRING EXECUTED MVC.          54800002
         SPACE                                                          54900002
INDIRECT EQU   *              CHECK FOR INDIRECT ADDRESS                55000002
         LH    R14,TEN(R5)    R14=INDIRECT COUNT.                       55100002
         LTR   R14,R14        Q.ANY COUNT SPECIFIED.                    55200002
         BCR   EIGHT,R11      NO, RETURN TO CALLER.                     55300002
         SPACE                                                          55400002
PCLOOP   EQU   *              SAVE PERCENT SIGN                         55500002
         LR    R8,R4          R8=ACCUMULATED LENGTH COUNT               55600002
         LA    R8,ONE(R8)     BUMP TEST ACCUMULATOR                     55700002
         CR    R8,R9          IS COUNT GREATER THAN MAXIMUM             55800002
         BH    GOBACK         YES, RETURN TO CALLER                     55900002
         MVI   ZERO(R1),PERCENT MOVE IN A PERCENT SIGN.                 56000002
         SPACE                                                          56100002
         LA    R1,ONE(R1)     BUMP SAVE AREA POINTER.                   56200002
         LA    R4,ONE(R4)     BUMP ACCUMULATOR.                         56300002
         BCT   R14,PCLOOP     MOVE 'EM ALL.                             56400002
         CR    R8,R9          IS COUNT EQUAL TO MAXIMUM                 56500002
         BE    GOBACK         YES, ALL THROUGH                          56600002
         BR    R11            NO, KEEP GOING                            56700002
         SPACE                                                          56800002
DECR     EQU   *              DECREMENT COUNT FOR MOVE                  56900002
         BCTR  R6,ZERO        SUBTRACT ONE                              57000002
         B     ADMOVE         TRY AGAIN                                 57100002
         SPACE                                                          57200002
GOBACK   EQU   *              STRING IS BUILT                           57300002
         LR    R0,R4          R0=TOTAL LENGTH OF STRING BUILT           57400002
         LM    R14,R15,TWELVE(R13) RESTORE R14-R15                      57500002
         LM    R2,R12,TWENTY8(R13) RESTORE R2-R12                       57600002
         BR    R14            RETURN TO CALLER                          57700002
         SPACE                                                          57800002
TRYD     EQU   *              IS ADDRESS DOUBLE PRECISION FLOATING      57900002
*                                POINT REGISTER                         58000002
         TM    PDEFLG4,DOUBLE IS FLAG ON                                58100002
         BZ    TRYE           NO, TRY SINGLE PRECISION                  58200002
         MVI   ZERO(R1),REGD  MOVE IN REGISTER SYMBOL                   58300002
         B     BUMPIT         BRANCH TO BUMP COUNTER                    58400002
         SPACE                                                          58500002
TRYE     EQU   *              IS ADDRESS SINGLE PRECISION FLOATING      58600002
*                                POINT REGISTER                         58700002
         TM    PDEFLG4,SINGLE IS FLAG ON                                58800002
         BZ    GOIND          NO, CHECK FOR PERCENT SIGNS               58900002
         MVI   ZERO(R1),REGE  MOVE IN REGISTER SYMBOL                   59000002
         B     BUMPIT         BRANCH TO BUMP COUNTER                    59100002
         SPACE                                                          59200002
         SPACE                                                          59300002
         TSTCWORK             DSECT FOR WORK AREA                       59400002
         SPACE                                                          59500002
         IKJPARMA             DSECT FOR ADDRESS PDE                     59600002
         END                                                            59700002
./  ADD  SSI=33180107,NAME=IKJEGCIV
GCIV     TITLE 'IKJEGCIV - TSO TEST - COMMAND INVOKER'                  00600002
         COPY  IKJEGSIO                                                 00600102
IKJEGCIV CSECT                                                          00600402
*C300000                                                        YA01840 00602402
*A300500                                                        YA01840 00604402
         EJECT                                                          00606402
*********************************************************************** 00610002
*                                                                     * 00620002
* STATUS --                                                           * 00630002
*    CHANGE LEVEL 00, VERSION 02, VS2   02/28/73                      * 00640002
*                                                                     * 00642002
* FUNCTION --                                                         * 00644002
*                                                                     * 00646002
*    THIS SERVICE ROUTINE OF TEST PERFORMS A BLDL ON THE COMMAND      * 00696002
*    SPECIFIED TO DETERMINE IF THE COMMAND EXISTS.  IF THE COMMAND    * 00706002
*    EXISTS, IT IS ATTACHED AS A SUBTASK OF TEST.  CIV WAITS FOR      * 00716002
*    THE COMMAND TO COMPLETE.  IT THEN UNALLOCATES ALL DATA SETS      * 00718002
*    GOTTEN BY THE COMMAND AND DETACHS THE SUBTASK.                   * 00720002
*                                                                     * 00741902
* ENTRY POINTS --                                                     * 00743902
*         IKJEGCIV    ENTERED FROM IKJEGMNL                           * 00745902
*                                                                     * 00749102
* INPUT -- A POINTER TO TCOMTAB, THE COMMUNICATION TABLE, IS EXPECTED * 00749502
*    IN REGISTER 9  ALL INFORMATION NEEDED CAN BE ACCESSED IN TCOMTAB.* 00749602
*    THE ECT CONTAINS THE NAME OF THE SUBCOMMAND TO BE ATTACHED.      * 00749702
*                                                                     * 00749802
* OUTPUT -- DIAGNOSTIC MESSAGES ON CERTAIN ERRORS.                    * 00749902
*                                                                     * 00829802
* EXTERNAL REFERENCES --                                              * 00839802
*         IKJDAIR IS INVOKED VIA A LINK MACRO INSTRUCTION TO          * 00841802
*         UNALLOCATE ALL DATA SETS ALLOCATED BY THE SUBTASK.          * 00843802
*                                                                     * 00845802
*         IKJEGIO IS INVOKED VIA IKJEGSIO MACRO TO PUT ERROR          * 00847802
*         MESSAGES TO THE TERMINAL USER.                              * 00847902
*                                                                     * 00848202
*         ESTAE IS CALLED TO ESTABLISH AN ABNORMAL TERMINATION EXIT.  * 00848602
*                                                                     * 00849402
*         FREEMAIN IS CALLED TO FREE CORE USED FOR A TERMINAL         * 00852202
*         INPUT BUFFER.                                               * 00854202
*                                                                     * 00855202
*         BLDL IS CALLED TO DETERMINE IF THE COMMAND SPECIFIED        * 00855602
*         IS VALID.                                                   * 00856002
*                                                                     * 00857202
*         ATTACH IS CALLED TO CREATE THE SUBTASK TO PROCESS THE       * 00857302
*         COMMAND.                                                    * 00857402
*                                                                     * 00862402
*         WAIT IS CALLED TO WAIT ON NOTIFICATION THAT ONE OR MORE     * 00862802
*         EVENTS HAS COMPLETED.                                       * 00863202
*                                                                     * 00864402
*         DETACH IS CALLED TO TERMINATE THE SUBTASK CREATED TO        * 00864802
*         PROCESS THE COMMAND.                                        * 00865202
*                                                                     * 00866402
* EXITS, NORMAL -- NORMAL EXIT IS BACK TO IKJEGMNL.                   * 00868402
*         RETURN IS ACCOMPLISHED VIA AN SVC 3 INSTRUCTION             * 00870402
*         WHICH IS POINTED TO BY R14.                                 * 00872402
*          RETURN CODES ARE:                                          * 00874402
*           0-IKJEGCIV COMPLETED NORMALLY                             * 00874802
*          16-ATTENTION HAS BEEN SCHEDULED                            * 00875202
*                                                                     * 00876402
* EXITS, ERROR -- ERROR EXIT IS BACK TO IKJEGMNL                      * 00878402
*          RETURN IS ACCOMPLISHED VIA AN SVC 3 INSTRUCTION            * 00878802
*          WHICH IS POINTED TO BY R14.                                * 00879202
*           RETURN CODES ARE:                                         * 00879602
*           20-ESTAE RETRY ROUTINE WAS ENTERED                        * 00880002
*           24-ESTAE MACRO ERROR                                      * 00880102
*                                                                     * 00880402
* TABLES/WORK AREAS --                                                * 00882402
*    THE WORKAREA POINTED TO IN TCOMTAB IS USED FOR ALL TEMPORARY     * 00888802
*    STORAGE                                                          * 00890802
*                                                                     * 00892802
* ATTRIBUTES --                                                       * 00893202
*    REFRESHABLE AND REENTRANT                                        * 00893602
*                                                                     * 00894002
* CHARACTER CODE DEPENDENCY --                                        * 00894102
*    REASSEMBLY MAY BE NEEDED FOR CHANGE OF CODE                      * 00894202
* NOTES --                                                            * 00894302
*    R12 IS BASE REG                                                  * 00944302
*********************************************************************** 00984302
R0       EQU   0                                                        01044302
R1       EQU   1                                                        01200002
R2       EQU   2                                                        01500002
R3       EQU   3                                                        01800002
R4       EQU   4                                                        02100002
R5       EQU   5                                                        02400002
R6       EQU   6                                                        02700002
R7       EQU   7                                                        03000002
R8       EQU   8                                                        03300002
R9       EQU   9                                                        03600002
R10      EQU   10                                                       03900002
R11      EQU   11                                                       04200002
R12      EQU   12                                                       04500002
R13      EQU   13                                                       04800002
R14      EQU   14                                                       05100002
R15      EQU   15                                                       05400002
X0       EQU   0              VALUE = 0.                                05450002
X1       EQU   1              VALUE = 1.                                05500002
X2       EQU   2              VALUE = 2.                                05550002
X3       EQU   3              VALUE = 3.                                05600002
X4       EQU   4              VALUE = 4.                                05650002
X5       EQU   5              VALUE = 5.                                05660002
X7       EQU   7              VALUE = 7.                                05670002
X8       EQU   8              VALUE = 8.                                05680002
X12      EQU   12             VALUE = 12.                               05690002
X16      EQU   16             VALUE = 16.                               05692002
XFF      EQU   X'FF'          MASK X'FF'                                05692102
CVTPTR   EQU   16             ADDRESS OF CVT POINTER                    05692402
CIVSP078 EQU   78             SUBPOOL 78 ID                             05692802
CIVENDL  EQU   X'80'          END OF LIST INDICATOR FOR WAIT.           05693202
CIVTSTAT EQU   X'48'          POST CODE FROM TEST ATTENTION EXIT.       05693602
CIVWAIT  EQU   X'80'          ECB FLAG - AWAITING COMPLETION            05693702
CIVPOST  EQU   X'40'          POST CODE FROM STOP/MODIFY.               05693802
CIVRC016 EQU   16             RETURN CODE 16.                           05693902
CIVRC020 EQU   20             RETURN CODE 20.                           05694702
CIVRC028 EQU   28             RETURN CODE 28.                           05695102
N28      EQU   28             DISPLACEMENT IN SAVE AREA TO R2           05695502
CIVBLANK EQU   C' '           CHARACTER BLANK.                          05696502
CIVCZERO EQU   C'0'           CHARACTER ZERO.                           05697302
CIVZONE  EQU   X'0F'          PRINTABLE ZONE IN PACKED DECIMAL          05698102
M0269    EQU   269           MESSAGE NUMBER M0269                       05698502
M0270    EQU   270           MESSAGE NUMBER M0270                       05698902
I0041    EQU   41            INSERT NUMBER 41                           05699302
I0042    EQU   42            INSERT NUMBER 42                           05699702
RC24     EQU   24            RETURN CODE 24                             05699802
         EJECT                                                          05700002
         SAVE  (14,12),,*     SAVE ENTRY REGISTERS.                     06000002
         LR    R12,R15        ESTABLISH A BASE REGISTER FOR THIS        06300002
         USING IKJEGCIV,R12   MODULE.                                   06600002
         USING TCOMTAB,R9     ESTABLISH ADDRESSABILITY TO TCOMTAB       06900002
         L     R15,REGSAVE2   ADDRESS OF AVAILABLE SAVE AREA.           07200002
         ST    R13,X4(,R15)   CROSS-CHAIN CURRENT AND PREVIOUS          07500002
         ST    R15,X8(,R13)   SAVE AREAS.                               07800002
         LR    R13,R15        PUT SAVE AREA ADDRESS IN STANDARD         08100002
*                             REGISTER.                                 08400002
         SPACE 5                                                        08700002
CIV01010 EQU   *                                                        09000002
         L     R10,WORKAREA   ADDRESS OF GENERAL TEST WORKAREA.         09300002
         USING TSTCWORK,R10   ESTABLISH ADDRESSABILITY TO               09600002
*                             WORKAREA.                                 09900002
         LA    R10,CWORKCMD   ADDRESS OF SUBCOMMAND PORTION OF          10200002
*                             WORKAREA.                                 10500002
         DROP  R10                                                      10800002
         USING CIVWORKA,R10   ESTABLISH ADDRESSABILITY TO THE           11100002
*                             COMMAND INVOKER'S WORKAREA.               11400002
         SPACE 5                                                        11700002
         MVI   CIVFLGS,X0     CLEAR FLAG BYTE                           11750002
         XC    CIVSTAE,CIVSTAE CLEAR ESTAE PARM LIST                    11800002
         L     R15,TSTSTAE   R15=ADDR OF ESTAE EXIT ROUTINE             11810002
         ESTAE (R15),CT,PARAM=CIVSPL,XCTL=NO,RECORD=YES,               *11850002
               MF=(E,CIVSTAE) ESTABLISH ESTAE EXIT                      11900002
         LTR   R15,R15        TEST FOR SUCCESSFUL COMPLETION.           13500002
         BZ    CIV02010       RETURN CODE = 0, BRANCH TO FREE           13800002
*                             AND EXCHANGE BUFFERS.                     14100002
         STC   R15,TSTESTRC  SAVE ESTAE RETURN CODE                     14150002
         LA    R15,RC24      SET RETURN CODE TO 24                      14200002
         B     CIV07030      RETURN TO MAINLINE                         14250002
         SPACE 3                                                        14300002
IORC1    EQU   *                                                        14650002
         CH    R15,ATTNCODE  IS RC=16,20,24                             14700002
         BNL   CIV07030      YES,RETURN WITH RC                         14750002
         B     CIV07010      ZERO RC AND RETURN                         14900002
         EJECT                                                          16200002
* FREE COMMAND BUFFER                                                   16250002
CIV02010 EQU   *                                                        16500002
         L     R11,TPLPTR     ADDRESS OF TPL.                           16800002
         USING TPL,R11        ESTABLISH ADDRESSABILITY TO TPL.          17100002
         L     R1,TPLCBUF     ADDRESS OF COMMAND BUFFER.                17400002
         LH    R0,X0(,R1)     LENGTH OF COMMAND BUFFER.                 17700002
         LTR   R0,R0          DETERMINE IF LENGTH IS ZERO.              18000002
         BZ    CIV03010       IF ZERO, NOTHING TO BE FREED.             18300002
         FREEMAIN RC,LV=(0),A=(1),SP=1 FREE COMMAND BUFFER.             18900002
         LTR   R15,R15       WAS FREEMAIN SUCCESSFUL?                   18950002
         BZ    CIV03010      YES,CONTINUE                               19000002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM LIST         19050002
* ISSUE 'FREEMAIN SVC ERROR' MESSAGE                                    19100002
         IKJEGSIO SVCERR,SVC=120,RC=(R15),ID=CIV07,MF=(E,TSTIOPRM)      19150002
* IGNORE IO RETURN CODES AND CONTINUE                                   19160002
         SPACE 5                                                        19200002
* SUBSTITUTE @ INBUF IN TPL                                             19250002
CIV03010 EQU   *                                                        19500002
         MVC   TPLCBUF(L'TPLCBUF),INBUF PLACE BUFFER ADDRESS IN         19800002
*                             TPL.                                      20100002
         XC    INBUF(L'INBUF),INBUF SHOW NO SUBCOMMAND BUFFER TO        20400002
*                             BE FREED.                                 20700002
         L     R2,TPLECT      ADDRESS OF ECT.                           21000002
         USING ECT,R2         ESTABLISH ADDRESSABILITY TO ECT.          21300002
         MVC   CIVBLDLC(L'ECTSCMD),ECTSCMD MOVE COMMAND INTO            21600002
*                             BLDL LIST.                                21900002
         MVC   CIVBLDLH(L'CIVBLDLH),CIVBLDLW INITIALIZE LENGTH OF       22200002
*                             AND NUMBER OF ENTRIES IN BLDL LIST.       22500002
         BLDL  0,CIVBLDLH     DETERMINE IF COMMAND IS VALID.            22800002
         LTR   R15,R15        FOR RETURN CODE = 0, BRANCH TO            23100002
         BZ    CIV04010       ATTACH COMMAND.                           23400002
*                                                                       23700002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO APRM LIST         23750002
* ISSUE 'COMMAND NOT FOUND' MESSAGE                                     23800002
         IKJEGSIO MSG,FIRST=M0067,ID=CIV07,MF=(E,TSTIOPRM)              23850002
         B     IORC1         TEST IO RC'S                               23900002
         EJECT                                                          25200002
* ATTACH NEW SUBTASK                                                    25250002
CIV04010 EQU   *                                                        25500002
         MVC   CIVECTCM(L'CIVECTCM),ECTPCMD SAVE PROBLEM PROGRAM        25800002
         MVC   ECTPCMD(L'ECTPCMD),CIVCTEST NAME AND SUBSTITUTE          26100002
*                             WITH TEST.                                26400002
         L     R3,ECBTERM     OBTAIN ADDRESS OF TERMINATION ECB         26700002
         LA    R5,ECTSCMD     ADDRESS OF COMMAND PROCESSOR NAME.        27000002
         XC    X0(X4,R3),X0(R3) AND ZERO IT.                            27300002
         MVC   CIVATCHL(CIVATTLN),CIVATTCH INITIALIZE ATTACH            27600002
*                             PARAMETER LIST.                           27900002
         LA    R15,CIVATCHL   ADDRESS OF SUPERVISOR PARAMETERS.         28200002
         MVC   CIVCPPL(CIVECT+L'CIVECT-CIVBUF),TPLCBUF BUILD            28500002
         LA    R1,CIVCPPL     TMP-LIKE PARAMETER LIST.                  28800002
         LA    R4,CIVSTAIX    ADDRESS OF STAI EXIT FOR NEW              29100002
*                             SUBTASK.                                  29400002
         LA    R15,CIVATCHL   ADDRESS OF COMMAND TO BE ATTACHED.        29700002
         ATTACH EPLOC=(R5),ECB=(R3),STAI=((R4)),MF=(E,(1)),     YA01840*30000002
               SF=(E,(15))                                      YA01840 30050002
         LTR   R15,R15        TEST FOR SUCCESSFUL COMPLETION.           30300002
         BZ    CIV04030       RETURN CODE = 0, BRANCH TO SAVE           30600002
*                             TCB ADDRESS.                              30900002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM LIST         32400002
* ISSUE 'INSUFFICIENT CORE' MESSAGE                                     32450002
         IKJEGSIO MSG,FIRST=M0103,ID=CIV07,MF=(E,TSTIOPRM)              32500002
         B     IORC1         TEST IO RETURN CODES AND EXIT              32550002
         SPACE 5                                                        32700002
CIV04030 EQU   *                                                        33000002
         ST    R1,TSTHTCB     SAVE TCB ADDRESS FOR DETACH.              33300002
         OI    TSTFLGS3,TSTHELP INDICATE THAT A SUBTASK EXISTS.         33600002
         MVI   ECBLOG,CIVENDL INDICATE END OF ECB LIST.                 33900002
         WAIT  ECBLIST=ECBTERM WAIT ON COMMAND PROCESSOR TO            &34200002
                              COMPLETE.                                 34500002
         SPACE 5                                                        34800002
         MVC   CIVDAP2C(CIV2CLEN),CIV2CBLK INITIALIZE DAIR              35100002
         MVC   CIVDAP2C+DA2CTCB-DAPB2C(L'DA2CTCB),TSTHTCB PARAMETER     35400002
*                             BLOCK.                                    35700002
         MVC   CIVDAPL(DAPLPSCB-DAPL),PARMLIST INITIALIZE DAIR          36000002
         L     R0,TPLPSCB     PARAMETER LIST.                           36300002
         LA    R1,CIVDAP2C                                              36600002
         STM   R0,R1,CIVDPSCB                                           36900002
         LA    R1,CIVDAPL     ADDRESS OF DAIR PARAMETER LIST.           37200002
         LINK  EP=IKJDAIR,MF=(E,(1)),ERRET=DAIRFAIL INVOKE DAIR TO     *37500002
                              UNALLOCATE TCB'S                          37800002
         LTR   R0,R15         LOAD R0 WITH RETURN CODE AND TEST         38100002
         BZ    CIV05010       IF DAIR WAS SUCCESSFUL, DETACH SUBTASK.   38400002
         LA    R1,CIVDAPL    GET ADDRESS OF DAPL                        38450002
         ST    R1,DFDAPLP    STORE IT IN DAPL POINTER                   38500002
         LA    R1,DFRC       GET ADDRESS OF DAIR RC AREA                38550002
         ST    R1,DFRCP      STORE IT IN DAIR RC POINTER                38600002
         ST    R15,DFRC      STORE DAIR RETURN CODE                     38650002
         LA    R1,DFMWEA     GET ADDRESS OF MESSAGE WRITER AREA         38700002
         ST    R1,DFMWEAP    STORE IT IN MESSAGE WRITER POINTER         38750002
         XC    DFMWEA,DFMWEA ZEROS MEANS NO MESSAGE WRITER              38800002
         LA    R1,DFCID      GET ADDRESS OF CALLER ID NO.               38850002
         ST    R1,DFCIDP     STORE IT IN CALLER ID NO. PTR              38900002
         LA    R1,X1         R1=F'1' CALLER ID NUMBER                   38950002
         STH   R1,DFCID      STORE CALLER ID NUMBER                     39000002
         LA    R1,DFDAPLP    R1=ADDRESS OF DAIR FAIL PARM LIST          39050002
* INVOKE DAIR FAIL ERROR HANDLER                                        39060002
         LINK  EP=IKJEFF18,MF=(E,(1)),ERRET=JEFFAIL                     39100002
* IGNORE RETURN CODES AND CONTINUE                                      39150002
         EJECT                                                          40200002
CIV05010 EQU   *                                                        40500002
         LA    R1,TSTHTCB     ADDRESS OF TCB POINTER TO BE DETACHED.    40800002
         OI    CIVFLGS,CIVDTACH  INDICATE DETACH IN PROGRESS.           41100002
*                             IF THE SUBTASK TERMINATED BEFORE IT       41150002
*                             WAS COMPLETE, THE DETACH WILL ABEND.      41200002
*                             IF THIS HAPPENS, THE STAE RETRY           41250002
*                             WILL REINSTATE THE STAE AND               41300002
*                             RESTART FOLLOWING THE DETACH.             41350002
         DETACH (1),STAE=YES  DETACH SUBTASK.                           41400002
BLOW1    EQU   *              POSSIBLE ABEND HERE                       41410002
CIV05020 NI    CIVFLGS,XFF-CIVDTACH    TURN OFF DETACH FLG              41450002
         SPACE 5                                                        41700002
*                                                                       42000002
*        DETERMINE TYPE OF SUB-TASK TERMINATION.                        42300002
*                                                                       42600002
         NI    TSTFLGS3,XFF-TSTHELP INDICATE THAT SUBTASK DETACHED.     42900002
         L     R1,ECBTMPA     ADDRESS OF ATTENTION ECB.                 43200002
         TM    X0(R1),CIVTSTAT DETERMINE IF TEST OR TMP POSTED          43500002
*                             ATTENTION ECB.                            43800002
         BNZ   CIV06010       IF ECB POSTED, BRANCH TO RETURN TO        44100002
*                             IKJEGMNL WITH ATTENTION RETURN CODE.      44400002
         SPACE 5                                                        44700002
         L     R1,ECBTERM    R1=ADDR OF ECB                             44750002
         OC    X1(X2,R1),X1(R1) DID MODULE ABEND                        44800002
         BZ    CIV05030      NO,CHECK FOR STOP/MODIFY                   44850002
         L     R4,OUTBUF     R4=ADDR OF OUTPUT BUFFER                   44900002
         MVC   X0(X4,R4),CMDLCON MOVE INSERT LENGTH TO OUTBUF           44950002
         MVC   X4(L'ECTPCMD,R4),ECTPCMD MOVE IN COMMAND NAME            45000002
         LR    R3,R4         R3=ADDR OF OUTBUF                          45050002
         AH    R3,CMDLCON    R3=ADDR OF OUTBUF+12                       45100002
         MVC   X0(X4,R3),INSTLCON MOVE INSERT LENGTH TO OUTBUF          45150002
         L     R5,X0(R1)     PUT ECB INTO R5                            45200002
         LA    R5,X0(R5)     CLEAR HIGH ORDER BYTE                      45250002
         LR    R6,R5         SAVE R5 FOR DESTRUCTIVE TEST               45300002
         N     R5,CIVSYSCD   WAS IT USER COMPLETION CODE                45350002
         BZ    CIV05170      YES,GO PROCESS IT                          45400002
         SRL   R6,X16        SHIFT SYS COMPLETION CODE                  45450002
         STH   R6,X4(R3)     STORE IT IN INSERT AREA                    45500002
         LA    R6,M0269      R6=MESSAGE NUMBER                          45550002
         B     CIV05180      GO OUTPUT MESSAGE                          45600002
CIV05170 EQU   *                                                        45650002
         STH   R5,X4(R3)     STORE COMPLETION CODE IN INSERT            45700002
         LA    R6,M0270      R6=MESSAGE NUMBER                          45750002
CIV05180 EQU   *                                                        45800002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM LIST         45850002
* ISSUE 'MODULE ENDED DUE TO ERROR' MESSAGE                             45900002
* ISSUE 'ABEND CODE IS' MESSAGE                                         45950002
         IKJEGSIO MSG,FIRST=M0068,INST11=(ADDR,(R4)),SECOND=(R6),      *46000002
               INST21=(ADDRCONX,(R3)),ID=CIV07,MF=(E,TSTIOPRM)          46050002
         B     IORC1         TEST IO RC'S                               46100002
         SPACE 5                                                        48300002
CIV05030 EQU   *                                                        48600002
         L     R1,ECBLOG      ADDRESS OF STOP/MODIFY ECB.               48900002
         TM    X0(R1),CIVPOST IS ECB POSTED.                            49200002
         BZ    CIV07010       IF NOT POSTED, BRANCH TO EXIT.            49500002
         LA    R15,CIVRC028   LOAD LOGOFF RETURN CODE.                  49800002
         B     CIV07030       BRANCH TO EXIT.                           50100002
         SPACE 5                                                        50400002
CIV06010 EQU   *                                                        50700002
         LA    R15,CIVRC016   LOAD ATTENTION RETURN CODE.               51000002
         B     CIV07030       BRANCH TO EXIT.                           51900002
         SPACE 5                                                        52200002
CIV07010 EQU   *                                                        52500002
         SR    R15,R15        LOAD COMPLETION RETURN CODE.              52800002
CIV07030 EQU   *                                                        53100002
         L     R1,ECBTERM     ZERO TERMINATION                          53150002
         XC    X0(X4,R1),X0(R1)        ECB                              53200002
         MVC   ECTPCMD(L'ECTPCMD),CIVECTCM RESTORE PROBLEM              53400002
*                             PROGRAM NAME TO ECT.                      53700002
         LR    R2,R15        SAVE RETURN CODE                           53710002
         ESTAE 0             REMOVE ESTAE                               53750002
         LR    R15,R2        RESET RETURN CODE                          53760002
         NI    TSTFLGS4,XFF-TSTRERTN TURN OFF RETRY BIT                 53800002
         L     R13,X4(,R13)   RESTORE HIGHER SAVE AREA ADDRESS.         54000002
         RETURN (14,12),,RC=(15) RETURN.                                54300002
         EJECT                                                          56400002
*                                                                       56410002
* ERRET'S FOR LINKS                                                     56420002
*                                                                       56430002
DAIRFAIL EQU   *             LINK TO IKJDAIR ERRET                      56440002
         LA    R3,I0041      INSERT MODULE NAME IKJDAIR                 56442002
         B     JEFFAIL1      GO ISSUE MESSAGE                           56444002
JEFFAIL  EQU   *             LINK TO IKJEFF18 ERRET                     56446002
         LA    R3,I0042      INSERT MODULE NAME IKJEFF18                56448002
JEFFAIL1 EQU   *                                                        56448402
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM LIST         56448802
         LR    R0,R1         LOAD ABEND CODE INTO R0                    56448902
* ISSUE 'LINK TO MODULE NAME SVC ERROR' MESSAGE                         56449202
         IKJEGSIO SVCERR,SVC=6,ABENDRG=(R0),RC=(R15),INST11=(NUM,(R3)),*56449602
               ID=CIV07,MF=(E,TSTIOPRM)                                 56449802
         C     R15,ATTNCODE  IS RETURN CODE 16,20 OR 24?                56449902
         BL    CIV05010      NO,CONTINUE AFTER DAIR LINKS               56450002
         B     CIV07030      YES, SEND RETURN CODE TO MAINLINE          56499902
         EJECT                                                          56509902
* STAI EXIT FOR SUBTASK                                                 56549902
CIVSTAIX EQU   *                                                        56700002
         LA    R15,CIVRC016   SET STAI RETURN CODE TO INDICATE          57000002
*                             CONTINUATION OF ABEND PROCESSING          57300002
*                             FOR SUBTASK.                              57600002
         BR    R14            RETURN TO ABEND.                          57900002
         EJECT                                                          58200002
* ESTAE RETRY ROUTINE                                                   58250002
CIVSTAEX EQU   *                                                        58500002
         USING *,R15          ESTABLISH ADDRESSABILITY                  58550002
         L     R12,BASEAD     *                                         58600002
         DROP  R15            *                                         58650002
         L     R9,CVTPTR      CVTPTR                                    58700002
         L     R9,X0(R9)      NEW/CURRENT WORDS.                        58750002
         L     R9,X4(,R9)     CURRENT TCB.                              58760002
         L     R9,TCBTRN-TCB(R9)  TCOMTAB ADDRESS.                      58770002
         L     R13,REGSAVE2   RESET R13                                 58780002
         LM    R2,R11,N28(R13) RESTORE REGISTERS                        58782002
*                                                                       58784002
         TM    CIVFLGS,CIVDTACH DID DETACH FAIL?                        58790002
         BZ    CIVSTAE2       NO. SET R.C. AND EXIT                     58792002
         SPACE 1                                                        58794002
CIVSTAE1 EQU   *                                                        58799202
         XC    CIVSTAE,CIVSTAE CLEAR ESTAE PARM LIST                    58849202
         L     R15,TSTSTAE   R15=ADDR OF ESTAE EXIT ROUTINE             58851202
         ESTAE (R15),OV,PARAM=CIVSPL,XCTL=NO,RECORD=YES,               *58859202
               MF=(E,CIVSTAE) REISSUE ESTAE                             58859602
         LTR   R15,R15       WAS ESTAE SUCCESSFUL?                      58859702
         BNZ   CIVSTAE2      NO, SET RETURN CODE AND EXIT               58859802
         NI    TSTFLGS4,XFF-TSTRERTN TURN OFF RETRY BIT                 58873102
         B     CIV05020      CONTINUE AFTER DETACH                      58883102
         SPACE 1                                                        58886602
CIVSTAE2 LA    R15,CIVRC020   SET ESTAE RETURN CODE.                    58899902
         B     CIV07030       BRANCH TO EXIT.                           59100002
         EJECT                                                          59400002
*                                                                       59700002
*        CONSTANTS AND AREAS.                                           60000002
*                                                                       60300002
CIVBLDLW DS    0F             ALIGN ON WORD BOUNDARY.                   62100002
         DC    AL2(1)         NUMBER OF ENTRIES IN LIST.                62400002
         DC    AL2(12)        LENGTH OF EACH ENTRY IN LIST.             62700002
CIVCTEST DC    CL8'TEST'      TEST COMMAND NAME.                        63000002
ATTNCODE DC    H'16'         ATTENTION RETURN CODE                      63010002
CMDLCON  DS    0F            LENGTH OF MODULE NAME INSERT               63030002
         DC    H'12'                                                    63040002
         DC    H'00'                                                    63042002
INSTLCON DS    0F            LENGTH OF COMPLETION CODE INSERT           63044002
         DC    H'6'                                                     63046002
         DC    H'00'                                                    63048002
CIVSPL   IKJEGSPL RTRY=CIVSTAEX,ABNTB=ICTAB,MODNM=IKJEGCIV,TNM=CIV      63048402
         SPACE 1                                                        63050002
CIVATTCH ATTACH DCB=0,SHSPV=CIVSP078,SZERO=NO,SF=L ATTACH              &63300002
                              PARAMETER LIST.                           63600002
CIVATTLN EQU   *-CIVATTCH     PARAMETER LIST LENGTH.                    63900002
         SPACE 1                                                  MSGYM 63902002
         SPACE 1                                                        63904002
CIVSYSCD DC    XL4'00FFF000'  MASK USED TO DETERMINE IF A USER          63949702
*                             ABEND OCCURRED.                           63949802
         SPACE 1                                                        63949902
CIVTRTAB DC    C'0123456789ABCDEF' TRANSLATE TABLE.                     63966602
         SPACE 1                                                        63983302
BASEAD   DC    A(IKJEGCIV)    ENTRY POINT ADDR FOR ADDR'BILITY          64000002
         SPACE 1                                                        64060002
ICTAB    DC    A(BLOW1)       IC TABLE FOR IKJEGSTA                     64070002
         DC    X'FF'          * END OF TABLE                            64080002
         EJECT                                                          64200002
         IKJDAP2C                                                       64500002
CIV2CLEN EQU   *-DAPB2C       PARAMETER BLOCK LENGTH.                   64800002
IKJEGCIV CSECT                                                          65100002
CIV2CBLK DC    XL16'0'        INITIALIZE BLOCK TO ZERO.                 65400002
         ORG   DA2CCD-DAPB2C+CIV2CBLK ORIGIN TO ENTRY CODE.             65700002
         DC    XL2'002C'      ENTRY CODE.                               66000002
         ORG   ,              ORIGIN TO END OF CONSTANTS.               66300002
         EJECT                                                          70599902
         TCOMTAB                                                        70800002
         EJECT                                                          71100002
         TSTCWORK                                                       71400002
         SPACE 2                                                        71410002
*********************************************************************** 71450002
*                                                                     * 71500002
*        COMMAND INVOKER WORK AREA DUMMY SECTION                      * 71550002
*                                                                     * 71600002
*********************************************************************** 71650002
         SPACE 2                                                        71660002
CIVWORKA DSECT                                                          71670002
CIVSTAE  DS    CL16           ESTAE PARAMETER LIST.                     71680002
CIVBLDLH DS    F              BLDL LIST CONTROL WORD.                   71690002
CIVBLDLC DS    CL12           MEMBER NAME TO BE SEARCHED FOR.           71692002
CIVECTCM DS    CL8            SAVE AREA FOR COMMAND NAME FROM ECT       71694002
CIVFLGS  DS    X              FLAG BYTE                                 71696002
CIVDTACH EQU   X'80'          FLAG TO INDICATE DETACH TO STAE RETRY     71698002
CIVCONT  EQU   X'40'          FLAG TO INDICATE CONTINUED PROCESSING     71698402
CIVATCHL DS    15F            SUPERVISOR PARAMETER LIST - ATTACH.       71698802
CIVCPPL  DS    0F             DUMMY COMMAND PARAMETER LIST.             71699202
CIVBUF   DS    F              ADDRESS OF INPUT BUFFER.                  71699602
CIVUPT   DS    F              ADDRESS OF UPT.                           71699702
CIVPSCB  DS    F              ADDRESS OF PSCB.                          71699802
CIVECT   DS    F              ADDRESS OF ECT.                           71699902
CIVDAP2C DS    4F             PARAMETER BLOCK FOR IKJDAIR.              71749902
         ORG   CIVATCHL       RE-ORIGIN TO OVERLAY WORK AREA.           71759902
CIVDAPL  DS    0F             PARAMETER LIST FOR IKJDAIR.               71769902
CIVDUPT  DS    F              ADDRESS OF UPT.                           71779902
CIVDECT  DS    F              ADDRESS OF ECT.                           71789902
CIVDECB  DS    F              ADDRESS OF ECB.                           71791902
CIVDPSCB DS    F              ADDRESS OF PSCB.                          71793902
CIVDAPB  DS    F              ADDRESS OF DAIR PARAMETER BLOCK.          71795902
CIVCCODE DS    D              BINARY TO DECIMAL CONVERSION AREA.        71797902
CIVMTEXT DS    F              COMPLETION CODE FOR MESSAGE.              71798302
DFDAPLP  DS    F             DAIR PARM LIST POINTER                     71798702
DFRCP    DS    F             DAIR RETURN CODE POINTER                   71799102
DFMWEAP  DS    F             MESSAGE WRITER POINTER                     71799502
DFCIDP   DS    F             CALLER ID POINTER                          71799602
DFRSVRD  DS    F             RESERVED                                   71799702
DFRC     DS    F             DAIR RETURN CODE                           71799802
DFMWEA   DS    F             MESSAGE WRITER ADDRESS=ZEROS               71849802
DFCID    DS    H             CALLID NUMBER=1                            71859802
         EJECT                                                          71899802
         IKJTPL                                                         72000002
         EJECT                                                          72300002
         IKJECT                                                         72600002
         EJECT                                                          72900002
         IKJDAPL                                                        73200002
         EJECT                                                          73500002
         IKJTCB                                                         73510002
         EJECT                                                          73550002
IKJEGCIV CSECT                                                          81200002
         DS    0F            FORCE FULLWORD ALIGNMENT                   81250002
CIVPATCH DC    50C'Z'        PATCH AREA                                 81260002
         END   IKJEGCIV                                                 81300002
./  ADD  SSI=81730761,NAME=IKJEGCPY
         TITLE  'IKJEGCPY -- COPY SUBCOMMAND FOR TSO/TEST'              00100002
* A 326000,366000                                            @ZA10462   00150000
*********************************************************************** 00200002
*                                                                       00300002
* STATUS --                                                             00400002
*    CHANGE LEVEL 000, VERSION 02, OS/VS2                               00500002
*                                                                       00600002
* FUNCTION --                                                           00700002
*    THIS SUBCOMMAND OF TEST RECEIVES CONTROL FROM TEST'S MAINLINE      00800002
*    MODULE(IKJEGMNL) VIA A LINK.                                       00900002
*    IT COPIES FROM STORAGE TO STORAGE , STORAGE TO REGISTERS,          01000002
*    REGISTERS TO STORAGE, AND ALSO FROM REGISTERS TO REGISTERS.        01100002
*    IT HAS AN ADDITIONAL FUNCTION OF OBTAINING POINTERS.               01200002
*    COPY HAS 2 POSITIONAL OPERANDS AND 3 KEYWORDS(LENGTH,POINTER,      01300002
*    AND NOPOINT).                                                      01400002
*    THE POINTER KEYWORD CHANGES THE MEANING OF THE FROM POSITIONAL.    01500002
*    EITHER SPECIFY --                                                  01600002
*    COPY  ADDRESS1  ADDRESS2                                           01700002
*    COPY  ADDRESS1  ADDRESS2  LENGTH(DECIMAL)                          01800002
*    COPY  ADDRESS1  ADDRESS2  POINTER                                  01900002
*    COPY  ADDRESS1  ADDRESS2  LENGTH(DECIMAL)  POINTER                 02000002
*    ADDRESS1 MAY BE AN ADDRESS OR GENERAL REGISTER.                    02100002
*    BUT, IF POINTER IS SPECIFIED IT CANNOT BE GENERAL REGISTER.        02200002
*    ADDRESS2 MAY BE AN ADDRESS OR GENERAL REGISTER.                    02300002
*    EXAMPLES OF COPY FOLLOW --                                         02400002
*    COPY  10.%%%+88%  A06A0.  L(512)                                   02500002
*    RELOCATING A TCB TO KEYED(OR GOTTEN) CORE.                         02600002
*    COPY  80680.  80681.  L(79)                                        02700002
*    PROPIGATION OF 1 BYTE THRU A BUFFER.                               02800002
*    COPY  80680.  80682.  L(44)                                        02900002
*    MOVING SOME INSTRUCTIONS AROUND. THESE FIELDS OVERLAP BUT          03000002
*    THE COPY IS DONE BACKWARDS TO AVOID PROPIGATION.                   03100002
*    COPY  0R  A0200.  L(64)                                            03200002
*    SAVING ALL REGISTERS FOR A LATER LOAD. ANY LENGTH ABOVE            03300002
*    64 WILL DEFAULT TO 64.                                             03400002
*    COPY  13R%+12N  14R  L(60)                                         03500002
*    EQUIVALENT TO A LOAD MULTIPLE FROM A SAVE AREA.                    03600002
*    COPY  15R  0R  L(8)                                                03700002
*    CONTENTS OF 15 AND 0 TO 0 AND 1                                    03800002
*    COPY  A  3R                                                        03900002
*    COPY FROM LOCATION A TO REGISTER 3 WITH A DEFAULT LENGTH OF 4      04000002
*    COPY  10.%  3R  P                                                  04100002
*    PLACES THE CVT ADDRESS INTO REGISTER 3 ZEROING THE HIGH BYTE.      04200002
*    COPY  10.  3R                                                      04300002
*    THIS WILL DO THE SAME AS ABOVE WITHOUT THE HIGH BYTE ZEROED.       04400002
*    COPY  80.  1R  L(1)  P                                             04500002
*    THIS WILL PUT A X'80' INTO THE HIGH BYTE OF R1,LOW 3 REMAIN.       04600002
*    COPY  40.  A  L(1)  P                                              04700002
*    THIS WILL PUT A BLANK AT LOCATION 'A'                              04800002
*    COPY  A  A+1  L(79)                                                04900002
*    THIS WILL PROPIGATE THE ABOVE BLANK THRU A BUFFER.                 05000002
*    COPY  IEFBR14.IEFBR14  15R  P                                      05100002
*    THIS WILL PLACE THE ENTRY POINT OF IEFBR14 INTO R15.               05200002
*    COPY  6B000.  A+1  L(3)  P                                         05300002
*    A+1 WILL NOW CONTAIN THE 3 BYTE ADDRESS X'06B000'                  05400002
*    COPY  0.  0R  L(8)                                                 05500002
*    THIS WILL NOT ZERO BOTH 0R AND 1R , THE POINTER KEYWORD DEFAULTS   05600002
*    TO A MAXIMUM OF 4.  ONLY REG 0 WAS CLEARED.                        05700002
*                                                                       05800002
* ENTRY POINTS --                                                       05900002
*    IKJEGFM  -- FROM PARSE FOR 'FROM' POSITIONAL.                      06000002
*    IKJEGTO  -- FROM PARSE FOR 'TO' POSITIONAL.                        06100002
*    IKJEGLN  -- FROM PARSE FOR 'LENGTH' KEYWORD.                       06200002
*    STAERTRY -- AFTER AN ABEND                                         06300002
*                                                                       06400002
* INPUT --                                                              06500002
*    A LINE OF INPUT.                                                   06600002
*                                                                       06700002
* OUTPUT --                                                             06800002
*    DIAGNOSTIC MESSAGES UPON ERROR.                                    06900002
*                                                                       07000002
* EXTERNAL REFERENCES --                                                07100002
*    IKJPARS(LINK)                                                      07200002
*    IKJEGCVT(BALR) TSTCONVT IN TCOMTAB.                                07300002
*    IKJEGBLD(BALR) TSTADDR IN TCOMTAB.                                 07400002
*    IKJEGIO(BALR) USING THE IKJEGSIO MACRO.                            07500002
*                                                                       07600002
* EXITS, NORMAL --                                                      07700002
*    RETURN TO MAINLINE(IKJEGMNL) RC OF 0-NORMAL,16-ATTENTION.          07800002
*                                                                       07900002
* EXITS, ERROR --                                                       08000002
*    RETURN TO MAINLINE(IKJEGMNL) RC OF 20-ABEND,24-ESTAE COULDNT BE    08100002
*    ISSUED.                                                            08160002
*                                                                       08200002
* TABLES/WORK AREAS --                                                  08300002
*    TCOMTAB-TEST'S COMMUNICATION TABLE.                                08400002
*    WA- COPY'S WORKAREA.                                               08500002
*                                                                       08600002
* ATTRIBUTES --                                                         08700002
*    REENTRANT-REFRESHABLE.                                             08800002
*                                                                       08900002
* CHARACTER CODE DEPENDENCY --                                          09000002
*    REASSEMBLE IS REQUIRED FOR CHANGE OF CODE.                         09100002
*                                                                       09200002
* NOTES --                                                              09300002
*    REGISTER CONVENTIONS                                               09400002
*    R0, R1, R3, R4, R5 ARE QUICKY WORK REGS.                           09500002
*    R2 PDL ADDRESS(MAIN ROUTINE), PDE ADDRESS(VALIDITY CK EXIT)        09600002
*    R6 USED AS WORK AREA IN ADDRESS VALIDITY CHECK ROUTINE.            09700002
*    R7 IS PARAMETER REG FOR ADDRRESS VALIDITY CHECK ROUTINE.           09800002
*    R8 IS THE VALIDITY LIST PASSED FROM IKJPARS.                       09900002
*    R9 IS TCOMTAB ADDRESS.                                             10000002
*    R10 IS WA ADDRESS. (COPY'S WORK AREA)                              10100002
*    R11 IS USED AS AN INTERNAL LINK REGISTER ONLY.                     10200002
*    R12 IS THE BASE REGISTER.                                          10300002
*    THE HIGH BYTE IN REGISTER 12 INDICATES WHICH VALIDITY EXIT IS      10400002
*    EXECUTING.                                                         10500002
*    PLM = SY35-0004                                                    10550002
*    *     TSO COMMAND PROCESSOR LOGIC                                  10560002
*    *     VOLUME III - TEST                                            10570002
* CHANGE-ACTIVITY -                                                     10580000
*                 APAR OZ10462 FIXES FETCHING AND STORING OF            10590000
*                 REGISTERS IN THE INCORRECT RB WHEN AN                 10600000
*                 ASYNCHRONOUS EXIT CAUSES AN IRB TO BE QUEUED          10610000
*                 ON THE TCB/RB CHAIN.  THE FIX IS AROUND LABELS        10620000
*                 SKIP2 AND CHECKTO.  THE SVC 97 SVRB ADDRESS           10630000
*                 IS OBTAINED FROM ECBPP+1.                             10640000
*********************************************************************** 10700002
         SPACE                                                          10800002
         EJECT                                                          10900002
         COPY  IKJEGSIO                                                 10950002
*        EQUATES                                                        11000002
         SPACE                                                          11100002
R0       EQU   0              REG.  0                                   11200002
R1       EQU   1              REG.  1                                   11300002
R2       EQU   2              REG.  2                                   11400002
R3       EQU   3              REG.  3                                   11500002
R4       EQU   4              REG.  4                                   11600002
R5       EQU   5              REG.  5                                   11700002
R6       EQU   6              REG.  6                                   11800002
R7       EQU   7              REG.  7                                   11900002
R8       EQU   8              REG.  8                                   12000002
R9       EQU   9              REG.  9                                   12100002
R10      EQU   10             REG. 10                                   12200002
R11      EQU   11             REG. 11                                   12300002
R12      EQU   12             REG. 12                                   12400002
R13      EQU   13             REG. 13                                   12500002
R14      EQU   14             REG. 14                                   12600002
R15      EQU   15             REG. 15                                   12700002
         SPACE                                                          12800002
X0       EQU   0              NO.  0                                    12900002
X1       EQU   1              NO.  1                                    13000002
X2       EQU   2              NO.  2                                    13100002
X3       EQU   3              NO.  3                                    13200002
X4       EQU   4              NO.  4                                    13300002
X5       EQU   5              NO.  5                                    13400002
X6       EQU   6              NO.  6                                    13500002
X7       EQU   7              NO.  7                                    13600002
X8       EQU   8              NO.  8                                    13700002
X9       EQU   9              NO.  9                                    13800002
N10      EQU   10             NO. 10                                    13900002
N11      EQU   11             NO. 11                                    14000002
N12      EQU   12             NO. 12                                    14100002
N13      EQU   13             NO. 13                                    14200002
N14      EQU   14             NO. 14                                    14300002
N15      EQU   15             NO. 15                                    14400002
N16      EQU   16             NO. 16                                    14500002
N24      EQU   24             NO. 24                                    14600002
N28      EQU   28             NO. 28                                    14700002
N64      EQU   64             NO. 64                                    14800002
N80      EQU   80             NO. 80                                    14900002
N256     EQU   256            NO. 256                                   15000002
RC8      EQU   8              RETURN CODE 08                            15100002
RC12     EQU   12             RETURN CODE 12                            15200002
RC16     EQU   16             RETURN CODE 16                            15300002
RC20     EQU   20             RETURN CODE 20                            15400002
CVTPTR   EQU   16             LOCATION OF CVT POINTER                   15500002
CPYCODE  EQU   0              COPY CODE                                 15600002
FMCODE   EQU   1              FM CODE                                   15700002
TOCODE   EQU   FMCODE+X1      TO CODE                                   15800002
LNCODE   EQU   TOCODE+X1      LN CODE                                   15900002
PTRKEY   EQU   1              PARSE CODE FOR POINTER KEYWORD.           16000002
BLANK    EQU   C' '           BLANK                                     16100002
CHARF    EQU   C'F'           F                                         16200002
CHART    EQU   C'T'           T                                         16300002
PLUS     EQU   C'+'           PLUS SIGN.                                16400002
TESTSVC  EQU   97             TEST SVC NUMBER                           16500002
X80      EQU   X'80'          HEXIDECIMAL 80                            16600002
XFF      EQU   X'FF'          X'FF'                                     16700002
* FIRST LEVEL MESSAGE EQUATES                                           16750002
M0064    EQU   64             INVALID LENGTH                            16760002
M0066    EQU   66             INVALID FROM ADDRESS                      16770002
M0072    EQU   72             INVALID TO ADDRESS                        16780002
M0101    EQU   101            INVALID ADDRESS ...                       16790002
M0103    EQU   103            NOT ENOUGH MAIN STORAGE                   16792002
M0104    EQU   104            COPY FAILED                               16794002
* SECOND LEVEL MESSAGE EQUATES                                          16796002
M0266    EQU   266            LEN MAY NOT EXCEED 64                     16798002
M0267    EQU   267            REG NOT. MUST BE GEN REG                  16798402
M0268    EQU   268            REG NOT. MUST BE INDIRECT                 16798802
M0277    EQU   277            PARSE ERROR CODE 12                       16799202
M0279    EQU   279            ADDRESS IN WRITE PROT. CORE               16799302
M0283    EQU   283            SVC 97 RET CODE NONZERO                   16799602
M0284    EQU   284            LEN MUST BE BTWN 0 AND 65535              16799702
* CONSTANT MESSAGE INSERT EQUATES                                       16799902
I0030    EQU   30             COPY                                      16833202
I0040    EQU   40             IKJPARS                                   16843202
I0099    EQU   99             BLOW CODE IN ABENDTABLE                   16853202
I0097    EQU   97             BLOW CODE IN ABENDTABLE                   16863202
         EJECT                                                          16866702
*        DSECTS                                                         16900002
         SPACE                                                          17000002
WA       DSECT                WORK AREA DSECT                           17100002
WALIST   DS    0A             PARSE PARAMETER LIST.                     17200002
WAUPT    DS    1A             UPT POINTER.                              17300002
WAECT    DS    1A             ECT POINTER                               17400002
WAECBPTR DS    1A             ATTENTION ECB POINTER.                    17500002
WAPRM    DS    1A             PARM BLOCK POINTER.                       17600002
WANSWER  DS    1A             PTR TO TSTANSPL                           17700002
WACODE   DS    0X             VALIDITY KEYWORD CODE.                    17800002
WAINBUF  DS    1A             INPUT BUFFER TO BE PARSED.                17900002
WASAVERC DS    0X             ONE BYTE RETURN CODE FORM CVT,SYM OR IO   18000002
WAPASS   DS    1A             PARM TO BE PASSED TO VALIDITY EXIT.       18100002
WAFROM   DS    1A             FROM ADDRESS OR FROM REGISTER.            18200002
WATO     DS    1A             TO ADDRESS OR TO REGISTER.                18300002
WALENGTH DS    1A             DEFAULT OR LENGTH SPECIFIED BY THE USER.  18400002
WATEMP   DS    3F             TEMPORARY W.A. FOR SVC 97 AND SEARCH RTN  18450002
* THREE WORD AREA USED BY SRH RTN TO PASS PARAMETERS                    18460002
         ORG   WATEMP         ORG TO NAME EACH WORD                     18500002
WATEMP1  DS    F              FIRST WORD                                18550002
WATEMP2  DS    F              SECOND WORD                               18600002
WATEMP3  DS    F              THIRD WORD                                18650002
WAFMREG  DS    16A            SAVE AREA FOR FROM REGISTER(S)            18700002
WATOREG  DS    16A            SAVE AREA FOR NEW REGISTERS               18800002
WAEND    EQU   *-WA           LENGTH OF WORKAREA.                       18900002
         SPACE                                                          19000002
VAL      DSECT                                                          19100002
VALPDE   DS    1A             PDE PASSED FROM PARSE.                    19200002
VALPASS  DS    1A             PARM PASSED BY MAIN ROUTINE.              19300002
VAL2LVL  DS    1A             2ND LEVEL MESSAGE PTR FOR PARSE.          19400002
         SPACE 2                                                        19500002
RB       DSECT                                                          19600002
RBGRSAVE EQU   RB+32                                                    19700002
         EJECT                                                          19800002
IKJEGCPY CSECT                                                          19900002
*        MAIN PROCESSOR CODE                                            20000002
         SPACE                                                          20100002
         USING *,R12          ADDRESSABILITY                            20200002
         USING TCOMTAB,R9     ADDRESSABILITY                            20300002
         USING WA,R10         ADDRESSABILITY                            20400002
         USING IKJPARMD,R2    ADDRESSABILITY                            20450002
         USING BRKELEM,R6     ADDRESSABILITY                            20500002
         SAVE  (14,12),,*     SAVE MAINLINES REGISTERS.                 20600002
         LR    R12,R15        SETUP BASE REG                            20700002
         L     R3,REGSAVE2    SET FOWARD AND BACKWD POINTERS            20800002
         ST    R13,X4(R3)     DITTO                                     20900002
         ST    R3,X8(R13)     DITTO                                     21000002
         LR    R13,R3         SET UP MY SAVE                            21100002
         L     R4,WORKAREA    GET GENERAL WORK AREA PTR.                21200002
         LA    R10,CWORKCMD-TSTCWORK(R4)  SET UP CPY'S W.A. PTR         21300002
         L     R3,TSTSTAE     GET ADDRESS OF TEST STAE EXIT (STA)       21700002
         STM   R14,R12,N12(R13)  SAVE REGS IF ABEND OCCURS.             21800002
         LR    R1,R10         STAE LIST PTR FOR STAE SVC                21900002
         MVC   X0(STAELSTL,R10),STAELIST  MOVE IN LIST                  22000002
         ESTAE (R3),PARAM=LISTESTA,RECORD=YES,MF=(E,(R1))  ISSUE ESTAE  22150002
         LTR   R15,R15        Q.GOT AN S.C.B.                           22200002
         BZ    ESTAEOK        RC=0 FROM ESTAE, ALL OK                   22210002
         STC   R15,TSTESTRC   STORE RET CODE                            22220002
         LA    R15,N24        SEND RC=24 TO MAINLINE                    22230002
         B     MNLRETS        BRANCH TO RETURN                          22240002
         SPACE                                                          22400002
*        WALENGTH IS INITIALIZED.                                       22500002
*        WALENGTH = X'00000004'                                         22600002
*        WHEN THE LENGTH IS NOT SPECIFIED, A DEFAULT OF 4 IS TAKEN.     22700002
*        COPY  A1680.  ADDR2 -- WILL CAUSE WAFROM TO BE X'000A1680'     22800002
*        COPY  3R      ADDR2 -- WILL CAUSE WAFROM TO BE X'80000003'     22900002
*        WATO IS HANDLED THE SAME AS WAFROM.                            23000002
*        IF A REGISTER IS SPECIFIED IN EITHER THE 'FROM' OR             23100002
*        THE 'TO' POITIONALS, A MAXIMUM LENGTH OF 64 MAY                23200002
*        BE DEFAULTED TO.                                               23300002
*        ANYTIME POINTER IS SPECIFIED, A MAXIMUM LENGTH OF 4 MAY        23400002
*        BE DEFAULTED TO.                                               23500002
         SPACE                                                          23600002
ESTAEOK  LA    R0,X4          SET DEFAULT LENGTH OF 4                   23700002
         ST    R0,WALENGTH    DITTO                                     23800002
PARSE    EQU   *              GOING TO PARSE.                           23900002
         LR    R1,R10         SET PARM REGISTER.                        24000002
         MVC   WALIST(N12),PARMLIST  SETUP LIST.                        24100002
         MVC   WAPRM(X4),PRMAD  DITTO                                   24200002
         LA    R5,TSTANSPL    DITTO                                     24300002
         ST    R5,WANSWER     DITTO                                     24400002
         MVC   WAINBUF(X4),INBUF  DITTO                                 24500002
         ST    R13,WAPASS     PARM TO BE PASSED TO VALIDITY EXIT.       24600002
         LINK  EP=IKJPARS,ERRET=LINKERR     GO TO PARSE.                24700002
BLOWPARS EQU   *              IF LINK FAILS ABEND WILL OCCUR HERE.      24800002
FROMPARS EQU   *              COMING FROM PARSE.                        24900002
         L     R2,TSTANSPL    GET THE PDL ADDRESS.                      25000002
         B     TABLE1(R15)    BRANCH TABLE.                             25100002
TABLE1   B     AOK            ALL O.K. MAYBE.                           25200002
         B     NOPROMPT       NOPROMPT MODE. QUIT.                      25300002
         B     ATTN           RET TO MNL WITH A CODE OF 16              25400002
         B     BADPARMS       PRINT 'PARSE ERROR CODE 12' RETURN.       25500002
         B     NOCORE         PRINT 'NOT ENOUGH CORE' RETURN.           25600002
         B     CHECKRC        A RET. CODE HAS BEEN PASSED BY EXIT RTN.  25700002
         SPACE                                                          25800002
         SPACE                                                          25900002
CHECKRC  EQU   *              OBTAIN THE PASSED RET. CODE FROM VAL EXIT 26000002
         IC    R15,WASAVERC   R15= RET. CODE.                           26100002
         CH    R15,ATTNCODE   COMPARE TO CODE 16                        26150002
         BL    NOPROMPT       IF < 16, SET TO 0 WITH TSTFLUSH           26200002
         B     MNLRET         ELSE RETURN WITH CODE PASSED (16 OR 20)   26250002
NOCORE   EQU   *              PRINT 'NOT ENOUGH CORE' MSG               26300002
         LA    R2,M0103       MSG - NOT ENOUGH CORE                     26350002
         LA    R3,X0          NO SECOND LEVEL MSG                       26400002
         BAL   R11,MSG1       GO OUTPUT MESSAGE                         26450002
         B     MNLRET0        RETURN TO MNL                             26600002
BADPARMS EQU   *              PRINT 1ST AND 2ND LEVEL MESSAGES          26700002
         LA    R2,M0104       MSG - COPY FAILED                         26800002
         LA    R3,M0277       MSG - PARSE ERROR                         26850002
         BAL   R11,MSG2       GO OUTPUT MESSAGE                         26900002
         B     MNLRET0        RETURN TO MNL.                            27000002
ATTN     EQU   *              RETURN TO MNL WITH CODE OF 16.            27100002
         LA    R15,RC16       DITTO                                     27200002
         B     MNLRET         RETURN.                                   27300002
NOPROMPT EQU   *                                                        27400002
         OI    TSTFLGS4,TSTFLUSH  SET THE FLUSH BIT                     27500002
         B     MNLRET0        RETURN TO MAINLINE.                       27600002
AOK      EQU   *              ALL O.K. MAYBE.                           27700002
         L     R5,WALENGTH    CHECK LENGTH FOR ZERO.                    27800002
         LTR   R5,R5          Q. WAS ZERO ENTERED BY USER.              27900002
         BZ    MNLRET0        A. YES USERS WISH IS GRANTED.             28000002
         CLI   PRMP+X1,PTRKEY  Q.IS POINTER SPECIFIED.                  28100002
         BNE   NOPOINT        NO.                                       28200002
         TM    WAFROM,X80     Q.IS REGISTER SPECIFIED.                  28300002
         BZ    POINT          NO. THIS IS LEGAL.                        28400002
         LA    R2,M0066       MSG - INVAL FROM ADDR.                    28500002
         LA    R3,M0268       MSG - INDIRECT GEN REG                    28550002
         BAL   R11,MSG1       GO OUTPUT MESSAGES                        28600002
         B     NOPROMPT       SET FLUSH BIT AND RETURN.                 28700002
* IF POINTER IS SPECIFIED, THE VALUE SPECIFIED AS ADDRESS1 IS MOVED     28800002
* INTO 'WAFMREG'(USED AS A WORK AREA) AND THE ADDRESS OF WAFMREG IS     28900002
* PLACED IN WAFROM.  A MAXIMUM LENGTH OF 4 MAY BE SPECIFIED. IF THE     29000002
* LENGTH IS GREATER THAN 4, A LENGTH OF 4 IS ASSUMED. IF THE LENGTH     29100002
* IS LESS THAN 4 (=N), THEN ONLY THE 1ST N BYTES OF THE 4 BYTE VALUE    29200002
* SPECIFIED WILL BE USED. THEY WILL BE RIGHT JUSTIFIED IN THE FIRST     29300002
* 4 BYTES OF WAFMREG.                                                   29400002
POINT    EQU   *              POINTER WAS SPECIFIED                     29500002
         LA    R0,X4          Q. LENGTH HIGHER THAN DEFAULT.            29600002
         CR    R0,R5          *                                         29700002
         BH    SKIP1          NO. DONT DEFAULT.                         29800002
         ST    R0,WALENGTH    DEFAULT TO LENGTH OF 4                    29900002
         LR    R5,R0          NEW LENGTH TO R5                          30000002
SKIP1    EQU   *                                                        30100002
         LA    R1,WAFROM      GET POINTER TO ADDRESS.                   30200002
         BCTR  R1,X0          INITIALIZE FOR BUMP.                      30300002
BUMPONE  EQU   *                                                        30400002
         LA    R1,X1(R1)      BUMP ONE.                                 30500002
         CR    R0,R5          Q.MOVE NOW OR BUMP.                       30600002
         LA    R5,X1(R5)      ADD ONE TO THE LENGTH.                    30700002
         BNE   BUMPONE        BUMP UNTIL COUNT REACHES FOUR.            30800002
         MVI   WAFROM,X0      CLEAR THE HIGH BYTE.                      30900002
         MVC   WAFMREG(X4),X0(R1)   MOVE POINTER ADDRESS.               31000002
         LA    R1,WAFMREG     PLACE ADDRESS OF SLOT 0 TO WAFROM         31100002
         ST    R1,WAFROM      DITTO.                                    31200002
         B     CHECKTO        CHECK IF 'TO' WAS ENTERED.                31300002
NOPOINT  EQU   *                                                        31400002
         TM    WAFROM,X80     Q.IS IT A REGISTER.                       31500002
         BZ    VALCHKFM       NO. IT IS AN ADDRESS.                     31600002
REGISTER EQU   *                                                        31700002
         LA    R0,N64         REGISTER WAS ENTERED.                     31800002
         CR    R0,R5          Q.LENGTH GREATER THAN 64.                 31900002
         BH    SKIP2          A. NO. DO NOT DEFAULT.                    32000002
         ST    R0,WALENGTH    DEFAULT TO 64.                            32100002
SKIP2    EQU   *                                                        32200002
         L     R1,WAFROM      OBTAIN FROM REGISTER NUMBER.              32300002
         SLL   R1,X2          LOSE HIGH BIT. AND MULT BY 4.             32400002
         SR    R0,R1          R0=64-(REG NUMX4)                         32500002
         L     R3,ECBPP       ADDRESSIBILITY TO SVRB REG SA  @ZA10462   32600000
         LA    R3,RBGRSAVE-RB(R3)  DITTO.                               32800002
         LA    R4,WAFMREG     ADDRESSIBILITY TO FM REG SAVE AREA.       32900002
         AR    R4,R0          POINTER TO SLOT WHERE REGS WILL BE MOVED  33000002
         LTR   R5,R1          Q. WAS R0 SPECIFIED.                      33100002
         BZ    MOVE2          BYPASS THIS MOVE. ONLY 1 MOVE REQD.       33200002
         SPACE                                                          33300002
*        AT THIS POINT, ASSUME  COPY  3R  ADDR2 L(64),WAS SPECIFIED.    33400002
*        REGS 0,1,2 ARE MOVED FROM SVRB REG SAVE TO THE LAST 3 SLOTS    33500002
*        OF WAFMREG SAVE AREA.                                          33600002
         SPACE                                                          33700002
         BCTR  R5,X0          MOVE THE FIRST PORTION OF REGISTERS.      33800002
         EX    R5,MVC         MOVE THEM.                                33900002
MOVE2    EQU   *              2ND MOVE UNLESS 0R WAS SPECIFIED.         34000002
         AR    R3,R1          POINTER TO REG SLOT IN SVRB.              34100002
         LA    R4,WAFMREG     SET POINTER TO BEGINNING OF FM REG AREA.  34200002
         LR    R5,R0          LENGTH OF 2ND PORTION TO BE MOVED.        34300002
         SPACE                                                          34400002
*        AT THIS POINT, ASSUME  COPY  3R  ADDR2 L(64),WAS SPECIFIED.    34500002
*        REGS 3,4,5,6,7,8,9,10,11,12,13,14,15 ARE MOVED FROM            34600002
*        SVRB REG SAVE TO THE FIRST 13 SLOTS OF WAFMREG SAVE AREA.      34700002
         SPACE                                                          34800002
         BCTR  R5,X0          DECREMENT FOR MOVE.                       34900002
         EX    R5,MVC         MOVE THE 2ND PORTION.                     35000002
         ST    R4,WAFROM      WAFROM= POINTER TO WAFMREG                35100002
         B     CHECKTO        CHECK 'TO' ADDRESS                        35150002
VALCHKFM EQU   *                                                        35200002
         SPACE                                                          35300002
         L     R3,WAFROM      OBTAIN FROM ADDRESS.                      35400002
         L     R5,WALENGTH    OBTAIN THE LENGTH.                        35500002
         LR    R7,R3          PUT ADDRESS TO BE CHECKED IN R7.          35600002
         BAL   R11,ADDRCHK    VALIDITY CHECK ROUTINE                    35700002
         LR    R15,R8         RET CODE TO REG 15                        35750002
         LA    R8,X8          REG 8 IS 8                                35752002
         CR    R15,R8         COMPARE RET CODE TO 8                     35754002
         BL    CHECKTO        0 OR 4 ARE OK                             35756002
         BH    MNLRET         HAVE RET CODE GREATER THAN 8              35758002
         LA    R2,M0066       MSG - INVALID FROM ADDR                   35900002
         LA    R3,M0279       MSG - ADDR IN PROT. CORE                  35950002
         BAL   R11,MSG1       GO OUTPUT MESSAGES                        36000002
         B     NOPROMPT       SET FLUSH BIT AND QUIT.                   36100002
CHECKTO  EQU   *                                                        36200002
         TM    WATO,X80       Q. IS IT ADDRESS OR REGISTER.             36300002
         BZ    COPY2          A. IT'S AN ADDRESS . COPY IT.             36400002
*  COPY IS TO REGISTERS                                                 36500002
         L     R3,ECBPP        ADDRESSABILITY TO SVRB REG SA  @ZA10462  36600000
         LA    R3,RBGRSAVE-RB(R3)  DITTO.                               36800002
         LA    R4,WATOREG     ADDRESSABILITY TO 'TO' REG SAVE AREA.     36900002
         LA    R5,N64-X1      MOVE ALL REGS TO 'TO' SAVE AREA.          37000002
         EX    R5,MVC         MOVE THEM.                                37100002
         LA    R0,N64         CHECK FOR LENGTH LARGER THAN 64.          37200002
         C     R0,WALENGTH    Q. LARGER THAN 64.                        37300002
         BH    SKIP5          NO. BYPASS DEFAULT.                       37400002
         ST    R0,WALENGTH    DEFAULT TO 64.                            37500002
SKIP5    EQU   *                                                        37600002
         L     R1,WATO        GET REGISTER SPECIFIED.                   37700002
         SLL   R1,X2          DROP HIGH BIT. AND MULT X 4.              37800002
         SR    R0,R1          64-(REG NUMX4)= LNG 2ND PORTION           37900002
         L     R3,WAFROM      OBTAIN FROM ADDRESS.                      38000002
         SPACE                                                          38100002
*        AT THIS POINT , WAFROM WILL ALWAYS CONTAIN AN ADDRESS.         38200002
         SPACE                                                          38300002
         LA    R4,WATOREG     ADDRESSIBILITY TO 'TO' REG SAVE AREA.     38400002
         AR    R4,R1          POINT TO REG SLOT OF SPECIFIED REG.       38500002
         L     R5,WALENGTH    OBTAIN LENGTH TO BE MOVED.                38600002
         CR    R5,R0          Q. IS LENGTH GREATER THAN 2ND PORTION OF  38700002
*                             'TO' SAVE AREA.                           38800002
         BH    MORE           YES. TWO MOVES REQUIRED.                  38900002
         BCTR  R5,X0          ONE MOVE. LENGTH SPECIFIED.               39000002
BLOW1A   EQU   *              PROTECTION CHECK HERE, IF ABEND.          39050002
         EX    R5,MVC         MOVE IT.                                  39100002
BLOW1    EQU   *              PROTECTION CHECK HERE, IF ABEND.          39110002
         BAL   R8,SRH0        CALL SEARCH ROUTINE                       39150002
         B     COPYR          CHANGE REGS. ALL OF THEM.                 39200002
MORE     EQU   *              2 MOVES REQUIRED.                         39300002
         LR    R5,R0          OBTAIN LENGTH OF SECOND PORTION(1ST MOVE) 39400002
         BCTR  R5,X0          DECREMENT FOR EXECUTE.                    39500002
BLOW2A   EQU   *              PROTECTION CHECK HERE, IF ABEND.          39550002
         EX    R5,MVC         MOVE IT.                                  39600002
BLOW2    EQU   *              PROTECTION CHECK HERE, IF ABEND.          39610002
         BAL   R8,SRH0        CALL SEARCH ROUTINE                       39650002
         AR    R3,R0          UPDATE FROM ADDRESS FOR 2ND MOVE.         39700002
         LA    R4,WATOREG     2ND MOVE GOES TO BEGINNING OF WATOREG     39800002
         L     R5,WALENGTH    OBTAIN LENGTH OF 2ND MOVE.                39900002
         SR    R5,R0          DITTO.                                    40000002
         BCTR  R5,X0          DECREMENT FOR MOVE.                       40100002
BLOW3A   EQU   *              PROTECTION CHECK HERE, IF ABEND.          40150002
         EX    R5,MVC         MOVE IT.                                  40200002
BLOW3    EQU   *              PROTECTION CHECK HERE, IF ABEND.          40210002
         BAL   R8,SRH0        CALL SEARCH ROUTINE                       40250002
* INVOKE SVC 97 TO MOVE REGS FROM WORK AREA (WATOREG) TO PP TCB.        40300002
COPYR    EQU   *              CHANGE ALL REGISTERS.                     40400002
         L     R3,PPTCB       ADDR OF TCB                               40450002
         LA    R4,WATOREG     POINTER TO NEW REGS.                      40500002
         IKJEGS9G AGPR,TCBADDR=(R3),VALUE=(R4),MF=(E,WATEMP)            40550002
         LTR   R15,R15        IF CHANGE WAS SUCCESSFUL,                 41000002
         BZ    MNLRET0        RETURN TO MAINLINE.                       41100002
         LA    R2,N12         REG 2 = 12 FOR COMPARISON                 41150002
         CR    R15,R2         COMPARE RET CODE TO 12                    41160002
         BH    MNLRET         GREATER THAN 12, RETURN TO MNL            41180002
         LA    R2,M0104       MSG - COPY FAILED                         41200002
         LA    R3,M0283       MSG - SVC 97 RET CODE NONZERO             41250002
         BAL   R11,MSG2       GO OUTPUT MESSAGES                        41300002
         B     NOPROMPT       RETURN TO MAINLINE.                       41400002
         SPACE                                                          41500002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       41600002
*   - THE 'TO' ADDRESS IS NOT A REGISTER -                              41700002
*        CHECK FOR OVERLAPPING OF FIELDS                                41800002
*        THE ONLY PERMISSABLE OVERLAP IS                                41900002
*        IF THE 'TO' ADDRESS IS ONE HIGHER THAN THE 'FROM' ADDRESS      42000002
*        IF FIELDS DO OVERLAP THEN THE MOVE IS DONE BACKWARDS.          42100002
         SPACE                                                          42200002
COPY2    EQU   *              SHOULD COPY BE BACKWARDS OR FORWARDS.     42300002
         L     R3,WAFROM      OBTAIN FROM ADDRESS.                      42400002
         L     R4,WATO        OBTAIN TO ADDRESS.                        42500002
         L     R5,WALENGTH    OBTAIN LENGTH.                            42600002
         SPACE                                                          42700002
*        R3= 'FROM' ADDRESS                                             42800002
*        R4= 'TO' ADDRESS                                               42900002
*        R5= 'LENGTH'                                                   43000002
         SPACE                                                          43100002
         LR    R7,R4          PUT ADDRESS TO BE CHECKED IN R7.          43200002
         BAL   R11,ADDRCHK    ADDRESS VALIDITY CHECK ROUTINE            43300002
         LTR   R15,R8         TEST RETURN CODE                          43350002
         BZ    GOODTO         IF ZERO, ALL OK SO FAR                    43360002
         LA    R8,N12         REG 8 IS 12 FOR COMPARISON                43410002
         CR    R15,R8         COMPARE RET CODE TO REG 8                 43460002
         BH    MNLRET         GREATER THAN 12, BACK TO MNL              43470002
COPY2B   LA    R2,M0072       MSG - INVALID TO ADDR                     43500002
         LA    R3,M0279       MSG - ADDR IN PROT. CORE                  43550002
         BAL   R11,MSG1       GO OUTPUT MESSAGES                        43600002
         B     NOPROMPT       QUIT. AND RETURN TO MNL.                  43700002
GOODTO   EQU   *                                                        43800002
* REMOVE BREAK POINTS FROM 'TO' AREA BEFORE COPY.                       43850002
         LA    R1,X8          SEARCH AND REMOVE WITH BACKUP             43860002
         ST    R1,WATEMP1     1ST WORD - OPTION CODE                    43870002
         ST    R4,WATEMP2     2ND WORD - START OF RANGE                 43880002
         LA    R1,X0(R4,R5)   START PLUS LENGTH OF RANGE                43890002
         BCTR  R1,X0          BACK UP ONE                               43892002
         ST    R1,WATEMP3     3RD WORD - END OF RANGE                   43894002
         LA    R1,WATEMP      ADDRESS OF PARM LIST                      43896002
         L     R15,TSTSRHRT   ADDRESS OF SEARCH ROUTINE                 43898002
         BALR  R14,R15        CALL SEARCH                               43898402
         CH    R15,H8         CHECK RETURN CODE                         43898802
         BH    NOFREE         IF ERROR, RETURN                          43899202
         SPACE                                                          43900002
         CR    R3,R4          Q. IS FROM LOWER THAN TO ADDRESS.         44000002
         BNL   COPY           NO. CANT OVERLAP.                         44100002
         LA    R3,X1(R3)      ADD ONE TO FROM ADDRESS.                  44200002
         CR    R3,R4          Q.IS TO ADDRESS ONLY ONE HIGHER THAN FROM 44300002
         BCTR  R3,X0          RESET FROM ADDRESS.                       44500002
         BE    COPY0          YES. CHECK FOR BREAKPOINT                 44550002
         AR    R3,R5          GET LAST BYTE OF FROM.                    44600002
         CR    R3,R4          Q. IS THIS BYTE MORE THAN TO ADDR.        44700002
         BNH   COPY           NO. COPY FOWARD.                          44800002
         SPACE                                                          44900002
*        BACKWARD COPY NOW IN PROGRESS.                                 45000002
*        AT THIS POINT THERE ARE OVERLAPPING FIELDS AND THE 'TO'        45100002
*        ADDRESS IS MORE THAN 1 GREATER THAN THE 'FROM' ADDRESS.        45200002
*        THE MOVE BACKWARDS LOOP IS KEPT TIGHT FOR SPEED.               45300002
*        CONSIDERATION HAS BEEN GIVEN TO SMALL LENGTHS RATHER THAN      45400002
*        LARGE.                                                         45500002
         SPACE                                                          45600002
         AR    R4,R5          OBTAIN LAST BYTE OF TO ADDRESS.           45700002
COPYLEFT EQU   *              COPY BACKWARDS.                           45800002
         BCTR  R3,X0          R3=ADDR-1                                 45900002
         BCTR  R4,X0          R4=ADDR-1                                 46000002
BLOW4A   EQU   *              PROTECTION CHECK HERE, IF ABEND.          46050002
         MVC   X0(X1,R4),X0(R3) MOVE ONE BYTE AT A TIME.                46100002
BLOW4    EQU   *              PROTECTION CHECK HERE, IF ABEND.          46200002
         BCT   R5,COPYLEFT    LOOP UNTIL LENGTH IS EXHAUSTED.           46300002
         B     COPY1B         COPY COMPLETE. CALL SEARCH RTN.           46400002
         SPACE 1                                                        46450002
* IF THERE IS A ONE BYTE OVERLAP, THE SEARCH ROUTINE IS CALLED          46460002
* BEFORE THE COPY IS DONE.  IF THE 1ST BYTE OF THE 'FROM' RANGE         46470002
* CONTAINS A BREAKPOINT, THE ORIGINAL VALUE OF THAT BYTE IS             46480002
* PLACED IN THE 1ST BYTE OF THE 'TO' RANGE.  THE 'TO' ADDRESS           46490002
* AND 'FROM' ADDRESS ARE BUMPED BY ONE AND THE LENGTH IS DECRE-         46492002
* MENTED BY ONE.                                                        46494002
COPY0    LA    R1,X4          CODE = SEARCH + LOCATE, NO BACKUP         46498002
         ST    R1,WATEMP1     * 1ST WORD OF PARM LIST                   46498402
         ST    R3,WATEMP3     * 3RD WORD OF PARM LIST (END RANGE)       46499202
         BCTR  R3,X0          BACK UP ONE                               46499302
         ST    R3,WATEMP2     * 2ND WORD OF PARM LIST (START RANGE)     46499602
         LA    R1,WATEMP      ADDRESS OF PARM LIST                      46499702
         L     R15,TSTSRHRT   ADDRESS OF SEARCH ROUTINE                 46499802
         BALR  R14,R15        CALL SEARCH ROUTINE                       46499902
         CH    R15,H4         IF ERROR OCCURRED                         46533202
         BH    NOFREE         RETURN TO MAINLINE                        46543202
         BE    COPY           IF NOT FOUNT GO DO COPY                   46553202
         L     R6,X4(R1)      GET ADDR OF BREAK ELEMENT                 46563202
         L     R7,BRKADDR     GET ADDR OF ORIGINAL INST.                46565202
         CR    R7,R3          DOES INST START IN RANGE                  46565602
         BNE   COPY0B         YES - MOVE 1ST BYTE                       46566002
         LA    R6,X1(R6)      NO - MOVE 2ND BYTE                        46566402
BLOW5A   EQU   *              PROTECTION CHECK HERE, IF ABEND.          46569102
COPY0B   MVC   X0(X1,R4),BRKINST MOVE CHARACTER                         46571902
BLOW5    EQU   *              PROTECTION CHECK HERE, IF ABEND.          46573902
         BCTR  R5,X0          DECREMENT R5 BY ONE                       46574602
         LTR   R5,R5          IF LENGTH IS NOW 0                        46577302
         BZ    MNLRET0        DONE. RETURN TO MAINLINE                  46580002
         LR    R3,R4          INCREMENT R3 BY ONE                       46582702
         LA    R4,X1(R4)      INCREMENT R4 BY ONE                       46585402
         STM   R3,R5,WAFROM   RESET VALUES IN WORK AREA                 46588102
*        B     COPY                                                     46588202
         SPACE 1                                                        46588502
* COPY FORWARD USED WHEN                                                46588902
*    (1) FIELDS DO NOT OVERLAP,                                         46600002
*    (2) THE 'FROM' ADDRESS IS GREATER THAN THE 'TO' ADDRESS,           46700002
*    (3) THE 'TO' ADDRESS IS 1 GREATER THAN THE 'FROM' ADDRESS          46800002
*        (THE FIELD WILL BE SET TO THE SAME CHARACTER AS THE            46900002
*        'FROM' FIELD BEGAN WITH).                                      47000002
COPY     EQU   *              COPY AN ADDRESS TO AN ADDRESS FOWARD.     47100002
         L     R3,WAFROM      GET FROM ADDRESS.                         47200002
         L     R4,WATO        GET TO ADDRESS                            47300002
         LA    R0,N256        MOVE 256 AT A TIME.                       47400002
         L     R1,WALENGTH    GET THE LENGTH.                           47500002
         LA    R5,N256-X1     LENGTH OF 256-1                           47600002
LOOP     EQU   *              COPY LOOP.                                47700002
         CR    R1,R0          IS LENGTH NOW LESS THAN 256               47800002
         BNH   COPY1          YES. FINAL COPY.                          47900002
BLOW6A   EQU   *              PROTECTION CHECK HERE, IF ABEND.          47950002
         EX    R5,MVC         COPY 256                                  48000002
BLOW6    EQU   *              PROTECTION CHECK HERE, IF ABEND.          48100002
         ALR   R3,R0          UPDATE FROM ADDRESS.                      48200002
         ALR   R4,R0          UPDATE TO ADDRESS.                        48300002
         SR    R1,R0          OBTAIN LENGTH OF WHAT'S LEFT.             48400002
         B     LOOP           KEEP GOING.                               48500002
COPY1    EQU   *              FINAL COPY.                               48600002
         LR    R5,R1          GET FINAL LENGTH.                         48700002
         BCTR  R5,X0          DECREMENT FOR EXECUTE.                    48800002
BLOW7A   EQU   *              PROTECTION CHECK HERE, IF ABEND.          48850002
         EX    R5,MVC         MOVE IT.                                  48900002
BLOW7    EQU   *              PROTECTION CHECK HERE, IF ABEND.          49000002
         SPACE 1                                                        49010002
COPY1B   L     R3,WAFROM      OBTAIN FROM ADDRESS                       49050002
         L     R4,WATO        OBTAIN TO ADDRESS                         49060002
         L     R5,WALENGTH    OBTAIN LENGTH                             49070002
         BCTR  R4,X0          DECREMENT 'TO' ADDRESS                    49080002
         CR    R3,R4          IS 'TO' 1 GREATER THAN 'FROM'?            49090002
         LA    R4,X1(R4)      RESTORE 'TO' ADDRESS                      49092002
         BE    COPY1C         SEARCH DONE ( 1 BYTE PROPAGATED )         49094002
         BAL   R8,SRH         CALL SRH                                  49096002
COPY1C   EQU   *                                                        49098002
MNLRET0  SR    R15,R15        RET. TO MNL WITH A CODE OF ZERO.          49100002
MNLRET   LR    R2,R15         SAVE RET CODE OVER ESTAE                  49102002
         ESTAE 0              REMOVE ESTAE REQUEST                      49110002
         LR    R15,R2         RESTORE RETURN CODE                       49112002
         NI    TSTFLGS4,XFF-TSTRERTN  SHUT OFF TCOMTAB FLAG             49120002
MNLRETS  L     R13,X4(R13)    RESTORE THE REGISTERS.                    49200002
         RETURN  (14,12),T,RC=(15)  RETURN.                             49300002
         SPACE                                                          49400002
         SPACE                                                          49500002
MVC      MVC   X0(X0,R4),X0(R3)  ALL MOVES ARE DONE WITH THIS MVC.      49600002
         SPACE                                                          49700002
         EJECT                                                          50500002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         50510002
*  FUNCTION - CALLS THE SEARCH ROUTINE TO LOCATE BREAKPOINTS  *         50550002
*        IN THE RANGE SPECIFIED.  FOR EVERY BREAKPOINT FOUND  *         50560002
*        IN THE 'FROM' RANGE, IT REPLACES THE INSTRUCTION IN  *         50570002
*        THE 'TO' RANGE.                                      *         50580002
*  INPUT -                                                    *         50582002
*        R3 = 'FROM' ADDRESS                                  *         50584002
*        R4 = 'TO' ADDRESS                                    *         50586002
*        R5 = LENGTH ( OR LENGTH-1 IF ENTERED AT SRH0 )       *         50588002
*        R8 = RETURN ADDRESS                                  *         50588402
*  REGISTER USAGE                                             *         50588802
*        R1 = WORK REG                                        *         50588902
*           = PARM REG                                        *         50589002
*           = ADDR OF INST IN 'TO' RANGE                      *         50589102
*        R6 = ADDRESS OF BREAK ELEMENT                        *         50607502
*        R7 = ADDR OF INST IN 'FROM' RANGE                    *         50626402
*  REGISTERS AT OUTPUT -                                      *         50636402
*        R1, R6, R7, R14, R15 DESTROYED                       *         50638402
*        R5 = LENGTH                                          *         50640402
*        OTHERS ARE UNCHANGED                                 *         50642402
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         50657102
SRH      BCTR  R5,X0          LENGTH-1                                  50659102
SRH0     AR    R5,R3          END OF RANGE                              50661102
         LR    R7,R3          INIT START ADDRESS                        50663102
         BCTR  R7,X0          BACK UP ONE                               50669202
SRHLOOP  LA    R1,X4          CODE = SEARCH + LOCATE, NO BACKUP         50677502
         ST    R1,WATEMP1     * PARMLIST: CODE = 4                      50679502
         ST    R7,WATEMP2     *           START OF RANGE                50681502
         ST    R5,WATEMP3     *           END OF RANGE                  50687602
         LA    R1,WATEMP      ADDRESS OF PARM LIST                      50689602
         L     R15,TSTSRHRT   ADDRESS OF SEARCH ROUTINE                 50691602
         BALR  R14,R15        CALL SEARCH ROUTINE                       50693602
         B     SRHRC(R15)     CHECK RETURN CODE                         50693702
SRHRC    B     SRHFOUND       R.C. 0 = FOUND                            50703702
         B     SRHDONE        R.C. 4 = NOT FOUND                        50720302
         B     NOPROMPT       R.C. 8 = INVALID PARAMETERS               50720702
         B     NOFREE         R.C.12 = STAE                             50722302
SRHFOUND L     R6,WATEMP2     GET ADDR OF BREAK ELEMENT                 50730302
         L     R7,BRKADDR     GET ADDR OF INST                          50740302
         LR    R1,R7          * DISPLACEMENT INTO                       50742302
         SR    R1,R3          * 'FROM' AREA                             50744302
         AR    R1,R4          INST IN 'TO' AREA                         50746302
         CR    R7,R3          DOES INST START BEFORE RANGE?             50746702
         BL    SRHMVC2        YES. MOVE ONLY 1ST BYTE                   50746802
SRHMVC1  MVC   X0(X1,R1),BRKINST REPLACE 1ST BYTE                       50746902
         CR    R7,R5          IS THIS LAST BYTE IN RANGE?               50755702
         BE    SRHDONE        YES. DONE                                 50757702
SRHMVC2  MVC   X1(X1,R1),BRKINST+X1 REPLACE 2ND BYTE                    50759702
         LA    R7,X2(R7)      START RANGE AFTER BREAKPOINT              50761702
         CR    R7,R5          IS NEW START AFTER END?                   50762102
         BNH   SRHLOOP        NO. SEARCH FOR MORE BREAKPOINTS           50762502
SRHDONE  SR    R5,R3          LENGTH - 1                                50764102
         LA    R5,X1(R5)      LENGTH                                    50764502
         BR    R8             RETURN                                    50764602
         EJECT                                                          50773402
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         50782402
* INPUT:  R7 = ADDRESS TO BE CHECKED                          *         50791202
*         R5 = LENGTH OF FIELD                                *         50800002
* RETURNS TO 0(R11) IF ADDRESS IS READ/WRITE                  *         50900002
*         TO 4(R11) IF ADDRESS IS NOT READ ONLY               *         51050002
*         TO 8(R11) IF ADDRESS IS INVALID                     *         51060002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         51100002
ADDRCHK  EQU   *                                                        51200002
         L     R6,CVTPTR      ADDRESS CVT                               51300002
         L     R6,X0(R6)      ADDRESS NEW/OLD                           51400002
         L     R6,X4(R6)      ADDRESS OF TCB                            51500002
         IKJEGS9G       ADDRCHK,TCBADDR=(R6),VALUE=(R7),MF=(E,WATEMP)   51700002
         LR    R8,R15         SAVE RETURN CODE                          51850002
         AR    R7,R5          GET END OF FIELD.                         52100002
         BCTR  R7,X0          - LAST BYTE.                              52200002
         IKJEGS9G       ADDRCHK,TCBADDR=(R6),VALUE=(R7),MF=(E,WATEMP)   52300002
         CR    R8,R15         IS OLD R.C. > NEW R.C.?                   52450002
         BH    ADDRCHK3       YES. USE OLD R.C.                         52500002
         LR    R8,R15         NO. USE NEW R.C.                          52550002
ADDRCHK3 EQU   *                                                        52600002
         BR    R11            RETURN                                    52700002
         EJECT                                                          52800002
*        VALIDITY CHECK EXIT                                            52900002
         DROP  R2                                                       53000002
         SPACE                                                          53100002
         USING  IKJPARMA,R2   ADDRESSIBILITY                            53200002
         USING  VAL,R8        ADDRESSIBILITY                            53300002
         SPACE                                                          53400002
IKJEGFM  DS    0D             'FROM' EXIT.                              53500002
         STM   R14,R12,N12(R13)  SAVE PARSE'S REGISTERS.                53600002
         L     R12,FMBASE-IKJEGFM(R15)  GET FROM KEYWORDS BASE REG.     53700002
         B     VALIDITY       GO TO COMMON EXIT.                        53800002
         SPACE                                                          53900002
         SPACE                                                          54000002
IKJEGTO  DS    0D             'TO' EXIT.                                54100002
         STM   R14,R12,N12(R13)  SAVE PARSE'S REGISTERS.                54200002
         L     R12,TOBASE-IKJEGTO(R15)  GET TO'S BASE REGISTER          54300002
         B     VALIDITY       GO TO COMMON VALIDITY EXIT                54400002
         SPACE                                                          54500002
IKJEGLN  DS    0D             LENGTH'S KEYWORD EXIT                     54600002
         STM   R14,R12,N12(R13)  SAVE PARSE'S REGISTERS.                54700002
         L     R12,LNBASE-IKJEGLN(R15)  GET LENGTH'S BASE REG.          54800002
         SPACE                                                          54900002
VALIDITY EQU   *              COMMON VALIDITY EXIT.                     55000002
         L     R14,VALPASS-VAL(R1)  PARM PASSED IS REGSAVE2 PTR.        55100002
         LM    R2,R11,N28(R14)  GET ALL OF MAIN ROUTINE'S REGS.         55200002
         LR    R8,R1          SAVE PARSE'S PARM LIST PTR.               55300002
         LR    R0,R12         MOVE CODE TO REG 0                        55400002
         SRL   R0,N24         RIGHT ADJUST IT.                          55500002
         STC   R0,WACODE      SAVE IT.                                  55600002
         L     R3,REGSAVE3    MY REG SAVE AREA.                         55700002
         ST    R3,X8(R13)     FOWARD POINTER.                           55800002
         ST    R13,X4(R3)     BACKWARD POINTER.                         55900002
         LR    R13,R3         SAVE AREA POINTER TO 13                   56000002
         SR    R14,R14        CLEAR REG 14                              56050002
         L     R4,OUTBUF      ACCESS POINTER TO OUTBUF                  56060002
         ST    R14,X0(R4)     CLEAR 1ST WORD OF OUTBUF                  56070002
         OI    TSTFLGS4,TSTVALCK INDICATE VALIDITY ROUTINE              56080002
         L     R2,VALPDE      ADDRESSABILITY TO P.D.E.                  56100002
         CLI   WACODE,LNCODE  IS THIS AN EXIT FOR LENGTH Q.Q.Q.         56200002
         BE    LENGTHCK       YES. CONVERT IT.                          56300002
         LNR   R1,R2          CONVERT THE FROM OR TO ADDRESS.           56400002
         LPR   R0,R2          PASS THE PDE TO IKJEGCVT.                 56500002
         L     R15,TSTCONVT   GO TO CONVERT.                            56600002
         BALR  R14,R15        GO.                                       56700002
FROMCVT  B     TABLE2(R15)    COMING FROM CONVERT.                      56800002
TABLE2   B     QAOK           ALL SEEMS TO BE O.K.                      56900002
         B     PROMPT1        CVT SAYS PROMPT.                          57000002
         B     QUIT           MUST QUIT.                                57100002
         B     QUIT           MUST QUIT.                                57200002
         B     QUIT           MUST QUIT.                                57300002
         B     QUIT           MUST QUIT.                                57400002
QUIT     EQU   *              QUIT HERE.                                57500002
         STC   R15,WASAVERC   SAVE TELLTALE RET. CODE.                  57600002
         LA    R15,RC12       RET TO PARSE .                            57700002
         B     PARSRET        RETURN.                                   57800002
PROMPT1  EQU   *                                                        58300002
         LA    R15,RC8        RETURN TO PARSE WITH 8.                   58400002
         B     PARSRET        RETURN.                                   58500002
QAOK     EQU   *              IS ALL REALLY O.K.                        58600002
         L     R3,PDEUSER     GET CONVERT'S ADDRESS.                    58700002
         LTR   R3,R3          IS IT CONVERT'S OR SYM'S                  58800002
         BNM   SKIP3          IT REALY IS CONVERTS                      58900002
         L     R3,X0(R3)      NO. IT'S REALLY SYMS.                     59000002
SKIP3    EQU   *              IN EITHER CASE , HERE WE ARE.             59100002
         LA    R3,X0(R3)      CLEAR FLAGS FROM TOP BYTE                 59150002
         LH    R4,PDEINDCT    CHECK FOR INDIRECT COUNT.                 59200002
         LTR   R4,R4          IS COUNT ZERO Q.Q.Q.                      59300002
         BNZ   SAVEADDR       NO. HAS TO BE AN ADDRESS.                 59400002
         TM    PDEFLG4,GENR   IS IT A GENERAL REGISTER Q.Q.Q.           59500002
         BZ    SKIP4          NO. CHECK FOR FLOATING POINT.             59600002
         O     R3,REGCODE     YES IT'S GENERAL REGISTER. SET HIGH BIT.  59700002
SKIP4    EQU   *                                                        59800002
         TM    PDEFLG4,LFPR+SFPR  Q. IS IT A FLOATING POINT REG.        59900002
         BZ    SAVEADDR       NO. IT HAS TO BE AN ADDRESS.              60000002
PRINT    EQU   *                                                        60200002
         LA    R4,M0101       MSG - INVALID ADDRESS                     60250002
         LA    R3,M0267       MSG - MUST BE GEN REG                     60300002
         BAL   R11,MSG4       GO OUTPUT MESSAGES                        60350002
         CH    R15,ATTNCODE   WAS ATTENTION HIT                         60400002
         BNL   QUIT           YES, RETURN                               60450002
         B     PROMPT1        PROMPT 'REENTER'                          60500002
SAVEADDR EQU   *              HAVE AN ADDRESS. OR GENERAL REG.          60600002
         CLI   WACODE,TOCODE  CHECK WHAT KEYWORD.                       60700002
         BE    SAVETO         'TO'                                      60800002
SAVEFROM ST    R3,WAFROM      'FROM'                                    60900002
         B     PARSRET0       RETURN TO PARSE WITH AOK CODE.            61000002
SAVETO   ST    R3,WATO        SAVE THE 'TO' ADDR OR REG.                61100002
         B     PARSRET0       AOK BACK TO PARSE.                        61200002
LENGTHCK EQU   *              CONVERT THE LENGTH.                       61300002
         SR    R0,R0          CLEAR REG 0                               61400002
         LPR   R1,R2          PDE ADDR TO R1 AND INSURE POITIVE.        61500002
         MVI   PDERSV1,DECIMAL  INDICATE CONVERT TO DECIMAL.            61600002
DECIMAL  EQU   X'10'          CONVERT TO DECIMAL INDICATOR.             61700002
         L     R15,TSTCONVT   CONVERT'S BRANCH ENTRY.                   61800002
         BALR  R14,R15        GO TO CONVERT.                            61900002
FMCVT    LTR   R15,R15        BACK FROM CONVERT.                        62000002
         BNZ   FROMCVT        NOT ZERO. GO TO BRANCH TABLE.             62100002
         L     R3,CONAREA     GET CONVERTED LENGTH.                     62200002
         L     R4,X1(R3)      DITTO.                                    62300002
         ST    R4,WALENGTH    SAVE IT FOR THE MAIN ROUTINE.             62400002
         L     R5,MAXIMUM     Q.GREATER THAN 65,535                     62500002
         CR    R4,R5          Q. IS IT.                                 62600002
         BNH   REGLNCHK       NO. CHECK FOR REGISTERS SPECIFIED.        62700002
         LA    R4,M0064       MSG - INVALID LENGTH                      62750002
         LA    R3,M0284       MSG - LEN BTWN 0 AND 65535                62800002
FMCVT2   BAL   R11,MSG3       GO OUTPUT MESSAGES                        62850002
         CH    R15,ATTNCODE   WAS ATTENTION HIT                         62900002
         BNL   QUIT           YES, RETURN                               62950002
         B     PROMPT1        PROMPT 'REENTER'                          63100002
         SPACE                                                          63200002
REGLNCHK TM    WAFROM,X80     IS REG SPECIFIED AS 'FROM' ADDR ?         63210002
         BO    MAX64          YES. CHECK MAX LENGTH OF 64.              63220002
         TM    WATO,X80       IS REG SPECIFIED AS 'TO' ADDR ?           63230002
         BZ    PARSRET0       NO. RETURN NORMALLY.                      63240002
MAX64    LA    R5,N64         TOTAL SIZE OF REGS IS 64.                 63242002
         CR    R4,R5          DOES LENGTH EXCEED 64?                    63244002
         BNH   PARSRET0       NO. RETURN NORMALLY TO PARSE.             63246002
         LA    R4,M0064       MSG - INVALID LENGTH                      63248002
         LA    R3,M0266       MSG - LEN 64 WHEN REGS SPEC.              63248102
         B     FMCVT2         BUILD AND PRINT MESSAGES.                 63248402
         SPACE                                                          63250002
PARSRET0 SR    R15,R15        RET. CODE OF ZERO.                        63300002
PARSRET  EQU   *              RETURN TO PARSE                           63350002
         NI    TSTFLGS4,XFF-TSTVALCK SHUT OFF VALIDITY FLAG             63360002
         L     R4,OUTBUF      ACCESS POINTER TO OUTBUF                  63370002
         L     R4,X0(R4)      ACCESS 1ST WORD OF OUTBUF                 63380002
         LTR   R4,R4          IS THERE A SECOND LEVEL MESSAGE           63390002
         BZ    PARSRETN       NO, RETURN TO PARSE                       63392002
         MVC   VAL2LVL(X4),OUTBUF  YES, GIVE IT TO PARSE                63394002
PARSRETN L     R13,X4(R13)    GET PARSE'S R13                           63400002
         RETURN  (14,12),T,RC=(15)  RETURN.                             63500002
         SPACE                                                          63600002
         EJECT                                                          67800002
*        STAE RETRY ROUTINE.                                            67900002
         SPACE                                                          68000002
STAERTRY EQU   *              ABEND PROCESSING HERE.                    68100002
         L     R3,CVTPTR      GET CVT PTR.                              68200002
         L     R4,X0(R3)      GET DOUBLE WORD PTR(NEW , CURRENT)        68300002
         L     R5,X4(R4)      GET CURRENT TCB PTR.                      68400002
         L     R9,TCBTRN-TCB(R5)  GET TCOMTAB ADDRESS.                  68500002
         L     R13,REGSAVE2   GET THE MAIN ROUTINE'S REGISTERS.         68600002
         L     R12,CPYBASE-STAERTRY(R15)  DITTO.                        68700002
         LM    R2,R11,N28(R13)  DITTO.                                  68800002
NOFREE   EQU   *                                                        68850002
         LA    R15,RC20       RETURN TO MAINLINE(IKJEGMNL) WITH 20      69300002
         B     MNLRET         GO.                                       69400002
         EJECT                                                          70600002
* THE FOLLOWING ARE MESSAGE OUTPUTTING ROUTINES.                        70650002
MSG1     XC    TSTIOPRM,TSTIOPRM  CLEAR PARAMETER AREA                  70660002
         IKJEGSIO MSG,FIRST=(R2),SECOND=(R3),ID=CPY08,                 *70670002
               MF=(E,TSTIOPRM) CALL IO                                  70680002
         CH    R15,ATTNCODE   WAS RET CODE GREATER OR = 16              70692402
         BNL   MNLRET         YES, RETURN                               70694002
         BR    R11            NO, BRANCH AND CONTINUE                   70696002
         SPACE                                                          70696402
MSG2     XC    TSTIOPRM,TSTIOPRM CLEAR PARAMETER AREA                   70698002
         IKJEGSIO MSG,FIRST=(R2),INST11=(NUM,I0030),SECOND=(R3),       *70698402
               ID=CPY08,MF=(E,TSTIOPRM) CALL IO                         70698802
         CH    R15,ATTNCODE   WAS RET CODE GREATER OR = 16              70699302
         BNL   MNLRET         YES, RETURN                               70699602
         BR    R11            NO, BRANCH AND CONTINUE                   70699702
         SPACE                                                          70699802
MSG3     XC    TSTIOPRM,TSTIOPRM CLEAR PARAMETER AREA                   70699902
         IKJEGSIO MSG,FIRST=(R4),INST11=(VPDE,(R2)),SECOND=(R3),       *70700002
               ID=CPY08,MF=(E,TSTIOPRM) CALL IO                         70733202
         BR    R11            CONTINUE PROCESSING                       70743202
         SPACE                                                          70745202
MSG4     XC    TSTIOPRM,TSTIOPRM CLEAR PARAMETER AREA                   70753202
         IKJEGSIO MSG,FIRST=(R4),INST11=(APDE,(R2)),SECOND=(R3),       *70763202
               ID=CPY08,MF=(E,TSTIOPRM) CALL IO                         70765202
         BR    R11            CONTINUE PROCESSING                       70765602
         SPACE                                                          70766002
LINKERR  LR    R3,R1          REG 3 = ABEND CODE                        70766402
         LR    R4,R15         REG 4 = RETURN CODE                       70766502
         XC    TSTIOPRM,TSTIOPRM CLEAR PARAMETER AREA                   70766602
         IKJEGSIO SVCERR,SVC=6,ABENDRG=(R3),RC=(R4),                   *70777702
               INST11=(NUM,I0040),ID=CPY08,MF=(E,TSTIOPRM) CALL IO      70787702
         CH    R15,ATTNCODE   IS RET CODE LESS THAN 16                  70788202
         BNL   MNLRET         NO, RETURN TO MAINLINE                    70788302
         B     MNLRET0        YES, SET RC=0, RETURN                     70788402
         SPACE                                                          70788502
LISTESTA IKJEGSPL RTRY=STAERTRY,ABNTB=ABTAB,MODNM=IKJEGCPY,            *70790802
               TNM=COPY       SET UP PARAMETER LIST FOR ESTAE           70791202
         EJECT                                                          70792502
*        LIST FORMS                                                     70796302
         SPACE                                                          70800002
****ESTAE CHANGES***                                                    70850002
****STAELIST ESTAE MF=L                                                 70860002
STAELIST ESTAE MF=L           ESTAE LIST FORM.                          70900002
STAELSTL EQU   *-STAELIST                                               71000002
         EJECT                                                          71100002
*        CONSTANTS                                                      71200002
         SPACE                                                          71300002
STAEADDR DC    AL3(STAERTRY)  ADDRESS OF STAE RETRY ADDRESS.            71400002
ONE      DC    H'1'           DECIMAL ONE                               71500002
SIX      DC    H'6'           DECIMAL 6                                 71600002
ATTNCODE DC    H'16'          DECIMAL 16                                71700002
H4       DC    H'4'           CONSTANT FOR R.C. COMPARE                 71750002
H8       DC    H'8'           CONSTANT FOR R.C. COMPARE                 71760002
         SPACE 1                                                        71800002
ABTAB    DS    0F             I.C. TABLE AND CODES FOR IKJEGSTA.        71900002
         DC    AL1(I0097),AL3(BLOW1A) PROTECTION CHECK                  72000002
         DC    AL1(I0097),AL3(BLOW1)  PROTECTION CHECK                  72100002
         DC    AL1(I0097),AL3(BLOW2A) PROTECTION CHECK                  72150002
         DC    AL1(I0097),AL3(BLOW2)  PROTECTION CHECK                  72200002
         DC    AL1(I0097),AL3(BLOW3A) PROTECTION CHECK                  72250002
         DC    AL1(I0097),AL3(BLOW3)  PROTECTION CHECK                  72260002
         DC    AL1(I0097),AL3(BLOW4A) PROTECTION CHECK                  72270002
         DC    AL1(I0097),AL3(BLOW4)  PROTECTION CHECK                  72280002
         DC    AL1(I0097),AL3(BLOW5A) PROTECTION CHECK                  72290002
         DC    AL1(I0097),AL3(BLOW5)  PROTECTION CHECK                  72292002
         DC    AL1(I0097),AL3(BLOW6A) PROTECTION CHECK                  72294002
         DC    AL1(I0097),AL3(BLOW6)  PROTECTION CHECK                  72296002
         DC    AL1(I0097),AL3(BLOW7A) PROTECTION CHECK                  72298002
         DC    AL1(I0097),AL3(BLOW7)  PROTECTION CHECK                  72298402
         DC    AL1(I0099),AL3(BLOWPARS)   LINK TO PARSE FAILED.         72300002
         DC    AL1(255),AL3(0)  END OF TABLE INDICATOR.                 72400002
         SPACE 1                                                        72500002
         DS    0F                                                       72600002
CPYBASE  DC    AL1(CPYCODE),AL3(IKJEGCPY)  BASE FOR MAIN ROUTINE.       72700002
FMBASE   DC    AL1(FMCODE),AL3(IKJEGCPY)  BASE FOR 'FROM' KEYWORD.      72800002
TOBASE   DC    AL1(TOCODE),AL3(IKJEGCPY)  BASE FOR 'TO' KEYWORD.        72900002
LNBASE   DC    AL1(LNCODE),AL3(IKJEGCPY)  BASE FOR 'LENGTH' KEYWORD.    73000002
MAXIMUM  DC    A(65535)       MAXIMUM LENGTH.                           73100002
PRMAD    DC    A(IKJEGPRM)    POINTER TO PARSE CSECT.                   73200002
CHNGREGS DC    X'04000000'    CODE FOR SVC 97.                          73300002
CHNGALL  DC    X'FF000000'    CODE TO CHANGE ALL REGISTERS.             73400002
REGCODE  DC    X'80000000'    HIGH BIT INDICATES GENERAL REGISTER.      73500002
CONSTANT DC    60C'Z'         PATCH AREA                                73550002
         EJECT                                                          73600002
         SPACE                                                          73700002
*        PARSE CSECT/DSECT                                              73800002
         SPACE                                                          73900002
IKJEGPRM IKJPARM                                                        74000002
PRMF     IKJPOSIT  ADDRESS,VALIDCK=IKJEGFM,PROMPT='FROM ADDRESS'        74100002
PRMT     IKJPOSIT  ADDRESS,VALIDCK=IKJEGTO,PROMPT='TO ADDRESS'          74200002
PRMP     IKJKEYWD                                                       74300002
         IKJNAME  'POINTER'                                             74400002
         IKJNAME  'NOPOINT'                                             74500002
PRMLNKEY IKJKEYWD                                                       74600002
         IKJNAME  'LENGTH',SUBFLD=PRMLNSUB                              74700002
PRMLNSUB IKJSUBF                                                        74800002
PRML     IKJIDENT   'LENGTH',FIRST=NUMERIC,OTHER=NUMERIC,MAXLNTH=5,    *74900002
               VALIDCK=IKJEGLN,PROMPT='LENGTH'                          75000002
         IKJENDP                                                        75100002
         EJECT                                                          75200002
         BRKELEM              BREAK ELEMENT DSECT                       75250002
         EJECT                                                          79300002
         IKJTCB                                                         79400002
         EJECT                                                          79500002
         TCOMTAB                                                        79600002
         EJECT                                                          79700002
         TSTCWORK                                                       79800002
         SPACE 5                                                        79900002
         IKJPARMA                                                       80000002
         END                                                            80100002
./  ADD  SSI=81740573,NAME=IKJEGCVT
CVT      TITLE ' * MVM * IKJEGCVT THE CONVERSION ROUTINE OF TEST'       00020002
         COPY IKJEGSIO                                                  00032002
IKJEGCVT CSECT                                                          00040002
*C59800                                        ZA09259,ZA10462,ZA07138  00050003
*D60600                                                        ZA07138  00060003
*A047397,047398                                                  YM0568 00090002
*A530420,530500                                                 YA00086 00140002
*A047130                                                       @ZA11823 00143003
*C047140                                                       @ZA11823 00146003
*C50040000                                                     @ZA11367 00149003
*A50042000-50050000                                            @ZA11367 00152003
*A159182                                                       @ZA28933 00155003
*****************************  PROLOGUE  ****************************** 00160002
* STATUS  CHANGE LEVEL  00, VERSION NUMBER 01, OS/VS2                 * 00180002
*                                                                     * 00200002
* FUNCTION                                                            * 00220002
*    THIS MODULE IS A UTILITY PROGRAM USED BY THE 'TEST' PACKAGE      * 00240002
*    OF THE TIME SHARING OPTION (TSO) FOR AOS/370 MVT.  IT IS         * 00260002
*    CALLED BY VARIOUS TEST ROUTINES TO PERFORM DATA TRANSLATION      * 00280002
*    TO/FROM BINARY FROM/TO A PRINTABLE FORMAT.  THIS ROUTINE IS      * 00300002
*    ABLE TO CONVERT TO BINARY FROM THE FOLLOWING PRINTABLE FOR-      * 00320002
*    MATS- A, B, D, E, F, H, P, S, X, AND Y.  IN ADDITION, IT IS      * 00340002
*    ABLE TO CONVERT FROM BINARY TO THE FOLLOWING PRINTABLE FOR-      * 00360002
*    MATS- A, D, E, F, H, I, P, S, X, AND Y.                          * 00380002
*                                                                     * 00400002
* ENTRY POINTS                                                        * 00420002
*                                                                     * 00440002
*    IKJEGCVT-ENTRY POINT FOR ADDRESS AND VALUE CONVERSIONS.          * 00460002
*                                                                     * 00480002
*    IKJEGCOP-ENTRY POINT FOR THE OPCODE TABLE.                       * 00500002
*                                                                     * 00520002
* INPUT                                                               * 00540002
*    GENERAL PURPOSE REGISTER ZERO                                    * 00560002
*         IF NEGATIVE, INDICATES CONVERSION TO PRINTABLE FORMAT.      * 00580002
*         IF POSITIVE, INDICATES CONVERSION TO BINARY FORMAT.         * 00600002
*    GENERAL PURPOSE REGISTER ONE POINTS TO A PARSE-LIKE PARAME-      * 00620002
*    TER DESCRIPTOR LIST (PDL) CONTAINING AN ADDRESS OR A VALUE       * 00640002
*    PARSE-LIKE DESCRIPTOR ENTRY (PDE)                                * 00660002
*         IF NEGATIVE, INDICATES AN ADDRESS CONVERSION.               * 00680002
*         IF POSITIVE, INDICATES A VALUE CONVERSION.                  * 00700002
*                                                                     * 00720002
* OUTPUT                                                              * 00740002
*    FOR ADDRESS CONVERSION                                           * 00760002
*         1).  BINARY TO PRINTABLE CONVERSION OUTPUT IS RETURNED      * 00780002
*              IN CONAREA.                                            * 00800002
*         2).  PRINTABLE TO BINARY CONVERSION OUTPUT IS RETURNED      * 00820002
*              IN THE USER WORD OF THE ADDRESS PDE.                   * 00840002
*    FOR VALUE CONVERSION                                             * 00860002
*         THIS ROUTINE PLACES IN A SECTION OF CORE, POINTED TO        * 00880002
*         TO BY 'CONAREA' IN THE TEST COMMUNICATION TABLE (TCOMTAB)   * 00900002
*         THE FOLLOWING                                               * 00920002
*         1).  LENGTH OF CONVERTED OUTPUT.  (FIRST BYTE).             * 00940002
*         2).  ACTUAL CONVERTED OUTPUT.  (REMAINING BYTES).           * 00960002
*                                                                     * 00980002
* EXTERNAL REFERENCES                                                 * 01000002
*                                                                     * 01020002
*    IKJEGSYM - THE CONVERT ROUTINE CALLS UPON IKJEGSYM TO PER-       * 01040002
*    *          FORM RESOLUTION FOR ALL SYMBOLIC ADDRESSES AS         * 01060002
*    *          WELL AS FOR THE SYMBOLIC PART OF ADDRESS EXPRES-      * 01080002
*    *          SIONS.  IT EXPECTS IKJEGSYM TO SET THE FIRST BYTE     * 01100002
*    *          OF THE USER WORD OF THE ADDRESS PDE TO X'80' AND      * 01120002
*    *          TO SET THE REMAINING THREE BYTES TO POINT TO A        * 01140002
*    *          SYMBOL INFORMATION BLOCK (SYMINFO) WHOSE FIRST        * 01160002
*    *          WORD CONTAINS THE BINARY REPRESENTATION OF THE        * 01180002
*    *          ADDRESS.                                              * 01200002
*                                                                     * 01220002
*    IKJEGIO  - I/O IS CALLED TO WRITE DIAGNOSTIC MESSAGES;   IT      * 01240002
*    *          IS INVOKED VIA THE IKJEGSIO MACRO.                    * 01260002
*                                                                     * 01360002
*    ESTAE    - ESTABLISH ABEND RECOVERY EXIT ROUTINE (IKJEGSTA)      * 01410002
*                                                                     * 01430002
* EXITS, NORMAL                                                       * 01480002
*    RETURN VIA GENERAL PURPOSE REGISTER FOURTEEN.                    * 01500002
*    RETURN CODE ZERO IN GENERAL PURPOSE REGISTER FIFTEEN.            * 01520002
*                                                                     * 01540002
* RETURN CODES                                                        * 01550002
*    00 - SUCCESSFULLY COMPLETED CONVERSION.                          * 01552002
*    04 - UNABLE TO CONVERT A VALUE.                                  * 01554002
*    16 - ATTENTION HAS BEEN SCHEDULED.                               * 01554402
*    20 - ESTAE EXIT ROUTINE HAS INTERCEPTED A SCHEDULED ABEND.       * 01554802
*    24 - COULD NOT ISSUE ESTAE.                                      * 01555202
*                                                                     * 01556002
* EXITS, ERROR                                                        * 01560002
*    RETURN VIA GENERAL PURPOSE REGISTER FOURTEEN.                    * 01580002
*    RETURN CODE FOUR (4) - UNABLE TO CONVERT VALUE.                  * 01600002
*    RETURN CODE SIXTEEN (16) - ATTENTION IN EFFECT.                  * 01620002
*                                                                     * 01640002
* TABLES/WORK AREAS                                                   * 01660002
*    TCOMTAB - TEST TABLE AND WORKAREA                                * 01670002
*                                                                     * 01672002
* ATTRIBUTES                                                          * 01680002
*    REENTRANT, REFRESHABLE                                           * 01700002
*                                                                     * 01702002
* CHARACTER CODE DEPENDENCY --                                        * 01710002
*    RE-ASSEMBLY IS REQUIRED FOR CHANGE OF CODE                       * 01712002
*                                                                     * 01720002
* NOTES                                                               * 01740002
* CHANGE-ACTIVITY -                                                     01741003
*                APAR OZ07138 FIXES A PROBLEM WITH FETCHING AND         01742003
*                STORING REGISTERS IN THE INCORRECT RB WHEN AN          01743003
*                ASYNCHRONOUS EXIT CAUSES AN IRB TO BE CHAINED ON       01744003
*                THE TCB/RB QUEUE.  THE FIX IS BEFORE LABEL REGPK.      01745003
*                THE SVC 97 SVRB WILL BE POINTED TO OUT OF TCOMTAB      01746003
*                AT LABEL ECBPP+1.                                      01747003
*                APAR OZ09259 - SAME AS ABOVE.                          01748003
*                APAR OZ10462 - SAME AS ABOVE.                          01749003
*                APAR OZ11823 - CORRECT EXIT ROUTINE SPECIFICATION      01750003
*                FOR ESTAE MACRO.                                       01751003
*                                                                     * 01760002
*********************************************************************** 01780002
         EJECT                                                          01800002
R0       EQU   0                       ******************************** 01820002
R1       EQU   1                       *                              * 01840002
R2       EQU   2                       *        REGISTERS             * 01860002
R3       EQU   3                       *                              * 01880002
R4       EQU   4                       *         EQUATES              * 01900002
R5       EQU   5                       *                              * 01920002
R6       EQU   6                       *                              * 01940002
R7       EQU   7                       *                              * 01960002
R8       EQU   8                       *                              * 01980002
R9       EQU   9                       *         REGISTERS            * 02000002
R10      EQU   10                      *                              * 02020002
R11      EQU   11                      *         EQUATES              * 02040002
R12      EQU   12                      *                              * 02060002
R13      EQU   13                      *                              * 02080002
R14      EQU   14                      *                              * 02100002
R15      EQU   15                      ******************************** 02120002
@0       EQU   0                                                        02130002
@4       EQU   4                                                        02130402
@6       EQU   6                                                        02130802
@12      EQU   12                                                       02132002
@16      EQU   16                                                       02134002
@20      EQU   20                                                       02136002
@24      EQU   24                                                       02136402
@60      EQU   60                                                       02138002
BASEDISP EQU   2                                                        02140002
EXPPLUS  EQU   C'+'                                                     02160002
B7       EQU   X'B7'                   FOR ALPHABETIC CONVERSION        02180002
F0       EQU   X'F0'                   FOR NUMERIC CONVERSIONS          02200002
ZERO     EQU   0                       ZERO                             02220002
ONE      EQU   1                       ONE                              02240002
TWO      EQU   2                       TWO                              02260002
THREE    EQU   3                       THREE                            02280002
FOUR     EQU   4                       FOUR                             02300002
FIVE     EQU   5                       FIVE                             02320002
SIX      EQU   6                       SIX                              02340002
SEVEN    EQU   7                       SEVEN                            02360002
EIGHT    EQU   8                       EIGHT                            02380002
NINE     EQU   9                       NINE                             02400002
TEN      EQU   10                      TEN                              02420002
ELEVEN   EQU   11                      ELEVEN                           02440002
ONE2     EQU   12                      TWELVE                           02460002
HEXFF    EQU   X'FF'                   HEX FF                           02480002
HEX00    EQU   X'00'                   HEX 00                           02500002
HEX40    EQU   X'40'                   HEX 40                           02520002
HEX80    EQU   X'80'                   HEX 80                           02540002
HEXC0    EQU   X'C0'                   HEX C0                           02560002
HEXF0    EQU   X'F0'                   HEX F0                           02580002
HEX04    EQU   X'04'                   HEX 04                           02600002
HEX0F    EQU   X'0F'                   HEX 0F                           02620002
HEX08    EQU   X'08'                   HEX 08                           02640002
HEX01    EQU   X'01'                   HEX 01                           02660002
HEX13    EQU   X'13'                   HEX 13                           02680002
HEX0C    EQU   X'0C'                   HEX 0C                           02700002
EXP      EQU   X'FF'                   HEX FF                           02720002
ONE3     EQU   13                      DEC 13                           02740002
ONE1     EQU   11                      DEC 11                           02760002
ONE4     EQU   14                      DEC 14                           02780002
ONE5     EQU   15                      DEC 15                           02800002
ONE6     EQU   16                      DEC 16                           02820002
ONE9     EQU   19                      DEC 19                           02840002
EXPIND   EQU   10                                                       02860002
TWO4     EQU   24                      DEC 24                           02880002
TWO3     EQU   23                      DEC 23                           02900002
TWO6     EQU   26                      DEC 26                           02920002
ONE7     EQU   17                      DEC 17                           02940002
NOFZONE  EQU   34                                                       02960002
TWO7     EQU   27                      DEC 27                           02980002
TWO8     EQU   28                      DEC 28                           03000002
THREE2   EQU   32                      DEC 32                           03020002
FORTY    EQU   40                      DEC 40                           03040002
*        GENERAL CONSTANTS USED BY THE CONVERT MODULES                  03052002
VALLEN   EQU   5                       FIVE                             03060002
STARTER  EQU   X'21'                   HEX 21                           03080002
LENSYM   EQU   8                       MAXIMUM LEN FOR SYMBLES.         03100002
PACKSIGN EQU   25                      DEC 25                           03120002
OUTLEN   EQU   X'70'                   HEX 70                           03140002
WORK2    EQU   16                      DEC 16                           03160002
WORK3    EQU   26                      DEC 26                           03180002
FIXED    EQU   47                      OFFSET TO END OF ZONED DATA.     03200002
WORK4    EQU   8                       EIGHT                            03220002
WORK5    EQU   18                      DEC 18                           03240002
FDECSTAR EQU   44                      DEC 44                           03260002
OPTAB4   EQU   4                       DEC 4                            03280002
NEGBYTE  EQU   X'FF'                   HEX FF                           03300002
HION     EQU   X'80'                   HEX 80                           03302002
*        NON NUMERIC CONSTANTS                                          03310002
SIGNNEG  EQU   C'-'                    MINUS SIGN                       03320002
PLUSSIGN EQU   C'+'                    PLUS SIGN                        03340002
BLANK    EQU   C' '                    BLANK                            03360002
AZERO    EQU   C'0'                    CHAR ZERO                        03400002
PLUS     EQU   C'+'                    CHAR PLUS                        03420002
MINUS    EQU   C'-'                    CHAR MINUS                       03440002
CLOSE    EQU   C')'                    CLOSE PREN                       03540002
OPEN     EQU   C'('                    OPEN PREN                        03560002
COMMA    EQU   C','                    COMMA                            03580002
PERIOD   EQU   C'.'                    PERIOD                           03600002
*        MORE NUMERIC CONSTANTS TO BE USED BY THE CONVERT MODULE        03602002
OPSSVAL  EQU   X'20'                   HEX 20                           03610002
OPRRVAL  EQU   X'04'                   HEX 04                           03612002
OPSIVAL  EQU   X'1C'                   HEX 1C                           03614002
OPRSVAL  EQU   X'0C'                   HEX 0C                           03616002
LEN7     EQU   X'07'                   HEX 07                           03620002
GENMASK  EQU   X'20'                   HEX 20                           03640002
DOBMASK  EQU   X'10'                   HEX 10                           03660002
SINMASK  EQU   X'08'                   HEX 08                           03680002
BADPK    EQU   X'09'                   HEX 09                           03700002
LOWORDER EQU   28                      DEC 28                           03720002
TCBGRS   EQU   32                      DEC 32                           03740002
TWO0     EQU   20                      DEC 20                           03760002
SYMCK    EQU   X'80'                   HEX 80                           03780002
VALCK    EQU   X'80'                   HEX 80                           03800002
SIGNF    EQU   X'0F'                   HEX 0F                           03820002
RSIGN    EQU   C'R'                    CHAR R                           03840002
PLUSBIT  EQU   X'01'                   HEX 01                           03860002
PLUSBITS EQU   X'0F'                   HEX 0F                           03880002
ODDLEN   EQU   X'01'                   HEX 01                           03900002
HCODE    EQU   X'14'                   HEX 14                           03920002
HEX      EQU   X'02'                   HEX 02                           03940002
F1       EQU   X'01'                   HEX 01                           03960002
STCTLM   EQU   X'B6'                   OP CODE FOR STCTL.               03980002
STNSMM   EQU   X'AC'                   OP CODE FOR STNSM 370-R.         04000002
STOSMM   EQU   X'AD'                   OP CODE FOR STOSM 370 R.         04020002
SIOFOP   EQU   X'9C'                   OP CODE FOR SIO AND SIOF.        04040002
SRPOP    EQU   X'F0'                   OP CODE FOR SRP.                 04060002
B2       EQU   X'B2'                   FIRST BYTES FOR 370 2 BYTE       04080002
*                                      OP CODES.                        04100002
CHARS    EQU   C'S'                                                     04120002
CHARF    EQU   C'F'                                                     04140002
YCODE    EQU   X'24'                                                    04160002
FIXCOUNT EQU   31                      LOOP COUNT FOR FIXDEC.           04180002
FEXPPDE  EQU   16                                                       04200002
SIGNIT   EQU   25                      LOC OF SIGN BYTE OF PACK DATA.   04220002
PKLEN    EQU   X'70'                                                    04240002
REGIN    EQU   3                                                        04260002
RDSIGN   EQU   C'D'                                                     04280002
RESIGN   EQU   C'E'                                                     04300002
PACKANS  EQU   16                      ANSWER PLACE OFFSET FOR PACK.    04320002
PACKWORK EQU   26                      OFFSET FOR UPDATED PACK VALUE.   04340002
         EJECT                                                          04360002
         TITLE '* AOS * IKJEGCVT ADDRESS AND VALUE ROUTING ROUTINE.'    04380002
         ENTRY IKJEGBL1                                                 04410002
CVTBEGIN SAVE  (14,12),,*                                               04420002
         LR    R12,R15                 R12=ADDR OF BEGINNING OF CSECT.  04440002
         USING CVTBEGIN,R12            CSECT ADDRESSABILITY.            04460002
         USING TCOMTAB,R9              TCOMTAB ADDRESSABILITY.          04480002
         L     R15,REGSAVE4            R15=ADDR OF MODULE SAVE AREA.    04500002
         ST    R13,FOUR(R15)           SAVE ADDR OF CALLER SAVE AREA.   04520002
         ST    R15,EIGHT(R13)          ADDR IN CALLER SAVE AREA.        04540002
         LR    R13,R15                 R13=ADDR OF MODULE SAVE AREA.    04560002
         SPACE                                                          04580002
*********************************************************************** 04600002
*                                                                     * 04620002
*        THE FOLLOWING INSTRUCTIONS ESTABLISH ESTAE SUPPORT FOR CVT   * 04640002
*                                                                     * 04680002
*********************************************************************** 04700002
         L     R3,WORKAREA        POINT TO CVT WORKAREA                 04710002
         XC    @0(ESTAELN,R3),@0(R3)  CLEAR AREA FOR ESTAE EXPANSION    04712002
         L     R15,TSTSTAE        GET ESTAE ROUTINE ADDRESS    @ZA11823 04712603
         ESTAE (R15),CT,PARAM=LIST,RECORD=YES,MF=(E,(R3))      @ZA11823 04713203
         LTR   R15,R15            WAS 'ESTAE' ACCEPTED                  04716002
         BZ    RESTORE1           IF R15=0, 'ESTAE' WAS ACCEPTED        04718002
         STC   R15,TSTESTRC       PLACE ESTAE RC IN TCOM TABLE          04718402
         LA    R15,@24            SET RETURN CODE TO DECIMAL 24         04718802
         B     AFTERSCB           GO RETURN                             04719202
         SPACE                                                          04720002
*********************************************************************** 04730002
*                                                                     * 04732002
*        THE FOLLOWING INSTRUCTIONS ROUTE CONTROL TO THE PROPER       * 04734002
*        CONVERSION AREA, ADDRESS OR EXPRESSION VALUE.                * 04736002
*                                                                     * 04738002
*********************************************************************** 04738402
         SPACE                                                          04738802
RESTORE1 L     R15,REGSAVE4       R15=ADDR OF MODULE SAVE AREA          04739202
         L     R1,FOUR(R15)       GET ADDR OF CALLER'S SAVE AREA        04739602
         L     R0,@20(R1)         RESTORE R0                     YM0568 04739702
         L     R1,@24(R1)         RESTORE R1                     YM0568 04739802
         LTR   R1,R1                   Q.AN ADDRESS CONVERSION.         04740002
         BP    VALCVT                  R1 IS POSITIVE, VALUE CONVERSION 04760002
         SPACE                                                          04780002
*********************************************************************** 04800002
* THE FOLLOWING INSTRUCTIONS DETERMINE IF THE ADDRESS CONVERSION IS   * 04820002
* TO BE TO OR FROM BINARY.                                            * 04840002
*********************************************************************** 04860002
         SPACE                                                          04880002
         L     R3,WORKAREA             R3=ADDRESS OF WORKAREA.          04900002
         LCR   R1,R1                   R1=ADDRESS POSITIVE.             04920002
         LR    R8,R1                   R8=ADDRESS OF PDE.               04940002
         USING IKJPARMA,R8             PDE ADDRESSABILITY.              04960002
         LTR   R0,R0                   Q.CONVERSION TO BINARY.          04980002
         BM    FROMBIN                 RO IS NEG CVT FROM BINARY.       05000002
         TITLE 'IKJEGCVT ADDRESS VALIDITY CHECKING ROUTINE.'            05020002
TOBIN    EQU   *                                                        05040002
         SPACE                                                          05060002
*********************************************************************** 05080002
*                                                                     * 05100002
*        THE FOLLOWING INSTRUCTIONS CONVERT AN ADDRESS FROM           * 05120002
*        PRINTABLE CHARACTERS TO THEIR BINARY FORMAT.                 * 05140002
*                                                                     * 05160002
*********************************************************************** 05180002
         SPACE                                                          05200002
* THE TEST UNDER MASK ROUTES CONTROL TO THE PROPER CONVERSION CODE.   * 05220002
         SPACE                                                          05240002
         TM    PDEFLG4,ABSCOMPL        Q.IS ADDR ABSOLUTE.              05260002
         BZ    NOENTRY                 YES,CONVERT AN ABSOLUTE ADDR.    05280002
         TM    PDEFLG4,SYMADDR         Q.IS ADDR SYMBOLIC.              05300002
         BO    SYMFOUND                YES,CONVERT A SYMBOLIC ADDR.     05320002
         TM    PDEFLG4,RELADDR         Q.IS ADDR A RELATIVE.            05340002
         BO    RELFOUND                YES,CONVERT A RELATIVE ADDR.     05360002
         TM    PDEFLG4,CTONLY          Q.ONLY ENTRYNAME SPECIFIED.      05380002
         BO    ENTNAME                 YES,GET ADDR OF ENTRYNAME.       05400002
         SPACE                                                          05420002
*********************************************************************** 05440002
* THIS SECTION OF CODE CONVERTS A REGISTER FROM ITS PRINTABLE FORMAT  * 05460002
* TO ITS BINARY FORMAT.  IF THE REGISTER IS A GENERAL PURPOSE         * 05480002
* REGISTER AND IS INDIRECTED, THE VALUE POINTED TO BY THE INDIRECT    * 05500002
* WILL BE CONVERTED TO BINARY AND RETURNED IN THE USERWORD.           * 05520002
*********************************************************************** 05540002
         SPACE                                                          05560002
         LH    R4,PDELEN3              R4=LENGTH OF INPUT.              05580002
         LA    R5,PKLEN                R5=LENGTH OF PACKED DATA.        05600002
         BCTR  R4,ZERO                 R4=EXECUTE LENGTH.               05620002
         OR    R4,R5                   R4=L1 & L2.                      05640002
         L     R2,PDEADRPT             R2=ADDR OF INPUT.                05660002
         EX    R4,REGPK                REG NOW PACKED DATA.             05680002
         CVB   R4,ZERO(R3)             R4=BINARY VALUE OF REG.          05700002
         ST    R4,ZERO(R3)             BINARY NOW IN WORKAREA.          05720002
         SPACE                                                          05740002
* CHECK  TO DETERMINE IF INDIRECT ADDRESSING HAS BEEN SPECIFIED.      * 05760002
         SPACE                                                          05780002
         LH    R7,PDEINDCT             R7=INDIRECT VALUE.               05800002
         CH    R7,ZEROS                Q.IS INDIRECT SPECIFIED.         05820002
         BE    EXPVAL                  NO,CHECK FOR MORE EXP VALUES.    05840002
         SPACE                                                          05860002
*********************************************************************** 05880002
* THE FOLLOWING INSTRUCTIONS LOCATE THE REGISTER SPECIFIED IN THE     * 05900002
* PROBLEM PROGRAM TCB TO GET THE CONTENT OF THE REGISTER.             * 05920002
*********************************************************************** 05940002
         SPACE                                                          05960002
         L     R5,ECBPP                R5=ADDR OF 9G SVRB      @ZA07138 05980003
*                                                              @ZA09259 05985003
*                                                              @ZA10462 05990003
         SR    R6,R6                   R6=0.                            06000002
         IC    R6,THREE(R3)            R6=REGISTER NUMBER IN BINARY.    06020002
         SLL   R6,TWO                  R6=REGISTER OFFSET VALUE.        06040002
         L     R5,TCBGRS(R6,R5)        R5=CONTENT OF REGISTER IN PPTCB. 06080002
         LA    R5,ZERO(R5)             CLEAR HIGH ORDER BYTE.           06100002
         ST    R5,ZERO(R3)             CONTENT OF REG NOW IN WORKAREA.  06120002
         BCT   R7,NEXTADDR             GET NEXT ADDR.                   06140002
         B     EXPVAL                  CHECK FOR INDIRECTING.           06160002
REGPK    PACK  ZERO(ONE,R3),ZERO(ONE,R2) INPUT NOW PACKED DECIMAL.      06180002
         SPACE                                                          06200002
*********************************************************************** 06220002
* THIS SECTION OF CODE CONVERTS A RELATIVE ADDRESS FROM ITS PRINT-    * 06240002
* ABLE FORMAT TO ITS BINARY FORMAT.  TO GET THE REQUIRED ADDRESS      * 06260002
* THE BINARY VALUE OF THE RELATIVE IS ADDED TO PPLOAD IF AN ENTRYNAME * 06280002
* WAS NOT SPECIFIED.  IF AN ENTRYNAME IS SPECIFIED CONTROL IS PASSED  * 06300002
* TO SYM TO RESOLVE THE ABSOLUTE ADDRESS OF THE ENTRYNAME.  THE       * 06320002
* RELATIVE VALUE IS THEN ADDED TO THE ABSOLUTE ADDRESS.               * 06340002
*********************************************************************** 06360002
         SPACE                                                          06380002
RELFOUND EQU   *                                                        06400002
         TM    PDEFLG2,CTNAMFLG        Q.ENTRYNAME SPECIFIED.           06420002
         BNO   NOENTRY                 NO,SKIP LINK TO SYM.             06440002
         NI    PDEFLG3,(HEXFF-AFLG)    TURN OFF PARAMETER SWITCH.       06460002
         BAL   R10,SYMLINK             GO CALL IKJEGSYM.                06480002
         OI    PDEFLG3,AFLG            TURN PARAMETER SWITCH ON.        06500002
         LTR   R15,R15                 Q.ENTRYNAME FOUND.               06520002
         BNZ   RETURN                  RETURN TO CALLER.                06540002
         NI    PDEFLG3,(HEXFF-AFLG)    TURN OFF PARAMETER SWITCH.       06560002
NOENTRY  EQU   *                                                        06580002
         SPACE                                                          06600002
*********************************************************************** 06620002
* THIS AREA OF CODE CONVERTS RELATIVE AND ABSOLUTE INPUT CHARACTERS   * 06640002
* TO BINARY VIA THE HEXBIN VALUE CONVERSION ROUTINE.                  * 06660002
*********************************************************************** 06680002
         SPACE                                                          06700002
         LA    R1,PDEADRPT             R1=ADDR OF VALUE TYPE PDE.       06720002
         BAL   R14,HEXBIN              LINK TO HEX TO BINARY ROUTINE.   06740002
         L     R2,CONAREA              R2=ADDRESS OF CONAREA.           06760002
         SR    R4,R4                   R4=0.                            06780002
         IC    R4,ZERO(R2)             R4=LENGTH OF RELATIVE.           06800002
         LA    R2,ONE(R2)              R2=OUTPUT STRING ADDRESS.        06820002
         L     R2,ZERO(R2)             R2=OUTPUT STRING.                06840002
         LA    R5,FOUR                 R5=4.                            06860002
         SR    R5,R4                   R5=NUMBER OF NONE VALID DIGITS.  06880002
         SLL   R5,THREE                R5=NUMBER OF BITS TO SHIFT.      06900002
         SRL   R2,ZERO(R5)             RELATIVE NOW RIGHT JUSTIFIED.    06920002
         ST    R2,ZERO(R3)             RELATIVE NOW IN WORKAREA.        06940002
         TM    PDEFLG4,ABSCOMPL        Q.ABSOLUTE SPECIFIED.            06960002
         BZ    INDIRECK                YES,CHECK FOR INDIRECKS.         06980002
         TM    PDEFLG3,AFLG            Q.ABSOLUTE ADDRESS IN USERWORD.  07000002
         BO    INFOSKIP                NO,GET PPLOAD.                   07020002
         LA    R7,PDEUSER              R7=QUALIFIED BASE ADDRESS.       07040002
         OI    PDEFLG3,AFLG            TURN PARAMETER SWITCH ON.        07060002
         B     PPSKIP                  SKIP PPLOAD CODE.                07080002
INFOSKIP EQU   *                                                        07100002
         LA    R7,PPLOAD               R7=ADDR OF CURRENT BASE FOR REL. 07120002
PPSKIP   EQU   *                                                        07140002
         MVC   FOUR(FOUR,R3),ZERO(R7)  MOVE CURRENT BASE INTO WORKAREA. 07160002
         L     R7,FOUR(R3)             R7=CURRENT BASE FOR RELATIVE.    07180002
         AL    R7,ZERO(R3)             R7=ABSOLUTE ADDRESS IN BINARY.   07200002
         ST    R7,ZERO(R3)             MOVE ABSOLTE ADDRESS TO WORKAREA 07220002
         SPACE                                                          07240002
*********************************************************************** 07260002
* THE FOLLOWING CODE WILL DETERMINE IF INDIRECTING WAS SPECIFIED. IF  * 07280002
* INDIRECTING IS SPECIFIED THE VALUE POINTED TO BY THE INDIRECT WILL  * 07300002
* BE PROCESSED.                                                       * 07320002
*********************************************************************** 07340002
         SPACE                                                          07360002
INDIRECK EQU   *                                                        07380002
         LH    R7,PDEINDCT             R7=INDIRECT COUNT.               07400002
         LTR   R7,R7                   Q.IS INDIRECTING REQUESTED.      07420002
         BZ    EXPVAL                  NO,CHECK FOR EXPRESSION VALUES.  07440002
         NI    PDEFLG5,HEXFF-PURESYM   TURN OFF SYMINFO SWITCH.         07460002
NEXTADDR EQU   *                                                        07480002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   07500002
*        BAL TO AN ADDRESS VALIDITY CHECK R3 = ADDR TO BE CHECKED   *   07520002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   07540002
         BAL   R10,ADDRVCK             IS THE ADDR VALID                07560002
         L     R6,ZERO(R3)             R6=ADDR OF NEXT VALUE.           07580002
         MVC   ZERO(FOUR,R3),ZERO(R6)  NEW VALUE NOW IN WORKAREA.       07600002
         MVI   ZERO(R3),ZERO           CLEAR HIGH ORDER BYTE.           07620002
         BCT   R7,NEXTADDR             DECREMENT INDIRECT COUNT.        07640002
         SPACE                                                          07660002
*********************************************************************** 07680002
* THE FOLLOWING INSTRUCTIONS CHECK FOR AN ADDRESS EXPRESSION VALUE.   * 07700002
* IF AN ADDRESS EXPRESSION IS INDICATED IT IS CONVERTED TO BINARY AND * 07720002
* ADDED TO THE ADDRESS ALREADY CALCULATED.                            * 07740002
*********************************************************************** 07760002
         SPACE                                                          07780002
EXPVAL   EQU   *                                                        07800002
         CLI   PDEEXPTR,EXP            Q.EXPRESSION SPECIFIED.          07820002
         BE    SKIPEXP                 NO,SKIP CODE TO TURN OFF SWITCH. 07840002
         NI    PDEFLG5,HEXFF-PURESYM   TURN OFF SYMINFO SWITCH.         07860002
SKIPEXP  EQU   *                                                        07880002
         L     R1,PDEEXPTR             R1=PT TO EXPRESSION PDE          07900002
         MVC   WORK4(ONE,R3),PDESIGN   SAVE EXPRESSION SIGN.            07920002
MOREVAL  EQU   *                                                        07940002
         LTR   R1,R1                   Q.MORE ADDRESS EXPRESSIONS.      07960002
         BM    CORECK                  NO,CHECK MAXIMUM CORE SIZE.      07980002
         SPACE                                                          08000002
*********************************************************************** 08020002
* THE FOLLOWING INSTRUCTION DETERMINE IF THE VALUE IS HEX OR DECML.   * 08040002
*********************************************************************** 08060002
         SPACE                                                          08080002
         TM    EIGHT(R1),HEX           Q.IS THE VALUE A HEX VALUE.      08100002
         BO    HEXVAL                  YES,CONVERT THE VALUE TO BINARY. 08120002
         SPACE                                                          08140002
* THIS AREA OF CODE CONVERTS A DECML VALUE TO BINARY BY A LINK TO     * 08160002
* FIXBIN(DECIMAL TO BINARY) ROUTINE.                                  * 08180002
         SPACE                                                          08200002
         SR    R5,R5                   R5=0,FOR FIXBIN ROUTINE.         08220002
         L     R0,ZERO(R3)             R0=ADDRESS.                      08240002
         BAL   R14,FAQVBIN             LINK TO FIXBIN CONVERT ROUTINE.  08260002
         SPACE                                                          08280002
*********************************************************************** 08300002
* THE FOLLOWING CODE ALTERS THE BINARY ADDRESS ALREADY COMPUTED WITH  * 08320002
* THE RESULTS OF THE BINARY VALUE RETURNED FROM THE CONVERSION        * 08340002
* ROUTINE.                                                            * 08360002
*********************************************************************** 08380002
         SPACE                                                          08400002
         L     R2,CONAREA              R2=ADDR OF CONAREA.              08420002
         LA    R2,ONE(R2)              R2=PT TO OUTPUT FROM FAQVBIN.    08440002
         L     R4,ZERO(R2)             R4=VALUE RETURNED BY FAQVBIN.    08460002
TESTSIGN EQU   *                                                        08480002
         CLI   WORK4(R3),EXPPLUS       Q.EXPRESSION VALUE SIGN POSITIVE 08500002
         BE    PLUSEXP                 YES,ADD VALUE TO ADDRESS.        08520002
*********************************************************************** 08540002
* THE FOLLOWING INSTRUCTIONS SUBTRACT FROM THE BINARY ADDRESS THE     * 08560002
* BINARY VALUE RETURNED FROM THE CONVERSION ROUTINE.                  * 08580002
*********************************************************************** 08600002
         SPACE                                                          08620002
         SR    R0,R4                   R4=ALTERED ADDRESS.              08640002
MOVEALT  EQU   *                                                        08660002
         ST    R0,ZERO(R3)             ALTERED ADDRESS NOW IN WORKAREA. 08680002
         LH    R7,EXPIND(R1)           R7=EXP INDIRECT COUNT.           08700002
         LTR   R7,R7                   Q.IS INDIRECTING REQUESTED.      08720002
         BZ    NEXTEXP                 NO,CHECK NEXT EXP VALUE.         08740002
EXPADDR  EQU   *                                                        08760002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   08780002
*        BAL TO AN ADDRESS VALIDITY CHECK R3 = ADDR TO BE CHECKED   *   08800002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   08820002
         BAL   R10,ADDRVCK             IS THE ADDR VALID                08840002
         MVC   PDEUSER+ONE(THREE),ONE(R3) ADDR NOW IN USERWORD.         08860002
         SPACE                                                          08880002
         L     R6,ZERO(R3)             R6=ADDR OF NEXT VALUE.           08900002
         MVC   ONE(THREE,R3),ONE(R6)   NEW VALUE NOW IN WORKAREA.       08920002
         BCT   R7,EXPADDR              DECREMENT INDIRECT COUNT.        08940002
NEXTEXP  EQU   *                                                        08960002
         MVC   WORK4(ONE,R3),NINE(R1)  SAVE SIGN OF EXPRESSION.         08980002
         L     R1,ONE2(R1)             R1=NEXT EXP ADDRESS.             09000002
         B     MOREVAL                 CHECK FOR MORE EXP.              09020002
         SPACE                                                          09040002
*********************************************************************** 09060002
* THE FOLLOWING INSTRUCTION ADDS TO THE BINARY ADDRESS THE BINARY     * 09080002
* VALUE  RETURNED FROM THE VALUE CONVERSION ROUTINE.                  * 09100002
*********************************************************************** 09120002
         SPACE                                                          09140002
PLUSEXP  EQU   *                                                        09160002
         AR    R0,R4                   R4=ALTERED ADDRESS.              09180002
         B     MOVEALT                 MOVE ALTERED ADDR INTO WORKAREA. 09200002
         SPACE                                                          09220002
*********************************************************************** 09240002
* THIS AREA OF CODE CONVERTS A HEX VALUE TO TO BINARY BY USING THE    * 09260002
* HEX TO BINARY VALUE CONVERSION ROUTINE.                             * 09280002
*********************************************************************** 09300002
         SPACE                                                          09320002
HEXVAL   EQU   *                                                        09340002
         L     R0,ZERO(R3)             R0=ADDRESS VALUE.                09360002
         BAL   R14,HEXBIN              CONVERT HEX TO BINARY.           09380002
         L     R2,CONAREA              R2=ADDR OF OUTPUT AREA.          09400002
         MVC   ZERO(FOUR,R3),ONE(R2)   BINARY VALUE NOW IN WORKAREA.    09420002
         L     R4,ZERO(R3)             R4=BINARY VALUE.                 09440002
         SR    R6,R6                   R6=0                             09460002
         IC    R6,ZERO(R2)             R6=LENGTH OF BINARY VALUE.       09480002
         LA    R7,FOUR                 R7=4.                            09500002
         SR    R7,R6                   R7=4-LENGTH OF BINARY.           09520002
         SLL   R7,THREE                R7=R7X8.                         09540002
         SRL   R4,ZERO(R7)             R4=VALUE RIGHT JUSTIFIED.        09560002
         B     TESTSIGN                CHECK FOR + OR - SIGN.           09580002
         SPACE                                                          09600002
*********************************************************************** 09620002
* THE FOLLOWING INSTRUCTIONS CONVERTS A SYMBOLIC ADDRESS FROM         * 09640002
* PRINTABLE CHARACTERS TO IT BINARY VALUE.  THIS CONVERSION IS DONE   * 09660002
* BY USING THE SYMBOLIC CONVERSION OF IKJEGSYM.                       * 09680002
*********************************************************************** 09700002
         SPACE                                                          09720002
SYMFOUND EQU   *                                                        09740002
         SPACE                                                          09760002
* CHECK LENGTH FOR MORE THAN 8 BYTES.                                 * 09780002
         SPACE                                                          09800002
         CLI   PDELEN3+ONE,LENSYM      Q.IS SYMBOL GT 8 CHARACTERS.     09820002
         BH    SYMERROR                YES,WRITE ERROR MESSAGE.         09840002
         BAL   R10,SYMLINK             GO CALL IKJEGSYM.                09860002
         LTR   R15,R15                 Q.IS THE RC=0.                   09880002
         BNZ   RETURN                  RETURN TO CALLER.                09900002
         SPACE                                                          09920002
*********************************************************************** 09940002
* THIS SECTION OF CODE GET THE BINARY ADDRESS FROM IKJEGSYM AND MOVES * 09960002
* IT INTO THE ADDRESS SAVE AREA.                                      * 09980002
*********************************************************************** 10000002
         SPACE                                                          10020002
         L     R2,PDEUSER              R2=ADDRESS OF SYMINFO.           10040002
         MVC   ZERO(FOUR,R3),ZERO(R2)  BINARY ADDRESS NOW IN WORKAREA.  10060002
         B     INDIRECK                CHECK FOR INDIRECKS.             10080002
         SPACE                                                          10100002
*********************************************************************** 10120002
* THIS SECTION OF CODE PUTS OUT AN ERROR MESSAGE INDICATING THAT THE  * 10140002
* LENGTH OF THE SYMBOLIC IS GREATER THAN EIGHT CHARACTERS.            * 10160002
*********************************************************************** 10180002
         SPACE                                                          10200002
SYMERROR EQU   *                                                        10220002
         LA    R4,MSG001               R4=ADDR OF MSG ID PARM LIST.     10240002
         B     RITERROR                WRITE ERROR MSG.                 10260002
         SPACE                                                          10280002
*********************************************************************** 10300002
* THIS SECTION OF CODE CHECKS TO DETERMINE IF THE ADDRESS COMPUTED IS * 10320002
* WITHIN THE MAXIMUM STORAGE AREA.                                    * 10340002
*********************************************************************** 10360002
         SPACE                                                          10380002
CORECK   EQU   *                                                        10400002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   10402002
*        BAL TO AN ADDRESS VALIDITY CHECK R3 = ADDR TO BE CHECKED   *   10404002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   10406002
         BAL   R10,ADDRVCK             IS THE ADDR VALID                10410002
         TM    PDEUSER,PDESIB          Q.ADDRES OF SYM INFO NEEDED.     10420002
         BO    NOCORECK                YES,SKIP CORE CHECK.             10440002
         MVC   PDEUSER+ONE(THREE),ONE(R3) ADDR NOW IN USERWORD.         10540002
         SPACE                                                          10560002
NOCORECK EQU   *                                                        10580002
         SR    R15,R15                 RC=0.                            10600002
         SPACE                                                          10620002
*********************************************************************** 10640002
* THIS SECTION CHECKS TO DETERMINE IF A RANGE OF ADDRESSES HAVE BEEN  * 10660002
* REQUESTED.  A CHECK IS MADE FIRST TO DETERMINE IF A RANGE IS        * 10680002
* POSSIBLE.  THE NEXT CHECK WILL DETERMINE IF A RANGE WAS SPEDIFIED.  * 10700002
* THE FIRST WORD OF THE SECOND PDL IS TESTED FOR ZEROES, WHICH        * 10720002
* INDICATES THAT THE RANGE WAS NOT SPECIFIED.                         * 10740002
*********************************************************************** 10760002
         SPACE                                                          10780002
         TM    TSTFLGS1,RANGESW        Q.IS A RANGE POSSIBLE.           10800002
         BZ    RETURN                  NO,RETURN                        10820002
         SPACE                                                          10840002
* A RANGE IS POSSIBLE.  TURN SWITCH OFF AND CHECK FOR A RANGE.        * 10860002
         SPACE                                                          10880002
         NI    TSTFLGS1,HEXFF-RANGESW  TURN RANGE SWITCH OFF.           10900002
         LA    R1,PDECHAIN             R1=ADDRESS OF SECOND PDL.        10920002
         NC    ZERO(TWO8,R1),ZERO(R1)  Q.RANGE SPECIFIED.               10940002
         BZ    RETURN                  NO,RETURN                        10960002
         LR    R8,R1                   BUMP ADDRESSABILITY.             10980002
         B     TOBIN                   CONVERT 2ND ADDRESS.             11000002
         SPACE                                                          11020002
*********************************************************************** 11040002
* THE FOLLOW INSTRUCTION ANALYZE THE NON-ZERO RETURN CODE TO          * 11060002
* DETERMINE WHY THE CONVERSION FAILED.  THE RETURN CODE PASSED        * 11080002
* TO THE CALLING ROUTINE WILL REFLECT THE RESMIT OF THE ANALYSIS.     * 11100002
*********************************************************************** 11120002
         SPACE                                                          11140002
         LA    R15,FOUR                SET RETURN CODE=4.               11160002
         B     RETURN                  RETURN TO CALLER.                11180002
         SPACE                                                          11200002
*********************************************************************** 11220002
*   THE NEXT SECTION OF CODE VARIFIES AN ADDRESS PASSED IN R3           11240002
*   IT INVOKES SVC 97, (IKJEGS9G)                                       11260002
*********************************************************************** 11280002
         SPACE                                                          11300002
ADDRVCK  DS    0H                      CHECK OUT THE ADDRESS            11320002
         SPACE                                                          11340002
         L     R6,PPTCB                R6= ADDR OF THE PROBLEM PROG TCB 11360002
         USING CVTWORK,R3              EST ADDR'IBILITY TO WORK AREA    11380002
         ST    R1,NUM4                 SAVE THE CONTENTS OF R1          11400002
         L     R2,ZERO(R3)             R2= ADDR TO BE CHECKED           11420002
         LA    R2,ZERO(R2)             ZERO HIGH ORDER BYTE             11430002
         IKJEGS9G ADDRCHK,TCBADDR=(R6),VALUE=(R2),MF=(E,NUM3)           11440002
         L     R1,NUM4                 RESTORE THE CONTENTS OF REG1     11460002
         LTR   R15,R15                 IS THE ADDRESS VALID             11480002
         BNZ   OUTCORE                 NO THE ADDRESS IS OUT OF REGION  11500002
         OI    PDEFLG5,PDEWRITE        SWITCH ON THE WRITE FLAG IN PDE  11510002
         DROP  R3                      RELEASE ADDR'IBILITY TO WORKAREA 11520002
         BR    R10                     RETURN TO CALLER VALID ADDRESS   11540002
         SPACE                                                          11560002
ENTNAME  EQU   *                                                        11580002
         LA    R10,ENDLINK             R14=CALLER ADDRESS.              11600002
         SPACE                                                          11620002
*********************************************************************   11640002
*        THIS SUBROUTINE DOES THE LINK TO SYM. REGISTER 1 POINTS TO *   11660002
*        THE PDE ON ENTRY                                           *   11680002
*********************************************************************   11700002
         SPACE                                                          11720002
SYMLINK  DS    0H                      LINK TO IKJEGSYM                 11740002
         LINK  EP=IKJEGSYM,MF=(E,(1)),ERRET=ERRET2 LINK WITHOUT BLDL    11760002
IKJEGBL1 EQU   *                                                        11780002
SMTSYM1  DS    0H                      SMT TESTCASE LABEL               11800002
*                                       LINK TO SYM FAILED              11820002
*                                       TESTCASE ID  TTSTC120           11840002
*                                       TESTCASE ID  TEQU5300           11860002
         BR    R10                     RETURN TO CALLER.                11880002
*                                                                       11890002
*                                                                       11892002
ERRET2   LR    R0,R1              PUT ABEND CODE IN REG0                11894002
         LA    R2,@6              GET 'LINK' SVC NUMBER                 11898002
         B     SVCERR1            GO ISSUE MESSAGES                     11898402
ENDLINK  EQU   *                                                        11900002
         LTR   R15,R15                 Q.RC=0.                          11920002
         BNZ   RETURN                  RETURN TO CALLER.                11940002
         TM    PDEFLG5,PDESIB          IS THIS A SIB POINTER            11950002
         BO    ENDLK2                  YES THEREFORE CHECK THAT ADDR    11952002
         MVC   ZERO(FOUR,R3),PDEUSER   ADDR TO BE CHECKED IN WORKA      11954002
         B     ENDLK3                  CHECK ADDR                       11956002
ENDLK2   DS    0H                      CHECK THE ADDR IN SIB BLK        11958002
         L     R6,PDEUSER              R6= ADDR OF THE SIB BLK          11958402
         MVC   ZERO(FOUR,R3),ZERO(R6)  ADDR TO BE CHECKED TO WORKA      11958802
ENDLK3   DS    0H                      GO TO THE VALIDITY CHECKER       11959202
         BAL   R10,ADDRVCK             IS THE ADDR VALID                11959602
         B     NOCORECK                CHECK FOR RANGE.                 11960002
         SPACE                                                          11980002
*********************************************************************** 12000002
*                                                                     * 12020002
*        THE FOLLOWING INSTRUCTIONS CONVERTS AN ADDRESS FROM          * 12040002
*        ITS BINARY FORMAT TO ITS PRINTABLE FORMAT.                   * 12060002
*                                                                     * 12080002
         SPACE                                                          12100002
FROMBIN  EQU   *                                                        12120002
         SPACE                                                          12140002
* THE TEST UNDER MASK ROUTES CONTROL TO THE PROPER CONVERSION CODE.   * 12160002
         SPACE                                                          12180002
         TM    PDEFLG4,ABSCOMPL        Q.IS BINARY TO BE ABSOLUTE ADDR. 12200002
         BZ    BINABT                  YES,CONVERT TO ABSOLUTE ADDR.    12220002
         TM    PDEFLG4,RELADDR         Q.IS BINARY TO BE A REL ADDR.    12240002
         BO    BINREL                  YES,CONVERT TO RELATIVE ADDR.    12260002
         SPACE                                                          12280002
*********************************************************************** 12300002
* THIS SECTION OF CODE CONVERTS BINARY TO REGISTER NOTATION. IF THE   * 12320002
* REGISTER IS A GENERAL PURPOSE REGISTER IT PRINTABLE VALUE WILL      * 12340002
* HAVE CHARACTER  -R-    FOLLOWING IT. IF IT IS A FLOATING POINT      * 12360002
* REGISTER THE LETTER -D- OR -E- WILL FOLLOW DEPENDING IF IT IS A     * 12380002
* SINGLE OR DOUBLE PRECISION.                                         * 12400002
*********************************************************************** 12420002
         SPACE                                                          12440002
         L     R5,PDEADRPT             R5=ADDR OF INPUT STRING.         12460002
         SR    R6,R6                   R6=0.                            12480002
         IC    R6,REGIN(R5)            R6=ADDR STRING.                  12500002
         CVD   R6,ZERO(R3)             REGISTER NOW PACKED DECIMAL.     12520002
         OI    SEVEN(R3),SIGNF         CHANGE SIGN TO X'F'.             12540002
         UNPK  ZERO(TWO,R3),SIX(TWO,R3) REGISTER NOW IN PRINTABLE FORM. 12560002
         SPACE                                                          12580002
*********************************************************************** 12600002
* THE FOLLOWING INSTRUCTION WHICH TYPE OF REGISTER HAS BEEN SPECIFIED * 12620002
* AND BRANCHES TO TO PROPER CODE TO MOVE IN THE PROPER LETTERS(R,RE,  * 12640002
* OR RD).                                                             * 12660002
*********************************************************************** 12680002
         SPACE                                                          12700002
         L     R2,CONAREA              R2=ADDRESS OF OUTPUT AREA.       12720002
         MVC   ONE(TWO,R2),ZERO(R3)    MOVE ADDR INTO OUTPUT AREA       12740002
         SR    R15,R15                 RC=0.                            12760002
         MVI   ZERO(R2),THREE          MOVE LENGTH INTO CONAREA.        12780002
         TM    PDEFLG4,DOBMASK         Q.IS REGISTER DOUBLE PRECISION.  12800002
         BO    RDMOVE                  YES,MOVE IN D.                   12820002
         TM    PDEFLG4,SINMASK         Q.IS REGISTER SINGLE PRECISION.  12840002
         BO    REMOVE                  YES,MOVE IN E.                   12860002
         SPACE                                                          12880002
*********************************************************************** 12900002
* THE FOLLOWING WILL ALTER THE REG VALUE BY HAVING A (R) FOLLOWING    * 12920002
* IT.                                                                 * 12940002
*********************************************************************** 12960002
         SPACE                                                          12980002
         MVI   THREE(R2),RSIGN         APPEND -R- TO END OF OUTPUT.     13000002
         CLI   ONE(R2),F0              Q.IS FIRST BYTE A HEX -F0-.      13020002
         BNE   RETURN                  NO,RETURN TO CALLER.             13040002
         MVI   ONE(R2),BLANK           BLANK NOW IN FIRST BYTE.         13060002
         B     RETURN                  RETURN TO CALLER.                13080002
         SPACE                                                          13100002
*********************************************************************** 13120002
* THIS SECTION OF CODE ALTERS THE REGISTER VALUE BY APPENDING A (RD)  * 13140002
* TO THE END OF IT AND MOVE THE OUTPUT INTO CONVAREA.                 * 13160002
*********************************************************************** 13180002
         SPACE                                                          13200002
RDMOVE   EQU   *                                                        13220002
         MVC   ONE(ONE,R2),ONE(R3)     REG NUMBER NOW IN CONAREA.       13240002
         MVI   TWO(R2),RDSIGN          MOVE D TO RIGHT OF OUTPUT.       13260002
         MVI   ZERO(R2),TWO            MOVE LENGTH INTO CONAREA.        13280002
         B     RETURN                  RETURN TO CALLER.                13300002
*********************************************************************** 13320002
* THIS SECTION FO CODE ALTERS THE REGISTER VALUE BY PPPENDING A "RE"  * 13340002
* TO THE END OF IT AND MOVES THE OUTPUT INTO CONAREA.                   13360002
*********************************************************************** 13380002
         SPACE                                                          13400002
REMOVE   EQU   *                                                        13420002
         MVC   ONE(ONE,R2),ONE(R3)     MOVE REGISTER INTO CONAREA.      13440002
         MVI   TWO(R2),RESIGN          MOVE R TO RIGHT OF OUTPUT.       13460002
         MVI   ZERO(R2),TWO            MOVE LENGTH INTO CONAREA.        13480002
         B     RETURN                  RETURN TO CALLER.                13500002
         SPACE                                                          13520002
*********************************************************************** 13540002
* THIS SECTION OF CODE CONVERTS BINARY TO IT ABSOLUTE FORMAT. THE     * 13560002
* OUTPUT IS STORED IN CONAREA.                                        * 13580002
*********************************************************************** 13600002
         SPACE                                                          13620002
BINABT   EQU   *                                                        13640002
         LA    R7,ZERO                 R7=0.                            13660002
         L     R2,PDEADRPT             R2=ADDRESS OF INPUT STRING.      13680002
         LA    R6,SIX                  R6=LENGTH,6.                     13700002
         MVC   ZERO(FOUR,R3),ZERO(R2)  INPUT NOW IN WORKAREA.           13720002
         L     R5,ZERO(R3)             R5=INPUT STRING.                 13740002
         SLL   R5,EIGHT                ISOLATE LOW ORDER 3 BYTES.       13760002
         L     R2,CONAREA              R2=ADDR OF CONAREA.              13780002
         LA    R0,NINE                 R0=9.                            13800002
NEXTBITS EQU   *                                                        13820002
         SR    R4,R4                   R4=0.                            13840002
         SLDL  R4,FOUR                 ISOLATE 4 BITS.                  13860002
         CR    R4,R0                   Q.ARE BITS GT 9.                 13880002
         BH    ADDRHI                  YES.                             13900002
         SPACE                                                          13920002
* THE 4 BITS ARE NUMERIC. MAKE PRINTABLE BY ADDING X'F0'.             * 13940002
         SPACE                                                          13960002
         LA    R4,F0(R4)               R4=PRINTABLE BYTE.               13980002
BYTEMOVE EQU   *                                                        14000002
         STC   R4,ONE(R2)              PUT BYTE INTO CONAREA.           14020002
         LA    R2,ONE(R2)              R2=ADDR OF NEXT OUTPUT AREA.     14040002
         LA    R7,ONE(R7)              INCREMENT BYTE COUNTER.          14060002
         CR    R7,R6                   Q.ARE THERE MORE BITS.           14080002
         BNE   NEXTBITS                YES,GET NEXT 4 BITS.             14100002
         L     R2,CONAREA              R2=ADDRESS OF CONAREA.           14120002
         MVI   ZERO(R2),LEN7           MOVE LENGTH INTO CONAREA.        14140002
         MVI   SEVEN(R2),PERIOD        APPEND -.- TO END OF OUTPUT.     14160002
         SR    R15,R15                 SET RC=0.                        14180002
         B     RETURN                  RETURN TO CALLER.                14200002
         SPACE                                                          14220002
* THE 4 BITS AREA ALPHABETIC. CONVERT PRINTABLE BY ADDING X'B7'.      * 14240002
         SPACE                                                          14260002
ADDRHI   EQU   *                                                        14280002
         LA    R4,B7(R4)               R4=PRINTABLE BYTE.               14300002
         B     BYTEMOVE                MOVE BYTE OF OUTPUT TO CONAREA.  14320002
         SPACE                                                          14340002
*********************************************************************** 14360002
* THIS SECTION OF CODE CONVERTS BINARY TO A RELATIVE ADDRESS. THE     * 14380002
* OUTPUT IS STORED IN CONAREA                                         * 14400002
*********************************************************************** 14420002
         SPACE                                                          14440002
BINREL   EQU   *                                                        14460002
         TM    PDEFLG2,CTNAMFLG        Q.IS QUALIFY SPECIFIED.          14480002
         BZ    GETPP                   NO,GET ADDRESS FROM PPLOAD.      14500002
         L     R2,PPTEMP               R2=BASE FOR RELATIVES.           14520002
BASEMOVE EQU   *                                                        14540002
         L     R4,PDEADRPT             R4=ADDRESS OF INPUT STRING.      14560002
         MVC   ZERO(FOUR,R3),ZERO(R4)  GET INPUT STRING.                14580002
         L     R4,ZERO(R3)             R4=INPUT STRING.                 14600002
         SR    R4,R2                   R4=REALTIVE VALUE IN BINARY.     14620002
         ST    R4,ONE6(R3)             PUT INPUT INTO FAKE PDE.         14640002
         LA    R4,ONE6(R3)             R4=ADDRESS OF INPUT VALUE.       14660002
         ST    R4,EIGHT(R3)            ADDRESS IN FAKE VALUE PDE.       14680002
         LA    R5,FOUR                 R5=A LENGTH OF FOUR.             14700002
         STH   R5,ONE2(R3)             MOVE LENGTH INTO PDE.            14720002
         LA    R1,EIGHT(R3)            R1=ADDRESS OF FAKE PDE.          14740002
         BAL   R14,BINHEX              LINK TO BINHEX RT.               14760002
         L     R2,CONAREA              R2=ADDRESS OF CONAREA.           14780002
         LA    R2,ONE(R2)              R2=ADDRESS OF OUTPUT STRING.     14800002
         LA    R5,SEVEN                R5=7.                            14820002
F0CHECK  EQU   *                                                        14840002
         CLI   ZERO(R2),F0             Q.IS BYTE FIRST VALID CHAR.      14860002
         BNE   ONEF0                   YES,FORMAT OUTPUT.               14880002
         LA    R2,ONE(R2)              ADVANCE POINTER.                 14900002
         BCT   R5,F0CHECK              CHECK LAST DITIT.                14920002
ONEF0    EQU   *                                                        14940002
         EX    R5,RELMOVE              MOVE REL INTO WORKAREA.          14960002
         L     R2,CONAREA              R2=ADDRESS OF CONAREA.           14980002
         MVI   ZERO(R2),BLANK          BLANK IN FIRST BYTE OF CONAREA.  15000002
         MVC   ONE(FIVE,R2),ZERO(R2)   CONAREA NOW HAS SIX BLANKS.      15020002
         MVI   ZERO(R2),SEVEN          LENGTH NOW IN CONAREA.           15040002
         LA    R6,SIX                  R6=6.                            15060002
         SR    R6,R5                   R6=OFFSET IN CONAREA.            15080002
         LA    R2,ONE(R6,R2)           R2=ADDR OF OUTPUT LOCATION.      15100002
         EX    R5,REL4MAT              MOVE OUTPUT INTO CONAREA.        15120002
         BCTR  R2,ZERO                 R2=ADDR OF BYTE BEFORE 1ST DIGIT 15140002
         MVI   ZERO(R2),PLUS           PRECEDE OUTPUT WITH A PLUS SIGN. 15160002
         SR    R15,R15                 RC=0.                            15180002
         B     RETURN                  RETURN TO CALLER.                15200002
RELMOVE  MVC   ZERO(ONE,R3),ZERO(R2)   MOVE REL INTO WORKAREA.          15220002
REL4MAT  MVC   ZERO(ONE,R2),ZERO(R3)   MOVE REL OUTPUT INTO CONAREA.    15240002
OUTCORE  EQU   *                                                        15260002
         LA    R2,EIGHT                CHECK FOR RETURN CODE FOUR       15270002
         CR    R15,R2                  RC=8 FROM SVC97?                 15272002
         BNL   OUTCORE2                CONTINUE WITH ERROR MSG          15272402
         NI    PDEFLG5,HEXFF-PDEWRITE  TURN OFF THE PDE WRITE SW        15274402
         BR    R10                     RETURN & CONTINUE ADDR MAYBE OK  15274802
OUTCORE2 DS    0H                      CONTINUE WITH ERROR MESSAGE      15276002
         LA    R4,MSG002               R4=ADDR OF MSG ID LIST.          15280002
RITERROR EQU   *                                                        15300002
ERRORPK  EQU   *                                                        15350002
         L     R6,@4(R4)              GET SECOND LEVEL MSG ID           15690002
         L     R4,@0(R4)              GET 1ST LEVEL MSG ID              15692002
         XC   TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR REMOTE LIST AREA     15694002
         LTR   R6,R6                  DOES SECOND LEVEL EXIST           15694402
         BZ    MACRO2                 NO - USE SECOND FORM OF IO MACRO  15694802
*                                     WE MUST BE ISSUING MSG003         15695202
         IKJEGSIO MSG,FIRST=(R4),INST11=(APDE,(R8)),SECOND=(R6),       *15696002
               ID=CVT09,MF=(E,TSTIOPRM)                                 15698002
CHECKIO  SR    R4,R4                   CLEAR REG 4                      15708002
         LA    R4,@12(R4)             PREPARE TO CHECK FOR RC > 12      15718002
         CR    R15,R4                  IS RC > 12                       15718402
         BH    RETURN                  IF SO, RETURN                    15740002
         LA    R15,FOUR                R15=RC OF 4.                     15760002
         B     RETURN                  RESTORE CALLER REGISTERS.        15780002
MACRO2   IKJEGSIO MSG,FIRST=(R4),ID=CVT09,MF=(E,TSTIOPRM)               15790002
         B     CHECKIO                GO CHECK IO RETURN CODE           15800002
GETPP    EQU   *                                                        15820002
         L     R2,PPLOAD               R2=CURRENT BASE FOR RELATIVES.   15840002
         B     BASEMOVE                MOVE IN INPUT STRING.            15860002
SVCERR1  LR    R3,R1              SET ABEND CODE FOR ABENDREG           15870002
         LR    R4,R15             SET RETURN CODE                       15872002
         XC    TSTOIPRM(L'TSTOIPRM),TSTOIPRM CLEAR REMOTE PARM LIST     15874002
         LTR   R0,R0              IS THERE AN ABEND CODE FOR ABENDREG   15876002
         BZ    SVCERR2            IF R0=0, USE SVCERR2 FORM OF IO-MACRO 15878002
*                                                                       15878402
         IKJEGSIO SVCERR,SVC=(R2),RC=(R4),ABENDRG=(R3),MF=(E,TSTOIPRM),*15878802
               ID=CVT09,INST11=(NUM,I0034)                              15878902
         LA    R14,RETURN         INDICATE THAT SCB MUST BE REMOVED     15879002
         B     SVCRET             GO SET PROPER RETURN CODE             15879202
*                                                                       15879602
SVCERR2  IKJEGSIO SVCERR,SVC=(R2),RC=(R4),MF=(E,TSTOIPRM),             *15881102
               ID=CVT09                                                 15884602
         LA    R14,AFTERSCB     INDICATE THAT NO SCB IS TO BE REMOVED   15886002
*                                                                       15887402
SVCRET   SR    R1,R1              CLEAR REG1                            15888802
         LA    R1,@12(R1)         PUT 12 IN REG 1                       15890202
         CR    R15,R1             COMPARE RETURN CODE FROM IO WITH 12   15891602
         BNH   SETRC         IF R15 NOT > DEC 12, PASS RC TO CALLER     15893002
         BR    R14                PASS RETURN CODE TO CALLER            15894402
SETRC    SR    R15,R15            CLEAR R15 FOR RETURN CODE             15895802
         LA    R15,FOUR(R15)      SET RETURN = 4                        15897202
         BR    R14                GO RESTORE REG'S AND RETURN TO CALLER 15898602
*                                                                       15900002
RETRY    SR    R9,R9              SET REG 9 TO ZERO                     15902002
         L     R9,@16(R9)         POINT TO COM VECTOR TABLE             15904002
         L     R9,@0(R9)          POINT TO TASK CNTRL BLCK POINTERS     15906002
         L     R9,@4(R9)          POINT TO CURRENT TCB                  15906402
         L     R9,@20(R9)         POINT TO THE TCOMTAB                  15906502
         NI    TSTFLGS4,HEXFF-TSTRERTN   TURN OFF RETRY INDICATOR       15915202
         NI    TSTFLGS4,HEXFF-TSTVALCK   TURN OFF VALIDITY INDICATOR    15915602
         LA    R15,@20            INDICATE RETRY ROUTINE ENTERED        15917202
         L     R12,TSTCONVT       LOAD BASE REG                @ZA28933 15918203
         B     RETURN                                                   15919202
*                                                                       15919602
ABENDTAB DS    0F                                                       15921602
         DC    X'63'              LINK FAILED INSERT FOR ABEND MSG      15923602
         DC    AL3(SMTSYM1)                                             15925602
         DC    X'FF'                                                    15925702
*                                                                       15926002
MSG001   DC    F'101'             MESSAGE M0101 (INVALID ADDRESS)       15928002
         DC    F'281'             MESSAGE M0281 (EXCEEDS EIGHT)         15930002
MSG002   DC    F'101'             MESSAGE M0101 (INVALID ADDRESS)       15932002
         DC    F'218'             MESSAGE M0217 (PROTECTED CORE)        15934002
MSG003   DC    F'23'              MESSAGE M0101 (INVALID ADDRESS)       15936002
         DC    F'000'    NO 2ND LEVEL MESSAGE PRESENT                   15938002
LIST     IKJEGSPL RTRY=RETRY,ABNTB=ABENDTAB,MODNM=IKJEGCVT,            *15938402
               TNM=CONVERT                                              15938802
         TITLE 'IKJEGCVT VALUE CONVERSION ROUTINE.'                     15940002
*********************************************************************** 15940202
* THE FOLLOWING INSTRUCTION DETRRMINE IF THE VALUE CONVERSION IS TO   * 15946802
* BE TO OR FROM BINARY.                                               * 15953402
*********************************************************************** 15960002
         SPACE                                                          15980002
YHCODE   EQU   *                                                        16000002
         LA    R5,ONE                  R5=1. INDICATES H OR Y SPECIFIED 16020002
         B     NOTHORY                 BRANCH TO PROPER RTN.            16040002
         SPACE                                                          16060002
VALCVT   EQU   *                                                        16080002
         LTR   R0,R0                   Q.IS THE CONVERSION TO BINARY.   16100002
         BM    FROMBI                  NO,CONVERT VALUE TO PRINTABLE.   16120002
         SPACE                                                          16140002
*********************************************************************** 16160002
* THE FOLLOWING INSTRUCTIONS CONVERTS A VALUE FROM PRINTABLE     *      16180002
* CHARACTERS TO ITS BINARY FORMAT.                                    * 16200002
*********************************************************************** 16220002
         SPACE                                                          16240002
         SR    R5,R5                   R5=O. NOT H OR Y SWITCH.         16260002
         CLI   SEVEN(R1),HCODE         Q.H SPECIFIED.                   16280002
         BE    YHCODE                  YES,SET H OR Y SWITCH.           16300002
         CLI   SEVEN(R1),YCODE         Q.Y SPECIFIED.                   16320002
         BE    YHCODE                  YES,SET H OR Y SWITCH.           16340002
         SPACE                                                          16360002
*********************************************************************** 16380002
* THE FOLLOWING BRANCH ROUTINE ROUTES CONTROL TO THE DIFFERENT TYPES  * 16400002
* OF CONVERSIONS.                                                     * 16420002
*********************************************************************** 16440002
         SPACE                                                          16460002
NOTHORY  EQU   *                                                        16480002
         SR    R6,R6                   R6=0.                            16500002
         IC    R6,SEVEN(R1)            R6=TYPE CODE IN HEX.             16520002
         L     R15,ACONLST(R6)         R15=ADDRESS OF CVT RTN.          16540002
         BALR  R14,R15                 GOTO PROPER CONVERT RTN.         16560002
         USING BASEADDR,R14            R14=TEMP BASE REGISTER.          16580002
BASEADDR EQU   *                                                        16600002
         L     R12,CVTBASE             R12=ADDR OF IKJEGCVT.            16620002
         DROP  R14                     R14 NO LONGER BASE REGISTER.     16640002
RETURN   EQU   *                                                        16660002
         LR    R2,R15                  PRESERVE REG 15                  16662002
         ESTAE 0                       REMOVE 'SCB'                     16670002
         LR    R15,R2                  RESTORE REG15                    16672002
AFTERSCB L     R13,FOUR(R13)           R13=ADDR OF CALLER SAVE AREA.    16680002
         RETURN (14,12),,RC=(15)       RESTORE CALLERS REGISTERS.       16700002
         SPACE                                                          16720002
BINBIN   EQU   *                                                        16740002
         SPACE                                                          16760002
*********************************************************************** 16780002
*                                                                     * 16800002
*        THIS ROUTINE CONVERTS PRINTABLE BYTES OF THE BINARY        *   16820002
*        FORMAT INTO ITS ONE BIT BINARY VALUE.                        * 16840002
*                                                                     * 16860002
*********************************************************************** 16880002
         SPACE                                                          16900002
         SR    R8,R8                   R8=0.                            16920002
         IC    R8,VALLEN(R1)           R8=LENGTH OF INPUT.              16940002
         LA    R0,EIGHT                R0=8.                            16960002
         SR    R7,R7                   R7=0.                            16980002
         SR    R6,R6                   R6=0.                            17000002
         L     R2,CONAREA              R2=ADDRESS OF OUTPUT AREA.       17020002
         LA    R2,ONE(R2)              R2=OUTPUT AREA PLUS 1.           17040002
         L     R3,ZERO(R1)             R3=ADDRESS OF INPUT STRING.      17060002
         SR    R1,R1                   R1=0.                            17080002
INIT     EQU   *                                                        17100002
         LA    R5,ONE                  R5=1                             17120002
         LCR   R5,R5                   R5=32 BINARY ONES.               17140002
         SR    R4,R4                   R4=0.                            17160002
NEXTBYTE TM    ZERO(R3),F1             Q.IS THE BYTE A ONE.             17180002
         BO    AONE                    YES,MOVE IN AN ON BIT.           17200002
         SLL   R4,ONE                  MOVE IN A ZERO.                  17220002
         B     SKIPONE                 SKIP ONES ROUTINE.               17240002
AONE     EQU   *                                                        17260002
         SLDL  R4,ONE                  MOVE IN ONE ON BIT.              17280002
SKIPONE  EQU   *                                                        17300002
         LA    R3,ONE(R3)              INCREMENT INPUT ADDRESS.         17320002
         LA    R6,ONE(R6)              INCREMENT SAVE BYTE COUNTER.     17340002
         LA    R7,ONE(R7)              INCREMENT BYTE COUNTER.          17360002
         CLR   R0,R7                   BYTE COUNT=8.                    17380002
         BNE   NOT8                    NO,COMPARE SAVE COUNT TO LENGHT. 17400002
         SR    R7,R7                   RE-INITIATE BYTE COUNT.          17420002
         STC   R4,ZERO(R2)             MOVE BYTE INTO CONAREA.          17440002
         LA    R1,ONE(R1)              INCREMENT LENGTH COUNTER.        17460002
         LA    R2,ONE(R2)              INCREMENT CONAREA POINTER        17480002
NOT8     CLR   R6,R8                   LENGTH=SAVE,BYTE COUNT.          17500002
         BE    BYTESEND                MOVE BYTE INTO CONAREA.          17520002
         LTR   R7,R7                   BYTE COUNT=0.                    17540002
         BZ    INIT                    YES,CHECK NEXT EIGHT BYTES.      17560002
         B     NEXTBYTE                GET NEXT BYTE.                   17580002
BYTESEND EQU   *                                                        17600002
         LTR   R7,R7                   BYTE COUNT=0.                    17620002
         BZ    NOOUT                   YES,OUTPUT IS IN OUTPUT AREA.    17640002
         LA    R8,EIGHT                R8=8.                            17660002
         SR    R8,R7                   R7=NUMBER OF LEADING ZEROS.      17680002
         SLL   R4,ZERO(R8)             LEFT JUSTIFY OUTPUT              17700002
         STC   R4,ZERO(R2)             MOVE OUTPUT INTO CONAREA.        17720002
         LA    R1,ONE(R1)              R1=LENGTH OF OUTPUT PLUS 1.      17740002
NOOUT    EQU   *                                                        17760002
         L     R2,CONAREA              R2=ADDRESS OF OUTPUT AREA.       17780002
         STC   R1,ZERO(R2)             PUT OUTPUT LENGTH INTO CONAREA.  17800002
         SR    R15,R15                 SET RC=0.                        17820002
         BR    R14                     RETURN TO CALLER.                17840002
PKBIN    EQU   *                                                        17860002
         SPACE                                                          17880002
*********************************************************************** 17900002
*                                                                     * 17920002
*        THIS ROUTINE CONVERTS PRINTABLE CHARACTERS TO PACKED         * 17940002
*        DECIMAL.                                                     * 17960002
*                                                                     * 17980002
*********************************************************************** 18000002
         SPACE                                                          18020002
         L     R2,CONAREA              R2=ADDR OF OUTPUT AREA.          18040002
         L     R4,WORKAREA             R4=ADDRESS OF WORKAREA.          18060002
         LH    R6,FOUR(R1)             R6=LENGTH OF INPUT.              18080002
         L     R3,ZERO(R1)             R3=ADDRESS OF INPUT STRING.      18100002
         LR    R8,R3                   R8=ADDR OF INPUT STRING.         18120002
         SPACE                                                          18140002
*        THIS SECTION OF CODE CHECKS FOR A SIGN.                      * 18160002
         SPACE                                                          18180002
         CLI   ZERO(R3),SIGNNEG        Q.IS SIGN NEGATIVE.              18200002
         BE    ADDADDR                 YES.                             18220002
         CLI   ZERO(R3),PLUSSIGN       Q.IS SIGN POSITIVE.              18240002
         BNE   NOSIGN                  YES.                             18260002
ADDADDR  LA    R3,ONE(R3)              R3=ADDRESS OF INPUT MINUS SIGN.  18280002
         BCTR  R6,ZERO                 DECREMENT LENGTH.                18300002
NOSIGN   EQU   *                                                        18320002
         CLI   FIVE(R1),ONE6           Q.LENGTH GT 16.                  18340002
         BH    PKLG                    YES.                             18360002
         SPACE                                                          18380002
*********************************************************************** 18400002
*                                                                     * 18420002
*        THIS SECTION OF CODE CONVERTS TO PACK THE VALUE LESS THAN    * 18440002
*        SEVENTEEN BYTES.                                             * 18460002
*                                                                     * 18480002
*********************************************************************** 18500002
         SPACE                                                          18520002
         LR    R7,R6                   R7=LENGTH OF INPUT.              18540002
         SRL   R6,ONE                  R6=LENGTH DIVIDED BY 2.          18560002
         SLL   R6,FOUR                 R6=L1                            18580002
         BCTR  R7,ZERO                 R7=EXECUTE INPUT LENGTH.         18600002
         OR    R6,R7                   R6=L1 AND L2.                    18620002
         EX    R6,PACK4                INPUT STRING IS NOW PACKED DEC.  18640002
         SRL   R6,FOUR                 ISOLATE LENGTH OF OUTPUT.        18660002
         LA    R6,ONE(R6)              R6=EXACT LENGTH OF PACKED DEC.   18680002
         STC   R6,ZERO(R2)             MOVE LENGTH INTO CONAREA.        18700002
         LA    R3,ZERO(R6,R4)          R3=ADDRESS OF LAST OUTPUT BYTE.  18720002
         BCTR  R3,ZERO                 *                                18740002
         CLI   ZERO(R8),SIGNNEG        Q.INPUT NEGATIVE.                18760002
         BNE   NO                      NO,MOVE IN POSITIVE SIGN.        18780002
         MVN   ZERO(ONE,R3),OFFSETD    MOVE IN NEG SIGN.                18800002
PKMOVE   EX    R6,OUTPUT               MOVE OUTPUT INTO CONAREA.        18820002
PKBEND   SR    R15,R15                 SET RETURN CODE.                 18840002
         BR    R14                     RETURN TO CALLING ROUTINE.       18860002
NO       EQU   *                                                        18880002
         MVN   ZERO(ONE,R3),OFFSETC    MOVE IN POSITIVE SIGN.           18900002
         B     PKMOVE                  MOVE OUTPUT INTO CONAREA.        18920002
PACK4    PACK  ZERO(ONE,R4),ZERO(ONE,R3)   INPUT NOW PACK DATA.         18940002
PKLG     EQU   *                                                        18960002
         STC   R6,ZERO(R4)             LENGTH NOW IN WORKAREA.          18980002
         TM    ZERO(R4),ODDLEN         Q.LENGTH ODD.                    19000002
         BO    LNODD                   YES,CONVERT ODD NUMBER OF BYTES. 19020002
         SPACE                                                          19040002
*********************************************************************** 19060002
*                                                                     * 19080002
*        THIS SECTION OF CODE CONVERTS AN EVEN NUMBER OF PRINTABLE    * 19100002
*        CHARACTERS TO PACKED DECIMAL.                                * 19120002
*                                                                     * 19140002
*********************************************************************** 19160002
         SPACE                                                          19180002
         PACK   ONE(NINE,R2),ZERO(ONE6,R3)  PACK FIRST 16 BYTES         19200002
         LA    R7,ONE6                 R7=16.                           19220002
         SR    R6,R7                   R6=LENGTH MINUS 16.              19240002
         LR    R7,R6                   R7=R6.                           19260002
         SRL   R6,ONE                  R6=LENGTH DIVIDED BY 2.          19280002
         BCTR  R7,ZERO                 R7=LENGTH FOR EXECUTE.           19300002
         SLL   R7,TWO8                 R7=LENGTH HIGH ORDER 4 BITS.     19320002
         SLDL  R6,FOUR                 R6=L1 AND L2 FOR EXECUTE.        19340002
         EX    R6,PACK2                PACK 2ND HALF OF INPUT STRING.   19360002
         SRL   R6,FOUR                 R6=LENGTH OUT PACKED DECIMAL.    19380002
         LA    R4,ZERO(R6,R4)          R4=ADDRESS OF SIGN BYTE.         19400002
         CLI   ZERO(R8),SIGNNEG        Q.SIGN NEGATIVE.                 19420002
         BNE   NO2                     NO,MOVE POSITIVE SIGN.           19440002
         MVN   ZERO(ONE,R4),OFFSETD    MOVE IN NEG SIGN.                19460002
MOVEZ    L     R4,WORKAREA             R4=ADDRESS OF WORKAREA.          19480002
         MVZ   ZERO(ONE,R4),NINE(R2)   MOVE ZONE BITS OF 1ST PACKED DEC 19500002
         EX    R6,OUTPUT2              MOVE 2ND PACKED INTO CONAREA.    19520002
         LA    R10,TEN(R6)             TOTAL LENGTH OF OUTPUT.          19540002
         STC   R10,ZERO(R2)            MOVE LENGTH INTO CONAREA.        19560002
         B     PKBEND                  SET RETURN CODE TO 0.            19580002
LNODD    EQU   *                                                        19600002
         SPACE                                                          19620002
*********************************************************************** 19640002
*                                                                     * 19660002
*        THIS  AREA OF CODE CONVERTS AN ODD NUMBER OF PRINTABLE       * 19680002
*        CHARACTERS TO PACKED DECIMAL.                                * 19700002
*                                                                     * 19720002
*********************************************************************** 19740002
         SPACE                                                          19760002
         PACK  ZERO(NINE,R4),ZERO(ONE6,R3) INPUT=PACKED DECIMAL FORMAT. 19780002
         XC    NINE(TWO,R4),NINE(R4)   ADD TWO BYTES OF ZEROS TO INPUT. 19800002
         NI    EIGHT(R4),AZERO         ALTER SIGN TO ZERO.              19820002
         MVO   ZERO(TEN,R4),ZERO(NINE,R4) SHIFT PACKED DEC 4 BITS.      19840002
         LA    R4,ONE(R4)              R4=ADDR OF PACKED DECIMAL.       19860002
         LA    R7,ONE6                 R7=169.                          19880002
         SR    R6,R7                   R6=LENGTH MINUS 16.              19900002
         LR    R7,R6                   R7=LENGTH MINUS 16.              19920002
         SRL   R6,ONE                  R6=LENGTH DIVIDED BY 2.          19940002
         BCTR  R7,ZERO                 R7=LENGTH DIVIDED BY 2 MINUS 1.  19960002
         SLL   R7,TWO8                 R7=LENGTH IN HIGH ORDER BYTE     19980002
         SLDL  R6,FOUR                 R6=L1 AND L2 FOR EXECUTE.        20000002
         EX    R6,PACK3                PACK 2ND HALF OF INPUT STRING.   20020002
         SRL   R6,FOUR                 R6=LENGTH OF PACKED DECIMAL.     20040002
         LA    R4,EIGHT(R6,R4)         R4=ADDR OF SIGN BYTE.            20060002
         CLI   ZERO(R8),SIGNNEG        Q.SIGN NEGATIVE.                 20080002
         BNE   POSITIVE                NO,MOVE POSITIVE SIGN.           20100002
         MVN   ZERO(ONE,R4),OFFSETD    MOVE IN NEG SIGN.                20120002
TLENGTH  LA    R6,NINE(R6)             R6=LENGTH OF OUTPUT              20140002
         STC   R6,ZERO(R2)             MOVE LENGTH INTO CONAREA.        20160002
         BCTR  R6,ZERO                 R6=LENGTH FOR EXECUTE.           20180002
         L     R4,WORKAREA             R4=ADDRESS OF WORKAREA.          20200002
         LA    R4,ONE(R4)              R4=ACTURAL ADDRESS OF INPUT      20220002
         B     PKMOVE                  MOVE OUTPUT INTO CONAREA.        20240002
POSITIVE EQU   *                                                        20260002
         MVN   ZERO(ONE,R4),OFFSETC    MOVE IN POSITIVE SIGN.           20280002
         B     TLENGTH                 GET LENGTH OF THE OUTPUT.        20300002
PACK3    PACK  EIGHT(ONE,R4),ONE6(ONE,R3)  PACK 2ND HALF OF INPUT.      20320002
OUTPUT   MVC   ONE(ONE,R2),ZERO(R4)    MOVE OUTPUT INTO CONAREA.        20340002
PACK2    PACK  ZERO(ONE,R4),ONE6(ONE,R3) PACK 2ND HALF OF STRING.       20360002
OUTPUT2  MVC   NINE(ONE,R2),ZERO(R4)   MOVE 2ND HALF INTO CONAREA.      20380002
NO2      EQU   *                                                        20400002
         MVN   ZERO(ONE,R4),OFFSETC    MOVEINNEG SIGN.                  20420002
         B     MOVEZ                   CONTINUE PROCESSING.             20440002
HEXBIN   EQU   *                                                        20460002
         SPACE                                                          20480002
*********************************************************************** 20500002
* THE FOLLOWING LINES OF CODE CONVERTS HEXADECIMAL BYTES TO BINARY.   * 20520002
* THIS ROUTINE CANNOT USE REGISTER 8, BECAUSE THE ADDRESS CONVERSION  * 20540002
* ROUTINE USES THIS ROUTINE AND REGISTER 8 IS THE PDE ADDRESSABILITY  * 20560002
* REGISTER.                                                           * 20580002
*********************************************************************** 20600002
         SPACE                                                          20620002
         L     R2,CONAREA              R2=CONVERT OUTPUT AREA ADDR.     20640002
         LH    R4,FOUR(R1)             R4=LENGTH OF INPUT.              20660002
         LR    R5,R4                   R5=LENGTH TO EXECUTE-TRANSLATE.  20680002
         BCTR  R5,ZERO                 DECREMENT LENGTH.                20700002
         L     R6,ZERO(R1)             R6=ADDRESS OF INPUT STRING.      20720002
         L     R3,WORKAREA             R3=ADDR OF TEMP. STORAGE         20740002
         EX    R5,SAFEMOVE             MOVE STRING INTO TEMP STORE      20760002
         LR    R6,R3                   R6=NEW STRING ADDR               20780002
         EX    R5,TRSLATE              TRANSLATE STRING                 20800002
         LR    R10,R4                  R10=HEX LENGTH                   20820002
         LA    R10,ONE(R10)            R10=LENGTH PLUS 1                20840002
         SRL   R10,ONE                 R10=LENGTH OF BINARY             20860002
         STC   R10,ZERO(R2)            STORE LENGTH FOR RETURN          20880002
         SLL   R10,FOUR                L1 TO HIGH END OF BYTE           20900002
         OR    R10,R4                  R10=L1 AND L2                    20920002
         EX    R10,PACK                CONVERT TO BINARY                20940002
         SR    R15,R15                 RETURN CODE=0.                   20960002
         BR    R14                     RETURN                           20980002
TRSLATE  TR    ZERO(ONE,R6),TRTABLE    ALTER PRINTABLES FOR CVT.        21000002
SAFEMOVE MVC   ZERO(ONE,R3),ZERO(R6)   INPUT NOW IN WORKAREA.           21020002
PACK     PACK  ONE(ONE,R2),ZERO(ONE,R6) INPUT NOW IN BINARY FORMAT.     21040002
         ORG   *-193                   BYPASS ZEROES IN TABLE.          21060002
TRTABLE  EQU   *                                                        21080002
         ORG   *+193                   RESET TABLE TO CORRECT IC.       21100002
         DC    X'FAFBFCFDFEFF'         *   TRANSLATE   TABLE          * 21120002
         DC    41X'00'                 *         FOR                  * 21140002
         DC    X'F0F1F2F3F4'           *    PRINTABLE HEXADECIMAL     * 21160002
         DC    X'F5F6F7F8F9'           *  TO BINARY ROUTINE.          * 21180002
         DC    C'ABCDEF'               *                              * 21200002
         DS    0H                      RESET TO HALFWORD BOUNDARY.      21220002
         SPACE                                                          21240002
*********************************************************************** 21260002
* THIS ROUTINE CONVERTS F,A,Q, AND V TYPE ADDRESSES TO BINARY.        * 21280002
* (R8 CAN NOT BE USE IN THIS ROUTINE.)                                * 21300002
*********************************************************************** 21320002
         SPACE                                                          21340002
FAQVBIN  EQU   *                                                        21360002
         LA    R7,ONE                  SET SWITCH.                      21380002
         L     R3,WORKAREA             R3=ADDR OF WORKAREA.             21400002
         LH    R2,FOUR(R1)             R2=PACK COUNT.                   21420002
         BCTR  R2,ZERO                 *                                21440002
         L     R4,ZERO(R1)             R4=ADDR OF INPUT STRING.         21460002
         CLI   ZERO(R4),SIGNNEG        Q.VALUE NEGATIVE.                21480002
         BE    NEGATIVE                YES,FLIP SWITCH NEGATIVE.        21500002
         CLI   ZERO(R4),PLUSSIGN       Q.PLUS SIGN ENTERED.             21520002
         BNE   NOSIGN2                 NO,DO NOT ACCOUNT FOR SIGN.      21540002
SIGN     EQU   *                                                        21560002
         LA    R4,ONE(R4)              INCREASE ADDR TO BYPASS SIGN.    21580002
         BCTR  R2,ZERO                 R2=1 LESS BECAUSE OF SIGN.       21600002
         B     NOSIGN2                 SKIP COMPLEMENT CODE.            21620002
NEGATIVE EQU   *                                                        21640002
         LCR   R7,R7                   FLIP SWITCH NEGATIVE.            21660002
         B     SIGN                    ALTER LENGTH.                    21680002
NOSIGN2  EQU   *                                                        21700002
         O     R2,ORREG                R2=L1 AND L2.                    21720002
         EX    R2,PACK1                CONVERT STRING TO PACKED DEC.    21740002
         LTR   R7,R7                   VALUE NEGATIVE                   21760002
         BH    POSIT                   NO,SKIP COMPLEMENT.              21780002
         MVN   SEVEN(ONE,R3),NEGSIGN   MAKE SIGN NEGATIVE.              21800002
POSIT    EQU   *                                                        21820002
         CVB   R4,ZERO(R3)             CONVERT INPUT TO BINARY.         21840002
         L     R2,CONAREA              R2=ADDR OF OUTPUT AREA.          21860002
         LA    R2,ONE(R2)              R2=BYPASS LENGTH FIELD.          21880002
         SR    R15,R15                 RETURN CODE=0.                   21900002
         LTR   R5,R5                   Q.H OR Y TYPE SPECIFIED.         21920002
         BNZ   HORY                    YES,MOVE ONLY HALFWORD.          21940002
         ST    R4,ZERO(R2)             MOVE VALUE INTO OUTPUT AREA.     21960002
         BCTR  R2,ZERO                 R2=ADDR OF LENGTH BYTE.          21980002
         MVI   ZERO(R2),FOUR           MOVE LENGTH INTO OUTPUT AREA.    22000002
         BR    R14                     RETURN.                          22020002
HORY     EQU   *                                                        22040002
         STH   R4,ZERO(R2)             MOVE VALUE INTO OUTPUT AREA.     22060002
         BCTR  R2,ZERO                 R2=ADDR OF LENGTH BYTE.          22080002
         MVI   ZERO(R2),TWO            LENGTH NOW IN OUTPUT AREA.       22100002
         BR    R14                     RETURN TO CALLER.                22120002
PACK1    PACK  ZERO(ONE,R3),ZERO(ONE,R4) INPUT NOW PACKED DECIMAL.      22140002
         SPACE                                                          22160002
**********************************************************************  22180002
*        THE FOLLOWING INSTRUCTIONS WILL CONVERT PRINTABLE CHARACTERS * 22200002
*        TO BINARY IN THE SCON FORMAT.                                * 22220002
*********************************************************************** 22240002
         SPACE                                                          22260002
SCONBIN  EQU   *                                                        22280002
         L     R6,WORKAREA             R6=ADDR OF WORKAREA.             22300002
         L     R3,ZERO(R1)             R3=ADDR OF INPUT STRING.         22320002
         LH    R2,FOUR(R1)             R2=LENGTH OF INPUT.              22340002
         BCTR  R2,ZERO                 R2=EXECUTE LENGTH.               22360002
         EX    R2,SCONMOVE             MOVE INPUT INTO WORKAREA.        22380002
         LR    R3,R6                   R3=ADDR OF WORKAREA.             22400002
FINDOPEN EQU   *                                                        22420002
         LA    R3,ONE(R3)              R3=ADDR OF NEXT BYTE.            22440002
         CLI   ZERO(R3),OPEN           Q.OPEN PARENTHESIS FOUND.        22460002
         BNE   FINDOPEN                NO,CHECK NEXT BYTE.              22480002
         LR    R7,R3                   R7=ADDR OF OPEN PARENTHESIS.     22500002
         SR    R7,R6                   R7=LENGHT OF DISP.               22520002
         CLI   TWO(R3),CLOSE           Q.CLOSE PARENTHESIS FOUND.       22540002
         BNE   PACKTWO                 NO,PACK TWO BYTES.               22560002
         PACK  EIGHT(EIGHT,R6),ONE(ONE,R3) REGISTER NOW PACK DATA.      22580002
BINREG   EQU   *                                                        22600002
         CVB   R5,EIGHT(R6)            REG NOW BINARY DATA.             22620002
         SLL   R5,ONE2                 REG IN HI ORDER OF SECOND BYTE.  22640002
         SPACE                                                          22660002
* THE FOLLOWING LINES OF CODE CONVERTS THE DISP TO BINARY             * 22680002
         SPACE                                                          22700002
         BCTR  R7,ZERO                 R7=EXECUTE LENGTH.               22720002
         LA    R8,OUTLEN               R8=OUTPUT LENGTH.                22740002
         OR    R7,R8                   R7=LENGTH1 AND LENGTH2.          22760002
         EX    R7,PACKDATA             PACK THE ZONE DISP DATA.         22780002
         CVB   R8,EIGHT(R6)            DISP NOW BINARY DATA.            22800002
         OR    R5,R8                   R5=SCON IN BINARY.               22820002
         L     R2,CONAREA              R2=ADDR OF CONAREA.              22840002
         MVI   ZERO(R2),TWO            LENGTH NOW IN CONAREA.           22860002
         LA    R2,ONE(R2)              R2=ADDR ONE PASS CONAREA.        22880002
         STH   R5,ZERO(R2)             SCON IN CONAREA.                 22900002
         SR    R15,R15                 RC=0.                            22920002
         BR    R14                     RETURN.                          22940002
PACKTWO  EQU   *                                                        22960002
         PACK  EIGHT(EIGHT,R6),ONE(TWO,R3) REGISTER NOW PACK DATA.      22980002
         B     BINREG                  CONVERT REGISTER TO BINARY.      23000002
SCONMOVE MVC   ZERO(ONE,R6),ZERO(R3)   INPUT NOW IN WORKAREA.           23020002
PACKDATA PACK  EIGHT(ONE,R6),ZERO(ONE,R6) DISP NOW PACK DATA.           23040002
         SPACE                                                          23060002
*********************************************************************** 23080002
* THE FOLLOWING INSTRUCTIONS CONVERTS A VALUE FROM BINARY TO ITS      * 23100002
* PRINTABLE FORMAT.                                                   * 23120002
*********************************************************************** 23140002
         SPACE                                                          23160002
HYCODE   EQU   *                                                        23180002
         LA    R5,ONE                  R5=1,INDICATES H OR Y SPECIFIED. 23200002
         B     NOHORY                  GET TYPE CODE.                   23220002
FROMBI   EQU   *                                                        23240002
         SR    R5,R5                   R5=0. NOT H OR Y SWITCH.         23260002
         CLI   SEVEN(R1),HCODE         Q.H SPECIFIED.                   23280002
         BE    HYCODE                  YES,SET H OR Y SWITCH.           23300002
         CLI   SEVEN(R1),YCODE         Q.Y CODE SPECIFIED.              23320002
         BE    HYCODE                  YES,SET H OR Y SWITCH.           23340002
NOHORY   EQU   *                                                        23360002
         SR    R6,R6                   R6=0                             23380002
         IC    R6,SEVEN(R1)            R6=TYPE CODE IN HEX.             23400002
         L     R15,ACONLST2(R6)        R15=ADDRESS OF CVT RTN.          23420002
         BALR  R14,R15                 GOTO PROPER CVT RTN.             23440002
         USING ADDRBASE,R14            R14=TEMP BASE REGISTER.          23460002
ADDRBASE EQU   *                                                        23480002
         L     R12,CVTBASE             R12=ADDR OF IKJEGCVT.            23500002
         DROP  R14                     R14,NO LONGER BASE REGISTER.     23520002
         B     RETURN                  RETURN TO CALLER.                23540002
         SPACE                                                          23560002
BINPK    EQU   *                                                        23580002
         SPACE                                                          23600002
*********************************************************************** 23620002
*                                                                     * 23640002
*        THIS ROUTINE CONVERTS PACKED DECIMAL DATA TO PRINTABLE       * 23660002
*        CHARACTERS.                                                  * 23680002
*                                                                     * 23700002
*********************************************************************** 23720002
         SPACE                                                          23740002
         LA    R8,BADPK                R8=HEX -09-.                     23760002
         SR    R6,R6                   R6=0.                            23780002
         L     R3,ZERO(R1)             R3=ADDRESS OF INPUT STRING.      23800002
         LH    R4,FOUR(R1)             R4=LENGTH OF INPUT.              23820002
         LR    R5,R3                   R5=ADDRESS OF INPUT STRING.      23840002
         LR    R2,R4                   R2=LENGTH OF INPUT.              23860002
NEXTPK   EQU   *                                                        23880002
         BCT   R2,BYTECK               CHECK FOR VALID PK DATA.         23900002
         IC    R6,ZERO(R5)             R5=LAST BYTE.                    23920002
         SRDL  R6,FOUR                 RISOLATE HIGH ORDER 4 BITS.      23940002
         CLR   R6,R8                   Q.IS HITH ORDER 4 BITS VALID.    23960002
         BH    PKERROR                 NO,WRITE ERROR MESSAGE.          23980002
         SRL   R7,LOWORDER             LOW ORDER 4 BITS ISOLATED.       24000002
         CLR   R7,R8                   Q.LOW ORDER 4 BITS VALID.        24020002
         BNH   PKERROR                 NO,WRITE ERROR MESSAGE.          24040002
         B     SKIPPKCK                SKIP PACK VALIDITY CHECK.        24060002
BYTECK   EQU   *                                                        24080002
         IC    R6,ZERO(R5)             R6=BYTE OF PACKED DATA.          24100002
         SRDL  R6,FOUR                 ISOLATE HIGH ORDER 4 BITS.       24120002
         CLR   R6,R8                   Q.HIGH ORDER 4 BITS VALID.       24140002
         BH    PKERROR                 NO,WRITE ERROR MESSAGE.          24160002
         SRL   R7,LOWORDER             LOW ORDER 4 BITS ISOLATED.       24180002
         CLR   R7,R8                   Q.LOW ORDER 4 BITS VALID.        24200002
         BH    PKERROR                 NO,WRITE ERROR MESSAGE.          24220002
         LA    R5,ONE(R5)              R5=ADDR OF NEXT BYTE.            24240002
         B     NEXTPK                  GET NEXT BYTE.                   24260002
SKIPPKCK EQU   *                                                        24280002
         LA    R6,ZERO(R4,R3)          R6=ADDR OF LAST BYTE OF INPUT.   24300002
         BCTR  R6,ZERO                 *                                24320002
         L     R2,WORKAREA             R2=ADDRESS OF WORKAREA.          24340002
         LA    R5,ZERO(R4,R2)          R5=ADDRESS OF SIGN BYTE.         24360002
         BCTR  R5,ZERO                 *                                24380002
         BCTR  R4,ZERO                 R4=EXECUTE LENGTH.               24400002
         EX    R4,MOVEPK               MOVE INPUT INTO WORKAREA.        24420002
         LA    R4,ONE(R4)              R4=CORRECT LENGTH.               24440002
         OI    ZERO(R5),SIGNF          ALTER SIGN TO X'F'               24460002
         LA    R5,ONE(R4,R2)           R5=ADDRESS OF EDIT OUTPUT AREA.  24480002
         MVC   ZERO(THREE2,R5),PATTERN MOVE PATTERN INTO WORKAREA.      24500002
         SLL   R4,ONE                  R4=LENGTH TIMES 2.               24520002
         BCTR  R4,ZERO                 R4=LENGTH MINUS ONE.             24540002
         LR    R7,R4                   R7=NEW LENGTH.                   24560002
         BCTR  R7,ZERO                 R7=NEW LENGTH MINUS 1.           24580002
         LA    R1,ZERO(R5,R7)          R1=ADDR OF LAST BYTE OF OUTPUT.  24600002
         LR    R7,R1                   R7=ADDR OF LAST BYTE OF OUTPUT.  24620002
         EX    R4,ZONEPK               INPUT NOW ZONE DECIMAL.          24640002
         CLI   ZERO(R1),BLANK          Q.IS LAST CHARACTER A BLANK.     24660002
         BNE   NOBLANK                 NO,SKIP MOVE IN ZERO CODE.       24680002
         MVI   ZERO(R1),AZERO          MOVE IN A CHARACTER -0-.         24700002
NOBLANK  EQU   *                                                        24720002
         L     R2,CONAREA              R2=ADDR OF CONAREA.              24740002
         TM    ZERO(R6),PLUSBIT        LOW ORDER BIT OF BYTE ON.        24760002
         BZ    ITSPLUS                 NO,THE STRING IS POSITIVE        24780002
         TM    ZERO(R6),PLUSBITS       Q.IS SIGN NEGATIVE.              24800002
         BO    ITSPLUS                 NO,IT MUST BE POSITIVE.          24820002
         BCTR  R1,ZERO                 R1=ADDR OF SIGN LOCATION.        24840002
         MVI   ZERO(R1),SIGNNEG        PUT SIGN IN OUTPUT AREA.         24860002
PUTOUT   EQU   *                                                        24880002
         LA    R7,ONE(R7)              R7=END OF ZONED DATA ADDR.       24900002
         SR    R7,R1                   R7=LENGTH OF ZONED DATA.         24920002
         EX    R7,MOVEOUT              MOVE OUTPUT INTO OUTPUT AREA.    24940002
         LA    R7,ONE(R7)              R4=LENGTH OF OUTPUT.             24960002
         STC   R7,ZERO(R2)             LENGTH OF OUTPUT NOW IN CONAREA. 24980002
         SR    R15,R15                 SET RETURN CODE TO 0.            25000002
         BR    R14                     RETURN                           25020002
ITSPLUS  EQU   *                                                        25040002
         BCTR  R1,ZERO                 R1=ADDR OF SIGN LOCATION.        25060002
         MVI   ZERO(R1),PLUSSIGN       PUT PLUS SIGN IN OUT PUT AREA.   25080002
         B     PUTOUT                  MOVE OUTPUT INTO CONAREA.        25100002
ZONEPK   EDMK  ZERO(ONE,R5),ZERO(R2)   STRING NOW PRINTABLE CHARACTERS. 25120002
MOVEPK   MVC   ZERO(ONE,R2),ZERO(R3)   MOVE INPUT INTO WORKAREA.        25140002
MOVEOUT  MVC   ONE(ONE,R2),ZERO(R1)    MOVE OUTPUT INTO OUTPUT AREA.    25160002
PKERROR  EQU   *                                                        25180002
         LA    R4,MSG003               R4=ADDR OF MSG PARM LIST.        25200002
         B     ERRORPK                 WRITE ERROR MESSAGE.             25220002
BINAQVY  EQU   *                                                        25240002
         SPACE                                                          25260002
*********************************************************************** 25280002
*                                                                     * 25300002
*        THIS ROUTINE CONVERTS A,Q,V, AND Y TYPE CONSTANTS FROM       * 25320002
*        BINARY TO PRINTABLE CHARACTERS.  WHEN THE TYPE OS H OR Y,    * 25340002
*        REGISTER 5 MUST CONTAIN A VALUE GREATER THAN ZERO('0')       * 25360002
*        OTHERWISE REGISTER 5 WILL BE ZERO.                           * 25380002
*                                                                     * 25400002
*********************************************************************** 25420002
         SPACE                                                          25440002
         L     R2,CONAREA              R2=ADDRESS OF CONAREA.           25460002
         LH    R4,FOUR(R1)             R4=LENGTH OF INPUT.              25480002
         L     R1,ZERO(R1)             R1=ADDRESS OF INPUT STRING.      25500002
         L     R10,WORKAREA            R10=ADDRESS OF WORKAREA.         25520002
         BCTR  R4,ZERO                 R4=EXECUTE LENGTH.               25540002
         EX    R4,AQVYMOVE             MOVE INPUT INTO WORKAREA.        25560002
         L     R1,ZERO(R10)            R1=INPUT STRING.                 25580002
         LA    R5,THREE                R5=3.                            25600002
         SR    R5,R4                   R5=LENGTH MINUS 3.               25620002
         M     R4,FULL8                R5=NUMBER OF BITS TO SHIFT.      25640002
         SRL   R1,ZERO(R5)             INPUT RIGHT JUSTIFIED.           25660002
         N     R1,MASKSIGN             TURN HIGH ORDER BIT OFF.         25680002
         CVD   R1,ZERO(R10)            STRING NOW PACK DECIMAL.         25700002
         OI    SEVEN(R10),SIGNF        ALTER SIGN TO HEX F.             25720002
         UNPK  EIGHT(ONE5,R10),ZERO(EIGHT,R10) ZONED DECIMAL DATA.      25740002
         LA    R1,TWO3(R10)            R1=END OF OUTPUT ADDR.           25760002
         LA    R5,ONE4                 R5=14.                           25780002
         LA    R10,EIGHT(R10)          R10=PTR TO OUTPUT DATA.          25800002
BUMP     CLI   ZERO(R10),AZERO         Q.VALID DATA FOUND.              25820002
         BNE   NOBUMP                  YES,COMPUTE LENGTH OF OUTPUT.    25840002
         LA    R10,ONE(R10)            BUMP PTR TO OUTPUT.              25860002
         BCT   R5,BUMP                 ALL OUTPUT TESTED FOR A ZERO.    25880002
NOBUMP   EQU   *                                                        25900002
         SR    R1,R10                  R1=LENGTH OF OUTPUT.             25920002
         STC   R1,ZERO(R2)             LENGTH NOW IN CONAREA.           25940002
         BCTR  R1,ZERO                 R1=EXECUTE LENGTH.               25960002
         EX    R1,MOVE2                OUTPUT NOW IN CONAREA.           25980002
         SR    R15,R15                 RC=0.                            26000002
         BR    R14                     RETURN TO CALLER.                26020002
MOVE2    MVC   ONE(ONE,R2),ZERO(R10)   MOVE OUTPUT TO CONAREA.          26040002
AQVYMOVE MVC   ZERO(ONE,R10),ZERO(R1)  INPUT NOW IN WORKAREA.           26060002
         SPACE                                                          26080002
BINFDEC  EQU   *                                                        26100002
         SPACE                                                          26120002
*********************************************************************** 26140002
*                                                                     * 26160002
*        THIS ROUTINE CONVERTS BINARY TO FIXED DECIMAL PRINTABLE.     * 26180002
*                                                                     * 26200002
*********************************************************************** 26220002
         SPACE                                                          26240002
         L     R2,CONAREA              R2=ADDR OF OUTPUT AREA.          26260002
         SR    R8,R8                   INITIALIZE GT SWITCH.            26280002
         LH    R6,FOUR(R1)             R6=LENGTH OF INPUT STRING.       26300002
         L     R3,ZERO(R1)             R3=ADDR OF INPUT STRING.         26320002
         L     R4,WORKAREA             R4=ADDR OF WORKAREA.             26340002
         MVI   ONE(R2),PLUSSIGN        PUT PLUS SIGN INTO OUTPUT AREA.  26360002
         SPACE                                                          26380002
*        IS THE LENGTH OF THE BINARY VALUE GREATER THAN 4 BYTES.      * 26400002
         SPACE                                                          26420002
         CL    R6,FIXLEN               Q.LENGTH GT 4 BYTES.             26440002
         BH    GREATER                 YES,CONVERT FIRST 4 BYTES.       26460002
         SPACE                                                          26480002
*********************************************************************** 26500002
*                                                                     * 26520002
*        THIS SECTION CONVERT ONLY FOUR BYTES OF BINARY DIGITS TO     * 26540002
*        ITS PRINTABLE FORM.                                          * 26560002
*                                                                     * 26580002
*********************************************************************** 26600002
         SPACE                                                          26620002
         BCTR  R6,ZERO                 R6=EXECUTE LENGTH.               26640002
         EX    R6,MOVEIN               INPUT NOW IN WORKAREA.           26660002
         LA    R6,ONE(R6)              R6=CORRECT LENGTH.               26680002
         L     R1,ZERO(R4)             R1=INPUT STRING.                 26700002
         MVI   ONE(R2),PLUSSIGN        PUT PLUS SIGN INTO OUTPUT AREA.  26720002
         LA    R0,EIGHT                R0=EIGHT.                        26740002
         LA    R5,FOUR                 R5=4.                            26760002
         SR    R5,R6                   R5=4 MINUS LENGTH.               26780002
         LTR   R5,R5                   Q.IS LENGTH 4.                   26800002
         BZ    NOSRL                   YES,SKIP RIGHT JUSTIFY.          26820002
         MR    R4,R0                   R4=SHIFT FACTOR.                 26840002
         SRA   R1,ZERO(R5)             RIGHT JUSTIFY INPUT.             26860002
NOSRL    EQU   *                                                        26880002
         LTR   R1,R1                   Q.IS VALUE NON-NEGATIVE.         26900002
         BNM   NONNEG                  YES,SKIP COMPLEMENT ROUTINE.     26920002
         SPACE                                                          26940002
*        THIS AREA COMPLEMENTS THE NEGATIVE BINARY VALUE.             * 26960002
         SPACE                                                          26980002
         LCR   R1,R1                   R1,NOW POSITIVE FOR CONVERT.     27000002
         MVI   ONE(R2),SIGNNEG         MOVE IN NEG SIGN.                27020002
         SPACE                                                          27040002
NONNEG   EQU   *                                                        27060002
         L     R3,WORKAREA             R3=ADDRESS OF WORKAREA.          27080002
         CVD   R1,ZERO(R3)             STRING IS NOW PACKED DECIMAL.    27100002
         LTR   R8,R8                   Q.LENGTH GT 4 BYTES.             27120002
         BZ    SKIP1                   NO,SKIP ADD ROUTINE              27140002
         SPACE                                                          27160002
*********************************************************************** 27180002
*                                                                     * 27200002
*        THIS SECTION ADDS THE REMAINDER OF THE INPUT STRING          * 27220002
*        (PACKED DECIMAL) TO THE ALREADY COMPUTED PACKED BYTES        * 27240002
*        OF THE STRING AND CONVERTS THE STRING TO ZONED DECIMAL.      * 27260002
*                                                                     * 27280002
*********************************************************************** 27300002
         SPACE                                                          27320002
         LTR   R7,R7                   Q.IS ADD ONE SWITCH ON.          27340002
         BZ    NOTON                   NO,DO NOT ADD ONE.               27360002
         AP    PACKANS(TEN,R3),PACKONE YES,ADD ONE.                     27380002
NOTON    EQU   *                                                        27400002
         AP    PACKANS(TEN,R3),ZERO(EIGHT,R3) ADD 2ND WORD TO 1ST WORD. 27420002
         MVN   PACKSIGN(ONE,R3),MASKSIGN   SET SIGN BITS TO HEX F.      27440002
         MVC   WORK3(TWO0,R3),PATTERN  PUT PATTERN INTO WORKAREA.       27460002
         MVI   FDECSTAR(R3),STARTER    STARTER CHAR NOW IN WORKAREA.    27480002
         LA    R1,FDECSTAR+ONE(R3)     R1=ADDR OF LAST BYTE.            27500002
         EDMK  WORK3(TWO0,R3),PACKANS(R3)  BLANK OUT LEADING ZEROS.     27520002
         LA    R4,FIXED(R3)            R4=END OF ZONED DATA.            27540002
         SR    R4,R1                   R4=NUMBER OF OUTPUT DIGITS.      27560002
         STC   R4,ZERO(R2)             LENGTH NOW IN OUTPUT AREA.       27580002
         BCTR  R4,ZERO                 R4=EXECUTE LENGTH                27600002
         BCTR  R4,ZERO                 R4=EXECUTE LENGTH.               27620002
         LR    R3,R1                   R3=ADDR OF SIGNIFICANCE BYTES.   27640002
         EX    R4,MOVE                 MOVE OUTPUT INTO CONAREA.        27660002
         SR    R15,R15                 R15=RC 0.                        27680002
         BR    R14                     RETURN                           27700002
         SPACE                                                          27720002
SKIP1    EQU   *                                                        27740002
         SPACE                                                          27760002
*********************************************************************** 27780002
*                                                                     * 27800002
*        THIS SECTION OF CODE CONVERTS FROM PACKED DECIMAL TO         * 27820002
*        ZONED THE INPUT WITH A LENGTH OF FOUR OR LESS.               * 27840002
*                                                                     * 27860002
*********************************************************************** 27880002
         SPACE                                                          27900002
         LA    R1,NOFZONE-TWO(R3)      R1=ADDR FOR STARTER CHAR.        27920002
         MVC   WORK5(ONE7,R3),PATTERN  PUT PATTERN INTO WORKAREA.       27940002
         MVI   ZERO(R1),STARTER        STARTER CHAR NOW IN PATTERN.     27960002
         LA    R1,ONE(R1)              R1=ADDR OF LAST BYTE.            27980002
         EDMK  WORK5(ONE6,R3),ZERO(R3) INPUT NOW ZONED DECIMAL.         28000002
         LR    R0,R3                   R0=ADDR OF WORKAREA.             28020002
         LR    R3,R1                   R3=ADDRESS OF ZONED DECIMAL.     28040002
         LA    R6,NOFZONE              R6=END OF ZONE DECIMAL.          28060002
         AR    R6,R0                   R6=END OF OUTPUT.                28080002
         SR    R6,R1                   R6=LENGTH OF OUTPUT.             28100002
         EX    R6,MOVE                 MOVE OUTPUT INTO CONAREA.        28120002
         LA    R6,ONE(R6)              R6=LENGTH OF OUTPUT.             28140002
         STC   R6,ZERO(R2)             MOVE LENGTH INTO CONAREA.        28160002
         SR    R15,R15                 R15=RC 0.                        28180002
         BR    R14                     RETURN                           28200002
GREATER  EQU   *                                                        28220002
         SPACE                                                          28240002
*********************************************************************** 28260002
*                                                                     * 28280002
*        THIA AREA OF CODE CONVERTS A BINARY VALUE TO PACKED DECIMAL  * 28300002
*        WHOSE LENGTH IS GREATER THAN FOUR BYTES.  ONLY THE HIGH      * 28320002
*        ORDER FOUR BYTES ARE PACKED.                                 * 28340002
*                                                                     * 28360002
*********************************************************************** 28380002
         SPACE                                                          28400002
         XC    ZERO(EIGHT,R4),ZERO(R4) INPUT AREA NOW CLEARED.          28420002
         SR    R7,R7                   R7=0.                            28440002
         LA    R1,SEVEN                R2=7.                            28460002
         BCTR  R6,ZERO                 R6=EXECUTE LENGTH.               28480002
         SR    R1,R6                   R2=NUMBER OF LEADING ZEROES.     28500002
         LA    R4,ZERO(R1,R4)          NEW ADDR OF WORKAREA.            28520002
         EX    R6,MOVEIN               MOVE INPUT INTO WORKAREA.        28540002
         L     R3,WORKAREA             R3=ADDR OF WORKAREA.             28560002
         TM    ZERO(R4),VALCK          Q.IS INPUT NEGATIVE.             28580002
         BZ    NOTNEG                  NO,DO NOT COMPLEMENT.            28600002
         MVI   ONE(R2),SIGNNEG         MOVE IN NEG SIGN.                28620002
         MVI   EIGHT(R4),NEGBYTE       SET AN AREA                      28640002
         MVC   NINE(SEVEN,R4),EIGHT(R4)            TO 2 WORDS OF ONES.  28660002
         XC    EIGHT(EIGHT,R3),ZERO(R3) FLIP BITS POSITIVE.             28680002
         LA    R3,EIGHT(R3)            R3=ADDR OF INPUT.                28700002
         LA    R7,ONE                  R7=1,INDICATE NEG & GT 4 BYTES.  28720002
NOTNEG   EQU   *                                                        28740002
         SPACE                                                          28760002
*********************************************************************** 28780002
*                                                                     * 28800002
*        THE FOLLOWING CODE CALCULATES THE VALUE OF THE HIGH ORDER    * 28820002
*        BYTES OF THE INPUT STRING THAT EXCEEDS FOUR BYTES.           * 28840002
*                                                                     * 28860002
*********************************************************************** 28880002
         SPACE                                                          28900002
         L     R4,WORKAREA             R4=ADDR OF WORKAREA.             28920002
         L     R5,ZERO(R3)             R5=INPUT STRING.                 28940002
         LA    R2,ONE                  R2=1.                            28960002
         MVC   PACKWORK(TEN,R4),PACKVAL INITIAL VALUE IN PACK WORKAREA. 28980002
         XC    PACKANS(TEN,R4),PACKANS(R4) ZERO OUT PACK ANSWER PLACE.  29000002
         LA    R6,FIXCOUNT             R6=31,LOOP COUNT.                29020002
         LR    R1,R2                   R1=1.                            29040002
         OI     SIGNIT(R4),SIGNF       PACK SIGN NOW X'F'.              29060002
NEXTBIT  EQU   *                                                        29080002
         NR    R2,R5                   SET UP TEST REGISTER.            29100002
         BZ    NOTON2                  NO,JUST ADVANCE PACK VALUE.      29120002
         AP    PACKANS(TEN,R4),PACKWORK(TEN,R4) COMPUTE PACK VALUE.     29140002
NOTON2   EQU   *                                                        29160002
         AP    PACKWORK(TEN,R4),PACKWORK(TEN,R4) UPDATE PACK VALUE.     29180002
         AR    R1,R1                   UPDATE BIT INDICATOR.            29200002
         LR    R2,R1                   R2=BIT INDICATOR.                29220002
         BCT   R6,NEXTBIT              IF MORE BITS TEST NEXT ONE.      29240002
         SPACE                                                          29260002
*********************************************************************** 29280002
*                                                                     * 29300002
*        THE FOLLOWING CODE CHECK THE HIGH ORDER BIT OF THE SECOND    * 29320002
*        WORD OF THE INPUT STRING TO DETERMINE IF IT IS ON. IF IT IS  * 29340002
*        ON IT WILL BE TURNED OFF AND THE VALUE OF IT WILL BE ADDED   * 29360002
*        TO THE FINAL VALUE. NO PROCESSING WILL BE DONE TO REFLECT    * 29380002
*        THE BIT BEINGING OFF.                                        * 29400002
*                                                                     * 29420002
*********************************************************************** 29440002
         SPACE                                                          29460002
         L     R2,CONAREA              R2=ADDR OF OUTPUT AREA.          29480002
         LA    R8,ONE                  SET GT SWITCH = GT 4 BYTES.      29500002
         L     R1,FOUR(R3)             R1=2ND WORK OF INPUT STRING.     29520002
         TM    FOUR(R3),HION           Q.HI ORDER BIT ON.               29540002
         BNO   NONNEG                  NO, BIT IS OFF.                  29560002
         SLL   R1,ONE                  DROP HI ORDER BIT.               29580002
         SRL   R1,ONE                  ISOLATE REMAINDER OF BITS.       29600002
         AP    PACKANS(TEN,R4),LASTPACK  COMPUTE PACKED VALUE.          29620002
         B     NONNEG                  CONTINUE PROCESSING.             29640002
MOVE     MVC   TWO(ONE,R2),ZERO(R3)    MOVE OUTPUT INTO CONAREA.        29660002
MOVEIN   MVC   ZERO(ONE,R4),ZERO(R3)   MOVE INPUT INTO WORKAREA.        29680002
BINHEX   EQU   *                                                        29700002
         SPACE                                                          29720002
*********************************************************************** 29740002
* THIS ROUTINE CONVERTS BINARY TO PRINTABLE HEXADECIMAL.              * 29760002
*********************************************************************** 29780002
         SPACE                                                          29800002
         L     R3,WORKAREA             R3=ADDRESS OF WORKAREA.          29820002
         LR    R4,R3                   R4=ADDRESS OF WORKAREA.          29840002
         L     R2,CONAREA              R2=OUTPUT AREA ADDRESS.          29860002
         LA    R2,ONE(R2)              ADVANCE PASS LENGTH AREA.        29880002
         LH    R10,FOUR(R1)            R10=LENGTH OF INPUT.             29900002
         BCTR  R10,ZERO                R10=EXECUTE LENGTH.              29920002
         L     R1,ZERO(R1)             R1=ADDRESS OF INPUT STRING.      29940002
         EX    R10,BHMOVE              MOVE INPUT TO EVEN BOUNDARY.     29960002
         LA    R10,ONE(R10)            R10=ACTUAL LENGTH OF INPUT.      29980002
         SLL   R10,ONE                 R10=LENGTH OF OUTPUT.            30000002
         SR    R1,R1                   CLEAR LENGTH COUNTER.            30020002
NEXTWORD EQU   *                                                        30040002
         L     R7,ZERO(R4)             GET A WORD OF INPUT.             30060002
         SR    R5,R5                   CLEAR COUNTER.                   30080002
MOREBITS EQU   *                                                        30100002
         SR    R6,R6                   CLEAR WORK REGISTER.             30120002
         SLDL  R6,FOUR                 MOVE J BITS INTO WORK REG.       30140002
         CL    R6,FULLNINE             Q.BITS GT 9.                     30160002
         BH    GREAT                   YES,CONVERT TO ALPHABETIC.       30180002
         LA    R6,F0(R6)               CONVERT TO HEX VALUE.            30200002
NEXT     EQU   *                                                        30220002
         STC   R6,ZERO(R2)             MOVE TO CONAREA.                 30240002
         LA    R2,ONE(R2)              INCREMENT CONAREA POINTER.       30260002
         LA    R5,ONE(R5)              INCREMENT INPUT COUNTER.         30280002
         LA    R1,ONE(R1)              INCREMENT LENGTH COUNTER.        30300002
         BCT   R10,BHEXGO              Q.MORE INPUT.                    30320002
BHEXEND  EQU   *                                                        30340002
         L     R2,CONAREA              R2=ADDRESS OF OUTPUT AREA.       30360002
         STC   R1,ZERO(R2)             PUT LENGTH INTO  CONAGRA.        30380002
         SR    R15,R15                 RC=0.                            30400002
         BR  R14                       RETURN TO CALLER.                30420002
BHEXGO   EQU   *                                                        30440002
         CL    R5,FULL8                Q.ANOTHER WORD NEEDED.           30460002
         BE    ADVANCE                 YES,INCREMENT R4 4 BYTES.        30480002
         B     MOREBITS                GET NEXT 4 BITS.                 30500002
ADVANCE  EQU   *                                                        30520002
         LA    R4,FOUR(R4)             R4=NEXT FOUR BYTES ADDRESS.      30540002
         B     NEXTWORD                GET NEW WORD.                    30560002
GREAT    EQU   *                                                        30580002
         LA    R6,B7(R6)               CONVERT TO HEX VALUE.            30600002
         B     NEXT                    MOVE BYTE TO CONAREA.            30620002
BHMOVE   MVC   ZERO(ONE,R4),ZERO(R1)   MOVE INPUT TO EVEN BOUNDARY.     30640002
         EJECT                                                          30660002
*********************************************************************** 30680002
* THE FOLLOWING IS A GROUP OF CONSTANTS USED BY THE CSECT'S             30700002
*********************************************************************** 30720002
         SPACE                                                          30740002
FIXLEN   DC    F'4'                    FULL WORD 4.                     30760002
FULLNINE DC    F'9'                    FULL WORD 9.                     30780002
FULL8    DC    F'8'                    FULL WORD 8.                     30800002
MASKSIGN DC    X'7FFFFFFF'             USED TO TURN OFF HIGH ORDER BIT. 30820002
PACKONE  DC    PL10'1'                 PACKED DECIMAL 1.                30840002
ZEROS    DC    X'0000'                 HALFWORD OF DECIMAL ZEROES.      30860002
OFFSETC  DC    X'FC'                   NUMERIC C FOR PACK SIGN.         30880002
OFFSETD  DC    X'FD'                   NUMERIC D FOR PACK SIGN.         30900002
PATTERN  DC    X'40'                   PATTERN FIELD FOR THE EDIT       30920002
         DC    31X'20'                 AND MARK INSTRUCTION.            30940002
NEGSIGN  DC    P'-1'                   PACKED DECIMAL -1.               30960002
         DS    0F                                                       30980002
ORREG    DC    X'00000070'             OUTPUT LENGTH FOR EXECUTE.       31000002
COMPFLD  DC    X'FFFFFFFF'             FULL WORD OF ONES.               31020002
         DS    0X                                                       31040002
PACKVAL  DC    PL10'4294967296'        PACK DECIMAL VALUE FOR FIXDEC.   31060002
LASTPACK DC    PL10'2147483648'        *                                31080002
BKPLUS   DC    C' +'                   MSG PLUS SIGN.                   31100002
SMTSYM2  DC    C'SYM'                  CONSTANT NAME FOR BLDL           31120002
*                                       SMT TESTCASE LABEL              31140002
*                                       LINK TO SYM FAILED              31160002
*                                       TESTCASE ID  TTSTC120           31180002
*                                       TESTCASE ID  TEQU5300           31200002
SUPERZAP DC    50CL1'Z'                SUPERZAP PATCHING AREA           31210002
         DS     0F                                                      31220002
LINKLST  LINK  SF=L                    LIST FORM OF LINK.               31320002
LINKLSTL EQU   *-LINKLST               LENGTH OF LIST FORM OF LINK.     31340002
ESTAELST ESTAE MF=L                    LIST FORM OF THE ESTAE MACRO     31350002
ESTAELN  EQU   *-ESTAELST              LENGTH OF ESTAE MACRO EXPANSION  31352002
         TITLE 'IKJEGCVT CONVERT BRANCH TABLE.'                         31360002
*********************************************************************** 31380002
* THE FOLLOWING LIST OF ADCONS AND VCONS ROUTES CONTROL TO THE PROPER * 31400002
* PRINTABLE TO BINARY CONVERSION ROUTINE.  THE VCONS ROUTE CONTROL TO * 31420002
* THE 2ND CSECT OF CONVERT WHICH CONTAINS THE INSTRUCTION AND FLOATING* 31440002
* POINT CONVERSIONS.                                                  * 31460002
*********************************************************************** 31480002
         SPACE                                                          31500002
ACONLST  EQU   *                                                        31520002
         DC    A(RETURN)               CODE X'00' FOR CHAR.             31540002
         DC    A(HEXBIN)               CODE X'04' FOR HEX.              31560002
         DC    A(BINBIN)               CODE X'08' FOR BINARY.           31580002
         DC    A(RETURN)               CODE X'0C' FOR INST FROM BIN.    31600002
         DC    A(FAQVBIN)              CODE X'10' FOR FULLWORD FIXED PT 31620002
         DC    A(FAQVBIN)              CODE X'14' FOR HALFWORD FIXED PT 31640002
         DC    V(IKJEGFTB)             CODE X'18' FOR SHORT FLT PT.     31660002
         DC    V(IKJEGFTB)             CODE X'1C' FOR LONG FLT PT.      31680002
         DC    A(FAQVBIN)              CODE X'20' FOR A AND Q ADDRESS.  31700002
         DC    A(FAQVBIN)              CODE X'24' FOR Y ADDR CONSTANTS. 31720002
         DC    A(SCONBIN)              CODE X'28' FOR S ADDR CONSTANTS. 31740002
         DC    A(FAQVBIN)              CODE X'2C' FOR V ADDR CONSTANTS. 31760002
         DC    A(PKBIN)                CODE X'30' FOR PACKED DECIMAL.   31780002
         DC    A(RETURN)               CODE X'34' FOR ZONED DECIMAL.    31800002
         DC    A(RETURN)               CODE X'38' FOR EXTENDED FLT PT.  31820002
         SPACE                                                          31840002
*********************************************************************** 31860002
* THE FOLLOWING LIST OF ADCONS AND VCONS ROUTES CONTROL TO THE PROPER * 31880002
* BINARY TO PRINTABLE CONVERSION ROUTINE.  THE VCONS ROUTES CONTROL TO* 31900002
* THE 2ND CSECT OF CONVERT WHICH CONTAINS THE INSTRUCTION AND FLOATING* 31920002
* POINT CONVERSIONS.                                                  * 31940002
*********************************************************************** 31960002
         SPACE                                                          31980002
ACONLST2 EQU   *                                                        32000002
         DC    A(RETURN)               CODE X'00' FOR CHAR.             32020002
         DC    A(BINHEX)               CODE X'04' FOR HEXADECIMAL.      32040002
         DC    A(RETURN)               CODE X'08' FOR BINARY.           32060002
         DC    V(IKJEGIST)             CODE X'0C' FOR INSTRUCTION.      32080002
         DC    A(BINFDEC)              CODE X'10' FOR FULLWORD FIXED PT 32100002
         DC    A(BINFDEC)              CODE X'14' FOR HALFWORD FIXED PT 32120002
         DC    V(IKJEGBFT)             CODE X'18' FOR SHORT FLT PT.     32140002
         DC    V(IKJEGBFT)             CODE X'1C' FOR LONG FLT PT.      32160002
         DC    A(BINAQVY)              CODE X'20' FOR A AND Q ADDRESS.  32180002
         DC    A(BINAQVY)              CODE X'24' FOR Y ADDR CONSTANTS. 32200002
         DC    V(IKJEGBIS)             CODE X'28' FOR S ADDR CONSTANTS. 32220002
         DC    A(BINAQVY)              CODE X'2C' FOR V ADDR CONSTANTS. 32240002
         DC    A(BINPK)                CODE X'30' FOR V ADDR CONSTANTS. 32260002
         DC    A(RETURN)               CODE X'34' FOR ZONED DECIMAL.    32280002
         DC    A(RETURN)               CODE X'38' FOR EXTENDED FLT PT.  32300002
CVTBASE  DC    A(CVTBEGIN)             ADDR OF IKJEGCVT.                32320002
         TITLE 'IKJEGCVT INSTRUCTION CONVERSION ROUTINE.'               32340002
IKJEGCVX   CSECT                                                        32360002
         SPACE                                                          32380002
*********************************************************************** 32400002
*                                                                     * 32420002
* THIS CSECT IS AN EXTENTION OF THE CONVERT ROUTINE.  THE INSTRUCTION * 32440002
* CONVERSIONS FROM BINARY TO PRINTABLE CHARACTERS ARE FOUND IN THIS   * 32460002
* CSECT.                                                              * 32480002
*                                                                     * 32500002
*********************************************************************** 32520002
         SPACE                                                          32540002
         ENTRY IKJEGIST                                                 32560002
         ENTRY IKJEGBIS                                                 32580002
         SPACE                                                          32600002
*********************************************************************** 32620002
* THE FOLLOWING INSTRUCTIONS CONVERT AN INSTRUCTION IN STORAGE FROM   * 32640002
* ITS BINARY VALUE TO ITS PRINTABLE FORMAT.  A VALIDITY CHECK  IS     * 32660002
* TAKEN TO DETERMINE IF THE OP CODE IS VALID.  IF THE OP CODE IS IN-  * 32680002
* VALID AN ERROR MESSAGE IS PRINTED DESCRIBING THE CONDITION.         * 32700002
*********************************************************************** 32720002
         SPACE                                                          32740002
IKJEGIST EQU   *                                                        32760002
         LR    R12,R15                 R12=ADDRESS OF IKJEGCVX.         32780002
         USING IKJEGCVX,R12            IKJEGCVX ADDRESSABILITY.         32800002
         USING TCOMTAB,R9              TCOMTAB ADDRESSABILITY.          32820002
         L     R3,ZERO(R1)             R3=PT TO THE INPUT STRING.       32840002
         SR    R5,R5                   R5=ZERO.                         32860002
         L     R7,WORKAREA             R7=ADRESS OF WORKAREA.           32880002
         USING CVTWORK,R7              USE R7 TO ADDRESS WORKAREA.      32900002
         L     R2,CONAREA              R2=ADDR OF THE OUTPUT AREA       32920002
         MVI   CODE370,HEX00           CLEAR 370 FLAG INITIALLY.        32940002
         CLI   ZERO(R3),B2             Q.IS OP CODE TWO BYTES.          32960002
         BNE   ONEBYTOP                NO,GET OP CODE.                  32980002
         CLI   ONE(R3),HEX13           YES,Q.IS 2 BYTE CODE VALID.      33000002
         BH    NOOPCODE                NO,ERROR MESSAGE.                33020002
         IC    R5,ONE(R3)              R5=SECOND OP CODE BYTE.          33040002
         LA    R8,SIX                  R2= X'6' (IE OP TABLE INCREMT)   33060002
         MR    R4,R8                   R5=INDEX FACTOR TO GET MNENOMIC  33080002
         L     R6,TSTOPCD2             R6=ADDR OF 2 BYTE OPCODE TABLE   33100002
         LA    R6,ZERO(R5,R6)          R6=ADDR OF OPCODE                33120002
         MVC   ONE(FIVE,R2),ZERO(R6)   PUT PRINTABLE OPCODE IN CONAREA  33140002
         LA    R8,FIVE                 R8=INDEX FOR OPCODE TABLE BRANCH 33160002
MVONEBK  EQU   *                       INSERT 1 BLANK FOLLOWING OPCODE  33180002
         MVI   SIX(R2),BLANK           FOLLOW OPCODE WITH ONE BLANK     33200002
         B     OPBRANCH                FIND THE OPCODE TYPE             33220002
ONEBYTOP EQU   *                                                        33240002
         CLI   ZERO(R3),STCTLM         Q.IS OP CODE STCTL-5 CHARS.      33260002
         BE    SETCODE5                NO                               33280002
         CLI   ZERO(R3),STNSMM         Q.IS OP CODE STNSM-5 CHARS.      33300002
         BE    SETCODE5                NO                               33320002
         CLI   ZERO(R3),STOSMM         Q.IS OP CODE STOSM-5 CHARS.      33340002
         BNE   COMMONOP                NO, TRY OPCODE TABLE FOR 360     33360002
SETCODE5 EQU   *                                                        33380002
         OI    CODE370,CHAR5           FLAG INDICATING 5 CHAR OPCODE    33400002
COMMONOP EQU   *                                                        33420002
         IC    R5,ZERO(R3)             R5=THE OP CODE IN BINARY.        33440002
         LA    R8,FIVE                 R2=HEX 5.                        33460002
         MR    R4,R8                   R5=INDEX FACTOR TO GET MNEMONIC. 33480002
         L     R6,OPCODTAB             R6=ADDR OF OPCODETAB.            33500002
         LA    R6,ZERO(R5,R6)          R6=ADDRESS OF OPCODE.            33520002
         LA    R8,FOUR                 R8=INDEX TO OPCODE TYPE FIELD    33540002
         TM    CODE370,CHAR5           Q.IS MNEUMONIC 5 CHARS.          33560002
         BNO   MOVEMNEU                NO,MOVE 4 CHARS FROM TABLE.      33580002
         MVI   ONE(R2),CHARS           YES,MOVE IN FIRST S CHAR.        33600002
         MVC   TWO(FOUR,R2),ZERO(R6)   INSERT REMAINING 4-BYT OF OPCODE 33620002
         B     MVONEBK                 INSERT THE BLANK                 33640002
MOVEMNEU EQU   *                                                        33660002
         MVC   ONE(FOUR,R2),ZERO(R6)   PRINTABLE OP CODE IN CONAREA.    33680002
         CLI   ZERO(R3),SIOFOP         Q.IS OP CODE X'9C' (SIOF OR SIO) 33700002
         BNE   MVBLANK                 NO,MOVE BLANK PAST MNEUMONIC.    33720002
         TM    ONE(R3),HEX01           YES.Q.IS OP CODE SIOF.           33740002
         BNO   MVBLANK                 NOT SIOF. MOVE BLANK.            33760002
         MVI   FOUR(R2),CHARF          IS SIOF. ADD F TO MNEUMONIC.     33780002
MVBLANK  EQU   *                                                        33800002
         MVC   FIVE(TWO,R2),BLANKS     MOVE IN BLANK PASS MNEMONIC.     33820002
         DROP  R7                      DROP ADDRESSABILITY TO WORKAREA  33840002
         SPACE                                                          33860002
*********************************************************************** 33880002
* THE FOLLOWING INSTRUCTION FINDS THE PROPER INDEX VALUE FOR THE      * 33900002
* BRANCH TABLE.  THE BRANCH TABLE ROUTES CONTROL TO THE PROPER FORMAT * 33920002
* ROUTINE.                                                            * 33940002
*********************************************************************** 33960002
         SPACE                                                          33980002
OPBRANCH EQU   *                                                        34000002
         LA    R2,SEVEN(R2)            R2=UPDATED OUTPUT POINTER.       34020002
         SR    R4,R4                   R4=ZERO.                         34040002
         IC    R4,ZERO(R8,R6)          R4=INDEX VALUE TO ROUTINE.       34060002
         B     INSTBRTB(R4)            BRANCH TO REQUIRED ROUTINE.      34080002
         SPACE                                                          34100002
* THE FOLLOWING TABLE ROUTES CONTROL TO THE PROPER FORMAT ROUTINE.    * 34120002
         SPACE                                                          34140002
INSTBRTB EQU   *                                                        34160002
         B     NOOPCODE                THE OP CODE IS INVALID,ERROR MSG 34180002
         B     OPRR                    OP=RR FORMAT.                    34200002
         B     OPRR                    OP=RR FORMAT WITH 1 REGISTER.    34220002
         B     OPRS                    OP=RS FORMAT.                    34240002
         B     OPRS                    OP=RS FORMAT ONE REGISTER.       34260002
         B     OPSVC                   OP=SVC.                          34280002
         B     OPSI                    OP=SI FORMAT.                    34300002
         B     OPSI                    OP=SI WITHOUT THE IMMEDIATE.     34320002
         B     OPSS                    OP=SS WITH ONE LENGTH.           34340002
         B     OPSS                    OP=SS WITH TWO LENGTH.           34360002
         B     OPRX                    OP=RX FORMAT.                    34380002
         SPACE                                                          34400002
*********************************************************************** 34420002
* THE FOLLOWING INSTRUCTIONS CONVERTS AND FORMAT THE RR INSTRUCTIONS  * 34440002
* WITH BOTH OPERANDS IN THE OPERAND FIELD.                            * 34460002
*********************************************************************** 34480002
         SPACE                                                          34500002
OPRR     EQU   *                                                        34520002
         LA    R8,ELEVEN               R8=LENGTH OF OUTPUT              34540002
         LA    R7,TWO                  R7=2.                            34560002
         LA    R5,OPRRVAL              R5=HEX 4.                        34580002
         CR    R4,R5                   Q.RR FORMAT WITH ONE REGISTER.   34600002
         BE    OP1R                    NO,SKIP 1 REGISTER SWITCH SET.   34620002
         LA    R7,ONE                  SET ONE REGISTER SWITCH.         34640002
         LA    R8,EIGHT                SET LENGTH FOR ONE REGISTER.     34660002
OP1R     EQU   *                                                        34680002
         IC    R4,ONE(R3)              R4=OPERANDS R1 AND R2.           34700002
         SRDL  R4,EIGHT                R5=R1 AND R2 IN HIGH ORDER BYTE. 34720002
         L     R6,WORKAREA             R6=ADDRESS OF WORKAREA.          34740002
GET1OR2  EQU   *                                                        34760002
         SR    R4,R4                   R4=0.                            34780002
         SLDL  R4,FOUR                 ISOLATE NEXT 4 BITS OP OPERAND   34800002
         CVD   R4,ZERO(R6)             REGISTER NOW DECIMAL.            34820002
         OI    SEVEN(R6),SIGNF         SIGN NOW HEX F.                  34840002
         UNPK  ZERO(THREE,R6),SIX(TWO,R6) R1 NOW ZONED DECIMAL.         34860002
         CLI   ONE(R6),F0              Q.IS REGISTER 1 OR 2 DIGITS.     34880002
         BNE   TWODIGIT                REGISTER IS TWO DIGITS.          34900002
         BCTR  R8,ZERO                 R8=CORRECTED LENGTH.             34920002
         MVC   ZERO(ONE,R2),TWO(R6)    REGISTER NOW IN OUTPUT AREA.     34940002
         LA    R2,ONE(R2)              UPDATE OUTPUT POINTER.           34960002
GETCOMMA EQU   *                                                        34980002
         MVI   ZERO(R2),COMMA          SEPERATE OPERANDS.               35000002
         LA    R2,ONE(R2)              UPDATE OUTPUT POINTER.           35020002
         BCT   R7,GET1OR2              Q.IS R2 COMPLETED.               35040002
         L     R2,CONAREA              YES,FIND LENGTH AREA.            35060002
         STC   R8,ZERO(R2)             LENGTH NOW IN CONAREA.           35080002
         SR    R15,R15                 RC=0.                            35100002
         BR    R14                     RETURN                           35120002
TWODIGIT EQU   *                                                        35140002
         MVC   ZERO(TWO,R2),ONE(R6)    REGISTER NOW IN OUTPUT AREA.     35160002
         LA    R2,TWO(R2)              UPDATE OUTPUT POINTER.           35180002
         B     GETCOMMA                GET A COMMA.                     35200002
         SPACE                                                          35220002
*********************************************************************** 35240002
* THE FOLLOWING INSTRUCTIONS CONVERT AND FORMAT THE RS INSTRUCTION    * 35260002
* TYPE R1 AND R3 OPERAND FIELD.                                       * 35280002
*********************************************************************** 35300002
         SPACE                                                          35320002
OPRS     EQU   *                                                        35340002
         LA    R8,SIX                  R8=LENG OF MNEMONIC AND A BLANK. 35360002
         LA    R7,TWO                  R7=2.                            35380002
         LA    R5,OPRSVAL              R5=HEX 0C.                       35400002
         CR    R4,R5                   Q.FORMAT 1 OR 2 REGISTERS.       35420002
         BE    RS2R                    2 REGISTERS,SKIP 1 SET.          35440002
         LA    R7,ONE                  R7=1.                            35460002
RS2R     EQU   *                                                        35480002
         IC    R4,ONE(R3)              R4=OPERANDS R1 AND R2.           35500002
         SRDL  R4,EIGHT                R5=R1 AND R3 IN HI ORDER BYTE.   35520002
         L     R6,WORKAREA             R6=ADDRESS OF WORKAREA.          35540002
         USING CVTWORK,R6              USE R6 TO ADRESS WORKAREA.       35560002
GET1OR3  EQU   *                                                        35580002
         SR    R4,R4                   R4=0.                            35600002
         SLDL  R4,FOUR                 ISOLATE NEXT 4 BITS.             35620002
         CVD   R4,ZERO(R6)             REGISTER NOW DECIMAL.            35640002
         OI    SEVEN(R6),SIGNF         SIGN NOW HEX F.                  35660002
         UNPK  ZERO(THREE,R6),SIX(TWO,R6) R1 NOW ZONED DECIMAL.         35680002
         CLI   ONE(R6),F0              Q.IS REGISTER 1 OR 2 DIGITS.     35700002
         BNE   TWOVAL                  R IS TWO DIGITS.                 35720002
         LA    R8,ONE(R8)              R8=LENGTH PLUS 1.                35740002
         MVC   ZERO(ONE,R2),TWO(R6)    REGISTER NOW IN OUTPUT AREA.     35760002
         LA    R2,ONE(R2)              UPDATE OUTPUT AREA.              35780002
PUTCOMMA EQU   *                                                        35800002
         MVI   ZERO(R2),COMMA          SEPERATE OPERANDS.               35820002
         LA    R2,ONE(R2)              UPDATE OUTPUT POINTER.           35840002
         LA    R8,ONE(R8)              R8=LENGTH PLUS 1.                35860002
         BCT   R7,GET1OR3              Q.IS REG COMPLETED.              35880002
         SPACE                                                          35900002
*********************************************************************** 35920002
* THE FOLLOWING LINES OF CODE CONVERTS THE STORAGE OPERAND OF THE RS  * 35940002
* INSTRUCTION FORMAT.                                                 * 35960002
*********************************************************************** 35980002
         SPACE                                                          36000002
         MVC   ZERO(TWO,R6),TWO(R3)    INPUT NOW IN WORKAREA.           36020002
         SR    R4,R4                   R4=0.                            36040002
         L     R5,ZERO(R6)             R5=STORAGE OPERAND               36060002
         SLDL  R4,FOUR                 R4=BASE REGISTER.                36080002
         SRL   R5,TWO0                 R5=DISPLACEMENT                  36100002
         CVD   R5,ZERO(R6)             DISP NOW PACKED DECIMAL.         36120002
         MVC   EIGHT(SIX,R6),PATTERN2  MOVE PATTERN INTO WORKAREA.      36140002
         OI    SEVEN(R6),SIGNF         SIGN NOW HEX F.                  36160002
         LA    R1,ONE3(R6)             R1=ADDR OF LAST BYTE.            36180002
         EDMK  EIGHT(SIX,R6),FIVE(R6)  DISP NOW ZONED DECIMAL.          36200002
         LA    R7,ONE4(R6)             R7=END OF ZONED DECIMAL.         36220002
         SR    R7,R1                   R7=LENGTH OF ZONED DECIMAL.      36240002
         LA    R8,ZERO(R7,R8)          R8=LENGTH PLUS DISP LENGTH.      36260002
         BCTR  R7,ZERO                 R6=EXECUTE LENGTH.               36280002
         EX    R7,DISPMOVE             MOVE DISP TO CONAREA.            36300002
         LA    R2,ONE(R7,R2)           UPDATE OUTPUT POINTER.           36320002
         MVI   ZERO(R2),OPEN           MOVE IN OPEN PARENTHESIS.        36340002
         SPACE                                                          36360002
*********************************************************************** 36380002
* THIS SECTION OF CODE CONVERT THE BASE REGISTER OF THE STORAGE       * 36400002
* OPERAND AND MOVE IT INTO THE OUTPUT AREA.                           * 36420002
*********************************************************************** 36440002
         SPACE                                                          36460002
         CVD   R4,ZERO(R6)             REGISTER NOW PACKED DECIMAL.     36480002
         OI    SEVEN(R6),SIGNF         SIGN NOW HEX F.                  36500002
         UNPK  ZERO(THREE,R6),SIX(TWO,R6) BASE NOW ZONED DECIMAL.       36520002
         CLI   ONE(R6),F0              Q.BASE 1 OR 2 DIGITS.            36540002
         BNE   TWOBASE                 BASE IS TWO DIGITS.              36560002
         LA    R8,ONE(R8)              R8=LENGTH NOW INCLUDES BASE.     36580002
         MVC   ONE(ONE,R2),TWO(R6)     BASE NOW IN OUTPUT AREA.         36600002
         LA    R2,TWO(R2)              UPDATE OUTPUT POINTER            36620002
ENDBASE  EQU   *                                                        36640002
         MVI   ZERO(R2),CLOSE          MOVE IN A CLOSE PARENTHESIS.     36660002
         LA    R8,TWO(R8)              R8=LENGTH PLUS 2.                36680002
         L     R2,CONAREA              R2=OUTPUT AREA ADDRESS.          36700002
         STC   R8,ZERO(R2)             LENGTH NOW IN CONAREA.           36720002
         SR    R15,R15                 RC=0.                            36740002
         BR    R14                     RETURN.                          36760002
         DROP  R6                      DROP ADRESSABILITY TO WORKAREA   36780002
DISPMOVE MVC   ZERO(ONE,R2),ZERO(R1)   MOVE DISP INTO CONAREA.          36800002
TWOBASE  EQU   *                                                        36820002
         LA    R8,TWO(R8)              INCREMENT LENGTH FOR 2 DIGITS.   36840002
         MVC   ONE(TWO,R2),ONE(R6)     BASE NOW IN OUTPUT AREA.         36860002
         LA    R2,THREE(R2)            UPDATE OUTPUT POINTER.           36880002
         B     ENDBASE                 GET CLOSE PARENTHESIS.           36900002
TWOVAL   EQU   *                                                        36920002
         LA    R8,TWO(R8)              R8=LENGTH PLUS 2.                36940002
         MVC   ZERO(TWO,R2),ONE(R6)    R NOW IN OUTPUT AREA.            36960002
         LA    R2,TWO(R2)              UPDATE OUTPUT POINTER.           36980002
         B     PUTCOMMA                GET COMMA.                       37000002
         SPACE                                                          37020002
*********************************************************************** 37040002
* THE FOLLOWING INSTRUCTIONS CONVERTS A SVC INSTRUCTION TO ITS        * 37060002
* PRINTABLE FORMAT.                                                   * 37080002
*********************************************************************** 37100002
         SPACE                                                          37120002
OPSVC    EQU   *                                                        37140002
         SR    R4,R4                   R4=0.                            37160002
         IC    R4,ONE(R3)              R4=IMMEDIATE FIELD.              37180002
         L     R6,WORKAREA             R6=ADDRESS OF WORKAREA.          37200002
         CVD   R4,ZERO(R6)             I FIELD NOW PACKED DECIMAL.      37220002
         OI    SEVEN(R6),SIGNF         SIGN NOW HEX F.                  37240002
         LA    R1,ONE3(R6)             R1=ADDR OF LAST BYTE.            37260002
         MVC   EIGHT(SEVEN,R6),PATTERN2  MOVE IN PATTERN.               37280002
         EDMK  EIGHT(SIX,R6),FIVE(R6)  I FIELD NOW ZONED DECIMAL.       37300002
         LA    R7,ONE4(R6)             R7=END OF ZONED DECIMAL.         37320002
         SR    R7,R1                   R7=LENGTH OF SIGNIFICANT DIGITS. 37340002
         LA    R8,SIX(R7)              R8=LENGTH OF OUTPUT.             37360002
         BCTR  R7,ZERO                 R7=EXECTUE LENGTH.               37380002
         EX    R7,SVCMOVE              MOVE I FIELD INTO CONAREA.       37400002
         L     R2,CONAREA              R2=CONAREA ADDRESS.              37420002
         STC   R8,ZERO(R2)             LENGTH NOW IN CONAREA.           37440002
         SR    R15,R15                 RC=0.                            37460002
         BR    R14                     RETURN TO CALLER.                37480002
SVCMOVE  MVC   ZERO(ONE,R2),ZERO(R1)   MOVE I FIELD INTO CONAREA.       37500002
         SPACE                                                          37520002
*********************************************************************** 37540002
* THE FOLLOWING INSTRUCTIONS CONVERTS A SI INSTRUCTION TO PRINTABLE   * 37560002
* CHARACTERS AND FORMAT IT IN ITS MACHINE INSTRUCTION FORMAT.         * 37580002
*********************************************************************** 37600002
         SPACE                                                          37620002
OPSI     EQU   *                                                        37640002
         LR    R0,R4                   SAVE INDEX VALUE                 37660002
         L     R6,WORKAREA             R6=ADDRESS OF WORKAREA.          37680002
         USING CVTWORK,R6              USE R6 TO ADDRESS WORKAREA       37700002
         MVC   ZERO(TWO,R6),TWO(R3)    STORAGE OPERAND NOW IN WORKAREA. 37720002
         SR    R4,R4                   R4=0.                            37740002
         L     R5,ZERO(R6)             R5=STORAGE OPERAND.              37760002
         SLDL  R4,FOUR                 R4=BASE REGISTER.                37780002
         SRL   R5,TWO0                 R5=DISPLACEMENT.                 37800002
         CVD   R5,ZERO(R6)             DISP NOW PACKED DECIMAL.         37820002
         MVC   EIGHT(SIX,R6),PATTERN2  MOVE PATTERN INTO WORKAREA.      37840002
         OI    SEVEN(R6),SIGNF         SIGN NOW HEX F.                  37860002
         LA    R1,ONE3(R6)             R1=ADDR OF LAST BYTE.            37880002
         EDMK  EIGHT(SIX,R6),FIVE(R6)  DISP NOW ZONED DECIMAL.          37900002
         LA    R7,ONE4(R6)             R7=END OF ZONED DECIMAL.         37920002
         SR    R7,R1                   R7=LENGTH OF ZONED DECIMAL.      37940002
         LA    R8,SIX(R7)              R8=LENGTH PLUS DISP.             37960002
         BCTR  R7,ZERO                 R7=EXECUTE LENGTH.               37980002
         EX    R7,DISPMOVE             MOVE DISP TO CONAREA             38000002
         LA    R2,ONE(R7,R2)           UPDATE OUTPUT POINTER.           38020002
         MVI   ZERO(R2),OPEN           MOVE OPEN PARENTHESIS TO CONAREA 38040002
         SPACE                                                          38060002
*********************************************************************** 38080002
* THIS SECTION OF CODE CONVERT THE BASE REGISTER OF THE STORAGE       * 38100002
* OPERAND AND MOVE IT INTO THE OUTPUT AREA.                           * 38120002
*********************************************************************** 38140002
         SPACE                                                          38160002
         CVD   R4,ZERO(R6)             REGISTER NOW PACKED DECIMAL.     38180002
         OI    SEVEN(R6),SIGNF         SIGN HEX F.                      38200002
         UNPK  ZERO(THREE,R6),SIX(TWO,R6) BASE NOW ZONED DECIMAL.       38220002
         CLI   ONE(R6),F0              Q.BASE 1 OR 2 DIGITS.            38240002
         BNE   SIBASE2                 BASE IS TWO DIGITS.              38260002
         LA    R8,ONE(R8)              R8=LENGTH NOW INCLUDES BASE.     38280002
         MVC   ONE(ONE,R2),TWO(R6)     BASE NOW IN OUTPUT AREA.         38300002
         LA    R2,TWO(R2)              UPDATE OUTPUT POINTER.           38320002
ENDISP   EQU   *                                                        38340002
         MVI   ZERO(R2),CLOSE          MOVE IN A CLOSE PARENTHESIS.     38360002
         LA    R8,TWO(R8)              R8=LENGTH + 2.                   38380002
         SPACE                                                          38400002
* CHECK TO DETERMINE IF A SCON IS BEING CONVERTED TO PRINTABLE.       * 38420002
         SPACE                                                          38440002
         LTR   R0,R0                   Q.SCON PROCESSING.               38460002
         BZ    SCON                    YES,FINISH SCON CONVERSION.      38480002
* CHECK TO DETERMINE IF THE FORMAT REQUESTED IS WITH OR WITHOUT AN    * 38500002
* IMMEDIATE FIELD.                                                    * 38520002
         SPACE                                                          38540002
         LA    R1,OPSIVAL              R1='14'.                         38560002
         CLR   R1,R0                   Q.IMMEDIATE FIELD REQUESTED.     38580002
         BNE   IMMED                   YES,GET IMMEDIATE FIELD.         38600002
         B     ENDOPSI                 END FORMAT AND RETURN.           38620002
         DROP  R6                      DROP ADDRESSABILITY TO WORKAREA  38640002
         SPACE                                                          38660002
*********************************************************************** 38680002
* THE FOLLOWING INSTRUCTIONS CONVERT THE IMMEDIATE FIELD TO PRINTABLE * 38700002
* CHARACTERS AND MOVE THEM TO THE OUTPUT AREA.                        * 38720002
*********************************************************************** 38740002
         SPACE                                                          38760002
IMMED    EQU   *                                                        38780002
         LA    R1,TWO                                                   38800002
         SR    R4,R4                   R4=0                             38820002
         IC    R4,ONE(R3)              R4=IMMEDIATE FIELD.              38840002
         SRDL  R4,FOUR                 ISOLATE FIRST 4 BITS.            38860002
         LA    R7,NINE                 R7=9.                            38880002
NEXT4I   EQU   *                                                        38900002
         CLR   R4,R7                   Q-4 BITS GT 9.                   38920002
         BH    SIHI                    YES,CONVERT TO ALPHABETIC.       38940002
         LA    R4,F0(R4)               R4=4 BIT NOW PRINTABLE.          38960002
MOVEI    STC   R4,ZERO(R6)             MOVE BYTE INTO WORKAREA.         38980002
         LA    R6,ONE(R6)              R6=ADDR ONE PASS WORKAREA.       39000002
         SR    R4,R4                   CLEAR REG4.                      39020002
         SLDL  R4,FOUR                 ISOLATE NEXT FOUR BITS.          39040002
         BCT   R1,NEXT4I               IF R1=0,CONTINUE,ELSE CVT NEXT 4 39060002
         MVC   ONE(SIX,R2),HEXI        MOVE INTO CONAREA THE I PATTERN. 39080002
         L     R6,WORKAREA             R6=ADDRESS OF WORKAREA.          39100002
         MVC   FOUR(TWO,R2),ZERO(R6)   MOVE IMMEDIATE DATA INTO CONAREA 39120002
         LA    R8,SIX(R8)              LENGTH NOW=OUTPUT LENGTH.        39140002
         B     ENDOPSI                 GO SET RETURN CODE.              39160002
SIBASE2  EQU   *                                                        39180002
         LA    R8,TWO(R8)              R8=LENGTH + 2 FOR 2 BASE DIGITS. 39200002
         MVC   ONE(TWO,R2),ONE(R6)     BASE NOW IN OUTPUT AREA.         39220002
         LA    R2,THREE(R2)            UPDATE OUTPUT POINTER.           39240002
         B     ENDISP                  GET CLOSE PARENTHESIS.           39260002
* MOVE LENGTH INTO CONAREA,GET RETURN CODE=O AND RETURN TO CALLER.    * 39280002
ENDOPSI  EQU   *                                                        39300002
         L     R2,CONAREA              R2=ADDRESS OF CONAREA.           39320002
         STC   R8,ZERO(R2)             LENGTH NOW IN CONAREA.           39340002
         SR    R15,R15                 RC=0.                            39360002
         BR    R14                     RETURN TO CALLER.                39380002
* CONVERT THE ALPHABETIC HEX VALUES TO PRINTABLE CHARACTERS.          * 39400002
SIHI     EQU   *                                                        39420002
         LA    R4,B7(R4)               R4=4 BITS NOW PRINTABLE.         39440002
         B     MOVEI                   GET IMMEDIATE FIELD.             39460002
         SPACE                                                          39480002
*********************************************************************** 39500002
* THE FOLLOWING INSTRUCTIONS CONVERTS THE STORAGE OPERANDS OF THE     * 39520002
* SS INSTRUCTION TO ITS PRINTABLE FORM.                               * 39540002
*********************************************************************** 39560002
         SPACE                                                          39580002
OPSS     EQU   *                                                        39600002
         LR    R0,R4                   SAVE INDEX FACTOR.               39620002
         LA    R8,SIX                  R8=LENGTH OF MNEMONIC + 0.       39640002
         LA    R10,TWO                 R10=2.                           39660002
         L     R6,WORKAREA             R6=ADDRESS OF THE WORKAREA AREA. 39680002
         USING CVTWORK,R6              USE R6 TO ADDRESS WORKAREA       39700002
         CLI   ZERO(R3),SRPOP          Q.IS OP CODE SRP.                39720002
         BNE   GETB2D2                 NO,GET B1D1.                     39740002
         OI    CODE370,SSIMM           YES,TURN ON SS,L1,I3 FLAG.       39760002
GETB2D2  EQU   *                                                        39780002
         MVC   ZERO(TWO,R6),TWO(R3)    MOVE STORAGE OPERAND TO WORKAREA 39800002
         L     R4,ZERO(R6)             R0=STORAGE OPERANDS.             39820002
         SRL   R4,ONE6                 ISOLATE FIRST OPERAND.           39840002
         SRDL  R4,ONE2                 R4=BASE REGISTER.                39860002
         SRL   R5,TWO0                 R5=DISPLACEMENT.                 39880002
         CVD   R5,ZERO(R6)             DISP NOW PACKED DECIMAL.         39900002
         MVC   EIGHT(SIX,R6),PATTERN2  MOVE PATTERN INTO WORKAREA.      39920002
         OI    SEVEN(R6),SIGNF         SIGN NOW X'F'.                   39940002
         LA    R1,ONE3(R6)             R1=ADDR OF LAST BYTE.            39960002
         EDMK  EIGHT(SIX,R6),FIVE(R6)  DISP NOW ZONED DECIMAL.          39980002
         LA    R7,ONE4(R6)             R7=END OF ZONED DECIMAL.         40000002
         SR    R7,R1                   LENGTH OF DISP.                  40020002
         LA    R8,ONE(R7,R8)           R8=NEW LENGTH.                   40040002
         BCTR  R7,ZERO                 R7=EXECUTE LENGTH.               40060002
         EX    R7,DISPMOVE             MOVE DISP TO CONAREA.            40080002
         LA    R2,ONE(R7,R2)           UPDATE OUTPUT POINTER.           40100002
         MVI   ZERO(R2),OPEN           MOVE IN OPEN PARENTHESIS.        40120002
         LA    R2,ONE(R2)              UPDATE OUTPUT POINTER.           40140002
         LA    R7,ONE                  R7=1.                            40160002
         CLR   R10,R7                  Q.IS THIS THE CVT FOR B2D2       40180002
         BE    CVTB2D2                 YES,CONVERT B2D2.                40200002
         SR    R4,R4                   R4=0.                            40220002
         IC    R4,ONE(R3)              R4=LENGTH FIELD OF THE INST.     40240002
         LA    R7,OPSSVAL              R7=TYPE FORMAT INDICATOR.        40260002
         CLR   R7,R0                   Q.IS LENGTH L1 & L2.             40280002
         BNE   SSL2                    YES,IS L1 & L2.                  40300002
         TM    CODE370,SSIMM           NO.Q.IS IT L1 & I3.              40320002
         BNO   SSL1                    NO,ONLY L1.                      40340002
         SPACE                                                          40360002
* CONVERT LENGTH FIELD TO REFLECT A L1 & L2 LENGTH FIELD.             * 40380002
         SPACE                                                          40400002
SSL2     EQU   *                                                        40420002
         SRDL  R4,FOUR                 R4=L1.                           40440002
SSL1     EQU   *                                                        40460002
         LA    R4,ONE(R4)              R4=CORRECT LENGTH TO BE CONVERT. 40480002
         CVD   R4,ZERO(R6)             LENGTH NOW PACKED DECIMAL.       40500002
         MVC   EIGHT(FOUR,R6),PATTERN2 LENGTH NOW ZONED DECIMAL.        40520002
         OI    SEVEN(R6),SIGNF         SIGN NOW X'F'.                   40540002
         EDMK  EIGHT(FOUR,R6),SIX(R6)  LENGTH NOW ZONED DECIMAL.        40560002
         LA    R7,ONE2(R6)             R7=END OF ZONED DECIMAL.         40580002
         SR    R7,R1                   R7=LENGTH OF LENGTH.             40600002
         LA    R8,ZERO(R7,R8)          R8=UPDATED LENGTH.               40620002
         BCTR  R7,ZERO                 R7=EXECUTE LENGTH.               40640002
         EX    R7,DISPMOVE             MOVE LENGTH INTO CONAREA.        40660002
         LA    R2,ONE(R7,R2)           UPDATE OUTPUT POINTER.           40680002
         MVI   ZERO(R2),COMMA          SEPERATE LENGTH & BASE.          40700002
         LA    R8,ONE(R8)              UPDATE OUTPUT COUNTER.           40720002
         LA    R2,ONE(R2)              UPDATE OUTPUT POINTER.           40740002
NOLENGTH EQU   *                                                        40760002
         SR    R4,R4                   R4=0.                            40780002
         IC    R4,TWO(R3)              R4=BASE + GARBAGE.               40800002
         SRL   R4,FOUR                 ISOLATE BASE.                    40820002
         CVD   R4,ZERO(R6)             REGISTER NOW DECIMAL.            40840002
         OI    SEVEN(R6),SIGNF         SIGN NOW X'F'.                   40860002
         UNPK  ZERO(THREE,R6),SIX(TWO,R6) BASE NOW ZONED DECIMAL.       40880002
         CLI   ONE(R6),F0              Q.IS BASE 1 OR 2 DIGITS.         40900002
         BNE   SSBASE2                 BASE IS 2 DIGITS.                40920002
         LA    R8,ONE(R8)              R8=LENGTH + NEXT OPERAND FIELD.  40940002
         MVC   ZERO(ONE,R2),TWO(R6)    REGISTER NOW IN OUTPUT AREA.     40960002
         LA    R2,ONE(R2)              UPDATE OUTPUT POINTER.           40980002
SSCOMMA  EQU   *                                                        41000002
         MVI   ZERO(R2),CLOSE          MOVE IN CLOSE PARENTHESIS.       41020002
         MVI   ONE(R2),COMMA           SEPERATE OPERANDS.               41040002
         LA    R2,TWO(R2)              UPDATE OUTPUT POINTER.           41060002
         LA    R8,TWO(R8)              UPDATE OUTPUT COUNTER.           41080002
         LA    R3,TWO(R3)              R3=ADDR OF B1D1.                 41100002
         BCT   R10,GETB2D2             IF BEDE IS COMPLETED RETURN.     41120002
         BCTR  R8,ZERO                 R8=CORRECT LENGTH.               41140002
         TM    CODE370,SSIMM           Q.IS IT SS,L1 & I3.              41160002
         BNO   SSRETURN                NO.FINISH UP AND RETURN.         41180002
         LA    R8,ONE(R8)              UPDATE OUTPUT CTR FOR COMMA.     41200002
         S     R3,THREEWD              R3=INPUT POINTER TO L1 & I3.     41220002
         SR    R4,R4                   CLEAR R4.                        41240002
         IC    R4,ZERO(R3)             R4= L1 & I3 IN BINARY.           41260002
         SLL   R4,TWO8                 CLEAR OUT L1.                    41280002
         SRL   R4,TWO8                 ISOLATE I3.                      41300002
         CVD   R4,ZERO(R6)             I3 NOW DECIMAL.                  41320002
         UNPK  ZERO(THREE,R6),SIX(TWO,R6) I3 NOW ZONED DECIMAL.         41340002
         OI    TWO(R6),HEXF0           SIGN NOW HEX F.                  41360002
         CLI   ONE(R6),F0              Q.IS I3 1 OR 2 DIGITS.           41380002
         BNE   ITWODIG                 I3 IS 2 DIGITS.                  41400002
         LA    R8,ONE(R8)              UPDATE OUTPUT LENGTH 1 DIGIT.    41420002
         MVC   ZERO(ONE,R2),TWO(R6)    I3 NOW IN OUTPUT AREA.           41440002
         B     SSRETURN                FINISH UP AND RETURN.            41460002
ITWODIG  EQU   *                                                        41480002
         LA    R8,TWO(R8)              UPDATE OUTPUT PTR 2 DIGITS.      41500002
         MVC   ZERO(TWO,R2),ONE(R6)    I3 NOW IN OUTPUT AREA.           41520002
SSRETURN EQU   *                                                        41540002
         L     R2,CONAREA              R2=ADDR OF OUTPUTAREA.           41560002
         STC   R8,ZERO(R2)             LENGTH NOW IN OUTPUT AREA.       41580002
         SR    R15,R15                 RC=0.                            41600002
         BR    R14                     RETURN TO CALLER.                41620002
CVTB2D2  EQU   *                                                        41640002
         LA    R7,OPSSVAL              R7=X'00'.                        41660002
         CR    R0,R7                   Q.IS LENGTH L1 OR L1 AND L2.     41680002
         BE    NOLENGTH                LENGTH IS L1 ONLY.               41700002
         SR    R4,R4                   R4=0.                            41720002
         BCTR  R3,ZERO                 R3=PTR TO LENGTH FIELD.          41740002
         IC    R4,ZERO(R3)             R4=LENGTH FIELD.                 41760002
         SLL   R4,TWO8                 CLEAR OUT L1.                    41780002
         SRL   R4,TWO8                 ISOLATE L2.                      41800002
         LA    R3,ONE(R3)              ADVANCE INPUT POINTER.           41820002
         B     SSL1                    CONVERT L2.                      41840002
SSBASE2  EQU   *                                                        41860002
         MVC   ZERO(TWO,R2),ONE(R6)    REGISTER NOW IN OUTPUT AREA.     41880002
         LA    R2,TWO(R2)              R2=UPDATED OUTPUT PTR.           41900002
         LA    R8,TWO(R8)              UPDATE LENGTH COUNTER.           41920002
         B     SSCOMMA                 MOVE IN A COMMA.                 41940002
OPRX     EQU   *                                                        41960002
         DROP  R6                      DROP ADDRESSABILITY TO WORKAREA  41980002
         SPACE                                                          42000002
*********************************************************************** 42020002
* THE FOLLOWING INSTRUCTIONS CONVERTS AND FORMATS THE RX INSTRUCTIONS * 42040002
*********************************************************************** 42060002
         SPACE                                                          42080002
         LA    R8,SIX                  R8=LENGTH OF MNEMONIC + A BLANK. 42100002
         SR    R0,R0                   R8=LENGTH OF MNEMONIC+A BLANK.   42120002
         LA    R7,ONE                  R7=ONE.                          42140002
         IC    R4,ONE(R3)              R4=R1 & X2 FIELDS.               42160002
         SRDL  R4,EIGHT                R5=R1&X2 IN HIGH ORDER BYTE.     42180002
         L     R6,WORKAREA             R6=ADDR OF WORKAREA.             42200002
B2ORX2   EQU   *                                                        42220002
         SR    R4,R4                   R4=0.                            42240002
         SLDL  R4,FOUR                 ISOLATE NEXT 4 BITS OF OPERAND.  42260002
         CVD   R4,ZERO(R6)             REGISTER NOW DECIMAL.            42280002
         OI    SEVEN(R6),SIGNF         SIGN NOW X'F'.                   42300002
         UNPK  ZERO(THREE,R6),SIX(TWO,R6) R1 NOW ZONED DECIMAL.         42320002
         CLI   ONE(R6),F0              Q.IS REGISTER 1 OR 2 DIGITS.     42340002
         BNE   TWOCHAR                 REGISTER IS 2 CHARACTERS.        42360002
         LA    R8,ONE(R8)              R8=LENGTH + NEXT OPERAND FIELD.  42380002
         MVC   ZERO(ONE,R2),TWO(R6)    REGISTER NOW IN OUTPUT AREA.     42400002
         LA    R2,ONE(R2)              UPDATE OUTPUT POINTER.           42420002
COMMAGET EQU   *                                                        42440002
         MVI   ZERO(R2),COMMA          SEPERATE OPERAND FIELDS.         42460002
         LA    R2,ONE(R2)              UPDATE OUTPUT POINTER.           42480002
         LA    R8,ONE(R8)              R8=LENGTH OF OUTPUT SO FAR.      42500002
         BCT   R7,B2ORX2               IF 7=2 CONBERT B2.               42520002
         LTR   R0,R0                   Q.B2 FIELD COMPLETED.            42540002
         BNZ   CLOSERX                 YES,CLOSE RX ROUTINE.            42560002
         LH    R4,BASEDISP(R3)         R4=BASE + DISP.                  42580002
         SLL   R4,TWO0                 DROP BASE REG.                   42600002
         SRL   R4,TWO0                 ISOLATE DISP.                    42620002
         CVD   R4,ZERO(R6)             DISP NOW PACKED DECIMAL.         42640002
         MVC   EIGHT(SIX,R6),PATTERN2  MOVE PATTERN INTO WORKAREA.      42660002
         OI    SEVEN(R6),SIGNF         SIGN NOW X'F'.                   42680002
         LA    R1,ONE3(R6)             R1=ADDR OF LAST BYTE.            42700002
         EDMK  EIGHT(SIX,R6),FIVE(R6)  DISP NOW ZONED DECIMAL.          42720002
         LA    R7,ONE4(R6)             R7=END OF ZONED DECIMAL.         42740002
         SR    R7,R1                   R7=LENGTH OF ZONED DECIMAL.      42760002
         LA    R8,ONE(R7,R8)           R8=LENGTH + DISP LENGTH.         42780002
         BCTR  R7,ZERO                 R7=EXECUTE LENGTH.               42800002
         EX    R7,DISPMOVE             MOVE DISP TO CONAREA.            42820002
         LA    R2,ONE(R7,R2)           UPDATE OUTPUT POINTER.           42840002
         MVI   ZERO(R2),OPEN           MOVE IN C'('.                    42860002
         LA    R2,ONE(R2)              UPDATE OUTPUT PTR.               42880002
*        CONVERT AND FORMAT THE INDEX AND BASE REGISTER               * 42900002
         SR    R10,R10                 R10=0.                           42920002
         LA    R7,TWO                  R7=2.                            42940002
         IC    R10,BASEDISP(R3)        R6=BASE + DISP.                  42960002
         SLL   R10,TWO0                MOVE BASE TO HI ORDER.           42980002
         OR    R5,R10                  R5=X2 AND B2.                    43000002
         LA    R0,ONE                  R0=1,INDICATES DISP COMPLETED.   43020002
         B     B2ORX2                  FORMAT X2 & BE FIELD.            43040002
CLOSERX  EQU   *                                                        43060002
         BCTR  R2,ZERO                 R2=PTR TO PARENTHESIS FIELD.     43080002
         MVI   ZERO(R2),CLOSE          MOVE CLOSE PARENTHESIS IN.       43100002
         L     R2,CONAREA              R2=ADDR OF OUTPUT AREA.          43120002
         STC   R8,ZERO(R2)             LENGTH OF OUTPUT NOW IN CONAREA. 43140002
         SR    R15,R15                 RETURN CODE =0.                  43160002
         BR    R14                     RETURN                           43180002
TWOCHAR  EQU   *                                                        43200002
         MVC   ZERO(TWO,R2),ONE(R6)    REGISTER NOW IN OUTPUT AREA.     43220002
         LA    R2,TWO(R2)              UPDATE OUTPUT POINTER.           43240002
         LA    R8,TWO(R8)              R8=LENGTH + NEXT OPERAND FIELD.  43260002
         B     COMMAGET                GO MOVE IN COMMA.                43280002
*********************************************************************** 43300002
* THIS SECTION OF CODE CONVERTS BINARY INPUT TO ITS PRINTABLE SCON    * 43320002
* FORMAT (DISP(BASE)).                                                * 43340002
*********************************************************************** 43360002
IKJEGBIS EQU   *                                                        43380002
         DROP  R12                     GET NEW BASE REGISTER.           43400002
         USING *,R15                   R15 IS NEW BASE REGISTER.        43420002
         L     R12,BASECON             R12=ADDRESS OF IKJEGCV2.         43440002
         DROP  R15                     GET NEW BASE REGISTER.           43460002
         USING IKJEGCVX,R12            IKJEGCVX ADDRESSABILITY.         43480002
         USING TCOMTAB,R9              TCOMTAB ADDRESSABILITY.          43500002
         SR    R4,R4                   R4=0.                            43520002
         L     R3,ZERO(R1)             R3=ADDR OF INPUT STRING.         43540002
         L     R2,CONAREA              R2=ADDR OF OUTPUT AREA.          43560002
         LA    R2,ONE(R2)              R2=ADDR ONE PASS LENGTH BYTE.    43580002
         BCTR  R3,ZERO                 R3=INPUT PTR-1.                  43600002
         BCTR  R3,ZERO                 R3=INPUT PTR-2.                  43620002
         B     OPSI                    CONVERT DISP(BASE).              43640002
SCON     EQU   *                                                        43660002
         LA    R5,SIX                  R5=6.                            43680002
         SR    R8,R5                   R8=SCON LENGTH.                  43700002
         L     R2,CONAREA              R2=ADDR OF CONAREA.              43720002
         STC   R8,ZERO(R2)             MOVE LENGTH INTO CONAREA.        43740002
         SR    R15,R15                 R15=0.                           43760002
         BR    R14                     RETURN TO CALLER.                43780002
BASECON  DC    A(IKJEGCVX)             ADDR OF IKJEGCVX.                43800002
NOOPCODE EQU   *                                                        43820002
         LA    R15,FOUR                RC=4.                            43840002
         BR    R14                     RETURN.                          43860002
         DS    0F                                                       43880002
HEXI     DC    C',X''  '''             IMMEDIATE PATTERN.               43900002
PATTERN2 DC    X'40'                   ******************************** 43920002
         DC    3X'20'                  * PATTERN FIELD FOR THE EDIT   * 43940002
         DC    X'21'                   * AND MARK INSTRUCTION.        * 43960002
         DC    5X'20'                  ******************************** 43980002
BLANKS   DC    C'  '                   STRING OF TWO BLANKS             44000002
THREEWD  DC    F'3'                    THREE                            44020002
         EJECT                                                          44040002
         TITLE 'IKJEGCVT PRINTABLE OPCODES TABLE.'                      44060002
*********************************************************************** 44080002
* THIS CSECT CONTAINS THE TABLE PRINTABLE OPCODES WITH THEIR          * 44100002
* RESPECTIVE INSTRUCTION FORMAT CODES.                                * 44120002
*********************************************************************** 44140002
         SPACE                                                          44160002
IKJEGCOP  CSECT                                                         44180002
         DC    4XL5'00'                CODE=00,INVALID OP CODE.         44200002
         DC    C'SPM '                 SPM OP CODE.                     44220002
         DC    X'08'                   CODE=08,RR FORMAT-1 OPERAND.     44240002
         DC    C'BALR'                 BALR OP CODE.                    44260002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44280002
         DC    C'BCTR'                 BCTR OP CODE.                    44300002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44320002
         DC    C'BCR '                 BCR OP CODE.                     44340002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44360002
         DC    C'SSK '                 SSK OP CODE.                     44380002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44400002
         DC    C'ISK '                 ISK OP CODE.                     44420002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44440002
         DC    C'SVC '                 SVC INSTRUCTION.                 44460002
         DC    X'14'                   CODE=10,RR FORMAT-1 OPERAND.     44480002
         DC    2XL5'00'                CODE=00,INVALID OP CODE.         44500002
         DC    C'BASR'                 BASR OP CODE.  370 R.            44520002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44540002
         DC    C'MVCL'                 MVCL OP CODE.  370.              44560002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44580002
         DC    C'CLCL'                 CLCL OP CODE.  370.              44600002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44620002
         DC    C'LPR '                 LPR OP CODE.                     44640002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44660002
         DC    C'LNR '                 LNR OP CODE.                     44680002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44700002
         DC    C'LTR '                 LTR OP CODE.                     44720002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44740002
         DC    C'LCR '                 LCR OP CODE.                     44760002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44780002
         DC    C'NR  '                 NR OP CODE.                      44800002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44820002
         DC    C'CLR '                 CLR OP CODE.                     44840002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44860002
         DC    C'OR  '                 OR OP CODE.                      44880002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44900002
         DC    C'XR  '                 XR OP CODE.                      44920002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44940002
         DC    C'LR  '                 LR OP CODE.                      44960002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    44980002
         DC    C'CR  '                 CR OP CODE.                      45000002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45020002
         DC    C'AR  '                 AR OP CODE.                      45040002
         DC    X'04'                   CODEV04,RR FORMAT-2 OPERANDS.    45060002
         DC    C'SR  '                 SR OP CODE.                      45080002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45100002
         DC    C'MR  '                 MR OP CODE.                      45120002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45140002
         DC    C'DR  '                 DR OP CODE.                      45160002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45180002
         DC    C'ALR '                 ALR OP CODE.                     45200002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45220002
         DC    C'SLR '                 SLR OP CODE.                     45240002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45260002
         DC    C'LPDR'                 LPDR OP CODE.                    45280002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45300002
         DC    C'LNDR'                 LNDR OP CODE.                    45320002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45340002
         DC    C'LTDR'                 LTDR OP CODE.                    45360002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45380002
         DC    C'LCDR'                 LCDR OF CODE.                    45400002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45420002
         DC    C'HDR '                 HDR OP CODE.                     45440002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45460002
         DC    C'LRDR'                 LRDR OP CODE.                    45480002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45500002
         DC    C'MXR '                 MXR OP CODE.                     45520002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45540002
         DC    C'MXDR'                 MXDR OP CODE.                    45560002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45580002
         DC    C'LDR '                 LDR OP CODE.                     45600002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45620002
         DC    C'CDR '                 CDR OP CODE.                     45640002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45660002
         DC    C'ADR '                 ADR OP CODE.                     45680002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45700002
         DC    C'SDR '                 SDR OP CODE.                     45720002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERADS.     45740002
         DC    C'MDR '                 MDR OP CODE.                     45760002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45780002
         DC    C'DDR '                 DDR OP CODE.                     45800002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45820002
         DC    C'AWR '                 AWR OP CODE.                     45840002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45860002
         DC    C'SWR '                 SWR OP CODE.                     45880002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45900002
         DC    C'LPER'                 LPER OP CODE.                    45920002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45940002
         DC    C'LNER'                 LNER OP CODE.                    45960002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    45980002
         DC    C'LTER'                 LTER OP CODE.                    46000002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    46020002
         DC    C'LCER'                 LCER OP CODE.                    46040002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    46060002
         DC    C'HER '                 HER OP CODE.                     46080002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    46100002
         DC    C'LRER'                 LRER OP CODE.                    46120002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    46140002
         DC    C'AXR '                 AXR OP CODE.                     46160002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    46180002
         DC    C'SXR '                 SXR OP CODE.                     46200002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    46220002
         DC    C'LER '                 LER OP CODE.                     46240002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    46260002
         DC    C'CER '                 CER OP CODE.                     46280002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    46300002
         DC    C'AER '                 AER OP CODE.                     46320002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    46340002
         DC    C'SER '                 SER OP CODE.                     46360002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    46380002
         DC    C'MER '                 MER OP CODE.                     46400002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    46420002
         DC    C'DER '                 DER OP CODE.                     46440002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    46460002
         DC    C'AUR '                 AUR OP CODE.                     46480002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    46500002
         DC    C'SUR '                 SUR OP CODE.                     46520002
         DC    X'04'                   CODE=04,RR FORMAT-2 OPERANDS.    46540002
         DC    C'STH '                 STH OP CODE.                     46560002
         DC    X'28'                   CODE=28,RX FORMAT.               46580002
         DC    C'LA  '                 LA OP CODE.                      46600002
         DC    X'28'                   CODE=28,RX FORMAT.               46620002
         DC    C'STC '                 STC OP CODE.                     46640002
         DC    X'28'                   CODE=28,RX FORMAT.               46660002
         DC    C'IC  '                 IC  OP CODE.                     46680002
         DC    X'28'                   CODE=28,RX FORMAT.               46700002
         DC    C'EX  '                 EX OP CODE.                      46720002
         DC    X'28'                   CODE=28,RX FORMAT.               46740002
         DC    C'BAL '                 BAL OP CODE.                     46760002
         DC    X'28'                   CODE=28,RX FORMAT.               46780002
         DC    C'BCT '                 BCT OP CODE.                     46800002
         DC    X'28'                   CODE=28,RX FORMAT.               46820002
         DC    C'BC  '                 BC OP CODE.                      46840002
         DC    X'28'                   CODE=28,RX FORMAT.               46860002
         DC    C'LH  '                 LH OP CODE.                      46880002
         DC    X'28'                   CODE=28,RX FORMAT.               46900002
         DC    C'CH  '                 CH OP CODE.                      46920002
         DC    X'28'                   CODE=28,RX FORMAT.               46940002
         DC    C'AH  '                 AH OP CODE.                      46960002
         DC    X'28'                   CODE=28,RX FORMAT.               46980002
         DC    C'SH  '                 SH OP CODE.                      47000002
         DC    X'28'                   CODE=28,RX FORMAT.               47020002
         DC    C'MH  '                 MH OP CODE.                      47040002
         DC    X'28'                   CODE=28,RX FORMAT.               47060002
         DC    C'BAS '                 BAS OP CODE. 370 R.              47080002
         DC    X'28'                   CODE=28,RX FORMAT.               47100002
         DC    C'CVD '                 CVD OP CODE.                     47120002
         DC    X'28'                   CODE=28,RX FORMAT.               47140002
         DC    C'CVB '                 CVB OP CODE                      47160002
         DC    X'28'                   CODE=28,RX FORMAT.               47180002
         DC    C'ST  '                 ST OP CODE.                      47200002
         DC    X'28'                   CODE=28,RX FORMAT.               47220002
         DC    3XL5'00'                CODE=00,INVALID OP CODE.         47240002
         DC    C'N   '                 N OP CODE.                       47260002
         DC    X'28'                   CODE=28,RX FORMAT.               47280002
         DC    C'CL  '                 CL OP CODE.                      47300002
         DC    X'28'                   CODE=28,RX FORMAT.               47320002
         DC    C'O   '                 O OP CODE.                       47340002
         DC    X'28'                   CODE=28,RX FORMAT.               47360002
         DC    C'X   '                 X OP CODE.                       47380002
         DC    X'28'                   CODE=28,RX FORMAT.               47400002
         DC    C'L   '                 L OP CODE                        47420002
         DC    X'28'                   CODE=28,RX FORMAT.               47440002
         DC    C'C   '                 C OP CODE.                       47460002
         DC    X'28'                   CODE=28,RX FORMAT.               47480002
         DC    C'A   '                 A OP CODE.                       47500002
         DC    X'28'                   CODE=28,RX FORMAT.               47520002
         DC    C'S   '                 S OP CODE.                       47540002
         DC    X'28'                   CODE=28,RX FORMAT.               47560002
         DC    C'M   '                 M OP CODE.                       47580002
         DC    X'28'                   CODE=28,RX FORMAT.               47600002
         DC    C'D   '                 D OP CODE.                       47620002
         DC    X'28'                   CODE=28,RX FORMAT.               47640002
         DC    C'AL  '                 AL OP CODE.                      47660002
         DC    X'28'                   CODE=28,RX FORMAT.               47680002
         DC    C'SL  '                 SL OP CODE.                      47700002
         DC    X'28'                   CODE=28,RX FORMAT.               47720002
         DC    C'STD '                 STD OP CODE.                     47740002
         DC    X'28'                   CODE=28,RX FORMAT.               47760002
         DC    6XL5'00'                CODE=00,INVALID OP CODE.         47780002
         DC    C'MXD '                 MXD OP CODE.                     47800002
         DC    X'28'                   CODE=28,RX FORMAT.               47820002
         DC    C'LD  '                 LD OP CODE.                      47840002
         DC    X'28'                   CODE=28,RX FORMAT.               47860002
         DC    C'CD  '                 CD OP CODE.                      47880002
         DC    X'28'                   CODE=28,RX FORMAT.               47900002
         DC    C'AD  '                 AD OP CODE.                      47920002
         DC    X'28'                   CODE=28,RX FORMAT.               47940002
         DC    C'SD  '                 SD OP CODE.                      47960002
         DC    X'28'                   CODE=28,RX FORMAT.               47980002
         DC    C'MD  '                 MD OP CODE.                      48000002
         DC    X'28'                   CODE=28,RX FORMAT.               48020002
         DC    C'DD  '                 DD OP CODE.                      48040002
         DC    X'28'                   CODE=28,RX FORMAT.               48060002
         DC    C'AW  '                 AW OP CODE.                      48080002
         DC    X'28'                   CODE=28,RX FORMAT.               48100002
         DC    C'SW  '                 SW OP CODE.                      48120002
         DC    X'28'                   CODE=28,RX OP CODE.              48140002
         DC    C'STE '                 STE OP CODE.                     48160002
         DC    X'28'                   CODE=28,RX FORMAT.               48180002
         DC    7XL5'00'                CODE=00,INVALID OP CODE.         48200002
         DC    C'LE  '                 LE OP CODE.                      48220002
         DC    X'28'                   CODE=28,RX FORMAT.               48240002
         DC    C'CE  '                 CE OP CODE.                      48260002
         DC    X'28'                   CODE=28,RX FORMAT.               48280002
         DC    C'AE  '                 AE OP CODE.                      48300002
         DC    X'28'                   CODE=28,RX FORMAT.               48320002
         DC    C'SE  '                 SE OP CODE.                      48340002
         DC    X'28'                   CODE=28,RX FORMAT.               48360002
         DC    C'ME  '                 ME OP CODE.                      48380002
         DC    X'28'                   CODE=28,RX FORMAT.               48400002
         DC    C'DE  '                 DE OP CODE.                      48420002
         DC    X'28'                   CODE=28,RX FORMAT.               48440002
         DC    C'AU  '                 AU OP CODE.                      48460002
         DC    X'28'                   CODE=28,RX FORMAT.               48480002
         DC    C'SU  '                 SU OP CODE.                      48500002
         DC    X'28'                   CODE=28,RX FORMAT.               48520002
         DC    C'SSM '                 SSM OP CODE.                     48540002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT THE I. 48560002
         DC    XL5'00'                 CODE=00 INVALID OP CODE.         48580002
         DC    C'LPSW'                 LPSW OP CODE.                    48600002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT THE I. 48620002
         DC    C'DIAG'                 DIAGNOSE INSTRUCTION.            48640002
         DC    X'18'                   CODE=18,DIAGNOSE FOR CE.         48660002
         DC    C'WRD '                 WRD OP CODE.                     48680002
         DC    X'18'                   CODE=18,5I FORMAT.               48700002
         DC    C'RDD '                 RDD OP CODE.                     48720002
         DC    X'18'                   CODE=18,SI FORMAT.               48740002
         DC    C'BXH '                 BXH OP CODE.                     48760002
         DC    X'0C'                   CODE=0C,RS FORMAT.               48780002
         DC    C'BXLE'                 BXLE OP CODE.                    48800002
         DC    X'0C'                   CODE=0C,RS FORMAT.               48820002
         DC    C'SRL '                 SRL OP CODE.                     48840002
         DC    X'10'                   CODE=10,RS FORMAT WITH 1 R.      48860002
         DC    C'SLL '                 SLL OP CODE.                     48880002
         DC    X'10'                   CODE=10,RS FORMAT WITH 1 R.      48900002
         DC    C'SRA '                 SRA OP CODE.                     48920002
         DC    X'10'                   CODE=10,RS FORMAT WITH 1 R.      48940002
         DC    C'SLA '                 SLA OP CODE.                     48960002
         DC    X'10'                   CODE=10,RS FORMAT WITH 1 R.      48980002
         DC    C'SRDL'                 SRDL OP CODE.                    49000002
         DC    X'10'                   CODE=10,RS FORMAT WITH 1 R.      49020002
         DC    C'SLDL'                 SLDL OP CODE.                    49040002
         DC    X'10'                   CODE=10,RS FORMAT WITH 1 R.      49060002
         DC    C'SRDA'                 SRDA OP CODE.                    49080002
         DC    X'10'                   CODE=10,RS FORMAT WITH 1 R.      49100002
         DC    C'SLDA'                 SLDA OP CODE.                    49120002
         DC    X'10'                   CODE=10,RS FORMAT WITH 1 R.      49140002
         DC    C'STM '                 STM OP CODE.                     49160002
         DC    X'0C'                   CODE=0C,RS FORMAT.               49180002
         DC    C'TM  '                 TM OP CODE.                      49200002
         DC    X'18'                   CODE=1C,SI FORMAT.               49220002
         DC    C'MVI '                 MVI OP CODE.                     49240002
         DC    X'18'                   CODE=1C,SI FORMAT.               49260002
         DC    C'TS  '                 TS OP CODE.                      49280002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT THE I. 49300002
         DC    C'NI  '                 NI OP CODE.                      49320002
         DC    X'18'                   CODE=18,SI FORMAT.               49340002
         DC    C'CLI '                 CLI OP CODE.                     49360002
         DC    X'18'                   CODE=18,SI FORMAT.               49380002
         DC    C'OI  '                 OI OP CODE.                      49400002
         DC    X'18'                   CODE=18,SI FORMAT.               49420002
         DC    C'XI  '                 XI OP CODE.                      49440002
         DC    X'18'                   CODE=18,SI FORMAT.               49460002
         DC    C'LM  '                 LM OP CODE.                      49480002
         DC    X'0C'                   CODE=0C,RS FORMAT.               49500002
         DC    3XL5'00'                CODE=00,INVALID OP CODE.         49520002
         DC    C'SIO '                 SIO OP CODE.                     49540002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT THE I. 49560002
         DC    C'TIO '                 TIO OP CODE.                     49580002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT THE I. 49600002
         DC    C'HIO '                 HIO OP CODE.                     49620002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT THE I. 49640002
         DC    C'TCH '                 TCH OP CODE.                     49660002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT THE I. 49680002
         DC    12XL5'00'               CODE=00,INVALID OP CODES.        49700002
         DC    C'TNSM'                 STNSM OP CODE. 370 R             49720002
         DC    X'18'                   CODE=18,SI FORMAT                49740002
         DC    C'TOSM'                 STOSM OP CODE. 370 R             49760002
         DC    X'18'                   CODE=18,SI FORMAT                49780002
         DC    C'SIGP'                 SIGP OP CODE. 370 R              49800002
         DC    X'0C'                   CODE=0C,RS FORMAT                49820002
         DC    C'MC  '                 MC OP CODE. 370                  49840002
         DC    X'18'                   CODE=18,SI FORMAT                49860002
         DC    1XL5'00'                CODE=00,INVALID OP CODES.        49880002
         DC    C'LRA '                 LRA OP CODE. 370 R               49900002
         DC    X'28'                   CODE=28,RX FORMAT                49920002
         DC    4XL5'00'                CODE=00,INVALID OP CODES.        49940002
         DC    C'TCTL'                 STCTL OP CODE. 370               49960002
         DC    X'0C'                   CODE=0C,RS FORMAT                49980002
         DC    C'LCTL'                 LCTL OP CODE. 370.               50000002
         DC    X'0C'                   CODE=0C,RS FORMAT.               50020002
         DC    2XL5'00'                CODE=00,INVALID OP CODES@ZA11367 50040003
         DC    C'CS  '                 CS OP CODE. 370.        @ZA11367 50042003
         DC    X'0C'                   CODE=0C,RS FORMAT.      @ZA11367 50044003
         DC    C'CDS '                 CDS OP CODE. 370.       @ZA11367 50046003
         DC    X'0C'                   CODE=0C,RS FORMAT.      @ZA11367 50048003
         DC    XL5'00'                 CODE=00,INVALID OP CODE.@ZA11367 50050003
         DC    C'CLM '                 CLM OP CODE. 370.                50060002
         DC    X'0C'                   CODE=0C,R1,M3.                   50080002
         DC    C'STCM'                 STCM OP CODE. 370.               50100002
         DC    X'0C'                   CODE=0C,R1,M3.                   50120002
         DC    C'ICM '                 ICM OP CODE. 370.                50140002
         DC    X'0C'                   CODE=0C,R1,M3.                   50160002
         DC    17XL5'00'               CODE=00,INVALID OP CODES.        50180002
         DC    C'MVN '                 MVN OP CODE.                     50200002
         DC    X'20'                   CODE=20,SS FORMAT L1.            50220002
         DC    C'MVC '                 MVC OP CODE.                     50240002
         DC    X'20'                   CODE=20,SS FORMAT L1.            50260002
         DC    C'MVZ '                 MVZ OP CODE.                     50280002
         DC    X'20'                   CODE=20,SS FORMAT L1.            50300002
         DC    C'NC  '                 NC OP CODE.                      50320002
         DC    X'20'                   CODE=20,SS FORMAT L1.            50340002
         DC    C'CLC '                 CLC OP CODE.                     50360002
         DC    X'20'                   CODE=20,SS FORAMT L1.            50380002
         DC    C'OC  '                 OC OP CODE.                      50400002
         DC    X'20'                   CODE=20,SS FORMAT L1.            50420002
         DC    C'XC  '                 XC OP CODE.                      50440002
         DC    X'20'                   CODE=20,SS FORMAT L1.            50460002
         DC    4XL5'00'                CODE=00,INVALID OP CODE.         50480002
         DC    C'TR  '                 TR OP CODE.                      50500002
         DC    X'20'                   CODE=20,SS FORMAT L1.            50520002
         DC    C'TRT '                 TRT OP CODE.                     50540002
         DC    X'20'                   CODE=20,SS FORMAT L1.            50560002
         DC    C'ED  '                 ED OP CODE.                      50580002
         DC    X'20'                   CODE=20,SS FORMAT L1.            50600002
         DC    C'EDMK'                 EDMK OP CODE.                    50620002
         DC    X'20'                   CODE=20,SS FORMAT L1.            50640002
         DC    16XL5'00'               CODE=00,INVALID OP CODE.         50660002
         DC    C'SRP '                  SRP OP CODE. 370.               50680002
         DC    X'20'                   CODE=20 SS FORMAT L1 WITH I.     50700002
         DC    C'MVO '                 MVO OP CODE.                     50720002
         DC    X'24'                   CODE=24,SS FORMAT L1 & L2.       50740002
         DC    C'PACK'                 PACK OP OCDE.                    50760002
         DC    X'24'                   CODE=24,SS FORMAT L1 & L2.       50780002
         DC    C'UNPK'                 UNPK OP CODE.                    50800002
         DC    X'24'                   CODE=24,SS FORMAT L1 & L2.       50820002
         DC    4XL5'00'                CODE=00,INVALID OP CODE.         50840002
         DC    C'ZAP '                 ZAP OP CODE.                     50860002
         DC    X'24'                   CODE=24,SS FORMAT L1 & L2.       50880002
         DC    C'CP  '                 CP OP CODE.                      50900002
         DC    X'24'                   CODE=24,SS FORMAT L1 & L2.       50920002
         DC    C'AP  '                 AP OP CODE.                      50940002
         DC    X'24'                   CODE=24,SS FORMAT L1 & L2.       50960002
         DC    C'SP  '                 SP OP CODE.                      50980002
         DC    X'24'                   CODE=24,SS FORMAT L1 & L2.       51000002
         DC    C'MP  '                 MP OP CODE.                      51020002
         DC    X'24'                   CODE=24,SS FORMAT L1 & L2.       51040002
         DC    C'DP  '                 DP OP CODE.                      51060002
         DC    X'24'                   CODE=24,SS FORMAT L1 & L2.       51080002
         DC    2XL5'00'                CODE=00,INVALID OP CODE.         51100002
OPTABLN  EQU   *-IKJEGCOP              LENGTH OF ONE BYTE OP TABLE      51120002
         EJECT                                                          51140002
*********************************************************************** 51160002
* BEGINNING OF 370 TWO BYTE OP CODE TABLE. EACH OP CODE BEGINS WITH   * 51180002
* ONE BYTE OF B2 AND THEN ANOTHER UNIQUE SECOND BYTE. THIS TABLE      * 51200002
* INCLUDES ONLY UP TO THE RRB OP CODE (370-R B213) AND CAN BE         * 51220002
* EXPANDED IN THE FUTURE IF NECESSARY.                                * 51240002
*********************************************************************** 51260002
         SPACE                                                          51280002
IKJEGCD2 CSECT                                                          51300002
         DC    2XL6'00'                CODE=00,INVALID OP CODES.        51320002
         DC    C'STIDP'                STIDP OP CODE. 370.              51340002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT I.     51360002
         DC    C'STIDC'                STIDC OP CODE. 370.              51380002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT I.     51400002
         DC    C'SCK  '                SCKC OP CODE. 370.               51420002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT I.     51440002
         DC    C'STCK '                SCKC OP CODE. 370.               51460002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT I.     51480002
         DC    C'SCKC '                SCKC OP CODE. 370-R              51500002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT I.     51520002
         DC    C'STCKC'                STCKC OP CODE. 370-R             51540002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT I.     51560002
         DC    C'SPT  '                SPT OP CODE. 370-R               51580002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT I.     51600002
         DC    C'STPT '                STPT OP CODE. 370-R              51620002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT I.     51640002
         DC    3XL6'00'                00 OP CODE. INVALID              51660002
         DC    C'PTLB '                PTLB OP CODE. 370-R              51680002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT I.     51700002
         DC    2XL6'00'                00 OP CODE. INVALID              51720002
         DC    C'SPX  '                SPX OP CODE. 370-R               51740002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT I.     51760002
         DC    C'STPX '                STPX OP CODE. 370-R              51780002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT I.     51800002
         DC    C'STAP '                STAP OP CODE. 370-R              51820002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT I.     51840002
         DC    C'RRB  '                RRB OP CODE. 370-R               51860002
         DC    X'1C'                   CODE=1C,SI FORMAT WITHOUT I.     51880002
OPCD2LN  EQU   *-IKJEGCD2              LENGTH OF 370 (B2) OP TABLE      51900002
         EJECT                                                          51920002
         TITLE 'IKJEGCVT' CVT MESSAGE CSECT.                            51940002
IKJEGFLT CSECT                                                          51960002
         SPACE                                                          51980002
*********************************************************************** 52000002
*                                                                     * 52020002
* THIS CSECT IS AN EXTENSION OF THE CONVERT ROUTINE(IKJEGCVT).  THE   * 52040002
* FOLLOWING LINES OF CODE IN THIS CSECT WILL CONVERT THE FLOATING     * 52060002
* POINT DATA.                                                         * 52080002
*********************************************************************** 52100002
         SPACE                                                          52120002
REMAIN   EQU   X'01'                   HEX 01                           52140002
AONE1    EQU   X'F1'                   HEX F1                           52160002
AFIVE    EQU   C'5'                    CHARACTER 5                      52180002
DOBLEND  EQU   24                      END OF DOUBLE ZONED DECIMAL.     52200002
ADJUST37 EQU   37                      DEC 37                           52220002
OFFSET39 EQU   39                      DEC 39                           52240002
HEX85    EQU   X'85'                   HEX 85                           52260002
HEX10    EQU   X'10'                   HEX 10                           52280002
HEX1C    EQU   X'1C'                   HEX 1C                           52300002
OFFSET40 EQU   40                      DEC 40                           52320002
FIVE3    EQU   53                      DEC 53                           52340002
FIVE4    EQU   54                      DEC 54                           52360002
HEX20    EQU   X'20'                   HEX 20                           52380002
SIX4     EQU   64                      DEC 64                           52400002
ONE8     EQU   18                      DEC 18                           52420002
         ENTRY IKJEGFTB                                                 52440002
         ENTRY IKJEGBFT                                                 52460002
         SPACE                                                          52480002
*********************************************************************** 52500002
*                                                                     * 52520002
* THE FOLLOWING INSTRUCTIONS CONVERT A FLOATING POINT BINARY VALUE    * 52540002
* TO ITS PRINTABLE FORMAT.                                            * 52560002
*                                                                     * 52580002
*********************************************************************** 52600002
         SPACE                                                          52620002
IKJEGBFT EQU   *                                                        52640002
         LR    R12,R15                 R12= ADDRESS OF IKJEGFLT.        52660002
         USING IKJEGFLT,R12            IKJEGFLT ADDRESSABILITY.         52680002
         L     R3,WORKAREA             R3=ADDRESS OF WORKAREA.          52700002
         USING CVTWORK,R3              WORKAREA ADDRESSABILITY.         52720002
         LH    R6,FOUR(R1)             R6=LENGTH OF INPUT.              52740002
         LR    R0,R6                   SAVE LENGTH OF INPUT.            52760002
         L     R1,ZERO(R1)             R1=ADDRESS OF INPUT STRING.      52780002
         XC    FLTINPUT,FLTINPUT       CLEAR INPUT AREA OF GARBAGE.     52800002
         BCTR  R6,ZERO                 R6=EXECUTE LENGTH.               52820002
         BCTR  R6,ZERO                 *                                52840002
         LTR   R6,R6                   Q.SKIP MOVE INSTRUCTION.         52860002
         BM    SKIPMOVE                YES,SKIP MOVE INSTRUCTION.       52880002
         EX    R6,FLTMOVE              MOVE INPUT INTO WORKAREA.        52900002
SKIPMOVE EQU   *                                                        52920002
         LM    R4,R5,FLTINPUT          INPUT NOW IN WORK REGISTERS.     52940002
         IC    R7,ZERO(R1)             R7=CHARACTERISTICS.              52960002
         N     R7,SIGNOFF              TURN OFF FRACTION SIGN.          52980002
         LTR   R6,R6                   Q.EXP ONLY SPECIFIED.            53000002
         BM    EXPONLY                 YES,CONVERT EXPONENT.            53020002
         LTR   R4,R4                   Q.ZERO FRACTION SPECIFIED.       53040002
         BNZ   NONZERO                 NO - GO GET EXPONENT.    YA00086 53042002
         LTR   R5,R5                   Q.ZERO FRACTION          YA00086 53050002
*                                      SPECIED.                         53052002
         BZ    ZEROFRAC                YES, PASS A ZERO.                53060002
NONZERO  DS    0H                                                       53070002
         SH    R7,FLTCHAR              DECIMAL POINT NOW 6 DIGITS TO    53080002
*                                      RIGHT AND EXP VALUE DETERMINE.   53100002
         LTR   R5,R5                   Q.IS THIS SINGLE PRECISION.      53120002
         BNZ   FLTLONG                 NO,CONVERT LONG PRECISION.       53140002
         SPACE                                                          53160002
*********************************************************************** 53180002
* THIS SECTION OF CODE WILL CONVERT THE FRACTION OF A SINGLE          * 53200002
* PRECISION FLOATING POINT BINARY TO ZONED DECIMAL                    * 53220002
*********************************************************************** 53240002
         SPACE                                                          53260002
         CVD   R4,PACKAREA             FRACTION NOW CONVERTED TO PACKED 53280002
         OI    PACKAREA+SEVEN,SIGNF    DECIMAL.                         53300002
         UNPK  FLTSTG(ONE5),PACKAREA   FRACTION NOW ZONED DECIMAL       53320002
         LA    R6,FLTSTG+ONE5          R6=ADDR OF END OF ZONED DEC.     53340002
SUPPRESS EQU   *                                                        53360002
* THE FOLLOWING INSTRUCTIONS SUPPRESSES LEADING ZEROES.               * 53380002
         SPACE                                                          53400002
         LA    R8,FLTSTG               R8=ADDR OF ZONED DATA.           53420002
FLTLOOP  EQU   *                                                        53440002
         CLI   ZERO(R8),F0             SUPPRESS INSIGNIFICANT LEADING   53460002
         BNE   SIGFOUND                ZEROES.                          53480002
         LA    R8,ONE(R8)              GET NEXT DIGIT.                  53500002
         B     FLTLOOP                 CHECK NEXT DIGIT.                53520002
SIGFOUND EQU   *                                                        53540002
         SR    R2,R2                   R0=0                             53560002
         SR    R6,R8                   R6=LENGTH OF SIGNIFICANT DATA.   53580002
         STH   R6,FLTLEN               LENGTH NOW IN SAVE AREA.         53600002
         LTR   R7,R7                   Q.WHICH TYPE OF CVT IS NEEDED.   53620002
         BP    FLTADD                  DECIMAL ADD TO ITSELF.           53640002
         BM    FLTDIV                  DIVISION BY TWO.                 53660002
         EX    R6,ZONEMOVE             LEFT JUSTIFY ZONED DATA.         53680002
        LA     R8,FLTSTG                                                53700002
        LA     R8,ZERO(R6,R8)                                           53720002
         B     CHAR                    COMPUTE EXP VALUE.               53740002
FLTADD   EQU   *                                                        53760002
         SPACE                                                          53780002
*********************************************************************** 53800002
*                                                                     * 53820002
* THE FOLLOWING INSTRUCTIONS CONVERT THE ZONED DECIMAL FRACTION TO ITS* 53840002
* PROPER INTEGER FORM.                                                * 53860002
*                                                                     * 53880002
*********************************************************************** 53900002
         SPACE                                                          53920002
         LA    R5,FLTSTG+OFFSET40      MANTISSA RIGHT ALIGNED.          53940002
         SLL   R7,TWO                  MULTIPLY EXP BY FOUR.            53960002
         SR    R5,R6                   R5=PTR TO NEW WORKAREA.          53980002
         BCTR  R6,ZERO                 R6=EXECUTE LENGTH.               54000002
         EX    R6,ALIGNMVC             MOVE FRACTION FOR ADDITION.      54020002
         LH    R6,FLTLEN               R6=LENGTH OF FRACTION.           54040002
FLTSIM   EQU   *                                                        54060002
         LA    R8,FLTSTG+OFFSET39      SET UP TO BEGIN ADD.             54080002
         SR    R5,R5                   R5=0                             54100002
ADDNEXT  IC    R4,ZERO(R8)             R4=BYTE TO BE CONVERTED.         54120002
         N     R4,FLTCLEAR             R4=4 BIT VALUE.                  54140002
         AR    R4,R4                   ADD DIGIT TO ITSELF.             54160002
         AR    R4,R5                   ADD PREVIOUS CARRY.              54180002
         LA    R5,ONE                  R5=CARRY VALUE.                  54200002
         SH    R4,FLT10                IS THERE A CARRY.                54220002
         BNM   ACARRY                  YES.                             54240002
         AH    R4,FLT10                RESTORE VALUE.                   54260002
         SR    R5,R5                   CLEAR CARRY VALUE.               54280002
ACARRY   EQU   *                                                        54300002
         LA    R4,F0(R4)               CONVERT VALUE TO PRINTABLE.      54320002
         STC   R4,ZERO(R8)             SAVE THE RESULTS.                54340002
         BCTR  R8,ZERO                 ADJUST POINTER.                  54360002
         BCT   R6,ADDNEXT              ADD NEXT BYTE.                   54380002
         LH    R6,FLTLEN               R6=LENGTH.                       54400002
         LTR   R5,R5                   Q.IS THERE A CARRY.              54420002
         BZ    LASTZERO                NO,DO NOT MOVE IN A 1.           54440002
         MVI   ZERO(R8),AONE1          MOVE IN A PRINTABLE 1.           54460002
         BCTR  R8,ZERO                 POINT TO NEXT BYTE.              54480002
         AR    R6,R5                   UPDATE NUMBER OF DIGITS.         54500002
         STH   R6,FLTLEN               SAVE LENGTH.                     54520002
         LA    R5,FLTSTG               R5=ADDR OF WORK AREA.            54540002
         CR    R5,R8                   ANY TRUNCATION NEEDED.           54560002
         BE    TRUNCATE                YES.                             54580002
LASTZERO BCT   R7,FLTSIM               NO.                              54600002
         LA    R8,ONE(R8)              ADJUST ZONE DECIMAL POINTER.     54620002
         EX    R6,ZONEMOVE             ADJUST ZONED DECIMAL.            54640002
         LA    R8,FLTSTG               R8=ADDR OF ZONE DECIMAL.         54660002
         CH    R6,FLT17                Q.ZONE DECIMAL TOO LONG.         54680002
         BL    NOTLONG                 NO,SKIP LENGTH CORRECTION.       54700002
         LA    R8,ONE7(R8)             INCREMENT BY 17                  54720002
         MVI   FLTLEN+ONE,ONE7         NEW LENGTH IN LENGTH FIELD.      54740002
         B     CHAR                    GO CONVERT CHARACTERISTICS.      54760002
NOTLONG  EQU   *                                                        54780002
         LA    R8,ZERO(R6,R8)          R8=PTR TO END OF ZONED DATA.     54800002
         B     CHAR                    GO CONVERT CHARACTERISTICS.      54820002
TRUNCATE EQU   *                                                        54840002
         SH    R6,FLTDEC2              CORRECT LENGTH FOR TRUNCATION.   54860002
         STH   R6,FLTLEN               NEW LNG IN LNG SAVE AREA.        54880002
         SH    R2,FLTDEC2                                               54900002
         LA    R8,FLTSTG+ADJUST37      RIGHT ADJUST THE NUMBER          54920002
FBYTEMVC MVC   TWO(ONE,R8),ZERO(R8)    IN WORK AREA.                    54940002
         BCTR  R8,ZERO                 ALTER POINTER TO NEXT TYTE.      54960002
         BCT   R6,FBYTEMVC             GET NEXT BYTE.                   54980002
         LH    R6,FLTLEN               R6=NEW LENGTH.                   55000002
         CH    R7,HALFONE              Q.LAST MULTIPLY.                 55020002
         BNE   NOTLAST                 NO,DO NOT ALTER POINTER.         55040002
         LA    R8,TWO(R8)              R8=PT TO SIGNIFICANT DIGITS.     55060002
NOTLAST  EQU   *                                                        55080002
         B     LASTZERO                CHECK FOR MORE VALUES TO ADD.    55100002
FLTDIV   EQU   *                                                        55120002
         SPACE                                                          55140002
*********************************************************************** 55160002
*                                                                     * 55180002
* THE FOLLOWING LINES OF CODE CONVERTS THE ZONED DECIMAL MANTISSA TO  * 55200002
* ITS PROPER ZONED DECIMAL MANTISSA.                                  * 55220002
*                                                                     * 55240002
*********************************************************************** 55260002
         SPACE                                                          55280002
         LPR   R7,R7                   R7,NOW POSITIVE.                 55300002
         SLL   R7,TWO                  MULTIPLY BY FOUR.                55320002
         BCTR  R6,ZERO                 R6=LENGTH OF ZONED DECIMAL.      55340002
         EX    R6,ZONEMOVE             LEFT JUSTIFY ZONED DECIMAL.      55360002
SCALE    LH    R6,FLTLEN               LENGTH NOW IN REGISTER.          55380002
         SR    R5,R5                   R5=ZERO.                         55400002
         LA    R8,FLTSTG               R8=POINTER TO ZONED DECIMAL.     55420002
         CLI   ZERO(R8),AZERO          CHECK TO SUPPRESS LEADING ZEROS. 55440002
         BNE   NEXTDIV                 BRANCH PROCESS DIGIT.            55460002
         BCTR  R6,ZERO                 DECREMENT LENGTH.                55480002
         STH   R6,FLTLEN               SAVE CORRECT LENGTH.             55500002
         BCTR  R6,ZERO                 R6=EXECUTE LENGTH.               55520002
         EX    R6,ZONEJUST             LEFT JUSTIFY THE SIGNIF.DIGITS.  55540002
         SR    R5,R5                   R5=ZERO.                         55560002
         LA    R6,ONE(R6)              R6=CORRECT LENGTH.               55580002
NEXTDIV  EQU   *                                                        55600002
         IC    R4,ZERO(R8)             SIMULATE DIVISION BY TWO.        55620002
         N     R4,FLTCLEAR             R4=4 BIT VALUE.                  55640002
         SRL   R4,ONE                  R4=VALUE DIVIDED BY TWO.         55660002
         AR    R4,R5                   COMBINE THE PARTIAL QUOTIENT.    55680002
         LA    R4,F0(R4)               VALUE NOW PRINTABLE CHARACTER.   55700002
         SR    R5,R5                   R5=ZERO.                         55720002
         TM    ZERO(R8),REMAIN         CHECK FOR REMAINDER.             55740002
         BZ    SKIPCARY                SKIP CARRY FLAG SET.             55760002
         LA    R5,FIVE                 R5=5,CARRY FLAG.                 55780002
SKIPCARY EQU   *                                                        55800002
         STC   R4,ZERO(R8)             MOVE NEW VALUE IN STRING.        55820002
         LA    R8,ONE(R8)              UPDATE STRING POINTER.           55840002
         BCT   R6,NEXTDIV              BRANCH TO PROCESS NEXT DIGIT.    55860002
         LH    R6,FLTLEN               R6=CORRECT LENGTH.               55880002
         LTR   R5,R5                   ANY FINAL PARTIAL QUOTIENT.      55900002
         BZ    NOFINAL                 NO,SKIP FINAL ADJUSTMENT.        55920002
         CH    R6,FLT20                Q.FINAL PARTIAL QUOTIENT.        55940002
         BNL   ADJUSTIT                YES,ADJUST RESULTS.              55960002
         MVI   ZERO(R8),AFIVE          MOVE IN A CHARACTER FIVE.        55980002
         LA    R2,ONE(R2)              INCREMENT POINTER.               56000002
         LA    R6,ONE(R6)                                               56020002
         STH   R6,FLTLEN               SAVE LENGTH.                     56040002
JUSTEND  EQU   *                                                        56060002
         LA    R8,ONE(R8)              UPDATE POINTER.                  56080002
NOFINAL  EQU   *                                                        56100002
         BCT   R7,SCALE                BRANCH IF SCALING IS NOT ZERO.   56120002
CHAR     EQU   *                                                        56140002
*********************************************************************** 56160002
*                                                                     * 56180002
* THE FOLLOWING LINES OF CODE CALCULATE THE NUMBER OF SIGNIFICANT     * 56200002
* DIGITS AND ROUND OFF THE SIGNIFICANTS.                              * 56220002
*                                                                     * 56240002
*********************************************************************** 56260002
         SPACE                                                          56280002
         CLI   FLTSTG,AZERO            Q.AN ZERO.                       56300002
         BNE   NOZERO                  NO,CONTINUE PROCESSING.          56320002
         BCTR  R8,ZERO                 DECREMENT R8 BY ONE              56330002
         LH    R6,FLTLEN               R6= LENGTH                       56332002
         BCTR  R6,ZERO                 ALSO DECREMENT LENGTH BY ONE     56334002
         STH   R6,FLTLEN               RESTORE THE LENGTH               56336002
         EX    R6,MOVEFLT              LEFT JUSTIFY ZONE DECIMAL.       56360002
NOZERO   EQU   *                                                        56380002
         LR    R4,R0                   R4=LENGTH OF INPUT.              56400002
         BCTR  R4,ZERO                 R4=FRACTION LENGTH.              56420002
         LR    R5,R4                   R5=FRACTION LENGTH.              56440002
         SLL   R4,ONE                  ******************************** 56460002
         LA    R5,ONE(R5)              * CALCULATE THE NUMBER OF      * 56480002
         SRL   R5,ONE                  * SIGNIFICANT DIGITS.          * 56500002
         AR    R4,R5                   ******************************** 56520002
         CH    R4,FLT17                Q.LENGTH GREATER THAN 16.        56540002
         BL    NOALTER                 NO,DO NOT ALTER LENGTH.          56560002
         BCTR  R4,ZERO                 R4=CORRECT SIGNIFICANT LENGTH.   56580002
NOALTER  EQU   *                                                        56600002
         CH    R4,FLTLEN               Q.SIGNIFICANT GREATER THAN LENG. 56620002
         BH    ENDSIGNF                NO,SKIP SIGNIFICANT ALTER.       56640002
         LR    R0,R4                   R0=NUMBER OF SIGNIFICANT DIGITS. 56660002
         LA    R5,ONE                  R5=1.                            56680002
         NR    R5,R4                   Q.LENGTH ODD.                    56700002
         BM    SKIPSHIF                YES,DO NOT SHIFT.                56720002
         BCTR  R4,ZERO                 SET UP EVEN SIGNIFICANT.         56740002
SKIPSHIF EQU   *                                                        56760002
         SRL   R4,ONE                  CALCULATE NUMBER OF OUTPUT BUTES 56780002
         LA    R4,ONE(R4)              FOR PACK INSTRUCTION.            56800002
         CH    R0,FLT17                Q.INPUT 17 BYTES.                56820002
         BE    SIMPACK                 YES,SIMULATE PACK INSTRUCTION.   56840002
         LR    R5,R0                   R5=NUMBER OF SIGNIFICANT DIGITS. 56860002
         BCTR  R5,ZERO                 R5=EXECUTE LENGTH.               56880002
         SLL   R4,FOUR                 R4=LENGTH IN HIGH OFDER 4 BITS.  56900002
         OR    R5,R4                   R5=LENGTH 1 AND LENGTH 2.        56920002
         EX    R5,ROUNDPK              PACK SIGNIFICANT DIGITS.         56940002
         SRL   R5,FOUR                 CLEAR LENGTH 2.                  56960002
         SLL   R5,FOUR                 *                                56980002
         EX    R5,ADD5                 ADD 5 TO SIGNIFICANT DIGITS.     57000002
         LR    R4,R0                   R4=LENGTH OF SIGNIFICANT DIGITS. 57020002
         BCTR  R4,ZERO                 R4=EXECUTE LENGTH.               57040002
         SLL   R4,FOUR                 R4=LENGTH 1 IN HIGH ORDER 4 BITS 57060002
         SRL   R5,FOUR                 R5=LENGTH 2 IN LOW ORDER.        57080002
         LA    R7,ONE                  R7=1,FOR EVEN ODD CHECK.         57100002
         NR    R7,R0                   Q.SIGNIFICANTS ODD.              57120002
         BM    ODDSIGNF                YES,CHECK FOR CARRY.             57140002
         CLI   FLTINPUT,HEX9           Q.IS THERE A CARRY.              57160002
         BNH   NOEXPJST                NO,DO NOT ADJUST.                57180002
ANEXPJST EQU   *                                                        57200002
         BCTR  R2,ZERO                 ACCOUNT FOR EXPONENT.            57220002
         LA    R4,ONE6(R4)              ACCOUNT FOR CARRY DIGIT.        57240002
NOEXPJST EQU   *                                                        57260002
         OR    R5,R4                   R5=LENGTH 1 AND 2.               57280002
         EX    R5,UNPKSIG              UNPACK SIGNIFICANT DIGITS.       57300002
ENDSIG   EQU   *                                                        57320002
         LR    R8,R0                   R8=NUMBER OF SIGNIFICANT DIGITS. 57340002
         STH   R8,FLTLEN               CORRECT LENGTH IN SAVE AREA.     57360002
         LA    R5,FLTSTG               R5=ADDR OF SIGNIFICANT DIGITS.   57380002
         LA    R8,ZERO(R5,R8)          R8=PTR TO END OF SIGNIFICANTS.   57400002
         BCTR  R8,ZERO                 POINT TO LAST BYTE.              57420002
         OI    ZERO(R8),HEXF0          ALTER SIGN TO PRINTABLE.         57440002
         LA    R8,ONE(R8)              R8=PTR TO END OF SIGNIFICANTS.   57460002
         B     ENDSIGNF                CALCULATE EXPONENT.              57480002
ODDSIGNF EQU   *                                                        57500002
         CLI   FLTINPUT,HEX00          Q.IS THERE A CARRY.              57520002
         BE    NOEXPJST                NO,DO NOT ADJUST.                57540002
         B     ANEXPJST                YES,ACCOUNT FOR EXPONENT.        57560002
         SPACE                                                          57580002
*********************************************************************** 57600002
*                                                                     * 57620002
* THIS AREA OF CODE PACKS AN AREA 17 BYTES IN LENGTH AND ROUNDS THE   * 57640002
* VALUE.                                                              * 57660002
*                                                                     * 57680002
*********************************************************************** 57700002
         SPACE                                                          57720002
SIMPACK  EQU   *                                                        57740002
         PACK  FLTINPUT(NINE),FLTSTG(ONE6) PACK FIRST 15 BYTES.         57760002
         PACK  FLTINPUT+EIGHT(TWO),FLTSTG+ONE5(THREE) NEXT THREE.       57780002
         OI    FLTINPUT+NINE,SIGNF     SIGN ALTERED FOR ADD.            57800002
         MVC   FLTSTG(ONE9),FLTPATTN   PATTERN NOW IN WORKAREA.         57820002
         AP    FLTINPUT(TEN),PACK5(ONE) ROUND VALUE.                    57840002
         CLI   FLTINPUT,HEX9           Q.IS THERE A CARRY.              57860002
         BNH   NOJSTEXP                NO,DO NOT ADJUST.                57880002
         BCTR  R2,ZERO                 ACCOUNT FOR EXPONENT.            57900002
NOJSTEXP EQU   *                                                        57920002
         ED    FLTSTG(TWO0),FLTINPUT   SIGNIFICANTS NOW ZONED DECIMAL.  57940002
         LA    R8,FLTSTG               R8=POINTER TO FLTSTG.            57960002
FINDNO0  EQU   *                                                        57980002
         CLI   ZERO(R8),AZERO          Q.NON-ZERO FOUND.                58000002
         BNE   JUSTSNFT                YES,LEFT JUSTIFY.                58020002
         LA    R8,ONE(R8)              POINT TO NEXT BYTE.              58040002
         B     FINDNO0                 GET NEXT BYTE.                   58060002
JUSTSNFT EQU   *                                                        58080002
         MVC   FLTSTG(ONE7),ZERO(R8)   LEFT JUSTIFY VALUE.              58100002
         B     ENDSIG                  END SIGNIFICANTS.                58120002
ENDSIGNF EQU   *                                                        58140002
         SR    R6,R2                   R6=EXPONENT VALUE.               58160002
         MVC   ZERO(FIVE,R8),EXPCHAR   EXPONENT PATTERN IN STRING.      58180002
         LTR   R6,R6                   IS EXPONENT NEGATIVE.            58200002
         BNM   SKIPNEG                 SKIP NEGATIVE SIGN MOVE.         58220002
         MVI   TWO(R8),SIGNNEG         NEGATIVE SIGN NOW IN STRING.     58240002
SKIPNEG  EQU   *                                                        58260002
         CVD   R6,PACKAREA             EXPONENT NOW PACKED DECIMAL.     58280002
         OI    PACKAREA+SEVEN,SIGNF    SIGN NOW X'F'.                   58300002
         UNPK  THREE(TWO,R8),PACKAREA+SIX(TWO) EXPONENT NOW IN STRING.  58320002
         CLI   THREE(R8),AZERO         IS FIRST CHARACTER A ZERO.       58340002
         BNE   BLKSKIP                 NO,DO NOT MOVE IN A BLANK.       58360002
         MVI   THREE(R8),BLANK         FIRST CHARACTER NOW A BLANK.     58380002
BLKSKIP  EQU   *                                                        58400002
         LA    R8,FLTSTG-TWO           R8=ADDRESS FOR MANTISSA SIGN.    58420002
         MVC   ZERO(TWO,R8),FRACSIGN   FRACTION + SIGN NOW IN STRING.   58440002
         TM    ZERO(R1),HION           IS FRACTION NEGATIVE.            58460002
         BZ    PLUSFRAC                NO,DO NOT MOVE IN NEGATIVE SIGN. 58480002
         MVI   ZERO(R8),MINUS          MINUS SIGN NOW IN STRING.        58500002
PLUSFRAC EQU   *                                                        58520002
         L     R2,CONAREA              R2=ADDRESS OF OUTPUT AREA.       58540002
         LH    R6,FLTLEN               R6=LENGTH OF MANTISSA.           58560002
         LA    R6,SEVEN(R6)            R6=LENGTH OF OUTPUT STRING.      58580002
         STC   R6,ZERO(R2)             LENGTH OF OUTPUT NOW IN CONAREA. 58600002
         BCTR  R6,ZERO                 R6=EXECUTE LENGTH.               58620002
         EX    R6,OUTMVC               MOVE STRING INTO OUTPUT AREA.    58640002
ENDFLT   SR    R15,R15                 R15=ZERO.                        58660002
         BR    R14                     RETURN TO CALLER.                58680002
*********************************************************************** 58700002
*                                                                     * 58720002
* THE FOLLOWING LINES OF CODE CALCULATE THE EXPONENT AND MOVE IT'S    * 58740002
* PRINTABLE REPRESENTATION INTO CONAREA.                              * 58760002
*                                                                     * 58780002
*********************************************************************** 58800002
         SPACE                                                          58820002
EXPONLY  EQU   *                                                        58840002
         L     R2,CONAREA              R2=ADDR OF CONAREA.              58860002
         SH    R7,FLT64                R7=EXPONENT IN BINARY.           58880002
         MVC   ONE(FOUR,R2),EXPCHAR+ONE EXPONENT SIGN NOW IN CONAREA.   58900002
         LTR   R7,R7                   Q.EXPONENT NEGATIVE.             58920002
         BNM   PLUSEXP2                NO,SKIP COMPLEMENT.              58940002
         MVI   TWO(R2),MINUS           NEGATIVE SIGN NOW IN CONAREA.    58960002
PLUSEXP2 EQU   *                                                        58980002
         CVD   R7,PACKAREA             EXP NOW PACKED DECIMAL.          59000002
         OI    PACKAREA+SEVEN,SIGNF    SIGN NOW X'F'.                   59020002
         UNPK  FLTSTG(TWO),PACKAREA+SIX(TWO) EXP NOW ZONED DECIMAL.     59040002
         CLI   FLTSTG,F0               Q.FIRST CHAR A ZERO.             59060002
         BNE   NOF0                    NO,DO NOT MOVE IN BLANK.         59080002
         MVI   FLTSTG,BLANK            BLANK NOW IN EXP FIELD.          59100002
NOF0     EQU   *                                                        59120002
         MVC   THREE(TWO,R2),FLTSTG    EXP NOW IN CONAREA.              59140002
         MVI   ZERO(R2),FOUR           LENGTH NOW IN CONAREA.           59160002
         B     ENDFLT                  SET RETURN CODE & RETURN.        59180002
*********************************************************************** 59200002
*                                                                     * 59220002
* THIS SECTION OF CODE MOVES INTO CONAREA(OUTPUT AREA) THE OUTPUT FOR * 59240002
* A FRACTION ZERO.                                                    * 59260002
*                                                                     * 59280002
*********************************************************************** 59300002
         SPACE                                                          59320002
ZEROFRAC EQU   *                                                        59340002
         L     R2,CONAREA              R2=ADDRESS OF OUTPUT AREA.       59360002
         MVC   ZERO(THREE,R2),FLPTZERO PRINTABLE +0 NOW IN CONAREA.     59380002
         B     ENDFLT                  GO,SET RETURN CODE & RETURN.     59400002
*********************************************************************** 59420002
*                                                                     * 59440002
* THE FOLLOWING INSTRUCTIONS CONVERT THE FRACTION OF A DOUBLE         * 59460002
* PRECISION FLOATING POINT BINARY TO ZONED DECIMAL.                   * 59480002
*                                                                     * 59500002
*********************************************************************** 59520002
FLTLONG  EQU   *                                                        59540002
         SH    R7,DOBLFLT              MOVE DEC PT 8 MORE DIGITS RIGHT. 59560002
         D     R4,CVTVAL               ALTER FRACTION FOR CONVERSION.   59580002
         CVD   R5,PACKAREA             FRACTION NOW BEING CONVERTED TO  59600002
         OI    PACKAREA+SEVEN,SIGNF    PACKED DECIMAL.                  59620002
         UNPK  FLTSTG(ONE5),PACKAREA   PARTIAL CONVERT OF FRACTION.     59640002
         CVD   R4,PACKAREA             REMAINDER OF FRACTION NOW BEING  59660002
         OI    PACKAREA+SEVEN,SIGNF    CONVERTED TO PACK DECIMAL.       59680002
         UNPK  REMDATA(NINE),PACKAREA  REMIANDER OF FRACTION CONVERTED. 59700002
         LA    R6,FLTSTG+DOBLEND       R6=ADDRESS OF END OF ZONED DEC.  59720002
         B     SUPPRESS                GO SUPPRESS LEADING ZEROES.      59740002
ADJUSTIT EQU   *                                                        59760002
         BCTR  R8,ZERO                 R8=PTR TO LAST BYTE.             59780002
         IC    R4,ZERO(R8)                                              59800002
         TM    ZERO(R8),HEX9           Q.IS IT EQUAL TO NINE.           59820002
         BO    ADJUST2                 YES                              59840002
         LA    R4,ONE(R4)              CARRY NEXT TO LAST BYTE ONE.     59860002
         STC   R4,ZERO(R8)             MOVE BYTE INTO STRING.           59880002
         B     JUSTEND                 CHECK SCALING.                   59900002
ADJUST2  EQU   *                                                        59920002
         BCTR  R6,ZERO                 DECREMENT LENGTH.                59940002
         BCTR  R2,ZERO                 DECREMENT EXPONENT.              59960002
         STH   R6,FLTLEN               SAVE LENGTH.                     59980002
         B     ADJUSTIT                GET NEXT BYTE.                   60000002
         EJECT                                                          60020002
*********************************************************************** 60040002
*                                                                     * 60060002
* THE FOLLOWING INSTRUCTIONS CONVERT PRINTABLE DATA IN STANDARD OR    * 60080002
* SCIENTIFIC NOTATION TO ITS SINGLE OR DOUBLE PRECISION FLOATING      * 60100002
* POINT REPRESENTATION.                                               * 60120002
*                                                                     * 60140002
*********************************************************************** 60160002
IKJEGFTB EQU   *                                                        60180002
         DROP  R12                     GET NEW BASE REGISTER            60200002
         USING *,R15                   ESTABLISH ADDRESSABILITY         60220002
         L     R12,FLTCON              R12=ADDRESS OF IKJEGFLT          60240002
         DROP  R15                     GET NEW BASE REGISTER            60260002
         USING IKJEGFLT,R12            IKJEGFLT ADDRESSABILITY          60280002
         USING TCOMTAB,R9              TCOMTAB ADDRESSABILITY           60300002
         L     R3,WORKAREA             GET WORK SPACE                   60320002
         USING CVTWORK,R3              ESTABLISH ADDRESSABILITY         60340002
         XC    ZERO(SIX4,R3),ZERO(R3)  CLEAR OUT WORK AREA              60360002
         STC   R6,TYPE                 STORE TYPE CODE E OR D           60380002
         LH    R4,FOUR(R1)             LOAD LENGTH OF INPUT STRING      60400002
         EJECT                                                          60420002
*********************************************************************** 60440002
* THE FOLLOWING CODE SCANS THE INPUT STRING SAVING THE COEFFICIENT    * 60460002
* SIGN, THE EXPONENT SIGN, THE ADDRESS OF THE COEFFICIENT AND THE     * 60480002
* EXPONENT.                                                           * 60500002
*********************************************************************** 60520002
         SPACE                                                          60540002
         LA    R6,FRACSGN              POINT TO LOCATION FOR COEFF SIGN 60560002
         LA    R2,SCAN1                R2= ADDR OF SCAN1                60580002
         L     R7,ZERO(R1)             POINT TO INPUT STRING            60600002
         MVI   EXPSIGN,PLUS            DEFAULT EXPONENT TO POSITIVE     60620002
         SR    R5,R5                   DEFAULT EXPONENT TO ZERO         60640002
SCAN0    CLI   ZERO(R7),MINUS          IS COEFFICIENT NEGATIVE          60660002
         BE    STORSIG1                IF YES BRANCH                    60680002
         CLI   ZERO(R7),PLUS           IS COEFFICIENT POSITIVE          60700002
         BE    STORSIG1                IF YES BRANCH                    60720002
         MVI   ZERO(R6),PLUS           DEFAULT TO POSITIVE              60740002
         BR    R2                      BRANCH TO SCAN1 OR SCANDONE      60760002
STORSIG1 MVC   ZERO(ONE,R6),ZERO(R7)                                    60780002
         LA    R7,ONE(R7)              POINT TO CHARACTER BEYOND SIGN   60800002
         BCTR  R4,R2                   BRANCH TO SCAN1 OR SCANDONE      60820002
SCAN1    SR    R8,R8                   INITLZ DIGIT COUNT OF COEFF      60840002
         LR    R1,R7                   SAVE ADDRESS OF COEFFICIENT      60860002
SCAN2    CLI   ZERO(R7),RESIGN         IS THE CHARACTER AN 'E'          60880002
         BE    EFOUND                  IF YES BRANCH                    60900002
         CLI   ZERO(R7),HEX85          LOWER CASE E                     60920002
         BE    EFOUND                  IF YES BRANCH                    60940002
         LA    R8,ONE(R8)              ADD ONE TO COEFF DIGIT COUNT     60960002
         LA    R7,ONE(R7)              POINT TO NEXT CHARACTER          60980002
         BCT   R4,SCAN2                BRANCH AND DECREMENT STRING LN   61000002
         B     NUMCHECK                IF STRING LENGTH ZERO BRANCH     61020002
EFOUND   LA    R7,ONE(R7)              POINT TO NEXT CHARACTER          61040002
         LA    R6,EXPSIGN              POINT TO LOCATION FOR EXP SIGN   61060002
         BCTR  R4,R0                   DECREMENT STRING LENGTH          61080002
         BAL   R2,SCAN0                CHECK FOR EXPONENT SIGN          61100002
         BCTR  R4,R0                   DECREMENT STRING LENGTH          61120002
         EX    R4,PACKE                PACK THE EXPONENT                61140002
         CVB   R5,NUM4                 CONVERT THE EXPONENT TO BINARY   61160002
         EJECT                                                          61180002
*********************************************************************** 61200002
* THE FOLLOWING CODE CHECKS FOR AN INPUT OF ZERO AND THEN BRANCHES TO * 61220002
* THE PROPER CODE TO PACK THE INPUT NUMBER DEPENDING ON WHETHER IT IS * 61240002
* AN INTEGER, A PROPER FRACTION, OR AN IMPROPER FRACTION.             * 61260002
*********************************************************************** 61280002
         SPACE                                                          61300002
NUMCHECK L     R2,CONAREA              POINT TO OUTPUT AREA             61320002
         XC    ZERO(THREE2,R2),ZERO(R2) CLEAR IT OUT                    61340002
         LA    R15,RETURN1             SAVE IN OTHERWISE USELESS REG    61360002
         MVI   NUM1,AZERO              MOVE IN CHARACTER ZERO           61380002
         MVC   NUM1+ONE(TWO6),NUM1     SPREAD IT ALONG                  61400002
         BCTR  R8,R0                   DECREMENT COEFF DIGIT CNT FOR EX 61420002
         EX    R8,CLC1                 IS COEFFICIENT ZERO              61440002
         BCR   EIGHT,R15               IF YES GO TO RETURN1             61460002
         LA    R8,ONE(R8)              RESTORE COEFFICIENT DIGIT COUNT  61480002
CLI      CLI   ZERO(R1),HEXF0          IS THERE A HIGH ORDER ZERO       61500002
         BNE   CLICLI                  IF NO BRANCH                     61520002
         BCTR  R8,R0                   DECREMENT DIGIT COUNT            61540002
         LA    R1,ONE(R1)              POINT PAST ZERO                  61560002
         B     CLI                     CHECK NEXT CHARACTER             61580002
CLICLI   EQU   *                                                        61600002
         CLI   EXPSIGN,PLUS            IS NUMBER AN INTEGER             61620002
         BE    INTEGER                 IF YES NUMBER IS PURE INTEGER    61640002
         CH    R5,HALFZERO             CHECK FOR XXXXE-0 INPUT          61660002
         BE    INTEGER                 IF SO NUMBER IS REALLY INTEGER   61680002
         CR    R8,R5                   IS NUMBER PURE FRACTION          61700002
         BNH   FRACTION                IF YES BRANCH                    61720002
         OI    FLAG,HEXC0              INDICATE MIXED                   61740002
         LR    R10,R8                  SAVE COEFFICIENT DIGIT COUNT     61760002
         SR    R10,R5                  NUMBER OF DIGITS IN INTEGER PART 61780002
         BCTR  R10,R0                  DECREMENT FOR EX                 61800002
         XC    NUM1(TWO7),NUM1         CLEAR NUM1                       61820002
         EX    R10,PACKA               PACK THE INTEGER INTO NUM1       61840002
         LA    R10,ONE(R10)            RESTORE REGISTER 10              61860002
         AR    R1,R10                  POINT PAST INTEGER PART OF COEFF 61880002
         LR    R8,R5                   SAVE R5=EXPONENT                 61900002
         LR    R6,R1                   POINT TO FRACTION COEFFICIENT    61920002
CLI2     CLI   ZERO(R6),HEXF0          DO COMPARE                       61940002
         BNE   LR8                     IF NO GET OUT                    61960002
         LA    R6,ONE(R6)              POINT TO NEXT CHARACTER          61980002
         BCT   R8,CLI2                 HAVE WE FINISHED CHECKING        62000002
         NI    FLAG,HEXFF-HEX80        IF YES THERE IS NO FRACTION PART 62020002
LR8      LR    R8,R5                   R8= R5 FOR SHIFT                 62040002
         SRL   R8,ONE                  REMOVE LOW BIT                   62060002
         LR    R4,R8                   SAVE CURRENT FRACTION            62080002
         SLL   R8,FOUR                 SHIFT BACK BY FOUR               62100002
         AR    R8,R5                   ADD R8, R5 TO GET FRACTIONAL PT  62120002
         BCTR  R8,R0                   R8=EXECUTE LENGTH.               62140002
         EX    R8,PACKB                PACK FRACTION PART OF USER NUMB  62160002
         LA    R4,NUM3+TWO(R4)         POINT TO END OF PACKED FRACTION  62180002
         MVN   ZERO(ONE,R4),HALFZERO                                    62200002
         LA    R4,ONE                  R4=1.                            62220002
         NR    R4,R5                   IS EXPONENT EVEN OR ODD          62240002
         BNZ   MIXED2                  IF EVEN BRANCH                   62260002
         MVO   NUM3(ONE6),NUM3(ONE6)                                    62280002
MIXED2   MVN   NUM3+ONE5(ONE),PACK10+ONE                                62300002
         B     PACKDONE                PACKING IS DONE, BRANCH OUT      62320002
INTEGER  EQU   *                                                        62340002
         OI    FLAG,HEX40              INDICATE INTEGER                 62360002
         LR    R10,R8                  SAVE R8=COEFFICIENT DIGIT COUNT  62380002
         AR    R10,R5                  ADD EXPONENT TO GET FULL SIZE    62400002
         BCTR  R8,R0                   DECREMENT FOR MOVE               62420002
         C     R10,TWENTY7             HOW LONG IS INTEGER              62440002
         BNL   LEFTADJ                 IF LONGER THAN BUFFER LFT ADJ IT 62460002
         LA    R6,NUM3+ONE1                                             62480002
         SR    R6,R10                  ALTER INTEGER POINTER.           62500002
         EX    R8,MOVEA                RIGHT ADJUST INTEGER .           62520002
         B     PACKINT                 PACK THE INTEGER                 62540002
LEFTADJ  EX    R8,MOVE1                LEFT ADJUST INTEGER.             62560002
PACKINT  PACK  NUM2+TWO(EIGHT),NUM1(ONE5)                               62580002
         PACK  NUM2+NINE(SEVEN),NUM1+ONE4(ONE3)                         62600002
         B     PACKDONE                PACKING IS DONE, GET OUT         62620002
*        THE NUMBER IS A PURE FRACTION SETUP FOR HANDLING IT            62630002
FRACTION EQU   *                       NUMBER IS A PURE FRACTION        62640002
         OI    FLAG,HEX80              TURN ON FRACTION FLAG            62660002
         MVI   NUM2,AZERO              MOVE IN CHARACTER ZERO           62680002
         MVC   NUM2+ONE(FIVE3),NUM2    SPREAD IT ALONG                  62700002
         LA    R0,FIVE4                NUMBER OF DIGITS FOR MULTIPLYING 62720002
         CR    R5,R0                   HOW MANY DIGITS IN FRACTION      62740002
         BNH   LESS55                  IF 54 OR LESS BRANCH             62760002
         S     R5,TWENTY7              SUBRACT 27                       62780002
         OI    FLAG,HEX04              FLAG TO INDICITE NOT FULL FRACT  62800002
         CR    R5,R0                   IS FRACTION STILL TOO LARGE      62820002
         BNH   LESS55                  IF SMALL ENOUGH BRANCH           62840002
         S     R5,TWENTY7              MAKE NUMBER SMALL ENOUGH         62860002
         OI    FLAG,HEX08              SET FLAG TO INDICATE FAKING      62880002
LESS55   LA    R6,NUM2(R5)             PACK THE FRACTION                62900002
         SR    R6,R8                   ALTER FRACTION POINTER.          62920002
         BCTR  R8,R0                   R8=EXECUTE LENGTH.               62940002
         EX    R8,MOVEA                LEFT ADJUST FRACTION.            62960002
         PACK  NUM4(EIGHT),NUM3+SEVEN(ONE5)       PACK                  62980002
         PACK  NUM3+EIGHT(EIGHT),NUM1+ONE1(ONE1)  PACK                  63000002
         MVN   NUM3+ONE5(ONE),NUM3+SIX            MOVE NUMERIC          63020002
         PACK  NUM3(EIGHT),NUM2+ONE2(ONE5)        PACK                  63040002
         PACK  NUM1+EIGHT(EIGHT),NUM2(ONE1)       PACK                  63060002
         MVN   NUM1+ONE5(ONE),NUM2+ONE1           MOVE NUMERIC          63080002
         MVC   NUM2(THREE2),NUM1+EIGHT            MOVE CHARACTER        63100002
         XC    NUM3(TWO4),NUM3                    AND (CLEAR)           63120002
         MVN   NUM4+SEVEN(ONE),PACK10+ONE         MOVE NUMERIC          63140002
         B     INTGREND                GO TO FRACTION PROCESSING PART   63160002
         EJECT                                                          63180002
*********************************************************************** 63200002
*                                                                     * 63220002
* THIS CODE IS REACHED WHEN PACKING AND FORMATTING ARE COMPLETED      * 63240002
* FOR INTEGER OR MIXED DATA.  IT SETS UP AND BEGINS CONVERSION OF     * 63260002
* THE INTEGER PORTION TO FLOATING POINT REPRESENTATION.               * 63280002
*                                                                     * 63300002
*********************************************************************** 63320002
         SPACE                                                          63340002
PACKDONE EQU   *                       PACKING IS DONE                  63360002
         SR    R5,R5                   INITIALIZE DIVISION COUNTER      63380002
         LA    R4,THREE2(R2)           POINT TO LOC FOR FRACT MANTISSA  63400002
         LA    R1,DIVIDE               SAVE ADDRESS IN UNUSED REG.      63420002
         LA    R8,MORENUM7             SAVE ADDRESS IN UNUSED REG.      63440002
DIVIDE   DP    NUM2(ONE6),TWO56(TWO)   DIVIDE TO OBTAIN HEX DIGITS      63460002
         LA    R5,TWO(R5)              INC BY 2 FOR EACH DIVISION BY 16 63480002
         MVC   NUM4+SIX(TWO),NUM2+ONE4                                  63500002
         ZAP   NUM2(ONE6),NUM2(ONE4)   RIGHT ADJUST QUOTIENT            63520002
         C     R10,TWENTY7             FULL INTEGER INVOLVED IN DIVISIN 63540002
         BH    MORENUM1                NO.                              63560002
         CVB   R0,NUM4                 YES CONTINUE                     63580002
         STC   R0,ZERO(R4)             STORE HEX DIGIT PAIR OUTPUT AREA 63600002
         BCTR  R4,R0                   POINT 1 BYTE LEFT FOR NEXT TIME  63620002
         EJECT                                                          63640002
*********************************************************************** 63660002
*                                                                     * 63680002
* THE FOLLOWING CODE IS EXECUTED IF THE FULL INTEGER IS BEING INVOLVED* 63700002
* IN DIVISION AND CALCULATION OF THE EQUIVALENT HEX REPRESENTATION. IT* 63720002
* DECREMENTS THE INTEGER DIGIT COUNTER (R10) AND IF PROCESSING IS NOT * 63740002
* DONE RETURNS TO DIVIDE THE INTEGER AGAIN.                           * 63760002
*                                                                     * 63780002
*********************************************************************** 63800002
         LA    R6,THREE                R6= 3                            63820002
         CR    R10,R6                  HOW BIG WAS DIGIT COUNT          63840002
         BL    INTGRND1                IF 1 OR 2 WE ARE DONE DIVIDING   63860002
         LA    R7,NUM2+ONE6                                             63880002
         LR    R6,R10                  SAVE R10                         63900002
         SRL   R6,ONE                  COMPUTE COUNT IN BYTES           63920002
         SR    R7,R6                   POINT TO FRONT OF QUOTIENT       63940002
         BCTR  R10,R0                  DECREMENT DIGIT COUNT            63960002
         BCTR  R10,R0                  DECREMENT DIGIT COUNT            63980002
         LA    R6,ONE                  TO CHECK R10 FOR EVEN OR ODD     64000002
         NR    R6,R10                  TO CHECK R10 FOR EVEN OR ODD     64020002
         BZ    ZEROFOX                 IF R10 IS EVEN BRANCH            64040002
         TM    ZERO(R7),HEXF0          CHECK FOR HIGH ORDER ZERO        64060002
         BCR   SEVEN,R1                BRANCH IF NONE TO DIVIDE         64080002
         B     BCTR                    GO DECREMENT DIVISION COUNTER.   64100002
ZEROFOX  TM    ZERO(R7),HEX0F          IS NEXT DIGIT ZERO ALSO          64120002
         BCR   SEVEN,R1                BRANCH IF NONE TO DIVIDE         64140002
BCTR     BCTR  R10,R1                  DECR INTEGER LENGTH AND REDIVIDE 64160002
         B     INTGRND1                GO PROCESS FRACTION PART.        64180002
         EJECT                                                          64200002
*********************************************************************** 64220002
*                                                                     * 64240002
* THE FOLLOWING CODE IS EXECUTED IF THE FULL INTEGER PART WAS NOT     * 64260002
* INVOLVED IN DIVISION. IT RECALCULATES THE INTEGER DIGIT COUNT AND   * 64280002
* FORMATS THE DIVIDEND FOR THE NEXT DIVISION.                         * 64300002
*                                                                     * 64320002
*********************************************************************** 64340002
         SPACE                                                          64360002
MORENUM1 EQU   *                                                        64380002
         S     R10,TWENTY7                                              64400002
         MP    NUM2(ONE6),PACK10(TWO)   SHIFT LEFT ONE DIGIT            64420002
         BCT   R10,MORENUM2            IF NOT ZERO CONTINUE SHIFTING    64440002
         TM    NUM2+TWO,HEX0F          IS FIRSTT OUT                    64460002
         BZ    MORENUM6                IF YES BRANCH                    64480002
         BR    R8                      IF NO GO TO MORENUM7             64500002
MORENUM2 MP    NUM2(ONE6),PACK10(TWO)   SHIFT LEFT ONE DIGIT            64520002
         TM    NUM2+TWO,HEXF0                                           64540002
         BCR   SEVEN,R8                DIGIT NOT ZERO BRANCH MORENUM7   64560002
         BCT   R10,MORENUM4            OTHERWISE DECREMENT DIGIT COUNT  64580002
         BR    R8                      IF DIGIT COUNT IS ZERO BRANCH    64600002
MORENUM4 MP    NUM2(ONE6),PACK10(TWO)  MULTIPLY TO SHIFT OUT ZERO       64620002
         BR    R8                      BRANCH TO MORENUM7               64640002
MORENUM6 BCTR  R10,R0                  DECREMENT INTEGER COUNTER        64660002
MORENUM7 BCTR  R10,R0                  DECREMENT INTEGER COUNTER        64680002
         A     R10,TWENTY7             RESTORE FULL INTEGER DIGIT CNTER 64700002
         BR    R1                      GO BACK TO DIVIDE                64720002
         EJECT                                                          64740002
*********************************************************************** 64760002
*                                                                     * 64780002
* THE FOLLOWING CODE IS REACHED WHEN THE INTEGER PROCESSING IS        * 64800002
* COMPLETE. IT WILL PROCESS THE FRACTION IF ANY.                      * 64820002
*                                                                     * 64840002
*********************************************************************** 64860002
         SPACE                                                          64880002
INTGRND1 EQU   *                       INTEGER PART CONVTED TO FLOAT PT 64900002
         LR    R8,R5                   LOAD DIGIT COUNT                 64920002
         SRL   R8,ONE                  COMPUTE BYTE COUNT               64940002
         BCTR  R8,R0                   DECREMENT FOR MOVE               64960002
         EX    R8,MOVEB                LFT ADJUST FRACT PART IN CONAREA 64980002
         TM    TWO(R2),HEXF0           IS FIRST DIGIT ZERO              65000002
         BNZ   INTGRND2                IF NO, OKAY AND BRANCH           65020002
         BCTR  R5,R0                   SUBRACT FROM DIGIT CNT (AND EXP) 65040002
         MVO   TWO(EIGHT,R2),TWO(EIGHT,R2)   SHIFT THE MANTISSA         65060002
         MVN   NINE(ONE,R2),HALFZERO    PUT IN A ZERO                   65080002
INTGRND2 EQU   *                                                        65100002
         STC   R5,NUM5                 SAVE FOR POSSIBLE USE LATER      65120002
         LA    R10,HEX40               LOAD BASE FOR EXPONENT           65140002
         CLI   FRACSGN,PLUS            IS NUMBER POSITIVE               65160002
         BE    PLUS3                   IF YES BRANCH                    65180002
         LA    R10,HEX80(R10)          OTHERWISE CHANGE THE BASE        65200002
PLUS3    AR    R10,R5                  COMPUTE THE EXPONENT             65220002
         STC   R10,ONE(R2)             SAVE IT                          65240002
         TM    FLAG,HEX80              WAS THERE A FRACTION PART        65260002
         BCR   EIGHT,R15               IF NO GO TO RETURN1              65280002
INTGREND LA    R4,ONE3(R2)             POINT TO FRACTION MANTISSA       65300002
         LA    R8,EIGHT                NUMBER OF SIGNIFICANT DIGITS     65320002
         SR    R5,R5                   MULTIPLICATION COUNTER           65340002
         SR    R7,R7                   CLEAR OUT A REGISTER             65360002
         TM    FLAG,HEX40              WAS THERE AN INTEGER PART        65380002
         BZ    MULTIPLY                IF NO START WORKING ON FRACTION  65400002
         MVC   NUM2(ONE6),NUM3         SETUP AREA FOR FRACT CONVERSION  65420002
         MVN   NUM1+ONE5(ONE),PACK10+ONE                                65440002
MULTIPLY MP    NUM2(ONE6),TWO56(TWO)                                    65460002
         MP    NUM1(ONE6),TWO56(TWO)                                    65480002
         MVO   NUM1(TWO),NUM1(TWO)     SHIFT LEFT TO MAKE ROOM FOR SIGN 65500002
         MVN   NUM1+ONE(ONE),PACK10+ONE                                 65520002
         AP    NUM2(ONE6),NUM1(TWO)     ADD TO LOW ORDER PART OF NUM2   65540002
         STH   R7,NUM1                 CLEAR OUT HIGH TWO BYTES         65560002
         CLC   NUM2(TWO),HALFZERO      IS OVERFLOW ZERO                 65580002
         BE    NEXTCHK1                IF YES BRANCH                    65600002
         TM    FLAG,HEX0C              IS EITHER FAKING FLAG STILL ON   65620002
         BZ    NEXTCHK4                IF NO BRANCH                     65640002
         BM    NEXTCHK8                IF ONLY ONE ON BRANCH            65660002
         NI    FLAG,(HEXFF-HEX08)      TURN OFF ONE FAKING FLAG         65680002
NEXTCHK9 MVC   NUM1(ONE6),NUM2         SHIFT STUFF TO LOW ORDER BUFFER  65700002
         XC    NUM2(ONE6),NUM2         CLEAR OUT HIGH ORDER BUFFER      65720002
         MVO   NUM2+ONE4(TWO),NUM1(TWO)                                 65740002
         MVN   NUM2+ONE5(ONE),PACK10+ONE                                65760002
         STH   R7,NUM1                 SAVE R7 IN NUM1                  65780002
NEXTCHKB LA    R5,TWO(R5)              INCREMENT MULTIPLY COUNTER       65800002
         B     MULTIPLY                GO DO IT AGAIN                   65820002
NEXTCHK8 NI    FLAG,(HEXFF-HEX04)      TURN OFF REMAINING FAKING FLAG   65840002
         B     NEXTCHK9                GO TO COMMON FAKING PART         65860002
NEXTCHK1 TM    FLAG,HEX20              ARE WE COMPUTING SIGNIFIC DIGITS 65880002
         BZ    NEXTCHKB                IF NO BRANCH                     65900002
NEXTCHK4 OI    FLAG,HEX20              INDICATE SIGNIFIC DIGIT FIGURING 65920002
         MVO   NUM4+SIX(TWO),NUM2(TWO)  MOVE INTO CLEAN AREA            65940002
         STH   R7,NUM2                 CLEAR OUT HIGH TWO BYTES         65960002
         CVB   R0,NUM4                 CONVERT TO TWO HEX DIGITS        65980002
         STC   R0,ZERO(R4)             SAVE THEM                        66000002
         LA    R4,ONE(R4)              POINT 1 BYTE RIGHT FOR NEXT PAIR 66020002
         BCT   R8,MULTIPLY             IF LESS THAN EIGHT BYTES BRANCH  66040002
         LA    R4,ONE3(R2)             POINT TO BEGINNING OF MANTISSA   66060002
         TM    ZERO(R4),HEXF0          IS THERE A HIGH ORDER ZERO       66080002
         BNZ   FRACDONE                IF NO BRANCH                     66100002
         MVO   ZERO(EIGHT,R4),ZERO(EIGHT,R4)                            66120002
         LA    R5,ONE(R5)              ADD TO THE MULTIPLY COUNTER      66140002
         EJECT                                                          66160002
*********************************************************************** 66180002
*                                                                     * 66200002
* THE FOLLOWING CODE IS REACHED WHEN THE MANTISSA PORTION OF THE      * 66220002
* FLOATING POINT RESULT HAS BEEN CALCULATED. IT WILL CALCULATE THE    * 66240002
* CHARACTERISTIC OR ALIGN THE MANTISSA PORTION OF THE FRACTION IF THE * 66260002
* USER ENTERED NUMBER WAS A FRACTION OR MIXED INTEGER AND FRACTION    * 66280002
*                                                                     * 66300002
*********************************************************************** 66320002
FRACDONE EQU   *                                                        66340002
         LA    R2,ONE(R2)              POINT PAST THE LENGTH FIELD      66360002
         LA    R10,HEX40               LOAD BASE FOR EXPONENT           66380002
         STC   R5,NUM7                 SAVE MULTIPLICATION COUNTER      66400002
         SR    R10,R5                  FIGURE THE EXPONENT              66420002
         CLI   FRACSGN,PLUS            IS NUMBER POSITIVE               66440002
         BE    PLUS1                   IF POSITIVE BRANCH               66460002
         LA    R10,HEX80(R10)          INDICATE NEGATIVE NUMBER         66480002
PLUS1    TM    FLAG,HEX40              WAS THERE AN INTEGER PART        66500002
         BNZ   INTNFRAC                IF YES BRANCH                    66520002
         STC   R10,ZERO(R2)            SAVE THE EXPONENT                66540002
         MVC   ONE(EIGHT,R2),ONE2(R2)                                   66560002
         BCTR  R2,R15                  RESTORE R2 AND GO TO RETURN1     66580002
INTNFRAC SR    R10,R10                 CLEAR OUT A REGISTER             66600002
         SR    R1,R1                   CLEAR OUT A REGISTER             66620002
         IC    R10,NUM7                LOAD FRACTION MULTIPLY COUNT     66640002
         IC    R1,NUM5                 LOAD INTEGER DIVISION COUNT      66660002
*        OBTAIN THE NUMBER OF DIGITS PLACES TO SHIFT TO ALIGN NUMBER    66670002
         LA    R1,TWO(R1,R10)          R1= NUMBER OF DIGIT PLACES       66680002
         LM    R4,R5,ONE2(R2)          LOAD R4, R5 FROM CONAREA         66700002
         LM    R6,R7,ONE6(R2)          LOAD R6, R7 FROM CONAREA         66720002
         LA    R0,SIX4                 R0= 64 USED FOR COMPARE          66740002
         SLL   R1,TWO                  MULTIPLY R1 BY 4                 66760002
         CR    R1,R0                   IS SHIFT MORE THAN 64 BITS       66780002
         BNL   SHIFT64                 IF YES BRANCH                    66800002
         SRL   R0,ONE                  R0= 32 USED FOR COMPARE          66820002
         CR    R1,R0                   IS SHIFT MORE THAN 32 BITS       66840002
         BNL   SHIFT32                 IF YES BRANCH                    66860002
         SRDL  R4,ZERO(R1)                                              66880002
         SRDL  R6,ZERO(R1)                                              66900002
         A     R4,ZERO(R2)             ADD R4 WITH CONAREA              66920002
         A     R5,FOUR(R2)             ADD R5 WITH CONAREA              66940002
         A     R7,EIGHT(R2)            ADD R7 WITH CONAREA              66960002
         LR    R6,R7                   R6 = CREATED SUM IN R7           66980002
         STM   R4,R6,ZERO(R2)          STORE R4, R5, R6 IN CONAREA      67000002
         BCTR  R2,R15                  RESTORE R2 AND GO TO RETURN1     67020002
SHIFT32  SR    R1,R0                   SHIFT 32 BITS (OR MORE)          67040002
         SRDL  R4,ZERO(R1)                                              67060002
         A     R4,FOUR(R2)             ADD R4 WITH CONAERA              67080002
         A     R5,EIGHT(R2)            ADD R5 WITH CONAERA              67100002
         STM   R4,R5,FOUR(R2)          STORE R4, R5 IN CONAREA          67120002
         BCTR  R2,R15                  RESTORE R2 AND GO TO RETURN1     67140002
SHIFT64  SRDL  R4,ZERO(R1)             SHIFT OF 64 BITS                 67160002
         A     R4,EIGHT(R2)            ADD R4 WITH CONAREA              67180002
         ST    R4,EIGHT(R2)            STORE R4 IN CONAREA              67200002
BCTR2    BCTR  R2,R0                   DECREMENT BY ONE                 67220002
*********************************************************************** 67240002
* THE FOLLOWING CODE COMPUTES THE OUTPUT LENGTH EITHER FOUR OR EIGHT  * 67260002
* BYTES AND SAVES THE LENGTH IN CONAREA FOR IKJEGPCH. IT THEN CHECKS  * 67280002
* THE FLOATING POINT REPRESENTATION AND ROUNDS IT IF NECESSARY.       * 67300002
* FINALLY IT CHECKS THE HIGH ORDER MANTISSA BYTE FOR ZERO             * 67320002
*********************************************************************** 67340002
         SPACE                                                          67360002
RETURN1  MVI   ZERO(R2),HEX08          SET LENGTH TO 8                  67380002
         LA    R15,ENDFLT              POINT TO ENDFLT                  67400002
         CLI   TYPE,HEX1C              DOUBLE OR SINGLE PRECISION       67420002
         BE    LNGROUND                IF DOUBLE BRANCH                 67440002
         MVI   ZERO(R2),HEX04          SET LENGTH TO 4                  67460002
*        THIS GROUP OF CODE ROUNDS THE RESULTS                          67480002
         LA    R2,ONE(R2)              POINT PAST LENGTH FIELD          67500002
         CLI   FOUR(R2),HEX80          IS IT NECESSARY TO CHANGE OUTPUT 67520002
         BCR   FOUR,R15                NO ROUNDING NECESSARY TO ENDFLT  67540002
         L     R4,ZERO(R2)             LOAD RESULT                      67560002
         LA    R5,ONE                  R5 = ONE                         67580002
         AR    R4,R5                   ADD ONE                          67600002
         ST    R4,ZERO(R2)             STORE RESULT                     67620002
         B     FINALCK                 CHECK FOR 0 HIGH ORDER MANTISSA  67640002
LNGROUND EQU   *                                                        67660002
         LA    R2,ONE(R2)              POINT PAST LENGTH FIELD          67680002
         CLI   EIGHT(R2),HEX80         IS IT NECESSARY TO CHANGE OUTPUT 67700002
         BCR   FOUR,R15                NO ROUNDING NECESSARY TO ENDFLT  67720002
         LD    R2,ZERO(R2)             LOAD INTO FLOATING PT REGISTER   67740002
         XC    ONE(SEVEN,R2),ONE(R2)   CLEAR OUT FRACTION               67760002
         MVI   SEVEN(R2),HEX01         MOVE IN ONE                      67780002
         AW    R2,ZERO(R2)             ADD TO ROUND                     67800002
         STD   R2,ZERO(R2)             REPLACE RESULT                   67820002
FINALCK  CLI   ONE(R2),HEX00                                            67840002
         BCR   SEVEN,R15               IF NOT ZERO GO TO ENDFLT         67860002
         MVI   ONE(R2),HEX10                                            67880002
         BR    R15                     GO TO ENDFLT                     67900002
         EJECT                                                          67920002
*********************************************************************** 67940002
* THE FOLLOWING IS A GROUP OF DESECT USED BY THE CSECT'S                67960002
*********************************************************************** 67980002
         TITLE 'IKJEGCVT PDE DSECT.'                                    68000002
         IKJPARMA                                                       68020002
         TITLE 'IKJEGCVT TEST COMMUNICATION TABLE.'                     68040002
         TCOMTAB                                                        68060002
CVTWORK  DSECT                                                          68080002
         SPACE                                                          68100002
*********************************************************************** 68120002
*                                                                     * 68140002
* THIS DSECT MAPS A SECTION OF THE WORKAREA POINTED TO BY 'WORKAREA'  * 68160002
* IN TCOMTAB.                                                         * 68180002
*                                                                     * 68200002
*********************************************************************** 68220002
         SPACE                                                          68240002
FLTINPUT DS    D                       LOCATION FOR FLTPT INPUT STRING. 68260002
PACKAREA DS    D                       LOCATION FOR PACKED DEC CONSTANT 68280002
FLTSTG   DS    5D                      FLOATING PT WORKAREA.            68300002
FLTLEN   DS    H                       SAVE LENGTH AREA.                68320002
         ORG   *-58                    POINT TO BEGINNING OF WORK AREA  68340002
NUM2     DS    4F                      WORK SPACE FOR CONVERSION        68360002
NUM1     DS    4F                      ***                              68380002
NUM3     DS    4F                      ***                              68400002
NUM4     DS    2F                      AREA FOR CVB OF EXPONENT         68420002
FRACSGN  DS    CL1                     SIGN OF USER ENTERED FRACTION    68440002
EXPSIGN  DS    CL1                     SIGN OF USER ENTERED EXPONENT    68460002
FLAG     DS    CL1                     USED TO INDICATE NUMBER TYPE     68480002
EXPON    DS    CL1                     USER ENTERED EXPONENT OR ZERO    68500002
NUM7     DS    CL1                     ***                              68520002
NUM5     DS    CL1                     ***                              68540002
COEFF    DS    CL1                     COEFFICIENT DIGIT COUNT          68560002
TYPE     DS    CL1                     DOUBLE OR SINGLE PRECISION       68580002
         ORG   *-1                     BACK UP ONE BYTE                 68600002
CODE370  DS    X                       370 OP CODE FLAG.                68620002
CHAR5    EQU   X'01'                   MNEUMONIC IS 5 CHARS.            68640002
SSIMM    EQU   X'02'                   SS FORMAT,L1 & I3.               68660002
IKJEGFLT CSECT                                                          68680002
FLTMOVE  MVC   FLTINPUT+ONE(ONE),ONE(R1) FRACTION NOW IN WORKAREA.      68700002
MOVEFLT  MVC   FLTSTG(ONE),FLTSTG+ONE  LEFT JUSTIFY ZONE DECIMAL.       68720002
ALIGNMVC MVC   ZERO(ONE,R5),ZERO(R8)   FRACTION NOW MOVED FOR ADD.      68740002
ZONEMOVE MVC   FLTSTG(ONE),ZERO(R8)    ZONED DECIMAL NOW LEFT JUSTIVIED 68760002
ZONEJUST MVC   ZERO(ONE,R8),ONE(R8)    INPUT NOW LEFT JUSTIFIED.        68780002
OUTMVC   MVC   ONE(ONE,R2),FLTSTG-TWO  MOVE STRING INTO OUTPUT AREA     68800002
PACKA    PACK  NUM2(ONE6),ZERO(ZERO,R1)                                 68820002
PACKB    PACK  NUM3+TWO(ZERO),ZERO(ZERO,R1)                             68840002
PACKE    PACK  NUM4+SIX(TWO),ZERO(ZERO,R7)                              68860002
CLC1     CLC   ZERO(ZERO,R1),NUM1                                       68880002
MOVE1    MVC   NUM1(ZERO),ZERO(R1)                                      68900002
MOVEA    MVC   ZERO(ZERO,R6),ZERO(R1)                                   68920002
MOVEB    MVC   TWO(ZERO,R2),ONE(R4)                                     68940002
ROUNDPK  PACK  FLTINPUT(ONE),FLTSTG(ONE) SIGNIFICANT DIGITS NOW PACKED. 68960002
ADD5     AP    FLTINPUT(ONE),PACK5(ONE) ROUND VALUE.                    68980002
UNPKSIG  UNPK  FLTSTG(ONE),FLTINPUT(ONE) SIGNIFICANT DIGITS NOW ZONED.  69000002
         DS    0F                                                       69020002
SIGNOFF  DC    X'0000007F'             VALUE TO CLEAR HIGH ORDER.       69040002
FLTCON   DC    A(IKJEGFLT)             ADDR OF FLOATING POINT ROUTINE.  69060002
CVTVAL   DC    X'3B9ACA00'             10**9 USED TO CONVERT FIXED DEC. 69080002
FLTCLEAR DC    X'0000000F'             FULL WORD 15                     69100002
DOBLFLT  DC    X'0008'                 HALFWORD 8 FOR CHARACTERISTICS.  69120002
FLT20    DC    H'20'                   HALFWORD 20.                     69140002
PACK10   DC    PL2'10'                 PACKED 10                        69160002
TWO56    DC    PL2'256'                PACKED 256                       69180002
HALFZERO DC    H'0'                    HALFWORD ZERO                    69200002
FLT17    DC    H'17'                   HALFWORD 179                     69220002
HALFONE  DC    H'1'                    HALFWORD 1.                      69240002
TWENTY7  DC    F'27'                   FULLWORD 27                      69260002
FLTDEC2  DC    H'2'                    FIXED DECIMAL 2 FOR FLOATING PT. 69280002
FLTCHAR  DC    X'0046'                 FLOATING PT CHARACTERISTIC + 6   69300002
FLT64    DC    H'64'                   HALF WORD 64.                    69320002
FLT10    DC    H'10'                   HALF WORD 10.                    69340002
EXPCHAR  DC    C' E+  '                EXPONENT PATTERN.                69360002
FLPTZERO DC    X'02'                   OUTPUT FOR ZERO VALUE.           69380002
         DC    C'+0'                   *                                69400002
FRACSIGN DC    C'+.'                   FRACTION SIGN PATTERN.           69420002
FLTPATTN DC    C'0'                    PATTERN FOR EDIT INSTRUCTION.    69440002
         DC    18X'20'                 *                                69460002
PACK5    DC    P'5'                    PACKED 5                         69480002
REMDATA  EQU   FLTSTG+15               LOC FOR REMAINDER OF FLT PT.     69500002
HEX9     EQU   X'09'                   A HEX 9.                         69520002
         END                                                            70320002
./  ADD  SSI=33180112,NAME=IKJEGDCB
         TITLE 'IKJEGDCB, THE LISTDCB FUNCTION OF THE TEST COMMAND'     00016002
* /* START OF SPECIFICATIONS ****                                       00016402
*02*  PROCESSOR = ASSEMBLER                                             00016802
**** END OF SPECIFICATIONS ***/                                         00017202
*********************************************************************** 00030002
* STATUS  CHANGE LEVEL 00, VERSION NO. 02, OS/VS2                     * 00040002
*                                                                     * 00050002
* FUNCTION/OPERATION                                                  * 00060002
*    THIS COMMAND PROGRAM RECEIVES CONTROL FROM THE TEST COMMAND      * 00070002
*    PROCESSOR.  IT DISPLAYS ALL OR PART OF THE DCB AT A USER         * 00080002
*    SPECIFIED ADDRESS.                                               * 00090002
*                                                                     * 00100002
* ENTRY POINTS                                                        * 00110002
*         IKJEGDCB-PROCESSES THE FIELDS OF THE DCB                    * 00120002
*         IKJEGDVK-VALIDITY CHECKS THE ADDRESS OF THE DCB             * 00130002
*                                                                     * 00140002
* INPUT                                                               * 00150002
*    ONE LINE OF INPUT FROM THE TERMINAL CONTAINING THE COMMAND       * 00160002
*                                                                     * 00170002
* OUTPUT                                                              * 00180002
*    LINES OF OUTPUT TO THE TERMINAL OR SPECIFIED DATA SET CONTAINING * 00190002
*    DESCRIPTIVE HEADERS AND THE REQUESTED DCB FIELDS.                * 00200002
*                                                                     * 00210002
* EXTERNAL REFERENCES                                                 * 00220002
*         IKJPARS  - TO SCAN THE INPUT BUFFER                         * 00230002
*         IKJEGCVT - TO CHECK AND CONVERT THE ADDRESS AND TO          * 00240002
*    CONVERT THE DCB FIELDS TO PRINTABLE HEXADECIMAL.                 * 00250002
*         IKJEGIO  - TO OUTPUT THE DCB HEADERS AND FIELDS             * 00260002
*                                                                     * 00280002
* EXITS,NORMAL                                                        * 00290002
*         IKJPARS-VIA REGISTER 14 WITH ONE OF THE FOLLOWING RETURN    * 00300002
*    CODES IN REGISTER 15-                                            * 00310002
*    0   INDICATING TO CONTINUE PROCESSING THE COMMAND BUFFER         * 00320002
*    8   INDICATING IKJPARS SHOULD PROMPT WITH REENTER                * 00330002
*    12  INDICATING IKJPARS SHOULD RETURN TO IKJEGDCB WITH A RETURN   * 00340002
*    *   CODE OF 20.                                                  * 00350002
*                                                                     * 00360002
*         IKJEGMNL-VIA REGISTER 14 WITH ONE OF THE FOLLOWING RETURN   * 00370002
*    CODES IN REGISTER 15.                                            * 00380002
*    0   NORMAL RETURN                                                * 00390002
*    16  INDICATING AN ATTENTION INTERRUPT WAS ENCOUNTERED            * 00400002
*                                                                     * 00410002
* EXITS,ERROR                                                         * 00420002
*         IKJEGMNL-VIA REGISTER 14 WITH A RETURN CODE OF 20 IN        * 00430002
*    REGISTER 15 INDICATING THE STAE RETRY ROUTINE WAS ENTERED.       * 00440002
*         IKJEGMNL-VIA REGISTER 14 WITH A RETURN CODE OF 24 IN        * 00440402
*    REGISTER 15 INDICATING THE ESTAE MACRO WAS NOT ISSUED            * 00442002
*                                                                     * 00450002
* TABLES/WORK AREAS                                                   * 00460002
*                                                                     * 00470002
*    TCOMTAB - DSECT CONTAINING THE ADDRESS OF THE OUTPUT BUFFER,     * 00480002
*    THE COMMAND BUFFER, LISTDCB'S WORKAREA AND SAVEAREA.             * 00490002
*                                                                     * 00500002
*    DCBWKARA - CONTAINS THE PARAMETER LIST FOR IKJPARS, THE BUFFERS, * 00510002
*    USED TO BUILD THE FIELD HEADERS AND FIELDS FOR                   * 00520002
*    OUTPUT, AND THE SWITCHES USED BY IKJEGDCB.                       * 00530002
*                                                                     * 00540002
* ATTRIBUTES                                                          * 00550002
*    REENTRANT ROUTINE                                                * 00560002
*    REFRESHABLE ROUTINE                                              * 00570002
*                                                                     * 00580002
* CHARACTER CODE DEPENDENCY                                           * 00590002
*    THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL            * 00600002
*    REPRESENTATION OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT * 00610002
*    TO THE ONE USED AT ASSEMBLY TIME.  THE CODING HAS BEEN ARRANGED  * 00620002
*    SO THAT REDEFINITION OF CHARACTER CONSTANTS, BY REASSEMBLY,      * 00630002
*    WILL RESULT IN A CORRECT MODULE FOR THE NEW DEFINITION.          * 00640002
*                                                                     * 00650002
* NOTES                                                               * 00660002
*    ABBREVIATIONS COMMONLY USED IN THE COMMENTS BESIDE THE CODE-     * 00670002
*    1.   PDL-PARAMETER DESCRIPTOR LIST                               * 00680002
*    2.   PDE-PARAMETER DESCRIPTOR ENTRY                              * 00690002
*    3.   PCL-PARAMETER CONTROL LIST                                  * 00700002
*    COMMENTS ON STATEMENTS USUALLY START IN COLUMN 36.               * 00710002
*    STAERTN IS THE ENTRY POINT INTO THE STAE RETRY ROUTINE.  THIS    * 00720002
*    CODE IS ENTERED FROM IKJEGSTA.                                   * 00730002
*********************************************************************** 00740002
         EJECT                                                          00750002
         COPY IKJEGSIO                                                  00752002
IKJEGDCB CSECT                                                          00754002
R0       EQU    0                 REGISTER 0                            00760002
R1       EQU    1                 REGISTER 1                            00770002
R2       EQU    2                 USED TO INDEX THROUGH OUTPUT BUFFER   00780002
R3       EQU    3                 USED AS BASE FOR DCB BEING PROCESSED  00790002
R4       EQU    4                 REGISTER 4                            00800002
R5       EQU    5                 BASE OF IKJEGDCB'S WORKAREA           00810002
R6       EQU    6                 REGISTER 6                            00820002
R7       EQU    7                 REGISTER 7                            00830002
R8       EQU    8                 BASE FOR IKJPARMD                     00840002
R9       EQU    9                 BASE FOR TCOMTAB                      00850002
R10      EQU   10                 USED TO ADDRESS OUTPUT BUFFERS        00860002
R11      EQU   11                 USED TO ADDRESS OUTPUT BUFFERS        00870002
R12      EQU   12                 PROGRAM BASE                          00880002
R13      EQU   13                 POINTER TO IKJEGDCB'S SAVEAREA        00890002
R14      EQU   14                 REGISTER 14                           00900002
R15      EQU   15                 REGISTER 15                           00910002
** THE FOLLOWING EQUATES ARE USED AS DISPLACEMENTS IN INSTRUCTIONS   ** 00920002
** AND TO INDICATE THE RELATIVE ADDRESS OF FIELDS WITHIN A DCB.      ** 00930002
D0       EQU    0                 DISPLACEMENT OF 0                     00940002
D1       EQU    1                 DISPLACEMENT OF 1                     00950002
D2       EQU    2                 DISPLACEMENT OF 2                     00960002
D4       EQU    4                 DISPLACEMENT OF 4                     00970002
D5       EQU    5                 DISPLACEMENT OF 5                     00980002
D8       EQU    8                 DISPLACEMENT OF 8                     00990002
D10      EQU   10                 DISPLACEMENT OF 10                    01000002
D12      EQU   12                 DISPLACEMENT OF 12                    01010002
D14      EQU   14                 DISPLACEMENT OF 14                    01020002
D32      EQU   32                 DISPLACEMENT OF 32                    01030002
D35      EQU   35                 DISPLACEMENT OF 35                    01040002
D40      EQU   40                 DISPLACEMENT OF 40                    01050002
D44      EQU   44                 DISPLACEMENT OF 44                    01060002
D56      EQU   56                 DISPLACEMENT OF 56                    01070002
D68      EQU   68                 DISPLACEMENT OF 68                    01080002
D84      EQU   84                 DISPLACEMENT OF 84                    01090002
** THE FOLLOWING EQUATES ARE USED IN TESTING AND IN DISPLACEMENTS    ** 01100002
HEXBF    EQU   X'BF'              USED TO TURN SECTION HEADER SW OFF    01110002
HEXDF    EQU   X'DF'              USED TO TURN OFF FIELD HEADER SWITCH  01120002
HEXEF    EQU   X'EF'              USED TO TURN OFF FIELD SWITCH         01130002
HEXCF    EQU   X'CF'              USED TO TURN OFF FIELD HEADER AND     01140002
*                                 FIELD SWITCHES                        01150002
HEXFF    EQU   X'FF'              HEX  'FF'                             01160002
HEX10    EQU   X'10'              USED TO TEST OFLGS OF DCB TO          01170002
*                                 DETERMINE IF DCB IS OPEN OR CLOSED    01180002
ALLCHECK EQU   X'80'              SWITCH INDICATING ALL FIELDS ARE TO   01190002
*                                 BE OUTPUTTED                          01200002
SECHDRCK EQU   X'40'              SWITCH INDICATING SECTION HEADER IS   01210002
*                                 TO BE OUTPUTTED                       01220002
HDRCHECK EQU   X'20'              SWITCH INDICATING FIELD HEADERS ARE   01230002
*                                 TO BE OUTPUTTED.                      01240002
FLDCHECK EQU   X'10'              SWITCH INDICATING CONTENTS OF FIELDS  01250002
*                                 ARE TO BE OUTPUTTED                   01260002
ZERO     EQU   X'0000'            USED TO TURN PDE'S OFF AND ALSO TO    01270002
*                                 TEST TO SEE IF FIELD WAS SPECIFIED    01280002
PDELEN   EQU   53                 NUMBER OF BYTES MINUS 1 OF THE FIELD  01290002
*                                 PDES                                  01300002
FLAG     EQU   X'80'              USED TO SET FLAG BYTE OF THE FIELD    01310002
*                                 PDE PASSED TO IKJEGCVT                01320002
TYPE     EQU   X'04'              INDICATES HEXADECIMAL TO IKJEGCVT     01330002
BLANK    EQU   C' '               BLANK                                 01340002
RET16    EQU   16                 USED IN TESTING AND SETTING OF A      01350002
*                                 RETURN CODE OF 16                     01360002
BADESTAE EQU   24                 USED TO PASS BACK A RETURN CODE 24    01362002
REGSMSK  EQU   X'38'              USED TO TEST FOR ADDRESS              01370002
*                                 BEING SPECIFIED AS REGISTER           01380002
HEXTHREE EQU   X'03'              USED TO TEST FOR ADDRESS BEING ON A   01390002
*                                 FULLWORD BOUNDARY                     01400002
INST99   EQU   99                 STAE CODE FOR 'LINK FAILED'           01410002
HEXZERO  EQU   X'0000'            USED TO TEST FOR INDIRECT ADDRESSING  01420002
*                                 AGAINST INDIRECT FIELD OF ADDR PDE    01430002
RETCOD0  EQU    0                 USED TO SET RETURN CODES              01440002
RETCODE8 EQU    8                 USED TO SET AND TEST RETURN CODE 8    01450002
RETCOD12 EQU   12                 USED TO SET RETURN CODE TO            01460002
*                                 IKJPARS TO 12                         01470002
RETCOD20 EQU   20                 USED TO SET THE RETURN CODE TO        01480002
*                                 IKJEGMNL TO 20 INDICATING STAE        01490002
*                                 EXIT ROUTINE WAS ENTERED              01500002
FACTOR   EQU   11                 NUMBER OF BYTES PER SECTION           01510002
*                                 OF CODE IN SUBTAB1                    01520002
LINELGTH EQU   80                 DEFAULT LINE LENGTH FOR TERMINAL      01530002
M0103    EQU   103                MESSAGE NUMBER FOR ERROR MESSAGE      01532002
M0015    EQU   15                 MESSAGE NUMBER FOR ERROR MESSAGE      01534002
M0298    EQU   298                MESSAGE NUMBER FOR ERROR MESSAGE      01536002
M0280    EQU   280                MESSAGE NUMBER FOR ERROR MESSAGE      01538002
I0088    EQU   88                 INSERT NUMBER FOR ERROR MESSAGE       01538402
I0003    EQU   3                  INSERT NUMBER FOR ERROR MESSAGE       01538802
** THE FOLLOWING EQUATES ARE USED IN THE LENGTH FIELDS OF            ** 01540002
** INSTRUCTIONS TO DESCRIBE THE NUMBER OF BYTES TO PROCESS.  THEY ARE** 01550002
** ALSO USED TO INDICATE THE NUMBER OF BYTES A PARTICULAR FIELD IN   ** 01560002
** THE DCB CONTAINS.                                                 ** 01570002
L0       EQU    0                 LENGTH OF 0                           01580002
L1       EQU    1                 LENGTH OF 1                           01590002
L2       EQU    2                 LENGTH OF 2                           01600002
L3       EQU    3                 LENGTH OF 3                           01610002
L4       EQU    4                 LENGTH OF 4                           01620002
L7       EQU    7                 LENGTH OF 7                           01630002
L8       EQU    8                 LENGTH OF 8                           01640002
L9       EQU    9                 LENGTH OF 9                           01650002
L52      EQU   52                 LENGTH OF DCB IN BYTES                01660002
L79      EQU   79                 LENGTH OF 79                          01670002
L159     EQU   159                LENGTH OF 159                         01680002
         EJECT                                                          01690002
         SAVE  (14,12),,*          SAVE IKJEGMNL'S REGISTERS            01700002
         LR    R12,R15             LOAD ADDRESS OF THIS MODULE          01710002
         USING IKJEGDCB,R12        ESTABLISH PROGRAM ADDRESSABILITY     01720002
         USING TCOMTAB,R9          ESTABLISH TCOMTAB ADDRESSABILITY     01730002
         L     R15,REGSAVE2        LOAD ADDRESS OF NEW SAVE AREA        01740002
         ST    R13,D4(R15)         STORE REGISTER 13 IN NEW SAVE AREA   01750002
         ST    R15,D8(R13)         STORE NEW SAVE AREA ADDRESS          01760002
         LR    R13,R15             R13 NOW POINTS TO NEW SAVE AREA      01770002
         L     R6,WORKAREA         LOAD ADDRESS OF TEST WORKAREA        01780002
         USING TSTCWORK,R6         ESTABLISH ADDRESSABILITY             01790002
         LA    R5,CWORKCMD         SKIP CONVERT WORK AREA               01800002
         USING DCBWKARA,R5         ESTABLISH WORKAREA ADDRESSABILITY    01810002
         DROP  R6                  RELEASE R6 FOR LATER USE             01820002
*                                  CSECT                                01850002
         STM   R14,R12,D12(R13)    SAVE LISTDCB'S REGISTERS             01860002
         SPACE                                                          01870002
**********************************************************************  01880002
*                      ISSUE ESTAE                                   *  01890002
**********************************************************************  01900002
         SPACE                                                          01910002
         LA    R15,STAEAREA        GET ADDRESS OF STAE WORKAREA         01950002
         MVC   D0(STAELEN,R15),STAELIST PUT STAE LIST FORM INTO         01960002
*                                  WORKAREA                             01970002
         L     R2,TSTSTAE          GET ADDR OF STAE EXIT ROUTINE        01980002
         ESTAE (R2),CT,PARAM=IKJEGSPL,RECORD=YES,XCTL=NO,MF=(E,(R15))   01990002
         LTR   R15,R15             RETURN CODE ZERO FROM STAE           02000002
SMTSTAE  DS    0H                  SMT LABEL FOR TEST CASE TDCB2700     02010002
         BZ    SETPARSE            YES, CONTINUE PROCESSING             02020002
         STC   R15,TSTESTRC        STORE RETURN CODE FOR MAINLINE       02020402
         LA    R15,BADESTAE        PASS BACK BAD ESTAE RTN CODE (24)    02020802
         B     RETTAB(R15)         RETURN TO CALLER                     02021202
         EJECT                                                          02070002
SETPARSE DS    0H                                                       02080002
**THIS CODE SETS UP TO GO TO IKJPARS TO VALIDITY CHECK THE COMMAND   ** 02090002
**BUFFER.                                                            ** 02100002
         XC    PPLLIST(TYPECODE-PPLLIST),PPLLIST  CLEAR WORKAREA        02110002
         LR    R4,R5               ESTABLISH ADDRESSABILITY TO PARSE    02120002
         USING PPL,R4              PARAMETER LIST                       02130002
         MVC   PPLUPT(L4),TSTUPT   PUT ADDR UPT INTO PARAMETER LIST     02140002
         MVC   PPLECT(L4),TSTECT   PUT ADDR ECT INTO PARAMETER LIST     02150002
         MVC   PPLECB(L4),TSTCPECB PUT ADDR ECB INTO PARAMETER LIST     02160002
         MVC   PPLPCL(L4),PCLADDR  PUT ADDR OF PCL INTO PARAMETER LIST  02170002
         LA    R2,TSTANSPL         PUT POINTER TO ANSWER PLACE INTO     02180002
         ST    R2,PPLANS           PARAMETER LIST TO PARSE              02190002
         MVC   PPLCBUF(L4),INBUF   PUT ADDR OF COMMAND BUFFER INTO      02200002
*                                  PARAMETER LIST FOR PARSE             02210002
         ST    R13,PPLUWA          PUT POINTER TO SAVE AREA INTO LIST   02220002
         LR    R1,R4               REGISTER 1 POINTS TO PARAMETER LIST  02230002
         LINK  EP=IKJPARS,ERRET=LINKFAIL          GO TO PARSE           02240002
PARSBLOW DS    0H                  LABEL USED BY STAE RETRY ROUTINE     02240402
         B     LINKOK              IF CONTROL COMES HERE LINK OK        02242002
LINKFAIL DS    0H                                                       02244002
         LR    R8,R15              TRANSFER RETURN CODE                 02246002
         LR    R6,R1               TRANSFER ABEND CODE                  02248002
         XC    TSTIOPRM,TSTIOPRM   CLEAR PARM LIST                      02248402
         IKJEGSIO SVCERR,SVC=6,ABENDRG=(R6),RC=(R8),INST11=(NUM,I0040),*02248802
               ID=DCB10,MF=(E,TSTIOPRM) CALL I/O FOR ERROR MSG          02249202
         B     RETTAB(R15)         BRANCH INTO RETURN CODE TABLE        02249602
LINKOK   DS    0H                                                       02249702
SMTPARS  DS    0H                  SMT LABEL FOR TEST CASE TDCB2600     02260002
         B     PARSDONE            GO TO PARSDONE                       02270002
         EJECT                                                          02280002
IKJEGDVK DS    0H                                                       02290002
** THIS CODE IS RESPONSIBLE FOR ANALYSING THE PARAMETERS FOR LISTDCB ** 02300002
** AFTER IKJPARS HAS CHECKED THEM FOR SYMTAX ERRORS.  CONTROL IS     ** 02310002
** PASSED TO THIS ROUTINE BY A LINK FROM IKJPARS.                    ** 02320002
         SAVE  (14,12),,*          SAVE PARSE REGISTERS                 02330002
         L     R9,D4(R1)           OBTAIN ADDRESS OF LISTDCB SAVEAREA   02340002
         L     R12,D68(R9)         RESTORE PROGRAM ADDRESSABILITY       02350002
         L     R5,D40(R9)          RESTORE WORKAREA ADDRESSABILITY      02360002
         L     R6,D44(R9)          RESTORE MSG CSECT ADDRESSABILITY     02370002
         L     R9,D56(R9)          RESTORE TCOMTAB ADDRESSABILITY       02380002
         L     R15,REGSAVE3        LOAD SAVE AREA FOR IKJEGCVT          02390002
         ST    R13,D4(R15)         SAVE ADDR OF PARSE'S SAVEAREA        02400002
         ST    R15,D8(R13)         SAVE ADDR OF VALIDITY CHECK RTN'S    02410002
*                                  SAVEAREA IN PARSE'S SAVEAREA         02420002
         LR    R13,R15             LOAD NEW SAVEAREA ADDRESS            02430002
         L     R2,D0(R1)           GET ADDRESS OF PDE                   02440002
         LA    R7,D8(R1)           SAVE ADDR OF 3RD PARAMETER FROM      02450002
*                                  PARSE                                02460002
         OI    TSTFLGS4,TSTVALCK   TURN ON VALIDITY CHECK FLAG FOR I/O  02462002
         SR    R0,R0               ZERO OUT REGISTER FOR NO SECOND LEV  02464002
         L     R15,OUTBUF          PICK UP POINTER TO OUTBUF            02468002
         ST    R0,ZERO(R15)        STORE NO SECOND LEV MSG INDICATOR    02468402
         USING IKJPARMA,R2         ESTABLISH ADDRESSABILITY TO          02470002
*                                  PARAMETER DESCRIPTOR ENTRY (PDE)     02480002
         CLC   PDEINDCT(L2),WORDZERO TEST TO SEE IF INDIRECT            02490002
*                                  ADDRESSING WAS USED                  02500002
         BNE   CONVERT             NO, GO SET UP FOR IKJEGCVT           02510002
         TM    PDEFLG4,REGSMSK     YES, IS TYPE OF ADDR REGISTER        02520002
         BZ    CONVERT             NO, GO SET UP FOR IKJEGCVT           02530002
         XC    TSTIOPRM,TSTIOPRM   CLEAR PARM LIST FOR I/O I/O CALL     02540002
         IKJEGSIO MSG,FIRST=M0101,SECOND=M0268,ID=DCB10,MF=(E,TSTIOPRM) 02550002
         LTR   R15,R15             TEST FOR ERROR                       02552002
         BZ    SET8                OK-GO BACK TO PARSE FOR REENTER      02555202
         B     SET12               NO GO BACK TO MAINLINE THRU PARSE    02556002
CONVERT  DS    0H                                                       02560002
** THIS ROUTINE SETS UP THE PARAMETERS AND THEN GOES TO IKJEGCVT FOR ** 02570002
** BINARY CONVERSION OF THE DCB ADDRESS.                             ** 02580002
         LR    R1,R2               PUT ADDRESS OF ADDR PDE INTO REG 1   02590002
         LNR   R1,R1               NEGATE REGISTER 1 TO INDICATE ADDR   02600002
*                                  CONVERSION                           02610002
         XR    R0,R0               RO IS POSITIVE TO INDICATE BINARY    02620002
*                                  CONVERSION                           02630002
         L     R15,TSTCONVT        OBTAIN ADDR OF ENTRY POINT TO        02640002
*                                  IKJEGCVT FROM TCOMTAB                02650002
         BALR  R14,R15             GO TO IKJEGCVT                       02660002
         LPR   R1,R1               RESET REGISTER 1 TO POSITIVE         02670002
         B     CONVTAB(R15)        BRANCH INTO TABLE INDEXED BY         02680002
*                                  CONTENTS OF REGISTER 15              02690002
CONVTAB  DS    0H                                                       02700002
         B     BOUNDCK             0-CONTINUE PROCESSING                02710002
         B     SETMSG              4-SET BY IKJEGCVT-MOVE MSG ADDR      02720002
         B     SETMSG2             8-SET BY IKJEGSYM-MOVE MSG ADDR      02730002
         B     SETMSG2             12-SET BY IKJEGSYM-MOVE MSG ADDR     02740002
         B     SET12               16-ATTENTION INTERRUPT-RETURN        02750002
         B     SET12               20-IKJEGCVT OR IKJEGSYM BLEW         02760002
         B     SET12               24-IKJEGCVT OR IKJEGSYM BLEW         02762002
SETMSG2  DS    0H                                                       02770002
SET12    DS    0H                                                       02790002
         ST    R15,REG15           SAVE RETURN CODE FOR LATER USE       02800002
         LA    R15,RETCOD12        SET RETURN CODE TO 12                02810002
         B     PARSRTRN            GO RETURN TO IKJPARS                 02820002
SETMSG   DS    0H                                                       02830002
         MVC   D0(L4,R7),PDEUSER   PUT MSG ADDR INTO PARAMETER LIST     02840002
SET8     DS    0H                                                       02850002
         LA    R15,RETCODE8        SET RETURN CODE TO 8                 02860002
         B     PARSRTRN            PREPARE TO RETURN TO IKJPARS         02870002
         SPACE                                                          02880002
BOUNDCK  DS    0H                                                       02890002
         L     R3,PDEUSER          LOAD SAVEPTR (WORD PASSED TO PARSE)  02900002
         TM    PDEFLG5,PDESIB      IF ADDR IS NOT SYMBOLIC              02912002
         BZ    NOSYM               ...THEN BRANCH                       02920002
         L     R3,D0(R3)           ...ELSE GET ADDR FROM SIB            02930002
NOSYM    EQU    *                                                       02940002
         LA    R3,0(,R3)           ZERO HIGH ORDER BYTE                 02942002
         L     R4,REGSAVE2         LOAD ADDR OF LISTDCBS REGISTERS      02950002
         ST    R3,D32(R4)          SAVE CONVERTED ADDRESS IN REG 3      02960002
*                                  FOR MAINLINE CODE                    02970002
         LA    R3,L52(R3)          GET ADDRESS OF END OF DCB            02980002
BOUNDARY DS    0H                                                       02990002
         TM    D35(R4),HEXTHREE    IS ADDRESS ON FULL WORD BOUNDARY     03000002
         BZ    SET0                IF YES, RETURN TO PARSE              03010002
         XC    TSTIOPRM,TSTIOPRM   CLEAR I/O PARM LIST                  03020002
         IKJEGSIO MSG,FIRST=M0101,INST11=(APDE,(R2)),  CALL I/O        *03030002
               INST21=(NUM,I0003),SECOND=M0280,ID=DCB10,MF=(E,TSTIOPRM) 03040002
         LTR   R15,R15             TEST FOR ERROR                       03052002
         BZ    SET8                OK-GO BACK TO PARSE FOR REENTER      03060002
         B     SET12               NO GO BACK TO MAINLINE THRU PARSE    03070002
SET0     DS    0H                                                       03410002
         XR    R15,R15             INDICATE PARAMETER IS VALID          03420002
PARSRTRN DS    0H                                                       03430002
         DROP  R2                  RELEASE ADDRESSABILITY TO ADDR PDE   03440002
         L     R6,OUTBUF           PICK UP ADDRESS OF OUTBUF            03442002
         LH    R5,ZERO(R6)         PICK UP MESSAGE LENGTH IF ONE        03444002
         LTR   R5,R5               SEE IF THERE IS A MESSAGE            03446002
         BZ    NO2NDLEV            BRANCH AROUND NEXT INST. IF NONE     03448002
         ST    R6,ZERO(R7)         PASS 2ND MSG ADDRESS TO PARSE        03448802
NO2NDLEV DS    0H                                                       03449202
         NI    TSTFLGS4,HEXFF-TSTVALCK TURN OFF VALIDITY CHECK BIT      03449602
         L     R13,D4(R13)         RESTORE ADDRESS OF PARSE SAVEAREA    03450002
         RETURN (14,12),,RC=(15)   RESTORE REGISTERS AND RETURN         03460002
         EJECT                                                          03480002
*********************************************************************** 03490002
*        THE FOLLOWING CODE IS EXECUTED UPON COMPLETION OF IKJPARS    * 03500002
*********************************************************************** 03510002
PARSDONE DS    0H                                                       03520002
** THE FOLLOWING IS A BRANCH TABLE USED TO DETERMINE WHERE CONTROL   ** 03530002
** SHOULD BE GIVEN AFTER RETURNING FROM IKJPARS.                     ** 03540002
         B     PARSTAB(R15)       BRANCH TO TABLE INDEXED BY CONTENTS   03550002
*                                 OF REGISTER 15                        03560002
PARSTAB  DS    0H                                                       03570002
         B     PDLADDR            RETURN CODE 0-CONTINUE PROCESSING     03580002
         B     FLUSHIT            RETURN CODE 4-GO BACK TO IKJEGMNL     03590002
         B     DCBRC16            RETURN CODE 8-ATTENTION INTERRUPT     03600002
         B     PARMSG2            RETURN CODE 12-GO WRITE MESSAGE       03610002
         B     PARMSG3            RETURN CODE 16-GO WRITE MESSAGE       03620002
         B     CHKRET             RETURN CODE 20-GO CHECK FOR CODE      03630002
PARMSG2  DS    0H                                                       03640002
** THIS SETS UP TO WRITE MESSAGES IKJ57206I                         **  03650002
         XC    TSTIOPRM,TSTIOPRM  CLEAR I/O PARM LIST                   03660002
         IKJEGSIO MSG,FIRST=M0104,INST11=(NUM,I0007),SECOND=M0277,     *03674002
               ID=DCB10,MF=(E,TSTIOPRM) CALL I/O TO ISSUE ERROR MSG     03674402
         B     RETTAB(R15)        BRANCH INTO RTN CODE TABLE            03674802
PARMSG3  DS    0H                                                       03676002
         LA    R4,M0103           GET MESSAGE NUMBER INTO PARM REG      03678002
         B     MSGERR             GO ISSUE ERROR MESSAGE TO TERM        03678402
PDLADDR  DS    0H                                                       03680002
         L     R8,TSTANSPL        OBTAIN ADDRESS OF PARSE PARAMETER     03700002
*                                 DESCRIPTOR LIST (PDL)                 03710002
         USING IKJPARMD,R8        ESTABLISH PDL ADDRESSABILITY          03720002
         EJECT                                                          03730002
FIELDCHK DS    0H                                                       03740002
** THIS CODE TESTS TO SEE IF THE FIELD PARAMETER WAS CODED ON THE    ** 03750002
** CONTROL STATEMENT.                                                ** 03760002
         USING IHADCB,R3          ESTABLISH ADDRESSABILITY TO DCB       03770002
         CLC   DCBFIELD(L2),WORDZERO WAS FIELD PARAMETER SPECIFIED      03780002
         BNE   SCANPDES           YES, GO SCAN DCBFIELDS                03790002
         OI    OUTPUTSW,ALLCHECK  NO, INDICATE ALL DCBFIELDS ARE TO BE  03800002
*                                 OUTPUTTED                             03810002
         MVI   RELAD,HEXFF        SET THE FIRST PARSE DESCRIPTOR        03820002
*                                 ENTRY (PDE) TO NON ZERO               03830002
         MVC   RELAD+D1(PDELEN),RELAD  SET REMAINING PDES NON ZERO      03840002
         MVC   FTEK(L4),WORDZERO  ZERO DCBFTEK AND DCBBFALN PDES        03850002
         TM    DCBOFLGS,HEX10     IS THIS AN OPEN DCB                   03860002
         BZ    CLOSED             NO, GO HANDLE FOR CLOSED              03870002
         MVI   DDNAM,HEXZERO      YES, ZERO OUT PDES DESCRIBING A       03880002
         MVC   DDNAM+D1(L7),DDNAM CLOSED DCB                            03890002
         B     PRINTCHK           GO SEE IF PRINT WAS SPECIFIED         03900002
CLOSED   DS    0H                                                       03910002
         MVI   TIOT,ZERO          ZERO OUT PDES DESCRIBING AN           03920002
         MVC   TIOT+D1(L9),TIOT   OPEN DCB                              03930002
         B     PRINTCHK           GO SEE IF PRINT WAS SPECIFIED         03940002
SCANPDES DS    0H                                                       03950002
         CLC   OFLGS(L2),WORDZERO WAS DCBOFLGS SPECIFIED                03960002
         BE    TRIHDR             NO, GO CHECK COMMON HEADER FIELD      03970002
         TM    DCBOFLGS,HEX10     YES, IS THIS AN OPEN DCB              03980002
         BZ    TRIHDR             NO, GO CHECK COMMON HEADER FIELD      03990002
         MVC   OFLGS(L2),WORDZERO YES, TURN OFF CLOSED DCBOFLGS PDE     04000002
         MVC   OFLGS2(L2),HEXFFFF TURN ON OPEN DCBOFLGS PDE             04010002
TRIHDR   DS    0H                                                       04020002
** THIS CODE TESTS TO SEE IF ONE OF THE FOLLOWING OR ALL OF THE      ** 04030002
** FOLLOWING FIELDS ARE SPECIFIED- DCBHIARC,DCBFTEK OR DCBBFALN      ** 04040002
** THE CODE WILL LEAVE ONE OF THE PDES ON TO BE PROCESSED AND WILL   ** 04050002
** TURN THE REST OF THEM OFF.  THIS IS TO AVOID OUTPUTTING THE SAME  ** 04060002
** FIELD THREE TIMES.                                                ** 04070002
         CLC   HIARC(L2),WORDZERO WAS THE DCBHIARC FIELD SPECIFIED      04080002
         BNE   CLEAR2             YES, CLEAR DCBFTEK AND DCBBFALN PDES  04090002
         CLC   FTEK(L2),WORDZERO  WAS THE DCBFTEK FIELD SPECIFIED       04100002
         BE    PRINTCHK           NO, GO SEE IF PRINT WAS SPECIFIED     04110002
         MVC   BFALN(L2),WORDZERO YES, ZERO OUT DCBBFALN PDE            04120002
         B     PRINTCHK           GO SEE IF PRINT WAS SPECIFIED         04130002
CLEAR2   DS    0H                                                       04140002
         MVC   FTEK(L4),WORDZERO  CLEAR DCBFTEK AND DCBBFALN PDES       04150002
         EJECT                                                          04160002
PRINTCHK DS    0H                                                       04170002
** THIS CODE IS RESPONSIBLE FOR DETERMINING IF THE PRINT PARAMETER   ** 04180002
** WAS SPECIFED.                                                     ** 04190002
         CLC   PRINT(L2),WORDZERO WAS PRINT SPECIFIED                   04200002
         BNE   PRNTSPEC           YES, PDE NON ZERO BRANCH              04210002
         NI    TSTFLGS1,(HEXFF-TSTPRINT)     INITIALIZE OUTPUT FLAGS    04220002
*                                 IN TCOMTAB                            04230002
         B     TABLESCN           GO DETERMINE LENGTH OF OUTPUT LINE    04240002
PRNTSPEC DS    0H                                                       04250002
** THIS CODE IS EXECUTED WHEN THE USER HAS SPECIFIED AN OUTPUT DATA  ** 04260002
** SET.  IT SAVES THE ADDRESS OF THE DSNAME PDE FOUND IN THE PDL     ** 04270002
** PASSED BY PARSE AND SETS A FLAG IN TCOMTAB TO INDICATE THIS       ** 04280002
** CONDITION TO IKJEGIO.                                             ** 04290002
         LA    R2,DSNAM           LOAD ADDRESS OF DSNAME PDE            04300002
         OI    TSTFLGS1,TSTPRINT  SET FLAG IN TCOMTAB TO INDICATE       04310002
*                                 USER SPECIFIED OUTPUT DATA SET        04320002
         ST    R2,PRINTFLG        STORE ADDR OF DSNAME PDE              04330002
TABLESCN DS    0H                                                       04340002
** THIS CODE IS RESPONSIBLE FOR DETERMINING THE LENGTH OF THE OUTPUT ** 04350002
** LINE.  THE DEFAULT IS 80 IF THE USER SPECIFIED AN OUTPUT LINE     ** 04360002
** GREATER THAN 80 OR LESS THAN 40.  IKJEGDCB TRIES TO GIVE A GOOD   ** 04370002
** FORMAT FOR THOSE OUTPUT LINES IN THE RANGE OF 40 TO 80.           ** 04380002
         LA    R4,LINELGTH        LOAD DEFAULT LINE LENGTH              04390002
         CH    R4,TMPLL           COMPARE TO TERMINAL LINE LENGTH       04400002
         BNH   LINESET            BRANCH IF 80 IS LOW OR EQUAL TO       04410002
*                                 TERMINAL LINE LENGTH                  04420002
         LA    R4,D40                                                   04430002
         CH    R4,TMPLL           COMPARE 40 WITH TMP LINE LENGTH       04440002
         BH    DEFAULT            BRANCH IF 40 IS HIGHER THAN TERMINAL  04450002
*                                 LINE LENGTH                           04460002
         LH    R4,TMPLL           USE SPECIFIED LINE LENGTH             04470002
         B     LINESET            GO SET LINE LENGTH                    04480002
DEFAULT  DS    0H                                                       04490002
         LA    R4,LINELGTH        DEFAULT LINE LENGTH                   04500002
LINESET  DS    0H                                                       04510002
         STH   R4,LINELEN         STORE OUTPUT LINE LENGTH              04520002
         L     R10,OUTBUF         GET ADDRESS OF OUTPUT BUFFER          04530002
         MVI   D4(R10),BLANK      BLANK OUT OUTPUT BUFFER               04540002
         MVC   D5(L159,R10),D4(R10)                                     04550002
         XC    D0(L4,R10),D0(R10) CLEAR 1ST 4 BYTES OF OUTBUF           04560002
         LA    R2,OFLGS2+D2       GET ADDRESS OF END OF DSECT           04570002
         ST    R2,ENDEND          STORE LAST PDE ADDRESS+2              04580002
         XR    R2,R2              INITIALIZE LENGTH OF OUTPUT TO ZERO   04590002
         LA    R6,RELAD           POINT TO FIRST PDE                    04600002
         EJECT                                                          04610002
PDECHECK DS    0H                                                       04620002
         CLC   D0(L2,R6),WORDZERO IS THIS FIELD DESIRED                 04630002
         BNE   SBRTNSVR           BRANCH IF DESIRED                     04640002
PDECHK   DS    0H                                                       04650002
         LA    R6,D2(R6)          NO, POINT TO NEXT PDE                 04660002
         C     R6,ENDEND          ARE THERE MORE PDE'S                  04670002
         BE    PDLEND             NO, GO TO END PROCESSING              04680002
         B     PDECHECK           YES, CHECK NEXT PDE                   04690002
SBRTNSVR DS    0H                                                       04700002
         LR    R11,R6             PRESERVE R6                           04710002
         LA    R7,RELAD           ADDRESS OF FIRST PDE                  04720002
         SR    R11,R7             FIND RELATIVE POSITION OF PDE         04730002
         LA    R10,FACTOR         LOAD MULTIPLICATION FACTOR            04740002
         LA    R7,SUBTAB1         LOAD ADDRESS OF TABLE                 04750002
         MR    R10,R10            COMPUTE PROPER OFFSET                 04760002
         AR    R7,R11             ADD OFFSET TO BASE                    04770002
         BR    R7                 GO TO PROPER SUBROUTINE               04780002
         SPACE                                                          04790002
*********************************************************************** 04800002
* THE FOLLOWING CODE CONSISTS OF 27 SUBROUTINES CORRESPONDING TO THE  * 04810002
* FIELDS OF DCB.  EACH SUBROUTINE MOVES THE RELATIVE ADDRESS, FIELD   * 04820002
* LENGTH, HEADER LENGTH, AND HEADER TO A COMMON BUFFER.  CONTROL IS   * 04830002
* THEN PASSED EITHER TO THE CONVERSION ROUTINE OR TO A HEADER OUTPUT  * 04840002
* ROUTINE AND THEN TO A CONVERSION ROUTINE.  THE SUBROUTINE FOR DDNAM * 04850002
* WILL PASS CONTROL TO A VALIDITY CHECKING ROUTINE.  IT IS ESSENTIAL  * 04860002
* FOR PROPER LOGIC FLOW THAT EACH SUBROUTINE HAVE THE SAME LENGTH.    * 04870002
*********************************************************************** 04880002
         SPACE                                                          04890002
SUBTAB1  DS    0H                                                       04900002
**THE FOLLOWING CODE SETS UP FOR FIELDS IN THE DEVICE INTERFACE         04910002
DSRELAD  EQU    *                                                       04920002
         MVC   HDRBUFFR(L'HDRRELAD),HDRRELAD  MOVE HEADING IN           04930002
         MVI   HDRLENTH,L'HDRRELAD MOVE LENGTH OF HEADER IN             04940002
         MVI   FLDLENTH,L4         MOVE IN FIELD LENGTH                 04950002
         LA    R4,DCBRELAD         MOVE IN RELATIVE ADDRESS             04960002
         B     HDROUTPT            GO WRITE SECTION HDR OUT             04970002
DSKEYCN  EQU    *                                                       04980002
         MVC   HDRBUFFR(L'HDRKEYCN),HDRKEYCN MOVE HEADING IN            04990002
         MVI   HDRLENTH,L'HDRKEYCN MOVE LENGTH OF HEADER IN             05000002
         MVI   FLDLENTH,L1         MOVE IN FIELD LENGTH                 05010002
         LA    R4,DCBKEYCN         MOVE IN RELATIVE ADDRESS             05020002
         B     CVTANDIO            GO SET UP FOR CONVERSION             05030002
DSFDAD   EQU    *                                                       05040002
         MVC   HDRBUFFR(L'HDRFDAD),HDRFDAD  MOVE IN HEADING             05050002
         MVI   HDRLENTH,L'HDRFDAD  MOVE LENGTH OF HEADER IN             05060002
         MVI   FLDLENTH,L8         MOVE IN FIELD LENGTH                 05070002
         LA    R4,DCBFDAD          MOVE IN RELATIVE ADDRESS             05080002
         B     CVTANDIO            GO SET UP FOR CONVERSION             05090002
DSDVTBL  EQU    *                                                       05100002
         MVC   HDRBUFFR(L'HDRDVTBL),HDRDVTBL  MOVE HEADING IN           05110002
         MVI   HDRLENTH,L'HDRDVTBL MOVE LENGTH OF HEADER IN             05120002
         MVI   FLDLENTH,L3         MOVE LENGTH OF FIELD IN              05130002
         LA    R4,DCBDVTBL+D1      MOVE IN RELATIVE ADDRESS             05140002
         B     CVTANDIO            GO SET UP FOR CONVERSION             05150002
DSKEYLE  EQU    *                                                       05160002
         MVC   HDRBUFFR(L'HDRKEYLE),HDRKEYLE   MOVE HEADING IN          05170002
         MVI   HDRLENTH,L'HDRKEYLE MOVE LENGTH OF HEADING IN            05180002
         MVI   FLDLENTH,L1         MOVE IN FIELD LENGTH                 05190002
         LA    R4,DCBKEYLE         MOVE IN RELATIVE ADDRESS             05200002
         B     CVTANDIO            GO SET UP FOR CONVERSION             05210002
DSDEVT   EQU    *                                                       05220002
         MVC   HDRBUFFR(L'HDRDEVT),HDRDEVT  MOVE HEADING IN             05230002
         MVI   HDRLENTH,L'HDRDEVT  MOVE LENGTH OF HEADING IN            05240002
         MVI   FLDLENTH,L1         MOVE LENGTH OF FIELD IN              05250002
         LA    R4,DCBDEVT          MOVE IN RELATIVE ADDRESS             05260002
         B     CVTANDIO            GO SET UP FOR CONVERSION             05270002
DSTRBAL  EQU    *                                                       05280002
         MVC   HDRBUFFR(L'HDRTRBAL),HDRTRBAL  MOVE HEADING IN           05290002
         MVI   HDRLENTH,L'HDRTRBAL MOVE LENGTH OF HEADING IN            05300002
         MVI   FLDLENTH,L2         MOVE LENGTH OF FIELD IN              05310002
         LA    R4,DCBTRBAL         MOVE IN RELATIVE ADDRESS             05320002
         B     CVTANDIO            GO SET UP FOR CONVERSION             05330002
**THE FOLLOWING CODE SETS UP FOR FIELDS IN THE COMMON INTERFACE         05340002
DSBUFNO  EQU    *                                                       05350002
         MVC   HDRBUFFR(L'HDRBUFNO),HDRBUFNO  MOVE HEADING IN           05360002
         MVI   HDRLENTH,L'HDRBUFNO MOVE LENGTH OF HEADING IN            05370002
         MVI   FLDLENTH,L1         MOVE IN FIELD LENGTH                 05380002
         LA    R4,DCBBUFNO         MOVE IN RELATIVE ADDRESS             05390002
         B     HDROUTPT            GO WRITE SECTION HEADER OUT          05400002
DSBUFCB  EQU    *                                                       05410002
         MVC   HDRBUFFR(L'HDRBUFCB),HDRBUFCB   MOVE HEADING IN          05420002
         MVI   HDRLENTH,L'HDRBUFCB MOVE LENGTH OF HEADING IN            05430002
         MVI   FLDLENTH,L3         MOVE LENGTH OF FIELD IN              05440002
         LA    R4,DCBBUFCB+D1      MOVE IN RELATIVE ADDRESS             05450002
         B     CVTANDIO            GO SET UP FOR CONVERSION             05460002
DSBUFL   EQU    *                                                       05470002
         MVC   HDRBUFFR(L'HDRBUFL),HDRBUFL  MOVE HEADING IN             05480002
         MVI   HDRLENTH,L'HDRBUFL  MOVE LENGTH OF HEADING IN            05490002
         MVI   FLDLENTH,L2         MOVE LENGTH OF FIELD IN              05500002
         LA    R4,DCBBUFL          MOVE IN RELATIVE ADDRESS             05510002
         B     CVTANDIO            GO SET UP FOR CONVERSION             05520002
DSDSORG  EQU    *                                                       05530002
         MVC   HDRBUFFR(L'HDRDSORG),HDRDSORG  MOVE HEADING IN           05540002
         MVI   HDRLENTH,L'HDRDSORG MOVE LENGTH OF HEADING IN            05550002
         MVI   FLDLENTH,L2         MOVE LENGTH OF FIELD IN              05560002
         LA    R4,DCBDSORG         MOVE IN RELATIVE ADDRESS             05570002
         B     CVTANDIO            GO SET UP FOR CONVERSION             05580002
DSIOBAD  DS    0H                                                       05590002
         MVC   HDRBUFFR(L'HDRIOBAD),HDRIOBAD  MOVE HEADING IN           05600002
         MVI   HDRLENTH,L'HDRIOBAD MOVE LENGTH OF HEADING IN            05610002
         MVI   FLDLENTH,L4         MOVE LENGTH OF FIELD IN              05620002
         LA    R4,DCBIOBAD         MOVE IN RELATIVE ADDRESS             05630002
         B     CVTANDIO            GO SET UP FOR CONVERSION             05640002
**THE FOLLOWING CODE SETS UP FOR FIELDS IN THE FOUNDATION EXTENSION     05650002
DSHIARC  DS    0H                                                       05660002
         MVC   HDRBUFFR(L'HDRHIARC),HDRHIARC  MOVE HEADING IN           05670002
         MVI   HDRLENTH,L'HDRHIARC MOVE LENGTH OF HEADING IN            05680002
         MVI   FLDLENTH,L1         MOVE LENGTH OF FIELD IN              05690002
         LA    R4,DCBBFTEK         MOVE IN RELATIVE ADDRESS             05700002
         B     HDROUTPT            GO WRITE SECTION HEADER OUT          05710002
DSBFTEK  DS    0H                                                       05720002
         MVC   HDRBUFFR(L'HDRBFTEK),HDRBFTEK  MOVE HEADING IN           05730002
         MVI   HDRLENTH,L'HDRBFTEK MOVE LENGTH OF HEADER IN             05740002
         MVI   FLDLENTH,L1         MOVE IN FIELD LENGTH                 05750002
         LA    R4,DCBBFTEK         MOVE IN RELATIVE ADDRESS             05760002
         B     CVTANDIO            GO SET UP FOR CONVERSION             05770002
DSBFALN  DS    0H                                                       05780002
         MVC   HDRBUFFR(L'HDRBFALN),HDRBFALN  MOVE HEADING IN           05790002
         MVI   HDRLENTH,L'HDRBFALN MOVE LENGTH OF HEADING IN            05800002
         MVI   FLDLENTH,L1         MOVE IN FIELD LENGTH                 05810002
         LA    R4,DCBBFALN         MOVE IN RELATIVE ADDRESS             05820002
         B     CVTANDIO            GO SET UP FOR CONVERSION             05830002
DSEODAD  DS    0H                                                       05840002
         MVC   HDRBUFFR(L'HDREODAD),HDREODAD  MOVE HEADING IN           05850002
         MVI   HDRLENTH,L'HDREODAD MOVE LENGTH OF HEADING IN            05860002
         MVI   FLDLENTH,L3         MOVE IN FIELD LENGTH                 05870002
         LA    R4,DCBEODAD+D1      MOVE IN RELATIVE ADDRESS             05880002
         B     CVTANDIO            GO SET UP FOR CONVERSION             05890002
DSRECFM  DS    0H                                                       05900002
         MVC   HDRBUFFR(L'HDRRECFM),HDRRECFM  MOVE HEADING IN           05910002
         MVI   HDRLENTH,L'HDRRECFM MOVE LENGTH OF HEADING IN            05920002
         MVI   FLDLENTH,L1         MOVE IN FIELD LENGTH                 05930002
         LA    R4,DCBRECFM         MOVE IN RELATIVE ADDRESS             05940002
         B     CVTANDIO            GO SET UP FOR CONVERSION             05950002
DSEXLST  DS    0H                                                       05960002
         MVC   HDRBUFFR(L'HDREXLST),HDREXLST  MOVE HEADING IN           05970002
         MVI   HDRLENTH,L'HDREXLST MOVE IN LENGTH OF HEADING            05980002
         MVI   FLDLENTH,L3         MOVE IN FIELD LENGTH                 05990002
         LA    R4,DCBEXLST+D1      MOVE IN RELATIVE ADDRESS             06000002
         B     CVTANDIO            GO SET UP FOR CONVERSION             06010002
**THE FOLLOWING CODE SETS UP FOR FIELDS IN A CLOSED FOUNDATION          06020002
DSDDNAM  DS    0H                                                       06030002
         MVC   HDRBUFFR(L'HDRDDNAM),HDRDDNAM  MOVE HEADING IN           06040002
         MVI   HDRLENTH,L'HDRDDNAM MOVE LENGTH OF HEADING IN            06050002
         MVI   FLDLENTH,L8         MOVE IN FIELD LENGTH                 06060002
         LA    R4,DCBDDNAM         MOVE IN RELATIVE ADDRESS             06070002
         B     HDROUTPT            GO WRITE SECTION HEADER OUT          06080002
DSOFLG1  DS    0H                                                       06090002
         MVC   HDRBUFFR(L'HDROFLGS),HDROFLGS MOVE HEADING IN            06100002
         MVI   HDRLENTH,L'HDROFLGS MOVE LENGTH OF HEADING IN            06110002
         MVI   FLDLENTH,L1         MOVE IN FIELD LENGTH                 06120002
         LA    R4,DCBOFLGS         MOVE IN RELATIVE ADDRESS             06130002
         B     CVTANDIO            GO SET UP FOR CONVERSION             06140002
DSIFLG   DS    0H                                                       06150002
         MVC   HDRBUFFR(L'HDRIFLG),HDRIFLG  MOVE HEADING IN             06160002
         MVI   HDRLENTH,L'HDRIFLG  MOVE LENGTH OF HEADING IN            06170002
         MVI   FLDLENTH,L1         MOVE IN FIELD LENGTH                 06180002
         LA    R4,DCBIFLG          MOVE IN RELATIVE ADDRESS             06190002
         B     CVTANDIO            GO SET UP FOR CONVERSION             06200002
DSMACR   DS    0H                                                       06210002
         MVC   HDRBUFFR(L'HDRMACR),HDRMACR  MOVE HEADING IN             06220002
         MVI   HDRLENTH,L'HDRMACR  MOVE LENGTH OF HEADING IN            06230002
         MVI   FLDLENTH,L2         MOVE IN FIELD LENGTH                 06240002
         LA    R4,DCBMACR          MOVE IN RELATIVE ADDRESS             06250002
         B     CVTANDIO            GO SET UP FOR CONVERSION             06260002
**THE FOLLOWING CODE SETS UP FOR FIELDS IN AN OPEN FOUNDATION           06270002
DSTIOT   DS    0H                                                       06280002
         MVC   HDRBUFFR(L'HDRTIOT),HDRTIOT  MOVE HEADING IN             06290002
         MVI   HDRLENTH,L'HDRTIOT  MOVE LENGTH OF HEADING IN            06300002
         MVI   FLDLENTH,L2         MOVE IN FIELD LENGTH                 06310002
         LA    R4,DCBTIOT          MOVE IN RELATIVE ADDRESS             06320002
         B     HDROUTPT            GO WRITE SECTION HEADER OUT          06330002
DSMACRF  DS    0H                                                       06340002
         MVC   HDRBUFFR(L'HDRMACRF),HDRMACRF  MOVE HEADING IN           06350002
         MVI   HDRLENTH,L'HDRMACRF MOVE LENGTH OF HEADING IN            06360002
         MVI   FLDLENTH,L2         MOVE IN FIELD LENGTH                 06370002
         LA    R4,DCBMACRF         MOVE IN RELATIVE ADDRESS             06380002
         B     CVTANDIO            GO SET UP FOR CONVERSION             06390002
DSIFLGS  DS    0H                                                       06400002
         MVC   HDRBUFFR(L'HDRIFLGS),HDRIFLGS  MOVE HEADING IN           06410002
         MVI   HDRLENTH,L'HDRIFLGS MOVE LENGTH OF HEADING IN            06420002
         MVI   FLDLENTH,L1         MOVE IN FIELD LENGTH                 06430002
         LA    R4,DCBIFLGS         MOVE IN RELATIVE ADDRESS             06440002
         B     CVTANDIO            GO SET UP FOR CONVERSION             06450002
DSDEBAD  DS    0H                                                       06460002
         MVC   HDRBUFFR(L'HDRDEBAD),HDRDEBAD  MOVE HEADING IN           06470002
         MVI   HDRLENTH,L'HDRDEBAD MOVE IN LENGTH OF HEADING            06480002
         MVI   FLDLENTH,L3         MOVE IN FIELD LENGTH                 06490002
         LA    R4,DCBDEBAD+D1      MOVE IN RELATIVE ADDRESS             06500002
         B     CVTANDIO            GO SET UP FOR CONVERSION             06510002
DSOFLG2  DS    0H                                                       06520002
         MVC   HDRBUFFR(L'HDROFLGS),HDROFLGS MOVE HEADING IN            06530002
         MVI   HDRLENTH,L'HDROFLGS MOVE LENGTH OF HEADING IN            06540002
         MVI   FLDLENTH,L1         MOVE IN FIELD LENGTH                 06550002
         LA    R4,DCBOFLGS         MOVE IN RELATIVE ADDRESS             06560002
         B     CVTANDIO            GO SET UP FOR CONVERSION             06570002
         EJECT                                                          06580002
**  THE FOLLOWING CODE OUTPUTS THE SECTION HEADERS                   ** 06590002
HDROUTPT DS    0H                                                       06600002
         TM    OUTPUTSW,ALLCHECK   ARE ALL THE FIELDS TO BE OUTPUTTED   06610002
         BZ    DDCHECK2            NO, GO CHECK FOR DDNAME PDE          06620002
         LTR   R2,R2               YES, IS THERE PREVIOUS OUTPUT        06630002
         BZ    CONTINUE            NO, GO PREPARE HEADER                06640002
         L     R10,OUTBUF          YES, POINT TO OUTPUT BUFFER          06650002
         LA    R14,D4(R2)          SET LENGTH OF OUTPUT                 06660002
         STH   R14,D0(R10)         STORE LENGTH IN OUTPUT BUFFER        06670002
         OI    OUTPUTSW,HDRCHECK   INDICATE HEADER BEING OUTPUTTED      06680002
         OI    OUTPUTSW,SECHDRCK   INDICATE SECTION HEADER IS TO BE     06690002
*                                  OUTPUTTED                            06700002
         BAL   R14,DCBIO           GO SET UP PARAMETER LIST FOR I/O     06710002
         XR    R2,R2               RESET OUTPUT COUNTER                 06720002
CONTINUE DS    0H                                                       06730002
         XR    R11,R11             CLEAR A REGISTER                     06740002
         IC    R11,HDRCOUNT        LOAD OFFSET TO PROPER INSTRUCTION    06750002
         LA    R7,D14(R11)         POINT TO NEXT HEADER                 06760002
         STC   R7,HDRCOUNT         SET COUNTER FOR NEXT HEADER          06770002
         LA    R7,HDRTAB           POINT TO TABLE                       06780002
         AR    R7,R11              ADD OFFSET TO TABLE ADDRESS          06790002
         L     R10,OUTBUF          POINT TO OUTPUT BUFFER               06800002
         BR    R7                  GO MOVE HEADER TO OUTPUT BUFFER      06810002
HDRTAB   DS    0H                                                       06820002
         MVC   D4(L'HEADER1,R10),HEADER1  MOVE HEADER TO BUFFER         06830002
         LA    R14,L'HEADER1       STORE LENGTH                         06840002
         B     HDRIO               GO OUTPUT HEADER                     06850002
         MVC   D4(L'HEADER2,R10),HEADER2  MOVE HEADER TO BUFFER         06860002
         LA    R14,L'HEADER2       STORE LENGTH                         06870002
         B     HDRIO               GO OUTPUT HEADER                     06880002
         MVC   D4(L'HEADER3,R10),HEADER3  MOVE HEADER TO BUFFER         06890002
         LA    R14,L'HEADER3       STORE LENGTH                         06900002
         B     HDRIO               GO OUTPUT HEADER                     06910002
         MVC   D4(L'HEADER4,R10),HEADER4  MOVE HEADER TO BUFFER         06920002
         LA    R14,L'HEADER4       STORE LENGTH                         06930002
HDRIO    DS    0H                                                       06940002
         LA    R14,D4(R14)         SET LENGTH OF OUTPUT                 06950002
         NI    OUTPUTSW,HEXCF      TURN OFF FIELD AND HEADER SWITCHES   06960002
         STH   R14,D0(R10)         PUT LENGTH AT BEGINNING OF BUFFER    06970002
         BAL   R14,DCBIO           GO PUT OUT THE HEADER                06980002
DDCHECK2 DS    0H                                                       06990002
         LA    R11,DDNAM           GET ADDRESS OF DCBDDNAM PDE          07000002
         CR    R6,R11              IS THIS DDNAM FIELD                  07010002
         BE    TRNSLATE            IF YES GO VALIDITY CHECK THE FIELD   07020002
         EJECT                                                          07030002
*********************************************************************** 07040002
* THE FOLLOWING CODE WILL SET UP CONVERSION AND OUTPUT OF REQUESTED   * 07050002
* FIELDS.  WHEN SECTION IS REACHED, RELATIVE ADDRESS, FIELD LENGTH    * 07060002
* HEADER LENGTH, AND HEADER WILL BE IN THE COMMON BUFFERS.            * 07070002
*********************************************************************** 07080002
         SPACE                                                          07090002
CVTANDIO DS    0H                                                       07100002
         XR    R7,R7                                                    07110002
         XR    R10,R10                                                  07120002
         SR    R0,R0               ZERO OUT REGISTER                    07130002
         OI    OUTPUTSW,HDRCHECK   TURN ON FIELD HEADER SWITCH          07140002
         IC    R7,FLDLENTH         LOAD FIELD LENGTH                    07150002
         ST    R0,HDROFFST         CLEAR OUT HDROFFST AND FLDOFFST      07160002
         IC    R10,HDRLENTH        LOAD HEADER LENGTH                   07170002
         AR    R7,R7               DOUBLE FOR TRUE PRINTABLE LENGTH     07180002
         LR    R0,R10              LOAD HEADER LENGTH                   07190002
         SR    R0,R7               DIFFERENCE BETWEEN HEADER AND FIELD  07200002
         LPR   R0,R0               ASSURE THAT DIFFERENCE IS POSITIVE   07210002
         SRL   R0,D1               SHIFT TO DIVIDE BY TWO               07220002
         CR    R7,R10              WHICH IS LONGER                      07230002
         BH    FLDLONGR            IF FIELD IS LONGER, BRANCH           07240002
         STH   R0,FLDOFFST         STORE IN WORK AREA                   07250002
         SR    R0,R0               CLEAR OUT REGISTER                   07260002
         LR    R7,R10              R7 NOW CONTAINS OUTPUT LENGTH        07270002
FLDLONGR DS    0H                                                       07280002
         STH   R0,HDROFFST         STORE IN WORK AREA                   07290002
         AR    R7,R2               COMPUTE TENTATIVE OUTPUT LENGTH      07300002
         CH    R7,LINELEN          IS FIELD LONGER THAN OUTPUT LINE     07310002
         BNH   MOREROOM            BRANCH IF THE FIELD CAN FIT          07320002
         L     R11,OUTBUF          OBTAIN ADDRESS OF OUTBUF             07330002
         LA    R10,D2(R2)          ADD TWO BYTES TO LENGTH OF OUTPUT    07340002
         STH   R10,D0(R11)         STORE LENGTH OF OUTPUT               07350002
         BAL   R14,DCBIO           GO OUTPUT LINES                      07360002
         SR    R7,R2               RESET LENGTH OF CURRENT FIELD        07370002
         XR    R2,R2               RESET LINE TO ZERO                   07380002
         OI    OUTPUTSW,HDRCHECK   TURN ON FIELD HEADER SWITCH          07390002
         EJECT                                                          07400002
*********************************************************************** 07410002
* THE FOLLOWING IS REACHED WHEN THERE IS MORE ROOM IN OUTPUT BUFFER   * 07420002
* IT SETS UP FOR IKJEGCVT WHICH WILL CONVERT THE FIELD AND MOVE THE   * 07430002
* HEADER AND FIELD TO THE PROPER BUFFERS.                             * 07440002
*********************************************************************** 07450002
MOREROOM DS    0H                                                       07460002
         SR    R7,R2                                                    07470002
         MVI   CVTLL,HEXZERO      ZERO OUT 1ST BYTE OF LENGTH           07480002
         MVC   CVTLL+D1(L1),FLDLENTH  MOVE LENGTH OF FIELD INTO         07490002
*                                 PARAMETER LIST                        07500002
         ST    R4,STRNGPTR        STORE POINTER TO FIELD CONTENTS       07510002
         MVI   FLAGS,FLAG         MOVE FLAG TO PARAMETER LIST           07520002
         MVI   TYPECODE,TYPE      MOVE TYPE CODE (HEX) TO LIST          07530002
         LNR   R0,R7              INDICATE CONVERSION TO PRINTABLE      07540002
         LA    R1,STRNGPTR        LOAD ADDRESS OF PARAMETER LIST        07550002
         L     R15,TSTCONVT       LOAD ADDRESS OF IKJEGCVT              07560002
         BALR  R14,R15            GO CONVERT THE FIELD                  07570002
         LPR   R0,R0              RESTORE REGISTER 0 TO POSITIVE        07580002
         LTR   R15,R15            IS RETURN CODE ZERO                   07590002
         BNZ   SEVRET             NO, GO HANDLE SERVICE ROUTINE CODE    07600002
         L     R10,OUTBUF         YES, POINT TO OUTPUT BUFFER           07610002
         LH    R11,FLDOFFST                                             07620002
         AR    R11,R10            ADD IN OFFSET FOR FORMATTING          07630002
         LA    R11,D84(R11)       POINT TO POSITION IN FIELD BUFFER     07640002
         AR    R11,R2             GET PROPER DISPLACEMENT INTO BUFFER   07650002
         L     R10,CONAREA        POINT TO CONVERT OUTPUT AREA          07660002
         XR    R1,R1              CLEAR A REGISTER                      07670002
         IC    R1,D0(R10)         OBTAIN LENGTH OF DCB FIELD FROM       07680002
*                                 FIRST BYTE OF CONVERTED AREA          07690002
         BCTR  R1,R0              TAKE ONE FROM LENGTH                  07700002
         EX    R1,MOVE2           GO MOVE FIELD INTO BUFFER             07710002
         LH    R10,HDROFFST                                             07720002
         L     R11,OUTBUF         GET ADDRESS OF OUTPUT BUFFER          07730002
         AR    R11,R10                                                  07740002
         LA    R10,HDRBUFFR       GET ADDRESS OF FIELD HEADER           07750002
         AR    R11,R2             GET PROPER DISPLACEMENT INTO BUFFER   07760002
         XR    R1,R1              CLEAR REGISTER 1                      07770002
         IC    R1,HDRLENTH        OBTAIN LENGTH OF DCB FIELD            07780002
         BCTR  R1,R0              TAKE ONE FROM LENGTH                  07790002
         EX    R1,MOVE3           GO MOVE FIELD NAME INTO BUFFER        07800002
         AR    R2,R7              RESET OUTPUT CHARACTER COUNT          07810002
         LA    R2,D2(R2)          2 SPACES BETWEEN THIS AND NEXT FIELD  07820002
         B     PDECHK             GO CHECK TO SEE IF THERE ARE MORE     07830002
*                                 FIELDS TO BE OUTPUTTED                07840002
         EJECT                                                          07850002
*********************************************************************** 07860002
* THE FOLLOWING CODE SETS UP A PARAMETER LIST FOR IKJEGIO WHICH WILL  * 07870002
* OUTPUT THE LINE(S).  THIS CODE IS BRANCHED TO FROM CVTANDIO, DCBRET,* 07880002
* AND HDROUTPT.  UPON ENTRY OUTBUF POINTS TO THE DATA TO BE OUTPUTTED.* 07890002
*********************************************************************** 07900002
         SPACE                                                          07910002
DCBIO    DS    0H                                                       07920002
         STM   R2,R3,DATAREGS     SAVE PARM REGISTERS                   07922002
         L     R1,OUTBUF          POINT TO OUTPUT BUFFER                07930002
         ST    R1,OUTPTR1         STORE POINTER IN PARAMETER LIST       07940002
         L     R0,PRINTFLG        SEND IKJEGIO POINTER TO DSNAME PDE    07950002
*                                 THE FIRST TIME                        07960002
         LR    R2,R1              TRANSFER ADDRESS OF OUTPUT LINE       07962002
         LR    R3,R0              TRANSFER ADDRESS OF DSNAME PDE        07964002
         XR    R1,R1              CLEAR A REGISTER                      07970002
         ST    R1,PRINTFLG        CLEAR PRINTFLG TO AVOID SENDING       07980002
*                                 THE ADDRESS OF THE DSNAME PDE TO      07990002
*                                 IKJEGIO MORE THAN ONCE                08000002
         ST    R14,REG14          SAVE CONTENTS OF REGISTER 14          08040002
         XC    TSTIOPRM,TSTIOPRM  CLEAR I/O PARM LIST                   08050002
         IKJEGSIO DATA,DATAPTR=(R2),DSNAME=(R3),ID=DCB10,              *08052002
               MF=(E,TSTIOPRM)    CALL I/O TO SEND OUT DATA             08054002
         LM    R2,R3,DATAREGS     RESTORE DATA PARM REGS                08056002
         LTR   R15,R15            RETURN CODE FROM IO A ZERO            08060002
         BZ    CLEARBUF           YES, GO CLEAR BUFFERS                 08070002
         B     SEVRET             NO, GO HANDLE SERVICE ROUTINE CODES   08080002
CLEARBUF DS    0H                                                       08090002
         L     R10,OUTBUF         GET ADDRESS OF OUTPUT BUFFER          08100002
         MVI   D4(R10),BLANK      CLEAR OUTPUT AREA                     08110002
         MVC   D5(L79,R10),D4(R10)                                      08120002
         L     R14,REG14          RESTORE CONTENTS OF REGISTER 14       08130002
         TM    OUTPUTSW,FLDCHECK  WAS A FIELD JUST PUT OUT              08140002
         BZ    FURTHCHK           NO, GO CHECK FOR FIELD HEADER         08150002
         NI    OUTPUTSW,HEXEF     YES, TURN OFF FIELD SWITCH            08160002
         TM    OUTPUTSW,SECHDRCK  IS SECTION HEADER TO BE OUTPUTTED     08170002
         BZ    BRANCH1            NO, CONTINUE PROCESSING               08180002
         NI    OUTPUTSW,HEXBF     YES, TURN OFF SECTION HEADER SWITCH   08190002
         XC    D0(L4,R10),D0(R10) CLEAR FIRST FOUR BYTES OF OUTBUF      08200002
*                                 TO INDICATE A LINE SHOULD BE SKIPPED  08210002
         B     DCBIO              GO BACK TO I/O ROUTINE                08220002
BRANCH1  DS    0H                                                       08230002
         BR    R14                RETURN TO CALLING ROUTINE             08240002
FURTHCHK DS    0H                                                       08250002
         TM    OUTPUTSW,HDRCHECK  WAS A FIELD HEADER JUST PUT OUT       08260002
         BZ    BRANCH1            NO, BRANCH TO RETURN TO CALLER        08270002
         NI    OUTPUTSW,HEXDF     YES, TURN OFF FIELD HEADER SWITCH     08280002
         L     R11,OUTBUF         GET ADDRESS OF OUTPUT BUFFER          08290002
         LA    R10,D84(R11)       POINT TO FIELD BUFFER                 08300002
         LR    R1,R2              GET LENGTH OF DATA TO BE OUTPUTTED    08310002
         BCTR  R1,R0              TAKE ONE FROM LENGTH                  08320002
         EX    R1,MOVE3           MOVE FIELD DATA INTO OUTPUT BUFFER    08330002
         OI    OUTPUTSW,FLDCHECK  INDICATE FIELD DATA TO BE OUTPUTTED   08340002
         MVI   D0(R10),BLANK      CLEAR WORK BUFFER                     08350002
         MVC   D1(L79,R10),D0(R10)                                      08360002
         B     DCBIO              GO TO I/O ROUTINE                     08370002
         EJECT                                                          08380002
*********************************************************************** 08390002
* THE FOLLOWING CODE SCANS THE DDNAME FIELD AND CONVERTS THE FIELD TO * 08400002
* PRINTABLES.  A NON PRINTABLE IS CONVERTED TO A PERIOD.  ACCEPTED    * 08410002
* CHARACTERS ARE ALL OF THE ALPHANUMERIC, NATIONAL, THE QUOTE SIGN,   * 08420002
* AND BLANKS.                                                         * 08430002
*********************************************************************** 08440002
TRNSLATE DS    0H                                                       08450002
         MVC   DDNAMBUF(L8),D0(R4) COPY DDNAME INTO WORKAREA            08460002
         TR    DDNAMBUF(L8),TRTABLE TRANSLATE DDNAM TO PRINTABLES       08470002
         LA    R10,L8             LOAD LENGTH OF DDNAME                 08480002
         AR    R10,R2             ADD PREVIOUS OUTPUT LENGTH            08490002
         CH    R10,LINELEN        DOES DDNAM FIT IN OUTPUT LINE         08500002
         BH    NOFIT              BRANCH IF NOT ENOUGH ROOM             08510002
         B     MOVEIT             GO PUT DDNAME FIELD IN WORK BUFFER    08520002
NOFIT    DS    0H                                                       08530002
         BAL   R14,DCBIO          OUTPUT FIELDS AND HEADERS             08540002
         XR    R2,R2                                                    08550002
MOVEIT   DS    0H                                                       08560002
         L     R11,OUTBUF         POINT TO OUTPUT BUFFER                08570002
         AR    R11,R2                                                   08580002
         LA    R10,D84(R11)       POINT TO FIELD BUFFER                 08590002
         OI    OUTPUTSW,HDRCHECK  TURN ON FIELD HEADER SWITCH           08600002
         MVC   D4(L'HDRDDNAM,R11),HDRBUFFR MOVE HEADING INTO I/O BUFFER 08610002
         MVC   D0(L8,R10),DDNAMBUF  MOVE DDNAME TO FIELD BUFFER         08620002
*                                 FROM DCB                              08630002
         LA    R2,D10(R2)         RESET LINE LENGTH                     08640002
         B     PDECHK             GO CHECK NEXT PDE                     08650002
         EJECT                                                          08660002
DCBRC16  DS    0H                                                       08670002
         LA    R15,RET16          SET RETURN CODE TO 16 (ATTENTION)     08680002
         B     EXITNOW            RETURN TO IKJEGMNL                    08690002
FIELDMSG DS    0H                                                       08700002
         LA    R4,M0015           GET MESSAGE NUMBER INTO PARM REG      08710002
MSGERR   DS    0H                                                       08720002
         XC    TSTIOPRM,TSTIOPRM  CLEAR PARM LIST FOR I/O CALL          08730002
         IKJEGSIO MSG,FIRST=(R4),ID=DCB10,MF=(E,TSTIOPRM) CALL I/O      08732002
         B     RETTAB(R15)        BRANCH INTO BRANCH RTN TABLE          08734002
DCBRET0  DS    0H                                                       08830002
         LA    R15,RETCOD0        SET RETURN CODE FOR IKJEGMNL TO 0     08840002
RETURN   DS    0H                                                       08850002
         CLC   REG14,WORDZERO     DID IKJEGDCB CALL IKJEGIO             08860002
         BE    FIELDMSG           NO, GO WRITE MESSAGE                  08870002
EXITNOW  DS    0H                                                       08880002
         NI    TSTFLGS1,(HEXFF-TSTPRINT)     TURN OFF OUTPUT FLAG       08890002
         LR    R2,R15             SAVE RETURN CODE                      08890102
*                                 IN TCOMTAB                            08890402
         ESTAE 0,OV               REMOVE THE ESTAE                      08892002
         NI    TSTFLGS4,HEXFF-TSTRERTN IF THE RETRY SWITCH ON, TURN OFF 08894002
         L     R13,D4(R13)        RESTORE REGISTER 13                   08910002
         LR    R15,R2             RESTORE RETURN CODE                   08912002
         RETURN (14,12),T,RC=(15) RETURN TO IKJEGMNL                    08920002
FLUSHIT  DS    0H                                                       08930002
         OI    TSTFLGS4,TSTFLUSH  INDICATE TO IKJEGMNL TO FLUSH STACK   08940002
RETURN0  DS    0H                                                       08950002
         XR    R15,R15            SET RETURN CODE TO ZERO               08960002
         B     EXITNOW            RETURN TO IKJEGMNL                    08970002
CHKRET   DS    0H                                                       08980002
         L     R15,REG15          PUT SAVED RETURN CODE INTO REG 15     08990002
SEVRET   DS    0H                                                       09000002
         B     RETTAB(R15)        GO THRU FOLLOWING TABLE INDEXED BY    09010002
*                                 CONTENTS OF REGISTER 15               09020002
RETTAB   DS    0H                                                       09030002
         B     RETURN0            0-FROM SERVICE ROUTINE-RETURN-0       09040002
         B     RETURN0            4-FROM SERVICE ROUTINE-RETURN-0       09050002
         B     RETURN0            8-FROM SERVICE ROUTINE-RETURN-0       09060002
         B     RETURN0            12-FROM SERVICE ROUTINE RETURN-0      09070002
         B     EXITNOW            16-FROM SERVICE ROUTINE-RETURN 16     09080002
         B     EXITNOW            20-FROM SERVICE ROUTINE-RETURN 20     09090002
         B     EXITNOW            24-FROM SERVICE ROUTINE-RETURN 24     09092002
PDLEND   DS    0H                                                       09100002
         LTR   R2,R2              IS THERE ANY MORE OUTPUT              09110002
         BZ    DCBRET0            IF NO, BRANCH                         09120002
         LA    R2,D2(R2)          ADD 2 BYTES TO OUTPUT LENGTH          09130002
         L     R10,OUTBUF         GET ADDRESS OF OUTPUT BUFFER          09140002
         STH   R2,D0(R10)         STORE LENGTH OF OUTPUT IN BUFFER      09150002
         BAL   R14,DCBIO          GO OUTPUT HEADERS AND FIELDS          09160002
         B     DCBRET0            RETURN TO IKJEGMNL                    09170002
         EJECT                                                          09180002
**********************************************************************  09190002
*                     STAE RETRY ROUTINE                             *  09200002
**********************************************************************  09210002
STAERTN  DS    0H                                                       09220002
         L     R6,CVTPTR          GET CVT ADDRESS                       09240002
         USING CVT,R6             ESTABLISH ADDRESSABILITY TO CVT       09250002
         L     R6,CVTTCBP         GET ADDRESS OF TCB WORDS              09260002
         L     R6,D4(R6)          GET ADDRESS OF CURRENT TCB            09270002
         DROP  R6                 DROP ADDRESSABLITY TO CVT             09280002
         USING TCB,R6             ESTABLISH ADDRESSABILITY TO TCB       09290002
         L     R9,TCBTRN          PICK UP POINTER TO TCOMTAB FROM       09300002
*                                 TCBTRN FIELD OF TEST'S TCB            09310002
         OI    TSTFLGS4,TSTRERTN  TURN ON THE RETRY IN PROCESS SWITCH   09312002
         L     R13,REGSAVE2       GET ADDR OF LISTDCB'S REGISTERS       09320002
         L     R12,D68(R13)       RESET BASE REGISTER                   09330002
         LA    R15,RETCOD20       INDICATE STAE EXIT RTN ENTERED        09380002
         B     EXITNOW            GO BACK TO IKJEGMNL                   09390002
         EJECT                                                          09400002
IKJEGSPL IKJEGSPL RTRY=STAERTN,ABNTB=STATBL,MODNM=IKJEGDCB,TNM=LISTDCB  09400402
ZZZZZZZZ DC    52C'Z'             TO BE USED FOR MAINTENANCE            09402002
TRTABLE  DS    0H                                                       09410002
         DC    256CL1'.'          INITIALIZE TO 256 PERIODS             09420002
         ORG   TRTABLE+(C'A')     GO TO POSITION +193 IN TABLE          09430002
         DC    C'ABCDEFGHI'       FIRST THIRD OF ALPHABET               09440002
         ORG   TRTABLE+(C'J')     GO TO POSITION +209 IN TABLE          09450002
         DC    C'JKLMNOPQR'       SECOND THIRD OF ALPHABET              09460002
         ORG   TRTABLE+(C'S')     GO TO POSITION +226 IN TABLE          09470002
         DC    C'STUBWXYZ'        THIRD THIRD OF ALPHABET               09480002
         ORG   TRTABLE+(C'0')     GO TO POSITION +240 IN TABLE          09490002
         DC    C'0123456789'      ACCEPT NUMBERS                        09500002
         ORG   TRTABLE+(C'''')    GO TO POSITION +125 IN TABLE          09510002
         DC    C''''              ACCEPT QUOTES                         09520002
         ORG   TRTABLE+(C'=')     GO TO POSITION +126 IN TABLE          09530002
         DC    C'='               ACCEPT EQUAL MARKS                    09540002
         ORG   TRTABLE+(C'$')     GO TO POSITION +91 IN TABLE           09550002
         DC    C'$'               ACCEPT DOLLAR SIGN                    09560002
         ORG   TRTABLE+(C' ')     GO TO POSITION +64 IN TABLE           09570002
         DC    C' '               ACCEPT BLANK                          09580002
         ORG   TRTABLE+256        GO TO END OF TABLE                    09590002
         SPACE                                                          09600002
HDRRELAD DC    C'RELAD'           FIELD HEADER IN DEVICE INTERFACE SEG  09610002
HDRKEYCN DC    C'KEYCN'           FIELD HEADER IN DEVICE INTERFACE SEG  09620002
HDRFDAD  DC    C'FDAD'            FIELD HEADER IN DEVICE INTERFACE SEG  09630002
HDRDVTBL DC    C'DVTBL'           FIELD HEADER IN DEVICE INTERFACE SEG  09640002
HDRKEYLE DC    C'KEYLE'           FIELD HEADER IN DEVICE INTERFACE SEG  09650002
HDRDEVT  DC    C'DEVT'            FIELD HEADER IN DEVICE INTERFACE SEG  09660002
HDRTRBAL DC    C'TRBAL'           FIELD HEADER IN DEVICE INTERFACE SEG  09670002
HDRBUFNO DC    C'BUFNO'           FIELD HEADER IN COMMON INTERFACE      09680002
HDRBUFCB DC    C'BUFCB'           FIELD HEADER IN COMMON INTERFACE      09690002
HDRBUFL  DC    C'BUFL'            FIELD HEADER IN COMMON INTERFACE      09700002
HDRDSORG DC    C'DSORG'           FIELD HEADER IN COMMON INTERFACE      09710002
HDRIOBAD DC    C'IOBAD'           FIELD HEADER IN COMMON INTERFACE      09720002
HDRHIARC DC    C'HIARC-BFTEK-BFALN' TRI HEADERS IN FOUNDATION EXTENSION 09730002
HDRBFTEK DC    C'BFTEK-HIARC-BFALN' TRI HEADERS IN FOUNDATION EXTENSION 09740002
HDRBFALN DC    C'BFALN-HIARC-BFTEK' TRI HEADERS IN FOUNDATION EXTENSION 09750002
HDREODAD DC    C'EODAD'           FIELD HEADER IN FOUNDATION EXTENSION  09760002
HDRRECFM DC    C'RECFM'           FIELD HEADER IN FOUNDATION EXTENSION  09770002
HDREXLST DC    C'EXLST'           FIELD HEADER IN FOUNDATION EXTENSION  09780002
HDRDDNAM DC    C'DDNAM'           FIELD HEADER IN CLOSED FOUNDATION     09790002
HDROFLGS DC    C'OFLGS'           FIELD HEADER IN CLOSED FOUNDATION     09800002
HDRIFLG  DC    C'IFLG'            FIELD HEADER IN CLOSED FOUNDATION     09810002
HDRMACR  DC    C'MACR'            FIELD HEADER IN CLOSED FOUNDATION     09820002
HDRTIOT  DC    C'TIOT'            FIELD HEADER IN OPEN FOUNDATION       09830002
HDRMACRF DC    C'MACRF'           FIELD HEADER IN OPEN FOUNDATION       09840002
HDRIFLGS DC    C'IFLGS'           FIELD HEADER IN OPEN FOUNDATION       09850002
HDRDEBAD DC    C'DEBAD'           FIELD HEADER IN OPEN FOUNDATION       09860002
HEADER1  DC    C'DEVICE INTERFACE SEGMENT'  DCB SECTION HEADER          09870002
HEADER2  DC    C'COMMON INTERFACE'          DCB SECTION HEADER          09880002
HEADER3  DC    C'FOUNDATION EXTENSION'      DCB SECTION HEADER          09890002
HEADER4  DC    C'FOUNDATION'                DCB SECTION HEADER          09900002
WORDZERO DC    X'00000000'        WORD OF ZEROES                        09910002
HEXFFFF  DC    X'FFFF'            USED TO TURN ON PDES DESCRIBING THE   09920002
*                                 DCB FIELDS                            09930002
PCLADDR  DC    V(IKJEGPCL)        ADDRESS OF PARAMETER CONTROL LIST     09950002
*                                 FOR IKJPARS                           09960002
RETRYADR DC    AL3(STAERTN)       ADDR OF STAE EXIT ROUTINE             09970002
** THE FOLLOWING IS THE STAE MESSAGE TABLE                           ** 09980002
STATBL   DS    0F                                                       09990002
         DC    AL1(INST99),AL3(PARSBLOW)  PARSE LINK FAILED             10000002
         DC    AL1(HEXFF)                   END OF STATE ABEND TABLE    10010002
MOVE2    MVC   D0(L0,R11),D1(R10) MOVE FIELD INTO BUFFER                10020002
MOVE3    MVC   D4(L0,R11),D0(R10) MOVE FIELD HEADER OR DATA INTO BUFFER 10030002
STAEL    DS    0F                                                       10040002
STAELIST ESTAE STAELIST,MF=L       LIST FORM OF STAE MACRO              10050002
STAELEN  EQU   *-STAELIST          LENGTH OF STAE LIST FORM             10060002
         EJECT                                                          10730002
IKJEGPCL IKJPARM                                                        10740002
ADDRESS  IKJPOSIT ADDRESS,VALIDCK=IKJEGDVK,PROMPT='ADDRESS OF DCB'      10750002
PRINT    IKJKEYWD                                                       10760002
         IKJNAME   'PRINT',SUBFLD=DSNAME                                10770002
DCBFIELD IKJKEYWD                                                       10780002
         IKJNAME   'FIELD',SUBFLD=FIELDNAM                              10790002
DSNAME   IKJSUBF                                                        10800002
DSNAM    IKJPOSIT  DSNAME,PROMPT='DSNAME'                               10810002
FIELDNAM IKJSUBF                                                        10820002
RELAD    IKJKEYWD                                                       10830002
         IKJNAME   'DCBRELAD'                                           10840002
KEYCN    IKJKEYWD                                                       10850002
         IKJNAME   'DCBKEYCN'                                           10860002
FDAD     IKJKEYWD                                                       10870002
         IKJNAME   'DCBFDAD'                                            10880002
DVTBL    IKJKEYWD                                                       10890002
         IKJNAME   'DCBDVTBL'                                           10900002
KEYLE    IKJKEYWD                                                       10910002
         IKJNAME   'DCBKEYLE'                                           10920002
DEVT     IKJKEYWD                                                       10930002
         IKJNAME   'DCBDEVT'                                            10940002
TRBAL    IKJKEYWD                                                       10950002
         IKJNAME   'DCBTRBAL'                                           10960002
BUFNO    IKJKEYWD                                                       10970002
         IKJNAME   'DCBBUFNO'                                           10980002
BUFCB    IKJKEYWD                                                       10990002
         IKJNAME   'DCBBUFCB'                                           11000002
BUFL     IKJKEYWD                                                       11010002
         IKJNAME   'DCBBUFL'                                            11020002
DSORG    IKJKEYWD                                                       11030002
         IKJNAME   'DCBDSORG'                                           11040002
IOBAD    IKJKEYWD                                                       11050002
         IKJNAME   'DCBIOBAD'                                           11060002
HIARC    IKJKEYWD                                                       11070002
         IKJNAME   'DCBHIARC'                                           11080002
FTEK     IKJKEYWD                                                       11090002
         IKJNAME   'DCBBFTEK'                                           11100002
BFALN    IKJKEYWD                                                       11110002
         IKJNAME   'DCBBFALN'                                           11120002
EODAD    IKJKEYWD                                                       11130002
         IKJNAME   'DCBEODAD'                                           11140002
RECFM    IKJKEYWD                                                       11150002
         IKJNAME   'DCBRECFM'                                           11160002
EXLST    IKJKEYWD                                                       11170002
         IKJNAME   'DCBEXLST'                                           11180002
DDNAM    IKJKEYWD                                                       11190002
         IKJNAME   'DCBDDNAM'                                           11200002
OFLGS    IKJKEYWD                                                       11210002
         IKJNAME   'DCBOFLGS'                                           11220002
IFLG     IKJKEYWD                                                       11230002
         IKJNAME   'DCBIFLG'                                            11240002
MACR     IKJKEYWD                                                       11250002
         IKJNAME   'DCBMACR'                                            11260002
TIOT     IKJKEYWD                                                       11270002
         IKJNAME   'DCBTIOT'                                            11280002
MACRF    IKJKEYWD                                                       11290002
         IKJNAME   'DCBMACRF'                                           11300002
IFLGS    IKJKEYWD                                                       11310002
         IKJNAME   'DCBIFLGS'                                           11320002
DEBAD    IKJKEYWD                                                       11330002
         IKJNAME   'DCBDEBAD'                                           11340002
OFLGS2   IKJKEYWD                                                       11350002
         IKJNAME   'DCBOFLG2'                                           11360002
         IKJENDP                                                        11370002
         EJECT                                                          11380002
         IKJPARMA                                                       11390002
         EJECT                                                          11400002
         IKJPPL                                                         11410002
         EJECT                                                          11420002
CVT      DSECT                                                          11430002
         CVT                                                            11440002
         EJECT                                                          11450002
         IKJTCB                                                         11460002
         EJECT                                                          11470002
         TCOMTAB                                                        11480002
         EJECT                                                          11490002
         TSTCWORK                                                       11500002
         EJECT                                                          11510002
         DCBD  DSORG=PS,DEVD=DA                                         11520002
         EJECT                                                          11530002
DCBWKARA DSECT                                                          11540002
PPLLIST  DS    7F       PARSE PARAMETER LIST DESCRIBED IN IKJPPL        11550002
*                       MACRO                                           11560002
HDRBUFFR DS    5F       BUFFER FOR ONE FIELD HEADER                     11570002
PRINTFLG DS    F        ADDRESS OF DSNAME PDE FOR IKJEGIO               11580002
ENDEND   DS    F        ADDRESS OF LAST FIELD PDE + 2                   11590002
DDNAMBUF DS    2F       BUFFER FOR DDNAM FIELD                          11600002
OUTPTR1  DS    F        FIRST OUTPUT POINTER FOR IKJEGIO                11610002
OUTPTR2  DS    F        SECOND OUTPUT POINTER FOR IKJEGIO               11620002
** THE FOLLOWING FIELD IS INITIALIZED IN THE DCBIO ROUTINE.  BEFORE  ** 11630002
** RETURNING TO IKJEGMNL THIS FIELD IS CHECKED FOR A 0 INDICATING    ** 11640002
** IKJEGIO WAS NOT CALLED TO OUTPUT A FIELD.                         ** 11650002
REG14    DS    F        REGISTER 14 SAVEAREA                            11660002
REG15    DS    F        RETURN CODE SAVEAREA                            11670002
HDROFFST DS    CL2      OFFSET FOR FORMATTING                           11680002
FLDOFFST DS    CL2      OFFSET FOR FORMATTING                           11690002
HDRLENTH DS    CL1      LENGTH OF PRECEDING FIELD HEADER                11700002
FLDLENTH DS    CL1      LENGTH OF DCB FIELD                             11710002
OUTPUTSW DS    CL1      OUTPUT FLAGS                                    11720002
HDRCOUNT DS    CL1      NUMBER OF SECTION HEADERS ALREADY OUT           11730002
** THE FOLLOWING FOUR FIELDS MAKE UP THE PARAMETER LIST FOR IKJEGCVT ** 11740002
STRNGPTR DS    F        POINTER TO FIELD TO BE CONVERTED                11750002
CVTLL    DS    CL2      LENGTH OF FIELD TO BE CONVERTED                 11760002
FLAGS    DS    CL1      FLAG FOR IKJEGCVT                               11770002
TYPECODE DS    CL1      TYPE OF INPUT DATA TO IKJEGCVT (HEX)            11780002
LINELEN  DS    H        OUTPUT LINE LENGTH                              11790002
STAEL2   DS    0F                                                       11800002
STAEAREA DS    3F       WORKAREA FOR STAE                               11810002
DATAREGS DS    2F       WORK REGISTER SAVE ON DATA I/O CALL             11812002
         END                                                            11820002
./  ADD  SSI=33180113,NAME=IKJEGDEB
     TITLE 'IKJEGDEB - TSO TEST LIST DEB ROUTINE'                       00120002
* /* START OF SPECIFICATIONS ****                                       00130002
*02*  PROCESSOR = ASSEMBLER                                             00140002
**** END OF SPECIFICATIONS ***/                                         00142002
*********************************************************************** 00150002
*                                                                     * 00200002
* STATUS --                                                           * 00250002
*    CHANGE LEVEL 00, VERSION NO. 02, OS/VS2                          * 00300002
*                                                                     * 00350002
* FUNCTION/OPERATION --                                               * 00400002
*    THIS SUBCOMMAND PROCESSOR RECEIVES CONTROL FROM THE TEST MA      * 00450002
*    LINE PROGRAM.  IT DISPLAYS ALL OR PART OF THE DEB AT THE         * 00500002
*    SPECIFIED ADDRESS.                                               * 00550002
*                                                                     * 00600002
* ENTRY POINTS --                                                     * 00650002
*         IKJEGDEB - MAIN ENTRY TO LISTDEB                            * 00700002
*         DEBVALCK - PARSE VALIDITY CHECK EXIT FOR ADDRESS OF DEB     * 00750002
*                                                                     * 00800002
* INPUT --                                                            * 00850002
*    ONE LINE OF INPUT FROM THE TERMINAL CONTAINING THE SUBCOMMAND    * 00900002
*                                                                     * 00950002
* OUTPUT --                                                           * 01000002
*    LINES OF OUTPUT TO THE TERMINAL OR SPECIFIED DATA SET CONTAINING * 01050002
*    DESCRIPTIVE HEADERS AND THE REQUESTED DEB FIELDS.                * 01100002
*                                                                     * 01150002
* EXTERNAL REFERENCES --                                              * 01200002
*         1.  IKJPARS  - TO SCAN THE INPUT BUFFER                     * 01250002
*         2.  IKJEGCVT - TO CHECK AND CONVERT THE ADDRESS,            * 01300002
*         AND TO CONVERT THE DEB TO PRINTABLE HEX                     * 01350002
*         3.  IKJEGIO  - TO OUTPUT THE HEADER AND DEB FIELDS          * 01400002
*                                                                     * 01500002
* EXITS, NORMAL --                                                    * 01550002
*         RETURN TO IKJEGMNL VIA REGISTER 14                          * 01600002
*                                                                     * 01650002
* EXITS, ERROR --                                                     * 01700002
*         RETURN TO IKJEGMNL VIA REGISTER 14                          * 01750002
*                                                                     * 01800002
* TABLES/WORK AREAS --                                                * 01850002
*    TCOMTAB - TEST TABLE AND WORKAREA                                * 01900002
*                                                                     * 01950002
* ATTRIBUTES --                                                       * 02000002
*    REENTRANT, REFRESHABLE                                           * 02050002
*                                                                     * 02100002
* CHARACTER CODE DEPENDENCY --                                        * 02150002
*    RE-ASSEMBLY IS REQUIRED FOR CHANGE OF CODE                       * 02200002
*                                                                     * 02250002
* NOTES --                                                            * 02300002
*    THE LISTDEB ROUTINE WILL PRINT ONLY THE BASIC SECTION AND ANY    * 02350002
*    DIRECT ACCESS SECTIONS OF THE SPECIFIED DEB.                     * 02400002
*    THE SPECIFIED DEB IS ASSUMED TO BE A VALID DEB.                  * 02450002
*                                                                     * 02500002
*********************************************************************** 02550002
         EJECT                                                          02600002
         COPY IKJEGSIO                                                  02610002
         TCOMTAB                                                        02650002
         SPACE 2                                                        02700002
         TSTCWORK                                                       02750002
         SPACE 2                                                        02800002
         IKJPPL                                                         02850002
         SPACE 2                                                        02900002
         IKJPARMA                                                       02950002
         EJECT                                                          03000002
         DCBD  DSORG=PS                                                 03050002
         EJECT                                                          03100002
IKJEGDEB CSECT                                                          03150002
*********************************************************************** 04100002
*                                                                     * 04150002
*                            REGISTER EQUATES                         * 04200002
*                                                                     * 04250002
*********************************************************************** 04300002
         SPACE 2                                                        04350002
R0       EQU   0                   REGISTER 0                           04400002
R1       EQU   1                   REGISTER 1                           04450002
R2       EQU   2                   REGISTER 2                           04500002
R3       EQU   3                   REGISTER 3 - BASE FOR DEB            04550002
R4       EQU   4                   REGISTER 4                           04600002
R5       EQU   5                   BASE FOR DBWKAREA                    04650002
R6       EQU   6                   REGISTER 6                           04700002
R7       EQU   7                   REGISTER 7                           04750002
R8       EQU   8                   BASE FOR IKJPARMD                    04800002
R9       EQU   9                   BASE FOR TCOMTAB                     04850002
R10      EQU   10                  REGISTER 10                          04900002
R11      EQU   11                  REGISTER 11                          04950002
R12      EQU   12                  PROGRAM BASE                         05000002
R13      EQU   13                  REGISTER 13                          05050002
R14      EQU   14                  REGISTER 14                          05100002
R15      EQU   15                  REGISTER 15                          05150002
         SPACE 2                                                        05200002
*********************************************************************** 05250002
*                                                                     * 05300002
*        OTHER EQUATES                                                * 05350002
*                                                                     * 05400002
*********************************************************************** 05450002
         SPACE 2                                                        05500002
BADESTAE EQU   24                  RETURN CODE FOR UNSUCCESSFUL ESTAE   05510002
M0040    EQU   40                  MESSAGE NUMBER                       05550002
M0041    EQU   41                  MESSAGE NUMBER                       05560002
M0103    EQU   103                 MESSAGE NUMBER                       05570002
M0247    EQU   247                 MESSAGE NUMBER                       05580002
M0248    EQU   248                 MESSAGE NUMBER                       05582002
M0268    EQU   268                 MESSAGE NUMBER                       05590002
M0298    EQU   298                 MESSAGE NUMBER                       05592002
N30      EQU   30                  DECIMAL 30                           05600002
N0       EQU   0                   DECIMAL 0                            05650002
N1       EQU   1                   DECIMAL 1                            05700002
N2       EQU   2                   DECIMAL 2                            05750002
N3       EQU   3                   DECIMAL 3                            05800002
N4       EQU   4                   DECIMAL 4                            05850002
N5       EQU   5                   DECIMAL 5                            05900002
N104     EQU   104                 DECIMAL 104                          06000002
N8       EQU   8                   DECIMAL 8                            06050002
N11      EQU   11                  DECIMAL 11                           06200002
N12      EQU   12                  DECIMAL 12                           06250002
N15      EQU   15                  DECIMAL 15                           06400002
N16      EQU   16                  DECIMAL 16                           06450002
N20      EQU   20                  DECIMAL 20                           06550002
N24      EQU   24                  DECIMAL 24                           06600002
N32      EQU   32                  DECIMAL 32                           06950002
N40      EQU   40                  DECIMAL 40                           07050002
N56      EQU   56                  DECIMAL 56                           07150002
N68      EQU   68                  DECIMAL 68                           07200002
N79      EQU   79                  DECIMAL 79                           07250002
N80      EQU   80                  DECIMAL 80                           07300002
NOTSYM   EQU   10                  BC INSTR MASK, BRANCH POSTIVE OR 0   07350002
         SPACE 2                                                        07400002
*********************************************************************** 07450002
*                                                                     * 07500002
*        TO LIMIT THE SIZE OF IKJEGDEB, THE MAJORITY OF THE FIELD     * 07550002
*        HEADERS HAVE BEEN EQUATED TO FIELDS IN THE PARSE CSECT,      * 07600002
*        IKJEGDBP.  THOSE EQUATES ARE AT THE END OF THE MODULE.  THE  * 07650002
*        FOLLOWING EQUATES SET UP THOSE FIELD HEADER EQUATES.         * 07700002
*                                                                     * 07750002
*********************************************************************** 07800002
         SPACE 2                                                        07850002
LENKEYWD EQU   6                   LENGTH OF IKJKEYWD PCE               07900002
LENNAME  EQU   13                  LENGTH OF IKJNAME PCE                07950002
FLDHDR   EQU   LENKEYWD+LENNAME    NORMAL DISPLACEMENT BETWEEN FIELD    08000002
*                                   HEADERS IN PARSE CSECT, IKJEGDBP    08050002
FIRSTHDR EQU   108                 DISPLACEMENT INTO PARSE CSECT,       08100002
*                                   IKJEGDBP, OF FIRST FIELD HDR, NMSUB 08150002
         EJECT                                                          08200002
         SAVE  (14,12),,*                                               08250002
         LR    R12,R15                                                  08300002
         USING IKJEGDEB,R12        ESTABLISH PROGRAM ADDRESSABILITY     08350002
         USING TCOMTAB,R9          ESTABLISH TCOMTAB ADDRESSABILITY     08400002
         L     R15,REGSAVE2        ADDRESS OF LISTDEB SAVE AREA         08450002
         ST    R13,N4(R15)         STORE REGISTER 13 NEW SAVE AREA      08500002
         ST    R15,N8(R13)         STORE NEW SAVE AREA ADDRESS          08550002
         LR    R13,R15             R13 NOW POINTS TO NEW SAVE AREA      08600002
         L     R7,WORKAREA         ADDR OF GENERAL WORK AREA FOR CMDS   08650002
         USING TSTCWORK,R7                                              08700002
         LA    R5,CWORKCMD         ADDRESS OF WORK AREA FOR CMDS        08750002
         USING DBWKAREA,R5         ESTABLISH WORK AREA ADDRESSABILITY   08800002
         DROP  R7                                                       08850002
         L     R3,TSTSTAE          ADDRESS OF STAE EXIT ROUTINE         09100002
         LA    R1,STAELIST         STAE PARAMETER LIST                  09150002
         ST    R12,N68(R13)        SAVE MY BASE IN MY SAVE AREA         09200002
         MVC   N0(N16,R1),LFSTAE   STAE PARAMETER LIST TO WORK AREA     09250002
         ESTAE (R3),CT,PARAM=IKJEGSPL,RECORD=YES,XCTL=NO,MF=(E,(R1))    09310002
         LTR   R15,R15             WAS STAE ISSUED SUCCESSFULLY         09350002
SMTSTAE  DS    0H                  SMT TESTCASE LABEL                   09400002
*                                   INSUFFICIENT CORE TO ISSUE STAE     09450002
*                                   TESTCASE ID  TDEB2800               09500002
         BZ    GOPARSE             YES, GO SET UP TO PARSE COMMAND      09550002
         STC   R15,TSTESTRC        SAVE RETURN CODE FOR MAINLINE        09600002
         LA    R15,BADESTAE        PASS BACK A BAD ESTAE RTN CODE       09650002
         B     DEBRET              BRANCH TO EXIT                       09750002
GOPARSE  DS    0H                                                       09850002
         MVI   OUTPUTSW,HEX00      ZERO OUTPUT SWITCH                   09900002
         LR    R1,R5               R1 POINTS TO LIST FOR PARSE          09950002
         USING PPL,R1                                                   10000002
         MVC   PPLUPT(N4),TSTUPT   POINTER TO UPT FOR PARSE             10050002
         MVC   PPLECT(N4),TSTECT   POINTER TO ECT FOR PARSE             10100002
         MVC   PPLECB(N4),TSTCPECB POINTER TO CP ECB FOR PARSE          10150002
         MVC   PPLPCL(N4),PCLADDR  ADDR OF PCL INTO PARSE LIST          10200002
         LA    R2,TSTANSPL         LOAD ADDRESS OF ANSWER PLACE         10250002
         ST    R2,PPLANS           PTR TO ANSWER PLACE                  10300002
         MVC   PPLCBUF(N4),INBUF   PTR TO COMMAND BUFFER                10350002
         ST    R13,PPLUWA          PTR TO SAVE AREA                     10400002
         DROP  R1                                                       10450002
         LINK  EP=IKJPARS,ERRET=LINKFAIL     GO TO PARSE                10500002
PABEND1  DS    0H                  POSSIBLE ABEND RESUME ADDRESS        10502002
         B     LINKOK              IF CONTROL COMES HERE SVC 6 OK       10510002
LINKFAIL DS    0H                                                       10530002
         LR    R2,R1               TRANSFER THE ABEND CODE              10540002
         LR    R3,R15              TRANSFER THE RETURN CODE             10542002
         XC    TSTIOPRM,TSTIOPRM   CLEAR PARM LIST FOR I/O CALL         10544002
         IKJEGSIO SVCERR,SVC=6,ABENDRG=(R2),RC=(R3),ID=DEB11,          *10546002
               INST11=(NUM,I0040),MF=(E,TSTIOPRM)     CALL I/O          10548002
         B     DEBRET              BRANCH TO TEST RTN CODE AND EXIT     10548402
LINKOK   DS    0H                                                       10548802
SMTPARS  DS    0H                  SMT TESTCASE LABEL                   10600002
*                                   LINK TO PARSE FAILED                10650002
*                                   TESTCASE ID  TDEB2700               10700002
         B     PARSDONE            GO TO PARSDONE                       10750002
         SPACE 1                                                        10800002
*********************************************************************** 10850002
*   THIS IS THE PARSE ADDRESS VALIDITY CHECK EXIT ROUTINE             * 10900002
*********************************************************************** 10950002
         SPACE 1                                                        11000002
DEBVALCK SAVE  (14,12),,*                                               11050002
         LR    R2,R1               ADDR OF PARSE LIST FOR VALIDITY      11100002
*                                   CHECK ROUTINES                      11150002
         L     R9,N4(R1)           LOAD R9 WITH ADDRESS OF SAVE AREA    11200002
         L     R12,N68(R9)         RESTORE BASE REGISTER                11250002
         L     R5,N40(R9)          RESTORE WORKAREA ADDRESSABILITY      11300002
         L     R1,N0(R1)           ADDRESS OF ADDRESS PDE               11350002
         LCR   R1,R1               NEGATIVE                             11400002
         L     R9,N56(R9)          RESTORE TCOMTAB ADDRESSABILITY       11450002
         L     R15,REGSAVE3        LOAD SAVE AREA FOR IKJEGCVT          11500002
         LCR   R0,R1               R0 INDICATES CONVERT TO BINARY       11550002
         ST    R13,N4(R15)         STORE OLD SAVE AREA ADDRESS          11600002
         ST    R15,N8(R13)         STORE NEW SAVE AREA ADDRESS          11650002
         LR    R13,R15                                                  11700002
         L     R15,OUTBUF          PICK UP POINTER TO OUTBUF            11710002
         SR    R14,R14             ZERO FOR NO MSG DEFAULT VALUE        11720002
         ST    R14,N0(R15)         STORE NO MSG INDICATOR               11730002
         OI    TSTFLGS4,TSTVALCK   TURN ON VALIDITY CHECK BIT           11740002
         L     R15,TSTCONVT        ENTRY POINT OF IKJEGCVT              11750002
         BALR  R14,R15             GO TO IKJEGCVT                       11800002
         LPR   R1,R1               POSTIVE POINTER TO ADDRESS PDE       11850002
         USING IKJPARMA,R1         R1 IS BASE FOR ADDRESS PDE           11900002
         LTR   R15,R15             IS RETURN CODE 0                     11950002
         BZ    BOUNDCK             YES, GO CHECK FOR VALID ADDRESS      12000002
         LA    R6,N4               UNSUCCESSFUL R.C. FROM CONVERT       12050002
         CR    R6,R15              WAS CONVERT UNABLE TO CONVERT        12100002
         BNE   STOP                NO, WORST TROUBLES, GO SET TO END    12150002
RETCODE8 DS    0H                                                       12250002
         LA    R15,N8              RC=8, PARSE GIVE REENTER MESG        12300002
PARSRTN  DS    0H                                                       12350002
         NI    TSTFLGS4,HEXFF-TSTVALCK TURN OFF VALIDITY CHECK BIT      12360002
         L     R13,N4(R13)                                              12400002
         L     R5,OUTBUF           PICK UP POINTER TO OUTBUF            12402002
         LH    R6,N0(R5)           PICK MSG LENGTH FIELD                12404002
         LTR   R6,R6               TEST FOR PRESENTS OF MSG             12406002
         BZ    NO2NDMSG            IF ZERO THEN THERE ISN'T A MESSAGE   12408002
         L     R1,N24(R13)         PICK UP POINTER TO PARSE PARM LIST   12410002
         ST    R5,N8(R1)           STORE ADDRESS OF MESSAGE IN PARM L   12420002
NO2NDMSG DS    0H                                                       12440002
         RETURN  (14,12),,RC=(15)  RESTORE REGISTERS AND RETURN         12450002
BOUNDCK  DS    0H                                                       12500002
         L     R3,PDEUSER          LOAD BINARY DEB ADDRESS              12550002
         LTR   R3,R3               WAS ADDRESS SYMBOLIC ?               12600002
         BC    NOTSYM,NOSYM        BRANCH IF NOT SYMBOLIC               12650002
         L     R3,N0(R3)           LOAD CONVERTED SYMBOLIC ADDR         12700002
         ST    R3,PDEUSER          PDEUSER NOW POINTS TO DEB            12750002
NOSYM    DS    0H                                                       12800002
         L     R6,REGSAVE2         GET DEB'S SAVE AREA ADDRESS          12850002
         ST    R3,N32(R6)          POINT DEB'S R3 TO DEB                12900002
REGTEST  DS    0H                                                       12950002
         LH    R4,PDEINDCT         LOAD INDIRECT COUNT                  13100002
         LTR   R4,R4               IS ADDRESS INDIRECT                  13150002
         BNZ   FULLWORD            IF INDIRECT BRANCH                   13200002
         TM    PDEFLG4,GENR+LFPR+SFPR  IS ADDRESS A REGISTER ?          13250002
         BZ    FULLWORD            IF NOT REGISTER BRANCH               13300002
         LA    R3,M0268            PICK UP SECOND LEVEL MESSAGE NUMBER  13350002
         B     MESSAGIO            PUT OUT THE MESSAGE                  13400002
FULLWORD DS    0H                                                       13450002
         TM    PDEUSER+N3,HEX03    ADDRESS ON FULL WORD                 13500002
         BNZ   SETMESG             NO, GO GIVE INVALID ADDRESS MESSAGE  13550002
         LA    R4,N32(R3)          ESTAB ENDING ADDR OF DEB             13600002
         L     R7,PPTCB            GET PP'S TCB ADDRESS                 13650002
         IKJEGS9G ADDRCHK,TCBADDR=(R7),VALUE=(R4),MF=(E,SVCPARMS)       13700002
         C     R15,EIGHT           IS ADDRESS VALID ?                   13750002
         BE    BADDEB              NO, BAD DEB ADDR PRINT MESSAGE       13800002
         BH    STOP                ERROR  ENCOUNTERED IN SVC 97         13810002
         LA    R1,DEBBASND-DEBBASIC-N1(R3) ADDR END BASIC SEC.          13850002
PARDCB1  DS    0H                  NEXT INSTRUCTION MAY ABEND           13900002
         L     R4,DEBDCBAD-DEBBASIC(R3)  GET DCB ADDRESS                13950002
PARDCB2  DS    0H                  PRECEDING INSTR MAY ABEND            14000002
         LA    R4,DCBDSORG-IHADCB(R4)  GET ADDRESS OF DEB'S DCB         14050002
         L     R7,PPTCB            GET PP'S TCB ADDRESS                 14100002
*                                  CHECK DCBDSORG FOR READABILIT        14150002
         IKJEGS9G ADDRCHK,TCBADDR=(R7),VALUE=(R4),MF=(E,SVCPARMS)       14200002
         C     R15,EIGHT           IS ADDRESS OK ?                      14250002
         BE    BADDEB              NO, DCB ADDRESS BAD - BAD DEB        14300002
         BH    STOP                ERROR ENCOUNTERED IN SVC 97          14310002
         LA    R1,DEBBASND-DEBBASIC-N1(R3) ADDR END BASIC SEC.          14350002
         TM    DCBDSORG-IHADCB(R4),ISAM ISDEB FOR ISAM DATA SET?        14400002
         BZ    NOTISAM             NOT ISAM, FORGET ADDED LENGTH        14450002
         LA    R1,DEBEXPTA-DEBISAM+L'DEBEXPTA(R1)  ADD LEN ISAM         14500002
NOTISAM  DS    0H                  CHECK FOR EXTENTS                    14550002
         SR    R0,R0               CLEAR REGISTER TO ZERO               14600002
PARNMEX1 DS    0H                  NEXT INSTRUCTION MAY ABEND           14650002
         IC    R0,DEBNMEXT-DEBBASIC(R3) NUM EXTENTS IN DATASET          14700002
PARNMEX2 DS    0H                  PREVIOUS INSTR MAY ABEND             14750002
         SLA   R0,N4               MULTIPLY BY 16-LEN OF DA SECT        14800002
         AR    R0,R1               ENDING ADDRESS OF DEB                14850002
         L     R7,PPTCB            GET ADDRESS OF PP'S TCB              14900002
         LR    R8,R0               GET ADDRESS OF END OF DEB            14950002
         IKJEGS9G ADDRCHK,TCBADDR=(R7),VALUE=(R8),MF=(E,SVCPARMS)       15000002
         C     R15,EIGHT           IS RETURN CODE 0 OR 4 ?              15050002
         BE    BADDEB              NO, BAD DEB ADDR PRINT MESSAGE       15060002
         BH    STOP                ERROR ENCOUNTERED IN SVC 97          15070002
         SR    R15,R15             SET RETURN CODE TO 0                 15100002
         B     PARSRTN             ADDRESS OK - RETURN TO PARSE         15150002
BADDEB   DS    0H                                                       15200002
         LA    R3,M0298            OBTAIN SECOND LEVEL MESSAGE NUMBER   15250002
         B     MESSAGIO            GO GIVE MESSAGE                      15300002
SETMESG  DS    0H                                                       15350002
         L     R2,N0(R2)           PICK UP ADDRESS PDE POINTER          15360002
         XC    TSTIOPRM,TSTIOPRM   CLEAR OUT PARM LIST FOR I/O          15400002
         IKJEGSIO MSG,FIRST=M0101,INST11=(APDE,(R2)),SECOND=M0280, CALL*15410002
               INST21=(NUM,I0003),ID=DEB11,MF=(E,TSTIOPRM) IO ISSUE MSG 15430002
         B     IOPARSE             RETURN TO PARSE                      15442002
MESSAGIO DS    0H                                                       15450002
         L     R2,N0(R2)           PTR TO ADDRESS PDE                   15800002
         XC    TSTIOPRM,TSTIOPRM   CLEAR OUT PARM LIST FOR I/O          15850002
         IKJEGSIO MSG,FIRST=M0101,INST11=(APDE,(R2)),SECOND=(R3), CALL *15900002
               ID=DEB11,MF=(E,TSTIOPRM) IO ISSUE ERROR MSG              15950002
IOPARSE  DS    0H                                                       16000002
         LTR   R15,R15             IS RETURN CODE 0                     16450002
         BZ    RETCODE8            YES, GO BACK TO PARSE WITH RC=8      16500002
         LA    R6,N4               UNSUCCESSFUL I/O R.C.                16550002
         CR    R15,R6              COULD I/O PUT OUT MESSAGE            16600002
         BNE   STOP                WORST TROUBLES, GO SAVE R.C.         16650002
         SR    R15,R15             CREATE 0 R.C. FOR MAINLINE           16700002
STOP     DS    0H                                                       16750002
         ST    R15,REG14           SAVE R.C.                            16800002
         LA    R15,N12             HAVE PARSE CLEAN UP AND END          16850002
         B     PARSRTN             GO BACK TO PARSE                     16900002
         SPACE 1                                                        16950002
*********************************************************************** 17000002
* THE FOLLOWING CODE CHECKS THE FIELD,PRINT, AND ADDRESS PDE'S.  IF   * 17050002
* FIELD IS NOT SPECIFIED, THE PROGRAM SETS ALL THE FIELD PDE'S        * 17100002
* NON-ZERO.  IF PRINT IS SPECIFIED THE ADDRESS OF THE PRINT DATA SET  * 17150002
* PDE IS STORED IN PRINTFLG AND LATER PASSED TO IKJEGIO1.  THE ADDRESS* 17200002
* OF THE DEB IS FOUND IN THE USER WORD OF THE PARSE PARM LIST AFTER   * 17250002
* CONTROL IS RETURNED FROM IKJEGCVT.                                  * 17300002
*********************************************************************** 17350002
         SPACE 1                                                        17400002
PARSDONE DS    0H                                                       17450002
         LTR   R15,R15             IS RETURN CODE 0                     17500002
         BNZ   DEBRET1             IF NO BRANCH TO DEBRET1              17550002
DCBTRY1  DS    0H                  NEXT INSTRUCTION MAY ABEND           17600002
         L     R6,DEBDCBAD-DEBBASIC(R3) ADDR DCB FOR THIS DEB           17650002
DCBTRY2  DS    0H                  PREV / NEXT INSTRS MAY ABEND         17700002
         TM    DCBDSORG-IHADCB(R6),ISAM IS DEB ISAM DATA SET?           17750002
PABEND2  DS    0H                                                       17800002
         BZ    NOTISAM1            NO, GO ON                            17850002
         OI    OUTPUTSW,ISAMBIT    YES, INDICATE FOR LATER PROCESSING   17900002
NOTISAM1 DS    0H                                                       17950002
         L     R8,TSTANSPL         FIND ADDRESS OF PARSE PDL            18000002
         USING IKJPARMD,R8         ESTABLISH PDL ADDRESSABILITY         18050002
         CLI   DEBFIELD+N1,HEX00   WAS FIELD SPECIFIED                  18100002
         BNE   PRINTCHK            IF SPECIFIED CHECK FOR PRINT KEYWORD 18150002
         OI    OUTPUTSW,ALLCHECK                                        18200002
         MVI   NMSUB,HEXFF         INDICATE THAT FIRST FIELD IS DESIRED 18250002
         MVC   NMSUB+N1(NMTRK-NMSUB+N1),NMSUB  INDICATE ALL FDS         18300002
PRINTCHK DS    0H                                                       18350002
         CLI   PRINT+N1,HEX00      WAS A PRINT DATA SET SPECIFIED       18400002
         BNE   PRNTSPEC            IF NOT ZERO PRINT WAS SPECIFIED      18450002
         SR    R2,R2                                                    18500002
         B     TABLESCN            GO CHECK OUTPUT LINE LENGTH          18550002
PRNTSPEC LA    R2,DSNAM                                                 18600002
         OI    TSTFLGS1,TSTPRINT                                        18650002
         EJECT                                                          18700002
*********************************************************************** 18750002
* THE FOLLOWING CODE STARTS WITH THE FIRST FIELD PDE AND DETERMINES   * 18800002
* WHETHER OR NOT THE FIELD CORRESPONDING TO THAT PDE IS DESIRED.  IF  * 18850002
* IT IS, CONTROL IS PASSED TO THE PROPER SUBROUTINE.  IF NOT, THE NEXT* 18900002
* PDE IS CHECKED UNTIL ALL THE PDE'S HAVE BEEN EXAMINED.              * 18950002
*********************************************************************** 19000002
         SPACE 1                                                        19050002
TABLESCN DS    0H                                                       19100002
         LA    R4,N40              MINIMUM LINE LENGTH                  19150002
         CH    R4,TMPLL            IS USER SPECIFIED LINE LENGTH LESS   19200002
         BH    LL80                YES, GO USE 80 FOR LINE LENGTH       19250002
         LA    R4,N80              NO, MAXIMUM LINE LENGTH              19300002
         CH    R4,TMPLL            IS SPECIFIED LINE LENGTH GREATER     19350002
         BL    LL80                YES, GO USE 80 FOR LINE LENGTH       19400002
         LH    R4,TMPLL            NO, USE SPECIFIED LINE LENGTH        19450002
         B     LINESET             GO SET LINE LENGTH                   19500002
LL80     LA    R4,N80              DEFAULT LINE LENGTH TO 80            19550002
LINESET  ST    R4,LINELEN          STORE LINE LENGTH                    19600002
         ST    R2,PRINTFLG         INDICATE OUTPUT TO TERM OR DS        19650002
         L     R10,OUTBUF          ADDRESS OF OUTPUT BUFFER             19700002
         MVI   N4(R10),BLANK       CLEAR OUTPUT                         19750002
         MVC   N5(N79,R10),N4(R10)  BUFFER TO BLANKS                    19800002
         LA    R11,BUFFER          ADDR OF DEB BUFF FOR CONVERTED FLDS  19850002
         MVC   N0(N80,R11),N4(R10) CLEAR DEB FIELD BUFFER               19900002
NMTRY1   DS    0H                  NEXT INSTRUCTION MAY ABEND           19950002
         MVC   NMEXTSTR(N1),DEBNMEXT-DEBBASIC(R3)  NUM OF EXTS          20000002
NMTRY2   DS    0H                  PREV NEXT INSTRS MAY ABEND           20050002
         MVC   EXTCTR(N1),DEBNMEXT-DEBBASIC(R3) ALSO IN EXT CTR         20100002
NMTRY3   DS    0H                  PREV & NEXT INSTRS MAY ABEND         20150002
         CLI   DEBEXSCL-DEBBASIC(R3),HEX04 IS DEB A DASD DATASET        20200002
EXTRY1   DS    0H                  PREVIOUS INSTR MAY ABEND             20250002
         BE    CHECKEXT            YES, GO CHECK NUMBER OF EXTENTS      20300002
         OI    OUTPUTSW,NOTDASD    NO, INDICATE WHY NO DASD SECTION     20350002
         B     SETPTRS             GO SET UP TO SEARCH FIELD PDE        20400002
CHECKEXT DS    0H                                                       20450002
         CLI   DEBNMEXT-DEBBASIC(R3),HEX00  ARE THEIR EXTENTS           20500002
EXTRY2   DS    0H                  PREVIOUS INSTR MAY ABEND             20550002
         BNE   SETPTRS             YES, GO SET UP FIELD PDE SEARCH      20600002
         OI    OUTPUTSW,NOEXTENT   NO, INDICATE WHY NO DASD SECTION     20650002
SETPTRS  DS    0H                                                       20700002
         LA    R2,DVMOD                                                 20750002
         ST    R2,FSTPDEND         ADDR OF 1ST PDE OF 2ND SECTION       20800002
         LA    R2,NMTRK            ADDR OF LAST PDE OF 2ND SECTION      20850002
         LA    R2,N2(R2)           ADDRESS GREATER THAN LAST PDE        20900002
         ST    R2,LASTPDE          SAVE FOR END INDICATOR               20950002
         LA    R6,NMSUB            POINT TO FIRST PDE                   21000002
         SR    R2,R2                                                    21050002
         L     R4,PCLADDR          ADDRESS OF PARSE CSECT               21100002
         USING IKJEGDBP,R4                                              21150002
PDECHECK CLI   N1(R6),HEX00        WAS THIS FIELD SPECIFIED             21200002
         BNE   SBRTNSVR            IF FIELD IS REQUESTED BRANCH         21250002
         LA    R6,N2(R6)           OTHERWISE POINT TO NEXT PDE          21300002
         C     R6,LASTPDE          ARE THERE MORE PDES                  21350002
         BE    PDLEND              IF NO MORE BRANCH TO PDLEND          21400002
         B     PDECHECK            CHECK THE NEXT PDE                   21450002
SBRTNSVR DS    0H                                                       21500002
         LR    R11,R6              PRESERVE R6                          21550002
         LA    R7,NMSUB            ADDRESS OF FIRST PDE                 21600002
         SR    R11,R7              FIND RELATIVE POSITION OF PDE        21650002
         LA    R10,N11             LOAD MULT FACTOR - EACH              21700002
*                                  SUBRTN IS 22 BYTES                   21750002
*                                  LONG, 11 IS HALF                     21800002
         LA    R7,SUBTAB1          LOAD ADDRESS OF TABLE                21850002
         MR    R10,R10             COMPUTE PROPER OFFSET                21900002
         AR    R7,R11              ADD OFFSET TO BASE                   21950002
         BR    R7                  GO TO PROPER SUBROUTINE              22000002
         EJECT                                                          22050002
*********************************************************************** 22100002
*   THE FOLLOWING CODE CONSISTS OF 26 SUBROUTINES CORRESPONDING       * 22150002
*   TO THE 26 FIELDS OF THE DEB.  EACH SUBROUTINE MOVES THE RELATIVE  * 22200002
*   ADDRESS, HEADER LENGTH, FIELD LENGTH, AND HEADER TO A COMMON      * 22250002
*   BUFFER.  CONTROL IS THEN PASSED TO A COMMON CONVERSION AND        * 22300002
*   I/O ROUTINE.  IT IS ESSENTIAL FOR PROPER LOGIC FLOW THAT EACH     * 22350002
*   SUBROUTINE HAVE THE SAME LENGTH                                   * 22400002
*********************************************************************** 22450002
         SPACE 1                                                        22500002
SUBTAB1  DS    0H                                                       22550002
DEB00B   MVC   HDRBUF(N5),HDRNMSUB FIELD HEADER TO HEADER BUFFER        22600002
         MVI   HDRLEN,N5           LENGTH OF FIELD HEADER               22650002
         MVI   FLDLEN,L'DEBNMSUB   LENGTH OF DEB FIELD                  22700002
         MVI   RELADR,DEBNMSUB-DEBBASIC DISP OF FIELD INTO DEB          22750002
         B     HEADERCK            GO CHECK FOR SECTION HEADER          22800002
DEB01B   MVC   HDRBUF(N5),HDRTCBAD FIELD HEADER TO FIELD BUFFER         22850002
         MVI   HDRLEN,N5           LENGTH OF DEB FIELD HEADER           22900002
         MVI   FLDLEN,L'DEBTCBB    LENGTH OF DEB FIELD                  22950002
         MVI   RELADR,DEBTCBB-DEBBASIC DISP OF FIELD INTO DEB           23000002
         B     CVTANDIO            GO CONVERT FIELD TO PRINTABLE        23050002
DEB04B   MVC   HDRBUF(N5),HDRAMLNG FIELD HEADER TO HEADER BUFFER        23100002
         MVI   HDRLEN,N5           LENGTH OF DEB FIELD HEADER           23150002
         MVI   FLDLEN,L'DEBAMLNG   LENGTH OF DEB FIELD                  23200002
         MVI   RELADR,DEBAMLNG-DEBBASIC DISP OF FIELD INTO DEB          23250002
         B     CVTANDIO            GO CONVERT FIELD TO PRINTABLE        23300002
DEB05B   MVC   HDRBUF(N5),HDRDEBAD FIELD HEADER TO HEADER BUFFER        23350002
         MVI   HDRLEN,N5           LENGTH OF DEB FIELD HEADER           23400002
         MVI   FLDLEN,L'DEBDEBB    LENGTH OF DEB FIELD                  23450002
         MVI   RELADR,DEBDEBB-DEBBASIC DISP OF FIELD INTO DEB           23500002
         B     CVTANDIO            GO CONVERT FIELD TO PRINTABLE        23550002
DEB08B   MVC   HDRBUF(N5),HDROFLGS FIELD HEADER TO HEADER BUFFER        23600002
         MVI   HDRLEN,N5           LENGTH OF DEB FIELD HEADER           23650002
         MVI   FLDLEN,L'DEBOFLGS   LENGTH OF DEB FIELD                  23700002
         MVI   RELADR,DEBOFLGS-DEBBASIC DISP OF FIELD INTO DEB          23750002
         B     CVTANDIO            GO CONVERT FIELD TO PRINTABLE        23800002
DEB11B   MVC   HDRBUF(N5),HDRIRBAD FIELD HEADER TO HEADER BUFFER        23850002
         MVI   HDRLEN,N5           LENGTH OF DEB FIELD HEADER           23900002
         MVI   FLDLEN,L'DEBIRBB    LENGTH OF DEB FIELD                  23950002
         MVI   RELADR,DEBIRBB-DEBBASIC DISP OF FIELD INTO DEB           24000002
         B     CVTANDIO            GO CONVERT FIELD TO PRINTABLE        24050002
DEB12B   MVC   HDRBUF(N5),HDROPATB FIELD HEADER TO HEADER BUFFER        24100002
         MVI   HDRLEN,N5           LENGTH OF DEB FIELD HEADER           24150002
         MVI   FLDLEN,L'DEBOPATB   LENGTH OF DEB FIELD                  24200002
         MVI   RELADR,DEBOPATB-DEBBASIC DISP OF FIELD INTO DEB          24250002
         B     CVTANDIO            GO CONVERT FIELD TO PRINTABLE        24300002
DEB13B   MVC   HDRBUF(N5),HDRQSCNT FIELD HEADER TO HEADER BUFFER        24350002
         MVI   HDRLEN,N5           LENGTH OF DEB FIELD HEADER           24400002
         MVI   FLDLEN,L'DEBQSCNT   LENGTH OF DEB FIELD                  24450002
         MVI   RELADR,DEBQSCNT-DEBBASIC DISP OF FIELD INTO DEB          24500002
         B     CVTANDIO            GO CONVERT FIELD TO PRINTABLE        24550002
DEB14B   MVC   HDRBUF(N5),HDRFLGS1 FIELD HEADER TO HEADER BUFFER        24600002
         MVI   HDRLEN,N5           LENGTH OF DEB FIELD HEADER           24650002
         MVI   FLDLEN,L'DEBFLGS1   LENGTH OF DEB FIELD                  24700002
         MVI   RELADR,DEBFLGS1-DEBBASIC DISP OF FIELD INTO DEB          24750002
         B     CVTANDIO            GO CONVERT FIELD TO PRINTABLE        24800002
DEB15B   MVC   HDRBUF(L'HDRRSRVD),HDRRSRVD                              24850002
         MVI   HDRLEN,L'HDRRSRVD   LENGTH OF DEB FIELD HEADER           24900002
         MVI   FLDLEN,N1           LENGTH OF DEB FIELD                  24950002
         MVI   RELADR,N15          DISPLACEMENT OF FIELD INTO DEB       25000002
         B     CVTANDIO            GO CONVERT FIELD TO PRINTABLE        25050002
DEB16B   MVC   HDRBUF(N5),HDRNMEXT FIELD HEADER TO HEADER BUFFER        25100002
         MVI   HDRLEN,N5           LENGTH OF DEB FIELD HEADER           25150002
         MVI   FLDLEN,L'DEBNMEXT   LENGTH OF DEB FIELD                  25200002
         MVI   RELADR,DEBNMEXT-DEBBASIC DISP OF FIELD INTO DEB          25250002
         B     CVTANDIO            GO CONVERT FIELD TO PRINTABLE        25300002
DEB17B   MVC   HDRBUF(N5),HDRUSPRG FIELD HEADER TO HEADER BUFFER        25350002
         MVI   HDRLEN,N5           LENGTH OF DEB FIELD HEADER           25400002
         MVI   FLDLEN,L'DEBUSRPB   LENGTH OF DEB FIELD                  25450002
         MVI   RELADR,DEBUSRPB-DEBBASIC DISP OF FIELD INTO DEB          25500002
         B     CVTANDIO            GO CONVERT FIELD TO PRINTABLE        25550002
DEB20B   MVC   HDRBUF(N5),HDRPRIOR FIELD HEADER TO HEADER BUFFER        25600002
         MVI   HDRLEN,N5           LENGTH OF DEB FIELD HEADER           25650002
         MVI   FLDLEN,L'DEBPRIOR   LENGTH OF DEB FIELD                  25700002
         MVI   RELADR,DEBPRIOR-DEBBASIC DISP OF FIELD INTO DEB          25750002
         B     CVTANDIO            GO CONVERT FIELD TO PRINTABLE        25800002
DEB21B   MVC   HDRBUF(N5),HDRECBAD FIELD HEADER TO HEADER BUFFER        25850002
         MVI   HDRLEN,N5           LENGTH OF DEB FIELD HEADER           25900002
         MVI   FLDLEN,L'DEBECBB    LENGTH OF DEB FIELD                  25950002
         MVI   RELADR,DEBECBB-DEBBASIC DISP OF FIELD INTO DEB           26000002
         B     CVTANDIO            GO CONVERT FIELD TO PRINTABLE        26050002
DEB24B1  MVC   HDRBUF(L'HDRPROTG),HDRPROTG                              26100002
         MVI   HDRLEN,L'HDRPROTG   LENGTH OF DEB FIELD HEADER           26150002
         MVI   FLDLEN,L'DEBPROTG   LENGTH OF DEB FIELD                  26200002
         MVI   RELADR,DEBPROTG-DEBBASIC DISP OF FIELD INTO DEB          26250002
         B     CVTANDIO            GO CONVERT FIELD TO PRINTABLE        26300002
DEB25B   MVC   HDRBUF(N5),HDRDCBAD FIELD HEADER TO HEADER BUFFER        26350002
         MVI   HDRLEN,N5           LENGTH OF DEB FIELD HEADER           26400002
         MVI   FLDLEN,L'DEBDCBB    LENGTH OF DEB FIELD                  26450002
         MVI   RELADR,DEBDCBB-DEBBASIC DISP OF FIELD INTO DEB           26500002
         B     CVTANDIO            GO CONVERT FIELD TO PRINTABLE        26550002
DEB28B   MVC   HDRBUF(N5),HDREXSCL FIELD HEADER TO HEADER BUFFER        26600002
         MVI   HDRLEN,N5           LENGTH OF DEB FIELD HEADER           26650002
         MVI   FLDLEN,L'DEBEXSCL   LENGTH OF DEB FIELD                  26700002
         MVI   RELADR,DEBEXSCL-DEBBASIC DISP OF FIELD INTO DEB          26750002
         B     CVTANDIO            GO CONVERT FIELD TO PRINTABLE        26800002
DEB29B   MVC   HDRBUF(N5),HDRAPPAD FIELD HEADER TO HEADER BUFFER        26850002
         MVI   HDRLEN,N5           LENGTH OF DEB FIELD HEADER           26900002
         MVI   FLDLEN,L'DEBAPPB    LENGTH OF DEB FIELD                  26950002
         MVI   RELADR,DEBAPPB-DEBBASIC DISP OF FIELD INTO DEB           27000002
         B     CVTANDIO            GO CONVERT FIELD TO PRINTABLE        27050002
         EJECT                                                          27100002
*********************************************************************** 27150002
*   THE FOLLOWING ROUTINES HANDLE THE DIRECT ACCESS SECTIONS          * 27200002
*********************************************************************** 27250002
         SPACE 1                                                        27300002
DEB00DA  MVC   HDRBUF(N5),HDRDVMOD FIELD HEADER TO HEADER BUFFER        27350002
         MVI   HDRLEN,N5           LENGTH OF DEB FIELD HEADER           27400002
         MVI   FLDLEN,L'DEBDVMOD   LENGTH OF FIELD                      27450002
         MVI   RELADR,DEBDVMOD-DEBDASD DISPL FIELD INTO DASD SEC        27500002
         B     FIRSTSEC            GO CHECK FOR ALL FIELDS REQUESTED    27550002
DEB01DA  MVC   HDRBUF(N5),HDRUCBAD FIELD HEADER TO HEADER BUFFER        27600002
         MVI   HDRLEN,N5           LENGTH OF DEB FIELD HEADER           27650002
         MVI   FLDLEN,L'DEBUCBA    LENGTH OF DEB FIELD                  27700002
         MVI   RELADR,DEBUCBA-DEBDASD DISPL FIELD INTO DASD SEC         27750002
         B     SECNDSEC            GO CHECK POINTER TO DASD SECTION     27800002
DEB04DA  MVC   HDRBUF(N5),HDRBINUM FIELD HEADER TO HEADER BUFFER        27850002
         MVI   HDRLEN,N5           LENGTH OF DEB FIELD HEADER           27900002
         MVI   FLDLEN,L'DEBBINUM   LENGTH OF DEB FIELD                  27950002
         MVI   RELADR,DEBBINUM-DEBDASD DISPL FIELD INTO DASD SEC        28000002
         B     SECNDSEC            GO CHECK POINTER TO DASD SECTION     28050002
DEB06DA  MVC   HDRBUF(N5),HDRSTRCC FIELD HEADER TO HEADER BUFFER        28100002
         MVI   HDRLEN,N5           LENGTH OF DEB FIELD HEADER           28150002
         MVI   FLDLEN,L'DEBSTRCC   LENGTH OF DEB FIELD                  28200002
         MVI   RELADR,DEBSTRCC-DEBDASD DISPL FIELD INTO DASD SEC        28250002
         B     SECNDSEC            GO CHECK POINTER TO DASD SECTION     28300002
DEB08DA  MVC   HDRBUF(N5),HDRSTRHH FIELD HEADER TO HEADER BUFFER        28350002
         MVI   HDRLEN,N5           LENGTH OF DEB FIELD HEADER           28400002
         MVI   FLDLEN,L'DEBSTRHH   LENGTH OF DEB FIELD                  28450002
         MVI   RELADR,DEBSTRHH-DEBDASD DISPL FIELD INTO DASD SEC        28500002
         B     SECNDSEC            GO CHECK POINTER TO DASD SECTION     28550002
DEB10DA  MVC   HDRBUF(N5),HDRENDCC FIELD HEADER TO HEADER BUFFER        28600002
         MVI   HDRLEN,N5           LENGTH OF DEB FIELD HEADER           28650002
         MVI   FLDLEN,L'DEBENDCC   LENGTH OF DEB FIELD                  28700002
         MVI   RELADR,DEBENDCC-DEBDASD DISPL FIELD INTO DASD SEC        28750002
         B     SECNDSEC            GO CHECK POINTER TO DASD SECTION     28800002
DEB12DA  MVC   HDRBUF(N5),HDRENDHH FIELD HEADER TO HEADER BUFFER        28850002
         MVI   HDRLEN,N5           LENGTH OF DEB FIELD HEADER           28900002
         MVI   FLDLEN,L'DEBENDHH   LENGTH OF DEB FIELD                  28950002
         MVI   RELADR,DEBENDHH-DEBDASD DISPL FIELD INTO DASD SEC        29000002
         B     SECNDSEC            GO CHECK POINTER TO DASD SECTION     29050002
DEB14DA  MVC   HDRBUF(N5),HDRNMTRK FIELD HEADER TO FIELD BUFFER         29100002
         MVI   HDRLEN,N5           LENGTH OF DEB FIELD HEADER           29150002
         MVI   FLDLEN,L'DEBNMTRK   LENGTH OF DEB FIELD                  29200002
         MVI   RELADR,DEBNMTRK-DEBDASD DISPL FIELD INTO DASD SEC        29250002
         B     SECNDSEC            GO CHECK POINTER TO DASD SECTION     29300002
         EJECT                                                          29350002
*                                                                       29400002
*        ANALYZE POSITION IN DEB                                        29450002
*                                                                       29500002
FIRSTSEC DS    0H                                                       29550002
         TM    OUTPUTSW,ANYSECND   IS THEIR A DIRECT ACCESS SECTION     29600002
         BM    NOSECOND            NO, GO CLEAN UP AND GIVE MESSAGE     29650002
         TM    OUTPUTSW,ALLCHECK   ARE ALL FIELDS REQUESTED             29700002
         BO    HEADERCK            YES, GO PUT OUT DASD SECTION HDR     29750002
SECNDSEC DS    0H                                                       29800002
         TM    OUTPUTSW,ANYSECND   IS THEIR A DIRECT ACCESS SECTION     29850002
         BM    NOSECOND            NO, GO CLEAN UP AND GIVE MESSAGE     29900002
         TM    OUTPUTSW,DASDSEC    IS POINTER TO SECOND SECTION OK      29950002
         BO    CVTANDIO            YES, GO CONVERT FIELD                30000002
         LTR   R2,R2               IS THEIR PREVIOUS OUTPUT             30050002
         BZ    SETSECPT            NO, GO POINT TO DASD SECTION         30100002
         L     R10,OUTBUF          POINT TO OUTPUT BUFFER               30150002
         LA    R14,N2(R2)          SET LENGTH OF OUTPUT                 30200002
         SLL   R14,N16             LENGTH IN HIGH ORDER HALF            30250002
         ST    R14,N0(R10)         PREFIX OUTPUT WITH LENGTH            30300002
         NI    OUTPUTSW,(HEXFF-FLDCHECK)                                30350002
         OI    OUTPUTSW,HDRCHECK                                        30400002
         BAL   R14,DEBIO           GO PUT OUT FIRST SECTION HDRS        30450002
*                                   AND FIELD DATA                      30500002
         SR    R2,R2               NO OUTPUT TO PUT OUT                 30550002
SETSECPT DS    0H                                                       30600002
         LA    R3,DEBBASND-DEBBASIC(R3)  POINT TO SEC SEC-DASD          30650002
         TM    OUTPUTSW,ISAMBIT    IS DEB FOR A ISAM DATASET            30700002
         BZ    NOTISAM2            NO, GO ON                            30750002
         LA    R3,DEBEXPTA-DEBBASND+L'DEBEXPTA(R3) YES,SKIP ISAM        30800002
NOTISAM2 DS    0H                                                       30850002
         OI    OUTPUTSW,DASDSEC    INDICATE POINTER TO DASD SEC OK      30900002
         B     CVTANDIO            GO CONVERT DEB FIELD                 30950002
HEADERCK DS    0H                                                       31000002
         TM    OUTPUTSW,ALLCHECK   ARE ALL FIELDS REQUESTED             31050002
         BZ    CVTANDIO            IF NO PROCESS THE FIELD              31100002
         LTR   R2,R2               IS THERE PREVIOUS OUTPUT             31150002
         BZ    NOOUTPUT            NO, GO GET SECTION HEADERS           31200002
         L     R10,OUTBUF          POINT TO OUTPUT BUFFER               31250002
         LA    R14,N2(R2)          SET LENGTH OF OUTPUT                 31300002
         SLL   R14,N16             LENGTH IN HIGH ORDER HALFWORD        31350002
         ST    R14,N0(R10)         STORE IN OUTPUT BUFFER               31400002
         NI    OUTPUTSW,(HEXFF-FLDCHECK) INDICATE NOT A FIELD           31450002
         OI    OUTPUTSW,HDRCHECK   INDICATE A HEADER                    31500002
         BAL   R14,DEBIO           PUT OUT HEADER AND FIELD             31550002
         SR    R2,R2               RESET OUTPUT COUNTER                 31600002
NOOUTPUT C     R6,FSTPDEND         IN SECTION1 OR SECTION2              31650002
         L     R10,OUTBUF          POINT TO OUTPUT BUFFER               31700002
         BNL   SECT2IO             IF IN SECTION2 BRANCH                31750002
         MVC   N4(L'HEADER1,R10),HEADER1                                31800002
         LA    R14,L'HEADER1       LOAD LENGTH OF HEADER                31850002
         B     HDR10               OUTPUT THE HEADER                    31900002
SECT2IO  DS    0H                                                       31950002
         STM   R2,R3,DATAREG       SAVE WORK REGSITERS                  31960002
         SR    R0,R0               SPACE                                32000002
         L     R1,OUTBUF            A                                   32050002
         ST    R0,N0(R1)             LINE                               32100002
         LR    R2,R1               INDICATE NULL LINE COMING            32210002
         XC    TSTIOPRM,TSTIOPRM   CLEAR PARM LIST FOR I/O CALL         32260002
         IKJEGSIO DATA,DATAPTR=(R2),ID=DEB11,MF=(E,TSTIOPRM) CALL I/O   32310002
         LM    R2,R3,DATAREG       RESTORE REGISTERS                    32320002
         LTR   R15,R15             WAS I/O OK                           32350002
         BNZ   DEBRET              NO, GO SET UP RETURN                 32400002
         MVC   N4(L'HEADER2,R10),HEADER2    MOVE HEADER TO BUFFER       32450002
         LA    R14,L'HEADER2                                            32500002
         NI    OUTPUTSW,(HEXFF-ALLCHECK)                                32550002
         LA    R3,DEBBASND-DEBBASIC(R3)  ADDR OF 1ST DASD SEC           32600002
         TM    OUTPUTSW,ISAMBIT    IS DEB FOR A ISAM DATASET            32650002
         BZ    NOTISAM3            NO, GO ON                            32700002
         LA    R3,DEBEXPTA-DEBBASND+L'DEBEXPTA(R3) YES,SKIP ISAM        32750002
NOTISAM3 DS    0H                                                       32800002
         OI    OUTPUTSW,DASDSEC    INDICATE PTR TO SECOND SECTION OK    32850002
HDR10    LA    R14,N4(R14)         SET LENGTH OF OUTPUT                 32900002
         NI    OUTPUTSW,(HEXFF-HDRCHECK-FLDCHECK)                       32950002
         SLL   R14,N16             LENGTH IN HIGH ORDER HALFWORD        33000002
         ST    R14,N0(R10)         STORE LENGTH IN OUTPUT BUFFER        33050002
         BAL   R14,DEBIO           PUT OUT THE HEADER                   33100002
         SPACE 1                                                        33150002
*********************************************************************** 33200002
*   THE FOLLOWING CODE DETERMINES WHETHER THE OUTPUT LINE IS ALREADY  * 33250002
*   FULL.  IF FULL CONTROL IS PASSED TO DEBIO.  WHEN THIS SECTION IS  * 33300002
*   REACHED, R6 POINTS TO THE PDE OF THE FIELD BEING PROCESSED, AND   * 33350002
*   FLDLEN, HDRLEN, RELADR, AND HDRBUF CONTAIN THE PROPER INFORMATION * 33400002
*   FOR THAT FIELD.                                                   * 33450002
*********************************************************************** 33500002
         SPACE 1                                                        33550002
CVTANDIO DS    0H                                                       33600002
         SR    R7,R7                                                    33650002
         SR    R10,R10                                                  33700002
         IC    R7,FLDLEN           LOAD FIELD LENGTH                    33750002
         IC    R10,HDRLEN          LOAD HEADER LENGTH                   33800002
         AR    R7,R7               DOUBLE FOR TRUE PRINTABLE LENGTH     33850002
         CR    R7,R10              WHICH IS LONGER                      33900002
         BH    FLDLONGR            IF FIELD IS LONGER, BRANCH           33950002
         LR    R7,R10              R7 CONTAINS OUTPUT LENGTH            34000002
FLDLONGR AR    R7,R2               CALCULATE TOTAL NEW OUTPUT LENGTH    34050002
         C     R7,LINELEN          IS THERE ROOM FOR THIS FIELD         34100002
         BNH   MOREROOM            BRANCH IF THE FIELD CAN FIT          34150002
         L     R11,OUTBUF          POINT TO OUTPUT BUFFER               34200002
         LA    R10,N2(R2)          LENGTH OF OUTPUT BUFFER              34250002
         SLL   R10,N16             LENGTH IN HIGH ORDER HALFWORD        34300002
         ST    R10,N0(R11)         STORE LENGTH OF OUTPUT               34350002
         TM    OUTPUTSW,HDRCHECK                                        34400002
         BZ    HEADERIO            GO SET UP TO OUTPUT FIELD HDRS       34450002
         OI    OUTPUTSW,FLDCHECK                                        34500002
         B     DEBIOGO             GO SETUP TO OUTPUT LINE              34550002
HEADERIO NI    OUTPUTSW,(HEXFF-FLDCHECK)                                34600002
         OI    OUTPUTSW,HDRCHECK                                        34650002
DEBIOGO  BAL   R14,DEBIO           GO TO INTERNAL I/O ROUTINE           34700002
         SR    R7,R2               RESET LENGTH OF FIELD TO BE CONVRTED 34750002
         ST    R6,FSTADDR                                               34800002
         SR    R2,R2               SET OUTPUT LENGTH TO ZERO            34850002
          SPACE                                                         34900002
*********************************************************************** 34950002
*   THE FOLLOWING CODE IS REACHED WHEN THERE IS MORE ROOM IN THE      * 35000002
*   OUTPUT BUFFER.  IT SETS UP FOR DEBCVT WHICH WILL CONVERT THE      * 35050002
*   FIELD TO PRINTABLE HEXADECIMAL AND MOVE THE HEADERS AND FIELD     * 35100002
*   TO THE PROPER BUFFERS                                             * 35150002
*********************************************************************** 35200002
          SPACE                                                         35250002
MOREROOM DS    0H                                                       35300002
         LTR   R2,R2                                                    35350002
         BNZ   RESET               MORE ROOM IN BUFFER, GO ADD          35400002
         ST    R6,FSTADDR                                               35450002
RESET    SR    R7,R2                                                    35500002
         SR    R10,R10                                                  35550002
         IC    R10,RELADR          FIND OFFSET OF FIELD                 35600002
         AR    R10,R3              ADD OFFSET TO BASE                   35650002
         SR    R1,R1               ZERO R1                              35700002
         IC    R1,FLDLEN           PUT FIELD LENGTH IN R1               35750002
         BCTR  R1,R0               DECREMENT FOR MOVE                   35800002
         LA    R11,TEMPAREA        GET ADDRESS OF TEMP STORAGE          35850002
*                                  AREA DATA TO BE TRANSLATED           35900002
MOVETRY1 DS    0H                  NEXT INSTRUCTION MAY ABEND           35950002
         EX    R1,MOVE1            MOVE DATA FROM DEB TEMPAREA          36000002
MOVETRY2 DS    0H                  PREVIOUS INSTR MAY ABEND             36050002
         ST    R11,STRNGPTR        STORE IN LIST FOR IKJEGCVT           36100002
         SPACE 1                                                        36150002
*********************************************************************** 36200002
*  THE FOLLOWING CODE SETS UP THE PARAMETER LIST FOR IKJEGCVT WHICH   * 36250002
*  WILL CONVERT THE DEB FIELD TO PRINTABLE HEXADECIMAL.  IT THEN      * 36300002
*  DETERMINES WHETHER THE HEADER FOR THAT FIELD HAS BEEN OUTPUTTED,   * 36350002
*  AND MOVES THE CONVERTED FIELD TO THE PROPER BUFFER.                * 36400002
*********************************************************************** 36450002
         SPACE                                                          36500002
DEBCVT   DS    0H                                                       36550002
         MVI   CVTLL,HEX00         ZERO OUT TOP BYTE OF LENGTH          36600002
         MVC   CVTLL+N1(N1),FLDLEN   MOVE LENGTH OF FIELD TO PARM LIST  36650002
         MVI   FLAGS,FLAG          MOVE FLAG TO LIST                    36700002
         MVI   TYPE,TYPECODE       MOVE IN CODE FOR HEX                 36750002
         LA    R1,STRNGPTR         POINT TO PARM LIST                   36800002
         LCR   R0,R1               R0 NEGATIVE FOR CONVERT TO PRINTABLE 36850002
         L     R15,TSTCONVT        LOAD ADDRESS OF IKJEGCVT             36900002
         BALR  R14,R15             GO TO IKJEGCVT                       36950002
         LTR   R15,R15             IS RETURN CODE 0                     37000002
         BNZ   DEBRET              IF NO BRANCH                         37050002
         L     R10,CONAREA         LOAD ADDRESS OF CONVERTED FIELDS     37100002
         TM    OUTPUTSW,HDRCHECK   IS HEADER OUT                        37150002
         BZ    HDRNTOUT            BRANCH IF NOT OUT YET                37200002
         L     R11,OUTBUF          POINT TO OUTPUT BUFFER               37250002
         AR    R11,R2              SKIP PREVIOUS DATA                   37300002
         IC    R1,FLDLEN           GET LENGTH OF FIELD                  37350002
         AR    R1,R1               DOUBLE FOR PRINTABLE LENGTH          37400002
         BCTR  R1,R0               LEN-1 FOR EXECUTE INSTR              37450002
         EX    R1,MOVE2            MOVE CONVERTED FIELD TO OUTBUF       37500002
         B     CVTRTRN             GO CHECK FOR MORE FIELDS             37550002
HDRNTOUT LA    R11,BUFFER          POINT TO FIELD BUFFER                37600002
         AR    R11,R2                                                   37650002
         IC    R1,FLDLEN           GET LENGTH OF FIELD                  37700002
         AR    R1,R1               DOUBLE FOR PRINTABLE LENGTH          37750002
         BCTR  R1,R0               LEN-1 FOR EXECUTE INSTR              37800002
         EX    R1,MOVE3            MOVE FIELD TO BUFFER IN WORKAREA     37850002
         L     R11,OUTBUF          ADDRESS OF OUTPUT BUFFER             37900002
         LA    R10,HDRBUF          ADDRESS OF HEADER BUFFER             37950002
         AR    R11,R2                                                   38000002
         SR    R1,R1                                                    38050002
         IC    R1,HDRLEN           GET HEADER LENGTH                    38100002
         BCTR  R1,R0               LEN-1 FOR EXECUTE INSTR              38150002
         EX    R1,MOVE4            MOVE FIELD HEADER TO OUTBUF          38200002
CVTRTRN  LA    R6,N2(R6)                                                38250002
         LA    R2,N2(R2)           SET FOR TWO SPACES BETWEEN FIELDS    38300002
         AR    R2,R7                                                    38350002
         C     R6,LASTPDE          ARE THERE ANY MORE PDE'S             38400002
         BE    PDLEND              BRANCH IF NO                         38450002
         B     PDECHECK            GO CHECK NEXT PDE                    38500002
          SPACE                                                         38550002
*********************************************************************** 38600002
* THE FOLLOWING CODE CONTAINS THE HEART OF THE LOGIC OF THE PROGRAM.  * 38650002
* IT SETS UP THE PARAMETER LIST FOR IKJEGIO1 WHICH WILL OUTPUT THE    * 38700002
* LINE OF DATA.  IT THEN DETERMINES WHAT KIND OF DATA, WHETHER HEADER * 38750002
* OR FIELD, WAS OUTPUTTED.  IF FIELD DATA WAS PUT OUT IT CHECKS FOR   * 38800002
* FURTHER EXTENTS OF THOSE FIELDS, AND FOR FURTHER FIELDS.  IF A      * 38850002
* FIELD HEADER WAS PUT OUT IT SETS UP THE BUFFERS AND THE PARAMETER   * 38900002
* LIST TO OUTPUT THE CORRESPONDING FIELDS.                            * 38950002
* UPON REACHING THIS SECTION, R2 CONTAINS THE OUTPUT LINE LENGTH,     * 39000002
* OUTPUTSW INDICATES THE KIND OF DATA IN THE BUFFER, R6 POINTS TO THE * 39050002
* PDE OF THE NEXT FIELD, EXTCTR CONTAINS THE NUMBER OF REMAINING      * 39100002
* EXTENTS, AND R3 POINTS TO THE DEB.                                  * 39150002
*********************************************************************** 39200002
         SPACE                                                          39250002
DEBIO    DS    0H                                                       39300002
         OI    OUTPUTSW,SOMEOUT    INDICATE WE PUT OUT A LINE           39350002
         L     R1,OUTBUF           POINT TO BUFFER                      39400002
         ST    R1,OUTPTR1          STORE POINTER IN LIST                39450002
         L     R0,PRINTFLG                                              39500002
         SR    R1,R1                                                    39550002
         ST    R1,PRINTFLG                                              39600002
         ST    R1,OUTPTR2          ZERO OUT SECOND WORD OF LIST         39650002
         LA    R1,OUTPTR1          POINT TO PARM LIST                   39700002
         STM   R2,R3,DATAREG       SAVE WORK REGISTERS                  39710002
         L     R2,OUTPTR1          PICK UP DATA LINE POINTER            39720002
         LR    R3,R0               TRANSFER DSNPDE IF ONE               39730002
         ST    R14,REG14           STORE RETURN ADDRESS                 39732002
         XC    TSTIOPRM,TSTIOPRM   CLEAR PARM LIST FOR I/O CALL         39740002
         IKJEGSIO DATA,DATAPTR=(R2),DSNAME=(R3),ID=DEB11,              *39742002
               MF=(E,TSTIOPRM)                                          39744002
         LM    R2,R3,DATAREG       RESTORE WORKREGS                     39794002
         LTR   R15,R15             IS RETURN CODE 0                     39900002
         BNZ   DEBRET              IF NO RETURN                         39950002
         L     R10,OUTBUF                                               40000002
         MVI   N4(R10),BLANK                                            40050002
         MVC   N5(N79,R10),N4(R10)                                      40100002
         L     R14,REG14           RESTORE RETURN ADDRESS               40150002
         TM    OUTPUTSW,FLDCHECK   WAS A FIELD JUST PUT OUT             40200002
         BZ    FURTHRCK            BRANCH IF NOT A FIELD                40250002
BRANCH2  DS    0H                  CONVERTED FIELDS WERE JUST PUT OUT   40300002
         BCTR  R6,R0               POINT BACK                           40350002
         BCTR  R6,R0                 TO PDE                             40400002
         LA    R10,BUFFER                                               40450002
         MVI   N0(R10),BLANK                                            40500002
         MVC   N1(N79,R10),N0(R10)                                      40550002
         CLC   FSTADDR(N4),FSTPDEND   IN BASIC OR DASD SECTION          40600002
         BL    S1OUTPUT            IF IN SECTION1 BRANCH                40650002
         LA    R6,N2(R6)                                                40700002
         SR    R10,R10                                                  40750002
         IC    R10,EXTCTR          LOAD EXTENT COUNTER                  40800002
         BCTR  R10,R0              DECREMENT EXTENT COUNTER             40850002
         STC   R10,EXTCTR                                               40900002
         LTR   R10,R10             ARE THERE MORE EXTENTS               40950002
         BZ    NOMOREXT            BRANCH IF NO MORE                    41000002
         L     R6,FSTADDR          POINT TO FIRST PDE FOR OUTPUT LINE   41050002
         LA    R3,N16(R3)          POINT TO NEXT EXTENT                 41100002
         SR    R2,R2                                                    41150002
         B     PDECHECK            CHECK NEXT PDE                       41200002
FURTHRCK TM    OUTPUTSW,HDRCHECK   WAS A FIELD HEADER JUST PUT OUT      41250002
         BZ    BRANCH1             IF NO BRANCH TO SETUP RETURN         41300002
         LA    R10,BUFFER                                               41350002
         L     R11,OUTBUF                                               41400002
         LR    R1,R2                                                    41450002
         BCTR  R1,R0               LEN-1 FOR EXECUTE INSTR              41500002
         EX    R1,MOVE4            MOVE FIELDS TO OUTBUF                41550002
         OI    OUTPUTSW,FLDCHECK                                        41600002
         B     DEBIO               GO SETUP TO PUT OUT LINE             41650002
BRANCH1  BR    R14                 SECTION 1 OR 2 HEADER PUT OUT        41700002
NOMOREXT DS    0H                                                       41750002
         NI    OUTPUTSW,(HEXFF-HDRCHECK)     INDICATE NO HEADER YET     41800002
         MVC   EXTCTR(N1),NMEXTSTR  RESET EXTENT COUNTER FOR FIELDS     41850002
         L     R3,TSTANSPL         ADDRESS OF PDL                       41900002
         USING IKJPARMD,R3         R3 POINTS TO PDL                     41950002
         L     R3,PDEUSER-IKJPARMA+ADDRESS   ADDR DEB PDEUSER           42000002
         DROP  R3                  R3 NO LONGER PDL BASE                42050002
         LA    R3,DEBBASND-DEBBASIC(R3)  ADDRESS OF1ST DASD SEC         42100002
         BR    R14                 RETURN TO MAIN ROUTINE               42150002
S1OUTPUT LA    R6,N2(R6)           RESTORE PDE POINTER                  42200002
         NI    OUTPUTSW,(HEXFF-HDRCHECK)                                42250002
         NI    OUTPUTSW,(HEXFF-FLDCHECK)                                42300002
         BR    R14                 RETURN TO MAIN ROUTINE               42350002
         SPACE                                                          42400002
*********************************************************************** 42450002
*   THE FOLLOWING CODE IS REACHED WHEN THERE ARE NO MORE FIELDS.      * 42500002
*   IT CHECKS THE BUFFER FOR MORE DATA, IN WHICH CASE A BRANCH IS     * 42550002
*   MADE TO DEBIO.  IF THERE ARE MORE EXTENTS IS THEN PASSED TO       * 42600002
*   TABLESCN WHICH WILL PROCESS THE NEXT EXTENT.  OTHERWISE CONTROL   * 42650002
*   IS RETURNED AND PASSED TO DEBRET PRIOR TO RETURN TO IKJEGMN1.     * 42700002
*********************************************************************** 42750002
         SPACE 1                                                        42800002
PDLEND   DS    0H                                                       42850002
         LTR   R2,R2               IS THERE ANY MORE OUTPUT             42900002
         BNZ   PUTITOUT            YES, GO PUT OUT REST OF OUTPUT       42950002
         TM    OUTPUTSW,SOMEOUT    DID WE OUTPUT ANY FIELDS             43000002
         BO    DEBRET              YES, GO SET UP RETURN TO MAINLINE    43050002
         LA    R2,M0041            PICK UP ERROR MESSAGE NUMBER         43200002
         SR    R3,R3               INDICATE NO SECOND LEVEL             43210002
         B     MSGIO               GO PUT OUT MESSAGE                   43300002
PUTITOUT DS    0H                                                       43350002
         L     R10,OUTBUF          LOAD ADDRESS OF OUTPUT BUFFER        43400002
         LA    R1,N2(R2)           LENGTH OF OUTPUT BUFFER              43450002
         SLL   R1,N16              LENGTH IN HIGH ORDER HALFWORD        43500002
         ST    R1,N0(R10)          STORE LENGTH OF OUTPUT               43550002
         TM    OUTPUTSW,HDRCHECK                                        43600002
         BZ    TURNONHD            GO SET UP FOR FIELD HEADER           43650002
         OI    OUTPUTSW,FLDCHECK                                        43700002
         B     BRANCH              GO SET UP TO OUTPUT FIELDS           43750002
TURNONHD NI    OUTPUTSW,(HEXFF-FLDCHECK)                                43800002
         OI    OUTPUTSW,HDRCHECK                                        43850002
BRANCH   BAL   R14,DEBIO           GO SETUP TO OUTPUT LINE              43900002
         B     DEBRET              RETURN TO IKJEGMN1                   43950002
NOSECOND DS    0H                                                       44000002
         LTR   R2,R2               IS THEIR ANY FIELDS TO PUT OUT       44050002
         BZ    GIVEMESG            NO, GO GIVE MESSAGE                  44100002
         L     R10,OUTBUF          ADDRESS OF OUTPUT BUFFER             44150002
         LA    R1,N2(R2)           LENGTH OF DATA TO PUT OUT            44200002
         SLL   R1,N16              LENGTH IN HIGH ORDER HALFWORD        44250002
         ST    R1,N0(R10)          PREFIX OUTPUT WITH LENGTH            44300002
         NI    OUTPUTSW,(HEXFF-FLDCHECK)                                44350002
         OI    OUTPUTSW,HDRCHECK                                        44400002
         BAL   R14,DEBIO           GO PUT OUT FIELD HDRS AND FIELDS     44450002
         SR    R2,R2               NO MORE OUTPUT                       44500002
GIVEMESG DS    0H                                                       44550002
         TM    OUTPUTSW,NOTDASD    NO DASD SECTION BECAUSE NOT A DASD   44700002
         BO    PUTMSG6A            YES, GO GIVE NOT A DASD MESSAGE      44750002
         LA    R2,M0040            PICK UP FIRST LEVEL ERROR MSG NUM    44800002
         LA    R3,M0247            PICK UP SECOND LEVEL ERROR MSG NUM   44810002
         B     MSGAGOGO            GO PUT OUT MESSAGE                   44850002
PUTMSG6A DS    0H                                                       44900002
         LA    R2,M0040            PICK UP FIRST LEVEL MSG NUMBER       44950002
         LA    R3,M0248            PICK UP SECOND LEVEL MSG NUMBER      44960002
MSGAGOGO DS    0H                                                       45050002
         NI    TSTFLGS1,(HEXFF-TSTPRINT) INSURE PRINT SWITCH OFF        45200002
         B     MSGIO               BRANCH TO ISSUE MESSAGES             45300002
          SPACE                                                         45350002
*********************************************************************** 45400002
*   THE FOLLOWING CODE PROCESSES THE VARIOUS RETURN CODES AND         * 45450002
*    RETURNS TO MAINLINE.                                             * 45500002
*********************************************************************** 45550002
          SPACE                                                         45600002
DEBRETRY DS    0H                                                       45650002
         L     R9,CVTPTR           ADDRESS OF CVT                       45700002
         L     R9,CVTTCBP-CVT(R9)  POINTER TO NEW, CURRENT TCBS         45750002
         L     R9,N4(R9)           ADDRESS OF CURRENT TCB IS TEST TCB   45800002
         L     R9,TCBTRN-TCB(R9)   ADDRESS OF TCOMTAB                   45850002
         OI    TSTFLGS4,TSTRERTN   TURN ON RETRY IN PROCESS SW          45860002
         L     R13,REGSAVE2        ADDRESS OF MY SAVE AREA              45900002
         L     R12,N68(R13)        MY BASE                              45950002
         LA    R8,N20              ABEND RETURN CODE FOR MAINLINE       46000002
         B     RETURN              GO RETURN TO MAINLINE                46200002
EXITERR  DS    0H                                                       46250002
         L     R15,REG14           VALIDITY EXIT SAVED RET CODE         46300002
DEBRET   DS    0H                                                       46350002
         LA    R8,N16              ATTENTION RETCODE                    46400002
         CR    R8,R15              DID SOMEONE HIT ATTENTION            46450002
         BE    RETURN              IF YES BRANCH                        46500002
         LA    R8,N20              ABEND RETURN CODE                    46550002
         CR    R8,R15              DID SOMEONE ABEND                    46600002
         BE    RETURN              YES, GO SET RETURN                   46650002
         LA    R8,N24              TEST FOR BAD ESTAE                   46660002
         CR    R8,R15              COMPARE WITH IO RTN CODE             46670002
         BE    RETURN              IF SO GO BACK WITH RTN CODE          46680002
         SR    R8,R8               RETCODE IS ZERO                      46700002
         B     RETURN              GO RETURN TO MAINLINE                46750002
DEBRET1  DS    0H                  PARSE RETURN CODE ANALYSIS           46800002
         LA    R8,N8               ATTENTION R.C. FROM PARSE IS 8       46950002
         CR    R8,R15              HAS AN ATTENTION BEEN SCHEDULED      47000002
         LA    R8,N16              MAINLINE ATTENTION R.C. IS 16        47050002
         BE    RETURN              ATTENTION SCHEDULED, GO SET UP RET   47100002
         LA    R8,N20              VALIDITY EXIT ERR R.C. FROM PARSE    47150002
         CR    R8,R15              DID VALIDITY EXIT SEEK TO END        47200002
         BE    EXITERR             VALIDITY EXIT TERM., GO SET RETURN   47250002
         LA    R8,N16              NO CORE R.C. FROM PARSE              47300002
         SR    R3,R3               INDICATE NO SECOND LEVEL MSG         47310002
         CR    R8,R15              IS R.C. FROM PARSE 16                47350002
         LA    R2,M0103            PICK UP FIRST LEVEL MESSAGE NUM      47400002
         BE    MSGIO               IF R.C. 16, GO GIVE NO CORE MESSAGE  47450002
         LA    R8,N12              INVALID PARMS R.C. FROM PARSE        47500002
         CR    R8,R15              IS R.C. FROM PARSE 12                47550002
         BE    PARSE12             IF A 12 SEND MESSAGE                 47600002
         SR    R8,R8               PARSE RC=4, NO MESSAGE               47750002
         OI    TSTFLGS4,TSTFLUSH   IF STACK, TELL MNL TO FLUSH          47800002
         B     RETURN              GO RETURN TO CALLER                  47850002
PARSE12  DS    0H                                                       47860002
         XC    TSTIOPRM,TSTIOPRM   CLEAR PARM LIST FOR I/O CALL         47870002
         IKJEGSIO MSG,FIRST=M0104,INST11=(NUM,I0014),SECOND=M0277,     *47880002
               ID=DEB11,MF=(E,TSTIOPRM)  CALL I/O FOR ERROR MSG         47890002
         B     DEBRET              GO CHECK RETURN CODE FROM I/O        47892002
MSGIO    DS    0H                                                       47900002
         XC    TSTIOPRM,TSTIOPRM   CLEAR PARM LIST FOR I/O CALL         47950002
         IKJEGSIO MSG,FIRST=(R2),SECOND=(R3),ID=DEB11,MF=(E,TSTIOPRM)   48000002
         B     DEBRET              GO CHECK RETURN CODE FROM I/O        48100002
RETURN   DS    0H                                                       48150002
         NI    TSTFLGS1,(HEXFF-TSTPRINT)                                48200002
         ESTAE 0,OV                REMOVE ESTAE                         48210002
         LR    R15,R8              RETCODE IN PROPER REGISTER           48250002
         L     R13,N4(R13)                                              48300002
         NI    TSTFLGS4,HEXFF-TSTRERTN TURN OFF RETRY SWITCH IF ON      48310002
         RETURN (14,12),T,RC=(15)                                       48350002
         EJECT                                                          48400002
*********************************************************************** 48450002
*                                                                     * 48500002
*                            HEADERS AND OTHER CONSTANTS              * 48550002
*                                                                     * 48600002
*********************************************************************** 48650002
         SPACE 2                                                        48700002
IKJEGSPL IKJEGSPL RTRY=DEBRETRY,ABNTB=ABENDTAB,MODNM=IKJEGDEB,TNM=LISTD*48710002
               EB                                                       48720002
ZZZZZZZZ DC    52C'Z'              TO BE USED FOR MAINTENANCE           48750002
HDRRSRVD DC    C'RESERVED'                      DEB FIELD HEADER        48800002
HDRPROTG DC    C'PROTG/DEBID'                   DEB FIELD HEADER        48850002
HEADER1  DC    C'BASIC SECTION'                 DEB SECTION HEADER      48900002
HEADER2  DC    C'DIRECT ACCESS SECTION'         DEB SECTION HEADER      48950002
FLAG     EQU   X'80'               FLAG FOR IKJEGCVT                    49000002
TYPECODE EQU   X'04'               TYPE CODE FOR HEX FOR CONVERT        49050002
BLANK    EQU   C' '                                                     49100002
HEXFF    EQU   X'FF'                                                    49150002
HEX00    EQU   X'00'                                                    49200002
HEX38    EQU   X'38'                                                    49250002
HEX03    EQU   X'03'                                                    49300002
HEX04    EQU   X'04'                                                    49350002
HEX0F    EQU   X'0F'                                                    49400002
FOUR     DC    F'4'                USED COMPARE RC ADDR CHECK           49450002
EIGHT    DC    F'8'                USED COMPARE RC ADDR CHECK           49460002
PCLADDR  DC    A(IKJEGDBP)         ADDRESS OF PARSE PCL CSECT           49500002
ABENDTAB DS    0F                                                       49550002
         DC    AL1(99)             LINK FAILED CODE                     49600002
         DC    AL3(PABEND1)        RESUME IC AFTER LINK                 49650002
         DC    AL1(98)             INVALID DEB CODE                     49700002
         DC    AL3(PARDCB1)        RESUME IC AT DCB CHECK               49750002
         DC    AL1(98)             INVALID DEB CODE                     49800002
         DC    AL3(PARDCB2)        RESUME IC AFTER DCB CHECK            49850002
         DC    AL1(98)             INVALID DEB CODE                     49900002
         DC    AL3(PARNMEX1)       RESUME IC AT EXT CHECK               49950002
         DC    AL1(98)             INVALID DEB CODE                     50000002
         DC    AL3(PARNMEX2)       RESUME IC AFTER EXT CHECK            50050002
         DC    AL1(98)             INVALID DEB CODE                     50100002
         DC    AL3(DCBTRY1)        RESUME IC AT DCB CHECK               50150002
         DC    AL1(98)             INVALID DEB CODE                     50200002
         DC    AL3(DCBTRY2)        RESUME IC AFTER DCB CHECK, AT        50250002
*                                  DSORG CHECK                          50300002
         DC    AL1(98)             INVALID DEB CODE                     50350002
         DC    AL3(PABEND2)        RESUME IC AFTER CHECK DSORG IN DCB   50400002
         DC    AL1(98)             INVALID DEB CODE                     50450002
         DC    AL3(NMTRY1)         RESUME IC AT NM CHECK                50500002
         DC    AL1(98)             INVALID DEB CODE                     50550002
         DC    AL3(NMTRY2)         RESUME IC AFTER NM CK                50600002
         DC    AL1(98)             INVALID DEB CODE                     50650002
         DC    AL3(NMTRY3)         RESUME IC AT NM CHECK                50700002
         DC    AL1(98)             INVALID DEB CODE                     50750002
         DC    AL3(EXTRY1)         RESUME IC AT EXT CHECK               50800002
         DC    AL1(98)             INVALID DEB CODE                     50850002
         DC    AL3(CHECKEXT)       RESUME IC AT EXT CHECK               50900002
         DC    AL1(98)             INVALID DEB CODE                     50950002
         DC    AL3(EXTRY2)         RESUME IC AT EXT CHECK               51000002
         DC    AL1(98)             INVALID DEB CODE                     51050002
         DC    AL3(MOVETRY1)       RESUME IC AT MOVE                    51100002
         DC    AL1(98)             INVALID DEB CODE                     51150002
         DC    AL3(MOVETRY2)       RESUME IC AFTER MOVE                 51200002
         DC    X'FF'               END OF TABLE INDICATOR               51250002
RETRYADR DC    AL3(DEBRETRY)       ADDRESS OF DEB STAE RETRY ROUTINE    51300002
LFSTAE   DS    0F                                                       51350002
         ESTAE  MF=L                                                    51400002
MOVE1    MVC   N0(N0,R11),N0(R10)                                       51450002
MOVE2    MVC   N4(N0,R11),N1(R10)                                       51500002
MOVE3    MVC   N0(N0,R11),N1(R10)                                       51550002
MOVE4    MVC   N4(N0,R11),N0(R10)                                       51600002
PDELENTH EQU   51                  TOTAL LENGTH OF FIELD PDES           51650002
ALLCHECK EQU   X'80'               OUTPUT FLAG FOR HEADER1              51700002
SOMEOUT  EQU   X'40'               FLAG FOR ANY OUTPUT, CHECK BAD PARMS 51750002
HDRCHECK EQU   X'20'               OUTPUT FLAG FOR FIELD HEADERS        51800002
FLDCHECK EQU   X'10'               OUTPUT FLAG FOR FIELDS               51850002
DASDSEC  EQU   X'08'               FLAG FOR SECOND SECTION POINTER      51900002
ISAMBIT  EQU   X'04'               FLAG FOR DEB ASSOCIATED WITH ISAM DS 51950002
ANYSECND EQU   X'03'               NO DIRECT ACCESS SECTION             52000002
NOTDASD  EQU   X'02'               NO DASD SECTION - DS NOT ON A DASD   52050002
NOEXTENT EQU   X'01'               NO DASD SECTION - 0 EXTENTS          52100002
ISAM     EQU   X'80'               ISAM ORGANIZATION CODE IN DCB        52150002
DSORG    EQU   26                  OFFSET INTO DCB OF DSORG CODE        52200002
OFFSET   EQU   64                  OFFSET OF DBWKAREA INTO TEST WRKAREA 52250002
         EJECT                                                          52300002
DBWKAREA DSECT                                                          52350002
PARSELST DS    7F                  PARM LIST FOR PARSE                  52400002
PRINTFLG DS    1F                  ADDRESS OF PRINT PDL                 52450002
OUTPUTSW DS    CL1                 OUTPUT FLAGS                         52500002
         DS    CL2                 TWO BYTES                            52550002
EXTCTR   DS    CL1                 NO. OF EXTENTS STILL TO BE PROCESSED 52600002
FSTADDR  DS    1F                  ADDR OF PDE OF 1ST FLD ON OUTPUT LNE 52650002
FSTPDEND DS    1F                  ADDRESS OF DVMOD PDE                 52700002
LASTPDE  DS    1F                  ADDRESS OF NMTRK PDE +2              52750002
BUFFER   DS    20F                 BUFFER FOR CONVERTED FIELDS          52800002
RELADR   DS    CL1                 OFFSET OF FIELD INTO THE DEB         52850002
FLDLEN   DS    CL1                 LENGTH OF DEB FIELD                  52900002
HDRLEN   DS    CL1                 LENGTH OF DEB FIELD HEADER           52950002
NMEXTSTR DS    CL1                 NUMBER OF EXTENTS IN DEB             53000002
HDRBUF   DS    3F                  BUFFER FOR CURR DEB FLD HEADER       53050002
LINELEN  DS    1F                  MAXIMUN LENGTH OF OUTPUT LINE        53100002
SVCPARMS DS    3F                  PARAMETER FOR SVC 97 ADRCK           53150002
TEMPAREA DS    CL8                 TEMPORARY STOR AREA FOR DATA         53200002
*                                  TO TRANSLATE. THIS FIELD IS          53250002
*                                  AS LONG AS THE LONGEST SINGLE        53300002
*                                  FIELD IN DEB. IF LONGER FIELD        53350002
*                                  IS EVER DEF, THIS FIELD MUST         53400002
*                                  BE LENGTHENED.                       53450002
* IT IS ESSENTIAL THAT THE FOLLOWING 6 AREAS BE CONTIGUOUS AND IN ORDER 53500002
STRNGPTR DS    1F                  CONVERT PARM LIST - PTR TO FIELD     53550002
CVTLL    DS    CL2                                     LENGTH OF FIELD  53600002
FLAGS    DS    CL1                                     FLAGS            53650002
TYPE     DS    CL1                                     TYPE OF DATA     53700002
OUTPTR1  DS    1F                  I/O PARM LIST - PTR TO IST I/O BUFF  53750002
OUTPTR2  DS    1F                                  PTR TO 2ND I/O BUFF  53800002
REG14    DS    1F                  REG 14 OR VALIDITY CHECK EXIT R.C.   53850002
         ORG   DBWKAREA            GO BACK TO BEGINNING OF WORK AREA    53900002
STAELIST DS    3F                  PARAMETER LIST FOR STAE              53950002
DATAREG  DS    2F                  PLACE TO HOLD PARM REG FOR I/O CALL  53960002
         EJECT                                                          54000002
IKJEGDEB CSECT                                                          57400002
         EJECT                                                          57450002
*                                                                       57500002
*        PARSE MACROS                                                   57550002
*                                                                       57600002
         SPACE 2                                                        57650002
IKJEGDBP IKJPARM                                                        57700002
ADDRESS  IKJPOSIT  ADDRESS,VALIDCK=DEBVALCK,PROMPT='ADDRESS OF DEB'     57750002
PRINT    IKJKEYWD                                                       57800002
         IKJNAME   'PRINT',SUBFLD=DSNAME                                57850002
DEBFIELD IKJKEYWD                                                       57900002
         IKJNAME   'FIELD',SUBFLD=FIELDNAM                              57950002
DSNAME   IKJSUBF                                                        58000002
DSNAM    IKJPOSIT  DSNAME,PROMPT='DATA SET NAME'                        58050002
FIELDNAM IKJSUBF                                                        58100002
NMSUB    IKJKEYWD                                                       58150002
         IKJNAME  'DEBNMSUB'                                            58200002
TCBAD    IKJKEYWD                                                       58250002
         IKJNAME  'DEBTCBAD'                                            58300002
AMLNG    IKJKEYWD                                                       58350002
         IKJNAME  'DEBAMLNG'                                            58400002
DEBAD    IKJKEYWD                                                       58450002
         IKJNAME  'DEBDEBAD'                                            58500002
OFLGS    IKJKEYWD                                                       58550002
         IKJNAME  'DEBOFLGS'                                            58600002
IRBAD    IKJKEYWD                                                       58650002
         IKJNAME  'DEBIRBAD'                                            58700002
OPATB    IKJKEYWD                                                       58750002
         IKJNAME  'DEBOPATB'                                            58800002
QSCNT    IKJKEYWD                                                       58850002
         IKJNAME  'DEBQSCNT'                                            58900002
FLGS1    IKJKEYWD                                                       58950002
         IKJNAME   'DEBFLGS1'                                           59000002
RSVD     IKJKEYWD                                                       59050002
         IKJNAME  'DEBRSRVD'                                            59100002
NMEXT    IKJKEYWD                                                       59150002
         IKJNAME  'DEBNMEXT'                                            59200002
USPRG    IKJKEYWD                                                       59250002
         IKJNAME  'DEBUSPRG'                                            59300002
PRIOR    IKJKEYWD                                                       59350002
         IKJNAME  'DEBPRIOR'                                            59400002
ECBAD    IKJKEYWD                                                       59450002
         IKJNAME  'DEBECBAD'                                            59500002
PROTG    IKJKEYWD                                                       59550002
         IKJNAME  'DEBPROTG'                                            59600002
         IKJNAME  'DEBDEBID'                                            59650002
DCBAD    IKJKEYWD                                                       59700002
         IKJNAME  'DEBDCBAD'                                            59750002
EXSCL    IKJKEYWD                                                       59800002
         IKJNAME  'DEBEXSCL'                                            59850002
APPAD    IKJKEYWD                                                       59900002
         IKJNAME  'DEBAPPAD'                                            59950002
DVMOD    IKJKEYWD                                                       60000002
         IKJNAME  'DEBDVMOD'                                            60050002
UCBAD    IKJKEYWD                                                       60100002
         IKJNAME  'DEBUCBAD'                                            60150002
BINUM    IKJKEYWD                                                       60200002
         IKJNAME  'DEBBINUM'                                            60250002
STRCC    IKJKEYWD                                                       60300002
         IKJNAME  'DEBSTRCC'                                            60350002
STRHH    IKJKEYWD                                                       60400002
         IKJNAME  'DEBSTRHH'                                            60450002
ENDCC    IKJKEYWD                                                       60500002
         IKJNAME  'DEBENDCC'                                            60550002
ENDHH    IKJKEYWD                                                       60600002
         IKJNAME  'DEBENDHH'                                            60650002
NMTRK    IKJKEYWD                                                       60700002
         IKJNAME  'DEBNMTRK'                                            60750002
         IKJENDP                                                        60800002
*                                                                       60850002
*        THE FOLLOWING STATEMENTS EQUATE THE FIELD HEADERS IN THE PARSE 60900002
*        CSECT                                                          60950002
*                                                                       61000002
HDRNMSUB EQU   IKJEGDBP+FIRSTHDR               FIELD HEADER IN PDL      61050002
HDRTCBAD EQU   HDRNMSUB+FLDHDR                 FIELD HEADER IN PDL      61100002
HDRAMLNG EQU   HDRTCBAD+FLDHDR                 FIELD HEADER IN PDL      61150002
HDRDEBAD EQU   HDRAMLNG+FLDHDR                 FIELD HEADER IN PDL      61200002
HDROFLGS EQU   HDRDEBAD+FLDHDR                 FIELD HEADER IN PDL      61250002
HDRIRBAD EQU   HDROFLGS+FLDHDR                 FIELD HEADER IN PDL      61300002
HDROPATB EQU   HDRIRBAD+FLDHDR                 FIELD HEADER IN PDL      61350002
HDRQSCNT EQU   HDROPATB+FLDHDR                 FIELD HEADER IN PDL      61400002
HDRFLGS1 EQU   HDRQSCNT+FLDHDR                 FIELD HEADER IN PDL      61450002
HDRNMEXT EQU   HDRFLGS1+FLDHDR+FLDHDR          FIELD HEADER IN PDL      61500002
HDRUSPRG EQU   HDRNMEXT+FLDHDR                 FIELD HEADER IN PDL      61550002
HDRPRIOR EQU   HDRUSPRG+FLDHDR                 FIELD HEADER IN PDL      61600002
HDRECBAD EQU   HDRPRIOR+FLDHDR                 FIELD HEADER IN PDL      61650002
HDRDCBAD EQU   HDRECBAD+FLDHDR+FLDHDR+LENNAME  FIELD HEADER IN PDL      61700002
HDREXSCL EQU   HDRDCBAD+FLDHDR                 FIELD HEADER IN PDL      61750002
HDRAPPAD EQU   HDREXSCL+FLDHDR                 FIELD HEADER IN PDL      61800002
HDRDVMOD EQU   HDRAPPAD+FLDHDR                 FIELD HEADER IN PDL      61850002
HDRUCBAD EQU   HDRDVMOD+FLDHDR                 FIELD HEADER IN PDL      61900002
HDRBINUM EQU   HDRUCBAD+FLDHDR                 FIELD HEADER IN PDL      61950002
HDRSTRCC EQU   HDRBINUM+FLDHDR                 FIELD HEADER IN PDL      62000002
HDRSTRHH EQU   HDRSTRCC+FLDHDR                 FIELD HEADER IN PDL      62050002
HDRENDCC EQU   HDRSTRHH+FLDHDR                 FIELD HEADER IN PDL      62100002
HDRENDHH EQU   HDRENDCC+FLDHDR                 FIELD HEADER IN PDL      62150002
HDRNMTRK EQU   HDRENDHH+FLDHDR                 FIELD HEADER IN PDL      62200002
         SPACE 4                                                        62250002
CVT      DSECT                                                          62300002
         CVT                                                            62350002
         EJECT                                                          62400002
         IKJTCB                                                         62450002
         EJECT                                                          62500002
         IEZDEB                                                         62550002
         END                                                            62600002
./  ADD  SSI=62030262,NAME=IKJEGEND
END      TITLE 'IKJEGEND, END COMMAND PROCESSOR  OF TEST'               00100002
         COPY IKJEGSIO                                                  00102002
         EJECT                                                          00104002
IKJEGEND CSECT                     END COMMAND PROCESSOR                00107000
         SPACE 2                                                        00150002
*C103200,110000                                                @ZA07834 00170000
*A104150                                                       @ZA07834 00177000
*D112444                                                       @ZA07834 00184000
************************************************************            00200002
*                                                         **            00250002
* STATUS                                                  **            00300002
*    CHANGE LEVEL 00, VERSION NUMBER 01, OS/VS2           **            00350002
*                                                         **            00400002
* FUNCTION                                                **            00450002
*         THE BASIC FUNCTION OF THE END SUBCOMMAND IS TO  **            00500002
*         FREE THE CORE THAT HAS BEEN OBTAINED DURING THE **            00550002
*         TEST SESSION. ALL OF TEST'S CORE IS FROM        **            00570000
*         SUBPOOL NUMBER ONE                              **            00650002
*                                                         **            01700002
* ENTRY POINTS                                            **            01750002
*         IKJEGEND - MAIN ENTRY POINT                     **            01800002
*                                                         **            01900002
* INPUT                                                   **            01950002
*    NONE                                                 **            02050002
*                                                         **            02100002
* OUTPUT                                                  **            02150002
*    1.  ERROR MESSAGES TO THE MESSAGE WRITER             **            02200002
*    2.  RETURN CODES                                     **            02250002
*    *          08 - SUCCESSFUL COMPLETION (CALL IKJEGOFF)**            02300002
*    *          20 - STAE RETRY HAS INTERCEPTED AN ABEND  **            02600002
*                                                         **            02650002
* EXTERNAL REFERENCES                                     **            02700002
*         IKJEGIO - PRINTS ERROR MESSAGES;  IT IS INVOKED **            02850002
*         *         VIA THE IKJEGSIO MACRO.               **            02900002
*                                                         **            03000002
*         FREEMAIN - FREE CORE ACQUIRED DURING SESSION    **            03050002
*                                                         **            03100002
* EXITS, NORMAL                                           **            03500002
*    RETURN TO MAINLINE VIA REGISTER 14                   **            03550002
*                                                         **            03600002
* EXITS, ERROR                                            **            03650002
*    RETURN TO MAINLINE VIA REGISTER 14                   **            03700002
*                                                         **            03750002
* TABLES/WORK AREAS                                       **            03800002
*    TCOMTAB -                                            **            03850002
*    *     TSTIODCB - ADDR OF THE IO DCB                  **            03860002
*    *     TSTSYMWK - ADDR OF THE SYMBOL WORK AREA        **            03870002
*    *     TSTIODSN - ADDR OF THE IO DSN                  **            03880002
*    ENDWORKA - END'S WORKAREA                            **            04000002
*                                                         **            04050002
* ATTRIBUTES                                              **            04100002
*    REENTRANT AND REFRESHABLE                            **            04150002
*                                                         **            04200002
* CHARACTER CODE DEPENDENCY                               **            04250002
*    THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL**            04300002
*    REPRESENTATION OF THE EXTERNAL CHARACTER SET WHICH IS**            04350002
*    EQUIVALENT TO THE ONE USED AT ASSEMBLY TIME. THE     **            04400002
*    CODING HAS BEEN ARRANGED SO THAT REDEFINITION OF     **            04450002
*    'CHARACTER' CONSTANTS, BY REASSEMBLY, WILL RESULT IN **            04500002
*    A CORRECT MODULE FOR THE NEW DEFINITIONS.            **            04550002
*                                                         **            04600002
* NOTES                                                   **            04650002
*                                                         **            04700002
************************************************************            04750002
         EJECT                                                          04800002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 04850002
*        THE FOLLOWING ARE THE EQUATES NEEDED BY THE OFF COMMAND        04900002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 04950002
         SPACE                                                          05000002
*        REGISTER EQUATES                                               05050002
R0       EQU   0                   GENERAL WORK REGISTER                05100002
R1       EQU   1                   GENERAL WORK REGISTER (PARAM PASS)   05150002
R2       EQU   2                   GENERAL WORK REGISTER                05200002
R3       EQU   3                   GENERAL WORK REGISTER                05250002
R4       EQU   4                   GENERAL WORK REGISTER                05300002
R5       EQU   5                   GENERAL WORK REGISTER                05350002
R6       EQU   6                   BASE REGISTER FOR CONTROL BLOCKS     05400002
R7       EQU   7                   BASE REGISTER FOR DEFER & ACTIVE Q   05450002
R8       EQU   8                   BASE REGISTER FOR TEMPORARY USE      05500002
R9       EQU   9                   BASE REGISTER FOR TCOMTAB            05550002
R10      EQU   10                  BASE REGISTER FOR OFFWORK AREA       05600002
R11      EQU   11                  EXTRA REGISTER NOT USED              05650002
R12      EQU   12                  BASE REGISTER FOR IKJEGOFF           05700002
R13      EQU   13                  POINTER TO SAVE AREA                 05750002
R14      EQU   14                  USED FOR BAL ALSO WORK REG           05800002
R15      EQU   15                  USED FOR RETURN CODES ALSO WORK REG  05850002
         SPACE                                                          05900002
N0       EQU   0                   CONSTANT 0                           05950002
N1       EQU   1                   CONSTANT 1                           06000002
N2       EQU   2                   CONSTANT 2                           06050002
N3       EQU   3                   CONSTANT 3                           06100002
N4       EQU   4                   CONSTANT 4                           06150002
N5       EQU   5                   CONSTANT 5                           06200002
N6       EQU   6                   CONSTANT 6                           06250002
N7       EQU   7                   CONSTANT 7                           06300002
N8       EQU   8                   CONSTANT 8                           06350002
N9       EQU   9                   CONSTANT 9                           06400002
N10      EQU   10                  CONSTANT 10                          06450002
N12      EQU   12                  CONSTANT 12                          06500002
N16      EQU   16                  CONSTANT 16                          06550002
N20      EQU   20                  CONSTANT 20                          06600002
N24      EQU   24                  CONSTANT 24                          06610002
N32      EQU   32                  CONSTANT 32                          06650002
N56      EQU   56                  CONSTANT 56                          06700002
N60      EQU   60                  CONSTANT 60                          06710002
N72      EQU   72                  CONSTANT 72                          06750002
N120     EQU   120                 CONSTANT 120                         06760002
****     HEXIDECIMAL EQUATES                                            06800002
HEXC0    EQU   X'C0'               HEX CONSTANT C0                      06850002
HEXFF    EQU   X'FF'               HEX CONSTANT FF                      06900002
HEX0C    EQU   X'0C'               HEX CONSTANT 0C                      06950002
HEX10    EQU   X'10'               HEX CONSTANT 10                      07000002
         EJECT                                                          07050002
ENDSTART DS    0H                  STARTING POSITION OF OFF             07100002
         SAVE  (14,12),,*          SAVE THE CALLERS REGISTERS           07150002
         LR    R12,R15             SETUP REG 12 AS OFF'S BASE           07200002
         USING ENDSTART,R12        ESTABLISH ADDRESSIBILITY             07250002
         USING TCOMTAB,R9          ESTABLISH ADDRESSIBILITY TO TCOMTAB  07300002
         L     R15,REGSAVE2        LOAD ADDR OF NEW SAVEAREA (OFF'S)    07350002
         ST    R13,N4(R15)         PLACE ADDR USER'S SAVEAREA INTO OFF  07400002
         ST    R15,N8(R13)         PLACE ADDR OFF SAVEAREA INTO USERS   07450002
         LR    R13,R15             R13= ADDR OF NEW SAVE AREA           07500002
****     ESTABLISH ADDRESSIBILITY TO OFF WORKAREA -- USE REG 10         07550002
         L     R8,WORKAREA         R1= ADDR OF GENERAL WORKAREA         07600002
         USING TSTCWORK,R8         ESTABLISH ADDRESSIBILITY             07650002
         LA    R10,CWORKCMD        R10= ADDR OF OFFS WORKAREA           07700002
         USING ENDWORKA,R10        COMPLETE ADDRESSIBILITY              07750002
         DROP  R8                  RELEASE REG 8                        07800002
         OI    TSTFLGS1,ENDSW      SET END SWITCH                       07810002
****     SETUP FOR RETRY THRU ESTAE                                     07850002
         STM   R14,R12,HEX0C(R13)  STORE REGISTERS FOR STAE             07900002
         L     R2,TSTSTAE          R2= STAE ADDR FROM TCOMTAB           08100002
         XC    STAEWRK(N16),STAEWRK   CLEAR AREA FOR STAE PARM LIST     08150002
         ESTAE (R2),PARAM=LIST,MF=(E,STAEWRK),RECORD=YES   ESTAE        08200002
         SPACE                                                          08250002
SMTSTAE  DS    0H                  SMT TESTING LABEL                    08300002
         LTR   R15,R15             TEST THE RETURN CODE FROM STAE       08350002
         BZ    END0000             START THE ACTUAL OFF PROCESSING      08400002
         STC   R15,TSTESTRC        PLACE ESTAE RC IN TCOM TABLE         08410002
         LA    R15,N24             SEND RET CODE TO MAINLINE            08450002
         B     MNLRET              THATS ALL                            08560002
         EJECT                                                          08600002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 08650002
*    THE FOLLOWING CSECT HANDLES ALL END PROCESSING;                    08700002
*        IT FREES; 1) IO DCB'S, 2) QSAM BUFFERS, 3) SYMBOL DCB'S,       08750002
*                  4) IO DSN AREAS, 5) CALL PARAMETER BLOCK.            08800002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 08850002
END0000  DS    0H                  START OF THE END PROCESSING ROUTINE  08900002
         L     R1,TSTIODCB         R1= ADDR OF THE IO DCB               08950002
         LA    R1,N0(R1)           ZERO HIGH ORDER BYTE                 08960002
         LTR   R2,R1               IS THE DCB OPEN IF SO CLOSE          09000002
         BZ    END0020             NO THE DCB IS NOT OPEN               09050002
         TM    DCBOFLGS(R2),HEX10  IS DCB OPEN                          09060002
         BZ    END0010             NO - GO FREE DCB CORE                09070002
         MVC   DCBARWRK(L'DCBARWRK),CLOSELST SETUP LIST FORM OF CLOSE   09100002
         XC    TSTIODCB,TSTIODCB   ZERO OUT THE DCB ENTRY IN TCOMTAB    09150002
         CLOSE ((R2)),MF=(E,DCBARWRK) CLOSE THE IO DCB                  09200002
END0010  DS    0H                                                       09210002
         LR    R1,R2               R1= ADDR 0F THE IO DCB               09250002
         FREEPOOL (1)              FREE ALL THE QSAM BUFFERS            09300002
         LR    R1,R2               R1= ADDR 0F THE IO DCB               09350002
         FREEMAIN RC,LV=152,A=(1),SP=1 FREE THE IO DCB                  09400002
         LTR   R15,R15             WAS RETURN CODE NONZERO              09410002
         BZ    END0020             IF SO, BRANCH                        09420002
         BAL   R14,SVCERR          GO PUT OUT ERROR MESSAGE             09440002
END0020  DS    0H                  NOW LOOK AT THE SYMBOL WORK AREA     09450002
         L     R1,TSTSYMWK         R1= ADDR OF SYMBOL WORK AREA         09500002
         XC    TSTSYMWK,TSTSYMWK   ZERO THE SYMWK ENTRY IN TCOMTAB      09504002
         LA    R1,N0(R1)           ZERO HIGH ORDER BYTE                 09510002
         LTR   R4,R1               IS THERE A SYMBOL WORK AREA          09550002
         BZ    END0060             NO CHECK IO DSN                      09600002
         L     R2,N72(R1)          R2= ADDR OF SYM DCB (FROM SYM WRKAR) 09650002
         TM    DCBOFLGS(R2),HEX10  IS THE IO DSN OPEN THEN CLOSE        09700002
         BZ    END0040             NO THEREFORE DO NOT CLOSE            09750002
         MVC   DCBARWRK(CLOSELN),CLOSELST SETUP LIST FORM CLOSE MACRO   09800002
         CLOSE ((R2)),MF=(E,DCBARWRK) CLOSE THE SYMBOL DCB              09850002
         LR    R1,R4               R1= ADDR OF SYMBOL WORK AREA SAVED   09900002
END0040  DS    0H                  FREE THE SYMBOL DCB                  09950002
         FREEMAIN RC,LV=800,A=(1),SP=1 ISSUE THE FREEMAIN               10000002
         LTR   R15,R15             WAS RETURN CODE NONZERO              10010002
         BZ    END0060             IF SO, BRANCH                        10020002
         BAL   R14,SVCERR          GO PUT OUT MESSAGE                   10040002
END0060  DS    0H                  LOOK AT THE IO DSN'S                 10050002
         L     R2,TSTIODSN         R2= LOCATION OF ADDR OF FIRST IO DSN 10100002
         XC    TSTIODSN,TSTIODSN   ZERO THE IO DSN ENTRY IN TCOMTAB     10110002
END0080  DS    0H                  CHECK IF THE IO DSN EXISTS           10150002
         LA    R1,N0(R2)           R1=R2=IO DSN, ZERO HIGH ORDER BYTE   10200002
         LTR   R1,R1               SEE IF IT EXISTS                     10250002
         BZ    END0100             ALL DONE RETURN TO OFF               10300002
         L     R2,N0(R1)           ADDRESS OF IO NEXT DSN      @ZA07834 10320000
         FREEMAIN RC,LV=50,A=(1),SP=1 FREE THE CORE OF  IO DSN          10400002
         LTR   R15,R15             WAS RETURN CODE NONZERO              10410002
         BZ    END0080             IF SO, BRANCH               @ZA07834 10415000
         BAL   R14,SVCERR          GO PUT OUT MESSAGE                   10440002
         B     END0080             BRANCH                               10492402
****     FREE THE CHAINED CALL PARAMETER BLOCKS. CHAIN PTR = WORD 1     10500002
****     LENGTH = 4 AND 5 BYTE OF BLOCK                                 10550002
END0100  DS    0H                  END OF END PROCESSING RETURN TO OFF  10600002
         L     R2,CALLPARM         R2= ADDR OF THE FIRST BLOCK          10650002
         XC    CALLPARM,CALLPARM   ZERO THE CALLPARM IN TCOMTAB         10700002
END0120  DS    0H                  BEGIN LOOPOF FREEMAINS               10800002
         LA    R1,N0(R2)           R1=ADDR OF CALL BLOCK ZERO HIGH BYTE 10850002
         LTR   R1,R1               IF R1=ZERO THEN WE ARE DONE          10900002
         BZ    END0140             YES WE ARE DONE W/ CALLPARM          10950002
         L     R2,N0(R1,R0)        R2= ADDR OF NEXT BLOCK      @ZA07834 10970000
         LH    R0,N4(R1)           R0= LENGTH OF THE AREA               11050002
         FREEMAIN RC,LV=(0),A=(1),SP=1   FREE THE CALL BLOCK            11150002
         LTR   R15,R15             WAS RETURN CODE NONZERO              11160002
         BZ    END0130             IF SO, BRANCH                        11170002
         BAL   R14,SVCERR          GO PUT OUT MESSAGE                   11192002
END0130  DS    0H                                                       11244002
         B     END0120             BRANCH                               11246002
END0140  DS    0H                  DONE WITH END PROCESSING             11250002
         LA    R15,N8              R15= 8 AS A RETURN CODE              11300002
END0160  DS    0H                  DONE WITH END PROCESSING             11350002
         OI    TSTFLGS2,TSTXCTL    TURN ON XCTL SW IN TCOMTAB           11392002
         MVC   TSTRETRY,MNLSVWRK   RESTORE MAILINES RETRY ROUTINE       11396002
         L     R13,N4(R13)         R13 = ADDR OF CALLERS SAVE AREA      11400002
         XCTL  (2,12),EP=IKJEGOFF  XCTL TO OFF                          11450002
         EJECT                                                          11500002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     11550002
*        THIS ROUTINE OUTPUTS ALL ERROR MESSAGES                        11600002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     11650002
         SPACE                                                          11700002
SVCERR   DS    0H                  THE SVC ERROR MSG HANDLER            11750002
         ST    R14,PUTREWRK        SAVE THE RETURN ADDR OF CALLER       11810002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO DYNAM AREA       11850002
         LR    R3,R15              PUT RETURN CODE TO REG3              11900002
         IKJEGSIO SVCERR,SVC=N120,RC=(R3),ID=END12,MF=(E,TSTIOPRM)      11910002
         L     R14,PUTREWRK        R14= ADDR OF THE CALLER              12000002
         BR    R14                 RETURN TO CALLER                     12050002
         EJECT                                                          12100002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 12150002
*          CONSTANTS USED BY THE END COMMAND                            12200002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   12250002
         DS    0F                  ALIGNMENT                            12300002
DCBOFLGS EQU   X'30'               DISPLACEMENT IN TSTSYMWK TO DCB ADDR 12400002
SUPERZAP DC    50CL1'Z'            PATCH AREA                           12410002
         SPACE                                                          12450002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   12500002
*        THE LIST FORM OF THE CLOSE MACRO                               12550002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   12600002
CLOSELST CLOSE (CLOSELST),MF=L     LIST FROM OF THE CLOSE MACRO         12650002
CLOSELN  EQU   *-CLOSELST          LENGTH OF THE CLOSE LIST MACRO       12700002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   12750002
*        THE STAE MACRO, RETRY ROUTINE, AND ABEND TABLE                 12800002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   12850002
ADDRETRY DC    A(RETRYRTN)         ADDRESS OF THE RETRY ROUTINE         13000002
ABENDTAB DS    0H                  THE ABEND TABLE FOR STAE             13050002
         DC    X'FF'               END OF TABLE INDICATOR               13100002
         SPACE 2                                                        13110002
*****************************************************************       13120002
*  THIS IS THE PARAM LIST FOR THE ESTAE EXIT ROUTINE                    13130002
*****************************************************************       13140002
LIST     IKJEGSPL RTRY=RETRYRTN,ABNTB=ABENDTAB,MODNM=IKJEGEND,         *13142002
               TNM=IKJEGEND                                             13144002
         SPACE 2                                                        13146002
****     THE BEGINING OF THE RETRY ROUTINE                              13150002
RETRYRTN DS    0H                  THE RETRY ROUTINE                    13200002
         L     R5,CVTPTR           R5= ADDR OF THE CVT                  13250002
         USING CVT,R5              ESTABLISH ADDR'ABILITY TO THE CVT    13300002
         L     R1,CVTTCBP          R1= ADDR OF NEW CURRENT TCB'S        13350002
         L     R5,N4(,R1)          R5= ADDR OF CURRENT TCB (TEST TCB)   13400002
         DROP  R5                  RELEASE ADDR'ABILITY TO THE CVT      13450002
         USING TCB,R5              ESTABLISH ADDR'ABILITY TO THE TCB    13500002
         L     R9,TCBTRN           R9= ADDR OF TCOMTAB (RESTORE)        13550002
         DROP  R5                  RELEASE ADDR'ABILITY TO TCB          13600002
         L     R13,REGSAVE2        R13= ADDR OF CURRENT SAVEAREA        13650002
         LM    R14,R12,N12(R13)    RESTORE ALL REGISTERS FOR OFF        13700002
         LA    R15,N20             RETURN CODE OF 20                    13710002
         SPACE                                                          13900002
MNLRET   EQU   *                   RETURN TO MAINLINE ROUTINE           13950002
         NI    TSTFLGS4,HEXFF-TSTRERTN  TURN OFF RETRY FLAG             14202002
         LR    R2,R15              SAVE RET CODE AROUND ESTAE           14204002
         ESTAE 0                   REMOVE END'S ESTAE CONTROL BLOK      14210002
         LR    R15,R2              RESTORE RETURN CODE                  14220002
         L     R13,N4(R13)         R13 = ADDR OF CALLERS SAVE AREA      14310002
         RETURN (14,12),,RC=(15)   END COMPLETE                         14320002
         EJECT                                                          15350002
************************************************************            15400002
**                                                        **            15450002
**                  TCOMTAB DSECT                         **            15500002
**                                                        **            15550002
************************************************************            15600002
TCOMTAB TCOMTAB                                                         15650002
         EJECT                                                          15700002
************************************************************            15750002
**                                                        **            15800002
**                TCB DSECT                               **            15850002
**                                                        **            15900002
************************************************************            15950002
TCB       IKJTCB                                                        16000002
************************************************************            16050002
**                                                        **            16100002
**             CVT DSECT MACRO EXPANSION                  **            16150002
**                                                        **            16200002
************************************************************            16250002
CVT      DSECT                                                          16300002
         CVT                                                            16350002
         EJECT                                                          16400002
************************************************************            16450002
**                                                        **            16500002
**                  RB DSECT                              **            16550002
**                                                        **            16600002
************************************************************            16650002
         SPACE                                                          16700002
         IKJRB               REQUEST BLOCK DSECT                        16750002
         EJECT                                                          16800002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   16850002
*        THE GENERAL TSO TEST WORKAREA                                  16900002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   16950002
         TSTCWORK                  TEST WORKAREA DSECT                  17000002
         EJECT                                                          17050002
************************************************************            17100002
**                                                        **            17150002
**                           WORKAREA DSECT               **            17200002
**                                                        **            17250002
************************************************************            17300002
ENDWORKA DSECT                     DSECT TO ADDRESS END'S WORKAREA      17350002
STAEWRK  DS    4F                  STAE EXPANSION AREA                  17400002
DCBARWRK DS    F                   TEMPORARY AREA FOR DCB ADDRESS       18500002
PUTREWRK DS    F                   PUT MESSAGE RETURN REGISTER          18550002
MNLSVWRK DS    F                   SAVE AREA FOR MNL'S RETRY            18560002
         END                                                            18600002
./  ADD  SSI=33180116,NAME=IKJEGEQU
         TITLE  'IKJEGEQU, THE EQUATE AND DROP COMMANDS OF TEST'        00016002
* /* START OF SPECIFICATIONS ****                                       00018002
*02*  PROCESSOR = ASSEMBLER                                             00018402
**** END OF SPECIFICATIONS ***/                                         00018802
**********************************************************************  00050002
* STATUS  CHANGE LEVEL  00  VERSION NO. 01  OS/VS2                   *  00060002
*                                                                    *  00070002
* FUNCTION                                                           *  00080002
*    THIS MODULE IS RESPONSIBLE FOR BUILDING AND MAINTAINING AN IN   *  00090002
*    CORE SYMBOL TABLE.  EACH ENTRY IN THE TABLE CONTAINS A POINTER  *  00100002
*    TO THE NEXT ENTRY, THE LOAD ADDRESS OF THE SYMBOL, THE          *  00110002
*    ATTRIBUTES OF THE SYMBOL AND THE LENGTH OF THE SYMBOL ALONG WITH*  00120002
*    THE SYMBOL.  A NEW ENTRY IS BUILT FOR EACH NEW SYMBOL.  IF A    *  00130002
*    SYMBOL ALREADY EXISTS IN THE TABLE, THE LOAD ADDRESS AND        *  00140002
*    ATTRIBUTES MAY BE OVERRIDEN.  IF THE ATTRIBUTES ARE NOT         *  00150002
*    SPECIFIED THE DEFAULTS TAKEN WILL BE TYPE-HEX, LENGTH-4 AND     *  00160002
*    MULTIPLICITY-1.  THE MODULE IS CAPABLE OF DEFAULTING THE        *  00170002
*    LENGTH AND/OR MULTIPLICITY FOR THE DIFFERENT TYPES.  THIS       *  00180002
*    MODULE IS ALSO CAPABLE OF DELETING A LIST OF ENTRIES OR ALL     *  00190002
*    ENTRIES FROM THE IN CORE SYMBOL TABLE.                          *  00200002
*                                                                    *  00210002
* ENTRY POINTS                                                       *  00220002
*                                                                    *  00230002
*         IKJEGEQU-ENTERED VIA A LINK FROM IKJEGMNL.  REGISTER 9     *  00240002
*    WILL POINT TO TCOMTAB, THE COMMON DSECT USED BY TEST.  THIS IS  *  00250002
*    THE ENTRY POINT WHEN ADDING OR UPDATING AN ENTRY IN THE         *  00260002
*    SYMBOL TABLE POINTED TO BY SYMTABLE IN TCOMTAB.                 *  00270002
*                                                                    *  00280002
*         IKJEGDRP-ENTERED VIA A LINK FROM IKJEGMNL.  REGISTER 9     *  00290002
*    WILL POINT TO TCOMTAB, THE COMMON DSECT USED BY TEST.  THIS IS  *  00300002
*    THE ENTRY POINT WHEN DELETING AN ENTRY FROM THE SYMBOL TABLE    *  00310002
*    POINTED TO BY SYMTABLE IN TCOMTAB.                              *  00320002
*                                                                    *  00330002
*         IKJEGVDK-ENTERED FROM IKJPARS.  REGISTER 1 POINTS TO A     *  00340002
*    THREE WORD PARAMETER LIST.  THE FIRST WORD IS A POINTER TO THE  *  00350002
*    PDE, THE SECOND WORD IS A POINTER TO IKJEGEQU'S OR IKJEGDRP'S   *  00360002
*    SAVEAREA.  THE THIRD WORD IS TO BE USED BY THE VALIDITY CHECK   *  00370002
*    ROUTINE TO PASS A POINTER TO A SECOND LEVEL MESSAGE BACK TO     *  00380002
*    IKJPARS.                                                        *  00390002
*                                                                    *  00400002
* INPUT                                                              *  00410002
*    THE REQUESTED FUNCTION WILL BE POINTED TO BY INBUF IN TCOMTAB.  *  00420002
*    FOR THE EQUATE VERB, THE SYMBOL AND ADDRESS PARAMETERS MUST BE  *  00430002
*    SPECIFIED.  THE REST OF THE PARAMETERS ARE OPTIONAL.            *  00440002
*    THE FORMAT OF THE EQUATE STATEMENT IS                           *  00450002
*    EQUATE SYMBOL ADDR TYPE LENGTH(X) MULTIPLE(X) WHERE X IS AN     *  00460002
*    INTEGER.                                                        *  00470002
*    THE SYMBOL IS AN OPTIONAL PARAMETER FOR THE DROP VERB.  THE     *  00480002
*    FORMAT OF THE DROP STATEMENT IS                                 *  00490002
*    DROP SYMBOL OR DROP OR DROP SYMBOL,SYMBOL WHERE THE LIST IS     *  00500002
*    ENCLOSED BY PARENTHESIS.                                        *  00510002
*                                                                    *  00520002
* OUTPUT                                                             *  00530002
*    IKJEGEQU WILL PUT THE ADDRESS OF THE IN CORE SYMBOL TABLE IN THE*  00540002
*    SYMTABLE FIELD IN TCOMTAB.  THE ADDRESS OF EACH NEW ENTRY CAN BE*  00550002
*    FOUND IN THE FIRST WORD OF THE PREVIOUS ENTRY.                  *  00560002
*    IKJEGDRP WILL DELETE AN ENTRY FROM THE IN CORE SYMBOL TABLE AND *  00570002
*    UPDATE THE AFFECTED POINTER TO REFLECT THE DELETION.  IF ALL THE*  00580002
*    ENTRIES ARE DELETED SYMTABLE WILL CONTAIN ZEROES.               *  00590002
*                                                                    *  00600002
* EXTERNAL REFERENCES                                                *  00610002
*                                                                    *  00620002
*         IKJPARS-TO VALIDITY CHECK AND SCAN THE COMMAND BUFFER.     *  00630002
*    REGISTER 1 WILL POINT TO A 7 WORD PARAMETER LIST.               *  00640002
*                                                                    *  00650002
*         IKJEGCVT-TO CONVERT THE ADDRESS, MULTIPLICITY AND LENGTH   *  00660002
*    ATTRIBUTES TO BINARY.  REGISTER 1 WILL BE THE ADDRESS COMPLEMENT*  00670002
*    OF THE ADDRESS PDE FOR THE ADDRESS CONVERSION AND WILL BE THE   *  00680002
*    ADDRESS OF THE PDE FOR THE ATTRIBUTE CONVERSIONS.  REGISTER 0   *  00690002
*    WILL BE POSITIVE TO INDICATE BINARY CONVERSION.                 *  00700002
*                                                                    *  00710002
*         IKJEGIO-TO WRITE DIAGNOSTIC MESSAGES.                      *  00720002
*                                                                    *  00730002
* EXITS, NORMAL                                                      *  00870002
*                                                                    *  00880002
*         IKJPARS-ONE OF THE FOLLOWING RETURN CODES WILL BE PASSED   *  00890002
*    VIA REGISTER 15.                                                *  00900002
*    0   INDICATING TO CONTINUE PROCESSING THE COMMAND BUFFER        *  00910002
*    8   INDICATING IKJPARS SHOULD PROMPT WITH REENTER               *  00920002
*    12  INDICATING IKJPARS SHOULD RETURN TO IKJEGEQU WITH A         *  00930002
*    *   RETURN CODE OF 20.                                          *  00940002
*                                                                    *  00950002
*         IKJEGMNL-VIA REGISTER 14 WITH ONE OF THE FOLLOWING         *  00960002
*    RETURN CODES IN REGISTER 15-                                    *  00970002
*    0   NORMAL RETURN CODE                                          *  00980002
*    16  INDICATING AN ATTENTION INTERRUPT WAS ENCOUNTERED           *  00990002
*    *   DURING PROCESSING                                           *  01000002
*                                                                    *  01010002
* EXITS, ERROR                                                       *  01020002
*         IKJEGMNL-VIA REGISTER 14 WITH A RETURN CODE OF 20 IN       *  01030002
*    REGISTER 15 TO INDICATE THE STAE RETRY ROUTINE WAS ENTERED.     *  01040002
*                                                                    *  01050002
* TABLES/WORKAREAS                                                   *  01060002
*    THIS MODULE USES THE COMMON DSECT OF THE TEST PACKAGE-TCOMTAB.  *  01070002
*    THE WORKAREA IS LABELED AREAWORK AND CAN BE FOUND AT A          *  01080002
*    DISPLACEMENT OF X'40' FROM THE AREA POINTED TO BY WORKAREA IN   *  01090002
*    TCOMTAB.  THE PARAMETER CONTROL LIST FOR IKJPARS IS BUILT IN THE*  01100002
*    WORKAREA ALONG WITH SWITCHES USED BY THIS MODULE TO PROCESS.    *  01110002
*    TCOMTAB CONTAINS POINTERS TO THIS MODULE'S SAVEAREA, A POINTER  *  01120002
*    TO THE COMMAND BUFFER CONTAINING THE REQUEST, AND A POINTER TO  *  01130002
*    AN OUTPUT BUFFER.                                               *  01140002
*                                                                    *  01150002
* ATTRIBUTES                                                         *  01160002
*    REENTRANT, REFRESHABLE                                          *  01170002
*                                                                    *  01180002
* CHARACTER CODE DEPENDENCY                                          *  01190002
*    THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL           *  01200002
*    REPRESENTATION OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT*  01210002
*    TO THE ONE USED AT ASSEMBLY TIME.  THE CODING HAS BEEN ARRANGED *  01220002
*    SO THAT REDEFINITION OF CHARACTER CONSTANTS, BY REASSEMBLY,     *  01230002
*    WILL RESULT IN A CORRECT MODULE FOR THE NEW DEFINITIONS.        *  01240002
*                                                                    *  01250002
* NOTES                                                              *  01260002
*    ABBREVIATIONS COMMONLY USED IN THE COMMENTS BESIDE THE CODE-    *  01270002
*    1.   PDL-PARAMETER DESCRIPTOR LIST                              *  01280002
*    2.   PDE-PARAMETER DESCRIPTOR ENTRY                             *  01290002
*    3.   PCL-PARAMETER CONTROL LIST                                 *  01300002
*    COMMENTS GENERALLY START IN COLUMN 35.                          *  01310002
*    ESTAERTN IS THE ENTRY POINT FOR THE STAE RETRY ROUTINE AND IS   *  01320002
*    ENTERED FROM IKJEGSTA.                                          *  01330002
**********************************************************************  01340002
         EJECT                                                          01350002
         COPY IKJEGSIO                                                  01352002
IKJEGEQU CSECT                                                          01354002
** THE COMMENTS FOR THE FOLLOWING STATEMENTS START IN COLUMN 25.    **  01360002
R0       EQU    0       REGISTER 0                                      01370002
R1       EQU    1       REGISTER 1                                      01380002
R2       EQU    2       REGISTER 2                                      01390002
R5       EQU    5       REGISTER 5                                      01400002
R6       EQU    6       REGISTER 6                                      01410002
R7       EQU    7       REGISTER 7                                      01420002
R8       EQU    8       REGISTER 8                                      01422002
R9       EQU    9       REGISTER 9                                      01430002
R12      EQU   12       REGISTER 12                                     01440002
R13      EQU   13       REGISTER 13                                     01450002
R14      EQU   14       REGISTER 14                                     01460002
R15      EQU   15       REGISTER 15                                     01470002
** THE FOLLOWING EQUATES ARE USED AS REGISTER NOTATION THROUGHOUT THE** 01480002
** MODULE.                                                           ** 01490002
PARMREG  EQU    1       USED TO PASS PARAMETERS TO OTHER MODULES        01500002
MSGREG   EQU    2       USED TO INDICATE MSG NUMBER TO BE OUTPUTTED     01510002
LASTENTR EQU    2       POINTS TO THE LAST ENTRY IN THE INCORE          01520002
*                       SYMBOL TABLE                                    01530002
WORKREG  EQU    3       GENERAL WORK REGISTER                           01540002
R3       EQU    3       PARM REGISTER                                   01542002
EVEN     EQU    4       USED AS AN EVEN REGISTER FOR MULTIPLICATION     01550002
STRNGPTR EQU    4       USED IN VALIDITY CHECK ROUTINE-PT TO VALUE      01560002
OUTBUFRG EQU    4       USED TO INDEX THROUGH OUTPUT BUFFER             01570002
ADDRBASE EQU    4       USED TO ADDRESS ADDRESS PDE AFTER RETURNING     01580002
*                       FROM IKJPARS                                    01590002
FSTMSG   EQU    5       USED TO ADDRESS FIRST LEVEL MESSAGE             01600002
SECNDMSG EQU    5       USED TO ADDRESS SECOND LEVEL MESSAGE            01610002
ODD      EQU    5       USED AS ODD REGISTER FOR MULTIPLICATION         01620002
ATTREG   EQU    6       USED TO ADDRESS THE ENTRY IN THE INCORE SYMBOL  01630002
*                       TABLE                                           01640002
DISPLREG EQU    7       USED TO DETERMINE WHAT CODE IS TO BE PROCESSED  01650002
*                       AFTER RETURNING FROM IKJEGIO                    01660002
WORKREG2 EQU    7       USED AS A GENERAL REGISTER                      01670002
PDLBASE  EQU    8       USED TO ADDR PDL AFTER RETURNING FROM IKJPARS   01680002
PDEPTR   EQU    8       USED TO ADDR THE PDE FROM PARSE IN THE VALIDITY 01690002
*                       CHECK ROUTINE                                   01700002
TABBASE  EQU    9       USED TO ADDRESS TCOMTAB                         01710002
WORKBASE EQU   10       USED TO ADDRESS WORKAREA                        01720002
BASEREG  EQU   11       BASE REGISTER FOR ADDRESSABILITY WITHIN CSECT   01730002
ENTRYREG EQU   12       USED TO ADDRESS NEW ENTRY IN INCORE SYMBOL      01740002
*                       TABLE                                           01750002
RETURN   EQU   14       CONTAINS ADDRESS OF NEXT SEQUENTIAL INST        01760002
RETCODE  EQU   15       USED FOR RETURNING RETURN CODES                 01770002
** THE FOLLOWING EQUATES ARE USED THROUGHOUT THE PROGRAM FOR LENGTHS,** 01780002
** AND DISPLACEMENTS IN INSTRUCTIONS.                                ** 01790002
L0       EQU    0       LENGTH OF 0                                     01800002
L1       EQU    1       LENGTH OF 1                                     01810002
L2       EQU    2       LENGTH OF 2                                     01820002
L3       EQU    3       LENGTH OF 3                                     01830002
L4       EQU    4       LENGTH OF 4                                     01840002
L5       EQU    5       LENGTH OF 5                                     01850002
L10      EQU   10       LENGTH OF 10                                    01860002
L16      EQU   16       LENGTH OF 16                                    01870002
L29      EQU   29       LENGTH OF 29                                    01880002
L35      EQU   35       LENGTH OF 35                                    01890002
D0       EQU    0       DISPLACEMENT OF 0                               01900002
D1       EQU    1       DISPLACEMENT OF 1                               01910002
D2       EQU    2       DISPLACEMENT OF 2                               01920002
D3       EQU    3       DISPLACEMENT OF 3                               01930002
D4       EQU    4       DISPLACEMENT OF 4                               01940002
D5       EQU    5       DISPLACEMENT OF 5                               01950002
D6       EQU    6       DISPLACEMENT OF 6                               01960002
D7       EQU    7       DISPLACEMENT OF 7                               01970002
D8       EQU    8       DISPLACEMENT OF 8                               01980002
D9       EQU    9       DISPLACEMENT OF 9                               01990002
D10      EQU   10       DISPLACEMENT OF 10                              02000002
D11      EQU   11       DISPLACEMENT OF 11                              02010002
D12      EQU   12       DISPLACEMENT OF 12                              02020002
D14      EQU   14       DISPLACEMENT OF 14                              02030002
D15      EQU   15       DISPLACEMENT OF 15                              02040002
D16      EQU   16       DISPLACEMENT OF 16                              02050002
D24      EQU   24       DISPLACEMENT OF 24                              02052002
D28      EQU   28       DISPLACEMENT OF 28                              02060002
D29      EQU   29       DISPLACEMENT OF 29                              02070002
D33      EQU   33       DISPLACEMENT OF 33                              02080002
D34      EQU   34       DISPLACEMENT OF 34                              02090002
D39      EQU   39       DISPLACEMENT OF 39                              02100002
D52      EQU   52       DISPLACEMENT OF 52                              02110002
D54      EQU   54       DISPLACEMENT OF 54                              02120002
D56      EQU   56       DISPLACEMENT OF 56                              02130002
D60      EQU   60       DISPLACEMENT OF 60                              02140002
D64      EQU   64       DISPLACEMENT OF 64                              02150002
D67      EQU   67       DISPLACEMENT OF 67                              02160002
D68      EQU   68       DISPLACEMENT OF 68                              02170002
D75      EQU   75       DISPLACEMENT OF 75                              02180002
FACTOR   EQU    3       USED TO CALCULATE MESSAGE DISPLACEMENT          02190002
ONE      EQU    1       NUMERICAL ONE                                   02200002
ONES     EQU    1       USED IN TM INSTRUCTION                          02210002
TWO      EQU    2       NUMERICAL TWO                                   02220002
SEVEN    EQU    7       NUMERICAL SEVEN                                 02222002
EIGHT    EQU    8       NUMERICAL EIGHT                                 02230002
ZERO     EQU    0       NUMERICAL 0                                     02240002
TWELVE   EQU   12       NUMBER OF BYTES IN EACH ENTRY OF ATTRTAB        02250002
BLANK    EQU   C' '     BLANK                                           02260002
REGSMASK EQU   X'38'    USED TO TEST FLAG 4 OF ADDR PDE                 02270002
HEXZERO  EQU   X'00'    USED IN TESTING SWITCHES                        02280002
HEXONE   EQU   X'01'    USED IN TESTING SWITCHES                        02290002
HEXTWO   EQU   X'02'    USED IN TESTING SWITCHES                        02300002
HEXTHREE EQU   X'03'    SIGNIFIES TO STAE THAT A LINK FAILED            02310002
HEXFOUR  EQU   X'04'    USED IN TESTING SWITCHES                        02320002
HEXEIGHT EQU   X'08'    USED IN TESTING SWITCHES                        02330002
HEX14    EQU   X'14'    USED TO SET TYPE CHARACTER OF PDE               02340002
HEX80    EQU   X'80'    USED TO TEST FOR ADDRESS OF BINARY ADDR         02350002
HEXFB    EQU   X'FB'    USED TO SET ALLSW                               02360002
HEXFD    EQU   X'FD'    USED TO TURN CMMNDSW OFF                        02370002
HEXFE    EQU   X'FE'    USED TO TURN DUPLSW OR LOWSW OFF                02380002
HEXFF    EQU   X'FF'    SIGNIFIES END OF STAE ABEND TABLE               02390002
RET0     EQU    0       USED TO SET RETURN CODE                         02400002
RET8     EQU    8       USED TO SET RETURN CODE                         02410002
RET12    EQU   12       USED TO SET RETURN CODE                         02420002
RET16    EQU   16       USED TO SET RETURN CODE                         02430002
RET20    EQU   20       USED TO SET RETURN CODE                         02440002
INSERTRG EQU   4        EQUATE REG USED FOR INSERTS TO MSG              02450002
FIVE     EQU   5        NUMBER FIVE FOR INCREMENTING INST LEN           02460002
FOUR     EQU   4        NUMBER FOUR FOR INCREMENTING INST LEN           02462002
BADESTAE EQU   24       RTN CODE NUMBER IF BAD ESTAE                    02470002
SIX      EQU   6        EQUATE NUMBER SIX FOR DATA MANIPULATION         02480002
L8       EQU   8        EQUATE NUMBER EIGHT FOR DATA MANIPULATION       02490002
M0240    EQU   240      EQUATE NUMBER OF STATIC MESSAGE IN I/O          02500002
M0241    EQU   241      EQUATE NUMBER OF STATIC MESSAGE IN I/O          02510002
         SPACE 3                                                        02520002
         ENTRY IKJEGDRP                                                 02530002
         SPACE 3                                                        02540002
** THE COMMENTS FOR THE FOLLOWING STATEMENTS START IN COLUMN 35.     ** 02550002
         EJECT                                                          02560002
         SAVE  (14,12),,*         SAVE REGISTERS                        02570002
         LR    BASEREG,R15        ESTABLISH ADDRESSABILITY FOR          02580002
         USING IKJEGEQU,BASEREG   THIS CSECT-BASEREG IS BASE            02590002
         USING TCOMTAB,TABBASE    USE TABBASE TO ADDR TCOMTAB           02600002
         L     WORKREG,WORKAREA   OBTAIN ADDR OF WORKAREA FROM TCOMTAB  02610002
         USING TSTCWORK,WORKREG   ESTABLISH ADDRESSABILITY TO ENTIRE    02620002
*                                 WORKAREA                              02630002
         LA    WORKBASE,CWORKCMD  GET ADDRESS OF IKJEGEQU'S             02640002
*                                 WORKAREA                              02650002
         USING AREAWORK,WORKBASE  USE WORKBASE TO ADDRESS WORKAREA      02660002
         DROP  WORKREG            DROP ADDRESSABILITY TO ENTIRE         02670002
*                                 WORKAREA                              02680002
         XC    PPLAREA(ENDWORK-PPLAREA),PPLAREA CLEAR WORKAREA          02690002
         B     PARS01C1           GO SET UP SAVEAREAS                   02700002
         DROP  BASEREG                                                  02710002
IKJEGDRP DS    0H                                                       02720002
         SAVE  (14,12),,*         SAVE REGISTERS                        02730002
         USING IKJEGDRP,R15       ESTABLISH ADDRESSABILITY              02740002
         L     BASEREG,BASE       GET ADDRESS OF BEGINNING OF PROGRAM   02750002
         DROP  R15                                                      02760002
         USING IKJEGEQU,BASEREG   BASEREG IS THE BASE REGISTER          02770002
         USING TCOMTAB,TABBASE    USE TABBASE TO ADDR TCOMTAB           02780002
         L     WORKREG,WORKAREA   OBTAIN ADDR OF WORKAREA FROM TCOMTAB  02790002
         USING TSTCWORK,WORKREG   ESTABLISH ADDRESSABILITY TO ENTIRE    02800002
*                                 WORKAREA                              02810002
         LA    WORKBASE,CWORKCMD  GET ADDRESS OF IKJEGDRP'S WORKAREA    02820002
         USING AREAWORK,WORKBASE  USE WORKBASE TO ADDRESS WORKAREA      02830002
         DROP WORKREG             DROP ADDRESSABILITY TO ENTIRE         02840002
*                                 WORKAREA                              02850002
         XC    PPLAREA(ENDWORK-PPLAREA),PPLAREA CLEAR WORKAREA          02860002
         OI    DROPSW,HEXTWO      INDICATE DROP FUNCTION REQUESTED      02870002
** THE FOLLOWING CODE SETS UP THE SAVEAREAS FOR THE EQUATE AND DROP  ** 02880002
** FUNCTIONS.                                                        ** 02890002
PARS01C1 DS    0H                                                       02900002
         MVC   LNGTWORK(L3),CHARZERO   INITIALIZE LENGTH TO CHARACTER   02910002
*                                 ZERO                                  02920002
         L     R15,REGSAVE2       GET ADDRESS OF SAVEAREA FROM          02930002
*                                 TCOMTAB                               02940002
         ST    R13,D4(R15)        STORE ADDRESS OF IKJEGMNL SAVEAREA    02950002
         ST    R15,D8(R13)        STORE ADDR OF OUR SAVEAREA            02960002
         LR    R13,R15            PUT ADDRESS OF OUR SAVEAREA INTO      02970002
*                                 REGISTER 13                           02980002
         STM   R14,R12,D12(R13)   SAVE OUR REGISTERS                    02990002
*********************************************************************   03000002
*                   ISSUE STAE FOR DROP AND EQUATE                  *   03010002
*********************************************************************   03020002
         L     WORKREG,TSTSTAE    GET ADDR OF STAE EXIT ROUTINE         03060002
         LA    R15,STAEAREA       GET ADDR OF STAE WORKAREA             03070002
         MVC   D0(STAELEN,R15),STAELIST  MOVE STAE LIST FORM INTO       03080002
*                                 WORKAREA                              03090002
         ESTAE (R3),CT,PARAM=IKJEGSPL,RECORD=YES,XCTL=NO,MF=(E,(R15))   03092002
         LTR   R15,R15            IS RETURN CODE ZERO                   03110002
SMTSTAE  DS    0H                 SMT LABEL FOR TEST CASE TEQU5500      03120002
         BZ    PARS01F2           YES, CONTINUE PROCESSING              03130002
         STC   R15,TSTESTRC       SAVE RTN CODE FOR MAINLINE            03132002
         LA    R15,BADESTAE       INDICATE TO MAINLINE BAD ESTAE        03134002
         B     EXIT05F2           RETURN TO MAINLINE                    03136002
PARS01G1 DS    0H                                                       03140002
         XC    TSTIOPRM,TSTIOPRM  ZERO OUT I/O PARM LIST                03150002
         IKJEGSIO MSG,FIRST=M0103,ID=EQU13,MF=(E,TSTIOPRM) CALL I/O     03160002
         B     MSG06A1            GO TO ERROR CODE ANALYE ROUTINE       03170002
PARS01F2 DS    0H                                                       03180002
         TM    TSTFLGS3,NOPARMS   WERE PARAMETERS SPECIFIED             03190002
         BZ    PARS01A3           YES, GO TO PARSE                      03200002
         TM    DROPSW,HEXTWO      NO, CHECK FOR DROP COMMAND            03210002
         BO    SYM02A1            YES, SKIP GOING TO PARSE              03220002
PARS01A3 DS    0H                                                       03230002
** THIS CODE BUILDS THE PARAMETER LIST IN THE WORKAREA TO GO TO      ** 03240002
** IKJPARS TO SCAN AND VALIDITY CHECK THE PARAMETERS OF THE COMMAND  ** 03250002
** BUFFER.                                                           ** 03260002
         LR    WORKREG2,WORKBASE  ESTABLISH ADDRESSABILITY TO PARSE     03270002
         USING PPL,WORKREG2       PARAMETER LIST                        03280002
         MVC   PPLUPT(L4),TSTUPT  PUT ADDR UPT INTO PARAMETER LIST      03290002
         MVC   PPLECT(L4),TSTECT  PUT ADDR ECT INTO PARAMETER LIST      03300002
         MVC   PPLECB(L4),TSTCPECB PUT ADDR ECB INTO PARAMETER LIST     03310002
         TM    DROPSW,HEXTWO      IS THE REQUEST TO DELETE AN ENTRY     03320002
*                                 FROM THE IN CORE SYMBOL TABLE         03330002
         BZ    PARS01C3           NO, GO SET UP PCL FOR EQUATE          03340002
         MVC   PPLPCL(L4),PARSDROP YES, PUT ADDR OF DROP'S PCL INTO     03350002
*                                 PARAMETER LIST                        03360002
         B     PARS01D3           GO SET UP REST OF PARAMETER LIST      03370002
PARS01C3 DS    0H                                                       03380002
         MVC   PPLPCL(L4),PARSADDR PUT ADDR OF EQUATE'S PCL INTO        03390002
*                                 PARAMETER LIST                        03400002
PARS01D3 DS    0H                                                       03410002
         LA    WORKREG,TSTANSPL   GET ADDR OF ANSWER PLACE FOR IKJPARS  03420002
         ST    WORKREG,PPLANS     PUT ADDRESS INTO THE PCL FOR IKJPARS  03430002
         MVC   PPLCBUF(L4),INBUF  MOVE COMMAND BUFFER ADDRESS           03440002
*                                 INTO PARAMETER LIST                   03450002
         ST    R13,PPLUWA         PUT ADDR OF THIS MODULE'S SAVEAREA    03460002
*                                 INTO PARAMETER LIST                   03470002
         LR    PARMREG,WORKBASE   REG 1 POINTS TO PARAMETER LIST        03480002
         DROP  WORKREG2           DROP ADDRESSABILITY TO PARSE          03490002
*                                 PARAMETER LIST                        03500002
         LINK  EP=IKJPARS,ERRET=LINKFAIL    GO TO IKJPARS               03510002
PARSBLOW DS    0H                 LABEL USED BY STAE RETRY ROUTINE      03510402
         B     LINKOK             IF CONTROL COMES HERE OK              03512002
LINKFAIL DS    0H                                                       03514002
         LR    R6,R1              TRANSFER ABEND CODE                   03516002
         LR    R5,R15             TRANSFER RTN CODE                     03518002
         XC    TSTIOPRM,TSTIOPRM  CLEAR PARM LIST                       03518402
         IKJEGSIO SVCERR,SVC=6,ABENDRG=(R6),RC=(R5),ID=EQU13, CALL I/O *03518802
               INST11=(NUM,I0040),MF=(E,TSTIOPRM) TO ISSUE AN ERROR MSG 03519202
         B     EXIT05G5           BRANCH TO EXIT                        03519602
LINKOK   DS    0H                                                       03519702
SMTPARS  DS    0H                 SMT LABEL FOR TEST CASES TEQU4900     03530002
*                                 AND TDRP1600                          03540002
** THE FOLLOWING BRANCH TABLE IS USED TO DETERMINE ACTION TO BE      ** 03550002
** TAKEN AFTER RETURNING FROM IKJPARS DEPENDENT ON THE RETURN CODE   ** 03560002
** FROM IKJPARS IN REGISTER 15.                                      ** 03570002
         B     PARS01F3(RETCODE)  BRANCH TO TABLE INDEXED BY CONTENTS   03580002
*                                 OF REGISTER 15                        03590002
PARS01F3 DS    0H                                                       03600002
         B     SYM02A1            0 - CONTINUE PROCESSING               03610002
         B     EXIT05G5           4 - RETURN TO IKJEGMNL                03620002
         B     ATTN05H4           8 - ATTENTION ENCOUNTERED             03630002
         B     PARS01J4           12 - GO WRITE ERROR MESSAGE           03640002
         B     PARS01G1           16 - GO WRITE ERROR MESSAGE           03650002
         B     EXIT05E2           20 - GO HANDLE SERVICE RTN CODE       03660002
PARS01J4 DS    0H                                                       03670002
         TM    DROPSW,HEXTWO      WAS DROP FUNCTION REQUESTED           03680002
         BZ    PARS01K4           NO, GO WRITE MESSAGE FOR EQUATE       03690002
         XC    TSTIOPRM,TSTIOPRM  ZERO OUT I/O PARM FIELD               03700002
         IKJEGSIO MSG,FIRST=M0104,INST11=(NUM,I0012),SECOND=M0277,     *03706002
               ID=EQU13,MF=(E,TSTIOPRM)  CALL I/O TO ISSUE MSG          03708002
         B     MSG06A1            GO WRITE MESSAGE                      03710002
PARS01K4 DS    0H                                                       03720002
         XC    TSTIOPRM,TSTIOPRM  ZERO OUT I/O PARM FIELD               03730002
         IKJEGSIO MSG,FIRST=M0104,INST11=(NUM,I0011),SECOND=M0277,     *03732002
               ID=EQU13,MF=(E,TSTIOPRM)  CALL I/O TO ISSUE MSG          03734002
         B     MSG06A1            GO WRITE MESSAGE                      03740002
SYM02A1  DS    0H                                                       03750002
** THE FOLLOWING CODE GETS THE LOAD ADDRESS OF THE SYMBOL FROM THE   ** 03760002
** PARAMETER DESCRIPTOR LIST (PDL) BUILT BY IKJPARS.  IT CHECKS TO   ** 03770002
** SEE IF THE ADDRESS IS ALREADY IN THE IN CORE SYMBOL TABLE.  THE   ** 03780002
** ADDRESS OF THE PDL IS FOUND IN TSTANSPL IN TCOMTAB                ** 03790002
         L     PDLBASE,TSTANSPL   OBTAIN ADDR OF PDL                    03800002
         L     WORKREG2,D8(PDLBASE)  GET ADDRESS OF SYMBOL              03810002
         L     WORKREG,SYMTABLE   GET ADDRESS OF SYMBOL TABLE           03820002
         LA    LASTENTR,SYMTABLE  OBTAIN ADDR OF LAST ENTRY             03830002
         TM    DROPSW,HEXTWO      WAS DROP FUNCTION REQUESTED           03840002
         BC    ONES,DROP09A1      YES, GO HANDLE REQUEST                03850002
         LA    ADDRBASE,D16(PDLBASE) NO, GET ADDRESS OF ADDRESS PDE     03860002
         USING IKJPARMA,ADDRBASE  ADDRBASE ADDRESSES ADDRESS PDE        03870002
         TM    PDEFLG5,PDESIB     IS LOAD ADDR OF SYMBOL IN PDL         03880002
         BZ    SYM02D2A           YES, PICK ADDRESS UP AND TEST FOR     03890002
*                                 SYMBOL TABLE                          03900002
** THIS CODE PICKS THE LOAD ADDRESS UP FROM THE SYM INFO BLOCK       ** 03910002
** POINTED TO BY THE LAST WORD IN THE ADDRESS PDE.                   ** 03920002
         L     R5,PDEUSER         NO, GET ADDRESS OF SI BLOCK           03930002
         L     R5,D0(R5)          GET LOAD ADDRESS OF SYMBOL            03940002
         B     SYM02D2            GO SEE IF SYMBOL TABLE EXIST          03950002
SYM02D2A DS    0H                                                       03960002
         L     R5,PDEUSER         GET ADDRESS OF SYMBOL FROM PDL        03970002
SYM02D2  DS    0H                                                       03980002
         LA    R5,0(,R5)          ZERO HIGH ORDER BYTE                  03982002
         LTR   WORKREG,WORKREG    ARE THERE ANY ENTRIES IN THE IN CORE  03990002
*                                 SYMBOL TABLE                          04000002
         BZ    SYM02E3            NO, GO SET UP FOR GETMAIN             04010002
SYM02D3  DS    0H                                                       04020002
** THIS CODE CHECKS TO SEE IF THE LENGTH OF THE NEW SYMBOL IS THE    ** 04030002
** SAME AS THE LENGTH OF ANY SYMBOL ALREADY IN THE IN CORE SYMBOL    ** 04040002
** TABLE.                                                            ** 04050002
         CLC   D12(L2,PDLBASE),D14(WORKREG) ARE LENGTHS THE SAME        04060002
         BE    SYM02D3A           YES, GO SEE IF SYMBOLS ARE SAME       04070002
SYM02D3B DS    0H                                                       04080002
** THIS CODE IS ENTERED FROM SYM02D3A AND IS RESPONSIBLE FOR SETTING ** 04090002
** UP TO CHECK THE NEXT ENTRY IN THE TABLE FOR DUPLICATE SYMBOLS     ** 04100002
         LR    LASTENTR,WORKREG   NO, SAVE ADDR OF LAST ENTRY SCANNED   04110002
         L     WORKREG,D0(WORKREG) GET ADDRESS OF NEXT ENTRY            04120002
         LTR   WORKREG,WORKREG    WAS THERE ANOTHER ENTRY               04130002
         BNZ   SYM02D3            YES, CONTINUE SEARCH FOR SYMBOL       04140002
SYM02E3  DS    0H                                                       04150002
** THIS CODE CALCULATES THE LENGTH OF THE ENTRY                      ** 04160002
         XR    R1,R1              CLEAR A REGISTER                      04170002
         LH    R1,D12(PDLBASE)    OBTAIN LENGTH OF SYMBOL               04180002
SMTGET01 DS    0H                 SMT LABEL FOR TESTCASE TEQU5600 -     04190002
*                                 THIS LABEL MUST COME BEFORE THE LAST  04200002
*                                 MODIFICATION OF REGISTER 1 WHEN       04210002
*                                 ISSUING THE GETMAIN.                  04220002
         LA    R1,D16(R1)         ADD 16 TO IT FOR ENTRY SIZE           04230002
         LR    R0,R1              PUT LENGTH INTO REGISTER 0            04240002
SYM02F3  DS    0H                                                       04250002
** THIS CODE GETS THE MAIN STORAGE FOR THE TABLE ENTRY               ** 04260002
*                                 BYTE OF REGISTER 0                    04280002
         GETMAIN  RC,SP=1,LV=(0)  ISSUE GETMAIN                         04290002
         LTR   R15,R15            TEST FOR ERROR                        04292002
         BZ    OKGETMN            CONTINUE IF OK                        04294002
         LR    R6,R15             TRANSFER RETURN CODE FOR I/O          04294402
         XC    TSTIOPRM,TSTIOPRM  CLEAR I/O PARM LIST                   04296002
         IKJEGSIO SVCERR,SVC=10,RC=(R6),ID=EQU13,MF=(E,TSTIOPRM)        04298002
         CH    R15,H16            TEST FOR SERIOUS ERROR                04298402
         BL    EXIT05H5           IF NOT SERIOUS CONTINUE               04298802
         B     EXIT05J5           RETURN TO MAINLINE WITH CODE          04299202
OKGETMN  DS    0H                                                       04299602
SYM02G3  DS    0H                 LABEL FOR STAE RETRY ROUTINE          04300002
         LR    ENTRYREG,R1        SAVE ADDRESS OF GETMAIN AREA          04310002
         USING ENTRY,ENTRYREG     USE ENTRYREG TO ADDRESS TABLE ENTRY   04320002
         XC    D0(L16,ENTRYREG),D0(ENTRYREG) CLEAR 16 BYTES OF ENTRY    04330002
         ST    R5,ADDRSYM         PUT LOAD ADDRESS OF SYMBOL INTO ENTRY 04340002
         XR    R6,R6              CLEAR A REGISTER                      04350002
         LH    R6,D12(PDLBASE)    GET LENGTH OF SYMBOL                  04360002
         STH   R6,SYMLNGTH        PUT LENGTH OF SYMBOL INTO TABLE ENTRY 04370002
         BCTR  R6,ZERO            TAKE ONE FROM LENGTH OF SYMBOL        04380002
         EX    R6,SYM02G3A        GO MOVE SYMBOL INTO ENTRY OF TABLE    04390002
         ST    ENTRYREG,D0(LASTENTR) PUT ADDRESS OF NEW ENTRY INTO      04400002
*                                 FIRST WORD OF PREVIOUS ENTRY          04410002
         B     TYPE03A1           GO GET TYPE ATTRIBUTE                 04420002
SYM02G3A MVC   D16(L0,ENTRYREG),D0(WORKREG2) MOVE SYMBOL INTO ENTRY     04430002
SYM02D3D CLC   D0(L0,WORKREG2),D16(WORKREG)  ARE THE SYMBOLS THE SAME   04440002
SYM02D3A DS    0H                                                       04450002
         XR    R6,R6              CLEAR A REGISTER                      04460002
         LH    R6,D12(PDLBASE)    PUT LENGTH OF SYMBOL IN A REGISTER    04470002
         BCTR  R6,ZERO            SUBTRACT ONE FROM LENGTH OF SYMBOL    04480002
         EX    R6,SYM02D3D        GO CHECK TO SEE IF SYMBOLS ARE SAME   04490002
         BNE   SYM02D3B           NO, CONTINUE SEARCHING ENTRIES        04500002
SYM02D4  DS    0H                                                       04510002
         LR    ENTRYREG,WORKREG   PUT ADDRESS OF ENTRY INTO REGISTER    04520002
         USING ENTRY,ENTRYREG     ENTRYREG ADDRESSES TABLE ENTRY        04530002
         L     R6,ADDRSYM         GET EXISTING LOAD ADDRESS             04540002
         CR    R5,R6              WAS SAME LOAD ADDRESS SPECIFIED       04550002
         BNE   SYM02E4            NO, SAVE ADDRESS SPECIFIED            04560002
         OI    DUPLSW,HEXONE      YES, INDICATE ENTRY ALREADY EXISTS    04570002
         B     TYPE03A1           GO GET TYPE ATTRIBUTE                 04580002
SYM02E4  DS    0H                                                       04590002
         ST    R5,ADDRSYM         PUT LOAD ADDRESS OF SYMBOL INTO TABLE 04600002
TYPE03A1 DS    0H                                                       04610002
** THIS CODE PUTS THE TYPE ATTRIBUTE INTO THE IN CORE SYMBOL TABLE IF** 04620002
** AN ENTRY DOES NOT ALREADY EXISTS AND OVERRIDES THE TYPE FIELD IF  ** 04630002
** THE ENTRY FOR THIS LOAD ADDRESS ALREADY EXISTS.                   ** 04640002
         XR    WORKREG2,WORKREG2  CLEAR A REGISTER                      04650002
         LH    WORKREG2,D52(PDLBASE)    OBTAIN TYPE SPECIFIED FROM      04660002
*                                 TYPE KEYWORD INDICATOR FIELD IN PDL   04670002
         DROP  ADDRBASE           DROP ADDRESSABILITY TO ADDR PDE       04680002
         LA    ATTREG,ATTRTAB     OBTAIN ADDRESS OF BEGINNING OF        04690002
*                                 ATTRIBUTE TABLE                       04700002
         LTR   WORKREG2,WORKREG2  WAS TYPE SPECIFIED                    04710002
         BNZ   TYPE03B2           YES, GO FIGURE TABLE DISPLACEMENT     04720002
         TM    DUPLSW,HEXONE      NO, DID ENTRY ALREADY EXIST           04730002
         BC    ONES,LNG04A1A      YES, GO GET LENGTH ATTRIBUTE          04740002
         LA    WORKREG2,TWO       NO, DEFAULT TYPE TO HEX               04750002
TYPE03B2 DS    0H                                                       04760002
** THIS CODE FIGURES THE DISPLACEMENT NEEDED INTO THE ATTRIBUTE      ** 04770002
** TABLE THAT IS USED TO ASSURE THE ATTRIBUTES ARE SPECIFIED         ** 04780002
** CORRECTLY.  THE PDL CONTAINS A FIELD WHICH CONTAINS A NUMBER AND  ** 04790002
** THAT NUMBER MULTIPLIED BY A FACTOR IS USED AS AN INDEX TO         ** 04800002
** DETERMINE THE TYPE SPECIFIED.                                     ** 04810002
         LR    EVEN,WORKREG2      PUT INDEX FACTOR INTO A REGISTER      04820002
         LA    ODD,TWELVE         PUT NUMBER OF BYTES IN EACH TABLE     04830002
*                                 ENTRY OF ATTRTAB INTO A REGISTER      04840002
         MR    EVEN,EVEN          MULTIPLY THE INDEX FACTOR BY          04850002
*                                 THE NUMBER OF BYTES IN EACH ENTRY     04860002
*                                 TO GET THE CORRECT DISPLACEMENT       04870002
*                                 INTO THE ATTRIBUTE TABLE              04880002
         AR    ATTREG,ODD         ADD THE START OF THE TABLE TO         04890002
*                                 THE DISPLACEMENT TO FIND THE          04900002
*                                 LIST IN USE                           04910002
         LA    ODD,TWELVE                                               04920002
         SR    ATTREG,ODD         PLACE POINTER TO BEGINNING OF LIST    04930002
         TM    DUPLSW,HEXONE      DOES AN ENTRY ALREADY EXIST           04940002
         BC    ONES,TYPE03B4      YES, GO CHECK FOR SAME TYPE           04950002
         MVC   ATTRTYPE(L1),D0(ATTREG)  NO, MOVE THE TYPE FIELD INTO    04960002
*                                 ENTRY OF IN CORE SYMBOL TABLE         04970002
         B     LNG04A1            GO GET LENGTH ATTRIBUTE               04980002
TYPE03B4 DS    0H                                                       04990002
** THIS CODE TESTS TO SEE IF THE SAME TYPE ATTRIBUTE WAS GIVEN FOR   ** 05000002
** THE NEW ENTRY AS THE OLD.                                         ** 05010002
         CLC   D8(L1,WORKREG),D0(ATTREG)  ARE THE TYPES THE SAME        05020002
         BE    LNG04A1            YES, GO GET LENGTH ATTRIBUTE          05030002
         XC    ATTRTYPE(ATTRLNTH-ATTRTYPE),ATTRTYPE  NO-CLEAR OLD ENTRY 05040002
*                                 OUT                                   05050002
         MVC   D8(L1,WORKREG),D0(ATTREG) MOVE TYPE ATTRIBUTE            05060002
*                                 INTO TABLE                            05070002
         NI    DUPLSW,HEXFE       TURN DUPLICATE ENTRY SWITCH OFF       05080002
         B     LNG04A1            GO GET LENGTH ATTRIBUTE               05090002
LNG04A1A DS    0H                                                       05100002
** THIS CODE IS RESPONSIBLE FOR FINDING THE CORRECT ENTRY IN ATTRTAB ** 05110002
** THAT DESCRIBES THIS TYPE ATTRIBUTE.                               ** 05120002
         CLC   D0(L1,ATTREG),ATTRTYPE ENTRIES CORRESPOND                05130002
         BE    LNG04A1            YES, CONTINUE PROCESSING              05140002
         LA    ATTREG,TWELVE(ATTREG) NO, GO TO NEXT ENTRY IN ATTRTAB    05150002
         B     LNG04A1A           GO CHECK THIS ENTRY                   05160002
LNG04A1  DS    0H                                                       05170002
** THE FOLLOWING CODE IS RESPONSIBLE FOR PUTTING THE LENGTH ATTRIBUTE** 05180002
** INTO THE IN CORE SYMBOL TABLE.  IF DEALING WITH A NEW ENTRY AND   ** 05190002
** THE LENGTH WAS NOT SPECIFIED THE DEFAULT WILL BE ONE.  IF THE NEW ** 05200002
** ENTRY IS OVERRIDING AN EXISTING ENTRY THE DEFAULT WILL BE THAT OF ** 05210002
** THE OLD ENTRY.                                                    ** 05220002
         XR    R5,R5              CLEAR A REGISTER                      05230002
         LH    R5,D54(PDLBASE)    OBTAIN LENGTH ATTRIBUTE INDICATOR     05240002
*                                 FROM PDL                              05250002
         LTR   R5,R5              WAS LENGTH ATTRIBUTE SPECIFIED        05260002
         BNZ   LNG04A2            YES, GO CHECK VALUE                   05270002
** THIS CODE DETERMINES IF THE ENTRY OVERLAID AN EXISTING ENTRY.     ** 05280002
         TM    DUPLSW,HEXONE      IS THIS A NEW ENTRY                   05290002
         BNZ   MULT05A1           NO, GO GET MULTIPLICITY ATTRIBUTE     05300002
** THIS CODE IS EXECUTED IF THE LENGTH ATTRIBUTE WAS NOT SPECIFIED.  ** 05310002
         MVC   ATTRLNTH+D1(L1),D7(ATTREG)  PUT LENGTH INTO TABLE        05320002
         B     MULT05A1           GO GET MULTIPLICITY ATTRIBUTE         05330002
LNG04A2  DS    0H                                                       05340002
         XR    R5,R5              CLEAR A REGISTER                      05350002
         LH    R5,D64(PDLBASE)    OBTAIN THE NUMBER OF BYTES SPECIFIED  05360002
*                                 IN THE LENGTH ATTRIBUTE               05370002
         L     R7,D60(PDLBASE)    OBTAIN ADDR OF CHAR STRING            05380002
         SLL   R5,TWO             MULTIPLY NUMBER OF BYTES OF LENGTH    05390002
*                                 ATTR BY 4 IN ORDER TO USE THE         05400002
*                                 FOLLOWING BRANCH TABLE                05410002
TABLE    DS    0H                                                       05420002
         B     TABLE(R5)          BRANCH INTO TABLE INDEXED BY THE      05430002
*                                 THE CONTENTS OF R5                    05440002
         B     LNGONE             BRANCH TO HANDLE ONE BYTE             05450002
         B     LNGTWO             BRANCH TO HANDLE TWO BYTES            05460002
         B     LNGTHREE           BRANCH TO HANDLE THREE BYTES          05470002
LNGONE   DS    0H                                                       05480002
** THIS CODE HANDLES THE CASE OF THE LENGTH ATTRIBUTE BEING ONE BYTE ** 05490002
         MVC   LNGTWORK+D2(L1),D0(R7)   PUT SPECIFIED LENGTH INTO       05500002
*                                 WORKAREA                              05510002
         B     LNGTEST            GO TEST VALUE                         05520002
LNGTWO   DS    0H                                                       05530002
** THIS CODE HANDLES THE CASE OF THE LENGTH ATTRIBUTE BEING TWO BYTES** 05540002
         MVC   LNGTWORK+D1(L2),D0(R7)  PUT SPECIFIED LENGTH INTO        05550002
*                                 WORKAREA                              05560002
         B     LNGTEST            GO TEST VALUE                         05570002
LNGTHREE DS    0H                                                       05580002
** THIS CODE HANDLES THE CASE OF THE LENGTH ATTRIBUTE BEING THREE    ** 05590002
** BYTES.                                                            ** 05600002
         MVC   LNGTWORK(L3),D0(R7) PUT SPECIFIED LENGTH INTO WORKAREA   05610002
LNGTEST  DS    0H                                                       05620002
         CLC   LNGTWORK(L3),D1(ATTREG)  TEST TO SEE IF VALUE SPECIFIED  05630002
*                                 IS LESS THAN MINIMUN VALUE ALLOWED    05640002
         BL    LNG04A3            YES, TAKE DEFAULT AND WRITE MESSAGE   05650002
         CLC   LNGTWORK(L3),D4(ATTREG) TEST TO SEE IF VALUE SPECIFIED   05660002
*                                 IS GREATER THAN MAXIMUN VALUE         05670002
*                                 ALLOWED                               05680002
         BH    LNG04B3            YES, TAKE DEFAULT AND WRITE MESSAGE   05690002
         MVI   D67(PDLBASE),HEX14 NO, SET TYPE CHARACTER OF PDE         05700002
LNG04C2  DS    0H                                                       05710002
** THIS ROUTINE SETS UP THE PARAMETERS TO GO TO IKJEGCVT FOR VALUE   ** 05720002
** CONVERSION TO BINARY.  REG 1 IS POSITIVE TO INDICATE VALUE        ** 05730002
** CONVERSION AND CONTAINS THE ADDRESS OF THE PDE.                   ** 05740002
         LA    PARMREG,D60(PDLBASE) PUT ADDR OF LENGTH PDE INTO REG 1   05750002
LNG04D2  DS    0H                                                       05760002
** ENTRY POINT FOR OTHER ROUTINES NEEDING TO GO TO CONVERT FOR VALUE ** 05770002
** CONVERSION.                                                       ** 05780002
         XR    R0,R0              CLEAR REG 0 TO INDICATE BINARY        05790002
*                                 CONVERSION                            05800002
         L     R15,TSTCONVT       OBTAIN ADDR OF IKJEGCVT FROM TCOMTAB  05810002
         BALR  RETURN,R15         GO TO CONVERT ROUTINE                 05820002
         LTR   R15,R15            IS RETURN CODE FROM IKJEGCVT 0        05830002
         BZ    LNG04F3            YES, CONTINUE PROCESSING              05840002
         BNZ   EXIT05F2           NO, GO TO CHECK SERVICE RTN RETURN    05850002
*                                 CODE                                  05860002
LNG04B3  DS    0H                                                       05870002
         LA    MSGREG,M0241       PREPARE TO WRITE MSG IKJ57293I        05880002
         B     LNG04A3A           GO GET MESSAGE                        05890002
LNG04A3  DS    0H                                                       05900002
         LA    MSGREG,M0240       PREPARE TO WRITE MSG IKJ57293I        05910002
         OI    LOWSW,HEXONE       INDICATE VALUE SPECIFIED WAS TOO LOW  05920002
LNG04A3A DS    0H                                                       05930002
** THIS CODE IS EXECUTED IF THE LENGTH ATTRIBUTE WAS INCORRECT.  THE ** 05940002
** DEFAULT VALUE WILL BE SUBSTITUTED AND THE USER WILL BE INFORMED.  ** 05950002
         MVC   ATTRLNTH+D1(L1),D7(ATTREG) MOVE THE LENGTH ATTRIBUTE     05960002
*                                 INTO THE TABLE                        05970002
BLDMSG   DS    0H                                                       05990002
** THIS CODE DOES THE INITIAL WORK OF FINDING THE APPROPRIATE MESSAGE** 06000002
** AND SETTING UP THE CORRECT POINTERS TO THE WORK BUFFERS WHEN A    ** 06010002
** MESSAGE HAS TO BE BUILT.  REGISTER 14 WILL CONTAIN THE ADDRESS OF ** 06020002
** THE ROUTINE CONTROL SHOULD BE GIVEN BACK TO.                      ** 06030002
LNG4A3A  DS    0H                                                       06040002
         L     INSERTRG,OUTBUF    SET UP DSECT REGISTER                 06050002
         USING MSGINST,INSERTRG   FOR MSG INSERTS TO BE BUILT           06060002
         MVI   WKINSTS,BLANK      MOVE A BLANK TO START OF INSERTS      06072002
         MVC   WKINSTS+ONE(OUTBUFRL-ONE),WKINSTS BLANK OUT OUTBUF       06074002
         LH    WORKREG,SYMLNGTH   PICK UP SYMBOL LENGTH                 06080002
         LA    WORKREG,FOUR(WORKREG) CALCULATE INSERT LENGTH            06090002
         STH   WORKREG,IN11LENG   STORE INTO INSERT HEADER              06100002
         MVC   IN11TXT(L8),SYMBOL MOVE SYMBOL INTO INSERT               06110002
** THIS CODE HANDLES THE SECOND PART OF THE FIRST MESSAGE            ** 06380002
         CLC   D10(L1,ATTREG),CHARZERO IS LENGTH TWO CHARACTERS         06430002
         BNE   LNG04A3D           YES, GO HANDLE TWO CHARACTERS         06440002
         MVC   IN12TXT(L1),D11(ATTREG) MOVE IN LENGTH INTO INSERT       06450002
         LA    WORKREG,SIX        PREPARE TO CALCULATE INSERT LEN       06460002
         STH   WORKREG,IN12LENG   STORE LENTH OF INSERT INTO HEADER     06470002
         B     LNG04A3E           GO GET THE SECOND LEVEL MESSAGE       06490002
LNG04A3D DS    0H                                                       06500002
** THIS CODE HANDLES THE CASE OF THE LENGTH FIELD OF THE MESSAGE     ** 06510002
** TAKING TWO BYTES.                                                 ** 06520002
         MVC   IN12TXT(L2),D10(ATTREG) MOVE LENGTH INTO INSERT          06530002
         LA    WORKREG,SEVEN     CALCULATE INSERT LENGTH                06540002
         STH   WORKREG,IN12LENG   STORE LENGTH OF INSERT INTO HEADER    06550002
LNG04A3E DS    0H                                                       06580002
         CLI   D8(ATTREG),BLANK   IS TYPE ONE CHARACTER                 06910002
         BE    LNG04A3F           YES, GO HANDLE ONE CHARACTER          06920002
** THIS CODE HANDLES THE MOVE OF A TYPE FIELD OF TWO BYTES INTO THE  ** 06930002
** MESSAGE.                                                          ** 06940002
         MVC   IN21TXT(L2),D8(ATTREG) MOVE TEXT LENGTH INTO INSERT      06950002
         LA    WORKREG,SEVEN      CALCULATE INSERT LENGTH               06960002
         STH   WORKREG,IN21LENG   STORE LENGTH OF INSERT INTO HEADER    06970002
         B     LNG04A3G           GO GET SECOND PART                    06990002
LNG04A3F DS    0H                                                       07000002
** THIS CODE HANDLES THE MOVE OF A ONE BYTE TYPE FIELD INTO THE      ** 07010002
** MESSAGE.                                                          ** 07020002
         MVC   IN21TXT(L1),D9(ATTREG) MOVE TEXT LENGTH INTO INSERT      07030002
         LA    WORKREG,SIX        CALCULATE INSERT LENGTH               07040002
         STH   WORKREG,IN21LENG   STORE LENGTH OF INSERT INTO HEADER    07050002
LNG04A3G DS    0H                                                       07070002
** THIS CODE IS RESPONSIBLE FOR HANDLING THE SECOND PART OF THE      ** 07080002
** SECOND LEVEL MESSAGE.                                             ** 07090002
         TM    LOWSW,HEXONE       WAS VALUE SPECIFIED TOO LOW           07130002
         BC    ONES,LNG04A3M      YES, GO PICK UP LOWEST VALUE ALLOWED  07140002
**THIS CODE HANDLES PUTTING THE HIGHEST VALUE ALLOWED INTO THE       ** 07150002
**MESSAGE.                                                           ** 07160002
         CLC   D4(L2,ATTREG),CHARZERO IS LENGTH FIELD ONE BYTE          07170002
         BE    LNG04A3H           YES, GO HANDLE ONE BYTE               07180002
**THIS CODE HANDLES THE CASE OF MOVING TWO BYTES                     ** 07190002
         MVC   IN22TXT(L2),D5(ATTREG) MOVE INSERT TEXT LENGTH           07200002
         LA    WORKREG,SEVEN      CALCULATE INSERT LENGTH               07210002
         STH   WORKREG,IN22LENG   STORE LENGTH OF INSERT INTO HEADER    07212002
         B     LNG04A3I           GO PREPARE TO WRITE MESSAGE           07220002
LNG04A3H DS    0H                                                       07230002
**THIS CODE HANDLES THE CASE OF MOVING A LENGTH FIELD OF ONE BYTE    ** 07240002
         MVC   IN22TXT(L1),D6(ATTREG) MOVE INSERT TEXT LENGTH           07250002
         LA    WORKREG,SIX        CALCULATE INSERT LENGTH               07252002
         STH   WORKREG,IN22LENG   STORE LENGTH OF INSERT INTO HEADER    07254002
         B     LNG04A3I           GO PREPARE TO WRITE MESSAGE           07260002
LNG04A3M DS    0H                                                       07270002
** THIS CODE HANDLES PUTTING THE LOWEST VALUE ALLOWED INTO THE       ** 07280002
** MESSAGE.                                                          ** 07290002
         NI    LOWSW,HEXFE        TURN VALUE SWITCH OFF                 07300002
         CLC   D1(L2,ATTREG),CHARZERO IS LENGTH FIELD ONE BYTE          07310002
         BE    LNG04A3N           YES, GO HANDLE ONE BYTE               07320002
** THIS CODE HANDLES THE CASE OF MOVING TWO BYTES                    ** 07330002
         MVC   IN22TXT(L2),D2(ATTREG) MOVE INSERT TEXT LENGTH           07340002
         LA    WORKREG,SEVEN      CALCULATE INSERT LENGTH               07350002
         STH   WORKREG,IN22LENG   STORE LENGTH OF INSERT INTO HEADER    07352002
         B     LNG04A3I           GO PREPARE TO WRITE MESSAGE           07360002
LNG04A3N DS    0H                                                       07370002
** THIS CODE HANDLES THE CASE OF MOVING A LENGTH FIELD OF ONE BYTE   ** 07380002
         MVC   IN22TXT(L1),D3(ATTREG) MOVE INSERT TEXT LENGTH           07390002
         LA    WORKREG,SIX        CALCULATE INSERT LENGTH               07392002
         STH   WORKREG,IN22LENG   STORE LENGTH OF INSERT INTO HEADER    07394002
LNG04A3I DS    0H                                                       07400002
** THIS CODE PUTS THE LENGTH FIELD INTO THE FIRST TWO BYTES OF THE   ** 07410002
** SECOND LEVEL MESSAGE AND PREPARES THE PARAMETER LIST TO IKJEGIO   ** 07420002
** AND THEN GOES TO THAT MODULE TO HAVE THE MESSAGE PRINTED.         ** 07430002
         XR    DISPLREG,DISPLREG ZERO OUT DISPLREG REGISTER             07440002
         XC    TSTIOPRM,TSTIOPRM  CLEAR I/O PARM LIST                   07450002
         IKJEGSIO MSG,FIRST=M0031,INST11=(ADDR,IN11),                  *07460002
               INST12=(ADDR,IN12),INST21=(ADDR,IN21),                  *07470002
               INST22=(ADDR,IN22),SECOND=(MSGREG),ID=EQU13,            *07482002
               MF=(E,TSTIOPRM)                                          07484002
         DROP  INSERTRG                                                 07486002
         B     MSG06C1            BRANCH TO FINISH UP                   07488002
LNG04F3  DS    0H                                                       07500002
** THIS CODE IS RESPONSIBLE FOR MOVING THE BINARY REPRESENTATION OF  ** 07510002
** THE ATTRIBUTE INTO THE SYMBOL TABLE.                              ** 07520002
         L     R7,CONAREA         GET ADDRESS OF CONVERTED ATTRIBUTE    07530002
         XR    R5,R5              CLEAR A REGISTER                      07540002
         IC    R5,D0(R7)          GET LENGTH OF CONVERTED AREA          07550002
         LA    R7,D1(R7)          UPDATE PT TO BEGINNING OF OUTPUT      07560002
         TM    MULTSW,HEXFOUR     WAS CONVERSION FOR MULTIPLICITY       07570002
*                                 ATTRIBUTE                             07580002
         BC    ONES,LNG04F4       YES, GO MOVE MULTIPLICITY INTO TABLE  07590002
         LA    R0,ONE                                                   07600002
         CR    R5,R0              NO, IS THERE ONE CONVERTED BYTE       07610002
         BE    LNG04G3            YES, GO MOVE ONE BYTE INTO TABLE      07620002
         MVC   ATTRLNTH(L2),D0(R7) NO, MOVE LENGTH ATTRIBUTE INTO TABLE 07630002
         B     MULT05A1           GO GET MULTIPLICITY ATTRIBUTE         07640002
LNG04G3  DS    0H                                                       07650002
** MOVES ONE BYTE INTO LENGTH ATTRIBUTE FIELD.  ENTERED FROM LNG04F3 ** 07660002
         MVC   ATTRLNTH+D1(L1),D0(R7) MOVE LENGTH ATTRIBUTE INTO TABLE  07670002
         B     MULT05A1           GO GET MULTIPLICITY ATTRIBUTE         07680002
LNG04F4  DS    0H                                                       07690002
** THIS CODE MOVES THE MULTIPLICITY ATTRIBUTE INTO THE INCORE SYMBOL ** 07700002
** TABLE.  ENTERED FROM LNG04F3.                                     ** 07710002
         LA    R0,ONE                                                   07720002
         CR    R5,R0              IS THERE ONE CONVERTED BYTE           07730002
         BE    LNG04F4A           YES, GO MOVE MULTIPLICITY ATTRIBUTE   07740002
         MVC   ATTRMULT+D1(L2),D0(R7) MOVE TWO BYTES INTO SYMBOL TABLE  07750002
         B     EXIT05H5           GO PROCESS SYMBOL                     07760002
LNG04F4A DS    0H                                                       07770002
** MOVES ONE BYTE INTO MULTIPLICITY ATTRIBUTE FIELD OF SYMBOL TABLE  ** 07780002
         MVC   ATTRMULT+D2(L1),D0(R7) MOVE MULTIPLICITY INTO TABLE      07790002
         B     EXIT05H5           GO PROCESS SYMBOL                     07800002
MULT05A1 DS    0H                                                       07810002
** THE FOLLOWING CODE TESTS TO SEE IF THE MULTIPLICITY FACTOR WERE   ** 07820002
** SPECIFIED AND IF NOT PUTS THE DEFAULT OF ONE INTO THE TABLE.      ** 07830002
         OI    MULTSW,HEXFOUR     SET SWITCH TO INDICATE                07840002
*                                 PROCESSING OF MULTIPLICITY            07850002
         XR    R5,R5              CLEAR A REGISTER                      07860002
         LH    R5,D56(PDLBASE)    OBTAIN MULTIPLICITY INDICATOR         07870002
*                                 FROM PDL                              07880002
         LTR   R5,R5              WAS MULTIPLICITY SPECIFIED            07890002
         BNZ   MULT05B2           YES, GO PREPARE TO GO TO IKJEGCVT     07900002
** THIS CODE IS EXECUTED WHEN THE MULTIPLICITY ATTRIBUTE WAS NOT     ** 07910002
** SPECIFIED.  IT CHECKS TO SEE IF THIS ENTRY EXISTED BEFORE.  IF SO ** 07920002
** THE DEFAULT WILL BE THE PREVIOUS VALUE, IF NOT THE DEFAULT WILL BE** 07930002
** ONE.                                                              ** 07940002
         TM    DUPLSW,HEXONE      DID ENTRY EXIST BEFORE                07950002
         BC    ONES,EXIT05H5      YES, SET UP TO RETURN                 07960002
         MVC   ATTRMULT+D2(L1),BINRYONE  NO, PUT A ONE IN THE           07970002
*                                 MULTIPLICITY FIELD OF THE IN CORE     07980002
*                                 SYMBOL TABLE                          07990002
         B     EXIT05H5           GO SET UP TO RETURN                   08000002
MULT05B2 DS    0H                                                       08010002
** SETS REGISTER 1 UP TO GO TO IKJEGCVT.                             ** 08020002
         LA    PARMREG,D68(PDLBASE) PUT ADDR MULTIPLICITY PDE INTO      08030002
*                                 REGISTER 1                            08040002
         MVI   D75(PDLBASE),HEX14 SET TYPE FIELD OF PDE                 08050002
         B     LNG04D2            GO SET UP FOR CONVERSION              08060002
EXIT05E2 DS    0H                                                       08070002
* THE FOLLOWING CODE HANDLES THE SERVICE ROUTINE RETURN CODES         * 08080002
         L     R15,REGSAVE        GET RETURN CODE FROM SAVEAREA         08090002
EXIT05F2 DS    0H                                                       08100002
         B     EXIT05G2(R15)      INDEX THROUGH TABLE BY CONTENTS OF    08110002
*                                 REGISTER 15                           08120002
EXIT05G2 DS    0H                                                       08130002
         B     EXIT05H5           0 - FROM SERVICE ROUTINE-RETURN 0     08140002
         B     EXIT05H5           4 - FROM SERVICE ROUTINE-RETURN 0     08150002
         B     EXIT05H5           8 - FROM SERVICE ROUTINE-RETURN 0     08160002
         B     EXIT05H5           12 - FROM SERVICE ROUTINE-RETURN 0    08170002
         B     EXIT05J5           16 - FROM SERVICE ROUTINE-RETURN 16   08180002
         B     EXIT05J5           20 - FROM SERVICE ROUTINE-RETURN 20   08190002
         B     EXIT05J5           24 - FROM SERVICE ROUTINE-RETURN 24   08192002
ATTN05H4 DS    0H                                                       08200002
         LA    RETCODE,RET16      SET RETURN CODE TO 16 TO INDICATE     08210002
*                                 ATTENTION ENCOUNTERED                 08220002
         B     EXIT05J5           GO PREPARE TO LEAVE                   08230002
EXIT05J4 DS    0H                                                       08240002
         LA    R15,RET20          SET RETURN CODE TO 20 TO INDICATE     08250002
*                                 STAE EXIT ROUTINE WAS ENTERED         08260002
         B     EXIT05J5           GO PREPARE TO LEAVE                   08270002
EXIT05G5 DS    0H                                                       08280002
         OI    TSTFLGS4,TSTFLUSH  INDICATE IKJEGMNL SHOULD FLUSH STACK  08290002
EXIT05H5 DS    0H                                                       08300002
** THIS SETS THE RETURN CODE TO IKJEGMNL TO ZERO.                    ** 08310002
         LA    RETCODE,RET0       SET RETURN CODE TO ZERO               08320002
EXIT05J5 DS    0H                                                       08330002
         LR    R2,R15             TRANSFER RTNCODE                      08330402
         ESTAE 0,OV               REMOVE ESTAE                          08332002
         LR    R15,R2             TRANSFER RTNCODE                      08334002
         L     R13,D4(R13)        RESTORE SAVEAREA ADDRESS              08340002
         NI    TSTFLGS4,HEXFF-TSTRERTN TURN OFF RETRY SW                08342002
         RETURN  (14,12),RC=(15)  RELOAD REGISTERS AND RETURN           08350002
MSG06A1  DS    0H                                                       08360002
** THIS IS ENTERED WHEN A MESSAGE SHOULD BE PRINTED AND AFTERWARDS   ** 08370002
** IKJEGEQU SHOULD TERMINATE.                                        ** 08380002
         OI    WRAPUP,HEXEIGHT    INDICATE PROCESSING SHOULD END        08390002
         XR    DISPLREG,DISPLREG  INDICATE MAINLINE CALLING MSGRTN      08400002
MSG06B1  DS    0H                                                       08410002
MSG06C1  DS    0H                                                       08570002
         B     MSGTAB(DISPLREG)   BRANCH THROUGH THE FOLLOWING TABLE    08640002
*                                 BY CONTENTS OF REGISTER 7             08650002
MSGTAB   DS    0H                                                       08660002
         B     MSG06E2            GO BACK TO MAINLINE CODE              08670002
         B     VDCK08E3           GO BACK TO VALIDITY CHECK ROUTINE     08680002
         B     DROP09D1(RETCODE)  GO BACK TO DROP CODE                  08690002
MSG06E2  DS    0H                                                       08700002
** USED TO DETERMINE PROCESSING AFTER RETURNING FROM IKJEGIO         ** 08710002
         LTR   R15,R15            RETURN CODE FROM IO A ZERO            08720002
         BNZ   EXIT05F2           NO, GO HANDLE RETURN CODE             08730002
** THE FOLLOWING CODE IS EXECUTED WHEN DISPLREG CONTAINS A ZERO      ** 08740002
** INDICATING THE MESSAGE WAS PUT OUT FROM EQUATE'S MAINLINE INSTEAD ** 08750002
** OF THE VALIDITY CHECK ROUTINE.                                    ** 08760002
         TM    WRAPUP,HEXEIGHT    YES, SHOULD EQUATE TERMINATE          08770002
         BZ    MULT05A1           NO, GO GET MULTIPLICITY ATTR          08780002
MSG06E3  DS    0H                                                       08790002
         B     EXIT05H5           YES, GO SET RETURN CODE AND RETURN    08800002
DROP09A1 DS    0H                                                       08810002
** WHEN THIS ROUTINE IS ENTERED WORKREG2 POINTS TO THE SYMBOL TO BE  ** 08820002
** DELETED IF ONE WERE SPECIFIED.  WORKREG CONTAINS THE CONTENTS OF  ** 08830002
** SYMTABLE AND LASTENTR IS A POINTER TO SYMTABLE.  THE FOLLOWING    ** 08840002
** CODE IS RESPONSIBLE FOR HANDLING THE DROP VERB.  IT REMOVES AN    ** 08850002
** ENTRY OR ALL ENTRIES FROM THE IN CORE SYMBOL TABLE.               ** 08860002
         LA    PDLBASE,D8(PDLBASE) BASE POINTS TO FIRST SYMBOL PDE      08870002
         LTR   WORKREG,WORKREG    DOES THE INCORE SYMBOL TABLE EXIST    08880002
         BNZ   DROP09A2           YES, GO HANDLE REQUEST                08890002
DROP09B1 DS    0H                                                       08900002
         XC    TSTIOPRM,TSTIOPRM  ZERO OUT I/O PARM LIST                08910002
         IKJEGSIO MSG,FIRST=M0033,ID=EQU13,MF=(E,TSTIOPRM)              08912002
         B     MSG06A1            GO TO MESSAGE ROUTINE                 08920002
DROP09A2 DS    0H                                                       08930002
         TM    TSTFLGS3,NOPARMS   WAS A SYMBOL SPECIFIED                08940002
         BNO   DROP09A3           YES, GO CHECK FOR ENTRY IN TABLE      08950002
** THE FOLLOWING CODE SETS UP TO DELETE THE IN CORE SYMBOL TABLE     ** 08960002
         OI    ALLSW,HEXFOUR      INDICATE ALL ENTRIES TO BE DELETED    08970002
DROP09C2 DS    0H                                                       08980002
         L     LASTENTR,D0(WORKREG) SAVE ADDRESS OF NEXT ENTRY          08990002
         LTR   LASTENTR,LASTENTR  IS THERE ANOTHER ENTRY                09000002
         BNZ   DROP09A5           YES, GO FIGURE SIZE OF ENTRY          09010002
         ST    LASTENTR,SYMTABLE  INDICATE IN CORE SYMBLE TABLE EMPTY   09020002
         NI    ALLSW,HEXFB        NO, INDICATE THIS IS LAST ENTRY TO    09030002
*                                 BE DELETED                            09040002
         B     DROP09A5           GO FIGURE SIZE OF ENTRY               09050002
** THIS SECTION OF CODE SCANS THE IN CORE SYMBOL TABLE FOR THE ENTRY ** 09060002
** REQUESTED TO BE DELETED.                                          ** 09070002
DROP09A3 DS    0H                                                       09080002
         CLC   D4(L2,PDLBASE),D14(WORKREG) ARE FIELD LENGTHS SAME       09090002
         BE    DRP9A31            YES, GO CHECK SYMBOLS                 09100002
DRP9A34  DS    0H                                                       09110002
         LR    LASTENTR,WORKREG   NO, SAVE POINTER TO NEXT TO LAST      09120002
*                                 ENTRY BEING SCANNED                   09130002
         L     WORKREG,D0(WORKREG) GET ADDRESS OF NEXT ENTRY            09140002
         LTR   WORKREG,WORKREG    WAS THERE ANOTHER ENTRY               09150002
         BNZ   DROP09A3           YES, GO CONTINUE CHECKING             09160002
         L     WORKREG,D0(PDLBASE) PICK UP ADDRESS TO PDE               09162002
         L     INSERTRG,OUTBUF    SET UP DSECT REGISTER FOR INSERTS     09164002
         USING MSGINST,INSERTRG                                         09166002
         MVC   IN11TXT(L8),D0(WORKREG) MOVE IN SYMBOL                   09168002
         LH    R6,D4(PDLBASE)     PICK UP THE LENGTH                    09168402
         LA    R6,FIVE(R6)        CALCULATE INSERT LENGTH               09168802
         STH   R6,IN11LENG        STORE INTO INSERT HEADER              09169202
         XC    TSTIOPRM,TSTIOPRM  ZERO OUT I/O PARM FIELDS              09169602
         IKJEGSIO MSG,FIRST=M0034,INST11=(ADDR,IN11),   CALL I/O       *09169702
               ID=EQU13,MF=(E,TSTIOPRM) FOR ERROR MSG                   09169802
         DROP  INSERTRG                                                 09169902
         LA    DISPLREG,D8        INDICATE DROP CODE CALLING MSG RTN    09430002
         B     MSG06C1            GO TO THE MESSAGE RTN CODE ROUTINE    09440002
DRP09B3A MVC   D0(L0,OUTBUFRG),D0(WORKREG) MOVE SYMBOL INTO BUFFER      09450002
DROP09D1 DS    0H                                                       09470002
** THE FOLLOWING BRANCH TABLE IS USED TO DETERMINE WHERE CONTROL     ** 09480002
** SHOULD BE GIVEN AFTER RETURNING FROM IKJEGIO.                     ** 09490002
         B     DROP09D5           GO SEE IF THERE IS ANOTHER ENTRY      09500002
*                                 TO DELETE                             09510002
         B     DROP09D5           SAME AS ABOVE                         09520002
         B     EXIT05F2           GO HANDLE SERVICE RTN RETURN CODE     09530002
         B     EXIT05F2           GO HANDLE SERVICE RTN RETURN CODE     09540002
         B     EXIT05F2           GO HANDLE SERVICE RTN RETURN CODE     09550002
DRP9A32  CLC   D0(L0,WORKREG2),D16(WORKREG) ARE SYMBOLS THE SAME        09560002
DRP9A31  DS    0H                                                       09570002
         LH    R6,D4(PDLBASE)     PUT LENGTH OF SYMBOL INTO REGISTER    09580002
         BCTR  R6,ZERO            TAKE ONE FROM LENGTH OF SYMBOL        09590002
         EX    R6,DRP9A32         GO SEE IF SYMBOLS ARE SAME            09600002
         BNE   DRP9A34            NO, CONTINUE SCANNING                 09610002
DROP09A4 DS    0H                                                       09620002
** THIS CODE PLACES THE POINTER TO THE ENTRY FOLLOWING THE ENTRY TO  ** 09630002
** BE DELETED INTO THE ENTRY IN FRONT OF THE ENTRY TO BE DELETED.    ** 09640002
         MVC   D0(L4,LASTENTR),D0(WORKREG) MOVE FORWARD POINTER INTO    09650002
*                                 PREVIOUS ENTRY                        09660002
DROP09A5 DS    0H                                                       09670002
** THIS CODE CALCULATES THE LENGTH OF THE ENTRY TO BE DELETED        ** 09680002
         XR    R1,R1              CLEAR A REGISTER                      09690002
         LH    R1,D14(WORKREG)    GET LENGTH OF SYMBOL AND ADD 16 TO    09700002
         LA    R1,D16(R1)         IT FOR ENTRY SIZE                     09710002
         LR    R0,R1              PUT LENGTH INTO REGISTER 0 FOR        09720002
*                                 FREEMAIN                              09730002
         LR    R1,WORKREG         PUT ADDRESS OF AREA TO BE DELETED     09740002
*                                 INTO REGISTER 1                       09750002
         FREEMAIN  RC,SP=1,LV=(0),A=(1) ISSUE FREEMAIN                  09780002
         LTR   R15,R15            TEST THE RETURN CODE                  09782002
         BZ    OKFREEMN           OK IF  ZERO CONTINUE                  09784002
         LR    R6,R15             TRANSFER RETURN CODE FOR I/O          09784402
         XC    TSTIOPRM,TSTIOPRM  CLEAR PARM LIST FOR I/O               09786002
         IKJEGSIO SVCERR,SVC=120,RC=(R6),ID=EQU13,MF=(E,TSTIOPRM)       09788002
         CH    R15,H16            TEST FOR SERIOUS ERROR                09788402
         BL    EXIT05H5           NOT SERIOUS CONTINUE                  09788802
         B     EXIT05J5           IF SERIOUS GET OUT WITH RTN CODE      09789202
OKFREEMN DS    0H                                                       09789602
DROP09C5 DS    0H                                                       09790002
         TM    ALLSW,HEXFOUR      ARE ALL ENTRIES TO BE DELETED         09800002
         BZ    DROP9C5A           NO, GO TEST FOR NEXT ENTRY            09810002
         LR    WORKREG,LASTENTR   YES, GET ADDRESS OF NEXT ENTRY        09820002
         B     DROP09C2           GO SET UP TO DELETE NEXT ENTRY        09830002
DROP9C5A DS    0H                                                       09840002
         TM    TSTFLGS3,NOPARMS   WERE SYMBOLS SPECIFIED                09850002
         BO    EXIT05H5           NO, RETURN TO IKJEGMNL                09860002
DROP09D5 DS    0H                                                       09870002
** THIS CODE TESTS THE WORD FOLLOWING THE SYMBOL PDE FOR NON ZERO    ** 09880002
** WHICH INDICATES THERE IS A LIST OF SYMBOLS TO BE PROCESSED.       ** 09890002
         CLC   D8(L0,PDLBASE),ENDCHAIN IS THERE ANOTHER SYMBOL          09900002
         BE    EXIT05H5           NO, GO RETURN TO IKJEGMNL             09910002
DROP09D4 DS    0H                                                       09920002
         L     WORKREG,SYMTABLE   GET ADDRESS OF SYMBOL TABLE           09930002
         LTR   WORKREG,WORKREG    DOES THE INCORE SYMBOL TABLE EXIST    09940002
         BZ    DROP09B1           NO, GO WRITE MESSAGE                  09950002
         L     PDLBASE,D8(PDLBASE) YES, POINT TO NEXT SYMBOL PDE        09960002
         LA    LASTENTR,SYMTABLE   GET ADDRESS OF LAST ENTRY            09970002
         L     WORKREG2,D0(PDLBASE) GET ADDRESS OF SYMBOL               09980002
         B     DROP09A3            GO FIND SYMBOL IN SYMBOL TABLE       09990002
IKJEGVDK DS    0H                                                       10000002
** THIS CODE IS RESPONSIBLE FOR ANALYSING THE PARAMETERS FOR EQUATE  ** 10010002
** AFTER PARSE HAS CHECKED ONE FOR SYNTAX ERRORS.                    ** 10020002
         SAVE  (14,12)            SAVE PARSE'S REGISTERS                10030002
         L     R15,D4(R1)         OBTAIN ADDR OF SAVEAREA               10040002
         LM    R2,R12,D28(R15)    RESTORE REGISTERS                     10050002
         L     R15,REGSAVE3       GET ADDR OF VALIDITY CHECK RTN'S      10060002
*                                 SAVEAREA                              10070002
         ST    R15,D8(R13)        STORE ADDRESS OF NEW SAVEAREA         10080002
         ST    R13,D4(R15)        STORE CALLERS SAVEAREA ADDRESS        10090002
*                                 IN VALIDITY RTN'S SAVEAREA            10100002
         LR    R13,R15            R13 POINTS TO VALIDITY CHECK          10110002
*                                 RTN'S SAVEAREA                        10120002
         OI    TSTFLGS4,TSTVALCK  TURN ON VALIDITY CHECK BIT            10122002
         L     R7,OUTBUF          PICK UP ADDRESS OF OUTBUF             10124002
         SR    R8,R8              ZERO REGISTER                         10126002
         ST    R8,D0(R7)          STORE DEFAULT (NO MESSAGE INDICATOR)  10128002
         L     PDEPTR,D0(PARMREG) PDEPTR POINTS TO THE PDE PASSED       10130002
*                                 TO THE VALIDITY RTN FROM              10140002
*                                 IKJPARS                               10150002
         TM    CMMNDSW,HEXTWO     IS THIS THE ADDRESS EXIT              10200002
         BC    ONES,VDCK08A1      NO, GO TO THE ATTRIBUTE EXIT          10210002
** THIS CODE ASSURES THAT THE ADDRESS WAS NOT SPECIFIED AS A REGISTER** 10220002
** ADDRESS UNLESS THE REGISTER WAS USED FOR INDIRECT ADDRESSING.     ** 10230002
** THE CHECK IS FIRST MADE ON THE INDIRECT COUNT FIELD OF THE PDE    ** 10240002
** AND IF THIS IS NON ZERO INDIRECT ADDRESSING WAS USED.  THE ADDRESS** 10250002
** IS SPECIFIED CORRECTLY AND PROCESSING IS CONTINUED AT VDCK07G2.   ** 10260002
** IF THE INDIRECT COUNT FIELD IS ZERO A CHECK HAS TO BE MADE IN     ** 10270002
** FLAGS 4 OF THE PDE.  FLAGS 4 INDICATES THE TYPE OF ADDRESS.  IF   ** 10280002
** THE TYPE IS GENERAL REGISTER, DOUBLE PRECISION FLOATING POINT     ** 10290002
** REGISTER OR SINGLE PRECISION FLOATING POINT REGISTER THE ADDRESS  ** 10300002
** IS INCORRECTLY SPECIFIED AND THE VALIDITY CHECK ROUTINE WILL      ** 10310002
** RETURN TO PARSE WITH A RETURN CODE OF EIGHT.                      ** 10320002
         USING IKJPARMA,PDEPTR    ESTABLISH ADDRESSABILITY TO ADDR PDE  10330002
         CLC   PDEINDCT(L2),HEXZER0 WAS INDIRECT ADDRESSING USED        10340002
         BNE   VDCK07G2           YES, GO PROCESS                       10350002
         TM    PDEFLG4,REGSMASK   NO, IS TYPE OF ADDR REGISTER          10360002
         BNZ   VDCK07F3           YES, GO WRITE MESSAGE                 10370002
VDCK07G2 DS    0H                                                       10380002
** THIS CODE SETS UP THE REGISTERS TO GO TO IKJEGCVT (CONVERT) TO    ** 10390002
** CONVERT THE ADDRESS TO BINARY.                                    ** 10400002
         OI    CMMNDSW,HEXTWO     TURN SWITCH ON TO INDICATE THE        10410002
*                                 ADDRESS EXIT HAS BEEN TAKEN           10420002
         XR    R0,R0              CLEAR REG 0 TO INDICATE BINARY        10430002
*                                 CONVERSION NEEDED                     10440002
         LNR   PARMREG,PDEPTR     REG 1 SHOULD BE NEGATIVE TO           10450002
*                                 INDICATE ADDRESS CONVERSION AND       10460002
*                                 SHOULD POINT TO THE PDE               10470002
         L     R15,TSTCONVT       OBTAIN ADDRESS OF IKJEGCVT FROM       10480002
*                                 TCOMTAB                               10490002
         BALR  RETURN,R15         GO TO IKJEGCVT TO CONVERT THE         10500002
*                                 ADDRESS TO BINARY                     10510002
         LPR   PARMREG,PARMREG    RESTORE REGISTER 1 TO POSITIVE        10520002
         B     VDCK07J2(RETCODE)  TAKE ONE OF THE FOLLOWING BRANCHES    10530002
*                                 DEPENDENT ON THE CONTENTS OF REG 15   10540002
VDCK07J2 DS    0H                                                       10550002
** USED TO DETERMINE WHAT TO DO UPON RETURN FROM IKJEGCVT            ** 10560002
         B     VDCK08C1           GO HANDLE 0 RETURN FROM IKJEGCVT      10570002
         B     VDCK07K3           GO HANDLE 4 RETURN FROM IKJEGCVT      10580002
         B     VDCK08C2           GO HANDLE 8 RETURN FROM IKJEGSYM      10590002
         B     VDCK08C2           GO HANDLE 12 RETURN FROM IKJEGSYM     10600002
         B     VDCK08D2           16 - ATTENTION INTERRUPT-RETURN       10610002
         B     VDCK08D2           20 - CONVERT OR SYM BLEW-RETURN       10620002
VDCK07K3 DS    0H                                                       10630002
         NI    CMMNDSW,HEXFD      INDICATE ADDRESS NOT PROCESSED        10640002
         B     VDCK08B3           GO INDICATE PARSE SHOULD PROMPT       10650002
*                                 WITH REENTER                          10660002
VDCK7F3  DS    0H                                                       10670002
VDCK07F3 DS    0H                                                       10720002
         XC    TSTIOPRM,TSTIOPRM  ZERO OUT I/O PARM FIELDS              11000002
         IKJEGSIO MSG,FIRST=M0072,INST11=(APDE,(PDEPTR)), CALL I/O     *11010002
               SECOND=M0274,ID=EQU13,MF=(E,TSTIOPRM) FOR ERROR MSG      11020002
VDCK07F5 DS    0H                                                       11040002
** CALCULATES PROPER DISPLACEMENT THAT BRINGS CONTROL BACK TO THE    ** 11050002
** VALIDITY CHECK ROUTINE AFTER GOING TO THE MESSAGE ROUTINE.        ** 11060002
         LA    DISPLREG,D4        INDICATE VALIDITY CHECK RTN GOING TO  11070002
*                                 MESSAGE ROUTINE                       11080002
         B     MSG06C1            GO TO THE MESSAGE ROUTINE             11090002
VDCK08E3 DS    0H                                                       11100002
         LTR   R15,R15            RETURN CODE FROM IO A ZERO            11110002
         BZ    VDCK08B4           YES, RETURN TO IKJPARS WITH AN 8      11120002
         B     VDCK08D2           NO, RETURN TO IKJPARS WITH A 12       11130002
VDCK08A1 DS    0H                                                       11140002
** THIS CODE IS RESPONSIBLE FOR CHECKING THE INTERGER SUPPLIED FOR   ** 11150002
** LENGTH OR MULTIPLICITY BEING SPECIFIED LESS THAN ONE OR GREATER   ** 11160002
** THAN 256.                                                         ** 11170002
         XR    WORKREG,WORKREG    CLEAR A REGISTER                      11180002
         L     STRNGPTR,D0(PDEPTR) GET ADDR OF CHARACTER STRING         11190002
         LH    WORKREG,D4(PDEPTR) OBTAIN LENGTH OF ATTRIBUTE            11200002
         SLL   WORKREG,TWO        MULTIPLY BY FOUR                      11210002
VDCKTAB3 DS    0H                                                       11220002
         B     VDCKTAB3(WORKREG)  GO PROCESS ACCORDING TO THE NUMBER    11230002
*                                 OF BYTES IN THE ATTRIBUTE             11240002
         B     VDCKONE            GO HANDLE ONE BYTE                    11250002
         B     VDCKTWO            GO HANDLE TWO BYTES                   11260002
         B     VDCKTHRE           GO HANDLE THREE BYTES                 11270002
** VDCKONE,VDCKTWO, AND VDCKTHREE ALL HAVE THE RESPONSIBILITY OF     ** 11280002
** CHECKING TO MAKE SURE THE INTERGER SUPPLIED IS NOT ZERO OR GREATER** 11290002
** THAN 256.                                                         ** 11300002
VDCKONE  DS    0H                                                       11310002
         CLC   D0(L1,STRNGPTR),CHARZERO  IS INTERGER ZERO               11320002
         BE    VDCK08A2           YES, GO PREPARE TO WRITE A MESSAGE    11330002
         B     VDCK08C1           NO, GO SET UP TO RETURN               11340002
VDCK08A2 DS    0H                                                       11350002
         XC    TSTIOPRM,TSTIOPRM  CLEAR I/O PARM FIELDS                 11360002
         IKJEGSIO MSG,FIRST=M0032,SECOND=M0278,ID=EQU13, CALL I/O      *11370002
               MF=(E,TSTIOPRM)    FOR ERROR MESSAGE                     11380002
         B     VDCK07F5           GO PREPARE TO RETURN                  11460002
VDCKTWO  DS    0H                                                       11470002
         CLC   D0(L2,STRNGPTR),CHARZERO IS INTERGER ZERO                11480002
         BE    VDCK08A2           YES, GO PREPARE TO WRITE A MESSAGE    11490002
         B     VDCK08C1           NO, GO SET UP TO RETURN               11500002
VDCKTHRE DS    0H                                                       11510002
         CLC   D0(L3,STRNGPTR),CHARZERO IS INTERGER ZERO                11520002
         BE    VDCK08A2           YES, GO PREPARE TO WRITE A MESSAGE    11530002
         CLC   D0(L3,STRNGPTR),MAXLNGTH IS INTERGER GREATER THAN 256    11540002
         BH    VDCK08A2           YES, GO PREPARE TO WRITE A MESSAGE    11550002
VDCK08C1 DS    0H                                                       11560002
** THIS SETS THE RETURN CODE BACK TO IKJPARS TO A ZERO               ** 11570002
         LA    RETCODE,RET0       SET RETURN CODE TO ZERO               11580002
VDCK08D1 DS    0H                                                       11590002
** THIS CODE IS RESPONSIBLE FOR RESTORING IKJPARS'S REGISTERS AND    ** 11600002
** RETURNING TO IKJPARS WITH A CONDITION CODE IN REGISTER 15 TO      ** 11610002
** INDICATE TO PARSE WHAT EQUATE WANTS PARSE TO DO NEXT.             ** 11620002
         L     R13,D4(R13)        RESTORE SAVEAREA ADDRESS              11640002
         NI    TSTFLGS4,HEXFF-TSTVALCK  TURN OFF VALIDITY CHECK BIT     11642002
         L     R5,OUTBUF          PICK UP POINTER TO OUTBUF             11644002
         LH    R6,D0(R5)          PICK MSG LENGTH FIELD                 11646002
         LTR   R6,R6              TEST FOR PRESENTS OF MSG              11648002
         BZ    NO2NDMSG           IF ZERO THEN THER ISN'T A MESSAGE     11648402
         L     R1,D24(R13)        PICK UP POINTER TO PARSE PARM LIST    11648802
         ST    R5,D8(R1)          STORE ADDRESS OF MESSAGE IN P. L.     11649202
NO2NDMSG DS    0H                                                       11649602
         RETURN (14,12),RC=(15)   RELOAD REGISTERS AND RETURN           11650002
VDCK08C2 DS    0H                                                       11660002
VDCK08D2 DS    0H                                                       11690002
         ST    R15,REGSAVE        SAVE RETURN CODE FOR LATER USE        11700002
         LA    RETCODE,RET12      SET RETURN CODE TO 12                 11710002
         B     VDCK08D1           GO PREPARE TO RETURN TO IKJPARS       11720002
VDCK08B3 DS    0H                                                       11730002
VDCK08B4 DS    0H                                                       11760002
         LA    RETCODE,RET8       SET RETURN CODE TO 8                  11770002
         B     VDCK08D1           GO PREPARE TO RETURN TO IKJPARS       11780002
         DROP  PDEPTR             DROP ADDRESSABILITY TO PDE            11790002
**********************************************************************  11800002
*                        STAE RETRY ROUTINE                          *  11810002
**********************************************************************  11820002
ESTAERTN DS    0H                                                       11830002
         L     WORKREG,CVTPTR     GET CVT ADDRESS                       11840002
         USING CVT,WORKREG        ESTABLISH ADDRESSABILITY TO CVT       11850002
         L     WORKREG,CVTTCBP    GET ADDRESS OF TCB ADDRESS            11860002
         L     WORKREG,D4(WORKREG) GET ADDRESS OF CURRENT TCB           11870002
         DROP  WORKREG            DROP ADDRESSABILITY TO CVT            11880002
         USING TCB,WORKREG        ESTABLISH ADDRESSABLITY TO TCB        11890002
         L     R9,TCBTRN          PICK UP POINTER TO TCOMTAB FROM       11900002
         OI    TSTFLGS4,TSTRERTN  TURN ON RETRY SW                      11902002
*                                 TCBTRN FIELD OF TEST'S TCB            11910002
         L     R13,REGSAVE2       GET ADDRESS OF REGISTERS              11920002
         L     BASEREG,D64(R13)   RESET ADDRESSABILITY                  11930002
         B     EXIT05J4           GO SET RETURN CODE FOR IKJEGMNL       11980002
         EJECT                                                          11990002
IKJEGSPL IKJEGSPL RTRY=ESTAERTN,ABNTB=STATBL,MODNM=IKJEGEQU,TNM=EQUATE/*11990402
               DROP                                                     11990802
ZZZZZZZZ DC    52C'Z'              TO BE USED FOR MAINTENANCE           11992002
H16      DC    H'16'              USED TO TEST RETURN CODES             11994002
ATTRTAB  DS    0H                                                       12000002
** THIS TABLE CONTAINS THE PROPER DATA TYPE REPRESENTATION FOR THE   ** 12010002
** VARIOUS TYPE ATTRIBUTES ALONG WITH THE MIN LENGTH FOLLOWED BY THE ** 12020002
** MAX LENGTH THAT CAN BE SPECIFIED FOR EACH TYPE.  THESE LENGTHS ARE** 12030002
** FOLLOWED BY THE DEFAULT LENGTH.                                   ** 12040002
CENTRY   DC    X'00'              TYPE ATTRIBUTE IS CHARACTER           12050002
         DC    C'001'             MIN LENGTH                            12060002
         DC    C'256'             MAX LENGTH                            12070002
         DC    X'01'              DEFAULT LENGTH IN BINARY              12080002
         DC    C' C'              TYPE IN PRINTABLE FORM                12090002
         DC    C'01'              LENGTH IN PRINTABLE FORM              12100002
XENTRY   DC    X'04'              TYPE ATTRIBUTE IS HEX                 12110002
         DC    C'001'             MIN LENGTH                            12120002
         DC    C'256'             MAX LENGTH                            12130002
         DC    X'04'              DEFAULT LENGTH IN BINARY              12140002
         DC    C' X'              TYPE IN PRINTABLE FORM                12150002
         DC    C'04'              LENGTH IN PRINTABLE FORM              12160002
BENTRY   DC    X'08'              TYPE ATTRIBUTE IS BINARY              12170002
         DC    C'001'             MIN LENGTH                            12180002
         DC    C'256'             MAX LENGTH                            12190002
         DC    X'01'              DEFAULT LENGTH IN BINARY              12200002
         DC    C' B'              TYPE IN PRINTABLE FORM                12210002
         DC    C'01'              LENGTH DEFAULT IN PRINTABLE FORM      12220002
IENTRY   DC    X'0C'              TYPE ATTRIBUTE IS INSTRUCTION         12230002
         DC    C'001'             MIN LENGTH                            12240002
         DC    C'256'             MAX LENGTH                            12250002
         DC    X'01'              DEFAULT LENGTH                        12260002
         DC    C' I'              TYPE IN PRINTABLE FORM                12270002
         DC    C'01'              DEFAULT LENGTH IN PRINTABLE FORM      12280002
FENTRY   DC    X'10'              TYPE ATTRIBUTE IS FIXED PT, FULLWORD  12290002
         DC    C'001'             MIN LENGTH                            12300002
         DC    C'008'             MAX LENGTH                            12310002
         DC    X'04'              DEFAULT LENGTH                        12320002
         DC    C' F'              TYPE IN PRINTABLE FORM                12330002
         DC    C'04'              DEFAULT IN PRINTABLE FORM             12340002
HENTRY   DC    X'14'              TYPE ATTRIBUTE IS FIXED PT, HALFWORD  12350002
         DC    C'001'             MIN LENGTH                            12360002
         DC    C'008'             MAX LENGTH                            12370002
         DC    X'02'              DEFAULT LENGTH IN BINARY              12380002
         DC    C' H'              TYPE IN PRINTABLE FORM                12390002
         DC    C'02'              DEFAULT LENGTH IN PRINTABLE FORM      12400002
EENTRY   DC    X'18'              TYPE ATTRIBUTE IS FLT PT. FULLWORD    12410002
         DC    C'001'             MIN LENGTH                            12420002
         DC    C'008'             MAX LENGTH                            12430002
         DC    X'04'              DEFAULT LENGTH IN BINARY              12440002
         DC    C' E'              TYPE IN PRINTABLE FORM                12450002
         DC    C'04'              DEFAULT LENGTH IN PRINTABLE FORM      12460002
DENTRY   DC    X'1C'              TYPE ATTRIBUTE IS FLT PT. DBLWORD     12470002
         DC    C'001'             MIN LENGTH                            12480002
         DC    C'008'             MAX LENGTH                            12490002
         DC    X'08'              DEFAULT LENGTH                        12500002
         DC    C' D'              TYPE IN PRINTABLE FORM                12510002
         DC    C'08'              DEFAULT LENGTH IN PRINTABLE FORM      12520002
AQENTRY  DC    X'20'              TYPE ATTRIBUTE IS A AND Q ADDR CONST  12530002
         DC    C'001'             MIN LENGTH                            12540002
         DC    C'004'             MAX LENGTH                            12550002
         DC    X'04'              DEFAULT LENGTH IN BINARY              12560002
         DC    C' A'              TYPE IN PRINTABLE FORM                12570002
         DC    C'04'              DEFAULT LENGTH IN PRINTABLE FORM      12580002
YENTRY   DC    X'24'              TYPE ATTRIBUTE IS Y ADDR CONSTANT     12590002
         DC    C'001'             MIN LENGTH                            12600002
         DC    C'002'             MAX LENGTH                            12610002
         DC    X'02'              DEFAULT LENGTH                        12620002
         DC    C' Y'              TYPE IN PRINTABLE FORM                12630002
         DC    C'02'              DEFAULT LENGTH IN PRINTABLE FORM      12640002
SENTRY   DC    X'28'              TYPE ATTRIBUTE IS S ADDR CONSTANT     12650002
         DC    C'002'             MIN LENGTH                            12660002
         DC    C'002'             MAX LENGTH                            12670002
         DC    X'02'              DEFAULT LENGTH IN BINARY              12680002
         DC    C' S'              TYPE IN PRINTABLE FORM                12690002
         DC    C'02'              DEFAULT LENGTH IN PRINTABLE FORM      12700002
PENTRY   DC    X'30'              TYPE ATTRIBUTE IS PACKED DECIMAL      12710002
         DC    C'001'             MIN LENGTH                            12720002
         DC    C'016'             MAX LENGTH                            12730002
         DC    X'01'              DEFAULT LENGTH IN BINARY              12740002
         DC    C' P'              TYPE IN PRINTABLE FORM                12750002
         DC    C'01'              DEFAULT LENGTH IN PRINTABLE FORM      12760002
ZENTRY   DC    X'34'              TYPE ATTRIBUTE IS ZONED DECIMAL       12770002
         DC    C'001'             MIN LENGTH                            12780002
         DC    C'016'             MAX LENGTH                            12790002
         DC    X'01'              DEFAULT LENGTH                        12800002
         DC    C' Z'              TYPE IN PRINTABLE FORM                12810002
         DC    C'01'              DEFAULT LENGTH IN PRINTABLE FORM      12820002
         EJECT                                                          12830002
BINRYONE DC    X'01'              BINARY ONE-USED IN DEFAULT IN LENGTH  12840002
*                                 ATTRIBUTE FIELD                       12850002
FULLWORD DC    X'03'              USED TO TEST FOR FULLWORD BOUNDARY    12860002
HEXZER0  DC    X'0000'            USED TO TEST FOR INDIRECT ADDRESSING  12870002
ENDCHAIN DC    X'FF000000'        USED TO TEST FOR END OF PDL CHAIN     12880002
CHARZERO DC    C'000000'          USED FOR INITIALIZING AND TESTING     12890002
*                                 VALUE SPECIFIED FOR MULTIPLICITY AND  12900002
*                                 LENGTH ATTRIBUTES                     12910002
MAXLNGTH DC    C'256'             MAXIMUN LENGTH ALLOWED SPECIFIED      12920002
*                                 FOR LENGTH AND MULTIPLICITY           12930002
*                                 ATTRIBUTES                            12940002
BASE     DC    A(IKJEGEQU)        ADDRESS OF IKJEGEQU CSECT             12950002
PARSADDR DC    V(IKJEGPAR)        ADDRESS OF PCL FOR IKJPARS-EQUATE     12970002
PARSDROP DC    V(IKJEGPRS)        ADDRESS OF PCL FOR IKJPARS-DROP       12980002
POOLONE  DC    X'01000000'        SUBPOOL NUMBER FOR GETMAIN            12990002
** THE FOLLOWING IS THE STAE MESSAGE TABLE                           ** 13000002
STATBL   DS    0F                                                       13010002
         DC    AL1(99),AL3(PARSBLOW)  PARSE LINK FAILED                 13020002
         DC    AL1(92),AL3(SYM02G3)   GETMAIN FAILED                    13030002
         DC    AL1(HEXFF)             END OF STAE ABEND TABLE           13040002
RETRYADR DC    AL3(ESTAERTN)      ADDRESS OF STAE EXIST ROUTINE         13050002
STAEL2   DS    0F                                                       13060002
STAELIST ESTAE STAELIST,MF=L      LIST FORM STAE MACRO                  13070002
STAELEN  EQU   *-STAELIST         LENGTH OF STAE LIST                   13080002
         EJECT                                                          14140002
IKJEGPAR IKJPARM DSECT=DSECTEQU                                         14150002
GETSYMBL IKJIDENT 'SYMBOL',MAXLNTH=8,OTHER=ALPHANUM,                   X14160002
               PROMPT='SYMBOL'                                          14170002
GETADDR  IKJPOSIT ADDRESS,PROMPT='ADDRESS',VALIDCK=IKJEGVDK             14180002
TYPEADDR IKJKEYWD                                                       14190002
         IKJNAME 'C'                                                    14200002
         IKJNAME 'X'                                                    14210002
         IKJNAME 'B'                                                    14220002
         IKJNAME 'I'                                                    14230002
         IKJNAME 'F'                                                    14240002
         IKJNAME 'H'                                                    14250002
         IKJNAME 'E'                                                    14260002
         IKJNAME 'D'                                                    14270002
         IKJNAME 'A'                                                    14280002
         IKJNAME 'Y'                                                    14290002
         IKJNAME 'S'                                                    14300002
         IKJNAME 'P'                                                    14310002
         IKJNAME 'Z'                                                    14320002
TYPELNTH IKJKEYWD                                                       14330002
         IKJNAME 'LENGTH',SUBFLD=LENGTHCD                        A43351 14340002
TYPEMULT IKJKEYWD                                                       14350002
         IKJNAME 'MULTIPLE',SUBFLD=MULTCD                        A43351 14360002
LENGTHCD IKJSUBF                                                        14370002
LENGTH   IKJIDENT  'LENGTH',FIRST=NUMERIC,OTHER=NUMERIC,MAXLNTH=3,     *14380002
               PROMPT='INTEGER FOR LENGTH',VALIDCK=IKJEGVDK             14390002
MULTCD   IKJSUBF                                                        14400002
MULTPCTY IKJIDENT  'MULTIPLICITY FACTOR',FIRST=NUMERIC,OTHER=NUMERIC,  *14410002
               PROMPT='INTEGER FOR MULTIPLICITY',VALIDCK=IKJEGVDK       14420002
         IKJENDP                                                        14430002
IKJEGPRS IKJPARM DSECT=DSECTDRP                                         14440002
DROPSYM  IKJIDENT 'SYMBOL',LIST,MAXLNTH=8,OTHER=ALPHANUM,              *14450002
               PROMPT='SYMBOL'                                          14460002
         IKJENDP                                                        14470002
         EJECT                                                          14480002
CVT      DSECT                                                          14490002
         CVT                                                            14500002
         EJECT                                                          14510002
         IKJTCB                                                         14520002
         EJECT                                                          14530002
TCOMTAB  TCOMTAB                                                        14540002
         EJECT                                                          14550002
         TSTCWORK                                                       14560002
         EJECT                                                          14570002
AREAWORK DSECT                                                          14580002
PPLAREA  DS    7F                 PARSE PARAMETER LIST-DESCRIPTION      14590002
*                                 IN PPL MACRO EXPANSION                14600002
** THE FOLLOWING TWO WORDS CANNOT BE SEPARATED.  USED AS A PARAMETER ** 14610002
** LIST TO GO TO IKJEGIO.                                            ** 14620002
ADDRONE  DS     A                 SAVEAREA FOR ADDR OF 1ST LEVEL MSG    14630002
ADDRTWO  DS     A                 SAVEAREA FOR ADDR OF 2ND LEVEL MSG    14640002
REGSAVE  DS     F                 SAVEAREA FOR SERVICE RTN RETURN CODES 14650002
STAEL    DS    0F                 ALIGN TO FULLWORD BOUNDARY            14660002
STAEAREA DS    18C                STAE LIST FORM WORKAREA               14670002
LNGTWORK DS    3X                 WORKAREA FOR LENGTH ATTRIBUTE         14680002
DUPLSW   EQU    *                 BIT 1 INDICATES ON (X'01')            14690002
CMMNDSW  EQU    *                 ADDR EXIT SWITCH ON -(X'02')          14700002
MULTSW   EQU    *                 BIT 3 INDICATES ON (X'04')            14710002
WRAPUP   DS     X                 TERMINATE SWITCH ON - (X'08')         14720002
LOWSW    EQU    *                 LOW VALUE SWITCH ON - (X'01')         14730002
DROPSW   EQU    *                 DROP SWITCH ON - (X'02')              14740002
ALLSW    DS     X                 DELETE ENTRIE TABLE ON - (X'04')      14750002
ENDWORK  EQU    *                                                       14760002
         EJECT                                                          14770002
ENTRY    DSECT                                                          14780002
** THE FOLLOWING SEVEN FIELDS CANNOT BE SEPARATED.                   ** 14790002
TABENTR  DS    0F                                                       14800002
CHAIN    DS     A                 POINTER TO NEXT ENTRY IN SYM TABLE    14810002
ADDRSYM  DS     A                 LOAD ADDRESS OF SYMBOL                14820002
ATTRTYPE DS     X                 TYPE ATTRIBUTE FIELD                  14830002
ATTRMULT DS    3X                 MULTIPLICITY ATTRIBUTE FIELD          14840002
ATTRLNTH DS    2X                 LENGTH ATTRIBUTE FIELD                14850002
SYMLNGTH DS    2X                 LENGTH OF SYMBOL                      14860002
SYMBOL   DS    8X                 SYMBOL FIELD                          14870002
         EJECT                                                          14880002
** THE FOLLOWING DSECT WILL BE USED TO BUILD MESSAGE INSERTS         ** 14880102
MSGINST  DSECT                                                          14880402
WKINSTS  DS    48X                                                      14880802
         ORG   WKINSTS                                                  14881202
IN11     DS    0H                                                       14881602
IN11LENG DS    H                  HALFWORD WHICH WILL CONTAIN INS. LG   14881702
         DS    H                  FILLER                                14881802
IN11TXT  DS    8C                 AREA FOR TEXT OF THE INSERT           14881902
IN12     DS    0H                                                       14884602
IN12LENG DS    H                  HALFWORD WHICH WILL CONTAIN INS. LG   14886602
         DS    H                  FILLER                                14887002
IN12TXT  DS    8C                 AREA FOR TEXT OF THE INSERT           14887102
IN21     DS    0H                                                       14887202
IN21LENG DS    H                  HALFWORD WHICH WILL CONTAIN INS. LG   14888102
         DS    H                  FILLER                                14888502
IN21TXT  DS    8C                 AREA FOR TEXT OF THE INSERT           14888902
IN22     DS    0H                                                       14889002
IN22LENG DS    H                  HALFWORD WHICH WILL CONTAIN INS. LG   14891702
         DS    H                  FILLER                                14893702
IN22TXT  DS    8C                 AREA FOR TEXT OF THE INSERT           14894102
         EJECT                                                          14894602
IKJPARMA IKJPARMA                                                       14897302
         EJECT                                                          14900002
         IKJPPL                                                         14910002
         END                                                            14920002
./  ADD  SSI=33200316,NAME=IKJEGGO
GO       TITLE 'GO RUN CALL COMMAND PROCESSOR (IKJEGGO)'                00002002
         COPY  IKJEGSIO                                                 00006002
IKJEGGO  CSECT                                                          00100002
*D324940,392300,491500,565500-567000                           XXXXXXXX 00101002
*C324960,492000                                                XXXXXXXX 00102002
*A387010,520610-520620,524610-524640                           XXXXXXXX 00103002
         EJECT                                                          00110002
*********************************************************************** 00150002
* STATUS                                                              * 00200002
*    CHANGE LEVEL 00,VERSION NUMBER 02, VS2     02/27/73              * 00210002
*                                                                     * 00250002
* FUNCTION                                                            * 00300002
*    GO-CAUSES THE MODE TO CHANGE FROM COMMAND (IN WHICH YOU MAY ENTER* 00350002
*    TEST COMMANDS) TO PROBLEM PROGRAM.  GO WITHOUT THE ADDRESS       * 00400002
*    PARAMETER CAUSES EXECUTION TO BEGIN AT THE INITIAL ENTRY         * 00450002
*    POINT IF THE PROBLEM PROGRAM HAD BEEN LOADED BY TEST OR          * 00500002
*    CAUSES EXECUTION TO BEGIN FROM THE POINT OF INTERRUPTION.        * 00550002
*    GO WITH AN ADDRESS CAUSES EXECUTION TO PROCEED AS IF A           * 00600002
*    BRANCH HAD BEEN TAKEN TO THAT ADDRESS.  WHEN A BREAKPOINT        * 00650002
*    IS ENCOUNTERED OR EXECUTION IS COMPLETED THE MODE IS CHANGED     * 00700002
*    BACK TO COMMAND MODE.                                            * 00750002
*                                                                     * 00800002
*    CALL-DIFFERS FROM 'GO' IN THAT IT INITIALIZES REGISTERS 1, 14,   * 00850002
*    AND 15 OF THE PROBLEM PROGRAM'S REGISTERS AT THE TIME            * 00900002
*    EXECUTION BEGINS THUS ALLOWING FOR THE PASSING OF A              * 00950002
*    PARAMETER LIST TO THE PROBLEM PROGRAM.  REGISTER 1 IS SET TO     * 01000002
*    A DUMMY PARAMETER LIST IF 'PARM' IS NOT SPECIFIED.  THE HIGH     * 01050002
*    ORDER BIT OF THE LAST PARAMETER IS SET TO 1 IF 'VL' IS           * 01100002
*    SPECIFIED.  REGISTER 14 WILL CONTAIN THE RETURN ADDRESS          * 01150002
*    WHICH WILL CAUSE A CHANGE IN THE MODE BACK TO THE COMMAND        * 01200002
*    MODE IN WHICH TEST COMMANDS CAN BE ISSUED.  IF THE 'RETURN'      * 01250002
*    KEYWORD IS SPECIFIED, REGISTER 14 IS SET TO THE RETURN           * 01300002
*    ADDRESS SPECIFIED.  THE ADDRESS PARAMETER MUST BE SPECIFIED      * 01350002
*    WITH THE CALL COMMAND.                                           * 01400002
*                                                                     * 01450002
*    RUN-DIFFERS FROM 'GO' IN THAT IT REMOVES ALL THE BREAKPOINTS     * 01500002
*    ESTABLISHED BY 'AT' AND ADJUSTS THE ENVIRONMENT SO THAT          * 01550002
*    TEST IS REMOVED UPON TERMINATION OF THE PROBLEM PROGRAM.         * 01600002
*                                                                     * 01650002
* ENTRY POINTS                                                        * 01700002
*                                                                     * 01750002
*         IKJEGGO-ENTERED VIA LINK FROM IKJEGMNL.  REGISTER 9 WILL    * 01800002
*    POINT TO TCOMTAB, THE COMMON DSECT USED BY TEST.  THIS IS THE    * 01850002
*    ENTRY POINT WHEN THE GO COMMAND HAS BEEN ISSUED.                 * 01900002
*                                                                     * 01950002
*         IKJEGRUN-ENTERED VIA LINK FROM IKJEGMNL.  REGISTER 9 WILL   * 02000002
*    POINT TO TCOMTAB, THE COMMON DSECT USED BY TEST.  THIS IS THE    * 02050002
*    ENTRY POINT WHEN THE RUN COMMAND HAS BEEN ISSUED.                * 02100002
*                                                                     * 02150002
*         IKJEGCAL-ENTERED VIA LINK FROM IKJEGMNL.  REGISTER 9 WILL   * 02200002
*    POINT TO TCOMTAB, THE COMMAND DSECT USED BY TEST.  THIS IS THE   * 02250002
*    ENTRY POINT WHEN THE CALL COMMAND HAS BEEN ISSUED.               * 02300002
*                                                                     * 02350002
*         ADDRCHK-ENTERED FROM IKJPARS.  REGISTER 1 POINTS TO A       * 02400002
*    THREE WORD PARAMETER LIST.  THE FIRST WORD POINTS TO THE         * 02450002
*    ADDRESS PDE BUILT BY IKJPARS, THE SECOND WORD POINTS TO          * 02500002
*    TCOMTAB AND THE THIRD WORD IS TO BE USED BY THE VALIDITY         * 02550002
*    CHECK ROUTINE TO PASS A POINTER TO A SECOND LEVEL MESSAGE        * 02600002
*    BACK TO IKJPARS.  THIS ROUTINE IS RESPONSIBLE FOR VALIDITY       * 02650002
*    CHECKING ALL PARAMETERS FOR GO, CALL, AND RUN.                   * 02700002
*                                                                     * 02750002
* INPUT                                                               * 02800002
*    THE REQUESTED FUNCTION WILL BE POINTED TO BY THE INBUF FIELD     * 02850002
*    FOUND IN TCOMTAB.  THE FORMAT OF THE GO STATEMENT IS             * 02900002
*    GO ADDR       WHERE THE ADDRESS IS AN OPTIONAL PARAMETER.        * 02950002
*    THE RUN STATEMENT ALSO HAS THE ADDRESS AS AN OPTIONAL PARAMETER  * 03000002
*    AND ITS FORMAT IS                                                * 03050002
*    RUN ADDR                                                         * 03100002
*    THE CALL STATEMENT HAS THE FOLLOWING FORMAT WITH ALL PARAMETERS  * 03150002
*    OPTIONAL EXCEPT THE ADDRESS PARAMETER.                           * 03200002
*    CALL ADDR PARM(ADDR-LIST) VL RETURN(ADDR)                        * 03250002
*                                                                     * 03300002
* OUTPUT                                                              * 03350002
*    GO AND CALL WILL CAUSE THE EXECUTION OF THE PROBLEM PROGRAM      * 03400002
*    WHICH CHANGES THE MODE TO PROBLEM PROGRAM UNTIL A BREAKPOINT IS  * 03450002
*    ENCOUNTERED OR UNTIL COMPLETE EXECUTION OF THE PROBLEM           * 03500002
*    PROGRAM, AT WHICH POINT GO AND CALL CHANGE THE MODE BACK TO THE  * 03550002
*    COMMAND MODE IN WHICH TEST COMMANDS MAY BE ENTERED.              * 03600002
*    RUN CAUSES THE EXECUTION OF THE PROBLEM PROGRAM WHICH CHANGES THE* 03650002
*    MODE TO PROBLEM PROGRAM AND UPON COMPLETION OF EXECUTION THE MODE* 03700002
*    WILL REMAIN PROBLEM PROGRAM.  RUN WIPES OUT ALL TRACES OF TEST.  * 03750002
*                                                                     * 03800002
* EXTERNAL REFERENCES                                                 * 03850002
*                                                                     * 03900002
*         IKJPARS-TO VALIDITY CHECK AND SCAN THE COMMAND BUFFER.      * 03950002
*    REGISTER 1 WILL POINT TO A 7 WORD PARAMETER LIST.                * 04000002
*                                                                     * 04050002
*         IKJEGCVT-TO CONVERT THE ADDRESS TO BINARY.  REGISTER 1      * 04100002
*    WILL BE THE ADDRESS COMPLEMENT OF THE ADDRESS PDE.  REGISTER 0   * 04150002
*    WILL BE POSITIVE TO INDICATE BINARY CONVERSION.                  * 04200002
*                                                                     * 04250002
*         IKJEGSIO-TO WRITE DIAGNOSTIC MESSAGES.                      * 04300002
*                                                                     * 04350002
* EXITS, NORMAL                                                       * 05050002
*                                                                     * 05100002
*         IKJPARS-VIA BRANCH REGISTER 14 FROM ADDRCHK WITH ONE OF THE * 05150002
*    FOLLOWING RETURN CODES IN REGISTER 15-                           * 05200002
*    0   INDICATING TO CONTINUE PROCESSING THE COMMAND BUFFER         * 05250002
*    8   INDICATING IKJPARS SHOULD PROMPT WITH REENTER                * 05300002
*    12  INDICATING IKJPARS SHOULD RETURN TO IKJEGGO WITH A RETURN    * 05350002
*    *   CODE OF 20                                                   * 05400002
*                                                                     * 05450002
*         IKJEGMNL-VIA BRANCH REGISTER 14 FROM IKJEGCAL AND IKJEGGO   * 05500002
*    WITH ONE OF THE FOLLOWING RETURN CODES IN REGISTER 15-           * 05550002
*    4    NORMAL END OF PROCESSING                                    * 05600002
*    16   INDICATING AN ATTENTION INTERRUPT WAS ENCOUNTERED           * 05650002
*    *    DURING PROCESSING                                           * 05700002
*                                                                     * 05750002
*         IKJEGMNL-VIA BRANCH REGISTER 14 FROM IKJEGRUN WITH ONE      * 05800002
*    OF THE FOLLOWING RETURN CODES IN REGISTER 15-                    * 05850002
*    12   NORMAL END OF PROCESSING, RUNSW IN TCOMTAB ON               * 05900002
*    16   INDICATING AN ATTENTION INTERRUPT WAS ENCOUNTERED           * 05950002
*    *    DURING PROCESSING                                           * 06000002
*                                                                     * 06050002
* EXITS, ERROR                                                        * 06100002
*         IKJEGMNL-VIA BRANCH REGISTER 14 WITH ONE OF THE FOLLOWING   * 06150002
*    RETURN CODES IN REGISTER 15 -                                    * 06200002
*    00   SYSTEM ERROR, TSTFLUSH IN TCOMTAB ON                        * 06250002
*    12   CRITICAL SYSTEM ERROR IN RUN PROCESSING, RUNSW IN           * 06260002
*    TCOMTAB OFF, TSTFLUSH IN TCOMTAB ON                              * 06280002
*    20   RETURN FROM ESTAE RETRY ROUTINE                             * 06300002
*    24   INDICATING AN ESTAE ERROR EITHER IN THIS MODULE OR A        * 06310002
*         MODULE CALLED BY THIS MODULE                                * 06320002
*                                                                     * 06350002
* TABLES/WORK AREAS                                                   * 06400002
*    THIS MODULE USES THE COMMON DSECT OF THE TEST PACKAGE-TCOMTAB.   * 06450002
*    AREA POINTED TO BY WORKAREA IN TCOMTAB.  THE PARAMETER CONTROL   * 06550002
*    LIST FOR IKJPARS IS BUILT IN THE WORKAREA.                       * 06560002
*    TCOMTAB CONTAINS POINTERS TO THIS MODULE'S SAVEAREA, A POINTER   * 06600002
*    TO THE COMMAND BUFFER, AND A POINTER TO THE OUTPUT BUFFER.       * 06610002
*                                                                     * 06750002
* ATTRIBUTES                                                          * 06800002
*    REENTRANT, REFRESHABLE                                           * 06850002
*                                                                     * 06900002
* CHARACTER CODE DEPENDENCY                                           * 06950002
*    THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL            * 07000002
*    REPRESENTATION OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT * 07050002
*    TO THE ONE USED AT ASSEMBLY TIME.  THE CODING HAS BEEN ARRANGED  * 07100002
*    SO THAT REDEFINITION OF CHARACTER CONSTANTS, BY REASSEMBLY,      * 07150002
*    WILL RESULT IN A CORRECT MODULE FOR THE NEW DEFINITIONS.         * 07200002
*                                                                     * 07250002
* NOTES                                                               * 07300002
*    ABBREVIATIONS COMMONLY USED IN THE COMMENTS BESIDE THE CODE      * 07350002
*    1.   PDL-PARAMETER DESCRIPTOR LIST                               * 07400002
*    2.   PDE-PARAMETER DESCRIPTOR ENTRY                              * 07450002
*    3.   PCL-PARAMETER CONTROL LIST                                  * 07500002
*    4.   PPL-PARSE PARAMETER LIST                                    * 07550002
*    THE COMMENTS ON THE STATEMENTS GENERALLY START IN COLUMN 30.     * 07600002
*    STAERTN IS THE ENTRY POINT TO THE STAE RETRY ROUTINE AND IS      * 07650002
*    ENTERED FROM IKJEGSTA.                                           * 07700002
*********************************************************************** 07750002
         EJECT                                                          07800002
*********************************************************************** 07850002
*                                                                     * 07900002
*        OTHER ENTRY POINTS TO THIS MODULE                            * 07950002
*                                                                     * 08000002
*********************************************************************** 08050002
         ENTRY IKJEGRUN                                                 08100002
         ENTRY IKJEGCAL                                                 08150002
         SPACE 3                                                        08200002
*********************************************************************** 08250002
*                                                                     * 08300002
*                      EQUATES                                        * 08350002
*                                                                     * 08400002
*********************************************************************** 08450002
         SPACE                                                          08500002
R0       EQU   0             REGISTER 0 - USED AS A PARM REGISTER       08550002
R1       EQU   1             REGISTER 1 - WORK REG AND SYSTEM REG       08600002
R2       EQU   2             REGISTER 2 - WORKREG                       08650002
R3       EQU   3             REGISTER 3 - WORKREG                       08700002
R4       EQU   4             REGISTER 4 - WORKREG                       08750002
R5       EQU   5             REGISTER 5 - WORKREG                       08800002
R6       EQU   6             REGISTER 6 - USED FOR TSTCWORK             08850002
*                            ADDRESSABILITY - SET IN SETUP CODE AND     08900002
*                            ABNORMAL ADDRCHCK RETURNS AND              08950002
*                            NOWHERE ELSE.                              09000002
R7       EQU   7             REGISTER 7 - BASE FOR ADDR PDE             09050002
R8       EQU   8             REGISTER 8 - WORKREG                       09100002
R9       EQU   9             REGISTER 9 - BASE FOR TCOMTAB              09150002
R10      EQU   10            REGISTER 10 - FOR INTERNAL BAL'S           09200002
R11      EQU   11            REGISTER 11 - RESERVED FOR MAINTENANCE     09250002
R12      EQU   12            REGISTER 12 - BASE FOR CSECT               09300002
R13      EQU   13            REGISTER 13 - SAVE AREA POINTER            09350002
R14      EQU   14            REGISTER 14 - FOR EXTERNAL BALR'S          09400002
R15      EQU   15            REGISTER 15 - WORKREG AND RETURN CODES     09450002
         SPACE                                                          09500002
L0       EQU    0            LENGTH OF 0 FOR EXECUTED MOVES             09550002
L2       EQU    2            LENGTH OF 2                                09600002
L3       EQU    3            LENGTH OF 3                                09650002
L4       EQU    4            LENGTH OF 4                                09700002
L8       EQU    8            LENGTH OF 8                                09750002
L12      EQU    12           LENGTH OF 12                               09800002
         SPACE                                                          09850002
D0       EQU    0            DISPLACEMENT OF 0                          09900002
D1       EQU    1            DISPLACEMENT OF 1                          09950002
D2       EQU    2            DISPLACEMENT OF 2                          10000002
D4       EQU    4            DISPLACEMENT OF 4                          10050002
D6       EQU    6            DISPLACEMENT OF 6                          10100002
D8       EQU    8            DISPLACEMENT OF 8                          10150002
         SPACE                                                          10200002
FACTOR   EQU    8            USED TO CALCULATE MSG DISPLACEMENT         10250002
FOUR     EQU    4            RETURN CODE FROM CALL AND GO               10300002
GOCODE   EQU   X'04'         GO RETURN CODE                             10350002
EIGHT    EQU    8            CALL CODE FOR PARSE EXIT                   10400002
ERCODE   EQU   8             ERROR RETURN CODE FROM RUN TO END TEST     10450002
CALLCODE EQU   GOCODE        CALL RETURN CODE - SAME AS GO              10500002
TWELVE   EQU   12            PARSE VALIDITY CHECK AND RUN RETURN CODES  10550002
RUNCODE  EQU   X'0C'         RUN RETURN CODE                            10600002
RET16    EQU   16            USED TO SET ATTN RETURN CODE FOR IKJEGMNL  10650002
RC24     EQU   24            ESTAE ERROR RETURN CODE                    10660002
RETCOD20 EQU   20            USED TO SET STAE RETURN CODE FOR IKJEGMNL  10700002
HEXONE   EQU   X'01'         INDICATOR GETMAIN FAILED                   10750002
HEXTHREE EQU   X'03'         INDICATOR LINK FAILED                      10800002
HEXFF    EQU   X'FF'         INDICATOR OF END OF STAE ABEND TABLE       10850002
HEXOF    EQU   X'0F'         BINARY '00001111' USED TO TEST FOR         10900002
*                            KEYWORDS FROM PARSE                        10950002
HIGHBIT  EQU   B'10000000'   HIGH ORDER BIT MASK.                       11000002
LENBITS  EQU   X'C0'         LENGTH BITS OF OP CODE                     11020002
PLUSSIGN EQU   C'+'          PLUS SIGN FOR INDICATING 2ND LEVEL MSG     11050002
         EJECT                                                          11550002
         USING TCOMTAB,R9    SET UP TCOMTAB ADDRESSABILITY              11600002
*                            FOR THIS CSECT                             11650002
         USING TSTCWORK,R6   R6 WILL BE SET UP TO POINT TO              11700002
*                            TSTCWORK                                   11750002
         SPACE                                                          11800002
*********************************************************************** 11850002
*                                                                     * 11900002
*                 GO PROCESSING STARTS HERE                           * 11950002
*                                                                     * 12000002
*********************************************************************** 12050002
         SPACE                                                          12100002
GO       DS    0H            GO COMMAND OF TEST                         12150002
         SAVE  (14,12),,*    SAVE CALLER'S REGISTERS                    12200002
         LR    R12,R15       ESTABLISH ADDRESSABILITY TO BEGINNING      12250002
         USING IKJEGGO,R12   OF PROGRAM                                 12300002
         LA    R5,GOSPL      R5=ADDR OF ESTAE PARM LIST                 12310002
         BAL   R10,SETUP     FINISH ENTRY LINKAGE, ISSUE STAE, AND      12350002
*                            POINT R6 TO GO'S WORKAREA                  12400002
         MVI   CMDCODE,GOCODE SAVE GO RETURN CODE                       12450002
         LA    R2,FOUR       SAVE GO CODE FOR PARSBILD ROUTINE          12500002
         SPACE                                                          12550002
INIT     DS    0H            RUN PROCESSING ENTERS HERE                 12600002
*********************************************************************** 12650002
**             CHECK FOR AN ADDRESS IN INPUT COMMAND                 ** 12700002
*********************************************************************** 12750002
         TM    TSTFLGS3,NOPARMS  HAS AN ADDRESS BEEN SUPPLIED.          12800002
         BO    RESUME        NO ADDRESS - CONTINUE.                     12850002
*********************************************************************** 12900002
**             SET UP PCL AND PARSE THE COMMAND                      ** 12950002
*********************************************************************** 13000002
         L     R4,GOCON      REG 4 CONTAINS GO PARAMETER CONTROL        13050002
*                            LIST (PCL) ADDRESS                         13100002
         BAL   R10,PARSBILD  BUILD PARM LIST AND PARSE INPUT            13150002
         SPACE                                                          13200002
*********************************************************************** 13250002
** CHECK TO SEE IF AN ADDRESS IS SPECIFIED.  IF SO USE IT TO ALTER   ** 13300002
** THE PROGRAM'S RESUME ADDRESS, OTHERWISE BACK THE CURRENT RESUME   ** 13350002
** ADDRESS UP TWO BYTES TO CONTINUE.                                 ** 13400002
*********************************************************************** 13450002
         SPACE                                                          13500002
         SR    R5,R5         CLEAR REGISTER 5                           13550002
         L     R7,TSTANSPL   REG 7 CONTAINS ADDRESS OF PDL              13600002
         USING GORUNDUM,R7   ESTABLISH PDL ADDRESSABILITY               13650002
         LA    R7,ADDR       REG 7 CONTAINS ADDR OF ADDRESS PDE         13700002
         DROP  R7            DROP PDL ADDRESSABILITY                    13750002
         USING IKJPARMA,R7   ESTABLISH PDE ADDRESSABILITY               13800002
*********************************************************************** 13850002
*              REGISTER 7 IS USED AS THE BASE FOR ALL PDE             * 13900002
*              REFERENCES FROM HERE ON                                * 13950002
*********************************************************************** 14000002
         O     R5,PDEUSER    REG 5 CONTAINS ADDRESS IF SPECIFIED        14050002
         BZ    RESUME        NONE SPECIFIED, USE RESUME ADDR.           14100002
         SPACE                                                          14150002
*********************************************************************** 14200002
**             AN ADDRESS WAS SUPPLIED, TURN OFF WAIT COUNT          ** 14250002
*********************************************************************** 14300002
SETWAIT  DS    0H                                                       14350002
         L     R3,PPTCB      ADDR SPECIFIED, REG 3 CONTAINS ADDR OF     14400002
*                            PROBLEM PROGRAM TCB                        14450002
         IKJEGS9G  WCF,TCBADDR=(R3),MF=(E,SVCPARMS)   TURN OFF         *14500002
                             WAIT COUNT                                 14550002
         LTR   R15,R15       SVC 97 RETURN CODE ZERO ?                  14600002
         BNZ   SVCERR        NO, ISSUE ERROR MESSAGE AND QUIT           14650002
         B     PSWSET        SPECIFIED, USE IT.                         14700002
         SPACE                                                          14750002
*********************************************************************** 14800002
** REGISTER 5 CONTAINS THE PRESUMED NEW IC ADDR FOR THE PROGRAM.     ** 14850002
** DETERMINE IF A USER-INSERTED BREAKPOINT EXISTS AT THAT ADDR.      ** 14900002
*********************************************************************** 14950002
BREAKTST DS    0H                                                       15000002
         SPACE                                                          15050002
         L     R4,BREAKTAB   REG 4 CONTAINS ADDR OF FIRST ELEMENT       15100002
         SPACE                                                          15150002
*********************************************************************** 15200002
**THIS CODE TESTS TO SEE IF THE NEW IC IS ON THE BREAK ELEMENT CHAIN ** 15250002
*********************************************************************** 15300002
LOOP1    DS    0H                                                       15350002
         LTR   R4,R4         IS THIS THE END OF CHAIN                   15400002
         BZ    PSWSET2       YES, ADDR NOT A BREAKPOINT, USE IT FOR     15450002
*                            RESUME ADDRESS                             15500002
         USING BRKELEM,R4    ESTABLISH BREAK ELEMENT ADDRESSABILITY     15550002
         C     R5,BRKADDR    IS ADDR SPECIFIED THIS BREAK ADDR          15600002
         BE    BREAK         YES, GO SET UP TO CHANGE THE IC            15650002
         L     R4,BRKLINK    NO, POINT TO NEXT BREAK ELEMENT            15700002
         B     LOOP1         GO TEST FOR BREAK POINT AT PRESUMED NEW    15750002
*                            IC ADDRESS                                 15800002
         SPACE                                                          15850002
*********************************************************************** 15900002
*        NO ADDRESS SUPPLIED. IF THIS IS A RUN REQUEST, GO REMOVE     * 15950002
*        ALL REMNANTS OF TEST FROM PP'S TCBS. OTHERWISE, GET RESUME   * 16000002
*        ADDRESS FROM OLD PSW IN SVRB FOR GO AND CALL.                * 16050002
*********************************************************************** 16100002
RESUME   DS    0H                                                       16150002
         L     R5,PPTCB      REG 5 POINTS TO THE PROBLEM PROGRAM TCB    16300002
         L     R5,TCBRBP-TCB(R5) REG 5 POINTS TO THE BREAKPOINT SVRB    16350002
         L     R5,RBLINK-RBSECT(R5)    REG 5 POINTS TO THE PROBLEM      16400002
*                            PROGRAM REQUEST BLOCK                      16450002
         L     R5,RBOPSW-RBSECT+D4(R5) PICK UP THE RESUME IC FROM       16500002
*                            THE OLD PSW (RBOPSW) IN THE REQUEST BLOCK  16550002
         LA    R5,D0(R5)     CLEAR HIGH ORDER BYTE                      16600002
         CLI   CMDCODE,RUNCODE    IS THIS A RUN REQUEST ?               16610002
         BE    RUNSET        YES, SET RESUME ADDRESS FOR RUN            16620002
         CLC   D0(L2,R5),TSTSVC IS BREAKPOINT INSTR THERE               16650002
         BE    BREAKTST      YES, CHECK FOR USER-SET BREAKPOINT         16700002
         B     EXIT          NO, GO RETURN TO MAINLINE                  16750002
         SPACE 2                                                        16800002
*********************************************************************** 16850002
** RESUME ADDRESS IN REGISTER 5 IS ADDRESS OF A BREAK SVC.           ** 16900002
** SET REGISTER 5 TO POINT TO INSTRUCTION SAVED IN THE BREAK ELEMENT.** 16950002
** THE PROBLEM PROGRAM WILL RESUME AT THAT POINT.                    ** 17000002
*********************************************************************** 17050002
BREAK    DS    0H                                                       17100002
         LA    R5,BRKINST    REG 5 CONTAINS ADDRESS OF SAVED INST       17150002
*********************************************************************** 17200002
*        R5 CONTAINS NEW RESUME ADDRESS. PUT IT INTO RESUME           * 17250002
*        PSW IN SVRB                                                  * 17300002
*********************************************************************** 17350002
PSWSET2  DS    0H                                                       17400002
         L     R3,PPTCB      GET ADDRESS OF PP'S TCB                    17450002
PSWSET   DS    0H                                                       17500002
         LA    R5,D0(R5)     CLEAR HIGH ORDER BYTE OF ADDR              17510002
         IKJEGS9G OPSW,TCBADDR=(R3),VALUE=(R5),MF=(E,SVCPARMS)         *17550002
                             RESET IC IN RESUME PSW                     17600002
         LTR   R15,R15       SVC 97 RETURN CODE ZERO?                   17650002
         BNZ   SVCERR        NO, ISSUE ERROR MESSAGE AND QUIT           17700002
         SPACE                                                          17750002
*********************************************************************** 17800002
*        IF THIS IS A RUN REQUEST, GO REMOVE ALL REMNANTS OF TEST     * 17850002
*        FROM PP'S TCBS.                                              * 17900002
*********************************************************************** 17950002
         CLI   CMDCODE,RUNCODE  IS THIS A RUN REQUEST ?                 18000002
         BE    RESET         YES, GO RESET TCBS                         18050002
         SPACE                                                          18100002
*********************************************************************** 18150002
*        NORMAL RETURN TO MAINLINE FROM GO, CALL, AND RUN             * 18200002
*********************************************************************** 18250002
EXIT     DS    0H            SET PROPER RETURN CODE (CONTAINED IN R11)  18300002
         SR    R15,R15       ZERO REG 15                                18350002
         IC    R15,CMDCODE   PUT RETURN CODE INTO REGISTER 15           18400002
         SPACE                                                          18450002
RETURN   DS    0H            RETURN TO IKJEGMNL                         18500002
         LR    R2,R15        SAVE RETURN CODE                           18502002
         ESTAE 0             REMOVE ESTAE                               18510002
         LR    R15,R2        RESET RETURN CODE                          18512002
         NI    TSTFLGS4,HEXFF-TSTRERTN TURN OFF RETRY BIT               18520002
         L     R13,SAVELAST-SAVEAREA(R13) RESET SAVE AREA POINTER       18550002
         RETURN  (14,12),RC=(15)  RETURN TO IKJEGMNL                    18600002
         SPACE                                                          18650002
*********************************************************************** 18700002
*        INPUT COMMAND WAS INCORRECT AND PARSE WAS UNABLE TO          * 18750002
*        PROMPT. TELL MAINLINE TO FLUSH THE INPUT STACK.              * 18800002
*********************************************************************** 18850002
FLUSHIT  DS    0H                                                       18900002
         OI    TSTFLGS4,TSTFLUSH  INDICATE IKJEGMNL SHOULD FLUSH STACK  18950002
         SPACE                                                          19000002
*********************************************************************** 19050002
*        SET RETURN CODE TO MAINLINE TO 0 FOR SYSTEM ERROR            * 19100002
*********************************************************************** 19150002
EXIT0    DS    0H                                                       19200002
         XR    R15,R15       SET RETURN CODE                            19250002
         B     RETURN        RETURN TO IKJEGMNL                         19300002
         SPACE                                                          19350002
*********************************************************************** 19400002
*        USER ENTERED AN ATTENTION, RETURN TO MNL WITH 16 RETURN CODE * 19450002
*********************************************************************** 19500002
ATTNEXIT DS    0H                                                       19550002
         LA    R15,RET16     INDICATE ATTENTION INTERRUPT ENCOUNTERED   19600002
         B     RETURN        GO SET UP TO RETURN TO IKJEGMNL            19650002
         SPACE                                                          19700002
*********************************************************************** 19710002
*        ESTAE ERROR ENCOUNTERED IN THIS MODULE OR ONE OF THE         * 19720002
*        MODULES CALLED BY THIS MODULE                                * 19730002
*********************************************************************** 19740002
EXIT24   DS    0H                                                       19742002
         LA    R15,RC24      INDICATE ESTAE ERROR ENCOUNTERED           19744002
         B     RETURN        GO SET UP RETURN TO IKJEGMNL               19746002
         SPACE                                                          19748002
*********************************************************************** 19750002
*        ERROR OR ATTN OCCURRED DURING VALIDITY CHECK PROCESSING.     * 19800002
*        SERVICE ROUTINE RETURN CODE WAS SAVED IN REGSAVE FIELD.      * 19850002
*        GET IT AND PERFORM APPROPRIATE FUNCTION.                     * 19900002
*********************************************************************** 19950002
CHKRET   DS    0H                                                       20000002
         L     R15,REGSAVE   PUT SAVED RETURN CODE INTO REG 15          20050002
SEVRET   DS    0H                                                       20100002
         B     RETTAB(R15)   GO THROUGH FOLLOWING TABLE INDEXED         20150002
*                            CONTENTS OF REGISTER 15                    20200002
RETTAB   DS    0H                                                       20250002
         B     EXIT0         THIS CONDITION SHOULD BE IMPOSSIBLE        20300002
         B     EXIT0         4-FROM SERVICE ROUTINE-RETURN 0            20350002
         B     EXIT0         8-FROM SERVICE ROUTINE-RETURN 0            20400002
         B     EXIT0         12-FROM SERVICE ROUTINE-RETURN 0           20450002
         B     RETURN        16-FROM SERVICE ROUTINE-RETURN 16          20500002
         B     RETURN        20-FROM SERVICE ROUTINE-RETURN 20          20550002
         B     RETURN        24-FROM SERVICE ROUTINE-RETURN 24          20560002
         SPACE 2                                                        20600002
*********************************************************************** 20650002
*        THIS SUBROUTINE IS ENTERED WITH A BAL 10,SETUP.              * 20700002
*        IT COMPLETES THE ENTRY LINKAGE AND ISSUES ESTAE FOR GO,      * 20750002
*        RUN, AND CALL. UPON RETURN FROM THIS CODE, REG 6 CONTAINS    * 20800002
*        THE ADDRESS OF GO'S WORKAREA.                                * 20850002
*********************************************************************** 20900002
SETUP    DS    0H                                                       20950002
         L     R15,REGSAVE2  SUBCOMMAND SAVE AREA.                      21000002
         ST    R15,SAVENEXT-SAVEAREA(R13) SAVE FOWARD POINTER.          21050002
         ST    R13,SAVELAST-SAVEAREA(R15) SAVE BACK POINTER.            21100002
         LR    R13,R15       SET REGISTER 13                            21150002
**********************************************************************  21200002
*              ISSUE ESTAE FOR GO, RUN, AND CALL                     *  21250002
**********************************************************************  21300002
STAECODE DS    0H                                                       21350002
         STM   R14,R12,RETURNPT-SAVEAREA(R13)  SAVE OUR REGISTERS       21400002
         L     R6,WORKAREA   LOAD ADDR OF WORKAREA                      21450002
         XC    STAEAREA,STAEAREA CLEAR ESTAE PARM AREA                  21500002
         L     R15,TSTSTAE   R15=ADDR OF ESTAE EXIT ROUTINE             21510002
         ESTAE (R15),CT,PARAM=(R5),XCTL=NO,RECORD=YES,                 *21550002
               MF=(E,STAEAREA)  ESTABLISH ESTAE EXIT                    21600002
         LTR   R15,R15       RETURN CODE FROM ESTAE                     21900002
         BZ    D0(R10)       RETURN TO CALLER                           21910002
         STC   R15,TSTESTRC  SAVE ESTAE RETURN CODE                     21920002
         B     EXIT24        RETURN TO MAINLINE WITH RC=24              21930002
SMTSTAE  DS    0H            SMT LABEL FOR TEST CASES TGO01500          21950002
*                            AND TCAL2900                               22000002
         BNZ   CODE16        NONZERO STAE RETURN CODE, GO WRITE MESSAGE 22050002
         BR    R10           RETURN TO CALLER.                          22100002
         EJECT                                                          22150002
*********************************************************************** 22200002
*                                                                     * 22250002
*        RUN PROCESSING STARTS HERE                                   * 22300002
*                                                                     * 22350002
*********************************************************************** 22400002
IKJEGRUN DS    0D            RUN COMMAND OF TEST                        22450002
         SAVE  (14,12),,IKJEGRUN                                        22500002
         L     R12,BASECON-IKJEGRUN(R15)  SETUP BASE REG.               22550002
         LA    R5,RUNSPL     R5=ADDR OF ESTAE PARM LIST                 22560002
         BAL   R10,SETUP     FINISH ENTRY LINKAGE, ISSUE STAE, AND      22600002
*                            POINT R6 TO GO'S WORKAREA                  22650002
         MVI   CMDCODE,RUNCODE SAVE RETURN CODE FROM RUN                22700002
         LA    R2,TWELVE     SET RUN INDICATOR FOR PARSE EXIT.          22750002
         SPACE                                                          22800002
*********************************************************************** 22850002
*        IF THIS IS AN OVERLAY MODULE, THE HIGH ORDER BIT             * 22900002
*        OF THE FIRST BYTE OF THE TSTDCB FIELD IN TCOMTAB WILL BE ON. * 22950002
*        IF SO, WRITE ERROR MESSAGE. IF NOT, BRANCH TO INIT SECTION   * 23000002
*        OF GO'S CODE.                                                * 23050002
*********************************************************************** 23100002
         TM    TSTDCB,HIGHBIT  IS THIS AN OVERLAY MODULE                23150002
         BZ    INIT          NO, CONTINUE PROCESSING REQUEST            23200002
         LA    R3,MSG3       YES, PREPARE TO WRITE MESSAGE IKJ57423I    23250002
         B     MSGRTN        GO TO THE MESSAGE ROUTINE                  23300002
         SPACE                                                          23300502
*********************************************************************** 23301002
*        A RUN WAS ISSUED WITH NO RESUME ADDRESS. R5 CONTAINS         * 23301502
*        RESUME ADDRESS FROM PP'S RBOPSW FIELD. CHECK TO SEE          * 23302002
*        IF THIS ADDRESS POINTS TO PPEXIT2 IN TCOMTAB, OR TO AN       * 23302502
*        INSTRUCTION IN A BRKELEM. IF NEITHER, LEAVE RESUME           * 23303002
*        ADDRESS ALONE. IF IT POINTS TO PPEXIT2, RESET TO POINT       * 23303502
*        TO CVTEXIT IN THE CVT. IF IT POINTS TO A BRKELEM             * 23304002
*        INSTRUCTION, RESET IT TO POINT TO THE APPROPRIATE POINT      * 23304502
*        IN THE PROBLEM PROGRAM.                                      * 23305002
*********************************************************************** 23305502
         SPACE                                                          23306002
RUNSET   DS    0H            CHECK RESUME ADDRESS AND RESET IT          23306502
*                            IF NECESSARY                               23307002
         LA    R4,PPEXIT2    GET ADDRESS OF PPEXIT2                     23307502
         CR    R4,R5         IS RESUME ADDRESS PPEXIT2 ?                23308002
         BE    SETEXIT       YES, GO RESET TO POINT TO CVTEXIT          23308502
         L     R8,BREAKTAB   GET ADDRESS OF FIRST BRKELEM               23309002
         USING BRKELEM,R8    R8 IS BASE FOR BRKELEM                     23309502
         SPACE                                                          23310002
CKBRKELM DS    0H            IF A BRKELEM EXISTS, SEE IF RESUME         23310502
*                            ADDRESS FOLLOWS INSTRUCTION IN BRKELEM -   23311002
*                            IF IT DOES, PP PROBABLY ABENDED IN BRKELEM 23311502
         LTR   R8,R8         DOES A BRKELEM EXIST ?                     23312002
         BZ    RESET         NO, GO RESET TRN FIELD                     23312502
         TM    BRKINST,LENBITS  HOW LONG IS INSTRUCTION IN BRKELEM ?    23313002
         LA    R3,L2         PUT A 2 IN R3                              23313502
         BZ    CHEKBRK       INSTRUCTION IS TWO BYTES, GO               23314002
*                            CHECK RESUME ADDRESS                       23314502
         LA    R3,L2(R3)     ADD TWO MORE TO LENGTH                     23315002
         BM    CHEKBRK       INSTRUCTION IS FOUR BYTES - GO CHECK       23315502
*                            RESUME ADDRESS                             23316002
         LA    R3,L2(R3)     ADD TWO TO LENGTH - SIX BYTE INSTRUCTION   23316502
         SPACE                                                          23317002
CHEKBRK  DS    0H            SEE IF RESUME ADDRESS POINTS TO            23317502
*                            END OF INSTRUCTION                         23318002
         LA    R4,BRKINST(R3)  POINT TO END OF INSTRUCTION              23318502
         CR    R4,R5         DOES RESUME ADDRESS POINT THERE ?          23319002
         BE    SETBRK        YES, PP PROBABLY ABENDED HERE - GO RESET   23319502
*                            RESUME ADDRESS TO FOLLOW INSTRUCTION IN PP 23320002
         L     R8,BRKLINK    GET ADDRESS OF NEXT BRKELEM                23320502
         B     CKBRKELM      GO CHECK NEXT BRKELEM                      23321002
SETBRK   DS    0H            RESUME ADDRESS FOLLOWED BREAKPOINT         23321502
*                            INSTRUCTION IN BRKELEM. RESET RESUME       23322002
*                            ADDRESS TO FOLLOW INSTRUCTION IN PP        23322502
         L     R4,BRKADDR    GET ADDR OF BREAKPOINT FOR BRKELEM         23323002
         LA    R4,D0(R3,R4)  POINT PAST BREAKPOINTED INSTRUCTION        23323502
         B     SETADDR       GO RESET RESUME ADDRESS                    23324002
         SPACE                                                          23324502
SETEXIT  DS    0H            RESUME ADDRESS POINTED TO PPEXIT2, RESET   23325002
*                            IT TO POINT TO CVTEXIT IN CVT              23325502
         L     R4,CVTPTR     GET ADDRESS OF CVT                         23326002
         USING CVT,R4        R4 IS BASE FOR CVT                         23326502
         LA    R4,CVTEXIT    GET ADDRESS OF CVTEXIT                     23327002
         DROP  R4            R4 NO LONGER CVT BASE                      23327502
         SPACE                                                          23328002
SETADDR  DS    0H            R4 CONTAINS NEW RESUME ADDRESS. USE IT     23328502
*                            TO CHANGE RBOPSW FIELD.                    23329002
         L     R5,PPTCB      GET PP'S TCB ADDRESS IN R5                 23329502
         IKJEGS9G  OPSW,TCBADDR=(R5),VALUE=(R4),MF=(E,SVCPARMS)  RESET *23330002
                             PP RESUME ADDRESS                          23330502
         LTR   R15,R15       IS RETURN CODE ZERO ?                      23331002
         BNZ   SVCERR        NO, GO ISSUE ERROR MESSAGE AND QUIT        23331502
         SPACE                                                          23332002
*********************************************************************** 23332502
*        RESET PROBLEM PROGRAM'S REGISTER 14 TO POINT TO AN SVC 3     * 23333002
*        IN CVT IF IT NOW POINTS TO SVC 97 (PPEXIT) IN TCOMTAB.       * 23333502
*        RESET BOTH THE ACTIVE PROGRAM'S REGISTER 14, AND REGISTER    * 23334002
*        14 IN THE FIRST SAVE AREA OFF THE FIRST DAUGHTER TCB         * 23334502
*        UNDER TEST.                                                  * 23335002
*********************************************************************** 23335502
         SPACE                                                          23336002
RESET    DS    0H            RESET REGISTER 14                          23336502
         L     R4,TSTTCB     GET ADDRESS OF TEST'S TCB                  23337002
         L     R4,TCBLTC-TCB(R4)  GET ADDRESS OF FIRST DAUGHTER         23337502
         L     R4,TCBFSA-TCB(R4)  GET ADDRESS OF FIRST SAVE AREA        23338002
         L     R8,RETURNPT-SAVEAREA(R4)  GET ORIGINAL REGISTER 14       23338502
         LA    R8,D0(R8)     CLEAR HIGH ORDER BYTE                      23339002
         LA    R5,PPEXIT     GET ADDRESS OF SVC 97 IN TCOMTAB           23339502
         CR    R5,R8         ARE THEY THE SAME                          23340002
         BNE   CKACTIVE      NO, GO CHECK ACTIVE R14                    23340502
         L     R8,CVTPTR     GET ADDRESS OF CVT                         23341002
         LA    R8,CVTEXIT-CVT(R8) GET ADDRESS OF SVC3 IN CVT            23341502
         ST    R8,RETURNPT-SAVEAREA(R4)  REPLACE ORIGINAL R14           23342002
         SPACE                                                          23342502
CKACTIVE DS    0H            CHECK ACTIVE R14                           23343002
         L     R4,PPTCB      GET ACTIVE PP TCB ADDRESS                  23343502
         L     R5,TCBRBP-TCB(R4)  GET SVRB ADDRESS FOR SVC 97           23344002
         L     R8,RBGRS14-RBSECT(R5)  GET ACTIVE R14 FOR PP             23344502
         LA    R8,D0(R8)      CLEAR HIGH ORDER BYTE                     23345002
         LA    R5,PPEXIT     GET ADDRESS OF SVC 97 IN TCOMTAB           23345502
         CR    R5,R8         ARE THEY THE SAME ?                        23346002
         BNE   OFFTEST       NO, GO REMOVE REMNANTS OF TEST             23346502
         L     R8,CVTPTR     GET ADDRESS OF CVT                         23347002
         LA    R8,CVTEXIT-CVT(R8) GET ADDRESS OF SVC3 IN CVT            23347502
         IKJEGS9G  GPR,TCBADDR=(R4),VALUE=(R8),REGNO=14,MF=(E,SVCPARMS)*23348002
                             REPLACE ACTIVE R14                         23348502
         LTR   R15,R15       SVC RETURN CODE ZERO ?                     23349002
         BNZ   SVCERR        NO, GO ISSUE ERROR MESSAGE AND QUIT        23349502
         SPACE                                                          23350002
*********************************************************************** 23400002
*        OTHER PROCESSING ALL DONE.  FOR ALL TASKS UNDER TEST'S TCB,  * 23450002
*        TURN OFF TEST BIT AND RESET TCBTRN FIELD TO 0 IN TCB.        * 23500002
*********************************************************************** 23550002
OFFTEST  DS    0H                                                       23600002
         L     R4,TSTTCB     REG 4 CONTAINS ADDR OF TEST'S TCB          23650002
         USING TCB,R4        ALLOW SYMBOLIC REFERENCE                   23700002
         LA    R8,D0(R4)     CLEAR HIGH ORDER BYTE AND SAVE             23750002
*********************************************************************** 23800002
*        FIND TEST'S SUBTASKS' TCBS.                                  * 23850002
*********************************************************************** 23900002
DAU      DS    0H                                                       23950002
         L     R5,TCBLTC     GET THE ADDR OF THE LAST DAUGHTER TASK     24000002
         LTR   R5,R5         IS THERE A DAUGHTER TASK                   24050002
         BNZ   PROCESS       YES, GO PROCESS                            24100002
SIS      DS    0H                                                       24150002
         L     R5,TCBNTC     NO, GET ADDRESS OF NEXT SISTER TCB IF ONE  24200002
         LTR   R5,R5         WAS THERE A SISTER TASK                    24250002
         BNZ   PROCESS       YES, GO PROCESS                            24300002
MOTH     DS    0H                                                       24350002
         L     R4,TCBOTC     NO, GET ADDRESS OF MOTHER TASK             24400002
         LA    R4,D0(R4)     CLEAR HIGH ORDER BYTE                      24450002
         CR    R4,R8         DOES MOTHER TASK = TEST TASK               24500002
         BNE   SIS           NO, GO CHECK FOR ANOTHER SISTER TCB        24550002
         SPACE                                                          24600002
*********************************************************************** 24650002
*        ALL DONE - RETURN TO MNL WITH OK RETURN CODE.                * 24700002
*********************************************************************** 24750002
RUNRTN   DS    0H                                                       24800002
         OI    TSTFLGS1,RUNSW TURN ON RUN SWITCH                        24820002
         B     EXIT          RUN AND GO SHARE CODE FROM HERE ON.        24850002
         SPACE                                                          24900002
*********************************************************************** 24950002
*        IF TASK IS UNDER TEST, TURN OFF TEST BIT, RESET TCBTRN.      * 25000002
*********************************************************************** 25050002
PROCESS  DS    0H                                                       25100002
         LA    R5,D0(R5)     CLEAR HIGH ORDER BYTE                      25150002
         CLC   TCBPKF,TCBPKF-TCB(R5)  IS THIS TCB'S KEY                 25200002
*                            THE SAME KEY AS TEST'S TCB                 25250002
         BNE   BUMPTCB       NO, THE TASK IS NOT UNDER TEST             25300002
         IKJEGS9G TCPOFF,TCBADDR=(R5),MF=(E,SVCPARMS) TURN OFF         *25350002
                             TEST BIT                                   25400002
         LTR   R15,R15       SVC 97 RETURN CODE ZERO?                   25450002
         BNZ   RUNBLEW       NO, GO TRY TO RECOVER                      25500002
         IKJEGS9G TRN,TCBADDR=(R5),VALUE=D0,MF=(E,SVCPARMS) RESET TRN   25550002
         LTR   R15,R15       SVC97 RETURN CODE ZERO?                    25600002
         BNZ   RUNBLEW       NO, GO TRY TO RECOVER                      25650002
         SPACE                                                          25700002
*********************************************************************** 25750002
*        GET ADDRESS OF NEXT TCB, PROCESS IT.                         * 25800002
*********************************************************************** 25850002
BUMPTCB  DS    0H            GET ADDRESS OF NEXT TCB                    25900002
         LR    R4,R5         FIND NEXT TCB UNDER TEST                   25950002
         B     DAU           LOOP UNTIL FINISHED                        26000002
         EJECT                                                          26050002
*********************************************************************** 26100002
*        NONZERO RETURN CODE FROM SVC 97 INDICATES BAD ERROR. ATTEMPT * 26150002
*        TO RECOVER BY REVERSING ABOVE PROCEDURE. IF RECOVERY         * 26200002
*        FAILS, ISSUE CRITICAL SYSTEM ERROR MESSAGE, AND RETURN       * 26250002
*        TO MAINLINE WITH A RETURN CODE OF 8 TO END TEST SESSION.     * 26300002
*        IF RECOVERY IS SUCCESSFUL, ISSUE SYSTEM ERROR MESSAGE AND    * 26350002
*        RETURN TO MAINLINE WITH A RETURN CODE OF 0.                  * 26400002
*********************************************************************** 26450002
         SPACE                                                          26500002
RUNBLEW  DS    0H                                                       26550002
         L     R4,TSTTCB     GET ADDRESS OF TEST'S TCB IN R4            26600002
         LA    R8,D0(R4)     CLEAR HI BYTE AND PUT IN R8                26650002
         SPACE                                                          26700002
BLEWDAU  DS    0H                                                       26750002
         L     R5,TCBLTC     GET ADDRESS OF DAUGHTER TCB                26800002
         LTR   R5,R5         ANY DAUGHTER TCB?                          26850002
         BNZ   BLEWPROC      YES, GO PROCESS IT                         26900002
         SPACE                                                          26950002
BLEWSIS  DS    0H                                                       27000002
         L     R5,TCBNTC     GET ADDRESS OF SISTER TCB                  27050002
         LTR   R5,R5         ANY SISTER TCB?                            27100002
         BNZ   BLEWPROC      YES, GO PROCESS IT                         27150002
         SPACE                                                          27200002
BLEWMOTH DS    0H                                                       27250002
         L     R4,TCBOTC     GET ADDRESS OF MOTHER TCB                  27300002
         LA    R4,D0(R4)     CLEAR HI BYTE                              27350002
         CR    R8,R4         IS THIS TEST'S TCB?                        27400002
         BNE   BLEWSIS       NO, CONTINUE CLEANUP                       27450002
         B     RUNSVCMS      RECOVERY SUCCESSFUL, GO ISSUE MESSAGE      27500002
         SPACE                                                          27550002
BLEWPROC DS    0H                                                       27600002
         LA    R5,D0(R5)     CLEAR HI BYTE OF TCB ADDRESS               27650002
         CLC   TCBPKF,TCBPKF-TCB(R5)  DOES THIS TCB HAVE THE SAME       27700002
*                            KEY AS TEST'S                              27750002
         BNE   BLEWBUMP      NO, THIS TCB NOT UNDER TEST                27800002
         CLI   TCBABF-TCB(R5),TCBTCP   IS THIS TCB'S TEST BIT ON?       27850002
         BE    BLEWTRN       YES, GO CHECK IT'S TRN FIELD               27900002
         IKJEGS9G TCPON,TCBADDR=(R5),MF=(E,SVCPARMS) TURN THIS TCB'S   *27950002
                             TEST BIT ON                                28000002
         LTR   R15,R15       SVC 97 RETURN CODE ZERO?                   28050002
         BNZ   RUNEND        NO, RECOVERY UNSUCCESSFUL                  28100002
         SPACE                                                          28150002
BLEWTRN  DS    0H                                                       28200002
         L     R7,TCBTRN-TCB(R5)  GET TCBTRN FIELD IN R7                28250002
         LA    R7,D0(R7)     CLEAR HI BYTE                              28300002
         CR    R7,R9         IS TRN FIELD POINTER TO TCOMTAB ?          28350002
         BE    BLEWBUMP      YES, THIS TCB OK                           28400002
         IKJEGS9G  TRN,TCBADDR=(R5),VALUE=(R9),MF=(E,SVCPARMS)  RESET  *28450002
                             TRN FIELD OF TCB                           28500002
         LTR   R15,R15       SVC 97 RETURN CODE ZERO?                   28550002
         BNZ   RUNEND        NO, RECOVERY UNSUCCESSFUL                  28600002
         SPACE                                                          28650002
BLEWBUMP DS    0H                                                       28700002
         LR    R4,R5         GET ADDRESS OF NEXT TCB                    28750002
         B     BLEWDAU       GO CHECK IT                                28800002
         SPACE                                                          28850002
RUNEND   DS    0H                                                       28900002
         O     R2,HIBITON    MAKE R2 NEGATIVE TO INDICATE BAD ERROR     28950002
         LA    R3,MSG10      PUT MSG ID IN R3                           29000002
         B     MSGRTN        GO WRITE MESSAGE                           29050002
         DROP  R4            R4 NO LONGER NEEDED FOR TCB ADDRESSES      29100002
         EJECT                                                          29150002
*********************************************************************** 29200002
*                                                                     * 29250002
*        CALL PROCESSING STARTS HERE                                  * 29300002
*                                                                     * 29350002
*********************************************************************** 29400002
IKJEGCAL DS    0D            CALL COMMAND OF TEST                       29450002
         SAVE  (14,12),,IKJEGCAL                                        29500002
         L     R12,BASECON-IKJEGCAL(R15)  SETUP BASE REG.               29550002
         LA    R5,CALSPL     R5=ADDR OF ESTAE PARM LIST                 29560002
         BAL   R10,SETUP     FINISH ENTRY LINKAGE, ISSUE STAE, AND      29600002
*                            POINT R6 TO GO'S WORKAREA                  29650002
         MVI   CMDCODE,CALLCODE SAVE RETURN CODE FROM CALL (SAME AS GO) 29700002
         LA    R2,EIGHT      CALL CODE FOR PARSE VALIDITY EXIT.         29750002
         SPACE                                                          29800002
*********************************************************************** 29850002
** BUILD PARAMETER LIST AND PARSE THE CALL COMMAND.                  ** 29900002
*********************************************************************** 29950002
         L     R4,CALLCON    REG 4 CONTAINS ADDRESS OF CALL'S PARAMETER 30000002
*                            CONTROL LIST                               30050002
         BAL   R10,PARSBILD  BUILD PARM LIST AND PARSE INPUT            30100002
         L     R8,TSTANSPL   REG 8 CONTAINS THE PDL ADDR                30150002
         USING CALLDUMM,R8   ESTABLISH ADDRESSABILITY FOR PDL           30200002
         SPACE                                                          30250002
*********************************************************************** 30300002
** MOVE PROBLEM PROGRAMS REGISTERS INTO WORKING STORAGE IN ORDER TO  ** 30350002
** MAKE THE REQUESTED CHANGES WITH A SINGLE ISSUANCE OF TEST'S SVC.  ** 30400002
*********************************************************************** 30450002
         SPACE                                                          30500002
         L     R5,PPTCB      REG 5 CONTAINS THE ADDR OF THE PROBLEM     30550002
*                            PROGRAM TASK CONTROL BLOCK (TCB)           30600002
         USING TCB,R5        ESTABLISH TCB ADDRESSABILITY               30650002
         L     R4,TCBRBP     REG 4 CONTAINS THE ADDR OF SVC'S SVRB      30700002
         DROP  R5            RELEASE REG 5 FOR FUTURE USE.              30750002
         MVC   PPRSAVE,RBGRSAVE-RBSECT(R4) MOVE PROBLEM PROGRAM'S       30800002
*                            REGISTERS INTO COMMAND'S WORKAREA          30850002
         SPACE                                                          30900002
*********************************************************************** 30950002
**       INITIALIZE COUNTER FOR PARMLIST GETMAIN, CHECK FOR          ** 31000002
**       PARM KEYWORD.                                               ** 31050002
*********************************************************************** 31100002
         LA    R4,L12        REG 4 IS AN ACCUMULATOR-HERE IS SET FOR    31150002
*                            MINIMUM LENGTH FOR PARMLIST, ONE           31200002
*                            ADDRESS AND 2 CONTROL WORDS.               31250002
         TM    PARM+D1,HEXOF WAS PARM SPECIFIED IN CALL COMMAND         31300002
         BZ    BLDLST        NO, BUILD A NULL PARAMETER LIST            31350002
         LA    R7,PARMADDR   YES, GET ADDR OF FIRST PARM ADDRESS PDE    31400002
         SPACE                                                          31450002
*********************************************************************** 31500002
** THIS CODE DETERMINES THE SIZE OF THE AREA FOR THE PARAMETER LIST  ** 31550002
** THAT IS TO BE BUILT.                                              ** 31600002
*********************************************************************** 31650002
LOOP3    DS    0H            EXAMINE PARM CHAIN                         31700002
         L     R7,PDECHAIN   OBTAIN THE ADDR OF THE NEXT ADDRESS PDE    31750002
         LA    R7,D0(R7)     CLEAR HIGH ORDER BYTE                      31800002
         LTR   R7,R7         IS THERE ANOTHER ADDRESS PDE               31850002
         BZ    BLDLST        NO, ISSUE GETMAIN AND BUILD PARMLIST       31900002
         LA    R4,D4(R4)     YES, BUMP ACCUMULATOR FOR ONE MORE ADDRESS 31950002
         B     LOOP3         GO FIND NEXT ADDR PDE IF ONE EXISTS        32000002
         SPACE                                                          32050002
*********************************************************************** 32100002
*        USE CALCULATED LENGTH TO ISSUE GETMAIN FOR PARMLIST          * 32150002
*********************************************************************** 32200002
SMTGET01 DS    0H            SMT LABEL FOR TEST CASE TGO01500           32250002
BLDLST   DS    0H            OBTAIN CORE FOR PARAMETER LIST             32300002
         LR    R0,R4         PUT LENGTH OF GETMAIN INTO REGISTER 0      32350002
         GETMAIN RC,LV=(0),SP=1   ISSUE GETMAIN FOR STORAGE             32450002
BLOW1    EQU   *             ABEND TABLE ENTRY                          32452002
         LTR   R15,R15       WAS GET MAIN SUCCESSFUL                    32460002
         BZ    GETMOK        YES CONTINUE                               32470002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO PARM LIST        32480002
* ISSUE 'GETMAIN SVC ERROR' MESSAGE                                     32490002
         IKJEGSIO SVCERR,SVC=10,RC=(R15),ID=GO014,MF=(E,TSTIOPRM)       32492002
         C     R15,ATTNRC    IS ATTENTION IN EFFECT?                    32492402
         BE    ATTNEXIT      YES,SEND RC=16 TO MAINLINE                 32492802
         C     R15,ESTAERC   DID IO FAIL ON ESTAE?                      32493202
         BE    EXIT24        YES,SEND RC=24 TO MAINLINE                 32493602
         B     MSGRTNA       GO ISSUE MESSAGE                  XXXXXXXX 32496002
         SPACE                                                          32500002
*********************************************************************** 32550002
*        CHAIN ADDRESS OF PARMLIST OFF CALLPARM FIELD IN TCOMTAB      * 32600002
*********************************************************************** 32650002
GETMOK   DS    0H                                                       32700002
         LA    R3,CALLPARM   GET ADDRESS OF BEGINNING OF PARAMETER LIST 32750002
*                            CHAINED FROM A WORD IN TCOMTAB             32800002
         SPACE                                                          32850002
LOOP4    DS    0H            CHECK FOR MORE PARAMETER LISTS             32900002
         OC    D1(L3,R3),D1(R3) ANY MORE PARAMETER LISTS AROUND         32950002
         BZ    ADDL          NO, GO ADD NEW LIST TO THE CHAIN           33000002
         L     R3,D0(R3)     YES, GET ADDRESS OF NEXT PARAMETER LIST    33050002
         B     LOOP4         GO SEE IF IT IS LAST ON CHAIN              33100002
         SPACE                                                          33150002
ADDL     DS    0H            ADD NEW PARAMETER LIST TO CHAIN IN TCOMTAB 33200002
         ST    R1,D0(R3)     PUT ADDR OF NEW LIST INTO FIRST WORD OF    33250002
*                            LAST ENTRY OF CHAIN                        33300002
         SPACE                                                          33350002
*********************************************************************** 33400002
*        FINISH INITIALIZATION OF PARMLIST. CHECK FOR PARM KEYWORD.   * 33450002
*        IF NO PARM, DUMMY IS PASSED. SET PP R1 TO POINT TO           * 33500002
*        ADDRESSES IN PARM LIST.                                      * 33550002
*********************************************************************** 33600002
         XC    D0(L8,R1),D0(R1)   ZERO FIRST EIGHT BYTES                33650002
*                            OF PARAMETER BUFFER                        33700002
         STH   R4,D4(R1)     PLACE LENGTH OF NEW LIST INTO THE LENGTH   33750002
*                            FIELD OF NEW ENTRY ON CHAIN                33800002
         LA    R1,D6(R1)     POINT TO HALFWORD OF ZEROS                 33850002
         ST    R1,D2(R1)     STORE ADDRESS OF HALFWORD OF               33900002
*                            ZEROS FOR DUMMY PARM LIST                  33950002
         LA    R1,L2(R1)     POINT TO BEGINNING OF ACTUAL               34000002
*                            PARAMETER ADDRESS LIST                     34050002
         ST    R1,PPREG1     REPLACE PP REG 1 CONTENTS                  34100002
         TM    PARM+D1,HEXOF WAS PARM SPECIFIED                         34150002
         BZ    VARLIST       NO - CHECK FOR VL KEYWORD                  34200002
         SPACE                                                          34250002
*********************************************************************** 34300002
** BUILD PARAMETER LIST FROM ADDRESS PDE USER FIELDS                 ** 34350002
*********************************************************************** 34400002
PARMSET  DS    0H                                                       34450002
         LA    R7,PARMADDR   REG 7 CONTAINS ADDR OF FIRST PARAMETER     34500002
*                            ADDRESS PDE                                34550002
         SPACE                                                          34600002
LOOP5    DS    0H            SET UP PARAMETER                           34650002
         L     R5,PDEUSER    PUT PARM ADDRESS IN R5                     34700002
         LA    R5,D0(R5)     ZERO HIGH ORDER BYTE OF ADDRESS            34750002
         ST    R5,D0(R1)     PUT ADDRESS IN PARM LIST                   34800002
         L     R7,PDECHAIN   REG 7 POINTS TO NEXT ADDRESS PDE           34850002
         LA    R7,D0(R7)     CLEAR HIGH ORDER BYTE                      34900002
         LTR   R7,R7         WERE THERE ANY MORE PDES                   34950002
         BZ    VARLIST       NO, CHECK IF LIST IS VARIABLE LENGTH       35000002
         LA    R1,D4(R1)     YES, BUMP LIST POINTER                     35050002
         B     LOOP5         AND GO MOVE NEXT ADDR INTO NEW LIST        35100002
         SPACE                                                          35150002
*********************************************************************** 35200002
*        IF VL WAS SPECIFIED, TURN ON HIGH-ORDER BIT OF LAST          * 35250002
*        ADDRESS IN PARM LIST.                                        * 35300002
*********************************************************************** 35350002
VARLIST  DS    0H            CHECK FOR 'VL' SPECIFIED                   35400002
         TM    VLIST+D1,HEXOF  WAS 'VL' SPECIFIED                       35450002
         BZ    RETNCHK       NO, GO CHECK FOR RETURN KEYWORD            35500002
         OI    D0(R1),HIGHBIT YES, FLAG HIGH ORDER BYTE OF LAST         35550002
*                            ELEMENT OF LIST WITH A X'80'               35600002
         SPACE                                                          35650002
*********************************************************************** 35700002
*        IF THE RETURN KEYWORD IS SPECIFIED, SET THE CONTENTS         * 35750002
*        OF PP REG 14  TO THE SPECIFIED ADDRESS. OTHERWISE, POINT     * 35800002
*        PP REG 14 TO A BREAK SVC IN TCOMTAB.                    *      35850002
*********************************************************************** 35900002
RETNCHK  DS    0H                                                       35950002
         TM    RETKEY+D1,HEXOF WAS 'RETURN' SPECIFIED                   36000002
         BZ    BREAKIT       NO, SET REG 14 FOR BREAK                   36050002
         LA    R7,RETADDR    REG 7 CONTAINS ADDRESS OF RETURN ADDR PDE  36100002
         MVC   PPREG14,PDEUSER MOVE ADDR INTO REG 14                    36150002
         B     ZAPREGS       RESET ALL PP REGS                          36200002
         SPACE                                                          36250002
BREAKIT  DS    0H            SET REG 14                                 36300002
         LA    R7,PPEXIT     REG 7 CONTAINS ADDR OF BREAK SVC           36350002
         ST    R7,PPREG14    RESET REGISTER 14 WITH THIS ADDRESS        36400002
         SPACE                                                          36450002
*********************************************************************** 36500002
*        SET PP REG 15 TO ADDRESS SPECIFIED BY USER. PUT ALTERED      * 36550002
*        PP REGS BACK IN SVRB.                                        * 36600002
*********************************************************************** 36650002
ZAPREGS  DS    0H            RESTORE ALL PP REGS, PICKING UP CHANGES    36700002
         SPACE                                                          36750002
         LA    R7,BRADDR     REG 7 CONTAINS ADDR OF BRANCH ADDR PDE     36800002
         L     R5,PDEUSER    REG 5 CONTAINS THE BRANCH ADDRESS          36850002
         ST    R5,PPREG15    PLACE ENTRY ADDR IN PP R15.                36900002
         L     R3,PPTCB      REG 3 CONTAINS TCB PTR FOR TEST SVC        36950002
         IKJEGS9G AGPR,TCBADDR=(R3),VALUE=PPRSAVE,MF=(E,SVCPARMS)      *37000002
                             RESTORE PP'S ALTERRED REGISTERS            37050002
         LTR   R15,R15       SVC 97 RETURN CODE ZERO?                   37100002
         BNZ   CALSVCMS      NO, GO ISSUE ERROR MESSAGE AND QUIT        37150002
         SPACE                                                          37200002
*********************************************************************** 37250002
**HAVING SET ADDRESS AT WHICH PROBLEM PROGRAM IS TO RESUME EXECUTION**  37300002
**IN REGISTER 5 AND A 'GO' RETURN CODE IN REGISTER 11, ENTER 'GO'   **  37350002
**LOGIC TO EFFECT RESET OF RIGHT-HALF PP RBOPSW AND RETURN TO       **  37400002
**IKJEGMNL.                                                          ** 37450002
*********************************************************************** 37500002
         SPACE                                                          37550002
         B     SETWAIT       ENTER 'GO' LOGIC                           37600002
         EJECT                                                          37650002
*********************************************************************** 37700002
*                                                                     * 37750002
*        THIS IS THE ADDRESS VALIDITY CHECK ROUTINE FOR GO,           * 37800002
*        CALL, AND RUN.                                               * 37850002
*                                                                     * 37900002
*********************************************************************** 37950002
ADDRCHK  DS    0H                                                       38000002
         SAVE  (14,12),,ADDRCHK                                         38050002
         L     R12,BASECON-ADDRCHK(R15)   SETUP BASE REG.               38100002
         L     R7,D0(R1)     REG 7 CONTAINS ADDRESS OF ADDRESS PDE      38150002
         L     R9,D4(R1)     REG 9 CONTAINS ADDRESS OF TCOMTAB          38200002
         LA    R8,D8(R1)     SAVE ADDRESS OF THIRD WORD IN LIST         38250002
         L     R4,REGSAVE3   REG 4 CONTAINS NEW SAVEAREA ADDRESS        38300002
         ST    R13,SAVELAST-SAVEAREA(R4) STORE BACK POINTER.            38350002
         ST    R4,SAVENEXT-SAVEAREA(R13) STORE FORWARD POINTER.         38400002
         LR    R13,R4        SET NEW SAVE ADDR IN REG 13                38450002
         SPACE                                                          38500002
*********************************************************************** 38550002
*        CHECK FOR INVALID ADDRESS TYPE. IF INVALID, ISSUE            * 38600002
*        ERROR MESSAGE.                                               * 38650002
*********************************************************************** 38700002
         OI    TSTFLGS4,TSTVALCK TURN ON VALIDITY CHECK BIT    XXXXXXXX 38701002
         OC    PDEINDCT,PDEINDCT WAS INDIRECT ADDRESSING SPECIFIED      38750002
         BNZ   CONVERT       YES, VALID STORAGE ADDR, CONVERT IT        38800002
         TM    PDEFLG4,GENR+LFPR+SFPR WAS REG TYPE ADDRESSING USED      38850002
         BNZ   BUMRTURN      YES, INVALID ADDR, REQUEST MSG & PROMPT    38900002
         SPACE                                                          38950002
*********************************************************************** 39000002
*        CONVERT THE ADDRESS TO BINARY USING IKJEGCVT.                * 39050002
*********************************************************************** 39100002
CONVERT  DS    0H                                                       39150002
         SPACE                                                          39200002
         L     R1,OUTBUF     R1=ADDR OF OUTPUT BUFFER                   39210002
         XC    D0(L4,R1),D0(R1) ZERO OUT FIRST WORD OF OUT BUFFER       39220002
         LR    R1,R7         REG 1 CONTAINS ADDR OF ADDRESS PDE         39250002
         LCR   R1,R1         NEGATIVE FOR ADDR CONVERSION               39300002
         SR    R0,R0         REG 0 IS POSITIVE TO INDICATE BINARY       39350002
*                            CONVERSION                                 39400002
         L     R15,TSTCONVT  REG 15 CONTAINS ADDR OF IKJEGCVT ENTRY PT  39450002
         BALR  R14,R15       ATTEMPT TO CONVERT THE ADDRESS             39500002
         B     RETAB(R15)    BRANCH THROUGH FOLLOWING TABLE INDEXED     39550002
*                            BY CONTENTS IN REGISTER 15                 39600002
RETAB    DS    0H                                                       39650002
         B     RET0          0-CONTINUE PROCESSING                      39700002
         B     SETMSG        4-IKJEGCVT CODE-RETURN TO IKJPARS          39750002
         B     SETMSG2       8-IKJEGSYM CODE-RETURN TO IKJPARS          39800002
         B     SETMSG2       12-IO ERROR-RETURN TO IKJPARS              39850002
         B     RETURN12      16-ATTENTION INTERRUPT-RETURN TO PARSE     39900002
         B     RETURN12      20-IKJEGCVT OR IKJEGSYM BLEW               39950002
         B     RETURN12      24-ESTAE ERROR                             39960002
         SPACE                                                          40000002
*********************************************************************** 40050002
**THIS CODE PASSES THE ADDRESS OF A SECOND LEVEL MESSAGE FROM        ** 40100002
**IKJEGCVT OR IKJEGSYM BACK TO IKJPARS.  THE ADDRESS IS PICKED UP IN ** 40150002
**THE PDEUSER WORD AND PLACED IN THE THIRD WORD OF THE PARAMETER LIST** 40200002
**PASSED BY IKJPARS.  IF NO SECOND LEVEL EXISTS THE PDEUSER WORD WILL** 40250002
**CONTAIN X'FF000000'. CVT RETURN CODE WAS 4 - UNABLE TO CONVERT.    ** 40300002
*********************************************************************** 40350002
SETMSG   DS    0H                                                       40400002
         L     R1,OUTBUF     R1=ADDR OF OUTBUF                          40450002
         SR    R0,R0         R0=0                                       40500002
         C     R0,D0(R1)     IS FIRST WORD OF OUTBUF ZERO?              40510002
         BE    RETURN8       YES, NO SECOND LEVEL MESSAGE TO PASS       40520002
         MVC   D0(L4,R8),OUTBUF MOVE ADDR OF SECOND LEVEL MESSAGE       40530002
*                               INTO PARSE PARAMETER LIST               40540002
RETURN8  DS    0H                                                       40550002
         LA    R15,EIGHT     SET RETURN CODE TO IKJPARS TO 8            40600002
         B     CHKRTURN      GO SET UP TO RETURN TO IKJPARS             40650002
         SPACE                                                          40700002
*********************************************************************** 40750002
*        SAME AS ABOVE, BUT CVT RETURN CODE 8 - EITHER SYM ERROR      * 40800002
*        OR I/O ERROR.                                                * 40850002
*********************************************************************** 40900002
SETMSG2  DS    0H                                                       40950002
         L     R1,OUTBUF     R1=ADDR OF OUTBUF                          41000002
         SR    R0,R0         R0=0                                       41050002
         C     R0,D0(R1)     IS FIRST WORD OF OUTBUF ZERO?              41060002
         BE    RETURN12      YES, NO SECOND LEVEL MESSAGE TO PASS       41070002
         MVC   D0(L4,R8),OUTBUF MOVE ADDR OF SECOND LEVEL MESSAGE       41080002
*                               INTO PARSE PARAMETER LIST               41090002
         SPACE                                                          41100002
*********************************************************************** 41150002
*        SET RETURN CODE TO PARSE TO 12 TO INDICATE THAT PARSE IS     * 41200002
*        TO RETURN TO GO WITH A RETURN CODE OF 20. SAVE IKJEGCVT      * 41250002
*        RETURN CODE IN REGSAVE FIELD OF GO'S WORKAREA.               * 41300002
*********************************************************************** 41350002
RETURN12 DS    0H                                                       41400002
         L     R6,WORKAREA   LOAD ADDR OF WORKAREA                      41450002
RETRN12  DS    0H                                                       41500002
         OI    TSTFLGS4,TSTFLUSH  TURN ON TSTFLUSH SO MNL WILL          41510002
*                            FLUSH INPUT STACK                          41520002
         ST    R15,REGSAVE   SAVE RETURN CODE FOR LATER USE             41550002
         LA    R15,TWELVE    SET RETURN CODE FOR IKJPARS                41600002
         B     CHKRTURN      GO RETURN TO IKJPARS                       41650002
         SPACE                                                          41700002
*********************************************************************** 41750002
*        CVT RETURN CODE WAS 0, ADDRESS HAS BEEN CONVERTED.           * 41800002
*        IF HIGH ORDER BIT OF PDEUSER FIELD IS ON, PDEUSER POINTS     * 41850002
*        TO THE CONVERTED ADDRESS WORD. OTHERWISE, PDEUSER            * 41900002
*        CONTAINS THE CONVERTED ADDRESS.                              * 41950002
*********************************************************************** 42000002
RET0     DS    0H                                                       42050002
         TM    PDEUSER,PDESIB IS ADDRESS IN SYM INFO BLOCK              42100002
         BZ    SET0          NO, LEAVE PDEUSER FIELD ALONE              42150002
         L     R1,PDEUSER    YES, REG 1 CONTAINS ADDR OF SYM INFO       42200002
*                            BLOCK                                      42250002
         MVC   PDEUSER,D0(R1) MOVE ACTUAL ADDRESS INTO PDEUSER.         42300002
         SPACE                                                          42350002
*********************************************************************** 42400002
*        TURN ON FLAG IN PDEUSER FIELD TO INDICATE ADDRESS            * 42450002
*        ADDRESS HAS BEEN CONVERTED.                                  * 42500002
*********************************************************************** 42550002
SET0     DS    0H                                                       42600002
         MVI   PDEUSER,PDECONVD  TURN ON FLAG IN PDE TO INDICATE        42650002
*                            ADDRESS IS CONVERTED                       42700002
         XR    R15,R15       INDICATE VALID PARAMETER TO IKJPARS        42750002
         SPACE                                                          42800002
*********************************************************************** 42850002
*        RETURN TO PARSE.                                             * 42900002
*********************************************************************** 42950002
CHKRTURN DS    0H                                                       43000002
         NI    TSTFLGS4,HEXFF-TSTVALCK TURN OFF VALIDITY CHECK BIT      43010002
         L     R13,SAVELAST-SAVEAREA(R13) RESET REGISTER 13             43050002
*                            TO RETURN TO IKJPARS                       43100002
         RETURN (14,12),RC=(15) RETURN TO IKJPARS                       43150002
         SPACE 3                                                        43200002
*********************************************************************** 43250002
** INFORM USER ADDRESS IS INCORRECTLY SPECIFIED.                     ** 43300002
*********************************************************************** 43350002
BUMRTURN DS    0H                                                       43400002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO PARM LIST        43450002
* ISSUE 'INVALID ADDRESS' MESSAGE                                       43500002
* ISSUE 'REG.NOTATION MUST BE INDIRECT GEN.REG.' MESSAGE                43550002
         IKJEGSIO MSG,FIRST=M0101,INST11=(APDE,(R7)),SECOND=M0274,     *43600002
               ID=GO014,MF=(E,TSTIOPRM)                                 43650002
         LTR   R15,R15       RETURN FROM IO A ZERO                      45150002
         BZ    SETMSG        YES, MESSAGE WAS WRITTEN-RETURN            45200002
         B     RETRN12       NO,MSG MAY NOT HAVE BEEN WRITTEN-RETURN    45250002
         EJECT                                                          45600002
*********************************************************************** 45650002
*        THIS SUBROUTINE BUILDS A STANDARD PARSE PARAMETER LIST       * 45700002
*        AND LINKS TO PARSE. IT IS ENTERED BY A BAL 10,PARSBILD.      * 45750002
*        THE PCL ADDRESS TO BE USED IS PASSED IN REG 4. REGS 1 AND    * 45800002
*        5 ARE CLOBBERED.                                             * 45850002
*********************************************************************** 45900002
PARSBILD DS    0H                                                       45950002
         LA    R1,PPLAREA    REGISTER 1 CONTAINS ADDR OF PPL AREA       46000002
         USING PPL,R1        ESTABLISH ADDRESSABILITY TO PARSE          46050002
*                            PARAMETER LIST                             46100002
         MVC   PPLUPT,TSTUPT PUT ADDR UPT INTO PARAMETER LIST           46150002
         MVC   PPLECT,TSTECT PUT ADDR ECT INTO PARAMETER LIST           46200002
         MVC   PPLECB,TSTCPECB PUT ADDR ECB INTO PARAMETER LIST         46250002
         ST    R4,PPLPCL     PUT ADDR OF PCL INTO PARAMETER LIST        46300002
         LA    R5,TSTANSPL   PUT POINTER TO ANSWER PLACE INTO           46350002
         ST    R5,PPLANS     PARAMETER LIST TO IKJPARS                  46400002
         MVC   PPLCBUF,INBUF PUT ADDRESS OF COMMAND BUFFER INTO         46450002
*                            PARAMETER LIST FOR PARSE                   46500002
         ST    R9,PPLUWA     PUT ADDRESS OF TCOMTAB INTO LIST           46550002
         DROP  R1            DROP ADDRESSABILITY TO PARSE PARAMETER     46600002
*                            LIST                                       46650002
         LINK  EP=IKJPARS,ERRET=PARSERR    PARSE THE COMMAND.           46700002
PARSBLOW DS    0H            LABEL USED BY STAE RETRY ROUTINE           46750002
SMTPARS  DS    0H            SMT LABEL FOR TEST CASES TGO01500 AND      46800002
*                            TCAL2800                                   46850002
         B     PARSTAB(R15)  GO HANDLE RETURN CODE FROM IKJPARS         46900002
PARSTAB  DS    0H                                                       46950002
         B     CODE0         0-CONTINUE PROCESSING                      47000002
         B     FLUSHIT       4-GO BACK TO IKJEGMNL                      47050002
         B     ATTNEXIT      8-ATTENTION ENCOUNTERED-EXIT               47100002
         B     CODE12        12-GO WRITE PROPER MESSAGE                 47150002
         B     CODE16        16-GO WRITE PROPER MESSAGE                 47200002
         B     CHKRET        20-RETURN TO IKJEGMNL                      47250002
         SPACE                                                          47300002
*********************************************************************** 47350002
*        PARSE OK, RETURN TO CALLER                                   * 47400002
*********************************************************************** 47450002
CODE0    DS    0H                                                       47500002
         BR    R10           GO BACK TO CALLING ROUTINE                 47550002
         SPACE                                                          47600002
*********************************************************************** 47650002
** PARSE RETURN CODE WAS 12, INDICATING INVALID PARMS SENT TO PARSE. ** 47700002
** REGISTER 2 CONTAINS A CODE INDICATING WHICH ROUTINE USED IKJPARS. ** 47750002
** THE FOLLOWING BRANCH TABLE IS USED TO FIND THE APPROPRIATE MESSAGE** 47800002
*********************************************************************** 47850002
CODE12   DS    0H                                                       47900002
         B     MSGTAB2(R2)   GO TO PROPER ROUTINE                       47950002
MSGTAB2  DS    0H                                                       48000002
         NOP   MSGTAB2       NO FUNCTION EXISTS                         48050002
         B     GOMSG2        4-CODE FOR GO                              48100002
         B     CALLMSG2      8-CODE FOR CALL                            48150002
         B     RUNMSG2       12-CODE FOR RUN                            48200002
         SPACE                                                          48250002
GOMSG2   DS    0H                                                       48300002
         LA    R3,MSG1       INDICATE MESSAGE NUMBER                    48350002
         B     MSGRTN        GO TO MESSAGE ROUTINE                      48400002
         SPACE                                                          48450002
CALLMSG2 DS    0H                                                       48500002
         LA    R3,MSG5       INDICATE MESSAGE NUMBER                    48550002
         B     MSGRTN        GO TO MESSAGE ROUTINE                      48600002
         SPACE                                                          48650002
RUNMSG2  DS    0H                                                       48700002
         LA    R3,MSG4       INDICATE MESSAGE NUMBER                    48750002
         B     MSGRTN        GO TO MESSAGE ROUTINE                      48800002
         SPACE                                                          48850002
*********************************************************************** 48900002
*        PARSE RETURN CODE 16 - NOT ENOUGH MAIN STORAGE FOR PDL       * 48950002
*        ISSUE MESSAGE.                                               * 49000002
*********************************************************************** 49050002
CODE16   DS    0H                                                       49100002
         B     MSGRTNA       GO TO MESSAGE ROUTINE             XXXXXXXX 49200002
         EJECT                                                          49250002
*********************************************************************** 49300002
*                                                                     * 49350002
*                   ESTAE EXIT ROUTINE                                * 49400002
*                                                                     * 49450002
*********************************************************************** 49500002
STAERTN  DS    0H                                                       49550002
         SPACE                                                          49600002
*********************************************************************** 49650002
*        GET ADDRESS OF TCOMTAB                                       * 49700002
*********************************************************************** 49750002
         L     R2,CVTPTR     GET CVT ADDRESS                            49800002
         USING CVT,R2        ESTABLISH ADDRESSABILITY TO CVT            49850002
         L     R2,CVTTCBP    GET ADDRESS OF TCB WORDS                   49900002
         L     R2,D4(R2)     GET ADDRESS OF CURRENT TCB                 49950002
         DROP  R2            DROP ADDRESSABILITY TO CVT                 50000002
         USING TCB,R2        ESTABLISH ADDRESSABILITY TO TCB            50050002
         L     R9,TCBTRN     PICK UP POINTER TO TCOMTAB FROM            50100002
*                            TCBTRN FIELD OF TEST'S TCB                 50150002
         SPACE                                                          50200002
*********************************************************************** 50250002
*        RESTORE GO'S REGISTERS 13 AND 12 (12 IS BASE).               * 50300002
*********************************************************************** 50350002
         L     R13,REGSAVE2  GET ADDR OF GO, CALL, RUN REGISTERS        50400002
         L     R12,GR12-SAVEAREA(R13)  RESET ADDRESSABILITY             50450002
         SPACE                                                          50500002
*********************************************************************** 50900002
*        SET RETURN CODE TO MAINLINE TO INDICATE THAT ESTAE           * 50950002
*        EXIT ROUTINE WAS ENTERED.                                    * 51000002
*********************************************************************** 51050002
NOWORK   DS    0H                                                       51100002
         LA    R15,RETCOD20  SET RETURN CODE FOR IKJEGMNL INDICATING    51150002
*                            ESTAE EXIT ROUTINE ENTERED                 51200002
         B     RETURN        GO SET UP TO RETURN TO IKJEGMNL            51250002
         EJECT                                                          51300002
*********************************************************************** 51350002
*  THIS IS THE MESSAGE WRITING ROUTINE.                                 51400002
*  AT ENTRY R3 CONTAINS THE ADDRESS OF A THREE WORD PARAMETER LIST.     51450002
*    WORD1=MESSAGE NUMBER OF FIRST LEVEL MESSAGE                        51500002
*    WORD2=MESSAGE NUMBER OF SECOND LEVEL MESSAGE                       51550002
*    WORD3=INSERT NUMBER TO BE INSERTED IN FIRST LEVEL MESSAGE          51600002
*          WORD3 WILL BE ZERO OF THERE IS NO INSERT                     51650002
*********************************************************************** 51700002
MSGRTN   DS    0H                                                       51750002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO PARM LIST        51800002
         STM   R2,R4,SAVE234 SAVE R2-R4 FOR REUSE                       51900002
         LM    R2,R4,D0(R3)  LOAD R2-R4 WITH PARM LIST VALUES           51950002
* ISSUE FIRST AND SECOND LEVEL MESSAGES                                 52000002
         IKJEGSIO MSG,FIRST=(R2),SECOND=(R3),INST11=(NUM,(R4)),        *52050002
               ID=GO014,MF=(E,TSTIOPRM)                                 52060002
         LM    R2,R4,SAVE234 RESET R2-R4                       XXXXXXXX 52061002
MSGRTN1  DS    0H                                              XXXXXXXX 52062002
         OI    TSTFLGS4,TSTFLUSH  TURN ON TSTFLUSH SO MNL WILL          52100002
*                            FLUSH INPUT STACK                          52120002
         B     RCTABLE(R15)  INDEX THROUGH RETURN CODE BRANCH TABLE     52130002
RCTABLE  DS    0H                                                       52140002
         B     CKCRIT        RC=0 NORMAL CONTINUE                       52150002
         B     CKCRIT        RC=4 IO ERROR TRY TO CONTINUE              52160002
         B     CKCRIT        RC=8 SHOULD NEVER HAPPEN                   52164002
         B     CKCRIT        RC=12 IO ERROR TRY TO CONTINUE             52166002
         B     ATTNEXIT      RC=16 ATTENION HIT,EXIT                    52168002
         B     CKCRIT        RC=20 IO ABEND TRY TO CONTINUE             52168402
         B     EXIT24        RC=24 ESTAE ERROR,EXIT                     52168802
CKCRIT   DS    0H            CHECK FOR CRITICAL ERROR                   52170002
         LTR   R2,R2         IS THIS A CRITICAL RUN ERROR?              52300002
         BNL   EXIT0         NO, GO BACK WITH RETURN CODE 0             52350002
         B     EXIT          RETURN TO MAINLINE WITH RETURN CODE 12     52400002
*                            BUT WITH RUNSW OFF TO CLEAN UP             52430002
*                            AND GET OUT OF TEST                        52460002
MSGRTNA  DS    0H                                              XXXXXXXX 52461002
* ISSUE 'NOT ENOUGH MAIN STORAGE' MESSAGE                      XXXXXXXX 52461202
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM LST XXXXXXXX 52462002
         IKJEGSIO MSG,FIRST=M0103,ID=GO014,MF=(E,TSTIOPRM)     XXXXXXXX 52463002
         B     MSGRTN1       GO CHECK RETURN CODES             XXXXXXXX 52464002
         EJECT                                                          52500002
*********************************************************************** 52550002
*        A NONZERO RETURN CODE WAS RETURNED BY SVC 97. DETERMINE      * 52600002
*        WHICH COMMAND WAS ISSUED, AND ISSUE APPROPRIATE MESSAGE.     * 52650002
*********************************************************************** 52700002
         SPACE                                                          52750002
SVCERR   DS    0H                                                       52800002
         B     SVCTAB(R2)    BRANCH ON R2 INTO TABLE                    52850002
         SPACE                                                          52900002
SVCTAB   DS    0H                                                       52950002
         NOP   SVCTAB        THIS BRANCH IMPOSSIBLE                     53000002
         B     GOSVCMSG      ISSUE GO MESSAGE                           53050002
         B     CALSVCMS      ISSUE CALL MESSAGE                         53100002
         B     RUNSVCMS      ISSUE RUN MESSAGE                          53150002
         SPACE                                                          53200002
GOSVCMSG DS    0H                                                       53250002
         LA    R3,MSG7       PUT MSG ID IN R3                           53300002
         B     MSGRTN        GO WRITE MSG                               53350002
         SPACE                                                          53400002
CALSVCMS DS    0H                                                       53450002
         LA    R3,MSG8       PUT MSGID IN R3                            53500002
         B     MSGRTN        GO WRITE MSG                               53550002
         SPACE                                                          53600002
RUNSVCMS DS    0H                                                       53650002
         LA    R3,MSG9       PUT MSGID IN R3                            53700002
         B     MSGRTN        GO WRITE MSG                               53750002
         EJECT                                                          53800002
*********************************************************************** 53810002
*     ROUTINES TO HANDLE ERRET EXITS FROM LINK AND LOAD MACROS          53812002
*********************************************************************** 53814002
PARSERR  EQU   *                                                        53820002
* ISSUE 'LINK TO IKJPARS SVC ERROR' MESSAGE                             53820402
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM LIST         53822002
         LR    R0,R1         LOAD ABEND CODE INTO R0                    53822402
         IKJEGSIO SVCERR,SVC=6,RC=(R15),ABENDRG=(R0),                  *53824002
               INST11=(NUM,I0040),ID=GO014,MF=(E,TSTIOPRM)              53826002
         C     R15,ATTNRC    IS RC=16,20 OR 24?                         53828002
         BL    NOWORK        NO, SEND RC=20 TO MAINLINE                 53828402
         B     RETURN        SEND 16,20 OR 24 RC TO MAINLINE            53828802
         EJECT                                                          53830002
*********************************************************************** 53850002
*        THESE ARE THE PARSE MACROS FOR GO, RUN, AND CALL.            * 53900002
*********************************************************************** 53950002
IKJEGPAR IKJPARM DSECT=GORUNDUM    GO AND RUN MACROS                    54000002
ADDR     IKJPOSIT ADDRESS,VALIDCK=ADDRCHK                               54050002
         IKJENDP                                                        54100002
         SPACE                                                          54150002
IKJEGPAS IKJPARM DSECT=CALLDUMM    CALL MACROS                          54200002
BRADDR   IKJPOSIT ADDRESS,PROMPT='BRANCH ADDRESS',VALIDCK=ADDRCHK       54250002
PARM     IKJKEYWD                                                       54300002
         IKJNAME  'PARM',SUBFLD=PARMSFLD                                54350002
VLIST    IKJKEYWD                                                       54400002
         IKJNAME 'VL'                                                   54450002
RETKEY   IKJKEYWD                                                       54500002
         IKJNAME 'RETURN',SUBFLD=RETSFLD                                54550002
PARMSFLD IKJSUBF                                                        54600002
PARMADDR IKJPOSIT ADDRESS,LIST,VALIDCK=ADDRCHK,PROMPT='PARAMETER ADDRESX54650002
               S(ES)'                                                   54700002
RETSFLD  IKJSUBF                                                        54750002
RETADDR  IKJPOSIT ADDRESS,VALIDCK=ADDRCHK,PROMPT='RETURN ADDRESS'       54800002
         IKJENDP                                                        54850002
         EJECT                                                          54900002
*********************************************************************** 54950002
*                           CONSTANTS                                 * 55000002
*********************************************************************** 55050002
         SPACE                                                          55100002
         DS    0F             ALIGN SP1 TO WORD BOUNDARY                55150002
HIBITON  DC    X'80000000'   WORD WITH HI BIT ON TO MAKE R2 NEGATIVE    55200002
GOCON    DC    V(IKJEGPAR)    ADDRESS OF GO/RUN PCL                     55300002
CALLCON  DC    V(IKJEGPAS)    ADDRESS OF CALL PCL                       55350002
BASECON  DC    A(IKJEGGO)     PROGRAM BASE ADDRESS                      55400002
ATTNRC   DC    F'16'         ATTENTION RETURN CODE                      55450002
ESTAERC  DC    F'24'         ESTAE FAILURE RETURN CODE                  55500002
         SPACE                                                          55550002
**  THE FOLLOWING IS THE ESTAE MESSAGE TABLE                         ** 55600002
         SPACE                                                          55650002
STATBL   DS    0F                                                       55700002
         DC    AL1(92),AL3(BLOW1)           GETMAIN FAILED              55750002
         DC    AL1(99),AL3(PARSBLOW)        PARSE LINK FAILED           55800002
         DC    AL1(HEXFF)                   END OF ESTAE ABEND TABLE    55850002
         SPACE 2                                                        55900002
GOSPL    IKJEGSPL RTRY=STAERTN,ABNTB=STATBL,MODNM=IKJEGGO,TNM=GO        55950002
RUNSPL   IKJEGSPL RTRY=STAERTN,ABNTB=STATBL,MODNM=IKJEGGO,TNM=RUN       56000002
CALSPL   IKJEGSPL RTRY=STAERTN,ABNTB=STATBL,MODNM=IKJEGGO,TNM=CALL      56050002
         EJECT                                                          56100002
*********************************************************************** 56150002
* THESE ARE THE MESSAGE PARAMETER LISTS USED BY THE COMMON              56200002
* MESSAGE WRITING ROUTINE(MSGRTN)                                       56250002
* THE PARAMETER LISTS HAVE THE FOLLOWING FORMAT.                        56260002
*    WORD1=FIRST LEVEL MESSAGE NUMBER IN BINARY                         56270002
*    WORD2=SECOND LEVEL MESSAGE NUMBER IN BINARY                        56280002
*    WORD3=FIRST LEVEL MESSAGE INSERT NUMBER IN                         56290002
*          BINARY OR ZERO IF THERE IS NO INSERT                         56292002
*********************************************************************** 56300002
MSG1     DS    0F                                                       56350002
         DC    F'104'        GO FAILED,COMMAND SYSTEM ERROR             56400002
         DC    F'277'        PARSE ERROR CODE 12                        56450002
         DC    F'18'         'GO' INSERT                                56500002
MSG3     DS    0F                                                       56750002
         DC    F'58'         RUN FAILED                                 56800002
         DC    F'257'        OVERLAY PGMS NOT SUPPORTED BY RUN          56850002
         DC    F'19'         'RUN' INSERT                               56900002
MSG4     DS    0F                                                       56950002
         DC    F'104'        RUN FAILED,COMMAND SYSTEM ERROR            57000002
         DC    F'277'        PARSE ERROR CODE 12                        57050002
         DC    F'19'         'RUN' INSERT                               57100002
MSG5     DS    0F                                                       57150002
         DC    F'104'        CALL FAILED,COMMAND SYSTEM ERROR           57200002
         DC    F'277'        PARSE ERROR CODE 12                        57250002
         DC    F'20'         'CALL' INSERT                              57300002
MSG7     DS    0F                                                       57350002
         DC    F'104'        GO FAILED,COMMAND SYSTEM ERROR             57400002
         DC    F'283'        SVC97 RETURN CODE NONZERO                  57450002
         DC    F'18'         'GO' INSERT                                57500002
MSG8     DS    0F                                                       57550002
         DC    F'104'        CALL FAILED,COMMAND SYSTEM ERROR           57600002
         DC    F'283'        SVC97 RETURN CODE NONZERO                  57650002
         DC    F'20'         'CALL' INSERT                              57700002
MSG9     DS    0F                                                       57750002
         DC    F'104'        RUN FAILED,COMMAND SYSTEM ERROR            57800002
         DC    F'283'        SVC97 RETURN CODE NONZERO                  57850002
         DC    F'19'         'RUN' INSERT                               57900002
MSG10    DS    0F                                                       57950002
         DC    F'104'        RUN FAILED,COMMAND SYSTEM ERROR            58000002
         DC    F'276'        SYSTEM CNTRL BLK ERROR,TEST SESSION ENDED  58050002
         DC    F'19'         'RUN' INSERT                               58100002
         EJECT                                                          62500002
         SPACE 2                                                        62550002
         TCOMTAB                                                        62600002
         EJECT                                                          62650002
         SPACE                                                          62700002
         BRKELEM                                                        62750002
         EJECT                                                          62800002
         SPACE                                                          62850002
         IKJPPL                                                         62900002
         EJECT                                                          62950002
         TSTCWORK                                                       63000002
         ORG   CWORKCMD      GO BACK TO COMMAND WORK AREA               63050002
GOWKAREA DS    0H                                                       63100002
CMDCODE  DS    AL1           THIS IS THE NORMAL RETURN CODE TO BE       63150002
*                            ISSUED UPON COMPLETION OF THE COMMAND      63200002
SVCPARMS DS    3F            WORK AREA FOR TEST SVC MACRO EXPANSION     63250002
PPLAREA  DS    7F            PARSE PARAMETER LIST-DESCRIPTION IN PPL    63300002
*                            MACRO EXPANSION                            63350002
ADDRONE  DS    A             ADDRESS OF FIRST LEVEL MESSAGE             63400002
ADDRTWO  DS    A             ADDRESS OF SECOND LEVEL MESSAGE            63450002
REGSAVE  DS    F             SERVICE ROUTINE RETURN CODE SAVEAREA       63500002
STAEAREA DS    CL16          ESTAE WORKAREA                             63550002
*********************************************************************** 63600002
*        THE FOLLOWING FORMAT FOR THE SVRB'S SAVE AREA FOR THE        * 63650002
*        GPR'S ASSUMES THAT THE SVC INTERRUPT HANDLER DOES A          * 63700002
*        STM 0,15                                                     * 63750002
*********************************************************************** 63800002
         DS    0F                                                       63850002
PPRSAVE  DS    0CL64         SAVE AREA FOR PP'S REGISTERS               63900002
PPREG0   DS    F             SAVED REGISTER 0                           63950002
PPREG1   DS    F             SAVED REGISTER 1                           64000002
PPREG2   DS    F             SAVED REGISTER 2                           64050002
PPREG3   DS    F             SAVED REGISTER 3                           64100002
PPREG4   DS    F             SAVED REGISTER 4                           64150002
PPREG5   DS    F             SAVED REGISTER 5                           64200002
PPREG6   DS    F             SAVED REGISTER 6                           64250002
PPREG7   DS    F             SAVED REGISTER 7                           64300002
PPREG8   DS    F             SAVED REGISTER 8                           64350002
PPREG9   DS    F             SAVED REGISTER 9                           64400002
PPREG10  DS    F             SAVED REGISTER 10                          64450002
PPREG11  DS    F             SAVED REGISTER 11                          64500002
PPREG12  DS    F             SAVED REGISTER 12                          64550002
PPREG13  DS    F             SAVED REGISTER 13                          64600002
PPREG14  DS    F             SAVED REGISTER 14                          64650002
PPREG15  DS    F             SAVED REGISTER 15                          64700002
SAVE234  DS    3F            SAVE AREA FOR R2-R4 DURING MESSAGE WRITING 64710002
         EJECT                                                          64750002
         SPACE                                                          64800002
         IKJPARMA                                                       64850002
         EJECT                                                          64900002
         SPACE                                                          64950002
         IKJTCB                                                         65000002
         EJECT                                                          65050002
CVT      DSECT                                                          65100002
         CVT                                                            65150002
         EJECT                                                          65200002
         IKJRB                                                          65250002
         EJECT                                                          65300002
SAVEAREA DSECT                                                          65352002
SAVEUSER DS    F             UNUSED                                     65354002
SAVELAST DS    F             PTR TO LAST SAVEAREA (CALLER'S)            65356002
SAVENEXT DS    F             PTR TO NEXT SAVEAREA (SUBROUTINE)          65358002
RETURNPT DS    F             PTR TO CALLER'S RESUME ADDRESS             65358402
ENTRYPT  DS    F             PTR TO ENTRY POINT                         65358802
GR0      DS    F             GENERAL REGISTER 0                         65359202
GR1      DS    F             GENERAL REGISTER 1                         65359602
GR2      DS    F             GENERAL REGISTER 2                         65359702
GR3      DS    F             GENERAL REGISTER 3                         65359802
GR4      DS    F             GENERAL REGISTER 4                         65359902
GR5      DS    F             GENERAL REGISTER 5                         65363202
GR6      DS    F             GENERAL REGISTER 6                         65365202
GR7      DS    F             GENERAL REGISTER 7                         65365602
GR8      DS    F             GENERAL REGISTER 8                         65366002
GR9      DS    F             GENERAL REGISTER 9                         65366402
GR10     DS    F             GENERAL REGISTER 10                        65366502
GR11     DS    F             GENERAL REGISTER 11                        65366602
GR12     DS    F             GENERAL REGISTER 12                        65374902
LSAVE    EQU   *-SAVEAREA    LENGTH OF SAVEAREA                         65376902
         EJECT                                                          65378902
IKJEGGO  CSECT                                                          65383402
         DS    0F            FORCE FULLWORD ALIGNMENT                   65385402
GRCPATCH DC    50C'Z'        PATCH AREA                                 65391702
         END                                                            65400002
./  ADD  SSI=81730763,NAME=IKJEGINT
GINT     TITLE 'IKJEGINT - TSO TEST INITIALIZATION - MAIN LINE CODE'    00008003
         COPY  IKJEGSIO                                                 00016003
         EJECT                                                          00024003
*D638400                                                       @YM07110 00032003
*A347600-347800                                                @ZA00859 00040003
IKJEGINT CSECT                                                          00048003
*********************************************************************** 00060003
*                                                                     * 00070003
* STATUS --                                                           * 00080003
*    VERSION NO. 01, OS/VS2 RELEASE NO. 02, 06/06/73                  * 00090003
*                                                                     * 00100003
* FUNCTION --                                                         * 00112003
*    THIS MODULE RECEIVES CONTROL FROM THE TMP AS THE RESULT OF       * 00120003
*    A LINK.IT IS THE PRIMARY INITIALIZATION ROUTINE OF THE TEST      * 00130003
*    CONVERSATIONAL DEBUGGING PACKAGE FOR TSO.THIS ROUTINE ACQUIRES   * 00140003
*    STORAGE NEEDED BY TEST,LOCATES SUB-COMMANDS VIA BLDL,INITIAL-    * 00150003
*    IZES THE COMMUNICATION TABLE AND SETS UP INITIAL QUALIFICATION   * 00160003
*    FOR ANY SUB-TASK WHICH EXISTS.IF NONE EXISTS,THE TEST LOADER     * 00170003
*    IS ATTACHED TO BRING IN THE REQUESTED PROGRAM AS A SUB-TASK      * 00180003
*    OF THE TEST TASK.                                                * 00190003
*                                                                     * 00200003
* ENTRY POINTS --                                                     * 00210003
*    IKJEGINT                                                         * 00220003
*                                                                     * 00230003
* INPUT --                                                            * 00240003
*    TEST PARAMETER LIST (TPL) POINTED TO BY REGISTER 1.              * 00250003
*                                                                     * 00260003
* OUTPUT --                                                           * 00270003
*    TCOMTAB IS INITIALIZED FOR TEST'S MAINLINE ROUTINE               * 00280003
*                                                                     * 00290003
* EXTERNAL REFERENCES --                                              * 00300003
*         IKJPARS  LINKED - TO PARSE TEST COMMAND.                    * 00310003
*         IKJEGLDR ATTACHED - TO BRING IN REQUESTED PROGRAM.          * 00320003
*         IKJEGIO BRANCHED - TO WRITE DIAGNOSTIC MESSAGES.            * 00330003
*         IKJDAIR LINKED - TO ALLOCATE AND UNALLOCATED DATA SETS      * 00340003
*         IKJEFF18 LINKED - TO TO HANDLE DAIR ERROR MESSAGES          * 00350003
*         IKJDFLT LINKED - TO DEFAULT THE USER SUPPLIED DS.           * 00360003
*                                                                     * 00370003
* EXITS, NORMAL --                                                    * 00380003
*         BRANCH TO IKJEGMNL                                          * 00390003
*                                                                     * 00400003
* EXITS, ERROR --                                                     * 00410003
*         RETURN TO TMP.                                              * 00420003
*                                                                     * 00430003
* TABLES/WORKAREAS --                                                 * 00440003
*    TCOMTAB IS THE TEST COMMUNICATION TABLE BUILT BY INITIALIZATION  * 00450003
*    WORKAREAS HUNG FROM THIS TABLE ARE GOTTEN BY THIS MODULE         * 00460003
*    OUTBUF, ATTNBUF, CONAREA, BLDLIST, SCPPAD, REGSAVE1-5, SCPP4K    * 00470003
*                                                                     * 00480003
* ATTRIBUTES --                                                       * 00490003
*    RE-ENTRANT.                                                      * 00500003
*    REFRESHABLE.                                                     * 00510003
*                                                                     * 00520003
* CHARACTER CODE DEPENDENCY --                                        * 00530003
*    NONE                                                             * 00540003
*                                                                     * 00550003
* NOTES --                                                            * 00560003
*    REGISTER CONVENTION FOR INITIALIZATION ARE AS FOLLOWS            * 00570003
*    REG 9 IS TCOMTAB POINTER                                         * 00580003
*    REG 10 IS THE TPL(TEST PARAMETER LIST) POINTER                   * 00590003
*    REG 11 ONLY USED FOR LINK REGISTER                               * 00600003
*    REG 12 IS THE BASE REGISTER                                      * 00610003
*    REGISTER 0,1,14,15 ARE USED BY MOST SUBROUTINE'S BAL-ED TO.      * 00620003
*                                                                     * 00630003
* CHANGE ACTIVITY --                                                  * 00633001
*    @ZA15329 - NEAR LABEL SPECIAL INSTRUCTION ST R2,PPEXIT DELETED   * 00636001
*    @ZA18794 - PUESDO POST ECBTERM IF ABEND OCCURES IN INITALIZATION * 00636501
*               AFTER LOADING PROBLEM PROGRAM TO BE TESTED.           * 00637001
*    @ZA25752 - MSGIKJ57370I ISSUED WITH IKJ57336I TEXT - REGS 3 AND  * 00638001
*                   4 SET UP INCORRECTLY,MSG IKJ57002I WILL BE ISSUED * 00638601
*                                                                     * 00640003
*********************************************************************** 00650003
         EJECT                                                          00660003
*********************************************************************** 00670003
*                                                                       00680003
* GENERAL REGISTER EQUATES                                              00690003
*                                                                       00700003
*********************************************************************** 00710003
         SPACE 2                                                        00720003
R0       EQU   0              GENERAL REGISTER 0                        00730003
R1       EQU   1              GENERAL REGISTER 1                        00740003
R2       EQU   2              GENERAL REGISTER 2                        00750003
R3       EQU   3              GENERAL REGISTER 3                        00760003
R4       EQU   4              GENERAL REGISTER 4                        00770003
R5       EQU   5              GENERAL REGISTER 5                        00780003
R6       EQU   6              GENERAL REGISTER 6                        00790003
R7       EQU   7              GENERAL REGISTER 7                        00800003
R8       EQU   8              GENERAL REGISTER 8                        00810003
R9       EQU   9              GENERAL REGISTER 9                        00820003
R10      EQU   10             GENERAL REGISTER 10                       00830003
R11      EQU   11             GENERAL REGISTER 11                       00840003
R12      EQU   12             GENERAL REGISTER 12                       00850003
R13      EQU   13             GENERAL REGISTER 13                       00860003
R14      EQU   14             GENERAL REGISTER 14                       00870003
R15      EQU   15             GENERAL REGISTER 15                       00880003
         SPACE                                                          00890003
*********************************************************************** 00900003
*        MESSAGE EQUATES, NUMBERS OF MESSAGE IN MESSAGE CSECT           00910003
*********************************************************************** 00920003
TESTFAIL EQU   0100           TEST FAILED MSG                           00930003
SVCFAIL  EQU   0273           BREAKPOINT SVC ERROR MESSAGE (2 ND)       00940003
DAIRNO   EQU   0041           NUMBER OF 'DAIR' IN STATIC INSERT TABLE   00950003
DEFLTNO  EQU   0046           NUMBER OF 'IKJDFLT' STATIC INSERT TABLE   00960003
EFF18NO  EQU   0042           NUMBER OF 'IKJEFF18' STATIC INSERT TABLE  00970003
PARSENO  EQU   0040           NUMBER OF 'IKJPARS' STATIC INSERT TABLE   00980003
BADMEMNO EQU   0002           BAD MEMBER MESSAGE NUMBER                 00990003
NOSTROG  EQU   0260           LACK OF STORAGE MESSAGE NUMBER  (2 ND)    01000003
MGNOTRY  EQU   0001           NO PROGRAM LEFT TO TEST                   01010003
ATTCHFL  EQU   0104           XXX FAILED COMMAND SYS ERROR MSG NO.      01020003
NOTCONT  EQU   0258           UNABLE TO CONTINUE TEST MSG NO.. (2 ND)   01030003
ATTCHNO  EQU   0027           ATTACH FIX INSERT NO.                     01040003
N1       EQU   1              DECIMAL ONE                      @ZA05807 01042001
         EJECT                                                          01050003
*********************************************************************** 01060003
*                                                                     * 01070003
*        PERFORM INITIAL PROCESSING FOR THE TEST COMMAND              * 01080003
*        PROCESSOR --                                                 * 01090003
*                                                                     * 01100003
*        1 --  SAVE ENTRY REGISTERS.                                  * 01110003
*                                                                     * 01120003
*        2 --  ACQUIRE MAIN STORAGE FOR TEST COMMUNICATION TABLE,     * 01130003
*              REGISTER SAVE AREAS, OUTPUT BUFFER, AND SUBCOMMAND     * 01140003
*              WORK AREAS.                                            * 01150003
*                                                                     * 01160003
*        3 --  SET MAIN STORAGE AREAS TO ZERO.                        * 01170003
*                                                                     * 01180003
*        4 --  ISSUE THE STAE MACRO INSTRUCTION TO ESTABLISH AN       * 01190003
*              ABNORMAL END EXIT FOR THIS LOAD OF THE TEST CP.        * 01200003
*                                                                     * 01210003
*        R9 -- ADDRESS OF TCOMTAB.                                    * 01220003
*        R10 - ADDRESS OF TPL.                                        * 01230003
*        R12 - BASE REGISTER.                                         * 01240003
*                                                                     * 01250003
*********************************************************************** 01260003
         SPACE 2                                                        01270003
         SAVE  (14,12),,*     SAVE CALLER'S REGS.                       01280003
         LR    R12,R15        ESTABLISH ADDRESSABILITY FOR THIS         01290003
         USING IKJEGINT,R12   CSECT.                                    01300003
INT01010 EQU   *                                                        01310003
         LR    R10,R1         ESTABLISH ADDRESSABILITY TO THE           01320003
         USING TPL,R10        TPL.                                      01330003
         SPACE 2                                                        01340003
         L     R0,TCOMTABL    SIZE OF TCOMTAB FOR GETMAIN.              01350003
         GETMAIN RU,LV=(0),SP=1  GET STORAGE FOR TCOMTAB, WORK AREAS.   01360003
         SPACE 2                                                        01370003
         LR    R9,R1          ESTABLISH ADDRESSABILITY TO               01380003
         USING TCOMTAB,R9     THE TCOMTAB.                              01390003
         SPACE 2                                                        01400003
         LR    R2,R9          BEGINNING ADDRESS OF GOTTEN CORE          01410003
         LR    R4,R9          TO BE SET TO ZERO,                        01420003
         SR    R5,R5          SHOW ENTIRE FIELD TO BE SET TO            01430003
         L     R3,TCOMTABL    ZERO WITH X'00' AS PADDING CHAR           01440003
         MVCL  R2,R4          SET TCOMTAB TO ZERO.                      01450003
         EJECT                                                          01460003
*********************************************************************** 01470003
*                                                                     * 01480003
*        INITIALIZE FIELDS IN THE TEST COMMUNICATION TABLE --         * 01490003
*                                                                     * 01500003
*        1 --  SET-UP ADDRESS OF TEST'S TCB.                          * 01510003
*                                                                     * 01520003
*        2 --  PLACE ENTRY POINTS OF THE I/O SERVICE ROUTINES IN      * 01530003
*              TCOMTAB.  NOTE THAT VCONS IN THIS MODULE MUST HAVE     * 01540003
*              SAME ORDER AS ENTRY POINT LABELS IN TCOMTAB.           * 01550003
*                                                                     * 01560003
*        3 --  ESTABLISH THE PSEUDO BREAKPOINT IN TCOMTAB.            * 01570003
*                                                                     * 01580003
*        4 --  MOVE ADDRESSES OF ECBS, UPT, AND ECT FROM THE TPL      * 01590003
*              TO TCOMTAB.                                            * 01600003
*                                                                     * 01610003
*        5 --  COMPUTE ADDRESSES OF VARIOUS TEST WORKAREAS AND        * 01620003
*              REGISTER SAVE AREAS AND PLACE IN TCOMTAB.              * 01630003
*                                                                     * 01640003
*        6 --  INVOKE SVC 97 TO PLACE TCOMTAB ADDRESS IN TEST'S       * 01650003
*              TCB.                                                   * 01660003
*                                                                     * 01670003
*        7 --  OBTAIN TERMINAL LINE SIZE AND SAVE IN TCOMTAB FOR      * 01680003
*              USE OF I/O ROUTINES.                                   * 01690003
*                                                                     * 01700003
*        R8 -- ADDRESS OF INITIALIZATION'S WORK AREA.                 * 01710003
*                                                                     * 01720003
*********************************************************************** 01730003
         SPACE 2                                                        01740003
         L     R4,CVTPTR       CVT ADDR.                                01750003
         USING CVT,R4          ADDRESSABILITY TO CVT.                   01760003
         L     R4,CVTTCBP      NEW-CURRENT ADDR.                        01770003
         DROP  R4                                                       01780003
         MVC   TSTTCB(L'TSTTCB),X4(R4) TSTTCB=TEST'S TCB.               01790003
         SPACE 2                                                        01800003
         MVC   TSTIO(L'TSTIO),IOADDR  PLACE ADDR OF  IO INTO TCOMTAB    01810003
         MVC   TSTCONVT(N12),CVTBDSTA  ADDR OF CVT, BLD, STA IN TCOMTAB 01820003
         MVC   TSTSRHRT(X4),SRHRTVCN   PLACE ADDR OF SRH INTO TCOMTAB   01830003
         SPACE 2                                                        01840003
         MVC   OPCODTAB(X8),OPCODV  INSERT THE OP CODE TABLE ADDR       01850003
         MVC   TSTSVC(L'TSTSVC),SVC  PSEUDO BREAKPOINT SVC.             01860003
         SPACE 2                                                        01870003
         L     R2,TPLCECB     ATTACHED CP ECB ADDRESS.                  01880003
         L     R3,TPLIECB     STAI ECB ADDRESS.                         01890003
         L     R4,TPLAECB     ATTN ECB ADDRESS.                         01900003
         L     R5,TPLMECB     STOP/MODIFY ECB.                          01910003
         STM   R2,R5,ECBTERM  SAVE.                                     01920003
         L     R2,TPLUPT      ADDRESS OF UPT FOR PARMLIST               01930003
         L     R3,TPLECT      ADDRESS OF ECT FOR PARMLIST               01940003
         STM   R2,R4,PARMLIST UPT ADDR, ECT ADDR, ATTN ECB ADDR         01950003
         SPACE 2                                                        01960003
         LA    R1,TCOMLEN(,R9) ADDR OF OUTPUT BUFFER                    01970003
         ST    R1,OUTBUF      INITIALIZE POINTER TO BUFFER.      ****** 01980003
         LA    R2,OUTBUFRL(,R1) ADDR OF CONVERT WORK AREA               01990003
         ST    R2,CONAREA     INITIALIZE POINTER TO CVT WORKAREA.****** 02000003
         LA    R3,CONAREAL(,R2) ADDR OF GENERAL WORK AREA               02010003
         LA    R4,CWORKLEN(,R3) ADDR OF REGISTER SAVE AREA 1            02020003
         LA    R5,N72(,R4)    ADDR OF REGISTER SAVE AREA 2              02030003
         LA    R6,N72(,R5)    ADDR OF REGISTER SAVE AREA 3              02040003
         LA    R7,N72(,R6)    ADDR OF REGISTER SAVE AREA 4              02050003
         LA    R8,N72(,R7)    ADDR OF REGISTER SAVE AREA 5              02060003
         STM   R3,R8,WORKAREA PLACE ADDRESSES IN TCOMTAB         ****** 02070003
         LA    R1,N72(,R8)    ADDR OF REGISTER SAVE AREA 6              02080003
         ST    R1,REGSAVE6    PLACE ADDRESS IN TCOMTAB                  02090003
         SPACE                                                          02100003
         ST    R13,X4(,R4)    SAVE BACKWARD POINTER.                    02110003
         ST    R4,X8(,R13)    SAVE FORWARD POINTER.                     02120003
         LR    R13,R4         R13=NEW REGSAVE ADDR.                     02130003
         SPACE 2                                                        02140003
         SR    R8,R8          ZERO R8                                   02150003
         LA    R0,INTWLEN     SIZE OF INT WORKAREA FOR GETMAIN.         02160003
         GETMAIN RC,SP=1,LV=(0)    GET STORAGE FOR INT WORK AREAS.      02170003
         LTR   R15,R15        WAS THE GETMAIN OK                        02180003
         BNZ   GETERROR       NO THEREFORE PUTOUT ERROR MSG             02190003
         SPACE 2                                                        02200003
         LR    R8,R1          R8= ADDR OF THE WORK AREA FOR INT         02210003
         ST    R8,N0(,R13)    SAVE WORKAREA ADDRESS FOR ABEND.          02220003
         USING INTWKARA,R8    ESTABLISH ADDRESSABILITY TO WORK          02230003
*                             AREA.                                     02240003
         SPACE 2                                                        02250003
*********************************************************************** 02260003
*        ISSUE AN ESTAE                                                 02270003
*********************************************************************** 02280003
         STM   R14,R12,N12(R13) SAVE THE REGS FOR RETRY                 02290003
         XC    INTWKARA(INTWLEN),INTWKARA CLEAR WORK AREA               02300003
         L     R2,TSTSTAE     R2=ADDR OF IKJEGSTA                       02310003
         ESTAE (R2),CT,PARAM=INTSPL,RECORD=YES,MF=(E,INTWKARA)          02320003
         LTR   R15,R15        IS R15 NON ZERO                           02330003
         BNZ   ESTAERR        YES IT IS NON ZERO ERROR CONDITION        02340003
         SPACE 2                                                        02350003
INT01030 EQU   *              CONTINUE AS ESTAE WAS OK                  02360003
         L     R2,TSTTCB      ADDRESS OF TMP/TEST TCB.                  02370003
         IKJEGS9G TRN,TCBADDR=(R2),VALUE=(R9),MF=(E,INTSVCPL)           02380003
         LTR   R15,R15        CHECK RETURN CODE.                        02390003
         BNZ   SVC97ERR       IF NONZERO THEN ERROR                     02400003
         LA    R2,TSTDSECB    TEST ECB ADDR IN TCOMTAB.                 02410003
         ST    R2,ECBTST      SAVE TEST ECB ADDRESS.                    02420003
         SPACE 2                                                        02430003
         GTSIZE                                                         02440003
         LR    R11,R1         PUT THE TERMINAL LENGTH IN R11.           02450003
         SLL   R11,N16(R0)    SHIFT FOR STORE.                          02460003
         STM   R10,R11,TPLPTR SAVE TPL ADDRESS AND TERMINAL LINE        02470003
*                             LENGTH IN TCOMTAB                         02480003
         EJECT                                                          02490003
*********************************************************************** 02500003
*                                                                     * 02510003
* DETERMINE IF TEST WAS INVOKED BY THE TMP DUE TO AN ATTENTION        * 02520003
* INTERRUPT OR DUE TO THE PREVIOUS COMMAND PROCESSOR COMPLETING       * 02530003
* ABNORMALLY.                                                         * 02540003
*                                                                     * 02550003
*********************************************************************** 02560003
         SPACE 2                                                        02570003
         OC    PPTCB(L'TPLNTCB),TPLNTCB MOVE AND TEST ABENDING TCB PTR  02580003
         BNZ   INT03010       YES,ABEND,SKIP NEXT TEST.                 02590003
         OC    PPTCB(L'TPLCTCB),TPLCTCB MOVE AND TEST ATTACHED TCB PTR  02600003
         BZ    INT07010       IF NO SUBTASKS, PARSE TEST COMMAND.       02610003
         B     INT03030       BRANCH TO TURN ON TEST BIT(S)             02620003
         SPACE 2                                                        02630003
INT03010 EQU   *                                                        02640003
         OI    TSTFLGS3,TSTSTAI TURN ON STAI INDICATOR FOR SVC97        02650003
         XC    TPLNTCB(L'TPLNTCB),TPLNTCB ZERO ABENDED TCB POINTER.     02660003
         EJECT                                                          02670003
*********************************************************************** 02680003
*                                                                     * 02690003
* SUBTASK WAS INTERCEPTED THROUGH AN ATTENTION INTERRUPT OR BY AN     * 02700003
* ABNORMAL END (STAI).  CHECK ALL SUBTASKS OF THE TEST (TMP) TCB      * 02710003
* FOR DATA SAVED BY THE SVC 061 ROUTINE (TCBTRN .NE. 0).  WHEN DATA   * 02720003
* WAS SAVED BY SVC 061, CHAIN DATA FROM TSTTRN (IN TCOMTAB) AND       * 02730003
* RESET THE TCBTRN AND TCBABF FIELDS IN THE TCB.                      * 02740003
*                                                                     * 02750003
*********************************************************************** 02760003
         SPACE 2                                                        02770003
INT03030 EQU   *                                                        02780003
         L     R4,TSTTCB      TEST'S TCB.                               02790003
         USING TCB,R4         ADDRESSABILITY TO TCB.                    02800003
         OI    TSTFLGS4,TSTA  INDICATE NEED FOR A TERMINAL ELEMENT.     02810003
         LA    R2,N0(,R4)     CLEAR HIGH BYTE AND SAVE.                 02820003
INT04010 EQU   *                                                        02830003
         L     R5,TCBLTC      OBTAIN DAUGHTER.                          02840003
         LTR   R5,R5          IS THERE A DAUGHTER.                      02850003
         BNZ   INT04050       YES.PROCESS.                              02860003
INT04030 EQU   *                                                        02870003
         L     R5,TCBNTC      OBTAIN SISTER IF ONE.                     02880003
         LTR   R5,R5          IS THERE ONE.                             02890003
         BNZ   INT04050       YES.GO PROCESS.                           02900003
         L     R4,TCBOTC      LOAD MOTHER TASK.                         02910003
         LA    R4,N0(,R4)     CLEAR HIGH BYTE.                          02920003
         CR    R4,R2          DOES MOTHER = TEST TASK.                  02930003
         BNE   INT04030       NO. CHECK SISTER TCB.                     02940003
         B     INT06010       YES. DONE....                             02950003
INT04050 EQU   *                                                        02960003
         LA    R5,N0(,R5)     CLEAR HIGH BYTE.                          02970003
         BAL   R11,INT05010   CHECK THE TCBTRN FIELD                    02980003
         LR    R4,R5          FIND NEXT TCB UNDER TEST.                 02990003
         B     INT04010       LOOP UNTIL DONE.                          03000003
         DROP  R4                                                       03010003
         EJECT                                                          03020003
*********************************************************************** 03030003
*                                                                     * 03040003
* USING THE TCB ADDRESS PASSED IN REGISTER (R5), CHECK THE TCBTRN     * 03050003
* FIELD TO DETERMINE IF A POINTER IS PRESENT TO DATA SAVED BY SVC     * 03060003
* 061.  WHEN TCBTRN .NE. 0, ISSUE A GETMAIN FOR 12 BYTES OF SUBPOOL   * 03070003
* 1 CORE WHICH WILL BE USED TO ENQUEUE DATA FROM TSTTRN (IN TCOMTAB). * 03080003
* IN ALL CASES, SVC 097 WILL BE INVOKED TO SET THE TCBTCP (IN         * 03090003
* TCBABF) FLAG TO 1 AND TCBTRN TO POINT TO TCOMTAB.                   * 03100003
*                                                                     * 03110003
*        R5 -  ADDRESS OF TCB TO BE CHECKED.                          * 03120003
*                                                                     * 03130003
*********************************************************************** 03140003
         SPACE 2                                                        03150003
INT05010 EQU   *                                                        03160003
         USING TCB,R5         ADDRESSABILITY TO TCB.                    03170003
         L     R6,TCBTRN      TCBTRN MAY CONTAIN A QUEUE.               03180003
         LA    R6,N0(,R6)     CLEAR HIGH BYTE                           03190003
         LTR   R6,R6          Q. HAS SVC61 BEEN HERE..                  03200003
         BZ    INT05030       NO. TURN ON BIT AND SET FIELD.            03210003
         L     R0,INTSVIBL    LENGTH OF CONTROL BLOCK FOR GETMAIN       03220003
         GETMAIN  RC,SP=1,LV=(0)   GET SVC INFO BLOCK CONTROL WORDS.    03230003
         LTR   R15,R15        WAS A NON ZERO RETURN CODE RECEIVED       03240003
         BNZ   GETERROR       PROCESS THE SVC ERROR                     03250003
INT05020 EQU   *              ALL IS OK WITH THE GETMAIN.               03260003
         USING IKJEGSVQ,R1    ADDRESSABILITY TO SVQ                     03270003
         MVC   SVQLNKPT(L'SVQLNKPT),TSTTRN LINK FIELD TO PUSH           03280003
*                             DOWN QUEUE.                               03290003
         STM   R5,R6,SVQTCBPT TCB ADDR,SVC INFO BLOCK PTR.              03300003
         ST    R1,TSTTRN      HANG CONTROL WORDS TO TSTTRN WORD.        03310003
         DROP  R1                                                       03320003
         SPACE 2                                                        03330003
INT05030 EQU   *                                                        03340003
         IKJEGS9G TCPON,TCBADDR=(R5),MF=(E,INTSVCPL)                    03350003
         LTR   R15,R15        CHECK RETURN CODE.                        03360003
         BNZ   SVC97ERR       IF NOT ZERO, BRANCH TO EXIT.              03370003
         SPACE 2                                                        03380003
         IKJEGS9G TRN,TCBADDR=(R5),VALUE=(R9),MF=(E,INTSVCPL)           03390003
         LTR   R15,R15        CHECK RETURN CODE.                        03400003
         BNZ   SVC97ERR       IF NOT ZERO, BRANCH TO EXIT.              03410003
         SPACE 2                                                        03420003
         BR    R11            CHECK THE NEXT TCB UNDER TEST.            03430003
         DROP  R5                                                       03440003
         EJECT                                                          03450003
*********************************************************************** 03460003
*                                                                     * 03470003
*        LOCATE PRB FOR PROGRAM BEING TESTED.  SET A PSEUDO-          * 03480003
*        BREAKPOINT AT THE RESUME ADDRESS CONTAINED IN THE            * 03490003
*        RBOPSW.                                                      * 03500003
*                                                                     * 03510003
*********************************************************************** 03520003
         SPACE 2                                                        03530003
INT06010 EQU   *                                                        03540003
         L     R6,TPLCTCB     MOTHER TASK.                              03550003
         USING TCB,R6         ADDRESSABILITY TO TCB.                    03560003
         L     R6,TCBFSA      INITIAL SAVE AREA.                        03570003
         DROP  R6                                                       03580003
         LA    R4,PPEXIT1     'NORMAL TERMINATION' EXIT.                03590003
         ST    R4,N12(,R6)    *                                         03600003
         L     R7,PPTCB       THE ABEND TASK OR THE HIGHEST TASK (ATTN) 03610003
         USING TCB,R7         ADDRESSABILITY TO TCB.                    03620003
         L     R2,TCBRBP      1ST RB.                                   03630003
         DROP  R7                                                       03640003
         TM    TSTFLGS3,TSTSTAI  TEST FOR STAI OR ATTENTION.            03650003
         BO    STAI1          IT'S AN ABEND. PROCESS RETRY.             03660003
         LR    R4,R2          SET REGISTER FOR ATTN.                    03670003
         USING RBSECT,R4      ADDRESSABILITY TO RB.                     03680003
         SPACE 2                                                        03690003
LOOP     EQU   *                                                        03700003
         TM    RBSTAB1,RBFTSIRB TEST FOR PRB(IRB)                       03710003
         BZ    FOUND          FOUND A PRB(IRB)                          03720003
         L     R4,RBLINK      GET THE NEXT R.B.                         03730003
         B     LOOP           LOOP UNTIL PRB(IRB) IS FOUND.             03740003
         DROP  R4                                                       03750003
         EJECT                                                          03760003
*********************************************************************** 03770003
*                                                                     * 03780003
*        ALL RBS ARE PURGED UP TO THE MOST CURRENT STAE/STAI EXIT PRB.* 03790003
*        IF THERE ARE NONE OF THESE, THEN PURGE BACK TO THE MOST      * 03800003
*        CURRENT PRB AFTER THE LAST SVRB.                             * 03810003
*                                                                     * 03820003
*        IF THERE ARE NO PRBS TO RETRY, AND THERE IS ONLY ONE TASK    * 03830003
*        UNDER TEST THEN PRINT 'NOTHING LEFT TO TEST' AND QUIT.       * 03840003
*        IF THE ABENDED TASK IS NOT THE HIGHEST TASK, SET A PSEUDO    * 03850003
*        BREAKPOINT IN ITS MOTHER AND LET THE DAUGHTER ABEND.         * 03860003
*                                                                     * 03870003
*********************************************************************** 03880003
         SPACE 2                                                        03890003
STAI1    EQU   *                                                        03900003
LOOP7    EQU   *                                                        03910003
         L     R6,TCBRBP-TCB(,R7) ADDRESS OF MOST RECENT RB,            03920003
*                             ASSUME PRB FOR STAI EXIT.                 03930003
         TM    RBSTAB1-RBSECT(R6),RBFTP DETERMINE IF A PRB.             03940003
         BNZ   QRETRY         IF FIRST RB IS NOT A PRB, ERROR.          03950003
*                             BRANCH TO CHECK FOR MULTITASKING.         03960003
         TM    RBSTAB2-RBSECT(R6),RBTCBNXT CHECK IF LAST RB.            03970003
         BO    QRETRY         IF ONLY RB ON QUEUE, ERROR.               03980003
         L     R5,RBLINK-RBSECT(,R6) ADDRESS OF NEXT MOST RECENT        03990003
*                             RB, ASSUME SVRB FOR ABEND.                04000003
         TM    RBSTAB1-RBSECT(R5),RBFTSVRB DETERMINE IF A SVRB.         04010003
         BNO   QRETRY         IF NOT A SVRB, ERROR.                     04020003
         TM    RBSTAB2-RBSECT(R5),RBTCBNXT CHECK IF LAST RB.            04030003
         BO    QRETRY         IF LAST RB ON QUEUE, ERROR.               04040003
         L     R4,RBLINK-RBSECT(,R5) ADDRESS OF NEXT MOST RECENT        04050003
*                             RB, ASSUME ABENDING PRB OR IRB.           04060003
         TM    RBSTAB1-RBSECT(R4),RBFTP-RBFTIRB DETERMINE IF A          04070003
*                             PRB OR AN IRB.                            04080003
         BNZ   ABNDSVRB       IF NOT A PRB OR AN IRB, BRANCH TO         04090003
*                             CHECK FOR A SVRB.                         04100003
         LR    R2,R5          R2= ADDR OF PREVIOUS RB                   04110003
         B     AOK            BRANCH TO SET PSEUDO BREAKPOINT.          04120003
         SPACE 2                                                        04130003
ABNDSVRB EQU   *                                                        04140003
         TM    RBSTAB2-RBSECT(R4),RBTCBNXT CHECK IF LAST RB.            04150003
         BO    QRETRY         IF LAST RB ON QUEUE, ERROR.               04160003
         TM    RBSTAB1-RBSECT(R4),RBFTSVRB DETERMINE IF SVRB.           04170003
         BNO   QRETRY         IF NOT A SVRB, ERROR.                     04180003
         LA    R5,RBSECT-RBPREFIX(,R0) LENGTH OF RB PREFIX.             04190003
         SR    R4,R5          SET RB POINTER TO PREFIX.                 04200003
         CLC   RBINTCOD-RBPREFIX(L'RBINTCOD,R4),ABEND DETERMINE         04210003
*                             IF THIS RB ABENDED.                       04220003
         BNE   QRETRY         IF RB DID NOT ABEND, ERROR.               04230003
         AR    R4,R5          RESTORE RB POINTER TO BASIC SECTION       04240003
         SPACE 2                                                        04250003
PRBLOOK  EQU   *                                                        04260003
         LR    R2,R4          SAVE ADDR OF PREVIOUS RB                  04270003
         L     R4,RBLINK-RBSECT(,R4) NEXT RB ON QUEUE.                  04280003
         TM    RBSTAB1-RBSECT(R4),RBFTP-RBFTIRB DETERMINE IF PRB        04290003
*                             OR IRB NEXT ON QUEUE.                     04300003
         BZ    AOK            IF A PRB OR IRB, BRANCH TO SET            04310003
*                             PSEUDO BREAKPOINT.                        04320003
         TM    RBSTAB2-RBSECT(R4),RBTCBNXT CHECK IF LAST RB.            04330003
         BZ    PRBLOOK        IF NOT THE END OF THE RB QUEUE,           04340003
*                             CONTINUE SEARCH UNTIL A PRB (OR           04350003
*                             IRB) OR END OF QUEUE OCCURS.              04360003
         SPACE 2                                                        04370003
QRETRY   EQU   *                                                        04380003
         NI    TSTFLGS3,XFF-TSTSTAI  TURN OFF ABEND BIT.                04390003
*        BIT TURNED OFF SO PP'S REGS WONT GET MESSED UP.                04400003
         L     R5,TCBOTC-TCB(,R7) GET THE MOTHER TCB.                   04410003
         LA    R5,N0(,R5)     CLEAR THE HIGH BYTE.                      04420003
         C     R5,TSTTCB      Q. IS THE MOTHER OF TPLNTCB TEST TCB.     04430003
         BNE   SOMTHING       SKIP THE NOTHING CODE.                    04440003
         LA    R3,MGNOTRY     'NO ACTIVE PROGRAM LEFT TO TEST'          04450003
         LA    R4,N0          NOSECOND LEVEL MSG                        04460003
         B     PUTRTURN       PRINT MSG AND EXIT.                       04470003
SOMTHING EQU   *                                                        04480003
         ST    R5,PPTCB       SAVE THE MOTHER AND SET A PSEUDO BRKPT.   04490003
         L     R6,TCBRBP-TCB(,R5) GET THE FIRST RB .                    04500003
LOOP7C   EQU   *                                                        04510003
         TM    RBSTAB1-RBSECT(R6),RBFTSIRB Q.IS THIS A PRB(IRB)         04520003
         BZ    SETPSEUD       YES SET A PSEUDO BRKPT.                   04530003
         L     R6,RBLINK-RBSECT(,R6) GET THE NEXT RB.                   04540003
         B     LOOP7C         LOOP UNTIL A PRB(IRB) IS FOUND.           04550003
SETPSEUD EQU   *                                                        04560003
         MVC   TSTGOPSW(L'TSTGOPSW),RBOPSW-RBSECT+X4(R6) SAVE THE I.C.  04570003
         MVC   TSTGOWCF(L'TSTGOWCF),RBWCF-RBSECT(R6) SAVE THE           04580003
*                             WAIT COUNT.                               04590003
         IKJEGS9G WCF,TCBADDR=(R6),MF=(E,INTSVCPL)                      04600003
         LTR   R15,R15        CHECK RETURN CODE.                        04610003
         BNZ   SVC97ERR       IF NOT ZERO, BRANCH TO EXIT.              04620003
         SPACE 2                                                        04630003
         LA    R2,TSTSVC      ADDRESS OF PSEUDO BREAKPT.                04640003
         IKJEGS9G OPSW,TCBADDR=(R6),VALUE=(R2),MF=(E,INTSVCPL)          04650003
         LTR   R15,R15        CHECK RETURN CODE.                        04660003
         BNZ   SVC97ERR       IF NOT ZERO, BRANCH TO EXIT.              04670003
         SPACE 2                                                        04680003
         STATUS START,TCB=(R7) START THE ABENDED TCB.                   04690003
         LA    R0,PPEXIT2     RETRY AT SVC 3                            04700003
         B     STAIPOST       LET THE ABEND CONTINUE.                   04710003
AOK      EQU   *                                                        04720003
         L     R3,REGSAVE2    SAVE AREA FOR ABENDING REGS.              04730003
         MVC   N0(N64,R3),RBGRSAVE-RBSECT(R2) SAVE THE REGISTERS.       04740003
         OC    TSTGOPSW(L'TSTGOPSW),RBABOPSW-RBSECT(R4) SAVE            04750003
*                             ADDRESS OF ABEND.                         04760003
         BNZ   SKIP5          SKIP THE NEXT BIT OF CODE.                04770003
FOUND    EQU   *                                                        04780003
         MVC   TSTGOPSW(L'TSTGOPSW),RBOPSW-RBSECT+X4(R4) SET UP         04790003
*                             RESUME ADDRESS.                           04800003
SKIP5    EQU   *                                                        04810003
         MVC   TSTGOWCF(L'TSTGOWCF),RBWCF-RBSECT(R4) SAVE THE           04820003
*                             WAIT COUNT.                               04830003
         SPACE 2                                                        04840003
         IKJEGS9G WCF,TCBADDR=(R4),MF=(E,INTSVCPL)                      04850003
         LTR   R15,R15        CHECK RETURN CODE.                        04860003
         BNZ   SVC97ERR       IF NOT ZERO, BRANCH TO EXIT.              04870003
         SPACE 2                                                        04880003
         LA    R2,TSTSVC      PSEUDO BREAKPOINT ADDRESS.                04890003
         IKJEGS9G OPSW,TCBADDR=(R4),VALUE=(R2),MF=(E,INTSVCPL)          04900003
         LTR   R15,R15        CHECK RETURN CODE.                        04910003
         BNZ   SVC97ERR       IF NOT ZERO, BRANCH TO EXIT.              04920003
         SPACE 2                                                        04930003
         LA    R0,TSTSVC      RETRY ADDRESS.                            04940003
STAIPOST EQU   *              POST IKJEFT04(TEST/TMP STAI EXIT)         04950003
         L     R1,TPLECT      GET ECT ADDRESS                  @ZA07137 04952001
         OI    ECTSWS2-ECT(R1),ECTTABND       TELL TMP STAI  @ZA07137   04954001
*                                               NOT TO DEQ     @ZA07137 04956001
         L     R1,TPLNECB     POST ECB FOR TMP STAI EXIT RTN.           04960003
         O     R0,POST7F      POST STAI ECB WITH A '7F'                 04970003
         POST  (1),(0)        POST                                      04980003
         STATUS  START        MAKE ALL SUBTASKS DISPATCHABLE.           04990003
         B     WAIT           ALLOW RECOVERY,BY WAITING FOR PSEUDO      05000003
*                             BREAK TO OCCUR.                           05010003
         EJECT                                                          05020003
*********************************************************************** 05030003
*                                                                     * 05040003
*        TRANSFER CONTROL TO IKJEGMNL                                 * 05050003
*                                                                     * 05060003
*********************************************************************** 05070003
         SPACE 2                                                        05080003
MODEGO   EQU   *                                                        05090003
         LA    R0,INTWLEN     R0=LENGTH OF THE FREEMAIN                 05100003
         MVC   PPEXIT(X4),SVC PLACE THE SVC97 AND 03 IN TCOMTAB         05110003
         FREEMAIN RC,LV=(0),SP=1,A=(8) FREEMAIN ADDR                    05120003
         LTR   R15,R15        WAS THE FREEMAIN OK                       05130003
         BZ    GOTOMNL        YES THEREFORE GO TO MNL                   05140003
         BAL   R11,FREERROR   NO THEREFORE OUTPUT ERROR                 05150003
         SPACE                                                          05160003
****     ISSUE ESTAE 0 TO REMOVE ESTAE                                  05179903
GOTOMNL  EQU   *              TRANFER CONTROL TO MNL                    05189903
         ESTAE 0              REMOVE THE CURRENT ESTAE                  05199903
         SPACE                                                          05200003
         LR    R1,R9          PASS MNL THE ADDR OF TCOMTAB              05210003
         L     R13,X4(R13)    RESTORE TMPS SAVE AREA ADDRESS            05220003
         L     R15,MNLADDR    R15= ENTRY POINT OF MNL                   05230003
         L     R14,N12(R13)   RESTORE R14 OF TMP                        05240003
         LM    R2,R12,N28(R13)   RESTORE TMP'S REGISTERS                05250003
         BR    R15            TRANSFER CONTROL TO MNL                   05260003
BLOW3    EQU   *                                                        05270003
         EJECT                                                          05280003
*********************************************************************** 05290003
*                                                                     * 05300003
*        WHEN TEST WAS ENTERED AS THE RESULT OF THE USER ENTERING     * 05310003
*        A TEST COMMAND, BUT NOT IN RESPONSE TO AN ATTENTION          * 05320003
*        INTERRUPT, INVOKE THE PARSE SERVICE ROUTINE TO SYNTAX        * 05330003
*        CHECK OPERANDS ENTERED ON THE TEST COMMAND.                  * 05340003
*                                                                     * 05350003
*        R2 -- ADDRESS OF PARSE PARAMETER CONTROL LIST.               * 05360003
*        R3 -- ADDRESS OF PARSE ANSWER PLACE.                         * 05370003
*        R4 -- ADDRESS OF COMMAND BUFFER.                             * 05380003
*                                                                     * 05390003
*********************************************************************** 05400003
         SPACE 2                                                        05410003
INT07010 EQU   *                                                        05420003
         L     R2,PCLADDR     R2=PCL ADDR.                              05430003
         MVC   INTPARSL(L'TSTUPT+L'TSTECT+L'TSTCPECB),PARMLIST MOVE     05440003
*                                    IN SERVICE ROUTINE PARMLIST.       05450003
         LA    R3,TSTANSPL    R3=ANSWER PLACE ADDR.                     05460003
         L     R4,TPLTBUF     R4=TEST COMMAND BUFFER.                   05470003
         LINK  EP=IKJPARS,PARAM=(,,,(R2),(R3),(R4)),ERRET=LINKPARS,    X05480003
               MF=(E,INTPARSL)  PARSE THE COMMAND.                      05490003
BLOW5    EQU   *                                                        05500003
         LTR   R15,R15        CHECK RETURN CODE FROM PARSE.             05510003
         BZ    INT08010       RETURN CODE = 0, CONTINUE NORMALLY        05520003
         CH    R15,INTRC004   CHECK FOR RETURN CODE = 4.                05530003
         BE    TMPRTURN       USER SPECIFIED NO PROMPT, RETURN.         05540003
         CH    R15,INTRC008   CHECK FOR RETURN CODE = 8.                05550003
         BE    TMPRTURN       USER CAUSED AN ATTENTION INTERRUPT,       05560003
*                             RETURN.                                   05570003
         CH    R15,INTRC016   CHECK FOR RETURN CODE = 16.               05580003
         BE    NOCORE         PARSE UNABLE TO GET CORE, RETURN.         05590003
*                                                                       05600003
*        FOR ALL OTHER RETURN CODES, ISSUE COMMAND SYSTEM ERROR         05610003
*        MESSAGE.                                                       05620003
*                                                                       05630003
         B     TMPRTURN       RETURN TO TMP.                            05640003
         SPACE                                                          05650003
****     ISSUE THE MESSAGE TEST FAILED NO CORE                          05660003
         SPACE                                                          05670003
NOCORE   EQU   *              ISSUE THE MESSAGE                         05680003
         LA    R3,TESTFAIL    R3= TEST FAILED MESSAGE NUMBER            05690003
         LA    R4,NOSTROG     R4= SECOND LEVEL NO STORAGE AVAILABLE     05700003
         B     PUTRTURN       OUTPUT THE MESSAGE AND EXIT               05710003
         EJECT                                                          05720003
*********************************************************************** 05730003
*                                                                     * 05740003
*        UPON SUCCESSFUL RETURN FROM THE PARSE SERVICE ROUTINE,       * 05750003
*        DETERMINE IF THE USER ENTERED A FULLY QUALIFIED OR A         * 05760003
*        PARTIALLY QUALIFIED DATA SET NAME.                           * 05770003
*                                                                     * 05780003
*        WHEN A FULLY QUALIFIED DATA SET NAME WAS ENTERED, BRANCH     * 05790003
*        IMMEDIATELY TO INVOKE THE DAIR SERVICE ROUTINE TO            * 05800003
*        ALLOCATE THE DATA SET.                                       * 05810003
*                                                                     * 05820003
*        WHEN A PARTIALLY QUALIFIED DATA SET NAME WAS ENTERED,        * 05830003
*        INSPECT THE RIGHTMOST QUALIFIER FOR THE DATA SET TYPE        * 05840003
*        ('LOAD' AND/OR 'OBJ').  IF EITHER TYPE WAS SPECIFIED AND     * 05850003
*        IS THE SAME AS THE KEYWORD OPERAND ENTERED ON THE TEST       * 05860003
*        COMMAND, STRIP OFF THE QUALIFIER SO THAT IT IS NOT ADDED     * 05870003
*        BY THE DEFAULT SERVICE ROUTINE.  EXAMPLE --                  * 05880003
*                                                                     * 05890003
*        IF THE USER ENTERS --                                        * 05900003
*                                                                     * 05910003
*              TEST XXX.LOAD LOAD --OR-- TEST XXX.OBJ OBJ             * 05920003
*                                                                     * 05930003
*        THE RIGHTMOST QUALIFIER IS REMOVED.                          * 05940003
*                                                                     * 05950003
*        FOR ALL PARTIALLY QUALIFIED DATA SET NAMES, THE DEFAULT      * 05960003
*        SERVICE ROUTINE IS INVOKED TO BUILD A FULLY QUALIFIED        * 05970003
*        DATA SET NAME BY PREFIXING THE USERID AND APPENDING THE      * 05980003
*        TYPE OPERAND SPECIFIED ON THE TEST COMMAND.  AFTER           * 05990003
*        DEFAULT HAS SUCCESSFULLY BUILT A FULLY QUALIFIED DATA        * 06000003
*        SET NAME, DAIR IS INVOKED TO ALLOCATE THE DATA SET.          * 06010003
*                                                                     * 06020003
*        R7 -- ADDRESS OF PARSE PDL.                                  * 06030003
*                                                                     * 06040003
*********************************************************************** 06050003
         SPACE 2                                                        06060003
INT08010 EQU   *                                                        06070003
         L     R7,TSTANSPL    R8=ADDR OF PARSE-PRODUCED PDL.            06080003
         USING IKJPARMD,R7    PDL ADDRESSABILITY.                       06090003
         SPACE 2                                                        06100003
         MVC   INDFLTPL(DFPLDFPB-DFPLUPT+L'DFPLDFPB),PARMLIST           06110003
*                             MOVE STANDARD POINTERS TO LIST            06120003
         MVI   INTSTDSN,BLANK BLANK OUT DATA SET NAME AREA              06130003
         MVC   INTSTDSN+X1(L'INTSTDSN-X1),INTSTDSN                      06140003
         L     R2,DSNAME      R2=ADDR OF DSNAME FROM DSNAME PDE.        06150003
         LH    R3,DSNAME+X4   R3 = DSNAME LENGTH.                       06160003
         STH   R3,INDSNLEN    DSNAME LENGTH SAVED FOR DEFAULT           06170003
         LTR    R3,R3         IS DSNAME LENGTH ZERO?     @ZA00859       06180003
          BZ    NODSNAM              YES, SKIP MOVE       @ZA00859      06190003
         BCTR  R3,R0          REDUCE LENGTH FOR EXECUTE.                06200003
         EX    R3,DSNMVC      MOVE DSNAME TO DSNAME AREA.               06210003
NODSNAM  TM    DSNAME+X6,FULLQUAL Q.IS DSNAME FULLY QUALIFIED.          06220003
         BO    DAIR           IF B'01000000',YES,ALLOCATE.              06230003
         CLI   LOADOBJ+X1,LOADON Q.IS LOAD SPECIFIED.                   06240003
         LA    R2,LOAD        YES,USE 'LOAD' QUALIFIER.                 06250003
         BE    NEXT1          *                                         06260003
         LA    R2,OBJECT      NO,USE 'OBJECT' QUALIFIER.                06270003
NEXT1    EQU   *                                                        06280003
         LA    R3,X1(,R3)     RESTORE DSNAME LENGTH.                    06290003
         LA    R4,X2(,R0)     CONSTANT FOR COMPARES                     06300003
         SR    R3,R4          IF USER NAME IS 2 CHARS OR LESS,          06310003
         BNH   DSN01030       BRANCH TO INDICATE SIMPLE NAME            06320003
         LA    R5,INTSTDSN(R3) ADDRESS NEXT-TO-LAST CHARACTER           06330003
DSN01010 EQU   *                                                        06340003
         CLI   N0(R5),INDSNPER IS CHARACTER A PERIOD                    06350003
         BE    DSN01020       IF SO, QUALIFIER CHECK REQUIRED           06360003
         BCTR  R5,R0          ADDRESS NEXT CHARACTER TO LEFT            06370003
         BCT   R3,DSN01010    DECREMENT LENGTH AND REPEAT AS            06380003
*                             LONG AS LENGTH .GT. 0                     06390003
         B     DSN01030       BRANCH TO INVOKE DEFAULT                  06400003
DSN01020 EQU   *                                                        06410003
         SH    R3,INDSNLEN    SUBTRACT FULL LENGTH FROM LENGTH          06420003
         LCR   R3,R3          COMPLEMENT TO GET QUALIFIER LENGTH        06430003
         BCTR  R3,R0          REDUCE LENGTH FOR EXECUTE                 06440003
         EX    R3,QUALCHK     DETERMINE IF QUALIFIER IS EITHER          06450003
*                             OBJ OR LOAD                               06460003
         BNE   DSN01030       IF NEITHER OF THE ABOVE, BRANCH TO        06470003
*                             INVOKE DEFAULT                            06480003
         LA    R3,X1(,R3)     RESTORE QUALIFIER LENGTH                  06490003
         LH    R4,INDSNLEN    GET DSNAME LENGTH                         06500003
         SR    R4,R3          SUBTRACT QUALIFIER LENGTH                 06510003
         STH   R4,INDSNLEN    UPDATE DSNAME LENGTH TO LOGICALLY         06520003
*                             REMOVE RIGHTMOST QUALIFIER                06530003
DSN01030 EQU   *                                                        06540003
         LA    R4,INDSNLEN    R4 = DSNAME ADDRESS                       06550003
         MVC   INDFLTPB+DFPBPSCB-DFPB(L'DFPBPSCB),TPLPSCB               06560003
*                             PUT ADDRESS OF PSCB IN PARMLIST           06570003
         MVI   INDFLTPB+DFPBCNTL-DFPB,DFPBUID SET CONTROL BYTE          06580003
         LA    R6,INDFLTPB    ADDRESS OF DEFAULT PARM BLOCK             06590003
         LINK  EP=IKJDFLT,PARAM=(,,,(R6),(R4),,(R2)),ERRET=LINKDEFL,   X06600003
               MF=(E,INDFLTPL) LINK TO DEFAULT SERVICE ROUTINE          06610003
         CH    R15,INTRC024   CHECK FOR RETURN CODE = 24.               06620003
         BE    TMPRTURN       USER CAUSED AN ATTENTION INTERRUPT,       06630003
*                             RETURN.                                   06640003
         EJECT                                                          06650003
*********************************************************************** 06660003
*                                                                     * 06670003
*        ALLOCATE THE DATA SET SPECIFIED ON THE TEST COMMAND.         * 06680003
*                                                                     * 06690003
*        FOR THE INITIAL ALLOCATION REQUEST, A MEMBER NAME IS         * 06700003
*        IGNORED WHETHER IT WAS ENTERED ON THE TEST COMMAND OR        * 06710003
*        NOT.  AFTER A SUCCESSFUL INVOCATION OF THE DAIR SERVICE      * 06720003
*        ROUTINE, THE ALLOCATED DATA SET IS CHECKED TO DETERMINE      * 06730003
*        IF IT HAS SEQUENTIAL OR PARTITIONED ORGANIZATION.  IF        * 06740003
*        THE DSORG IS 'PS', TYPE 'OBJ' IS ASSUMED, THE TERMINAL       * 06750003
*        IS ALLOCATED TO DDNAME 'SYSTERM', AND IKJEGLDR IS            * 06760003
*        ATTACHED TO PROCESS THE OBJECT DATA SET.                     * 06770003
*                                                                     * 06780003
*        FOR BOTH 'LOAD' AND 'OBJ', A BLDL IS PERFORMED ON THE        * 06790003
*        MEMBER NAME (OR 'TEMPNAME' IF A MEMBER NAME WAS NOT          * 06800003
*        ENTERED) TO DETERMINE IF THE MEMBER EXISTS.  IF THE          * 06810003
*        MEMBER IS NOT FOUND IN THE DATA SET, TEST RETURNS TO THE     * 06820003
*        TMP.  IF TYPE 'LOAD' WAS SPECIFIED ON THE TEST COMMAND       * 06830003
*        AND DSORG IS 'PO', IKJEGLDR IS ATTACHED TO PROCESS THE       * 06840003
*        LOAD MODULE SPECIFIED.                                       * 06850003
*                                                                     * 06860003
*        WHEN TYPE 'OBJ' WAS SPECIFIED AND DSORG IS 'PO', THE         * 06870003
*        DATA SET IS UNALLOCATED AND ALLOCATED A SECOND TIME          * 06880003
*        SPECIFYING DSNAME(MEMBER).  AFTER SUCCESSFUL ALLOCATION,     * 06890003
*        THE TERMINAL IS ALLOCATED AND IKJEGLDR IS ATTACHED.          * 06900003
*                                                                     * 06910003
*********************************************************************** 06920003
         SPACE 2                                                        06930003
DAIR     EQU   *                                                        06940003
         NI    INTFLGS1,X'FF'-INTDSMEM FIRST TIME SWITCH FOR            06950003
*                             OBJECT(PDS)                               06960003
DAIROBJ  EQU   *              ENTRY FOR OBJECT(PDS) ALLOCATION.         06970003
         MVC   INTDAIRB(LEN08),DAIR08 MOVE BASIC PARM BLOCK             06980003
         LA    R3,INDSNLEN    GET ADDRESS OF DSNAME AND PLACE IN        06990003
         ST    R3,INTDAIRB+(DA08PDSN-DAPB08) DAIR PARAMETER BLOCK.      07000003
         CLI   LOADOBJ+X1,LOADON Q.IS 'LOAD' SPECIFIED.                 07010003
         BE    NOMEMBER       LOAD SPECIFIED,FORGET MEMBER.             07020003
         TM    INTFLGS1,INTDSMEM CHECK FOR OBJECT (PDS)                 07030003
         BZ    NOMEMBER       DO NOT ALLOCATE TO MEMBER                 07040003
         LH    R3,DSNAME+N12  R3=MEMBER NAME LENGTH.                    07050003
         L     R4,DSNAME+X8   R4=ADDR OF MEMBER NAME.                   07060003
         BCTR  R3,R0          REDUCE LENGTH FOR EXECUTE.                07070003
         EX    R3,MEMMOVE     MOVE MEMBER NAME TO DAIR PARM BLOCK.      07080003
NOMEMBER EQU   *                                                        07090003
         TM    PASSWORD+X6,PRESENT  IS PASSWORD PRESENT                 07100003
         BZ    NOPASSWD       NO -- BRANCH                              07110003
         LH    R3,PASSWORD+X4 GET PASSWORD LENGTH                       07120003
         L     R4,PASSWORD    POINT TO THE PASSWORD                     07130003
         BCTR  R3,R0          DECREMENT FOR THE EXECUTE                 07140003
         EX    R3,MOVEPASS    MOVE PASSWORD TO DAIR LIST                07150003
NOPASSWD EQU   *                                                        07160003
         BAL   R11,DAIR1      ALLOCATE THE DATA SET                     07170003
         SPACE 2                                                        07180003
         TM    INTFLGS1,INTDSMEM TEST FOR PREVIOUS ALLOCATION           07190003
         LA    R1,INTDAIRB    GET PARM ADDR.                            07200003
         MVC   INTSTDDN,DA08DDN-DAPB08(R1) SAVE DDNAME FOR IKJEGLDR.    07210003
         BNZ   ALLOCTER       ALLOCATE FOR PSUEDO SYSTERM DD            07220003
         SPACE 2                                                        07230003
         TM    DA08DSO-DAPB08(R1),PS   IS THIS A SEQUENTIAL DATA SET    07240003
         BO    SEQOBJ         SET TO OBJECT                             07250003
         SPACE 2                                                        07260003
         NC    DSNAME+X8(X4),DSNAME+X8 Q.IS MEMBER SPECIFIED            07270003
         BNZ   ATTACH1        YES,O.K. TO ATTACH                        07280003
         SPACE 2                                                        07290003
         MVC   DSNAME+X8(X4),TEMPNAME MOVE POINTER TO 'TEMPNAME'        07300003
         MVC   DSNAME+N12(X2),INTRC008 MOVE LENGTH OF TEMPNAME.         07310003
         SPACE 2                                                        07320003
ATTACH1  EQU   *                                                        07330003
         LA    R0,N100        SIZE OF INT WORKAREA FOR GETMAIN.         07340003
         GETMAIN RC,SP=1,LV=(0)    GET STORAGE FOR INT WORK AREAS.      07350003
         LTR   R15,R15        WAS THE GETMAIN OK                        07360003
         BNZ   GETERROR       NO THEREFORE PUTOUT ERROR MSG             07370003
         ST    R1,TSTDCB      SAVE THE DCB CORE ADDRESS.                07380003
         XC    N0(N100,R1),N0(R1) ZERO THE LINK FIELD.                  07390003
         LA    R4,N4(R1)      GET THE DCB ADDRESS.                      07400003
         USING IHADCB,R4      ESTABLISH ADDRESSABILITY TO THE DCB       07410003
         MVC   IHADCB(ADDCBLEN),ADDCB CONSTRUCT DCB.                    07420003
         MVC   DCBDDNAM(L'INTSTDDN),INTSTDDN  MOVE IN DDNAME            07430003
         MVC   INTOPENL,LFORM MOVE IN OPEN L-FORM                       07440003
         MVC   INTCLOSL,CLFORM MOVE IN CLOSE L-FORM.                    07450003
         OPEN  ((R4)),MF=(E,INTOPENL) OPEN THE DATA SET.                07460003
         SPACE 2                                                        07470003
         TM    DCBOFLGS,DCBOFOPN DID DCB OPEN.                          07480003
         DROP  R4             RELEASE ADDR'ABILITY TO DCB               07490003
         BO    ATTACH1A       IF OPEN, BRANCH TO PROCESS.               07500003
*                                                                       07510003
*        GENERATE ERROR MESSAGE FOR OPEN FAILURE.                       07520003
*                                                                       07530003
         B     TMPRTURN       RETURN TO TMP.                            07540003
         SPACE 2                                                        07550003
ATTACH1A EQU   *                                                        07560003
         LH    R3,DSNAME+N12  R5=MEMBER NAME LENGTH.                    07570003
         L     R6,DSNAME+X8   R6=MEMBER NAME ADDR.                      07580003
         L     R5,BLDLAREA    GET THE ADDRESS FOR THE BLDL ENTRY        07590003
         MVC   N0(INTBLDLL,R5),INTBLDLD INITIALIZE LIST DESCRIPTION.    07600003
         BCTR  R3,R0          DECREMENT LENGTH FOR EXECUTE.             07610003
         EX    R3,MEMMVC      MOVE IN MEMBER NAME.                      07620003
         BLDL  (R4),(R5)      OBTAIN DIRECTORY ENTRY.                   07630003
         LTR   R15,R15        DETERMINE IF BLDL WAS SUCCESSFUL.         07640003
         BNZ   BADMEM         IF NOT, BRANCH TO ISSUE MESSAGE.          07650003
         SPACE 2                                                        07660003
         LA    R5,X4(,R5)     INCREMENT BEYOND LIST DESCRIPTION.        07670003
         USING PDS2,R5        ESTABLISH ADDRESSABILITY TO PDS           07680003
*                             DIRECTORY ENTRY.                          07690003
         TM    PDS2ATR1,PDS2OVLY TEST FOR OVERLAY STRUCTURE.            07700003
         BZ    SKIP3          SKIP AROUND.                              07710003
         MVI   TSTDCB,X80     TURN ON HIGH BIT TO INDICATE OVLY.        07720003
         SPACE 2                                                        07730003
SKIP3    EQU   *                                                        07740003
         CLI   LOADOBJ+X1,LOADON  Q.LOAD OR OBJECT.                     07750003
         BE    ATTACH         A.LOAD (PDS)                              07760003
         BAL   R11,CLOSE      OBJECT (PDS).                             07770003
         MVC   INTDAIRB(LEN2C),DAIR2C UNALLOC BY DDNAME.                07780003
         MVC   INTDAIRB+(DA2CDDN-DAPB2C)(L'INTSTDDN),INTSTDDN           07790003
*                             MOVE IN THE DDNAME.                       07800003
         MVI   INTDAIRB+(DA2CFLG-DAPB2C+X1),X1 CODE TO UNALLOCATE BY    07810003
*                             DDNAME.                                   07820003
         BAL   R11,DAIR1      UNALLOCATE BY DDNAME                      07830003
         OI    INTFLGS1,INTDSMEM INDICATE MEMBER TO BE ALLOCATED        07840003
         B     DAIROBJ        REALLOCATE TO DSN(MEMBER)                 07850003
         SPACE 2                                                        07860003
SEQOBJ   EQU   *                                                        07870003
         MVI   LOADOBJ+X1,OBJON  SET TO OBJECT , IF NOT SUPPLIED        07880003
ALLOCTER EQU   *                                                        07890003
         MVC   INTDAIRB(LEN1C),DAIR1C ALLOCATE THE TERMINAL             07900003
         BAL   R11,DAIR1      SETUP AND LINK TO DAIR                    07910003
         MVC   TERMDD,INTDAIRB+(DA1CDDN-DAPB1C) SAVE TERMINAL           07920003
*                             DDNAME FOR OS LOADER.                     07930003
         EJECT                                                          07940003
*********************************************************************** 07950003
*                                                                     * 07960003
*        WHEN THE DATA SET SPECIFIED ON THE TEST COMMAND HAS BEEN     * 07970003
*        SUCCESSFULLY ALLOCATED AND THE MEMBER (OR TEMPNAME)          * 07980003
*        FOUND IN THE DATA SET, THE TEST LOADER (IKJEGLDR) IS         * 07990003
*        ATTACHED AS A SUBTASK OF TEST.  FOLLOWING A SUCCESSFUL       * 08000003
*        ATTACH, THE NEW SUBTASK TCB ADDRESS IS SAVED IN THE TPL      * 08010003
*        SO THAT TMP MAY DETACH ONCE TEST HAS RETURNED.               * 08020003
*                                                                     * 08030003
*        DATA PASSED TO IKJEGLDR POINTED TO OUT OF TCOMTAB IS --      * 08040003
*                                                                     * 08050003
*        1 --  PDL FOR TEST COMMAND (POINTED TO BY TSTANSPL)          * 08060003
*        2 --  BLDL ENTRY FOR LOADMODULE (POINTED TO BY BLDLAREA)     * 08070003
*                                                                     * 08080003
*********************************************************************** 08090003
         SPACE 2                                                        08100003
ATTACH   EQU   *                                                        08110003
         OI    DEFERTAB,X40       INIT DEFER'D BRKPT QUEUE   @ZA06226   08113001
*                                  FOR SVC 61                 @ZA06226  08116001
         MVC   INTATCHL(ATTCHLLN),ATTCHLFM SET UP PARAMETER LIST.       08120003
         L     R3,TPLSTAI     R3=STAI EXIT ADDRESS.                     08130003
         L     R2,ECBTERM     R2=PP TERMINATION ECB ADDR.               08140003
         XC    N0(X4,R2),N0(R2) ZERO TERMINATION ECB.                   08150003
         L     R4,TPLSPLS     R4=ADDR OF PARMS FOR STAI EXIT.           08160003
         L     R1,TPLECT      OBTAIN ECT POINTER                        08170003
         MVC   ECTPCMD-ECT(L'ECTPCMD,R1),TEST  MOVE TEST NAME INTO ECT  08180003
         ATTACH EP=IKJEGLDR,ECB=(R2),MF=(E,(R9)),SF=(E,INTATCHL),      X08190003
               SHSPV=78,ESTAI=((R3),(R4)),SZERO=NO ATTACH LOADER.       08200003
         SPACE 2                                                        08210003
BLOW6    EQU   *                                                        08220003
         LTR   R15,R15        CHECK FOR SUCCESSFUL COMPLETION.          08230003
         BZ    SETTCBPT       IF RETURN CODE = 0, CONTINUE.             08240003
*                                                                       08250003
*        GENERATE ERROR MESSAGE FOR ATTACH FAILURE.                     08260003
*                                                                       08270003
         LA    R3,ATTCHFL     R3= ATTACH FAILLED MESSAGE MSG NUMBER     08280003
         LA    R4,NOTCONT     R4= UNEABLE TO CONT. MSG NUMBER           08290003
         LA    R2,ATTCHNO     R2= STATIC INSERT NO FOR ATTACH           08300003
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR THE IO PARM AREA    08310003
         IKJEGSIO MSG,FIRST=(R3),SECOND=(R4),INST11=(NUM,(R2)),        *08320003
               ID=INT15,MF=(E,TSTIOPRM)    INVOKE IO FOR ERROR          08330003
         B     TMPRTURN       RETURN TO TMP.                            08340003
         SPACE 2                                                        08350003
SETTCBPT EQU   *                                                        08360003
         LA    R1,N0(,R1)     CLEAR HIGH BYTE.                          08370003
         ST    R1,TPLCTCB     SET ATTACHED TCB ADDRESS FOR TMP.         08380003
         EJECT                                                          08390003
*********************************************************************** 08400003
*                                                                     * 08410003
*        FOLLOWING A SUCCESSFUL ATTACH, WAIT ON A LIST OF ECBS.       * 08420003
*        ANY ONE OF THE FOLLOWING EVENTS WILL CAUSE TEST TO COME      * 08430003
*        OUT OF THE WAIT STATE --                                     * 08440003
*                                                                     * 08450003
*        1 --  USER PROGRAM WAIT STATE.                               * 08460003
*        2 --  USER PROGRAM TERMINATION.                              * 08470003
*        3 --  USER PROGRAM ABEND.                                    * 08480003
*        4 --  ATTENTION.                                             * 08490003
*        5 --  OPERATOR STOP TS OR MODIFY TS.                         * 08500003
*                                                                     * 08510003
*********************************************************************** 08520003
         SPACE 2                                                        08530003
WAIT     EQU   *                                                        08540003
         MVI   ECBLOG,X80     INDICATE END OF ECBLIST.                  08550003
         WAIT  ECBLIST=ECBTST ISSUE THE WAIT.                           08560003
         EJECT                                                          08570003
*********************************************************************** 08580003
*                                                                     * 08590003
*        AN EVENT OCCURRED TO TAKE TEST OUT OF THE WAIT STATE.        * 08600003
*        DETERMINE IF SVC 061 POSTED IKJEGINT SIGNALING THAT THE      * 08610003
*        PROGRAM TO BE TESTED WAS LOADED.  IF NOT, CONTINUE           * 08620003
*        TESTING FOR WHICH EVENT OCCURRED.                            * 08630003
*                                                                     * 08640003
*        WHEN SVC 061 HAS POSTED IKJEGINT --                          * 08650003
*                                                                     * 08660003
*        1 --  DETERMINE IF IKJEGLDR IS XCTLING.  IF NOT (TSTGOSW     * 08670003
*              IS ZERO), IGNORE EVENT AND POST SVC 061 COMPLETE.      * 08680003
*                                                                     * 08690003
*        2 --  WHEN IKJEGLDR IS XCTLING, OBTAIN TCB ADDRESS AND       * 08700003
*              SVC INFORMATION BLOCK POINTER FROM SVC 061'S           * 08710003
*              EXTENDED SAVE AREA.  IF SVC INFORMATION BLOCK          * 08720003
*              PRESENT, ISSUE GETMAIN FOR QUEUE CONTROL BLOCK         * 08730003
*              AND INITIALIZE.                                        * 08740003
*                                                                     * 08750003
*        3 --  IF A VALID XCTL, SAVE FIRST TWO BYTES OF USER          * 08760003
*              PROGRAM AND ESTABLISH A PSEUDO BREAKPOINT.             * 08770003
*                                                                     * 08780003
*        4 --  POST SVC 061 COMPLETE AND BRANCH TO WAIT ON SVC        * 08790003
*              097 TO COMPLETE.                                       * 08800003
*                                                                     * 08810003
*********************************************************************** 08820003
         SPACE 2                                                        08830003
         L     R5,ECBTST      TEST ECB ADDRESS.                         08840003
         TM    N0(R5),X44     X'44' IS A POST FROM SVC 61.              08850003
         BNO   SETTSIP        BRANCH TO ISSUE TSIP SVC.                 08860003
         SPACE 2                                                        08870003
         XC    N0(X4,R5),N0(R5) CLEAR TEST'S ECB.                       08880003
         TM    TSTFLGS4,TSTSVCAB  DID THE SVC ABEND?                    08890003
         BO    TSTRTURN       OUTPUT TEST FAILS AND EXIT                08900003
         L     R2,ECBPP       OBTAIN SVC61'S SVRB ADDRESS.              08910003
         TM    TSTFLGS3,TSTGOSW  TEST IF LOADER IS XCTLING.             08920003
         BZ    POST6A         NO POST. BRANCH.                          08930003
         SPACE 2                                                        08940003
         LM    R3,R4,RBEXSAVE-RBSECT(R2) GET THE TCB ADR AND SVC INFO   08950003
*                             BLOCK POINTER.                            08960003
         LTR   R3,R3          IF TCB SLOT IS ZERO , IGNORE.             08970003
         BZ    NOGET          TCB ADDR=0 , DONT GET CORE.               08980003
         SPACE 2                                                        08990003
         L     R0,INTSVIBL    IKJEGSVQ LENGTH.                          09000003
         GETMAIN  RC,SP=1,LV=(0)   GET CORE FOR CONTROL WORDS.          09010003
         LTR   R15,R15        WAS A NON ZERO RETURN CODE RECEIVAED      09020003
         BNZ   GETERROR       PROCESS THE SVC ERROR                     09030003
SVQGETOK EQU   *              ALL IS OK WITH GETMAIN                    09040003
         USING IKJEGSVQ,R1    ADDRESSABILITY TO SVQ.                    09050003
         MVC   SVQLNKPT(L'SVQLNKPT),TSTTRN PUSH DOWN QUEUE.             09060003
         STM   R3,R4,SVQTCBPT TCB ADDR, SVC BLOCK PTR TO WORDS.         09070003
         ST    R1,TSTTRN      ADD CONTROL WORDS TO QUEUE.               09080003
         DROP  R1                                                       09090003
         SPACE 2                                                        09100003
NOGET    EQU   *                                                        09110003
         L     R1,RBLINK-RBSECT(,R2) GET PRB(IRB) ADDRESS               09120003
         TM    RBCDFLGS-RBSECT(R1),RBCDXCTL TEST XCTL BIT, FL-CDE FIELD 09130003
         L     R1,RBCDE-RBSECT(,R1) XCTLEE CDE.                         09140003
         USING CDENTRY,R1     ADDRESSABILITY TO CDE DSECT.              09150003
         BZ    POST6A         BRANCH IF NOT XCTL.                       09160003
         SPACE 2                                                        09170003
         OI    INITFLG,X'10'  TURN ON INIT FLAG               @ZA18794  09171001
         L     R6,CDENTPT     XCTLEE  E.P. ADDRESS.                     09180003
         MVC   TSTGO(L'SVC),N0(R6) SAVE 2 BYTES OF INSTR.               09188401
         MVC   N0(L'SVC,R6),SVC PLANT SVC                               09200003
         MVI   DEFERTAB,X'00'   RESET DEFER BRKPT Q FOR SVC61 @ZA06226  09205001
         XC    INITFLG,INITFLG RESET INIT FLG                 @ZA18794  09207001
         SPACE 2                                                        09210003
POST6A   EQU   *                                                        09220003
         POST  ECBPP          MAKE SVC 61 DISPATCHABLE.                 09230003
         B     WAIT           WAIT AGAIN.                               09240003
         EJECT                                                          09250003
*********************************************************************** 09260003
*                                                                     * 09270003
*        DETERMINE IF IKJEGINT WAS POSTED BY SVC 097.  IF NOT,        * 09280003
*        BRANCH TO CHECK FOR USER PROGRAM ABEND.                      * 09290003
*                                                                     * 09300003
*        WHEN SVC 097 HAS POSTED IKJEGINT --                          * 09310003
*                                                                     * 09320003
*        1 --  CLEAN-UP FOLLOWING IKJEGLDR EXECUTION.                 * 09330003
*                                                                     * 09340003
*        2 --  RESET PRB RESUME PSW AND RESTORE INSTRUCTION, IF       * 09350003
*              NECESSARY.                                             * 09360003
*                                                                     * 09370003
*        3 --  BRANCH TO BRANCH TO IKJEGMNL.                          * 09380003
*                                                                     * 09390003
*********************************************************************** 09400003
         SPACE 2                                                        09410003
SETTSIP  EQU   *                                                        09420003
         SPACE 2                                                        09430003
         BAL   R11,FROMLDR    CLOSE THE DCB, AND FREE CORE              09440003
         TM    N0(R5),X44     X'40' IS NORMAL LOAD.                     09450003
         MVI   N0(R5),N0      ZERO ECB.                                 09460003
         BZ    STAICHK        CHECK STAI ECB.                           09470003
         SPACE 1                                                        09480003
*        SVC 97 POSTED INT.                                             09490003
         SPACE 1                                                        09500003
         TM    TSTFLGS4,TSTSVCAB  DID THE SVC ABEND?                    09510003
         BO    TSTRTURN       OUTPUT TEST FAILS AND EXIT                09520003
         NI    TSTFLGS3,XFF-TSTSTAI INSURE THAT STAI BIT IS OFF.        09530003
         L     R4,PPTCB       R4=PP TCB ADDR.                           09540003
         L     R5,TCBRBP-TCB(,R4) R5=ACTIVE RB ADDR.                    09550003
         L     R5,RBLINK-RBSECT(,R5) R5=PRB ADDR FOR PP.                09560003
         TM    TSTFLGS3,TSTGOSW IS IT SPECIAL BREAKPOINT.               09570003
         BO    SPECIAL        YES IT IS.                                09580003
         L     R2,TSTGO       ADDRESS OF CLOBBERED INSTRUCTION.         09590003
         SPACE 2                                                        09600003
         IKJEGS9G OPSW,TCBADDR=(R4),VALUE=(R2),MF=(E,INTSVCPL)          09610003
         LTR   R15,R15        CHECK RETURN CODE.                        09620003
         BNZ   SVC97ERR       IF NOT ZERO, BRANCH TO EXIT.              09630003
         B     CONTINUE       CONTINUE PROCESSING.                      09640003
         SPACE 2                                                        09650003
SPECIAL  EQU   *                                                        09660003
         L     R1,RBOPSW-RBSECT+X4(,R5) OBTAIN I.C.                     09670003
         MVC   N0(X2,R1),TSTGO  RESTORE 2 BYTES OF INSTRUCTION.         09680003
         NI    TSTFLGS3,XFF-TSTGOSW TURN OFF THE PSEUDO SPECIAL SW.     09690003
         LA    R2,PPEXIT      CHANGE REGISTER FOURTEEN.                 09700003
         L     R4,PPTCB       PPS TCB POINTER.                          09720003
         IKJEGS9G GPR,TCBADDR=(R4),VALUE=(R2),REGNO=R14,               *09730003
               MF=(E,INTSVCPL)                                          09740003
         LTR   R15,R15        CHECK RETURN CODE.                        09750003
         BNZ   SVC97ERR       IF NOT ZERO, BRANCH TO EXIT.              09760003
         SPACE 2                                                        09770003
CONTINUE EQU   *                                                        09780003
         XC    TSTGO(X6),TSTGO  ZERO PSEUDO BREAK FIELD IN TCOMTAB.     09790003
         B     MODEGO         ISSUE MODE MESSAGE AND GO TO MAINLINE.    09800003
         EJECT                                                          09810003
*********************************************************************** 09820003
*                                                                     * 09830003
*        THE LAST SIGNIFICANT EVENT TO BE CHECKED IS TO DETERMINE     * 09840003
*        IF THE USER PROGRAM ABENDED.  ONLY IF AN ABEND IS            * 09850003
*        INDICATED AND A MESSAGE ROUTINE ADDRESS GIVEN IN THE ECB     * 09860003
*        WILL A MESSAGE BE PRODUCED.  IN ALL CASES, CONTROL WILL      * 09870003
*        RETURN TO THE TMP.                                           * 09880003
*                                                                     * 09890003
*********************************************************************** 09900003
         SPACE 2                                                        09910003
STAICHK  EQU   *                                                        09920003
         L     R5,ECBTMPS     GET STAI ECB.                             09930003
         TM    N0(R5),X40     Q. HAS IT BEEN POSTED BY IKJEFT04.        09940003
         BZ    LDRFAIL        NO. MUST BE SOMETHING ELSE.               09950003
         MVI   N0(R5),N0      CLEAR THE ECB.                            09960003
         L     R5,N0(,R5)     GET THE ECB PARM LIST ADDRESS.            09970003
         LTR   R1,R5          IS THERE AN ADDRESS.                      09980003
         BZ    TMPRTURN       NO. RETURN TO THE TMP.                    09990003
         L     R15,N0(,R5)    GET BRANCH TO ADDRESS.(IKJEFT04)          10000003
         CALL  (15)           CALL IKJEFT04 TO PUT OUT MESSAGE.         10010003
         SPACE 2                                                        10020003
*        WAS IT A IKJEGLDR FAILURE IF SO WHAT WAS IT.                   10030003
         SPACE                                                          10040003
LDRFAIL  EQU   *                                                        10050003
         L     R5,ECBTERM     R5= ADDR OF ECBTERM ECB                   10060003
         TM    N0(R5),X40     WAS IT POSTED BY LDR?                     10070003
         BNZ   LDRDONE        EXIT WITH TEST FAILED MSG       @ZA06995  10075001
         L     R5,ECBTMPA     NOT POSTED BY LDR,SEE IF ATTN   @ZA06995  10080001
         TM    N0(R5),X'40'   WAS ATTN ECB POSTED?            @ZA06995  10081001
         BNO   TSTRTURN       NO-EXIT WITH TEST FAILED MSG    @ZA06995  10082001
         L     R5,TPLPTR      ATTN ECB POSTED                 @ZA06995  10083001
         L     R5,TPLECT-TPL(R5)   GET ECT PTR FROM TPL       @ZA06995  10084001
         OI    ECTSWS-ECT(R5),ECTATRM  SET ECT FLAG FOR ESTAI @ZA06995  10085001
LDRDONE  EQU   *                                              @ZA06995  10086001
         LA    R5,N0(R5)      CLEAR THE HIGH BYTE.                      10090003
         LA    R4,N4          R4= FOUR (R. C. CHECK)                    10100003
         CR    R4,R5          IS THE RETURN CODE 4                      10110003
         BE    TMPRTURN       YES THEREFORE EXIT (ATTN)                 10120003
         LA    R4,N24         R4= TWENTY FOUR (ESTAE FAILED)            10130003
         CR    R4,R5          IS RC 24                         @ZA25752 10140001
         BE    ESTERROR       YES,ESTAE FAILED                 @ZA25752 10141001
         LR    R3,MGNOTRY     MSG'NO ACTIVE PROG LEFT TO TEST' @ZA25752 10142001
         LA    R4,N0          NO SECOND LEVEL MSG              @ZA25752 10143001
         B     PUTRTURN       GO OUTPUT MSG                    @ZA25752 10144001
ESTERROR EQU   *              ESTAE ERROR FROM SUBTASK.                 10150003
         SR    R15,R15        ZERO R15                                  10160003
         IC    R15,TSTESTRC   R15= ESTAE RETURN CODE FROM LDR.          10170003
         B     ESTAERR        HANDLE AS ESTAE ERROR.                    10180003
         EJECT                                                          10190003
*********************************************************************** 10200003
*                                                                     * 10210003
*        TEST INITIALIZATION EXIT.                                    * 10220003
*                                                                     * 10230003
*        WHEN SOME CONDITION EXISTS SUCH THAT THE TEST SESSION        * 10240003
*        CAN NOT CONTINUE, THIS SECTION OF CODE WILL CLEAN-UP         * 10250003
*        AND RETURN TO THE TMP.                                       * 10260003
*                                                                     * 10270003
*********************************************************************** 10280003
         SPACE 2                                                        10290003
TMPRTURN EQU   *                                                        10300003
         L     R1,TPLPTR      GET TPL ADDRESS            @ZA07137       10302001
         L     R1,TPLECT-TPL(R1)  GET ECT ADDRESS        @ZA07137       10304001
         NI    ECTSWS2-ECT(R1),XFF-ECTTABND RESET NO DEQ FLAG@ZA07137   10306001
         MVI   TSTDCB,N0      INDICATE DCB MAY BE FREED.                10310003
         BAL   R11,FROMLDR    CLOSE AND FREE THE DCB.                   10320003
         SPACE                                                          10330003
         L     R1,INBUF       R1=ADDR OF BUFFER                         10340003
         LTR   R1,R1          IS INBUF ALREADY ZERO                     10350003
         BZ    RET1           YES.RETURN.                               10360003
         LH    R0,N0(,R1)     R0=LENGTH OF BUFFER FOR FREEMAIN.         10370003
         FREEMAIN RC,LV=(0),SP=1,A=(1) FREE THE BUFFER.                 10380003
         LTR   R15,R15        WAS A NON ZERO RETURN CODE RECEIVED       10390003
         BZ    FREDCBOK       OK CONTINUE                               10400003
         BAL   R11,FREERROR   PROCESS THE SVC ERROR                     10410003
         SPACE 2                                                        10420003
FREDCBOK EQU   *              FREEMAIN WAS OK CONTINUE                  10430003
         XC    INBUF(L'INBUF),INBUF CLEAR INBUF.                        10440003
         SPACE 2                                                        10450003
RET1     EQU   *                                                        10460003
         IKJRLSA TSTANSPL     RELEASE THE NEW PDL                       10470003
         XC    TSTANSPL(X4),TSTANSPL  ZERO TEST ANSWER PLACE            10480003
         SPACE 2                                                        10490003
BLOW2LOC EQU   *                                                        10500003
         L     R2,TSTTCB      TCB ADDRESS FOR DAIR LIST                 10510003
         MVC   INTDAIRB(LEN2C),DAIR2C UNALLOC TCB.                      10520003
         ST    R2,INTDAIRB+(DA2CTCB-DAPB2C) TCB TO LIST.                10530003
         BAL   R11,DAIR1      BRANCH TO UNALLOCATE.                     10540003
         SPACE 2                                                        10550003
         TCLEARQ  INPUT                                                 10560003
         SPACE 2                                                        10570003
         MVC   INSTCKPL(L'TSTUPT+L'TSTECT+L'TSTCPECB),PARMLIST          10580003
*                             MOVE IN STANDARD PARM LIST.               10590003
         MVC   INSTCKPB(STACKLEN),STACKLST MOVE LIST FORM OF STACK.     10600003
         STACK PARM=INSTCKPB,DELETE=ALL,MF=(E,INSTCKPL)                X10610003
                              FLUSH THE STACK.                          10620003
         SPACE 2                                                        10630003
         L     R2,TSTTCB      CHANGE TEST'S TCBTRN FIELD TO '0'         10640003
         SR    R3,R3          ZERO.                                     10650003
         IKJEGS9G TRN,TCBADDR=(R2),VALUE=(R3),MF=(E,INTSVCPL)           10660003
*****                                                                   10670003
*****    RETURN CODE CHECK IGNORED.                                     10680003
*****                                                                   10690003
         SPACE 2                                                        10700003
BLOW1LOC EQU   *                                                        10710003
         C     R3,TPLCTCB          WAS A SUBTASK ATTACHED ?             10710503
         BE    NODETACH            NO, SKIP ABEND COMPLETION PROCESSING 10711003
         L     R1,ECBTMPA          DID TMP SEE ATTN?           @ZA06995 10711101
         TM    N0(R1),X'40'        EXAMINE ECB TO FIND OUT     @ZA06995 10711201
         BO    NODETACH            YES-SKIP ESTAI POSTING      @ZA06995 10711301
*                                                              @ZA02373 10711503
         L     R1,ECBTERM          GET ADDR OF PROB PGM ECB    @ZA02373 10711703
         TM    INITFLG,X'10'       IN INIT?                    @ZA18794 10711801
         BZ    NOTINIT             NO,GO TO NOT INIT.          @ZA18794 10711901
         OI    0(R1),X'40'         PSEUDO POST PROB PGM ECB    @ZA18794 10712501
         XC    INITFLG,INITFLG     RESET INIT FLAG             @ZA18794 10712601
NOTINIT  TM    0(R1),X40           HAS IT BEEN POSTED COMPLETE @ZA02373 10712701
*                                                              @ZA18794 10712801
         BO    NODETACH            YES, DON'T POST AGAIN       @ZA02373 10712901
         SR    R0,R0               NO PARMLIST FOR POST        @ZA02373 10713401
         L     R1,TPLNECB          ABEND ECB                   @ZA02373 10713503
         POST  (R1)                WAKE UP TMP ESTAI (IKJEFT04)@ZA02373 10714003
*                                                                       10714503
*              AFTER WAKEING UP THE TMP ESTAI START ALL SUBTASKS        10715003
*                   TO ALLOW CONTINUATION OF THE ABEND AND AVOID        10715503
*                   A 13E ABEND                                         10716003
*              GO BACK TO MAIN WAIT AND WAIT FOR THE SUBTASK ECB        10716503
*                 (ECBTERM) TO BE POSTED INDICATING TASK COMPLETE       10717003
*                                                                       10717503
         STATUS START              START ALL SUBTASKS          @ZA02373 10718003
         B     WAIT                WAIT FOR COMPLETION         @ZA02373 10718503
         SPACE 2                                                        10770003
NODETACH EQU *                                                          10770701
AARGHH   EQU   *                                                        10778401
         SPACE 2                                                        10790003
         LR    R1,R9          R1=TCOMTAB ADDR.                          10800003
         L     R0,TCOMTABL    R0=TCOMTAB LENGTH.                        10810003
         L     R6,X4(,R13)    RESTORE TMP'S SAVE AREA ADDRESS.          10820003
         FREEMAIN RC,SP=1,LV=(0),A=(1) FREE IT.                         10830003
         LTR   R15,R15        WAS A NON ZERO RETURN CODE RECEIVED       10840003
         BZ    FRET1          OK CONTINUE                               10850003
         BAL   R11,FREERROR   PROCESS THE SVC ERROR                     10860003
         SPACE 2                                                        10870003
FRET1    EQU   *              CONTINUE                                  10880003
         LTR   R8,R8          IS R8 = 0 (NO WORKAREA TO FREE)           10890003
         BZ    FRETCMOK       YES THEREFORE AVOID THE FREEMAIN          10900003
         LA    R0,INTWLEN     R0=LENGTH OF THE FREEMAIN                 10910003
         FREEMAIN RC,LV=(0),SP=1,A=(8) FREEMAIN ERROR                   10920003
         LTR   R15,R15        WAS THE FREEMAIN OK                       10930003
         BZ    FRETCMOK       OK CONTINUE                               10940003
         BAL   R11,FREERROR   OUPUT ERROR MSG                           10950003
         SPACE 2                                                        10960003
FRETCMOK EQU   *              FREEMAIN WAS OK CONTINUE                  10970003
         SPACE                                                          10980003
         LR    R13,R6         RESTORE TMP'S SAVE AREA ADDR              10990003
         RETURN (14,12),RC=4  RETURN TO TMP WITH RETURN CODE=4.         11000003
         EJECT                                                          11010003
*********************************************************************** 11020003
*                                                                     * 11030003
*        SUBROUTINE USED TO CLEAN-UP RESOURCES AFTER IKJEGLDR         * 11040003
*        PROCESSING.                                                  * 11050003
*                                                                     * 11060003
*        THIS SUBROUTINE IS USED TO CLEAN-UP ALL RESOURCES            * 11070003
*        ALLOCATED DURING IKJEGLDR PROCESSING.                        * 11080003
*                                                                     * 11090003
*        1.    IF THE TERMINAL WAS ALLOCATED FOR THE OS LOADER        * 11100003
*              PROCESSING, SYSTERM IS UNALLOCATED.                    * 11110003
*                                                                     * 11120003
*        2.    IF A DCB WAS OPENED PRIOR TO ATTACHING IKJEGLDR,       * 11130003
*              IT IS CLOSED AND THE POINTER TO IT IS ZEROED.          * 11140003
*                                                                     * 11150003
*********************************************************************** 11160003
         SPACE 2                                                        11170003
FROMLDR  EQU   *                                                        11180003
         TM    TERMDD,XFF     Q. DOES TERM DD GET UNALLOCATED.          11190003
         BZ    SKIP4          NO. NEVER ALLOCATED.                      11200003
         MVC   INTDAIRB(LEN2C),DAIR2C UNALLOC BY DDNAME.                11210003
         MVC   INTDAIRB+DA2CDDN-DAPB2C(L'TERMDD),TERMDD MOVE IN         11220003
*                             THE DDNAME.                               11230003
         MVI   INTDAIRB+DA2CFLG-DAPB2C+X1,X1 CODE TO UNALLOC BY         11240003
*                             DDNAME.                                   11250003
         LR    R2,R11         SAVE LINK REGISTER.                       11260003
         BAL   R11,DAIR1      BRANCH TO UNALLOCATE.                     11270003
         LR    R11,R2         RESTORE THE LINK REGISTER.                11280003
CLOSE    EQU   *                                                        11290003
SKIP4    EQU   *                                                        11300003
         L     R4,TSTDCB      GET THE DCB ADDRESS - 4                   11310003
         LTR   R4,R4          DID WE GO THRU THE 'ATTACH1' CODE         11320003
         BCR   NEG+Z,R11      RETURN UNLESS POSITIVE AND NON-ZERO       11330003
         LA    R4,N4(R4)      GET THE DCB ADDRESS.                      11340003
         USING IHADCB,R4      ESTABLISH ADDRESSABILITY TO DCB.          11350003
         TM    DCBOFLGS,DCBOFOPN HAS THE DCB BEEN OPENED                11360003
         BZ    NOCLOSE        THE DCB IS NOT OPEN                       11370003
         CLOSE ((R4)),MF=(E,INTCLOSL) CLOSE DCB                         11380003
         DROP  R4                                                       11390003
         SPACE 2                                                        11400003
NOCLOSE  EQU   *              *                                         11410003
         BR    R11            RETURN TO CALLER.                         11420003
         EJECT                                                          11430003
*********************************************************************** 11440003
*                                                                     * 11450003
*        THIS CODE OUTPUTS THE MESSAGE 'MEMBER XXX NOT IN DATA        * 11460003
*        SET YYY'.  IKJEGIO IS CALLED TO PUT  THE MESSAGE. CONTROL    * 11470003
*        IKJEGIO IS CALLED TO PUT THE MESSAGE.  CONTROL IS THEN       * 11480003
*        IS THEN RETURNED TO THE TMP.                                 * 11490003
*********************************************************************** 11500003
         SPACE 2                                                        11510003
BADMEM   EQU   *              BAD MEMBER MSG                            11520003
         L     R6,OUTBUF      R6=ADDR OF OUTPIT BUFFER                  11530003
         LA    R2,X5(R6)      R2= WHERE INSERT 2 GOES                   11540003
         MVI   N0(R6),BLANK   SET UP TO BLANK OUTPUT BUFFER    @ZA05807 11541001
         MVC   N1(OUTBUFRL-1,R6),N0(R6) BLANK ENTIRE BUFFER    @ZA05807 11543001
         SR    R4,R4          CLEAR                                     11560003
         IC    R4,DSNAME+N13  GET THE LENGTH OF MEMBER NAME             11570003
         L     R3,DSNAME+X8   POINTER TO ACTUAL DSNAME                  11580003
         LA    R1,X5(R4)      R1= TOTAL LENGTH FOR IKJEGIO              11590003
         XC    N0(4,R6),N0(R6)    ZERO INSERT LENGTH FIELD     @ZA05807 11592001
         STH   R1,N0(R6)      PLACE LENGTH INTO OUTPUT BUFFER           11600003
         AR    R2,R4          R2= LOCATION IN OUTBUF OF SECOND INSERT   11610003
         BCTR  R4,R0          DECREMENT FOR EXECUTE                     11620003
         EX    R4,MOVEMEMB    MOVE MEMBER NAME TO MESSAGE.              11630003
         LA    R3,INTSTDSN    ACTUAL DATA SET NAME.                     11640003
         L     R4,TPLUPT      ADDRESSABILITY TO UPT .          @ZA05807 11645001
         SR    R5,R5          ZERO FOR INSERT CHAR.                     11660003
         IC    R5,UPTPREFL-UPT(,R4)  GET THE LENGTH OF USERID. @ZA05807 11665001
         BCTR  R5,R0          MINUS ONE.                                11680003
         EX    R5,CLCID       COMPARE FOR USERID PREFIX.                11690003
         BNE   MOVEDSN        MOVE IN THE DATA SET NAME.                11700003
         LA    R3,X2(R5,R3)   UP POINTER PAST USERID.          @ZA05807 11705001
MOVEDSN  MVC   X4(N35,R2),N0(R3) MOVE MOST OF THE DATA SET NAME.        11720003
         LA    R1,N40         R1= LENGTH OF INSERT                      11730003
         XC    N0(4,R2),N0(R2) ZERO SECOND INSERT LENGTH FIELD @ZA05807 11732001
         STH   R1,N0(R2)      PLACE LENGTH INTO BUFFER                  11740003
         LA    R3,BADMEMNO    R3= BAD MEMBER MESSAGE NUMBER             11750003
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM ZERO IO PARAMETER LIST     11760003
         IKJEGSIO MSG,FIRST=(R3),INST11=(ADDR,(R6)),                   X11770003
               INST12=(ADDR,(2)),ID=INT15,MF=(E,TSTIOPRM)               11780003
         B     TMPRTURN       EXIT TO TMP                               11790003
         EJECT                                                          11800003
*********************************************************************** 11810003
*                                                                     * 11820003
*        DAIR SUBROUTINE.                                             * 11830003
*                                                                     * 11840003
*        THIS SUBROUTINE PROVIDES A COMMON INTERFACE TO THE DAIR      * 11850003
*        SERVICE ROUTINE.  THE SUBROUTINE ASSUMES THAT THE CALLER     * 11860003
*        HAS CONSTRUCTED THE APPROPRIATE DAIR PARAMETER BLOCK.        * 11870003
*        UPON RETURN FROM DAIR, THE RETURN CODE IS TESTED FOR         * 11880003
*        ZERO.  IF A NON-ZERO RETURN CODE IS RETURNED, THE DAIR       * 11890003
*        DIAGNOSTIC ROUTINE, IKJEGDDN, IS INVOKED TO BUILD THE        * 11900003
*        ERROR MESSAGE.                                               * 11910003
*                                                                     * 11920003
*********************************************************************** 11930003
         SPACE 2                                                        11940003
DAIR1    EQU   *                                                        11950003
         MVC   INTDAIRL(L'TSTUPT+L'TSTECT+L'TSTCPECB),PARMLIST MOVE     11960003
*                             IN SERVICE ROUTINE PARAMETER LIST.        11970003
         LA    R1,INTDAIRB    ADDRESS OF DAIR PARAMETER BLOCK.          11980003
         L     R0,TPLPSCB     PSCB TO SECOND PORTION.                   11990003
         STM   R0,R1,INTDAIRL+(DAPLPSCB-DAPL) PSCB,DAIR PARMS TO LIST.  12000003
         LINK  EP=IKJDAIR,ERRET=LINKDAIR,MF=(E,INTDAIRL) LINK TO DAIR.  12010003
         SPACE 2                                                        12020003
         LTR   R15,R15        TEST FOR SUCCESSFUL COMPLETION.           12030003
         BCR   8,R11          IF SUCCESSFUL, RETURN.                    12040003
         ST    R15,INTREGSV   SAVE RETURN CODE                          12050003
         LA    R1,INTDAIRL    R1= ADDR OF THE DAIR PARM LIST            12060003
         LA    R2,INTREGSV    R2= ADDR OF THE RETURN CODE               12070003
         LA    R3,ZEROS       R3= ADDR OF WORD OF ZEROS                 12080003
         LA    R4,HONES       R4= ADDR OF HALF WORD OF A ONE            12090003
         STM   R1,R4,EFF18PRM SETUP THE IKJEFF18 PARM LIST              12100003
         LINK  EP=IKJEFF18,ERRET=LINKEFF1,MF=(E,EFF18PRM) LINK TO EFF18 12110003
         LA    R3,TESTFAIL    R3= ADDR OF TEST FAILED                   12120003
         SR    R4,R4          ZERO R4 NO SECOND LEVEL                   12130003
         B     PUTRTURN       PRINT MESSAGE AND QUIT                    12140003
         EJECT                                                          12150003
*********************************************************************** 12160003
*                                                                     * 12170003
*        STAE RETRY ROUTINE.                                          * 12180003
*                                                                     * 12190003
*        DETERMINE IF THE ABEND WAS PREDICTED.  IF SO, DETACH ANY     * 12200003
*        SUB-TASK WHICH MAY EXIST AND WRITE THE PROPER DIAGNOSTIC.    * 12210003
*        OTHERWISE, WRITE AN 'UNPREDICTABLE ERROR' DIAGNOSTIC 2ND     * 12220003
*        LEVEL MESSAGE AND RETURN TO THE TMP.                         * 12230003
*                                                                     * 12240003
*********************************************************************** 12250003
         SPACE 2                                                        12262003
HOMEBASE EQU   *                                                        12271003
         USING *,R15          RETRY ROUTINE.                            12280003
         SPACE                                                          12289003
SETREGS  EQU   *              SET UP BASIC PROCESSING REGISTERS         12298003
         L     R2,CVTPTR      CVT POINTER                               12307003
         USING CVT,R2         ADDRESSABILITY TO CVT.                    12316003
         L     R3,CVTTCBP     NEW/CURRENT WORDS.                        12325003
         L     R4,X4(,R3)     CURRENT TCB.                              12334003
         USING TCB,R4         ADDRESSABILITY TO TCB.                    12343003
         L     R7,TCBNSTAE    SCB ADDRESS.                              12360003
         LM    R7,R10,N0(R7)  LINK , EXIT EP , TCOMTAB , PRB            12370003
         SPACE                                                          12380003
         DROP  R2,R4                                                    12390003
         L     R12,BASEAD     SETUP THE BASE REGISTER.                  12400003
         DROP  R15            RESET ORIGINAL ADDRESSABILITY             12410003
         USING IKJEGINT,R12   *                                         12420003
         L     R9,TCBTRN-TCB(,R4) ADDRESS OF TCOMTAB.                   12430003
         L     R13,REGSAVE1   RELOAD SAVE AREA ADDRESS.                 12440003
         L     R8,N0(,R13)    GET IKJEGINT WORKAREA ADDRESS.            12450003
         L     R10,TPLPTR     SETUP ADDRESSABILITY TO TPL               12460003
         B     TSTRTURN       OUT MSG AND EXIT TO TMP                   12470003
         EJECT                                                          12480003
**********************************************************************  12490003
*        ERROR HANDLER ROUTINES, FOR LINK FAILED, GETMAIN FAILED,       12500003
*        AND FREEMAIN FAILED.                                           12510003
**********************************************************************  12520003
         SPACE                                                          12530003
LINKPARS EQU   *              LINK TO PARSE FAILED                      12540003
         LA    R2,PARSENO     R2= NUMBER FOR PARSE IN STATIC TABLE      12550003
         B     LINKFAIL       OUTPUT THE ERROR MESSAGE                  12562003
         SPACE                                                          12570003
LINKEFF1 EQU   *              LINK TO IKJEFF18 FAILED                   12580003
         LA    R2,EFF18NO     R2= NUMBER FOR IKJEFF18 IN STATIC TABLE   12590003
         B     LINKFAIL       OUTPUT THE ERROR MESSAGE                  12600003
         SPACE                                                          12610003
LINKDEFL EQU   *              LINK TO IKJDFLT FAILED                    12620003
         LA    R2,DEFLTNO     R2= NUMBER FOR DEFAULT IN STATIC TABLE    12630003
         B     LINKFAIL       OUTPUT THE ERROR MESSAGE                  12640003
         SPACE                                                          12650003
LINKDAIR EQU   *              LINK TO DAIR FAILED                       12660003
         LA    R2,DAIRNO      R2= NUMBER FOR DAIR IN STATIC TABLE       12670003
         SPACE                                                          12680003
**********************************************************************  12690003
*        THIS IS THE LINK FAILED VERSION OF THE IKJEGSIO MACRO          12700003
**********************************************************************  12710003
         SPACE                                                          12720003
LINKFAIL EQU   *              LINKFAILED CALL TO IKJEGIO                12730003
         LR    R3,R15         R3= ADDRESS OF THE RETURN CODE            12740003
         LR    R4,R1          R4= ADDRESS OF THE ABEND CODE             12750003
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM ZERO IO PARM LIST          12760003
         IKJEGSIO SVCERR,SVC=6,ABENDRG=(R4),RC=(R3),INST11=(NUM,(R2)), X12770003
               ID=INT15,MF=(E,TSTIOPRM)  ISSUE MACRO TO CALL IKJEGIO    12780003
         LTR   R15,R15        WAS A NON ZERO RETURN CODE RECEIVED       12790003
         BNZ   TMPRTURN       YES THEREFORE EXIT TO TMP                 12800003
         B     TSTRTURN       OUTPUT THE ERROR AND EXIT TO TMP          12810003
         SPACE                                                          12820003
****                                                                    12830003
****     GETMAIN FAILED ERROR HANDLER PORTION OF IKJEGINT               12840003
****                                                                    12850003
         SPACE                                                          12860003
GETERROR EQU   *              A GETMAIN FAILED                          12870003
         LR    R3,R15         R3= THE RETURN CODE                       12880003
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM ZERO IO PARM LIST          12890003
         IKJEGSIO SVCERR,SVC=10,RC=(R3),ID=INT15,MF=(E,TSTIOPRM)        12900003
         LTR   R15,R15        WAS A NON ZERO RETURN CODE RECEIVED       12910003
         BNZ   TMPRTURN       YES THEREFORE EXIT TO TMP                 12920003
         B     TSTRTURN       OUTPUT THE ERROR AND EXIT TO TMP          12930003
****                                                                    12940003
****     FREEMAIN FAILED ERROR HANDLER PORTION OF IKJEGINT              12950003
****                                                                    12960003
         SPACE                                                          12970003
FREERROR EQU   *              A FREEMAIN FAILED                         12980003
         LR    R3,R15         R3= THE RETURN CODE                       12990003
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM ZERO IO PARM LIST          13000003
         IKJEGSIO SVCERR,SVC=10,RC=(R3),ID=INT15,MF=(E,TSTIOPRM)        13010003
         B     FREETABL(R15)  BRANCH ON RETURN CODE                     13020003
FREETABL EQU   *              TABLE FOR IO RETURN CODES                 13030003
         B     RETCALL        RC=0 RETURN TO WHERE FREEMAIN ISSUED      13040003
         B     RETCALL        RC=4 RETURN TO WHERE FREEMAIN ISSUED      13050003
         B     TSTRTURN       RC=8 THEREFORE EXIT TO TMP                13060003
         B     RETCALL        RC=12 RETURN TO WHERE FREEMAIN ISSUED     13070003
         B     TMPRTURN       RC=16 THEREFORE EXIT TO TMP               13080003
         B     TSTRTURN       RC=20 THEREFORE EXIT TO TMP               13090003
         B     TMPRTURN       RC=24 THEREFORE EXIT TO TMP               13100003
TSTRTURN EQU   *              TEST FAILED MESSAGE AND EXIT              13110003
         LA    R3,TESTFAIL    R3= NUMBER OF TEST FAILED                 13120003
         LA    R4,N0          R4= ZERO NO SECOND LEVEL                  13130003
         B     PUTRTURN       GO OUTPUT MESSAGE                         13140003
RETCALL  EQU   *              RETURN TO CALLER                          13150003
         BR    R11            RETURN TO WHERE THE FREEMAIN WAS ISSUED   13160003
****                                                                    13170003
****     ESTAE FAILED ERROR HANDLER PORTION OF IKJEGINT                 13180003
****                                                                    13190003
         SPACE                                                          13200003
ESTAERR  EQU   *              A ESTAE FAILED                            13210003
         LR    R3,R15         R3= THE RETURN CODE                       13220003
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM ZERO IO PARM LIST          13230003
         IKJEGSIO SVCERR,SVC=60,RC=(R3),ID=INT15,MF=(E,TSTIOPRM)        13240003
         LTR   R15,R15        WAS A NON ZERO RETURN CODE RECEIVED       13250003
         BNZ   TMPRTURN       YES THEREFORE EXIT TO TMP                 13260003
         LA    R3,TESTFAIL    R3= NUMBER OF TEST FAILED                 13270003
         LA    R4,N0          R4= ZERO NO SECOND LEVEL                  13280003
         B     PUTRTURN       OUTPUT THE ERROR AND EXIT TO TMP          13290003
****                                                                    13300003
****     SVC 97 FAILED OUTPUT BREAKPOINT ERROR MSG                      13310003
***                                                                     13320003
SVC97ERR EQU   *              SVC 97 NONZERO RETURN CODE                13330003
         LA    R2,N24         R2= 24 (ESTAE MACRO FAILURE RETURN CODE   13340003
         CR    R2,R15         IS THAT THE RETURN CODE FROM SVC 97       13343001
*                                                              @ZA05803 13346001
         BE    ESTAERR        YES THEREFORE HANDLE ERROR       @ZA05803 13350001
         LA    R3,TESTFAIL    R3= TEST FAILED MESSAGE                   13370003
         LA    R4,SVCFAIL     R4= SECOND LEVEL SVC ERROR                13380003
         EJECT                                                          13390003
**********************************************************************  13400003
*        THIS ROUTINE OUTPUT A MESSAGE AS INDICATED IN R3, AND R4       13410003
*        THAT IS FIRST AND SECOND LEVEL... (NO INSERTS).........        13420003
**********************************************************************  13430003
         SPACE                                                          13440003
PUTRTURN EQU   *              ISSUE MSG FROM OF IO                      13450003
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM ZERO IO PARM LIST          13460003
         IKJEGSIO MSG,FIRST=(R3),SECOND=(R4),ID=INT15,MF=(E,TSTIOPRM)   13470003
         SPACE                                                          13480003
****                                                                    13490003
****     WE ALWAYS EXIT THEREFORE RETURN CODES ARE IGNORED              13500003
****                                                                    13510003
         B     TMPRTURN                                                 13520003
         EJECT                                                          13530003
ADDCB    DCB   DSORG=PO,MACRF=(R) DEFINE A DCB.                         13540003
ADDCBLEN EQU   *-ADDCB        DCB LENGTH.                               13550003
         SPACE 5                                                        13560003
LFORM    OPEN  (,(INPUT)),MF=L OPEN LIST FORM.                          13570003
         SPACE 5                                                        13580003
CLFORM   CLOSE (CLFORM),MF=L  CLOSE LIST FORM.                          13590003
         SPACE 5                                                        13600003
         DS    0F             ALIGN ON WORD BOUNDARY.                   13610003
INTBLDLD DC    H'1'           NUMBER OF ENTRIES IN LIST.                13620003
         DC    H'58'          LENGTH OF DIRECTORY ENTRY.                13630003
         DC    CL8' '         MEMBER NAME.                              13640003
INTBLDLL EQU   *-INTBLDLD     LENGTH OF CONSTANT.                       13650003
ABENDCOD DC    CL16'SYSTEM CODE XXX '  FOR 2ND LEVEL MESSAGE.           13660003
         SPACE 5                                                        13670003
         DS    0F                                                       13680003
TCOMTABL DC    AL1(0)         SUBPOOL IDENTIFIER.                       13690003
         DC    AL3(TCOMLEN+OUTBUFRL+CONAREAL+CWORKLEN+REGSAVEL)         13700003
*                             LENGTH OF TCOMTAB, OUTPUT BUFFER,         13710003
*                             CONVERT WORKAREA, GENERAL PURPOSE         13720003
*                             WORKAREA, REGISTER SAVEAREAS FOR          13730003
*                             GETMAIN, AND GENERAL WORKAREA.            13740003
INTSVIBL DC    AL1(0)         SUBPOOL IDENTIFIER.                       13750003
         DC    AL3(12)        LENGTH OF CONTROL BLOCK FOR -             13760003
*                             +0 LINK FIELD                             13770003
*                             +4 TCB POINTER                            13780003
*                             +8 SVC INFORMATION BLOCK POINTER          13790003
LOAD     DC    C'LOAD    '    'LOAD' DEFAULT QUALIFIER.                 13800003
OBJECT   DC    C'OBJ     '    'OBJECT' DEFAULT QUALIFIER.               13810003
MNLADDR  DC    V(IKJEGMNL)    ADDRESS OF IKJEGMNL                       13820003
IOADDR   DC    V(IKJEGIO)     ADDRESS OF THE IO MODULE                  13830003
CVTBDSTA DC    V(IKJEGCVT)    ADDR OF IKJEGCVT                          13840003
         DC    V(IKJEGBLD)    ADDR OF IKJEGBLD                          13850003
         DC    V(IKJEGSTA)    ADDRESS OF IKJEGSTA FOR TCOMTAB           13860003
SRHRTVCN DC    V(IKJEGSRH)    ADDRESS OF IKJEGSRH                       13870003
OPCODV   DC    V(IKJEGCOP)    ADDR OF THE 360 OP CODE TABLE (1 BYTE)    13880003
         DC    V(IKJEGCD2)    ADDR OF 370 OP CODE TABLE (2 BYTE)        13890003
HIGHBIT  DC    X'80000000'    'OR' IN HIGH BIT.                         13900003
POST7F   DC    X'3F000000'    POST STAI EXIT WITH A '7F'                13910003
ZEROS    DC    X'00000000'    WORD OF ZEROS                             13920003
BASEAD   DC    A(IKJEGINT)    BASE ADDRESS FOR THIS MODULE.             13930003
CORE104  DC    AL1(0),AL3(104)  104 BYTE STAE W.A.                      13940003
INTRC004 DC    H'4'           RETURN CODE = 4.                          13950003
INTRC008 DC    H'8'           RETURN CODE = 8.                          13960003
INTRC016 DC    H'16'          RETURN CODE = 16.                         13970003
INTRC024 DC    H'24'          RETURN CODE = 24.                         13980003
HONES    DC    H'1'           HALF WORD OF A ONE                        13990003
PCLADDR  DC    V(IKJEGYNT)    *                                         14000003
SP1      DC    X'01000000'    SUB-POOL ONE INDICATOR.                   14010003
SVC      SVC   TESTSVC        TEST SVC                                  14020003
         SVC   EXITSVC        EXIT SVC                                  14030003
         EJECT                                                          14040003
         IKJDAP08                                                       14050003
DA08LEN  EQU   *              DSECT LENGTH                              14060003
IKJEGINT CSECT                                                          14070003
DAIR08   DC    (DA08LEN-DAPB08)X'0'  INITIALIZE BEFORE ORGS             14080003
         ORG   DA08CD-DAPB08+DAIR08    *                                14090003
         DC    XL2'0008'      CODE                                      14100003
         ORG   DA08DDN-DAPB08+DAIR08   *                                14110003
         DC    CL8' '         DDNAME                                    14120003
         ORG   DA08UNIT-DAPB08+DAIR08  *                                14130003
         DC    CL8' '         UNITNAME                                  14140003
         ORG   DA08SER-DAPB08+DAIR08   *                                14150003
         DC    CL8' '         VOLUME SERIAL NUMBER                      14160003
         ORG   DA08MNM-DAPB08+DAIR08   *                                14170003
         DC    CL8' '         MEMBER NAME                               14180003
         ORG   DA08PSWD-DAPB08+DAIR08  *                                14190003
         DC    CL8' '         PASSWORD                                  14200003
         ORG   DA08DSP1-DAPB08+DAIR08  *                                14210003
         DC    AL1(DA08SHR)   DISP=SHR                                  14220003
         ORG   DA08LEN-DAPB08+DAIR08   *                                14230003
LEN08    EQU   *-DAIR08       *                                         14240003
         EJECT                                                          14250003
         IKJDAP1C                                                       14260003
DA1CLEN  EQU   *              DSECT LENGTH                              14270003
IKJEGINT CSECT                                                          14280003
DAIR1C   DC    (DA1CLEN-DAPB1C)X'0'  INITIALIZE BEFORE ORGS             14290003
         ORG   DA1CCD-DAPB1C+DAIR1C    *                                14300003
         DC    XL2'001C'      CODE                                      14310003
         ORG   DA1CDDN-DAPB1C+DAIR1C   *                                14320003
         DC    CL8' '         DDNAME                                    14330003
         ORG   DA1CLEN-DAPB1C+DAIR1C   *                                14340003
LEN1C    EQU   *-DAIR1C       *                                         14350003
         EJECT                                                          14360003
         IKJDAP2C                                                       14370003
DA2CLEN  EQU   *              DSECT LENGTH                              14380003
IKJEGINT CSECT                                                          14390003
DAIR2C   DC    (DA2CLEN-DAPB2C)X'0'  INITIALIZE BEFORE ORGS             14400003
         ORG   DA2CCD-DAPB2C+DAIR2C    *                                14410003
         DC    XL2'002C'      CODE                                      14420003
         ORG   DA2CLEN-DAPB2C+DAIR2C   *                                14430003
LEN2C    EQU   *-DAIR2C       *                                         14440003
         EJECT                                                          14450003
ABENDLST DS    0F                                                       14460003
         DC    AL1(99)        ABEND KEY                                 14470003
         DC    AL3(BLOW5)     LINK TO PARSE FAILURE.                    14480003
         SPACE 1                                                        14490003
         DC    AL1(95)        ABEND KEY                                 14500003
         DC    AL3(BLOW6)     ATTACH IKJEGLDR FAILURE.                  14510003
         SPACE 1                                                        14520003
         DC    XL1'FF'        END-OF-LIST FLAG.                         14530003
         SPACE 2                                                        14540003
INTSPL   IKJEGSPL RTRY=HOMEBASE,ABNTB=ABENDLST,MODNM=IKJEGINT,         *14550003
               TNM=INITIALIZATION                                       14560003
         SPACE 2                                                        14570003
TRTABLE  DC    C'0123456789'  HEX-CHARACTER CONVERSION TABLE.           14580003
         DC    C'ABCDEF'      *                                         14590003
TEMPNAME DC    A(*+4),C'TEMPNAME' THIS IS THE MEMBER NAME IF NONE .     14600003
TEST     DC    CL8'TEST'      TEST CONSTANT                             14610003
ABEND    DC    X'000D'        ABEND CONSTANT                            14620003
         SPACE 2                                                        14630003
MEMMVC   MVC   X4(*-*,R5),N0(R6)  *                                     14640003
DSNMVC   MVC   INTSTDSN(*-*),N0(R2)  *                                  14650003
MEMMOVE  MVC   INTDAIRB+(DA08MNM-DAPB08)(*-*),N0(R4)  *                 14660003
MOVEPASS MVC   INTDAIRB+(DA08PSWD-DAPB08)(*-*),N0(R4) MOVE THE PASSWORD 14670003
QUALCHK  CLC   X1(*-*,R5),N0(R2) CHECK FOR EQUAL QUALIFIERS      A43321 14680003
CLCID    CLC   N0(*-*,R3),UPTPREFX-UPT(R4) COMPARE PREFIXES    @ZA05807 14685001
MOVEMEMB MVC   X4(*-*,R6),N0(R3)  MOVE MEMBER NAME TO MESSAGE           14700003
         SPACE 5                                                        14710003
STACKLST STACK DELETE=ALL,MF=L       LIST FORM.                         14720003
STACKLEN EQU   *-STACKLST     LENGTH OF STACK LIST.                     14730003
         SPACE 5                                                        14740003
ATTCHLFM ATTACH EP=IKJEGLDR,SF=L                                        14750003
ATTCHLLN EQU   *-ATTCHLFM                                               14760003
         EJECT                                                          14770003
IKJEGYNT IKJPARM                                                        14780003
DSNAME   IKJPOSIT DSNAME,PROMPT='DSNAME'                                14790003
STRING   IKJPOSIT QSTRING                                               14800003
LOADOBJ  IKJKEYWD DEFAULT='LOAD'                                        14810003
         IKJNAME 'LOAD'                                                 14820003
         IKJNAME 'OBJECT'                                               14830003
CPNOCP   IKJKEYWD DEFAULT='NOCP'                                        14840003
         IKJNAME 'CP'                                                   14850003
         IKJNAME 'NOCP'                                                 14860003
         IKJENDP                                                        14870003
         EJECT                                                          14880003
*              GENERAL EQUATES.                                         14890003
N0       EQU   0              DECIMAL 0                                 14900003
X0       EQU   0              HEXIDECIMAL 0                             14910003
X1       EQU   1              HEXIDECIMAL 1                             14920003
X2       EQU   2              HEXIDECIMAL 2                             14930003
X4       EQU   4              HEXIDECIMAL 4                             14940003
X5       EQU   5              HEXIDECIMAL 5                             14950003
X6       EQU   6              HEXIDECIMAL 6                             14960003
X8       EQU   8              HEXIDECIMAL 8                             14970003
N4       EQU   4              DECIMAL FOUR                              14980003
N12      EQU   12             TWELVE                                    14990003
N13      EQU   13             THIRTEEN.                                 15000003
N16      EQU   16             SIXTEEN.                                  15010003
N20      EQU   20             TWENTY                                    15020003
N24      EQU   24             TWENTY FOUR                               15030003
N28      EQU   28             TWENTY EIGHT                              15040003
N35      EQU   35             THIRTY FIVE.                              15050003
N39      EQU   39             THIRTY NINE                               15060003
N40      EQU   40             FOURTY                                    15070003
N64      EQU   64             SIXTY FOUR.                               15080003
N72      EQU   72             SEVENTY TWO.                              15090003
N100     EQU   100            ONE HUNDRED (DCB GETMAIN LENGTH)          15100003
X40      EQU   X'40'          HEXIDECIMAL 40                            15110003
X80      EQU   X'80'          HEXIDECIMAL 80                            15120003
XFF      EQU   X'FF'          HEXIDECIMAL FF                            15130003
* --- * --- * --- * --- * --- * --- * --- * --- * --- * --- *           15140003
TESTSVC  EQU   97             TEST'S SVC                                15150003
EXITSVC  EQU   3              EXIT SVC NUMBER                           15160003
* --- * --- * --- * --- * --- * --- * --- * --- * --- * --- *           15170003
PASSWORD EQU   DSNAME+16      POINTER,LEN,FLGS,RES                      15180003
INDSNPER EQU   C'.'           CHARACTER PERIOD.                  A43321 15190003
BLANK    EQU   C' '           THIS IS A BLANK (X'40').                  15200003
LOADON   EQU   1                                                        15210003
PRESENT  EQU   X'80'          PRESENT -- NOT ABSENT                     15220003
PS       EQU   X'40'          PHYSICAL SEQUENTIAL                       15230003
OBJON    EQU   2              INDICATES OBJECT                          15240003
Z        EQU   8              ZERO CONDITION CODE                       15250003
NEG      EQU   4              NEGATIVE CONDITION.                       15260003
X44      EQU   X'44'          HEXIDECIMAL 44.                           15270003
FULLQUAL EQU   B'01000000'    BIT TO INDICATE 'FULLY-QUALIFIED'.        15280003
         EJECT                                                          15290003
         TCOMTAB                                                        15300003
         EJECT                                                          15310003
         IKJDFPL                                                        15320003
         EJECT                                                          15330003
         IKJDFPB                                                 A43321 15340003
         EJECT                                                          15350003
         TSTCWORK                                                       15360003
         EJECT                                                          15370003
         DCBD  DSORG=PO,DEVD=DA                                         15380003
         EJECT                                                          15390003
INTWKARA DSECT                                                          15400003
INTPARSL DS    6F             PARSE SERVICE ROUTINE PARAMETER           15410003
*                             LIST.                                     15420003
INTRSVD1 DS    2F             RESERVED SPACE.                           15430003
         ORG   INTPARSL       ORIGIN TO BEGINNING OF WORK AREA.         15440003
INDFLTPL DS    4F             DEFAULT SERVICE ROUTINE PARAMETER         15450003
*                             LIST.                                     15460003
INDFLTPB DS    3F             DEFAULT SERVICE ROUTINE PARAMETER         15470003
*                             BLOCK.                                    15480003
         ORG   INTPARSL       ORIGIN TO BEGINNING OF WORK AREA.         15490003
INSTCKPL DS    4F             STACK SERVICE ROUTINE PARAMETER LIST      15500003
INSTCKPB DS    2F             STACK SERVICE ROUTINE PARAMETER BLOCK     15510003
         ORG   ,              ORIGIN TO RESTART WORK AREA.              15520003
INTRSVD2 DS    H              RESERVED SPACE.                           15530003
INDSNLEN DS    H              LENGTH OF DATA SET NAME.                  15540003
INTSTDSN DS    CL44           DATA SET NAME FROM TEST COMMAND.          15550003
INTFLGS1 DS    X              INITIALIZATION FLAGS.                     15560003
INTDSMEM EQU   X'80'          ALLOCATE TO MEMBER SPECIFIED ON           15570003
*                             THE TEST COMMAND.                         15580003
         ORG   INTPARSL       ORIGIN TO BEGINNING OF WORK AREA.         15590003
INTDAIRL DS    1F             DAIR SERVICE ROUTINE PARAMETER LIST       15600003
INTDAIR2 DS    1F             SECOND WORD OF DAIR LIST                  15610003
INTDAIR3 DS    3F             THIRD WORD OF DAIR LIST                   15620003
         ORG   ,              ORIGIN TO RESTART WORK AREA.              15630003
         DS    0F             ALIGN ON WORD BOUNDARY.                   15640003
INTDAIRB DS    (DA08LEN-DAPB08)X DAIR SERVICE ROUTINE PARAMETER         15650003
*                             BLOCK.                                    15660003
INTOPENL DS    F              OPEN PARAMETER LIST.                      15670003
INTCLOSL DS    F              CLOSE PARAMETER LIST.                     15680003
EFF18PRM DS    0F             ALSO  IKJEFF18 PARM LIST                  15690003
INTSVCPL DS    3F             SVC 97 PARAMETER LIST.                    15700003
INTATCHL DS    XL(ATTCHLLN)   ATTACH PARAMETER LIST FOR ATTACH.         15710003
INTREGSV DS    1F             SAVE AREA FOR RETURN CODES                15720003
INITFLG  DS    1F             INIT. FLAGS                   @ZA18794    15725001
INTWLEN  EQU   *-INTWKARA     LENGTH OF WORKAREA.                       15730003
         EJECT                                                          15740003
         IKJTPL                                                         15750003
         EJECT                                                          15760003
         IKJPSCB                                                        15770003
         EJECT                                                          15780003
         IKJTCB                                                         15790003
         EJECT                                                          15800003
         IKJECT                                                         15810003
         EJECT                                                          15820003
*        PARSE                                                          15830003
         IKJPPL                                                         15840003
         EJECT                                                          15850003
*        DAIR                                                           15860003
         IKJDAPL                                                        15870003
         EJECT                                                          15880003
         CVT   DSECT=YES                                                15890003
         EJECT                                                          15900003
         IKJRB                                                          15910003
         EJECT                                                          15920003
         IHAPDS                                                         15930003
         EJECT                                                          15940003
         IKJUPT                                                         15950003
         EJECT                                                          15960003
         IHACDE                                                         15970003
         EJECT                                                          15980003
         IKJEGSVQ                                                       15990003
         EJECT                                                          16000003
IKJEGINT CSECT                                                          16010003
PATCHSP  DC    50C'Z'         PATCH AREA.                               16020003
         END   IKJEGINT                                                 16050003
./  ADD  SSI=81730764,NAME=IKJEGIO
         TITLE 'IKJEGIO - I/O SERVICE MODULE FOR VS2-R2 OF TSO TEST    *00001000
                        '                                               00002000
         COPY IKJEGSIO                                                  00003000
IKJEGIO  CSECT ,                                                   0002 00004000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00005000
         BALR  @03,0                                               0002 00006000
@PSTART  LA    @07,4095(,@03)                                      0002 00007000
         LA    @08,4095(,@07)                                      0002 00008000
         USING @PSTART,@03                                         0002 00009000
         USING @PSTART+4095,@07                                    0002 00010000
         USING @PSTART+8190,@08                                    0002 00011000
         L     @00,@SIZDATD                                        0002 00012000
         GETMAIN  R,LV=(0)                                              00013000
         LR    @12,@01                                             0002 00014000
         USING @DATD,@12                                           0002 00015000
         ST    @13,@SA00001+4                                      0002 00016000
         LM    @00,@01,20(@13)                                     0002 00017000
         ST    @12,8(,@13)                                         0002 00018000
         LR    @13,@12                                             0002 00019000
         USING TCOMTAB,TCOMPTR         ESTABLISH BASE REGISTER FOR TCOM 00020000
*   RTNCODE=0;                      /* INITIALIZE THE RTN CODE-OK    */ 00021000
         SLR   RTNCODE,RTNCODE                                     0072 00022000
*   IOPARMS=PRMREG1;                /* STORE THE ADDRESS TO PARMS    */ 00023000
         ST    PRMREG1,IOPARMS                                     0073 00024000
*/********************************************************************/ 00025000
*/*                                                                  */ 00026000
*/*                D  (NO,,YES,TESTPARM)                           0074 00027000
*/*                   IS THERE AN ABEND IN PROCESS ?                 */ 00028000
*/*                                                                  */ 00029000
*/********************************************************************/ 00030000
*                                                                  0074 00031000
*   IF TSTFLGS4(4)='1'B|TSTFLGS4(5)='1'B|SIOMODID=16 THEN          0074 00032000
         TM    TSTFLGS4,B'00011000'                                0074 00033000
         BNZ   @RT00074                                            0074 00034000
         L     @14,IOPARMS                                         0074 00035000
         CLI   SIOMODID(@14),16                                    0074 00036000
         BE    @RT00074                                            0074 00037000
*     GO TO NOESTAE;                /* IF ON DON'T ISSUE ESTAE       */ 00038000
*/********************************************************************/ 00039000
*/*                                                                  */ 00040000
*/*                P  (,,ABEND,RETRY)                              0076 00041000
*/*                   ISSUE AN ESTAE MACRO                           */ 00042000
*/*                                                                  */ 00043000
*/********************************************************************/ 00044000
*                                                                  0076 00045000
*   PRMREG1=REGSAVE5;               /* PICK UP ADDRESS SAVE AREA     */ 00046000
         L     PRMREG1,REGSAVE5                                    0076 00047000
*   GENERATE(STM 0,14,0(1));        /* SAVE REGISTER INCASE RETRY    */ 00048000
         STM 0,14,0(1)                                                  00049000
*   ESTAEPRM='00'X;                 /* ZERO THE PARM LIST            */ 00050000
         XC    ESTAEPRM+1(15),ESTAEPRM+1                           0078 00051000
         MVI   ESTAEPRM,X'00'                                      0078 00052000
*   ESTAEADD=TSTSTAE;               /* PUT STA ADDRESS IN REGISTER   */ 00053000
         L     ESTAEADD,TSTSTAE                                    0079 00054000
*   GENERATE;                                                      0080 00055000
         ESTAE (2),CT,PARAM=IKJEGSPL,XCTL=NO,MF=(E,ESTAEPRM)            00056000
*   IF RTNCODE=0 THEN              /* SEE IF ESTAE WAS SUCCESSFUL   */ 00057000
         LTR   RTNCODE,RTNCODE                                     0081 00058000
         BZ    @RF00081                                            0081 00059000
*     DO;                                                          0082 00060000
*       GENERATE(STC  15,TSTESTRC); /* SAVE RETURN CODE FOR MAINL'E  */ 00061000
         STC  15,TSTESTRC                                               00062000
*       RTNCODE=24;                 /* INDICATE TO CALLER PROBLEM    */ 00063000
         LA    RTNCODE,24                                          0084 00064000
*       GO TO ENDIO;                /* RETURN TO CALLER              */ 00065000
         B     ENDIO                                               0085 00066000
*     END;                                                         0086 00067000
*                                                                  0086 00068000
*/********************************************************************/ 00069000
*/*                                                                  */ 00070000
*/*TESTPARM:       D  (NO,,YES,%CONT1)                             0087 00071000
*/*                   IS THE SERVICE REQ'T NUMBER WRONG ?            */ 00072000
*/*                S  (,END)                                       0087 00073000
*/*                   CALL MAG-DATA: CALL REQUESTED                0087 00074000
*/*                   ROUTINE DATA, SVCERR,MSG,PTGT                  */ 00075000
*/*%CONT1:         S  (,END)                                       0087 00076000
*/*                   CALL BADPARM: ISSUE BAD PARM MESSAGE           */ 00077000
*/*                                                                  */ 00078000
*/********************************************************************/ 00079000
*                                                                  0087 00080000
*NOESTAE:                                                          0087 00081000
*   MSGCSECT=ADDR(ATTACHIO);        /* GET ATTACH PARMS ADDR INTO  0087 00082000
*                                      REGISTER TO INCREASE EFF      */ 00083000
@RF00081 DS    0H                                                  0087 00084000
NOESTAE  L     MSGCSECT,@CA00152                                   0087 00085000
*   IF SIOTYPE=1 THEN               /* SEE IF REQUEST IS FOR DATA    */ 00086000
         L     @14,IOPARMS                                         0088 00087000
         CLI   SIOTYPE(@14),1                                      0088 00088000
         BNE   @RF00088                                            0088 00089000
*     CALL DATA;                    /* CALL DATA PROCESSOR IF SO     */ 00090000
         BAL   @14,DATA                                            0089 00091000
*   ELSE                                                           0090 00092000
*     IF SIOTYPE=4 THEN             /* SEE IF REQUEST IS FOR PTGT    */ 00093000
         B     @RC00088                                            0090 00094000
@RF00088 L     @14,IOPARMS                                         0090 00095000
         CLI   SIOTYPE(@14),4                                      0090 00096000
         BNE   @RF00090                                            0090 00097000
*       CALL PTGT;                  /* CALL PTGT PROCESSOR IF SO     */ 00098000
         BAL   @14,PTGT                                            0091 00099000
*     ELSE                                                         0092 00100000
*       IF SIOTYPE=2 THEN           /* SEE IF REQUEST IS FOR MSG     */ 00101000
         B     @RC00090                                            0092 00102000
@RF00090 L     @14,IOPARMS                                         0092 00103000
         CLI   SIOTYPE(@14),2                                      0092 00104000
         BNE   @RF00092                                            0092 00105000
*         CALL MSG;                 /* CALL MSG PROCESSOR IF SO      */ 00106000
         BAL   @14,MSG                                             0093 00107000
*       ELSE                                                       0094 00108000
*         IF SIOTYPE=3 THEN         /* SEE IF REQUEST IS FOR   SVCERR*/ 00109000
         B     @RC00092                                            0094 00110000
@RF00092 L     @14,IOPARMS                                         0094 00111000
         CLI   SIOTYPE(@14),3                                      0094 00112000
         BNE   @RF00094                                            0094 00113000
*           CALL SVCERR;            /* CALL SVCERR PROCESSOR IF SO   */ 00114000
         BAL   @14,SVCERR                                          0095 00115000
*         ELSE                      /* IF NO MATCH YET THEN ERROR    */ 00116000
*           CALL BADPARM;           /* SERVICE NUM IN ERROR BY CALL  */ 00117000
         B     @RC00094                                            0096 00118000
@RF00094 BAL   @14,BADPARM                                         0096 00119000
*/********************************************************************/ 00120000
*/*                                                                  */ 00121000
*/*END:            P  PREPARE FOR RETURN TO CALLER                   */ 00122000
*/*                R  RETURN TO CALLER                               */ 00123000
*/*                                                                  */ 00124000
*/********************************************************************/ 00125000
*                                                                  0097 00126000
*ENDIO:                                                            0097 00127000
*   IF TSTFLGS4(4)='1'B|TSTFLGS4(5)='1'B|SIOMODID=16 THEN       0097 00128000
@RC00094 DS    0H                                                  0097 00129000
@RC00092 DS    0H                                                  0097 00130000
@RC00090 DS    0H                                                  0097 00131000
@RC00088 DS    0H                                                  0097 00132000
ENDIO    TM    TSTFLGS4,B'00011000'                                0097 00133000
         BNO   @RT00097                                            0097 00134000
         L     @14,IOPARMS                                         0097 00135000
         CLI   SIOMODID(@14),16                                    0097 00136000
         BE    @RF00097                                            0097 00137000
@RT00097 DS    0H                                                  0098 00138000
*     DO;                                                          0098 00139000
*       RTNSAVE=RTNCODE;            /* TRANSFER RETURN CODE          */ 00140000
         LR    RTNSAVE,RTNCODE                                     0099 00141000
*       GENERATE(ESTAE  0);         /* REMOVE ESTAE                  */ 00142000
         ESTAE  0                                                       00143000
*       RTNCODE=RTNSAVE;            /* TRANSFER RETURN CODE          */ 00144000
         LR    RTNCODE,RTNSAVE                                     0101 00145000
*     END;                                                         0102 00146000
*   RETURN CODE(RTNCODE);           /* RETURN TO CALLING TEST MOD    */ 00147000
@RF00097 LR    @06,@15                                             0103 00148000
         L     @13,4(,@13)                                         0103 00149000
         L     @00,@SIZDATD                                        0103 00150000
         LR    @01,@12                                             0103 00151000
         FREEMAIN R,LV=(0),A=(1)                                        00152000
         LR    @15,@06                                             0103 00153000
         L     @14,12(,@13)                                        0103 00154000
         LM    @00,@12,20(@13)                                     0103 00155000
         BR    @14                                                 0103 00156000
*                                                                  0104 00157000
*/********************************************************************/ 00158000
*/*                                                                  */ 00159000
*/*    THE FOLLOWING PROCEDURE IS THE RETRY ROUTINE.                 */ 00160000
*/*    IT WILL BE INVOKED IF THE MODULE PROGRAM CHECKS               */ 00161000
*/*    THE PRIMARY FUNCTIONS ARE:                                    */ 00162000
*/*                                                                  */ 00163000
*/*        1.  REESTABLISH MODULE ADDRESSABILITY                     */ 00164000
*/*        2.  REMOVE SCB AND SET THE RETURN CODE TO 20              */ 00165000
*/*                                                                  */ 00166000
*/********************************************************************/ 00167000
*/********************************************************************/ 00168000
*/*                                                                  */ 00169000
*/*RETRY:          P  TURN ON RETRY SW ISSUE ESTAE ZERO & RTNCODE=20 */ 00170000
*/*                R  RETURN TO CALLER                               */ 00171000
*/*                                                                  */ 00172000
*/********************************************************************/ 00173000
*                                                                  0104 00174000
*RETRY:                                                            0104 00175000
*   PROCEDURE OPTIONS(NOSAVEAREA,DONTSAVE);                        0104 00176000
*                                                                  0104 00177000
RETRY    DS    0H                                                  0105 00178000
*/********************************************************************/ 00179000
*/*                                                                  */ 00180000
*/* THE FOLLOWING GENERATE SECTION WILL REGAIN MODULE ADDRESSABILITY */ 00181000
*/*                                                                  */ 00182000
*/********************************************************************/ 00183000
*                                                                  0105 00184000
*   GENERATE;                                                      0105 00185000
         L     4,16                    PICK UP CVT PTR                  00186000
         USING CVTDSECT,4              ESTABLISH ADDRESSABILITY         00187000
         L     4,CVTTCBP               PICK UP TCB ADDRESS              00188000
         L     4,4(4)                  CURRENT TCB PTR                  00189000
         DROP  4                                                        00190000
         USING TCB,4                   ESTABLISH ADDRESSABILITY         00191000
         L     9,TCBTRN                PICK UP ADDRESS OF TCOMTAB       00192000
         OI    TSTFLGS4,B'00001000'    TURN ON RETRY SWITCH             00193000
         L     1,REGSAVE5              PICK UP REG SAVE AREA ADDR       00194000
         LM    0,14,0(1)               RESTORE ORIGINAL REGISTERS       00195000
         DROP  4                                                        00196000
*   RTNCODE=20;                     /* SET THE RETURN CODE - RETRY   */ 00197000
         LA    RTNCODE,20                                          0106 00198000
*   TSTFLGS4(5)='0'B;               /* TURN OFF THE RETRY BIT        */ 00199000
         NI    TSTFLGS4,B'11110111'                                0107 00200000
*   RETURN TO ENDIO CODE(RTNCODE);  /* GO TO THE IO EXIT ROUTINE     */ 00201000
         LA    @14,ENDIO                                           0108 00202000
@EL00002 DS    0H                                                  0108 00203000
@EF00002 DS    0H                                                  0108 00204000
@ER00002 BR    @14                                                 0108 00205000
*   END RETRY;                                                     0109 00206000
*                                                                  0110 00207000
*/********************************************************************/ 00208000
*/*                                                                  */ 00209000
*/*    THE FOLLOWING PROCEDURE IS THE MESSAGE ROUTINE.               */ 00210000
*/*    IT WILL BE INVOKED IF THE USERS HAS REQUESTED 'MSG' SERVICE.  */ 00211000
*/*                                                                  */ 00212000
*/*        1.  DETERMINE WHETHER THE USER HAS REQUESTED ONE          */ 00213000
*/*            OR TWO LEVEL MESSAGE BE ISSUED.                       */ 00214000
*/*        2.  FIND THE MESSAGE AND PREPARE IT FOR ISSUANCE          */ 00215000
*/*                                                                  */ 00216000
*/********************************************************************/ 00217000
*/********************************************************************/ 00218000
*/*                                                                  */ 00219000
*/*MSGROUT:        E  MESSAGE ROUTINE                                */ 00220000
*/*                                                                  */ 00221000
*/********************************************************************/ 00222000
*                                                                  0110 00223000
*MSG:                                                              0110 00224000
*   PROCEDURE;                                                     0110 00225000
*                                                                  0110 00226000
MSG      STM   @14,@12,@SA00003                                    0110 00227000
*/********************************************************************/ 00228000
*/*                                                                  */ 00229000
*/*                P  FIND AND PREPARE FIRST LEVEL MESSAGE           */ 00230000
*/*                S  CALL BADPARM: IF ERROR IN PARMS                */ 00231000
*/*                                                                  */ 00232000
*/********************************************************************/ 00233000
*                                                                  0111 00234000
*   IF SIO1STMS>0&SIO1STMS<100 THEN /* TEST FOR MSG BEING IN 1ST     */ 00235000
         L     @14,IOPARMS                                         0111 00236000
         L     @14,SIO1STMS(,@14)                                  0111 00237000
         LTR   @14,@14                                             0111 00238000
         BNP   @RF00111                                            0111 00239000
         CH    @14,@CH00256                                        0111 00240000
         BNL   @RF00111                                            0111 00241000
*     DO;                                                          0112 00242000
*       INDXTAB=MSG99PTR;           /* TABLE IF SO SET UP ADDRESS    */ 00243000
         L     @06,MSG99PTR(,MSGCSECT)                             0113 00244000
         ST    @06,INDXTAB                                         0113 00245000
*       IF AMTINDX<SIO1STMS THEN    /* LOOK AT ACTUAL TAB LEN FOR    */ 00246000
         C     @14,AMTINDX(,@06)                                   0114 00247000
         BNH   @RF00114                                            0114 00248000
*         DO;                       /* POSSIBLE BAD NUMBER PASSED    */ 00249000
*           CALL BADPARM;           /* IF MSG NUM EXCEEDS LEN-ERROR  */ 00250000
         BAL   @14,BADPARM                                         0116 00251000
*           GO TO EXITMSG;          /* BRANCH TO END OF PROCEDURE    */ 00252000
         B     EXITMSG                                             0117 00253000
*         END;                                                     0118 00254000
*     END;                                                         0119 00255000
*   ELSE                                                           0120 00256000
*     IF SIO1STMS>0&SIO1STMS<200 THEN/* TEST FOR MSG IN OTH TB       */ 00257000
         B     @RC00111                                            0120 00258000
@RF00111 L     @14,IOPARMS                                         0120 00259000
         L     @14,SIO1STMS(,@14)                                  0120 00260000
         LTR   @14,@14                                             0120 00261000
         BNP   @RF00120                                            0120 00262000
         CH    @14,@CH00258                                        0120 00263000
         BNL   @RF00120                                            0120 00264000
*       DO;                                                        0121 00265000
*         INDXTAB=MSG199PT;         /* TABLE IF SO SET UP ADDRESS    */ 00266000
         L     @06,MSG199PT(,MSGCSECT)                             0122 00267000
         ST    @06,INDXTAB                                         0122 00268000
*         IF AMTINDX<SIO1STMS THEN  /* LOOK AT ACTUAL TAB LEN FOR    */ 00269000
         C     @14,AMTINDX(,@06)                                   0123 00270000
         BNH   @RF00123                                            0123 00271000
*           DO;                     /* POSSIBLE BAD NUMBER PASSED    */ 00272000
*             CALL BADPARM;         /* IF MSG NUM EXCEEDS LEN-ERROR  */ 00273000
         BAL   @14,BADPARM                                         0125 00274000
*             GO TO EXITMSG;        /* BRANCH TO END OF PROCEDURE    */ 00275000
         B     EXITMSG                                             0126 00276000
*           END;                                                   0127 00277000
*         SIO1STMS=SIO1STMS-99;     /* ADJUST TO TABLE VALUES        */ 00278000
@RF00123 L     @14,IOPARMS                                         0128 00279000
         L     @06,SIO1STMS(,@14)                                  0128 00280000
         SH    @06,@CH00259                                        0128 00281000
         ST    @06,SIO1STMS(,@14)                                  0128 00282000
*       END;                                                       0129 00283000
*     ELSE                                                         0130 00284000
*       DO;                                                        0130 00285000
         B     @RC00120                                            0130 00286000
@RF00120 DS    0H                                                  0131 00287000
*         CALL BADPARM;             /* IF MSG NOT IN TABLE ERROR     */ 00288000
         BAL   @14,BADPARM                                         0131 00289000
*         GO TO EXITMSG;            /* BRANCH TO END OF PROCEDURE    */ 00290000
         B     EXITMSG                                             0132 00291000
*       END;                                                       0133 00292000
*   MSGPTR=INDXPTR(SIO1STMS);       /* ESTAB. ADDRESSABILITY TO MSG  */ 00293000
@RC00120 DS    0H                                                  0134 00294000
@RC00111 L     @14,IOPARMS                                         0134 00295000
         L     @14,SIO1STMS(,@14)                                  0134 00296000
         SLA   @14,2                                               0134 00297000
         L     @06,INDXTAB                                         0134 00298000
         L     @14,INDXPTR-4(@14,@06)                              0134 00299000
         ST    @14,MSGPTR                                          0134 00300000
*   IF INDISP(1)='FF'X THEN         /* TEST IF NULL ENTRY            */ 00301000
         CLI   INDISP(@14),255                                     0135 00302000
         BNE   @RF00135                                            0135 00303000
*     DO;                                                          0136 00304000
*       CALL BADPARM;               /* CALL FOR ERROR PROC BAD PRMS  */ 00305000
         BAL   @14,BADPARM                                         0137 00306000
*       GO TO EXITMSG;              /* BRANCH TO EXIT ROUTINE        */ 00307000
         B     EXITMSG                                             0138 00308000
*     END;                                                         0139 00309000
*   MESSAGE(1)=LOCALMSG;            /* MOVE MESSAGE INTO MYWK AREA   */ 00310000
@RF00135 MVI   MESSAGE+93,C' '                                     0140 00311000
         MVC   MESSAGE+94(10),MESSAGE+93                           0140 00312000
         L     @14,MSGPTR                                          0140 00313000
         MVC   MESSAGE(93),LOCALMSG(@14)                           0140 00314000
*   SIO1STMS=ADDR(MESSAGE(1));      /* STORE ADDRESS OF MSG IN P.L.  */ 00315000
         L     @14,IOPARMS                                         0141 00316000
         LA    @06,MESSAGE                                         0141 00317000
         ST    @06,SIO1STMS(,@14)                                  0141 00318000
*/********************************************************************/ 00319000
*/*                                                                  */ 00320000
*/*                P  PREPARE TO PROCESS FIRST LEVEL INSERTS         */ 00321000
*/*                                                                  */ 00322000
*/********************************************************************/ 00323000
*                                                                  0142 00324000
*   LEV=1;                          /* INDICATE THAT THIS IS 1ST LV  */ 00325000
         MVI   LEV,X'01'                                           0142 00326000
*   SIOTYPPT=ADDR(SIOTYP11);        /* SET ADDRESSABILITY TO TYPES   */ 00327000
         LA    @06,SIOTYP11(,@14)                                  0143 00328000
         ST    @06,SIOTYPPT                                        0143 00329000
*   SIOINTPT=ADDR(SIO11PTR);        /* SET ADDRESSABILITY TO INST    */ 00330000
         LA    @14,SIO11PTR(,@14)                                  0144 00331000
         ST    @14,SIOINTPT                                        0144 00332000
*/********************************************************************/ 00333000
*/*                                                                  */ 00334000
*/*                S  CALL INSERT R.: PROCESS INSERTS                */ 00335000
*/*                                                                  */ 00336000
*/********************************************************************/ 00337000
*                                                                  0145 00338000
*   CALL INSERT;                    /* CALL INSERT PROCESSOR         */ 00339000
         BAL   @14,INSERT                                          0145 00340000
*   IF RTNCODE=0 THEN              /* TEST FOR SUCCESSFUL CALL      */ 00341000
         SLR   @14,@14                                             0146 00342000
         CR    RTNCODE,@14                                         0146 00343000
         BNE   @RT00146                                            0146 00344000
*     GOTO EXITMSG;                 /* BRANCH TO END OF PROCEDURE    */ 00345000
*/********************************************************************/ 00346000
*/*                                                                  */ 00347000
*/*                D  (YES,,NO,ONELEV)                             0148 00348000
*/*                   IS THERE A SECOND LEVEL MSG ?                  */ 00349000
*/*                                                                  */ 00350000
*/********************************************************************/ 00351000
*                                                                  0148 00352000
*   IF SIO2NDMS=0 THEN             /* TEST FOR PRESENTS OF 2ND LEV  */ 00353000
         L     @06,IOPARMS                                         0148 00354000
         L     @06,SIO2NDMS(,@06)                                  0148 00355000
         CR    @06,@14                                             0148 00356000
         BE    @RF00148                                            0148 00357000
*     DO;                                                          0149 00358000
*       INDXTAB=SECONDPT;           /* ESTAB ADDRESSABILITY TO TAB   */ 00359000
         L     @14,SECONDPT(,MSGCSECT)                             0150 00360000
         ST    @14,INDXTAB                                         0150 00361000
*       MESSAGE(1,LENMSG(1))='+';   /* INDICATE TO USER TWO LEVELS   */ 00362000
         LH    @11,LENMSG                                          0151 00363000
         LA    @10,MESSAGE-1(@11)                                  0151 00364000
         MVI   0(@10),C'+'                                         0151 00365000
*       IF SIO2NDMS<200|SIO2NDMS>AMTINDX THEN/* TEST FOR VAL #       */ 00366000
         CH    @06,@CH00258                                        0152 00367000
         BL    @RT00152                                            0152 00368000
         C     @06,AMTINDX(,@14)                                   0152 00369000
         BNH   @RF00152                                            0152 00370000
@RT00152 DS    0H                                                  0153 00371000
*         DO;                                                      0153 00372000
*           CALL BADPARM;           /* CALL FOR ERROR PROC BAD PARM  */ 00373000
         BAL   @14,BADPARM                                         0154 00374000
*           GO TO EXITMSG;          /* BRANCH TO END OF ROUTINE      */ 00375000
         B     EXITMSG                                             0155 00376000
*         END;                                                     0156 00377000
*                                                                  0156 00378000
*/********************************************************************/ 00379000
*/*                                                                  */ 00380000
*/*SECOND:         P  FIND AND PREPARE SECOND LEVEL MESSAGE          */ 00381000
*/*                                                                  */ 00382000
*/********************************************************************/ 00383000
*                                                                  0157 00384000
*       SIO2NDMS=SIO2NDMS-199;      /* ADJUST TO TABLE VALUES        */ 00385000
@RF00152 L     @14,IOPARMS                                         0157 00386000
         L     @06,SIO2NDMS(,@14)                                  0157 00387000
         SH    @06,@CH00263                                        0157 00388000
         ST    @06,SIO2NDMS(,@14)                                  0157 00389000
*       MSGPTR=INDXPTR(SIO2NDMS);   /* ESTAB ADDRESSABILITY TO MSG   */ 00390000
         SLA   @06,2                                               0158 00391000
         L     @14,INDXTAB                                         0158 00392000
         L     @14,INDXPTR-4(@06,@14)                              0158 00393000
         ST    @14,MSGPTR                                          0158 00394000
*       IF INDISP(1)='FF'X THEN     /* TEST IF NULL ENTRY            */ 00395000
         CLI   INDISP(@14),255                                     0159 00396000
         BNE   @RF00159                                            0159 00397000
*         DO;                                                      0160 00398000
*           CALL BADPARM;           /* CALL FOR ERROR PROC BAD PRMS  */ 00399000
         BAL   @14,BADPARM                                         0161 00400000
*           GO TO EXITMSG;          /* BRANCH TO EXIT ROUTINE        */ 00401000
         B     EXITMSG                                             0162 00402000
*         END;                                                     0163 00403000
*       MESSAGE(2)='00'X;           /* CLEAR CORE FOR SECOND MSG     */ 00404000
@RF00159 XC    MESSAGE+105(103),MESSAGE+105                        0164 00405000
         MVI   MESSAGE+104,X'00'                                   0164 00406000
*       WKMSGID(2)=WKMSGID(1);      /* MOVE FIRST LEVEL NUMBER       */ 00407000
         MVC   WKMSGID+104(9),WKMSGID                              0165 00408000
*       WKMSGTXT(2)=TEXTMSG;        /* MOVE IN THE TEXT PORTION      */ 00409000
         MVI   WKMSGTXT+193,C' '                                   0166 00410000
         MVI   WKMSGTXT+194,C' '                                   0166 00411000
         L     @14,MSGPTR                                          0166 00412000
         MVC   WKMSGTXT+104(89),TEXTMSG(@14)                       0166 00413000
*       LENMSG(2)=LENLOCAL;         /* MOVE IN MESSAGE LENGTH        */ 00414000
         MVC   LENMSG+104(2),LENLOCAL(@14)                         0167 00415000
*       SIO2NDMS=ADDR(MESSAGE(2));  /* STORE ADDRESS OF MSG IN P.L.  */ 00416000
         L     @14,IOPARMS                                         0168 00417000
         LA    @06,MESSAGE+104                                     0168 00418000
         ST    @06,SIO2NDMS(,@14)                                  0168 00419000
*/********************************************************************/ 00420000
*/*                                                                  */ 00421000
*/*                P  PREPARE TO PROCESS SECOND LEVEL INSERTS        */ 00422000
*/*                                                                  */ 00423000
*/********************************************************************/ 00424000
*                                                                  0169 00425000
*       LEV=2;                      /* INDICATE THAT THIS IS 2ND LV  */ 00426000
         MVI   LEV,X'02'                                           0169 00427000
*       SIOTYPPT=ADDR(SIOTYP21);    /* SET ADDRESSABILITY TO TYPES   */ 00428000
         LA    @06,SIOTYP21(,@14)                                  0170 00429000
         ST    @06,SIOTYPPT                                        0170 00430000
*       SIOINTPT=ADDR(SIO21PTR);    /* SET ADDRESSABILITY TO INST    */ 00431000
         LA    @14,SIO21PTR(,@14)                                  0171 00432000
         ST    @14,SIOINTPT                                        0171 00433000
*/********************************************************************/ 00434000
*/*                                                                  */ 00435000
*/*                S  CALL INSERT R.: PROCESS INSERTS                */ 00436000
*/*                                                                  */ 00437000
*/********************************************************************/ 00438000
*                                                                  0172 00439000
*       CALL INSERT;                /* CALL INSERT PROCESSOR         */ 00440000
         BAL   @14,INSERT                                          0172 00441000
*       IF RTNCODE=0 THEN          /* TEST FOR SUCCESSFUL CALL      */ 00442000
         LTR   RTNCODE,RTNCODE                                     0173 00443000
         BNZ   @RT00173                                            0173 00444000
*         GOTO EXITMSG;             /* BRANCH TO END OF PROCEDURE    */ 00445000
*/********************************************************************/ 00446000
*/*                                                                  */ 00447000
*/*                S   (,MSGEND)                                   0175 00448000
*/*                    CALL TERMOUT:  ISSUE 2 LEVEL MSG              */ 00449000
*/*                                                                  */ 00450000
*/********************************************************************/ 00451000
*                                                                  0175 00452000
*       CALL TERMOUT;               /* CALL PUTLINE FOR MULTILEVEL   */ 00453000
         BAL   @14,TERMOUT                                         0175 00454000
*     END;                                                         0176 00455000
*                                                                  0176 00456000
*/********************************************************************/ 00457000
*/*                                                                  */ 00458000
*/*ONELEV:         S   CALL TERMOUT: ISSUE SINGLE LEVEL MSG          */ 00459000
*/*                                                                  */ 00460000
*/********************************************************************/ 00461000
*                                                                  0177 00462000
*   ELSE                                                           0177 00463000
*     CALL TERMOUT;                 /* CALL PUTLINE FOR SINGLELEVEL  */ 00464000
         B     @RC00148                                            0177 00465000
@RF00148 BAL   @14,TERMOUT                                         0177 00466000
*/********************************************************************/ 00467000
*/*                                                                  */ 00468000
*/*MSGEND:         R  RETURN TO IO CONTROLLER                        */ 00469000
*/*                                                                  */ 00470000
*/********************************************************************/ 00471000
*                                                                  0178 00472000
*EXITMSG:                           /* LABEL TO BRANCH TO END        */ 00473000
*   RETURN CODE(RTNCODE);           /* RETURN TO DRIVER WITH CODE    */ 00474000
@RC00148 DS    0H                                                  0178 00475000
EXITMSG  L     @14,@SA00003                                        0178 00476000
         LM    @00,@12,@SA00003+8                                  0178 00477000
         BR    @14                                                 0178 00478000
*   END MSG;                                                       0179 00479000
*                                                                  0180 00480000
*/********************************************************************/ 00481000
*/*                                                                  */ 00482000
*/*    THE FOLLOWING PROCEDURE IS THE INSERT ROUTINE.                */ 00483000
*/*    IT WILL BE INVOKED IF THE USERS HAS REQUESTED 'MSG' SERVICE.  */ 00484000
*/*                                                                  */ 00485000
*/*        1.  DETERMINE WHICH TYPE INSERT TO BE PREPARED AND        */ 00486000
*/*            INVOKE APPROPRIATE ROUTINE.                           */ 00487000
*/*        2.  KEEP TRACK OF INSERT BEING PROCESSED.                 */ 00488000
*/*                                                                  */ 00489000
*/********************************************************************/ 00490000
*/********************************************************************/ 00491000
*/*                                                                  */ 00492000
*/*INSTPROC:       E  INSERT PROCESSOR ROUTINE                       */ 00493000
*/*                                                                  */ 00494000
*/********************************************************************/ 00495000
*                                                                  0180 00496000
*INSERT:                                                           0180 00497000
*   PROCEDURE;                                                     0180 00498000
*                                                                  0180 00499000
INSERT   STM   @14,@12,@SA00004                                    0180 00500000
*/********************************************************************/ 00501000
*/*                                                                  */ 00502000
*/*                P  INITIALIZE TO PROCESS INSERTS                  */ 00503000
*/*                                                                  */ 00504000
*/********************************************************************/ 00505000
*                                                                  0181 00506000
*   DCL                                                            0181 00507000
*     TYPEINST FIXED(8);            /* TEMP VAR TO FIND TYPE         */ 00508000
*   DO INSTCTR=1 TO 7;              /* SET UP LOOP COUNTER FOR 7     */ 00509000
         LA    @14,1                                               0182 00510000
         ST    @14,INSTCTR                                         0182 00511000
@DL00182 DS    0H                                                  0183 00512000
*     IF LEV=1 THEN                 /* SEE IF INST OLD NUM IS 1ST    */ 00513000
         CLI   LEV,1                                               0183 00514000
         BNE   @RF00183                                            0183 00515000
*       SIONUMI1=SIONUMI1+1;        /* INSERT AMOUNT OF INSERTS      */ 00516000
         L     @14,IOPARMS                                         0184 00517000
         LA    @06,1                                               0184 00518000
         AL    @06,SIONUMI1(,@14)                                  0184 00519000
         ST    @06,SIONUMI1(,@14)                                  0184 00520000
*     ELSE                                                         0185 00521000
*       IF LEV=2 THEN               /* THE ONLY OTHER POSSIBILITY    */ 00522000
         B     @RC00183                                            0185 00523000
@RF00183 CLI   LEV,2                                               0185 00524000
         BNE   @RF00185                                            0185 00525000
*         SIONUMI2=SIONUMI2+1;      /* INSERT AMOUNT OF INSERTS      */ 00526000
         L     @14,IOPARMS                                         0186 00527000
         LA    @06,1                                               0186 00528000
         AL    @06,SIONUMI2(,@14)                                  0186 00529000
         ST    @06,SIONUMI2(,@14)                                  0186 00530000
*       ELSE                                                       0187 00531000
*         DO;                                                      0187 00532000
         B     @RC00185                                            0187 00533000
@RF00185 DS    0H                                                  0188 00534000
*           RTNCODE=4;              /* SOMEHOW AN ERR HAS HAPPENED   */ 00535000
         LA    RTNCODE,4                                           0188 00536000
*           GO TO EXITINST;         /* BRANCH TO EXIT OF ROUTINE     */ 00537000
         B     EXITINST                                            0189 00538000
*         END;                                                     0190 00539000
*                                                                  0190 00540000
*/********************************************************************/ 00541000
*/*                                                                  */ 00542000
*/*%CONT10:        D  (YES,,NO,EXITINST)                           0191 00543000
*/*                   ARE THERE INSERTS TO PROCESS ?                 */ 00544000
*/*                                                                  */ 00545000
*/********************************************************************/ 00546000
*                                                                  0191 00547000
*     IF INSTCTR>6 THEN             /* TEST IF MAXIMUM NUMBER        */ 00548000
@RC00185 DS    0H                                                  0191 00549000
@RC00183 L     @14,INSTCTR                                         0191 00550000
         CH    @14,@CH00129                                        0191 00551000
         BH    @RT00191                                            0191 00552000
*       GO TO EXITINST;             /* BRANCH TO EXIT                */ 00553000
*     TYPEINST=TYP(INSTCTR);        /* OBTAIN TYPE INSERT BY CALLER  */ 00554000
         L     @06,SIOTYPPT                                        0193 00555000
         BCTR  @06,0                                               0193 00556000
         SLR   @11,@11                                             0193 00557000
         IC    @11,TYP(@14,@06)                                    0193 00558000
         STC   @11,TYPEINST                                        0193 00559000
*     IF TYPEINST=0 THEN            /* TEST FOR INSERT TO PROCESS    */ 00560000
         CLI   TYPEINST,0                                          0194 00561000
         BE    @RT00194                                            0194 00562000
*       GO TO EXITINST;             /* BRANCH TO EXIT IF NONE        */ 00563000
*     IF INDISP(INSTCTR)=0 THEN     /* TEST FOR ERROR NO DISP VALUE  */ 00564000
         L     @06,MSGPTR                                          0196 00565000
         BCTR  @06,0                                               0196 00566000
         SLR   @11,@11                                             0196 00567000
         IC    @11,INDISP(@14,@06)                                 0196 00568000
         CH    @11,@CH00235                                        0196 00569000
         BNE   @RF00196                                            0196 00570000
*       DO;                                                        0197 00571000
*         CALL BADPARM;             /* ISSUE BAD PARM MESSAGE        */ 00572000
         BAL   @14,BADPARM                                         0198 00573000
*         GO TO EXITINST;           /* GO TO EXIT INSERT             */ 00574000
         B     EXITINST                                            0199 00575000
*       END;                                                       0200 00576000
*                                                                  0200 00577000
*/********************************************************************/ 00578000
*/*                                                                  */ 00579000
*/*%CONT11:        D  (YES,,NO,%CONT12)                            0201 00580000
*/*                   IS THIS INSERT "NUM" ?                         */ 00581000
*/*                S  (,EXITINST)                                  0201 00582000
*/*                   CALL NUM INSERT: FORMAT INSERT OF FIXED INSERT */ 00583000
*/*                                                                  */ 00584000
*/********************************************************************/ 00585000
*                                                                  0201 00586000
*     ELSE                                                         0201 00587000
*       IF TYPEINST=5 THEN          /* TEST TO SEE IF TYPE IS NUM    */ 00588000
@RF00196 CLI   TYPEINST,5                                          0201 00589000
         BNE   @RF00201                                            0201 00590000
*         CALL INSTNUM;             /* IF SO INVOKE THE NUM ROUT.    */ 00591000
         BAL   @14,INSTNUM                                         0202 00592000
*/********************************************************************/ 00593000
*/*                                                                  */ 00594000
*/*%CONT12:        D  (YES,,NO,%CONT13)                            0203 00595000
*/*                   IS THIS INSERT "APDE" ?                        */ 00596000
*/*                S  (,EXITINST)                                  0203 00597000
*/*                   CALL APDE INSERT: FORMAT INSERT OF ADDRESS PDE */ 00598000
*/*                                                                  */ 00599000
*/********************************************************************/ 00600000
*                                                                  0203 00601000
*       ELSE                                                       0203 00602000
*         IF TYPEINST=6 THEN        /* TEST TO SEE IF TYPE IS A-PDE  */ 00603000
         B     @RC00201                                            0203 00604000
@RF00201 CLI   TYPEINST,6                                          0203 00605000
         BNE   @RF00203                                            0203 00606000
*           CALL INSTAPDE;          /* IF SO INVOKE THE A-PDE PROC.  */ 00607000
         BAL   @14,INSTAPDE                                        0204 00608000
*/********************************************************************/ 00609000
*/*                                                                  */ 00610000
*/*%CONT13:        D  (YES,,NO,%CONT14)                            0205 00611000
*/*                   IS THIS INSERT "VPDE" ?                        */ 00612000
*/*                S  (,EXITINST)                                  0205 00613000
*/*                   CALL VPDE INSERT: FORMAT INSERT OF VALUE PDE   */ 00614000
*/*                                                                  */ 00615000
*/********************************************************************/ 00616000
*                                                                  0205 00617000
*         ELSE                                                     0205 00618000
*           IF TYPEINST=7 THEN      /* TEST TO SEE IF TYPE IS E-PDE  */ 00619000
         B     @RC00203                                            0205 00620000
@RF00203 CLI   TYPEINST,7                                          0205 00621000
         BNE   @RF00205                                            0205 00622000
*             CALL INSTVPDE;        /* IF SO INVOKE THE V-PDE PROC.  */ 00623000
         BAL   @14,INSTVPDE                                        0206 00624000
*/********************************************************************/ 00625000
*/*                                                                  */ 00626000
*/*%CONT14:        D  (YES,,NO,%CONT15)                            0207 00627000
*/*                   IS THIS INSERT "REG" ?                         */ 00628000
*/*                S  (,EXITINST)                                  0207 00629000
*/*                   CALL  INSERTREG: FORMAT INSERT FOR CONT OF REG */ 00630000
*/*                                                                  */ 00631000
*/********************************************************************/ 00632000
*                                                                  0207 00633000
*           ELSE                                                   0207 00634000
*             IF TYPEINST=1 THEN    /* TEST TO SEE IF TYPE IS REG    */ 00635000
         B     @RC00205                                            0207 00636000
@RF00205 CLI   TYPEINST,1                                          0207 00637000
         BNE   @RF00207                                            0207 00638000
*               CALL INSTREG;       /* IF SO INVOKE THE REG PROC.    */ 00639000
         BAL   @14,INSTREG                                         0208 00640000
*/********************************************************************/ 00641000
*/*                                                                  */ 00642000
*/*%CONT15:        D  (YES,,NO,%CONT16)                            0209 00643000
*/*                   IS THIS INSERT "ADDR" ?                        */ 00644000
*/*                S  (,EXITINST)                                  0209 00645000
*/*                   CALL INSTADDR: FORMAT INSERT                   */ 00646000
*/*                                                                  */ 00647000
*/********************************************************************/ 00648000
*                                                                  0209 00649000
*             ELSE                                                 0209 00650000
*               IF TYPEINST=2 THEN  /* TEST TO SEE IF TYPE IS ADDR   */ 00651000
         B     @RC00207                                            0209 00652000
@RF00207 CLI   TYPEINST,2                                          0209 00653000
         BNE   @RF00209                                            0209 00654000
*                 CALL INSTADDR;    /* IF SO THE PROC. IS COMPLETE   */ 00655000
         BAL   @14,INSTADDR                                        0210 00656000
*/********************************************************************/ 00657000
*/*                                                                  */ 00658000
*/*%CONT16:        D  (YES,,NO,%CONT17)                            0211 00659000
*/*                   IS THIS INSERT "ADDRCONX" ?                    */ 00660000
*/*                S  (,EXITINST)                                  0211 00661000
*/*                   CALL ADDRCONX I: FORMAT AND CONVERT INSERT     */ 00662000
*/*                                                                  */ 00663000
*/********************************************************************/ 00664000
*                                                                  0211 00665000
*               ELSE                                               0211 00666000
*                 IF TYPEINST=3 THEN/* TEST IF TYPE INSERT ADDRCONX  */ 00667000
         B     @RC00209                                            0211 00668000
@RF00209 CLI   TYPEINST,3                                          0211 00669000
         BNE   @RF00211                                            0211 00670000
*                   CALL INSTADDX;  /* IF SO INVOKE INSTADCX ROUT    */ 00671000
         BAL   @14,INSTADDX                                        0212 00672000
*/********************************************************************/ 00673000
*/*                                                                  */ 00674000
*/*%CONT17:        D  (YES,,NO,%CONT18)                            0213 00675000
*/*                   IS THIS INSERT "ADDRCOND" ?                    */ 00676000
*/*                S  (,EXITINST)                                  0213 00677000
*/*                   CALL ADDRCOND: FORMAT AND CONVERT INSERT       */ 00678000
*/*                                                                  */ 00679000
*/********************************************************************/ 00680000
*                                                                  0213 00681000
*                 ELSE                                             0213 00682000
*                   IF TYPEINST=4 THEN/* TEST IF TYPE INSERT ADDRCOND*/ 00683000
         B     @RC00211                                            0213 00684000
@RF00211 CLI   TYPEINST,4                                          0213 00685000
         BNE   @RF00213                                            0213 00686000
*                     CALL INSTADDD;/* IF SO INVOKE INSTADCD ROUT    */ 00687000
         BAL   @14,INSTADDD                                        0214 00688000
*/********************************************************************/ 00689000
*/*                                                                  */ 00690000
*/*%CONT18:        S   CALL BADPARM:  ISSUE ERROR MESSAGE            */ 00691000
*/*                                                                  */ 00692000
*/********************************************************************/ 00693000
*                                                                  0215 00694000
*                   ELSE                                           0215 00695000
*                     DO;                                          0215 00696000
         B     @RC00213                                            0215 00697000
@RF00213 DS    0H                                                  0216 00698000
*                       CALL BADPARM;/* IF NO MATCH YET BAD PARM     */ 00699000
         BAL   @14,BADPARM                                         0216 00700000
*                       GO TO EXITINST;/* BRANCH TO EXIT OF ROUTINE  */ 00701000
         B     EXITINST                                            0217 00702000
*                     END;                                         0218 00703000
*   END;                                                           0219 00704000
*                                                                  0219 00705000
@RC00213 DS    0H                                                  0219 00706000
@RC00211 DS    0H                                                  0219 00707000
@RC00209 DS    0H                                                  0219 00708000
@RC00207 DS    0H                                                  0219 00709000
@RC00205 DS    0H                                                  0219 00710000
@RC00203 DS    0H                                                  0219 00711000
@RC00201 LA    @14,1                                               0219 00712000
         AL    @14,INSTCTR                                         0219 00713000
         ST    @14,INSTCTR                                         0219 00714000
         CH    @14,@CH00033                                        0219 00715000
         BNH   @DL00182                                            0219 00716000
*/********************************************************************/ 00717000
*/*                                                                  */ 00718000
*/*EXITINST:       R  RETURN TO I/O CONTROLLER                       */ 00719000
*/*                                                                  */ 00720000
*/********************************************************************/ 00721000
*                                                                  0220 00722000
*EXITINST:                          /* LABEL USED TO EXIT ON ERROR   */ 00723000
*   RETURN CODE(RTNCODE);           /* RETURN TO PROCESSING          */ 00724000
EXITINST L     @14,@SA00004                                        0220 00725000
         LM    @00,@12,@SA00004+8                                  0220 00726000
         BR    @14                                                 0220 00727000
*   END INSERT;                     /* END OF INSERT ROUTINE         */ 00728000
*                                                                  0222 00729000
*/********************************************************************/ 00730000
*/*                                                                  */ 00731000
*/*    THE FOLLOWING PROCEDURE IS THE ADDRESS PDE INSERT ROUTINE.    */ 00732000
*/*    IT WILL BE INVOKED IF THE USER'S MESSAGE MUST INCLUDE THIS    */ 00733000
*/*    TYPE INSERT.  THE PRIMARY FUNCTIONS ARE:                      */ 00734000
*/*                                                                  */ 00735000
*/*        1.  SETS UP AND INVOKE THE IKJEGBLD ROUTINE               */ 00736000
*/*            TO EXTRACT AND FORMAT THE ADDRESS PDE.                */ 00737000
*/*        2.  PREPARE THE INSERT FOR INCLUSION                      */ 00738000
*/*                                                                  */ 00739000
*/********************************************************************/ 00740000
*/********************************************************************/ 00741000
*/*                                                                  */ 00742000
*/*INSTAPDE:       E  PDE INSERT BUILD ROUTINE                       */ 00743000
*/*                                                                  */ 00744000
*/********************************************************************/ 00745000
*                                                                  0222 00746000
*INSTAPDE:                                                         0222 00747000
*   PROCEDURE;                                                     0222 00748000
INSTAPDE STM   @14,@12,@SA00005                                    0222 00749000
*   PDEREG=INTPLPTR(INSTCTR);       /* SET UP ADDR TO PDE FOR CONV   */ 00750000
         L     @14,INSTCTR                                         0223 00751000
         LR    @06,@14                                             0223 00752000
         SLA   @06,2                                               0223 00753000
         L     @11,SIOINTPT                                        0223 00754000
         AL    @11,@CF00622                                        0223 00755000
         L     PDEREG,INTPLPTR(@06,@11)                            0223 00756000
*   IF LEV=1 THEN                   /* SEE WHETHER WORKING ON 1ST L  */ 00757000
         CLI   LEV,1                                               0224 00758000
         BNE   @RF00224                                            0224 00759000
*     INSERTRG=ADDR(INSTTXT1(INSTCTR));/* IF SO ADDRESS 1ST INSERT PL*/ 00760000
         MH    @14,@CH00617                                        0225 00761000
         LA    INSERTRG,INSTTXT1-56(@14)                           0225 00762000
*   ELSE                                                           0226 00763000
*     IF LEV=2 THEN                 /* SEE WHETHER WORKING ON 2ND    */ 00764000
         B     @RC00224                                            0226 00765000
@RF00224 CLI   LEV,2                                               0226 00766000
         BNE   @RF00226                                            0226 00767000
*       INSERTRG=ADDR(INSTTXT2(INSTCTR));/* IF SO ADDRESS 2ND INSERTS*/ 00768000
         L     INSERTRG,INSTCTR                                    0227 00769000
         MH    INSERTRG,@CH00617                                   0227 00770000
         LA    INSERTRG,INSTTXT2-56(INSERTRG)                      0227 00771000
*     ELSE                                                         0228 00772000
*       DO;                                                        0228 00773000
         B     @RC00226                                            0228 00774000
@RF00226 DS    0H                                                  0229 00775000
*         RTNCODE=4;                /* IF NOT 1 OR 2 THE FOUL UP     */ 00776000
         LA    RTNCODE,4                                           0229 00777000
*         GO TO EXITAPDE;           /* BRANCH TO EXIT                */ 00778000
         B     EXITAPDE                                            0230 00779000
*       END;                                                       0231 00780000
*                                                                  0231 00781000
*/********************************************************************/ 00782000
*/*                                                                  */ 00783000
*/*                S  CALL PDECONVR: CONVERT PDE FOR USE             */ 00784000
*/*                                                                  */ 00785000
*/********************************************************************/ 00786000
*                                                                  0232 00787000
*                                   /* BY PASSING THE COMPLEMENT     */ 00788000
*   CALL PDECONVR;                  /* CALL ROUTINE OUTSIDE IO       */ 00789000
@RC00226 DS    0H                                                  0232 00790000
@RC00224 L     @15,TSTADDR                                         0232 00791000
         BALR  @14,@15                                             0232 00792000
*   RTNCODE=0;                      /* RESET RTNCODE BACK TO ZERO    */ 00793000
         SLR   RTNCODE,RTNCODE                                     0233 00794000
*   IF PDELEN>50 THEN               /* IF AFTER CONV. TOO BIG MUST   */ 00795000
         LA    @14,50                                              0234 00796000
         CR    PDELEN,@14                                          0234 00797000
         BNH   @RF00234                                            0234 00798000
*     PDELEN=50;                    /* REDUCE TO MAX. SIZE POSS.     */ 00799000
         LR    PDELEN,@14                                          0235 00800000
*/********************************************************************/ 00801000
*/*                                                                  */ 00802000
*/*                P  PREPARE INSERT FOR INSERTION                   */ 00803000
*/*                                                                  */ 00804000
*/********************************************************************/ 00805000
*                                                                  0236 00806000
*   IF LEV=1 THEN                   /* SEE IF ADDR SHOULD BE TO 1ST  */ 00807000
@RF00234 CLI   LEV,1                                               0236 00808000
         BNE   @RF00236                                            0236 00809000
*     DO;                                                          0237 00810000
*       INSTTXT1(INSTCTR,PDELEN+1:PDELEN+1)=' ';/* INSERT BLANK SEP  */ 00811000
         L     @14,INSTCTR                                         0238 00812000
         LR    @06,@14                                             0238 00813000
         MH    @06,@CH00617                                        0238 00814000
         LR    @11,PDELEN                                          0238 00815000
         ALR   @11,@06                                             0238 00816000
         LA    @10,INSTTXT1-56(@11)                                0238 00817000
         MVI   0(@10),C' '                                         0238 00818000
*       LENINST1(INSTCTR)=PDELEN+5; /* MOVE AIN THE LENGTH           */ 00819000
         LA    @11,5                                               0239 00820000
         ALR   @11,PDELEN                                          0239 00821000
         STH   @11,LENINST1-56(@06)                                0239 00822000
*       DISPIN1(INSTCTR)=INDISP(INSTCTR);/* MOVE DISP TO PL          */ 00823000
         L     @11,MSGPTR                                          0240 00824000
         BCTR  @11,0                                               0240 00825000
         SLR   @10,@10                                             0240 00826000
         IC    @10,INDISP(@14,@11)                                 0240 00827000
         STH   @10,DISPIN1-56(@06)                                 0240 00828000
*       INTPLPTR(INSTCTR)=ADDR(MSGINST1(INSTCTR));/* MOVE PTR TO PL  */ 00829000
         SLA   @14,2                                               0241 00830000
         LA    @06,MSGINST1-56(@06)                                0241 00831000
         L     @11,SIOINTPT                                        0241 00832000
         AL    @11,@CF00622                                        0241 00833000
         ST    @06,INTPLPTR(@14,@11)                               0241 00834000
*     END;                                                         0242 00835000
*   ELSE                                                           0243 00836000
*     DO;                                                          0243 00837000
         B     @RC00236                                            0243 00838000
@RF00236 DS    0H                                                  0244 00839000
*       INSTTXT2(INSTCTR,PDELEN+1:PDELEN+1)=' ';/* INSERT BLANK SEP  */ 00840000
         L     @14,INSTCTR                                         0244 00841000
         LR    @06,@14                                             0244 00842000
         MH    @06,@CH00617                                        0244 00843000
         LR    @11,PDELEN                                          0244 00844000
         ALR   @11,@06                                             0244 00845000
         LA    @10,INSTTXT2-56(@11)                                0244 00846000
         MVI   0(@10),C' '                                         0244 00847000
*       LENINST2(INSTCTR)=PDELEN+5; /* MOVE AIN THE LENGTH           */ 00848000
         LA    @11,5                                               0245 00849000
         ALR   @11,PDELEN                                          0245 00850000
         STH   @11,LENINST2-56(@06)                                0245 00851000
*       DISPIN2(INSTCTR)=INDISP(INSTCTR);/* MOVE DISP TO PL          */ 00852000
         L     @11,MSGPTR                                          0246 00853000
         BCTR  @11,0                                               0246 00854000
         SLR   @10,@10                                             0246 00855000
         IC    @10,INDISP(@14,@11)                                 0246 00856000
         STH   @10,DISPIN2-56(@06)                                 0246 00857000
*       INTPLPTR(INSTCTR)=ADDR(MSGINST2(INSTCTR));/* MOVE PTR TO PL  */ 00858000
         SLA   @14,2                                               0247 00859000
         LA    @06,MSGINST2-56(@06)                                0247 00860000
         L     @11,SIOINTPT                                        0247 00861000
         AL    @11,@CF00622                                        0247 00862000
         ST    @06,INTPLPTR(@14,@11)                               0247 00863000
*     END;                                                         0248 00864000
*                                                                  0248 00865000
*/********************************************************************/ 00866000
*/*                                                                  */ 00867000
*/*EXITAPDE:       R  RETURN TO MAIN INSERT ROUTINE                  */ 00868000
*/*                                                                  */ 00869000
*/********************************************************************/ 00870000
*                                                                  0249 00871000
*EXITAPDE:                          /* LABEL TO EXIT ROUTINE         */ 00872000
*   RETURN CODE(RTNCODE);                                          0249 00873000
@RC00236 DS    0H                                                  0249 00874000
EXITAPDE L     @14,@SA00005                                        0249 00875000
         LM    @00,@12,@SA00005+8                                  0249 00876000
         BR    @14                                                 0249 00877000
*   END INSTAPDE;                                                  0250 00878000
*                                                                  0251 00879000
*/********************************************************************/ 00880000
*/*                                                                  */ 00881000
*/*    THE FOLLOWING PROCEDURE IS THE VALUE PDE INSERT ROUTINE.      */ 00882000
*/*    IT WILL BE INVOKED IF THE USER'S MESSAGE MUST INCLUDE THIS    */ 00883000
*/*    TYPE INSERT.  THE PRIMARY FUNCTION IS:                        */ 00884000
*/*                                                                  */ 00885000
*/*        1.  PREPARE THE INSERT FOR INCLUSION                      */ 00886000
*/*                                                                  */ 00887000
*/********************************************************************/ 00888000
*/********************************************************************/ 00889000
*/*                                                                  */ 00890000
*/*INSTVPDE:       E  PDE INSERT BUILD ROUTINE                       */ 00891000
*/*                                                                  */ 00892000
*/********************************************************************/ 00893000
*                                                                  0251 00894000
*INSTVPDE:                                                         0251 00895000
*   PROCEDURE;                                                     0251 00896000
INSTVPDE STM   @14,@12,12(@13)                                     0251 00897000
*   DCL                                                            0252 00898000
*     INSTPDE CHAR(8) BDY(WORD) BASED(INTPLPTR(INSTCTR));/* OVERLAY  */ 00899000
*   DCL                                                            0253 00900000
*     VPDETXT CHAR(*) BASED(VPDEPT);/* DEFINE USER TEXT              */ 00901000
*   VPDE=INSTPDE;                   /* MOVE PDE INTO MY WORK PDE     */ 00902000
         L     @14,INSTCTR                                         0254 00903000
         SLA   @14,2                                               0254 00904000
         L     @06,SIOINTPT                                        0254 00905000
         AL    @06,@CF00622                                        0254 00906000
         L     @14,INTPLPTR(@14,@06)                               0254 00907000
         MVC   VPDE(8),INSTPDE(@14)                                0254 00908000
*   IF VPDEL>50 THEN                /* MAKE SURE WILL NOT OVERFLOW   */ 00909000
         LA    @14,50                                              0255 00910000
         CH    @14,VPDEL                                           0255 00911000
         BNL   @RF00255                                            0255 00912000
*     VPDEL=50;                     /* REDUCE TO MAX ALLOWED         */ 00913000
         STH   @14,VPDEL                                           0256 00914000
*/********************************************************************/ 00915000
*/*                                                                  */ 00916000
*/*                P  PREPARE INSERT FOR INSERTION                   */ 00917000
*/*                                                                  */ 00918000
*/********************************************************************/ 00919000
*                                                                  0257 00920000
*   IF LEV=1 THEN                   /* SEE IF WE'RE WORKING OF 1ST   */ 00921000
@RF00255 CLI   LEV,1                                               0257 00922000
         BNE   @RF00257                                            0257 00923000
*     DO;                                                          0258 00924000
*       LENINST1(INSTCTR)=VPDEL+5;  /* CALCULATE LENGTH OF INSERT    */ 00925000
         L     @14,INSTCTR                                         0259 00926000
         LR    @06,@14                                             0259 00927000
         MH    @06,@CH00617                                        0259 00928000
         LH    @11,VPDEL                                           0259 00929000
         LA    @10,5                                               0259 00930000
         ALR   @10,@11                                             0259 00931000
         STH   @10,LENINST1-56(@06)                                0259 00932000
*       DISPIN1(INSTCTR)=INDISP(INSTCTR);/* MOVE DISPLACEMENT VAL IN */ 00933000
         L     @10,MSGPTR                                          0260 00934000
         BCTR  @10,0                                               0260 00935000
         SLR   @05,@05                                             0260 00936000
         IC    @05,INDISP(@14,@10)                                 0260 00937000
         STH   @05,DISPIN1-56(@06)                                 0260 00938000
*       INSTTXT1(INSTCTR,1:VPDEL+1)=VPDETXT(1:VPDEL+1);            0261 00939000
         LA    @10,INSTTXT1-56(@06)                                0261 00940000
         L     @05,VPDEPT                                          0261 00941000
         EX    @11,@SM00623                                        0261 00942000
*       INSTTXT1(INSTCTR,VPDEL+1:VPDEL+1)=' ';/* INSERT BLANK        */ 00943000
         ALR   @11,@06                                             0262 00944000
         LA    @10,INSTTXT1-56(@11)                                0262 00945000
         MVI   0(@10),C' '                                         0262 00946000
*       INTPLPTR(INSTCTR)=ADDR(MSGINST1(INSTCTR));/* MOVE PTR TO PL  */ 00947000
         SLA   @14,2                                               0263 00948000
         LA    @06,MSGINST1-56(@06)                                0263 00949000
         L     @11,SIOINTPT                                        0263 00950000
         AL    @11,@CF00622                                        0263 00951000
         ST    @06,INTPLPTR(@14,@11)                               0263 00952000
*     END;                                                         0264 00953000
*   ELSE                                                           0265 00954000
*     IF LEV=2 THEN                 /* SEE IF WE'RE WORKING OF 2ND   */ 00955000
         B     @RC00257                                            0265 00956000
@RF00257 CLI   LEV,2                                               0265 00957000
         BNE   @RF00265                                            0265 00958000
*       DO;                                                        0266 00959000
*         LENINST2(INSTCTR)=VPDEL+5;/* CALCULATE LENGTH OR INST      */ 00960000
         L     @14,INSTCTR                                         0267 00961000
         LR    @06,@14                                             0267 00962000
         MH    @06,@CH00617                                        0267 00963000
         LH    @11,VPDEL                                           0267 00964000
         LA    @10,5                                               0267 00965000
         ALR   @10,@11                                             0267 00966000
         STH   @10,LENINST2-56(@06)                                0267 00967000
*         DISPIN2(INSTCTR)=INDISP(INSTCTR);/* MOVE DISPLACEMENT VAL     00968000
*                                      IN                            */ 00969000
         L     @10,MSGPTR                                          0268 00970000
         BCTR  @10,0                                               0268 00971000
         SLR   @05,@05                                             0268 00972000
         IC    @05,INDISP(@14,@10)                                 0268 00973000
         STH   @05,DISPIN2-56(@06)                                 0268 00974000
*         INSTTXT2(INSTCTR,1:VPDEL+1)=VPDETXT(1:VPDEL+1);          0269 00975000
         LA    @10,INSTTXT2-56(@06)                                0269 00976000
         L     @05,VPDEPT                                          0269 00977000
         EX    @11,@SM00623                                        0269 00978000
*         INSTTXT2(INSTCTR,VPDEL+1:VPDEL+1)=' ';/* INSERT BLANK      */ 00979000
         ALR   @11,@06                                             0270 00980000
         LA    @10,INSTTXT2-56(@11)                                0270 00981000
         MVI   0(@10),C' '                                         0270 00982000
*         INTPLPTR(INSTCTR)=ADDR(MSGINST2(INSTCTR));/* MOVE PTR TO PL*/ 00983000
         SLA   @14,2                                               0271 00984000
         LA    @06,MSGINST2-56(@06)                                0271 00985000
         L     @11,SIOINTPT                                        0271 00986000
         AL    @11,@CF00622                                        0271 00987000
         ST    @06,INTPLPTR(@14,@11)                               0271 00988000
*       END;                                                       0272 00989000
*     ELSE                                                         0273 00990000
*       RTNCODE=4;                  /* IF LEV NOT 1 OR 2 THEN ERROR  */ 00991000
         B     @RC00265                                            0273 00992000
@RF00265 LA    RTNCODE,4                                           0273 00993000
*/********************************************************************/ 00994000
*/*                                                                  */ 00995000
*/*                R  RETURN TO MAIN INSERT ROUTINE                  */ 00996000
*/*                                                                  */ 00997000
*/********************************************************************/ 00998000
*                                                                  0274 00999000
*EXITVPDE:                          /* LABEL USED TO BRANCH TO EXIT  */ 01000000
*   RETURN CODE(RTNCODE);           /* RETURN TO INSERT PROCESSOR    */ 01001000
@RC00265 DS    0H                                                  0274 01002000
@RC00257 DS    0H                                                  0274 01003000
EXITVPDE L     @14,12(,@13)                                        0274 01004000
         LM    @00,@12,20(@13)                                     0274 01005000
         BR    @14                                                 0274 01006000
*   END INSTVPDE;                   /* END OF ROUTINE                */ 01007000
*                                                                  0276 01008000
*/********************************************************************/ 01009000
*/*                                                                  */ 01010000
*/*    THE FOLLOWING PROCEDURE IS THE NUMBER INSERT ROUTINE.         */ 01011000
*/*    IT WILL BE INVOKED IF THE USER'S MESSAGE MUST INCLUDE THIS    */ 01012000
*/*    TYPE INSERT.  THE PRIMARY FUNCTIONS ARE:                      */ 01013000
*/*                                                                  */ 01014000
*/*        1.  LOCATE THE INSERT WITHIN IKJEGMSG                     */ 01015000
*/*        2.  PREPARE THE INSERT FOR INCLUSION                      */ 01016000
*/*                                                                  */ 01017000
*/********************************************************************/ 01018000
*/********************************************************************/ 01019000
*/*                                                                  */ 01020000
*/*INSTNUM:        E  NUMBER INSERT ROUTINE                          */ 01021000
*/*                                                                  */ 01022000
*/********************************************************************/ 01023000
*                                                                  0276 01024000
*INSTNUM:                                                          0276 01025000
*   PROCEDURE;                                                     0276 01026000
*                                                                  0276 01027000
INSTNUM  STM   @14,@12,@SA00007                                    0276 01028000
*/********************************************************************/ 01029000
*/*                                                                  */ 01030000
*/*                P  FIND INSERT AND PREPARE FOR INCLUSION          */ 01031000
*/*                                                                  */ 01032000
*/********************************************************************/ 01033000
*                                                                  0277 01034000
*   INDXTAB=INSERTPT;               /* ESTAB ADDRESSABILITY TO INST  */ 01035000
         L     @14,INSERTPT(,MSGCSECT)                             0277 01036000
         ST    @14,INDXTAB                                         0277 01037000
*   IF AMTINDX<INTPLPTR(INSTCTR) THEN/* SEE IF IN INDEX RANGE        */ 01038000
         L     @06,INSTCTR                                         0278 01039000
         SLA   @06,2                                               0278 01040000
         L     @14,AMTINDX(,@14)                                   0278 01041000
         L     @11,SIOINTPT                                        0278 01042000
         AL    @11,@CF00622                                        0278 01043000
         C     @14,INTPLPTR(@06,@11)                               0278 01044000
         BNL   @RF00278                                            0278 01045000
*     DO;                                                          0279 01046000
*       CALL BADPARM;               /* HAVE MESSAGE SENT OUT         */ 01047000
         BAL   @14,BADPARM                                         0280 01048000
*       GO TO EXITNUM;              /* GO TO EXIT OR ROUTINE         */ 01049000
         B     EXITNUM                                             0281 01050000
*     END;                                                         0282 01051000
*   INSTPTR=INDXPTR(INTPLPTR(INSTCTR));/* GET ADDRESS OR INSERT      */ 01052000
@RF00278 L     @14,INSTCTR                                         0283 01053000
         SLA   @14,2                                               0283 01054000
         L     @06,SIOINTPT                                        0283 01055000
         AL    @06,@CF00622                                        0283 01056000
         L     @14,INTPLPTR(@14,@06)                               0283 01057000
         SLA   @14,2                                               0283 01058000
         L     @06,INDXTAB                                         0283 01059000
         L     @14,INDXPTR-4(@14,@06)                              0283 01060000
         ST    @14,INSTPTR                                         0283 01061000
*   IF MSGINST(1)='FF'X THEN        /* TEST FOR MESSING INSERT       */ 01062000
         CLI   MSGINST(@14),X'FF'                                  0284 01063000
         BNE   @RF00284                                            0284 01064000
*     DO;                                                          0285 01065000
*       CALL BADPARM;               /* HAVE MESSAGE SENT OUT         */ 01066000
         BAL   @14,BADPARM                                         0286 01067000
*       GO TO EXITNUM;              /* GO TO EXIT OF ROUTINE         */ 01068000
         B     EXITNUM                                             0287 01069000
*     END;                                                         0288 01070000
*   IF LEV=1 THEN                   /* TEST FOR FIRST LEVEL          */ 01071000
@RF00284 CLI   LEV,1                                               0289 01072000
         BNE   @RF00289                                            0289 01073000
*     DO;                                                          0290 01074000
*       MSGINST1(INSTCTR)=MSGINST;  /* MOVE INSERT TO WORKAREA       */ 01075000
         L     @14,INSTCTR                                         0291 01076000
         LR    @06,@14                                             0291 01077000
         MH    @06,@CH00617                                        0291 01078000
         LA    @11,MSGINST1-56(@06)                                0291 01079000
         MVI   54(@11),C' '                                        0291 01080000
         MVI   55(@11),C' '                                        0291 01081000
         L     @10,INSTPTR                                         0291 01082000
         MVC   0(54,@11),MSGINST(@10)                              0291 01083000
*       DISPIN1(INSTCTR)=INDISP(INSTCTR);/* MOVE DISPLACE VALUE IN   */ 01084000
         L     @11,MSGPTR                                          0292 01085000
         BCTR  @11,0                                               0292 01086000
         SLR   @10,@10                                             0292 01087000
         IC    @10,INDISP(@14,@11)                                 0292 01088000
         STH   @10,DISPIN1-56(@06)                                 0292 01089000
*       INTPLPTR(INSTCTR)=ADDR(MSGINST1(INSTCTR));/* MOVE ADDR TO PL */ 01090000
         SLA   @14,2                                               0293 01091000
         LA    @06,MSGINST1-56(@06)                                0293 01092000
         L     @11,SIOINTPT                                        0293 01093000
         AL    @11,@CF00622                                        0293 01094000
         ST    @06,INTPLPTR(@14,@11)                               0293 01095000
*     END;                                                         0294 01096000
*   ELSE                                                           0295 01097000
*     IF LEV=2 THEN                 /* TEST FOR SECOND LEVEL         */ 01098000
         B     @RC00289                                            0295 01099000
@RF00289 CLI   LEV,2                                               0295 01100000
         BNE   @RF00295                                            0295 01101000
*       DO;                                                        0296 01102000
*         MSGINST2(INSTCTR)=MSGINST;/* MOVE INSERT TO WORKAREA       */ 01103000
         L     @14,INSTCTR                                         0297 01104000
         LR    @06,@14                                             0297 01105000
         MH    @06,@CH00617                                        0297 01106000
         LA    @11,MSGINST2-56(@06)                                0297 01107000
         MVI   54(@11),C' '                                        0297 01108000
         MVI   55(@11),C' '                                        0297 01109000
         L     @10,INSTPTR                                         0297 01110000
         MVC   0(54,@11),MSGINST(@10)                              0297 01111000
*         DISPIN2(INSTCTR)=INDISP(INSTCTR);/* MOVE DISPLACE VALUE IN */ 01112000
         L     @11,MSGPTR                                          0298 01113000
         BCTR  @11,0                                               0298 01114000
         SLR   @10,@10                                             0298 01115000
         IC    @10,INDISP(@14,@11)                                 0298 01116000
         STH   @10,DISPIN2-56(@06)                                 0298 01117000
*         INTPLPTR(INSTCTR)=ADDR(MSGINST2(INSTCTR));/* MOVE ADDR TO     01118000
*                                      PL                            */ 01119000
         SLA   @14,2                                               0299 01120000
         LA    @06,MSGINST2-56(@06)                                0299 01121000
         L     @11,SIOINTPT                                        0299 01122000
         AL    @11,@CF00622                                        0299 01123000
         ST    @06,INTPLPTR(@14,@11)                               0299 01124000
*       END;                                                       0300 01125000
*     ELSE                                                         0301 01126000
*       RTNCODE=4;                  /* IF LEV NOT 1 OR 2 THEN ERROR  */ 01127000
         B     @RC00295                                            0301 01128000
@RF00295 LA    RTNCODE,4                                           0301 01129000
*/********************************************************************/ 01130000
*/*                                                                  */ 01131000
*/*EXITNUM:        R  RETURN TO MAIN INSERT ROUTINE                  */ 01132000
*/*                                                                  */ 01133000
*/********************************************************************/ 01134000
*                                                                  0302 01135000
*EXITNUM:                           /* LABEL TO EXIT ROUTINE         */ 01136000
*   RETURN CODE(RTNCODE);           /* RETURN TO INSERT ROUTINE      */ 01137000
@RC00295 DS    0H                                                  0302 01138000
@RC00289 DS    0H                                                  0302 01139000
EXITNUM  L     @14,@SA00007                                        0302 01140000
         LM    @00,@12,@SA00007+8                                  0302 01141000
         BR    @14                                                 0302 01142000
*   END INSTNUM;                                                   0303 01143000
*                                                                  0304 01144000
*/********************************************************************/ 01145000
*/*                                                                  */ 01146000
*/*    THE FOLLOWING PROCEDURE IS THE PREFORMMATTED USER'S INSERT R. */ 01147000
*/*    IT WILL BE INVOKED IF THE USER'S MESSAGE MUST INCLUDE THIS    */ 01148000
*/*    TYPE INSERT.  THE PRIMARY FUNCTION IS:                        */ 01149000
*/*                                                                  */ 01150000
*/*        1.  PREPARE THE INSERT FOR INCLUSION                      */ 01151000
*/*                                                                  */ 01152000
*/********************************************************************/ 01153000
*/********************************************************************/ 01154000
*/*                                                                  */ 01155000
*/*INSTADDR:       E  ADDR BUILD INSERT ROUTINE                      */ 01156000
*/*                P  PREPARE INSERT FOR INCLUSION                   */ 01157000
*/*                                                                  */ 01158000
*/********************************************************************/ 01159000
*                                                                  0304 01160000
*INSTADDR:                                                         0304 01161000
*   PROCEDURE;                                                     0304 01162000
INSTADDR STM   @14,@12,12(@13)                                     0304 01163000
*   INSTPTR=INTPLPTR(INSTCTR);      /* OBTAIN ADDRESS FOR MOVE       */ 01164000
         L     @14,INSTCTR                                         0305 01165000
         SLA   @14,2                                               0305 01166000
         L     @06,SIOINTPT                                        0305 01167000
         AL    @06,@CF00622                                        0305 01168000
         L     @14,INTPLPTR(@14,@06)                               0305 01169000
         ST    @14,INSTPTR                                         0305 01170000
*   IF INSTLEN>54 THEN              /* MAKE SURE LENGTH IS LESS-MAX  */ 01171000
         LA    @06,54                                              0306 01172000
         CH    @06,INSTLEN(,@14)                                   0306 01173000
         BNL   @RF00306                                            0306 01174000
*     INSTLEN=54;                   /* REDUCE TO MAXIMUM             */ 01175000
         STH   @06,INSTLEN(,@14)                                   0307 01176000
*   IF LEV=1 THEN                   /* TEST FOR MSG LEVEL 1          */ 01177000
@RF00306 CLI   LEV,1                                               0308 01178000
         BNE   @RF00308                                            0308 01179000
*     DO;                                                          0309 01180000
*       MSGINST1(INSTCTR,1:INSTLEN)=MSGINST;/* MOVE INSERT TO WKAREA */ 01181000
         L     @14,INSTCTR                                         0310 01182000
         LR    @06,@14                                             0310 01183000
         MH    @06,@CH00617                                        0310 01184000
         LA    @11,MSGINST1-56(@06)                                0310 01185000
         L     @10,INSTPTR                                         0310 01186000
         LH    @05,INSTLEN(,@10)                                   0310 01187000
         BCTR  @05,0                                               0310 01188000
         EX    @05,@SM00625                                        0310 01189000
*       DISPIN1(INSTCTR)=INDISP(INSTCTR);/* MOVE IN THE DISPLACEMENT */ 01190000
         L     @11,MSGPTR                                          0311 01191000
         BCTR  @11,0                                               0311 01192000
         SLR   @10,@10                                             0311 01193000
         IC    @10,INDISP(@14,@11)                                 0311 01194000
         STH   @10,DISPIN1-56(@06)                                 0311 01195000
*       INTPLPTR(INSTCTR)=ADDR(MSGINST1(INSTCTR));/* MOVE ADDR TO PL */ 01196000
         SLA   @14,2                                               0312 01197000
         LA    @06,MSGINST1-56(@06)                                0312 01198000
         L     @11,SIOINTPT                                        0312 01199000
         AL    @11,@CF00622                                        0312 01200000
         ST    @06,INTPLPTR(@14,@11)                               0312 01201000
*     END;                                                         0313 01202000
*   ELSE                                                           0314 01203000
*     IF LEV=2 THEN                 /* TEST FOR MSG LEVEL 2          */ 01204000
         B     @RC00308                                            0314 01205000
@RF00308 CLI   LEV,2                                               0314 01206000
         BNE   @RF00314                                            0314 01207000
*       DO;                                                        0315 01208000
*         MSGINST2(INSTCTR,1:INSTLEN)=MSGINST;/* MOVE INSERT TO    0316 01209000
*                                      WKAREA                        */ 01210000
         L     @14,INSTCTR                                         0316 01211000
         LR    @06,@14                                             0316 01212000
         MH    @06,@CH00617                                        0316 01213000
         LA    @11,MSGINST2-56(@06)                                0316 01214000
         L     @10,INSTPTR                                         0316 01215000
         LH    @05,INSTLEN(,@10)                                   0316 01216000
         BCTR  @05,0                                               0316 01217000
         EX    @05,@SM00625                                        0316 01218000
*         DISPIN2(INSTCTR)=INDISP(INSTCTR);/* MOVE IN THE          0317 01219000
*                                      DISPLACEMENT                  */ 01220000
         L     @11,MSGPTR                                          0317 01221000
         BCTR  @11,0                                               0317 01222000
         SLR   @10,@10                                             0317 01223000
         IC    @10,INDISP(@14,@11)                                 0317 01224000
         STH   @10,DISPIN2-56(@06)                                 0317 01225000
*         INTPLPTR(INSTCTR)=ADDR(MSGINST2(INSTCTR));/* MOVE ADDR TO     01226000
*                                      PL                            */ 01227000
         SLA   @14,2                                               0318 01228000
         LA    @06,MSGINST2-56(@06)                                0318 01229000
         L     @11,SIOINTPT                                        0318 01230000
         AL    @11,@CF00622                                        0318 01231000
         ST    @06,INTPLPTR(@14,@11)                               0318 01232000
*       END;                                                       0319 01233000
*     ELSE                                                         0320 01234000
*       RTNCODE=4;                  /* IF NOT LEV 1 OR 2 SOMEHOW ER  */ 01235000
         B     @RC00314                                            0320 01236000
@RF00314 LA    RTNCODE,4                                           0320 01237000
*/********************************************************************/ 01238000
*/*                                                                  */ 01239000
*/*EXITADDR:       R  RETURN TO MAIN INSERT ROUTINE                  */ 01240000
*/*                                                                  */ 01241000
*/********************************************************************/ 01242000
*                                                                  0321 01243000
*EXITADDR:                          /* LABEL TO BRANCH TO EXIT       */ 01244000
*   RETURN CODE(RTNCODE);           /* RETURN TO INSERT ROUTINE      */ 01245000
@RC00314 DS    0H                                                  0321 01246000
@RC00308 DS    0H                                                  0321 01247000
EXITADDR L     @14,12(,@13)                                        0321 01248000
         LM    @00,@12,20(@13)                                     0321 01249000
         BR    @14                                                 0321 01250000
*   END INSTADDR;                   /* END OF ROUTINE                */ 01251000
*                                                                  0323 01252000
*/********************************************************************/ 01253000
*/*                                                                  */ 01254000
*/*    THE FOLLOWING PROCEDURE IS THE  UNFORMMATTED USER'S INSERT R. */ 01255000
*/*    IT WILL BE INVOKED IF THE USER'S MESSAGE MUST INCLUDE THIS    */ 01256000
*/*    TYPE INSERT.  THE PRIMARY FUNCTIONS ARE:                      */ 01257000
*/*                                                                  */ 01258000
*/*        1.  CALL IKJEGCVT TO CONVERT INSERT TO PRINTABLE CHAR.    */ 01259000
*/*        2.  PREPARE THE INSERT FOR INCLUSION                      */ 01260000
*/*                                                                  */ 01261000
*/********************************************************************/ 01262000
*/********************************************************************/ 01263000
*/*                                                                  */ 01264000
*/*INSTADDX:       E  ADDRCONV BUILD INSERT ROUTINE                  */ 01265000
*/*                P  CONVERT TEXT TO PRINTABLE CHARACTERS           */ 01266000
*/*                P  PREPARE INSERT FOR INCLUSION                   */ 01267000
*/*                                                                  */ 01268000
*/********************************************************************/ 01269000
*                                                                  0323 01270000
*INSTADDX:                                                         0323 01271000
*   PROCEDURE;                                                     0323 01272000
INSTADDX STM   @14,@12,@SA00009                                    0323 01273000
*   INSTPTR=INTPLPTR(INSTCTR);      /* OBTAIN INSERT ADDRESS         */ 01274000
         L     @14,INSTCTR                                         0324 01275000
         SLA   @14,2                                               0324 01276000
         L     @06,SIOINTPT                                        0324 01277000
         AL    @06,@CF00622                                        0324 01278000
         L     @14,INTPLPTR(@14,@06)                               0324 01279000
         ST    @14,INSTPTR                                         0324 01280000
*   IF INSTLEN>54 THEN              /* SEE IF CALL FOR MORE THAN MX  */ 01281000
         LA    @06,54                                              0325 01282000
         CH    @06,INSTLEN(,@14)                                   0325 01283000
         BNL   @RF00325                                            0325 01284000
*     INSTLEN=54;                   /* IF SO REDUCE TO MAX           */ 01285000
         STH   @06,INSTLEN(,@14)                                   0326 01286000
*   VPDEL=(INSTLEN-4)/2;            /* CALCULATE LENGTH FOR CVT      */ 01287000
@RF00325 LA    @14,4                                               0327 01288000
         L     @06,INSTPTR                                         0327 01289000
         LH    @04,INSTLEN(,@06)                                   0327 01290000
         SLR   @04,@14                                             0327 01291000
         SRDA  @04,32                                              0327 01292000
         D     @04,@CF00119                                        0327 01293000
         STH   @05,VPDEL                                           0327 01294000
*   VPDEPT=INSTPTR+4+VPDEL;         /* ADJUST & SET UP ADDR OF DATA  */ 01295000
         ALR   @06,@14                                             0328 01296000
         ALR   @06,@05                                             0328 01297000
         ST    @06,VPDEPT                                          0328 01298000
*   VPDET='04'X;                    /* INDICATE THAT NEED DATA HEX   */ 01299000
         MVI   VPDET,X'04'                                         0329 01300000
*   PRMREG0=-1;                     /* INDICATE THAT RESULTS BE PRT  */ 01301000
         SLR   PRMREG0,PRMREG0                                     0330 01302000
         BCTR  PRMREG0,0                                           0330 01303000
*   PRMREG1=ADDR(VPDE);             /* PASS ADDR OF PDE IN REG 1     */ 01304000
         LA    PRMREG1,VPDE                                        0331 01305000
*   CALL CONVROUT;                  /* CALL IKJEGCVT TO CONVERT DAT  */ 01306000
         L     @15,TSTCONVT                                        0332 01307000
         BALR  @14,@15                                             0332 01308000
*   IF RTNCODE=0 THEN              /* TEST FOR SUCCESS OF REQ'T     */ 01309000
         LTR   RTNCODE,RTNCODE                                     0333 01310000
         BNZ   @RT00333                                            0333 01311000
*     GO TO EXITADDX;               /* BRANCH TO EXIT IF ERROR       */ 01312000
*   IF LEV=1 THEN                   /* SEE IF WE'RE WORKING OF 1ST   */ 01313000
         CLI   LEV,1                                               0335 01314000
         BNE   @RF00335                                            0335 01315000
*     DO;                                                          0336 01316000
*       LENINST1(INSTCTR)=CONLEN+5; /* CALCULATE LEN OR INST         */ 01317000
         L     @14,INSTCTR                                         0337 01318000
         LR    @06,@14                                             0337 01319000
         MH    @06,@CH00617                                        0337 01320000
         L     @11,CONAREA                                         0337 01321000
         SLR   @10,@10                                             0337 01322000
         IC    @10,CONLEN(,@11)                                    0337 01323000
         LA    @05,5                                               0337 01324000
         ALR   @05,@10                                             0337 01325000
         STH   @05,LENINST1-56(@06)                                0337 01326000
*       DISPIN1(INSTCTR)=INDISP(INSTCTR);/* MOVE DISPLACEMENT VAL IN */ 01327000
         L     @05,MSGPTR                                          0338 01328000
         BCTR  @05,0                                               0338 01329000
         SLR   @04,@04                                             0338 01330000
         IC    @04,INDISP(@14,@05)                                 0338 01331000
         STH   @04,DISPIN1-56(@06)                                 0338 01332000
*       INSTTXT1(INSTCTR)=CONTXT;   /* MOVE IN INST CONVERTED TEXT   */ 01333000
         LA    @05,INSTTXT1-56(@06)                                0339 01334000
         MVI   31(@05),C' '                                        0339 01335000
         MVC   32(20,@05),31(@05)                                  0339 01336000
         MVC   0(31,@05),CONTXT(@11)                               0339 01337000
*       INSTTXT1(INSTCTR,CONLEN+1:CONLEN+1)=' ';/* INSERT BLANK      */ 01338000
         ALR   @10,@06                                             0340 01339000
         LA    @11,INSTTXT1-56(@10)                                0340 01340000
         MVI   0(@11),C' '                                         0340 01341000
*       INTPLPTR(INSTCTR)=ADDR(MSGINST1(INSTCTR));/* MOVE PTR TO PL  */ 01342000
         SLA   @14,2                                               0341 01343000
         LA    @06,MSGINST1-56(@06)                                0341 01344000
         L     @11,SIOINTPT                                        0341 01345000
         AL    @11,@CF00622                                        0341 01346000
         ST    @06,INTPLPTR(@14,@11)                               0341 01347000
*     END;                                                         0342 01348000
*   ELSE                                                           0343 01349000
*     IF LEV=2 THEN                 /* SEE IF WE'RE WORKING OF 2ND   */ 01350000
         B     @RC00335                                            0343 01351000
@RF00335 CLI   LEV,2                                               0343 01352000
         BNE   @RF00343                                            0343 01353000
*       DO;                                                        0344 01354000
*         LENINST2(INSTCTR)=CONLEN+5;/* CALCULATE LENGTH OR INST     */ 01355000
         L     @14,INSTCTR                                         0345 01356000
         LR    @06,@14                                             0345 01357000
         MH    @06,@CH00617                                        0345 01358000
         L     @11,CONAREA                                         0345 01359000
         SLR   @10,@10                                             0345 01360000
         IC    @10,CONLEN(,@11)                                    0345 01361000
         LA    @05,5                                               0345 01362000
         ALR   @05,@10                                             0345 01363000
         STH   @05,LENINST2-56(@06)                                0345 01364000
*         DISPIN2(INSTCTR)=INDISP(INSTCTR);/* MOVE DISPLACEMENT VAL     01365000
*                                      IN                            */ 01366000
         L     @05,MSGPTR                                          0346 01367000
         BCTR  @05,0                                               0346 01368000
         SLR   @04,@04                                             0346 01369000
         IC    @04,INDISP(@14,@05)                                 0346 01370000
         STH   @04,DISPIN2-56(@06)                                 0346 01371000
*         INSTTXT2(INSTCTR)=CONTXT; /* MOVE IN INST CONVERTED TEXT   */ 01372000
         LA    @05,INSTTXT2-56(@06)                                0347 01373000
         MVI   31(@05),C' '                                        0347 01374000
         MVC   32(20,@05),31(@05)                                  0347 01375000
         MVC   0(31,@05),CONTXT(@11)                               0347 01376000
*         INSTTXT2(INSTCTR,CONLEN+1:CONLEN+1)=' ';/* INSERT BLANK    */ 01377000
         ALR   @10,@06                                             0348 01378000
         LA    @11,INSTTXT2-56(@10)                                0348 01379000
         MVI   0(@11),C' '                                         0348 01380000
*         INTPLPTR(INSTCTR)=ADDR(MSGINST2(INSTCTR));/* MOVE PTR TO PL*/ 01381000
         SLA   @14,2                                               0349 01382000
         LA    @06,MSGINST2-56(@06)                                0349 01383000
         L     @11,SIOINTPT                                        0349 01384000
         AL    @11,@CF00622                                        0349 01385000
         ST    @06,INTPLPTR(@14,@11)                               0349 01386000
*       END;                                                       0350 01387000
*     ELSE                                                         0351 01388000
*       RTNCODE=4;                  /* IF LEV NOT 1 OR 2 THEN ERROR  */ 01389000
         B     @RC00343                                            0351 01390000
@RF00343 LA    RTNCODE,4                                           0351 01391000
*/********************************************************************/ 01392000
*/*                                                                  */ 01393000
*/*                R  RETURN TO MAIN INSERT ROUTINE                  */ 01394000
*/*                                                                  */ 01395000
*/********************************************************************/ 01396000
*                                                                  0352 01397000
*EXITADDX:                          /* LABEL USED TO BRANCH TO EXIT  */ 01398000
*   RETURN CODE(RTNCODE);           /* RETURN TO INSERT PROCESSOR    */ 01399000
@RC00343 DS    0H                                                  0352 01400000
@RC00335 DS    0H                                                  0352 01401000
EXITADDX L     @14,@SA00009                                        0352 01402000
         LM    @00,@12,@SA00009+8                                  0352 01403000
         BR    @14                                                 0352 01404000
*   END INSTADDX;                   /* END OF ROUTINE                */ 01405000
*                                                                  0354 01406000
*/********************************************************************/ 01407000
*/*                                                                  */ 01408000
*/*    THE FOLLOWING PROCEDURE IS THE  UNFORMMATTED USER'S INSERT R. */ 01409000
*/*    IT WILL BE INVOKED IF THE USER'S MESSAGE MUST INCLUDE THIS    */ 01410000
*/*    TYPE INSERT.  THE PRIMARY FUNCTIONS ARE:                      */ 01411000
*/*                                                                  */ 01412000
*/*        1.  CALL IKJEGCVT TO CONVERT INSERT TO PRINTABLE CHAR.    */ 01413000
*/*        2.  PREPARE THE INSERT FOR INCLUSION                      */ 01414000
*/*                                                                  */ 01415000
*/********************************************************************/ 01416000
*/********************************************************************/ 01417000
*/*                                                                  */ 01418000
*/*INSTADDD:       E  INSTADDD BUILD INSERT ROUTINE                  */ 01419000
*/*                P  CONVERT TEXT TO DECIMAL PRINTABLE CHARACTERS   */ 01420000
*/*                P  PREPARE INSERT FOR INCLUSION                   */ 01421000
*/*                                                                  */ 01422000
*/********************************************************************/ 01423000
*                                                                  0354 01424000
*INSTADDD:                                                         0354 01425000
*   PROCEDURE;                                                     0354 01426000
INSTADDD STM   @14,@12,@SA00010                                    0354 01427000
*   INSTPTR=INTPLPTR(INSTCTR);      /* OBTAIN INSERT ADDRESS         */ 01428000
         L     @14,INSTCTR                                         0355 01429000
         SLA   @14,2                                               0355 01430000
         L     @06,SIOINTPT                                        0355 01431000
         AL    @06,@CF00622                                        0355 01432000
         L     @14,INTPLPTR(@14,@06)                               0355 01433000
         ST    @14,INSTPTR                                         0355 01434000
*   IF INSTLEN>54 THEN              /* MAKE SURE INSERT UNDER MAX    */ 01435000
         LA    @06,54                                              0356 01436000
         CH    @06,INSTLEN(,@14)                                   0356 01437000
         BNL   @RF00356                                            0356 01438000
*     INSTLEN=54;                   /* IF NOT REDUCE IT              */ 01439000
         STH   @06,INSTLEN(,@14)                                   0357 01440000
*   VPDEL=(INSTLEN-4)/2;            /* CALCULATE LENGTH FOR CVT      */ 01441000
@RF00356 LA    @14,4                                               0358 01442000
         L     @06,INSTPTR                                         0358 01443000
         LH    @04,INSTLEN(,@06)                                   0358 01444000
         SLR   @04,@14                                             0358 01445000
         SRDA  @04,32                                              0358 01446000
         D     @04,@CF00119                                        0358 01447000
         STH   @05,VPDEL                                           0358 01448000
*   VPDEPT=INSTPTR+4+VPDEL;         /* ADJUST & SET UP ADDR OF DATA  */ 01449000
         ALR   @06,@14                                             0359 01450000
         ALR   @06,@05                                             0359 01451000
         ST    @06,VPDEPT                                          0359 01452000
*   VPDET='10'X;                    /* INDICATE THAT NEED DATA DEC   */ 01453000
         MVI   VPDET,X'10'                                         0360 01454000
*   PRMREG0=-1;                     /* INDICATE THAT RESULTS BE PRT  */ 01455000
         SLR   PRMREG0,PRMREG0                                     0361 01456000
         BCTR  PRMREG0,0                                           0361 01457000
*   PRMREG1=ADDR(VPDE);             /* PASS ADDR OF PDE IN REG 1     */ 01458000
         LA    PRMREG1,VPDE                                        0362 01459000
*   CALL CONVROUT;                  /* CALL IKJEGCVT TO CONVERT DAT  */ 01460000
         L     @15,TSTCONVT                                        0363 01461000
         BALR  @14,@15                                             0363 01462000
*   IF RTNCODE=0 THEN              /* TEST FOR SUCCESS OF REQ'T     */ 01463000
         LTR   RTNCODE,RTNCODE                                     0364 01464000
         BNZ   @RT00364                                            0364 01465000
*     GO TO EXITADDD;               /* BRANCH TO EXIT IF ERROR       */ 01466000
*   IF LEV=1 THEN                   /* SEE IF WE'RE WORKING OF 1ST   */ 01467000
         CLI   LEV,1                                               0366 01468000
         BNE   @RF00366                                            0366 01469000
*     DO;                                                          0367 01470000
*       LENINST1(INSTCTR)=CONLEN+5; /* CALCULATE LENGTH OF INSERT    */ 01471000
         L     @14,INSTCTR                                         0368 01472000
         LR    @06,@14                                             0368 01473000
         MH    @06,@CH00617                                        0368 01474000
         L     @11,CONAREA                                         0368 01475000
         SLR   @10,@10                                             0368 01476000
         IC    @10,CONLEN(,@11)                                    0368 01477000
         LA    @05,5                                               0368 01478000
         ALR   @05,@10                                             0368 01479000
         STH   @05,LENINST1-56(@06)                                0368 01480000
*       DISPIN1(INSTCTR)=INDISP(INSTCTR);/* MOVE DISPLACEMENT VAL IN */ 01481000
         L     @05,MSGPTR                                          0369 01482000
         BCTR  @05,0                                               0369 01483000
         SLR   @04,@04                                             0369 01484000
         IC    @04,INDISP(@14,@05)                                 0369 01485000
         STH   @04,DISPIN1-56(@06)                                 0369 01486000
*       INSTTXT1(INSTCTR)=CONTXT;   /* MOVE IN INST CONVERTED TEXT   */ 01487000
         LA    @05,INSTTXT1-56(@06)                                0370 01488000
         MVI   31(@05),C' '                                        0370 01489000
         MVC   32(20,@05),31(@05)                                  0370 01490000
         MVC   0(31,@05),CONTXT(@11)                               0370 01491000
*       INSTTXT1(INSTCTR,CONLEN+1:CONLEN+1)=' ';/* INSERT BLANK      */ 01492000
         ALR   @10,@06                                             0371 01493000
         LA    @11,INSTTXT1-56(@10)                                0371 01494000
         MVI   0(@11),C' '                                         0371 01495000
*       INTPLPTR(INSTCTR)=ADDR(MSGINST1(INSTCTR));/* MOVE PTR TO PL  */ 01496000
         SLA   @14,2                                               0372 01497000
         LA    @06,MSGINST1-56(@06)                                0372 01498000
         L     @11,SIOINTPT                                        0372 01499000
         AL    @11,@CF00622                                        0372 01500000
         ST    @06,INTPLPTR(@14,@11)                               0372 01501000
*     END;                                                         0373 01502000
*   ELSE                                                           0374 01503000
*     IF LEV=2 THEN                 /* SEE IF WE'RE WORKING OF 2ND   */ 01504000
         B     @RC00366                                            0374 01505000
@RF00366 CLI   LEV,2                                               0374 01506000
         BNE   @RF00374                                            0374 01507000
*       DO;                                                        0375 01508000
*         LENINST2(INSTCTR)=CONLEN+5;/* CALCULATE LENGTH OF INSERT   */ 01509000
         L     @14,INSTCTR                                         0376 01510000
         LR    @06,@14                                             0376 01511000
         MH    @06,@CH00617                                        0376 01512000
         L     @11,CONAREA                                         0376 01513000
         SLR   @10,@10                                             0376 01514000
         IC    @10,CONLEN(,@11)                                    0376 01515000
         LA    @05,5                                               0376 01516000
         ALR   @05,@10                                             0376 01517000
         STH   @05,LENINST2-56(@06)                                0376 01518000
*         DISPIN2(INSTCTR)=INDISP(INSTCTR);/* MOVE DISPLACEMENT VAL     01519000
*                                      IN                            */ 01520000
         L     @05,MSGPTR                                          0377 01521000
         BCTR  @05,0                                               0377 01522000
         SLR   @04,@04                                             0377 01523000
         IC    @04,INDISP(@14,@05)                                 0377 01524000
         STH   @04,DISPIN2-56(@06)                                 0377 01525000
*         INSTTXT2(INSTCTR)=CONTXT; /* MOVE IN INST CONVERTED TEXT   */ 01526000
         LA    @05,INSTTXT2-56(@06)                                0378 01527000
         MVI   31(@05),C' '                                        0378 01528000
         MVC   32(20,@05),31(@05)                                  0378 01529000
         MVC   0(31,@05),CONTXT(@11)                               0378 01530000
*         INSTTXT2(INSTCTR,CONLEN+1:CONLEN+1)=' ';/* INSERT BLANK    */ 01531000
         ALR   @10,@06                                             0379 01532000
         LA    @11,INSTTXT2-56(@10)                                0379 01533000
         MVI   0(@11),C' '                                         0379 01534000
*         INTPLPTR(INSTCTR)=ADDR(MSGINST2(INSTCTR));/* MOVE PTR TO PL*/ 01535000
         SLA   @14,2                                               0380 01536000
         LA    @06,MSGINST2-56(@06)                                0380 01537000
         L     @11,SIOINTPT                                        0380 01538000
         AL    @11,@CF00622                                        0380 01539000
         ST    @06,INTPLPTR(@14,@11)                               0380 01540000
*       END;                                                       0381 01541000
*     ELSE                                                         0382 01542000
*       RTNCODE=4;                  /* IF LEV NOT 1 OR 2 THEN ERROR  */ 01543000
         B     @RC00374                                            0382 01544000
@RF00374 LA    RTNCODE,4                                           0382 01545000
*/********************************************************************/ 01546000
*/*                                                                  */ 01547000
*/*                R  RETURN TO MAIN INSERT ROUTINE                  */ 01548000
*/*                                                                  */ 01549000
*/********************************************************************/ 01550000
*                                                                  0383 01551000
*EXITADDD:                          /* LABEL USED TO BRANCH TO EXIT  */ 01552000
*   RETURN CODE(RTNCODE);           /* RETURN TO INSERT PROCESSOR    */ 01553000
@RC00374 DS    0H                                                  0383 01554000
@RC00366 DS    0H                                                  0383 01555000
EXITADDD L     @14,@SA00010                                        0383 01556000
         LM    @00,@12,@SA00010+8                                  0383 01557000
         BR    @14                                                 0383 01558000
*   END INSTADDD;                   /* END OF ROUTINE                */ 01559000
*                                                                  0385 01560000
*/********************************************************************/ 01561000
*/*                                                                  */ 01562000
*/*    THE FOLLOWING PROCEDURE IS THE  REGISTER TYPE USER'S INSERT R.*/ 01563000
*/*    IT WILL BE INVOKED IF THE USER'S MESSAGE MUST INCLUDE THIS    */ 01564000
*/*    TYPE INSERT.  THE PRIMARY FUNCTIONS ARE:                      */ 01565000
*/*                                                                  */ 01566000
*/*        1.  CALL IKJEGCVT TO CONVERT INSERT TO PRINTABLE CHAR.    */ 01567000
*/*        2.  PREPARE THE INSERT FOR INCLUSION                      */ 01568000
*/*                                                                  */ 01569000
*/********************************************************************/ 01570000
*/********************************************************************/ 01571000
*/*                                                                  */ 01572000
*/*INSTREG:        E  REGISTER INSERT BUILD ROUTINE                  */ 01573000
*/*                P  COUNT LEADING ZEROS                            */ 01574000
*/*                P  ADJUST POINTER TO FIRST NON-ZERO NUMBER        */ 01575000
*/*                                                                  */ 01576000
*/********************************************************************/ 01577000
*                                                                  0385 01578000
*INSTREG:                                                          0385 01579000
*   PROCEDURE;                                                     0385 01580000
INSTREG  STM   @14,@12,@SA00011                                    0385 01581000
*   DCL                                                            0386 01582000
*     ZEROTEST FIXED(8) BASED(REGPTR);/* SETUP STRUCTURE-COMPARE 0'S */ 01583000
*   DCL                                                            0387 01584000
*     ZEROCTR FIXED(31);            /* SETUP STRUCTURE-COMPARE 0'S   */ 01585000
*   DCL                                                            0388 01586000
*     REGPTR PTR(31);               /* VAR TO POINT TO DATA CVT R.   */ 01587000
*   REGPTR=ADDR(INTPLPTR(INSTCTR)); /* ESTAB ADDRESS TO CONTENTS     */ 01588000
         L     @14,INSTCTR                                         0389 01589000
         SLA   @14,2                                               0389 01590000
         L     @06,SIOINTPT                                        0389 01591000
         AL    @06,@CF00622                                        0389 01592000
         LA    @14,INTPLPTR(@14,@06)                               0389 01593000
         ST    @14,REGPTR                                          0389 01594000
*   DO ZEROCTR=0 TO 2 WHILE ZEROTEST=0;/* MOVE DOWN STRING UNTIL=0  */ 01595000
         SLR   @14,@14                                             0390 01596000
         ST    @14,ZEROCTR                                         0390 01597000
@DL00390 L     @06,REGPTR                                          0390 01598000
         CLI   ZEROTEST(@06),0                                     0390 01599000
         BNE   @DC00390                                            0390 01600000
*     REGPTR=REGPTR+1;              /* INCREMENT TO NEXT BYTE        */ 01601000
         AH    @06,@CH00115                                        0391 01602000
         ST    @06,REGPTR                                          0391 01603000
*   END;                                                           0392 01604000
*                                                                  0392 01605000
         AH    @14,@CH00115                                        0392 01606000
         ST    @14,ZEROCTR                                         0392 01607000
         CH    @14,@CH00119                                        0392 01608000
         BNH   @DL00390                                            0392 01609000
@DC00390 DS    0H                                                  0393 01610000
*/********************************************************************/ 01611000
*/*                                                                  */ 01612000
*/*                P  MOVE AND CONVERT TO PRINTABLE HEX TO INSERT    */ 01613000
*/*                P  PREPARE INSERT FOR INCLUSION                   */ 01614000
*/*                                                                  */ 01615000
*/********************************************************************/ 01616000
*                                                                  0393 01617000
*   VPDEL=4-ZEROCTR;                /* CALCULATE LENGTH FOR CVT      */ 01618000
         LA    @14,4                                               0393 01619000
         SL    @14,ZEROCTR                                         0393 01620000
         STH   @14,VPDEL                                           0393 01621000
*   VPDEPT=REGPTR;                  /* ADJUST & SET UP ADDR OF DATA  */ 01622000
         MVC   VPDEPT(4),REGPTR                                    0394 01623000
*   VPDET='04'X;                    /* INDICATE THAT DATA NEED HEX   */ 01624000
         MVI   VPDET,X'04'                                         0395 01625000
*   PRMREG0=-1;                     /* INDICATE THAT RESULTS BE HEX  */ 01626000
         SLR   PRMREG0,PRMREG0                                     0396 01627000
         BCTR  PRMREG0,0                                           0396 01628000
*   PRMREG1=ADDR(VPDE);             /* PASS ADDR OF PDE IN REG 1     */ 01629000
         LA    PRMREG1,VPDE                                        0397 01630000
*   CALL CONVROUT;                  /* CALL IKJEGCVT TO CONVERT DAT  */ 01631000
         L     @15,TSTCONVT                                        0398 01632000
         BALR  @14,@15                                             0398 01633000
*   IF RTNCODE=0 THEN              /* TEST FOR SUCCESS OF REQ'T     */ 01634000
         LTR   RTNCODE,RTNCODE                                     0399 01635000
         BNZ   @RT00399                                            0399 01636000
*     GO TO EXITREG;                /* BRANCH TO EXIT IF ERROR       */ 01637000
*   IF LEV=1 THEN                   /* SEE IF WE'RE WORKING OF 1ST   */ 01638000
         CLI   LEV,1                                               0401 01639000
         BNE   @RF00401                                            0401 01640000
*     DO;                                                          0402 01641000
*       LENINST1(INSTCTR)=CONLEN+5; /* CALCULATE LENGTH OR INST      */ 01642000
         L     @14,INSTCTR                                         0403 01643000
         LR    @06,@14                                             0403 01644000
         MH    @06,@CH00617                                        0403 01645000
         L     @11,CONAREA                                         0403 01646000
         SLR   @10,@10                                             0403 01647000
         IC    @10,CONLEN(,@11)                                    0403 01648000
         LA    @05,5                                               0403 01649000
         ALR   @05,@10                                             0403 01650000
         STH   @05,LENINST1-56(@06)                                0403 01651000
*       DISPIN1(INSTCTR)=INDISP(INSTCTR);/* MOVE DISPLACEMENT VAL IN */ 01652000
         L     @05,MSGPTR                                          0404 01653000
         BCTR  @05,0                                               0404 01654000
         SLR   @04,@04                                             0404 01655000
         IC    @04,INDISP(@14,@05)                                 0404 01656000
         STH   @04,DISPIN1-56(@06)                                 0404 01657000
*       INSTTXT1(INSTCTR)=CONTXT;   /* MOVE IN INST TXT              */ 01658000
         LA    @05,INSTTXT1-56(@06)                                0405 01659000
         MVI   31(@05),C' '                                        0405 01660000
         MVC   32(20,@05),31(@05)                                  0405 01661000
         MVC   0(31,@05),CONTXT(@11)                               0405 01662000
*       INSTTXT1(INSTCTR,CONLEN+1:CONLEN+1)=' ';/* INSERT BLANK      */ 01663000
         ALR   @10,@06                                             0406 01664000
         LA    @11,INSTTXT1-56(@10)                                0406 01665000
         MVI   0(@11),C' '                                         0406 01666000
*       INTPLPTR(INSTCTR)=ADDR(MSGINST1(INSTCTR));/* MOVE PTR TO PL  */ 01667000
         SLA   @14,2                                               0407 01668000
         LA    @06,MSGINST1-56(@06)                                0407 01669000
         L     @11,SIOINTPT                                        0407 01670000
         AL    @11,@CF00622                                        0407 01671000
         ST    @06,INTPLPTR(@14,@11)                               0407 01672000
*     END;                                                         0408 01673000
*   ELSE                                                           0409 01674000
*     IF LEV=2 THEN                 /* SEE IF WE'RE WORKING OF 2ND   */ 01675000
         B     @RC00401                                            0409 01676000
@RF00401 CLI   LEV,2                                               0409 01677000
         BNE   @RF00409                                            0409 01678000
*       DO;                                                        0410 01679000
*         LENINST2(INSTCTR)=CONLEN+5;/* CALCULATE LENGTH OR INST     */ 01680000
         L     @14,INSTCTR                                         0411 01681000
         LR    @06,@14                                             0411 01682000
         MH    @06,@CH00617                                        0411 01683000
         L     @11,CONAREA                                         0411 01684000
         SLR   @10,@10                                             0411 01685000
         IC    @10,CONLEN(,@11)                                    0411 01686000
         LA    @05,5                                               0411 01687000
         ALR   @05,@10                                             0411 01688000
         STH   @05,LENINST2-56(@06)                                0411 01689000
*         DISPIN2(INSTCTR)=INDISP(INSTCTR);/* MOVE DISPLACEMENT VAL     01690000
*                                      IN                            */ 01691000
         L     @05,MSGPTR                                          0412 01692000
         BCTR  @05,0                                               0412 01693000
         SLR   @04,@04                                             0412 01694000
         IC    @04,INDISP(@14,@05)                                 0412 01695000
         STH   @04,DISPIN2-56(@06)                                 0412 01696000
*         INSTTXT2(INSTCTR)=CONTXT; /* MOVE IN INST CONVERTED TEXT   */ 01697000
         LA    @05,INSTTXT2-56(@06)                                0413 01698000
         MVI   31(@05),C' '                                        0413 01699000
         MVC   32(20,@05),31(@05)                                  0413 01700000
         MVC   0(31,@05),CONTXT(@11)                               0413 01701000
*         INSTTXT2(INSTCTR,CONLEN+1:CONLEN+1)=' ';/* INSERT BLANK    */ 01702000
         ALR   @10,@06                                             0414 01703000
         LA    @11,INSTTXT2-56(@10)                                0414 01704000
         MVI   0(@11),C' '                                         0414 01705000
*         INTPLPTR(INSTCTR)=ADDR(MSGINST2(INSTCTR));/* MOVE PTR TO PL*/ 01706000
         SLA   @14,2                                               0415 01707000
         LA    @06,MSGINST2-56(@06)                                0415 01708000
         L     @11,SIOINTPT                                        0415 01709000
         AL    @11,@CF00622                                        0415 01710000
         ST    @06,INTPLPTR(@14,@11)                               0415 01711000
*       END;                                                       0416 01712000
*     ELSE                                                         0417 01713000
*       RTNCODE=4;                  /* IF LEV NOT 1 OR 2 THEN ERROR  */ 01714000
         B     @RC00409                                            0417 01715000
@RF00409 LA    RTNCODE,4                                           0417 01716000
*/********************************************************************/ 01717000
*/*                                                                  */ 01718000
*/*                R  RETURN TO MAIN INSERT ROUTINE                  */ 01719000
*/*                                                                  */ 01720000
*/********************************************************************/ 01721000
*                                                                  0418 01722000
*EXITREG:                           /* LABEL USED TO BRANCH TO EXIT  */ 01723000
*   RETURN CODE(RTNCODE);           /* RETURN TO INSERT PROCESSOR    */ 01724000
@RC00409 DS    0H                                                  0418 01725000
@RC00401 DS    0H                                                  0418 01726000
EXITREG  L     @14,@SA00011                                        0418 01727000
         LM    @00,@12,@SA00011+8                                  0418 01728000
         BR    @14                                                 0418 01729000
*   END INSTREG;                    /* END OF ROUTINE                */ 01730000
*                                                                  0420 01731000
*/********************************************************************/ 01732000
*/*                                                                  */ 01733000
*/*    THE FOLLOWING PROCEDURE IS THE SVC ERROR MESSAGE ROUTINE      */ 01734000
*/*    IT WILL BE INVOKED IF THE USER'S HAS REQUESTED AN SVC ERROR   */ 01735000
*/*    MESSAGE. THE PRIMARY FUNCTIONS ARE:                           */ 01736000
*/*                                                                  */ 01737000
*/*        1.  DETERMINE WHICH MESSAGE TO ISSUE                      */ 01738000
*/*        2.  PREPARE THE INSERTS FOR INCLUSION                     */ 01739000
*/*                                                                  */ 01740000
*/********************************************************************/ 01741000
*/********************************************************************/ 01742000
*/*                                                                  */ 01743000
*/*SVCERR:         E  SVC ERROR MESSAGE ROUTINE                      */ 01744000
*/*                                                                  */ 01745000
*/********************************************************************/ 01746000
*                                                                  0420 01747000
*SVCERR:                                                           0420 01748000
*   PROCEDURE;                                                     0420 01749000
*                                                                  0420 01750000
SVCERR   STM   @14,@12,@SA00012                                    0420 01751000
*/********************************************************************/ 01752000
*/*                                                                  */ 01753000
*/*  THE FOLLOWING DCL STRUCTURES WILL BE USED FOR SVCERR MESSAGES   */ 01754000
*/*                                                                  */ 01755000
*/********************************************************************/ 01756000
*                                                                  0421 01757000
*   DCL                                                            0421 01758000
*     SVCTABPR PTR(31) BDY(WORD);   /* TEMP POINTER - TAB SEARCHING  */ 01759000
*   DCL                                                            0422 01760000
*     SVCINDX FIXED(31) BDY(WORD);  /* INDEX VALUE FOR SVC SEARCH    */ 01761000
*   DCL                                                            0423 01762000
*     ABENDINX FIXED(31) BDY(WORD); /* INDEX VALUE FOR AB TAB SRCH   */ 01763000
*   DCL                                                            0424 01764000
*     RCODEINX FIXED(31) BDY(WORD); /* INDEX VALUE FOR RC TAB SRCH   */ 01765000
*   DCL                                                            0425 01766000
*     1 SVCTB1 BDY(WORD) BASED(SVCTABPR),/* STRUCTURE-AB TAB SRCH    */ 01767000
*      2 AB2NDLV1 PTR(31),          /* POINTER TO SEC LEV MSG        */ 01768000
*      2 ABCDTB1(*),                /* ARRAY FOR REPEAT OF LEV 3     */ 01769000
*       3 SVCNUM1 FIXED(31),        /* SVC NUMBER OR ZERO IF END     */ 01770000
*       3 ABTABPT1 PTR(31),         /* PTR TO TAB OF AB CODES        */ 01771000
*       3 SVCINST1 PTR(31);         /* PTR TO SVC NAME INSERT        */ 01772000
*   DCL                                                            0426 01773000
*     1 ABTAB1(*) BDY(WORD) BASED(ABTABPT1(SVCINDX)),/* AB TAB STRU. */ 01774000
*      2 ABCODE1 FIXED(31),         /* ABEND CODE OR ZERO IF END     */ 01775000
*      2 RCTABPT1 PTR(31),          /* POINTER TO RC TAB FOR SRCH    */ 01776000
*      2 ABCDINST PTR(31);          /* POINTER TO ABCODE INSERT      */ 01777000
*   DCL                                                            0427 01778000
*     1 RCTAB1 BDY(WORD) BASED(RCTABPT1(ABENDINX)),/* RC TAB   STRUCT*/ 01779000
*      2 SVC1STM1 PTR(31),          /* POINTER TO FIRST LEV MSG      */ 01780000
*      2 RCSVC(*),                  /* ARRAY OF RTNCODES             */ 01781000
*       3 SVCRC1 FIXED(31),         /* RTN CODE VALUE OR ZERO END    */ 01782000
*       3 RCINST1 PTR(31);          /* POINTER TO RTN NUM INSERT     */ 01783000
*   DCL                                                            0428 01784000
*     1 SVCTBRC2 BDY(WORD) BASED(SVCTABPR),/* RC TAB STRUCTURE       */ 01785000
*      2 RC2NDLV2 PTR(31),          /* POINTER TO SEC LEV MSG        */ 01786000
*      2 SVCRCT2(*),                /* ARRAY OF RTNCODES             */ 01787000
*       3 SVCNUM2 FIXED(31),        /* VALUE OF SVC NUMBERS          */ 01788000
*       3 SVCRCTB2 PTR(31);         /* POINTER TO RC TABLE           */ 01789000
*   DCL                                                            0429 01790000
*     1 RCTAB2(*) BDY(WORD) BASED(SVCRCTB2(SVCINDX)),/* RC TAB STRUC */ 01791000
*      2 SVCRC2 FIXED(31),          /* RC NUMBER VALUE OF ZERO END   */ 01792000
*      2 SVC1STM2 PTR(31),          /* PTR TO THE 1ST LEVEL MSG      */ 01793000
*      2 SVCRCIN2 PTR(31);          /* PTR TO THE RC NUM INSERT      */ 01794000
*/********************************************************************/ 01795000
*/*                                                                  */ 01796000
*/* THERE IS TWO BASIC SEARCH ROUTINE TO FIND PROPER MESSAGES.       */ 01797000
*/* THE FIRST ROUTINE (SVCABSH) SEARCHES FOR AN SVC FAILURE THAT     */ 01798000
*/* RETURNS AN ABEND CODE SUCH AS THE LINK SVC 6.                    */ 01799000
*/* IF THE PROPER MESSAGE HAS NOT BEEN FOUND IN THE FIRST SEARCH,    */ 01800000
*/* THE RETURN CODE IS SET TO 8 TO INDICATE THAT THE SECOND TABLE    */ 01801000
*/* SHOULD BE SEARCHED (SVCRCSH--RETURN CODE TYPE).                  */ 01802000
*/*                                                                  */ 01803000
*/********************************************************************/ 01804000
*                                                                  0430 01805000
*   CALL SVCABSH;                   /* FIRST SEARCH FOR MSG-AB TAB   */ 01806000
         BAL   @14,SVCABSH                                         0430 01807000
*   IF RTNCODE=8 THEN               /* IF NOT IN ABEND TABLE         */ 01808000
         CH    RTNCODE,@CH00034                                    0431 01809000
         BNE   @RF00431                                            0431 01810000
*     CALL SVCRCSH;                 /* SEARCH FOR MSG IN RC TY TAB   */ 01811000
         BAL   @14,SVCRCSH                                         0432 01812000
*SVCABSH:                                                          0433 01813000
*   PROCEDURE;                                                     0433 01814000
*                                                                  0433 01815000
         B     @PB00013                                            0433 01816000
SVCABSH  STM   @14,@12,@SA00013                                    0433 01817000
*/********************************************************************/ 01818000
*/*                                                                  */ 01819000
*/*                P  LOCATE MSG AND PREPARE INSERTS FOR INSERTION   */ 01820000
*/*                                                                  */ 01821000
*/********************************************************************/ 01822000
*                                                                  0434 01823000
*   SVCTABPR=SVCTBP;                /* ESTAB ADDR TO AB TYPE TABLE   */ 01824000
         MVC   SVCTABPR(4),SVCTBP(MSGCSECT)                        0434 01825000
*   DO SVCINDX=1 BY 1 TO 20 WHILE SVCNUM1(SVCINDX)=0;/* SVC NUM OR     01826000
*                                      ZERO(NOT THERE)               */ 01827000
         LA    @14,1                                               0435 01828000
         ST    @14,SVCINDX                                         0435 01829000
@DL00435 MH    @14,@CH00058                                        0435 01830000
         L     @06,SVCTABPR                                        0435 01831000
         AL    @06,@CF00627                                        0435 01832000
         L     @14,SVCNUM1-4(@14,@06)                              0435 01833000
         LTR   @14,@14                                             0435 01834000
         BZ    @DC00435                                            0435 01835000
*     IF SVCNUM1(SVCINDX)=SIOSVCMG THEN/* TEST MATCH IN SVC NUM      */ 01836000
         L     @06,IOPARMS                                         0436 01837000
         C     @14,SIOSVCMG(,@06)                                  0436 01838000
         BNE   @RF00436                                            0436 01839000
*       DO ABENDINX=1 BY 1 TO 20 WHILE ABCODE1(ABENDINX)=0;/* TEST     01840000
*                                      MATCH IN ABEND VAL            */ 01841000
         LA    @14,1                                               0437 01842000
         ST    @14,ABENDINX                                        0437 01843000
@DL00437 LA    @06,12                                              0437 01844000
         LR    @05,@14                                             0437 01845000
         MR    @04,@06                                             0437 01846000
         L     @14,SVCTABPR                                        0437 01847000
         LR    @11,@06                                             0437 01848000
         M     @10,SVCINDX                                         0437 01849000
         LA    @06,0(@11,@14)                                      0437 01850000
         AL    @06,@CF00622                                        0437 01851000
         L     @06,ABTABPT1-8(,@06)                                0437 01852000
         LA    @10,0(@05,@06)                                      0437 01853000
         AL    @10,@CF00628                                        0437 01854000
         L     @10,ABCODE1(,@10)                                   0437 01855000
         LTR   @10,@10                                             0437 01856000
         BZ    @DC00437                                            0437 01857000
*         IF ABCODE1(ABENDINX)=SIOABREG THEN/* WHEN MATCH SRH RC   0438 01858000
*                                      FIRST DO INITAL SET UP OF MSG    01859000
*                                      PTRS & INST PTRS              */ 01860000
         L     @04,IOPARMS                                         0438 01861000
         C     @10,SIOABREG(,@04)                                  0438 01862000
         BNE   @RF00438                                            0438 01863000
*           DO;                                                    0439 01864000
*             SIOTYPPT=ADDR(SIOTYP11);/* ADDRESSABILITY INPUT PL     */ 01865000
         LA    @10,SIOTYP11(,@04)                                  0440 01866000
         ST    @10,SIOTYPPT                                        0440 01867000
*             SIOINTPT=ADDR(SIO11PTR);/* ADDRESSABILITY INST PL      */ 01868000
         LA    @10,SIO11PTR(,@04)                                  0441 01869000
         ST    @10,SIOINTPT                                        0441 01870000
*             MSGPTR=SVC1STM1;      /* ADDRESSABILITY TO MSG         */ 01871000
         AL    @06,@CF00627                                        0442 01872000
         L     @06,RCTABPT1-4(@05,@06)                             0442 01873000
         L     @06,SVC1STM1(,@06)                                  0442 01874000
         ST    @06,MSGPTR                                          0442 01875000
*             MESSAGE(1)=LOCALMSG;  /* MOVE MESSAGE TO WK AREA       */ 01876000
         MVI   MESSAGE+93,C' '                                     0443 01877000
         MVC   MESSAGE+94(10),MESSAGE+93                           0443 01878000
         MVC   MESSAGE(93),LOCALMSG(@06)                           0443 01879000
*             INSTPTR=SVCINST1(SVCINDX);/* ESTAB ADDR OF INST        */ 01880000
         L     @14,SVCINST1-12(@11,@14)                            0444 01881000
         ST    @14,INSTPTR                                         0444 01882000
*             MSGINST1(1)=MSGINST;  /* MOVE INSERT TO WK AREA        */ 01883000
         MVI   MSGINST1+54,C' '                                    0445 01884000
         MVI   MSGINST1+55,C' '                                    0445 01885000
         MVC   MSGINST1(54),MSGINST(@14)                           0445 01886000
*             DISPIN1(1)=INDISP(1); /* MOVE DISPLACEMENT VAL         */ 01887000
         SLR   @14,@14                                             0446 01888000
         IC    @14,INDISP(,@06)                                    0446 01889000
         STH   @14,DISPIN1                                         0446 01890000
*             INTPLPTR(1)=ADDR(MSGINST1(1));/* MOVE PTR OF INST      */ 01891000
         LA    @14,MSGINST1                                        0447 01892000
         ST    @14,INTPLPTR(,@10)                                  0447 01893000
*             SIO13PTR=SIOMODID+100;/* ADJ & RESTORE INST NO         */ 01894000
         LA    @14,100                                             0448 01895000
         SLR   @06,@06                                             0448 01896000
         IC    @06,SIOMODID(,@04)                                  0448 01897000
         ALR   @14,@06                                             0448 01898000
         ST    @14,SIO13PTR(,@04)                                  0448 01899000
*             INSTCTR=3;            /* INDICATE TO INSTNUM 2ND       */ 01900000
         MVC   INSTCTR(4),@CF00032                                 0449 01901000
*             LEV=1;                /* INDICATE TO NUM PRC LEV       */ 01902000
         MVI   LEV,X'01'                                           0450 01903000
*             CALL INSTNUM;         /* CALL AND HAVE INST PROC.      */ 01904000
         BAL   @14,INSTNUM                                         0451 01905000
*             IF RTNCODE=0 THEN    /* MAKE SURE SUCESSFUL           */ 01906000
         LTR   RTNCODE,RTNCODE                                     0452 01907000
         BNZ   @RT00452                                            0452 01908000
*               GO TO EXITABSH;     /* GO TO THE EXIT IF NOT         */ 01909000
*             INTPLPTR(2)=ADDR(MSGINST1(3));/* MOVE PTR OF INST      */ 01910000
         LA    @14,MSGINST1+112                                    0454 01911000
         L     @06,SIOINTPT                                        0454 01912000
         ST    @14,INTPLPTR+4(,@06)                                0454 01913000
*             DISPIN1(3)=INDISP(2); /* MOVE DISPLACEMENT VAL         */ 01914000
         L     @14,MSGPTR                                          0455 01915000
         SLR   @06,@06                                             0455 01916000
         IC    @06,INDISP+1(,@14)                                  0455 01917000
         STH   @06,DISPIN1+112                                     0455 01918000
*             SIONUMI1=3;           /* SET UP AMT OF SEGMENTS        */ 01919000
         LA    @14,3                                               0456 01920000
         L     @06,IOPARMS                                         0456 01921000
         ST    @14,SIONUMI1(,@06)                                  0456 01922000
*             SIOTYPPT=ADDR(SIOTYP21);/* ADDRESSABILITY INPUT PL     */ 01923000
         LA    @11,SIOTYP21(,@06)                                  0457 01924000
         ST    @11,SIOTYPPT                                        0457 01925000
*             SIOINTPT=ADDR(SIO21PTR);/* ADDRESSABILITY INST PL      */ 01926000
         LA    @10,SIO21PTR(,@06)                                  0458 01927000
         ST    @10,SIOINTPT                                        0458 01928000
*             MSGPTR=AB2NDLV1;      /* ESTAB ADDR TO 2ND MSG         */ 01929000
         L     @10,SVCTABPR                                        0459 01930000
         L     @10,AB2NDLV1(,@10)                                  0459 01931000
         ST    @10,MSGPTR                                          0459 01932000
*             MESSAGE(2)='00'X;     /* ZERO OUT WORK AREA            */ 01933000
         XC    MESSAGE+105(103),MESSAGE+105                        0460 01934000
         MVI   MESSAGE+104,X'00'                                   0460 01935000
*             WKMSGID(2)=WKMSGID(1);/* MOVE FIRST LEVEL NUMBER       */ 01936000
         MVC   WKMSGID+104(9),WKMSGID                              0461 01937000
*             WKMSGTXT(2)=TEXTMSG;  /* MOVE IN 2ND LEV TEXT          */ 01938000
         MVI   WKMSGTXT+193,C' '                                   0462 01939000
         MVI   WKMSGTXT+194,C' '                                   0462 01940000
         MVC   WKMSGTXT+104(89),TEXTMSG(@10)                       0462 01941000
*             LENMSG(2)=LENLOCAL;   /* MOVE IN MESSAGE LENGTH        */ 01942000
         MVC   LENMSG+104(2),LENLOCAL(@10)                         0463 01943000
*             LEV=2;                /* INDICATE THAT WORKING 2       */ 01944000
         MVI   LEV,X'02'                                           0464 01945000
*             INSTCTR=1;            /* INDICATE 1ST INSERT           */ 01946000
         MVC   INSTCTR(4),@CF00115                                 0465 01947000
*             IF TYP(1)=5 THEN      /* FIND OUT WHICH INST           */ 01948000
         CLI   TYP(@11),5                                          0466 01949000
         BNE   @RF00466                                            0466 01950000
*               DO;                                                0467 01951000
*                 SIONUMI2=3;       /* SET UP AMT OF SEGMENTS        */ 01952000
         ST    @14,SIONUMI2(,@06)                                  0468 01953000
*                 CALL INSTNUM;     /* HAVE INSERT LOCATED           */ 01954000
         BAL   @14,INSTNUM                                         0469 01955000
*                 IF RTNCODE=0 THEN/* TEST FOR SUCESSFUL REQ        */ 01956000
         LTR   RTNCODE,RTNCODE                                     0470 01957000
         BNZ   @RT00470                                            0470 01958000
*                   GO TO EXITABSH; /* BRANCH TO EXIT                */ 01959000
*               END;                                               0472 01960000
*             ELSE                                                 0473 01961000
*               SIONUMI2=2;         /* NO INST FROM CALLER RED       */ 01962000
         B     @RC00466                                            0473 01963000
@RF00466 L     @14,IOPARMS                                         0473 01964000
         MVC   SIONUMI2(4,@14),@CF00119                            0473 01965000
*             INSTPTR=ABCDINST(ABENDINX);/* PTR TO ABEND NUM INT     */ 01966000
@RC00466 LA    @14,12                                              0474 01967000
         L     @05,ABENDINX                                        0474 01968000
         MR    @04,@14                                             0474 01969000
         LR    @11,@14                                             0474 01970000
         M     @10,SVCINDX                                         0474 01971000
         L     @14,SVCTABPR                                        0474 01972000
         AL    @14,@CF00622                                        0474 01973000
         L     @14,ABTABPT1-8(@11,@14)                             0474 01974000
         AL    @14,@CF00622                                        0474 01975000
         L     @14,ABCDINST-8(@05,@14)                             0474 01976000
         ST    @14,INSTPTR                                         0474 01977000
*             MSGINST2(2)=MSGINST;  /* MOVE INSERT TO WORK AREA      */ 01978000
         MVI   MSGINST2+110,C' '                                   0475 01979000
         MVI   MSGINST2+111,C' '                                   0475 01980000
         MVC   MSGINST2+56(54),MSGINST(@14)                        0475 01981000
*             DISPIN2(2)=INDISP(2); /* MOVE DISPLACEMENT VAL         */ 01982000
         L     @14,MSGPTR                                          0476 01983000
         SLR   @06,@06                                             0476 01984000
         IC    @06,INDISP+1(,@14)                                  0476 01985000
         STH   @06,DISPIN2+56                                      0476 01986000
*             IF TYP(1)=5 THEN      /* SEE WHICH INST THIS IS        */ 01987000
         L     @14,SIOTYPPT                                        0477 01988000
         CLI   TYP(@14),5                                          0477 01989000
         BNE   @RF00477                                            0477 01990000
*               INTPLPTR(2)=ADDR(MSGINST2(2));/* MOVE ADDR TO PL     */ 01991000
         LA    @14,MSGINST2+56                                     0478 01992000
         L     @06,SIOINTPT                                        0478 01993000
         ST    @14,INTPLPTR+4(,@06)                                0478 01994000
*             ELSE                                                 0479 01995000
*               INTPLPTR(1)=ADDR(MSGINST2(2));/* MOVE ADDR TO PL     */ 01996000
         B     @RC00477                                            0479 01997000
@RF00477 LA    @14,MSGINST2+56                                     0479 01998000
         L     @06,SIOINTPT                                        0479 01999000
         ST    @14,INTPLPTR(,@06)                                  0479 02000000
*             IF SVCRC1(1)=0 THEN                                 0480 02001000
@RC00477 LA    @14,12                                              0480 02002000
         L     @05,ABENDINX                                        0480 02003000
         MR    @04,@14                                             0480 02004000
         LR    @11,@14                                             0480 02005000
         M     @10,SVCINDX                                         0480 02006000
         L     @14,SVCTABPR                                        0480 02007000
         AL    @14,@CF00622                                        0480 02008000
         L     @14,ABTABPT1-8(@11,@14)                             0480 02009000
         AL    @14,@CF00627                                        0480 02010000
         L     @14,RCTABPT1-4(@05,@14)                             0480 02011000
         ICM   @06,15,SVCRC1(@14)                                  0480 02012000
         BZ    @RF00480                                            0480 02013000
*               DO RCODEINX=1 BY 1 TO 20/* SET UP FIND RC            */ 02014000
*                     WHILE SVCRC1(RCODEINX)=0;/* IF 0 THEN ERROR   */ 02015000
         LA    @14,1                                               0481 02016000
         ST    @14,RCODEINX                                        0481 02017000
@DL00481 SLA   @14,3                                               0481 02018000
         LA    @06,12                                              0481 02019000
         L     @05,ABENDINX                                        0481 02020000
         MR    @04,@06                                             0481 02021000
         LR    @11,@06                                             0481 02022000
         M     @10,SVCINDX                                         0481 02023000
         L     @06,SVCTABPR                                        0481 02024000
         AL    @06,@CF00622                                        0481 02025000
         L     @06,ABTABPT1-8(@11,@06)                             0481 02026000
         AL    @06,@CF00627                                        0481 02027000
         L     @06,RCTABPT1-4(@05,@06)                             0481 02028000
         LA    @11,0(@14,@06)                                      0481 02029000
         AL    @11,@CF00622                                        0481 02030000
         L     @11,SVCRC1-4(,@11)                                  0481 02031000
         LTR   @11,@11                                             0481 02032000
         BZ    @DC00481                                            0481 02033000
*                 IF SVCRC1(RCODEINX)=SIORCREG THEN/* SRCH           */ 02034000
         L     @10,IOPARMS                                         0482 02035000
         C     @11,SIORCREG(,@10)                                  0482 02036000
         BNE   @RF00482                                            0482 02037000
*                   DO;                                            0483 02038000
*                     SIONUMI1=SIONUMI1+1;/* INCREMENT SG #          */ 02039000
         LA    @11,1                                               0484 02040000
         AL    @11,SIONUMI1(,@10)                                  0484 02041000
         ST    @11,SIONUMI1(,@10)                                  0484 02042000
*                     INSTPTR=RCINST1(RCODEINX);/* ADDR INT          */ 02043000
         L     @14,RCINST1-8(@14,@06)                              0485 02044000
         ST    @14,INSTPTR                                         0485 02045000
*                     MSGINST1(2)=MSGINST;/* MOVE INT TO WK          */ 02046000
         MVI   MSGINST1+110,C' '                                   0486 02047000
         MVI   MSGINST1+111,C' '                                   0486 02048000
         MVC   MSGINST1+56(54),MSGINST(@14)                        0486 02049000
*                     MSGPTR=SVC1STM1;/* ESTAB ADD - D'SP            */ 02050000
         L     @14,SVC1STM1(,@06)                                  0487 02051000
         ST    @14,MSGPTR                                          0487 02052000
*                     DISPIN1(2)=INDISP(2);/* MOVE DISP VAL          */ 02053000
         SLR   @06,@06                                             0488 02054000
         IC    @06,INDISP+1(,@14)                                  0488 02055000
         STH   @06,DISPIN1+56                                      0488 02056000
*                     DISPIN1(3)=INDISP(3);/* MOVE DISP VAL          */ 02057000
         SLR   @06,@06                                             0489 02058000
         IC    @06,INDISP+2(,@14)                                  0489 02059000
         STH   @06,DISPIN1+112                                     0489 02060000
*                     SIOINTPT=ADDR(SIO11PTR);/* READJUST 1ST        */ 02061000
         LA    @14,SIO11PTR(,@10)                                  0490 02062000
         ST    @14,SIOINTPT                                        0490 02063000
*                     INTPLPTR(2)=ADDR(MSGINST1(2));/* ADDR          */ 02064000
         LA    @06,MSGINST1+56                                     0491 02065000
         ST    @06,INTPLPTR+4(,@14)                                0491 02066000
*                     INTPLPTR(3)=ADDR(MSGINST1(3));/* ADDR          */ 02067000
         LA    @06,MSGINST1+112                                    0492 02068000
         ST    @06,INTPLPTR+8(,@14)                                0492 02069000
*                   END;                                           0493 02070000
*               END;                                               0494 02071000
@RF00482 LA    @14,1                                               0494 02072000
         AL    @14,RCODEINX                                        0494 02073000
         ST    @14,RCODEINX                                        0494 02074000
         CH    @14,@CH00251                                        0494 02075000
         BNH   @DL00481                                            0494 02076000
@DC00481 DS    0H                                                  0495 02077000
*             SIO1STMS=ADDR(MESSAGE(1));/* ESTAB PTR                 */ 02078000
@RF00480 L     @14,IOPARMS                                         0495 02079000
         LA    @06,MESSAGE                                         0495 02080000
         ST    @06,SIO1STMS(,@14)                                  0495 02081000
*             SIO2NDMS=ADDR(MESSAGE(2));/* ESTAB PTR                 */ 02082000
         LA    @06,MESSAGE+104                                     0496 02083000
         ST    @06,SIO2NDMS(,@14)                                  0496 02084000
*             CALL TERMOUT;         /* HAVE MESSAGE SENT TO USER     */ 02085000
         BAL   @14,TERMOUT                                         0497 02086000
*             GO TO EXITABSH;       /* BRANCH TO EXIT OF ROUTINE     */ 02087000
         B     EXITABSH                                            0498 02088000
*           END;                                                   0499 02089000
*       END;                                                       0500 02090000
@RF00438 LA    @14,1                                               0500 02091000
         AL    @14,ABENDINX                                        0500 02092000
         ST    @14,ABENDINX                                        0500 02093000
         CH    @14,@CH00251                                        0500 02094000
         BNH   @DL00437                                            0500 02095000
@DC00437 DS    0H                                                  0501 02096000
*   END;                                                           0501 02097000
@RF00436 LA    @14,1                                               0501 02098000
         AL    @14,SVCINDX                                         0501 02099000
         ST    @14,SVCINDX                                         0501 02100000
         CH    @14,@CH00251                                        0501 02101000
         BNH   @DL00435                                            0501 02102000
@DC00435 DS    0H                                                  0502 02103000
*   RTNCODE=8;                      /* INDICATE NOT IN ABCODE TAB    */ 02104000
         LA    RTNCODE,8                                           0502 02105000
*EXITABSH:                          /* LABEL TO BRANCH TO EXIT OF R  */ 02106000
*   RETURN CODE(RTNCODE);           /* RETURN TO MAIN SVCERR ROUT    */ 02107000
EXITABSH L     @14,@SA00013                                        0503 02108000
         LM    @00,@12,@SA00013+8                                  0503 02109000
         BR    @14                                                 0503 02110000
*   END SVCABSH;                                                   0504 02111000
*                                                                  0505 02112000
*/********************************************************************/ 02113000
*/*                                                                  */ 02114000
*/* THIS ROUTINE WILL SEARCH FOR SVC ERROR MSGS SUCH AS ESTAE AND    */ 02115000
*/* PREPARE THE NECESSARY MESSAGES.                                  */ 02116000
*/*                                                                  */ 02117000
*/********************************************************************/ 02118000
*                                                                  0505 02119000
*SVCRCSH:                                                          0505 02120000
*   PROCEDURE;                                                     0505 02121000
SVCRCSH  STM   @14,@12,@SA00014                                    0505 02122000
*   SVCTABPR=SVCTBRCP;              /* ESTAB ADDR TO RC TYPE TABLE   */ 02123000
         MVC   SVCTABPR(4),SVCTBRCP(MSGCSECT)                      0506 02124000
*   RTNCODE=0;                      /* INITIALIZE THE RC TO ZERO     */ 02125000
         SLR   RTNCODE,RTNCODE                                     0507 02126000
*   DO SVCINDX=1 BY 1 TO 20         /* START SEARCH FOR SVC NO       */ 02127000
*         WHILE SVCNUM2(SVCINDX)=0;/* SEARCH UNTIL REACH END TAB    */ 02128000
         LA    @14,1                                               0508 02129000
         ST    @14,SVCINDX                                         0508 02130000
@DL00508 SLA   @14,3                                               0508 02131000
         L     @06,SVCTABPR                                        0508 02132000
         AL    @06,@CF00622                                        0508 02133000
         L     @14,SVCNUM2-4(@14,@06)                              0508 02134000
         LTR   @14,@14                                             0508 02135000
         BZ    @DC00508                                            0508 02136000
*     IF SVCNUM2(SVCINDX)=SIOSVCMG THEN/* IF MATCH STOP FOR ADDR     */ 02137000
         L     @06,IOPARMS                                         0509 02138000
         C     @14,SIOSVCMG(,@06)                                  0509 02139000
         BNE   @RF00509                                            0509 02140000
*       DO RCODEINX=1 BY 1 TO 20    /* SEARCH UNTIL REACH END / TAB  */ 02141000
*             WHILE SVCRC2(RCODEINX)=0;/* TEST FOR END OF TAB       */ 02142000
         LA    @14,1                                               0510 02143000
         ST    @14,RCODEINX                                        0510 02144000
@DL00510 MH    @14,@CH00058                                        0510 02145000
         L     @06,SVCTABPR                                        0510 02146000
         L     @11,SVCINDX                                         0510 02147000
         SLA   @11,3                                               0510 02148000
         L     @11,SVCRCTB2-8(@11,@06)                             0510 02149000
         LA    @10,0(@14,@11)                                      0510 02150000
         AL    @10,@CF00628                                        0510 02151000
         L     @10,SVCRC2(,@10)                                    0510 02152000
         LTR   @10,@10                                             0510 02153000
         BZ    @DC00510                                            0510 02154000
*         IF SVCRC2(RCODEINX)=SIORCREG THEN/* IF FIND STOP & PROC    */ 02155000
         L     @05,IOPARMS                                         0511 02156000
         C     @10,SIORCREG(,@05)                                  0511 02157000
         BNE   @RF00511                                            0511 02158000
*           DO;                                                    0512 02159000
*             MSGPTR=SVC1STM2(RCODEINX);/* MOVE MSG PTR              */ 02160000
         LA    @10,0(@14,@11)                                      0513 02161000
         AL    @10,@CF00627                                        0513 02162000
         L     @10,SVC1STM2-4(,@10)                                0513 02163000
         ST    @10,MSGPTR                                          0513 02164000
*             MESSAGE(1)=LOCALMSG;  /* MOVE IN MSG TO WORK AREA      */ 02165000
         MVI   MESSAGE+93,C' '                                     0514 02166000
         MVC   MESSAGE+94(10),MESSAGE+93                           0514 02167000
         MVC   MESSAGE(93),LOCALMSG(@10)                           0514 02168000
*             SIOTYPPT=ADDR(SIOTYP21);/* ADDRESSABILITY INPUT PL     */ 02169000
         LA    @10,SIOTYP21(,@05)                                  0515 02170000
         ST    @10,SIOTYPPT                                        0515 02171000
*             SIOINTPT=ADDR(SIO21PTR);/* ADDRESSABILITY INST PL      */ 02172000
         LA    @10,SIO21PTR(,@05)                                  0516 02173000
         ST    @10,SIOINTPT                                        0516 02174000
*             MSGPTR=RC2NDLV2;      /* ESTAB ADDR TO MESSAGE 2ND LV  */ 02175000
         L     @06,RC2NDLV2(,@06)                                  0517 02176000
         ST    @06,MSGPTR                                          0517 02177000
*             MESSAGE(2)='00'X;     /* CLEAR WORK AREA               */ 02178000
         XC    MESSAGE+105(103),MESSAGE+105                        0518 02179000
         MVI   MESSAGE+104,X'00'                                   0518 02180000
*             WKMSGID(2)=WKMSGID(1);/* MOVE FIRST LEVEL NUMBER       */ 02181000
         MVC   WKMSGID+104(9),WKMSGID                              0519 02182000
*             WKMSGTXT(2)=TEXTMSG;  /* MOVE IN 2ND LEV TEXT PORTION  */ 02183000
         MVI   WKMSGTXT+193,C' '                                   0520 02184000
         MVI   WKMSGTXT+194,C' '                                   0520 02185000
         MVC   WKMSGTXT+104(89),TEXTMSG(@06)                       0520 02186000
*             LENMSG(2)=LENLOCAL;   /* MOVE IN MESSAGE LENGTH        */ 02187000
         MVC   LENMSG+104(2),LENLOCAL(@06)                         0521 02188000
*             INSTPTR=SVCRCIN2(RCODEINX);/* ESTAB ADDR TO INSERT     */ 02189000
         AL    @11,@CF00622                                        0522 02190000
         L     @14,SVCRCIN2-8(@14,@11)                             0522 02191000
         ST    @14,INSTPTR                                         0522 02192000
*             MSGINST2(1)=MSGINST;  /* MOVE INSERT TO WORK AREA      */ 02193000
         MVI   MSGINST2+54,C' '                                    0523 02194000
         MVI   MSGINST2+55,C' '                                    0523 02195000
         MVC   MSGINST2(54),MSGINST(@14)                           0523 02196000
*             DISPIN2(1)=INDISP(1); /* MOVE DISPLACEMENT VAL TO INT  */ 02197000
         SLR   @14,@14                                             0524 02198000
         IC    @14,INDISP(,@06)                                    0524 02199000
         STH   @14,DISPIN2                                         0524 02200000
*             INTPLPTR(1)=ADDR(MSGINST2(1));/* MOVE ADDR TO P.L.     */ 02201000
         LA    @14,MSGINST2                                        0525 02202000
         ST    @14,INTPLPTR(,@10)                                  0525 02203000
*             LEV=2;                /* INDICATE TWO LEVEL MESSAGE    */ 02204000
         MVI   LEV,X'02'                                           0526 02205000
*             SIONUMI1=1;           /* INDICATE NO INSERTS IN MSG    */ 02206000
         MVC   SIONUMI1(4,@05),@CF00115                            0527 02207000
*             SIONUMI2=2;           /* INDICATE NO INSERTS IN MSG    */ 02208000
         MVC   SIONUMI2(4,@05),@CF00119                            0528 02209000
*             SIO1STMS=ADDR(MESSAGE(1));/* ESTAB ADDRESSABILITY      */ 02210000
         LA    @14,MESSAGE                                         0529 02211000
         ST    @14,SIO1STMS(,@05)                                  0529 02212000
*             SIO2NDMS=ADDR(MESSAGE(2));/* ESTAB ADDRESSABILITY      */ 02213000
         LA    @14,MESSAGE+104                                     0530 02214000
         ST    @14,SIO2NDMS(,@05)                                  0530 02215000
*             RTNCODE=0;            /* RESET THE RETURN CODE TO 0    */ 02216000
         SLR   RTNCODE,RTNCODE                                     0531 02217000
*             CALL TERMOUT;         /* HAVE MESSAGE SENT TO TERM     */ 02218000
         BAL   @14,TERMOUT                                         0532 02219000
*             GO TO EXITRCSH;       /* BRANCH TO END OF PROC         */ 02220000
         B     EXITRCSH                                            0533 02221000
*           END;                                                   0534 02222000
*       END;                                                       0535 02223000
@RF00511 LA    @14,1                                               0535 02224000
         AL    @14,RCODEINX                                        0535 02225000
         ST    @14,RCODEINX                                        0535 02226000
         CH    @14,@CH00251                                        0535 02227000
         BNH   @DL00510                                            0535 02228000
@DC00510 DS    0H                                                  0536 02229000
*   END;                                                           0536 02230000
*                                                                  0536 02231000
@RF00509 LA    @14,1                                               0536 02232000
         AL    @14,SVCINDX                                         0536 02233000
         ST    @14,SVCINDX                                         0536 02234000
         CH    @14,@CH00251                                        0536 02235000
         BNH   @DL00508                                            0536 02236000
@DC00508 DS    0H                                                  0537 02237000
*/********************************************************************/ 02238000
*/*                                                                  */ 02239000
*/* AFTER BOTH TABLES HAVE BEEN SEARCHED WITH NO SUCCESS. THE ERROR  */ 02240000
*/* MSG THAT DATA HAS BEEN LOST DURING IO PROCESSING WILL BE ISSUED  */ 02241000
*/*                                                                  */ 02242000
*/********************************************************************/ 02243000
*                                                                  0537 02244000
*   CALL BADPARM;                   /* IF OUT OF TABLE THEN ERROR    */ 02245000
         BAL   @14,BADPARM                                         0537 02246000
*/********************************************************************/ 02247000
*/*                                                                  */ 02248000
*/*                R  RETURN TO I/O CONTROLLER                       */ 02249000
*/*                                                                  */ 02250000
*/********************************************************************/ 02251000
*                                                                  0538 02252000
*EXITRCSH:                          /* LABEL TO BRANCH TO EXIT OF R  */ 02253000
*   RETURN CODE(RTNCODE);           /* RETURN TO MAIN SVCERR ROUTIN  */ 02254000
EXITRCSH L     @14,@SA00014                                        0538 02255000
         LM    @00,@12,@SA00014+8                                  0538 02256000
         BR    @14                                                 0538 02257000
*   END SVCRCSH;                                                   0539 02258000
@PB00014 DS    0H                                                  0540 02259000
*EXITSERR:                          /* LABEL TO BRANCH TO EXIT       */ 02260000
*   RETURN CODE(RTNCODE);           /* RETURN TO DRIVER WITH CODE    */ 02261000
EXITSERR L     @14,@SA00012                                        0540 02262000
         LM    @00,@12,@SA00012+8                                  0540 02263000
         BR    @14                                                 0540 02264000
*   END SVCERR;                                                    0541 02265000
*                                                                  0542 02266000
*/********************************************************************/ 02267000
*/*                                                                  */ 02268000
*/*    THE FOLLOWING PROCEDURE IS THE PROMTING MESSAGE ROUTINE       */ 02269000
*/*    IT WILL BE INVOKED IF THE USER'S HAS REQUESTED  A PROMPTING   */ 02270000
*/*    MESSAGE. THE PRIMARY FUNCTION IS:                             */ 02271000
*/*                                                                  */ 02272000
*/*        1.  DETERMINE WHICH MESSAGE TO ISSUE                      */ 02273000
*/*                                                                  */ 02274000
*/********************************************************************/ 02275000
*/********************************************************************/ 02276000
*/*                                                                  */ 02277000
*/*PTGTROUT:       E  ENTRY TO PUT/GET (PTGT) ROUTINE                */ 02278000
*/*                                                                  */ 02279000
*/********************************************************************/ 02280000
*                                                                  0542 02281000
*PTGT:                                                             0542 02282000
*   PROCEDURE;                                                     0542 02283000
*                                                                  0542 02284000
PTGT     STM   @14,@12,@SA00015                                    0542 02285000
*/********************************************************************/ 02286000
*/*                                                                  */ 02287000
*/*                P  LOCATE AND POINT TO PROMPTING MESSAGE          */ 02288000
*/*                                                                  */ 02289000
*/********************************************************************/ 02290000
*                                                                  0543 02291000
*   IF SIO1STMS>0&SIO1STMS<100 THEN /* TEST FOR MSG BEING IN 1ST     */ 02292000
         L     @14,IOPARMS                                         0543 02293000
         L     @14,SIO1STMS(,@14)                                  0543 02294000
         LTR   @14,@14                                             0543 02295000
         BNP   @RF00543                                            0543 02296000
         CH    @14,@CH00256                                        0543 02297000
         BNL   @RF00543                                            0543 02298000
*     INDXTAB=MSG99PTR;             /* TABLE IF SO SET UP ADDRESS    */ 02299000
         MVC   INDXTAB(4),MSG99PTR(MSGCSECT)                       0544 02300000
*   ELSE                                                           0545 02301000
*     IF SIO1STMS>0&SIO1STMS<200 THEN/* TEST IF IN 2ND TAB           */ 02302000
         B     @RC00543                                            0545 02303000
@RF00543 L     @14,IOPARMS                                         0545 02304000
         L     @06,SIO1STMS(,@14)                                  0545 02305000
         LTR   @06,@06                                             0545 02306000
         BNP   @RF00545                                            0545 02307000
         CH    @06,@CH00258                                        0545 02308000
         BNL   @RF00545                                            0545 02309000
*       DO;                                                        0546 02310000
*         INDXTAB=MSG199PT;         /* TABLE IF SO SET UP ADDRESS    */ 02311000
         MVC   INDXTAB(4),MSG199PT(MSGCSECT)                       0547 02312000
*         SIO1STMS=SIO1STMS-99;     /* ADJUST TO TABLE VALUES        */ 02313000
         SH    @06,@CH00259                                        0548 02314000
         ST    @06,SIO1STMS(,@14)                                  0548 02315000
*       END;                                                       0549 02316000
*     ELSE                                                         0550 02317000
*       DO;                                                        0550 02318000
         B     @RC00545                                            0550 02319000
@RF00545 DS    0H                                                  0551 02320000
*         CALL BADPARM;             /* IF MSG NOT IN TABLE ERROR     */ 02321000
         BAL   @14,BADPARM                                         0551 02322000
*         GO TO EXITPTGT;           /* BRANCH TO END OF PROCEDURE    */ 02323000
         B     EXITPTGT                                            0552 02324000
*       END;                                                       0553 02325000
*   IF AMTINDX<SIO1STMS THEN        /* LOOK AT ACTUAL TAB LEN FOR    */ 02326000
@RC00545 DS    0H                                                  0554 02327000
@RC00543 L     @14,INDXTAB                                         0554 02328000
         L     @14,AMTINDX(,@14)                                   0554 02329000
         L     @06,IOPARMS                                         0554 02330000
         C     @14,SIO1STMS(,@06)                                  0554 02331000
         BNL   @RF00554                                            0554 02332000
*     DO;                           /* POSSIBLE BAD NUMBER PASSED    */ 02333000
*       CALL BADPARM;               /* IF MSG NUM EXCEEDS LEN-ERROR  */ 02334000
         BAL   @14,BADPARM                                         0556 02335000
*       GO TO EXITPTGT;             /* BRANCH TO END OF PROCEDURE    */ 02336000
         B     EXITPTGT                                            0557 02337000
*     END;                                                         0558 02338000
*   MSGPTR=INDXPTR(SIO1STMS);       /* ESTAB ADDRESSABILITY TO MSG   */ 02339000
@RF00554 L     @14,IOPARMS                                         0559 02340000
         L     @14,SIO1STMS(,@14)                                  0559 02341000
         SLA   @14,2                                               0559 02342000
         L     @06,INDXTAB                                         0559 02343000
         L     @14,INDXPTR-4(@14,@06)                              0559 02344000
         ST    @14,MSGPTR                                          0559 02345000
*   IF INDISP(1)='FF'X THEN         /* TEST IF NULL ENTRY            */ 02346000
         CLI   INDISP(@14),255                                     0560 02347000
         BNE   @RF00560                                            0560 02348000
*     DO;                                                          0561 02349000
*       CALL BADPARM;               /* CALL FOR ERROR PROC BAD PRMS  */ 02350000
         BAL   @14,BADPARM                                         0562 02351000
*       GO TO EXITPTGT;             /* BRANCH TO EXIT ROUTINE        */ 02352000
         B     EXITPTGT                                            0563 02353000
*     END;                                                         0564 02354000
*   MESSAGE(1)=LOCALMSG;            /* MOVE MESSAGE INTO MYWK AREA   */ 02355000
@RF00560 MVI   MESSAGE+93,C' '                                     0565 02356000
         MVC   MESSAGE+94(10),MESSAGE+93                           0565 02357000
         L     @14,MSGPTR                                          0565 02358000
         MVC   MESSAGE(93),LOCALMSG(@14)                           0565 02359000
*   SIONUMI1=1;                     /* SET NUM OF INSERTS TO ONE     */ 02360000
         L     @14,IOPARMS                                         0566 02361000
         MVC   SIONUMI1(4,@14),@CF00115                            0566 02362000
*   SIO1STMS=ADDR(MESSAGE(1));      /* STORE ADDRESS OF MSG IN P.L.  */ 02363000
         LA    @06,MESSAGE                                         0567 02364000
         ST    @06,SIO1STMS(,@14)                                  0567 02365000
*/********************************************************************/ 02366000
*/*                                                                  */ 02367000
*/*                S  CALL TERMOUT: HAVE MESSAGE SENT OUT TO USER    */ 02368000
*/*                                                                  */ 02369000
*/********************************************************************/ 02370000
*                                                                  0568 02371000
*   LEV=3;                          /* INDICATE PTGT TYPE REQ'T      */ 02372000
         MVI   LEV,X'03'                                           0568 02373000
*   CALL TERMOUT;                   /* HAVE THE I/O PERFORMED        */ 02374000
         BAL   @14,TERMOUT                                         0569 02375000
*/********************************************************************/ 02376000
*/*                                                                  */ 02377000
*/*PTGTEND:        R  RETURN TO IO CONTROLLER                        */ 02378000
*/*                                                                  */ 02379000
*/********************************************************************/ 02380000
*                                                                  0570 02381000
*EXITPTGT:                          /* LABEL USED TO BRANCH TO EXIT  */ 02382000
*   RETURN CODE(RTNCODE);           /* RETURN TO DRIVER WITH CODE    */ 02383000
EXITPTGT L     @14,@SA00015                                        0570 02384000
         LM    @00,@12,@SA00015+8                                  0570 02385000
         BR    @14                                                 0570 02386000
*   END PTGT;                                                      0571 02387000
*                                                                  0572 02388000
*/********************************************************************/ 02389000
*/*                                                                  */ 02390000
*/*    THE FOLLOWING PROCEDURE IS THE TERMINAL OUTPUT ROUTINE        */ 02391000
*/*    IT WILL BE INVOKED IF THE DATA OR MESSAGE IS TO BE SENT       */ 02392000
*/*    TO THE USER'S TERMINAL.                                       */ 02393000
*/*    THE PRIMARY FUNCTIONS ARE:                                    */ 02394000
*/*                                                                  */ 02395000
*/*        1.  DETERMINE WHICH TYPE PUTLINE MACROS SHOULD BE USED    */ 02396000
*/*        2.  ISSUE THE APPROPRIATE MACROS                          */ 02397000
*/*        3.  ANALYZE RETURN CODES AND RETURN                       */ 02398000
*/*                                                                  */ 02399000
*/********************************************************************/ 02400000
*/********************************************************************/ 02401000
*/*                                                                  */ 02402000
*/*TERMOUT:        E  TERMOUT ROUTINE TO ISSUE OUTPUT TO TERMINAL    */ 02403000
*/*                P  PREPARE COMMON OPERATIONS TO ALL OUTPUT        */ 02404000
*/*                                                                  */ 02405000
*/********************************************************************/ 02406000
*                                                                  0572 02407000
*TERMOUT:                                                          0572 02408000
*   PROCEDURE;                                                     0572 02409000
TERMOUT  STM   @14,@12,@SA00016                                    0572 02410000
*   RFY                                                            0573 02411000
*    (DSECT10,                                                     0573 02412000
*     IOPLREG,                                                     0573 02413000
*     IOPBREG,                                                     0573 02414000
*     OLD) RSTD;                    /* THESE REGS NOT FOR USE        */ 02415000
*   DCL                                                            0574 02416000
*     SKIPLINE FIXED(15) BASED(SIODATA) BDY(HWORD);/* DETERMINE SKIP */ 02417000
*   DCL                                                            0575 02418000
*     PUTSPACE CHAR(12) GEND;       /* ID LIST FORM OF PUTLINE       */ 02419000
*   DCL                                                            0576 02420000
*     PUTDATA CHAR(12) GEND;        /* ID LIST FORM OF PUTLINE       */ 02421000
*   DCL                                                            0577 02422000
*     PUTMSG2 CHAR(12) GEND;        /* ID LIST FORM OF PUTLINE       */ 02423000
*   DCL                                                            0578 02424000
*     PUTGETIT CHAR(16) GEND;       /* ID LIST FORM OF PUTLINE       */ 02425000
*   DCL                                                            0579 02426000
*     INBUF PTR(31) GEND;           /* PTR IN TCOM OF INPUT LINE     */ 02427000
*   DCL                                                            0580 02428000
*     PRMREG5 REGISTER(5) RSTD;     /* DEFINE REG TO PASS TO P.L.    */ 02429000
*   DCL                                                            0581 02430000
*     ECTMSGF BIT(8) GEND;          /* DEFINE FLAG BYTE FLUSH 2 LEV  */ 02431000
*   DCL                                                            0582 02432000
*     1 PUTGETDS BASED(IOPBREG),    /* OVERLAY STRUCTURE PUTGET PB   */ 02433000
*      2 * CHAR(12),                /* FILLER                        */ 02434000
*      2 INBUFPTR PTR(31);          /* POINTER TO PROMPT LINE BACK   */ 02435000
*   DCL                                                            0583 02436000
*     1 NULLINE STATIC BDY(WORD),   /* IF CALLER WANTS BLANK LINE    */ 02437000
*      2 * FIXED(15) INIT(5),       /* TOTAL LEN INCL HEADER         */ 02438000
*      2 * FIXED(15) INIT(0),       /* RESERVED CONTROL BYTE PUTLIN  */ 02439000
*      2 * CHAR(1) INIT(' ');       /* ONE BLANK WILL ACHIEVE SKIP   */ 02440000
*   DCL                                                            0584 02441000
*     PARSEMSG CHAR(256) BASED(OUTBUF);/* DEFINE LOCATION OF MSG     */ 02442000
*   DCL                                                            0585 02443000
*     OUTBUF PTR(31) GEND;          /* DEFINE POINTER TO OUTBUF      */ 02444000
*   DCL                                                            0586 02445000
*     1 FMTMSG BDY(HWORD) BASED(FMATMSG),/* DEFINE FORMATTED MSG     */ 02446000
*      2 FMTMSGLN FIXED(15),        /* DEFINE LENGTH OF MSG          */ 02447000
*      2 * FIXED(15),               /* FILLER                        */ 02448000
*      2 * CHAR(*);                 /* TEXT                          */ 02449000
*   IOPLREG=ADDR(USERIOPL);         /* ESTAB ADDR TO IOPL FOR P.L.   */ 02450000
         LA    IOPLREG,USERIOPL                                    0587 02451000
*   IOPBREG=ADDR(OUTPUTPB);         /* ESTAB ADDR TO IOPB FOR P.L.   */ 02452000
         LA    IOPBREG,OUTPUTPB                                    0588 02453000
*   OLD=ADDR(OLDPTR2);              /* SET UP ADDR TO OLD PARM LST   */ 02454000
         L     OLD,IOPARMS                                         0589 02455000
         LA    OLD,OLDPTR2(,OLD)                                   0589 02456000
*   USERIOPL=PARMLIST;              /* MOVE THE UPT,ECT & ECB TO PL  */ 02457000
         MVI   USERIOPL+12,C' '                                    0590 02458000
         MVC   USERIOPL+13(3),USERIOPL+12                          0590 02459000
         MVC   USERIOPL(12),PARMLIST                               0590 02460000
*/********************************************************************/ 02461000
*/*                                                                  */ 02462000
*/*                S  CALL ATTNCK: CHECK FOR ATTN OR LOGOFF          */ 02463000
*/*                P  DETERMINE WHICH FORM PUTLINE SHOULD BE ISSUED  */ 02464000
*/*                P  ISSUE PUTLINE OR PUTGET MACRO                  */ 02465000
*/*                S  CALL R.C. CHECK: INTERPRUPT RTN CODE           */ 02466000
*/*                                                                  */ 02467000
*/********************************************************************/ 02468000
*                                                                  0591 02469000
*   CALL ATTNCK;                    /* BEFORE SENDING OUTPUT CK ATT  */ 02470000
         BAL   @14,ATTNCK                                          0591 02471000
*   IF RTNCODE=0 THEN              /* SEE IF ONE IS SCHEDULED       */ 02472000
         SLR   @14,@14                                             0592 02473000
         CR    RTNCODE,@14                                         0592 02474000
         BNE   @RT00592                                            0592 02475000
*     GO TO EXITTERM;               /* IF SO GO TO EXIT              */ 02476000
*   IF LEV=0 THEN                   /* TEST FOR DATA OUTPUT          */ 02477000
         CLI   LEV,0                                               0594 02478000
         BNE   @RF00594                                            0594 02479000
*     DO;                                                          0595 02480000
*       IF SKIPLINE=0 THEN          /* CHECK FOR NULL LINE           */ 02481000
         L     @11,IOPARMS                                         0596 02482000
         L     @11,SIODATA(,@11)                                   0596 02483000
         CH    @14,SKIPLINE(,@11)                                  0596 02484000
         BNE   @RF00596                                            0596 02485000
*         DO;                                                      0597 02486000
*           OUTPUTPB=PUTSPACE;      /* SEND EDIT FORM PUTL'E TO PL   */ 02487000
         MVI   OUTPUTPB+12,C' '                                    0598 02488000
         MVC   OUTPUTPB+13(3),OUTPUTPB+12                          0598 02489000
         MVC   OUTPUTPB(12),PUTSPACE                               0598 02490000
*           MSGINST1(1)=NULLINE;    /* MOVE INSERT TO WORKAREA       */ 02491000
         MVI   MSGINST1+5,C' '                                     0599 02492000
         MVC   MSGINST1+6(50),MSGINST1+5                           0599 02493000
         MVC   MSGINST1(5),NULLINE                                 0599 02494000
*           OLD=ADDR(MSGINST1(1));  /* SET UP ADDRESS IN P.L.        */ 02495000
         LA    OLD,MSGINST1                                        0600 02496000
*         END;                                                     0601 02497000
*       ELSE                                                       0602 02498000
*         DO;                                                      0602 02499000
         B     @RC00596                                            0602 02500000
@RF00596 DS    0H                                                  0603 02501000
*           OUTPUTPB=PUTDATA;       /* SEND DATA PUTLINE LIST TO PL  */ 02502000
         MVI   OUTPUTPB+12,C' '                                    0603 02503000
         MVC   OUTPUTPB+13(3),OUTPUTPB+12                          0603 02504000
         MVC   OUTPUTPB(12),PUTDATA                                0603 02505000
*           OLD=SIODATA;            /* POINT TO DATA LINE            */ 02506000
         L     @14,IOPARMS                                         0604 02507000
         L     OLD,SIODATA(,@14)                                   0604 02508000
*         END;                                                     0605 02509000
*                                                                  0605 02510000
*/********************************************************************/ 02511000
*/*                                                                  */ 02512000
*/*    ISSUE PUTLINE MACRO FOR A DATA LINE TO USER'S TERMINAL        */ 02513000
*/*                                                                  */ 02514000
*/********************************************************************/ 02515000
*                                                                  0606 02516000
*       GENERATE;                                                  0606 02517000
@RC00596 DS    0H                                                  0606 02518000
         PUTLINE PARM=(5),OUTPUT=((4),TERM,SINGLE,DATA),MF=(E,(1))      02519000
*       IF RTNCODE=0 THEN          /* SEE IF PROBLEMS OCCURRED      */ 02520000
         LTR   RTNCODE,RTNCODE                                     0607 02521000
         BZ    @RF00607                                            0607 02522000
*         CALL RCCHECK;             /* INTERPRET RETURN CODE         */ 02523000
         BAL   @14,RCCHECK                                         0608 02524000
*     END;                                                         0609 02525000
*   ELSE                                                           0610 02526000
*     IF LEV=1 THEN                 /* SEE IF SINGLE LEV MESSAGE     */ 02527000
         B     @RC00594                                            0610 02528000
@RF00594 CLI   LEV,1                                               0610 02529000
         BNE   @RF00610                                            0610 02530000
*       DO;                                                        0611 02531000
*         OUTPUTPB=PUTMSG;          /* MOVE LIST FORM PUTLINE TO PL  */ 02532000
         MVI   OUTPUTPB+12,C' '                                    0612 02533000
         MVC   OUTPUTPB+13(3),OUTPUTPB+12                          0612 02534000
         MVC   OUTPUTPB(12),PUTMSG                                 0612 02535000
*         OLD=ADDR(SIONUMI1);       /* ADJUST OUTPUT LINE DES PTR    */ 02536000
         L     OLD,IOPARMS                                         0613 02537000
         LA    OLD,SIONUMI1(,OLD)                                  0613 02538000
*/********************************************************************/ 02539000
*/*                                                                  */ 02540000
*/*    ISSUE PUTLINE MACRO FOR A SINGLE LEVEL INFORMATIONAL MESSAGE  */ 02541000
*/*                                                                  */ 02542000
*/********************************************************************/ 02543000
*                                                                  0614 02544000
*         GENERATE;                                                0614 02545000
         PUTLINE PARM=(5),OUTPUT=((4),TERM,SINGLE,INFOR),MF=(E,(1))     02546000
*         IF RTNCODE=0 THEN        /* SEE IF PROBLEMS OCCURRED      */ 02547000
         LTR   RTNCODE,RTNCODE                                     0615 02548000
         BZ    @RF00615                                            0615 02549000
*           CALL RCCHECK;           /* INTERPRET RETURN CODE         */ 02550000
         BAL   @14,RCCHECK                                         0616 02551000
*       END;                                                       0617 02552000
*     ELSE                                                         0618 02553000
*       IF LEV=2 THEN               /* SEE IF SINGLE LEV MESSAGE     */ 02554000
         B     @RC00610                                            0618 02555000
@RF00610 CLI   LEV,2                                               0618 02556000
         BNE   @RF00618                                            0618 02557000
*         IF TSTFLGS4(8)='1'B THEN  /* SEE IF CALLER IN PARSE VAL    */ 02558000
         TM    TSTFLGS4,B'00000001'                                0619 02559000
         BNO   @RF00619                                            0619 02560000
*           DO;                                                    0620 02561000
*             OUTPUTPB=PUTMSG;      /* MOVE LIST FORM PUTLINE TO PL  */ 02562000
         MVI   OUTPUTPB+12,C' '                                    0621 02563000
         MVC   OUTPUTPB+13(3),OUTPUTPB+12                          0621 02564000
         MVC   OUTPUTPB(12),PUTMSG                                 0621 02565000
*             OLD=ADDR(SIONUMI1);   /* ADJUST OUTPUT LINE DES PTR    */ 02566000
         L     OLD,IOPARMS                                         0622 02567000
         LA    OLD,SIONUMI1(,OLD)                                  0622 02568000
*/********************************************************************/ 02569000
*/*                                                                  */ 02570000
*/*    ISSUE PUTLINE MACRO FOR FIRST HALF OF TWO LEVEL MESSAGE       */ 02571000
*/*                                                                  */ 02572000
*/********************************************************************/ 02573000
*                                                                  0623 02574000
*             GENERATE;                                            0623 02575000
         PUTLINE PARM=(5),OUTPUT=((4),TERM,SINGLE,INFOR),MF=(E,(1))     02576000
*             IF RTNCODE=0 THEN    /* SEE IF PROBLEMS OCCURRED      */ 02577000
         LTR   RTNCODE,RTNCODE                                     0624 02578000
         BZ    @RF00624                                            0624 02579000
*               CALL RCCHECK;       /* INTERPRET RETURN CODE         */ 02580000
         BAL   @14,RCCHECK                                         0625 02581000
*             IF RTNCODE=0 THEN     /* IF OK THEN FORMAT SECOND      */ 02582000
@RF00624 LTR   RTNCODE,RTNCODE                                     0626 02583000
         BNZ   @RF00626                                            0626 02584000
*               DO;                                                0627 02585000
*                 OUTPUTPB=PUTMSG;  /* MOVE LIST FORM PUTLINE TO PL  */ 02586000
         MVI   OUTPUTPB+12,C' '                                    0628 02587000
         MVC   OUTPUTPB+13(3),OUTPUTPB+12                          0628 02588000
         MVC   OUTPUTPB(12),PUTMSG                                 0628 02589000
*                 OLD=ADDR(SIONUMI2);/* ADJUST OUTPUT LINE DES PTR   */ 02590000
         L     OLD,IOPARMS                                         0629 02591000
         LA    OLD,SIONUMI2(,OLD)                                  0629 02592000
*/********************************************************************/ 02593000
*/*                                                                  */ 02594000
*/*    ISSUE PUTLINE MACRO FOR SECOND HALF OF TWO LEVEL MESSAGE      */ 02595000
*/*    THE SECOND LEVEL WILL BE FORMATTED ONLY.                      */ 02596000
*/*                                                                  */ 02597000
*/********************************************************************/ 02598000
*                                                                  0630 02599000
*                 GENERATE;                                        0630 02600000
         PUTLINE PARM=(5),OUTPUT=((4),FORMAT,SINGLE,INFOR),MF=(E,(1))   02601000
*                 IF RTNCODE=0 THEN/* SEE IF PROBLEMS OCCURRED      */ 02602000
         LTR   RTNCODE,RTNCODE                                     0631 02603000
         BZ    @RF00631                                            0631 02604000
*                   CALL RCCHECK;   /* INTERPRET RETURN CODE         */ 02605000
         BAL   @14,RCCHECK                                         0632 02606000
*                 IF RTNCODE=0 THEN /* IF EVERY THING IS OK PASS AD  */ 02607000
@RF00631 LTR   RTNCODE,RTNCODE                                     0633 02608000
         BNZ   @RF00633                                            0633 02609000
*                   DO;                                            0634 02610000
*                     PRMREG5=FMTMSGLN;/* PICK UP LENGTH             */ 02611000
         L     @14,FMATMSG                                         0635 02612000
         LH    PRMREG5,FMTMSGLN(,@14)                              0635 02613000
*                     PRMREG4=FMATMSG;/* PICK UP ADDRESS OF MSG      */ 02614000
         LR    PRMREG4,@14                                         0636 02615000
*                     IF PRMREG5>256 THEN/* SEE IF MESSAGE IS TOO BIG*/ 02616000
         LA    @11,256                                             0637 02617000
         CR    PRMREG5,@11                                         0637 02618000
         BNH   @RF00637                                            0637 02619000
*                       FMTMSGLN=256;/* REDUCE TO MAXIMUM            */ 02620000
         STH   @11,FMTMSGLN(,@14)                                  0638 02621000
*                     PARSEMSG(1:FMTMSGLN)=FMTMSG(1:FMTMSGLN);/* MOVE   02622000
*                                      MSG                           */ 02623000
@RF00637 L     @14,OUTBUF                                          0639 02624000
         L     @11,FMATMSG                                         0639 02625000
         LH    @06,FMTMSGLN(,@11)                                  0639 02626000
         BCTR  @06,0                                               0639 02627000
         EX    @06,@SM00629                                        0639 02628000
*                     GENERATE;                                    0640 02629000
         FREEMAIN RC,LV=(PRMREG5),A=(PRMREG4),SP=1                      02630000
*                     IF RTNCODE=0 THEN/* TEST FOR ERROR            */ 02631000
         LTR   RTNCODE,RTNCODE                                     0641 02632000
         BZ    @RF00641                                            0641 02633000
*                       DO;                                        0642 02634000
*                         PRMREG4=RTNCODE;/* TRANSFER RTNCODE        */ 02635000
         LR    PRMREG4,RTNCODE                                     0643 02636000
*                         IOMSGPLT='00'X;/* CLEAR PARM LIST          */ 02637000
         XC    IOMSGPLT+1(83),IOMSGPLT+1                           0644 02638000
         MVI   IOMSGPLT,X'00'                                      0644 02639000
*                         TSTFLGS4(8)='0'B;/* TURN OFF VALIDITY BIT  */ 02640000
         NI    TSTFLGS4,B'11111110'                                0645 02641000
*                         GENERATE REFS(@IOVCON);                  0646 02642000
         IKJEGSIO SVCERR,SVC=120,RC=(4),ID=IO016,VCONBR=YES,           *02643000
               MF=(E,IOMSGPLT)                                          02644000
*                         IF RTNCODE<16 THEN/* TEST FOR ATTN         */ 02645000
         CH    RTNCODE,@CH00095                                    0647 02646000
         BNL   @RF00647                                            0647 02647000
*                           RTNCODE=4;/* INDICATE ERROR              */ 02648000
         LA    RTNCODE,4                                           0648 02649000
*                         TSTFLGS4(8)='1'B;/* TURN ON VALIDITY BIT   */ 02650000
@RF00647 OI    TSTFLGS4,B'00000001'                                0649 02651000
*                         GO TO EXITTERM;/* RETURN                   */ 02652000
         B     EXITTERM                                            0650 02653000
*                       END;                                       0651 02654000
*                   END;                                           0652 02655000
*               END;                                               0653 02656000
*           END;                                                   0654 02657000
*         ELSE                                                     0655 02658000
*           DO;                                                    0655 02659000
         B     @RC00619                                            0655 02660000
@RF00619 DS    0H                                                  0656 02661000
*             OLDPTR2=ADDR(ZEROOLD);/* SET UP POINTER TO SEC LEV     */ 02662000
         L     @14,IOPARMS                                         0656 02663000
         LA    @11,ZEROOLD(,@14)                                   0656 02664000
         ST    @11,OLDPTR2(,@14)                                   0656 02665000
*             OUTPUTPB=PUTMSG2;     /* MOVE LIST FORM PUTLINE TO PL  */ 02666000
         MVI   OUTPUTPB+12,C' '                                    0657 02667000
         MVC   OUTPUTPB+13(3),OUTPUTPB+12                          0657 02668000
         MVC   OUTPUTPB(12),PUTMSG2                                0657 02669000
*             ZEROOLD='00'X;        /* ZERO THE NEXT OLD PTR         */ 02670000
         SLR   @11,@11                                             0658 02671000
         ST    @11,ZEROOLD(,@14)                                   0658 02672000
*/********************************************************************/ 02673000
*/*                                                                  */ 02674000
*/*    ISSUE PUTLINE MACRO FOR TWO LEVEL MESSAGE                     */ 02675000
*/*                                                                  */ 02676000
*/********************************************************************/ 02677000
*                                                                  0659 02678000
*             GENERATE;                                            0659 02679000
         PUTLINE PARM=(5),OUTPUT=((4),TERM,MULTLVL,INFOR),MF=(E,(1))    02680000
*             IF RTNCODE=0 THEN    /* SEE IF PROBLEMS OCCURRED      */ 02681000
         LTR   RTNCODE,RTNCODE                                     0660 02682000
         BZ    @RF00660                                            0660 02683000
*               CALL RCCHECK;       /* INTERPRET RETURN CODE         */ 02684000
         BAL   @14,RCCHECK                                         0661 02685000
*           END;                                                   0662 02686000
*       ELSE                                                       0663 02687000
*         IF LEV=3 THEN             /* SEE IF SINGLE LEV MESSAGE     */ 02688000
         B     @RC00618                                            0663 02689000
@RF00618 CLI   LEV,3                                               0663 02690000
         BNE   @RF00663                                            0663 02691000
*           DO;                                                    0664 02692000
*             OUTPUTPB=PUTGETIT;    /* MOVE LIST FORM PUTLINE TO PL  */ 02693000
         MVC   OUTPUTPB(16),PUTGETIT                               0665 02694000
*             OLD=ADDR(SIONUMI1);   /* SET UP ADDR OF PTGT OLD       */ 02695000
         L     OLD,IOPARMS                                         0666 02696000
         LA    OLD,SIONUMI1(,OLD)                                  0666 02697000
*/********************************************************************/ 02698000
*/*                                                                  */ 02699000
*/*    ISSUE PUTGET MACRO TO PROMPT THE USER FOR A RESPONSE          */ 02700000
*/*                                                                  */ 02701000
*/********************************************************************/ 02702000
*                                                                  0667 02703000
*             GENERATE;                                            0667 02704000
         USING ECT,DSECT10             SET UP ADDRESSABLITY TO ECT      02705000
         PUTGET PARM=(5),OUTPUT=((4),SINGLE,MODE),MF=(E,(1)) ISSUE CALL 02706000
*             IF RTNCODE=12 THEN    /* TEST FOR NEED TO FLUSH 2 LEV  */ 02707000
         CH    RTNCODE,@CH00058                                    0668 02708000
         BNE   @RF00668                                            0668 02709000
*               DO;                                                0669 02710000
*                 OLD=ADDR(SIONUMI1);/* SET UP ADDR OF PTGT OLD      */ 02711000
         L     OLD,IOPARMS                                         0670 02712000
         LA    OLD,SIONUMI1(,OLD)                                  0670 02713000
*                 DSECT10=TSTECT;   /* GET ADDR OF ECT IN DSECT REG  */ 02714000
         L     DSECT10,TSTECT                                      0671 02715000
*                 ECTMSGF(1)='1'B;  /* TURN ON THE FLUSH 2 LEV BIT   */ 02716000
         OI    ECTMSGF,B'10000000'                                 0672 02717000
*/********************************************************************/ 02718000
*/*                                                                  */ 02719000
*/*    ISSUE PUTGET MACRO TO PROMPT THE USER FOR A RESPONSE          */ 02720000
*/*                                                                  */ 02721000
*/********************************************************************/ 02722000
*                                                                  0673 02723000
*                 GENERATE;                                        0673 02724000
         PUTGET PARM=(5),OUTPUT=((4),SINGLE,MODE),MF=(E,(1)) REISSUE    02725000
*                 CALL RCCHECK;     /* ALTER RC TO MY RC'S           */ 02726000
         BAL   @14,RCCHECK                                         0674 02727000
*                 IF RTNCODE=0 THEN/* IF CONVERTED RC NOT OK EXIT   */ 02728000
         LTR   RTNCODE,RTNCODE                                     0675 02729000
         BNZ   @RT00675                                            0675 02730000
*                   GO TO EXITTERM; /* BRANCH TO END OF ROUTINE      */ 02731000
*               END;                                               0677 02732000
*             ELSE                                                 0678 02733000
*               DO;                                                0678 02734000
         B     @RC00668                                            0678 02735000
@RF00668 DS    0H                                                  0679 02736000
*                 CALL RCCHECK;     /* CALL RTN CODE ANALYZER        */ 02737000
         BAL   @14,RCCHECK                                         0679 02738000
*                 IF RTNCODE=0 THEN/* IF ANALYZER SET NON-ZERO      */ 02739000
         LTR   RTNCODE,RTNCODE                                     0680 02740000
         BNZ   @RT00680                                            0680 02741000
*                   GO TO EXITTERM; /* BRANCH TO END OF ROUTINE      */ 02742000
*               END;                                               0682 02743000
*             INBUF=INBUFPTR;       /* MOVE ADDR RTN'D LINE TO TCOM  */ 02744000
@RC00668 MVC   INBUF(4),INBUFPTR(IOPBREG)                          0683 02745000
*           END;                                                   0684 02746000
*         ELSE                                                     0685 02747000
*           RTNCODE=4;              /* IF LEV NUM NO MATCHED ERROR   */ 02748000
         B     @RC00663                                            0685 02749000
@RF00663 LA    RTNCODE,4                                           0685 02750000
*/********************************************************************/ 02751000
*/*                                                                  */ 02752000
*/*                R  RETURN TO CALLING ROUTINE                      */ 02753000
*/*                                                                  */ 02754000
*/********************************************************************/ 02755000
*                                                                  0686 02756000
*EXITTERM:                          /* LABEL USED TO BRANCH TO EXIT  */ 02757000
*   RETURN CODE(RTNCODE);           /* RETURN TO CALLING ROUTINE     */ 02758000
@RC00663 DS    0H                                                  0686 02759000
@RC00618 DS    0H                                                  0686 02760000
@RC00610 DS    0H                                                  0686 02761000
@RC00594 DS    0H                                                  0686 02762000
EXITTERM L     @14,@SA00016                                        0686 02763000
         LM    @00,@12,@SA00016+8                                  0686 02764000
         BR    @14                                                 0686 02765000
*   RFY                                                            0687 02766000
*    (DSECT10,                                                     0687 02767000
*     IOPLREG,                                                     0687 02768000
*     IOPBREG,                                                     0687 02769000
*     OLD) UNRSTD;                  /* ALLOW REGS TO BE USED         */ 02770000
*   END TERMOUT;                    /* END OF PROCEDURE              */ 02771000
*                                                                  0689 02772000
*/********************************************************************/ 02773000
*/*                                                                  */ 02774000
*/*    THE FOLLOWING PROCEDURE IS THE RETURN CODE ANALYZER ROUTINE   */ 02775000
*/*    IT WILL BE INVOKED TO ANALYZE THE PUTLINE RETURN CODES        */ 02776000
*/*    THE PRIMARY FUNCTIONS ARE:                                    */ 02777000
*/*                                                                  */ 02778000
*/*        1.  DETERMINE IF AN ERROR OCCURRED                        */ 02779000
*/*        2.  CONVERT THE RETURN CODE TO TSO-TEST RETURN CODES      */ 02780000
*/*                                                                  */ 02781000
*/********************************************************************/ 02782000
*/********************************************************************/ 02783000
*/*                                                                  */ 02784000
*/*RCCHECK:        E  RTN CODE ANALYZER                              */ 02785000
*/*                                                                  */ 02786000
*/********************************************************************/ 02787000
*                                                                  0689 02788000
*RCCHECK:                                                          0689 02789000
*   PROCEDURE;                                                     0689 02790000
*                                                                  0689 02791000
RCCHECK  STM   @14,@12,12(@13)                                     0689 02792000
*/********************************************************************/ 02793000
*/*                                                                  */ 02794000
*/*                P  DETERMINE WHICH IO MAC WAS USED PUTLINE ETC.   */ 02795000
*/*                P  BASED ON TYPE MACRO ADJUST RTN CODE TO MY RC'S */ 02796000
*/*                                                                  */ 02797000
*/********************************************************************/ 02798000
*                                                                  0690 02799000
*   IF LEV=0|LEV=1|LEV=2 THEN       /* ALL PUTLINE MACROS ARE ALIKE  */ 02800000
         CLI   LEV,0                                               0690 02801000
         BE    @RT00690                                            0690 02802000
         CLI   LEV,1                                               0690 02803000
         BE    @RT00690                                            0690 02804000
         CLI   LEV,2                                               0690 02805000
         BNE   @RF00690                                            0690 02806000
@RT00690 DS    0H                                                  0691 02807000
*     IF RTNCODE=4 THEN             /* CHECK FOR ATTN IN PROCESS     */ 02808000
         CH    RTNCODE,@CH00146                                    0691 02809000
         BNE   @RF00691                                            0691 02810000
*       RTNCODE=16;                 /* IF SO ADJUST TO OUR RTN CODE  */ 02811000
         LA    RTNCODE,16                                          0692 02812000
*     ELSE                                                         0693 02813000
*       IF RTNCODE=8 THEN           /* CHECK FOR NOWAIT BY USER      */ 02814000
         B     @RC00691                                            0693 02815000
@RF00691 CH    RTNCODE,@CH00034                                    0693 02816000
         BNE   @RF00693                                            0693 02817000
*         RTNCODE=0;                /* USER DID NOT WANT MSG OK      */ 02818000
         SLR   RTNCODE,RTNCODE                                     0694 02819000
*       ELSE                                                       0695 02820000
*         RTNCODE=4;                /* ALL OTHER RTN CODES MEAN ERR  */ 02821000
         B     @RC00693                                            0695 02822000
@RF00693 LA    RTNCODE,4                                           0695 02823000
*   ELSE                                                           0696 02824000
*     IF LEV=3 THEN                 /* ONLY ONE LEFT IS PUTGET       */ 02825000
         B     @RC00690                                            0696 02826000
@RF00690 CLI   LEV,3                                               0696 02827000
         BNE   @RF00696                                            0696 02828000
*       IF RTNCODE=0 THEN           /* IF RTN CODE IS ZERO NO ADJ'T  */ 02829000
         LTR   RTNCODE,RTNCODE                                     0697 02830000
         BNZ   @RF00697                                            0697 02831000
*         TSTFLGS4(1)='1'B;         /* INDICATE TO MAINL'E NOT ST'K  */ 02832000
         OI    TSTFLGS4,B'10000000'                                0698 02833000
*       ELSE                                                       0699 02834000
*         IF RTNCODE=4 THEN         /* RTN MESSAGE IN CHAIN          */ 02835000
         B     @RC00697                                            0699 02836000
@RF00697 CH    RTNCODE,@CH00146                                    0699 02837000
         BNE   @RF00699                                            0699 02838000
*           RTNCODE=0;              /* OK TO CONTINUE                */ 02839000
         SLR   RTNCODE,RTNCODE                                     0700 02840000
*         ELSE                                                     0701 02841000
*           IF RTNCODE=8 THEN       /* SEE IF ATTN IN PROCESS        */ 02842000
         B     @RC00699                                            0701 02843000
@RF00699 CH    RTNCODE,@CH00034                                    0701 02844000
         BNE   @RF00701                                            0701 02845000
*             RTNCODE=16;           /* IF SO CHANGE TO OUR CODE      */ 02846000
         LA    RTNCODE,16                                          0702 02847000
*           ELSE                                                   0703 02848000
*             RTNCODE=4;            /* ALL OTHER RTN CODES MEAM ERR  */ 02849000
         B     @RC00701                                            0703 02850000
@RF00701 LA    RTNCODE,4                                           0703 02851000
*     ELSE                                                         0704 02852000
*       RTNCODE=4;                  /* NO MATCH IN LEV # MEANS ERR   */ 02853000
         B     @RC00696                                            0704 02854000
@RF00696 LA    RTNCODE,4                                           0704 02855000
*/********************************************************************/ 02856000
*/*                                                                  */ 02857000
*/*EXITRCCK:       R  RETURN TO PROCESSING                           */ 02858000
*/*                                                                  */ 02859000
*/********************************************************************/ 02860000
*                                                                  0705 02861000
*EXITRCCK:                          /* LABEL USED TO EXIT ROUTINE    */ 02862000
*   RETURN CODE(RTNCODE);           /* RETURN TO CALLING ROUTINE     */ 02863000
@RC00696 DS    0H                                                  0705 02864000
@RC00690 DS    0H                                                  0705 02865000
EXITRCCK L     @14,12(,@13)                                        0705 02866000
         LM    @00,@12,20(@13)                                     0705 02867000
         BR    @14                                                 0705 02868000
*   END RCCHECK;                    /* END OF RTN CODE ANALYZER      */ 02869000
*                                                                  0707 02870000
*/********************************************************************/ 02871000
*/*                                                                  */ 02872000
*/*    THE FOLLOWING PROCEDURE IS THE ATTENTION CHECKING ROUTINE     */ 02873000
*/*    IT WILL BE INVOKED TO TEST FOR ATTENTIONS IN PROCESS          */ 02874000
*/*    THE PRIMARY FUNCTIONS ARE:                                    */ 02875000
*/*                                                                  */ 02876000
*/*        1.  DETERMINE IF AN ATTENTION OR LOGOFF HAS BEEN REQUESTED*/ 02877000
*/*        2.  CONVERT THE RETURN CODE TO TSO-TEST RETURN CODE 16    */ 02878000
*/*                                                                  */ 02879000
*/********************************************************************/ 02880000
*/********************************************************************/ 02881000
*/*                                                                  */ 02882000
*/*ATTNCHK:        E  ATTENTION CHECK ROUTINE                        */ 02883000
*/*                D  (NO,,YES,%RTN2)                              0707 02884000
*/*                   IS THE LOGON ECB POSTED ?                      */ 02885000
*/*                D  (YES,,NO,EXITATTN)                           0707 02886000
*/*                   IS THE ATTENTION ECB POSTED ?                  */ 02887000
*/*%RTN2:          P  SET THE RETURN CODE TO 16 (ATTN/LOGOFF)        */ 02888000
*/*                                                                  */ 02889000
*/********************************************************************/ 02890000
*                                                                  0707 02891000
*ATTNCK:                                                           0707 02892000
*   PROCEDURE;                                                     0707 02893000
ATTNCK   STM   @14,@12,12(@13)                                     0707 02894000
*   DCL                                                            0708 02895000
*     ECBLOG PTR(31) GEND;          /* DEFINE LOGON LOGOFF ECB PTR   */ 02896000
*   DCL                                                            0709 02897000
*     ECBTMPA PTR(31) GEND;         /* DEFINE ATTENTION ECB PTR      */ 02898000
*   DCL                                                            0710 02899000
*     LOGONOFF BIT(8) BASED(ECBLOG);/* DEFINE ECB HIGH ORDER BYTE    */ 02900000
*   DCL                                                            0711 02901000
*     ATTNHIT BIT(8) BASED(ECBTMPA);/* DEFINE ECB HIGH ORDER BYTE    */ 02902000
*   IF LOGONOFF(2)='1'B|ATTNHIT(2)='1'B THEN/* TEST BIT BEING ON     */ 02903000
         L     @14,ECBLOG                                          0712 02904000
         TM    LOGONOFF(@14),B'01000000'                           0712 02905000
         BO    @RT00712                                            0712 02906000
         L     @14,ECBTMPA                                         0712 02907000
         TM    ATTNHIT(@14),B'01000000'                            0712 02908000
         BNO   @RF00712                                            0712 02909000
@RT00712 DS    0H                                                  0713 02910000
*     RTNCODE=16;                   /* IF EITHER BIT IS ON SET RC16  */ 02911000
         LA    RTNCODE,16                                          0713 02912000
*/********************************************************************/ 02913000
*/*                                                                  */ 02914000
*/*EXITATTN:       R  RETURN TO PROCESSING                           */ 02915000
*/*                                                                  */ 02916000
*/********************************************************************/ 02917000
*                                                                  0714 02918000
*EXITATTN:                          /* LABEL TO INDICATE END ROUT'E  */ 02919000
*   RETURN CODE(RTNCODE);           /* RETURN TO CALLING ROUTINE     */ 02920000
@RF00712 DS    0H                                                  0714 02921000
EXITATTN L     @14,12(,@13)                                        0714 02922000
         LM    @00,@12,20(@13)                                     0714 02923000
         BR    @14                                                 0714 02924000
*   END ATTNCK;                     /* END OF ROUTINE                */ 02925000
*                                                                  0716 02926000
*/********************************************************************/ 02927000
*/*                                                                  */ 02928000
*/*    THE FOLLOWING PROCEDURE IS THE BAD INPUT PARMS MESSAGE ROUTINE*/ 02929000
*/*    IT WILL BE INVOKED TO ISSUE A MESSAGE TO USER OF LOST OUTPUT  */ 02930000
*/*    THE PRIMARY FUNCTION IS:                                      */ 02931000
*/*                                                                  */ 02932000
*/*        1.  ISSUE THE ERROR MESSAGE AND SET THE RTN CODE TO 12    */ 02933000
*/*                                                                  */ 02934000
*/********************************************************************/ 02935000
*/********************************************************************/ 02936000
*/*                                                                  */ 02937000
*/*BADPARM:        E  BADPARM ROUTINE-ISSUE ERROR MESSAGE DATA LOST  */ 02938000
*/*                S  CALL I/O: ISSUE ERROR MESSAGE DATA LOST        */ 02939000
*/*                                                                  */ 02940000
*/********************************************************************/ 02941000
*                                                                  0716 02942000
*BADPARM:                                                          0716 02943000
*   PROCEDURE;                                                     0716 02944000
BADPARM  STM   @14,@12,@SA00019                                    0716 02945000
*   IOMSGPLT='00'X;                 /* ZERO OUT PARM LIST            */ 02946000
         XC    IOMSGPLT+1(83),IOMSGPLT+1                           0717 02947000
         MVI   IOMSGPLT,X'00'                                      0717 02948000
*   GENERATE;                                                      0718 02949000
*           REFS(@IOVCON);                                              02950000
         IKJEGSIO MSG,FIRST=M0042,ID=I0016,VCONBR=YES,MF=(E,IOMSGPLT)   02951000
*   RTNCODE=12;                     /* SET RETURN CODE TO BAD PARM   */ 02952000
         LA    RTNCODE,12                                          0719 02953000
*/********************************************************************/ 02954000
*/*                                                                  */ 02955000
*/*EXITBPRM:       R  RETURN TO PROCESSING                           */ 02956000
*/*                                                                  */ 02957000
*/********************************************************************/ 02958000
*                                                                  0720 02959000
*EXITBPRM:                          /* LABEL USED TO EXIT ROUTINE    */ 02960000
*   RETURN CODE(RTNCODE);           /* RETURN TO CALLING ROUTINE     */ 02961000
EXITBPRM L     @14,@SA00019                                        0720 02962000
         LM    @00,@12,@SA00019+8                                  0720 02963000
         BR    @14                                                 0720 02964000
*   END BADPARM;                    /* END OF RTN CODE ANALYZER      */ 02965000
*                                                                  0722 02966000
*/********************************************************************/ 02967000
*/*                                                                  */ 02968000
*/*DATAROUT:       E  DATA REQUEST ROUTINE                           */ 02969000
*/*                D  (YES,,NO,%CONT4)                             0722 02970000
*/*                   IS THIS REQUEST TO A DATA SET ?                */ 02971000
*/*                S  (,%RTN3)                                     0722 02972000
*/*                   CALL D.S. ROUT.:  PUT DATA INTO DATA SET       */ 02973000
*/*%CONT4:         S  CALL TERM ROUT.:  PUT DATA OUT TO TERMINAL     */ 02974000
*/*%RTN3:          R  RETURN TO I/O CONTROLLER                       */ 02975000
*/*                                                                  */ 02976000
*/********************************************************************/ 02977000
*                                                                  0722 02978000
*DATA:                                                             0722 02979000
*   PROCEDURE;                                                     0722 02980000
DATA     STM   @14,@12,@SA00020                                    0722 02981000
*   DCL                                                            0723 02982000
*     TSTFLGS1 BIT(8) GEND;         /* DEFINE FLG WHERE TSTPRINT SW  */ 02983000
*   RTNCODE=0;                      /* INITIALIZE RTNCODE TO ZERO    */ 02984000
         SLR   RTNCODE,RTNCODE                                     0724 02985000
*   IF TSTFLGS1(3)='1'B THEN        /* SEE IF DATA GOES TO DATA SET  */ 02986000
         TM    TSTFLGS1,B'00100000'                                0725 02987000
         BNO   @RF00725                                            0725 02988000
*     CALL DATASET;                 /* IF SO CALL ROUTINE FOR D.S.   */ 02989000
         BAL   @14,DATASET                                         0726 02990000
*   ELSE                                                           0727 02991000
*     DO;                                                          0727 02992000
         B     @RC00725                                            0727 02993000
@RF00725 DS    0H                                                  0728 02994000
*       LEV=0;                      /* INDICATE DATA NOT MESSAGE     */ 02995000
         MVI   LEV,X'00'                                           0728 02996000
*       CALL TERMOUT;               /* HAVE DATA SENT TO TERMINAL    */ 02997000
         BAL   @14,TERMOUT                                         0729 02998000
*     END;                                                         0730 02999000
*   RETURN CODE(RTNCODE);           /* RETURN TO DRIVER WITH CODE    */ 03000000
@RC00725 L     @14,@SA00020                                        0731 03001000
         LM    @00,@12,@SA00020+8                                  0731 03002000
         BR    @14                                                 0731 03003000
*   END DATA;                                                      0732 03004000
*                                                                  0733 03005000
*/********************************************************************/ 03006000
*/*                                                                  */ 03007000
*/*DATASET:        E  DATA SET PROCESSOR                             */ 03008000
*/*                                                                  */ 03009000
*/********************************************************************/ 03010000
*                                                                  0733 03011000
*DATASET:                                                          0733 03012000
*   PROCEDURE;                                                     0733 03013000
DATASET  STM   @14,@12,@SA00021                                    0733 03014000
*   RESPECIFY                                                      0734 03015000
*     DSECT10 RSTD;                 /* TELL PLS NOT TO USE REG HERE  */ 03016000
*   DCL                                                            0735 03017000
*     TSTIODCB PTR(31) GEND;        /* ADDRESS TO OPEN DCB IN TCOM   */ 03018000
*   DCL                                                            0736 03019000
*     LISTDCB CHAR(*) GEND;         /* ADDRESS OF LIST MAC OF DCB    */ 03020000
*   DCL                                                            0737 03021000
*     LISTOPEN CHAR(*) GEND;        /* ADDRESS OF LIST MAC OF OPEN   */ 03022000
*   DCL                                                            0738 03023000
*     CLFORM CHAR(4) GEND;          /* DEFINE LIST FORM OF CLOSE     */ 03024000
*   DCL                                                            0739 03025000
*     DSECT4 REGISTER(4) RSTD;      /* REG USED FOR ADDR OF DSECT    */ 03026000
*   DCL                                                            0740 03027000
*     DSECT11 REGISTER(11) RSTD;    /* REG USED FOR ADDR OF DSECT    */ 03028000
*   DCL                                                            0741 03029000
*     1 DSNAMPDE BDY(WORD) BASED(SIODSN),/* STRUTURE USED DAIR       */ 03030000
*      2 STRNGPTR PTR(31),          /* POINTER TO DSNAME             */ 03031000
*      2 DSL FIXED(15),             /* LENGTH OF DSNAME              */ 03032000
*      2 FLAGRES1 BIT(15),          /* FLAG BYTE                     */ 03033000
*      2 PTRMEMBR PTR(31),          /* POINTER TO MEMBER NAME        */ 03034000
*      2 LENMEMBR FIXED(15),        /* MEMBER NAME LENGTH            */ 03035000
*      2 FLAGRES2 BIT(15),          /* FLAG BYTE                     */ 03036000
*      2 PSWRDPTR PTR(31),          /* POINTER TO PASSWORD           */ 03037000
*      2 LENPSWRD FIXED(15),        /* LENGTH OF PASS WORD           */ 03038000
*      2 FLAGRES3 BIT(15);          /* FLAG BYTES                    */ 03039000
*   DCL                                                            0742 03040000
*     IOTSTWK PTR(31);              /* VARIABLE TO STORE WK ADDR     */ 03041000
*   DCL                                                            0743 03042000
*     1 TESTIOWK BASED(IOTSTWK) BDY(WORD),/* OVERLAY OF WK AREA      */ 03043000
*      2 DCB CHAR(96),              /* WHEN OPENING AND USING A DCB  */ 03044000
*      2 CLOSE CHAR(4),             /* WHEN CLOSING AN OPEN DCB      */ 03045000
*      2 OPEN CHAR(4),              /* WHEN OPENING THE DCB          */ 03046000
*      2 CURDCBDN,                  /* CURRENT DCB BEING USED        */ 03047000
*       3 LENDSN FIXED(15),         /* LENGTH OF CURRENT DCB NAME    */ 03048000
*       3 NAME CHAR(44);            /* ACTUAL NAME OF CURRENT DS     */ 03049000
*   DCL                                                            0744 03050000
*     MACROWK CHAR(12);             /* THREE WORDS FOR GETMAIN       */ 03051000
*   DCL                                                            0745 03052000
*     TEMPDDN CHAR(8);              /* HOLD AREA OF DD NAME GOTTEN   */ 03053000
*   DCL                                                            0746 03054000
*     1 DSNDAIR,                    /* LENGTH OF DSNAME USED /DAIR   */ 03055000
*      2 DSLNGTH FIXED(15),         /* LENGTH OF DSNAME USED /DAIR   */ 03056000
*      2 DSNAME CHAR(44);           /* ACTUAL DSNAME                 */ 03057000
*   DCL                                                            0747 03058000
*     DSN CHAR(44) BASED(STRNGPTR); /* DEFINE DATA SET NAME          */ 03059000
*   DCL                                                            0748 03060000
*     TSTCPECB PTR(31) GEND;        /* POINTER TO ECB                */ 03061000
*   DCL                                                            0749 03062000
*     TSTUPT PTR(31) GEND;          /* POINTER TO UPT                */ 03063000
*   DCL                                                            0750 03064000
*     DAPLUPT PTR(31) GEND;         /* POINTER TO DAIR PRM LST UPT   */ 03065000
*   DCL                                                            0751 03066000
*     DAPLECT PTR(31) GEND;         /* POINTER TO DAIR PRM LST ECT   */ 03067000
*   DCL                                                            0752 03068000
*     DAPLECB PTR(31) GEND;         /* POINTER TO DAIR PRM LST ECB   */ 03069000
*   DCL                                                            0753 03070000
*     DAPB08 CHAR(84) GEND BDY(WORD);/* POINTER TO DAIR PRM BLOCK    */ 03071000
*   DCL                                                            0754 03072000
*     DA08LEN FIXED(15) GEND;       /* LENGTH                        */ 03073000
*   DCL                                                            0755 03074000
*     DA08DDN CHAR(8) GEND;         /* DAIR DD NAME                  */ 03075000
*   DCL                                                            0756 03076000
*     DA08UNIT CHAR(8) GEND;        /* DAIR UNIT - DEVICE            */ 03077000
*   DCL                                                            0757 03078000
*     DA08SER CHAR(8) GEND;         /* VOL SER NUMBER                */ 03079000
*   DCL                                                            0758 03080000
*     DA08MNM CHAR(8) GEND;         /* MEMBER NAME                   */ 03081000
*   DCL                                                            0759 03082000
*     DA08PSWD CHAR(8) GEND;        /* FOR DAIR PASS WORD            */ 03083000
*   DCL                                                            0760 03084000
*     DA08CD CHAR(2) GEND;          /* DAIR ENTRY CODE               */ 03085000
*   DCL                                                            0761 03086000
*     DA08DSP1 CHAR(1) GEND;        /* DATA SET STATUS FLAG          */ 03087000
*   DCL                                                            0762 03088000
*     DA08DPS2 CHAR(1) GEND;        /* DATA SET DISPOSTION           */ 03089000
*   DCL                                                            0763 03090000
*     DA08DPS3 CHAR(1) GEND;        /* DATA SET CONDITIONAL DISP     */ 03091000
*   DCL                                                            0764 03092000
*     DFPBCNTL CHAR(1) GEND;        /* DEFAULT CONTROL               */ 03093000
*   DCL                                                            0765 03094000
*     DFPBCODE CHAR(1) GEND;        /* DEFAULT ENTRY CODE            */ 03095000
*   DCL                                                            0766 03096000
*     PASSWORD CHAR(8) BASED(PSWRDPTR);/* PASSWORD                   */ 03097000
*   DCL                                                            0767 03098000
*     DFPBQUAL PTR(31) GEND;        /* POINTER TO DEFAULT QUALIFY    */ 03099000
*   DCL                                                            0768 03100000
*     DA08PDSN PTR(31) GEND;        /* POINTER DSN TO BE SRCH DSE    */ 03101000
*   DCL                                                            0769 03102000
*     DFPBDSN PTR(31) GEND;         /* POINTER DSN TO BE SRCH DSE    */ 03103000
*   DCL                                                            0770 03104000
*     DFPBPSCB PTR(31) GEND;        /* POINTER TO DEFAULT CONT BK    */ 03105000
*   DCL                                                            0771 03106000
*     DAPLPSCB PTR(31) GEND;        /* POINTER TO DAIR CONT BLOCK    */ 03107000
*   DCL                                                            0772 03108000
*     TPLPSCB PTR(31) GEND;         /* POINTER TO TMP CONT BLOCK     */ 03109000
*   DCL                                                            0773 03110000
*     DAPL CHAR(*) GEND;            /* DEFINE LABEL OF DIAR PARM L   */ 03111000
*   DCL                                                            0774 03112000
*     DFPB CHAR(*) GEND;            /* DEFINE LABEL OF DIAR PARM B   */ 03113000
*   DCL                                                            0775 03114000
*     TESTLIST CHAR(8) INIT('TESTLIST') STATIC;/* NAME USED DFLT N.  */ 03115000
*   DCL                                                            0776 03116000
*     DAPLDAPB PTR(31) GEND;        /* POINTER TO PRM BLOCK          */ 03117000
*   DCL                                                            0777 03118000
*     DA08DSO BIT(8) GEND;          /* DATA SET ORG                  */ 03119000
*   DCL                                                            0778 03120000
*     TSTFLGS3 BIT(8) GEND;         /* DEFINE FLAG BYTE              */ 03121000
*   DCL                                                            0779 03122000
*     TPLPTR PTR(31) GEND;          /* DEFINE THE TCOM POINTER/TPL   */ 03123000
*   DCL                                                            0780 03124000
*     TEMPTPL PTR(31);              /* DEFINE TEMP POINTER           */ 03125000
*   DCL                                                            0781 03126000
*     DAPB08WK CHAR(100) BDY(WORD); /* DEFINE DAIR PARM AREA         */ 03127000
*   DCL                                                            0782 03128000
*     DAPLWK CHAR(20) BDY(WORD);    /* DEFINE DAIR PARM LIST         */ 03129000
*   DCL                                                            0783 03130000
*     DFPBWK CHAR(20) BDY(WORD);    /* DEFINE DEFAULT PARM LIST      */ 03131000
*   DCL                                                            0784 03132000
*     TSTIODSN PTR(31) GEND;        /* IDENT DSN POINTER IN TCOM     */ 03133000
*   DCL                                                            0785 03134000
*     DSNQUEUE FIXED(15);           /* VALUE USED TO LOOP THRU QUEU  */ 03135000
*   DCL                                                            0786 03136000
*     1 DSNQUEU BASED(PRMREG4) BDY(WORD),/* OVERLAY OF MY DSN CHAIN  */ 03137000
*      2 DSNCHAIN PTR(31),          /* BACKPTR TO PREVIOUS DSN CH    */ 03138000
*      2 LENGTHDN FIXED(15),        /* LENGTH DSN IN CHAIN MEMBER    */ 03139000
*      2 DN CHAR(44);               /* ACTUAL DSN OF MEMBER          */ 03140000
*   GENERATE;                                                      0787 03141000
         DROP  DSECT10                                                  03142000
         USING DAPB08,DSECT10                                           03143000
         USING DAPL,DSECT4                                              03144000
         USING TPL,DSECT11                                              03145000
*   RTNCODE=0;                      /* INITIALIZE THE RTNCODE OK     */ 03146000
         SLR   RTNCODE,RTNCODE                                     0788 03147000
*/********************************************************************/ 03148000
*/*                                                                  */ 03149000
*/*                D  (NO,,YES,DATAOUT)                            0789 03150000
*/*                   IS THE DATA SET OPEN FROM REPEAT ?             */ 03151000
*/*                                                                  */ 03152000
*/********************************************************************/ 03153000
*                                                                  0789 03154000
*   IOTSTWK=TSTIODCB;               /* ESTAB ADDR WORKAREA   @YM06400*/ 03155000
         L     @14,TSTIODCB                                        0789 03156000
         ST    @14,IOTSTWK                                         0789 03157000
*   IF SIODSN=0 THEN               /* TEST TO SEE IF NOT A REPEAT   */ 03158000
         SLR   @06,@06                                             0790 03159000
         L     @05,IOPARMS                                         0790 03160000
         L     @05,SIODSN(,@05)                                    0790 03161000
         CR    @05,@06                                             0790 03162000
         BE    @RF00790                                            0790 03163000
*/********************************************************************/ 03164000
*/*                                                                  */ 03165000
*/*%CONT5:         D  (YES,,NO,%CONT6)                             0791 03166000
*/*                   IS ANOTHER DATA SET OPEN ?                     */ 03167000
*/*                                                                  */ 03168000
*/********************************************************************/ 03169000
*                                                                  0791 03170000
*     DO;                                                          0791 03171000
*       IF TSTIODCB=0 THEN         /* TEST FOR DATA SET BEING OPEN  */ 03172000
         CR    @14,@06                                             0792 03173000
         BE    @RF00792                                            0792 03174000
*/********************************************************************/ 03175000
*/*                                                                  */ 03176000
*/*                D  (NO,,YES,DATAOUT)                            0793 03177000
*/*                   IS THE OPEN DATA SET THE CORRECT D.S. ?        */ 03178000
*/*                                                                  */ 03179000
*/********************************************************************/ 03180000
*                                                                  0793 03181000
*         DO;                                                      0793 03182000
*           IOTSTWK=TSTIODCB;       /* ESTAB ADDR TO WORKAREA        */ 03183000
         ST    @14,IOTSTWK                                         0794 03184000
*           IF LENDSN=DSL THEN      /* SEE IF LENGTHS ARE EQUAL      */ 03185000
         LH    @06,LENDSN(,@14)                                    0795 03186000
         CH    @06,DSL(,@05)                                       0795 03187000
         BNE   @RF00795                                            0795 03188000
*             IF NAME(1:LENDSN)=DSN(1:LENDSN) THEN/* TEST SAME       */ 03189000
         L     @05,STRNGPTR(,@05)                                  0796 03190000
         BCTR  @06,0                                               0796 03191000
         EX    @06,@SC00634                                        0796 03192000
         BNE   @RF00796                                            0796 03193000
*               DO;                                                0797 03194000
*                 CALL PUT;         /* HAVE THE DATA SENT OUT        */ 03195000
         BAL   @14,PUT                                             0798 03196000
*                 GO TO EXITDS;     /* RETURN TO CALLER              */ 03197000
         B     EXITDS                                              0799 03198000
*               END;                                               0800 03199000
*         END;                                                     0801 03200000
@RF00796 DS    0H                                                  0801 03201000
@RF00795 DS    0H                                                  0802 03202000
*       GENERATE;                                                  0802 03203000
@RF00792 DS    0H                                                  0802 03204000
         GETMAIN RC,LV=TLEN,SP=1       GET CORE FOR NEW DCB             03205000
*       IF RTNCODE=0 THEN          /* TEST FOR SUCESSFUL GETMAIN    */ 03206000
         LTR   RTNCODE,RTNCODE                                     0803 03207000
         BZ    @RF00803                                            0803 03208000
*         DO;                                                      0804 03209000
*           PRMREG4=RTNCODE;        /* TRANSFER RETURN CODE          */ 03210000
         LR    PRMREG4,RTNCODE                                     0805 03211000
*           GENERATE REFS(@IOVCON);                                0806 03212000
      IKJEGSIO SVCERR,SVC=10,RC=(4),ID=I0016,VCONBR=YES,MF=(E,IOMSGPLT) 03213000
*           IF RTNCODE<16 THEN      /* SEE IF ATTN OR RETRY          */ 03214000
         CH    RTNCODE,@CH00095                                    0807 03215000
         BNL   @RF00807                                            0807 03216000
*             RTNCODE=4;            /* SET THE RETURN CODE TO ERROR  */ 03217000
         LA    RTNCODE,4                                           0808 03218000
*           GO TO EXITDS;           /* RETURN TO CALLER              */ 03219000
         B     EXITDS                                              0809 03220000
*         END;                                                     0810 03221000
*       IOTSTWK=PRMREG1;            /* SAVE ADDRESS OF CORE          */ 03222000
@RF00803 ST    PRMREG1,IOTSTWK                                     0811 03223000
*       DSECT10=ADDR(DAPB08WK);     /* ESTABLISH ADDR TO PARM AREA   */ 03224000
         LA    DSECT10,DAPB08WK                                    0812 03225000
*       DSECT4=ADDR(DAPLWK);        /* ESTABLISH ADDR TO PARM AREA   */ 03226000
         LA    DSECT4,DAPLWK                                       0813 03227000
*       DSECT11=TPLPTR;             /* ESTABLISH ADDR TO PARM AREA   */ 03228000
         L     DSECT11,TPLPTR                                      0814 03229000
*       TEMPTPL=TPLPSCB;            /* SAVE TPLPSCB POINTER          */ 03230000
         L     @14,TPLPSCB                                         0815 03231000
         ST    @14,TEMPTPL                                         0815 03232000
*       DAPLWK='00'X;               /* CLEAR PARM AREA               */ 03233000
         XC    DAPLWK+1(19),DAPLWK+1                               0816 03234000
         MVI   DAPLWK,X'00'                                        0816 03235000
*       DAPB08WK='00'X;             /* CLEAR PARM AREA               */ 03236000
         XC    DAPB08WK+1(99),DAPB08WK+1                           0817 03237000
         MVI   DAPB08WK,X'00'                                      0817 03238000
*       DAPLUPT=TSTUPT;             /* MOVE UPT FROM TCOM            */ 03239000
         MVC   DAPLUPT(4),TSTUPT                                   0818 03240000
*       DAPLECT=TSTECT;             /* MOVE ECT FROM TCOM            */ 03241000
         MVC   DAPLECT(4),TSTECT                                   0819 03242000
*       DAPLECB=TSTCPECB;           /* MOVE ECB FROM TCOM            */ 03243000
         MVC   DAPLECB(4),TSTCPECB                                 0820 03244000
*       DAPLPSCB=TPLPSCB;           /* MOVE SCB TO DAIR CB           */ 03245000
         ST    @14,DAPLPSCB                                        0821 03246000
*       DAPLDAPB=ADDR(DAPB08);      /* MOVE ADDR OF DIAR PB          */ 03247000
         LA    @14,DAPB08                                          0822 03248000
         ST    @14,DAPLDAPB                                        0822 03249000
*       DAPB08='00'X;               /* ZERO OUT DAPB08               */ 03250000
         XC    DAPB08+1(83),DAPB08+1                               0823 03251000
         MVI   DAPB08,X'00'                                        0823 03252000
*       DA08DDN=' ';                /* SET THE DDNAME TO BLANKS      */ 03253000
         MVI   DA08DDN+1,C' '                                      0824 03254000
         MVC   DA08DDN+2(6),DA08DDN+1                              0824 03255000
         MVI   DA08DDN,C' '                                        0824 03256000
*       DA08UNIT=' ';               /* SET THE UNIT FILD TO BLANKS   */ 03257000
         MVI   DA08UNIT+1,C' '                                     0825 03258000
         MVC   DA08UNIT+2(6),DA08UNIT+1                            0825 03259000
         MVI   DA08UNIT,C' '                                       0825 03260000
*       DA08SER=' ';                /* SET SER NUMBER TO BLANKS      */ 03261000
         MVI   DA08SER+1,C' '                                      0826 03262000
         MVC   DA08SER+2(6),DA08SER+1                              0826 03263000
         MVI   DA08SER,C' '                                        0826 03264000
*       DA08MNM=' ';                /* SET MEMBER NAME TO BLANKS     */ 03265000
         MVI   DA08MNM+1,C' '                                      0827 03266000
         MVC   DA08MNM+2(6),DA08MNM+1                              0827 03267000
         MVI   DA08MNM,C' '                                        0827 03268000
*       DA08PSWD=' ';               /* SET PASSWD NAME TO BLANKS     */ 03269000
         MVI   DA08PSWD+1,C' '                                     0828 03270000
         MVC   DA08PSWD+2(6),DA08PSWD+1                            0828 03271000
         MVI   DA08PSWD,C' '                                       0828 03272000
*       DA08UNIT='';                /* INDICATE DEVICE       @ZA06224*/ 03273000
         MVI   DA08UNIT,C' '                                       0829 03274000
         MVC   DA08UNIT+1(7),DA08UNIT                              0829 03275000
*       DA08CD(2)='08'X;            /* SET UP                        */ 03276000
         MVI   DA08CD+1,X'08'                                      0830 03277000
*       DA08DSP1='01'X;             /* SET DPS BYTE TO 01            */ 03278000
         MVI   DA08DSP1,X'01'                                      0831 03279000
*       DA08DPS2='08'X;             /* SET DPS2 BYTE TO 08           */ 03280000
         MVI   DA08DPS2,X'08'                                      0832 03281000
*       DA08DPS3='08'X;             /* SET THE DPS3 BYTE TO 08       */ 03282000
         MVI   DA08DPS3,X'08'                                      0833 03283000
*       NAME='';                    /* BLANK OUT THE DSNAME FIELD    */ 03284000
         L     @14,IOTSTWK                                         0834 03285000
         MVI   NAME(@14),C' '                                      0834 03286000
         MVC   NAME+1(43,@14),NAME(@14)                            0834 03287000
*       DA08PDSN=ADDR(DSNDAIR);     /* MOVE ADDRESS OF PARM LIST     */ 03288000
         LA    @14,DSNDAIR                                         0835 03289000
         ST    @14,DA08PDSN                                        0835 03290000
*       IF FLAGRES3(1)='1'B THEN    /* TEST FOR PASS WORD DATA SET   */ 03291000
         L     @14,IOPARMS                                         0836 03292000
         L     @14,SIODSN(,@14)                                    0836 03293000
         TM    FLAGRES3(@14),B'10000000'                           0836 03294000
         BNO   @RF00836                                            0836 03295000
*         DA08PSWD(1:LENPSWRD)=PASSWORD;/* IF SO MOVE IN             */ 03296000
         LH    @06,LENPSWRD(,@14)                                  0837 03297000
         BCTR  @06,0                                               0837 03298000
         L     @14,PSWRDPTR(,@14)                                  0837 03299000
         EX    @06,@SM00636                                        0837 03300000
*       DSNAME(1:DSL)=DSN;          /* MOVE DSNAME TO PARM LIST      */ 03301000
@RF00836 L     @14,IOPARMS                                         0838 03302000
         L     @14,SIODSN(,@14)                                    0838 03303000
         LH    @06,DSL(,@14)                                       0838 03304000
         LR    @05,@06                                             0838 03305000
         BCTR  @05,0                                               0838 03306000
         L     @14,STRNGPTR(,@14)                                  0838 03307000
         EX    @05,@SM00638                                        0838 03308000
*       DSLNGTH=DSL;                /* MOVE DATA SET NAME LENGTH IN  */ 03309000
         STH   @06,DSLNGTH                                         0839 03310000
*       CURDCBDN=DSNDAIR;           /* TRANSFER DSN TO CUR. DCB      */ 03311000
         L     @14,IOTSTWK                                         0840 03312000
         MVC   CURDCBDN(46,@14),DSNDAIR                            0840 03313000
*/********************************************************************/ 03314000
*/*                                                                  */ 03315000
*/*%CONT7:         P  CLOSE DATA SET                                 */ 03316000
*/*%CONT6:         D  (NO,,YES,%CONT8)                             0841 03317000
*/*                   IS THE DATA SET FULLY QUALIFIED ?              */ 03318000
*/*                                                                  */ 03319000
*/********************************************************************/ 03320000
*                                                                  0841 03321000
*       IF FLAGRES1(2)='1'B THEN   /* TEST FOR QUOTE MEANS QUAL     */ 03322000
         L     @14,IOPARMS                                         0841 03323000
         L     @14,SIODSN(,@14)                                    0841 03324000
         TM    FLAGRES1(@14),B'01000000'                           0841 03325000
         BO    @RF00841                                            0841 03326000
*         DO;                                                      0842 03327000
*                                                                  0842 03328000
*/********************************************************************/ 03329000
*/*                                                                  */ 03330000
*/*                P  PREPARE PARM LIST FOR IKJDFLT TO QUALIFY NAME  */ 03331000
*/*                                                                  */ 03332000
*/********************************************************************/ 03333000
*                                                                  0843 03334000
*           GENERATE(DROP DSECT11); /* DISCONTINUE DSECT REGISTER    */ 03335000
         DROP DSECT11                                                   03336000
*           GENERATE(USING DFPB,DSECT11);/* ESTAB DSECT REG          */ 03337000
         USING DFPB,DSECT11                                             03338000
*           DSECT11=ADDR(DFPBWK);   /* PICK UP POINTER               */ 03339000
         LA    DSECT11,DFPBWK                                      0845 03340000
*           DFPBWK='00'X;           /* CLEAR PARM FIELDS             */ 03341000
         XC    DFPBWK+1(19),DFPBWK+1                               0846 03342000
         MVI   DFPBWK,X'00'                                        0846 03343000
*           DFPBPSCB=DAPLPSCB;      /* MOVE PSCB FROM DAIR PL        */ 03344000
         MVC   DFPBPSCB(4),DAPLPSCB                                0847 03345000
*           DFPBDSN=DA08PDSN;       /* MOVE DATA SET NAME FROM DAIR  */ 03346000
         MVC   DFPBDSN(4),DA08PDSN                                 0848 03347000
*           DFPBQUAL=ADDR(TESTLIST);/* INDICATE DEFLT NAME FOR US    */ 03348000
         LA    @14,TESTLIST                                        0849 03349000
         ST    @14,DFPBQUAL                                        0849 03350000
*           DFPBCODE='00'X;         /* ENTRY CODE                    */ 03351000
         MVI   DFPBCODE,X'00'                                      0850 03352000
*           DFPBCNTL='20'X;         /* INDICATE TO USE USERS ID PRE  */ 03353000
         MVI   DFPBCNTL,X'20'                                      0851 03354000
*           PRMREG1=ADDR(DAPL);     /* SET ADDR IN R1 OF DA PRM LST  */ 03355000
         LA    PRMREG1,DAPL                                        0852 03356000
*           DAPLPSCB=ADDR(DFPB);    /* SET ADDR OF PRM BLOCK         */ 03357000
         LA    @14,DFPB                                            0853 03358000
         ST    @14,DAPLPSCB                                        0853 03359000
*/********************************************************************/ 03360000
*/*                                                                  */ 03361000
*/*                P  ISSUE LINK MACRO TO IKJDFLT TO QUALIFY NAME    */ 03362000
*/*                S  CALL CKDSNAME: CHECK DATA SET NAME             */ 03363000
*/*                                                                  */ 03364000
*/********************************************************************/ 03365000
*                                                                  0854 03366000
*           GENERATE;                                              0854 03367000
         LINK EP=IKJDFLT               LINK TO DEFAULT FOR QUAL NAME    03368000
*           IF RTNCODE=24 THEN      /* SEE IF IT MEANS ATTN HIT      */ 03369000
         CH    RTNCODE,@CH00082                                    0855 03370000
         BNE   @RF00855                                            0855 03371000
*             DO;                                                  0856 03372000
*               RTNCODE=16;         /* IF SO CHANGE TO OUT CODE      */ 03373000
         LA    RTNCODE,16                                          0857 03374000
*               GO TO EXITDS;       /* GO TO EXIT OF ROUTINE         */ 03375000
         B     EXITDS                                              0858 03376000
*             END;                                                 0859 03377000
*           IF RTNCODE=8            /* IF DSN TOO LONG       @ZA06223*/ 03378000
*             THEN                  /* GET CORRECTED DSN     @ZA06223*/ 03379000
@RF00855 CH    RTNCODE,@CH00034                                    0860 03380000
         BNE   @RF00860                                            0860 03381000
*             CALL GETDSN;          /* PROMPT FOR DSNAME     @ZA06223*/ 03382000
         BAL   @14,GETDSN                                          0861 03383000
*           IF RTNCODE=0 THEN       /* TEST RETURN CODE FROM DFLT    */ 03384000
@RF00860 LTR   RTNCODE,RTNCODE                                     0862 03385000
         BNZ   @RF00862                                            0862 03386000
*             DAPLPSCB=TEMPTPL;     /* RESTORE TPL POINTER           */ 03387000
         MVC   DAPLPSCB(4),TEMPTPL                                 0863 03388000
*           RTNCODE=0;              /* REINITIALIZE RTNCODE TO ZERO  */ 03389000
@RF00862 SLR   RTNCODE,RTNCODE                                     0864 03390000
*         END;                                                     0865 03391000
*       CALL CKDSNAME;              /* CALL TO CHECK IF MATCH OF DS  */ 03392000
@RF00841 BAL   @14,CKDSNAME                                        0866 03393000
*       IF RTNCODE=0 THEN          /* CHECK FOR ERROR RTNCODE       */ 03394000
         LTR   RTNCODE,RTNCODE                                     0867 03395000
         BNZ   @RT00867                                            0867 03396000
*         GO TO EXITDS;             /* IF SO BRANCH TO THE EXIT      */ 03397000
*                                                                  0869 03398000
*/********************************************************************/ 03399000
*/*                                                                  */ 03400000
*/*%CONT8:         P  ISSUE LINK MACRO TO IKJDAIR TO ALLOCATE D.S.   */ 03401000
*/*                                                                  */ 03402000
*/********************************************************************/ 03403000
*                                                                  0869 03404000
*TODAIR:                                                           0869 03405000
*       IF FLAGRES2(1)='1'B THEN    /* SEE IF PHYSICAL SEQUENTIAL    */ 03406000
TODAIR   L     @14,IOPARMS                                         0869 03407000
         L     @14,SIODSN(,@14)                                    0869 03408000
         TM    FLAGRES2(@14),B'10000000'                           0869 03409000
         BNO   @RF00869                                            0869 03410000
*         DO;                                                      0870 03411000
*           CALL BADDS;             /* HAVE MESSAGE PUT OUT          */ 03412000
         BAL   @14,BADDS                                           0871 03413000
*           GO TO EXITDS;           /* BRANCH TO EXIT                */ 03414000
         B     EXITDS                                              0872 03415000
*         END;                                                     0873 03416000
*       IF TSTFLGS3(5)='1'B THEN    /* TEST FOUND A PRIOR DS   SWITCH*/ 03417000
@RF00869 TM    TSTFLGS3,B'00001000'                                0874 03418000
         BNO   @RF00874                                            0874 03419000
*         DO;                                                      0875 03420000
*           TSTFLGS3(5)='0'B;       /* TURN OFF SWITCH FOR NEXT TIM  */ 03421000
         NI    TSTFLGS3,B'11110111'                                0876 03422000
*           DA08DSP1='02'X;         /* IDICATE MOD ON DISP TO DAIR   */ 03423000
         MVI   DA08DSP1,X'02'                                      0877 03424000
*         END;                                                     0878 03425000
*       PRMREG1=ADDR(DAPL);         /* SET UP ADDRESS FOR DAIR       */ 03426000
@RF00874 LA    PRMREG1,DAPL                                        0879 03427000
*       GENERATE;                                                  0880 03428000
*                                                                  0880 03429000
         LINK EP=IKJDAIR               LINK TO DAIR FOR DD CARD         03430000
*/********************************************************************/ 03431000
*/*                                                                  */ 03432000
*/*                D  (YES,,NO,DATAOUT)                            0881 03433000
*/*                   IS THE DAIR RTN CODE NON-ZERO ?                */ 03434000
*/*                S  CALL CKDARC:  ANALYZE RETURN CODE              */ 03435000
*/*                                                                  */ 03436000
*/********************************************************************/ 03437000
*                                                                  0881 03438000
*       IF RTNCODE=0 THEN          /* SEE IF DAIR FAILED            */ 03439000
         LTR   RTNCODE,RTNCODE                                     0881 03440000
         BZ    @RF00881                                            0881 03441000
*         DO;                                                      0882 03442000
*           CALL CKDARC;            /* CALL ROUTINE TO ANALYZE CODE  */ 03443000
         BAL   @14,CKDARC                                          0883 03444000
*           IF RTNCODE=0 THEN      /* SEE IF I CAN CONTINUE         */ 03445000
         LTR   RTNCODE,RTNCODE                                     0884 03446000
         BNZ   @RT00884                                            0884 03447000
*             GO TO EXITDS;         /* IF NOT QUITE                  */ 03448000
*         END;                                                     0886 03449000
*       IF DA08DSO='00000000'B THEN/* SEE IF THE DS IS NEW          */ 03450000
@RF00881 CLI   DA08DSO,B'00000000'                                 0887 03451000
         BE    @RF00887                                            0887 03452000
*         IF DA08DSO(2)='1'B THEN  /* SEE IF THE DS IS PHY. SEQ.    */ 03453000
         TM    DA08DSO,B'01000000'                                 0888 03454000
         BO    @RF00888                                            0888 03455000
*           DO;                                                    0889 03456000
*             CALL BADDS;           /* HAVE ERROR MESSAGE SENT       */ 03457000
         BAL   @14,BADDS                                           0890 03458000
*             GO TO EXITDS;         /* GO TO EXIT OF ROUTINE         */ 03459000
         B     EXITDS                                              0891 03460000
*           END;                                                   0892 03461000
*                                                                  0892 03462000
*/********************************************************************/ 03463000
*/*                                                                  */ 03464000
*/*DATAOUT:        S  CALL PUT:  MOVE DATA TO D.S.                   */ 03465000
*/*                R  RETURN TO MAIN DATA ROUTINE                    */ 03466000
*/*                                                                  */ 03467000
*/********************************************************************/ 03468000
*                                                                  0893 03469000
*       TEMPDDN=DA08DDN;            /* STORE DDNAME IN MY WORK AREA  */ 03470000
@RF00888 DS    0H                                                  0893 03471000
@RF00887 MVC   TEMPDDN(8),DA08DDN                                  0893 03472000
*       CALL OPENDS;                /* CALL THE OPEN NEW DCB ROUT    */ 03473000
         BAL   @14,OPENDS                                          0894 03474000
*       IF RTNCODE=0 THEN          /* CHECK ON SUCCESS OF OPEN      */ 03475000
         LTR   RTNCODE,RTNCODE                                     0895 03476000
         BNZ   @RT00895                                            0895 03477000
*         GO TO EXITDS;             /* BRANCH TO EXIT IF NOT         */ 03478000
*     END;                                                         0897 03479000
*   TSTIODCB=ADDR(DCB);             /* MOVE THE ADDRESS OF DCB TCOM  */ 03480000
@RF00790 MVC   TSTIODCB(4),IOTSTWK                                 0898 03481000
*   CALL PUT;                       /* GO TO ISSUE PUT MACRO         */ 03482000
         BAL   @14,PUT                                             0899 03483000
*EXITDS:                            /* LABEL USED TO BRANCH TO EXIT  */ 03484000
*   RETURN CODE(RTNCODE);           /* RETURN TO THE CALLER          */ 03485000
EXITDS   L     @14,@SA00021                                        0900 03486000
         LM    @00,@12,@SA00021+8                                  0900 03487000
         BR    @14                                                 0900 03488000
*                                                                  0901 03489000
*/* *********************************************************@ZA06223*/ 03490000
*/*                                                          @ZA06223*/ 03491000
*/*  GETDSN - PROMPT FOR VALID DSNAME FOR PRINT DATASET      @ZA06223*/ 03492000
*/*      WHEN RETURN FROM THIS ROUTINE DSNAME WILL BE FULLY  @ZA06223*/ 03493000
*/*      QUALIFIED AND VALIDITY CHECKED.                     @ZA06223*/ 03494000
*/*                                                          @ZA06223*/ 03495000
*/* *********************************************************@ZA06223*/ 03496000
*                                                                  0901 03497000
*GETDSN:                                                           0901 03498000
*   PROC;                           /*                       @ZA06223*/ 03499000
GETDSN   STM   @14,@12,@SA00022                                    0901 03500000
*   DCL                             /*                       @ZA06223*/ 03501000
*     DUMBUF CHAR(5) INIT('0005000040'X),/* DUMMY CMD BUFFER @ZA06223*/ 03502000
*     1 DSN2LONG STATIC,            /* DSN TOO LONG MSG      @ZA06223*/ 03503000
*      2 MSGLENTH FIXED(15) INIT(67),/* LENGTH               @ZA06223*/ 03504000
*      2 * FIXED(15),               /* RESERVED              @ZA06223*/ 03505000
*      2 TXTOFMSG CHAR(63) INIT(    /* MESSAGE TEXT          @ZA06223*/ 03506000
*'IKJ57613I DSNAME WHEN FULLY QUALIFIED WILL EXCEED 44 CHARACTERS');    03507000
*   GEN DATA DEFS(PRMTPCL);                                        0903 03508000
*   RFY                                                            0904 03509000
*    (IOPLREG,                                                     0904 03510000
*     IOPBREG,                                                     0904 03511000
*     OLD) RSTD;                    /* REGS MAY NOT BE USED  @ZA06223*/ 03512000
*   IOPLREG=ADDR(USERIOPL);         /* INIT IOPL PTR         @ZA06223*/ 03513000
         LA    IOPLREG,USERIOPL                                    0905 03514000
*   IOPBREG=ADDR(OUTPUTPB);         /* INIT IOPL             @ZA06223*/ 03515000
         LA    IOPBREG,OUTPUTPB                                    0906 03516000
*   USERIOPL=PARMLIST;              /* INIT REST OF IOPL     @ZA06223*/ 03517000
         MVI   USERIOPL+12,C' '                                    0907 03518000
         MVC   USERIOPL+13(3),USERIOPL+12                          0907 03519000
         MVC   USERIOPL(12),PARMLIST                               0907 03520000
*   OUTPUTPB=PUTMSG;                /* INIT PUTL PARMS       @ZA06223*/ 03521000
         MVI   OUTPUTPB+12,C' '                                    0908 03522000
         MVC   OUTPUTPB+13(3),OUTPUTPB+12                          0908 03523000
         MVC   OUTPUTPB(12),PUTMSG                                 0908 03524000
*   OLD=ADDR(SIONUMI1);             /* INIT OLD PTR          @ZA06223*/ 03525000
         L     @14,IOPARMS                                         0909 03526000
         LA    OLD,SIONUMI1(,@14)                                  0909 03527000
*   SIONUMI1=1;                     /* INIT OLD COUNT        @ZA06223*/ 03528000
         MVC   SIONUMI1(4,@14),@CF00115                            0910 03529000
*   SIO1STMS=ADDR(DSN2LONG);        /* INIT MSG ADDR         @ZA06223*/ 03530000
         LA    @06,DSN2LONG                                        0911 03531000
         ST    @06,SIO1STMS(,@14)                                  0911 03532000
*   GENERATE;                                                      0912 03533000
*                                  /*                        @ZA06223*/ 03534000
       PUTLINE PARM=(5),OUTPUT=((4),TERM,SINGLE,INFOR),MF=(E,(1))       03535000
*   RFY                                                            0913 03536000
*    (IOPBREG,                                                     0913 03537000
*     OLD);                         /* OK TO USE REGS AGAIN  @ZA06223*/ 03538000
*   IF RTNCODE=0                   /* PUTLINE OK?           @ZA06223*/ 03539000
*     THEN                          /* NO-DIAGNOSE ERROR     @ZA06223*/ 03540000
         LTR   RTNCODE,RTNCODE                                     0914 03541000
         BZ    @RF00914                                            0914 03542000
*     IF RTNCODE=8                  /* WAS ATTN HIT?         @ZA06223*/ 03543000
*       THEN                                                       0915 03544000
         CH    RTNCODE,@CH00034                                    0915 03545000
         BNE   @RF00915                                            0915 03546000
*       DO;                         /* IF IT WAS SET         @ZA06223*/ 03547000
*         RTNCODE=16;               /* SET ATTN RC           @ZA06223*/ 03548000
         LA    RTNCODE,16                                          0917 03549000
*         RETURN TO ENDIO;          /* AND QUIT              @ZA06223*/ 03550000
         LA    @14,ENDIO                                           0918 03551000
         LM    @15,@12,@SA00022+4                                  0918 03552000
         BR    @14                                                 0918 03553000
*       END;                        /*                       @ZA06223*/ 03554000
*     ELSE                                                         0920 03555000
*       IF RTNCODE=8                /* IF NOWAIT WAS SPEC    @ZA06223*/ 03556000
*         THEN                                                     0920 03557000
@RF00915 CH    RTNCODE,@CH00034                                    0920 03558000
         BNE   @RF00920                                            0920 03559000
*         RTNCODE=0;                /* ACCEPT AS VALID       @ZA06223*/ 03560000
         SLR   RTNCODE,RTNCODE                                     0921 03561000
*       ELSE                                                       0922 03562000
*         DO;                       /* ALL OTHERS ARE ERRORS @ZA06223*/ 03563000
         B     @RC00920                                            0922 03564000
@RF00920 DS    0H                                                  0923 03565000
*           RTNCODE=4;              /* SET ERROR RETURN CODE @ZA06223*/ 03566000
         LA    RTNCODE,4                                           0923 03567000
*           RETURN TO ENDIO;        /* AND GET OUT           @ZA06223*/ 03568000
         LA    @14,ENDIO                                           0924 03569000
         LM    @15,@12,@SA00022+4                                  0924 03570000
         BR    @14                                                 0924 03571000
*         END;                      /*                       @ZA06223*/ 03572000
*   USERCBUF=DUMBUF;                /* SET UP DUMMY CMD BFR  @ZA06223*/ 03573000
@RC00920 DS    0H                                                  0926 03574000
@RF00914 MVC   USERCBUF(5),DUMBUF                                  0926 03575000
*   PPLPTR=ADDR(USERPPL);           /* POINT TO PPL          @ZA06223*/ 03576000
         LA    @14,USERPPL                                         0927 03577000
         ST    @14,PPLPTR                                          0927 03578000
*   USERPPL=PARMLIST;               /* INIT PARSE PARMS      @ZA06223*/ 03579000
         MVI   USERPPL+12,C' '                                     0928 03580000
         MVC   USERPPL+13(15),USERPPL+12                           0928 03581000
         MVC   USERPPL(12),PARMLIST                                0928 03582000
*   PPLPCL=PCLADDR;                 /* POINT TO PCL          @ZA06223*/ 03583000
         MVC   PPLPCL(4,@14),PCLADDR                               0929 03584000
*   PPLANS=ADDR(PDLPTR);            /* PROVIDE ANSWER AREA   @ZA06223*/ 03585000
         LA    @06,PDLPTR                                          0930 03586000
         ST    @06,PPLANS(,@14)                                    0930 03587000
*   PPLCBUF=ADDR(USERCBUF);         /* POINT TO PHONY BFR    @ZA06223*/ 03588000
         LA    @06,USERCBUF                                        0931 03589000
         ST    @06,PPLCBUF(,@14)                                   0931 03590000
*   PPLUWA=IOPLREG;                 /* PASS IOPL TO VALIDCK  @ZA06223*/ 03591000
         ST    IOPLREG,PPLUWA(,@14)                                0932 03592000
*   IOPLREG=PPLPTR;                 /* POINT TO PARSE PARMS  @ZA06223*/ 03593000
         LR    IOPLREG,@14                                         0933 03594000
*   GEN( LINK EP=IKJPARS);          /* CALL PARSE            @ZA06223*/ 03595000
          LINK EP=IKJPARS                                               03596000
*   IF RTNCODE=0                   /* IF PARSE RC NOT ZERO  @ZA06223*/ 03597000
*     THEN                          /* ATTEMPT TO DIAGNOSE   @ZA06223*/ 03598000
         LTR   RTNCODE,RTNCODE                                     0935 03599000
         BZ    @RF00935                                            0935 03600000
*     IF RTNCODE=8                  /* POSSIBLY ATTN?        @ZA06223*/ 03601000
*       THEN                                                       0936 03602000
         CH    RTNCODE,@CH00034                                    0936 03603000
         BNE   @RF00936                                            0936 03604000
*       DO;                         /* YES-                  @ZA06223*/ 03605000
*         RTNCODE=16;               /* SET ATTN RETURN CODE  @ZA06223*/ 03606000
         LA    RTNCODE,16                                          0938 03607000
*         RETURN TO ENDIO;          /* PROCESS ATTN          @ZA06223*/ 03608000
         LA    @14,ENDIO                                           0939 03609000
         LM    @15,@12,@SA00022+4                                  0939 03610000
         BR    @14                                                 0939 03611000
*       END;                        /*                       @ZA06223*/ 03612000
*     ELSE                                                         0941 03613000
*       DO;                         /* REAL ERROR?           @ZA06223*/ 03614000
@RF00936 DS    0H                                                  0942 03615000
*         RTNCODE=4;                /* SET ERROR RETURN CODE @ZA06223*/ 03616000
         LA    RTNCODE,4                                           0942 03617000
*         RETURN TO ENDIO;          /* GET THE H--- OUT      @ZA06223*/ 03618000
         LA    @14,ENDIO                                           0943 03619000
         LM    @15,@12,@SA00022+4                                  0943 03620000
         BR    @14                                                 0943 03621000
*       END;                        /*                       @ZA06223*/ 03622000
*   SIODSN=PDLPTR+8;                /* INCR TO PDE           @ZA06223*/ 03623000
@RF00935 LA    @14,8                                               0945 03624000
         AL    @14,PDLPTR                                          0945 03625000
         L     @06,IOPARMS                                         0945 03626000
         ST    @14,SIODSN(,@06)                                    0945 03627000
*   IF FLAGRES3(1)='1'B             /* IF PASSWORD SUPPLIED  @ZA06223*/ 03628000
*     THEN                          /* MOVE IT TO PASSWORD   @ZA06223*/ 03629000
         TM    FLAGRES3(@14),B'10000000'                           0946 03630000
         BNO   @RF00946                                            0946 03631000
*     DA08PSWD(1:LENPSWRD)=PASSWORD;/* TO DAIR PSWD AREA     @ZA06223*/ 03632000
         LH    @06,LENPSWRD(,@14)                                  0947 03633000
         BCTR  @06,0                                               0947 03634000
         L     @14,PSWRDPTR(,@14)                                  0947 03635000
         EX    @06,@SM00636                                        0947 03636000
*   DSNAME(1:DSL)=DSN;              /* SAVE DSNAME           @ZA06223*/ 03637000
@RF00946 L     @14,IOPARMS                                         0948 03638000
         L     @14,SIODSN(,@14)                                    0948 03639000
         LH    @06,DSL(,@14)                                       0948 03640000
         LR    @05,@06                                             0948 03641000
         BCTR  @05,0                                               0948 03642000
         L     @14,STRNGPTR(,@14)                                  0948 03643000
         EX    @05,@SM00638                                        0948 03644000
*   DSLNGTH=DSL;                    /* AND DSN LENGTH        @ZA06223*/ 03645000
         STH   @06,DSLNGTH                                         0949 03646000
*   CURDCBDN=DSNDAIR;               /* ASSOC. DSN W/ DCB     @ZA06223*/ 03647000
         L     @14,IOTSTWK                                         0950 03648000
         MVC   CURDCBDN(46,@14),DSNDAIR                            0950 03649000
*   IF FLAGRES1(2)='1'B            /* IF DSN NOT FULLY      @ZA06223*/ 03650000
*     THEN                                                         0951 03651000
         L     @14,IOPARMS                                         0951 03652000
         L     @14,SIODSN(,@14)                                    0951 03653000
         TM    FLAGRES1(@14),B'01000000'                           0951 03654000
         BO    @RF00951                                            0951 03655000
*     DO;                           /* QUALIFIED             @ZA06223*/ 03656000
*       DFPBCNTL=''B;               /* SET CONTROL FLAGS     @ZA06223*/ 03657000
         MVI   DFPBCNTL,X'00'                                      0953 03658000
*       PRMREG1=ADDR(DAPL);         /* POINT TO PARMS        @ZA06223*/ 03659000
         LA    PRMREG1,DAPL                                        0954 03660000
*       DAPLPSCB=ADDR(DFPB);        /* POINT TO PARM LIST    @ZA06223*/ 03661000
         LA    @14,DFPB                                            0955 03662000
         ST    @14,DAPLPSCB                                        0955 03663000
*       GEN( LINK EP=IKJDFLT);      /* QUALIFY DSN           @ZA06223*/ 03664000
          LINK EP=IKJDFLT                                               03665000
*       IF RTNCODE=24               /* SEE IF ATTN           @ZA06223*/ 03666000
*         THEN                                                     0957 03667000
         CH    RTNCODE,@CH00082                                    0957 03668000
         BNE   @RF00957                                            0957 03669000
*         DO;                       /* YES-                  @ZA06223*/ 03670000
*           RTNCODE=16;             /* SET ATTN RETCODE      @ZA06223*/ 03671000
         LA    RTNCODE,16                                          0959 03672000
*           RETURN TO ENDIO;        /* GET OUT               @ZA06223*/ 03673000
         LA    @14,ENDIO                                           0960 03674000
         LM    @15,@12,@SA00022+4                                  0960 03675000
         BR    @14                                                 0960 03676000
*         END;                      /*                       @ZA06223*/ 03677000
*       IF RTNCODE=0                /* IF NO ERROR           @ZA06223*/ 03678000
*         THEN                      /* RESTORE PSCB PTR      @ZA06223*/ 03679000
@RF00957 LTR   RTNCODE,RTNCODE                                     0962 03680000
         BNZ   @RF00962                                            0962 03681000
*         DAPLPSCB=TEMPTPL;         /* RESTORE PTR           @ZA06223*/ 03682000
         MVC   DAPLPSCB(4),TEMPTPL                                 0963 03683000
*     END;                          /*                       @ZA06223*/ 03684000
@RF00962 DS    0H                                                  0965 03685000
*   RTNCODE=0;                      /* SET RC = 0            @ZA06223*/ 03686000
@RF00951 SLR   RTNCODE,RTNCODE                                     0965 03687000
*   END GETDSN;                     /*                       @ZA06223*/ 03688000
@EL00022 DS    0H                                                  0966 03689000
@EF00022 DS    0H                                                  0966 03690000
@ER00022 LM    @14,@12,@SA00022                                    0966 03691000
         BR    @14                                                 0966 03692000
*                                                                  0967 03693000
*/********************************************************************/ 03694000
*/*                                                                  */ 03695000
*/*                E  CKDARC ROUTINE - ANALYZE DAIR RTN CODE         */ 03696000
*/*                S  CALL ATTN CHECK: CHECK FOR ATTN OR LOGOFF      */ 03697000
*/*                P  ISSUE LINK MACRO (IKJEFF18) ANALYZE RTN CD   0967 03698000
*/*                   & PRINT ERR MSG                                */ 03699000
*/*                P  SET RETURN CODE TO 4                           */ 03700000
*/*                                                                  */ 03701000
*/********************************************************************/ 03702000
*                                                                  0967 03703000
*CKDARC:                                                           0967 03704000
*   PROCEDURE;                                                     0967 03705000
CKDARC   STM   @14,@12,@SA00023                                    0967 03706000
*   DCL                                                            0968 03707000
*     DA08DARC FIXED(15) BDY(HWORD) GEND;                          0968 03708000
*   DCL                                                            0969 03709000
*     DA08CTL BIT(8) GEND;                                         0969 03710000
*   DCL                                                            0970 03711000
*     DA08PQTY CHAR(4) GEND;                                       0970 03712000
*   DCL                                                            0971 03713000
*     DA08SQTY CHAR(4) GEND;                                       0971 03714000
*   DCL                                                            0972 03715000
*     1 EFF18PL,                    /* IKJEFF18 PARM LIST            */ 03716000
*      2 F18DAPL PTR(31),           /* POINTER TO DAIR PARM LIST     */ 03717000
*      2 F18DAPRC PTR(31),          /* POINTER TO DAIR RTN CODE      */ 03718000
*      2 F18MSGPT PTR(31),          /* POINTER TO FULL WORD ZEROS    */ 03719000
*      2 F18IDNUM PTR(31),          /* POINTER TO ID NUMBER          */ 03720000
*      2 F18FILL FIXED(31);         /* FILLER TO BE RESERVED         */ 03721000
*   DCL                                                            0973 03722000
*     DAPLRC FIXED(31);             /* FULLWORD TO CONTAIN RTN CODE  */ 03723000
*   DCL                                                            0974 03724000
*     F18ID FIXED(15) INIT(1) STATIC;/* I.D. NUMBER                  */ 03725000
*   DCL                                                            0975 03726000
*     F18MSG FIXED(31) INIT(0) STATIC;/* INDICATE NO MSG PTR - ZERO  */ 03727000
*   IF RTNCODE=8 THEN               /* SEE IF POSSIBLE CAT. ERROR    */ 03728000
         CH    RTNCODE,@CH00034                                    0976 03729000
         BNE   @RF00976                                            0976 03730000
*     IF DA08DARC='1708'X THEN      /* SEE IF CODE IS CATG ERROR     */ 03731000
         CLC   DA08DARC(2),@CH00557                                0977 03732000
         BNE   @RF00977                                            0977 03733000
*       DO;                                                        0978 03734000
*         DA08CTL='40'X;            /* INDICATE WE WANT BLOCKS       */ 03735000
         MVI   DA08CTL,X'40'                                       0979 03736000
*         DA08DSP1='04'X;           /* NDICATE DS IS NEW             */ 03737000
         MVI   DA08DSP1,X'04'                                      0980 03738000
*         DA08DPS2='02'X;           /* INDICATE WANT DS CATLG        */ 03739000
         MVI   DA08DPS2,X'02'                                      0981 03740000
*         DA08DPS3='02'X;           /* INDICATE CONDITIONAL DIS      */ 03741000
         MVI   DA08DPS3,X'02'                                      0982 03742000
*         DA08PQTY=1;               /* MOVE SPACE INTO SPQTY         */ 03743000
         MVC   DA08PQTY(4),@CF00115                                0983 03744000
*         DA08SQTY=100;             /* EQU(BLK,(1,100))              */ 03745000
         MVC   DA08SQTY(4),@CF00256                                0984 03746000
*         RTNCODE=0;                /* RESET THE RETURN CODE         */ 03747000
         SLR   RTNCODE,RTNCODE                                     0985 03748000
*         RETURN TO TODAIR;         /* GO BACK AND TRY AGAIN         */ 03749000
         LA    @14,TODAIR                                          0986 03750000
         LM    @15,@12,@SA00023+4                                  0986 03751000
         BR    @14                                                 0986 03752000
*       END;                                                       0987 03753000
*   F18DAPL=ADDR(DAPL);             /* POINT TO DAPL LIST            */ 03754000
@RF00977 DS    0H                                                  0988 03755000
@RF00976 LA    @14,DAPL                                            0988 03756000
         ST    @14,F18DAPL                                         0988 03757000
*   DAPLRC=RTNCODE;                 /* STORE RETURN CODE             */ 03758000
         ST    RTNCODE,DAPLRC                                      0989 03759000
*   F18DAPRC=ADDR(DAPLRC);          /* POINT TO RETURN CODE          */ 03760000
         LA    @14,DAPLRC                                          0990 03761000
         ST    @14,F18DAPRC                                        0990 03762000
*   F18MSGPT=ADDR(F18MSG);          /* POINT TO ZERO POINTER         */ 03763000
         LA    @14,F18MSG                                          0991 03764000
         ST    @14,F18MSGPT                                        0991 03765000
*   F18IDNUM=ADDR(F18ID);           /* POINT TO DAIR ALLOC ID NUM    */ 03766000
         LA    @14,F18ID                                           0992 03767000
         ST    @14,F18IDNUM                                        0992 03768000
*   RTNCODE=0;                      /* RESET RETURN CODE             */ 03769000
         SLR   RTNCODE,RTNCODE                                     0993 03770000
*   CALL ATTNCK;                    /* TEST FOR ATTN OR LOGOFF       */ 03771000
         BAL   @14,ATTNCK                                          0994 03772000
*   IF RTNCODE=0 THEN              /* IF ONE IS IN PROCESS GO OUT   */ 03773000
         LTR   RTNCODE,RTNCODE                                     0995 03774000
         BNZ   @RT00995                                            0995 03775000
*     GO TO EXITRCDR;               /* BRANCH TO THE EXIT            */ 03776000
*   PRMREG1=ADDR(EFF18PL);          /* POINT TO PARM LIST            */ 03777000
         LA    PRMREG1,EFF18PL                                     0997 03778000
*   GENERATE;                                                      0998 03779000
       LINK  EP=IKJEFF18               LINK TO MSG FOR DAIR             03780000
*   RTNCODE=4;                      /* SET UP ERROR RETURN CODE      */ 03781000
         LA    RTNCODE,4                                           0999 03782000
*/********************************************************************/ 03783000
*/*                                                                  */ 03784000
*/*                R  RETURN TO CALLER                               */ 03785000
*/*                                                                  */ 03786000
*/********************************************************************/ 03787000
*                                                                  1000 03788000
*EXITRCDR:                          /* LABEL TO EXIT OUT OF ROUTINE  */ 03789000
*   RETURN CODE(RTNCODE);                                          1000 03790000
EXITRCDR L     @14,@SA00023                                        1000 03791000
         LM    @00,@12,@SA00023+8                                  1000 03792000
         BR    @14                                                 1000 03793000
*   END CKDARC;                                                    1001 03794000
*                                                                  1002 03795000
*/********************************************************************/ 03796000
*/*                                                                  */ 03797000
*/*    THE FOLLOWING PROCEDURE IS THE I/O SYNAD MESSAGE ROUTINE      */ 03798000
*/*    THE PRIMARY FUNCTION IS:                                      */ 03799000
*/*                                                                  */ 03800000
*/*        1.  PREPARE SYNAD ERROR MESAGE AND SET RTN CODE TO 4      */ 03801000
*/*                                                                  */ 03802000
*/********************************************************************/ 03803000
*/********************************************************************/ 03804000
*/*                                                                  */ 03805000
*/*                E  A7SYNAD ROUTINE                                */ 03806000
*/*                P  PREPARE I/O SYNAD ERROR MSG                    */ 03807000
*/*                S  CALL I/O: ISSUE MESSAGE                        */ 03808000
*/*                P  SET RETURN CODE TO 4                           */ 03809000
*/*                                                                  */ 03810000
*/********************************************************************/ 03811000
*                                                                  1002 03812000
*A7SYNAD:                                                          1002 03813000
*   PROCEDURE;                                                     1002 03814000
A7SYNAD  STM   @14,@12,@SA00024                                    1002 03815000
*   DCL                                                            1003 03816000
*     1 ERRORMSG BASED(PRMREG1+50), /* DEFINE SYNAD INSERT TEXT      */ 03817000
*      2 PART1 CHAR(34),            /* TOO BIG FOR ONE INSERT P1     */ 03818000
*      2 PART2 CHAR(44);            /* PART 2 OF TEXT                */ 03819000
*   DCL                                                            1004 03820000
*     PRMREG11 REGISTER(11) RSTD;   /* DEFINE PARM REG 11 FOR USE    */ 03821000
*   GENERATE;                                                      1005 03822000
         SYNADAF ACSMETH=QSAM          ISSUE SYNAD MACRO                03823000
*   LENINST1(1)=38;                 /* ESTABLISH LENGTH INSERT 1     */ 03824000
         MVC   LENINST1(2),@CH00570                                1006 03825000
*   LENINST1(2)=48;                 /* ESTABLISH LENGTH INSERT 2     */ 03826000
         MVC   LENINST1+56(2),@CH00571                             1007 03827000
*   INSTTXT1(1)=PART1;              /* MOVE FIRST HALF TEXT IN       */ 03828000
         MVI   INSTTXT1+34,C' '                                    1008 03829000
         MVC   INSTTXT1+35(17),INSTTXT1+34                         1008 03830000
         LA    @14,50                                              1008 03831000
         ALR   @14,PRMREG1                                         1008 03832000
         MVC   INSTTXT1(34),PART1(@14)                             1008 03833000
*   INSTTXT1(2)=PART2;              /* MOVE SECOND HALF TEXT IN      */ 03834000
         MVI   INSTTXT1+100,C' '                                   1009 03835000
         MVC   INSTTXT1+101(7),INSTTXT1+100                        1009 03836000
         MVC   INSTTXT1+56(44),PART2(@14)                          1009 03837000
*   PRMREG4=ADDR(MSGINST1(1));      /* SET UP PARM REG 4             */ 03838000
         LA    PRMREG4,MSGINST1                                    1010 03839000
*   PRMREG11=ADDR(MSGINST1(2));     /* SET UP PARM REG 11            */ 03840000
         LA    PRMREG11,MSGINST1+56                                1011 03841000
*   IOMSGPLT='00'X;                 /* CLEAR PARM LIST               */ 03842000
         XC    IOMSGPLT+1(83),IOMSGPLT+1                           1012 03843000
         MVI   IOMSGPLT,X'00'                                      1012 03844000
*   GENERATE REFS(@IOVCON);                                        1013 03845000
         IKJEGSIO MSG,FIRST=M0051,INST21=(ADDR,(4)),INST22=(ADDR,(11)),*03846000
               SECOND=M0202,ID=IO016,VCONBR=YES,MF=(E,IOMSGPLT)         03847000
*   IF RTNCODE>=16 THEN             /* TEST FOR ATTN                 */ 03848000
         CH    RTNCODE,@CH00095                                    1014 03849000
         BNL   @RT01014                                            1014 03850000
*     GO TO EXITSYND;               /* RETURN                        */ 03851000
*   GENERATE;                                                      1016 03852000
         SYNADRLS                      ISSUE SYNAD RELEASE MACRO        03853000
*   RTNCODE=4;                      /* SET RTN CODE TO ERROR         */ 03854000
         LA    RTNCODE,4                                           1017 03855000
*/********************************************************************/ 03856000
*/*                                                                  */ 03857000
*/*                R  RETURN TO CALLER                               */ 03858000
*/*                                                                  */ 03859000
*/********************************************************************/ 03860000
*                                                                  1018 03861000
*EXITSYND:                          /* LABEL AT EXIT OF ROUTINE      */ 03862000
*   RETURN TO EXITDS CODE(RTNCODE); /* RETURN TO EXIT                */ 03863000
EXITSYND LA    @14,EXITDS                                          1018 03864000
         LM    @00,@12,@SA00024+8                                  1018 03865000
         BR    @14                                                 1018 03866000
*   END A7SYNAD;                                                   1019 03867000
*                                                                  1020 03868000
*/********************************************************************/ 03869000
*/*                                                                  */ 03870000
*/*    THE FOLLOWING PROCEDURE IS THE BAD DATA SET ERROR ROUTINE     */ 03871000
*/*    THE PRIMARY FUNCTION IS:                                      */ 03872000
*/*                                                                  */ 03873000
*/*        1. PREPARE ERROR MESSAGE AND SET ERROR CODE TO 4          */ 03874000
*/*                                                                  */ 03875000
*/********************************************************************/ 03876000
*/********************************************************************/ 03877000
*/*                                                                  */ 03878000
*/*                E  BADDS ROUTINE                                  */ 03879000
*/*                S  CALL I/O: ISSUE MESSAGE                        */ 03880000
*/*                P  SET RETURN CODE TO 4                           */ 03881000
*/*                                                                  */ 03882000
*/********************************************************************/ 03883000
*                                                                  1020 03884000
*BADDS:                                                            1020 03885000
*   PROCEDURE;                                                     1020 03886000
BADDS    STM   @14,@12,@SA00025                                    1020 03887000
*   RESPECIFY                                                      1021 03888000
*     PRMREG4 RSTD;                 /* TELL PLS NOT TO USE REG HERE  */ 03889000
*   PRMREG4=TSTIODSN;               /* PICK UP PTR TO CORE           */ 03890000
         L     PRMREG4,TSTIODSN                                    1022 03891000
*   TSTIODSN=DSNCHAIN;              /* REMOVE FROM CHAIN             */ 03892000
         MVC   TSTIODSN(4),DSNCHAIN(PRMREG4)                       1023 03893000
*   GENERATE;                                                      1024 03894000
         FREEMAIN RC,LV=50,A=(4),SP=1  FREE CORE                        03895000
*   IF RTNCODE=0 THEN              /* TEST FOR ERROR                */ 03896000
         LTR   RTNCODE,RTNCODE                                     1025 03897000
         BZ    @RF01025                                            1025 03898000
*     DO;                                                          1026 03899000
*       PRMREG4=RTNCODE;            /* TRANSFER RTNCODE              */ 03900000
         LR    PRMREG4,RTNCODE                                     1027 03901000
*       IOMSGPLT='00'X;             /* CLEAR PARM LIST               */ 03902000
         XC    IOMSGPLT+1(83),IOMSGPLT+1                           1028 03903000
         MVI   IOMSGPLT,X'00'                                      1028 03904000
*       GENERATE REFS(@IOVCON);                                    1029 03905000
     IKJEGSIO SVCERR,SVC=120,RC=(4),ID=IO016,VCONBR=YES,MF=(E,IOMSGPLT) 03906000
*       IF RTNCODE<16 THEN          /* TEST FOR ATTN                 */ 03907000
         CH    RTNCODE,@CH00095                                    1030 03908000
         BNL   @RF01030                                            1030 03909000
*         RTNCODE=4;                /* INDICATE ERROR                */ 03910000
         LA    RTNCODE,4                                           1031 03911000
*       GO TO EXITBADD;             /* RETURN                        */ 03912000
         B     EXITBADD                                            1032 03913000
*     END;                                                         1033 03914000
*   LENINST2(1)=DSL+4;              /* STORE INSERT LENGTH           */ 03915000
@RF01025 L     @14,IOPARMS                                         1034 03916000
         L     @14,SIODSN(,@14)                                    1034 03917000
         LA    @06,4                                               1034 03918000
         AH    @06,DSL(,@14)                                       1034 03919000
         STH   @06,LENINST2                                        1034 03920000
*   INSTTXT2(1)=DSN;                /* MOVE IN TEXT OF INSERT        */ 03921000
         MVI   INSTTXT2+44,C' '                                    1035 03922000
         MVC   INSTTXT2+45(7),INSTTXT2+44                          1035 03923000
         L     @14,STRNGPTR(,@14)                                  1035 03924000
         MVC   INSTTXT2(44),DSN(@14)                               1035 03925000
*   PRMREG4=ADDR(MSGINST2(1));      /* POINT TO INSERT               */ 03926000
         LA    PRMREG4,MSGINST2                                    1036 03927000
*   IOMSGPLT='00'X;                 /* ZERO OUT PARM LIST            */ 03928000
         XC    IOMSGPLT+1(83),IOMSGPLT+1                           1037 03929000
         MVI   IOMSGPLT,X'00'                                      1037 03930000
*   GENERATE REFS(@IOVCON);                                        1038 03931000
         IKJEGSIO MSG,FIRST=M0054,INST11=(ADDR,(4)),SECOND=M0255,      *03932000
               ID=I0016,VCONBR=YES,MF=(E,IOMSGPLT)                      03933000
*   IF RTNCODE<16 THEN              /* TEST FOR ATTN                 */ 03934000
         CH    RTNCODE,@CH00095                                    1039 03935000
         BNL   @RF01039                                            1039 03936000
*     RTNCODE=4;                    /* INDICATE ERROR TO CALLER      */ 03937000
         LA    RTNCODE,4                                           1040 03938000
*/********************************************************************/ 03939000
*/*                                                                  */ 03940000
*/*                R  RETURN TO CALLER                               */ 03941000
*/*                                                                  */ 03942000
*/********************************************************************/ 03943000
*                                                                  1041 03944000
*EXITBADD:                          /* LABEL FOR EXIT OF ROUTINE     */ 03945000
*   RETURN CODE(RTNCODE);                                          1041 03946000
@RF01039 DS    0H                                                  1041 03947000
EXITBADD L     @14,@SA00025                                        1041 03948000
         LM    @00,@12,@SA00025+8                                  1041 03949000
         BR    @14                                                 1041 03950000
*   END BADDS;                                                     1042 03951000
*                                                                  1043 03952000
*/********************************************************************/ 03953000
*/*                                                                  */ 03954000
*/*    THE FOLLOWING PROCEDURE IS THE CHECK DATA SET ALLOCATED ROUT. */ 03955000
*/*    THE PRIMARY FUNCTIONS ARE:                                    */ 03956000
*/*                                                                  */ 03957000
*/*        1.  PREPARE AND MAINTAIN DSN QUEUE                        */ 03958000
*/*        2.  CLOSE THE CURRENT DCB IF NOT CORRECT DS               */ 03959000
*/*                                                                  */ 03960000
*/********************************************************************/ 03961000
*/********************************************************************/ 03962000
*/*                                                                  */ 03963000
*/*                E  CDSNAME ROUTINE                                */ 03964000
*/*                D  (YES,,NO,%CONT19)                            1043 03965000
*/*                   IS DSN PREVIOUS USED                           */ 03966000
*/*                S  (,ENDCKD)                                    1043 03967000
*/*                   CALL PUT:  SEND DATA TO D.S.                   */ 03968000
*/*%CONT19:        P  CLOSE DCB                                      */ 03969000
*/*                P  FREE DCB CORE                                  */ 03970000
*/*                P  FREE QSAM BUFFERS                              */ 03971000
*/*                                                                  */ 03972000
*/********************************************************************/ 03973000
*                                                                  1043 03974000
*CKDSNAME:                                                         1043 03975000
*   PROCEDURE;                                                     1043 03976000
CKDSNAME STM   @14,@12,@SA00026                                    1043 03977000
*   RESPECIFY                                                      1044 03978000
*     PRMREG4 RSTD;                 /* INDICATE RESTRICTED HERE      */ 03979000
*   PRMREG4=TSTIODSN;               /* GET ADDR OF OPEN DCB IN REG   */ 03980000
         L     PRMREG4,TSTIODSN                                    1045 03981000
*   IF TSTIODCB=0 THEN             /* MAKE SURE THERE IS A DCB      */ 03982000
         L     @14,TSTIODCB                                        1046 03983000
         LTR   @14,@14                                             1046 03984000
         BZ    @RF01046                                            1046 03985000
*     DO;                                                          1047 03986000
*       DCBPTR=IOTSTWK;             /* SAVE DCB POINTER              */ 03987000
         L     @06,IOTSTWK                                         1048 03988000
         ST    @06,DCBPTR                                          1048 03989000
*       IOTSTWK=TSTIODCB;           /* PICK UP LAST POINTER          */ 03990000
         ST    @14,IOTSTWK                                         1049 03991000
*       IF LENGTHDN=DSLNGTH THEN    /* SEE IF THE LENGTHS ARE EQ     */ 03992000
         LH    @14,DSLNGTH                                         1050 03993000
         CH    @14,LENGTHDN(,PRMREG4)                              1050 03994000
         BNE   @RF01050                                            1050 03995000
*         IF DN(1:DSLNGTH)=DSNAME(1:DSLNGTH) THEN/* SEE IF SAME      */ 03996000
         BCTR  @14,0                                               1051 03997000
         EX    @14,@SC00640                                        1051 03998000
         BNE   @RF01051                                            1051 03999000
*           DO;                                                    1052 04000000
*             PRMREG4=DCBPTR;       /* SET UP ADDRESSABILITY         */ 04001000
         LR    PRMREG4,@06                                         1053 04002000
*             GENERATE;                                            1054 04003000
         FREEMAIN RC,LV=TLEN,A=(4),SP=1 FREE UP CORE                    04004000
*             IF RTNCODE=0 THEN    /* TEST FOR PROBLEMS             */ 04005000
         LTR   RTNCODE,RTNCODE                                     1055 04006000
         BZ    @RF01055                                            1055 04007000
*               DO;                                                1056 04008000
*                 PRMREG4=RTNCODE;  /* TRANSFER RETURN CODE          */ 04009000
         LR    PRMREG4,RTNCODE                                     1057 04010000
*                 IOMSGPLT='00'X;   /* CLEAR PARM LIST               */ 04011000
         XC    IOMSGPLT+1(83),IOMSGPLT+1                           1058 04012000
         MVI   IOMSGPLT,X'00'                                      1058 04013000
*                 GENERATE REFS(@IOVCON);                          1059 04014000
     IKJEGSIO SVCERR,SVC=120,RC=(4),ID=I0016,VCONBR=YES,MF=(E,IOMSGPLT) 04015000
*                 IF RTNCODE<16 THEN/* TEST FOR ATTN                 */ 04016000
         CH    RTNCODE,@CH00095                                    1060 04017000
         BNL   @RF01060                                            1060 04018000
*                   RTNCODE=4;      /* INDICATE PROBLEMS TO CALLER   */ 04019000
         LA    RTNCODE,4                                           1061 04020000
*                 GO TO EXITCKDN;   /* RETURN                        */ 04021000
         B     EXITCKDN                                            1062 04022000
*               END;                                               1063 04023000
*             CALL PUT;             /* HAVE LINE PUT INTO DS         */ 04024000
@RF01055 BAL   @14,PUT                                             1064 04025000
*             RETURN TO EXITDS;     /* RETURN TO CALLER              */ 04026000
         LA    @14,EXITDS                                          1065 04027000
         LM    @15,@12,@SA00026+4                                  1065 04028000
         BR    @14                                                 1065 04029000
*           END;                                                   1066 04030000
*       IOTSTWK=DCBPTR;             /* RESTORE DCBPTR                */ 04031000
@RF01051 DS    0H                                                  1067 04032000
@RF01050 MVC   IOTSTWK(4),DCBPTR                                   1067 04033000
*     END;                                                         1068 04034000
*   IF TSTIODSN=0 THEN             /* SEE IF THERE IS A DCB OPEN    */ 04035000
@RF01046 ICM   @14,15,TSTIODSN                                     1069 04036000
         BZ    @RF01069                                            1069 04037000
*     DO DSNQUEUE=1 BY 1 TO 256;    /* LOOP THRU DSN QUEUE           */ 04038000
         LA    @14,1                                               1070 04039000
         STH   @14,DSNQUEUE                                        1070 04040000
@DL01070 DS    0H                                                  1071 04041000
*       IF LENGTHDN=DSLNGTH THEN    /* IF THE NAME IS IN THE QUEUE   */ 04042000
         LH    @14,DSLNGTH                                         1071 04043000
         CH    @14,LENGTHDN(,PRMREG4)                              1071 04044000
         BNE   @RF01071                                            1071 04045000
*         IF DN(1:DSLNGTH)=DSNAME(1:DSLNGTH) THEN/* COMPARE          */ 04046000
         BCTR  @14,0                                               1072 04047000
         EX    @14,@SC00640                                        1072 04048000
         BNE   @RF01072                                            1072 04049000
*           DO;                                                    1073 04050000
*             TSTFLGS3(5)='1'B;     /* TURN ON THE DUPLICATE NAME    */ 04051000
         OI    TSTFLGS3,B'00001000'                                1074 04052000
*             GO TO NEWDSN;         /* NO MORE PROCESSING REQ'D      */ 04053000
         B     NEWDSN                                              1075 04054000
*           END;                                                   1076 04055000
*       PRMREG4=DSNCHAIN;           /* MOVE TO NEXT ELEMENT IN CH'N  */ 04056000
@RF01072 DS    0H                                                  1077 04057000
@RF01071 L     PRMREG4,DSNCHAIN(,PRMREG4)                          1077 04058000
*       IF PRMREG4=0 THEN           /* MAKE SURE MORE TO COMPARE     */ 04059000
         LTR   PRMREG4,PRMREG4                                     1078 04060000
         BZ    @RT01078                                            1078 04061000
*         GO TO NEWDSN;             /* IF NOT STOP SEARCHING         */ 04062000
*     END;                                                         1080 04063000
         LA    @14,1                                               1080 04064000
         AH    @14,DSNQUEUE                                        1080 04065000
         STH   @14,DSNQUEUE                                        1080 04066000
         CH    @14,@CH00393                                        1080 04067000
         BNH   @DL01070                                            1080 04068000
*NEWDSN:                                                           1081 04069000
*   GENERATE;                                                      1081 04070000
@RF01069 DS    0H                                                  1081 04071000
NEWDSN   DS    0H                                                  1081 04072000
         GETMAIN RC,LV=50,SP=1                                          04073000
*   IF RTNCODE=0 THEN              /* SEE IF GETMAIN FAILED         */ 04074000
         LTR   RTNCODE,RTNCODE                                     1082 04075000
         BZ    @RF01082                                            1082 04076000
*     DO;                                                          1083 04077000
*       PRMREG4=RTNCODE;            /* TRANSFER RETURN CODE          */ 04078000
         LR    PRMREG4,RTNCODE                                     1084 04079000
*       IOMSGPLT='00'X;             /* ZERO OUT PARM LIST FOR IO     */ 04080000
         XC    IOMSGPLT+1(83),IOMSGPLT+1                           1085 04081000
         MVI   IOMSGPLT,X'00'                                      1085 04082000
*       GENERATE REFS(@IOVCON);                                    1086 04083000
     IKJEGSIO SVCERR,SVC=10,RC=(4),ID=I0016,VCONBR=YES,MF=(E,IOMSGPLT)  04084000
*       IF RTNCODE<16 THEN          /* MAKE SURE AN ATTN NOT   SCHE'D*/ 04085000
         CH    RTNCODE,@CH00095                                    1087 04086000
         BNL   @RF01087                                            1087 04087000
*         RTNCODE=4;                /* SET THE RETURN CODE TO ERROR  */ 04088000
         LA    RTNCODE,4                                           1088 04089000
*       GO TO EXITCKDN;             /* BRANCH TO EXIT OF ROUTINE     */ 04090000
         B     EXITCKDN                                            1089 04091000
*     END;                                                         1090 04092000
*   PRMREG4=PRMREG1;                /* TRANSFER GETMAIN ADDRESS      */ 04093000
@RF01082 LR    PRMREG4,PRMREG1                                     1091 04094000
*   DSNCHAIN=TSTIODSN;              /* MOVE NEW NAME INTO DSN CHAIN  */ 04095000
         MVC   DSNCHAIN(4,PRMREG4),TSTIODSN                        1092 04096000
*   TSTIODSN=PRMREG4;               /* STORE ADD OF NEW DCB TCOMTAB  */ 04097000
         ST    PRMREG4,TSTIODSN                                    1093 04098000
*   LENGTHDN=DSLNGTH;               /* STORE LENGTH IN CHAIN         */ 04099000
         LH    @14,DSLNGTH                                         1094 04100000
         STH   @14,LENGTHDN(,PRMREG4)                              1094 04101000
*   DN(1:DSLNGTH)=DSNAME(1:DSLNGTH);/* STORE NAME IN CHAIN           */ 04102000
         BCTR  @14,0                                               1095 04103000
         EX    @14,@SM00643                                        1095 04104000
*CLOSEDCB:                                                         1096 04105000
*   IF TSTIODCB=0 THEN             /* MAKE SURE THERE IS OPEN DCB   */ 04106000
CLOSEDCB ICM   @14,15,TSTIODCB                                     1096 04107000
         BZ    @RF01096                                            1096 04108000
*     DO;                                                          1097 04109000
*       CALL ATTNCK;                /* CHECK FOR AN ATTN             */ 04110000
         BAL   @14,ATTNCK                                          1098 04111000
*       IF RTNCODE=0 THEN          /* IF ONE GET OUT & RTN          */ 04112000
         LTR   RTNCODE,RTNCODE                                     1099 04113000
         BNZ   @RT01099                                            1099 04114000
*         GO TO EXITCKDN;                                          1100 04115000
*       PRMREG4=TSTIODCB;           /* ESTAB ADDRESS OF OLD DCB      */ 04116000
         L     PRMREG4,TSTIODCB                                    1101 04117000
*       PRMREG1=ADDR(CLOSE);        /* SET UP ADDR IN R1 - CLOSE PL  */ 04118000
         L     @14,IOTSTWK                                         1102 04119000
         LA    PRMREG1,CLOSE(,@14)                                 1102 04120000
*       CLOSE=CLFORM;               /* MOVE LIST FORM OF CLOSE MAC   */ 04121000
         MVC   CLOSE(4,@14),CLFORM                                 1103 04122000
*       GENERATE;                                                  1104 04123000
         CLOSE ((4)),MF=(E,(1))                                         04124000
         FREEPOOL (4)                  FREE QSAM BUFFERS                04125000
         FREEMAIN RC,LV=TLEN,SP=1,A=(4) FREE OLD DCB                    04126000
*       IF RTNCODE=0 THEN          /* TEST FOR PROBLEMS             */ 04127000
         LTR   RTNCODE,RTNCODE                                     1105 04128000
         BZ    @RF01105                                            1105 04129000
*         DO;                                                      1106 04130000
*           PRMREG4=RTNCODE;        /* TRANSFER RETURN CODE          */ 04131000
         LR    PRMREG4,RTNCODE                                     1107 04132000
*           IOMSGPLT='00'X;         /* CLEAR PARM LIST               */ 04133000
         XC    IOMSGPLT+1(83),IOMSGPLT+1                           1108 04134000
         MVI   IOMSGPLT,X'00'                                      1108 04135000
*           GENERATE REFS(@IOVCON);                                1109 04136000
     IKJEGSIO SVCERR,SVC=120,RC=(4),ID=IO016,VCONBR=YES,MF=(E,IOMSGPLT) 04137000
*           IF RTNCODE<16 THEN      /* TEST FOR AN ATTN              */ 04138000
         CH    RTNCODE,@CH00095                                    1110 04139000
         BNL   @RF01110                                            1110 04140000
*             RTNCODE=4;            /* INDICATE TO USER PROBLEMS     */ 04141000
         LA    RTNCODE,4                                           1111 04142000
*         END;                                                     1112 04143000
@RF01110 DS    0H                                                  1113 04144000
*       TSTIODCB='00'X;             /* ZERO OUT TSTIODCB IN TCOMTAB  */ 04145000
@RF01105 SLR   @14,@14                                             1113 04146000
         ST    @14,TSTIODCB                                        1113 04147000
*     END;                                                         1114 04148000
*                                                                  1114 04149000
*/********************************************************************/ 04150000
*/*                                                                  */ 04151000
*/*ENDCKD:         R  RETURN TO CALLER                               */ 04152000
*/*                                                                  */ 04153000
*/********************************************************************/ 04154000
*                                                                  1115 04155000
*EXITCKDN:                                                         1115 04156000
*   RETURN CODE(RTNCODE);           /* RETURN TO CALLER              */ 04157000
@RF01096 DS    0H                                                  1115 04158000
EXITCKDN L     @14,@SA00026                                        1115 04159000
         LM    @00,@12,@SA00026+8                                  1115 04160000
         BR    @14                                                 1115 04161000
*   END CKDSNAME;                                                  1116 04162000
*                                                                  1117 04163000
*/********************************************************************/ 04164000
*/*                                                                  */ 04165000
*/*                E  OPEN ROUTINE                                   */ 04166000
*/*                P  CREATE DCB AND OPEN DATA SET                   */ 04167000
*/*                                                                  */ 04168000
*/********************************************************************/ 04169000
*                                                                  1117 04170000
*OPENDS:                                                           1117 04171000
*   PROCEDURE;                                                     1117 04172000
OPENDS   STM   @14,@12,@SA00027                                    1117 04173000
*   RESPECIFY                                                      1118 04174000
*     PRMREG4 RSTD;                 /* TELL PLS TO NOT USE REG 4     */ 04175000
*   DCL                                                            1119 04176000
*     OPENREG REGISTER(11) RSTD;    /* DEFINE OPEN REGISTER FOR USE  */ 04177000
*   DCL                                                            1120 04178000
*     DCBOFLGS BIT(8) GEND;         /* FLAG BYTE TO CK FOR OK OPEN   */ 04179000
*   DCL                                                            1121 04180000
*     MYDCB CHAR(96) GEND;          /* DEFINE DCB LIST FORM          */ 04181000
*   DCL                                                            1122 04182000
*     LFORM CHAR(4) GEND;           /* DEFINE LIST FORM OF OPEN      */ 04183000
*   DCL                                                            1123 04184000
*     DCBDDNAM CHAR(8) GEND;        /* DEFINE DD NAME AREA IN DCB    */ 04185000
*   GENERATE;                                                      1124 04186000
         DROP  DSECT4                  RELEASE REG 4 FOR USE            04187000
         USING IHADCB,DSECT4           ESTAB REG 4 FOR DSECT            04188000
*   PRMREG4=IOTSTWK;                /* ESTAB ADDRESS OF DCB          */ 04189000
         L     @14,IOTSTWK                                         1125 04190000
         LR    PRMREG4,@14                                         1125 04191000
*   OPEN=LFORM;                     /* MOVE LIST FORM OF OPEN MACRO  */ 04192000
         MVC   OPEN(4,@14),LFORM                                   1126 04193000
*   DCB=MYDCB;                      /* MOVE LIST FORM OF DCB MACRO   */ 04194000
         MVC   DCB(96,@14),MYDCB                                   1127 04195000
*   DCBDDNAM=TEMPDDN;               /* MOVE DD NAME TO DCBDD NAME    */ 04196000
         MVC   DCBDDNAM(8),TEMPDDN                                 1128 04197000
*   CALL ATTNCK;                    /* SEE IF ATTN OR LOGOFF IN PRO  */ 04198000
         BAL   @14,ATTNCK                                          1129 04199000
*   IF RTNCODE=0 THEN              /* TEST RESULTS                  */ 04200000
         LTR   RTNCODE,RTNCODE                                     1130 04201000
         BNZ   @RT01130                                            1130 04202000
*     GO TO EXITOPEN;               /* BRANCH TO THE EXIT            */ 04203000
*   OPENREG=ADDR(OPEN);             /* SET UP OPEN PARM REG          */ 04204000
         L     OPENREG,IOTSTWK                                     1132 04205000
         LA    OPENREG,OPEN(,OPENREG)                              1132 04206000
*   GENERATE;                                                      1133 04207000
         OPEN ((4)),MF=(E,(11))                                         04208000
*   RTNCODE=0;                      /* MAKE SURE RTNCODE ZERO        */ 04209000
         SLR   RTNCODE,RTNCODE                                     1134 04210000
*   IF DCBOFLGS(4)='1'B THEN       /* SEE WE WERE ABLE GET IT OPEN  */ 04211000
         TM    DCBOFLGS,B'00010000'                                1135 04212000
         BO    @RF01135                                            1135 04213000
*     DO;                                                          1136 04214000
*       IOMSGPLT='00'X;             /* CLEAR PARM LIST               */ 04215000
         XC    IOMSGPLT+1(83),IOMSGPLT+1                           1137 04216000
         MVI   IOMSGPLT,X'00'                                      1137 04217000
*       GENERATE REFS(@IOVCON);                                    1138 04218000
* ISSUE THE COULD NOT OPEN DATA SET MESSAGE                             04219000
         IKJEGSIO MSG,FIRST=M0052,ID=IO016,VCONBR=YES,MF=(E,IOMSGPLT)   04220000
*       IF RTNCODE<16 THEN          /* MAKE SURE AN ATTN NOT SCHE    */ 04221000
         CH    RTNCODE,@CH00095                                    1139 04222000
         BNL   @RF01139                                            1139 04223000
*         RTNCODE=4;                /* INDICATE TROUBLE WITH 4 RC    */ 04224000
         LA    RTNCODE,4                                           1140 04225000
*     END;                                                         1141 04226000
*                                                                  1141 04227000
@RF01139 DS    0H                                                  1142 04228000
*/********************************************************************/ 04229000
*/*                                                                  */ 04230000
*/*                R  RETURN TO CALLER                               */ 04231000
*/*                                                                  */ 04232000
*/********************************************************************/ 04233000
*                                                                  1142 04234000
*EXITOPEN:                          /* LABEL USED TO BRANCH TO END   */ 04235000
*   RETURN CODE(RTNCODE);           /* RETURN TO DATA SET ROUTINE    */ 04236000
@RF01135 DS    0H                                                  1142 04237000
EXITOPEN L     @14,@SA00027                                        1142 04238000
         LM    @00,@12,@SA00027+8                                  1142 04239000
         BR    @14                                                 1142 04240000
*   END OPENDS;                                                    1143 04241000
*                                                                  1144 04242000
*/********************************************************************/ 04243000
*/*                                                                  */ 04244000
*/*    THE FOLLOWING PROCEDURE IS THE PUT ROUTINE                    */ 04245000
*/*    THE PRIMARY FUNCTION IS:                                      */ 04246000
*/*                                                                  */ 04247000
*/*        1.   ISSUE PUT MACRO TO PUT OUT DATA TO D.S.              */ 04248000
*/*                                                                  */ 04249000
*/********************************************************************/ 04250000
*/********************************************************************/ 04251000
*/*                                                                  */ 04252000
*/*                E  PUT ROUTINE                                    */ 04253000
*/*                S  CALL ATTN CHECK: CHECK FOR ATTN OR LOGOFF      */ 04254000
*/*                P  ISSUE PUT MACRO TO PUT DATA LINE IN DATA SET   */ 04255000
*/*                R  RETURN TO CALLING ROUTINE                      */ 04256000
*/*                                                                  */ 04257000
*/********************************************************************/ 04258000
*                                                                  1144 04259000
*PUT:                                                              1144 04260000
*   PROCEDURE;                                                     1144 04261000
PUT      STM   @14,@12,@SA00028                                    1144 04262000
*   CALL ATTNCK;                    /* SEE IF ATTENTION WAS SCHE'D   */ 04263000
         BAL   @14,ATTNCK                                          1145 04264000
*   IF RTNCODE=0 THEN              /* SHOULD THE PROCESSING STOP ?  */ 04265000
         SLR   @14,@14                                             1146 04266000
         CR    RTNCODE,@14                                         1146 04267000
         BNE   @RT01146                                            1146 04268000
*     GO TO EXITPUT;                /* IF SO RETURN                  */ 04269000
*   IF SKIPLINE=0 THEN              /* IF NULL LINE REQ      @ZA15369*/ 04270000
         L     @06,IOPARMS                                         1148 04271000
         L     @06,SIODATA(,@06)                                   1148 04272000
         CH    @14,SKIPLINE(,@06)                                  1148 04273000
         BNE   @RF01148                                            1148 04274000
*     SKIPLINE=NULLINE(1:2);        /* SET LL TO 05          @ZA15369*/ 04275000
         MVC   SKIPLINE(2,@06),NULLINE                             1149 04276000
*   PRMREG1=TSTIODCB;               /* SET UP ADDR OF DCB FOR PUT    */ 04277000
@RF01148 L     PRMREG1,TSTIODCB                                    1150 04278000
*   PRMREG0=SIODATA;                /* SET UP ADDR TO DATA LINE      */ 04279000
         L     @14,IOPARMS                                         1151 04280000
         L     PRMREG0,SIODATA(,@14)                               1151 04281000
*   GENERATE(PUT (1),(0));          /* ISSUE PUT ASSEM MACRO         */ 04282000
         PUT (1),(0)                                                    04283000
*   RTNCODE=0;                      /* INITIALIZE RTNCODE TO ZERO    */ 04284000
         SLR   RTNCODE,RTNCODE                                     1153 04285000
*EXITPUT:                                                          1154 04286000
*   RETURN CODE(RTNCODE);           /* RETURN TO CALLER WITH CODE    */ 04287000
EXITPUT  L     @14,@SA00028                                        1154 04288000
         LM    @00,@12,@SA00028+8                                  1154 04289000
         BR    @14                                                 1154 04290000
*   END PUT;                                                       1155 04291000
*                                                                  1156 04292000
*/********************************************************************/ 04293000
*/*                                                                  */ 04294000
*/*    THE FOLLOWING PROCEDURE IS THE OPEN EXIT ROUTINE CALL BY OPEN */ 04295000
*/*    THE PRIMARY FUNCTION IS:                                      */ 04296000
*/*                                                                  */ 04297000
*/*        1.  ADJUST DCB DURING THE OPENING OF DATA SET             */ 04298000
*/*                                                                  */ 04299000
*/********************************************************************/ 04300000
*/********************************************************************/ 04301000
*/*                                                                  */ 04302000
*/*                E  EXIT ROUTINE                                   */ 04303000
*/*                P  ADJUST REC AND BLK SIZES IF NOT COMPATIBLE     */ 04304000
*/*                R  RETURN TO CALLING ROUTINE                      */ 04305000
*/*                                                                  */ 04306000
*/********************************************************************/ 04307000
*                                                                  1156 04308000
*EXIT:                                                             1156 04309000
*   PROCEDURE;                                                     1156 04310000
EXIT     STM   @14,@12,12(@13)                                     1156 04311000
*   DCL                                                            1157 04312000
*     DCBRECFM BIT(8) GEND;         /* DEFINE DCB FIELDS TO PLS      */ 04313000
*   DCL                                                            1158 04314000
*     DCBLRECL FIXED(15) GEND;      /* DEFINE DCB FIELDS TO PLS      */ 04315000
*   DCL                                                            1159 04316000
*     DCBBLKSI FIXED(15) GEND;      /* DEFINE DCB FIELDS TO PLS      */ 04317000
*   IF DCBRECFM(2)='1'B|DCBRECFM(1:2)='11'B THEN/* TEST FMT         */ 04318000
         TM    DCBRECFM,B'01000000'                                1160 04319000
         BNO   @RT01160                                            1160 04320000
         TM    DCBRECFM,B'11000000'                                1160 04321000
         BNO   @RF01160                                            1160 04322000
@RT01160 DS    0H                                                  1161 04323000
*     DO;                                                          1161 04324000
*       DCBRECFM='50'X;             /* SET IN THE DEFAULT SIZE       */ 04325000
         MVI   DCBRECFM,X'50'                                      1162 04326000
*       DCBLRECL=125;               /* SET IN THE DEFAULT SIZE       */ 04327000
         MVC   DCBLRECL(2),@CH00611                                1163 04328000
*       DCBBLKSI=1629;              /* SET IN THE DEFAULT SIZE       */ 04329000
         MVC   DCBBLKSI(2),@CH00612                                1164 04330000
*       GO TO EXITEXIT;             /* RETURN TO OPEN                */ 04331000
         B     EXITEXIT                                            1165 04332000
*     END;                                                         1166 04333000
*   IF DCBLRECL>125 THEN            /* TEST FOR SIZE GT THAN 124     */ 04334000
@RF01160 LA    @14,125                                             1167 04335000
         CH    @14,DCBLRECL                                        1167 04336000
         BNL   @RF01167                                            1167 04337000
*     DCBLRECL=125;                 /* RESET TO TEST LIMITS          */ 04338000
         STH   @14,DCBLRECL                                        1168 04339000
*   IF DCBBLKSI<129 THEN            /* TEST FOR MIMIMUM SIZE         */ 04340000
@RF01167 LA    @14,129                                             1169 04341000
         CH    @14,DCBBLKSI                                        1169 04342000
         BNH   @RF01169                                            1169 04343000
*     DCBBLKSI=129;                 /* RESET TO TEST LIMITS          */ 04344000
         STH   @14,DCBBLKSI                                        1170 04345000
*EXITEXIT:                          /* LABEL TO BRANCH TO EXIT OF R  */ 04346000
*   RETURN;                                                        1171 04347000
@EL00029 DS    0H                                                  1171 04348000
@EF00029 DS    0H                                                  1171 04349000
@ER00029 LM    @14,@12,12(@13)                                     1171 04350000
         BR    @14                                                 1171 04351000
*   END EXIT;                                                      1172 04352000
         B     @EL00029                                            1172 04353000
*   END DATASET;                                                   1173 04354000
*                                                                  1174 04355000
*/********************************************************************/ 04356000
*/*                                                                  */ 04357000
*/* THE FOLLOWING GENERATE SECTION WILL EXPAND ALL ASSEMBLER MACROS  */ 04358000
*/*                                                                  */ 04359000
*/********************************************************************/ 04360000
*                                                                  1174 04361000
*   GENERATE DATA;                                                 1174 04362000
*   END IKJEGIO                                                    1175 04363000
*                                                                  1175 04364000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 04365000
*/*%INCLUDE SYSLIB  (IKJPPL  )                                       */ 04366000
*                                                                  1175 04367000
*       ;                                                          1175 04368000
@EL00001 L     @13,4(,@13)                                         1175 04369000
@EF00001 L     @00,@SIZDATD                                        1175 04370000
         LR    @01,@12                                             1175 04371000
         FREEMAIN R,LV=(0),A=(1)                                        04372000
@ER00001 LM    @14,@12,12(@13)                                     1175 04373000
         BR    @14                                                 1175 04374000
@DATA    DS    0H                                                       04375000
@CH00235 DC    H'0'                                                     04376000
@CH00146 DC    H'4'                                                     04377000
@CH00129 DC    H'6'                                                     04378000
@CH00033 DC    H'7'                                                     04379000
@CH00034 DC    H'8'                                                     04380000
@CH00058 DC    H'12'                                                    04381000
@CH00095 DC    H'16'                                                    04382000
@CH00251 DC    H'20'                                                    04383000
@CH00082 DC    H'24'                                                    04384000
@CH00570 DC    H'38'                                                    04385000
@CH00571 DC    H'48'                                                    04386000
@CH00617 DC    H'56'                                                    04387000
@CH00259 DC    H'99'                                                    04388000
@CH00611 DC    H'125'                                                   04389000
@CH00263 DC    H'199'                                                   04390000
@CH00258 DC    H'200'                                                   04391000
@CH00393 DC    H'256'                                                   04392000
@CH00612 DC    H'1629'                                                  04393000
@CH00557 DC    XL2'1708'                                                04394000
@SM00623 MVC   0(0,@10),VPDETXT(@05)                                    04395000
@SM00625 MVC   0(0,@11),MSGINST(@10)                                    04396000
@SM00629 MVC   PARSEMSG(0,@14),FMTMSG(@11)                              04397000
@SC00634 CLC   NAME(0,@14),DSN(@05)                                     04398000
@SM00636 MVC   DA08PSWD(0),PASSWORD(@14)                                04399000
@SM00638 MVC   DSNAME(0),DSN(@14)                                       04400000
@SC00640 CLC   DN(0,PRMREG4),DSNAME                                     04401000
@SM00643 MVC   DN(0,PRMREG4),DSNAME                                     04402000
@DATD    DSECT                                                          04403000
         DS    0F                                                       04404000
@SA00001 DS    18F                                                      04405000
@SA00020 DS    15F                                                      04406000
@SA00015 DS    15F                                                      04407000
@SA00003 DS    15F                                                      04408000
@SA00012 DS    15F                                                      04409000
@SA00019 DS    15F                                                      04410000
@SA00004 DS    15F                                                      04411000
@SA00016 DS    15F                                                      04412000
@SA00007 DS    15F                                                      04413000
@SA00005 DS    15F                                                      04414000
@SA00011 DS    15F                                                      04415000
@SA00009 DS    15F                                                      04416000
@SA00010 DS    15F                                                      04417000
@SA00013 DS    15F                                                      04418000
@SA00014 DS    15F                                                      04419000
@SA00021 DS    15F                                                      04420000
@SA00028 DS    15F                                                      04421000
@SA00022 DS    15F                                                      04422000
@SA00026 DS    15F                                                      04423000
@SA00025 DS    15F                                                      04424000
@SA00023 DS    15F                                                      04425000
@SA00027 DS    15F                                                      04426000
@SA00024 DS    15F                                                      04427000
IKJEGIO  CSECT                                                          04428000
         DS    0F                                                       04429000
@CF00115 DC    F'1'                                                     04430000
@CH00115 EQU   @CF00115+2                                               04431000
@CF00119 DC    F'2'                                                     04432000
@CH00119 EQU   @CF00119+2                                               04433000
@CF00032 DC    F'3'                                                     04434000
@CF00256 DC    F'100'                                                   04435000
@CH00256 EQU   @CF00256+2                                               04436000
@CF00628 DC    F'-12'                                                   04437000
@CF00627 DC    F'-8'                                                    04438000
@CF00622 DC    F'-4'                                                    04439000
@DATD    DSECT                                                          04440000
         DS    0D                                                       04441000
MSGPTR   DS    A                                                        04442000
INSTPTR  DS    A                                                        04443000
DCBPTR   DS    A                                                        04444000
IOPARMS  DS    A                                                        04445000
INSTCTR  DS    F                                                        04446000
SIOTYPPT DS    A                                                        04447000
SIOINTPT DS    A                                                        04448000
PPLPTR   DS    A                                                        04449000
PDLPTR   DS    A                                                        04450000
INDXTAB  DS    A                                                        04451000
REGPTR   DS    A                                                        04452000
ZEROCTR  DS    F                                                        04453000
SVCTABPR DS    A                                                        04454000
SVCINDX  DS    F                                                        04455000
ABENDINX DS    F                                                        04456000
RCODEINX DS    F                                                        04457000
IOTSTWK  DS    A                                                        04458000
TEMPTPL  DS    A                                                        04459000
DAPLRC   DS    F                                                        04460000
INTBUFPT DS    A                                                        04461000
MSGBUFPT DS    A                                                        04462000
DSNQUEUE DS    H                                                        04463000
LEV      DS    FL1                                                      04464000
TYPEINST DS    FL1                                                      04465000
LENGTH   DS    FL1                                                      04466000
         DS    CL3                                                      04467000
IOMSGPLT DS    CL84                                                     04468000
ESTAEPRM DS    CL16                                                     04469000
USERPPL  DS    CL28                                                     04470000
USERCBUF DS    CL5                                                      04471000
         DS    CL3                                                      04472000
MSGBUF   DS    CL932                                                    04473000
         ORG   MSGBUF                                                   04474000
MESSAGE  DS    CL104                                                    04475000
         ORG   MESSAGE+0                                                04476000
LENMSG   DS    FL2                                                      04477000
@NM00004 DS    FL2                                                      04478000
MSGTEXT  DS    CL100                                                    04479000
         ORG   MSGTEXT+0                                                04480000
WKMSGID  DS    CL9                                                      04481000
WKMSGTXT DS    CL91                                                     04482000
         ORG   MSGBUF+208                                               04483000
MSGINST1 DS    CL56                                                     04484000
         ORG   MSGINST1+0                                               04485000
LENINST1 DS    FL2                                                      04486000
DISPIN1  DS    FL2                                                      04487000
INSTTXT1 DS    CL52                                                     04488000
         ORG   MSGBUF+544                                               04489000
MSGINST2 DS    CL56                                                     04490000
         ORG   MSGINST2+0                                               04491000
LENINST2 DS    FL2                                                      04492000
DISPIN2  DS    FL2                                                      04493000
INSTTXT2 DS    CL52                                                     04494000
         ORG   MSGBUF+880                                               04495000
USERIOPL DS    CL16                                                     04496000
USERPGB  DS    CL12                                                     04497000
         ORG   USERPGB                                                  04498000
@NM00005 DS    CL8                                                      04499000
MRTNADDR DS    AL4                                                      04500000
         ORG   MSGBUF+908                                               04501000
OUTPUTPB DS    CL16                                                     04502000
         ORG   OUTPUTPB                                                 04503000
@NM00006 DS    CL8                                                      04504000
FMATMSG  DS    AL4                                                      04505000
@NM00007 DS    CL4                                                      04506000
         ORG   MSGBUF+924                                               04507000
VPDE     DS    CL8                                                      04508000
         ORG   VPDE                                                     04509000
VPDEPT   DS    AL4                                                      04510000
VPDEL    DS    FL2                                                      04511000
VDEFLG   DS    FL1                                                      04512000
VPDET    DS    FL1                                                      04513000
         ORG   MSGBUF+932                                               04514000
TEMPDDN  DS    CL8                                                      04515000
DSNDAIR  DS    CL46                                                     04516000
         ORG   DSNDAIR                                                  04517000
DSLNGTH  DS    FL2                                                      04518000
DSNAME   DS    CL44                                                     04519000
         ORG   DSNDAIR+46                                               04520000
         DS    CL2                                                      04521000
DAPB08WK DS    CL100                                                    04522000
DAPLWK   DS    CL20                                                     04523000
DFPBWK   DS    CL20                                                     04524000
EFF18PL  DS    CL20                                                     04525000
         ORG   EFF18PL                                                  04526000
F18DAPL  DS    AL4                                                      04527000
F18DAPRC DS    AL4                                                      04528000
F18MSGPT DS    AL4                                                      04529000
F18IDNUM DS    AL4                                                      04530000
F18FILL  DS    FL4                                                      04531000
         ORG   EFF18PL+20                                               04532000
MACROWK  DS    CL12                                                     04533000
IKJEGIO  CSECT                                                          04534000
         DS    0F                                                       04535000
@SIZDATD DC    AL1(78)                                                  04536000
         DC    AL3(@ENDDATD-@DATD)                                      04537000
@CA00152 DC    A(ATTACHIO)                                              04538000
         DS    0D                                                       04539000
PUTOUT   DC    XL4'0'                                                   04540000
F18MSG   DC    F'0'                                                     04541000
F18ID    DC    H'1'                                                     04542000
         DS    CL2                                                      04543000
LIST     DS    CL4                                                      04544000
         ORG   LIST                                                     04545000
@NM00001 DC    XL1'85'                                                  04546000
@NM00002 DC    AL3(EXIT)                                                04547000
         ORG   LIST+4                                                   04548000
SUPERZAP DS    CL50                                                     04549000
         ORG   SUPERZAP                                                 04550000
@NM00003 DC    50CL1'Z'                                                 04551000
         ORG   SUPERZAP+50                                              04552000
         DS    CL2                                                      04553000
NULLINE  DS    CL5                                                      04554000
         ORG   NULLINE                                                  04555000
@NM00020 DC    H'5'                                                     04556000
@NM00021 DC    H'0'                                                     04557000
@NM00022 DC    CL1' '                                                   04558000
         ORG   NULLINE+5                                                04559000
TESTLIST DC    CL8'TESTLIST'                                            04560000
DUMBUF   DC    X'0005000040'                                            04561000
DSN2LONG DS    CL67                                                     04562000
         ORG   DSN2LONG                                                 04563000
MSGLENTH DC    H'67'                                                    04564000
@NM00025 DS    FL2                                                      04565000
TXTOFMSG DC    CL63'IKJ57613I DSNAME WHEN FULLY QUALIFIED WILL EXCEED 4C04566000
               4 CHARACTERS'                                            04567000
         ORG   DSN2LONG+67                                              04568000
IKJEGIO  CSECT                                                          04569000
*                                      /* VCON FOR SIO MACRO  ZZZZZZZZ* 04570000
@IOVCON  DC    V(IKJEGIO)                                               04571000
@DATD    DSECT                                                          04572000
*                                       /* PCL AND VALIDCK   @ZA06223*/ 04573000
IKJEGIO  CSECT    ,           PUSHING THE ASSEMBLER AROUND   @ZA06223   04574000
PCLADDR  DC       A(PRMTPCL)  PCL ADDRESS IN HERE            @ZA06223   04575000
PRMTPCL  IKJPARM  DSECT=PDLMAP                                          04576000
PRMTDSN  IKJPOSIT DSNAME,USID,VALIDCK=CHKDSNM,               @ZA06223  X04577000
               PROMPT='OUTPUT DATA SET NAME'                 @ZA06223   04578000
         IKJENDP                                                        04579000
CHKDSNM  CSECT                                               @ZA06223   04580000
         STM   14,12,12(13)   SAVE PARSE REGS                @ZA06223   04581000
         BALR  12,0           GET ADDRESSABILITY             @ZA06223   04582000
         USING *,12           FOR CSECT                      @ZA06223   04583000
         LR    2,1            SAVE PARAMETERS                @ZA06223   04584000
         GETMAIN R,LV=72      GET A SAVE AREA                @ZA06223   04585000
         ST    1,8(13)        AND CHAIN IT UP                @ZA06223   04586000
         ST    13,4(1)        FOREWARD AND BACK              @ZA06223   04587000
         LR    13,1           POINT TO MY SAVE AREA          @ZA06223   04588000
         L     3,0(0,2)       LOAD PDE ADDR                  @ZA06623   04589000
         TM    6(3),X'20'     SEE IF DSN FULLY QUALIFIED     @ZA06223   04590000
         BO    GOODDSN        YES - BYPASS ALL FURTHER TESTS @ZA06223   04591000
         LH    4,4(0,3)       NO-SEE IF TOO LONG             @ZA06223   04592000
         LA    5,35(0,0)      LOAD DSN LEN AND LIMIT         @ZA06223   04593000
         CR    4,5            SEE IF TOO LONG                @ZA06223   04594000
         BNH   GOODDSN        NO-GET OUT NORMALLY            @ZA06223   04595000
         L     1,4(0,2)       LOAD PTR TO IOPL               @ZA06223   04596000
         PUTLINE MF=(E,(1))   ISSUE ERROR MSG                @ZA06223   04597000
         LR    1,13           SAVE W/A PTR                   @ZA06223   04598000
         L     13,4(13)       LOAD CALLERS S/A PTR           @ZA06223   04599000
         FREEMAIN R,LV=72,A=(1) FREE MY S/A                  @ZA06223   04600000
         LM    14,12,12(13)   LOAD CALLERS REGS              @ZA06223   04601000
         LA    15,8(0,0)      SET RC = 8                     @ZA06223   04602000
         BR    14             RETURN TO PARSE                @ZA06223   04603000
GOODDSN  LR    1,13           SAVE MY S/A PTR                @ZA06223   04604000
         L     13,4(13)       LOAD CALLERS S/A PTR           @ZA06223   04605000
         FREEMAIN R,LV=72,A=(1) FREE MY S/A                  @ZA06223   04606000
         LM    14,12,12(13)   RELOAD CALLERS REGS            @ZA06223   04607000
         SLR   15,15          SET RC = ZERO                  @ZA06223   04608000
         BR    14             RETURN TO PARSE                @ZA06223   04609000
         DROP  12                                            @ZA06223   04610000
IKJEGIO  CSECT ,                                             @ZA06223   04611000
@DATD    DSECT                                                          04612000
         DS    0D  NULL LINE                                            04613000
IKJEGIO  CSECT                                                          04614000
IKJEGSPL IKJEGSPL RTRY=RETRY,ABNTB=IOABLST,MODNM=IKJEGIO,TNM=TEST-I/O   04615000
IOABLST  DS    0F            ABEND TABLE                                04616000
         DC    X'FF'         TABLE STOPPER                              04617000
MYDCB    DCB   MACRF=(PM),DSORG=PS,EXLST=LIST,SYNAD=A7SYNAD             04618000
LENDCB   EQU   *-MYDCB       LENGTH OF YMDCB                            04619000
CLFORM   CLOSE (CLFORM),MF=L  LIST FORM OF CLOSE                        04620000
LENCLF   EQU   *-CLFORM      LENGTH OF CLOSE MACRO                      04621000
LFORM    OPEN  (,(OUTPUT)),MF=L  LIST FORM OF OPEN                      04622000
LENOLF   EQU   *-LFORM       LENGTH OF OPEN MACRO                       04623000
************************************************************            04624000
**                                                        **            04625000
**                   PUTLINE LIST MACRO EXPANSIONS        **            04626000
**                                                        **            04627000
************************************************************            04628000
PUTDATA PUTLINE OUTPUT=(PUTOUT,TERM,SINGLE,DATA),MF=L                   04629000
PUTDATA1 EQU   *-PUTDATA     THIS INSTRUCTION OBTAINS THE LENGTH        04630000
PUTMSG   PUTLINE OUTPUT=(PUTOUT,TERM,SINGLE,INFOR),MF=L                 04631000
PUTMSG1  EQU   *-PUTMSG      THIS GETS THE LENGHT OF THE PARM FLD       04632000
PUTMSG2  PUTLINE OUTPUT=(PUTOUT,TERM,MULTLVL,INFOR),MF=L                04633000
PUTMSG3  EQU   *-PUTMSG2     OBTAIN LENGTH OF PARM LIST                 04634000
GETLINE  EQU   *                                                        04635000
SERVICE  EQU   *                                                        04636000
PUTGETIT PUTGET  OUTPUT=(PUTOUT,SINGLE,MODE),MF=L                       04637000
PUTGETSZ EQU   *-PUTGETIT                                               04638000
PUTGETML PUTGET OUTPUT=(PUTOUT,MULTLVL),MF=L                            04639000
PUTGETLN EQU   *-PUTGETML    FIND CORRECT LENGTH OF LIST                04640000
PUTSPACE PUTLINE OUTPUT=(PUTOUT,DATA),TERMPUT=(EDIT),MF=L               04641000
SPACESZ  EQU   *-PUTSPACE    SIZE OF LIST                               04642000
TCOMTAB  TCOMTAB                                                        04643000
         TSTCWORK                                                       04644000
         IKJTPL                                                         04645000
         IKJECT                                                         04646000
         IKJDAP08                                                       04647000
         IKJIOPL                                                        04648000
         IKJPTPB                                                        04649000
         IKJPGPB                                                        04650000
         IKJDFPL                                                        04651000
         IKJDFPB                                                        04652000
         IKJDAPL                                                        04653000
CVTDSECT DSECT                                                          04654000
         CVT                                                            04655000
         IKJTCB                                                         04656000
         DCBD  DSORG=PS                                                 04657000
DSNLEN   EQU   46                    LENGTH OF DATA SET NAME            04658000
PASSDCB  EQU   LENDCB+LENCLF+LENOLF  ADDRESS FOR DSNAME DSECT           04659000
TLEN     EQU   LENDCB+LENCLF+LENOLF+DSNLEN  LENGTH OF GETMAIN AREA      04660000
@DATD    DSECT                                                          04661000
@DATD    DSECT                                                          04662000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                04663000
@ENDDATD EQU   *                                                        04664000
IKJEGIO  CSECT                                                          04665000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       04666000
@01      EQU   01                                                       04667000
@02      EQU   02                                                       04668000
@03      EQU   03                                                       04669000
@04      EQU   04                                                       04670000
@05      EQU   05                                                       04671000
@06      EQU   06                                                       04672000
@07      EQU   07                                                       04673000
@08      EQU   08                                                       04674000
@09      EQU   09                                                       04675000
@10      EQU   10                                                       04676000
@11      EQU   11                                                       04677000
@12      EQU   12                                                       04678000
@13      EQU   13                                                       04679000
@14      EQU   14                                                       04680000
@15      EQU   15                                                       04681000
PRMREG1  EQU   @01                                                      04682000
PRMREG0  EQU   @00                                                      04683000
SIORETCD EQU   @15                                                      04684000
RTNCODE  EQU   @15                                                      04685000
DCBREG   EQU   @01                                                      04686000
IOPLREG  EQU   @01                                                      04687000
IOPBREG  EQU   @05                                                      04688000
OLD      EQU   @04                                                      04689000
TCOMPTR  EQU   @09                                                      04690000
MSGCSECT EQU   @02                                                      04691000
ESTAEADD EQU   @02                                                      04692000
RTNSAVE  EQU   @02                                                      04693000
DSECT10  EQU   @10                                                      04694000
PRMREG4  EQU   @04                                                      04695000
PDEREG   EQU   @00                                                      04696000
PDELEN   EQU   @00                                                      04697000
INSERTRG EQU   @01                                                      04698000
PRMREG5  EQU   @05                                                      04699000
DSECT4   EQU   @04                                                      04700000
DSECT11  EQU   @11                                                      04701000
PRMREG11 EQU   @11                                                      04702000
OPENREG  EQU   @11                                                      04703000
         EXTRN ATTACHIO                                                 04704000
TYP      EQU   0                                                        04705000
INTPLPTR EQU   0                                                        04706000
CONVROUT EQU   0                                                        04707000
CONDATA  EQU   0                                                        04708000
CONLEN   EQU   CONDATA                                                  04709000
CONTXT   EQU   CONDATA+1                                                04710000
PDECONVR EQU   0                                                        04711000
PPL      EQU   0                                                        04712000
PPLPCL   EQU   PPL+12                                                   04713000
PPLANS   EQU   PPL+16                                                   04714000
PPLCBUF  EQU   PPL+20                                                   04715000
PPLUWA   EQU   PPL+24                                                   04716000
PARMTAB  EQU   0                                                        04717000
MSG99PTR EQU   PARMTAB                                                  04718000
MSG199PT EQU   PARMTAB+4                                                04719000
SECONDPT EQU   PARMTAB+8                                                04720000
INSERTPT EQU   PARMTAB+12                                               04721000
SVCTBP   EQU   PARMTAB+16                                               04722000
SVCTBRCP EQU   PARMTAB+20                                               04723000
MSGPARMS EQU   0                                                        04724000
SIOTYPE  EQU   MSGPARMS                                                 04725000
SIOMODID EQU   MSGPARMS+1                                               04726000
SIOTYP11 EQU   MSGPARMS+2                                               04727000
SIONUMI1 EQU   MSGPARMS+12                                              04728000
SIO1STMS EQU   MSGPARMS+16                                              04729000
SIO11PTR EQU   MSGPARMS+20                                              04730000
SIO13PTR EQU   MSGPARMS+28                                              04731000
SIOTYP21 EQU   MSGPARMS+46                                              04732000
SIONUMI2 EQU   MSGPARMS+52                                              04733000
SIO2NDMS EQU   MSGPARMS+56                                              04734000
SIO21PTR EQU   MSGPARMS+60                                              04735000
SVCPRMS  EQU   0                                                        04736000
SIOABREG EQU   SVCPRMS+4                                                04737000
SIORCREG EQU   SVCPRMS+8                                                04738000
SIOSVCMG EQU   SVCPRMS+16                                               04739000
DATAPRMS EQU   0                                                        04740000
SIODATA  EQU   DATAPRMS+4                                               04741000
SIODSN   EQU   DATAPRMS+8                                               04742000
REDEFPL  EQU   0                                                        04743000
OLDPTR2  EQU   REDEFPL+8                                                04744000
ZEROOLD  EQU   REDEFPL+48                                               04745000
@NM00016 EQU   0                                                        04746000
AMTINDX  EQU   @NM00016                                                 04747000
INDXPTR  EQU   @NM00016+4                                               04748000
MG       EQU   0                                                        04749000
INDISP   EQU   MG                                                       04750000
LOCALMSG EQU   MG+6                                                     04751000
LENLOCAL EQU   LOCALMSG                                                 04752000
TEXTMSG  EQU   LOCALMSG+4                                               04753000
MSGINST  EQU   0                                                        04754000
INSTLEN  EQU   MSGINST                                                  04755000
INSTPDE  EQU   0                                                        04756000
VPDETXT  EQU   0                                                        04757000
ZEROTEST EQU   0                                                        04758000
SVCTB1   EQU   0                                                        04759000
AB2NDLV1 EQU   SVCTB1                                                   04760000
ABCDTB1  EQU   SVCTB1+4                                                 04761000
SVCNUM1  EQU   ABCDTB1                                                  04762000
ABTABPT1 EQU   ABCDTB1+4                                                04763000
SVCINST1 EQU   ABCDTB1+8                                                04764000
ABTAB1   EQU   0                                                        04765000
ABCODE1  EQU   ABTAB1                                                   04766000
RCTABPT1 EQU   ABTAB1+4                                                 04767000
ABCDINST EQU   ABTAB1+8                                                 04768000
RCTAB1   EQU   0                                                        04769000
SVC1STM1 EQU   RCTAB1                                                   04770000
RCSVC    EQU   RCTAB1+4                                                 04771000
SVCRC1   EQU   RCSVC                                                    04772000
RCINST1  EQU   RCSVC+4                                                  04773000
SVCTBRC2 EQU   0                                                        04774000
RC2NDLV2 EQU   SVCTBRC2                                                 04775000
SVCRCT2  EQU   SVCTBRC2+4                                               04776000
SVCNUM2  EQU   SVCRCT2                                                  04777000
SVCRCTB2 EQU   SVCRCT2+4                                                04778000
RCTAB2   EQU   0                                                        04779000
SVCRC2   EQU   RCTAB2                                                   04780000
SVC1STM2 EQU   RCTAB2+4                                                 04781000
SVCRCIN2 EQU   RCTAB2+8                                                 04782000
SKIPLINE EQU   0                                                        04783000
PUTGETDS EQU   0                                                        04784000
INBUFPTR EQU   PUTGETDS+12                                              04785000
PARSEMSG EQU   0                                                        04786000
FMTMSG   EQU   0                                                        04787000
FMTMSGLN EQU   FMTMSG                                                   04788000
LOGONOFF EQU   0                                                        04789000
ATTNHIT  EQU   0                                                        04790000
DSNAMPDE EQU   0                                                        04791000
STRNGPTR EQU   DSNAMPDE                                                 04792000
DSL      EQU   DSNAMPDE+4                                               04793000
FLAGRES1 EQU   DSNAMPDE+6                                               04794000
FLAGRES2 EQU   DSNAMPDE+14                                              04795000
PSWRDPTR EQU   DSNAMPDE+16                                              04796000
LENPSWRD EQU   DSNAMPDE+20                                              04797000
FLAGRES3 EQU   DSNAMPDE+22                                              04798000
TESTIOWK EQU   0                                                        04799000
DCB      EQU   TESTIOWK                                                 04800000
CLOSE    EQU   TESTIOWK+96                                              04801000
OPEN     EQU   TESTIOWK+100                                             04802000
CURDCBDN EQU   TESTIOWK+104                                             04803000
LENDSN   EQU   CURDCBDN                                                 04804000
NAME     EQU   CURDCBDN+2                                               04805000
DSN      EQU   0                                                        04806000
PASSWORD EQU   0                                                        04807000
DSNQUEU  EQU   0                                                        04808000
DSNCHAIN EQU   DSNQUEU                                                  04809000
LENGTHDN EQU   DSNQUEU+4                                                04810000
DN       EQU   DSNQUEU+6                                                04811000
ERRORMSG EQU   0                                                        04812000
PART1    EQU   ERRORMSG                                                 04813000
PART2    EQU   ERRORMSG+34                                              04814000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    04815000
LENMEMBR EQU   DSNAMPDE+12                                              04816000
PTRMEMBR EQU   DSNAMPDE+8                                               04817000
@NM00024 EQU   FMTMSG+4                                                 04818000
@NM00023 EQU   FMTMSG+2                                                 04819000
@NM00019 EQU   PUTGETDS                                                 04820000
@NM00018 EQU   MSGINST+2                                                04821000
@NM00017 EQU   LOCALMSG+2                                               04822000
SECONDPR EQU   REDEFPL+56                                               04823000
INSTNUM2 EQU   REDEFPL+52                                               04824000
@NM00015 EQU   REDEFPL+20                                               04825000
FIRSTPTR EQU   REDEFPL+16                                               04826000
INSTAMT1 EQU   REDEFPL+12                                               04827000
@NM00014 EQU   REDEFPL                                                  04828000
@NM00013 EQU   DATAPRMS                                                 04829000
SIOINPTR EQU   SVCPRMS+60                                               04830000
@NM00012 EQU   SVCPRMS+47                                               04831000
SIOINTYP EQU   SVCPRMS+46                                               04832000
@NM00011 EQU   SVCPRMS+20                                               04833000
@NM00010 EQU   SVCPRMS+12                                               04834000
@NM00009 EQU   SVCPRMS                                                  04835000
SIO26PTR EQU   MSGPARMS+80                                              04836000
SIO25PTR EQU   MSGPARMS+76                                              04837000
SIO24PTR EQU   MSGPARMS+72                                              04838000
SIO23PTR EQU   MSGPARMS+68                                              04839000
SIO22PTR EQU   MSGPARMS+64                                              04840000
SIOTYP26 EQU   MSGPARMS+51                                              04841000
SIOTYP25 EQU   MSGPARMS+50                                              04842000
SIOTYP24 EQU   MSGPARMS+49                                              04843000
SIOTYP23 EQU   MSGPARMS+48                                              04844000
SIOTYP22 EQU   MSGPARMS+47                                              04845000
@NM00008 EQU   MSGPARMS+44                                              04846000
SIO16PTR EQU   MSGPARMS+40                                              04847000
SIO15PTR EQU   MSGPARMS+36                                              04848000
SIO14PTR EQU   MSGPARMS+32                                              04849000
SIO12PTR EQU   MSGPARMS+24                                              04850000
SIOSCPTR EQU   MSGPARMS+8                                               04851000
SIOTYP16 EQU   MSGPARMS+7                                               04852000
SIOTYP15 EQU   MSGPARMS+6                                               04853000
SIOTYP14 EQU   MSGPARMS+5                                               04854000
SIOTYP13 EQU   MSGPARMS+4                                               04855000
SIOTYP12 EQU   MSGPARMS+3                                               04856000
PPLECB   EQU   PPL+8                                                    04857000
PPLECT   EQU   PPL+4                                                    04858000
PPLUPT   EQU   PPL                                                      04859000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      04860000
@RT00074 EQU   NOESTAE                                                  04861000
@RF00114 EQU   @RC00111                                                 04862000
@RT00146 EQU   EXITMSG                                                  04863000
@RT00173 EQU   EXITMSG                                                  04864000
@RT00191 EQU   EXITINST                                                 04865000
@RT00194 EQU   EXITINST                                                 04866000
@RT00333 EQU   EXITADDX                                                 04867000
@RT00364 EQU   EXITADDD                                                 04868000
@RT00399 EQU   EXITREG                                                  04869000
@RT00452 EQU   EXITABSH                                                 04870000
@RT00470 EQU   EXITABSH                                                 04871000
@PB00013 EQU   @PB00014                                                 04872000
@RT00592 EQU   EXITTERM                                                 04873000
@RF00607 EQU   @RC00594                                                 04874000
@RF00615 EQU   @RC00610                                                 04875000
@RC00619 EQU   @RC00618                                                 04876000
@RF00660 EQU   @RC00618                                                 04877000
@RT00675 EQU   EXITTERM                                                 04878000
@RT00680 EQU   EXITTERM                                                 04879000
@RC00693 EQU   @RC00690                                                 04880000
@RC00691 EQU   @RC00690                                                 04881000
@RC00701 EQU   @RC00696                                                 04882000
@RC00699 EQU   @RC00696                                                 04883000
@RC00697 EQU   @RC00696                                                 04884000
@RF00807 EQU   EXITDS                                                   04885000
@RT00867 EQU   EXITDS                                                   04886000
@RT00884 EQU   EXITDS                                                   04887000
@RT00895 EQU   EXITDS                                                   04888000
@RT00995 EQU   EXITRCDR                                                 04889000
@RT01014 EQU   EXITSYND                                                 04890000
@RF01030 EQU   EXITBADD                                                 04891000
@RF01060 EQU   EXITCKDN                                                 04892000
@RT01078 EQU   NEWDSN                                                   04893000
@RF01087 EQU   EXITCKDN                                                 04894000
@RT01099 EQU   EXITCKDN                                                 04895000
@RT01130 EQU   EXITOPEN                                                 04896000
@RT01146 EQU   EXITPUT                                                  04897000
@RF01169 EQU   @EL00029                                                 04898000
EXITEXIT EQU   @EL00029                                                 04899000
@RF00431 EQU   @PB00013                                                 04900000
@RF00626 EQU   @RC00619                                                 04901000
@RF00633 EQU   @RC00619                                                 04902000
@RF00641 EQU   @RC00619                                                 04903000
@ENDDATA EQU   *                                                        04904000
         END   IKJEGIO,(C'PLS0741',0701,78174)                          04905000
./  ADD  SSI=40310051,NAME=IKJEGLDF
         TITLE 'IKJEGLDF, LOAD, DELETE, FREEMAIN, AND GETMAIN SUBCMNDS' 00050002
         COPY  IKJEGSIO                                                 00052002
IKJEGLDF CSECT                                                          00060002
*C127000,C151500,A151600                                        YA00064 00070002
*C529000                                                       @YM07111 00080002
*********************************************************************** 00100002
*                                                                     * 00150002
* STATUS --                                                           * 00200002
*    CHANGE LEVEL 000, VERSION 02, OS/VS2                             * 00250002
*                                                                     * 00260002
* FUNCTION --                                                         * 00300002
*                                                                     * 00350002
*    LOAD SUBCOMMAND RESULTS IN AN ATTEMPT TO LOAD THE SPECIFIED      * 00400002
*    PROGRAM AS IF A LOAD MACRO WERE ISSUED BY THE PROBLEM PROGRAM.   * 00450002
*                                                                     * 00500002
*    DELETE SUBCOMMAND RESULTS IN THE ISSUING OF THE DELETE MACRO     * 00550002
*    IN BEHALF OF THE PROBLEM PROGRAM UNDER TEST.                     * 00600002
*                                                                     * 00650002
*    GETMAIN SUBCOMMAND RESULTS IN AN ATTEMPT TO ACQUIRE THE          * 00700002
*    SPECIFIED NUMBER OF BYTES FROM A USER SPECIFIED SUBPOOL. THE     * 00750002
*    MACRO IS ISSUED UNDER THE PROBLEM PROGRAM TASK                   * 00800002
*                                                                     * 00850002
*    FREEMAIN SUBCOMMAND RESULTS IN AN ATTEMPT TO FREE THE SPECIFIED  * 00900002
*    NUMBER OF BYTES FROM THE SPECIFIED SUBPOOL. THE MACRO IS ISSUED  * 00950002
*    UNDER THE PROBLEM PROGRAM TASK.                                  * 01000002
*                                                                     * 01050002
* ENTRY POINTS --                                                     * 01100002
*         IKJEGLOD IS THE ENTRY POINT FOR LOAD                        * 01150002
*         IKJEGDEL IS THE ENTRY POINT FOR DELETE                      * 01200002
*         IKJEGGET IS THE ENTRY POINT FOR GETMAIN                     * 01250002
*         IKJEGFRE IS THE ENTRY POINT FOR FREEMAIN                    * 01300002
*                                                                     * 01350002
* INPUT -- A POINTER TO TCOMTAB, THE COMMUNICATION TABLE, IS EXPECTED * 01400002
*    IN REGISTER 9  ALL INFORMATION NEEDED CAN BE ACCESSED IN TCOMTAB.* 01450002
*                                                                     * 01500002
* OUTPUT -- A LOAD SUBCOMMAND WILL RESULT IN THE LOADED AT ADDRESS    * 01550002
*    BEING PRINTED TO THE TERMINAL. A GETMAIN WILL RESULT IN THE      * 01600002
*    GETMAIN AREA ADDRESS BEING PRINTED. NEITHER DELETE NOR FREEMAIN  * 01650002
*    PRINT OTHER THAN DIAGNOSTIC MESSAGES.                            * 01700002
*                                                                     * 01750002
* EXTERNAL REFERENCES --                                              * 01800002
*         IKJEGPARS IS ENTERED TO SCAN THE SUBCOMMAND STRING AND      * 01850002
*         CHECK SYNTAX                                                * 01900002
*                                                                     * 01950002
*         IKJEGIO IS ENTERED TO PRINT MESSAGES TO THE TERMINAL        * 02000002
*                                                                     * 02050002
*         IKJEGCVT IS ENTERED IN FREEMAIN VALIDITY CHECK TO CONVERT   * 02100002
*         THE ADDRESS OF THE AREA TO BE FREED.                        * 02150002
*                                                                     * 02200002
* EXITS, NORMAL -- SINCE LOAD, DELETE, GETMAIN AND FREEMAIN ARE       * 02250002
*         ISSUED UNDER THE PROBLEM PROGRAM TCB, RETURN IS             * 02300002
*         ACCOMPLISHED VIA THE ADDRESS IN TSTGO IN TCOMTAB INSTEAD    * 02350002
*         OF THE NORMAL BR R14                                        * 02400002
*                                                                     * 02450002
* EXITS, ERROR -- NONE                                                * 02500002
*                                                                     * 02550002
* TABLES/WORK AREAS --                                                * 02600002
*    A GETMAIN AREA IS USED FOR THE DCB ASSOCIATED WITH THE DATASET   * 02650002
*    SPECIFIED IN THE LOAD SUBCOMMAND.                                * 02700002
*    THE WORKAREA POINTED TO IN TCOMTAB IS USED FOR ALL TEMPORARY     * 02750002
*    STORAGE                                                          * 02800002
*                                                                     * 02850002
* ATTRIBUTES --                                                       * 02900002
*    REFRESHABLE AND REENTRANT                                        * 02950002
*                                                                     * 03000002
* CHARACTER CODE DEPENDENCY --                                        * 03050002
*    REASSEMBLY MAY BE NEEDED FOR CHANGE OF CODE                      * 03100002
* NOTES --                                                            * 03150002
*    R12 IS BASE REG                                                  * 03200002
*    PLM = SY35-0004                                                  * 03210002
*    *     TSO COMMAND PROCESSOR LOGIC                                * 03220002
*    *     VOLUME III - TEST                                          * 03230002
*********************************************************************** 03250002
         ENTRY IKJEGLOD                                                 03350002
         ENTRY IKJEGDEL                                                 03400002
         ENTRY IKJEGGET                                                 03450002
         ENTRY IKJEGFRE                                                 03500002
         USING TCOMTAB,R9     USE REG9 TO ADDRESS TCOMTAB DSECT         03550002
BASELOC  EQU   *             EQUATE LABEL TO THIS ADDRESS               03600002
IKJEGFRE EQU   *             EQUATE ENTRY POINT TO THIS ADDRESS         03650002
FREEMAIN EQU   *             EQUATE FREEMAIN ENTRY TO THIS ADDR         03700002
LOADLOAD SAVE  (14,12),,*    SAVE REGISTERS                             03750002
         USING FREEMAIN,R15  USE REG15 AS BASE STARTING AT FREEMN       03800002
         L     R12,BASE      PLACE START ADDRESS OF PROG IN R12         03850002
         DROP  R15           REMOVE REG15 AS BASE REG                   03900002
         USING BASELOC,R12   USE REG12 AS BASE REG                      03950002
         B     FREEALL       BRANCH TO ROUTINE TO FREEMAIN              04000002
IKJEGDEL EQU   *             EQUATE ENTRY POINT TO THIS ADDRESS         04050002
DELETE   EQU   *             EQUATE DELETE ENTRY PTR TO THIS ADDR       04100002
         SAVE  (14,12)       SAVE REGISTERS                             04150002
         USING DELETE,R15    USE REG15 AS BASE FROM DELETE              04200002
         L     R12,BASE      PLACE START ADDRESS OF PROG IN R12         04250002
         DROP  R15           REMOVE REG15 AS BASE REG                   04300002
         USING BASELOC,R12   USE REG12 AS BASE REG                      04350002
         B     DELETEIT      BRANCH TO ROUTINE TO DELETE PROG           04400002
IKJEGGET EQU   *             EQUATE ENTRY POINT TO THIS ADDRESS         04450002
GETMAIN  EQU   *             EQUATE GETMAIN ENTRY PTR TO THS ADDR       04500002
         SAVE  (14,12)       SAVE REGISTERS                             04550002
         USING GETMAIN,R15   USE REG15 AS BASE START AT GETMAIN         04600002
         L     R12,BASE      PLACE START ADDRESS OF PROG IN R12         04650002
         DROP  R15           REMOVE REG15 AS BASE REG                   04700002
         USING BASELOC,R12   USE REG12 AS BASE REG                      04750002
         B     GETIT         BRANCH TO ROUTINE TO GETMAIN               04800002
IKJEGLOD EQU    *            EQUATE ENTRY POINT TO THIS ADDRESS         04850002
LOAD     EQU   *             EQUATE LOAD ENTRY PTR TO THIS ADDR         04900002
         SAVE  (14,12)       SAVE REGISTERS                             04950002
         USING LOAD,R15      USE REG15 AS BASE WITH LOAD AS START       05000002
         L     R12,BASE      PLACE ADDRESS AT BASE                      05050002
         DROP  R15           DROP REG 15 AS BASE                        05100002
         USING BASELOC,R12   USE REG12 AS BASE START AT BASELOC         05150002
         EJECT                                                          05200002
************************************************************            05250002
** THIS  CODE  WILL LOAD A SPECIFIED PROGRAM INTO CORE    **            05300002
** UNDER PROBLEM PROGRAM TCB. INITIALLY WE SAVE REGISTERS,**            05350002
** ESTABLISH FORWARD AND BACKWARD CHAINING OF REGISTERS & **            05400002
** ESTABLISH A BASE REGISTER FOR PROGRAM ADDRESSABILITY.  **            05450002
************************************************************            05500002
LOADIT   L     R4,REGSAVE2   GET ADDRESS OF MY SAVEAREA FROM TCOM       05550002
         ST    R4,@8(R13)    PLACE MY SAVE AREA INTO CALLER SAVEAREA    05600002
         ST    R13,@4(R4)    PLACE USER SAVE AREA INTO MY SAVE          05650002
         LR    R13,R4        PLACE MY SAVEAREA ADDR INTO R13            05700002
         LA    R10,STAELOAD  ACCESS ADDR OF STAE EXIT TAB               05750002
         L     R5,LOADPARS   PLACE ADDRESS OF PCL INTO REG 5            05800002
         LA    R11,I0023     LOAD-INSERT FOR POSS ERR MSG               05850002
         LA    R6,SPLISTLD   REG 6= ESTAE PARAMETER LIST                05860002
         BAL   R14,STAEPREP  TO EXPAND STAE MACRO + CALL PARSE          05900002
*                            NOTE: LOAD VALIDITY CHECK ROUTINE,         05950002
*                            'LOADVLCK', WILL GET CONTROL FROM PARSE.   06000002
         L     R10,TSTANSPL  PLACE ADDRESS OF PDE FROM PARSE IN R10     06050002
         USING D,R10         ESTABLISH PDL ADDRESSABILITY               06100002
         LA    R10,PARSE2    ACCESS PDE ADDRESS                         06150002
         DROP  R10           DROP PDL ADDRESSABILITY                    06200002
         USING PARDSECT,R10  ESTABLISH PDE ADDRESSABILITY               06250002
************************************************************            06300002
** A PARAMETER LIST WILL BE CONSTRUCTED FOR DAIR. DAIR    **            06350002
** WILL RETURN A DDNAME FOR THE PARTITIONED DATA SET THAT **            06400002
** CONTAINS THE PROGRAM WE ARE LOOKING FOR                              06450002
************************************************************            06500002
         MVC   @4(LISTSIZE,R2),GETLIST FUTURE DCB EXPANSION AREA        06550002
         LA    R1,@4(R2)     ADDR OF LIST FORM INTO R1                  06600002
         GETMAIN EC,LV=100,SP=1,A=(R2),MF=(E,(R1))  GET CORE FOR DCB    06650002
         LTR   R15,R15       TEST RETURN CODE                           06700002
SMTGET01 DS    0H            TEST CASE TTTA7600                         06750002
         BZ    A10100        BRANCH OF RET CODE = O                     06800002
         LA    R4,TEN        REG 4 IMPLIES SVC 10 FAILED                06810002
         B     GETERR        OUTPUT ERROR MESSAGE                       06850002
A10100   EQU   *                                                        06950002
         L     R7,0(R2)      ACCESS ADDR OF GETMAIN AREA                07000002
         MVC   @0(@4,R7),TSTDCB ESTABLISH CHAIN ADDRESS                 07050002
         ST    R7,TSTDCB     ESTABLISH NEW CHAIN PTR                    07100002
         LA    R7,@4(R7)     INCREMENT PTR TO GETMAIN AREA              07150002
         L     R2,WORKAREA   ACCESS WORKAREA POINTER                    07200002
         LA    R3,DSNMEPTR-TSTCWORK(R2) INITIALIZE BUFFER               07250002
         MVI   @2(R3),BLANK  INITIALIZE BUFFER                          07300002
         MVC   @3(@43,R3),@2(R3) INITIALIZE BUFFER                      07350002
         L     R6,DSNAMPTR   ACCESS PTR TO DSNAME                       07400002
         LH    R5,LENGTH1    ACCESS LENGTH OF DSNAME                    07450002
         STH   R5,@0(R3)     STORE LENGTH OF DSNAME                     07500002
         BCTR  R5,R0         DECREMENT FOR EXECUTE                      07550002
         EX    R5,MOVEDSN    MOVE DSNAME                                07600002
         TM    FLAGS1,FULLQUAL Q.FULLY QUALIFIED DSNAME                 07650002
         BO    TODAIR        A. IF SO, GO TO DAIR                       07700002
         USING DFPL,R2       ESTABLISH ADDRESSABILITY                   07750002
         USING DFPB,R7       ESTABLISH ADDRESSABILITY                   07800002
         MVC   DFPLUPT(@4),TSTUPT  *****                                07850002
         MVC   DFPLECT(@4),TSTECT      *                                07900002
         MVC   DFPLECB(@4),TSTCPECB    *                                07950002
         ST    R7,DFPLDFPB             * INITIALIZE                     08000002
         ST    R3,DFPBDSN              *                                08050002
         L     R4,TPLPTR               *   DEFAULT                      08100002
         USING TPL,R4                  *                                08150002
         MVC   DFPBPSCB(@4),TPLPSCB    * PARM BLOCK                     08200002
         LA    R4,LOADQUAL             *                                08250002
         ST    R4,DFPBQUAL             *                                08300002
         MVI   DFPBCODE,DFPB00         *                                08350002
         MVI   DFPBCNTL,DFPBUID        *                                08400002
         LR    R1,R2                   *                                08450002
         LA    R5,@6         SVC = 6 FOR LINKFAIL                       08452002
         LA    R4,I0046      DFLT INSERT FOR POSS ERR MSG               08460002
         LINK  EP=IKJDFLT,ERRET=LINKFAIL          *****                 08500002
BLOW10   EQU   *             RESUME ADDRESS FOR STAE                    08550002
SMTDFLT  DS    0H            TEST CASE TTTA7600                         08600002
         LA    R14,@24       FOR FUTURE COMPARISON                      08650002
         CR    R14,R15       TEST ATTN                                  08700002
         LA    R15,@16       NEEDED IF ATTN WAS DETECTED                08750002
         BE    RET           RETURN TO MAINLINE                         08800002
         DROP  R2            DROP DFPL ADDRESSABILITY                   08850002
TODAIR   EQU   *             TO SET UP FOR DAIR                         08900002
         LA    R1,DAIR-TSTCWORK(R2) ACCESS COMMAND PORTION              08950002
         USING DAPL,R1       ADDRESSABILITY FOR DAIR PARM BLOCK         09000002
         MVC   DAPLUPT(@4),TSTUPT UPT PTR FOR DAIR                      09050002
         MVC   DAPLECT(@4),TSTECT ECT PTR FOR DAIR                      09100002
         MVC   DAPLECB(@4),TSTCPECB PTR TO CP ECB FOR DAIR              09150002
         L     R4,TPLPTR     PLACE POINTER TO TMP INTO R4               09200002
         USING TPL,R4        USE REG4 TO ADDRESS TMP DSECT              09250002
         L     R3,TPLPSCB    GET PTR TO PROTECTED STEP CONTROL BLK      09300002
         ST    R3,DAPLPSCB    PUT PTR INTO PSCB FIELD OF DAIR           09350002
*                            PARAMETER LIST                             09400002
         ST    R7,DAPLDAPB   PLACE POINTER TO DAIR PDE INTO PARM        09450002
         XC    @0(@76,R7),@0(R7) INITIALIZE FUTURE DAIR PARM BLOCK      09500002
         USING DAPB08,R7     ESTABLISH DAIR PARM BLOCK ADDRESSABILITY   09550002
         MVI   DA08DDN,BLANK MOVE BLANK INTO DDNAME FIELD               09600002
         MVC   DA08DDN+@1(@7),DA08DDN BLANK OUT DDNAME FIELD            09650002
         MVI   DA08UNIT,BLANK     BLANK CHAR INTO UNIT FIELD            09700002
         MVC   DA08UNIT+@1(@7),DA08UNIT BLANK OUT UNIT FIELD            09750002
         MVI   DA08SER,BLANK MOVE BLANK INTO SERIAL FIELD               09800002
         MVC   DA08SER+@1(@7),DA08SER BLANK OUT SERIAL FIELD            09850002
         MVI   DA08MNM,BLANK MOMOVE BLANK INTO MEMBER NAME FIELD        09900002
         MVC   DA08MNM+@1(@7),DA08MNM BLANK OUT MEMBER NAME FIELD       09950002
         MVC   DA08PSWD(@8),PASSWORD-TSTCWORK(R2) ACCESS PASSWORD       10000002
         OI    DA08DSP1,DA08SHR INDICATE DISP = SHR                     10050002
         MVI   DA08CD+@1,HEX08 CODE TO DAIR                             10100002
         DROP  R1            DROP DAIR PARM BLOCK ADDRESSABILITY        10150002
         LA    R3,DSNMEPTR-TSTCWORK(R2) ACCESS PTR TO DSNAME            10200002
         ST    R3,DA08PDSN   STORE DSN POINTER IN DAIR PARM BLOCK       10250002
         LA    R5,@6         SVC = 6 FOR LINKFAIL                       10252002
         LA    R4,I0041      DAIR INSERT FOR POSS ERR MSG               10260002
         LINK  EP=IKJDAIR,ERRET=LINKFAIL  LINK TO DAIR                  10310002
BLOW2    EQU   *             RESUME ADDR FOR STAE                       10350002
SMTDAIR1 DS    0H            TEST CASE TTTA7600                         10400002
         LTR   R0,R15        LOAD R0 WITH RETURN CODE AND TEST          10450002
         BZ    A10200        IFDAIR IS SUCCESSFUL THEN BRANCH           10500002
         BAL   R14,DAIRFL    TO DAIRFAIL ROUTINE                        10500402
         BAL   R14,FREEDCB   TO FREE GETMAIN AREA                       10500802
         B     A18000        BRANCH TO RETURN                           10501202
DAIRFL   EQU   *             DAIR FAIL ROUTINE                          10501602
         LR    R6,R14        SAVE RETURN ADDRESS                        10501702
         L     R2,WORKAREA   ACCESS WORKAREA PTR                        10502002
         LA    R11,PARMDRFL-TSTCWORK(R2) ACCESS DAIRFAIL PARAM LIST     10504002
         XC    @0(@20,R11),@0(R11) ZERO PARAMETER FIELD                 10506002
         ST    R15,TMPRETC-TSTCWORK(R2) STORE RET CODE IN WORK AREA     10508002
         LA    R1,TMPRETC-TSTCWORK(R2) R1=ADDR OF RET CODE              10508402
         ST    R1,@4(R11)    2ND WORD OF PARAM LIST                     10508802
         LA    R1,ONE        SET UP CALLER ID                           10509202
         STH   R1,TMPCIDP-TSTCWORK(R2) STORE IN WORK AREA               10509602
         LA    R1,TMPCIDP-TSTCWORK(R2) R1=ADDR OF CALLER ID             10509702
         ST    R1,@12(R11)   4TH WORD OF PARAM LIST                     10509802
         LA    R1,DAIR-TSTCWORK(R2) GET DAPL POINTER                    10509902
         ST    R1,@0(R11)    1ST WORD OF PARAM LIST                     10523202
         LA    R1,ZERO       SET UP MSG WRITER ENTRY                    10525202
         ST    R1,MIDHOLD-TSTCWORK(R2) STORE IN WORK AREA               10527202
         LA    R1,MIDHOLD-TSTCWORK(R2) R1=ADDR MSG WRTR ENTRY           10529202
         ST    R1,@8(R11)    3RD WORD OF PARAMETER LIST                 10531202
         LR    R1,R11        POINT TO PARAMETER LIST                    10531602
         LA    R5,@6         SVC = 6 FOR LINKFAIL                       10533602
         LA    R4,I0042      IKJEFF18-INSERT                            10535202
         LINK  EP=IKJEFF18,ERRET=LINKFAIL LINK TO DAIRFAIL              10535602
         BR    R6            RETURN TO CALLER                           10585602
* FREE DCB AREA                                                         10800002
FREEDCB  EQU   *             FREEMAIN DCB AREA                          10850002
         LR    R3,R14        SAVE RETURN ADDRESS                        10900002
         L     R2,TSTDCB     ACCESS GETMAIN AREA ADDRESS                10950002
         L     R7,@0(R2)     ACCESS PREVIOUS CHAIN ADDRESS              11000002
         ST    R7,TSTDCB     RESTORE PREVIOUS CHAIN ADDRESS TO TSTDCB   11050002
         FREEMAIN  RC,LV=100,A=(R2),SP=1                                11100002
         LTR   R15,R15       TEST RETURN CODE                           11110002
         BZ    FREDCB1       ZERO-ALL OK                                11120002
         LA    R4,@120       IMPLIES SVC 120 FAILED                     11122002
         B     GETERR        OUTPUT ERROR MESSAGE                       11130002
FREDCB1  BR    R3            RETURN TO CALLER                           11140002
UNALLOC  EQU   *             TO CLOSE DCB AND UNALLOCATE DSNAME         11200002
         L     R7,TSTDCB     ACCESS DCB CHAIN ADDRESS                   11250002
         LA    R7,@4(R7)     ACCESS PTR TO DCB                          11300002
         LA    R6,@92(R7)    ADDR OF LIST FORM OF CLOSE                 11350002
         LR    R3,R14        SAVE RETURN ADDR                           11400002
         CLOSE ((R7)),MF=(E,(6))  CLOSE DCB                             11450002
         L     R2,WORKAREA   ACCESS WORKAREA ADDRESS                    11500002
         LA    R2,CWORKCMD-TSTCWORK(R2) ACCESS COMMAND PORTION          11550002
         USING DAPB2C,R2      ESTABLISH ADDRESSABILITY FOR DAIR PARM    11600002
         MVC   DA2CCD(@2),DAIR2C INSERT DAIR CODE INTO BLOCK            11650002
         MVC   DA2CFLG(@2),FLG2C SET FLAG                               11700002
         XC    DA2CTCB(@4),DA2CTCB ZERO TCB ADDRESS PORTION             11750002
         L     R14,WORKAREA   ACCESS WORKAREA POINTER                   11800002
         MVC   DA2CDDN(@8),DDNSAVE-TSTCWORK(R14) ACCESS DDNAME          11850002
         LA    R1,DAIR-TSTCWORK(R14) WORKAREA FOR DAPL                  11900002
         USING DAPL,R1       ADDRESSABILITY FOR DAIR PARM BLOCK         11950002
         ST    R2,DAPLDAPB   PTR TO DAPB18                              12000002
         MVC   DAPLUPT(@4),TSTUPT UPT PTR FOR DAIR                      12050002
         MVC   DAPLECT(@4),TSTECT ECT PTR FOR DAIR                      12100002
         MVC   DAPLECB(@4),TSTCPECB PTR OT CPECB FOR DAIR               12150002
         L     R5,TPLPTR     PLACE PTR TO TMP INTO R5                   12200002
         USING TPL,R5        ADDRESSABILITY TO TMP DSECT                12250002
         L     R14,TPLPSCB   GET PTR TO PROTECTED STEP CONTROL BLOCK    12300002
         ST    R14,DAPLPSCB  PUT PTR INTO PSCB FIELD OF DAIR PARM       12350002
         DROP  R5            DROP TMP ADDRESSABILITY                    12400002
         DROP  R1            DROP DAIR PARM ADDRESSABILITY              12450002
         LA    R5,@6         SVC = 6 FOR LINKFAIL                       12452002
         LA    R4,I0041      DAIR INSERT FOR POSS ERR MSG               12460002
         LINK  EP=IKJDAIR,ERRET=LINKFAIL    UNALLOCATE DATA SET         12500002
BLOW9    EQU   *             STAE RESUME ADDRESS                        12550002
SMTDAIR2 DS    0H            TEST CASE TTTA7600                         12600002
         LTR   R15,R15       TEST RETURN CODE                           12602002
         BZ    NODRFL        BRANCH AROUND DAIRFAIL                     12604002
         BAL   R14,DAIRFL    TO DAIRFAIL ROUTINE                        12604402
         L     R2,WORKAREA   ACCESS WORKAREA                            12614402
         CLI   TASKSWF-TSTCWORK(R2),HEXFF  HAS TASK SW. OCCURRED        12624402
         BE    STAEOFF       YES, GO TO REMOVE ESTAE AND RETURN         12634402
         B     A18000        BRANCH TO RETURN                           12636502
NODRFL   EQU   *             COME HERE IF DAIR WAS OK                   12636602
         LR    R14,R3        RESTORE RETURN ADDRESS                     12650002
         BR    R14           RETURN TO CALLER                   YA00064 12700002
         DROP  R2            DROP DAPB18 ADDRESSABILITY                 12750002
A10200   EQU   *             EQUATE LABEL TO THIS ADDRESS               12800002
         L     R2,WORKAREA   ACCESS PTR TO WORKAREA                     12850002
         LA    R2,DDNSAVE-TSTCWORK(R2) CREATE PTR TO DDNAME SAVE AREA   12900002
         LA    R6,DA08DDN    OBTAIN ADDRESS OF DDNAME FROM              12950002
         MVC    @0(@8,R2),@0(R6) MOVE DDNAME TO HOLD AREA               13000002
         LR    R1,R7         RESTORE STARTING ADDRESS OF DCB            13050002
         USING DSNDSECT,R4   USE REG4 TO ADDRESS DSECT                  13100002
         MVC   @0(@88,R1),MYDCB MOVE DCB INTO GOTTEN CORE               13150002
         USING IHADCB,R1     USE DCB DSECT TO LOCATE LABELS             13200002
         MVC   DCBDDNAM,@0(R2) MOVE DDNAME INTO DCB                     13250002
         MVC   @88(@4,R1),LFORM MOVE IN OPEN ROUTINE INTO DCB           13300002
         MVC   @92(@4,R1),CLFORM MOVE CLOSE LIST FORM TO NEW CORE       13350002
         LA    R6,@88(@0,R1) PLACE ADDR OF ELIST                        13400002
         LR    R0,R1         PLACE POINTER TO DCB INTO R0               13450002
         OPEN  ((0)),MF=(E,(6)) OPEN DATA SET FOR BLDL MACRO            13500002
BLOW3    EQU   *             RESUME ADDR FOR STAE                       13550002
SMTOPEN  DS    0H            TEST CASE TTTA7600                         13600002
         USING IHADCB,R7     USE REG7 TO ADDRESS DCB                    13650002
         TM    DCBOFLGS,HEX10 TEST IF OPEN WAS SUCCESSFUL               13700002
         BO    A13190        IF OPEN WAS SUCCESSFUL THEN BRANCH         13750002
         LA    R2,M0045      MSG-UNABLE TO LOAD PGM                     13800002
         LA    R3,M0249      MSG-OPEN ERROR                             13810002
         BAL   R6,MSG1       GO OUTPUT MESSAGES                         13820002
         B     A18000        BRANCH TO PUT MSG OUT TO TERM              13850002
************************************************************            13900002
*  THE DCB HAS BEEN CREATED AND OPENED.                     *           13950002
*  THE BLDL MACRO WILL BE ISSUED                            *           14000002
*************************************************************           14050002
A13190   EQU   *             EQUATE LABEL TO THIS ADDRESS               14100002
         LH    R5,LENGTH2    GET LENGTH OF MEMBER NAME                  14150002
         L     R6,MEMBERPT   PLACE POINTER TO MEMBER NAME IN R6         14200002
         L     R2,WORKAREA   ACCESS WORKAREA PTR                        14250002
         LA    R11,CWORKCMD-TSTCWORK(R2)  FUTURE BLDL AREA              14300002
         MVC   @0(@4,R11),LSTDSCP PLACE LIST DESCRIPTOR INTO LIST       14350002
**************************************************************          14400002
**LIST DESCRIPTOR FIELD CONSIST OF 2 HALFWORDS.THE FIRST TWO**          14450002
**BYTES IS THE NUMBER OF ENTRIES,THE NEXT 2 BYTES IS THE    **          14500002
**LENGTH OF EACH ENTRY                                      **          14550002
**************************************************************          14600002
         MVI   @4(R11),HEX40 MOVE A BLANK INTO NAME FIELD               14650002
         MVC   @5(@7,R11),@4(R11) SPREAD THRU OUT ENTIRE AREA           14700002
         BCTR  R5,R0         PREPARE FOR EX INSTRUCTION                 14750002
         EX    R5,MEMMOVE    MOVE MEMBER NAME TO LIST                   14800002
         LR    R5,R11        PLACE ADDR OF LIST INTO REG5               14850002
         BLDL  (7),(5)       ISSUE BLDL MACRO TO COMPLETE LIST          14900002
         LTR   R15,R15       CHECK TO SEE IF BLDL FOUND MEMBER          14950002
SMTBLDL  DS    0H            TEST CASE                                  15000002
         BZ    A12020        IF BLDL SUCCESSFUL THEN BRANCH             15050002
         LR    R4,R15        SAVE RETURN CODE                           15100002
         BAL   R14,UNALLOC   GO CLOSE AND UNALLOC DATASET       YA00064 15150002
         BAL   R14,FREEDCB   GO FREE GETMAIN DCB AREA           YA00064 15160002
         LA    R2,M0045      MSG-UNABLE TO LOAD PGM                     15170002
         LA    R3,M0250      MSG-BLDL ERROR CODE 4                      15180002
         LA    R14,@4        PUT 4 IN REGISTER                          15190002
         CR    R14,R4        IS RET CODE = 4                            15192002
         BNE   BLDL8         NO, NEED ERR CODE 8 MSG                    15194002
         BAL   R6,MSG1       GO OUTPUT MESSAGES                         15196002
         B     A18000        RETURN TO MAINLINE                         15198002
BLDL8    LA    R3,M0297      MSG-BLDL ERROR CODE 8                      15198402
         BAL   R6,MSG1       GO OUTPUT MESSAGES                         15198802
         B     A18000        RETURN TO MAINLINE                         15199202
************************************************************            16000002
**IF WE'VE MADE IT THIS FAR WE ARE READY TO LOAD THE      **            16050002
**ASKED FOR PROGRAM INTO CORE.TO DO THIS WE WILL USE THE  **            16100002
**LOAD MACRO                                              **            16150002
************************************************************            16200002
A12020   EQU   *             EQUATE LABEL TO THIS ADDRESS               16250002
         TM    @26(R5),HEX20 TEST OVERLAY BIT                           16300002
         BZ    OVLY          BRANCH IF OVERLAY BIT OFF                  16350002
         OI    TSTDCB,HEX80  INDICATE  OVERLAY IN TCOMTAB               16400002
OVLY     EQU   *                                                        16450002
         LA    R10,I0023     LOAD-INSERT FOR POSS ERR MSG               16460002
         L     R2,WORKAREA   PTR TO WORKAREA                            16510002
         ST    R10,MIDHOLD-TSTCWORK(R2) STORE LOAD INSERT               16520002
         BAL   R14,TASKSW    SWITCH TO PPTCB FROM TEST TCB              16550002
**********************************************************************  16600002
** WHEN WE RETURN TO THIS POINT WE ARE NOW FUNCTIONING AS           **  16650002
** PART OF THE PROBLEM PROGRAM AND NOT AS PART OF TEST.             **  16700002
**********************************************************************  16750002
CONTLOAD BAL   R14,PPSTAE          SETUP FOR STAE UNDER PRB PROG        16800002
         LA    R5,@4(R0,R5)  LOAD LIBRARY ADDR OF PROGRAM               17000002
         LOAD  DE=(5),DCB=(7),ERRET=LOADFAIL BRING IN REQSTED PROGRAM   17050002
BLOW4    EQU   *             RESUME ADDR FOR STAE                       17100002
SMTLOAD1 DS    0H            TEST CASE                                  17150002
************************************************************            17200002
** THE REQUESTED PROGRAM HAS BEEN LOADED IN. THE ENTRY    **            17250002
** POINT OF THE PROGRAM,RETURNED IN REG0,MUST BE SAVED TO **            17300002
** BE PASSED ON TO THE  PROBLEM PROGRAM                   **            17350002
************************************************************            17400002
*                            INTO REG1                                  17450002
         LA    R2,M0049      MSG-ENTRY POINT AT ...                     17460002
         LR    R4,R0         LOAD EPA IN REG 4                          17470002
         BAL   R6,MSG5       GO OUTPUT MESSAGE                          17480002
         B     STAEOFF       REMOVE STAE REQUEST AND RETURN             18250002
         USING DSNDSECT,R2   USE REG2 TO ADDRESS DSECT                  18300002
         EJECT                                                          18350002
************************************************************            18400002
**THIS IS THE ENTRY POINT FOR THE DELETE FUNCTION OF      **            18450002
**LDF. THIS SUB-COMMAND RESULTS IN A MODULE  BEING        **            18500002
**REMOVED FROM CORE                                       **            18550002
************************************************************            18600002
DELETEIT EQU   *             EQUATE DELETE ENTRY PTR TO THIS ADDR       18650002
         L     R4,REGSAVE2   PLACE ADDR OF MY SAVE AREA INTO R4         18700002
         ST    R13,@4(R4)    STORE USER SAVE AREA ADDR INTO MY SAVE     18750002
         LR    R13,R4        PLACE MY SAVE AREA ADDR INTO R13           18800002
         LA    R10,STAEDEL   ACCESS ADDR OF STAE EXIT TAB               18850002
         L     R5,PARSEDEL   ACCESS PCL POINTER                         18900002
         LA    R11,I0024     DELETE-INSERT FOR ERR MSG                  18950002
         LA    R6,SPLISTDL   REG 6 = ESTAE PARAMETER LIST               18960002
         BAL   R14,STAEPREP  TO EXPAND STAE MACRO                       19000002
         L     R5,TSTANSPL   PLACE ADDRESS OF PDE IN R5                 19050002
         USING C,R5          ESTABLISH PDL ADDRESSABILITY               19100002
         LA    R5,PARSE1     ACCESS PDE PTR                             19150002
         DROP  R5            DROP PDL ADDRESSABILITY                    19200002
         USING PRSDSECT,R5   ESTABLISH PDE ADDRESSABILITY               19250002
         L     R2,WORKAREA   GET ADDRESS OF WORKAREA                    19260002
         MVI   CWORKCMD-TSTCWORK(R2),BLANK  PLACE A BLANK INTO BYTE 1   19270002
*                            OF WA TO PAD WITH BLANK FOR DELETE MACRO   19280002
         MVC   CWORKCMD-TSTCWORK+@1(@7,R2),CWORKCMD-TSTCWORK(R2)        19290002
         LH    R4,LEN2       LOAD LENGTH OF NAME INTO REG4              19292002
         BCTR  R4,R0         PREPARE FOR EX INSTRUCTION                 19294002
         L     R5,DSNPTR     GET MEMBER NAME POINTER                    19296002
         DROP  R5                                                       19298002
         EX    R4,DELMOVE    MOVE MODULE NAME TO WORKAREA               19298402
         LA    R10,I0024     DELETE-INSERT FOR ERR MSG                  19298802
         ST    R10,MIDHOLD-TSTCWORK(R2) STORE DELETE INSERT             19308802
************************************************************            19310002
** AFTER RETURNING FROM PARSE AND PLACING THE MODULE NAME **            19320002
** IN THE WORK AREA WE BRANCH TO SWITCH REGISTERS THEREBY **            19330002
** PUTTING US UNDER THE PROBLEM PROGRAM TCB AND NOT UNDER **            19332002
** THE TEST TCB                                           **            19340002
************************************************************            19342002
         BAL   R14,TASKSW    SWITCH TO PROB PROG TCB                    19350002
         BAL   R14,PPSTAE    SET UP FOR STAE UNDER PRB PROG             19400002
************************************************************            20100002
** AT THIS POINT WE ARE READY TO DELETE THE NAMED MODULE  **            20150002
************************************************************            20200002
CONTDEL  DELETE EPLOC=CWORKCMD-TSTCWORK(R2)     DELETE MODULE           20250002
         LTR   R15,R15       CHECK TO SEE THAT DELETE WAS SUCCESSFUL    20400002
SMTDEL   DS    0H            TEST CASE                                  20450002
         BZ    STAEOFF       RETURN TO TEST                             20500002
************************************************************            20550002
** THE MODULE TO BE DELETED CAN NOT BE FOUND WE THEREFORE **            20600002
** PUT OUT A MESSAGE INDICATING THIS AND THEN BRANCH TO   **            20650002
** PUT US BACK INTO TEST ROUTINE                          **            20700002
************************************************************            20750002
         LA    R2,M0058      MSG-DELETE FAILED                          20760002
         LA    R3,M0251      MSG-PGM NOT ON LOAD LIST                   20770002
         LA    R4,I0024      DELETE INSERT                              20780002
         BAL   R6,MSG2       GO OUTPUT MESSAGES                         20790002
         OI    TSTFLGS4,TSTFLUSH TELL MAINLINE TO FLUSH STACK           20792002
         B     STAEOFF       REMOVE STAE REQUEST AND RETURN             20792102
         EJECT                                                          21000002
************************************************************            21050002
** THIS IS THE ENTRY POINT FOR A GETMAIN COMMAND. WE WILL **            21100002
** SAVE REGISTERS,ESTABLISH ADDRESSABILITY,THEN SWITCH    **            21150002
** OURSELVES FROM TEST TO THE PROBLEM PROGRAM TCB. ONCE   **            21200002
** THIS HAS BEEN ACCOMPLISHED WE WILL ISSUE A GETMAIN     **            21250002
** FOR THE REQUIRED CORE. WE THEN RETURN                  **            21300002
************************************************************            21350002
GETIT    EQU   *             EQUATE GETMAIN ENTRY TO THIS ADDR          21400002
         L     R4,REGSAVE2   PLACE ADDR OF MY SAVE AREA INTO R4         21450002
         ST    R13,@4(R4)    PLACE USER SAVEAREA ADDR INTO MY SAVE      21500002
         LR    R13,R4        PLACE MY SAVE AREA ADDR INTO R13           21550002
         LA    R10,STAEGET   ACCESS ADDR OF STAE EXIT TABLE             21600002
         L     R5,PCLGET     ACCESS POINTER TO PCL                      21650002
         LA    R11,I0025     GETMAIN-INSERT FOR ERR MSG                 21660002
         LA    R6,SPLISTGT   REG 6 = ESTAE PARAMETER LIST               21710002
         BAL   R14,STAEPREP  TO EXPAND STAE MACRO                       21750002
         L     R3,TSTANSPL   PLACE ADDR TO PDE INTO R3                  21800002
         USING B,R3          ESTABLISH PDL ADDRESSABILITY               21850002
         LA    R3,GETMAIN1   ACCESS PDE POINTER                         21900002
         DROP  R3            DROP PDL ADDRESSABILITY                    21950002
         USING IDENTGM,R3    ESTABLISH PDE ADDRESSABILITY               22000002
         L     R1,STRNGPTR   PLACE POINTER TO INTER IN R1               22050002
         LH    R6,LENDSNME   PLACE LENGTH OF OF INTEGER IN R6           22100002
         BCTR   R6,R0        DECREMENT R6 BY 1 FOR EXECUTE CMD          22150002
         EX    R6,A13000     PACK INTEGER INTO WORKAREA                 22200002
         CVB   R4,@0(R2)     CONVERT INTEGER TO BINARY                  22250002
         LTR   R4,R4         TEST GETMAIN COUNT                         22260002
         BNZ   GETOK         COUNT NOT ZERO, BRANCH                     22270002
         LA    R2,M0047      MSG-0 BYTES INVALID CNT                    22280002
         LA    R3,ZERO       NO SECOND LEVEL MESSAGE                    22282002
         BAL   R6,MSG1       GO OUTPUT MESSAGES                         22292002
         B     A18000        RETURN TO MAINLINE                         22294002
GETOK    L     R1,SPOINTER   PLACE SUBPOOL POINTER IN REG1              22296002
         LTR   R1,R1         SEE IF WE HAVE A SUBPOOL SPECIFIED         22500002
         BNZ   A13010        IF ENTERED THEN AVOID NEXT CODE            22550002
         SR    R5,R5         DEFAULT TO SUBPOOL ZERO                    22600002
         B     A13020        BRANCH TO ISSUE GETMAIN TO SP=0            22650002
A13010   EQU   *             EQUATE LABEL TO THIS ADDRESS               22700002
         LH    R6,SPLENGTH   GET LENGTH OF INTEGER FROM PDE             22750002
         BCTR  R6,R0         DECREMENT R6 TO FIT EX INSTRUCTION         22800002
         EX    R6,A13000     PACK THIS NUMBER INTO WORKAREA             22850002
         CVB   R5,@0(R2)     CONVERT SUBPOOL INTEGER TO BINARY          22900002
A13020   EQU   *             EQUATE LABEL TO THIS ADDRESS               22950002
         XR    R7,R7         INDICATE EQUATE NOT SPECIFIED              23000002
         TM    EQUFLG,HEX80  TEST FOR PRESENCE OF EQUATE KEYWORD        23050002
         BNO   NOSYM         IF NO EQUATE KEYWORD, BRANCH               23100002
         L     R7,SYMTABLE   ACCESS PTR TO IN-CORE SYMBOL TABLE         23150002
         USING SYMDSECT,R7   ESTABLISH SYMTABLE ENTRY ADDRESSABILITY    23200002
CHKSYM   EQU   *                                                        23250002
         LTR   R7,R7         TEST IF END OF CHAIN                       23300002
         BZ    ENDSRCH       IF ZERO THEN SEARCH ENDED                  23350002
         LH    R6,EQULEN     ACCESS LENGTH OF SYMBOL IN PDE             23400002
         LH    R8,SYMLNGTH   ACCESS LENGTH OF SYMTABLE ENTRY            23450002
         CR    R8,R6         COMPARE SYMBOL LENGTHS                     23500002
         BNE   REINIT        GET NEXT SYMTAB ENTRY                      23550002
         L     R8,EQUPTR     ACCESS PTR TO SYMBOL IN PDE                23600002
         BCTR  R6,R0         DECREMENT FOR EXECUTE                      23650002
         EX    R6,SYMCOMP    TO COMPARE SYMBOLS                         23700002
         BE    SKIPGTMN      DUPLICATE FOUND, BYPASS GETMAIN            23750002
REINIT   EQU   *                                                        23800002
         L     R7,CHAIN      ACCESS PTR TO NEXT SYMTAB ENTRY            23850002
         B     CHKSYM        IF NOT, TEST FOR DUPLICATE                 23900002
*                                                                       23950002
ENDSRCH  EQU   *                                                        24000002
         LH    R6,EQULEN     ACCESS SYMBOL LENGTH                       24050002
         LA    R7,@16(R6)    LENGTH OF FUTURE SYMTAB ENTRY              24100002
         LA    R2,CWORKCMD-TSTCWORK(R2) COMMAND PORTION OF WORKAREA     24150002
         MVC   @4(LISTSIZE,R2),GETLIST  LIST FORM OF GETMAIN            24200002
         LA    R1,@4(R2)     PTR TO LIST FORM                           24250002
         GETMAIN EC,LV=(7),SP=1,A=(2),MF=(E,(1))  ISSUE GETMAIN         24300002
         LTR   R15,R15       TEST RETURN CODE                           24350002
         BZ    ENTERSYM      IF RC=0, BRANCH                            24400002
         LA    R4,TEN        IMPLIES SVC 10 FAILED                      24402002
         B     GETERR        GO OUTPUT ERROR MSG                        24410002
ENTERSYM EQU   *                                                        24550002
         L     R8,SYMTABLE   ACCESS PTR TO LAST SYMTAB ENTRY            24600002
         L     R7,@0(R2)     ACCESS PTR TO FUTURE SYMTAB ENTRY          24650002
         ST    R8,CHAIN      STORE LATEST PTR IN FUTURE ENTRY           24700002
         ST    R7,SYMTABLE   FUTURE ENTRY BECOMES LATEST ENTRY          24750002
         STH   R6,SYMLNGTH   STORE SYMBOL LENGTH                        24800002
         BCTR  R6,R0         DECREMENT FOR EXECUTE                      24850002
         L     R8,EQUPTR     ACCESS PTR TO SYMBOL FROM PDE              24900002
         EX    R6,SYMMVC     MOVE SYMBOL                                24950002
SKIPGTMN EQU   *                                                        25000002
         MVI   SYMBOL,BLANK  MAKE SYMTABLE ENTRY INACTIVE IN CASE OF    25050002
*                            GETMAIN FAILURE                            25100002
         IC    R6,@0(R8)     STORE FIRST CHARACTER IN R6                25150002
         MVC   ATTRTYPE(PARMSIZE),SYMPARM  MOVE IN CONSTANTS            25200002
         XC    ADDRSYM(@4),ADDRSYM ZERO CURRENT ADDRESS                 25250002
NOSYM    EQU   *                                                        25300002
         LA    R10,I0025     GETMAIN-INSERT FOR ERR MSG                 25310002
         L     R2,WORKAREA   PTR TO WORKAREA                            25360002
         ST    R10,MIDHOLD-TSTCWORK(R2) STORE GETMAIN INSERT            25370002
         BAL   R14,TASKSW    BRANCH TO SWITCH US TO THE PROBLEM PROG    25400002
*                            OF PDL IN REG2                             25450002
CONTGET  EQU   *                                                        25500002
************************************************************            25550002
** WHEN WE RETURN TO THIS POINT WE ARE NOW UNDER THE      **            25600002
** PROBLEM PROGRAM TASK AND NOT UNDER TEST. SINCE WE      **            25650002
** NEED OUR REGISTERS LATER,WE MUST SAVE THEM NOW IN      **            25700002
** REGSAVE3                                               **            25750002
************************************************************            25800002
************************************************************            25850002
**    REGISTER 4 = LENGTH OF CORE TO ISSUE GETMAIN        **            25900002
**    REGISTER 5 = SUBPOOL NUMBER TO GET CORE             **            25950002
**    REGISTER 1 = ADDRESS OF AREA FOR GETMAIN TO BUILD   **            26000002
**                 PARAMETER LIST IN BEFORE ISSUING SVC 10 *            26050002
************************************************************            26100002
         BAL   R14,PPSTAE    BRANCH TO STAE SETUP UNDER PPTCB           26150002
         LA    R2,CWORKCMD-TSTCWORK(R2) ACCESS COMMAND PORTION OF WRKA  26350002
         LA    R1,@4(R2)     PLACE ADDRESS OF LIST FORM IN R1           26400002
         MVC   @4(LISTSIZE,R2),GETLIST    MOVE LIST FORM INTO WA        26450002
         GETMAIN EC,LV=(4),SP=(5),A=(2),MF=(E,(1)) ISSUE CONDITIONAL    26500002
*                            GETMAIN WITH ADDRESS RETURN IN WORKAREA    26550002
         LTR   R15,R15       TEST IF GETMAIN WAS SUCCESSFUL             26600002
SMTGET02 DS    0H            TEST CASE                                  26650002
         BZ    A14001        IF SUCCESSFUL THEN BRANCH                  26700002
         LA    R4,TEN        IMPLIES SVC 10 FAILED                      26702002
         B     GETERR        GO OUTPUT ERROR MSG                        26710002
A14001   EQU   *             EQUATE LABEL TO THIS ADDRESS               26950002
         LTR   R7,R7         TEST IF EQUATE SPECIFIED                   27000002
         BZ    DONTEQU       SKIP EQUATE PROCESSING                     27050002
         STC   R6,SYMBOL     ACTIVATE SYMTABLE ENTRY                    27100002
         MVC   ADDRSYM(@4),@0(R2) ENTER EQUATED ADDRESS IN SYMTAB ENTRY 27150002
         DROP  R7                                                       27200002
DONTEQU  EQU   *                                                        27250002
         L     R4,@0(R2)     LOAD REG4 WITH ADDR OF STORAGE             27252002
         LA    R2,M0046      MSG-STORAGE AT ...                         27260002
         BAL   R6,MSG5       GO OUTPUT MESSAGE                          27280002
         B     STAEOFF       REMOVE STAE REQUEST AND RETURN             27290002
         EJECT                                                          28200002
************************************************************            28250002
** THIS IS THE ENTRY POINT FOR A FREEMAIN COMMAND.WE      **            28300002
** WILL SAVE REGISTERS,ESTABLISH ADDRESSABILITY,THEN      **            28350002
** PARSE WILL SCAN OFF THE SUB-PARAMETERS. ONCE THIS      **            28400002
** HAS BEEN ACCOMPLISHED WE WILL SWITCH FROM TEST TO THE  **            28450002
** PROBLEM PROGRAM TASK TO ISSUE THE FREEMAIN             **            28500002
************************************************************            28550002
FREEALL  EQU   *             EQUATE FREEMAIN TO THIS ADDR               28600002
         L     R4,REGSAVE2   PLACE ADDRESS OF MY SAVEAREA INTO R4       28650002
         ST    R13,@4(R4)    PLACE ADDR OF USER SAVEAREA INTO MY AREA   28700002
         LR    R13,R4        PLACE MY SAVEAREA ADDR INTO R13            28750002
         LA    R10,STAEFREE  ACCESS ADDR OF STAE TABLE                  28800002
         L     R5,PARSEIT    ACCESS POINTER TO PCL                      28850002
         LA    R11,I0026     FREEMAIN-INSERT FOR POSSIBLE MSG           28860002
         LA    R6,SPLISTFR   REG 6= ESTAE PARAMETER LIST                28910002
         BAL   R14,STAEPREP  TO EXPAND STAE MACRO                       28950002
         L     R10,TSTANSPL  PLACE ADDRESS OF PDE INTO R10              29000002
         USING A,R10         ESTABLISH PDL ADDRESSABILITY               29050002
         LA    R10,FREEMAN1  ACCESS PTR TO PDE                          29100002
         DROP  R10           DROP PDL ADDRESSABILITY                    29150002
************************************************************            29200002
** UPON RETURN FROM SWITCHING TO PROBLEM PROGRAM TASK,    **            29250002
** WE WILL ACCESS THE PDL POINTED TO BY REGISTER 10. THE  **            29300002
** LENGTH OF THE AREA TO BE FREED WILL BE IN EBCDIC AND   **            29350002
** MUST BE CONVERTED TO BINARY. THE ABSOLUTE ADDRESS      **            29400002
** WILL BE RETURNED BY CONVERT AND POINTED TO BY CONAREA  **            29450002
** IN TCOMTAB. A CHECK WILL BE MADE TO SEE IF A SUBPOOL   **            29500002
** WAS SPECIFIED. IF SO THIS TOO MUST BE CONVERTED TO     **            29550002
** BINARY                                                 **            29600002
************************************************************            29650002
         USING IDENTFM,R10   USE REG10 TO ADDRESS PDE                   29700002
         L     R1,COREPTR    PLACE POINTER TO INTEGER IN R1             29750002
         LH    R6,LENGTHFM   GET LENGTH OF INTEGER INTO R6              29800002
         BCTR  R6,R0         DECREMENT LENGTH FOR EX INSTRUCTION        29850002
         EX    R6,A13000     PACK THIS INTO WORKAREA                    29900002
         CVB   R0,@0(R2)     CONVERT THIS TO BINARY                     29950002
         DROP  R10           DROP PDE ADDRESSABILITY                    30000002
         L     R10,TSTANSPL  ACCESS PDL POINTER                         30050002
         USING A,R10         ESTABLISH PDL ADDRESSABILITY               30100002
         SR    R7,R7         CLEAR REG 7 FOR SUBPOOL NUMB               30110002
         OC    FREEMAN3(@2),FREEMAN3 TEST IF SUBPOOL SPECIFIED          30150002
         BZ    A14012        IF NOT SPECIFIED, BRANCH                   30200002
         LA    R10,FREEMAN4  ACCESS IDENT PDE                           30250002
         DROP  R10           DROP PREVIOUS PDE ADDRESSABILITY           30300002
         USING IDENTFM,R10   ESTABLISH IDENT PDE ADDRESSABILITY         30350002
         L     R1,COREPTR    ACCESS PTR TO SUBPOOL STRING               30400002
************************************************************            30450002
** AT THIS TIME SUBPOOL WAS SPECIFIED SO WE MUST CONVERT  **            30500002
**    THE INTEGER TO BINARY                               **            30550002
************************************************************            30600002
         LH    R6,LENGTHFM   ACCESS LENGTH OF SUBPOOL STRING            30650002
         BCTR  R6,R0         DECREMENT LENGTH FOR EX INSTRUCTION        30700002
         EX    R6,A13000     PACK THIS VALUE INTO THE WORKAREA          30750002
         CVB   R4,@0(R2)     CONVERT THIS TO BINARY                     30800002
         SLL   R4,@24        MOVE SUBPOOL TO HIGH ORDER BYTE            30850002
         LR    R7,R4         SUBPOOL NUMB TO REG 7                      30860002
         SRL   R7,@24        RIGHT-JUST. IN REG 7                       30870002
A14012   EQU   *             ENTER HERE IF NO SUBPOOL SPECIFIED         30950002
         DROP  R10           DROP PREVIOUS PDE ADDRESSABILITY           31000002
         L     R10,TSTANSPL  ACCESS ADDR OF PDL                         31050002
         USING A,R10         ESTABLISH PDL ADDRESSABILITY               31100002
         LA    R10,FREEMAN2  ACCESS ADDR OF PDE                         31150002
         DROP  R10           DROP PDL ADDRESSABILITY                    31200002
         USING IKJPARMA,R10  ESTABLISH PDE ADDRESSABILITY               31250002
         L     R6,PDEUSER    ACCESS ADDR IN USERWORD                    31300002
         LR    R4,R0         SAVE REGISTER ZERO                         31350002
         LA    R10,I0026     FREEMAIN-INSERT FOR POSSIBLE MSG           31360002
         L     R2,WORKAREA   PTR TO WORKAREA                            31410002
         ST    R10,MIDHOLD-TSTCWORK(R2) STORE FREEMAIN INSERT           31420002
         BAL   R14,TASKSW    SWITCH TO PROB PROG TCB                    31450002
CONTFREE BAL   R14,PPSTAE    SETUP FOR STAE UNDER PRB PROG              31500002
         LR    R0,R4         RESTORE REGISTER 0                         31700002
         LR    R1,R6         ACCESS ADDR IN USERWORD                    31750002
         LA    R1,@0(R1)     CLEAR HIGH ORDER BYTE OF ADDRESS           31760002
         FREEMAIN RC,LV=(0),A=(1),SP=(R7)  ISSUE FREEMAIN               31800002
         LTR   R15,R15       TEST RETURN CODE                           31810002
         BZ    CONTFRE1      BRANCH IF ALL OK                           31820002
         LA    R4,@120       IMPLIES SVC 120 FAILED                     31822002
         B     GETERR        GO OUTPUT ERROR MESSAGE                    31830002
CONTFRE1 B     STAEOFF       REMOVE STAE REQUEST AND RETURN             31840002
         EJECT                                                          32000002
************************************************************            32050002
** THIS ROUTINE WILL SWITCH US FROM TEST TCB WHICH WE ARE **            32100002
** NOW RUNNING UNDER TO PROBLEM PROGRAM TCB.SO THAT WE    **            32150002
** WILL LOAD THE PROGRAM UNDER THE PROBLEM PROGRAM. THIS  **            32200002
** IS ACCOMPLISHED BY PLACING OUR REGISTERS INTO THE SVRB **            32250002
** GENERAL PURPOSE SAVE AREA (RBGRSAVE) SO THAT WHEN      **            32300002
** CONTROL IS RETURNED TO THE PROBLEM PROGRAM OUR         **            32350002
** REGISTERS ARE LOADED. WE ALSO CHANGE THE LOCATION      **            32400002
** COUNTER FOUND IN RBOPSW OF THE PROGRAM REQUEST BLOCK   **            32450002
** SO THAT AFTER OUR REGISTERS HAVE REPLACED THE PROBLEM  **            32500002
** PROGRAMS REGISTERS CONTROL IS RETURNED BACK INTO THIS  **            32550002
** PROGRAM AT THE POINT WHERE WE WERE AFTER  BRANCHING    **            32600002
** TO THIS ROUTINE.                                       **            32650002
** IF A NON ZERO RETURN CODE IS ENCOUNTERED FROM SVC 97,  **            32700002
** RETURN IS MADE TO 4(R14).                              **            32750002
************************************************************            32800002
TASKSW   EQU   *                                                        32850002
         L     R1,PPTCB      PLACE PROBLEM PROGRAM TCB ADDR             32900002
*                            INTO REG1                                  32950002
         L     R2,WORKAREA   ACCESS WORKAREA PTR                        33000002
         LA    R11,CWORKLDF-TSTCWORK(R2) FUTURE RB REG SAVE AREA        33050002
         USING TCB,R1        USE REG1 TO ADDRESS TASK CONTROL BLK       33100002
         L     R1,TCBRBP     LOAD RB ADDRESS INTO REG1                  33150002
         DROP  R1            DROP R1                                    33200002
         USING RBSECT,R1     USE REG1 TO ADDRESS REQUEST BLOCK          33250002
         MVC   @0(@64,R11),RBGRSAVE MOVE RB REG SAVE AREA INTO          33300002
*                            AREA FROM GETMAIN                          33350002
         L     R1,RBLINK     PLACE ADDR OF NEXT RB INTO R1              33400002
         MVC   TSTGO(@4),RBOPSW+@4 MOVE INSTRUCTION COUNTER             33450002
*                            FROM RB INTO GETMAIN SAVE AREA             33500002
         DROP  R1            DROP R1                                    33550002
         L     R1,REGSAVE3   REGISTER SAVE AREA PARM FOR SVC            33600002
         STM   R0,R15,@0(R1) STORE REG INTO MY SAVE AREA                33650002
         LR    R4,R1         PLACE ADDR OF REG AREA IN R4               33660002
         L     R3,PPTCB      PLACE PROB PROG TCB ADDR INTO R1           33700002
         LR    R5,R14        SAVE RETURN ADDR ACROSS SVC.               33750002
* ISSUE SVC WHICH WILL PLACE MY REGISTERS INTO PROB PROG SVRB           33800002
         IKJEGS9G AGPR,TCBADDR=(R3),VALUE=(R4),MF=(E,(R2))              33850002
         LTR   R15,R15       CHECK RETURN CODE                          33900002
         BZ    TASKCONT      CONTINUE IF ALL OK                         33910002
TASKERR  EQU   *             SVC 97 ERROR PROCESSING                    33912002
         LA    R2,@12        REG 2 IS 12 FOR COMPARISON                 33920002
         CR    R15,R2        COMPARE 12 TO RET CODE                     33930002
         BH    RET           IS GREATER THAN 12, BACK TO MNL            33940002
         B     SVCFAIL       IF 12 OR LESS, PUT OUT ERROR MSG           33942002
TASKCONT EQU   *             CONTINUE PROCESSING                        33944002
*************************************************************           34000002
** AT THIS TIME WE SHOULD HAVE SWITCHED THE PROBLEM PROGRAM**           34050002
** REGISTERS WITH MY REGISTERS.NOW WE CHANGE THE           **           34100002
** INSTRUCTION COUNTER FOUND IN THE PRB                    **           34150002
*************************************************************           34200002
         LA    R5,0(R5)      CLEAR 1ST BYTE OF RESUME ADDRESS           34250002
************************************************************            34300002
**AT THIS POINT REG5 CONTAINS MY RETURN ADDRESS WITHIN THE**            34350002
**MAINLINE PORTION OF THIS PROGRAM. REG3 CONTAINS THE     **            34400002
**PROBLEM PROG TCB ADDRESS WHICH WILL BE SEARCHED FOR A   **            34450002
**PRB. ONCE FOUND THE RPOPSW FIELD WILL BE CHANGED TO     **            34500002
**CONTAIN MY RETURN ADDRESS                               **            34550002
************************************************************            34600002
         IKJEGS9G OPSW,TCBADDR=(R3),VALUE=(R5),MF=(E,(R2))              34650002
         LTR   R15,R15       CHECK RETURN CODE                          34700002
         BNZ   TASKERR       SVC FAILED                                 34750002
*                                                                       34800002
         L     R3,PPRB        ACCESS ADDR OF NEW RB                     34850002
         USING RBSECT,R3      USE REG3 TO ADDRESS REQUEST BLOCK         34900002
         MVC   TSTGO+@4(@1),RBWCF SAVE WAIT COUNT OF NEW RB             34950002
         DROP  R3             DROP REG3                                 35000002
         IKJEGS9G WCF,TCBADDR=(R3),MF=(E,(R2))                          35050002
         LTR   R15,R15        CHECK RETURN CODE                         35100002
         BNZ   TASKERR        SVC FAILED                                35150002
*                                                                       35200002
         LA    R4,I0087      IKJEGLDF INSERT                            35210002
         LA    R5,@8         SVC = 8 FOR LINKFAIL                       35220002
         LOAD  EP=IKJEGLDF,ERRET=LINKFAIL  LOAD MYSELF                  35230002
BLOW8    EQU   *              RESUME ADDR FOR STAE EXIT                 35300002
SMTLOAD2 DS    0H             TEST CASE TTTA7600                        35350002
         XR    R15,R15        ZERO REGISTER                             35400002
         L     R3,OUTBUF      ACCESS PTR TO OUTBUF                      35450002
         ST    R15,@0(R3)     STORE ZEROES IN BUFFER- NO MSG            35500002
         OI    TSTFLGS2,TSTLDF                                          35550002
         LA    R15,@4         PLACE SUCCESSFUL JOB RETURN CODE          35600002
*                             INTO REG15                                35650002
         L     R13,REGSAVE1   RESTORE CALLERS SAVE AREA                 35750002
         RETURN (14,12),RC=(15) RETURN TO MAINLINE TEST                 35800002
         SPACE 1                                                        35850002
SVCFAIL  LR    R4,R10        LOAD REG4 WITH INSERT                      35860002
         LA    R2,M0104      MSG-... FAILED, CMMND SYS ERR              35870002
         LA    R3,M0283      MSG-SVC 97 RET CODE NONZERO                35880002
         BAL   R6,MSG2       GO OUTPUT MESSAGES                         35890002
         B     A18000        RETURN TO MAINLINE                         35892002
         EJECT                                                          36150002
************************************************************            36200002
*                                                                       36250002
*          MISCELLANEOUS SUBROUTINES                                    36300002
*                                                                       36350002
******************************************************************      36400002
PPSTAE   EQU   *                                                        36450002
         L     R1,WORKAREA         ACCESS WORKAREA PTR                  36500002
         MVI   TASKSWF-TSTCWORK(R1),HEXFF  SET TASK SW INDICATOR ON     36510002
         MVC   @0(STAELEN,R1),LISTSTAE LIST FORM OF ESTAE MACRO         36550002
         LA    R10,STAEXIT         STAE EXIT ROUTINE                    36600002
         LR    R3,R14              SAVE RETURN REGISTER                 36650002
         ESTAE (R10),RECORD=YES,MF=(E,(R1))   ISSUE ESTAE               36652002
         LTR   R15,R15             TEST STAE RETURN CODE                36750002
         BZ    PPGOBACK            IF ZERO BRANCH AROUND MSG            36752002
         OI    TSTFLGS4,TSTESTAE   TURN ON TSTESTAE FOR IO              36752402
         LA    R2,M0103            MSG-NOT ENOUGH CORE                  36754002
         LA    R3,ZERO             NO SECOND LEVEL MESSAGE              36756002
         BAL   R6,MSG1             GO OUTPUT MESSAGES                   36758002
         NI    TSTFLGS4,HEXFF-TSTESTAE  TURN OFF TSTESTAE               36808002
         OI    TSTFLGS4,TSTFLUSH   TELL MAINLINE TO FLUSH STACK         36960002
         B     TSTSVC              RETURN VIA SVC                       37020002
PPGOBACK EQU   *                   LOAD R2 AND RETURN                   38210002
         LR    R14,R3              RESTORE RETURN REGISTER              38250002
         L     R2,WORKAREA         INIT REG 2 WITH WORKAREA             38300002
         BR    R14                 RETURN                               38350002
******************************************************************      38400002
GETREGS  EQU   *                                                        38450002
         L     R2,@16              ACCESS PTR TO CVT                    38500002
         USING CVT,R2              ESTABLISH CVT ADDRESSABILITY         38550002
         L     R4,CVTTCBP          ACCESS TCB PTR                       38600002
         L     R4,@4(R4)           ACCESS CURRENT TCB PTR               38650002
         USING TCB,R4              ESTABLISH TCB ADDRESSABILITY         38700002
         L     R9,TCBTRN           ACCESS PTR TO TCOMTAB                38750002
         DROP  R2                  DROP CVT  ADDRESSABILITY             38800002
         BR    R11                 RETURN TO CALLER                     38850002
******************************************************************      38900002
STAEXIT  EQU   *                   STAE EXIT FOR PP                     38950002
         USING STAEXIT,R15         USE ENTRY POINT AS BASE              39000002
         L     R12,BASE            START ADDR OF PROGRAM                39050002
         DROP  R15                 DROP ENTRY POINT ADDRESSABILITY      39100002
         USING BASELOC,R12         ESTABLISH PROGRAM ADDRESSABILITY     39150002
         BAL   R11,GETREGS         TO GET PTR TO TCOMTAB                39200002
         LR    R8,R14              SAVE RETURN ADDRESS                  39202002
         LA    R7,M0058            MSG-... FAILED                       39220002
         LA    R5,M0253            MSG-SYS ABEND CODE ...               39230002
         L     R2,WORKAREA         PTR TO WORKAREA                      39240002
         LA    R3,MSGINSRT-TSTCWORK(R2)  ACCESS WORKAREA FOR INSERT     39240402
         UNPK  @0(@5,R3),TCBCMPC(@3)  PREPARE CODE FOR CONVERT          39240802
         TR    @0(@3,R3),TABLE-@240  CONVERT TO EBCDIC                  39241202
         LA    R6,@7               MESSAGE INSERT LENGTH OF 7           39241702
         STH   R6,MSGINSHD-TSTCWORK(R2)  STORE MESSAGE LENGTH           39241802
         L     R4,MIDHOLD-TSTCWORK(R2) R4=INSERT FOR MSG                39242002
         BAL   R6,MSG6                                                  39244002
         LA    R15,@4              SET RETURN CODE                      39500002
         LA    R0,RETRY2           INDICATE ADDRESS OF RETRY RTN        39550002
         DROP  R4                  DROP TCB  ADDRESSABILITY             39600002
         OI    TSTFLGS4,TSTFLUSH   TELL MAINLINE TO FLUSH STACK         39610002
         BR    R8                  RETURN TO ABEND                      39650002
******************************************************************      39700002
RETRY2   EQU   *                                                        39750002
         USING RETRY2,R15          USE ENTRY POINT AS BASE              39800002
         L     R12,BASE            START ADDR OF PROGRAM                39850002
         DROP  R15                 DROP ENTRY POINT ADDRESSABILITY      39900002
         USING BASELOC,R12         ESTABLISH PROGRAM ADDRESSABILITY     39950002
         BAL   R11,GETREGS         TO GET PTR TO TCOMTAB                40000002
         B     STAEOFF             RETURN VIA SVC                       40300002
******************************************************************      40350002
STAEOFF  EQU   *                                                        40400002
         LR    R2,R15        SAVE RET CODE OVER ESTAE                   40402002
         ESTAE 0             REMOVE ESTAE REQUEST                       40404002
         LR    R15,R2        RESTORE RETURN CODE                        40406002
         NI    TSTFLGS4,HEXFF-TSTRERTN  SHUT OFF RETRY FLAG             40408002
         B     TSTSVC        RETURN VIA SVC                             40458002
******************************************************************      40550002
*  R5 = @ PCL                                                           40600002
* R10 = @ STAE EXIT TAB                                                 40650002
* R11 = POSSIBLE COMMAND SYSTEM ERROR MSG                               40700002
******************************************************************      40750002
STAEPREP EQU   *             EXPAND STAE MACRO                          40800002
         L     R2,WORKAREA   ACCESS ADDR OF WORKAREA                    40950002
         MVI   TASKSWF-TSTCWORK(R2),HEX00  SET TASKSWITCH IND. OFF      40960002
         MVC   CWORKCMD-TSTCWORK(STAELEN,R2),LISTSTAE PUT STAE IN WKA   41000002
         LA    R1,CWORKCMD-TSTCWORK(R2)  PARAMETER TO STAE              41050002
         L     R10,TSTSTAE   ADDR OF STAE EXIT ROUTINE                  41100002
         ST    R12,@68(R13)  SAVE BASE REGISTER                         41150002
         LR    R3,R14        RETAIN RETURN ADDR IN REG 3                41200002
         LR    R8,R14        SAVE RETURN REGISTER                       41250002
         ESTAE (R10),PARAM=(R6),RECORD=YES,MF=(E,(R1))  ISSUE ESTAE     41252002
         LTR   R15,R15       TEST FOR NON ZERO RETURN CODE              41350002
SMTSTAE  DS    0H            TEST CASE TTTA7600                         41400002
         BZ    SETPARM       IF ZERO SETUP FOR PARSE                    41450002
         STC   R15,TSTESTRC  STORE RETURN CODE FROM ESTAE               41452002
         LA    R15,@24       SEND RET CODE=24 TO MAINLINE               41454002
         B     RET1          BRANCH TO RETURN TO MAINLINE               41456002
SETPARM  EQU   *             SET UP PARAMETER LIST FOR PARSE            41600002
         LA    R1,CWORKCMD-TSTCWORK(R2) ACCESS COMMAND PORTION          41650002
         USING PPL,R1        ESTABLISH PPL ADDRESSABILITY               41700002
         MVC   PPLUPT(@4),TSTUPT PTR TO UPT FOR PARSE                   41750002
         MVC   PPLECT(@4),TSTECT PTR TO ECT FOR PARSE                   41800002
         MVC   PPLECB(@4),TSTCPECB PTR TO CP ECB FOR PARSE              41850002
         ST    R5,PPLPCL      PTR TO PCL FOR PARSE                      41900002
         ST    R13,PPLUWA     PTR TO MY SAVE AREA                       41950002
         LA    R3,TSTANSPL    ACCESS ADDR OF ANSWER PLACE               42000002
         ST    R3,PPLANS      PTR TO ANSWER PLACE FOR PARSE             42050002
         MVC   PPLCBUF(@4),INBUF PTR TO COMMAND BUFFER FOR PARSE        42100002
         DROP  R1            DROP PPL ADDRESSABILITY                    42150002
         LA    R5,@6         SVC = 6 FOR LINKFAIL                       42152002
         LA    R4,I0040      PARSE-INSERT FOR POSSIBLE MSG              42160002
         LINK  EP=IKJPARS,ERRET=LINKFAIL LINK TO PARS                   42210002
BLOW1    EQU   *                                                        42250002
SMTPARS  DS    0H            TEST CASE TTTA7600                         42300002
         BAL   R14,CHKCDE    TO CHECK RETURN CODE                       42350002
         LR    R14,R8        RESTORE RETRUN REGISTER                    42400002
         BR    R14           RETURN TO COMMAND PROCESSING               42450002
CHKCDE   EQU   *                                                        42500002
         B     RETCDTAB(R15) BRANCH ACCORDING TO CODE                   42550002
RETCDTAB BR    R14           BRANCH BACK OF CODE = 0                    42600002
         BR    R14           FOR ALIGNMENT PURPOSES                     42650002
         B     RETCDE4       RETURN CODE = 4                            42700002
         B     RETCDE8       RETURN CODE = 8                            42750002
         B     RETCDE12      RETURN CODE = 12                           42800002
         B     RETCDE16      RETURN CODE = 16                           42850002
         B     RETCDE20      RETURN CODE = 20                           42900002
*                                                                       42950002
RETCDE20 EQU   *             ENTER IF RETURN CODE = 20                  43000002
         L     R15,CODESAVE-TSTCWORK(R2) ACCESS SAVED RETURN CODE       43050002
         LA    R14,@16       TO TEST RETURN CODE                        43100002
         CR    R15,R14       TEST RETURN CODE                           43150002
         BE    RET           RETURN 16 TO MAINLINE                      43200002
         BH    SEND20        RETURN 20 TO MAINLINE                      43250002
RETCDE4  EQU   *             ENTER FOR R. C. OF 4 (UNABLE TO PROMPT)    43300002
         OI    TSTFLGS4,TSTFLUSH TELL MNLINE TO FLUSH STACK             43350002
         XR    R15,R15       RETURN 0 TO MAINLINE                       43400002
         B     RET           RETURN TO MAINLINE                         43450002
SEND20   EQU   *                                                        43500002
         LA    R15,@20       RETURN CODE OF 20 TO MAINLINE              43550002
         B     RET           RETURN TO MAINLINE                         43600002
RETCDE12 EQU   *             ENTER IF PARSE RET CODE = 12               43650002
* INVALID PARMS FROM SUBCOMMAND                                         43660002
         LA    R3,M0277      MSG-PARSE ERROR CODE 12                    43670002
         LA    R2,M0104      MSG-... FAILED COMMND SYS ERR              43680002
         LR    R4,R11        LOAD REG4 WITH INSERT                      43690002
         BAL   R6,MSG2       GO OUTPUT MESSAGES                         43692002
         B     A18000        RETURN TO MAINLINE                         43694002
RETCDE16 EQU   *             ENTER IF R. C. = 16 (NO STORAGE FOR PDE)   43950002
         LA    R2,M0103      MSG-NOT ENOUGH MAIN STOR.                  43960002
         LA    R3,ZERO       NO SECOND LEVEL MESSAGE                    43962002
         BAL   R6,MSG1       GO OUTPUT MESSAGES                         43980002
         B     A18000        COMMON MSG OUTPUT ROUTINE                  44050002
RETCDE8  EQU   *             ENTER IF PARSE RET CODE = 8 (ATTENTION)    44100002
         LA    R15,@16       SET RETURN CODE TO MAINLINE                44150002
         B     RET           RETURN TO MAINLINE                         44200002
******************************************************************      44250002
RETRY    EQU   *             STAE RETRY ENTRY POINT                     44300002
         L     R2,@16        ACCESS PTR TO CVT                          44350002
         USING CVT,R2        ESTABLISH CVT ADDRESSABILITY               44400002
         L     R3,CVTTCBP    ACCESS TCB PTR                             44450002
         L     R3,@4(R3)     ACCESS CURRENT TCB PTR                     44500002
         USING TCB,R3        ESTABLISH TCB ADDRESSABILITY               44550002
         L     R9,TCBTRN     PTR TO TCOMTAB                             44600002
         L     R13,REGSAVE2  ACCESS SAVE AREA                           44650002
         L     R12,@68(R13)  ACCESS BASE REGISTER                       44700002
         DROP  R2            DROP CVT ADDRESSABILITY                    44750002
         DROP  R3            DROP TCB ADDRESSABILITY                    44800002
         NI    TSTFLGS2,HEXFF-TSTLDF TURN OF LDF FLAG                   45100002
         LA    R15,@20       RETURN CODE TO MAINLINE                    45150002
         OI    TSTFLGS4,TSTFLUSH   TELL MAINLINE TO FLUSH STACK         45160002
         B     RET           RETURN TO MAINLINE                         45200002
******************************************************************      45250002
A18000   EQU   *             EQUATE LABEL TO THIS ADDRESS               46800002
         OI    TSTFLGS4,TSTFLUSH   TELL MAINLINE TO FLUSH STACK         46850002
         CH    R15,ATTNCODE  COMPARE RET CODE TO 16                     46900002
         BNL   RET           RET WITH CODE NOT LESS 16                  46950002
GOHOME   EQU   *                                                        47150002
         SR    R15,R15       SEND BACK ZERO RETRUN CODE                 47152002
RET      EQU   *             REMOVE ESTAE AND RETURN                    47154002
         LR    R2,R15        SAVE RET CODE OVER ESTAE                   47156002
         ESTAE 0             REMOVE ESTAE REQUEST                       47158002
         LR    R15,R2        RESTORE RETURN CODE                        47158402
         NI    TSTFLGS4,HEXFF-TSTRERTN  SHUT OFF RETRY FLAG             47158802
RET1     EQU   *             RETURN TO MAINLINE                         47159202
         L     R13,@4(R13)   RESTORE SAVE AREA ADDR                     47200002
         RETURN (14,12),RC=(15) RETURN TO CALLER                        47250002
         EJECT                                                          47300002
******************************************************************      47350002
*          VALIDITY CHECK ROUTINES FROM PARSE                           47400002
*           (1) LOADVLCK - LOAD VALIDITY CHECK RTN                      47450002
*           (2) ADDRVLCK - FREEMAIN VALIDITY CHECK RTN                  47500002
******************************************************************      47550002
LOADVLCK EQU   *             LOAD VALIDITY CHECK ROUTINE                47600002
         SAVE  (14,12)       SAVE CALLERS REGISTERS                     47650002
         DROP  R12           DROP R12 AS BASE REGISTER                  47700002
         USING LOADVLCK,R15  USE ENTRY POINT AS BASE REGISTER           47750002
         L     R2,@4(R1)     PLACE ADDRESS IF MY SAVEAREA INTO R2       47800002
         LM    R3,R12,@32(R2) RELOAD MY REGISTERS FROM SAVEAREA         47850002
         DROP  R15           DROP R15 AS BASE REGISTER                  47900002
         USING BASELOC,R12   USE REG12 AS BASE REGISTER                 47950002
         L     R3,REGSAVE3   GET MY SAVE AREA ADDRESS FROM TCOMTAB      48000002
         ST    R13,@4(R3)    PLACE BACK POINTER INTO MY REG             48050002
         LR    R13,R3        POINT R13 TO MY REGISTERS SAVE             48100002
         SR    R14,R14       CLEAR REG 14                               48110002
         L     R4,OUTBUF     ACCESS OUTBUF                              48120002
         ST    R14,ZERO(R4)  CLEAR 1ST WORD OF OUTBUF                   48130002
         L     R10,@0(R1)    ACCESS ADDRESS OF PDE                      48150002
         USING PARDSECT,R10  ESTABLISH PDE ADDRESSABILITY               48200002
         L     R2,WORKAREA   ACCESS PTR TO WORKAREA                     48250002
         TM    FLAGS2,HEX80  TEST FOR PRESENCE OF MEMBERNAME            48300002
         BNO   INVLDMSG      BRANCH TO PUT OUT DIAGNOSTIC               48350002
         MVI   PASSWORD-TSTCWORK(R2),BLANK MOVE IN BLANK                48400002
         MVC   PASSWORD-TSTCWORK+@1(@7,R2),PASSWORD-TSTCWORK(R2) BLANK  48450002
         TM    FLAGS3,HEX80  TEST FOR PRESENCE OF PASSWORD              48500002
         BNO   GOPARSE       BRANCH TO RETURN                           48550002
         LH    R4,LENGTH3    ACCESS LENGTH OF PASSWORD                  48600002
         BCTR  R4,R0         DECREMENT FOR EXECUTE                      48650002
         L     R5,PSWRDPTR   ACCESS ADDR OF ADDR STRING                 48700002
         EX    R4,MOVEPASS   PUT PASSWOR IN WORKAREA                    48750002
GOPARSE  SR    R15,R15       ZERO RETURN CODE                           48760002
         B     A16030        BRANCH TO RETURN                           48800002
INVLDMSG EQU   *             PUT OUT DIAGNOSTIC MSG                     48850002
         LA    R2,M0048      MSG-MEMBER NAME MISSING                    48860002
         LA    R3,ZERO       NO SECOND LEVEL MESSAGE                    48862002
         BAL   R6,MSG1       GO OUTPUT MESSAGES                         48880002
         B     GOIO          GO CHECK RETURN CODE                       48890002
         SPACE                                                          49000002
ADDRVLCK EQU   *             FREEMAIN VALIDITY CHECK ROUTINE            49050002
         SAVE  (14,12)       SAVE REG                                   49100002
         DROP  R12           REMOVE REG12 AS BASE REG                   49150002
         USING ADDRVLCK,R15  USE REG15 AS BASE REG                      49200002
         L     R2,@4(R1)     PLACE ADDRESS OF MY SAVEAREA INTO R2       49250002
         LM    R3,R12,@32(R2) LOAD BACK MY REGISTERS FROM SAVEAREA      49300002
         DROP  R15           REMOVE REG15 AS BASE REG                   49350002
         USING BASELOC,R12   USE REG12 AS BASE REG                      49400002
         L     R3,REGSAVE3   GET MY SAVE AREA ADDRESS FROM TCOMTAB      49450002
         ST    R13,@4(R3)    PLACE BACK POINTER INTO MY REG             49500002
         LR    R13,R3        POINT R13 TO MY REGISTERS                  49550002
         SR    R14,R14       CLEAR REG 14                               49560002
         L     R4,OUTBUF     ACCESS OUTBUF                              49570002
         ST    R14,ZERO(R4)  CLEAR 1ST WORD OF OUTBUF                   49580002
         OI    TSTFLGS4,TSTVALCK SET VALIDITY FLAG ON FOR IO            49590002
         L     R10,@0(R1)    PLACE ADDRESS OF PDE INTO R10              49600002
         L     R2,WORKAREA   ACCESS PTR TO WORKAREA                     49650002
         LA    R3,@8(R1)     CREATE PTR TO PARSE PARAM                  49700002
         ST    R3,MSGADDR-TSTCWORK(R2) FUTURE PTR TO 2ND MSG            49750002
         USING IKJPARMA,R10    USE REG10 TO ADDRESS PDE                 49800002
A15000   EQU   *             EQUATE LABEL TO THIS ADDRESS               49850002
         TM    PDEFLG2,CTNAMFLG SEE IF ENTRY NAME WAS SPECIFIED         49900002
         BNO   A15001        IF NOT THEN ALL OK SO FAR                  49950002
         TM    PDEFLG4,SYMADDR+RELADDR TEST FOR SYMBOLIC/RELATIVE ADDR  50000002
         BM    A15010        IF ADDR THEN BRANCH                        50050002
         LA    R1,M0252      MSG-INVALID QUAL ADDR                      50060002
         B     ADDRMSG       BRANCH TO PUT ERROR MSG OUT                50150002
A15001   EQU   *             EQUATE LABEL TO THIS ADDRESS               50200002
         TM    PDEFLG4,SYMADDR  TEST FOR SYMBOLIC ADDR                  50250002
         BO    A15010        BRANCH IF SYMBOL SPECIFIED                 50300002
         TM    PDEFLG4,ABSCOMPL                                         50350002
         BZ    A15010        IF IT WAS THEN BRANCH TO GO TO CONVERT     50400002
A15002   EQU   *             EQUATE LABEL TO THIS ADDRESS               50450002
         TM    PDEFLG4,RELADDR  CHECK FORA A RELATIVE ADDRESS           50500002
         BNO   A15003        IF NOT RELATIVE THEN BRANCH                50550002
         B     A15010        BRANCH TO CONVERT ADDR AND CONTINUE        50600002
A15003   EQU   *             EQUATE LABEL TO THIS ADDRESS               50650002
         TM    PDEFLG4,GENR  CHECK FOR REGISTER NOTATION                50700002
         BNO   A15004        IF NOT REG NOTATION THEN BRANCH            50750002
         LH    R4,PDEINDCT   OTHERWISE LOAD INDIRECT COUNT INTO R4      50800002
         LTR   R4,R4         SEE IF INDIRECT COUNT WAS SPECIFIED        50850002
         BNZ   A16010        IF SPECIFIED THEN BRANCH ALL OK SO FAR     50900002
A15004   EQU   *             EQUATE LABEL TO THIS ADDRESS               50950002
         LA    R1,M0274      MSG-REG MUST BE INDRCT GEN REG             50960002
*                            THEREFORE LOAD ERROR MSG AND BRANCH        51050002
ADDRMSG  EQU   *             PREPARE INVALID ADDRESS MSG                51100002
         LA    R2,M0101      MSG-INVALID ADDRESS                        51110002
         LR    R3,R1         REG3 IS SECOND LEVEL MSG                   51120002
         LR    R4,R10        REG4 IS ADDRESS OF PDE                     51130002
         BAL   R6,MSG3       GO OUTPUT MESSAGES                         51140002
GOIO     L     R2,WORKAREA   ACCESS PTR TO WORKAREA                     51140402
         ST    R15,CODESAVE-TSTCWORK(R2) STORE RETURN CODE              51142002
         CH    R15,ATTNCODE  COMPARE RET CODE TO 16                     51192002
         LA    R15,@12       IF EQUAL RETURN CODE OF 16                 52600002
         BNL   A16030        IF RETURN CODE EQUAL 16                    52650002
         LA    R15,@8        TELL PARSE TO SIGNAL REENTER               52700002
A16030   EQU   *             EQUATE LABEL TO THIS ADDRESS               52750002
         L     R4,OUTBUF     ACCESS OUTBUF                              52760002
         L     R4,ZERO(R4)   ACCESS 1ST WORD OF OUTBUF                  52770002
         LTR   R4,R4         IS THERE A SECOND LEVEL MESSAGE            52780002
         BZ    PARSRET       NO, RETURN TO PARSE                        52790002
         L     R8,WORKAREA   ACCESS WORKAREA POINTER                    52792002
         L     R11,MSGADDR-TSTCWORK(R8) GET PTR TO PARSE PARM LIST      52794002
         MVC   @0(@4,R11),OUTBUF ADDR OF SECOND LEVEL MSG TO LIST       52796002
PARSRET  EQU   *             RETURN TO PARSE                            52798002
         NI    TSTFLGS4,HEXFF-TSTVALCK SHUT OFF VALIDITY FLAG           52798402
         L     R13,@4(R13)   RESTORE USER REG                           52800002
         L     R5,INBUF      PLACE INPUT BUFFER POINTER IN R5           52850002
         LA    R6,CWORKCMD-TSTCWORK(R2) COMMAND PORTION OFWORK @YM07111 52900002
        ST    R5,PPLCBUF-PPL(R6) RESTORE POINTER IN PARSE PARM LIST     52950002
         RETURN (14,12),RC=(15)     RETURN TO CALLER                    53000002
A16010   EQU   *             EQUATE LABEL TO THIS ADDRESS               53050002
A15010   EQU   *             EQUATE LABEL TO THIS ADDRESS               53100002
         LR    R1,R10        PALCE POINTER TO PDE INTO R1               53150002
*                            CONVERT TO LOCATE                          53200002
         LCR   R1,R1         LOAD COMPLIMENT OF R1 AS INDICATOR TO CVT  53250002
         L     R15,TSTCONVT  PLACE ADDR OF CONVERT INTO R15             53300002
         BALR  R14,R15       BRANCH TO CONVERT TO GET BINARY ADDR       53350002
         B     CONVTAB(R15)  BRANCH ACCORDING TO RETURN CODE            53400002
CONVTAB  B     CONTINUE      IF RETURN CODE = 0                         53450002
         B     CONVMSG       IF RETURN CODE = 4                         53500002
         B     SYMSTAE       IF RETURN CODE = 8                         53550002
         B     SYMSTAE       IF RETURN CODE = 12                        53600002
         B     SYMSTAE       IF RETURN CODE = 16                        53650002
         B     SYMSTAE       IF RETURN CODE = 20                        53700002
CONTINUE EQU   *             CONTINUE HERE IF RETURN CODE = 0           53750002
         L     R11,PDEUSER   ACCESS USERWORD                            53800002
         LTR   R11,R11       DETERMINE IF SYMBOLIC ADDR                 53850002
         LA    R11,@0(R11)   TURN HIERARCHY BIT                         53900002
         BH    RESCHK        USERWORD NOT FROM SYM, BRANCH              53950002
         L     R11,@0(R11)   ACCESS SYMBOL                              54000002
         ST    R11,PDEUSER   STORE ADDR IN USERWORD                     54050002
RESCHK   EQU   *             RESUME CHECK PROCEDURE                     54100002
         SR    R15,R15       PLACE ZERO RETURN CODE IN R15              54150002
         TM    PDEUSER+@3,HEX07 CHECK LOW ORDER BYTE OF BINARY          54200002
*                            ADDRESS FOR '000' TO SEE IF IT IS ON       54250002
*                            A DOUBLEWORD BOUNDARY                      54300002
         BZ    A16030        IF ZERO THEN IT IS ON AN INTEGRAL BDY      54350002
         LA    R2,M0101      MSG-INVALID ADDRESS                        54360002
         LA    R3,M0280      MSG-DOUBLEWORD BOUNDRY REQ.                54370002
         LR    R4,R10        ADDRESS INSERT TO REG4                     54380002
         LA    R5,I0004      DOUBLE-INSERT                              54382002
         BAL   R6,MSG4       GO OUTPUT MESSAGES                         54390002
         B     GOIO          GO CHECK RETURN CODE                       54392002
CONVMSG  EQU   *             ENTER HERE IF RETURN CODE = 4              54500002
         LA    R15,@8        SET RETURN CODE TO PARSE (PROMPT)          54550002
         B     A16030        RETURN TO PARSE                            54750002
SYMSTAE  EQU   *             ENTER HERE IF RETURN CODE = 20             55000002
         L     R8,WORKAREA   ACCESS PTR TO WORKAREA                     55050002
         ST    R15,CODESAVE-TSTCWORK(R8) STORE RETURN CODE              55100002
         LA    R15,@12       SET RETURN CODE TO PARSE                   55150002
         B     A16030        RETURN TO PARSE                            55200002
         EJECT                                                          55300002
* THE FOLLOWING ARE MESSAGE OUTPUTTING ROUTINES                         55310002
         SPACE                                                          55320002
MSG1     XC    TSTIOPRM,TSTIOPRM CLEAR PARAMETER AREA                   55330002
         IKJEGSIO MSG,FIRST=(R2),SECOND=(R3),ID=LDF17,                 *55340002
               MF=(E,TSTIOPRM)  CALL IO                                 55342002
         BR    R6            RETURN                                     55344002
         SPACE                                                          55346002
MSG2     XC    TSTIOPRM,TSTIOPRM CLEAR PARAMETER AREA                   55348002
         IKJEGSIO MSG,FIRST=(R2),INST11=(NUM,(R4)),SECOND=(R3),        *55348402
               ID=LDF17,MF=(E,TSTIOPRM)  CALL IO                        55348802
         BR    R6            RETURN                                     55349202
         SPACE                                                          55349602
MSG3     XC    TSTIOPRM,TSTIOPRM CLEAR PARAMETER AREA                   55349702
         IKJEGSIO MSG,FIRST=(R2),INST11=(APDE,(R4)),SECOND=(R3),       *55349802
               ID=LDF17,MF=(E,TSTIOPRM)  CALL IO                        55350002
         BR    R6            RETURN                                     55366602
         SPACE                                                          55376602
MSG4     XC    TSTIOPRM,TSTIOPRM CLEAR PARAMETER AREA                   55378602
         IKJEGSIO MSG,FIRST=(R2),INST11=(APDE,(R4)),SECOND=(R3),       *55380602
               INST21=(NUM,(R5)),ID=LDF17,MF=(E,TSTIOPRM) CALL IO       55381002
         BR    R6            RETURN                                     55383002
         SPACE                                                          55383102
MSG5     XC    TSTIOPRM,TSTIOPRM CLEAR PARAMETER AREA                   55383202
         IKJEGSIO MSG,FIRST=(R2),INST11=(REG,(R4)),ID=LDF17,           *55388802
               MF=(E,TSTIOPRM)  CALL IO                                 55390802
         BR    R6            RETURN                                     55392802
         SPACE                                                          55393202
MSG6     XC    TSTIOPRM,TSTIOPRM CLEAR PARAMETER AREA                   55393302
         IKJEGSIO MSG,FIRST=(R7),INST11=(NUM,(R4)),SECOND=(R5),        *55393402
               INST21=(ADDR,MSGINSHD-TSTCWORK(R2)),ID=LDF17,           *55395602
               MF=(E,TSTIOPRM)  CALL IO                                 55396002
         BR    R6            RETURN                                     55396502
         SPACE                                                          55398502
LINKFAIL LR    R2,R1         ABEND CODE TO REG 2                        55400202
         LR    R3,R15        RET CODE TO REG 3                          55403202
         XC    TSTIOPRM,TSTIOPRM CLEAR PARAMETER AREA                   55406202
         IKJEGSIO SVCERR,SVC=(R5),ABENDRG=(R2),RC=(R3),                *55411202
               INST11=(NUM,(R4)),ID=LDF17,MF=(E,TSTIOPRM)               55412202
TESTRC   L     R2,WORKAREA   ADDRESSABILITY TO WORKAREA                 55412302
         CLI   TASKSWF-TSTCWORK(R2),HEXFF  TEST FOR TASK SWITCH         55412602
         BE    STAEOFF       YES, RETURN VIA TSTSVC                     55413002
         CH    R15,ATTNCODE  IS RET CODE LESS THAN 16                   55414202
         BNL   RET           NO, RETURN TO MAINLINE                     55414602
         B     GOHOME        YES, RETURN TO MAINLINE, RC=0              55415002
         SPACE                                                          55418202
GETERR   LR    R3,R15        RET CODE TO REG 3                          55420602
         XC    TSTIOPRM,TSTIOPRM CLEAR PARAMETER AREA                   55421002
         IKJEGSIO SVCERR,SVC=(R4),RC=(R3),                             *55421402
               ID=LDF17,MF=(E,TSTIOPRM)  CALL IO                        55421802
         B     TESTRC        BRANCH TO TEST RET CODE                    55425502
         SPACE                                                          55437102
LOADFAIL LR    R3,R15        RET CODE TO REG 3                          55447102
         LR    R2,R1         ABEND CODE TO REG 2                        55457102
         XC    TSTIOPRM,TSTIOPRM  CLEAR PARAMETER AREA                  55459102
         IKJEGSIO SVCERR,SVC=8,ABENDRG=(R2),RC=(R3),                   *55461102
               ID=LDF17,MF=(E,TSTIOPRM)  CALL IO                        55463102
         B     TESTRC        BRANCH TO TEST RET CODE                    55465102
         SPACE                                                          55465502
SPLISTLD IKJEGSPL RTRY=RETRY,ABNTB=STAELOAD,MODNM=IKJEGLDF,            *55465902
               TNM=LOAD      BUILD ESTAE PARAMETER LIST                 55466302
SPLISTDL IKJEGSPL RTRY=RETRY,ABNTB=STAEDEL,MODNM=IKJEGLDF,             *55466402
               TNM=DELETE    BUILD ESTAE PARAMETER LIST                 55466502
SPLISTGT IKJEGSPL RTRY=RETRY,ABNTB=STAEGET,MODNM=IKJEGLDF,             *55466602
               TNM=GETMAIN   BUILD ESTAE PARAMETER LIST                 55477702
SPLISTFR IKJEGSPL RTRY=RETRY,ABNTB=STAEFREE,MODNM=IKJEGLDF,            *55487702
               TNM=FREEMAIN  BUILD ESTAE PARAMETER LIST                 55488102
         EJECT                                                          55555602
MEMMOVE  MVC   @4(@1,R11),@0(R6) MOVE NAME INTO LIST                    55566702
DELMOVE  MVC   CWORKCMD-TSTCWORK(@0,R2),@0(R5)  MOVE NAME TO WORKAREA   55577802
A13000   PACK  @0(@8,R2),@0(@1,R1) PACK INTEGER INTO WORKAREA           55588902
MOVEPASS MVC   PASSWORD-TSTCWORK(@1,R2),@0(R5) MOVE PASSWORD            55600002
MOVEDSN  MVC   @2(@1,R3),@0(R6) MOVE DSNAME FOR DEFAULT PARM BLOCK      55800002
         USING SYMDSECT,R7                                              55850002
SYMCOMP  CLC   SYMBOL(@1),@0(R8) COMPARE SYMBOLS                        55900002
SYMMVC   MVC   SYMBOL(@0),@0(R8) MOVE SYMBOL FROM PDE TO SYMTABLE       55950002
PCLGET   DC    V(IKJEGGTM)   ADDR OF PCL DSECT FOR GETMAIN              56000002
PARSEIT  DC    V(IKJEGFRL)   ADDR OF PCL DSECT FOR FREEMAIN             56050002
PARSEDEL DC    V(IKJEGDLT)   ADDR OF PCL CSECT FOR DELETE               56100002
LOADPARS DC    V(IKJEGLDP)   ADDR OF PCL CSECT FOR LOAD                 56150002
         SPACE 1                                                        56200002
BASE     DC    A(BASELOC)    ADCON WHICH CONTAINS BEGINNING ADDRESS     56250002
REGCODE  DC    X'FF000000'   CODE FOR SVC 97                            56300002
         DS    0F                                                       56350002
LSTDSCP  DC    X'0001004C'   LIST DESCRIPTOR FIELD FOR BLDL LIST        56400002
         DS    0F                                                       56450002
BYTEX04  DC    X'04000000'   CODE TO SVC 97                             56500002
BYTEX08  DC    X'08000000'   HEX 08 TO TEST MASK WITH                   56550002
BYTEX01  DC    X'01000000'   HEX 40 TO TEST MASK WITH                   56600002
DAIR2C   DC    X'002C'       CODE TO DAIR                               56850002
FLG2C    DC    X'0001'       DAIR FLAG TO INDICATE DDN NOT IN USE       56900002
ATTNCODE DC    H'16'         ATTENTION RETURN CODE                      56950002
TABLE    DC    C'0123456789ABCDEF'  TRANSLATE TABLE                     57000002
         SPACE 1                                                        57900002
GETLIST  GETMAIN MF=L        LIST FORM OF THE GETMAIN MACRO             57950002
LISTSIZE EQU   *-GETLIST     GET ACTUAL SIZE OF THE LIST                58000002
         SPACE 1                                                        58050002
MYDCB    DCB   DSORG=PO,MACRF=(R)                                       58100002
         SPACE 1                                                        58150002
CLFORM   CLOSE (CLFORM),MF=L                                            58200002
         SPACE 1                                                        58250002
LFORM    OPEN  (,(INPUT)),MF=L                                          58300002
         SPACE 3                                                        58310002
CONSTANT DC    60C'Z'        PATCH AREA                                 58320002
         EJECT                                                          58350002
************************************************************            58400002
*                                                          *            58450002
*                  PARSE MACROS FOR FREEMAIN               *            58500002
*                                                          *            58550002
************************************************************            58600002
IKJEGFRL IKJPARM  DSECT=A                                               58650002
         SPACE 1                                                        58700002
FREEMAN1 IKJIDENT 'NUMBER',FIRST=NUMERIC,OTHER=NUMERIC,PROMPT='INTEGER' 58750002
         SPACE 1                                                        58800002
FREEMAN2 IKJPOSIT ADDRESS,PROMPT='ADDRESS',VALIDCK=ADDRVLCK             58850002
         SPACE 1                                                        58900002
FREEMAN3 IKJKEYWD                                                       58950002
         SPACE 1                                                        59000002
         IKJNAME  'SP',SUBFLD=SUBPOOL                                   59050002
         SPACE 1                                                        59100002
SUBPOOL IKJSUBF                                                         59150002
         SPACE 1                                                        59200002
FREEMAN4 IKJIDENT 'NUMBER',FIRST=NUMERIC,OTHER=NUMERIC,                *59250002
               PROMPT='SUBPOOL NUMBER'                                  59260002
         SPACE 1                                                        59300002
         IKJENDP                                                        59350002
         EJECT                                                          59400002
************************************************************            59450002
*                                                          *            59500002
*                  PARSE MACROS FOR GETMAIN                *            59550002
*                                                          *            59600002
************************************************************            59650002
IKJEGGTM IKJPARM  DSECT=B                                               59700002
         SPACE 1                                                        59750002
GETMAIN1 IKJIDENT 'NUMBER',FIRST=NUMERIC,OTHER=NUMERIC,                *59800002
               MAXLNTH=8,PROMPT='INTEGER'                               59810002
         SPACE 1                                                        59850002
GETMAIN2 IKJKEYWD                                                       59900002
         SPACE 1                                                        59950002
GETMAIN3 IKJNAME  'SP',SUBFLD=GETMAIN4                                  60000002
         SPACE 1                                                        60050002
GETMAIN6 IKJKEYWD                                                       60100002
         SPACE 1                                                        60150002
GETMAIN7 IKJNAME    'EQUATE',SUBFLD=GETMAIN8                            60200002
         SPACE 1                                                        60250002
GETMAIN4 IKJSUBF                                                        60300002
         SPACE 1                                                        60350002
GETMAIN5 IKJIDENT 'NUMBER',FIRST=NUMERIC,OTHER=NUMERIC,                J60400002
               PROMPT='SUBPOOL NUMBER'                                  60450002
         SPACE 1                                                        60500002
GETMAIN8 IKJSUBF                                                        60550002
         SPACE 1                                                        60600002
GETMAIN9 IKJIDENT   'SYMBOL',FIRST=ALPHA,OTHER=ALPHANUM,               *60650002
               PROMPT='SYMBOL',MAXLNTH=8                                60660002
         SPACE 1                                                        60700002
         IKJENDP                                                        60750002
         EJECT                                                          60800002
************************************************************            60850002
*                                                          *            60900002
*                  PARSE MACROS FOR DELETE                 *            60950002
*                                                          *            61000002
************************************************************            61050002
IKJEGDLT IKJPARM  DSECT=C                                               61100002
         SPACE 1                                                        61150002
PARSE1   IKJIDENT 'NAME',FIRST=ALPHA,OTHER=ALPHANUM,                   X61200002
               PROMPT='PROGRAM NAME'                                    61250002
         SPACE 1                                                        61300002
         IKJENDP                                                        61350002
         EJECT                                                          61400002
************************************************************            61450002
*                                                          *            61500002
*                  PARSE MACROS FOR LOAD                   *            61550002
*                                                          *            61600002
************************************************************            61650002
IKJEGLDP IKJPARM  DSECT=D                                               61700002
         SPACE 1                                                        61750002
PARSE2   IKJPOSIT DSNAME,                                              J61800002
               PROMPT='PROGRAM NAME AS FULLY QUALIFIED DSNAME',        X61850002
               VALIDCK=LOADVLCK                                         61900002
         SPACE 1                                                        61950002
         IKJENDP                                                        62000002
         EJECT                                                          62050002
************************************************************            62100002
*                                                          *            62150002
*                           EQUATES                        *            62200002
*                                                          *            62250002
************************************************************            62300002
R0       EQU   0             REG.  0                                    62350002
R1       EQU   1             REG.  1                                    62400002
R2       EQU   2             REG.  2                                    62450002
R3       EQU   3             REG.  3                                    62500002
R4       EQU   4             REG.  4                                    62550002
R5       EQU   5             REG.  5                                    62600002
R6       EQU   6             REG.  6                                    62650002
R7       EQU   7             REG.  7                                    62700002
R8       EQU   8             REG.  8                                    62750002
R9       EQU   9             REG.  9                                    62800002
R10      EQU   10            REG. 10                                    62850002
R11      EQU   11            REG. 11                                    62900002
R12      EQU   12            REG. 12                                    62950002
R13      EQU   13            REG. 13                                    63000002
R14      EQU   14            REG. 14                                    63050002
R15      EQU   15            REG. 15                                    63100002
CHANGEO  EQU   97            SVC 97                                     63150002
HEX01    EQU   X'01'         X'01'                                      63200002
F0       EQU   X'F0'         X'F0'                                      63250002
B7       EQU   X'B7'         X'B7'                                      63300002
BLANK    EQU   X'40'         X'40'                                      63350002
ZERO     EQU   0             EQUATE ZERO TO 0                           63400002
@164     EQU   164           164                                        63450002
TWELVE   EQU   12            12                                         63500002
@64      EQU   64            64                                         63550002
@232     EQU   232           232                                        63600002
@20      EQU   20            20                                         63650002
SIXFOUR  EQU   64            64                                         63700002
TEN      EQU   10            10                                         63750002
ONE      EQU   1             1                                          63800002
@0       EQU   0             NO.  0                                     63850002
@1       EQU   1             NO.  1                                     63900002
@2       EQU   2             NO.  2                                     63950002
@3       EQU   3             NO.  3                                     64000002
@4       EQU   4             NO.  4                                     64050002
@5       EQU   5             NO.  5                                     64100002
@6       EQU   6             NO.  6                                     64150002
@7       EQU   7             NO.  7                                     64200002
@8       EQU   8             NO.  8                                     64250002
@9       EQU   9             NO.  9                                     64300002
@12      EQU   12            NO. 12                                     64350002
@13      EQU   13            NO. 13                                     64400002
@14      EQU   14            NO. 14                                     64450002
@16      EQU   16            NO. 16                                     64500002
@17      EQU   17            NO. 17                                     64550002
@152     EQU   152           NO. 152                                    64560002
@21      EQU   21            NO. 21                                     64600002
@22      EQU   22            NO. 22                                     64650002
@24      EQU   24            NO. 24                                     64700002
@26      EQU   26            NO. 26                                     64750002
@32      EQU   32            NO. 32                                     64800002
@33      EQU   33            NO. 33                                     64850002
@36      EQU   36            NO. 36                                     64900002
@38      EQU   38            NO. 38                                     64950002
@40      EQU   40            NO. 40                                     65000002
@43      EQU   43            NO. 43                                     65050002
@44      EQU   44            NO. 44                                     65100002
@52      EQU   52            NO. 52                                     65150002
@68      EQU   68            NO. 68                                     65200002
@76      EQU   76            NO. 76                                     65250002
@88      EQU   88            NO. 88                                     65300002
@92      EQU   92            NO. 92                                     65350002
@95      EQU   95            NO. 95                                     65400002
@96      EQU   96            NO. 96                                     65450002
@104     EQU   104           NO. 104                                    65460002
@108     EQU   108           NO. 108                                    65470002
@112     EQU   112           NO. 112                                    65480002
@116     EQU   116           NO. 116                                    65490002
@120     EQU   120           NO. 120                                    65492002
@124     EQU   124           NO. 124                                    65492402
@136     EQU   136           NO. 136                                    65494002
@140     EQU   140           NO. 140                                    65496002
@144     EQU   144           NO. 144                                    65498002
@148     EQU   148           NO. 148                                    65498402
@156     EQU   156           NO. 156                                    65498802
@240     EQU   240           NO. 240                                    65500002
FULLQUAL EQU   X'40'         X'40'                                      65550002
HEX00    EQU   X'00'         X'00'                                      65600002
HEX10    EQU   X'10'         X'10'                                      65650002
HEX08    EQU   X'08'         X'08'                                      65700002
HEX07    EQU   X'07'         X'07'                                      65750002
HEX20    EQU   X'20'         X'20'                                      65800002
HEXFF    EQU   X'FF'         X'FF'                                      65850002
HEX80    EQU   X'80'         X'80'                                      65900002
HEX40    EQU   X'40'         X'40'                                      65950002
HEX04    EQU   X'04'         X'04'                                      66000002
C8       EQU   C'8'          X'8'                                       66050002
PLUS     EQU   X'4E'         X'4E'                                      66100002
* THE FOLLOWING ARE FIRST LEVEL MESSAGE NUMB. EQUATES.                  66110002
M0045    EQU   45            UNABLE TO LOAD PROGRAM                     66120002
M0046    EQU   46            STORAGE AT ...                             66122002
M0047    EQU   47            0 BYTES IS INVAL CNT FOR GETMAIN           66130002
M0048    EQU   48            MEMBER NAME MISSING, RESPECIFY             66140002
M0049    EQU   49            ENTRY POINT AT ...                         66142002
M0058    EQU   58            ... FAILED                                 66144002
M0101    EQU   101           INVALID ADDRESS ...                        66146002
M0103    EQU   103           NOT ENOUGH MAIN STORAGE                    66148002
M0104    EQU   104           ... FAILED, COMMAND SYS. ERR.              66148402
* THE FOLLOWING ARE 2ND LEVEL MESSAGE NUMB. EQUATES.                    66148802
M0249    EQU   249           OPEN ERROR                                 66149202
M0250    EQU   250           BLDL ERROR CODE 4                          66149602
M0251    EQU   251           PROGRAM NOT ON LOAD LIST                   66149702
M0252    EQU   252           INVALID QUALIFIED ADDRESS                  66149802
M0253    EQU   253           SYSTEM ABEND CODE ...                      66149902
M0274    EQU   274           REG NOT. MUST BE INDRCT GEN REG            66166602
M0277    EQU   277           PARSE ERROR CODE 12                        66176602
M0280    EQU   280           DOUBLEWORD BOUNDARY REQUIRED               66178602
M0283    EQU   283           SVC 97 RET CODE NONZERO                    66180602
M0297    EQU   297           BLDL ERROR CODE 8                          66181002
* THE FOLLOWING ARE CONST MESSAGE INSERT EQUATES.                       66182602
I0004    EQU   4             DOUBLE                                     66182702
I0023    EQU   23            LOAD                                       66183002
I0024    EQU   24            DELETE                                     66183102
I0025    EQU   25            GETMAIN                                    66183202
I0026    EQU   26            FREEMAIN                                   66188802
I0040    EQU   40            IKJPARS                                    66190802
I0041    EQU   41            IKJDAIR                                    66192802
I0046    EQU   46            IKJDFLT                                    66193202
I0042    EQU   42            IKJEFF18                                   66193602
I0087    EQU   87            IKJEGLDF                                   66194002
I0094    EQU   94            ESTAE CODE FOR ABEND                       66194102
I0096    EQU   96            ESTAE CODE FOR ABEND                       66194202
I0099    EQU   99            ESTAE CODE FOR ABEND                       66194302
************************************************************            66194402
         EJECT                                                          66200002
************************************************************            75500002
*                                                          *            75550002
*                          TCOMTAB DSECT MACRO GENERATED   *            75600002
*                                                          *            75650002
************************************************************            75700002
TCOMTAB  TCOMTAB             MACRO THAT GENERATES TCOMTAB               75750002
         EJECT                                                          75800002
************************************************************            75850002
*                                                          *            75900002
*                         DCB DSECT                        *            75950002
*                                                          *            76000002
************************************************************            76050002
          DCBD  DEVD=DA       DCB DSECT                                 76100002
************************************************************            76150002
*                                                          *            76200002
*                    TMP DSECT                             *            76250002
*                                                          *            76300002
************************************************************            76350002
         IKJTPL                                                         76400002
************************************************************            76450002
*                                                          *            76500002
*                     PDE DSECT FOR PARSE                  *            76550002
*                                                          *            76600002
************************************************************            76650002
PARDSECT DSECT               DSECT DEFINING PDE FOR PARSE               76700002
DSNAMPTR DS    CL4           POINTER TO DSNAME                          76750002
LENGTH1  DS    CL2           LENGTH OF DSNAME                           76800002
FLAGS1   DS    CL1           FLAGS                                      76850002
RESERVE1 DS    CL1           NOT USED                                   76900002
MEMBERPT DS    CL4           POINTER TO MEMBER                          76950002
LENGTH2  DS    CL2           LENGTH OF MEMBER                           77000002
FLAGS2   DS    CL1           FLAGS                                      77050002
RESERVE2 DS    CL1           NOT USED                                   77100002
PSWRDPTR DS    CL4           POINTER TO PASSWORD                        77150002
LENGTH3  DS    CL2           LENGTH OF PASSWORD                         77200002
FLAGS3   DS    CL1           FLAGS                                      77250002
RESRVE3  DS    CL1           NOT USED                                   77300002
*                                                                       77350002
         DS    0F                                                       77400002
PRSDSECT DSECT               DSECT DEFINING DSECT FOR PARSE             77450002
DSNPTR   DS    CL4           POINTER TO DSNAME                          77500002
LEN2     DS    CL2           LENGTH OF DSNAME                           77550002
FLGS1    DS    CL1           FLAGS                                      77600002
RESRVE1  DS    CL1           NOT USED                                   77650002
************************************************************            77700002
*                                                          *            77750002
*       DSECT FOR PARAMETER CONTROL LIST PASSED TO PARSE   *            77800002
*                                                          *            77850002
************************************************************            77900002
         IKJPPL               DSECT DESCRIBING PCL TO BE PASSEC         77950002
         EJECT                                                          78000002
         IKJDAPL              DSECT FOR DAIR PARM BLOCK                 78050002
         IKJDAP08             DSECT FOR DAIR CODE 08                    78100002
         IKJDAP2C             DSECT FOR DAIR CODE 2C                    78150002
***********************************************************             78200002
*                                                         *             78250002
*       DSNAME DSECT POINTED TO BY DAIR ALLOCATION DSECT  *             78300002
*                                                         *             78350002
***********************************************************             78400002
DSNDSECT DSECT                                                          78450002
LENGTHDN DS   CL2             LENGTH OF DSNAME FOR DAIR                 78500002
NAME     DS   CL8             DSNAME FOR DAIR                           78550002
         EJECT                                                          78600002
************************************************************            78650002
*                                                          *            78700002
*                     REQUEST BLOCK DSECT                  *            78750002
*                                                          *            78800002
************************************************************            78850002
         IKJRB                RB DSECT                                  78900002
         EJECT                                                          78950002
         IKJDFPL                                                        79000002
         IKJDFPB                                                        79050002
************************************************************            79100002
*                                                          *            79150002
*                          TCB DSECT                       *            79200002
*                                                          *            79250002
************************************************************            79300002
TCBDSECT IKJTCB               DSECT FOR TCB                             79350002
        EJECT                                                           79400002
************************************************************            79450002
**                                                        **            79500002
**   PARSE PDE DSECT FOR GETMAIN ENTRY POINT              **            79550002
**                                                        **            79600002
************************************************************            79650002
IDENTGM  DSECT               DSECT FOR IDENT PDE                        79700002
STRNGPTR DS    A             POINTER TO INTEGER STRING                  79750002
LENDSNME DS    CL2           LENGTH OF INTERGER STRING                  79800002
FLAGS    DS    CL1           FLAGS                                      79850002
RESERVED DS    CL1           RESERVED                                   79900002
KEYWORD  DS    CL2           KEYWORD                                    79950002
EQUKYWD  DS    CL2           NUMBER OF KEYWORDS                         80000002
SPOINTER DS    A             POINTER TO SUBPOOL INTEGER                 80050002
SPLENGTH DS    CL2           LENGTH OF SP INTEGER                       80100002
SPFLAGS  DS    CL1           FLAGS                                      80150002
SPRES    DS    CL1           RESERVED                                   80200002
EQUPTR   DS    A             PTR TO EQUATE SYMBOL                       80250002
EQULEN   DS    H             LENGTH OF SYMBOL                           80300002
EQUFLG   DS    X             FLAGS                                      80350002
EQURES   DS    X             RESERVED                                   80400002
*                                                                       80450002
         DS    0F                                                       80500002
SYMDSECT DSECT               DSECT FOR SYMBOL TABLE                     80550002
CHAIN    DS    A             PTR TO NEXT SYMTABLE ENTRY                 80600002
ADDRSYM  DS    A             ADDRESS                                    80650002
ATTRTYPE DS    X             TYPE                                       80700002
ATTRMULT DS    CL3           MULT                                       80750002
ATTRLNTH DS    H             LENGTH                                     80800002
SYMLNGTH DS    H             LENGTH OF SYMBOL                           80850002
SYMBOL   DS    CL8           SYMBOL                                     80900002
************************************************************            80950002
**                                                        **            81000002
**      PARSE PDE DSECT FOR FREEMANI ENTRY POINT          **            81050002
**                                                        **            81100002
************************************************************            81150002
IDENTFM  DSECT               DSECT FOR FREEMAIN PARSE PDE               81200002
COREPTR  DS    A             POINTER TO INTEGER                         81250002
LENGTHFM DS    CL2           LENGTH OF INTEGER                          81300002
FLAGSFM  DS    CL1           FLAGS                                      81350002
RESFM    DS    CL1           RESERVED                                   81400002
         IKJPARMA            ADDRESS PDE FOR PARSE                      81450002
         EJECT                                                          81500002
TSTCWORK TSTCWORK                                                       81550002
DDNSAVE  EQU   CWORKCMD+@68                                             81552002
DAIR     EQU   CWORKCMD+@76                                             81554002
PASSWORD EQU   CWORKCMD+@96                                             81556002
CODESAVE EQU   CWORKCMD+@104                                            81558002
MSGHOLD  EQU   CWORKCMD+@108                                            81558402
MSGHOLD2 EQU   CWORKCMD+@112                                            81558802
MSGADDR  EQU   CWORKCMD+@116                                            81559202
PARMDRFL EQU   CWORKCMD+@120                                            81559602
MIDHOLD  EQU   CWORKCMD+@140                                            81559702
TMPRETC  EQU   CWORKCMD+@144                                            81559802
TMPCIDP  EQU   CWORKCMD+@148                                            81559902
TASKSWF  EQU   CWORKCMD+@152                                            81561902
DSNMEPTR EQU   CWORKCMD+@156                                            81563202
* THE FOLLOWING IS A FORMATTED MESSAGE INSERT FOR IO.                   81613202
* THE SAME AREA IS USED AS FOR THE DAIL FAIL PARAMETER LIST.            81663202
MSGINSHD EQU   CWORKCMD+@120 MESSAGE INSERT HEADER                      81713202
MSGINSRT EQU   CWORKCMD+@124 MESSAGE INSERT ITSELF                      81763202
IKJEGLDF CSECT                                                          82000002
         DS    0F             FOR ALIGNMENT PURPOSES                    82050002
STAELOAD DC   AL1(I0099)      STAE CODE                                 82100002
         DC   AL3(BLOW1)      RESUME ADDRESS                            82150002
         DC   AL1(I0099)      STAE CODE FOR DAIR LINK                   82200002
         DC   AL3(BLOW2)      RESUME ADDRESS                            82250002
         DC   AL1(I0096)      STAE CODE                                 82300002
         DC   AL3(BLOW3)      RESUME ADDRESS                            82350002
         DC   AL1(I0094)      STAE CODE                                 82400002
         DC   AL3(BLOW4)      RESUME ADDRESS                            82450002
         DC   AL1(I0094)      STAE CODE                                 82500002
         DC   AL3(BLOW8)      RESUME ADDRESS                            82550002
         DC    AL1(I0099)     STAE CODE FOR DAIR LINK                   82600002
         DC    AL3(BLOW9)     RESUME ADDRESS                            82650002
         DC    AL1(I0099)     STAE CODE FOR DEFAULT LINK                82700002
         DC    AL3(BLOW10)    RESUME ADDRESS                            82750002
         DC   X'FF'           END OF TABLE INDICATION                   82800002
         DS   0F              FOR ALIGNMENT PURPOSES                    82850002
STAEDEL  DC   AL1(I0099)      STAE CODE                                 82900002
         DC    AL3(BLOW1)     RESUME ADDRESS                            82950002
         DC   AL1(I0094)      STAE CODE                                 83000002
         DC   AL3(BLOW8)      RESUME CODE                               83050002
         DC   X'FF'           END OF TABLE INDICATOR                    83100002
         DS   0F              FOR ALIGNMENT PURPOSES                    83150002
STAEGET  DC   AL1(I0099)      STAE CODE                                 83200002
         DC    AL3(BLOW1)     RESUME ADDRESS                            83250002
         DC   AL1(I0094)      STAE CODE                                 83300002
         DC   AL3(BLOW8)      RESUME ADDRESS                            83350002
         DC   X'FF'           END OF TABLE INDICATOR                    83400002
         DS   0F              FOR ALIGNMENT PURPOSES                    83450002
STAEFREE DC   AL1(I0099)      STAE CODE                                 83500002
         DC    AL3(BLOW1)     RESUME ADDRESS                            83550002
         DC   AL1(I0094)      STAE CODE                                 83600002
         DC   AL3(BLOW8)      RESUME ADDRESS                            83650002
         DC   X'FF'           END OF TABLE INDICATOR                    83700002
LOADQUAL DC   CL8'LOAD'       FOR DEFAULT PARM BLOCK                    83750002
         DS   0F              FOR ALIGNMENT PURPOSES                    83800002
LISTSTAE ESTAE MF=L           LIST FORM OF ESTAE                        83810002
STAELEN  EQU   *-LISTSTAE     LENGTH OF LIST FORM OF ESTAE              83860002
SUBPOOL2 EQU  *                                                         83900002
         DC   AL1(0)          SUBPOOL NUMBER                            83950002
         DC   AL3(104)        LENGTH TO BE FREED                        84000002
ARETRY   DC   A(RETRY)        ADDRESS OF STAE RETRY RTN                 84050002
ARETRY1  EQU   ARETRY+@1                                                84100002
SYMPARM  DC    X'04'          DITTO                                     84150002
         DC    X'000001'      DITTO                                     84200002
         DC    H'4'           DITTO                                     84250002
PARMSIZE EQU   *-SYMPARM                                                84300002
         EJECT                                                          84350002
         CVT   DSECT=YES                                                84400002
         END                                                            84450002
./  ADD  SSI=81810258,NAME=IKJEGLDR
         TITLE 'TEST LOADER       IKJEGLDR'                             00050002
         COPY  IKJEGSIO                                                 00054002
IKJEGLDR CSECT                                                          00060002
         EJECT                                                          00100002
*********************************************************************** 00150002
*                                                                       00200002
* STATUS --                                                             00250002
*    CHANGE LEVEL 00, VERSION NO. 02, VS2   02/27/73                    00300002
*                                                                       00350002
* FUNCTION -- IKJEGLDR LOADS THE PROGRAM TO BE TESTED                   00400002
*                                                                       00450002
*    IKJEGLDR IS ATTACHED BY THE TEST INITIALIZATION                    00500002
*    ROUTINE, IKJEGINT.  IT IS PASSED AS AN INPUT PARAMETER THE         00550002
*    ADDRESS OF THE TCOMTAB IN REGISTER ONE.  AFTER SAVING              00600002
*    REGISTERS AND SETTING PROGRAM ADDRESSABILITY, IT PICKS UP          00650002
*    FROM THE TCOMTAB THE ADDRESS OF THE PARSE DESCRIPTOR LIST          00700002
*    FOR THE TEST COMMAND.  IT THEN CHECKS TO SEE WHETHER THE           00750002
*    INPUT IS A LOAD MODULE OR AN OBJECT MODULE.  WHEN THE INPUT        00800002
*    IS A LOAD MODULE, THE PROCESSING BY THE OS/VS2 LOADER AS           00850002
*    DESCRIBED IN THE FOLLOWING PARAGRAPH IS SKIPPED.                   00900002
*                                                                       00950002
*    IF THE INPUT IS AN OBJECT MODULE, IKJEGLDR GETS CORE               01000002
*    AND BUILDS A PARAMETER LIST FOR THE OS/VS2 LOADER (HEWLOAD).YM1030 01050002
*    IKJEGLDR THEN LOADS THE LOADER AND BRANCHES TO IT.  IF THERE       01100002
*    IS AN ERROR DURING LOADER PROCESSING, THEN CONTROL IS              01150002
*    RETURNED TO OS/VS2.  IF THERE ARE NO ERRORS, THEN THE LOADER       01200002
*    IS DELETED AND THE PARAMETER LIST CORE FREED.                      01250002
*                                                                       01300002
*    ONCE HEWLOAD HAS COMPLETED, IF REQUIRED, IKJEGLDR           YM1030 01350002
*    CHECKS TO SEE IF THE PROBLEM PROGRAM IS A COMMAND PROCESSOR,       01400002
*    AS DESCRIBED BY THE PDE FOR THE CP OPERAND OF THE TEST             01450002
*    COMMAND.  IF SO, IKJEGIO IS CALLED IN ORDER TO GET A COMMAND       01500002
*    FROM THE USER.  ONCE THE COMMAND IS RECEIVED, CORE IS GOTTEN       01550002
*    FOR A COMMAND PROCESSOR PARAMETER LIST (CPPL) AND THE LIST         01600002
*    IS BUILT.  NEXT, THE COMMAND SCAN SERVICE ROUTINE (IKJSCAN)        01650002
*    IS CALLED TO PROCESS THE VERB FIELD OF THE COMMAND IN ORDER        01700002
*    TO SIMULATE THE CONDITIONS THAT WOULD HAVE OCCURRED IF THE         01750002
*    COMMAND HAD BEEN RECEIVED BY THE TMP.  IKJEGLDR THEN               01800002
*    BRANCHES TO THE LOCATION AT WHICH A PSEUDO BREAK POINT IS          01850002
*    INSERTED INTO THE PROBLEM PROGRAM, AS DESCRIBED BELOW.             01900002
*                                                                       01950002
*    IF THE PROBLEM PROGRAM IS NOT A COMMAND PROCESSOR, THEN            02000002
*    INSTEAD OF GETTING A COMMAND FROM THE USER, IKJEGLDR BUILDS        02050002
*    A PARAMETER LIST IN THE STANDARD OS/VS2 FORMAT.  IF THE USER       02100002
*    SPECIFIES PARAMETER DATA ON THE TEST COMMAND, THEN THIS DATA       02150002
*    IS PLACED INTO THE LIST.  IF NO DATA IS FURNISHED, A               02200002
*    PARAMETER LIST WITH A LENGTH OF FOUR CONTAINING ALL ZEROES         02250002
*    IS CONSTRUCTED.                                                    02300002
*                                                                       02350002
*    ONCE THE PARAMETER LIST HAS BEEN CONSTRUCTED, WHETHER              02400002
*    IT IS A COMMAND PROCESSOR OR STANDARD OS/VS2 LIST, IKJEGLDR        02450002
*    CALLS IKJEGS9G IN ORDER TO PLACE THE ADDRESS OF THE TCOMTAB        02500002
*    INTO THE PROBLEM PROGRAM TCB AND TO TURN ON THE TCBTCP BIT         02550002
*    IN THE TCB.  UPON RETURN FROM IKJEGS9G, IKJEGLDR FINDS THE         02600002
*    ENTRY POINT OF THE PROBLEM PROGRAM BY SEARCHING THE CONTENTS       02650002
*    DIRECTORY ENTRIES.  ONCE THE ENTRY POINT HAS BEEN FOUND, THE       02700002
*    FIRST TWO BYTES OF USER CODE ARE SAVED IN THE TSTGO FIELD OF       02750002
*    THE TCOMTAB AND A SVC 97 IS PLACED INTO THE PROBLEM                02800002
*    PROGRAM.  THIS IS DONE SO THAT WHEN IKJEGLDR XCTLS TO THE          02850002
*    PROGRAM, SVC 97 WILL GET CONTROL AND POST THE INITIALIZATION       02900002
*    ROUTINE.  THUS, THE PROBLEM PROGRAM WILL THEN BE INITIALIZED       02950002
*    WITH THE STANDARD TEST FORMAT, WHICH IS A PRB FOR THE              03000002
*    PROBLEM PROGRAM CHAINED TO AN SVRB FOR SVC 97.  ONCE THE           03050002
*    PSEUDO BREAK POINT IS ESTABLISHED, IKJEGLDR XCTLS TO THE           03100002
*    PROBLEM PROGRAM.                                                   03150002
*                                                                       03200002
* ENTRY POINTS --                                                       03250002
*    IKJEGLDR                                                           03300002
*                                                                       03350002
* INPUT --                                                              03400002
*    TEST COMMUNICATION TABLE POINTED TO BY REGISTER 1.                 03450002
*                                                                       03500002
*    TPL POINTED TO BY TPLPTR IN TCOMTAB                                03550002
*                                                                       03600002
*    THE DCB OPENED BY IKJEGINT IS HUNG FROM TSTDCB IN TCOMTAB          03650002
*                                                                       03700002
*    THE BLDL ENTRY GOTTEN BY IKJEGINT IS LOCATED AT BLDLAREA           03750002
*    BLDLAREA IS EQUATED TO CONAREA IN TCOMTAB                          03800002
*                                                                       03850002
*    THE PDL(PARAMETER DISCRIPTOR LIST) IS PASSED AT TSTANSPL           03900002
*    IN TCOMTAB                                                         03950002
*                                                                       04000002
* OUTPUT --                                                             04050002
*    REGISTER 1 POINTS TO THE PARAMETER LIST BUILT FOR THE PROGRAM      04100002
*    TO BE TESTED.                                                      04150002
*    REGISTER 15 CONTAINS A RETURN CODE.                                04200002
*                                                                       04250002
* EXTERNAL REFERENCES --                                                04300002
*         IKJEGIO- TO WRITE DIAGNOSTIC MESSAGES TO THE TERMINAL IN      04350002
*         THE CASE OF ERROR.                                            04400002
*                                                                       04450002
* EXITS, NORMAL --                                                      04500002
*         XCTL TO THE EPA OF THE PROGRAM TO BE TESTED.                  04550002
*                                                                       04600002
* EXITS, ERROR --                                                       04650002
*         RETURN VIA REGISTER 14.                                       04700002
*           RC=0 ERROR OCCURRED                                         04710002
*           RC=4 ATTENTION OCCURRED                                     04720002
*           RC=20 ESTAE ERROR EXIT ENTERED                              04730002
*           RC=24 ESTAE MACRO ERROR                                     04740002
*                                                                       04750002
* TABLES/WORKAREAS --                                                   04800002
*    TCOMTAB POINTED TO BY REG 9, IS TEST'S COMMUNICATION TABLE         04850002
*                                                                       04900002
*    TPL POINTED TO BY REGISTER 10 IS THE TEST PARAMETER LIST           04950002
*                                                                       05000002
*    PDL POINTED TO BY TSTANSPL IN TCOMTAB                              05050002
*                                                                       05100002
*    WORKAREA POINTED TO BY TCOMTAB IS THE GENERAL W.A. FOR ALL OF TEST 05150002
*                                                                       05200002
* ATTRIBUTES --                                                         05250002
*    RE-ENTRANT                                                         05300002
*    REFRESHABLE                                                        05350002
*                                                                       05400002
* CHARACTER CODE DEPENDENCY --                                          05450002
*    NONE                                                               05500002
*                                                                       05550002
* NOTES --                                                              05600002
*    REGISTER CONVENTIONS FOR LOADER ARE AS FOLLOWS                     05650002
*    REG 9  TCOMTAB POINTER                                             05700002
*    REG 10 TPL POINTER                                                 05750002
*    REG 11 ONLY USED FOR LINK REGISTER                                 05800002
*    REG 12 IS THE BASE REGISTER                                        05850002
*    REG 6  IS FOR MAINTENANCE                                          05900002
*                                                                       05950002
**************************CHANGE ACTIVITY****************************** 05960000
*    @ZA15329 - NEAR LABEL SETPSUED TCBTCP FLAG ZEROED WHEN INVALID.  * 05970000
*                                                                     * 05980000
*********************************************************************** 06000002
         EJECT                                                          06050002
*        EQUATES AND CONSTANTS                                          06100002
         SPACE                                                          06150002
LOAD     EQU   1                                                        06200002
DCBLEN   EQU   96                                                       06250002
CP       EQU   1                                                        06300002
X0       EQU   0              HEXIDECIMAL 0                             06350002
X1       EQU   1              HEXIDECIMAL 1                             06400002
X2       EQU   2              HEXIDECIMAL 2                             06450002
X3       EQU   3              HEXIDECIMAL 3                             06500002
X4       EQU   4              HEXIDECIMAL 4                             06550002
X5       EQU   5              HEXIDECIMAL 5                             06600002
X6       EQU   6              HEXIDECIMAL 6                             06650002
X7       EQU   7              HEXIDECIMAL 7                             06700002
X8       EQU   8              HEXIDECIMAL 8                             06750002
X9       EQU   9              HEXIDECIMAL 9                             06800002
N12      EQU   12             TWELVE.                                   06850002
N15      EQU   15             FIFTEEN.                                  06900002
BLANK    EQU   X'40'          BLANK.                                    06950002
X40      EQU   X'40'          HEXIDECIMAL '40'                          07000002
XFF      EQU   X'FF'          HEXIDECIMAL 'FF'                          07050002
N22      EQU   22             TWENTY TWO.                               07100002
N24      EQU   24             TWENTY FOUR.                              07150002
N25      EQU   25             TWENTY FIVE.                              07200002
N28      EQU   28             TWENTY EIGHT.                             07250002
N44      EQU   44             FORTY FOUR.                               07300002
N48      EQU   48             FORTY EIGHT.                              07350002
N50      EQU   50             FIFTY.                                    07400002
N96      EQU   96             NINETY SIX.                               07450002
N98      EQU   98             NINETY EIGHT.                             07500002
MINORBIT EQU   X'04'          MINOR BIT IN CDE ATTR 1.                  07550002
NOSYNTAX EQU   X'80'         NO SYNTAX CHECK                            07560002
ATTNBIT  EQU   B'01000000'    TO TEST IF ATTENTION HAS BEEN ENTERED     07600002
ZERO     EQU   0              USED IN CONJUNCTION WITH ATTN TEST        07610002
R0       EQU   0              REGISTER 0                                07650002
R1       EQU   1              REGISTER 1                                07700002
R2       EQU   2              REGISTER 2                                07750002
R3       EQU   3              REGISTER 3                                07800002
R4       EQU   4              REGISTER 4                                07850002
R5       EQU   5              REGISTER 5                                07900002
R6       EQU   6              REGISTER 6                                07950002
R7       EQU   7              REGISTER 7                                08000002
R8       EQU   8              REGISTER 8                                08050002
R9       EQU   9              REGISTER 9                                08100002
R10      EQU   10             REGISTER 10                               08150002
R11      EQU   11             REGISTER 11                               08200002
R12      EQU   12             REGISTER 12                               08250002
R13      EQU   13             REGISTER 13                               08300002
R14      EQU   14             REGISTER 14                               08350002
R15      EQU   15             REGISTER 15                               08400002
RC20     EQU   20            RETURN CODE 20                             08410002
RC24     EQU   24            RETURN CODE 24                             08420002
         EJECT                                                          08450002
         SAVE  (14,12),,*                                               08700002
         LR    R12,R15        LOAD R12 AS BASE REGISTER                 08750002
         USING IKJEGLDR,R12   ESTABLISH ADDRESSABILITY                  08800002
         LR    R9,R1          R9=TCOMTAB ADDRESS.                       08850002
         USING TCOMTAB,R9     TCOMTAB ADDRESSABILITY.                   08900002
         LR    R4,R13         R4=BACK POINTER.                          08950002
         L     R13,REGSAVE2   R13=NEW REGSAVE AREA ADDR.                09000002
         ST    R4,X4(R13)     STORE BACK POINTER IN NEW AREA.           09050002
         ST    R13,X8(R4)     STORE FORE POINTER IN OLD AREA.           09100002
         L     R2,WORKAREA   R2=ADDR OF WORK AREA                       09110002
         USING TSTCWORK,R2   ESTABLISH ADDRESSABILITY                   09120002
         XC    LDRESTAE,LDRESTAE CLEAR ESTAE PARM LIST                  09130002
         L     R15,TSTSTAE   R15=ADDR OF ESTAE EXIT ROUTINE             09132002
         ESTAE (R15),CT,PARAM=LDRSPL,XCTL=NO,RECORD=YES,               *09140002
               MF=(E,LDRESTAE) ESTABLISH ESTAE EXIT                     09142002
         DROP  R2                                                       09144002
         LTR   R15,R15       WAS ESTAE SUCCESSFUL?                      09146002
         BZ    LDR1          YES,CONTINUE                               09148002
         STC   R15,TSTESTRC  NO,STORE RETURN CODE                       09148402
         LA    R15,RC24      RC=24 IS ESTAE FAILURE                     09148802
         B     RETURN        RETURN TO INITIALIZATION                   09149202
LDR1     EQU   *                                                        09149602
         USING ECT,R2         ECT ADDRESSABILITY.                       09150002
         L     R8,TSTANSPL    R8=ADDR OF PASSED PDL.                    09200002
         USING IKJPARMD,R8    *                                         09250002
         L     R3,CVTPTR      GET CVT ADDRESS                           09300002
         USING CVT,R3                                                   09350002
         L     R4,CVTTCBP     GET TCB WORDS ADDRESS                     09400002
         L     R7,X4(R4)      GET CURRENT TCB ADDRESS                   09450002
         ST    R7,PPTCB       INITIALIZE THE PPTCB IN TCOMTAB           09500002
         L     R10,TPLPTR     GET TPL ADDRESS                           09550002
         USING TPL,R10         TPL ADDRESSABILITY                       09600002
         ST    R7,TPLCTCB     INITIALIZE TPL ATTACHED TCB SLOT          09650002
         L     R2,TPLECT      ECT POINTER.                              09700002
         XC    ECTRCDF(X2),ECTRCDF  ZERO RTN CD                         09750002
         SPACE                                                          09800002
*        IF LOAD KEYWORD SPECIFIED, THEN FETCH WILL LOAD.               09850002
*        ELSE, IT WAS OBJECT WHICH WAS SPECIFIED, IN WHICH CASE         09900002
*        THE OSLOADER IS USED TO DO THE LOAD.                           09950002
         SPACE                                                          10000002
         CLI   LOADOBJ+X1,LOAD Q.IS 'LOAD' SPECIFIED.                   10050002
         BNE   OSLOAD         NO,USE OS LOADER.                         10100002
*                             YES,USE PROGRAM FETCH.                    10150002
         L     R4,TSTDCB      GET THE DCB ADDRESS - 4                   10200002
         LA    R4,X4(R4)      GET THE DCB ADDRESS.                      10250002
         L     R5,BLDLAREA    GET THE BLDL ENTRY ADDRESS.               10300002
         L     R2,TPLECT      ECT POINTER.                              10350002
         MVC   ECTPCMD(L'ECTPCMD),X4(R5)  PUT MEMBER NAME IN ECT.       10400002
         SPACE                                                          10450002
*        WAS CP SPECIFIED, IF YES THEN PROMPT FOR THE COMMAND.          10500002
*        IF NO, THEN PROCEED.                                           10550002
         SPACE                                                          10600002
PARMSET  EQU   *                                                        10650002
         CLI   CPNOCP+X1,CP    Q.IS 'CP' SPECIFIED.                     10700002
         BE    CMDPRMPT       YES,REQUEST A COMMAND.                    10750002
         SPACE                                                          10800002
*        IF A PARM STRING WERE ENTERED, GET A BUFFER AND FILL IT.       10850002
*        OTHERWISE , PROCEED                                            10900002
         SPACE                                                          10950002
         NC    STRING+X1(X3),STRING+X1  PARM STRING SPECIFIED Q.        11000002
         BNZ   PARMSTRG       YES,SET UP PARMS.                         11050002
         GETMAIN RC,LV=8      GET STORAGE FOR PARMLIST.                 11100002
         LTR   R15,R15        WAS GETMAIN SUCCESSFUL                    11120002
         BNZ   GETMERR        NO. ISSUE MESSAGES AND TERMINATE          11130002
         LA    R3,X4(R1)      PARMS ADDR.                               11150002
         SR    R4,R4          EMPTY LIST.                               11200002
         O     R3,HIGHBIT     INDICATE LAST ELEMENT OF LIST.            11250002
         STM   R3,R4,X0(R1)   INITIALIZE EMPTY LIST                     11300002
         LR    R7,R1          SAVE THE PARAMETER LIST ADDRESS.          11350002
GOPP     EQU   *                                                        11400002
         BAL   R11,SETTRN     TCBTCP BIT=1 TCBTRNB=TCOMTAB ADDRESS.     11450002
         L     R2,TPLECT      ECT POINTER                               11500002
         LA    R3,ECTPCMD     POINTER TO THE MEMBER NAME.               11550002
         L     R4,TSTTCB      THIS IS THE JOB STEP TCB.                 11600002
         SPACE                                                          11650002
*        IF THE MODULE IS ALREADY IN CORE , SET A PSUEDO BREAKPT.       11700002
*        IF IT IS NOT IN CORE , WHICH IS THE 99.9999 PERCENT CASE,      11750002
*        THE BREAK POINT WILL BE SET BY THE IKJEGINT MODULE             11800002
*        AFTER BEING POSTED BY SVC 61.                                  11850002
         SPACE                                                          11900002
         XR    R1,R1                                                    11950002
         L     R1,TCBJPQ-TCB(R4)  FIRST CDE.                            12000002
         USING CDENTRY,R1                                               12050002
CDELOOP  EQU   *                                                        12100002
         LA    R1,X0(R1)      CLEAR HIGH ORDER BYTE                     12150002
         LR    R2,R1          COPY CDE ADDRESS INTO REG TWO             12160002
         LTR   R1,R1          IS IT THE END OF CDE'S                    12200002
         BZ    LLSLOOK        LOOK ON THE LOAD LIST...                  12250002
         CLC   CDNAME(L'CDNAME),X0(R3)  CHECK THE NAME.                 12300002
         BE    SETPSEUD          FOUND A MATCH.                         12350002
         L     R1,CDCHAIN     GET THE NEXT CDE ADDRESS                  12400002
         B     CDELOOP        LOOP.......                               12450002
LLSLOOK  EQU   *                                                        12500002
         L     R1,TCBLLS-TCB(R4)  GET LOAD LIST BEGIN.                  12550002
         USING LLE,R1                                                   12600002
         USING CDENTRY,R2      ESTABLISH ADDRESSABILITY FOR CDE         12650002
LLSLOOP  EQU   *                                                        12700002
         LTR   R1,R1          CHECK FOR END OF LOAD LIST.               12750002
         BZ    OUT            NOFIND GET OUT.                           12800002
         LM    R1,R2,LLECHN   R1=NEXT ENTRY...R2=CDE PTR.               12850002
         CLC   CDNAME(L'CDNAME),X0(R3)  SEE IF NAME IS IN CORE.         12900002
         BNE   LLSLOOP        NO FIND LOOP.....                         12950002
SETPSEUD EQU   *              *                                         13000002
         L     R1,CDENTPT        GET THE ENTRY POINT.                   13050002
         MVC   TSTGOPSW(X2),X0(R1)  SAVE THE INSTR.                     13100002
         MVC   X0(X2,R1),TSTSVC  SET THE PSEUDO BREAK POINT.            13150002
         MVI   DEFERTAB,X0    SET TRN TO ZERO              @ZA15329     13170000
         DROP  R2             FREE BASE REGISTER USED FOR CDE           13200002
         USING ECT,R2         ESTABLISH ADDRESSABILITY FOR ECT          13250002
OUT      EQU   *                                                        13300002
         L     R15,WORKAREA   ADDR OF XCTL LIST FORM FOR XCTL.          13350002
         MVC   X0(XCTLLEN,R15),XCTLFORM  *                              13400002
         OI    TSTFLGS3,TSTGOSW    SET SPECIAL PSEUDO BP SWITCH.        13450002
         CLI   LOADOBJ+X1,LOAD  LOAD OR OBJECT...                       13500002
         LR    R1,R7          PARMAMETER LIST TO REGISTER ONE...        13550002
         L     R13,X4(R13)    FIX UP REGISTER 13 FOR PP                 13600002
         BNE   XCTLOBJ        OBJECT...                                 13650002
         BAL   R14,ATNCHK     GO SEE IF AN ATTENTION WAS POSTED         13660002
         L     R4,TSTDCB      GET THE DCB ADDRESS - 4                   13700002
         LA    R4,X4(R4)      GET THE DCB ADDRESS.                      13750002
         L     R5,BLDLAREA    GET THE BLDL ENTRY ADDRESS.               13800002
         LA    R5,X4(R5)           OFFSET INTO BLDL ENTRY.              13850002
         XC    N28(N44,R13),N28(R13)  ZERO REGS FOR PROTECTION.         13900002
         XCTL  (2,12),DCB=(R4),DE=(R5),SF=(E,(15))                      13950002
         EJECT                                                          14000002
XCTLOBJ  EQU   *                                                        14050002
         BAL   R14,ATNCHK     GO SEE IF AN ATTENTION WAS POSTED         14060002
         XC    N28(N44,R13),N28(R13)  ZERO REGS FOR PROTECTION.         14100002
         XCTL  (2,12),EPLOC=(3),SF=(E,(15))                             14150002
         SPACE                                                          14200002
         SPACE                                                          14250002
CMDPRMPT EQU   *                                                        14300002
*        REQUEST A COMMAND FOR THE PROGRAM BEING TESTED.                14350002
         SPACE                                                          14400002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM LIST         14450002
* ISSUE 'ENTER COMMAND FOR CP' MESSAGE AND GET INPUT                    14500002
         IKJEGSIO PTGT,FIRST=M0070,ID=LDR18,MF=(E,TSTIOPRM)             14510002
         LTR   R15,R15        TEST FOR ZERO RETURN CODE                 14520002
         BZ    PRMPGETM       NORMAL RETURN CONTINUE                    14530002
         C     R15,ATTNCODE   TEST FOR ATTENTION IN EFFECT              14540002
         BE    RET4           ATTN HIT, EXIT WITH RETURN CODE=4         14542002
         B     RET0           CANNOT CONTINUE DUE TO IO ERRORS          14544002
         SPACE                                                          14550002
*        BUILD PARMLIST FOR COMMAND SCAN SERVICE ROUTINE AND SCAN THE   14600002
*        VERB FIELD OF THE COMMAND RECEIVED FROM THE TERMINAL.          14650002
PRMPGETM EQU   *                                                        14660002
         GETMAIN RC,LV=16      GET CORE FOR CPPL                        14700002
         LTR   R15,R15        WAS GETMAIN SUCCESSFUL                    14720002
         BNZ   GETMERR        NO. ISSUE MESSAGES AND TERMINATE          14730002
         LR    R7,R1          SAVE ADDRESS.                             14750002
         USING CPPL,R7        *                                         14800002
         SPACE                                                          14850002
         L     R1,WORKAREA    R1=ADDR OF PARM LIST.                     14900002
         MVC   X0(N12,R1),PARMLIST MOVE IN STANDARD PARMS.              14950002
         LA    R2,N24(,R1)    R2=FLAG WORD ADDR.                        15000002
         LA    R3,N28(,R1)    R3=OUTPUT AREA ADDR.                      15050002
         L     R4,INBUF       CPPL COMMAND BUFFER =IN BUFFER.           15100002
         ST    R4,CPPLCBUF     INITIALIZE CPPL.                         15150002
         MVC   CPPLUPT(N12),TPLUPT  DITTO.                              15200002
         SR    R5,R5          FLAG WORD.                                15250002
         STM   R2,R5,N12(R1)   MOVE IN FLAG & OUTPUT AREA ADDRS.        15300002
         ST    R5,INBUF       CLEAR TEST'S INPUT BUFFER POINTER.        15350002
         OI    X0(R2),NOSYNTAX INDICATE 'NO SYNTAX CHECK'.              15400002
         LINK  EP=IKJSCAN,ERRET=SCANERR     SCAN VERB FIELD OF COMMAND. 15550002
         L     R2,TPLECT      ECT POINTER.                              15600002
         NI    ECTSWS,XFF-ECTNOPD  TURN OFF PARM SW.                    15650002
         TM    X6(R3),X40     Q.COMMAND NAME W/NO FIELDS.               15700002
         BZ    SKIP           SWITCH OFF.                               15750002
         OI    ECTSWS,ECTNOPD  TURN SWITCH ON.                          15800002
SKIP     EQU   *              *                                         15850002
         B     GOPP           PLACE PSEUDO-BREAK & ENTER PP.            15900002
ATNCHK   EQU   *                                                        15910002
         L     R4,ECBTMPA     GET ADDRESS OF ATTENTION ECB.             15920002
         TM    ZERO(R4),ATTNBIT HAS AN ATTENTION BEEN POSTED            15930002
         BO    RET4           IF SO, LET'S GET OUT OF HERE              15940002
         BR    R14            OTHERWISE, RETURN TO CALLER               15942002
         SPACE                                                          15950002
PARMSTRG EQU   *                                                        16000002
*        SET UP SPECIFIED PARM STRING AS POINTED TO FROM A STANDARD     16050002
*        VARIABLE LIST.                                                 16100002
         SPACE                                                          16150002
         L     R4,STRING      R4=ADDR OF CHARACTER STRING.              16200002
         LH    R2,STRING+X4    R2=LENGTH OF STRING.                     16250002
         CL    R2,AHUNDRED    DOES IT EXCEED MAXIMUM Q.                 16300002
         BNH   PARMST10       STRING NOT GTR THAN 100,CONTINUE          16350002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO PARM LIST        16360002
* ISSUE 'PARAMETER STRING LENGTH EXCEEDED' MESSAGE                      16370002
* ISSUE 'MAXIMUM LENGTH IS 100' MESSAGE                                 16380002
         IKJEGSIO MSG,FIRST=M0069,SECOND=M0271,ID=LDR18,               *16390002
               MF=(E,TSTIOPRM)                                          16392002
         BAL   R11,IORETCK    TEST IO RETURN CODES                      16394002
         B     RET0           RETURN WITH RC-0-ERROR                    16396002
PARMST10 EQU   *                                                        16400002
         LA    R0,X6(,R2)     R0=LENGTH OF STRING & POINTER.            16450002
         GETMAIN RC,LV=(0)    GET STORAGE FOR LIST AND STRING.          16500002
         LTR   R15,R15        WAS GETMAIN SUCCESSFUL                    16520002
         BNZ   GETMERR        NO. ISSUE MESSAGES AND TERMINATE          16530002
         LA    R3,X4(,R1)     R3=ADDR FOR PASSED PARM STRING.           16550002
         STH   R2,X4(R1)      MOVE LENGTH TO PARMS.                     16600002
        LTR   R2,R2          IS NULL PARM STRING PASSED ZZZZZZZZ        16610000
        BZ    NULPARMS       YES, SKIP EXECUTE INST     ZZZZZZZZ        16620000
         BCTR  R2,X0          DECREMENT FOR EXECUTE.                    16650002
         EX    R2,STRMVC      MOVE THE STRING.                          16700002
NULPARMS O     R3,HIGHBIT     INDICATE LAST LIST ELEMENT. ZZZZZZZZ      16720000
         ST    R3,X0(,R1)     STORE PARM POINTER IN LIST.               16800002
         LR    R7,R1          SAVE THE PARAMETER LIST ADDRESS.          16850002
         B     GOPP           PLACE PSEUDO-BREAK, ENTER PP.             16900002
         SPACE                                                          16950002
STRMVC   MVC   X6(X0,R1),X0(R4)         *                               17000002
         SPACE                                                          17050002
OSLOAD   EQU   *                                                        17100002
*        SET UP PARM LIST AND DDNAME LIST FOR OS LOADER.LOAD THE        17150002
*        PROCESSING PORTION OF THE LOADER,BRANCH TO IT AND DELETE       17200002
*        IT UPON ITS RETURN.                                            17250002
         SPACE                                                          17300002
         GETMAIN  RC,LV=OBJCORE  GET CORE FOR OSLOAD PARMS              17350002
         LTR   R15,R15        WAS GETMAIN SUCCESSFUL                    17370002
         BNZ   GETMERR        NO. ISSUE MESSAGES AND TERMINATE          17380002
         LA    R2,X8(R1)      OPTION LIST ADDRESS.                      17400002
         LA    R3,OPTCORE(R2)  POINT BEYOND OPTIONS                     17450002
         O     R3,HIGHBIT     INDICATE LAST ELEMENT.                    17500002
         MVC   X0(OPTLN,R2),OPTIONS MOVE IN OPTIONS.                    17550002
         XC    X0(N98,R3),X0(R3) CLEAR DDNAME LIST.                     17600002
         MVC   N98-X8(X8,R3),TERMDD  PLACE DDNAME INTO LIST             17650002
         MVI   X1(R3),N96     DDNAME LIST LENGTH.                       17700002
         MVC   X2(X8,R3),INTSTDDN MOVE DDNAME TO SYSLIN SLOT IN LIST.   17750002
         STM   R2,R3,X0(R1)   INITIALIZE LIST.                          17800002
         LR    R2,R1          SAVE LIST ADDR.                           17850002
         LOAD  EP=HEWLOAD,ERRET=LOADERR     LOAD THE VS LOADER.         17900002
         LR    R15,R0         R15=VS LOADER ENTRY POINT.                17950002
         LR    R1,R2          R1=LIST ADDR.                             18000002
         BALR  R14,R15        ENTER LDR TO LOAD TESTED PROGRAM          18050002
         C     R15,FOUR       Q. IS PROGRAM SUCCESSFULLY LOADED.        18150002
         BH    RET0           NO. DEPART                                18200002
         LR    R3,R1          SAVE NAME POINTER IN R3.                  18250002
         DELETE EP=HEWLOAD     DELETE THE VS LOADER.                    18300002
         LR    R1,R2          R1=ADDR OF STORAGE GOTTEN FOR LOADER.     18350002
         FREEMAIN  RC,LV=OBJCORE,A=(1)  FREE THE PARM CORE              18400002
         LTR   R15,R15        WAS FREEMAIN SUCCESSFUL                   18420002
         BZ    OSLOAD1        YES. CONTINUE                             18430002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO PARM LIST        18440002
* ISSUE 'FREEMAIN SVC ERROR' MESSAGE                                    18444002
         IKJEGSIO SVCERR,SVC=120,RC=(R15),ID=LDR18,MF=(E,TSTIOPRM)      18446002
         BAL   R11,IORETCK    TEST IO RETURN CODES                      18448002
* CONTINUE AFTER ERROR                                                  18448402
         SPACE                                                          18450002
*        ISSUE A LOAD FOR THE PROGRAM BROUGHT IN BY THE VS LOADER       18500002
*        IN ORDER TO GET IT ON THE LOAD LIST.SAVE THE PROGRAM NAME      18550002
*        IN TSTCURLD OF TCOMTAB AND SET UP PARAMETERS REQUIRED BY       18600002
*        THE PROGRAM.                                                   18650002
         SPACE                                                          18700002
OSLOAD1  EQU   *                                                        18710002
         L     R2,TPLECT      ECT POINTER.                              18750002
         MVC   ECTPCMD(X8),X0(R3)  PUT MEMBER NAME IN ECT.              18800002
         B     PARMSET        SET UP PARAMETERS FOR THE PROGRAM.        18850002
SETTRN   EQU   *                                                        18900002
         BAL   R14,ATNCHK     GO SEE IF AN ATTENTION WAS POSTED         18910002
         L     R2,WORKAREA    GET POINTER TO WORKING CORE               18950002
         USING TSTCWORK,R2    ESTABLISH ADDRESSABILITY                  19000002
         L     R4,PPTCB       OUR TCB ADDRESS ...                       19050002
         IKJEGS9G TRN,TCBADDR=(R4),VALUE=(R9),MF=(E,LDRSVCL) SET TCBTRN 19100002
         LTR   R15,R15        CHECK RETURN CODE FROM SVC                19150002
         BNZ   PUTSVCMG       BRANCH IF OTHER THAN ZERO                 19200002
         SPACE                                                          19250002
         IKJEGS9G TCPON,TCBADDR=(R4),MF=(E,LDRSVCL) TCBTCP              19300002
         LTR   R15,R15        CHECK RETURN CODE FROM SVC                19350002
         BNZ   PUTSVCMG       BRANCH IF OTHER THAN ZERO                 19400002
         BR    R11            RETURN                                    19450002
RET4     LA    R15,X4         RC=4                                      19500002
         B     RETURN         RETURN TO CALLER                          19510002
RET0     SR    R15,R15        ZERO RETURN CODE.                         19520002
RETURN   EQU   *              RETURN.                                   19550002
         LR    R2,R15        SAVE RETURN CODE                           19552002
         ESTAE 0             REMOVE ESTAE                               19560002
         LR    R15,R2        RESET RETURN CODE                          19562002
         NI    TSTFLGS4,XFF-TSTRERTN TURN OFF RETRY BIT                 19570002
         L     R13,X4(R13)     ADDRESS OF REGSAVE AREA                  19600002
         RETURN (14,12),RC=(15)  RETURN.                                19650002
PUTSVCMG EQU   *                                                        19700002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO PARM LIST        19750002
* ISSUE 'LOADER FAILED' MESSAGE                                         19800002
* ISSUE ' SVC 97 RETURN CODE NONZERO' MESSAGE                           19850002
         IKJEGSIO MSG,FIRST=M0058,INST11=(NUM,I0031),SECOND=M0283,     *19900002
               ID=LDR18,MF=(E,TSTIOPRM)                                 19950002
         BAL   R11,IORETCK    TEST IO RETURN CODES                      20000002
         B     RET0           RETURN WITH RC=0-ERROR                    20050002
         EJECT                                                          20100002
IORETCK  EQU   *              IO RETURN CODE CHECK ROUTINE              20150002
         B     IORC0(R15)     USE RETURN CODE AGAINST BRANCH TABLE      20200002
IORC0    EQU   *                                                        20250002
         B     X0(R11)        RC=0 NORMAL RETURN, CONTINUE              20300002
         B     X0(R11)        RC=4 IO ERROR TRY TO CONTINUE             20350002
         B     RET0           RC=8 SHOULD NEVER HAPPEN                  20360002
         B     X0(R11)        RC=12 IO ERROR TRY TO CONTINUE            20370002
         B     RET4           RC=16 ATTN,RETURN TO INIT WITH RC=4       20380002
         B     X0(R11)        RC=20 RETRY ENTERED TRY TO CONTINUE       20390002
         B     RETURN         RC=24, PASS IT ON BACK TO INIT            20392002
         EJECT                                                          20420002
SCANERR  EQU   *              LOGIC FOR LINK ERRET                      20440002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO PARM LIST        20440402
         LR    R0,R1         LOAD ABEND CODE INTO R0                    20440802
* ISSUE 'LINK TO IKJSCAN SVC ERROR' MESSAGE                             20441602
         IKJEGSIO SVCERR,SVC=6,ABENDRG=(R0),RC=(R15),                  *20441702
               INST11=(NUM,I0043),ID=LDR18,MF=(E,TSTIOPRM)              20459702
         BAL   R11,IORETCK    TEST IO RETURN CODES                      20468702
         B     RET0           TERMINATE WITH RC=0-ERROR                 20477702
         SPACE                                                          20479702
LOADERR  EQU   *             LOGIC FOR LOAD ERRET                       20479802
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM LIST         20479902
         LR    R0,R1         LOAD ABEND CODE INTO R0                    20482802
* ISSUE 'LOAD HEWLOAD SVC ERROR' MESSAGE                                20486202
         IKJEGSIO SVCERR,SVC=8,ABENDRG=(R0),RC=(R15),                  *20489102
               INST11=(NUM,I0134),ID=LDR18,MF=(E,TSTIOPRM)              20492002
         BAL   R11,IORETCK   TEST IO RC'S                               20494902
         B     RET0          TERMINATE WITH RC=0-ERRORS                 20497802
         SPACE                                                          20500702
GETMERR  EQU   *              GETMAIN ERROR HANDLING LOGIC              20503602
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO PARM LIST        20506502
* ISSUE 'GETMAIN SVC ERROR' MESSAGE                                     20509402
         IKJEGSIO SVCERR,SVC=10,RC=(R2),ID=LDR18,MF=(E,TSTIOPRM)        20515202
         BAL   R11,IORETCK    TEST IO RETURN CODES                      20521002
         B     RET0           TERMINATE WITH RC=0                       20526802
         EJECT                                                          20532602
*************************************************                       20534602
*     ESTAE EXIT ROUTINE                                                20536602
*************************************************                       20537002
ESTAERTY EQU   *                                                        20537402
* ESTABLISH PROGRAM ADDRESSABILITY                                      20537802
         DROP  R12                                                      20538202
         USING *,R15         USE R15 AS TEMPORARY BASE REG              20538302
         L     R12,BASEAD    LOAD PROGRAM BASE REGISTER                 20550602
         DROP R15                                                       20560602
         USING IKJEGLDR,R12  ESTABLISH ADDRESSABILITY                   20562602
* REESTABLISH TCOMTAB ADDRESSABILITY                                    20563002
         L     R2,CVTPTR     GET CVT ADDRESS                            20567102
         USING CVT,R2                                                   20569102
         L     R2,CVTTCBP    GET ADDRESS OF TCB WORDS                   20571102
         L     R2,X4(R2)     GET ADDRESS OF THIS TCB                    20571202
         DROP  R2                                                       20575302
         USING TCB,R2                                                   20577302
         L     R2,TCBOTC     GET ADDRESS OF TEST'S(MOTHER) TCB          20579302
         L     R9,TCBTRN     GET TCOMTAB ADDRESS                        20579402
         L     R13,REGSAVE2  GET LOADERS SAVE AREA ADDRESS              20583502
         LA    R15,RC20      SET RC=20                                  20585502
         B     RETURN        RETURN TO INITIALIZATION                   20587502
         EJECT                                                          20587602
         SPACE                                                          20587702
XCTLFORM XCTL  EP=XCTLFORM,SF=L                                         20591802
XCTLLEN  EQU   *-XCTLFORM     *                                         20595902
OPTIONS  DS    0F             ROUND TO FULL WORD                        20600002
         DC    AL2(OPTLN-2)   LENGTH OF LIST.                           20650002
         DC    C'TERM,NOPRINT,NCAL,NOMAP,NORES,LET,NAME=TEMPNAME'      *20700002
               OSLOADER PARAMETERS                                      20750002
OPTLN    EQU   *-OPTIONS                                                20800002
OPTLN1   DS    0F             ROUND TO FULL WORD                        20850002
OPTCORE  EQU   OPTLN1-OPTIONS  OPTIONS CORE REQUIREMENT                 20900002
OBJCORE  EQU   8+OPTCORE+12*8  TOTAL PARAMETER CORE FOR OSLOADER        20950002
AHUNDRED DC    A(100)         *                                         21000002
FOUR     DC    F'4'           FOUR                                      21050002
ATTNCODE DC    F'16'          RETURN CODE 16=ATTENTION                  21100002
HIGHBIT  DC    X'80000000'    HIGH ORDER BIT                            21150002
DUMMYATB DC    X'FF'         DUMMY ABEND TABLE                          21200002
BASEAD   DC    A(IKJEGLDR)   PROGRAM BASE ADDRESS                       21250002
LDRSPL   IKJEGSPL RTRY=ESTAERTY,ABNTB=DUMMYATB,MODNM=IKJEGLDR,         *21300002
               TNM=LOADER    ESTAE PARAMETER LIST                       21350002
         TSTCWORK                                                       21450002
         ORG   CWORKCVT       ORIGIN OF SPACE FOR FOLLOWING DS          21500002
LDRSVCL  DS    XL12           SPACE FOR SVC97 PARAMETER LIST            21550002
LDRESTAE DS    XL16          SPACE FOR ESTAE PARM LIST                  21600002
         EJECT                                                          21650002
         IHACDE                                                         21700002
         EJECT                                                          21750002
         IHALLE                                                         21800002
         EJECT                                                          21850002
CVT      DSECT                                                          21900002
         CVT                                                            21950002
         EJECT                                                          22000002
IKJEGLDR CSECT                                                          22050002
         SPACE                                                          22100002
*        PARSE CONSTANTS AND DSECT                                      22150002
         SPACE                                                          22200002
IKJEGYDR IKJPARM                                                        22250002
DSNAME   IKJPOSIT DSNAME                                                22300002
STRING   IKJPOSIT QSTRING                                               22350002
LOADOBJ  IKJKEYWD                                                       22400002
         IKJNAME 'LOAD'                                                 22450002
         IKJNAME 'OBJECT'                                               22500002
CPNOCP   IKJKEYWD                                                       22550002
         IKJNAME 'CP'                                                   22600002
         IKJNAME 'NOCP'                                                 22650002
         IKJENDP                                                        22700002
         EJECT                                                          22750002
         TCOMTAB                                                        22800002
         SPACE                                                          22950002
         IKJCPPL                                                        23000002
         SPACE                                                          23050002
         IKJECT                                                         23100002
         SPACE                                                          23150002
         IKJTPL                                                         23200002
         SPACE                                                          23250002
         IKJTCB                                                         23300002
         SPACE                                                          23350002
         EJECT                                                          23360002
IKJEGLDR CSECT                                                          23400002
         DS    0F            FORCE FULLWORK ALIGNMENT                   23450002
LDRPATCH DC    50C'Z'        PATCH AREA                                 23500002
         END                                                            24550002
./  ADD  SSI=81730766,NAME=IKJEGLSA
         TITLE 'IKJEGLSA, ''LIST'' SUBCOMMAND OF TEST, SECOND LOAD'     00146702
* /* START OF SPECIFICATIONS ****                                       00147102
*02*  PROCESSOR = ASSEMBLER                                             00147502
**** END OF SPECIFICATIONS ***/                                         00147902
*********************************************************************** 00148702
*                                                                       00150002
* STATUS --                                                             00200002
*    VERSION NO.  00, OS/VS2 RELEASE NO. 02                             00210002
*                                                                       00700002
* FUNCTION --                                                           00750002
*    THIS MODULE IS THE SECOND LOAD OF IKJEGLST, THE LIST SUBCOMMAND.   00800002
*    IT IS ENTERED WHEN THE OUTPUT TYPE IS ONE OF THE FOLLOWING- A, B,  00850002
*    C, D, E, F, H, I, L, P, Q, S, V, Y, OR Z.  THE ROUTINE CALLS       00900002
*    IKJEGCVT TO CONVERT THE DATA (EXCEPT FOR CHARACTER, BINARY, OR     00950002
*    ZONED FORMATS WHICH ARE DONE WITHIN THIS MODULE), FORMATS THE      01000002
*    DATA IN THE BUFFER, AND GOES TO IKJEGIO TO OUTPUT THE DATA. THIS   01050002
*    MODULE LISTS AREAS OF CORE IN ONE OF THE ABOVE NAMED FORMATS.      01100002
*                                                                       01150002
* ENTRY POINTS --                                                       01200002
*         IKJEGLSA  MAIN ENTRY PT, ENTERED BY XCTL FROM IKJEGLST        01250002
*                                                                       01300002
* INPUT --                                                              01350002
*    REG 1 POINTS TO A 2 WORD LIST, THE FIRST WORD IS A POINTER TO      01400002
*    THE CURRENT ADDRESS PDE AND THE SECOND WORD IS A POINTER TO THE    01450002
*    'LSTWORK' DSECT WHICH HAS ALREADY BEEN INITIALIZED.                01500002
*    REG 9 CONTAINS THE ADDRESS OF 'TCOMTAB', THE COMMUNICATIONS DSECT  01550002
*                                                                       01600002
* OUTPUT --                                                             01650002
*    LINES TO THE TERMINAL DISPLAYING REQUESTED DATA OR, IF THE PRINT   01700002
*    KEYWORD HAS BEEN SPECIFIED, THE REQUESTED DATA IS WRITTEN TO THE   01750002
*    DESIGNATED DATA SET.                                               01800002
*                                                                       01850002
* EXTERNAL REFERENCES --                                                01900002
*         IKJEGCVT  FOR CONVERSION OF ADDRESSES AND DATA FROM MACHINE   01950002
*         FORMAT TO PRINTABLE FORMAT. FOR CONVERSION OF ADDRESSES,      02000002
*         CVT IS ENTERED WITH THE HIGH ORDER BIT OF REG 0 SET TO ONE    02050002
*         AND REGISTER 1 CONTAINING THE COMPLEMENT OF THE ADDRESS OF    02100002
*         AN ADDRESS PDE. THE ADDRESS PDE DESCRIBES THE ADDRESS TO BE   02150002
*         CONVERTED.  FOR DATA CONVERSIONS, REG 0 IS SET TO ZERO, AND   02200002
*         REG 1 CONTAINS THE ADDRESS OF A VALUE PDE DESCRIBING THE      02250002
*         TO BE CONVERTED.                                              02300002
*                                                                       02350002
*         IKJEGIO  TO OUTPUT DATA TO THE TERMINAL OR TO A PRINT DATA    02400002
*                                                                       02800002
* EXITS, NORMAL --                                                      02850002
*         BR 14  TO THE ORIGINAL CALLER OF IKJEGLST WHEN THE LAST       02900002
*         ADDRESS PDE HAS BEEN PROCESSED.                               02950002
*         XCTL  TO IKJEGLST IF THE NEXT ADDRESS IN A LIST OF ADDRESSES  03000002
*         IS REGISTER TYPE, OR IF THE FORMAT TYPE IS HEX (X).           03050002
*                                                                       03100002
* EXITS, ERROR --                                                       03150002
*         NONE                                                          03200002
*                                                                       03250002
* TABLES/WORK AREAS --                                                  03300002
*    TCOMTAB  POINTED AT BY REG 9, IS THE COMMUNICATIONS TABLE FOR THE  03350002
*    TEST PROCESSOR.                                                    03400002
*                                                                       03450002
*    LSTWORK  THE MAPPING DSECT FOR THE WORK AREA USED BY IKJEGLST AND  03500002
*    IKJEGLSA. IT HOLDS WORKING COPIES OF THE ATTRIBUTES, ADDRESSES     03550002
*    FOR THE DATA CURRENTLY BEING LISTED, PARAMETER LISTS FOR CALLING   03600002
*    VARIOUS ROUTINES, AND A DATA BUFFER FOR REMOVING BREAKPOINT SVC'S  03650002
*                                                                       03700002
*    PARAMETER DESCRIPTOR LIST  (PDE) SET UP BY PARSE                   03750002
*                                                                       03800002
* ATTRIBUTES --                                                         03850002
*    REENTRANT, REFRESHABLE, PROBLEM PROGRAM.                           03900002
*                                                                       03950002
* CHARACTER CODE DEPENDENCY --                                          04000002
*                                                                       04050002
* NOTES --                                                              04100002
*                                                                       04110003
* CHANGE ACTIVITY --                                                    04120003
*   ADDED CODE TO SUBROUTINE ADDRCHK TO CLEAR OUTPUT BUFFER   @ZA11395  04125003
*   UPON RETURN FROM SVC 97.                                  @ZA11395  04130003
*********************************************************************** 04200002
         EJECT                                                          04250002
         COPY  IKJEGSIO            OBTAIN I/O CALLING MACROS            04260002
IKJEGLSA CSECT                                                          04300002
*D562500,D563000                                                YA00087 04310002
         SPACE 1                                                        04350002
*********************************************************************** 04400002
*  REGISTER EQUATES.                                                    04450002
         SPACE                                                          04500002
R0       EQU   0                   WORK REG                             04550002
R1       EQU   1                   WORK REG                             04600002
R2       EQU   2                   WORK REG                             04650002
R3       EQU   3                   WORK REG                             04700002
R4       EQU   4                   USED IN PROCESS SECTION FOR CONTROL  04750002
R5       EQU   5                   WORK REG                             04800002
R6       EQU   6                   IN PROCESS SECTION, CUR BUF PTR      04850002
R7       EQU   7                   INTERNAL LINKAGE REGISTER            04900002
R8       EQU   8                   POINTS TO CURRENT ADDRESS PDE        04950002
R9       EQU   9                   BASE FOR TCOMTAB DSECT               05000002
R10      EQU   10                  BASE FOR LSTWORK DSECT               05050002
R11      EQU   11                  SPACE REGISTER                       05100002
R12      EQU   12                  PROGRAM BASE REGISTER                05150002
R13      EQU   13                  PROGRAM SAVE AREA                    05200002
R14      EQU   14                  EXTERNAL LINKAGE REGISTER            05250002
R15      EQU   15                  EXTERNAL LINKAGE REGISTER            05300002
*********************************************************************** 05350002
         SPACE 2                                                        05400002
*  DATA EQUATES FOR OPERANDS OF IMMEDIATE TYPE INSTRUCTIONS.            05450002
         SPACE                                                          05500002
NULL     EQU   0                   USED FOR BALR R,0 AND BCTR R,0.      05550002
ZERO     EQU   0                   SYMBOLIC EQUATE                      05600002
ONE      EQU   1                   SYMBOLIC EQUATE                      05650002
TWO      EQU   2                   SYMBOLIC EQUATE                      05700002
THREE    EQU   3                   SYMBOLIC EQUATE                      05750002
FOUR     EQU   4                   SYMBOLIC EQUATE                      05800002
FIVE     EQU   5                   SYMBOLIC EQUATE                      05850002
SIX      EQU   6                   USED AS THE MAX INSTRUCTION LENGTH   05900002
EIGHT    EQU   8                   SYMBOLIC EQUATE                      05950002
SIXTEEN  EQU   16                  SYMBOLIC EQUATE                      06000002
HEX0A    EQU   X'0A'               USED IN SIGNTBL FOR ZONED FORMAT     06050002
HEX80    EQU   X'80'               SYMBOLIC MASK                        06100002
HEXFF    EQU   X'FF'               SYMBOLIC MASK                        06150002
         SPACE                                                          06200002
BLANK    EQU   C' '                SYMBOLIC FOR BLANK (SPACE).          06250002
PERIOD   EQU   C'.'                SYMBOLIC FOR PERIOD (.)              06300002
CHAR0    EQU   C'0'                SYMBOLIC FOR  CHARACTER 0            06400002
CHAR1    EQU   C'1'                SYMBOLIC FOR A CHARACTER 1           06450002
CHAR9    EQU   C'9'                SYMBOLIC FOR CHARACTER 9             06500002
         SPACE                                                          06550002
CFLDMASK EQU   B'00011111'         MASK TO ISOLATE REMAINDERS FOR C TYP 06600002
DWBDY    EQU   B'00000111'         USED TO TEST ADDRS FOR DBL WRD BDY.  06650002
FWBDY    EQU   B'00000011'                                FULL          06700002
HWBDY    EQU   B'00000001'                                HALF          06750002
INSTRLEN EQU   B'11000000'         FOR TESTING 1ST 2 BITS OF INSTRS     06800002
PACKMSK  EQU   X'6F'               USED TO SET UP LNTHS FOR PACK INSTR  06850002
         SPACE                                                          06900002
*  EQUATES FOR OFFSETS INTO A SYMINFO BLOCK.                            06950002
         SPACE                                                          07000002
SIDATAPT EQU   0                   OFFSET INTO SYMINFO BLK FOR DATA PTR 07050002
SITYPE   EQU   4                   OFFSET INTO SYMINFO FOR TYPE         07100002
SIMUL    EQU   6                   OFFSET TO LAST 2 BYTES OF MLTPLCTY   07150002
SILEN    EQU   8                   OFFSET TO LNTH IN SYMINFO            07200002
SINXTPTR EQU   12                  OFFSET INTO SYMINFO BLK FOR CHAIN PT 07250002
SYMINFOL EQU   16                  SYMBOLIC FOR LENGTH OF SYMINFO BLK   07300002
         SPACE                                                          07350002
LL00LEN  EQU   4                   SYMBOLIC FOR LENGTH OF LL00 FIELD    07400002
LSTBUFL  EQU   82                  LENGTH TO BE BLANKED IN BUFFER       07450002
MINLL    EQU   40                  MINIMUM LINE LNTH FORMATTED BY LIST  07500002
STDLL    EQU   81                  DEFAULT LINE LNTH WHEN TMPLL IS LOW  07550002
CHARLEN  EQU   32                  LENGTH OF AN OUTPUT FLD, CHAR FORMAT 07600002
SP1      EQU   1                   USED TO INCREMENT BY 1 SPACE         07650002
SP2      EQU   2                   USED TO INCREMENT BY 2 SPACES        07700002
SP4      EQU   4                   FOR INCREMENTING PAST 4 SPACES       07750002
         SPACE                                                          07800002
H2ND     EQU   1                   OFFSET TO 2ND BYTE OF A HALFWORD     07850002
F1STHALF EQU   0                   OFFSET TO 1ST HALFWORD OF A FIELD    07900002
LL00OFF  EQU   0                   OFFSET INTO BUFFER FOR LL00 FIELD    07950002
ADDRLEN  EQU   7                   SYMBOLIC LNTH OF ABS/REL ADDRESSES   08000002
BFLDLEN  EQU   8                   SYMBOLIC LNTH OF 1 BINARY FIELD      08050002
BDATALEN EQU   1                   SYMBOLIC LNTH OF INPUT FOR 1 BIN FLD 08100002
SIGNLEN  EQU   1                   LENGTH OF A SING FIELD               08150002
DATAOFF  EQU   4                   OFFSET TO DATA PORTION OF BUFFER     08200002
MSGOFFST EQU   80                  OFFSET INTO BUFFER FOR PLACING MSG   08250002
R6OFF    EQU   44                  OFFSET INTO SAVE AREA FOR REG 6      08300002
R10OFF   EQU   60                  OFFSET INTO SAVE AREA FOR R10        08350002
TYPELEN  EQU   1                   SYMBOLIC LNTH OF TYPE FIELD IN MSG   08400002
         SPACE                                                          08450002
LSTWRKPT EQU   0                   PARM LIST OFFSET TO LSTWORK BASE     08500002
LSTPDEPT EQU   4                   PARM LIST OFFSET TO CUR ADDR PDE     08550002
         SPACE                                                          08600002
L0AOFF   EQU   DATAOFF+ADDRLEN     OFFSET TO FIRST INSTR FROM BUF BEGIN 08650002
FOREPTR  EQU   8                   OFFSET TO FOREWARD PTR IN SAVE AREA  08700002
BACKPTR  EQU   4                   OFFSET TO BACKWARD PTR IN SAVE AREA  08750002
FIRSTI   EQU   DATAOFF+ADDRLEN+SP4 OFFSET INTO BUF OF 1ST INSTR, I TYPE 08800002
CONLNTH  EQU   0                   OFFSET INTO CONVERT AREA FOR LENGTH  08850002
CONDATA  EQU   1                   OFFSET INTO CONAREA TO START OF DATA 08900002
MAXLINE  EQU   100                 MAX LINE LENGTH FOR OUTPUT           08950002
LSTIBLK  EQU   31                  LNTH OF DATA MOVED TO HOLD AREA      09000002
CVTSPACE EQU   64                  OFFSET INTO COMMON WORK AREA FOR LST 09050002
ATTNBIT  EQU   B'01000000'                                              09100002
EQZERO   EQU   8                   COND CODE MASK FOR CC OF 0           09150002
NOTONES  EQU   14                  COND. CODE MASK FOR CC OF 0, 1, OR 2 09200002
         SPACE                                                          09250002
MAXPLEN  EQU   16                  LENGTH LIMIT FOR P,Z,L TYPES         09300002
POUTMAX  EQU   32                  MAX OUTPUT LNTH FOR P TYPE           09350002
ZOUTMAX  EQU   17                  MAX OUTPUT LNTH FOR Z TYPE           09400002
LOUTMAX  EQU   32                  MAX OUTPUT LNTH FOR L TYPE           09450002
MAXFLEN  EQU   8                   LENGTH LIMIT FOR F,E,H,D TYPES       09500002
FOUTMAX  EQU   20                  MAX OUTPUT LNTH FOR F,H TYPES        09550002
EOUTMAX  EQU   23                  MAX OUTPUT LNTH FOR E,D TYPES        09600002
MAXALEN  EQU   4                   LENGTH LIMIT FOR A,Q,V TYPE          09650002
AOUTMAX  EQU   11                  MAX OUTPUT LNTH FOR A,V,Q TYPES      09700002
MAXYLEN  EQU   2                   LENGTH LIMIT FOR Y,S TYPES           09750002
YOUTMAX  EQU   6                   MAX OUTPUT LNTH FOR Y TYPE           09800002
SOUTMAX  EQU   8                   MAX OUTPUT LNTH FOR S TYPE           09850002
MAXGENR  EQU   15                  MAXIMUM GENERAL REGISTER NUMBER      09900002
TWENTY   EQU   20                  NUMBER FOR COMPARE                   09950002
MAXFPR   EQU   6                   MAXIMUM FLOATING PT REG NUMBER       10000002
ELEVEN   EQU   11                  GENERAL EQUATE FOR 11                10010002
BADESTAE EQU   24                  RTN CODE IF BAD ESTAE                10020002
M0019    EQU   19                  NUMBER OF ERROR MESSAGE              10030002
M0020    EQU   20                  NUMBER OF ERROR MESSAGE              10040002
M0021    EQU   21                  NUMBER OF ERROR MESSAGE              10040402
         SPACE 2                                                        10050002
*  EQUATES FOR INTERNAL ASSEMBLER-TYPE-CODES.                           10100002
         SPACE                                                          10150002
CHARCODE EQU   X'00'               TYPE ATTRIBUTE =CHAR                 10200002
HEXCODE  EQU   X'04'                ''     ''     =HEXADECIMAL          10250002
BINCODE  EQU   X'08'                ''     ''     =BINARY               10300002
ICODE    EQU   X'0C'                ''     ''     =INSTRUCTION          10350002
FCODE    EQU   X'10'                ''     ''     =FIXED PT, FULLWORD   10400002
HCODE    EQU   X'14'                ''     ''       ''   '', HALFWORD   10450002
ECODE    EQU   X'18'                ''     ''     =FLT PT, FULLWORD     10500002
DCODE    EQU   X'1C'                ''     ''      ''  '', DBL WORD     10550002
AQCODE   EQU   X'20'                ''     ''     =A AND Q ADDR CONST   10600002
YCODE    EQU   X'24'                ''     ''     =Y ADDR CONST         10650002
SCODE    EQU   X'28'                ''     ''     =S ADDR CONST         10700002
VCODE    EQU   X'2C'                ''     ''     =V ADDR CONST         10750002
PACKCODE EQU   X'30'                ''     ''     =PACKED DECIMAL       10800002
ZONECODE EQU   X'34'                ''     ''     =ZONED DECIMAL        10850002
LCODE    EQU   X'38'                ''     ''     =FLT PT, EXTENDED     10900002
         SPACE                                                          10950002
         TITLE 'IKJEGLSA, ''LIST'', INITIALIZATION SECTION.'            11300002
*********************************************************************** 11350002
*                                                                     * 11400002
*  PROGRAM BEGINS WITH STANDARD LINKAGE CONVENTIONS.                  * 11450002
*                                                                     * 11500002
*********************************************************************** 11550002
         SPACE                                                          11600002
LIST     SAVE  (14,12),,*                                               11650002
         LR    R12,R15             R12=BASE REG FOR PROG ADDRESSABILITY 11700002
         USING LIST,R12                                                 11750002
         USING TCOMTAB,R9          COMMUNICATION TABLE ADDRESSABILITY.  11800002
         L     R4,REGSAVE2         R4=NEXT SAVE AREA                    11850002
         ST    R4,FOREPTR(R13)     FOREWARD CHAIN SAVE AREAS.           11900002
         ST    R13,BACKPTR(R4)     BACKWARD CHAIN SAVE AREAS.           11950002
         LR    R13,R4              R13=NEXT REGSAVE AREA ADDR.          12000002
         SPACE 1                                                        12050002
         L     R8,LSTPDEPT(R1)     GET PTR TO CURRENT ADDRESS PDE       12100002
         L     R10,LSTWRKPT(R1)    GET BASE ADDR FOR LSTWORK DSECT      12150002
         USING IKJPARMA,R8         ADDRESSABILITY FOR ADDR PDE DSECT    12200002
         USING LSTWORK,R10                                              12250002
         SPACE                                                          12300002
*                                                                       12350002
*        ISSUE STAE MACRO                                               12400002
*                                                                       12450002
         NI    TSTFLGS2,HEXFF-TSTXCTL  TURN OFF XCTL IN PROGRESS SW     12500002
         LA    R1,STAELIST         PTR TO LIST FORM MACRO               12600002
         L     R2,TSTSTAE          PTR TO TEST STAE MODULE              12650002
         STM   R10,R12,R10OFF(R13)     SAVE BASE PTR                    12700002
         ESTAE (R2),CT,PARAM=IKJEGSPL,RECORD=YES,XCTL=NO,MF=(E,(R1))    12710002
         SPACE                                                          12800002
         LTR   R15,R15             TEST RETURN CODE                     12850002
SMTSTAE  DS    0H                  SMT TEST LABEL FOR STAE MACRO        12900002
         BZ    STAEOK              CONTINUE IF ZERO                     12950002
         STC   R15,TSTESTRC        SAVE RTN CODE FOR MAINLINE           12960002
         LA    R15,BADESTAE        PREPARE TO RETURN BAD ESTAE RTN CODE 12970002
         ST    R15,LSTRETCD        SAVE FOR EXIT                        12980002
         B     LSTMN90             BRANCH TO EXIT                       12990002
         SPACE                                                          13050002
STAEOK   DS    0H                                                       13100002
         SPACE                                                          13150002
*********************************************************************** 13200002
*                                                                     * 13250002
*  BEGINNING OF REPEAT SECTION.  THE ROUTINE BELOW IS RE-ENTERED IF   * 13300002
*  A LIST OF ADDRESSES HAS BEEN GIVEN.                                * 13350002
*                                                                     * 13400002
*********************************************************************** 13450002
LSTMN04  DS    0H                                                       13500002
         L     R2,LMATTR           GET LENGTH AND MULTIPLICITY ATTR'S   13550002
         ST    R2,A1LMATTR             AND SET ADDRESS 1 ATTRIBUTES.    13600002
         SPACE                                                          13650002
         TM    PDE2FLG3,AFLG       WAS A SECOND ADDRESS GIVEN           13700002
         L     R15,PDEUSER         GET DATA ADDR OR SI PTR              13750002
         BO    LSTMN05             IF YES, BRANCH                       13800002
         TM    PDE2FLG2,CTNAMFLG   WAS 2ND ADDRESS A CSECT NAME         13850002
         BNO   LSTMN06             BRANCH IF NO 2ND ADDRESS             13900002
LSTMN05  DS    0H                                                       13950002
         OI    COMFLGS,TWOADDRS    SET FLAG TO INDICATE ADDRESS RANGE   14000002
LSTMN06  DS    0H                                                       14050002
         LTR   R15,R15             IF R15 NEG, R15 POINTS TO SYMINFO    14100002
         BM    SYM1                IF SYMBOLIC, BRANCH                  14150002
LSTMN07  DS    0H                                                       14200002
         LA    R15,ZERO(R15)       ZERO OUT THE PDE WRITE BIT           14250002
         ST    R15,A1              SAVE ADDR OF CURRENT INPUT           14300002
         TM    COMFLGS,TWOADDRS    WERE TWO ADDRESSESS SPECIFIED        14350002
         BZ    ONLYONE             IF ONLY ONE ADDR, BRANCH             14400002
         L     R15,PDE2USER        GET SECOND ADDR OR SI PTR            14450002
         LTR   R15,R15             IF R15 NEG, R15 POINTS TO SYMINFO    14500002
         BNM   ONLYONE             IF ADDR2 IS SYMBOLIC, BRANCH         14550002
         L     R15,SIDATAPT(R15)   PICK UP INPUT ADDR FROM SI BLOCK     14600002
ONLYONE  DS    0H                                                       14650002
         LA    R15,ZERO(R15)       ZERO OUT THE PDE WRITE BIT           14700002
         ST    R15,A2              SET A2 TO CURRENT SECOND ADDR        14750002
         LA    R15,HOLDAREA        MAKE A PTR TO DATA HOLDING AREA      14800002
         ST    R15,VPDEPT          SET UP VALUE PDE FOR CONVERT         14850002
         SPACE                                                          14900002
*  NEXT TEST WHETHER ADDR IF REG TYPE                                   14950002
         SPACE                                                          15000002
         TM    PDEFLG4,GENR+LFPR+SFPR  IS ADDRESS TYPE REGISTER         15050002
         BZ    NOTREG              IF NOT, BRANCH                       15100002
         NC    PDEINDCT,PDEINDCT   IF REG, IS IT INDIRECT               15150002
         BZ    LSTREG              IF REG IS NOT INDIRECTED, BRANCH     15200002
         SPACE                                                          15250002
*  NEXT TEST WHETHER ADDRESS IS RELATIVE                                15300002
         SPACE                                                          15350002
NOTREG   DS    0H                                                       15400002
         TM    PDEFLG4,CTONLY      IS ADDRESS A CSECT NAME              15450002
         BO    LSTMN09             IF CSECT NAME, BRANCH                15500002
         TM    PDEFLG4,RELADDR     IS ADDRESS TYPE RELATIVE             15550002
         BZ    LSTMN10             IF NOT RELATIVE, BRANCH              15600002
         NC    PDEINDCT,PDEINDCT   IF RELATIVE, IS IT INDIRECTED        15650002
         BNZ   LSTMN10             IF INDIRECTED, BRANCH                15700002
         TM    PDEEXPTR,HEXFF      IF RELATIVE, IS IT AN EXPRESSION     15750002
         BNO   LSTMN10             IF START OF AN EXPRESSION, BRANCH    15800002
         OI    A1FLG,A1REL         TURN ON ADDRESS IS RELATIVE FLAG     15850002
         TM    PDEFLG2,CTNAMFLG    IS RELATIVE ADDR QUALIFIED           15900002
         BNO   LSTMN14             IF NOT QUALIFIED, BRANCH             15950002
         SPACE                                                          16000002
*********************************************************************** 16050002
*                                                                     * 16100002
*  IF THE ADDRESS IS A QUALIFIED RELATIVE, CALCULATE THE BASE FOR     * 16150002
*   RELATIVES BY CONVERTING THE RELATIVE OFFSET TO BINARY AND         * 16200002
*    SUBTRACTING IT FROM THE RESOLVED CURRENT ADDRESS. THIS BASE      * 16250002
*     ADDRESS IS KEPT IN 'PPTEMP' FOR USE BY IKJEGCVT.                * 16300002
*                                                                     * 16350002
*********************************************************************** 16400002
         XC    HOLDAREA(APL),HOLDAREA  CLEAR AN AREA FOR AN ADDR PDE    16450002
         L     R2,PDEUSER          GET BINARY START ADDRESS             16500002
         LA    R2,ZERO(R2)         ZERO OUT HIGH ORDER BIT              16550002
         SPACE                                                          16600002
*  NEXT MOVE THE ADDRESS POINTER AND THE LENGTH TO THE NEW ADDR PDE.    16650002
         SPACE                                                          16700002
         MVC   HOLDAREA+PDEADRPT-IKJPARMA(PDERSV3-PDEADRPT),PDEADRPT    16750002
         MVI   HOLDAREA+PDEEXPTR-IKJPARMA,HEXFF  INDICATE NOT INDIRECT  16800002
         SPACE                                                          16850002
*  THE ADDRESS TYPE FIELD IS ZERO WHICH IS THE CODE FOR ABSOLUTE.       16900002
         SPACE                                                          16950002
         LA    R1,HOLDAREA         SET UP A POINTER TO NEW PDE.         17000002
         L     R15,TSTCONVT        GET ADDRESS OF CONVERT ROUTINE       17050002
         SR    R0,R0               MAKE REG 0, ZERO FOR CONVERT TO BIN  17100002
         LCR   R1,R1               MAKE REG 1 NEGATIVE FOR ADDR CONVERT 17150002
         BALR  R14,R15             GO CONVERT RELATIVE OFFSET TO BINARY 17200002
         LTR   R15,R15             IS THE RETURN CODE ZERO              17250002
         L     R1,HOLDAREA+PDEUSER-IKJPARMA  GET CONVERTED DATA         17300002
         LA    R1,ZERO(R1)         ZERO OUT HIGH ORDER BIT              17350002
         BNZ   LSTCVTRC            IF RC WAS NOT 0, BRANCH              17400002
         SR    R2,R1               SUBTRACT OFFSET FROM ADDRESS         17450002
         ST    R2,PPTEMP           SET UP DIVVERENCE AS BASE FOR RELS   17500002
         B     LSTMN14             BRANCH AROUND SET UP FOR ABSOLUTE    17550002
         SPACE                                                          17600002
LSTMN09  DS    0H                                                       17650002
         OI    A1FLG,A1SYM         TURN ON ADDR IS SYMBOLIC FLAG        17700002
LSTMN10  DS    0H                                                       17750002
         XC    APDE(APL),APDE      CLEAR ADDRESS PDE,                   17800002
         OI    APDE+(PDEFLG3-IKJPARMA),AFLG     SET FLAG, ADDR PRESENT  17850002
         OI    APDE+(PDEFLG4-IKJPARMA),ABSADDR  SET FLAG FOR ABSOLUTE   17900002
LSTMN14  DS    0H                                                       17950002
         SPACE                                                          18000002
*  NOW PICK UP TYPE FIELD AND USE AS INDEX INTO BRANCH TABLE.           18050002
         SR    R15,R15             CLEAR REG                            18100002
         IC    R15,A1TYPE              PICK UP TYPE CODE                18150002
         B     TYPEBTBL(R15)               AND BRANCH INTO BRANCH TABLE 18200002
         SPACE                                                          18250002
TYPEBTBL DS    0H                                                       18300002
         B     LSTCHAR             CODE X'00' FOR CHAR                  18350002
         B     LSTHEX              CODE X'04' FOR HEXADECIMAL           18400002
         B     LSTBIN              CODE X'08' FOR BINARY                18450002
         B     LSTINSTR            CODE X'0C' INSTRUCTION FORMAT        18500002
         B     FCON                CODE X'10' FOR FULLWORD FIXED PT     18550002
         B     HCON                CODE X'14' FOR HALFWORD FIXED PT     18600002
         B     ECON                CODE X'18' FOR SHORT FLT PT          18650002
         B     DCON                CODE X'1C' FOR LONG FLT PT           18700002
         B     ACON                CODE X'20' FOR A AND Q ADDR CNSTNTS  18750002
         B     YCON                CODE X'24' FOR Y ADDR CONSTANTS      18800002
         B     SCON                CODE X'28' FOR S ADDR CONSTANTS      18850002
         B     ACON                CODE X'2C' FOR V ADDR CONSTANTS      18900002
         B     PACKED              CODE X'30' FOR PACKED DECIMAL        18950002
         B     ZONED               CODE X'34' FOR ZONED DECIMAL         19000002
         B     LCON                CODE X'38' FOR EXTENDED FLT PT       19050002
         TITLE 'IKJEGLSA, ''LIST'', XCTL FOR REG ADDR OR HEX FORMAT'    19100002
*  IF FORMAT TYPE IS HEX (X), OR, IF THE ADDRESS TYPE IS REG, XCTL TO * 19150002
*  IKJEGLST WITH THE 'PCHLSTVL' SW IN 'TCOMTAB(TSTFLGS1)' SET TO 1    * 19200002
*  TO SHOW ENTRY FROM IKJEGLSA                                          19250002
         SPACE                                                          19300002
LSTHEX   DS    0H                                                       19350002
LSTREG   DS    0H                                                       19400002
         SPACE                                                          19450002
*        THE FOLLOWING XCTL IS EXECUTED TO OBTAIN LST                   19500002
         SPACE 2                                                        19550002
NOBLDL   DS    0H                                                       19600002
         L     R13,BACKPTR(R13)    PICK UP ADDR OF CALLERS SAVE AREA    19650002
         LA    R15,LXCTL           SET UP PTR TO LIST FORM OF XCTL MAC  19700002
         LA    R1,LXCTL1           SET UP PTR TO LIST XCTL PARM LIST    19750002
         ST    R8,LSTPDEPT(R1)     PASS PTR TO CUR ADDR PDE             19800002
         ST    R10,LSTWRKPT(R1)    PASS BASE ADDR OF LSTWORK DSECT      19850002
         OI    TSTFLGS1,PCHLSTVL   INDICATE CALL IS FROM IKJEGLSA       19900002
         OI    TSTFLGS2,TSTXCTL    INDICATE XCTL WITHIN LIST SUB-CMD    19950002
         SPACE                                                          20050002
         XCTL  (2,12),EP=IKJEGLST,SF=(E,(15))                           20100002
         SPACE                                                          20150002
SMTXCTL  DS    0H                  SMT TEST LABEL FOR XCTL MAC          20200002
         TITLE 'IKJEGLSA, ''LIST'', WRAPUP AND NON-ZERO RETURN CODES'   20250002
*********************************************************************** 20300002
*                                                                     * 20350002
*  COMPLETION ROUTINE, TESTS FOR ADDITIONAL ADDRESSES TO LIST AND     * 20400002
*  SETS A 0 RETURN CODE. WHEN ALL ADDRESSES HAVE BEEN PROCESSED,      * 20450002
*  THE ROUTINE RETURNS TO THE CALLER.                                 * 20500002
*                                                                     * 20550002
*********************************************************************** 20600002
         SPACE                                                          20650002
LSTCC0   DS    0H                                                       20700002
         TM    COMFLGS,OUTCORE     WAS THERE AN OUT OF CORE REQUEST     20750002
         BZ    LSTOK               BRANCH IF NOT                        20800002
         BAL   R7,LSTOUT           GO PUT OUT MESSAGE IF SO             20850002
LSTOK    DS    0H                                                       20900002
         TM    PDE2CHAI,HEXFF      IS THERE ANOTHER ADDRESS PDE         20950002
         BNO   MORE                IF YES, BRANCH                       21000002
LSTMN90  DS    0H                                                       21050002
*  TURN OFF ALL SWITCH'S WHICH MAY HAVE BEEN USED.                      21100002
         NI    TSTFLGS1,HEXFF-TSTPRINT-TSTFIRST-PCHLSTVL-RANGESW        21150002
         ESTAE 0,OV                REMOVE ESTAE                         21160002
         L     R15,LSTRETCD        PICK UP RETURN CODE                  21200002
         L     R13,BACKPTR(R13)    GET ADDR OF PREVIOUS SAVE AREA.      21250002
         NI    TSTFLGS4,HEXFF-TSTRERTN TURN OFF RETRY IN PROCESS IF ON  21260002
         RETURN (14,12),RC=(15)    RETURN TO CALLER                     21300002
         SPACE                                                          21350002
MORE     DS    0H                                                       21400002
         L     R6,OUTBUF           GET ADDR OF OUTPUT BUFFER            21450002
         ST    R6,DATAPT           SET UP THE IO PARM LIST              21500002
         BAL   R7,LSTIO            GO TO IO RTN TO VERTICAL SPACE 1     21550002
         SPACE                                                          21600002
         XC    LSTRPT(RPTSIZE),LSTRPT  CLEAR ADDR PORTION OF WORK AREA  21650002
         L     R8,PDE2CHAI         GET ADDR OF NEXT PDE FROM CHAIN PTR  21700002
         IC    R2,TYPESAVE         GET TYPE CODE OR DEFAULT TYPE CODE   21750002
         STC   R2,A1TYPE           SET FORMAT TYPE (EXCEPT FOR SYMBOLS) 21800002
         B     LSTMN04             GO BACK AND PROCESS NEXT ADDR        21850002
         SPACE                                                          21900002
LSTCC16  DS    0H                                                       21950002
         LA    R15,SIXTEEN         R15=16                               22000002
         ST    R15,LSTRETCD        RC=16                                22050002
         B     LSTMN90             GO CLEAN UP AND RETURN               22100002
         SPACE                                                          22150002
LSTCVTRC DS    0H                                                       22200002
         CH    R15,H16             IS RC=16                             22250002
         BE    LSTCC16             IF EQUAL, ATTN, BRANCH               22300002
         B     LSTCC0              OTHERWISE, GO CHECK FOR MORE ADDRS   22350002
         EJECT                                                          22400002
*********************************************************************** 22450002
*                                                                     * 22500002
*  SYMBOLIC ADDRESS SETUP ROUTINE. THIS ROUTINE SETS UP THE A1 FIELD  * 22550002
*  AND FILLS IN ANY ATTRIBUTES NOT OVER-RIDDEN BY THE USER.           * 22600002
*                                                                     * 22650002
*********************************************************************** 22700002
SYM1     DS    0H                                                       22750002
         TM    LSTFLGS,TYPEFLG     WAS A TYPE GIVEN BY THE USER         22800002
         BO    HAVETYPE            IF GIVEN, IGNORE ATTRS OF SYMBOL     22850002
         SR    R2,R2               CLEAR A REG,                         22900002
         IC    R2,SITYPE(R15)          PICK UP THE TYPE,                22950002
         STC   R2,A1TYPE                   AND MAKE IT THE TYPE FOR A1  23000002
HAVETYPE DS    0H                                                       23050002
         TM    LSTFLGS,LNTHFLG     WAS LNTH ATTR GIVEN BY USER          23100002
         BO    SYM1L               IF GIVEN, IGNORE ATTRS OF SYMBOL     23150002
         LH    R2,SILEN(R15)       PICK UP SYMS LENGTH ATTR             23200002
         STH   R2,A1L              ESTABLISH SYMS LNTH FOR THIS DATA    23250002
SYM1L    DS    0H                                                       23300002
         TM    LSTFLGS,MULTIFLG    WAS MULTIPLICITY ATTR GIVEN BY USER  23350002
         BO    SYM1M               IF GIVEN, IGNORE ATTRS OF SYMBOL     23400002
         LH    R2,SIMUL(R15)       PICK UP SYMS MULTIPLICITY FACTOR     23450002
         STH   R2,A1M              EST. SYMS MULTI FOR THIS DATA        23500002
SYM1M    DS    0H                                                       23550002
         L     R15,SIDATAPT(R15)   GET PTR TO INPUT FROM SYMINFO BLOCK  23600002
         OI    A1FLG,A1SYM         SET FLAG TO INDICATE ADDR SYMBOLIC   23650002
         B     LSTMN07             RETURN TO MAINLINE SETUP ROUTINE     23700002
         TITLE 'IKJEGLSA, ''LIST'', CHARACTER FORMATTING ROUTINE'       23750002
*********************************************************************** 23800002
*                                                                     * 23850002
*  CHARACTER FORMATTING ROUTINE.                                      * 23900002
*                                                                     * 23950002
*********************************************************************** 24000002
         SPACE                                                          24050002
LSTCHAR  DS    0H                                                       24100002
         TM    COMFLGS,TWOADDRS    TEST FOR 1 OR 2 ADDRESSES            24150002
         BO    LSTC20              IF TWO, BRANCH                       24200002
         SR    R0,R0               SET UP A CONSTANT OF 0               24250002
         CH    R0,A1M              WAS MULTIPLICITY GIVEN               24300002
         BNE   LSTC04              IF GIVEN, BRANCH                     24350002
         MVI   A1M+H2ND,ONE        DEFAULT MULTIPLICITY TO ONE          24400002
LSTC04   DS    0H                                                       24450002
         CH    R0,A1L              WAS A LENGTH GIVEN                   24500002
         BNE   LSTC06              IF GIVEN, BRANCH                     24550002
         MVI   A1L+H2ND,ONE        DEFAULT LENGTH TO ONE                24600002
         SPACE                                                          24650002
LSTC06   DS    0H                                                       24700002
         BAL   R14,LSTLMTCK        GO CHECK UPPER ADDR OF THIS REQUEST  24750002
         BAL   R14,ADDRCHK         GO CHECK VALIDITY 2ND ADDR           24760002
         LTR   R15,R15             HAS THE MULTIPLICITY BECOME ZERO     24800002
         BNZ   LSTCC0              IF ZERO, BRANCH                      24850002
         LH    R1,A1L              GET LENGTH GIVEN BY USER             24900002
         CH    R1,H32              COMPARE IT TO MAX-CHARS/LINE         24950002
         BH    LSTC24              IF GREATER THAN MAX, BRANCH          25000002
LSTC08   DS    0H                                                       25050002
         XC    REMAIN,REMAIN       SET REMAINDER TO 0                   25100002
         LH    R4,A1M              SET CONTROL TO MULTIPLICITY          25150002
LSTC10   DS    0H                                                       25200002
         STH   R1,VPDEL            PUT LENGTH IN VALUE PDE AND          25250002
         STH   R1,A1L                  IN LENGTH FIELD.                 25300002
         TM    A1FLG,A1SYM         TEST ADDRESS TYPE OF ADDR 1.         25350002
         BZ    LSTC12              IF TYPE IS ABSOLUTE, BRANCH          25400002
         BO    LSTC40              IF TYPE IS SYMBOLIC, BRANCH          25450002
         SPACE                                                          25500002
*  SETUP ROUTINE FOR RELATIVE TYPE ADDRESSES                            25550002
         SPACE                                                          25600002
         MVC   APDE(APL),IKJPARMA  MOVE ORIGINAL PDE TO WORK AREA       25650002
         SPACE                                                          25700002
LSTC12   DS    0H                                                       25750002
         LA    R2,A1               SET UP PTR TO CURRENT ADDRESS FLD    25800002
         ST    R2,APDE+(PDEADRPT-IKJPARMA) STORE IT IN THE ADDR PDE     25850002
         B     LSTC50              GO TO CHAR PROCESS ROUTINE           25900002
         SPACE 3                                                        25950002
*  SETUP ROUTINE FOR TWO ADDRESSES                                      26000002
         SPACE                                                          26050002
LSTC20   DS    0H                                                       26100002
         L     R1,A2               R3=ADDR2                             26150002
         S     R1,A1               ADDR2-ADDR1=LNTH EXCLUDING END BYTE  26200002
         LA    R1,ONE(R1)          ADD 1 TO INCLUDE BYTE AT END         26250002
         STH   R1,A1L              SET LENGTH TO A2-A1+1                26300002
         MVI   A1M+H2ND,ONE        SET MULTIPLICITY TO ONE              26350002
         CH    R1,H32              IS COMPUTED LNTH GT MAX-CHARS/LINE   26400002
         BNH   LSTC08              IF NOT GREATER THAN MAX, BRANCH      26450002
         B     LSTC26              BRANCH TO ROUTINE FOR MULTIPLE LINES 26500002
         SPACE                                                          26550002
LSTC24   DS    0H                                                       26600002
         OI    COMFLGS,ARTIMSW     TURN ON ARTIFICIAL MULTIPLICITY SW   26650002
LSTC26   DS    0H                                                       26700002
         LA    R2,CFLDMASK         MASK TO ISOLATE REMAINDER            26750002
         LH    R4,A1L              R4=LENGTH TO BE LISTED               26800002
         NR    R2,R4               R2=REMAINDER OF LNTH/CHARLEN         26850002
         SRL   R4,FIVE             DIVIDE LNTH BY 32                    26900002
         STH   R2,REMAIN           SAVE REMAINDER                       26950002
         STH   R2,REMAIN2          SAVE A COPY OF THE REMAINDER         27000002
         STH   R4,ARTIFMUL         SAVE CONTROL, (QUOTIENT). R4=CONTROL 27050002
         LA    R1,CHARLEN          SET UP MAX-CHARS/LINE AS LENGTH      27100002
         B     LSTC10              RETURN TO COMMON SETUP RTN           27150002
         SPACE 2                                                        27200002
*  SETUP ROUTINE FOR SYMBOLIC ADDRESSES                                 27250002
         SPACE                                                          27300002
LSTC40   DS    0H                                                       27350002
         BAL   R7,LSTSYM           GO MOVE SYMBOL TO BUF                27400002
         L     R3,CONAREA          SET UP PTR TO CONVERT OUTPUT AREA    27450002
         CH    R4,HONE             IS CONTROL = 1                       27500002
         BH    LSTC42              IF GREATER THAN 1 BRANCH             27550002
         SR    R15,R15             MAKE A ZERO CONSTANT                 27600002
         CH    R15,ARTIFMUL        IS THERE AN ARTIFICIAL MULTIPLICITY  27650002
         BNE   LSTC42              IF YES, BRANCH                       27700002
         CH    R15,REMAIN          IS THERE A REMAINDER                 27750002
         BNE   LSTC42              IF YES, BRANCH                       27800002
         LH    R15,A1L             GET LENGTH OF OUTPUT FIELD           27850002
         LA    R15,SP2(R6,R15)     CALCULATE BUF PTR AT END OF DATA     27900002
         C     R15,ENDOBUF         WILL ADDR + DATA FIT IN THE BUFFER   27950002
         BNH   LSTC58              IF DATA WILL FIT, BRANCH             28000002
         SPACE                                                          28050002
LSTC42   DS    0H                                                       28100002
         BAL   R7,LSTIO            GO OUTPUT ADDR ON A SEPARATE LINE    28150002
         B     LSTC54              GO OUTPUT REL ADDRS AND DATA.        28200002
         SPACE                                                          28250002
*********************************************************************** 28300002
*                                                                     * 28350002
*  PROCESS LOOP OF LSTCHAR SUBROUTINE. CALLS 'LSTBPT' TO REMOVE ANY   * 28400002
*  BREAKPOINTS FROM THE INPUT DATA, THEN CALLS IKJEGCVT TO CONVERT    * 28450002
*  THE DATA ADDRESS TO PRINTABLE, AND THEN TRANSLATES UNPRINTABLES TO * 28500002
*  PERIODS. WHER BUF IS READY, LSTIO IS CALLED TO OUTPUT A LINE OF    * 28550002
*  DATA. IF THE ADDRESS WAS SYMBOLIC, THE ROUTINE MAY BE ENTERED AT   * 28600002
*  LSTC54 OR LSTC58, NORMAL ENTRY IS TO LSTC50.                       * 28650002
*  AT THIS POINT, THE ADDRESS IS IN THE BUFFER AND THE DATA MUST BE   * 28700002
*  MOVE TO THE BUFFER AND HAVE THE UNPRINTABLES TRANSLATED TO PERIODS * 28750002
*                                                                     * 28800002
*********************************************************************** 28850002
LSTC50   DS    0H                                                       28900002
         L     R6,OUTBUF           GET PTR TO OUTPUT BUFFER             28950002
         LA    R6,DATAOFF(R6)      INCRE BUF PTR PAST LL00 FIELD        29000002
LSTC52   DS    0H                                                       29050002
         BAL   R14,LSTBPT          GO CLEAR BREAKPOINT SVC'S FROM DATA  29100002
LSTC54   DS    0H                                                       29150002
         L     R15,TSTCONVT        ADDR OF CONVERT ROUTINE              29200002
         LA    R1,APDE             R1=ADDR OF ADDR PDE                  29250002
         SR    R0,R0               R0=0                                 29300002
         LCR   R1,R1               MAKE NEGATIVE FOR ADDR CONVERSION    29350002
         BCTR  R0,NULL             R0 NEGATVE FOR CONVERT TO PRINTABLE  29400002
         BALR  R14,R15             GO CONVERT AN ADDR TO PRINTABLE      29450002
         LTR   R15,R15             TEST RETURN CODE                     29500002
         BNZ   LSTCVTRC            IF RC IS NON-ZERO, GO ANALYZE.       29550002
         L     R1,CONAREA          ADDR OF CONVERT OUTPUT AREA          29600002
         MVC   ZERO(ADDRLEN,R6),CONDATA(R1)    MOVE CONVERTED ADDR      29650002
         LA    R6,ADDRLEN(R6)      INCRE BUF PTR PAST ADDR              29700002
LSTC58   DS    0H                                                       29750002
         LH    R1,A1L              GET PERMANENT DATA LENGTH            29800002
         LH    R2,VPDEL            PICK UP LENGTH OF THIS DATA FIELD    29850002
         LA    R1,SP2(R1,R6)       CALCULATE POTENTIAL END OF LINE ADDR 29900002
         C     R1,ENDOBUF          WILL DATA + ADDR FIT IN THE BUFFER   29950002
         BNH   LSTC64              IF ADDR+DATA WILL FIT, BRANCH        30000002
         BAL   R7,LSTIO            OTHERWISE, GO OUTPUT ADDR ON SEP LN  30050002
LSTC64   DS    0H                                                       30100002
         MVC   TWO*SP1(CHARLEN,R6),HOLDAREA    MOVE MAX POSSIBLE BYTES  30150002
         TR    TWO*SP1(CHARLEN,R6),TRTABLE     TRANSLATE TO PRINTABLE   30200002
         LA    R6,TWO*SP1(R2,R6)   INCRE BUF PTR PAST DATA              30250002
         BAL   R7,LSTIO            GO OUTPUT THE DATA                   30300002
         A     R2,VPDEPT           CALCULATE NEW INPUT ADDR             30350002
         ST    R2,VPDEPT           SET NEW INPUT ADDRESS                30400002
         BCT   R4,LSTC52           TEST AND DECREMTN CNTRL              30450002
         CH    R4,REMAIN           IS REMAINDER NON-ZERO                30500002
         BE    LSTC70              IF NOT, BRANCH                       30550002
         LH    R1,REMAIN           R1=REMAINDER LENGTH                  30600002
         STH   R1,VPDEL            SET VALUE PDE FOR REMAINDED LNTH     30650002
         STH   R4,REMAIN           SET REMAINDER TO ZERO                30700002
         LA    R4,ONE              SET CONTROL TO 1 FIELD.              30750002
         B     LSTC52              GO BACK AND PROCESS REMAINDER        30800002
         SPACE                                                          30850002
LSTC70   DS    0H                                                       30900002
         TM    COMFLGS,ARTIMSW     WAS CONTROL AN ARTIFICIAL MLTPLCTY   30950002
         BNO   LSTCC0              IF NOT, RETURN TO LIST MAINLINE      31000002
         LH    R15,A1M             R15=TRUE MULTIPLICITY                31050002
         BCT   R15,LSTC74          TEST AND DECRE MULTIPLICITY          31100002
         B     LSTCC0              IF NO MORE TO DO, RETURN TO MAINLINE 31150002
LSTC74   DS    0H                                                       31200002
         STH   R15,A1M             SAVE DECREMENTED VALUE               31250002
         LH    R1,A1L              R1=LENGTH OF AN OUTPUT FIELD.        31300002
         LH    R2,REMAIN2          PICK UP REMAINDER                    31350002
         LH    R4,ARTIFMUL         RESET CONTROL TO ARTIFICIAL MLTPLCTY 31400002
         STH   R1,VPDEL            RESET LENGTH OF OUTPUT FIELD         31450002
         STH   R2,REMAIN           RESET REMAINDER                      31500002
         B     LSTC52              GO PROCESS NEXT FIELD                31550002
         TITLE 'IKJEGLSA, ''LIST'', FORMAT INITIALIZATION'              31600002
*********************************************************************** 31650002
*                                                                     * 31700002
*  THE FOLLOWING ROUTINES SET UP LIMITS AND DEFAULT VALUES FOR THEIR  * 31750002
*  RESPECTIVE ASSEMBLER TYPES.  AFTER SETUP, CONTROL IS PASSED TO     * 31800002
*  A COMMON ROUTINE TO CHECK VALUES AND SET ANY NECESSARY DEFAULTS.   * 31850002
*                                                                     * 31900002
*********************************************************************** 31950002
         SPACE                                                          32000002
PACKED   DS    0H                                                       32050002
         LA    R0,MAXPLEN          R0= LNTH LIMIT                       32100002
         SR    R1,R1               R1=SHIFT VALUE TO DIVIDE BY 1        32150002
         LA    R2,ONE              R2=DEFAULT LNTH                      32200002
         LA    R3,POUTMAX          R3=LNTH MAX FOR OUTPUT               32250002
         B     LSTGEN00            GO TO COMMAN ROUTINE                 32300002
         SPACE                                                          32350002
ZONED    DS    0H                                                       32400002
         LA    R0,MAXPLEN          SAME LIMIT AS PACKED                 32450002
         SR    R1,R1               R1=SHIFT VALUE TO DIVIDE BY 1        32500002
         LA    R2,ONE              DEFAULT LNTH                         32550002
         LA    R3,ZOUTMAX          MAX FLD SIZE FOR Z OUTPUT            32600002
         B     LSTGEN00            GO TO COMMON ROUTINE                 32650002
         SPACE                                                          32700002
LCON     DS    0H                                                       32750002
         LA    R15,HEXCODE         CONVERT TO HEX CHAR FOR PRINTING     32800002
         LA    R0,MAXPLEN          SAME LIMIT AS PACKED                 32850002
         LA    R1,FOUR             R1=SHIFT VALUE TO DIVIDE BY 16       32900002
         LA    R2,SIXTEEN          DEFAULT LENGTH                       32950002
         LA    R3,LOUTMAX          MAX FLD SIZE FOR L OUTPUT            33000002
         B     LSTGEN00            GO TO COMMON ROUTINE                 33050002
         SPACE                                                          33100002
FCON     DS    0H                                                       33150002
         LA    R0,MAXFLEN          R0=LENGTH LIMIT                      33200002
         LA    R1,TWO              R1=SHIFT VALUE TO DIVIDE BY 4        33250002
         LA    R2,FOUR             DEFAULT LENGTH                       33300002
         LA    R3,FOUTMAX          MAX OUTPUT LNTH                      33350002
         B     LSTGEN00            GO TO COMMON ROUTINE                 33400002
         SPACE                                                          33450002
ECON     DS    0H                                                       33500002
         LA    R0,MAXFLEN          SAME LIMIT AS F TYPE                 33550002
         LA    R1,TWO              R1=SHIFT VALUE TO DIVDIE BY 4        33600002
         LA    R2,FOUR             DEFAUT LENGTH                        33650002
         LA    R3,EOUTMAX          MAX OUTPUT FIELD SIZE                33700002
         B     LSTGEN00            GO TO COMMON ROUTINE                 33750002
         SPACE                                                          33800002
HCON     DS    0H                                                       33850002
         LA    R0,MAXFLEN          SAME LIMIT AS F TYPE                 33900002
         LA    R1,ONE              R1=SHIFT VALUE TO DIVIDE BY 2        33950002
         LA    R2,TWO              DEFAULT LENGTH                       34000002
         LA    R3,FOUTMAX          SAME LIMIT AS F TYPE                 34050002
         B     LSTGEN00            GO TO COMMON ROUTINE                 34100002
         SPACE                                                          34150002
DCON     DS    0H                                                       34200002
         LA    R0,MAXFLEN          SAME LIMIT AS F TYPE                 34250002
         LA    R1,THREE            R1=SHIFT VALUE TO DIVIDE BY 8        34300002
         LA    R2,EIGHT            DEFAULT LENGTH                       34350002
         LA    R3,EOUTMAX          SAME LIMIT AS E TYPE                 34400002
         B     LSTGEN00            GO TO COMMON ROUTINE                 34450002
         SPACE                                                          34500002
ACON     DS    0H                  ALSO Q AND V FORMATS                 34550002
         LA    R0,MAXALEN          R0=LNTH LIMIT                        34600002
         LA    R1,TWO              R1=SHIFT VALUE TO DIVIDE BY 4        34650002
         LA    R2,FOUR             DEFAULT LENGTH                       34700002
         LA    R3,AOUTMAX          MAX OUTPUT FLD SIZE                  34750002
         B     LSTGEN00            GO TO COMMON ROUTINE                 34800002
         SPACE                                                          34850002
YCON     DS    0H                                                       34900002
         LA    R0,MAXYLEN          LENGTH LIMIT                         34950002
         LA    R1,ONE              R1=SHIFT VALUE TO DIVIDE BY 2        35000002
         LA    R2,TWO              DEFAULT LENGTH                       35050002
         LA    R3,YOUTMAX          MAX OUTPUT FLD SIZE                  35100002
         B     LSTGEN00            GO TO COMMON ROUTINE                 35150002
         SPACE                                                          35200002
SCON     DS    0H                                                       35250002
         LA    R0,MAXYLEN          SAME LIMIT AS Y TYPE BUT MUST BE EQ  35300002
         TM    LSTFLGS,LNTHFLG     DID USER SPECIFY LENGTH              35350002
         BNO   SCON04              IF NOT, USE DEFAULT LENGTH           35400002
         CH    R0,A1L              IS LNTH EXACTLY TWO                  35450002
         BNE   LSTSERR             IF LENGTH NOT 2, BRANCH              35500002
SCON04   DS    0H                                                       35550002
         LA    R1,ONE              R1=SHIFT VALUE TO DIVIDE BY TWO      35600002
         LA    R2,TWO              DEFAULT LENGTH                       35650002
         LA    R3,SOUTMAX          MAX OUTPUT FIELD SIZE                35700002
         B     LSTGEN00            GO TO COMMON ROUTINE                 35750002
LSTSERR  DS    0H                                                       35800002
         L     R7,OUTBUF           PICK UP ADDRESS FOR MSG INSERT       35850002
         MVC   ZERO(TWO,R7),LENFIVE   MOVE IN MESSAGE INSERT LENGTH     35880002
         MVI   FOUR(R7),C'S'       MOVE INTO INSERT INSERT TEXT         35890002
         LA    R2,M0019            PUT MESSAGE TO ISSUE NUMBER IN REG   35900002
         LA    R3,ZERO             INDICATE - NO SECOND LEVEL           35910002
         B     MSGOUT              GO ISSUE MESSAGE                     36150002
         TITLE 'IKJEGLSA, ''LIST'', GENERAL FORMATTING ROUTINE'         36200002
*********************************************************************** 36250002
*                                                                     * 36300002
*  GENERAL ROUTINE FOR LISTING DATA IN P, S, AQV, H, F, E, D, AND L   * 36350002
*  FORMATS. THE ROUTINE IS ENTERED FROM THE SETUP ROUTINE FOR THE     * 36400002
*  REGUESTED TYPE. AT ENTRY THE FOLLOWING REGS MUST BE SET.           * 36450002
*        R0=MAXIMUM LENGTH FOR THE PARTICULAR CONSTANT TYPE.          * 36500002
*        R1=A SHIFT VALUE FOR DIVIDING A RANGE INTO DEFAULT SIZED FLDS* 36550002
*        R2=THE DEFAULT LENGTH TO BE USED IF NONE GIVEN BY USER       * 36600002
*        R3=MAXIMUM LENGTH FOR OUTPUT IN THE GIVEN DATA TYPE.         * 36650002
*        R15=HEX CODE FOR REQUESTED TYPE                              * 36700002
*                                                                     * 36750002
*********************************************************************** 36800002
         SPACE                                                          36850002
LSTGEN00 DS    0H                                                       36900002
         STC   R15,VPDET           TYPE CODE TO PDE FOR CONVERT         36950002
         TM    COMFLGS,TWOADDRS    TEST FOR ONE ON TWO ADDRS            37000002
         BO    LSTGEN20            IF TWO, BRANCH                       37050002
*  SET UP FOR 1 ADDRESS                                                 37100002
         SR    R15,R15             GET A ZERO COMPAREND                 37150002
         CH    R15,A1M             WAS MULTIPLICITY GIVEN               37200002
         BNE   LSTGEN04            IF GIVEN, BRANCH                     37250002
         MVI   A1M+H2ND,ONE        DEFAULT MULTIPLICITY TO ONE          37300002
LSTGEN04 DS    0H                                                       37350002
         CH    R15,A1L             WAS LENGTH GIVEN                     37400002
         BE    LSTGEN08            IF NOT, BRANCH AND USE DEFAULT LNTH  37450002
         LH    R2,A1L              PICK UP GIVEN LENGTH                 37500002
LSTGEN08 DS    0H                                                       37550002
         CR    R2,R0               TEST REQUESTED FIELD LENGTH          37600002
         STH   R2,VPDEL            LENGTH TO VALUE PDE, ANTICIPATE OK.  37650002
         BH    LSTGEN90            IF LENGTH GREATER THAN MAX, BRANCH   37700002
         STH   R2,A1L              SAVE LENGTH TO BE USED IN THIS LIST  37750002
         BAL   R14,LSTLMTCK        GO CHECK UPPER ADDR OF THIS REQUEST  37800002
         BAL   R14,ADDRCHK         GO CK VALIDITY OF 2ND ADDR           37810002
         LTR   R15,R15             WAS REMAINING MULTIPLICITY ZERO      37850002
         BNZ   LSTCC0              IF ZERO, BRANCH                      37900002
         LH    R4,A1M              SET CONTROL TO MULTIPLICITY          37950002
LSTGEN10 DS    0H                                                       38000002
         TM    A1FLG,A1SYM         WHAT IS THE ADDRESS TYPE             38050002
         BZ    LSTGEN12            IF ADDRESS IS ABSOLUTE, BRANCH       38100002
         BO    LSTGEN40            IF SYMBOLIC, BRANCH                  38150002
         SPACE                                                          38200002
*  IF THE ADDRESS TYPE IS RELATIVE, FALL THRU AND SET UP FOR RELATIVES  38250002
         SPACE                                                          38300002
         MVC   APDE(APL),IKJPARMA  MOVE ORIGINAL PDE TO WORK AREA       38350002
LSTGEN12 DS    0H                                                       38400002
         LA    R2,A1               GET PTR TO INPUT DATA ADDRESS        38450002
         ST    R2,APDE+(PDEADRPT-IKJPARMA) STORE IT IN THE ADDR PDE     38500002
         CLI   A1TYPE,ZONECODE     IS REQUESTED FORMAT ZONED            38550002
         BE    LSTZ50              IF ZONED, BRANCH TO SPECIAL RTN      38600002
         B     LSTGEN50            GO PROCESS DATA                      38650002
         SPACE                                                          38700002
*  SET UP FOR 2 ADDRESSES                                               38750002
LSTGEN20 DS    0H                                                       38800002
         STH   R2,VPDEL            FOR ADDR RANGE, USE DEFAULT LNTH     38850002
         L     R4,A2               R4=2ND ADDRESS IN RANGE              38900002
         AR    R4,R2               INCLUDE FIELD AT 2ND ADDRESS         38950002
         C     R4,ENDADR           DOES THIS ADDR EXCEED HIGHEST ADDR   39000002
         BNH   LSTGEN24            IF NOT, BRANCH                       39050002
         SR    R4,R2               EXCLUDE LAST FIELD IF OUT OF CORE    39100002
LSTGEN24 DS    0H                                                       39150002
         S     R4,A1               CALCULATE RANGE IN BYTES             39200002
         SRA   R4,ZERO(R1)         DIVIDE RANGE BY FIELD LENGTH         39250002
         B     LSTGEN10            GO BACK TO COMMON RTN.               39300002
         SPACE                                                          39350002
LSTGEN40 DS    0H                                                       39400002
         BAL   R7,LSTSYM           GO MOVE SYMBOLS TO BUF               39450002
         CH    R4,HONE             TEST CONTROL FOR MORE THAN 1 FIELD   39500002
         BH    LSTGEN42            IF MORE THAN 1, BRANCH               39550002
         LA    R15,ONE(R3,R6)      R15=MAX POSSIBLE NEEDED LNTH         39600002
         C     R15,ENDOBUF         WOULD THIS BE OUT OF BUF.            39650002
         BH    LSTGEN42            IF OUT OF BUF, BRANCH                39700002
         L     R3,CONAREA          SET UP PTR TO CONVERT OUTPUT AREA    39750002
         CLI   A1TYPE,ZONECODE     IS OUTPUT FORMAT TO BE ZONED         39800002
         BE    LSTZ58              IF ZONED, BRANCH TO SPECIAL RTN      39850002
         B     LSTGEN58            OTHERWISE, DATA WILL FIT, PROCESS IT 39900002
LSTGEN42 DS    0H                                                       39950002
         BAL   R7,LSTIO            GO OUTPUT THE SYMBOLIC ADDRESS       40000002
         CLI   A1TYPE,ZONECODE     IS OUTPUT FORMAT TO BE ZONED         40050002
         BE    LSTZ54              IF ZONED, BRANCH TO SPECIAL RTN      40100002
         B     LSTGEN54            GO PROCESS ADDRESSES AND DATA        40150002
         SPACE 2                                                        40200002
*********************************************************************** 40250002
*                                                                     * 40300002
*  MAIN PROCESS PORTION OF THE GENERAL LIST ROUTINE                     40350002
*        FIRST, GO CONVERT THE ADDRESS TO PRINTABLE                   * 40400002
*  AT THIS POINT, THE ADDRESS HAS BEEN PLACED IN THE BUFFER.          * 40450002
*        NEXT, GO CONVERT THE DATA TO THE PROPER FORMAT AND MOVE IT   * 40500002
*        TO THE BUFFER.                                               * 40550002
*********************************************************************** 40600002
LSTGEN50 DS    0H                                                       40650002
         L     R6,OUTBUF           GET PTR TO THE OUTPUT BUFFER         40700002
         LA    R6,DATAOFF(R6)      INCRE BUFFER PTR PAST LL00 FIELD     40750002
LSTGEN52 DS    0H                                                       40800002
         BAL   R14,LSTBPT          GO CLEAR BREAKPOINT SVC'S FROM DATA  40850002
LSTGEN54 DS    0H                                                       40900002
         SR    R0,R0               R0=0                                 40950002
         LA    R1,APDE             R1=ADDR OF ADDRESS PDE               41000002
         L     R15,TSTCONVT        R15=ADDR OF CONVERT ROUTINE          41050002
         BCTR  R0,NULL             R0=NEGATIVE FOR CONVERT TO PRINTABLE 41100002
         LCR   R1,R1               R1=NEG TO SHW ADDRESS CONVERSION     41150002
         BALR  R14,R15             GO TO CONVERT ROUTINE                41200002
         LTR   R15,R15             TEST RETURN CODE FROM IKJEGCVT       41250002
         BNZ   LSTCVTRC            IF NON-ZERO, GO ANALYZE              41300002
         L     R3,CONAREA          ADDR OF CONVERT OUTPUT AREA          41350002
         MVC   ZERO(ADDRLEN,R6),CONDATA(R3)  MOVE CONVERTED ADDR TO BUF 41400002
         LA    R6,ADDRLEN(R6)      INCREMENT BUF PTR PAST ADDRESS       41450002
LSTGEN58 DS    0H                                                       41500002
         L     R15,TSTCONVT        R15=ADDR OF CONVERT ROUTINE          41550002
         LA    R1,VPDE             R1=ADDR OF VALUE PDE                 41600002
         BALR  R14,R15             GO CONVERT DATA TO PROPER FORMAT     41650002
         LTR   R15,R15             TEST RETURN CODE FROM IKJEGCVT       41700002
         BNZ   LSTCVTRC            IF NON-ZERO, BRANCH AND ANALYZE      41750002
         IC    R15,CONLNTH(R3)     GET LENGTH OF CONVERTED DATA         41800002
         BCTR  R15,NULL            DECREMENT LENGTH FOR MVC INSTR       41850002
         EX    R15,DATAMOVE        MOVE CONVERTED DATA TO BUF           41900002
         LA    R6,SP2+ONE(R15,R6)  INCREMENT BUF PTR PAST SPACE+DATA    41950002
         L     R15,VPDEPT          R15=PTR TO LAST DATA                 42000002
         AH    R15,VPDEL           ADD LNTH OF DATA JUST PROCESSED      42050002
         ST    R15,VPDEPT          STORE UPDATE DATA PTR                42100002
         BAL   R7,LSTIO            GO OUTPUT ADDR AND 1 FIELD           42150002
         BCT   R4,LSTGEN52         IF MORE FIELDS, LOOP BACK            42200002
         B     LSTCC0              OTHERWISE, GO TO COMPLETION RTN      42250002
         SPACE                                                          42300002
         SPACE                                                          42350002
*  MGS FORMATTING ROUTINE FOR LSTGEN AND LST I ROUTINES.                42400002
LSTGEN90 DS    0H                                                       42450002
         SR    R5,R5               CLEAR OUT REGISTER                   42452002
         IC    R5,VPDET            PICK UP TYPE CODE FOR DATA           42460002
         SRL   R5,TWO              DIVIDE HEX TYPE CODE BY 4 FOR INDEX  42470002
         L     R4,OUTBUF           PICK UP ADDRESS TO BUILD INSERT      42480002
         MVC   ZERO(TWO,R4),LENFIVE  MOVE THE CONTROL LENGTH IN         42490002
         LA    R5,LSTTYPE(R5)      SET UP PTR TO TYPE CODE              42500002
         MVC   FOUR(TYPELEN,R4),ZERO(R5)  MOVE TYPE CODE TO INSERT      42510002
         XC    TSTIOPRM,TSTIOPRM   ZERO OUT I/O PARM LIST               43050002
         IKJEGSIO MSG,FIRST=M0019,INST11=(ADDR,(R4)),ID=LSA19,         *43410002
               MF=(E,TSTIOPRM)     CALL I/O TO ISSUE ERROR MESSAGE      43420002
         CH    R15,H16             TEST FOR SERIOUS ERROR CONDITION     43430002
         BL    LSTCC0              IF NOT SERIOUS TRY NEXT ADDRESS      43440002
         ST    R15,LSTRETCD        SAVE RETURN CODE FOR MAINLINE        43440402
         B     LSTMN90             IF SERIOUS GO BACK TO MAINLINE       43442002
         TITLE 'IKJEGLSA, ''LIST'', ZONED DECIMAL FORMATTING ROUTINE'   43500002
*********************************************************************** 43550002
*                                                                     * 43600002
*  AFTER BEING SETUP BY THE COMMON ROUTINE, CONTROL IS PASSED TO THIS * 43650002
*  ROUTINE IF THE FORMAT IS TO BE ZONED. ENTRY IS AS FOLLOWS          * 43700002
*        TO LSTZ50 FOR RELATIVE AND ABSOLUTEADDRESSES                 * 43750002
*        TO LSTZ54 FOR SYMBOLIC ADDRESSES WITH MULTIPLE OUTPUT LINES  * 43800002
*        TO LSTZ58 FOR SYMBOLIC ADDRESSES WITH ONLY ONE OUTPUT LINE   * 43850002
*                                                                     * 43900002
*  THIS ROUTINE VALIDITY CHECKS THE DATA TO ASSURE ZONED FORMAT, MOVES* 43950002
*  THE CORRECT SIGN TO THE BUFFER, THE DATA TO THE BUFFER, AND SETS   * 44000002
*  THE ZONE FIELD OF THE RIGHTMOST BYTE.                              * 44050002
*                                                                     * 44100002
*********************************************************************** 44150002
         SPACE                                                          44200002
LSTZ50   DS    0H                                                       44250002
         L     R6,OUTBUF           GET PTR TO THE OUTPUT BUFFER         44300002
         LA    R6,DATAOFF(R6)      INCRE BUFFER PTR PAST LL00 FIELD     44350002
LSTZ52   DS    0H                                                       44400002
         BAL   R14,LSTBPT          GO CLEAR BREAKPOINT SVC'S FROM DATA  44450002
LSTZ54   DS    0H                                                       44500002
         SR    R0,R0               R0=0                                 44550002
         LA    R1,APDE             R1=ADDR OF ADDRESS PDE               44600002
         L     R15,TSTCONVT        ADDR OF CONVERT ROUTINE              44650002
         BCTR  R0,NULL             R0=-1 TO INDICATE CONVERT TO PRNTBL  44700002
         LCR   R1,R1               R1=NEG TO INDICATE ADDR CONVERSION   44750002
         BALR  R14,R15             GO TO CONVERT ROUTINE                44800002
         LTR   R15,R15             TEST RETURN CODE FROM IKJEGCVT       44850002
         BNZ   LSTCVTRC            IF NON-ZERO, GO ANALYZE              44900002
         L     R3,CONAREA          R3=ADDR OF CONVERT OUTPUT AREA       44950002
         MVC   ZERO(ADDRLEN,R6),CONDATA(R3)  MOVE ADDRESS TO BUF        45000002
         LA    R6,ADDRLEN(R6)      INCREMENT BUF PTR PAST ADDR          45050002
LSTZ58   DS    0H                                                       45100002
         LH    R15,VPDEL           R15=DATA FIELD LENGTH                45150002
         LR    R3,R15              SAVE A COPY OF THE LENGTH            45200002
         BCTR  R15,NULL            REDUCE LENGTH BY 1 FOR SS INSTR      45250002
         L     R1,VPDEPT           R1=PTR TO DATA                       45300002
         SR    R2,R2               CLEAR A REG                          45350002
         IC    R2,ZERO(R15,R1)     PICK UP LAST BYTE OF DATA FIELD      45400002
         CH    R2,SIGNPAT          TEST FOR VAL ZONE                    45450002
         BL    LSTZ90              IF SIGN FLD LESS THAN X'A0', BRANCH  45500002
         SRL   R2,FOUR             DISCARD RIGHT HALF OF BYTE           45550002
         IC    R2,SIGNTBL(R2)      PICK UP CORRECT SIGN                 45600002
         STC   R2,SP2(R6)          PLACE SIGN IN BUFFER                 45650002
         LA    R6,SP2+SIGNLEN(R6)  INCREMENT BUF PTR PAST SIGN          45700002
         AR    R15,R1              R15=ADDR OF LAST DATA BYTE IN BUF    45750002
         MVZ   ZERO(ONE,R15),VALZONE   MOVE A VALID ZONE TO SIGN BYTE   45800002
         LR    R15,R3              SET SAVED COPY OF THE DATA LENGTH    45850002
         LA    R3,ZERO(R3,R1)      INCREMENT DATA PTR TO NEXT DATA      45900002
         ST    R3,VPDEPT           SAVE UPDATED PTR                     45950002
         SPACE                                                          46000002
*  NEXT, ELIMINATE LEADING ZEROS (EXCEPT IF CONSTANT EQUALS).           46050002
         SPACE                                                          46100002
         BCT   R15,LSTZ66          IF LNTH GREATER THAN ONE, BRANCH     46150002
LSTZ62   DS    0H                                                       46200002
         EX    R15,ZDATAMVC        MOVE DATA TO BUF                     46250002
         LA    R15,ONE(R15)        INCREMENT DATA LNTH BY ONE           46300002
LSTZ64   DS    0H                                                       46350002
         CLI   ZERO(R6),CHAR0      CHAR MUST BE 0 OR GREATER            46400002
         BL    LSTZ90              IF LOW, BRANCH                       46450002
         CLI   ZERO(R6),CHAR9      CHAR MUST BE 9 OR LESS               46500002
         BH    LSTZ90              IF GREATER THAN 9, ERROR, BRANCH     46550002
         LA    R6,ONE(R6)          INCREMENT BUF PTR TO NEXT DATA       46600002
         BCT   R15,LSTZ64          DECRE REMAINING LNTH, TEST FOR DONE  46650002
         BAL   R7,LSTIO            IF DONE, GO OUTPUT DATA              46700002
         BCT   R4,LSTZ52           TEST FOR MORE TO DO                  46750002
         B     LSTCC0              GO TO COMPLETION ROUTINE             46800002
         SPACE                                                          46850002
LSTZ66   DS    0H                                                       46900002
         CLI   ZERO(R1),CHAR0      IS THIS CHAR A ZERO                  46950002
         BNE   LSTZ62              IF NOT, BRANCH                       47000002
         LA    R1,ONE(R1)          INCREMENT DATA PTR TO NEXT BYTE      47050002
         BCT   R15,LSTZ66          DECRE BYTE COUNT AND CHECK FOR DONE  47100002
         B     LSTZ62              IF ONLY ONE BYTE REMAINS, BRANCH     47150002
         SPACE                                                          47200002
LSTZ90   DS    0H                                                       47250002
         LA    R2,M0020            OBTAIN FIRST LEVEL MSG NUMBER        47300002
         LA    R3,ZERO             INDICATE NO SECOND LEVEL MSG         47410002
         L     R7,OUTBUF           OBTAIN POINTER TO AREA TO BUILD INST 47460002
         MVC   ZERO(TWO,R7),LENFIVE   MOVE INSERT LENGTH TO INSERT      47466002
         MVI   FOUR(R7),C'Z'       MOVE Z AS THE INSERT TEXT            47468002
         B     MSGOUT              BRANCH TO CALL I/O TO MESSAGE        47468802
         SPACE                                                          47470002
ZDATAMVC MVC   ZERO(NULL,R6),ZERO(R1)  FOR MOVING RAW DATA TO BUFFER    47500002
         TITLE 'IKJEGLSA, ''LIST'', BINARY FORMATTING ROUTINE'          47550002
*********************************************************************** 47600002
*                                                                     * 47650002
*  THE FOLLOWING SUBROUTINE LIST AREAS OF CORE IN THE BINARY OUTPUT   * 47700002
*  FORMAT. CONVERSION TO PRINTABLE IS DONE IN THIS ROUTINE.           * 47750002
*********************************************************************** 47800002
LSTBIN   DS    0H                                                       47850002
         TM    COMFLGS,TWOADDRS    TEST FOR 1 OR 2 ADDRESSES            47900002
         BO    LSTB20              IF TWO, BRANCH                       47950002
         SR    R0,R0               R0=0                                 48000002
         CH    R0,A1M              WAS A MULTIPLICITY GIVEN             48050002
         BNE   LSTB04              IF GIVEN, BRANCH                     48100002
         MVI   A1M+H2ND,ONE        DEFAULT MULTIPLICITY TO ONE          48150002
LSTB04   DS    0H                                                       48200002
         CH    R0,A1L              WAS A LNTH GIVEN                     48250002
         BNE   LSTB06              IF GIVEN, BRANCH                     48300002
         MVI   A1L+H2ND,ONE        DEFAULT LENGTH TO ONE                48350002
LSTB06   DS    0H                                                       48400002
         BAL   R14,LSTLMTCK        GO CHECK UPPER ADDR OF THIS REQUEST  48450002
         BAL   R14,ADDRCHK         GO CK VALIDITY OF 2ND ADDR           48460002
         LTR   R15,R15             IS REMAINING MULTIPLICITY ZERO       48500002
         BNZ   LSTB80              IF ZERO, BRANCH                      48550002
         LH    R4,A1M              SET UP CONTROL                       48600002
         LH    R5,A1L              SET UP LENGTH CTR                    48650002
LSTB10   DS    0H                                                       48700002
         TM    A1FLG,A1SYM         WAS ADDR SYMBOLIC, REL, OR ABS.      48750002
         BZ    LSTB12              IF ADDRESS IS ABSOLUTE, BRANCH       48800002
         BO    LSTB40              IF SYMBOLIC, BRANCH                  48850002
         SPACE                                                          48900002
*  IF THE ADDRESS TYPE IS RELATIVE, FALL THRU AND SET UP FOR RELATIVES  48950002
         SPACE                                                          49000002
         MVC   APDE(APL),IKJPARMA  MOVE ORIGINAL PDE TO WORK AREA       49050002
LSTB12   DS    0H                                                       49100002
         LA    R1,A1               GET PTR TO INPUT DATA ADDRESS        49150002
         ST    R1,APDE+(PDEADRPT-IKJPARMA) SET UP PTR IN ADDRESS PDE    49200002
         L     R6,OUTBUF           GET PTR TO THE OUTPUT BUFFER         49250002
         LA    R6,DATAOFF(R6)      INCRE BUFFER PTR PAST LL00 FIELD     49300002
LSTB52   DS    0H                                                       49350002
         BAL   R14,LSTBPT          GO CLEAR BREAKPOINT SVC'S FROM DATA  49400002
         LA    R1,APDE             R1=ADDR OF ADDRESS PDE               49450002
         L     R15,TSTCONVT        R15=ADDR OF CONVERT ROUTINE          49500002
         SR    R0,R0               ZERO REG                             49550002
         BCTR  R0,NULL             MAKE REG 0 NEG FOR CONVERT TO PRINT  49600002
         LCR   R1,R1               R1=NEG, SHOW CONVERT AN ADDRESS      49650002
         BALR  R14,R15             GO TO CONVERT ROUTINE                49700002
         LTR   R15,R15             TEST RETURN CODE FROM CONVERT        49750002
         BNZ   LSTCVTRC            IF NON-ZERO, GO ANALYZE FURTHER      49800002
         L     R3,CONAREA          R3=ADDR OF CONVERT OUTPUT AREA       49850002
         MVC   ZERO(ADDRLEN,R6),CONDATA(R3)  MOVE CONVERTED ADDR TO BUF 49900002
         LA    R6,ADDRLEN(R6)      INCRE BUF PTR PAST ADDR FIELD        49950002
LSTB58   DS    0H                                                       50000002
         LA    R1,BFLDLEN+SP2(R6)  COMPUTE BUF PTR AFTER 1 FLD + 2 SP'S 50050002
         C     R1,ENDOBUF          WILL A DATA BYTE FIT.                50100002
         BNH   LSTB60              IF MORE DATA WILL FIT, GO PROCESS    50150002
         BAL   R7,LSTIO            IF DATA WONT FIT, GO OUTPUT BUF      50200002
         B     LSTB52              GO CONVERT ANOTHER ADDR              50250002
         SPACE                                                          50300002
LSTB60   DS    0H                                                       50350002
         L     R1,VPDEPT           R1=PTR TO CUR BYTE OF INPUT DATA     50400002
         LA    R15,EIGHT           SET UP LOOP CONTROL                  50450002
         LA    R2,HEX80            INITIALIZE TEST MASK                 50500002
         LA    R6,SP2(R6)          INCRE BUF PTR FOR 2 BLANKS           50550002
LSTB62   DS    0H                                                       50600002
         EX    R2,BTM              TEST BIT FOR 1 OR 0                  50650002
         BO    LSTB68              IF ONE, BRANCH                       50700002
         MVI   ZERO(R6),CHAR0      MOVE A ZERO TO THE BUF FOR THIS BIT  50750002
LSTB64   DS    0H                                                       50800002
         LA    R6,BDATALEN(R6)     INCRE BUF PTR PAST DATA              50850002
         SRL   R2,ONE              MOVE MASK TO TEST NEXT BIT           50900002
         BCT   R15,LSTB62          TEST FOR DONE                        50950002
         LA    R1,BDATALEN(R1)     INCREMENT DATA PTR TO NEXT BYTE      51000002
         ST    R1,VPDEPT           SAVE UPDATED DATA ADDRESS            51050002
         BCT   R5,LSTB58           IF MORE BYTES TO DO,BRANCH           51100002
         BAL   R7,LSTIO            ELSE, GO OUTPUT BUF                  51150002
         LH    R5,A1L              RELOAD LENGTH IN CASE MORE TO LIST   51200002
         BCT   R4,LSTB52           IF MULTIPLICITY NOT ZERO DO MORE     51250002
         B     LSTCC0              IF DONE, RETURN TO MAIN ROUTINE      51300002
LSTB68   DS    0H                                                       51350002
         MVI   ZERO(R6),CHAR1      MOVE A ONE TO THE BUF FOR THIS BIT   51400002
         B     LSTB64              RETURN TO INCRE PTRS                 51450002
BTM      TM    ZERO(R1),NULL       FOR TESTING BITS FOR 0 OR 1.         51500002
         SPACE                                                          51550002
LSTB20   DS    0H                                                       51600002
         L     R1,A1               GET START ADDR                       51650002
         L     R5,A2               GET ENDING ADDR                      51700002
         BCTR  R1,NULL             DECREMENT A1 TO GET INCLUSIVE LENGTH 51750002
         SR    R5,R1               COMPUTE LNTH, R5 IS LNTH CNTRL REG   51800002
         STH   R5,A1L              STORE LENGTH FOR LATER               51850002
         LA    R4,ONE              SET MULTIPLICITY CONTROL TO 1.       51900002
         B     LSTB10              GO SET UP ADDRESSES.                 51950002
         SPACE                                                          52000002
LSTB40   DS    0H                                                       52050002
         BAL   R7,LSTSYM           GO INITIALIZE BUF WITH SYMBOL        52100002
         B     LSTB58              GO TO BINARY PROCESS ROUTINE         52150002
         SPACE                                                          52200002
LSTB80   DS    0H                                                       52250002
         LH    R5,LASTLEN          AMT OF REQUEST STILL IN CORE         52300002
         LA    R4,ONE              SET MULTIPLICITY CNTRL TO ONE        52350002
         STH   R4,A1M              SAVE MULTIPLICITY CNTRL              52400002
         STH   R5,A1L              SAVE REMAINING LENGTH                52450002
         B     LSTB10              GO LIST QUANTITY WITHIN CORE         52500002
         TITLE 'IKJEGLSA, ''LIST'', INSTRUCTION FORMATTING ROUTINE'     52550002
*********************************************************************** 52600002
*                                                                     * 52650002
*  THIS ROUTINE WILL OUTPUT DATA IN THE INSTRUCTION FORMAT.           * 52700002
*  CONTROL CAN BE BY LNTH (INCLUDING RANGE), BY MULTIPLICITY, OR BY   * 52750002
*  BOTH, WITH THE ROUTINE ENDING WHEN EITHER MULTIPLICITY REACHES 0,  * 52800002
*  OR WHEN THE NEXT-INSTR-ADDR IS INCRE PAST THE STOP ADDRESS.        * 52850002
*  WITHIN THE PROCESS SECTION (BEGINS AT LSTI50) REGS AND CONTROLS    * 52900002
*  ARE SET AS FOLLOWS.                                                * 52950002
*                                                                     * 53000002
*        R2    CONTAINS THE STOP ADDR                                 * 53050002
*        R3    CONTAINS THE CURRENT TRUE DATA ADDRESS                 * 53100002
*        R4    CONTAINS THE MULTIPLICITY OR 32767.                    * 53150002
*        R5    CONTAINS A COUNTER FOR REFRESHING HOLDAREA.            * 53200002
*        R6    IS THE CURRENT BUFFER PTR                              * 53250002
*                                                                     * 53300002
*********************************************************************** 53350002
LSTINSTR DS    0H                                                       53400002
         NI    LASTINST,TURNOFF    TURN OFF SW IN CASE SW ON            53410002
         STC   R15,VPDET           TYPE CODE TO VALUE PDE.              53450002
         L     R3,A1               SET UP CURRENT TRUE DATA ADDR        53500002
         LA    R3,ZERO(ZERO,R3)    CLEAR HIGH ORDER BYTE FOR CALCULATE  53550002
         TM    COMFLGS,TWOADDRS    IF ADDRESS RANGE WAS NOT GIVEN       53600002
         BNO   LSTI05               ... THEN BRANCH                     53650002
*  PROCESS ADDRESS RANGE                                                53700002
         L     R2,A2               SET 2ND ADDRESS IN ANTICIPATION      53750002
         LA    R2,ONE(R2)          ADD 1 TO MAKE RANGE INCULSIVE        53800002
         LH    R4,MAXHWRD          SET MULTI=32767 FOR LOOP CONTROL     53850002
         B     LSTI20              SKIP SINGLE ADDR PROCESSING          53900002
*  PROCESS SINGLE ADDRESS                                               53950002
LSTI05   DS    0H                                                       54000002
         SR    R15,R15             CONSTANT OF 0 FOR COMPARE            54050002
         LH    R4,A1M              R4=MULTPLICITY OR 0                  54100002
         LH    R2,A1L              R2=LENGTH OR 0                       54150002
         TM    LSTFLGS,LNTHFLG     IF LENGTH WAS GIVEN                  54200002
         BO    LSTI06              ... THEN BRANCH                      54250002
         TM    LSTFLGS,MULTIFLG    IF MULTIPLICITY WAS NOT GIVEN        54300002
         BNO   LSTI06              ... THEN BRANCH                      54350002
         LA    R2,SIX              SET REG 2 VALUE 6 FOR MULT           54360002
         MH    R2,A1M              MULT BY THE NUMBER OF INST           54370002
         B     LSTI07              GO TO NEXT PROCESS INSTR             54450002
LSTI06   DS    0H                                                       54500002
         LH    R4,MAXHWRD          SET MULTI=32767 FOR LOOP CONTROL     54550002
LSTI07   DS    0H                                                       54600002
         AR    R2,R3               CALCULATE STOP ADDR AS ADDR1+LENGTH  54650002
LSTI20   DS    0H                                                       54700002
         C     R2,ENDADR           IS STOP ADDRESS OUT OF CORE          54750002
         BNH   LSTI21              IF STOP ADDR WITHIN CORE, BRANCH     54800002
         L     R2,ENDADR           GET HIGHEST CORE ADDR FOR STOPPER    54850002
         LA    R2,ONE(ZERO,R2)     INCRE BY ONE FOR USE AS A STOPPER    54900002
         EJECT                                                          54950002
LSTI21   DS    0H                                                       55000002
         ST    R2,A2               ADDR2 IS STOP ADDR                   55050002
         BAL   R14,ADDRCHK         GO TEST VALIDITY ENDING ADDR         55060002
         TM    A1FLG,A1SYM         TEST ADDR TYPE                       55100002
         BZ    LSTI22              IF ADDRESS IS ABSOLUTE, BRANCH       55150002
         BO    LSTI40              IF SYMBOLIC, BRANCH                  55200002
         SPACE                                                          55250002
*  IF THE ADDRESS TYPE IS RELATIVE, FALL THRU AND SET UP FOR RELATIVES  55300002
         SPACE                                                          55350002
         MVC   APDE(APL),IKJPARMA  MOVE ORIGINAL PDE TO WORK AREA       55400002
LSTI22   DS    0H                                                       55450002
         LA    R2,APDE+PDEUSER-IKJPARMA    GET PTR TO DATA ADDRESS      55500002
         ST    R2,APDE+(PDEADRPT-IKJPARMA) STORE IT IN THE ADDR PDE     55550002
         B     LSTI50              GO PROCESS.                          55600002
         SPACE                                                          55650002
LSTI40   DS    0H                                                       55700002
         BAL   R7,LSTSYM           GO MOVE SYM TO BUF                   55750002
         LA    R2,APDE+PDEUSER-IKJPARMA    GET PTR TO DATA ADDRESS      55800002
         ST    R2,APDE+(PDEADRPT-IKJPARMA) STORE IT IN THE ADDR PDE     55850002
         TM    COMFLGS,TWOADDRS    TEST FOR 1 OR 2 ADDRS                55900002
         L     R2,CONAREA          GET ADDR OF CONVERT OUTPUT AREA      55950002
         BO    LSTI42              IF AN ADDR RANGE WAS USED, BRANCH    56000002
         LA    R15,ONE             MAKE A CONSTANT OF 1 FOR COMPARISON  56050002
         CH    R15,A1M             IF MULTIPLICITY GT ONE               56100002
         BL    LSTI42              ...THEN BRANCH                       56150002
         ST    R3,APDE+PDEUSER-IKJPARMA    STORE CURRENT DATA ADDR      56200002
         EJECT                                                          56350002
LSTI42   DS    0H                                                       56400002
         BAL   R7,LSTIO            GO OUTPUT SYMBOLIC ADDRESS           56450002
         B     LSTI51              GO PROCESS LIST REQUEST              56500002
         SPACE 2                                                        56550002
*  PROCESS ADDRESS FOR THE FIRST LINE OF OUTPUT.                        56600002
         SPACE                                                          56650002
LSTI50   DS    0H                                                       56700002
         L     R6,OUTBUF           GET PTR TO THE OUTPUT BUFFER         56750002
         LA    R6,DATAOFF(R6)      INCREMENT BUF PTR PAST LL00 FIELD    56800002
         BAL   R14,LSTBPT          GO REMOVE BREAKPOINT SVC'S FROM DATA 56850002
         L     R2,CONAREA          ADDR OF CONVERT OUTPUT AREA          56900002
LSTI51   DS    0X                                                       56950002
         LA    R5,L'HOLDAREA/SIX   SET UP COUNTER FOR DATA IN HOLDAREA  57000002
LSTI52   DS    0H                                                       57050002
         ST    R3,APDE+PDEUSER-IKJPARMA    STORE CUR DATA ADDRESS       57100002
         SR    R0,R0               R0=0                                 57150002
         LA    R1,APDE             R1=ADDR OF THE ADDRESS PDE           57200002
         L     R15,TSTCONVT        R15=ADDR OF CONVERT ROUTINE          57250002
         BCTR  R0,NULL             MAKE R0 NEG FOR CONVERT TO PRINTABLE 57300002
         LCR   R1,R1               R1 NEG TO SHOW ADDR CONVERSION       57350002
         BALR  R14,R15             GO TO CONVERT ROUTINE                57400002
         LTR   R15,R15             TEST RETURN CODE.                    57450002
         BNZ   LSTCVTRC            IF NON-ZERO, BRANCH                  57500002
         MVC   ZERO(ADDRLEN,R6),CONDATA(R2)  CONVERTED DATA TO BUF      57550002
         LA    R6,ADDRLEN(R6)      INCRE BUF PTR PAST LL00 FIELD        57600002
         EJECT                                                          57650002
*  CONVERT ONE INSTRUCTION, AND MOVE IT INTO THE BUFFER.                57700002
LSTI54   DS    0H                                                       57750002
         LA    R1,VPDE             ADDR OF THE VALUE PDE                57800002
         L     R15,TSTCONVT        ADDR OF CONVERT ROUTINE.             57850002
         BALR  R14,R15             GO TO CONVERT ROUTINE                57900002
         LTR   R15,R15             TEST RETURN CODE                     57950002
         BNZ   LSTI80              IF NON-ZERO, BRANCH                  58000002
         IC    R15,CONLNTH(R2)     PICK UP LENGTH OF CONVERTED DATA     58050002
         BCTR  R15,NULL            DECREMENT LNTH FOR MVC INSTR         58100002
         TM    LASTINST,INSTSW     TEST FOR LAST INSTR IN BUFFER        58110002
         BZ    CONT                BRANCH AROUND AND CONTINUE           58120002
         L     R6,OUTBUF           GET PTR TO THE OUTPUT BUFFER         58130002
         LA    R6,ELEVEN(R6)       INCREMENT BUF PTR PAST ADDR          58130402
CONT     DS    0H                  LABEL TO BRANCH TO CONT PROC         58140002
         EX    R15,INSTRMVC        MOVE CONVERTED DATA TO BUF           58150002
         LA    R6,ONE+SP4(R15,R6)  INCRE BUF PTR PAST DATA AND SPACES   58200002
         SPACE                                                          58250002
*  NEXT, INCREMENT THE POINTERS PAST THE INSTRUCITON JUST PROCESSED.    58300002
         SPACE                                                          58350002
LSTI66   DS    0H                                                       58410002
         L     R15,VPDEPT          R15=ADDR OF DATA JUST CONVERTED      58450002
         TM    LASTINST,INSTSW     TEST FOR LAST INSTR IN BUFFER        58452002
         BO    CONTINUE            BRANCH BY SPECIAL HANDLING           58454002
         LR    R1,R3               PREPARE TEST NEAR END OF PG          58460002
         TM    ZERO(R15),INSTRLEN  TEST FOR INST. SIZE                  58470002
         BZ    ADJUST1             IF INSTR BEGINS 00, LNTH=2           58472002
         BM    ADJUST2             IF BEGINS 10 OR 01, LNTH=4           58474002
         BO    ADJUST3             IF INSTR BEGINS 11, LNTH=6           58476002
TESTOUT  DS    0H                  BRANCH BACK TO AFTER ADJUSTED        58478002
         C     R1,A2               TEST FOR LAST INSTR IN BUFFER        58480002
         BL    CONTINUE            BRANCH BY SPECIAL HANDLING           58490002
         OI    LASTINST,INSTSW     TURN ON THE LAST INST SWITCH         58490402
         ST    R1,A2               ESTABLISH ENDING ADDRESS             58492402
         BAL   R14,ADDRCHK         GO TEST VALIDITY ENDING ADDR         58494402
         B     LOADBUFF            BRANCH TO MOVE LAST INST             58496402
CONTINUE DS    0H                  BRANCHED TO IF INST LEFT             58498002
         TM    ZERO(R15),INSTRLEN  TEST INSTR LENGTH FOR 2, 4, OR 6     58500002
         BM    LSTI68              IF INSTR BEGINS 10 OR 01, LNTH=4, GO 58550002
         LA    R15,TWO(R15)        INCRE DATA PTR BY 2 IF LNTH 2 OR 6   58600002
         LA    R3,TWO(R3)          ALSO INCRE TRUE ADDR BY 2            58650002
         BZ    LSTI70              IF INSTR BEGINS 00, LNTH=2, BRANCH   58700002
         SPACE                                                          58750002
*  IF THE INSTRUCITON BEGINS 11, THE LNTH=6, 2 HAS ALREADY BEEN ADDED   58800002
*  SO FALL THRU AND ADD 4 MORE. THIS INSTR IS BRANHCED TO IF LNTH=4.    58850002
         SPACE                                                          58900002
LSTI68   DS    0H                                                       58950002
         LA    R15,FOUR(R15)       INCRE DATA PTR BY 4 IF LNTH 4 OR 6   59000002
         LA    R3,FOUR(R3)         ALSO INCRE TRUE ADDR BY 4            59050002
LSTI70   DS    0H                                                       59100002
         C     R3,A2               COMPARE UPDATED ADDR TO STOP ADDR    59150002
         ST    R15,VPDEPT          STORE UPDATED ADDR IN VALUE PDE      59200002
         BNL   LSTI74              IF PAST LIMIT, BRANCH TO FINALE      59250002
         TM    LASTINST,INSTSW     TEST FOR LAST INSTR IN BUFFER        59260002
         BO    LSTI74              BRANCH TO PRINT OUT LAST INST        59270002
         BCT   R4,LSTI64           IF CONTROL-1 NOT ZERO, DO ANOTHER    59300002
LSTI74   DS    0H                                                       59350002
         NI    LASTINST,TURNOFF    TURN OFF LAST INSTR SWITCH           59360002
         BCTR  R3,NULL             DECRE ADDR TO TEST FOR OUT-OF-CORE   59400002
         C     R3,ENDADR           WAS LISTING STOPPED BY TOP OF CORE   59450002
         BH    LSTI78              IF INSTR IN BUF OUT-OF-CORE, BRANCH  59500002
         BAL   R7,LSTIO            GO OUTPUT FINAL DATA                 59550002
         B     LSTCC0              RETURN TO MAIN ROUTINE               59600002
ADJUST1  DS    0H                  BRANCHED TO FOR 2 BYTE INST          59600402
         LA    R1,ONE(R1)          INCREMENT BY 1 BYTES FOR MOVE        59601202
         B     TESTOUT             BRANCH TO TEST LAST INST             59601302
ADJUST2  DS    0H                  BRANCHED TO FOR 4 BYTE INST          59602002
         LA    R1,THREE(R1)        INCREMENT BY 3 BYTES FOR MOVE        59620002
         B     TESTOUT             BRANCH TO TEST LAST INST             59640002
ADJUST3  DS    0H                  BRANCHED TO FOR 6 BYTE INST          59642002
         LA    R1,FIVE(R1)         INCREMENT BY 5 BYTES FOR MOVE        59646002
         B     TESTOUT             BRANCH TO TEST LAST INST             59648402
         SPACE                                                          59650002
LSTI78   DS    0H                                                       59700002
         OI    COMFLGS,OUTCORE     SET REQUEST EXTENDS OUT OF CORE SW   59750002
         B     LSTCC0              GO TO COMPLETION ROUTINE             59800002
         EJECT                                                          59810002
*****************************************************************       59870002
*                                                                       59880002
*  THIS ROUTINE IS ENTERED AT THIS POINT TO CHECK THE VALIDITY OF       59890002
*  THE CALCULATED STOP ADDRESS FOR THE LIST COMMAND.                    59892002
*  REGS ARE SAVE AND RESTORED AND THE ROUTINE RETURNS TO CALLER         59892402
*  IF THE ADDRESS PROVES TO BE VALID; OTHERWISE, THE ROUTINE            59892802
*  BRANCHES TO PRINT MESSAGE AND RETURN TO MAINLINE.                    59893202
*                                                                       59894002
*****************************************************************       59896002
ADDRCHK  DS    0H                                                       59896402
         SAVE (14,12)              STANDARD SAVE                        59896802
         L     R6,PPTCB            ESTAB PTR TO PROB PROG TCB           59897202
         L     R7,A2               ESTAB PTR TO STOP ADDR               59897702
         IKJEGS9G  ADDRCHK,TCBADDR=(R6),VALUE=(R7),MF=(E,WKWORDS)       59897802
         L     R1,OUTBUF           RE INIT OUTPUT BUFFER      @ZA11395  59901803
         MVI   DATAOFF(R1),C' '    TO BLANKS...IT HAS BEEN    @ZA11395  59906903
         MVC   DATAOFF+1(OUTBUFRL-5,R1),DATAOFF(R1) CLOBBERED @ZA11395  59907903
         C     R15,FEIGHT          RTN CODE(ZERO/FOUR GOOD ADDR)        59908903
         BL    GOODADDR            OK - - RETURN TO PROCESSING          59910902
         BH    ERR97               ERROR IN SVC97                       59911302
         XC    TSTIOPRM,TSTIOPRM   ZERO OUT I/O PARM LIST               59912902
         IKJEGSIO MSG,FIRST=M0018,SECOND=M0285,ID=LSA19,  ISSUE CALL   *59914902
               MF=(E,TSTIOPRM)     CALL I/O TO ISSUE ERROR MESSAGE      59916902
         CH    R15,H16             TEST FOR SERIOUS ERROR CONDITION     59918902
         BL    LSTCC0              IF NOT SERIOUS TRY NEXT ADDRESS      59919302
ERR97    DS    0H                                                       59919402
         ST    R15,LSTRETCD        SAVE RETURN CODE FOR MAINLINE        59919702
         B     LSTMN90             IF SERIOUS GO BACK TO MAINLINE       59920102
         EJECT                                                          59920802
GOODADDR RETURN (14,12)            RETURN TO PROCESSING                 59922902
         EJECT                                                          59924002
LSTI64   DS    0H                                                       59937002
         BAL   R7,LSTIO            GO OUTPUT DATA                       59950002
         BCT   R5,LSTI52           IF MODE DATA IN HOLDAREA, BRANCH     60000002
LOADBUFF DS    0H                  BRANCHED TO FOR LAST INST            60010002
         BAL   R14,LSTBPT          GO REMOVE BREAKPOINT SVC'S           60050002
         LA    R5,L'HOLDAREA/SIX   RESET HOLDAREA COUNTER               60100002
         B     LSTI52              GO UPDATE THE CURRENT DATA ADDRESS   60150002
         SPACE                                                          60200002
LSTI80   DS    0H                                                       60250002
         C     R15,FFOUR           IS THE RETURN CODE 4                 60300002
         BNE   LSTCVTRC            IF NOT 4, GO ANALYZE                 60350002
         SPACE                                                          60400002
*  IF THE RETURN CODE WAS 4, AN INVALID OP CODE WAS ENCOUNTERED, AND    60450002
*     A MESSAGE INDICATING WHERE MUST BE PUT OUT.                       60500002
         SPACE                                                          60550002
         L     R15,OUTBUF          GET START ADDRESS OF OUTPUT BUFFER   60600002
         LR    R14,R15             SAVE START ADDRESS OF BUFFER         60650002
         LA    R15,DATAOFF(R15)    INCREMENT ADDRESS PAST LL00 FIELD    60700002
         SR    R6,R15              CALCUALTE LENGTH OF ADDRESS IN BUF   60750002
         SPACE                                                          60800002
*  NEXT, BYPASS ANY LEADING BLANKS IN THE ADDRESS ALREADY IN THE BUF.   60850002
         SPACE                                                          60900002
LSTI84   DS    0H                                                       60950002
         BCTR  R6,NULL             REDUCE LENGTH BY ONE FOR MVC INSTR   61000002
         CLI   ZERO(R15),BLANK     IS THE NEXT CHARACTER IN BUF A BLANK 61050002
         BNE   LSTI86              IF NOT A BLANK, BRANCH               61100002
         LA    R15,ONE(R15)        INCREMENT BUF ADDR TO NEXT CHAR      61150002
         B     LSTI84              LOOP BACK TO CHECK NEXT CHARACTER    61200002
         SPACE                                                          61250002
LSTI86   DS    0H                                                       61300002
         LA    R14,FOUR(R14)       POINT TO BYTE AFTER INST HEADER      61310002
         L     R7,OUTBUF           POINT TO BEGINNING OF INSERT         61320002
         EX    R6,MSGMOVE3         MOVE ADDRESS INTO 1ST LVL MSG        61600002
         LA    R6,FIVE(R6)         CALCUALTE TOTAL LENGTH OF INSERT     61750002
         STH   R6,ZERO(R7)         STORE LENGTH IN MSG LENGTH FIELD     61800002
         LA    R2,M0021            OBTAIN FIRST LEVEL MSG NUMBER        61812002
         LA    R3,ZERO             INDICATE NO SECOND  LEVEL MSG        61814002
MSGOUT   DS    0H                                                       61820002
         XC    TSTIOPRM,TSTIOPRM   ZERO OUT I/O PARM FIELD              61830002
         IKJEGSIO MSG,FIRST=(R2),INST11=(ADDR,(R7)),SECOND=(R3), CALL  *61840002
               ID=LSA19,MF=(E,TSTIOPRM)   FOR OUTPUT OF MESSAGE         61842002
         CH    R15,H16             TEST FOR SERIOUS ERROR               61844002
         BL    LSTCC0              IF NOT CONTINUE                      61846002
         ST    R15,LSTRETCD        SAVE RETURN CODE FOR  MAINLINE       61848002
         B     LSTMN90             RETURN TO MAINLINE                   61848402
         SPACE                                                          61900002
MSGMOVE3 MVC   ZERO(NULL,R14),ZERO(R15)  MOVES ADDR INTO MESS           62000002
BLOW1    DS    0H                  ESTABLISH ADDR IF ABEND              62010002
INSTRMVC MVC   SP4(NULL,R6),CONDATA(R2)  MOVES INSTRUCTIONS TO BUF      62050002
         TITLE 'IKJEGLSA, ''LIST'', LSTIO SUBROUTINE FOR OUTPUT'        62100002
*********************************************************************** 62150002
*                                                                     * 62200002
*  THES ROUTINE SETS UP THE PTRS AND CALLS IKJEGIO1 TO OUTPUT A LINE  * 62250002
*  OF DATA. AT ENTRY, THE FOLLOWING REGS ARE SET.                     * 62300002
*        R6  POINTS TO THE NEXT AVAILABLE BYTE IN THE BUFFER          * 62350002
*        R7  HAS THE RETURN POINT ADDRESS                             * 62400002
*                                                                     * 62450002
*  THE CONTENTS OF REGS 0, 1, 6, 14, AND 15 ARE MODIFIED BY THIS RTN  * 62500002
*                                                                     * 62550002
*********************************************************************** 62600002
         SPACE                                                          62650002
LSTIO    DS    0H                                                       62700002
         STM   R2,R3,WKWORDS       SAVE CONTENTS OF WORK REGISTERS      62710002
         L     R2,DATAPT           SET UP PTR TO 2 WORD LIST            62750002
         LR    R15,R6              R15=PTR TO 'END OF DATA'+1           62800002
         L     R6,OUTBUF           R6=PTR TO BEGINNING OF BUF           62850002
         SR    R15,R6              CALCULATE LENGTH OF DATA             62900002
         STH   R15,F1STHALF(R6)    LNTH TO 1ST HALF WORD OF BUFFER      62950002
         SPACE                                                          63000002
*  COMMON PORTION OF IO ROUTINE.                                        63050002
LSTIO1   DS    0H                                                       63100002
         TM    TSTFLGS1,TSTPRINT+TSTFIRST  IS OUTPUT TO A DS 1ST TIME   63150002
         BM    FIRSTIO             IF OUTPUT TO DS 1ST TIME, BRANCH     63250002
         SR    R3,R3               IF NOT 1ST TIME, INDICATE SO BY R0=0 63300002
LSTIO4   DS    0H                                                       63350002
         XC    TSTIOPRM,TSTIOPRM   ZERO OUT I/O PARM AREA               63400002
         IKJEGSIO DATA,DATAPTR=(R2),DSNAME=(R3),ID=LSA19,              *63430002
               MF=(E,TSTIOPRM)     CALL I/O TO OUTPUT DATA LINE         63440002
         LM    R2,R3,WKWORDS       RESTORE WORK REGISTERS               63442002
         MVI   DATAOFF(R6),BLANK   MOVE A BLANK TO START OF DATA AREA   63450002
         MVC   DATAOFF+ONE(LSTBUFL,R6),DATAOFF(R6)     BLANK OUT BUFFER 63500002
         LA    R6,DATAOFF(R6)      INCRE BUF PTR PAST LL00 FIELD        63550002
         LTR   R15,R15             TEST RETURN CODE                     63600002
         BCR   EQZERO,R7           IF ZERO, RETURN TO CALLER            63650002
         CH    R15,H16             TEST FOR SERIOUS ERROR               63660002
         BL    LSTIO3              IF NOT SERIOUS CONTINUE              63850002
         ST    R15,LSTRETCD        SAVE RETURN CODE FOR MAINLINE        63870002
         B     LSTMN90             RETURN TO MAINLINE                   63872002
LSTIO3   DS    0H                                                       63880002
         XC    LSTRETCD,LSTRETCD   SET THE RETURN CODE TO 0             63900002
         LTR   R15,R15             SEE IF PROCESSING SHOULD BE CONT'D   63910002
         BNZ   LSTMN90             RETURN TO MAINLINE                   63930002
         B     LSTCC0              GO CLEAN UP AND RETURN               63950002
         SPACE                                                          64500002
FIRSTIO  DS    0H                                                       64550002
         L     R14,TSTANSPL        PICK UP BASE ADDR FOR PARSE DSECT    64600002
         USING IKJPARMD,R14        ADDRESSABILITY FOR THE PDL           64650002
         LA    R3,DSNAME           SET UP PTR TO THE DSNAME PDE         64700002
         OI    TSTFLGS1,TSTFIRST   SET FIRST TIME SWITCH TO 1           64750002
         DROP  R14                                                      64800002
         B     LSTIO4              RETURN TO MAIN IO ROUTINE            64850002
         TITLE 'IKJEGLSA, ''LIST'', GENERAL USE SUBROUTINES'            64900002
*********************************************************************** 64950002
*                                                                     * 65000002
*  THIS CLOSED SUBROUTINE CHECKS SEGMENTS OF CORE FOR INSERTED BREAK- * 65050002
*  POINTS AND REPLACES THEM WITH THE ORIGINAL CONTENTS OF THE LOCATION* 65100002
*  THE ROUTINE MOVES THE NEXT 32 BYTES TO BE LISTED TO A WORKAREA AND * 65150002
*  SCANS THE BREAK ELEMENT QUEUE FOR ANY BREAK POINT SVC'S WITHIN THE * 65200002
*  32 BYTE FIELD. WHEN A BREAKPOINT SVC IS FOUND TO BE IN THE RANGE,  * 65250002
*  THE ORIGINAL INSTRUCTION IS MOVED (1ST 2 BYTES) INTO WORK AREA OVER* 65300002
*  THE BREAKPOINT SVC.  REGISTERS ARE SAVED AND RESTORED.             * 65350002
*  INPUT A1=ORIGINAL START ADDR OF DATA IN HOLD AREA                  * 65400002
*        VPDEPT =ADDR OF NEXT BY OF HOLD AREA TO BE LISTED            * 65450002
*                                                                     * 65500002
*********************************************************************** 65550002
         SPACE                                                          65600002
LSTBPT   DS    0H                                                       65650002
         SAVE  (14,12)             STANDARD SAVE                        65700002
         SPACE                                                          65750002
*  CALCULATE THE NEW DATA ADDRESS.                                      65800002
         SPACE                                                          65850002
         L     R3,VPDEPT           GET ADDR OF NEXT BYTE OF HOLDAREA    65900002
         LA    R5,HOLDAREA         SET UP START ADDR OF HOLDING CORE    65950002
         SR    R3,R5               DETERMINE NUMBER OF BYTES USED       66000002
         A     R3,A1               INCRE INPUT CORE ADDR BY AMT LISTED  66050002
         LA    R4,LSTIBLK(R3)      ESTABLISH ADDR OF END OF NEXT BLK    66100002
         C     R4,ENDADR           IS END ADDR GREATER THAN HIGHEST     66150002
         BH    LSTBPT30            IF OUT OF CORE, BRANCH TO ADJUST RTN 66200002
         L     R0,A2               OBTAIN LAST ADDRESS                  66210002
         SR    R0,R3               PREPARE TEST LESS THAN FULL          66220002
         CH    R0,H32              TEST FOR 32 OR MORE LEFT             66240002
         BNL   MOVEMAX             IF MORE THAN 32 BRANCH AROUND        66242002
         LR    R1,R0               ESTAB NUMBER OF BYTES TO MOVE        66244002
         B     LSTBPT04            BRANCH TO MOVE ROUTINE               66246002
MOVEMAX  DS    0H                  BRANCHED TO IF CAN MOVE 32           66248002
         LA    R1,LSTIBLK          USE STANDARD LENGTH FOR HOLD DATA    66250002
LSTBPT04 DS    0H                                                       66300002
         EX    R1,HOLDMVC          MOVE DATA TO HOLDING AREA            66350002
         SPACE                                                          66400002
*  IF THE DATA ADDRESS IS NOT ON A HALF WORD BOUNDARY, R0 WILL CONTAIN  66450002
*  A ONE (1), IF THE DATA ADDRESS IS ON A HALFWORD BOUNDARY, R0 WILL    66500002
*  CONTAIN A ZERO (0). THE CONTENTS OF R0 WILL THEN BE USED TO ADJUST   66550002
*  THE DATA ADDRESS AND THE HOLDAREA ADDRESS. THIS ADJUSTMENT IS TO     66600002
*  TAKE CARE OF THE CASE WHERE THE DATA START ADDRESS IS THE SECOND     66650002
*  BYTE OF A BREAKPOINT.                                                66700002
         SPACE                                                          66750002
BLOW2    DS    0H                  ESTABLISH ADDR IF ABEND              66760002
         LA    R0,ONE              SET THE LOW ORDER BIT ON IN REG 0    66800002
         NR    R0,R3               TEST DATA ADDRESS FOR A HALFWORD BDY 66850002
         SR    R3,R0               ADJUST DATA START ADDRESS IF NEEDED  66900002
         SR    R5,R0               MAKE SAME CHANGE FOR HOLDAREA ADDR   66950002
         L     R6,BREAKTAB         GET PTR TO FIRST BREAK ELEMENT       67000002
         USING BRKELEM,R6          ADDRESSABILITY FOR KREAK ELEMENT     67050002
         LTR   R6,R6               IS THERE A 1ST BREAK ELEMENT         67100002
         BP    LSTBPT12            IF THERE IS A BREAK ELEMENT, BRANCH  67150002
         B     LSTBPT20            IF NONE, RETURN                      67200002
         SPACE                                                          67250002
LSTBPT08 DS    0H                                                       67300002
         L     R6,BRKLINK          PICK UP FOREWARD PTR                 67350002
         LTR   R6,R6               TEST FOR ANOTHER                     67400002
         BNP   LSTBPT20            IF NO MORE, BRANCH                   67450002
LSTBPT12 DS    0H                                                       67500002
         C     R3,BRKADDR          COMPARE START ADDR TO BREAKPOINT     67550002
         BH    LSTBPT08            IF BRK-PT LOW, NOT IN RANGE, BRANCH  67600002
         C     R4,BRKADDR          COMPARE END ADDR TO BREAKPOINT       67650002
         BNL   LSTBPT40            IF END ADDR HI OR EQ, ADDR IN RANGE  67700002
LSTBPT20 DS    0H                                                       67750002
         AR    R3,R0               RE-ADJUST DATA ADDRESS AS NEEDED     67800002
         AR    R5,R0               DO THE SAME FOR HOLD AREA ADDRESS.   67850002
         ST    R3,A1               SAVE ACTUAL CORE ADDR OF CUR DATA    67900002
         ST    R5,VPDEPT            RESET VALUE PDE TO PT AT HOLD AREA  67950002
         RETURN (14,12)            RETURN TO CALLER                     68000002
         SPACE                                                          68050002
LSTBPT30 DS    0H                                                       68100002
         L     R1,ENDADR           PICK UP HIGHEST CORE ADDR            68150002
         LR    R4,R1               SET TOP ADDR AS TOP OF CORE          68200002
         SR    R1,R3               DETERMINE REMAINING LENGTH IN BYTES  68250002
         B     LSTBPT04            RETURN TO MAIN LSTBPT FLOW           68300002
         SPACE                                                          68350002
*  IF A BREAK POINT IS FOUND IN THE RANGE, THE FOLLOWING CODE           68400002
*  WILL REPLACE THE BREAK POINT SVC WITH THE ORIGINAL INSTRUCTION       68450002
         SPACE                                                          68500002
LSTBPT40 DS    0H                                                       68550002
         L     R2,BRKADDR          R2=ADDR OF BREAKPOINT SVC            68600002
         SR    R2,R3               DETERMINE OFFSET INTO HOLD AREA,     68650002
         AR    R2,R5               ADD THE ADDR OF HOLDAREA             68700002
         SPACE                                                          68750002
*  IF THE BREAK ELEMENT IS STILL ACTIVE, REPLACE THE BREAKPOINT SVC     68800002
*    WITH THE DATA FROM THE BREAK ELEMENT.                              68850002
         SPACE                                                          68900002
         MVC   ZERO(TWO,R2),BRKINST        REPLACE SAVED INSTR          68950002
         B     LSTBPT08            RETURN TO SEARCH LOOP                69000002
BLOW3    DS    0H                  ESTAB ADDR IF ABEND                  69010002
HOLDMVC  MVC   HOLDAREA(NULL),ZERO(R3) MOVE SEG OF CORE TO HOLD         69050002
         DROP  R6                                                       69100002
         EJECT                                                          69150002
*********************************************************************** 69200002
*                                                                     * 69250002
*  GENERAL SUBROUTINE FOR MOVING SYMBOLIC ADDRESSES TO THE OUTPUT BUF * 69300002
*        AT ENTRY,  R6 SHOULD POINT TO FIRST BYTE OF OUTPUT AREA      * 69350002
*                   R7 POINTS TO RETURN POINT.                        * 69400002
*********************************************************************** 69450002
         SPACE                                                          69500002
LSTSYM   DS    0H                                                       69550002
         OI    APDE+(PDEFLG2-IKJPARMA),CTNAMFLG TURN ON 'QUALIFIED' SW  69600002
*  TURN RELATIVE ADDR FLAG ON, AND ABSOLUTE ADDR SW OFF                 69650002
         XI    APDE+(PDEFLG4-IKJPARMA),RELADDR+ABSADDR                  69700002
         LA    R2,A1               GET ADDR OF INPUT DATA PTR           69750002
         ST    R2,APDE+(PDEADRPT-IKJPARMA) PUT IT IN THE ADDRESS PDE    69800002
         L     R6,OUTBUF           GET PTR TO START OF OUTPUT BUFFER    69850002
         LA    R6,DATAOFF(R6)      INCREMENT PTR PAST LL00 FIELD        69900002
         BAL   R14,LSTAMV          GO MOVE THE ADDRESS TO THE BUFFER    69950002
         L     R15,A1              R15=START ADDR OF DATA               70000002
         ST    R15,PPTEMP          MAKE START OF DATA ADDR BASE FOR REL 70050002
         SR    R0,R0               R0=0                                 70100002
         BCTR  R0,NULL             MAKE REG 0 NEG FOR CNVRT TO PRINT    70150002
         BAL   R14,LSTBPT          GO CLEAR BREAKPOINT SVC'S FROM DATA  70200002
         BR    R7                  RETURN TO CALLER                     70250002
         EJECT                                                          70300002
*********************************************************************** 70350002
*  THIS ROUTINE WILL ADD THE PRODUCT OF THE LENGTH AND MULTIPLICITY   * 70400002
*  TO THE START ADDRESS AND COMPARE THE SUM TO 'ENDADR'. IF THE       * 70450002
*  SUM EXCEEDS 'ENDADR', A NEW MULTIPLICITY IS CALCULATED AND SWITCH  * 70500002
*  'OUTCORE' IN COMFLGS IS SET, THE NUMBER OF BYTES NOT OUT           * 70550002
*  OF CORE IS PLACED 'LASTLEN', AND THE CALCULATED MULTIPLICITY IS    * 70600002
*  STORED IN 'A1M'.                                                   * 70650002
*  RETURN CODES---   4  IF 'NEW' MULTIPLICITY IS ZERO                 * 70700002
*                    0  FOR ALL OTHER CASES.                          * 70750002
*********************************************************************** 70800002
LSTLMTCK DS    0H                                                       70850002
         SAVE  (0,12)                                                   70900002
         L     R2,A1               GET DATA START ADDR                  70950002
         LH    R3,A1L              GET LENGTH FOR THIS REQUEST          71000002
         LA    R2,ZERO(ZERO,R2)    CLEAR HIGH BYTE FOR CALCULATION      71050002
         MH    R3,A1M              MULTIPLY  (LENGTH X MULTIPLICITY)    71100002
         AR    R3,R2               ADD START ADDR TO LENGTH OF REQUEST  71150002
         BCTR  R3,NULL             DECREMENT TO MAKE EXCLUSIVE          71200002
         ST    R3,A2               STORE 2ND ADDR FOR LATER USE         71210002
         C     R3,ENDADR           COMPARE POTENTIAL END ADDR TO TOP    71250002
         BH    LSTLMT20            IF REQUEST GOES OUT OF CORE, BRANCH  71300002
LSTLMT10 DS    0H                                                       71350002
         SR    R15,R15             SET RETURN CODE TO ZERO              71400002
LSTLMT14 DS    0H                                                       71450002
         RETURN  (0,12)                                                 71500002
         SPACE                                                          71550002
LSTLMT20 DS    0H                                                       71600002
         L     R5,ENDADR           GET LAST MACHINE ADDRESS             71650002
         ST    R5,A2               STORE 2ND ADDR FOR LATER USE         71660002
         SR    R4,R4               CLEAR EVEN REG FOR DIVIDE            71700002
         LH    R3,A1L              GET LENGTH FOR THIS REQUEST          71750002
         SR    R5,R2               TOP ADDR - START ADDR                71800002
         LA    R5,ONE(ZERO,R5)     MAKE LASTLEN INCLUSIVE               71850002
         DR    R4,R3               DIVIDE BYTES IN CORE BY LENGTH       71900002
         STH   R5,A1M              SET NEW MULTIPLICITY                 71950002
         STH   R4,LASTLEN          SAVE NO. OF BYTES IN CORE            72000002
         OI    COMFLGS,OUTCORE                                          72050002
         LTR   R5,R5               WAS REMAINING MULTI ZERO             72100002
         BNZ   LSTLMT10            IF NOT, BRANCH                       72150002
         LA    R15,FOUR            SET RETURN CODE TO FOUR              72200002
         B     LSTLMT14            GO RETURN WITH A RC=4                72250002
         SPACE                                                          72300002
LSTOUT   DS    0H                                                       72350002
         XC    TSTIOPRM,TSTIOPRM   ZERO OUT I/O PARM LIST               72360002
         IKJEGSIO MSG,FIRST=M0022,INST11=(APDE,(R8)),ID=LSA19,         *72370002
               SECOND=M0272,MF=(E,TSTIOPRM)   CALL I/O ISSUE ERROR MSG  72380002
         CH    R15,H16             TEST FOR SERIOUS ERROR CONDITION     72390002
         BL    LSTMN90             IF NOT SERIOUS TRY NEXT ADDRESS      72400002
         ST    R15,LSTRETCD        SAVE RETURN CODE FOR MAINLINE        72410002
         B     LSTMN90             IF SERIOUS GO BACK TO MAINLINE       72420002
         EJECT                                                          72700002
*********************************************************************** 72750002
*                                                                     * 72800002
*  GENERAL SUBROUTINE FOR MOVING ADDRESSES TO THE OUTPUT BUFFER.      * 72850002
*        AT ENTRY,  R6 SHOULD POINT TO THE NEXT AVAILABLE BUFFER BYTE * 72900002
*                   R8 SHOULD CONTAIN THE ADDRESS OF THE ADDR PDE.    * 72950002
*        AT-EXIT,   R6 CONTAINS THE UPDATED BUFFER PTR, AND           * 73000002
*                   THE OUTPUT BUFFER CONTAINS THE ADDRESS STRING.    * 73050002
*                                                                     * 73100002
*********************************************************************** 73150002
LSTAMV   DS    0H                                                       73200002
         SAVE  (14,12)             SAVE CALLERS REGS                    73250002
         TM    PDEFLG1,LDNAMFLG    WAS A LOADNAME USED                  73300002
         BZ    LSTAMV04                IF NOT, BRANCH                   73350002
         LH    R2,PDELEN1          PICK UP LENGTH OF LOAD NAME          73400002
         BCTR  R2,NULL                 DECREMENT BY 1 FOR MVC INSTR.    73450002
         L     R15,PDELDNAM        PICK UP PTR TO LOAD NAME             73500002
         EX    R2,SYMMOVE          MOVE SYMBOL TO BUFFER                73550002
         LA    R6,ONE(R2,R6)       INCREMENT BUF PTR PAST NAME          73600002
LSTAMV04 DS    0H                                                       73650002
         TM    PDEFLG2,CTNAMFLG    WAS ENTRY NAME SPECIFIED             73700002
         BZ    LSTAMV08                IF NOT, BRANCH                   73750002
         MVI   ZERO(R6),PERIOD     MOVE IN ENTRY NAME PREFIX            73800002
         LA    R6,L'PERIOD(R6)     INCREMENT BUF PTR PAST PREFIX        73850002
         LH    R2,PDELEN2          GET LENGTH OF ENTRY NAME AND         73900002
         BCTR  R2,NULL                 DECREMENT BY 1 FOR MVC INSTR.    73950002
         L     R15,PDECTNAM        PICK UP PTR TO ENTRY NAME            74000002
         EX    R2,SYMMOVE          MOVE NAME TO OUTPUT AREA             74050002
         LA    R6,ONE(R2,R6)       INCREMENT BUF PTR PAST ENTRY NAME    74100002
         TM    PDEFLG4,CTONLY      IS ADDR TYPE STAND ALONE ENTRYNAME   74150002
         BO    LSTAMV16                IF STAND ALONE ENTRYNAME, BRANCH 74200002
         MVI   ZERO(R6),PERIOD     MOVE IN SYMBOL SEPARATOR             74250002
         LA    R6,L'PERIOD(R6)     INCREMENT BUF PTR PAST PREFIX        74300002
LSTAMV08 DS    0H                                                       74350002
         LH    R2,PDELEN3          PICK UP LENGTH OF WYMBOL AND         74400002
         BCTR  R2,NULL                 DECREMENT BY 1 FOR MVC INSTR.    74450002
         L     R15,PDEADRPT        R15=PTR TO SYMBOL                    74500002
         EX    R2,SYMMOVE          MOVE SYMBOL TO OUTPUT AREA           74550002
         LA    R6,ONE(R2,R6)       INCREMENT BUF PTR PAST SYMBOL        74600002
LSTAMV16 DS    0H                                                       74650002
         ST    R6,R6OFF(R13)       MODIFY REG 6 CONTENTS (IN SAVE AREA) 74700002
         RETURN (14,12)            RETRUN TO CALLER WITH HIS REGS       74750002
         SPACE                                                          74800002
SYMMOVE  MVC   ZERO(NULL,R6),ZERO(R15)  FOR MOVING NAMES TO BUFFER      74850002
DATAMOVE MVC   SP2(NULL,R6),CONDATA(R3) MOVES CONVERTED DATA TO BUFFER  74900002
         SPACE 2                                                        74950002
*********************************************************************** 75000002
*                                                                       75050002
*        STAE RETRY ROUTINE                                             75100002
*                                                                       75150002
*********************************************************************** 75200002
         SPACE 3                                                        75250002
RETRY    DS    0H                                                       75300002
         L     R4,CVTPTR           PTR TO CVT                           75350002
         USING CVTDSECT,R4         ADDRESSABILITY FOR CVT               75400002
         L     R4,CVTTCBP          TCB PTR                              75450002
         L     R4,FOUR(R4)         CURRENT TCB PTR                      75500002
         DROP  R4                                                       75550002
         USING TCB,R4              TCB ADDRESSABILITY                   75600002
         L     R9,TCBTRN           TCOMTAB PTR                          75650002
         OI    TSTFLGS4,TSTRERTN   TURN ON RETRY IN PROCESS SW          75660002
         L     R13,REGSAVE2        PTR TO SAVE AREA                     75700002
         LM    R10,R12,R10OFF(R13)     RESTORE MODULE ADDRESSABILITY    75750002
         LA    R15,TWENTY          INDICATE ERROR RETURN                76000002
         ST    R15,LSTRETCD        SAVE RETURN CODE                     76050002
         B     LSTMN90             RETURN                               76100002
         EJECT                                                          76150002
RETRYAD  DC    A(RETRY)            PTR TO STAE RETRY ROUTINE            77000002
FFOUR    DC    F'4'                CONSTANT OF 4, GENERAL USE           77050002
FEIGHT   DC    F'8'                CONSTANT OF 8, GENERAL USE           77052002
TWELVE   DC    F'12'               CONSTANT OF 12, GERERAL USE          77060002
LENFIVE  DC    H'5'                LENGTH FOR MESSAGE INSERTS           77070002
         DS    0F                                                       77100002
SPMASK   DC    X'01000000'         SUBPOOL NUMBER MASK FOR FREEMAIN     77150002
ENDADR   DC    X'00FFFFFF'         MAXIMUM CORE ADDRESS                 77200002
HONE     DC    H'1'                CONSTANT OF 1, GENERAL USE           77250002
H16      DC    H'16'               CONSTANT OF 16, GENERAL USE          77300002
H32      DC    H'32'               CONSTANT OF 32                       77350002
MAXHWRD  DC    H'32767'            MAX POSITIVE HALFWORD VALUE          77400002
         SPACE                                                          77450002
SMTLABL  DS    0H                  SMT TEST LABEL FOR XCTL MACRO        77500002
LST      DC    C'LST'              CONSTANT USED BY MAINLINE BLDL RTNE  77550002
         SPACE                                                          77600002
         ORG   *-HEX0A             ACCOUNT FOR X'00H TO X'09' IN TABLE  77650002
SIGNTBL  DS    0H                  TABLE FOR CONVERTING A ZONE TO SIGN  77700002
         ORG   *+HEX0A             RESET LOC CTR TO ACTUAL TABLE        77750002
         DC    C'+-+-++'           ACTUAL SIGN TABLE                    77800002
         SPACE                                                          77850002
         DS    0H                                                       77900002
SIGNPAT  DC    X'00A0'             USED TO TEST FOR VALID SIGN          77950002
VALZONE  DC    C'0'                USED TO GET A NUMERIC ZONE           78000002
         SPACE 2                                                        78050002
*********************************************************************** 78100002
*                                                                     * 78150002
*  THIS TABLE IS USED TO CONVERT THE HEX TYPE CODES TO THEIR CHARACTER  78200002
*  EQUIVALENT FOR PLACING THE FORMAT TYPE IN MESSAGES.                  78250002
*                                                                     * 78300002
*********************************************************************** 78350002
         SPACE                                                          78400002
LSTTYPE  DC    C'CXBIFHEDAYSVPZ'   EBCDIC FOR DATA TYPE CODES           78450002
IKJEGSPL IKJEGSPL RTRY=RETRY,ABNTB=ABENDTAB,MODNM=IKJEGLSA,TNM=LIST     78460002
SUPERZAP DC    50CL1'Z'            AREA FOR TEMP UPDATES                78500002
ABENDTAB DS    0F                  FULL WORD ALIGNMENT         @ZA06225 78510003
         DC    AL1(97)             CODE FOR PROTECTION CHECK            78520002
         DC    AL3(BLOW3)          RESUME ADDRESS FOLLOWING             78530002
         DC    AL1(97)             CODE FOR PROTECTION CHECK            78532002
         DC    AL3(BLOW1)          RESUME ADDRESS FOLLOWING             78534002
         DC    AL1(97)             CODE FOR PROTECTION CHECK            78540002
         DC    AL3(BLOW2)          RESUME ADDRESS FOLLOWING             78542002
         DC    AL1(97)             CODE FOR PROTECTION CHECK            78544002
         DC    AL3(LSTBPT04)       RESUME ADDRESS FOLLOWING             78546002
         DC    X'FF'               END OF TABLE                         78548002
         EJECT                                                          78550002
*********************************************************************** 78600002
*                                                                       78650002
*  THE FOLLOWING TABLE IS USED TO TRANSLATE UNPRINTABLE CHARACTERS    * 78700002
*  TO PERIODS (.) SO THAT THEY WILL BE ACCEPTABLE TO THE TERMINAL.    * 78750002
*  USED WHEN OUTPUT TYPE IS 'C'.                                      * 78800002
*********************************************************************** 78850002
         SPACE                                                          78900002
TRTABLE  DS    0H                                                       78950002
         DC    256C'.'             ALL CHARS NOT OTHERWISE DEFINED ='.' 79000002
         ORG   TRTABLE+X'40'       BLANK OR SPACE                       79050002
         DC    AL1(*-TRTABLE)      DEFINE                               79100002
         ORG   TRTABLE+X'4A'       CENT, PERIOD, LT, LEFT PAREND,       79150002
*                                  PLUS, VERTICAL BAR, AMPERSAND        79200002
         DC    7AL1(*-TRTABLE)     DEFINE                               79250002
         ORG   TRTABLE+X'5A'       EXCLAMATION, DOLLAR, PERIOD,         79300002
*                                  RIGHT PAREND, SEMICOLON,             79350002
*                                  LOGICAL NOT, DASH, SLASH             79400002
         DC    8AL1(*-TRTABLE)     DEFINE                               79450002
         ORG   TRTABLE+C','        COMMA, PERCENT, UNDERLINE, GT, QUES. 79500002
         DC    5AL1(*-TRTABLE)     DEFINE                               79550002
         ORG   TRTABLE+C':'        COLON, LB., AT, APSTRPHE, EQ, DBL Q. 79600002
         DC    6AL1(*-TRTABLE)     DEFINE                               79650002
         ORG   TRTABLE+C'A'-C' '   LOWER CASE 'A' TO 'I'                79700002
         DC    9AL1(*-TRTABLE)     DEFINE                               79750002
         ORG   TRTABLE+C'J'-C' '   LOWER CASE 'J' TO 'R'                79800002
         DC    9AL1(*-TRTABLE)     DEFINE                               79850002
         ORG   TRTABLE+C'S'-C' '   LOWER CASE 'S' TO 'Z'                79900002
         DC    8AL1(*-TRTABLE)     DEFINE                               79950002
         ORG   TRTABLE+C'A'        UPPER CASE 'A' TO 'I'                80000002
         DC    9AL1(*-TRTABLE)     DEFINE                               80050002
         ORG   TRTABLE+C'J'        UPPER CASE 'J' TO 'R'                80100002
         DC    9AL1(*-TRTABLE)     DEFINE                               80150002
         ORG   TRTABLE+C'S'        UPPER CASE 'S' TO 'Z'                80200002
         DC    8AL1(*-TRTABLE)     DEFINE                               80250002
         ORG   TRTABLE+C'0'        NUMERALS '0' TO '9'                  80300002
         DC    10AL1(*-TRTABLE)    DEFINE                               80350002
         ORG   TRTABLE+256         SET LOCATION CTR TO END OF TRTABLE   80400002
         EJECT                                                          80450002
*********************************************************************** 80500002
*                                                                       80550002
*                                                                       80600002
*  ---NOTICE---  THIS DSECT IS A COPY OF THE ONE PRODUCED BY THE PARSE  80650002
*                MACROS IN IKJEGLST. THIS DSECT MUST BE UPDATED         80700002
*                WHENEVER THE PARSE MACROS ARE CHANGED OR WHEN THEIR    80750002
*                EXPANSION CHANGES.                                     80800002
*********************************************************************** 80850002
IKJPARMD DSECT                                                          80900002
         DS    2A                  CHAIN PTR                            80950002
ADDR1    DS    9A                  ADDRESS PDE FOR 1ST ADDR OF RANGE    81000002
         DS    9A                  ADDRESS PDE FOR 2ND ADDR OF RANGE    81050002
         DS    A                   CHAIN ADDRESS                        81100002
TYPE     DS    AL2                 TYPE KEYWORD PDE                     81150002
LATTR    DS    AL2                 LENGTH ATTRIBUTE PDE                 81200002
MATTR    DS    AL2                 MULTIPLICITY ATTRIBUTE PDE           81250002
PRINT    DS    AL2                 PRINT KEYWORD PDE                    81300002
LENGTH   DS    2A                  LENGTH SUBFIELD                      81350002
MULTI    DS    2A                  MULTIPLICITY SUBFIELD                81400002
DSNAME   DS    6A                  DSNAME SUBFIELD OF PRINT KEYWORD     81450002
         DS    0D                  ALIGNMENT FOR STORAGE PURPOSES       81500002
         SPACE                                                          81550002
         EJECT                                                          81560002
IKJEGLSA CSECT                                                          81600002
         EJECT                                                          81650002
LSTWORK  DSECT                                                          81700002
         SPACE                                                          81750002
*********************************************************************** 81800002
*                                                                     * 81850002
*  ---NOTICE---                                                       * 81900002
*                                                                     * 81950002
***** THERE IS A DUPLICATE OF THIS DSECT IN IKJEGLST AND ANY CHANGES ** 82000002
*****  TO THE DSECT MUST BE MADE IN BOTH MODULES.                    ** 82050002
*                                                                     * 82100002
*  THIS DSECT MAPS A SECTION OF THE COMMON WORKING CORE POINTED TO    * 82150002
*  BY 'WORKAREA' IN TCOMTAB.                                          * 82200002
*                                                                     * 82250002
*********************************************************************** 82300002
         SPACE                                                          82350002
DWORK    DS    D                   DOUBLE WORD WORKAREA                 82400002
         ORG   DWORK               USE WORK AREA FOR XCTL LIST          82450002
LXCTL1   DS    2A                  LIST PARM LIST FOR XCTL              82500002
PARSEPL  DS    7F                  PARSE CALLING PARAMETER LIST.        82550002
         ORG   PARSEPL             REUSE CORE USED BY PARSE PARM LIST   82600002
LSTRPT   DS    0H                  START OF SECTION REUSED FOR ADDR LST 82650002
APDE     DS    9F                  WORKING COPY OF THE ADDRESS PDE      82700002
A1       DS    A                   CONTAINS CURRENT ADDR OF INPUT       82750002
A1LMATTR DS    F                   LENGTH AND MULTIPLICITY FACTORS      82800002
         ORG   A1LMATTR            PLACE LNTH AND MULTI IN ONE FULLWORD 82850002
A1L      DS    H                   LENGTH                               82900002
A1M      DS    H                   MULTPLICITY FACTOR                   82950002
A1FLG    DS    X                   FLAG BYTE FOR ADDR1 INFORMATION      83000002
A1FPD    EQU   X'80'               FLOATING PT DBL                      83050002
A1FPE    EQU   X'40'               FLOATING PT SINGLE                   83100002
A1GEN    EQU   X'20'               GENERAL REG                          83150002
A1REG    EQU   X'10'               ADDRESS 1 IS A REG.                  83200002
         SPACE                                                          83250002
A1ABS    EQU   X'00'               ADDR IS ABSOLUTE                     83300002
A1SYM    EQU   X'03'               ADDR IS SYMBOLIC                     83350002
A1REL    EQU   X'01'               ADDR IS RELATIVE                     83400002
         SPACE                                                          83450002
A1TYPE   DS    X                   CONTAINS TYPE CODE FOR ADDR1         83500002
REMAIN   DS    H                   REMAINDER                            83550002
A2       DS    A                   SECOND ADDR IF A RANGE WAS GIVEN     83600002
ARTIFMUL DS    H                   VALUE OF ARTIFICIAL MULTIPLICITY     83650002
REMAIN2  DS    H                   BACKUP COPY OF REMAINDER             83700002
REGSTART DS    F                   START ADDR OF REG SAVE AREA TO LIST  83750002
LSTRETCD DS    F                   HOLDS RETURN CODE                    83800002
LASTLEN  DS    H                   CONTAINS REMAINDER FROM LSTLMTCK     83850002
COMFLGS  DS    X                   FLAG BYTES FOR PROCESS CONTROL       83900002
TWOADDRS EQU   X'80'               1 INDICATE ADDR RANGE                83950002
ARTIMSW  EQU   X'40'               1 INDICATE CONTROL IS ARTIFICIAL     84000002
NOINDENT EQU   X'20'               1 INDICATES DATA NOT TO BE INDENTED  84050002
SECOND   EQU   X'10'               1 INDICATES PROCESSING 2ND GROUP     84100002
WRAPSW   EQU   X'08'               1 INDICATES 2ND REG LOWER THAN 1ST   84150002
PARSEFLG EQU   X'04'               SW SHOWS IO REQUESTED BY PARSE EXIT  84200002
OUTCORE  EQU   X'02'               REQUEST EXTENDS OUT OF CORE          84250002
DATASIZE EQU   X'01'               SYMBOLIC FOR NUMBER OF HEX FLDS/GRP  84300002
         SPACE                                                          84350002
*  THE FOLLOWING FIELDS DEFINE A VALUE PDE FOR CONVERTING DATA.         84400002
VPDE     DS    0F                  VALUE PDE FOR CONVERTING DATA        84450002
VPDEPT   DS    A                   PTR TO DATA                          84500002
VPDEL    DS    H                   LENGTH OF DATA FOR CONVERSION        84550002
VPDEFLG  DS    X                   FLAGS                                84600002
VPDET    DS    X                   HEX TYPE CODE FOR VALUE.             84650002
         SPACE                                                          84700002
RPTSIZE  EQU   *-LSTRPT            LNTH OF REUSED SECTION.              84750002
LMATTR   DS    F                   LENGTH AND MULTIPLICITY FACTOR FLD'S 84800002
         ORG   LMATTR              PLACE LNTH AND MULTI IN ONE FULLWORD 84850002
BINLEN   DS    H                   CONVERTED LENGTH GIVEN BY USER       84900002
BINMUL   DS    H                   CONVERTED MLTPLCTY GIVEN BY USER     84950002
LXCTL    XCTL  ,SF=L               RESERVE SPACE FOR LIST FORM OF XCTL  85000002
ENDOBUF  DS    A                   CONTAINS MAX BUF ADDR + 1            85050002
ENDOGRP  DS    A                   CONTAINS GROUP STOP ADDRESS          85100002
DATAPT   DS    2F                  DATA PTR LIST FOR IKJEGIO1           85150002
         SPACE                                                          85200002
TYPESAVE DS    X                   CONTAINS SPECIFIED OR DEFAULTED TYPE 85250002
RETRYSAV DS    AL3                 CONTAINS MAINLINES STAE RETRY ADDR   85300002
LSTFLGS  DS    X                   FLAG BYTES TO SAVE PARSE DATA        85350002
TYPEFLG  EQU   B'10000000'         SET TO ONE IF TYPE KEYWORD USED      85400002
LNTHFLG  EQU   B'01000000'         SET TO ONE IF LENGTH KEYWORD USED    85450002
MULTIFLG EQU   B'00100000'         SET TO ONE IF MULTIPLICITY GIVEN     85500002
         SPACE                                                          85550002
         DS    X                   SPILL BYTE FOR HOLDAREA  ON ODD ADDR 85600002
LASTINST DS    X                   BYTE FOR INSTR FORMATTING            85610002
TURNOFF  EQU   B'00000000'         USED TO TURN OFF LAST INST SW        85620002
INSTSW   EQU   B'11111111'         USED TO COMPARE IF LAST INST         85630002
         DS    0D                  ALIGN HOLDAREA                       85650002
HOLDAREA DS    XL32                HOLDS DATA BEING CONVERTED CURRENTLY 85700002
WKWORDS  DS    3F                  FWDS-DYNAMIC WK AREA                 85710002
*                                  WHEN CALLED TO CK VAL. OF ADD        85730002
STAELIST STAE  MF=L                                                     85750002
         SPACE                                                          85800002
LWLNTH   EQU   *-LSTWORK           LENGTH OF DSECT                      85850002
         EJECT                                                          85900002
         TITLE 'IKJEGLSA, ''LIST'', TCOMTAB, COMMUNICATIONS DSECT'      89050002
         TCOMTAB                                                        89100002
         TITLE 'IKJEGLSA, ''LIST'', IKJPARMA, ADDRESS PDE MAP DSECT'    89150002
         IKJPARMA                                                       89200002
APL      EQU   PDECHAIN-IKJPARMA   SYMBOLIC LENGTH OF AN ADDRESS PDE    89250002
         TITLE 'IKJEGLSA, ''LIST'', BRKELEM, BREAK ELEMENT MAP DSECT'   89300002
         BRKELEM                                                        89350002
CVTDSECT DSECT                                                          89400002
         CVT                                                            89450002
         IKJTCB                                                         89500002
         END                                                            89550002
./  ADD  SSI=81730767,NAME=IKJEGLST
         TITLE 'IKJEGLST, ''LIST'' SUBCOMMAND OF TEST, FIRST LOAD'      00050002
* /* START OF SPECIFICATIONS ****                                       00060002
*02*  PROCESSOR = ASSEMBLER                                             00070002
**** END OF SPECIFICATIONS ***/                                         00080002
*A375600,375700                                                @YM06177 00090002
*A453600,453700,635100,635200                                 @ZA07140  00095003
*C463000                                             @ZA09259,@ZA07138  00097003
*********************************************************************** 00100002
*                                                                       00150002
* STATUS--VERSION NO. 01, OS/VS2 RELEASE NO. 02                         00200002
*                                                                       00250002
* FUNCTION--                                                            00300002
*    THIS MODULE IS THE FIRST LOAD OF THE 'LIST' SUBCOMMAND OF TEST.    00350002
*    IT IS ENTERED INITIALLY WHENEVER A LIST SUBCOMMAND IS ENCOUNTERED  00400002
*    BY THE TEST MAINLINE ROUTINE. THE LIST SUBCOMMAND OF TEST          00450002
*    DISPLAYS REQUESTED AREAS OF MAIN STORAGE AND/OR THE GENERAL        00500002
*    AND FLOATING POINT REGISTERS. THIS MODULE PREFORMS THE LIST        00550002
*    INITIALIZATION FUNCTION, THE LIST IN HEXADECIMAL FORMAT FUNCTION,  00600002
*    AND THE LIST GENERAL AND FLOATING POINT REGISTERS FUNCTION.        00650002
*                                                                       00700002
* ENTRY POINTS--                                                        00750002
*         IKJEGLST                                                      00800002
*         1. ENTERED FROM TEST MAINLINE FOR THE LIST SUB-CMD.           00850002
*         2. ENTERED FROM IKJEGLSA WITH 'PCHLSTVL' SW IN TSTFLGS1       00900002
*         SET TO ONE IF THE NEXT ADDRESS IN AN ADDRESS LIST             00950002
*         IS REGISTER TYPE OR IF THE FORMAT TYPE IS HEX (X).            01000002
*         IKJPARSE  TO PARSE THE CUBCOMMAND BUFFER.                     01050002
*                                                                       01100002
* INPUT--                                                               01150002
*    ONE LINE OF INPUT FROM TERMINAL IN INPUT BUFFER.                   01200002
*                                                                       01250002
* OUTPUT--                                                              01300002
*    LINES TO THE TERMINAL DISPLAYING REQUESTED DATA, OR, IF THE        01350002
*    PRINT KEYWORD WAS SPECIFIED, THE DATA IS WRITTEN TO A DATA SET.    01400002
*                                                                       01450002
* EXTERNAL REFERENCES--                                                 01500002
*         IKJEGCVT  FOR CONVERSION OF ADDRESSES AND DATA FROM MACHINE   01550002
*         FORMAT TO PRINTABLE FORMAT. FOR CONVERSION OF ADDRESSES,      01600002
*         CVT IS ENTERED WITH THE HIGH ORDER BIT OF REG 0 SET TO ONE    01650002
*         AND REGISTER 1 CONTAINING THE COMPLEMENT OF THE ADDRESS OF    01700002
*         AN ADDRESS PDE. THE ADDRESS PDE DESCRIBES THE ADDRESS TO BE   01750002
*         CONVERTED. FOR DATA CONVERSIONS, REG 0 IS SET TO ZERO, AND    01800002
*         REG 1 CONTAINS THE ADDRESS OF A VALUE PDE DESCRIBING THE      01850002
*         DATA TO BE CONVERTED.                                         01900002
*                                                                       01950002
*         IKJEGIO  TO OUTPUT DATA TO THE TERMINAL OR TO A PRINT DATA    02000002
*         SET, AND TO OUTPUT MESSAGES TO THE TERMINAL.                  02050002
*         IKJPARSE  TO PARSE THE SUB-COMMAND CHAIN.                     02400002
*                                                                       02450002
* EXITS, NORMAL--                                                       02500002
*         BRANCH REGISTER 14 TO THE ORIGINAL CALLER OF LIST WHEN THE    02550002
*         LAST ADDRESS PDE HAS BEEN PROCESSED.                          02600002
*         XCTL TO IKJEGLSA IF TYPE ATTRIBUTE IS ONE OF THE FOLLOWING-   02650002
*         A, B, C, D, E, F, H, I, P, Q, S, V, Y, OR Z.                  02700002
*                                                                       02750002
* EXITS, ERROR--                                                        02800002
*         NONE                                                          02850002
*                                                                       02900002
* TABLES/WORK AREAS --                                                  02950002
*    TCOMTAB  POINTED AT BY REG 9, IS THE COMMUNICATIONS TABLE FOR THE  03000002
*    TEST PROCESSOR.                                                    03050002
*                                                                       03100002
*    LSTWORK  THE MAPPING DSECT FOR THE WORK AREA USED BY IKJEGLST AND  03150002
*    IKJEGLSA. IT HOLDS WORKING COPIES OF THE ATTRIBUTES, ADDRESSES     03200002
*    FOR THE DATA CURRENTLY BEING LISTED, PARAMETER LISTS FOR CALLING   03250002
*    VARIOUS ROUTINES, AND A DATA BUFFER FOR REMOVING BREAKPOINT SVC'S  03300002
*                                                                       03350002
*    PARAMETER DESCRIPTOR LIST  (PDE) SET UP BY PARSE                   03400002
*                                                                     * 03450002
* ATTRIBUTES--                                                          03500002
*    REENTRANT, REFRESHABLE, PROBLEM PROGRAM.                           03550002
*                                                                       03600002
* CHARACTER CODE DEPENDENCY--                                           03650002
*                                                                       03700002
* NOTES--                                                               03750002
*                                                                       03757003
* CHANGE-ACTIVITY -                                                     03764003
*                 APAR OZ07138 - CHANGES TO USE THE CORRECT RB          03771003
*                 WHEN COPYING REGISTERS. THE CORRECT POINTER           03778003
*                 IS IN TCOMTAB IN ECBPP+1.                             03785003
*                 APAR OZ09259 - SAME AS ABOVE                          03788003
*                                                                       03792003
*********************************************************************** 03850002
         TITLE 'IKJEGLST, ''LIST'', EUQATES'                            03900002
         COPY  IKJEGSIO            OBTAIN IO CALLING MACROS             03910002
IKJEGLST CSECT                                                          03950002
         SPACE 1                                                        04000002
*********************************************************************** 04050002
         SPACE 1                                                        04100002
*  REGISTER EQUATES.                                                    04150002
         SPACE                                                          04200002
R0       EQU   0                   WORK REG                             04250002
R1       EQU   1                   PARAMETER REG                        04300002
R2       EQU   2                   WORK REG                             04350002
R3       EQU   3                   WORK REG                             04400002
R4       EQU   4                   IN PROCESS SECTION, LENTH CNTRL CTR  04450002
R5       EQU   5                   WORK REG                             04500002
R6       EQU   6                   IN PROCESS SECTION, CUR BUF PTR      04550002
R7       EQU   7                   INTERNAL LINKAGE REGISTER            04600002
R8       EQU   8                   POINTS TO CURRENT ADDRESS PDE        04650002
R9       EQU   9                   BASE FOR TCOMTAB DSECT               04700002
R10      EQU   10                  BASE FOR LSTWORK DSECT               04750002
R11      EQU   11                  *** SPARE REGISTER, FOR MAINTAINANCE 04800002
R12      EQU   12                  PROGRAM BASE REGISTER                04850002
R13      EQU   13                  PROGRAM SAVE AREA                    04900002
R14      EQU   14                  EXTERNAL LINKAGE REGISTER            04950002
R15      EQU   15                  EXTERNAL LINKAGE REGISTER            05000002
         SPACE 1                                                        05050002
*********************************************************************** 05100002
         SPACE 2                                                        05150002
*  DATA EQUATES FOR OPERANDS OF IMMEDIATE TYPE INSTRUCTIONS.            05200002
         SPACE                                                          05250002
NULL     EQU   0                   USED FOR BALR R,0 AND BCTR R,0.      05300002
ZERO     EQU   0                   SYMBOLIC EQUATE                      05350002
ONE      EQU   1                   SYMBOLIC EQUATE                      05400002
TWO      EQU   2                   SYMBOLIC EQUATE                      05450002
THREE    EQU   3                   USED WHERE AN ABSOLUTE 3 IS REQ'D    05500002
FOUR     EQU   4                   SYMBOLIC EQUATE                      05550002
FIVE     EQU   5                   SYMBOLIC EQUATE                      05600002
EIGHT    EQU   8                   SYMBOLIC EQUATE                      05650002
TWELVE   EQU   12                  SYMBOLIC FOR 12, USED AS AN RC       05700002
SIXTEEN  EQU   16                  SYMBOLIC EQUATE                      05750002
TWENTY   EQU   20                  ERROR RETURN CODE                    05800002
HEX80    EQU   X'80'               SYMBOLIC MASK                        05850002
HEXFF    EQU   X'FF'               SYMBOLIC MASK                        05900002
         SPACE                                                          05950002
BLANK    EQU   C' '                SYMBOLIC FOR BLANK (SPACE).          06000002
PERIOD   EQU   C'.'                SYMBOLIC EQUATE                      06050002
CHAR0    EQU   C'0'                SYMBOLIC FOR  CHARACTER 0            06100002
CHAR9    EQU   C'9'                SYMBOLIC FOR CHARACTER 9             06200002
BALRCODE EQU   X'05'               OP CODE FOR BALR INSTRUCTION         06250002
BALCODE  EQU   X'45'               OP CODE FOR BAL INSTRUCTION          06300002
         SPACE                                                          06350002
CFLDMASK EQU   B'00011111'         MASK TO ISOLATE REMAINDERS FOR C TYP 06400002
DWBDY    EQU   B'00000111'         USED TO TEST ADDRS FOR DBL WRD BDY.  06450002
FWBDY    EQU   B'00000011'                                FULL          06500002
HWBDY    EQU   B'00000001'                                HALF          06550002
INSTRLEN EQU   B'11000000'         FOR TESTING 1ST 2 BITS OF INSTRS     06600002
PACKMSK  EQU   X'6F'               USED TO SET UP LNTHS FOR PACK INSTR  06650002
         SPACE                                                          06700002
*  SYMBOLIC OFFSETS FOR THE SYMINFO BLOCK.                              06750002
         SPACE                                                          06800002
SIDATAPT EQU   0                   OFFSET TO DATA ADDR IN SI-BLOCK      06850002
SITYPE   EQU   4                   OFFSET TO TYPE FIELD OF SI-BLOCK     06900002
SIMUL    EQU   6                   OFFSET TO LAST 2 BYTES OF MLTPLCTY   06950002
SILEN    EQU   8                   OFFSET TO LNTH IN SYMINFO            07000002
SINXTPTR EQU   12                  OFFSET INTO SYMINFO BLK FOR CHAIN PT 07050002
SYMINFOL EQU   16                  SYMBOLIC FOR LENGTH OF SYMINFO BLK   07100002
         SPACE                                                          07150002
LSTBUFL  EQU   82                  LENGTH TO BE BLANKED IN BUFFER       07200002
MAXLINE  EQU   100                 MAX LINE LENGTH FOR OUTPUT           07250002
LSTIBLK  EQU   31                  LNTH OF DATA MOVED TO HOLD AREA      07300002
LL00LEN  EQU   4                   SYMBOLIC FOR LENGTH OF LL00 FIELD    07350002
ADDRLEN  EQU   7                   LENGTH OF AN ADDR FIELD IN THE BUF   07400002
RADDRLEN EQU   3                   LENGTH OF REGISTER ADDRESS FIELD     07450002
VPDELEN  EQU   8                   SYMBOLIC FOR LENGTH OF A VALUE PDE   07500002
MINLL    EQU   40                  MINIMUM LINE LNTH FORMATTED BY LIST  07550002
STDLL    EQU   81                  DEFAULT LINE LNTH WHEN TMPLL IS LOW  07600002
         SPACE                                                          07650002
H2ND     EQU   1                   OFFSET TO 2ND BYTE OF A HALFWORD     07700002
F1STHALF EQU   0                   OFFSET TO 1ST HALFWORD OF A FIELD    07750002
LL00OFF  EQU   0                   OFFSET INTO BUFFER FOR LL00 FIELD    07800002
DATAOFF  EQU   4                   OFFSET TO DATA PORTION OF BUFFER     07850002
R1OFF    EQU   24                  OFFSET INTO SAVE AREA FOR REG 1      07900002
R6OFF    EQU   44                  OFFSET INTO SAVE AREA FOR REG 6      07950002
R10OFF   EQU   60                  OFFSET INTO SAVE AREA FOR R10        08000002
SP1      EQU   1                   DISPLACEMENT FOR 1 SPACE IN BUF      08050002
SP2      EQU   2                   SYMBOLIC FOR 2 SPACES                08100002
SP4      EQU   4                   FOR INCREMENTING PAST 4 SPACES       08150002
SP5      EQU   5                   DISPLACEMENT FOR 5 SPACES IN BUF     08200002
CONDATA  EQU   1                   OFFSET TO DATA IN CONVERT OUTPUT     08250002
CONLFLD  EQU   0                   OFFSET TO LNTHFLD IN CONVERT OUTPUT  08300002
FOREPTR  EQU   8                   OFFSET TO FOREWARD PTR IN SAVE AREA  08350002
BACKPTR  EQU   4                   OFFSET TO BACKWARD PTR IN SAVE AREA  08400002
CVTSPACE EQU   64                  OFFSET INTO COMMON WORK AREA FOR LST 08450002
LSTWRKPT EQU   0                   OFFSET INTO PARM LIST FOR DSECT BASE 08500002
LSTPDEPT EQU   4                   OFFSET INTO PARM LIST FOR PDE ADDR   08550002
         SPACE                                                          08600002
ATTNBIT  EQU   B'01000000'                                              08650002
EQZERO   EQU   8                   COND CODE MASK FOR CC OF 0           08700002
NOTONES  EQU   14                  COND. CODE MASK FOR CC OF 0, 1, OR 2 08750002
         SPACE                                                          08800002
GRINCR   EQU   1                   USED BY LSTREG TO INCRE GEN REG NO.  08850002
GRMAX    EQU   15                  HIGHEST GENERAL REGISTER NUMBER      08900002
GRFLENO  EQU   11                  LNTH OF OUTPUT DATA, GEN REG F FRMT  08950002
GRXLENO  EQU   8                   LNTH OF OUTPUT DATA, GEN REG IN HEX  09000002
RBGRSAVE EQU   32                  OFFSET INTO SVRB FOR REG SAVE AREA   09050002
         SPACE                                                          09100002
FPRINCR  EQU   2                   INCREMENT FOR FLOATING POINT REGS    09150002
FPRMAX   EQU   6                   MAX FLOATING POINT REG NUMBER        09200002
REINLEN  EQU   4                   LNTH OF INPUT DATA FOR 'RE' ADDRS    09250002
RDINLEN  EQU   8                   LNTH OF INPUT DATA FOR 'RD' ADDRS    09300002
REXLENO  EQU   8                   LNTH OF HEX OUTPUT FOR 'RE' ADDRS    09350002
RDXLENO  EQU   16                  LNTH OF HEX OUTPUT FOR 'RD' ADDRS    09400002
REELENO  EQU   15                  LNTH OF 'E' FORMAT OUTPUT            09450002
RDDLENO  EQU   24                  LNTH OF 'D' FORMAT OUTPUT            09500002
         SPACE                                                          09550002
HEXDLEN  EQU   4                   DEFAULT LENGTH FOR HEX FORMAT        09600002
         SPACE 2                                                        09650002
*  EQUATES FOR THE INTERNAL ASSEMBLER TYPE CODES.                       09700002
         SPACE                                                          09750002
CHARCODE EQU   X'00'               TYPE ATTRIBUTE =CHAR                 09800002
HEXCODE  EQU   X'04'                ''     ''     =HEXADECIMAL          09850002
BINCODE  EQU   X'08'                ''     ''     =BINARY               09900002
ICODE    EQU   X'0C'                ''     ''     =INSTRUCTION          09950002
FCODE    EQU   X'10'                ''     ''     =FIXED PT, FULLWORD   10000002
HCODE    EQU   X'14'                ''     ''       ''   '', HALFWORD   10050002
ECODE    EQU   X'18'                ''     ''     =FLT PT, FULLWORD     10100002
DCODE    EQU   X'1C'                ''     ''      ''  '', DBL WORD     10150002
AQCODE   EQU   X'20'                ''     ''     =A AND Q ADDR CONST   10200002
YCODE    EQU   X'24'                ''     ''     =Y ADDR CONST         10250002
SCODE    EQU   X'28'                ''     ''     =S ADDR CONST         10300002
VCODE    EQU   X'2C'                ''     ''     =V ADDR CONST         10350002
PACKCODE EQU   X'30'                ''     ''     =PACKED DECIMAL       10400002
ZONECODE EQU   X'34'                ''     ''     =ZONED DECIMAL        10450002
LCODE    EQU   X'38'                ''     ''     =FLT PT, EXTENDED     10500002
         SPACE                                                          10550002
I0083    EQU   83                  NUMBER OF STATIC MESSAGE INSERT      10560002
I0084    EQU   84                  NUMBER OF STATIC MESSAGE INSERT      10570002
M0219    EQU   219                 NUMBER OF STATIC MESSAGE             10580002
M0220    EQU   220                 NUMBER OF STATIC MESSAGE             10590002
M0221    EQU   221                 NUMBER OF STATIC MESSAGE             10600002
BADESTAE EQU   24                  RETURN CODE FOR UNSUCCESSFUL ESTAE   10610002
      TITLE 'IKJEGLST, ''LIST'', INITIALIZATION/COMPLETION ROUTINES'    11000002
*********************************************************************** 11050002
*                                                                     * 11100002
*  PROGRAM BEGINS WITH STANDARD LINKAGE CONVENTIONS.                  * 11150002
*                                                                     * 11200002
*********************************************************************** 11250002
         SPACE                                                          11300002
LIST     SAVE  (14,12),,*                                               11350002
         LR    R12,R15             R12=BASE REG FOR PROG ADDRESSABILITY 11400002
         USING IKJEGLST,R12                                             11450002
         USING TCOMTAB,R9          COMMUNICATION TABLE ADDRESSABILITY.  11500002
         L     R6,REGSAVE2         R6=NEXT SAVE AREA                    11550002
         ST    R6,FOREPTR(R13)     FOREWARD CHAIN SAVE AREAS.           11600002
         ST    R13,BACKPTR(R6)     BACKWARD CHAIN SAVE AREAS.           11650002
         LR    R13,R6              R13=NEXT REGSAVE AREA ADDR.          11700002
         SPACE                                                          11750002
         TM    TSTFLGS1,PCHLSTVL   IS ENTRY FROM IKJEGLSA               11800002
         BO    IKJEGLSS            IF YES, BRANCH AROUND WORKAREA SETUP 11850002
         SPACE                                                          11900002
*  INITIALIZE WORKING STORAGE                                           11950002
         SPACE                                                          12000002
         L     R10,WORKAREA        PICK UP ADDR OF GENERAL WORK SPACE   12050002
         USING TSTCWORK,R10                                             12100002
         LA    R10,CWORKCMD        SET UP PTR TO WORK CORE FOR SUB-CMDS 12150002
         USING LSTWORK,R10                                              12200002
         XC    LSTWORK(LWLNTH),LSTWORK CLEAR WORK AREA                  12250002
         MVC   LXCTL(XCTLLEN),XCTLLF   MOVE LIST FORM OF XCTL TO DSECT  12300002
         XC    LSTRETCD,LSTRETCD       CLEAR RETURN CODE SAVE AREA      12350002
*                                                                       12400002
*  SET UP FOR AND ISSUE THE  STAE  MACRO                                12450002
*                                                                       12500002
LSTINT10 DS    0H                                                       12550002
         LA    R1,STAELIST         PTR TO LIST FORM MACRO               12700002
         L     R2,TSTSTAE          PTR TO TEST STAE MODULE              12750002
         STM   R10,R12,R10OFF(R13)     SAVE BASE PTR                    12800002
         ESTAE (R2),CT,PARAM=IKJEGSPL,RECORD=YES,XCTL=NO,MF=(E,(R1))    12810002
         SPACE                                                          12900002
         LTR   R15,R15             TEST RETURN CODE                     12950002
SMTSTAE  DS    0H                  SMT TEST LABEL FOR STAE MACRO        13000002
         BZ    STAEOK              CONTINUE IF ZERO                     13050002
         SPACE                                                          13100002
         STC   R15,TSTESTRC        SAVE RETURN CODE                     13110002
         LA    R15,BADESTAE        PREPARE TO SEND BACK RTN CODE        13120002
         ST    R15,LSTRETCD        SAVE FOR EXIT                        13130002
         B     LSTMN90             EXIT TO CALLER                       13140002
         SPACE                                                          13200002
*********************************************************************** 13250002
*                                                                     * 13300002
*  INITIALIZE PARAMETER LIST, TEST FOR A SCHEDULED ATTENTION, AND IF  * 13350002
*  NO ATTENTION IS PENDING, LINK TO PARSE.                            * 13400002
*                                                                     * 13450002
*********************************************************************** 13500002
STAEOK   DS    0H                                                       13550002
         TM    TSTFLGS1,PCHLSTVL   WAS ENTRY FROM IKJEGLSA              13700002
         BO    MORE02              IF YES, GO PROCESS                   13750002
         SPACE                                                          13800002
*  IF ENTRY WAS NOT FROM IKJEGLSA, THIS IS THE FIRST ENTRY, INITILIZE.  13850002
         SPACE                                                          13900002
         LA    R1,PARSEPL          PTR TO PARSE LIST                    13950002
         USING PPL,R1              ADDRESSABILITY FOR LIST              14000002
         L     R2,TSTUPT           PTR TO UPT                           14050002
         L     R3,TSTECT           PTR TO ECT                           14100002
         L     R4,TSTCPECB         PTR TO P/P ECB                       14150002
         ST    R2,PPLUPT           PUT PTR TO UPT INTO PARSE LIST       14200002
         ST    R3,PPLECT           PUT PTR TO ECT INTO PARSE LIST       14250002
         ST    R4,PPLECB           PUT PTR TO P/P ECB INTO PARSE LIST   14300002
         L     R2,PARSEPCL         PTR TO PARSE PCL                     14350002
         LA    R3,TSTANSPL         PTR TO ANSWER PLACE                  14400002
         L     R4,INBUF            PTR TO INPUT BUFFER                  14450002
         ST    R2,PPLPCL           PUT PTR TO PARSE PCL INTO PARSE LIST 14500002
         ST    R3,PPLANS           PUT PTR TO ANS PLACE INTO PARSE LIST 14550002
         ST    R4,PPLCBUF          PUT PTR TO INPUT BUF INTO PARSE LIST 14600002
         SPACE                                                          14650002
*  R6 SHOULD STILL CONTAIN THE SAVE AREA ADDRESS AT THIS POINT.         14700002
         SPACE                                                          14750002
         ST    R6,PPLUWA           PUT INTO PARSE LIST                  14800002
         DROP  R1                                                       14850002
         SPACE                                                          14900002
         LINK  EP=IKJPARS,ERRET=LINKFAIL LINK TO THE PARSE ROUTINE      14950002
PARSEBLO DS    0H                                                       14952002
         B     LINKOK              IF OK CONTINUE                       14960002
LINKFAIL DS    0H                                                       14970002
         LR    R6,R1               TRANSFER ABEND CODE                  14980002
         LR    R5,R15              TRANSFER RETURN CODE                 14982002
         XC    TSTIOPRM,TSTIOPRM   CLEAR PARM LIST                      14990002
         IKJEGSIO SVCERR,SVC=6,ABENDRG=(R6),RC=(R5), ISSUE IO CALLING  *14992002
               INST11=(NUM,I0040),ID=LST20,MF=(E,TSTIOPRM) FOR ERR MSG  14994002
         CH    R15,H16             TEST RETURN CODE                     14996002
         BL    LSTMN90             RETURN TO MNL RC=0                   14998002
         ST    R15,LSTRETCD        SAVE RC FOR MNL                      14998402
         B     LSTMN90             RETURN TO MNL WITH I/O RTN CODE      14998502
LINKOK   DS    0H                                                       14998802
         SPACE                                                          15000002
SMTPARS  DS    0H                  SMT TEST LABEL FOR PARSE LINK        15050002
         SPACE                                                          15100002
         SPACE 2                                                        15200002
*  TEST THE RETURN CODE FROM PARSE                                      15250002
         SPACE                                                          15300002
         LTR   R15,R15             TEST FOR RC=0                        15350002
         BNZ   PARSRC(R15)         IF NON-ZERO, BRANCH TO BRANCH TABLE  15400002
         L     R8,TSTANSPL         PICK UP ADDRESS OF PDL               15450002
         USING IKJPARMD,R8                                              15500002
         SPACE                                                          15550002
*********************************************************************** 15600002
*  NEXT EXTRACT THE NECESSARY DATA FROM THE ADDRESS PDE AND SET UP    * 15650002
*  THE ADDRESS INFORMATION FIELDS. CONVERT THE LENGTH AND MULTIPLICITY* 15700002
*  FACTORS TO BINARY IF THEY WERE SUPPLIED. SET THE TSTPRINT SWITCH   * 15750002
*  IF PRINT HAS BEEN SPECIFIED.                                       * 15800002
*********************************************************************** 15850002
         SPACE                                                          15900002
         CH    R15,PRINT           TEST FOR PRINT KEYWORD SPECIFIED     15950002
         BE    NOPRINT             IF NOT, BRANCH AROUND SETUP          16000002
         OI    TSTFLGS1,TSTPRINT   SET THE PRINT SPECIFIED FLAG         16050002
NOPRINT  DS    0H                                                       16100002
         CH    R15,TYPE            WAS A TYPE KEYWORD USED              16150002
         BE    NOTYPE              IF NOT, BRANCH                       16200002
         OI    LSTFLGS,TYPEFLG     IF TYPE USED, SET FLAG               16250002
NOTYPE   DS    0H                                                       16300002
         LH    R2,TYPE             PICK UP NUMBER OF TYPE KEYWORD OR 0  16350002
         IC    R2,TYPETBL(R2)      GET HEX CODE FOR FORMAT TYPE         16400002
         STC   R2,A1TYPE           PLACE TYPE CODE IN ADDR 1 DESCRIPTOR 16450002
         STC   R2,TYPESAVE         SAVE TYPE FOR POSSIBLE ADDR LIST     16500002
         CH    R15,LATTR           WAS THE LENGTH ATTR KEYWORD USED     16550002
         BE    NOLENGTH            IF NOT, BRANCH                       16600002
         OI    LSTFLGS,LNTHFLG     IF LENGTH GIVEN, SET FLAG            16650002
NOLENGTH DS    0H                                                       16700002
         CH    R15,MATTR           WAS MULTIPLICITY GIVEN               16750002
         BE    NOMULTI             IF NOT, BRANCH                       16800002
         OI    LSTFLGS,MULTIFLG    IF GIVEN, SET FLAG                   16850002
NOMULTI  DS    0H                                                       16900002
         L     R2,OUTBUF           GET PTR TO THE OUTPUT BUFFER         16950002
         XC    LL00OFF(LL00LEN,R2),LL00OFF(R2)   CLEAR LL00 FLD TO ZERO 17000002
         MVI   DATAOFF(R2),BLANK   MOVE A BLANK TO START OF DATA AREA   17050002
         MVC   DATAOFF+ONE(LSTBUFL,R2),DATAOFF(R2)     BLANK OUT BUFFER 17100002
         ST    R2,DATAPR           SET UP IO PARM LIST                  17150002
         LA    R3,MINLL            SET UP TO SEE THAT TMPLL=MIN LINE    17200002
         CH    R3,TMPLL            Q. IS TMPLL GT OR EQ TO MINIMUM      17250002
         LA    R3,STDLL            SET UP STANDARD LINE LNTH DEFAULT    17300002
         BH    LSTMN02             IF TMPLL LT MINIMUM, BRANCH          17350002
         CH    R3,TMPLL            IS TMPLL GREATER THAN STANDARD LL    17400002
         BL    LSTMN02             IF SO, USE STANDARD LINE LENGTH      17450002
         LH    R3,TMPLL            IF TMPLL NLT MIN, USE TMPLL          17500002
LSTMN02  DS    0H                                                       17550002
         LA    R2,DATAOFF(R3,R2)   R2=PTR TO END OF BUFFER+1            17600002
         ST    R2,ENDOBUF          SETUP END OF BUFFER ADDRESS          17650002
         LA    R8,ADDR1            SET UP ADDRESS OF ADDR PDE AS BASE   17700002
         USING IKJPARMA,R8         ADDRESSABILITY FOR ADDR PDE DSECT    17750002
         EJECT                                                          17800002
*********************************************************************** 17850002
*                                                                     * 17900002
*  BEGINNING OF REPEAT SECTION.  THE ROUTINE BELOW IS RE-ENTERED IF   * 17950002
*  A LIST OF ADDRESSES HAS BEEN GIVEN.                                * 18000002
*                                                                     * 18050002
*********************************************************************** 18100002
LSTMN04  DS    0H                                                       18150002
         L     R2,LMATTR           GET LENGTH AND MULTIPLICITY ATTR'S   18200002
         ST    R2,A1LMATTR             AND SET ADDRESS 1 ATTRIBUTES.    18250002
         TM    PDE2FLG3,AFLG       WAS A SECOND ADDRESS GIVEN           18300002
         L     R15,PDEUSER         GET DATA ADDR OR SI PTR              18350002
         BO    LSTMN05             IF YES, BRANCH                       18400002
         TM    PDE2FLG2,CTNAMFLG   WAS 2ND ADDRESS A CSECT NAME         18450002
         BNO   LSTMN06             BRANCH IF NO 2ND ADDRESS             18500002
LSTMN05  DS    0H                                                       18550002
         OI    COMFLGS,TWOADDRS    SET FLAG TO INDICATE ADDRESS RANGE   18600002
LSTMN06  DS    0H                                                       18650002
         LTR   R15,R15             IF R15 NEG, R15 POINTS TO SYMINFO    18700002
         BM    SYM1                IF SYMBOLIC, BRANCH                  18750002
LSTMN07  DS    0H                                                       18800002
         LA    R15,ZERO(R15)       ZERO OUT PDE WRITE BIT               18850002
         ST    R15,A1              SAVE ADDR OF CURRENT INPUT           18900002
         TM    COMFLGS,TWOADDRS    WERE TWO ADDRESSESS SPECIFIED        18950002
         BZ    ONLYONE             IF ONLY ONE ADDR, BRANCH             19000002
         L     R15,PDE2USER            GET SECOND ADDR OR SI PTR        19050002
         LTR   R15,R15             IF R15 NEG, R15 POINTS TO SYMINFO    19100002
         BNM   ONLYONE             IF ADDR2 IS SYMBOLIC, BRANCH         19150002
         L     R15,SIDATAPT(R15)   PICK UP INPUT ADDR FROM SYMINFO BLK  19200002
ONLYONE  DS    0H                                                       19250002
         LA    R15,ZERO(R15)       ZERO OUT PDE WRITE BIT               19300002
         ST    R15,A2              SET A2 TO CURRENT SECOND ADDR        19350002
         LA    R15,HOLDAREA        MAKE A PTR TO DATA HOLDING AREA      19400002
         ST    R15,VPDEPT          SET UP VALUE PDE FOR DATA CONVERT    19450002
         SPACE                                                          19500002
*  NEXT TEST WHETHER ADDR IS REGISTER TYPE                              19550002
         SPACE                                                          19600002
         TM    PDEFLG4,GENR+LFPR+SFPR  IS ADDRESS TYPE REGISTER         19650002
         BZ    NOTREG              IF NOT, BRANCH                       19700002
         NC    PDEINDCT,PDEINDCT   IF REG, IS IT INDIRECT               19750002
         BZ    LSTREG              IF REG ADDR NOT INDIRECTED, BR       19800002
         SPACE                                                          19850002
*  NEXT TEST WHETHER ADDRESS IS RELATIVE                                19900002
         SPACE                                                          19950002
NOTREG   DS    0H                                                       20000002
         TM    PDEFLG4,CTONLY      IS ADDRESS A CSECT ONLY              20050002
         BO    LSTMN09             IF CSECT ONLY, BRANCH                20100002
         TM    PDEFLG4,RELADDR     IS ADDRESS TYPE RELATIVE             20150002
         BZ    LSTMN10             IF NOT RELATIVE, BRANCH              20200002
         NC    PDEINDCT,PDEINDCT   IF RELATIVE, IS IT INDIRECTED        20250002
         BNZ   LSTMN10             IF INDIRECTED, BRANCH                20300002
         TM    PDEEXPTR,HEXFF      IF RELATIVE, IS IT AN EXPRESSION     20350002
         BNO   LSTMN10             IF START OF AN EXPRESSION, BRANCH    20400002
         OI    A1FLG,A1REL         TURN ON ADDRESS IS RELATIVE FLAG     20450002
         TM    PDEFLG2,CTNAMFLG    IS RELATIVE ADDR QUALIFIED           20500002
         BNO   LSTMN14             IF NOT QUALIFIED, BRANCH             20550002
         SPACE                                                          20600002
*********************************************************************** 20650002
*                                                                     * 20700002
*  IF THE ADDRESS IS A QUALIFIED RELATIVE, CALCULATE THE BASE FOR     * 20750002
*   RELATIVES BY CONVERTING THE RELATIVE OFFSET TO BINARY AND         * 20800002
*    SUBTRACTING IT FROM THE RESOLVED CURRENT ADDRESS. THIS BASE      * 20850002
*     ADDRESS IS KEPT IN 'PPTEMP' FOR USE BY IKJEGCVT.                * 20900002
*                                                                     * 20950002
*********************************************************************** 21000002
         XC    HOLDAREA(APL),HOLDAREA  CLEAR AN AREA FOR AN ADDR PDE    21050002
         L     R2,PDEUSER          GET BINARY START ADDRESS             21100002
         LA    R2,ZERO(R2)         ZERO OUT HIGH ORDER BYTE             21150002
         SPACE                                                          21200002
*  NEXT MOVE THE ADDRESS POINTER AND THE LENGTH TO THE NEW ADDR PDE.    21250002
         SPACE                                                          21300002
         MVC   HOLDAREA+PDEADRPT-IKJPARMA(PDERSV3-PDEADRPT),PDEADRPT    21350002
         MVI   HOLDAREA+PDEEXPTR-IKJPARMA,HEXFF  INDICATE NOT INDIRECT  21400002
         SPACE                                                          21450002
*  THE ADDRESS TYPE FIELD IS ZERO WHICH IS THE CODE FOR ABSOLUTE.       21500002
         SPACE                                                          21550002
         LA    R1,HOLDAREA         SET UP A POINTER TO NEW PDE.         21600002
         L     R15,TSTCONVT        GET ADDRESS OF CONVERT ROUTINE       21650002
         SR    R0,R0               MAKE REG 0, ZERO FOR CONVERT TO BIN  21700002
         LCR   R1,R1               MAKE REG 1 NEGATIVE FOR ADDR CONVERT 21750002
         BALR  R14,R15             GO CONVERT RELATIVE OFFSET TO BINARY 21800002
         LTR   R15,R15             IS THE RETURN CODE ZERO              21850002
         L     R1,HOLDAREA+PDEUSER-IKJPARMA  GET CONVERTED DATA         21900002
         LA    R1,ZERO(R1)         ZERO OUT HIGH ORDER BYTE             21950002
         BNZ   LSTCVTRC            IF RC WAS NOT 0, BRANCH              22000002
         SR    R2,R1               SUBTRACT OFFSET FROM ADDRESS         22050002
         ST    R2,PPTEMP           SET UP DIFFERENCE AS BASE FOR RELS   22100002
         B     LSTMN14             BRANCH AROUND SET UP FOR ABSOLUTE    22150002
         SPACE                                                          22200002
LSTMN09  DS    0H                                                       22250002
         OI    A1FLG,A1SYM         INDICATE ADDRESS IS A SYMBOLIC TYPE  22300002
LSTMN10  DS    0H                                                       22350002
         XC    APDE(APL),APDE      CLEAR ADDRESS PDE,                   22400002
         OI    APDE+(PDEFLG4-IKJPARMA),ABSADDR  SET FLAG FOR ABSOLUTE   22450002
         OI    APDE+(PDEFLG3-IKJPARMA),AFLG     SET FLAG, ADDR PRESENT  22500002
         SPACE                                                          22550002
*  TEST FORMAT TYPE TO BE USED                                          22600002
         SPACE                                                          22650002
LSTMN14  DS    0H                                                       22700002
         CLI   A1TYPE,HEXCODE      IS REQUESTED FORMAT HEX              22750002
         BE    LSTHEX              IF HEX, BRANCH                       22800002
         SPACE 2                                                        22850002
*        THE FOLLOWING XCTL IS EXECUTED TO OBTAIN LSA                   22900002
         SPACE 2                                                        22950002
NOBLDL   DS    0H                                                       23000002
         L     R13,BACKPTR(R13)    PICK UP ADDR OF CALLERS SAVE AREA    23050002
         LA    R15,LXCTL           SET UP PTR TO LIST FORM OF XCTL MAC  23100002
         LA    R1,LXCTL1           SET UP PTR TO LIST'S PARM LIST       23150002
         ST    R8,LSTPDEPT(R1)     PASS A PTR TO THE CURRENT ADDR PDE   23200002
         ST    R10,LSTWRKPT(R1)    PASS THE BASE ADDR OF LSTWORK DSECT  23250002
         OI    TSTFLGS2,TSTXCTL    INDICATE XCTL WITHIN LIST SUB-CMD    23350002
*********************************************************************** 23400002
*                                                                     * 23450002
*  IF FORMAT TYPE WAS A, B, C, D, E, F, H, I, L, P, S, Y, OR Z---     * 23500002
*  XCTL TO SECOND LOAD MODULE OF LIST.                                * 23550002
*  IF THE XCTL FAILS, THE TEST MAINLINE STAE RETRY ROUTINE WILL BE    * 23600002
*  ENTERED. (FIELD 'TSTRETRY' IN TCOMTAB POINTS TO MAINLINE RTN ACROSS* 23650002
*  THE XCTL).                                                         * 23700002
*                                                                     * 23750002
*********************************************************************** 23800002
         SPACE                                                          23850002
         XCTL  (2,12),EP=IKJEGLSA,SF=(E,(15))                           23900002
         SPACE                                                          23950002
SMTXCTL  DS    0H                  SMT TEST LABEL FOR XCTL MACRO        24000002
         EJECT                                                          24050002
*********************************************************************** 24100002
*                                                                     * 24150002
*  THIS ENTRY POINT IS USED BY IKJEGLSA, THE 2ND LOAD OF LIST, IF     * 24200002
*  AN ADDRESS LIST IS BEING PROCESSED AND---                          * 24250002
*        1 THE NEXT ADDRESS IN THE LIST IS A REG ADDR.                  24300002
*        2 THE NEXT ADDRESS IN THE LIST IS SYMBOLIC AND THE SYMBOLS'  * 24350002
*          TYPE ATTRIBUTE IS HEX AND HAS NOT BEEN OVER-RIDDEN         * 24400002
*          BY THE USER.                                                 24450002
*        3 THE NEXT ADDRESS HAS NO ASSOCIATED ATTRIBUTES AND DEFAULTS   24500002
*          TO HEXADECIMAL FORMAT.                                       24550002
*  AFTER SETUP, CONTROL IS PASSED TO THE REPEAT ROUTINE.              * 24600002
*                                                                     * 24650002
*********************************************************************** 24700002
         SPACE                                                          24750002
IKJEGLSS DS    0H                                                       24800002
         L     R8,LSTPDEPT(R1)     PICK UP PTR TO CURRENT ADDR PDE      24850002
         L     R10,LSTWRKPT(R1)    SET UP BASE REG FOR LSTWORK DSECT    24900002
         NI    TSTFLGS2,HEXFF-TSTXCTL  TURN OFF XCTL IN PROGRESS SW     24950002
         B     LSTINT10            GO ISSUE STAE, THEN PROCESS NXT ADDR 25000002
         SPACE 3                                                        25050002
MORE     DS    0H                                                       25100002
         L     R6,OUTBUF           LOAD PTR TO OUTPUT BUFFER            25150002
         ST    R6,DATAPR           SET UP THE IO PARM LIST              25200002
         BAL   R7,LSTIO            GO TO OUTPUT ROUTINE                 25250002
         SPACE                                                          25300002
         L     R8,PDE2CHAI         GET ADDR OF NEXT PDE FROM CHAIN PTR  25350002
MORE02   DS    0H                                                       25400002
         XC    LSTRPT(RPTSIZE),LSTRPT  CLEAR ADDR PORTION OF WORK AREA  25450002
         IC    R2,TYPESAVE         GET TYPE CODE OR DEFAULT TYPE CODE   25500002
         STC   R2,A1TYPE           SET FORMAT TYPE (EXCEPT FOR SYMBOLS) 25550002
         B     LSTMN04             GO BACK AND PROCESS NEXT ADDR        25600002
         EJECT                                                          25650002
*********************************************************************** 25700002
*                                                                     * 25750002
*  COMPLETION ROUTINE, TESTS FOR ADDITIONAL ADDRESSES TO LIST AND     * 25800002
*  SETS A 0 RETURN CODE. WHEN ALL ADDRESSES HAVE BEEN PROCESSED,      * 25850002
*  THE ROUTINE RETURNS TO THE CALLER.                                 * 25900002
*                                                                     * 25950002
*********************************************************************** 26000002
         SPACE                                                          26050002
LSTCC0   DS    0H                                                       26100002
         TM    COMFLGS,OUTCORE     WAS THE LAST LIST TRUNCATED          26150002
         BZ    LSTOK               IF LAST LIST COMPLETE, BRANCH        26200002
         XC    TSTIOPRM,TSTIOPRM   ZERO OUT PARM FIELD FOR I/O CALL     26210002
         IKJEGSIO  MSG,FIRST=M0022,SECOND=M0272,ID=LST20, ISSUE IO CALL*26220002
               MF=(E,TSTIOPRM)     TO SEND MESSAGE TO USER              26222002
         CH    R15,H16             TEST THE RTN CODE                    26240002
         BL    LSTOK               IF SUCCESSFUL CONTINUE               26250002
         ST    R15,LSTRETCD        SAVE THE RETURN CODE FOR MAINLINE    26260002
         B     LSTMN90             GO BACK TO MAINLINE                  26270002
LSTOK    DS    0H                                                       26300002
         TM    PDE2CHAI,HEXFF      IS THERE ANOTHER ADDRESS PDE         26350002
         BNO   MORE                IF YES, BRANCH                       26400002
LSTMN90  DS    0H                                                       26450002
         NI    TSTFLGS1,HEXFF-TSTPRINT-TSTFIRST-PCHLSTVL-RANGESW        26500002
         ESTAE 0,OV                REMOVE THE ESTAE                     26520002
         L     R15,LSTRETCD        PICK UP RETURN CODE                  26550002
         L     R13,BACKPTR(R13)    GET ADDR OF PREVIOUS SAVE AREA.      26600002
         NI    TSTFLGS4,HEXFF-TSTRERTN TURN OFF THE RETRY SW IF ON      26610002
         RETURN (14,12),RC=(15)    RETURN TO CALLER                     26650002
         SPACE 2                                                        26700002
LSTCVTRC DS    0H                                                       26750002
         CH    R15,H16             IS RC=16                             26800002
         BNE   LSTCC0              OTHERWISE, GO CHECK FOR MORE ADDRS   26850002
LSTCC16  DS    0H                                                       26900002
         LA    R15,SIXTEEN         R15=16                               26950002
         ST    R15,LSTRETCD        RC=16                                27000002
         B     LSTMN90             GO CLEAN UP AND RETURN               27050002
         EJECT                                                          27100002
*  BRANCH TABLE ENTERED WHEN THE RETURN CODE FROM IKJPARS IS GREATER  * 27150002
*  THAN ZERO.                                                         * 27200002
         SPACE                                                          27250002
         ORG   *-4                 REUSE SPACE FOR ZERO COND CODE       27300002
PARSRC   DS    0H                                                       27350002
         ORG                                                            27400002
         B     PRC04               RC = 4, UNABLE TO PROMPT             27450002
         B     LSTCC16             ATTN SCHEDULED, GO SET RC=16         27500002
         B     PRC12               INVALID PARM, SHOULD NOT OCCUR       27550002
         B     PRC16               INSUFFIENT STORAGE FOR PARSE         27600002
         B     LSTMN90             RC=20, TERMINATE IMMEDIATELY         27650002
         SPACE                                                          27700002
PRC04    OI    TSTFLGS4,TSTFLUSH   INITIALIZE STACK FLUSH FOR           27750002
*                                  MAINLINE                             27800002
         B     LSTMN90             RETURN TO MAINLINE                   27850002
         SPACE                                                          27900002
PRC12    DS    0H                                                       27950002
         XC    TSTIOPRM,TSTIOPRM   ZERO OUT PARM FIELD FOR I/O CALL     28000002
         IKJEGSIO  MSG,FIRST=M0104,INST11=(NUM,I0009), ISSUE I/O CALL- *28010002
               SECOND=M0277,ID=LST20,MF=(E,TSTIOPRM)   ING MACRO        28012002
         CH    R15,H16             TEST THE RTN CODE                    28030002
         BL    LSTMN90             IF SUCCESSFUL CONTINUE               28040002
         ST    R15,LSTRETCD        SAVE THE RETURN CODE FOR MAINLINE    28050002
         B     LSTMN90             GO BACK TO MAINLINE                  28060002
PRC16    DS    0H                                                       28100002
         XC    TSTIOPRM,TSTIOPRM   ZERO OUT PARM FIELD FOR I/O CALL     28150002
         IKJEGSIO MSG,FIRST=M0103,ID=LST20,MF=(E,TSTIOPRM) ISSUE MSG    28184002
         CH    R15,H16             TEST THE RTN CODE                    28190002
         BL    LSTMN90             IF SUCCESSFUL CONTINUE               28192002
         ST    R15,LSTRETCD        SAVE THE RETURN CODE FOR MAINLINE    28194002
         B     LSTMN90             GO BACK TO MAINLINE                  28196002
         EJECT                                                          28800002
*********************************************************************** 28850002
*                                                                     * 28900002
*  SYMBOLIC ADDRESS SETUP ROUTINE. THIS ROUTINE SETS UP THE A1 FIELD  * 28950002
*  AND FILLS IN ANY ATTRIBUTES NOT OVER-RIDDEN BY THE USER.           * 29000002
*  AT ENTRY, REGISTER 15 POINTS TO THE SYMINFO BLOCK FOR ADDRESS 1    * 29050002
*********************************************************************** 29100002
SYM1     DS    0H                                                       29150002
         TM    LSTFLGS,TYPEFLG     WAS A TYPE GIVEN BY THE USER         29200002
         BO    HAVETYPE            IF GIVEN, IGNORE ATTRS OF SYMBOL     29250002
         SR    R2,R2               CLEAR A REG,                         29300002
         IC    R2,SITYPE(R15)         PICK UP THE TYPE,                 29350002
         STC   R2,A1TYPE                   AND MAKE IT THE TYPE FOR A1  29400002
HAVETYPE DS    0H                                                       29450002
         TM    LSTFLGS,LNTHFLG     WAS LNTH ATTR GIVEN BY USER          29500002
         BO    SYM1L               IF GIVEN, IGNORE ATTRS OF SYMBOL     29550002
         LH    R2,SILEN(R15)       PICK UP SYMS LENGTH ATTR             29600002
         STH   R2,A1L              ESTABLISH SYMS LNTH FOR THIS DATA    29650002
SYM1L    DS    0H                                                       29700002
         TM    LSTFLGS,MULTIFLG    WAS MULTIPLICITY ATTR GIVEN BY USER  29750002
         BO    SYM1M               IF GIVEN, IGNORE ATTRS OF SYMBOL     29800002
         LH    R2,SIMUL(R15)       PICK UP SYMS MULTIPLICITY FACTOR     29850002
         STH   R2,A1M              EST. SYMS MULTI FOR THIS DATA        29900002
SYM1M    DS    0H                                                       29950002
         OI    A1FLG,A1SYM         SET FLAG TO INDICATE ADDR SYMBOLIC   30000002
         L     R15,SIDATAPT(R15)   GET PTR TO INPUT FROM SYMINFO        30050002
         B     LSTMN07             RETURN TO MAINLINE SETUP ROUTINE     30100002
         TITLE 'IKJEGLST, ''LIST'', HEX FORMATTING ROUTINE'             30150002
*********************************************************************** 30200002
*                                                                     * 30250002
*  LIST AREAS OF CORE IN HEX FORMAT.                                  * 30300002
*        FIRST ANALYZE THE ADDRESS(ES) AS TO TYPE AND NUMBER.         * 30350002
*                                                                     * 30400002
*********************************************************************** 30450002
         SPACE                                                          30500002
LSTHEX   DS    0H                                                       30550002
         MVI   VPDET,HEXCODE       SET TYPE CODE FIELD TO HEX           30600002
         LH    R5,A1L              GET USER SPECIFIED LENGTH            30650002
         SR    R0,R0               CLEAR FOR COMPARE                    30700002
         CH    R0,A1M              WAS MULTIPLICITY GIVEN               30750002
         BNZ   LSTX04              IF YES, BRANCH AROUND DEFAULT        30800002
         MVI   A1M+H2ND,ONE        DEFAULT MULTIPLICITY TO ONE          30850002
LSTX04   DS    0H                                                       30900002
         TM    COMFLGS,TWOADDRS    HOW MANY ADDRESSES WERE GIVEN        30950002
         BO    LSTX24              IF TWO, BRANCH                       31000002
         OI    COMFLGS,ARTIMSW     INDICATE CONTROL IS ARTIFICIAL       31050002
         CR    R0,R5               WAS A LENGTH GIVEN OR IMPLIED        31100002
         BNE   LSTX06              IF YES, BRANCH                       31150002
         LA    R5,HEXDLEN          SET DEFAULT LNTH FOR HEX             31200002
         STH   R5,A1L              SAVE DEFAULTED LENGTH                31250002
LSTX06   DS    0H                                                       31300002
         B     LSTX18              GO TO LENGTH SPECIFIED ROUTINE       31350002
LSTX08   DS    0H                                                       31400002
         LA    R4,ONE              SET CONTROL TO 1 GROUP PER LINE      31450002
         STH   R4,ARTIFMUL         SET ARTIFICIAL MULTIPLICITY          31500002
         SPACE                                                          31550002
*********************************************************************** 31600002
*                                                                     * 31650002
*  DETERMINE WHETHER ADDRESS IS RELATIVE, SYMBOLIC, OR ABSOLUTE.      * 31700002
*                                                                     * 31750002
*********************************************************************** 31800002
LSTX10   DS    0H                                                       31850002
         LA    R3,FOUR             SET A CONSTANT OF 4                  31900002
         CR    R3,R4               COMPARE IT TO NUMBER OF GRPS TO LIST 31950002
         BNH   LSTX12              IF 4 OR MORE GROUPS, BRANCH          32000002
         L     R15,ENDOBUF         GET END OF BUFFER ADDRESS            32050002
         OI    COMFLGS,DATASIZE    IF LESS THAN 4 GROUPS, SET SW        32100002
         ST    R15,ENDOGRP         SET END OF GROUP TO END OF BUF       32150002
LSTX12   DS    0H                                                       32200002
         STH   R5,VPDEL            SET LENGTH FIELD OF VALUE PDE        32250002
         STH   R5,A1L              RECORD LENGTH FINALLY CHOSEN         32300002
         TM    A1FLG,A1SYM         TEST ADDR TYPE                       32350002
         BZ    LSTX14              IF ADDR IS ABSOLUTE, BRANCH          32400002
         BO    LSTX40              IF ONES, ADDR IS SYMBOLIC            32450002
         SPACE                                                          32500002
*  IF ADDRESS TYPE IS RELATIVE, FALL THROUGH AND SET UP FOR RELATIVES.  32550002
         SPACE                                                          32600002
         MVC   APDE(APL),IKJPARMA  MOVE ORIGINAL PDE TO WORK AREA       32650002
LSTX14   DS    0H                                                       32700002
         LA    R2,A1               GET ADDR OF INPUT DATA PTR           32750002
         ST    R2,APDE+(PDEADRPT-IKJPARMA) STORE IT IN THE ADDR PDE     32800002
         B     LSTX50              GO TO MAIN ROUTINE FOR HEX.          32850002
         SPACE                                                          32900002
*********************************************************************** 32950002
*                                                                     * 33000002
*  ROUTINE WHEN LNTH WAS SPECIFIED, OR AVAILABLE THRU A SYMBOLIC ADDR.* 33050002
*                                                                     * 33100002
*********************************************************************** 33150002
LSTX18   DS    0H                                                       33200002
         BAL   R14,LSTLMTCK        GO TEST FOR EXTENSION BEYOND CORE    33250002
         BAL   R14,ADDRCHK         GO CHECK VALIDITY 2ND ADDR           33260002
         LTR   R15,R15             WAS REMAINING MULTIPLICITY ZERO      33300002
         BZ    LSTX19              IF MULTIPLICITY NON-ZERO, BRANCH     33350002
         MVI   A1M+H2ND,ONE        SET MULTIPLICITY TO ONE              33400002
         LH    R5,LASTLEN          GET REMAINING LENGTH                 33450002
         XC    LASTLEN,LASTLEN     CLEAR LASTLEN TO PREVENT RE-USE      33500002
         STH   R5,A1L              SET REQUEST LENGTH TO LAST LENGTH    33550002
LSTX19   DS    0H                                                       33600002
         LA    R2,FOUR             SET UP TEST VALUE                    33650002
         CR    R5,R2               IS LENGTH GREATER THAN 4             33700002
         BNH   LSTX08              IF NOT, GO USE ACTUAL LENGTH         33750002
         LA    R1,FWBDY            SET UP TO TEST IF LNTH/4 HAS REMAIN  33800002
         LR    R4,R5               GET A WORKING COPY OF THE LENGTH     33850002
         NR    R1,R4               PLACE ANY REMAINDER IN R1            33900002
         SRL   R4,TWO              DIVIDE LENGTH BY 4                   33950002
         STH   R4,ARTIFMUL         SAVE ARTIFICIAL MULTIPLICITY         34000002
LSTX20   DS    0H                                                       34050002
         LR    R5,R2               SET UP LENGTH REGISTER               34100002
         STH   R1,REMAIN           SAVE REMAINDER                       34150002
         STH   R1,REMAIN2          SAVE A COPY OF THE REMAINDER         34200002
         B     LSTX10              RETURN TO MAINLINE                   34250002
         SPACE                                                          34300002
*********************************************************************** 34350002
*                                                                     * 34400002
*  ROUTINE TO SET UP FOR TWO ADDRESSES.                               * 34450002
*                                                                     * 34500002
*********************************************************************** 34550002
LSTX24   DS    0H                                                       34600002
         LA    R2,HEXDLEN          SET UP DEFAULT LENGTH FOR HEX        34650002
         L     R4,A2               R4=ADDR OF END OF INPUT DATA FLD.    34700002
         S     R4,A1               CALCULATE RANGE IN BYTES.            34750002
         LA    R4,ONE(R4)          INCLUDE BYTE AT 2ND ADDRESS          34800002
         LA    R1,FWBDY            SET UP TO DETERMINE REMAINDER OF L/4 34850002
         NR    R1,R4               PLACE ANY REMAINDER IN R1            34900002
         SRA   R4,TWO              DIVIDE LENGTH BY 4                   34950002
         BNZ   LSTX20              IF QUOTIENT NON-ZERO, BRANCH         35000002
         LR    R5,R1               SET LENGTH TO REMAINDER              35050002
         B     LSTX08              RETURN TO MAINLINE                   35100002
         SPACE                                                          35150002
*  ROUTINE TO SET UP FOR SYMBOLIC ADDRESSES                             35200002
         SPACE                                                          35250002
LSTX40   DS    0H                                                       35300002
         BAL   R7,LSTSYM           GO MOVE SYMBOLIC ADDR TO BUF         35350002
         CH    R4,HONE             HOW MANY FIELDS ARE TO BE LISTED     35400002
         BH    LSTX42              IF MORE THAN 1 + A REMAINDER, BRANCH 35450002
         CH    R4,A1M              ARE THERE MORE FIELDS TO LIST        35500002
         BL    LSTX42              IF MORE, BRANCH                      35550002
         LH    R15,A1L             GET LENGTH OF PRIMARY FIELD          35600002
         AH    R15,REMAIN          ADD ANY REMAINDER                    35650002
         AR    R15,R15             DOUBLE LENGTH TO GET OUTPUT LENGTH   35700002
         LA    R15,SP4(R6,R15)     CALCULATE BUF PTR AT END OF DATA     35750002
         C     R15,ENDOBUF         WILL DATA FIT                        35800002
         BNH   LSTX57              IF DATA WILL FIT, BRANCH             35850002
         SPACE                                                          35900002
*  IF DATA WILL NOT FIT, FALL THROUGH AND PUT OUT ADDRESS SEPARATELY.   35950002
         SPACE                                                          36000002
LSTX42   DS    0H                                                       36050002
         BAL   R7,LSTIO            GO OUTPUT ADDR ONLY                  36100002
         B     LSTX54              GO OUTPUT DATA                       36150002
         EJECT                                                          36200002
*********************************************************************** 36250002
*  PROCESS LOOP FOR HEX FORMATTING ROUTINE                              36300002
*                                                                     * 36350002
*        DURING THE PROCESSING CYCLE, THE REGISTER USAGE IS AS FOLLOWS* 36400002
*              R0 CONTAINS A NEG (-) NUMBER TO SHOW CONVERT TO PRINT  * 36450002
*              R5 CONTAINS THE ADDR OF THE OUTPUT BUFFER.               36500002
*              R6 CONTAINS THE ADDR ON THE NEXT AVAILABLE BYTE IN BUF * 36550002
*                                                                     * 36600002
*        OUTPUT IS PLACED IN THE BUFFER IN ONE OF THE FOLLOWING       * 36650002
*        FORMATS, DEPENDING ON LINE SIZE. (AN X REPRESENTS A GROUP OF * 36700002
*        2, 4, 6, OR 8 CHARACTERS OF DATA AND ADDR IS RELATIVE OR     * 36750002
*        ABSOLUTE. SYMBOL INDICATES SYMBOLIC ADDR.)                   * 36800002
*        1.    ADDR  X X X X  X X X X                                 * 36850002
*        2.    ADDR  X X X X                                          * 36900002
*                    X X X X                                          * 36950002
*        3.    ADDR                                                   * 37000002
*                X X X X                                              * 37050002
*                X X X X                                              * 37100002
*        4.    SYMBOL  X           IF ADDR SYMBOLIC AND ONLY 1 GROUP  * 37150002
*        5.    SYMBOL                                                 * 37200002
*              ADDR  X X X X  X X X X   (SEE 1, 2, AND 3 ABOVE)       * 37250002
*        6.    ADDR  X                                                * 37300002
*              ADDR  X                                                * 37350002
*               ETC.    (THIS FORMAT RESULTS FROM USING MULTIPLICITY) * 37400002
*********************************************************************** 37450002
LSTX50   DS    0H                                                       37500002
         L     R6,OUTBUF           GET PTR TO OUTPUT BUFFER             37550002
         MVI   DATAOFF(R6),BLANK   MOVE BLANK TO START OF DATA @YM06177 37560002
         MVC   DATAOFF+ONE(LSTBUFL,R6),DATAOFF(R6)   BLANK OUT @YM06177 37570002
         LA    R6,DATAOFF(R6)      INCRE BUF PTR PAST LL00 FIELD        37600002
         L     R3,CONAREA          R3=PTR TO CONVERT OUTPUT AREA        37650002
LSTX52   DS    0H                                                       37700002
         BAL   R14,LSTBPT          GO CLEAR BREAKPOINT SVC'S FROM DATA  37750002
         SPACE                                                          37800002
*********************************************************************** 37850002
*                                                                     * 37900002
*  IF ADDRESS WAS SYMBOLIC AND THERE ARE 2 OR MORE FIELDS THE ROUTINE * 37950002
*  IS ENTERED HERE. AFTER THE SYMBOL IS PRINTED ON A SEPARATE LINE.   * 38000002
*                                                                     * 38050002
*********************************************************************** 38100002
LSTX54   DS    0H                                                       38150002
         L     R15,TSTCONVT        PTR TO CONVERT ROUTINE               38200002
         LA    R1,APDE             PTR TO ADDR PDE, ADDR TO CONVERT     38250002
         LCR   R1,R1               INDICATE ADDR CONVERSION.            38300002
         SR    R0,R0               SET R0 NEGATIVE TO                   38350002
         BCTR  R0,NULL                 INDICATE CONVERT TO PRINTABLE    38400002
         BALR  R14,R15             GO TO CONVERT ROUTINE                38450002
         LTR   R15,R15             TEST CONVERT RETURN CODE.            38500002
         BNZ   LSTCVTRC            IF NON-ZERO, BRANCH                  38550002
         MVC   ZERO(ADDRLEN,R6),CONDATA(R3)  MOVE ADDR TO BUF           38600002
         LA    R6,ADDRLEN(R6)      INCRE BUF PTR PAST ADDR              38650002
         TM    COMFLGS,DATASIZE    ARE THERE 4 FIELDS TO LIST           38700002
         BO    LSTX57              IF LESS THAN 4, BRANCH               38750002
         LR    R2,R5               GET LENGTH OF AN OUTPUT FIELD        38800002
         SLL   R2,TWO+ONE          LNTH*4*2  4=NO. OF FLDS, 2=PRINTSIZE 38850002
         LA    R2,SP5(R6,R2)       CALCULATE BUF PTR AFTER 4 FIELDS     38900002
         C     R2,ENDOBUF          WILL 4 GROUPS + ADDR FIT IN BUF      38950002
         BNH   LSTX56              IF GRPS+ADDR WILL FIT, BRANCH        39000002
         OI    COMFLGS,NOINDENT    SET SW TO PREVENT INDENTATION.       39050002
         BAL   R7,LSTIO            GO OUTPUT ADDR ONLY                  39100002
         S     R2,AFLEN            REDUCE OUTPUT LINE LNTH BY ADDR+2SP  39150002
LSTX55   DS    0H                                                       39200002
         SR    R0,R0               SET R0 TO A (-1) TO SHOW             39250002
         BCTR  R0,NULL                 CONVERTION TO PRINTABLE.         39300002
         SPACE                                                          39350002
*********************************************************************** 39400002
*                                                                     * 39450002
*  DATA CONVERT LOOP                                                  * 39500002
*  IF THE NEXT GROUPS OF DATA WILL FIT INTO THE BUFFER OR IF THE ADDR * 39550002
*  WAS SYMBOLIC AND THERE IS ONLY ONE GROUP, THIS ROUTINE IS ENTERED. * 39600002
*                                                                     * 39650002
*********************************************************************** 39700002
LSTX56   DS    0H                                                       39750002
         ST    R2,ENDOGRP          SAVE STOP ADDR FOR 4 GROUPS          39800002
LSTX57   DS    0H                                                       39850002
         LA    R1,VPDE             SET UP FIELDS TO CONVERT A VALUE     39900002
         LA    R6,SP1(R6)          INCRE BUF PTR AN EXTRA SPACE         39950002
LSTX59   DS    0H                                                       40000002
         LA    R6,SP1(R6)          INCRE BUF PTR FOR SPACE BETWN GRPS   40050002
         SPACE                                                          40100002
         L     R15,TSTCONVT        GET ADDR OF CONVERT ROUTINE          40150002
         BALR  R14,R15             GO TO CONVERT ROUTINE                40200002
         LTR   R15,R15             TEST RETURN CODE                     40250002
         BNZ   LSTCVTRC            IF RC=NON-ZERO, BRANCH               40300002
         IC    R15,CONLFLD(R3)     PICK UP LENGTH OF CONVERTED DATA     40350002
         BCTR  R15,NULL            REDUCE LENGTH BY 1 FOR MVC INSTR     40400002
         EX    R15,DATAMOVE        MOVE CONVERTED DATA TO BUF           40450002
         LA    R6,ONE(R15,R6)      INCRE BUF PTR PAST A DATA FIELD      40500002
         L     R15,VPDEPT              R15=ADDR OF LAST INPUT DATA      40550002
         AH    R15,VPDEL           UPDATE DATA PTR BY LNTH OF LAST FLD  40600002
         ST    R15,VPDEPT          SET UP VALUE PDE FOR NEXT DATA       40650002
         BCT   R4,LSTX62           HAS CONTROL REACHED 0, IF NOT, BRNCH 40700002
         CH    R4,REMAIN           IS REMAINDER 0, (NOTE- R4=0)         40750002
         BE    LSTX66              IF ZERO, BRANCH TO TEST FOR COMPL    40800002
         LH    R2,REMAIN           PICK UP REMAINDE LENGTH              40850002
         STH   R2,VPDEL            SET VALUE LENGTH AND                 40900002
         STH   R4,REMAIN           SET REMAINDER TO 0 (NOTE-- R4=0)     40950002
         LA    R4,ONE              SET A CONTROL VALUE OF 1             41000002
LSTX62   DS    0H                                                       41050002
         C     R6,ENDOGRP          TEST FOR END OF A GROUP OF 4 FIELDS  41100002
         BL    LSTX59              IF NOT, GO PUT NEXT FIELD IN BUF     41150002
         TM    COMFLGS,SECOND      IS THIS THE 2ND GROUP OF 4           41200002
         BO    LSTX76              IF 2ND GROUP, BRANCH                 41250002
         SPACE 2                                                        41300002
*********************************************************************** 41350002
*  AT THIS POINT, ONE GROUP OF 4 IS IN THE BUF AND A TEST MUST BE MADE* 41400002
*  IF A SECOND GROUP OF 4 WILL FIT. IF IT WILL FIT, AN EXTRA SPACE IS * 41450002
*  INSERTED IN THE BUF TO SEPARATE THE GROUPS OF 4.                   * 41500002
*********************************************************************** 41550002
         SPACE                                                          41600002
         LR    R2,R5               GET LENGTH OF AN OUTPUT FIELD        41650002
         SLL   R2,TWO+ONE          L*4*2, LNTH TIMES FLDS/GRP TIMES 2.  41700002
         LA    R2,SP5(R6,R2)       INCRE BUF PTR BY 2SP+3SP+(4*DATALEN) 41750002
         OI    COMFLGS,SECOND      SET FLAG TO SHOW SECOND GRP          41800002
         C     R2,ENDOBUF          TEST WHETHER RESULT IS PAST BUF END  41850002
         BNH   LSTX56              IF DATA WILL FIT, BRANCH             41900002
         SPACE                                                          41950002
LSTX64   DS    0H                                                       42000002
         BAL   R7,LSTIO            GO OUTPUT DATA IN BUF                42050002
         LR    R2,R5               GET LENGTH OF AN OUTPUT FIELD        42100002
         SLL   R2,TWO+ONE          L*4*2, LNTH TIMES FLDS/GRP TIMES 2   42150002
         LA    R2,SP5(R6,R2)       CALCULATE BUF PTR AFTER 4 MORE FLDS  42200002
         TM    COMFLGS,NOINDENT    TEST IF DATA TO BE INDENTED          42250002
         BO    LSTX55              IF NO INDENTATION REQUIRED, BRANCH   42300002
         LA    R6,ADDRLEN(R6)      INCRE BUF PTR FOR INDENTATION        42350002
         LA    R2,ADDRLEN(R2)      INCRE STOP ADDR BY INDENTATION       42400002
         B     LSTX55              GO BACK TO DATA PROCESS LOOP         42450002
         SPACE                                                          42500002
LSTX66   DS    0H                                                       42550002
         TM    COMFLGS,ARTIMSW     WAS CONTROL TRU MULTIPLICITY         42600002
         BNO   LSTX68              IF TRU, BRANCH                       42650002
         LH    R2,A1M              PICK UP TRU MULTIPLICITY             42700002
         BCT   R2,LSTX72           DECRE IT AND TEST FOR COMPLETION     42750002
LSTX68   DS    0H                                                       42800002
         TM    COMFLGS,OUTCORE     WAS REQUEST TRUNCATED BY TOP ADDR    42850002
         BO    LSTX84              IF TRUNCATED, BRANCH                 42900002
LSTX70   DS    0H                                                       42950002
         BAL   R7,LSTIO            GO OUTPUT LAST BUF                   43000002
         B     LSTCC0              GO BACK TO MAINLINE.                 43050002
LSTX72   DS    0H                                                       43100002
         STH   R2,A1M              SAVE REMAINING TRU MULTIPLICITY      43150002
         LH    R2,REMAIN2          PICK UP SAVED REMAINDER              43200002
         STH   R2,REMAIN           RESTORE IT TO REMAINDER FIELD        43250002
         LH    R4,ARTIFMUL         RESET CONTROL TO ARTIFICIAL MULTIP.  43300002
         STH   R5,VPDEL            RESET INPUT DATA LENGTH              43350002
LSTX76   DS    0H                                                       43400002
         BAL   R7,LSTIO            GO OUTPUT CURRENT BUF LOAD           43450002
         NI    COMFLGS,HEXFF-SECOND    TURN OFF SECOND GRP FLAG         43500002
         B     LSTX52              GO SET UP ANOTHER LINE.              43550002
         SPACE                                                          43600002
LSTX84   DS    0H                                                       43650002
         LH    R4,LASTLEN          PICK UP POSSIBLE SHORT FIELD LENGTH  43700002
         LTR   R4,R4               IS THERE A SHORT FIELD TO LIST       43750002
         BZ    LSTX70              IF NOT, OR IF DONE, BRANCH           43800002
         LA    R5,FOUR             SET UP GROUP LENGTH                  43850002
         CR    R4,R5               IS THERE MORE THAN ONE GROUP         43900002
         BNH   LSTX90              IF NOT, BRANCH                       43950002
         LA    R15,FWBDY           PREPARE TO ISOLATE ODD NO. OF BYTES  44000002
         NR    R15,R4              ISOLATE BYTES NOT A MULTIPLE OF 4    44050002
         SRL   R4,TWO              DIVIDE NO. OF BYTES BY 4             44100002
LSTX86   DS    0H                                                       44150002
         STH   R15,REMAIN2         SAVE ODD BYTES                       44200002
         STH   R4,ARTIFMUL         SAVE QUOTIENT AS ARTIFICIAL MULTI    44250002
         LA    R2,ONE              SET TRUE MULTIPLICITY TO ONE         44300002
         XC    LASTLEN,LASTLEN     MAKE LAST LENGTH ZERO TO STOP LOOP   44350002
         B     LSTX72              GO FINISH LISTING CORE               44400002
         SPACE                                                          44450002
LSTX90   DS    0H                                                       44500002
         LR    R5,R4               SET FOR LENGTH EQUALS REMAINDER      44550002
         SR    R15,R15             SET FOR REMAINDER OF ZERO            44600002
         LA    R4,ONE              SET ARTIFICIAL MULTIPLICITY FOR 1    44650002
         B     LSTX86              GO FINISH SETUP                      44700002
         TITLE 'IKJEGLST, ''LIST'', REGISTER LISTING ROUTINE'           44750002
*********************************************************************** 44800002
*                                                                     * 44850002
*  LIST REGISTER ROUTINE, LIST THE GENERAL OR FLOATING POINT REGISTERS* 44900002
*  IN HEXADECIMAL FORMAT. WILL LIST EITHER A SINGLE REGISTER OR A     * 44950002
*  RANGE OF REGISTERS.                                                  45000002
*                                                                     * 45050002
*********************************************************************** 45100002
         SPACE                                                          45150002
LSTREG   DS    0H                                                       45200002
         L     R2,A1               GET REG NUMBER OF FIRST ADDRESS      45250002
         L     R6,OUTBUF           ADDR OF OUTPUT BUF                   45300002
         LA    R6,DATAOFF(R6)      INCREMENT BUF PTR PAST LL00 FIELD    45350002
         MVI   ZERO(R6),BLANK   MOVE BLANK TO START OF BUF@ZA07140      45360003
         MVC   ONE(LSTBUFL-DATAOFF,R6),ZERO(R6) BLANK OUT @ZA07140      45370003
         TM    PDEFLG4,GENR        IS ADDR TYPE GENERAL REGISTER        45400002
         BNO   LSTREG30            IF NOT, BRANCH TO FLOATING PT        45450002
         SPACE                                                          45500002
*  SETUP ROUTINE FOR LISTING CONTENTS OF GENERAL REGISTERS.             45550002
         SPACE                                                          45600002
         CLI   A1TYPE,FCODE        IS REQUESTED FORMAT FIXED PT BINARY  45650002
         LA    R4,GRFLENO          SET UP OUTPUT LNTH FOR FIXED PT      45700002
         BE    LSTREG08            IF FIXED, SETUP IS COMPLETE, BRANCH  45750002
         SPACE                                                          45800002
*  IF FORMAT IS NOT F TYPE, DEFAULT TYPE TO HEX                         45850002
         SPACE                                                          45900002
         MVI   A1TYPE,HEXCODE      SET TYPE FIELD                       45950002
         LA    R4,GRXLENO          SET UP OUTPUT LNTH FOR HEX DATA      46000002
         SPACE                                                          46050002
*  NEXT, SET UP A PTR TO THE GENERAL REGISTER SAVE AREA OF THE        * 46100002
*  SVRB OF THE BREAKPOINT SVC ON THE TCB OF THE INTERRUPTED PROB PROG * 46150002
         SPACE                                                          46200002
LSTREG08 DS    0H                                                       46250002
         L     R5,ECBPP              GET SVC97 SVRB ADDR      @ZA07138  46300003
*                                                             @ZA09259  46330003
         LA    R5,RBGRSAVE(R5)     SET UP ADDRESS OF REG SAVE AREA      46500002
         SPACE                                                          46550002
         MVI   REMAIN+ONE,GRINCR   SET REG NO. INCREMENT FOR GEN REGS   46600002
         LA    R3,FOUR             SET INPUT DATA LENGTH (AND INCRE)    46650002
         LA    R1,GRMAX            SET MAX REG NUMBER FOR GEN REGS      46700002
         STH   R3,VPDEL            SET INPUT DATA LENGTH                46750002
         LA    R15,RADDRLEN+SP2(R4)    LNTH OF 1 OUTPUT FIELD TIMES     46800002
         SLL   R15,TWO                     FOUR=REQUIRED LINE LNTH.     46850002
         LA    R15,THREE*SP2(R15,R6) INCRE LNTH FOR INTER-DATA-GRP SP'S 46900002
         MVI   REMAIN2+ONE,SP2     SET UP SPACING FACTOR                46950002
         EJECT                                                          47000002
*********************************************************************** 47050002
*                                                                     * 47100002
*  COMMON PART OF SETUP ROUTINE, USED BY BOTH FLOATING PT AND GENERAL * 47150002
*  REGISTER ROUTINES.  AT ENTRY, REGISTERS MUST BE AS FOLLOWS         * 47200002
*        1  MAXIMUM REGISTER NUMBER FOR THE REG TYPE BEING LISTED     * 47250002
*        2  REGISTER NUMBER OF THE FIRST REGISTER TO BE LISTED        * 47300002
*        3  INPUT DATA INCREMENT (FOR INCREMENTING CORE ADDRESSES     * 47350002
*           OF THE RB OR TCB REG SAVE AREA.                           * 47400002
*        4  OUTPUT DATA LENGTH OR MAX OUTPUT DATA LENGTH.             * 47450002
*        5  ADDRESS OF THE APPROPIATE REGISTER SAVE AREA              * 47500002
*        6  PTR TO THE FIRST DATA BYTE OF THE OUTPUT BUFFER           * 47550002
*        REMAIN    CONTAINS APPROPIATE INCREMENT FOR REG NUMBERS      * 47600002
*        REMAIN2   CONTAINS SPACING FACTOR USED FOR GROUP SEPARATION  * 47650002
*                                                                     * 47700002
*********************************************************************** 47750002
LSTREG20 DS    0H                                                       47800002
         C     R15,ENDOBUF         IS CUR LINE LNTH ENOUGH FOR 4 GRPS   47850002
         BNH   LSTREG22            IF LINE LNTH IS OK, BRANCH           47900002
         SPACE                                                          47950002
*********************************************************************** 48000002
*  IF LINE LENGTH TOO SMALL FOR 4 GENERAL REGS OR 2 FLOATING PT REG,  * 48050002
*  USE THE NORMAL END OF BUFFER ADDRESS AS A STOPPER AND PUT AS MANY  * 48100002
*  GROUPS ON ONE ONE AS WILL FIT.                                     * 48150002
*********************************************************************** 48200002
         SPACE                                                          48250002
         L     R15,ENDOBUF         GET END OF BUFFER ADDRESS            48300002
         SPACE                                                          48350002
LSTREG22 DS    0H                                                       48400002
         ST    R15,ENDOGRP         SET END OF LINE (STOPPER) FOR LSTREG 48450002
         STH   R3,A1L              SET INPUT DATA INCREMENT             48500002
         LR    R3,R2               GET FIRST REG NUMBER TO BE LISTED    48550002
         ST    R5,REGSTART         SAVE START ADDRESS OF REG SAVE AREA  48600002
         SLL   R3,TWO              MULTIPLY REG NUMBER BY 4 FOR OFFSET  48650002
         AR    R5,R3               ADD OFFSET TO REG SAVE START ADDR    48700002
         C     R2,A2               COMPARE 1ST ADDR TO LAST (TEST WRAP) 48750002
         BNH   LSTREG24            IF REGS DO NOT WRAP, BRANCH          48800002
         ST    R1,A2               IF REGS WRAP, SET 2ND ADDR TO MAX    48850002
         OI    COMFLGS,WRAPSW          REG NUMBER AND TURN ON WRAP SW.  48900002
LSTREG24 DS    0H                                                       48950002
         IC    R15,A1TYPE          GET FORMAT TYPE FOR THIS REQUEST     49000002
         MVC   APDE(APL),PDELDNAM  MOVE THE ADDRESS PDE TO WORKING CORE 49050002
         STC   R15,VPDET           SET VALUE PDE TO PROPER FORMAT TYPE  49100002
         LA    R1,A1               GET PTR TO CURRENT REG ADDRESS AND   49150002
         ST    R1,APDE+(PDEADRPT-IKJPARMA)  SET ADDR PDE PTR TO IT.     49200002
         B     LSTREG50            GO PROCESS LIST REG REQUEST          49250002
         EJECT                                                          49300002
*********************************************************************** 49350002
*                                                                     * 49400002
*  SETUP ROUTINE FOR LISTING THE CONTENTS OF THE FLOATING POINT REGS.   49450002
*                                                                     * 49500002
*********************************************************************** 49550002
LSTREG30 DS    0H                                                       49600002
         TM    PDEFLG4,SFPR        TEST REG TYPE FOR RE OR RD           49650002
         BO    LSTREG40            IF RE, BRANCH                        49700002
         TM    LSTFLGS,TYPEFLG     WAS TYPE SPECIFIED BY THE USER       49750002
         BZ    LSTREG32            IF NOT, BRANCH, AND DEFAULT TO 'D'   49800002
         LA    R4,RDXLENO          SET UP FOR POSSIBLE HEX OUTPUT       49850002
         CLI   A1TYPE,HEXCODE      WAS THE SPECIFIED TYPE HEX           49900002
         BE    LSTREG34            IF HEX, BRANCH                       49950002
LSTREG32 DS    0H                                                       50000002
         LA    R4,RDDLENO          SET UP OUTPUT LENGTH FOR 'D' FORMAT  50050002
         MVI   A1TYPE,DCODE        SET TYPE TO 'D'                      50100002
LSTREG34 DS    0H                                                       50150002
         MVI   VPDEL+ONE,RDINLEN   SET INPUT DATA LENGTH FOR 'D' TYPE   50200002
         B     LSTREG46            GO TO COMMON FLT PT SETUP ROUTINE    50250002
         SPACE                                                          50300002
LSTREG40 DS    0H                                                       50350002
         TM    LSTFLGS,TYPEFLG     WAS TYPE SPECIFIED BY THE USER       50400002
         BZ    LSTREG42            IF NOT, BRANCH, AND DEFAULT TO 'E'   50450002
         LA    R4,REXLENO          SET UP FOR POSSIBLE HEX OUTPUT       50500002
         CLI   A1TYPE,HEXCODE      WAS THE SPECIFIED TYPE HEX           50550002
         BE    LSTREG44            IF HEX, BRANCH                       50600002
LSTREG42 DS    0H                                                       50650002
         LA    R4,REELENO          SETUP OUTPUT LNTH FOR 'E' FORMAT     50700002
         MVI   A1TYPE,ECODE        SET TYPE TO 'E'                      50750002
LSTREG44 DS    0H                                                       50800002
         MVI   VPDEL+ONE,REINLEN   SET INPUT DATA LENGTH FOR 'E' TYPE   50850002
         SPACE                                                          50900002
*********************************************************************** 50950002
*  COMMON SET UP FOR FLOATING POINT REGS.                             * 51000002
*        SET REGISTER NUMBER INCREMENT                                  51050002
*        SET CORE ADDRESS INCREMENT                                     51100002
*        GET REGISTER SAVE AREA ADDRESS FOR FLOATING POINT REGISTERS    51150002
*********************************************************************** 51200002
LSTREG46 DS    0H                                                       51250002
         MVI   REMAIN+ONE,FPRINCR  SET REG NUMBER INCREMENT             51300002
         LA    R3,RDINLEN          SET INPUT DATA ADDR INCREMENT        51350002
         LA    R1,FPRMAX           MAX REG NUMBER                       51400002
         SPACE                                                          51450002
         L     R5,PPTCB            GET PTR TO TCB FOR BREAKPOINTED TASK 51500002
         LA    R15,L'TCBFRS        LNTH OF TCB FLOATING PT REG SAVE     51550002
         SR    R5,R15              BACK UP TCB PTR TO TCB PREFIX        51600002
         USING TCBFIX,R5           ADDRESSABILITY FOR TCB PREFIX        51650002
         LA    R5,TCBFRS           GET PTR TO FLOATING PT REG SAVE      51700002
         DROP  R5                                                       51750002
         LA    R15,RADDRLEN+SP2(R4)    CALCULATE LENGTH OF OUTPUT       51800002
         AR    R15,R15             DOUBLE IT FOR LENTH OF TWO FIELDS    51850002
         LA    R15,SP4(R15,R6)     CALCULATE SPACE FOR 2 REGS IN BUF    51900002
         MVI   REMAIN2+ONE,SP4     SET SPACING FACTOR FOR FLT PT REGS   51950002
         B     LSTREG20            RETURN TO LIST REG MAINLINE          52000002
         EJECT                                                          52050002
*********************************************************************** 52100002
*                                                                     * 52150002
*  LIST REGISTER MAINPROCESS ROUTINE, AT ENTRY, THE FOLLOWING REGS    * 52200002
*  ARE INITIALIZED                                                    * 52250002
*        2  CURRENT REG NUMBER                                        * 52300002
*        4  LENGTH OF AN OUTPUT DATA FIELD                            * 52350002
*        5  PTR TO REG SAVE AREA FOR CURRENT REGISTER                 * 52400002
*        6  CURRENT BUFFER PTR                                        * 52450002
*  OTHER REGISTERS WITH CONSTANT USES ARE,                            * 52500002
*        3  PTR TO CONVERT OUTPUT AREA                                * 52550002
*                                                                     * 52600002
*********************************************************************** 52650002
LSTREG50 DS    0H                                                       52700002
         L     R3,CONAREA          SET UP A PTR TO CONAREA              52750002
LSTREG54 DS    0H                                                       52800002
         SR    R0,R0               CLEAR REG 0 TO 0 THEN MAKE IT NEG    52850002
         BCTR  R0,NULL                 TO INDICATE CONVERT TO PRINTABLE 52900002
LSTREG56 DS    0H                                                       52950002
         LA    R1,APDE             R1=ADDR OF ADDRESS PDE               53000002
         L     R15,TSTCONVT        R15=ADDR OF IKJEGCVT                 53050002
         LCR   R1,R1               R1 NEG INDICATES ADDR CONVERSION     53100002
         BALR  R14,R15             GO CONVERT ADDR                      53150002
         LTR   R15,R15             TEST RETURN CODE                     53200002
         BNZ   LSTCVTRC            IF NON-ZERO, BRANCH                  53250002
         IC    R15,CONLFLD(R3)     PICK UP LENGTH OF ADDRESS FIELD      53300002
         BCTR  R15,NULL            DECREMENT LENGTH FOR AN MVC INSTR    53350002
         EX    R15,DATAMOVE        MOVE ADDRESS TO BUFFER               53400002
         LA    R6,ONE(R15,R6)      INCREMENT BUF PTR PAST DATA          53450002
         ST    R5,VPDEPT           SET VALUE PDE TO ADDR OF REG CONTENT 53500002
         L     R15,TSTCONVT        R15=ADDR OF CONVERT ROUTINE          53550002
         LA    R1,VPDE             R1=ADDR OF VALUE PDE                 53600002
         BALR  R14,R15             GO CONVERT REG CONTENTS              53650002
         LTR   R15,R15             TEST RETURN CODE                     53700002
         BNZ   LSTCVTRC            IF NON-ZERO, BRANCH                  53750002
         IC    R15,CONLFLD(R3)     PICK UP LENGTH OF CONVERTED DATA     53800002
         BCTR  R15,NULL            DECREMENT BY 1 FOR AN MVC INSTR      53850002
         EX    R15,REGMOVE         MOVE CONVERTED DATA TO BUFFER        53900002
         LA    R6,SP2(R4,R6)       INCREMENT BUF PTR PAST DATA          53950002
         C     R2,A2               IS ADDR JUST PROCESSED END OF RANGE  54000002
         BNL   LSTREG70            IF YES, BRANCH, AND TEST FOR WRAP    54050002
         AH    R2,REMAIN           INCREMENT REG NUMBER                 54100002
         AH    R5,A1L              INCREMENT INPUT DATA PTR             54150002
LSTREG60 DS    0H                                                       54200002
         ST    R2,A1               STORE ADDR OF NEXT REG TO LIST       54250002
         LA    R15,SP2+RADDRLEN(R4,R6)  CALCULATE PTR AFTER NXT FLD     54300002
         AH    R15,REMAIN2         ADD APPROPIATE SPACING FACTOR        54350002
         C     R15,ENDOGRP         WILL ANOTHER ADDR + DATA FIT IN BUF  54400002
         BH    LSTREG62            IF NOT, BRANCH                       54450002
         AH    R6,REMAIN2          INCRE BUF PTR BY INTER-GROUP SPACE   54500002
         B     LSTREG56            GO PROCESS NEXT REG                  54550002
         SPACE                                                          54600002
LSTREG62 DS    0H                                                       54650002
         BAL   R7,LSTIO            ELSE, GO OUTPUT BUFFER               54700002
         B     LSTREG54            GO LIST MORE REGS                    54750002
LSTREG70 DS    0H                                                       54800002
         TM    COMFLGS,WRAPSW      ELSE TEST FOR WRAP                   54850002
         BNO   LSTREG80            IF NOT, LISTING IS DONE, BRANCH      54900002
         L     R5,REGSTART         ELSE GET REG SAVE START ADDR         54950002
         L     R15,PDE2USER        GET 2ND REG NUMBER GIVEN BY USER     55000002
         SR    R2,R2                   SET UP ADDR FOR REG 0            55050002
         ST    R15,A2                  SET ADDR2 TO LAST REG ADDR       55100002
         NI    COMFLGS,HEXFF-WRAPSW    TURN OFF WRAP SW                 55150002
         B     LSTREG60            GO PROCESS REMAIN REGS               55200002
LSTREG80 DS    0H                                                       55250002
         BAL   R7,LSTIO            GO OUTPUT LAST DATA                  55300002
         B     LSTCC0              RETURN TO LIST MAINLINE              55350002
REGMOVE  MVC   SP2(NULL,R6),CONDATA(R3)   MOVES DATA TO BUFFER          55400002
         TITLE 'IKJEGLST, ''LIST'', COMMON INTERFACE WITH IKJEGIO'      55450002
*********************************************************************** 55500002
*                                                                     * 55550002
*  THIS ROUTINE SETS UP THE PTRS AND CALLS IKJEGIO1 TO OUTPUT A LINE  * 55600002
*  OF DATA. AT ENTRY, THE FOLLOWING REGS ARE SET.                     * 55650002
*        R6  POINTS TO THE NEXT AVAILABLE BYTE IN THE BUFFER          * 55700002
*        R7  HAS THE RETURN POINT ADDRESS                             * 55750002
*                                                                     * 55800002
*  THE CONTENTS OF REGS 0, 1, 6, 14, AND 15 ARE MODIFIED BY THIS RTN  * 55850002
*                                                                     * 55900002
*********************************************************************** 55950002
         SPACE                                                          56000002
LSTIO    DS    0H                                                       56050002
         LR    R15,R6              R15=PTR TO 'END OF DATA'+1           56150002
         L     R6,OUTBUF           R6=PTR TO BEGINNING OF BUF           56200002
         SR    R15,R6              CALCULATE LENGTH OF DATA             56250002
         STH   R15,F1STHALF(R6)    LNTH TO 1ST HALF WORD OF BUFFER      56300002
         SPACE                                                          56350002
*  COMMON PORTION OF IO ROUTINE.                                        56400002
         SPACE                                                          56450002
LSTIO1   DS    0H                                                       56500002
         TM    TSTFLGS1,TSTPRINT+TSTFIRST  IS OUTPUT TO A DS 1ST TIME   56550002
         BM    FIRSTIO             IF OUTPUT TO DS 1ST TIME, BRANCH     56650002
         SR    R0,R0               IF NOT 1ST TIME, INDICATE SO BY R0=0 56700002
LSTIO4   DS    0H                                                       56750002
         STM   R2,R3,WKWORDS       SAVE CONTENTS TO WORK REGS           56760002
         L     R2,DATAPR           OBTIAN DATA LINE ADDRESS FOR I/O     56770002
         LR    R3,R0               TRANSFER CONTENTS OF DSNAME PDE      56780002
         XC    LSTRETCD,LSTRETCD   SET THE RETURN CODE TO 0             56782002
         XC    TSTIOPRM,TSTIOPRM   ZERO OUT PARM FIELD FOR I/O CALL     56790002
         IKJEGSIO  DATA,DATAPTR=(R2),DSNAME=(R3), ISSUE I/O CALLING MAC*56800002
               ID=LST20,MF=(E,TSTIOPRM)   RO FOR DATA LINE              56810002
         LM    R2,R3,WKWORDS       RESTORE WORK REGISTERS               56812002
         CH    R15,H16             TEST THE RTN CODE                    56820002
         BL    LSTIO3              IF NOT SERIOUS CONTINUE              56830002
         ST    R15,LSTRETCD        SAVE THE RETURN CODE FOR MAINLINE    56840002
         B     LSTMN90             GO BACK TO MAINLINE                  56842002
LSTIO3   DS    0H                                                       56844002
         LTR   R15,R15             SEE IF PROCESSING SHOULD BE CONT'D   56846002
         BNZ   LSTMN90             IF NOT ZERO RETURN TO MAINLINE       56848002
         MVI   DATAOFF(R6),BLANK   MOVE A BLANK TO START OF DATA AREA   56850002
         MVC   DATAOFF+ONE(LSTBUFL,R6),DATAOFF(R6)     BLANK OUT BUFFER 56900002
         LA    R6,DATAOFF(R6)      INCRE BUF PTR PAST LL00 FIELD        56950002
         BR    R7                  RETURN TO PROCESSING                 57000002
         SPACE                                                          57400002
*********************************************************************** 57450002
*                                                                     * 57500002
*  THIS ROUTINE IS ENTERED AT THIS POINT WITH R1=COMPLIMENT OF THE    * 57550002
*  ADDRESS OF THE TWO WORD LIST IF OUTPUT IS A MESSAGE.               * 57600002
*                                                                     * 57650002
*********************************************************************** 57700002
LSTIO2   DS    0H                                                       57750002
         L     R6,OUTBUF           SET R6 TO POINT AT OUTPUT BUF        57800002
         B     LSTIO1              GO TO COMMON PART OF IO ROUTINE      57850002
         SPACE                                                          57900002
FIRSTIO  DS    0H                                                       57950002
         L     R14,TSTANSPL        PICK UP BASE ADDR FOR PARSE DSECT    58000002
         USING IKJPARMD,R14        ADDRESSABILITY FOR THE PDL           58050002
         LA    R0,DSNAME           SET UP PTR TO THE DSNAME PDE         58100002
         OI    TSTFLGS1,TSTFIRST   SET FIRST TIME SWITCH TO 1           58150002
         DROP  R14                                                      58200002
         B     LSTIO4              RETURN TO MAIN IO ROUTINE            58250002
         TITLE 'IKJEGLST, ''LIST'', GENERAL SUBROUTINES'                58300002
*********************************************************************** 58350002
*                                                                     * 58400002
*  THIS CLOSED SUBROUTINE CHECKS SEGMENTS OF CORE FOR INSERTED BREAK- * 58450002
*  POINTS AND REPLACES THEM WITH THE ORIGINAL CONTENS OF THE LOCATION.* 58500002
*  THE ROUTINE MOVES THE NEXT 32 BYTES TO BE LISTED TO A WORKAREA AND * 58550002
*  SCANS THE BREAK ELEMENT QUEUE FOR ANY BREAK POINT SVC'S WITHIN THE * 58600002
*  32 BYTE FIELD. WHEN A BREAKPOINT SVC IS FOUND TO BE IN THE RANGE,  * 58650002
*  THE ORIGINAL INSTRUCTION IS MOVED (1ST 2 BYTES) INTO WORK AREA OVER* 58700002
*  THE BREAKPOINT SVC.  REGISTERS ARE SAVED AND RESTORED.             * 58750002
*                                                                     * 58800002
*  INPUT A1=ORIGINAL START ADDR OF DATA IN HOLD AREA                  * 58850002
*        VPDEPT=ADDR OF NEXT BYTE OF THE HOLD AREA TO BE LISTED.      * 58900002
*                                                                     * 58950002
*********************************************************************** 59000002
         SPACE                                                          59050002
LSTBPT   DS    0H                                                       59100002
         SAVE  (14,12)             STANDARD SAVE                        59150002
         SPACE                                                          59200002
*  CALCULATE THE NEW DATA ADDRESS.                                      59250002
         SPACE                                                          59300002
         L     R3,VPDEPT           GET ADDR OF NEXT BYTE OF HOLDAREA    59350002
         LA    R5,HOLDAREA         SET UP START ADDR OF HOLDING CORE    59400002
         SR    R3,R5               DETERMINE NUMBER OF BYTES USED       59450002
         A     R3,A1               INCRE INPUT CORE ADDR BY AMT LISTED  59500002
         LA    R4,LSTIBLK(R3)      ESTABLISH ADDR OF END OF NEXT BLK    59550002
         C     R4,ENDADR           IS END ADDR GREATER THAN HIGHEST     59600002
         BH    LSTBPT30            IF OUT OF CORE, BRANCH TO ADJUST RTN 59650002
         L     R0,A2               OBTAIN LAST ADDRESS                  59660002
         SR    R0,R3               PREPARE TEST LESS THAN FULL          59670002
         CH    R0,H32              TEST 32 OR MORE BYTES LEFT           59680002
         BNL   MOVEMAX             IF 32 OR MORE BYTES LEFT             59690002
         LR    R1,R0               ESTAB NUMBER OF BYTES TO MOVE        59694002
         B     LSTBPT04            BRANCH TO MOVE ROUTINE               59696002
MOVEMAX  DS    0H                  BRANCHED TO 32 CAN BE MOVED          59698002
         LA    R1,LSTIBLK          USE STANDARD LENGTH FOR HOLD DATA    59700002
LSTBPT04 DS    0H                                                       59750002
         EX    R1,HOLDMVC          MOVE DATA TO HOLDING AREA            59800002
         SPACE                                                          59850002
*  IF THE DATA ADDRESS IS NOT ON A HALF WORD BOUNDARY, R0 WILL CONTAIN  59900002
*  A ONE (1), IF THE DATA ADDRESS IS ON A HALFWORD BOUNDARY, R0 WILL    59950002
*  CONTAIN A ZERO (0). THE CONTENTS OF R0 WILL THEN BE USED TO ADJUST   60000002
*  THE DATA ADDRESS AND THE HOLDAREA ADDRESS. THIS ADJUSTMENT IS TO     60050002
*  TAKE CARE OF THE CASE WHERE THE DATA START ADDRESS IS THE SECOND     60100002
*  BYTE OF A BREAKPOINT.                                                60150002
         SPACE                                                          60200002
BLOW2    DS    0H                  ESTABLISH ADDR IF ABEND              60210002
         LA    R0,ONE              SET THE LOW ORDER BIT ON IN REG 0    60250002
         NR    R0,R3               TEST DATA ADDRESS FOR A HALFWORD BDY 60300002
         SR    R3,R0               ADJUST DATA START ADDRESS IF NEEDED  60350002
         SR    R5,R0               MAKE SAME CHANGE FOR HOLDAREA ADDR   60400002
         L     R6,BREAKTAB         GET PTR TO FIRST BREAK ELEMENT       60450002
         USING BRKELEM,R6          ADDRESSABILITY FOR BREAK ELEMENT     60500002
         LTR   R6,R6               IS THERE A 1ST BREAK ELEMENT         60550002
         BP    LSTBPT12            IF THERE IS A BREAK ELEMENT, BRANCH  60600002
         B     LSTBPT20            IF NONE, RETURN                      60650002
         SPACE                                                          60700002
LSTBPT08 DS    0H                                                       60750002
         L     R6,BRKLINK          PICK UP FOREWARD PTR                 60800002
         LTR   R6,R6               TEST FOR ANOTHER                     60850002
         BNP   LSTBPT20            IF NO MORE, BRANCH                   60900002
LSTBPT12 DS    0H                                                       60950002
         C     R3,BRKADDR          COMPARE START ADDR TO BREAKPOINT     61000002
         BH    LSTBPT08            IF BRK-PT LOW, NOT IN RANGE, BRANCH  61050002
         C     R4,BRKADDR          COMPARE END ADDR TO BREAKPOINT       61100002
         BNL   LSTBPT40            IF END ADDR HI OR EQ, ADDR IN RANGE  61150002
LSTBPT20 DS    0H                                                       61200002
         AR    R3,R0               RE-ADJUST DATA ADDRESS AS NEEDED     61250002
         AR    R5,R0               DO THE SAME FOR HOLD AREA ADDRESS.   61300002
         ST    R3,A1               SAVE ACTUAL CORE ADDR OF CUR DATA    61350002
         ST    R5,VPDEPT           RESET VALUE PDE TO PT AT HOLD AREA   61400002
         RETURN (14,12)            RETURN TO CALLER                     61450002
         SPACE                                                          61500002
LSTBPT30 DS    0H                                                       61550002
         L     R1,ENDADR           PICK UP HIGHEST CORE ADDR            61600002
         LR    R4,R1               SET TOP ADDR AS TOP OF CORE          61650002
         SR    R1,R3               DETERMINE REMAINING LENGTH IN BYTES  61700002
         B     LSTBPT04            RETURN TO MAIN LSTBPT FLOW           61750002
         SPACE                                                          61800002
*********************************************************************** 61850002
*  IF A BREAK POINT IS FOUND IN THE RANGE, THE FOLLOWING CODE           61900002
*  WILL REPLACE THE BREAK POINT SVC WITH THE ORIGINAL INSTRUCTION       61950002
*********************************************************************** 62000002
         SPACE                                                          62050002
LSTBPT40 DS    0H                                                       62100002
         L     R2,BRKADDR          R2=ADDR OF BREAKPOINT SVC            62150002
         SR    R2,R3               DETERMINE OFFSET INTO HOLD AREA,     62200002
         AR    R2,R5               ADD THE ADDR OF HOLDAREA             62250002
         SPACE                                                          62300002
*  IF THE BREAK ELEMENT IS STILL ACTIVE, REPLACE THE BREAKPOINT SVC     62350002
*    WITH THE DATA FROM THE BREAK ELEMENT.                              62400002
         SPACE                                                          62450002
         MVC   ZERO(TWO,R2),BRKINST    REPLACE SAVED INSTR              62500002
         B     LSTBPT08            RETURN TO SEARCH LOOP                62550002
         SPACE                                                          62600002
BLOW1    DS    0H                  ESTABLISH ADDR IF ABEND              62610002
HOLDMVC  MVC   HOLDAREA(NULL),ZERO(R3) MOVE SEGMENT OF CORE TO HOLD.    62650002
         DROP  R6                                                       62700002
         EJECT                                                          62750002
*********************************************************************** 62800002
*                                                                     * 62850002
*  GENERAL SUBROUTINE FOR MOVING SYMBOLIC ADDRESSES TO THE OUTPUT BUF * 62900002
*        AT ENTRY,  R6 SHOULD POINT TO FIRST BYTE OF OUTPUT AREA      * 62950002
*                   R7 POINTS TO RETURN POINT.                        * 63000002
*********************************************************************** 63050002
         SPACE                                                          63100002
LSTSYM   DS    0H                                                       63150002
         OI    APDE+(PDEFLG2-IKJPARMA),CTNAMFLG TURN ON 'QUALIFIED' SW  63200002
*  TURN RELATIVE ADDR FLAG ON, AND ABSOLUTE ADDR SW OFF                 63250002
         XI    APDE+(PDEFLG4-IKJPARMA),RELADDR+ABSADDR                  63300002
         LA    R2,A1               GET ADDR OF INPUT DATA PTR           63350002
         ST    R2,APDE+(PDEADRPT-IKJPARMA) PUT IT IN THE ADDRESS PDE    63400002
         L     R6,OUTBUF           GET PTR TO THE OUTPUT BUFFER         63450002
         LA    R6,DATAOFF(R6)      INCRE BUFFER PTR PAST LL00 FIELD     63500002
         MVI   ZERO(R6),BLANK    MOVE BLANK TO BUFFER     @ZA07140      63510003
         MVC   ONE(LSTBUFL-DATAOFF,R6),ZERO(R6) BLANK OUT @ZA07140      63520003
         BAL   R14,LSTAMV          GO MOVE THE ADDRESS TO THE BUFFER    63550002
         L     R15,A1              R15=START ADDR OF DATA               63600002
         ST    R15,PPTEMP          MAKE START OF DATA ADDR BASE FOR REL 63650002
         L     R3,CONAREA                                               63700002
         SR    R0,R0               R0=0                                 63750002
         BCTR  R0,NULL             MAKE NEG TO SHOW CONVERT TO PRINT    63800002
         BAL   R14,LSTBPT          GO CLEAR BREAKPOINT SVC'S FROM DATA  63850002
         BR    R7                  RETURN TO CALLER                     63900002
         EJECT                                                          63950002
*********************************************************************** 64000002
*  THIS ROUTINE WILL ADD THE PRODUCT OF THE LENGTH AND MULTIPLICITY   * 64050002
*  TO THE START ADDRESS AND COMPARE THE SUM TO 'ENDADR'. IF THE       * 64100002
*  SUM EXCEEDS 'ENDADR', A NEW MULTIPLICITY IS CALCULATED AND SWITCH  * 64150002
*  'OUTCORE' IN COMFLGS IS SET, THE NUMBER OF BYTES NOT OUT           * 64200002
*  OF CORE IS PLACED 'LASTLEN', AND THE CALCULATED MULTIPLICITY IS    * 64250002
*  STORED IN 'A1M'.                                                   * 64300002
*  RETURN CODES---   4  IF 'NEW' MULTIPLICITY IS ZERO                 * 64350002
*                    0  FOR ALL OTHER CASES.                          * 64400002
*********************************************************************** 64450002
LSTLMTCK DS    0H                                                       64500002
         SAVE  (0,12)                                                   64550002
         L     R2,A1               GET DATA START ADDR                  64600002
         LH    R3,A1L              GET LENGTH FOR THIS REQUEST          64650002
         LA    R2,ZERO(ZERO,R2)    CLEAR HIGH BYTE FOR CALCULATION      64700002
         MH    R3,A1M              MULTIPLY  (LENGTH X MULTIPLICITY)    64750002
         AR    R3,R2               ADD START ADDR TO LENGTH OF REQUEST  64800002
         BCTR  R3,NULL             DECREMENT TO MAKE EXCLUSIVE          64850002
         ST    R3,A2               STORE 2ND ADDR FOR LATER USE         64860002
         C     R3,ENDADR           COMPARE POTENTIAL END ADDR TO TOP    64900002
         BH    LSTLMT20            IF REQUEST GOES OUT OF CORE, BRANCH  64950002
LSTLMT10 DS    0H                                                       65000002
         SR    R15,R15             SET RETURN CODE TO ZERO              65050002
LSTLMT14 DS    0H                                                       65100002
         RETURN  (0,12)                                                 65150002
         SPACE                                                          65200002
LSTLMT20 DS    0H                                                       65250002
         L     R5,ENDADR           GET LAST MACHINE ADDRESS             65300002
         ST    R5,A2               STORE 2ND ADDR FOR LATER USE         65310002
         SR    R4,R4               CLEAR EVEN REG FOR DIVIDE            65350002
         LH    R3,A1L              GET LENGTH FOR THIS REQUEST          65400002
         SR    R5,R2               TOP ADDR - START ADDR                65450002
         LA    R5,ONE(ZERO,R5)     ADD ONE TO MAKE LASTLEN INCLUSIVE    65500002
         DR    R4,R3               DIVIDE BYTES IN CORE BY LENGTH       65550002
         STH   R5,A1M              SET NEW MULTIPLICITY                 65600002
         STH   R4,LASTLEN          SAVE NO. OF BYTES IN CORE            65650002
         OI    COMFLGS,OUTCORE                                          65700002
         LTR   R5,R5               WAS REMAINING MULTI ZERO             65750002
         BNZ   LSTLMT10            IF NOT, BRANCH                       65800002
         LA    R15,FOUR            SET RETURN CODE TO FOUR              65850002
         B     LSTLMT14            GO RETURN WITH A RC=4                65900002
         SPACE                                                          65950002
         EJECT                                                          66350002
*********************************************************************** 66400002
*                                                                     * 66450002
*  GENERAL SUBROUTINE FOR MOVING ADDRESSES TO THE OUTPUT BUFFER.      * 66500002
*        AT ENTRY,  R6 SHOULD POINT TO THE NEXT AVAILABLE BUFFER BYTE * 66550002
*                   R8 SHOULD CONTAIN THE ADDRESS OF THE ADDR PDE.    * 66600002
*        AT-EXIT,   R6 CONTAINS THE UPDATED BUFFER PTR, AND           * 66650002
*                   THE OUTPUT BUFFER CONTAINS THE ADDRESS STRING.    * 66700002
*                                                                     * 66750002
*********************************************************************** 66800002
LSTAMV   DS    0H                                                       66850002
         SAVE  (14,12)             SAVE CALLERS REGS                    66900002
         LA    R2,X'40'            PUT A BLANK IN REG2         @ZA00914 66910000
         STC   R2,0(R6)            PUT A BLANK IN BUFFER       @ZA00914 66920000
         MVC   ONE(7,R6),0(R6)     PROPAGATE BLANKS            @ZA00914 66930000
         TM    PDEFLG1,LDNAMFLG    WAS A LOADNAME USED                  66950002
         BZ    LSTAMV04                IF NOT, BRANCH                   67000002
         LH    R2,PDELEN1          PICK UP LENGTH OF LOAD NAME          67050002
         BCTR  R2,NULL                 DECREMENT BY 1 FOR MVC INSTR     67100002
         L     R15,PDELDNAM        PICK UP PTR TO LOAD NAME             67150002
         EX    R2,SYMMOVE          MOVE SYMBOL TO OUTPUT LOCATION       67200002
         LA    R6,ONE(R2,R6)       INCREMENT BUF PTR PAST LOADNAME      67250002
LSTAMV04 DS    0H                                                       67300002
         TM    PDEFLG2,CTNAMFLG    WAS ENTRY NAME SPECIFIED             67350002
         BZ    LSTAMV08                IF NOT, BRANCH                   67400002
         MVI   ZERO(R6),PERIOD     MOVE IN SEPARATOR                    67450002
         LA    R6,L'PERIOD(R6)     INCREMENT BUF PTR PAST PREFIX        67500002
         LH    R2,PDELEN2          GET LENGTH OF ENTRY NAME AND         67550002
         BCTR  R2,NULL                 DECREMENT BY 1 FOR MVC INSTR     67600002
         L     R15,PDECTNAM        PICK UP PTR TO ENTRY NAME            67650002
         EX    R2,SYMMOVE          MOVE NAME TO OUTPUT AREA             67700002
         LA    R6,ONE(R2,R6)       INCREMENT BUF PTR PAST ENTRYNAME     67750002
         TM    PDEFLG4,CTONLY      IS ADDR TYPE STAND ALONE ENTRYNAME   67800002
         BO    LSTAMV16                IF STAND ALONE ENTRYNAME, BRANCH 67850002
         MVI   ZERO(R6),PERIOD     MOVE IN SEPARATOR                    67900002
         LA    R6,L'PERIOD(R6)     INCREMENT BUF PTR PAST PREFIX        67950002
LSTAMV08 DS    0H                                                       68000002
         LH    R2,PDELEN3          PICK UP LENGTH OF WYMBOL AND         68050002
         BCTR  R2,NULL                 DECREMENT BY 1 FOR MVC INSTR     68100002
         L     R15,PDEADRPT        R15=PTR TO SYMBOL                    68150002
         EX    R2,SYMMOVE          MOVE SYMBOL TO OUTPUT AREA           68200002
         LA    R6,ONE(R2,R6)       INCREMENT BUF PTR PAST SYMBOL        68250002
LSTAMV16 DS    0H                                                       68300002
         ST    R6,R6OFF(R13)       MODIFY REG 6 CONTENTS (IN SAVE AREA) 68350002
         RETURN (14,12)            RETRUN TO CALLER WITH HIS REGS       68400002
SYMMOVE  MVC   ZERO(NULL,R6),ZERO(R15)  FOR MOVING NAMES TO BUFFER      68450002
         TITLE 'IKJEGLST, ''LIST'', PARSE EXIT SUB-ROUTINES'            68500002
*********************************************************************** 68550002
*                                                                     * 68600002
*  ENTRY POINT FOR LENGTH VALIDITY CHECK EXIT ROUTINE.                * 68650002
*                                                                     * 68700002
*********************************************************************** 68750002
LSTVALEN DS    0H                                                       68800002
         SAVE  (14,12)             SAVE PARSE REGS                      68850002
         LA    R14,OFFSETL1(R15)   SET UP ADDR OF LNTH/MULTI ROUTINE    68900002
         SR    R4,R4               INDICATE LENGTH PARAMETER            68950002
         B     OFFSET1(R15)        GO TO COMMON LINK CONVENTION RTNJ    69000002
         SPACE                                                          69050002
*********************************************************************** 69100002
*                                                                     * 69150002
*  ENTRY POINT FOR MULTIPLICITY VALIDITY CHECK EXIT ROUTINE.          * 69200002
*                                                                     * 69250002
*********************************************************************** 69300002
LSTVALMT DS    0H                                                       69350002
         SAVE  (14,12)             SAVE PARSE REGS                      69400002
         LA    R14,OFFSETM1(R15)   SET UP ADDR OF LNTH/MULTI ROUTINE    69450002
         LA    R4,TWO              INDICATE MULTIPLICITY PARAMETER      69500002
         B     OFFSET2(R15)        GO TO COMMON LINK CONVENTION RTN     69550002
         SPACE                                                          69600002
*********************************************************************** 69650002
*                                                                     * 69700002
*  ENTRY POINT FOR ADDRESS VALIDITY CHECK EXIT ROUTINE.               * 69750002
*                                                                     * 69800002
*********************************************************************** 69850002
LSTVALAD SAVE  (14,12)             SAVE PARSE PREGS                     69900002
         LA    R14,OFFSETAD(R15)   SET UP ADDR OF ADDRESS VALIDITY RTN  69950002
         SPACE                                                          70000002
LSTVALCM DS    0H                                                       70050002
OFFSET1  EQU   *-LSTVALEN                                               70100002
OFFSET2  EQU   *-LSTVALMT                                               70150002
         L     R12,FOUR(R1)        R12=PTR TO LIST'S SAVE AREA          70200002
         LR    R3,R1               SAVE REG1                            70250002
         LM    R6,R12,R6OFF(R12)   RESTORE REQUIRED REGS OF LIST        70300002
         L     R2,REGSAVE3         PTR TO NEW SAVE AREA                 70350002
         ST    R2,FOREPTR(R13)     FOREWARD CHAIN SAVE AREAS.           70400002
         ST    R13,BACKPTR(R2)     BACKWARD CHAIN SAVE AREAS.           70450002
         LR    R13,R2              SET NEW SAVE AREA                    70500002
         OI    TSTFLGS4,TSTVALCK   TURN ON VALIDITY CHECK ROUTINE BIT   70510002
         SR    R0,R0               INDICATE CONVERT TO BINARY           70520002
         L     R8,OUTBUF           OBTAIN ADDRESS TO OUTBUF             70530002
         ST    R0,ZERO(R8)         INITIALIZE SECOND LEVEL LENGTH ZERO  70540002
         L     R8,ZERO(R3)         GET ADDR OF PDE                      70550002
         BR    R14                 GO TO PROPER RTN                     70700002
         EJECT                                                          70750002
*********************************************************************** 70800002
*                                                                     * 70850002
*  ADDRESS VALIDITY ROUTINE. AT ENTRY, R0=0, AND R2=PTR TO ADDR PDE.  * 70900002
*                                                                     * 70950002
*********************************************************************** 71000002
LSTADR   DS    0H                                                       71050002
OFFSETAD EQU   *-LSTVALAD                                               71100002
         SPACE                                                          71150002
         USING IKJPARMA,R8         ADDRESSABILITY FOR THE ADDR PDE      71200002
         LCR   R1,R8               INDICATE ADDR CONVERSION             71250002
         L     R15,TSTCONVT        GET ADDR OF IKJEGCVT                 71300002
         OI    TSTFLGS1,RANGESW    SET SW TO SHOW ADDR MAY BE A RANGE   71350002
         BALR  R14,R15             GO TO CONVERT ROUTINE                71400002
         LTR   R15,R15             TEST CONVERT RTN CODE                71450002
         BNZ   LSTADR12            IF NON-ZERO, BRANCH                  71500002
         TM    PDE2FLG3,AFLG       WAS A SECOND ADDR GIVEN              71550002
         BO    LSTADR04            IF YES, BRANCH                       71600002
         TM    PDE2FLG4,CTONLY     WAS A 2ND ADDR GIVEN AS ENTRY NAME   71650002
         BZ    LSTADR06            IF NO 2ND ADDRESS, BRANCH            71700002
LSTADR04 DS    0H                                                       71750002
         TM    PDEFLG4,GENR+LFPR+SFPR  IS 1ST ADDR A REG TYPE           71800002
         BZ    LSTADR26            IF NOT, BRANCH                       71850002
         CH    R0,PDEINDCT         IS 1ST REG ADDR INDIRECTED           71900002
         BNE   LSTADR26            IF INDIRECT, BRANCH, ADDR IS CORE    71950002
         SPACE                                                          72000002
*  ADDRESS 1 IS A REG ADDRESS, NOW TEST ADDRESS 2.                      72050002
         SPACE                                                          72100002
         CH    R0,PDE2INDC         IS 2ND REG ADDR INDIRECTED           72150002
         BNE   LSTADR50            IF INDIRECT, ERROR, BRANCH           72200002
         CLC   PDEFLG4,PDE2FLG4    COMPARE TYPES FOR 1ST AND 2ND ADDRS  72250002
         BNE   LSTADR24            IF NOT EQ, ERROR, BRANCH             72300002
LSTADR06 DS    0H                                                       72350002
         SR    R15,R15             SET RETURN CODE TO 0                 72400002
LSTADR08 DS    0H                                                       72450002
         L     R13,BACKPTR(R13)    PICK UP CALLERS SAVE AREA ADDRESS    72500002
         L     R1,R1OFF(R13)       PICK UP PTR TO PARM LIST FROM PARSE  72550002
         L     R8,OUTBUF           PICK UP ADDR OF OUTBUF/2ND LEV MSG   72560002
         LH    R7,ZERO(R8)         PICK UP MSG LENGTH                   72580002
         LTR   R7,R7               SEE IF THERE IS A SECOND LEVEL MSG   72590002
         BZ    NO2NDLEV            IF NOT, BRANCH AROUND NEXT INST.     72592002
         ST    R8,EIGHT(ZERO,R1)   PASS PTR TO 2ND LEVEL MSG            72600002
NO2NDLEV DS    0H                                                       72610002
         NI    TSTFLGS1,HEXFF-RANGESW  CLEAR RANGE SW FOR RE-USE        72650002
         NI    TSTFLGS4,HEXFF-TSTVALCK TURN OFF VALIDITY CHECK SWITCH   72660002
         RETURN (14,12),,RC=(15)   RETURN TO PARSE                      72700002
         SPACE                                                          72750002
LSTADR12 DS    0H                                                       72800002
         C     R15,FSIXTEEN        WAS RETURN CODE A 16 OR 20           72850002
         BNL   LSTADR16            IF 16 OR 20, BRANCH                  72900002
         TM    TSTFLGS1,RANGESW    WAS 1ST OR 2ND PDE IN ERROR          72950002
         LA    R1,PDEUSER          ANTICIPATE 1ST PDE IN ERROR          73000002
         BO    LSTADR14            IF 1ST ADDR IN ERROR, BRANCH         73050002
         LA    R1,PDE2USER         IF 2ND PDE IN ERROR, RE-INITIALIZE   73100002
LSTADR14 DS    0H                                                       73150002
         SPACE                                                          73250002
LSTADR15 DS    0H                                                       73300002
         LA    R15,EIGHT           SET RETURN CODE TO 8.                73350002
         B     LSTADR08            BRANCH TO RETURN RTN                 73400002
         SPACE                                                          73450002
LSTADR16 DS    0H                                                       73500002
         ST    R15,LSTRETCD        SAVE RC TO PASS BACK TO MAINLINE     73550002
         LA    R15,TWELVE          SET RC=12 TO PARSE                   73600002
         B     LSTADR08            GO RETURN TO PARSE                   73650002
         SPACE                                                          73700002
LSTADR24 DS    0H                                                       73750002
         TM    PDE2FLG4,GENR+SFPR+LFPR  IS ADDR 2 REGISTER TYPE         73800002
         BNM   LSTADR50            IF NOT REG TYPE, BRANCH              73850002
         LA    R6,M0219            OBTAIN MSG NUMBER FOR I/O CALL       73900002
         B     LSTADR70            GO TO MSG ROUTINE                    73950002
         SPACE                                                          74000002
*  IF ADDRESS 1 IS A CORE ADDRESS AND A RANGE WAS GIVEN, ADDRESS 2    * 74050002
*  MUST ALSO BE A CORE ADDRESS.                                       * 74100002
         SPACE                                                          74150002
LSTADR26 DS    0H                                                       74200002
         TM    PDE2FLG4,GENR+LFPR+SFPR  IS 2ND ADDR REG TYPE            74250002
         BZ    LSTADR30            IF NOT REG, BRANCH                   74300002
         CH    R0,PDE2INDC         IF 2ND ADDR REG TYPE, IS IT INDIRECT 74350002
         BE    LSTADR50            IF 2ND ADDR REG TYPE, BRANCH         74400002
         SPACE                                                          74450002
*  IF AN ADDRESS RANGE HAS BEEN SPECIFIED AND THE ADDRESSES ARE CORE  * 74500002
*  ADDRESS 1 MUST BE LESS THAN OR EQUAL TO ADDRESS 2.                 * 74550002
         SPACE                                                          74600002
LSTADR30 DS    0H                                                       74650002
         L     R3,PDEUSER          GET 1ST ADDR OR SI PTR (SYM-INFO)    74700002
         LTR   R3,R3               IS 1ST ADDR AN SI PTR                74750002
         BNM   LSTADR32            IF NOT AN SI PTR, BRANCH             74800002
         L     R3,SIDATAPT(R3)     GET ACTUAL DATA ADDR FROM SI BLK     74850002
LSTADR32 DS    0H                                                       74900002
         LA    R3,ZERO(R3)         ZERO OUT HIGH ORDER BYTE             74950002
         L     R4,PDE2USER         GET 2ND ADDR OR SI PTR               75000002
         LTR   R4,R4               IS 2ND ADDR AN SI BLK PTR            75050002
         BNM   LSTADR36            IF NOT AN SI BLOCK PTR, BRANCH       75100002
         L     R4,SIDATAPT(R4)     GET ACTUAL DATA ADDRESS              75150002
LSTADR36 DS    0H                                                       75200002
         LA    R4,ZERO(R4)         ZERO OUT HIGH ORDER BYTE             75250002
         CR    R3,R4               COMPARE DATA ADDR 1 WITH DATA ADDR2  75300002
         BNH   LSTADR06            IF ADDR 1 IS EQUAL OR HIGH, BRANCH   75350002
         SPACE                                                          75400002
*  IF ADDRESS 2 IS LOWER THAN ADDRESS 1, THE RANGE IS INVALID AND AN  * 75450002
*  ERROR MESSAGE MUST BE ISSUED.                                      * 75500002
         SPACE                                                          75550002
         LA    R6,M0221            OBTAIN MSG NUMBER FOR I/O CALL       75600002
         B     LSTADR70            GO TO MSG SETUP ROUTINE              75650002
         SPACE                                                          75700002
LSTADR50 DS    0H                                                       75750002
         LA    R6,M0220            OBTAIN MSG NUMBER FOR I/O CALL       75800002
         B     LSTADR70            GO TO MESSAGE SET UP ROUTINE         75850002
         SPACE                                                          75900002
*  INVALID ADDRESS AND ADDRESS RANGE MESSAGE SETUP ROUITNE            * 75950002
*        AT ENTRY, R15 CONTAINS THE OFFSET TO THE DESIRED MSG LIST.     76000002
         SPACE                                                          76050002
LSTADR70 DS    0H                                                       76100002
         XC    TSTIOPRM,TSTIOPRM   ZERO OUT PARM FIELD FOR I/O CALL     76110002
         IKJEGSIO  MSG,FIRST=M0073,INST11=(APDE,(R8)), ISSUE I/O CALL- *76120002
               SECOND=(R6),ID=LST20,MF=(E,TSTIOPRM)    ING MACRO        76130002
LSTADR86 DS    0H                                                       76132002
         CH    R15,H16             TEST THE RTN CODE                    76140002
         BL    LSTADR15            IF SUCCESSFUL CONTINUE WITH PROMPT   76150002
         B     LSTADR16            GO BACK TO MAINLINE THRUGH PARSE     76170002
         DROP  R8                                                       78050002
         EJECT                                                          78100002
*********************************************************************** 78150002
*                                                                     * 78200002
*  LENGTH/MULTIPLICITY VALIDITY ROUTINE, AT ENTRY,                    * 78250002
*        R0=0, R2=PTR TO THE PDE, AND R4= EITHER 0 FOR LENGTH         * 78300002
*        VALIDITY CHECK, OR 2 FOR MULTIPLICITY VALIDITY CHECK.        * 78350002
*                                                                     * 78400002
*********************************************************************** 78450002
         SPACE                                                          78500002
LSTLM    DS    0H                                                       78550002
OFFSETL1 EQU   *-LSTVALEN          OFFSET FROM LNTH VALIDCK E.P.        78600002
OFFSETM1 EQU   *-LSTVALMT          OFFSET FROM MULTIPLICITY VALIDCK EP  78650002
         LA    R1,VPDE             SET UP REG 1 TO CONVERT A VALUE      78700002
         MVC   VPDE(VPDELEN),ZERO(R8)  MOVE IDENT PDE TO WORKING CORE   78750002
         MVI   VPDET,HCODE         INDICATE TYPE IS FIXED PT HALFWORD   78800002
         L     R15,TSTCONVT        ADDR OF IKJEGCVT                     78850002
         BALR  R14,R15             GO TO CONVERT RTN                    78900002
         LTR   R15,R15             TEST RETURN CODE                     78950002
         BNZ   LSTADR86            IF NON-ZERO, BRANCH, GO TEST RC      79000002
         L     R15,CONAREA         ADDR OF CONVERT OUTPUT AREA          79050002
         LA    R15,CONDATA(R15)    INCREMENT PTR PAST LENGTH FIELD      79100002
         LH    R0,ZERO(R15)        PICK UP CONVERTED VALUE              79150002
         CH    R0,H256             COMPARE ATTR TO MAX                  79200002
         BH    LSTERR              IF HIGH, ERROR, BRANCH               79250002
         LTR   R0,R0               TEST FOR LENTH/MULTI EQ 0            79300002
         STH   R0,LMATTR(R4)       SAVE CONVERTED ATTRIBUTE             79350002
         BNZ   LSTADR06            IF LENTH/MULTI NON-ZERO, BRANCH      79400002
         SPACE                                                          79450002
LSTERR   DS    0H                                                       79500002
         LA    R5,I0084            GET INSERT NUMBER INTO REGISTER      79510002
         LTR   R4,R4               IS THE LENGTH BEING CHECKED          80000002
         BZ    LENERR              BRANCH IF SO                         80100002
         LA    R5,I0083            GET INSERT NUMBER INTO REGISTER      80150002
LENERR   DS    0H                                                       80300002
         XC    TSTIOPRM,TSTIOPRM   ZERO OUT PARM FIELD FOR I/O CALL     80310002
         IKJEGSIO  MSG,FIRST=M0017,INST11=(NUM,(R5)),  ISSUE I/O CALL- *80320002
               SECOND=M0278,ID=LST20,MF=(E,TSTIOPRM)   ING MACRO        80330002
         CH    R15,H16             TEST THE RTN CODE                    80340002
         BL    LSTADR15            IF SUCCESSFUL CONTINUE               80350002
         B     LSTADR16            RETURN TO MAINLINE THROUGH PARSE     80450002
         SPACE                                                          80460002
DATAMOVE MVC   ZERO(NULL,R6),CONDATA(R3)  FOR MOVING DATA TO BUFFER     80470002
         EJECT                                                          80600002
*********************************************************************** 80650002
*                                                                       80700002
*        STAE RETRY ROUTINE                                             80750002
*                                                                       80800002
*********************************************************************** 80850002
         SPACE 3                                                        80900002
RETRY    DS    0H                                                       80950002
         L     R4,CVTPTR           PTR TO CVT                           81000002
         USING CVTDSECT,R4         ADDRESSABILITY FOR CVT               81050002
         L     R4,CVTTCBP          TCB PTR                              81100002
         L     R4,FOUR(R4)         CURRENT TCB PTR                      81150002
         DROP  R4                                                       81200002
         USING TCB,R4              TCB ADDRESSABILITY                   81250002
         L     R9,TCBTRN           TCOMTAB PTR                          81300002
         OI    TSTFLGS4,TSTRERTN   TURN ON RETRY IN PROCESS SW          81310002
         L     R13,REGSAVE2        PTR TO SAVE AREA                     81350002
         LM    R10,R12,R10OFF(R13)     RESTORE MODULE ADDRESSABILITY    81400002
         LA    R15,TWENTY          INDICATE ERROR RETURN                81650002
         ST    R15,LSTRETCD        SAVE RETURN CODE                     81700002
         B     LSTMN90             RETURN                               81750002
         EJECT                                                          81752002
*****************************************************************       81760002
*                                                                       81770002
*  THIS ROUTINE IS ENTERED AT THIS POINT TO CK THE VALIDITY OF          81780002
*  THE CALCULATED STOP ADDRESS FOR THE LIST COMMAID.                    81782002
*  REGS ARE SAVED AND RESTORED AND THE ROUTINE RETURNS TO CALLER        81784002
*  IF THE ADDRESS PROVES TO BE VALID; OTHERWISE, THE ROUTINE            81786002
*  BRANCHES TO PRINT MESSAGE AND RETURN TO MAINLINE.                    81788002
*                                                                       81790002
*****************************************************************       81792002
ADDRCHK  DS    0H                                                       81794002
         SAVE  (14,12)             STANDARD SAVE                        81796002
         L     R6,PPTCB            EXTAB PTR TO PROB PROG TCB           81798002
         L     R7,A2               EXTAB PTR TO STOP ADDR               81798402
         IKJEGS9G  ADDRCHK,TCBADDR=(R6),VALUE=(R7),MF=(E,WKWORDS)       81798802
         C     R15,FEIGHT          RTN CODE (EIGHT)                     81799202
         BL    GOODADDR            OK -- RETURN TO PROCESSING           81799602
         BH    ERR97               ERROR ENCOUNTERED IN SVC97           81811602
         SPACE                                                          81812202
*  COMMON PARSE ERROR MESSAGE SETUP ROUTINE.                            81822202
         SPACE                                                          81824202
         XC    TSTIOPRM,TSTIOPRM   ZERO OUT PARM FIELD FOR I/O CALL     81834202
         IKJEGSIO  MSG,FIRST=M0018, ISSUE I/O CALLING FOR MSG          *81836202
               SECOND=M0285,ID=LST20,MF=(E,TSTIOPRM)  CALLING MACRO     81838202
         CH    R15,H16             TEST THE RTN CODE                    81840202
         BL    LSTMN90             IF SUCCESSFUL CONTINUE               81842202
ERR97    DS    0H                                                       81842302
         ST    R15,LSTRETCD        SAVE THE RETURN CODE FOR MAINLINE    81842602
         B     LSTMN90             CLEAN UP, RTN TO CALLER I/O RC       81844102
GOODADDR RETURN (14,12)            RETURN TO PROCESSING                 81844402
         TITLE 'IKJEGLST, ''LIST'', PARSE DISCRIPTOR MACROS'            81847202
IKJEGPMA IKJPARM                                                        81850002
ADDR1 IKJPOSIT ADDRESS,LIST,RANGE,PROMPT='ADDRESS OR REGISTER',        *81900002
               VALIDCK=LSTVALAD                                         81950002
TYPE     IKJKEYWD                                                       82000002
         IKJNAME 'C'               CHARACTER FORMAT                     82050002
         IKJNAME 'X'               HEXADECIMAL                          82100002
         IKJNAME 'B'               BINARY                               82150002
         IKJNAME 'F'               FIXED PT BINARY, FULLWORD            82200002
         IKJNAME 'H'               FIXED PT BINARY, HALFWORD            82250002
         IKJNAME 'E'               FLOATING PT, SINGLE PRECISION        82300002
         IKJNAME 'D'               FLOATING PT, DOUBLE PRECISION        82350002
         IKJNAME 'A'               ADDRESS CONSTANT, FULLWORD           82400002
         IKJNAME 'Y'               ADDRESS CONSTANT, HALFWORD           82450002
         IKJNAME 'S'               ADDRESS CONSTANT, BASE/DISPLACEMENT  82500002
         IKJNAME 'P'               PACKED DECIMAL                       82550002
         IKJNAME 'Z'               ZONED DECIMAL                        82600002
         IKJNAME 'I'               INSTRUCTION FORMAT                   82650002
LATTR    IKJKEYWD                                                       82700002
         IKJNAME 'LENGTH',SUBFLD=LENCD                                  82750002
MATTR    IKJKEYWD                                                       82800002
         IKJNAME 'MULTIPLE',SUBFLD=MULCD                                82850002
PRINT    IKJKEYWD                                                       82900002
         IKJNAME 'PRINT',SUBFLD=DSNAM                                   82950002
LENCD    IKJSUBF                                                        83000002
LENGTH   IKJIDENT 'LENGTH',MAXLNTH=3,FIRST=NUMERIC,OTHER=NUMERIC,      C83050002
               PROMPT='LENGTH',VALIDCK=LSTVALEN                         83100002
MULCD    IKJSUBF                                                        83150002
MULTI    IKJIDENT 'MULTIPLICITY FACTOR',FIRST=NUMERIC,OTHER=NUMERIC,   C83200002
               PROMPT='MULTIPLICITY FACTOR',VALIDCK=LSTVALMT            83250002
DSNAM    IKJSUBF                                                        83300002
DSNAME   IKJPOSIT DSNAME,PROMPT='OUTPUT DATA SET NAME'                  83350002
         IKJENDP                                                        83400002
         TITLE 'IKJEGLST, ''LIST'', CONSTANTS AND DSECTS'               83450002
PARSEPCL DC    V(IKJEGPMA)         PTR TO PARSE PCL                     83550002
RETRYAD  DC    A(RETRY)            PTR TO STAE RETRY CODE               83600002
         SPACE                                                          83650002
XCTLLF  XCTL  ,SF=L                MODEL FOR LIST FORM OF XCTL MACRO    83700002
XCTLLEN  EQU   *-XCTLLF            LENGTH OF LIST FORM OF XCTL MACRO    83750002
         SPACE                                                          83800002
FEIGHT   DC    F'8'                CONSTANT OF EIGHT GENERAL USE        83850002
FSIXTEEN DC    F'16'               CONSTANT OF 16, GENERAL USE          83900002
         SPACE                                                          83950002
LENTH    DC    C'LENGTH+'          KEYWORD TO MOVE IN MESSAGE           84000002
MULTIP   DC    C'MULTIPLICITY+'             ''                          84050002
         SPACE                                                          84100002
SMTLABL  DS    0H                  SMT TEST LABEL FOR XCTL MACRO        84150002
LSA      DC    C'LSA'              CONSTANT USED BY MAINLINE BLDL RTNE  84200002
         SPACE                                                          84250002
CONLEN   EQU   13                  LENGTH OF THE PREVIOUS CONSTANTS     84300002
         DS    0F                                                       84350002
SPMASK   DC    X'01000000'         SUB-POOL NUMBER MASK FOR FREEMAIN    84400002
ENDADR   DC    X'00FFFFFF'         MAXIMUM CORE ADDRESS                 84450002
IKJEGSPL IKJEGSPL RTRY=RETRY,ABNTB=LSTABEND,MODNM=IKJEGLST,TNM=LIST     84460002
SUPERZAP DC    50CL1'Z'            AREA FOR TEMP UPDATES                84500002
         SPACE                                                          84550002
HONE     DC    H'1'                CONSTANT OF 1, GENERAL USE           84600002
H16      DC    H'16'               CONSTANT OF SIXTEEN, GENERAL USE     84650002
H32      DC    H'32'               CONSTANT OF THIRTY-TWO GENERAL USE   84660002
H256     DC    H'256'              CONSTANT OF 256, GENERAL USE         84700002
AFLEN    DC    A(ADDRLEN+SP1+SP1)  LENGTH OF ADDR FLD (+ 2 SPACES)      84750002
         SPACE 2                                                        84800002
LSTABEND DS    0F                                              @ZA06225 84850003
         DC    AL1(97)             CODE FOR PROTECTION CHECK            84910002
         DC    AL3(BLOW1)          RESUME ADDRESS FOLLOWING             84920002
         DC    AL1(97)             CODE FOR PROTECTION CHECK            84930002
         DC    AL3(BLOW2)          RESUME ADDRESS FOLLOWING             84940002
         DC    AL1(97)             CODE FOR PROTECTION CHECK            84942002
         DC    AL3(LSTBPT04)       RESUME ADDRESS FOLLOWING             84944002
         DC    AL1(99)             CODE FOR LINK TO PARSE FAILED        84950002
         DC    AL3(PARSEBLO)       ADDRESS OF POTENTIAL ABEND           85000002
         DC    X'FF'               TABLE STOPPER                        85050002
         SPACE 2                                                        85100002
*********************************************************************** 85150002
*  THIS TABLE CONVERTS THE NUMBER OF THE TYPE KEYWORD SPECIFIED, TO   * 85200002
*  A HEXADECIMAL CODE USED INTERNALLY BY TEST.                        * 85250002
*        THE FIRST CODE BYTE (X'04' FOR HEX) IS PICKED UP IF THE TYPE * 85300002
*        KEYWORD WAS NOT SPECIFIED AND THE PDE IS ZERO. THE TYPE CODE * 85350002
*        OF X'0C' IS NOT CURRENTLY USED BY THE ASSEMBLER AND IS USED  * 85400002
*        HERE FOR INSTRUCTION FORMAT, TYPE 'I'. THE ORDER OF THIS     * 85450002
*        TABLE DIRECTLY CORRESPONDS TO THE ORDER OF THE IKJNAME MACROS* 85500002
*        FOR THE TYPE KEYWORD.                                        * 85550002
         SPACE                                                          85600002
TYPETBL  DS    0H                                                       85650002
         DC    X'04'               CODE FOR HEX FORMAT, DEFAULT TYPE    85700002
         DC    X'00'                ''  ''  CHARACTER FORMAT            85750002
         DC    X'04'                ''  ''  HEXFORMAT, USER GIVEN       85800002
         DC    X'08'                ''  ''  BINARY FORMAT               85850002
         DC    X'10'                ''  ''  FIXED PT BINARY 'F'         85900002
         DC    X'14'                ''  ''    ''   ''   ''   'H'        85950002
         DC    X'18'                ''  ''  FLOATING PT 'E'             86000002
         DC    X'1C'                ''  ''     ''    '' 'D'(TYPE -DN-)  86050002
         DC    X'20'                ''  ''  A TYPE ADDRESS CONSTANT     86100002
         DC    X'24'                ''  ''  Y  ''    ''      ''         86150002
         DC    X'28'                ''  ''  S  ''    ''      ''         86200002
         DC    X'30'                ''  ''  PACKED DECIMAL FORMAT       86250002
         DC    X'34'                ''  ''  ZONED DECIMAL FORMAT        86300002
         DC    X'0C'                ''  ''  INSTRUCTION FORMAT, TYPE I  86350002
         EJECT                                                          86360002
LSTWORK  DSECT                                                          86500002
         SPACE                                                          86550002
*********************************************************************** 86600002
*                                                                     * 86650002
*  ---NOTICE---                                                       * 86700002
*                                                                     * 86750002
***** THERE IS A DUPLICATE OF THIS DSECT IN IKJEGLSA AND ANY CHANGES ** 86800002
*****  TO THE DSECT MUST BE MADE IN BOTH MODULES.                    ** 86850002
*                                                                     * 86900002
*  THIS DSECT MAPS A SECTION OF THE COMMON WORKING CORE POINTED TO    * 86950002
*  BY 'WORKAREA' IN TCOMTAB.                                          * 87000002
*                                                                     * 87050002
*********************************************************************** 87100002
         SPACE                                                          87150002
DWORK    DS    D                   DOUBLE WORD WORKAREA                 87200002
         ORG   DWORK               USE WORK AREA FOR XCTL LIST          87250002
LXCTL1   DS    2A                  PROBLEM PROG PARAMETER LIST          87300002
PARSEPL  DS    7F                  PARSE CALLING PARAMETER LIST.        87350002
         ORG   PARSEPL             REUSE CORE USED BY PARSE PARM LIST   87400002
LSTRPT   DS    0H                  START OF SECTION REUSED FOR ADDR LST 87450002
APDE     DS    9F                  WORKING COPY OF THE ADDRESS PDE      87500002
A1       DS    A                   CONTAINS CURRENT ADDR OF INPUT       87550002
A1LMATTR DS    F                   LENGTH AND MULTIPLICITY FACTORS      87600002
         ORG   A1LMATTR            PLACE LNTH AND MULTI IN ONE FULLWORD 87650002
A1L      DS    H                   LENGTH                               87700002
A1M      DS    H                   MULTPLICITY FACTOR                   87750002
A1FLG    DS    X                   FLAG BYTE FOR ADDR1 INFORMATION      87800002
A1FPD    EQU   X'80'               FLOATING PT DBL                      87850002
A1FPE    EQU   X'40'               FLOATING PT SINGLE                   87900002
A1GEN    EQU   X'20'               GENERAL REG                          87950002
A1REG    EQU   X'10'               ADDRESS 1 IS A REG.                  88000002
         SPACE                                                          88050002
A1ABS    EQU   X'00'               ADDR IS ABSOLUTE                     88100002
A1SYM    EQU   X'03'               ADDR IS SYMBOLIC                     88150002
A1REL    EQU   X'01'               ADDR IS RELATIVE                     88200002
         SPACE                                                          88250002
A1TYPE   DS    X                   CONTAINS TYPE CODE FOR ADDR1         88300002
REMAIN   DS    H                   REMAINDER                            88350002
A2       DS    A                   SECOND ADDR IF A RANGE WAS GIVEN     88400002
ARTIFMUL DS    H                   VALUE OF ARTIFICIAL MULTIPLICITY     88450002
DATAINCR EQU   ARTIFMUL            NAME OF FIELD USED IN LIST REGS      88500002
REMAIN2  DS    H                   BACKUP COPY OF REMAINDER             88550002
REGSTART DS    F                   START ADDR OF REG SAVE AREA TO LIST  88600002
LSTRETCD DS    F                   HOLDS RETURN CODE                    88650002
LASTLEN  DS    H                   CONTAINS REMAINDER FROM LSTLMTCK     88700002
COMFLGS  DS    X                   FLAG BYTES FOR PROCESS CONTROL       88750002
TWOADDRS EQU   X'80'               1 INDICATE ADDR RANGE                88800002
ARTIMSW  EQU   X'40'               1 INDICATE CONTROL IS ARTIFICIAL     88850002
NOINDENT EQU   X'20'               1 INDICATES DATA NOT TO BE INDENTED  88900002
SECOND   EQU   X'10'               1 INDICATES PROCESSING 2ND GROUP     88950002
WRAPSW   EQU   X'08'               1 INDICATES 2ND REG LOWER THAN 1ST   89000002
PARSEFLG EQU   X'04'               SW SHOWS IO REQUESTED BY PARSE EXIT  89050002
OUTCORE  EQU   X'02'               REQUEST EXTENDS OUT OF CORE          89100002
DATASIZE EQU   X'01'               SYMBOLIC FOR NUMBER OF HEX FLDS/GRP  89150002
         SPACE                                                          89200002
*  THE FOLLOWING FIELDS DEFINE A VALUE PDE FOR CONVERTING DATA.         89250002
VPDE     DS    0F                  VALUE PDE FOR CONVERTING DATA        89300002
VPDEPT   DS    A                   PTR TO DATA                          89350002
VPDEL    DS    H                   LENGTH OF DATA FOR CONVERSION        89400002
VPDEFLG  DS    X                   FLAGS                                89450002
VPDET    DS    X                   HEX TYPE CODE FOR VALUE.             89500002
         SPACE                                                          89550002
RPTSIZE  EQU   *-LSTRPT            LNTH OF REUSED SECTION.              89600002
LMATTR   DS    F                   LENGTH AND MULTIPLICITY FACTOR FLD'S 89650002
         ORG   LMATTR              PLACE LNTH AND MULTI IN ONE FULLWORD 89700002
BINLEN   DS    H                   CONVERTED LENGTH GIVEN BY USER       89750002
BINMUL   DS    H                   CONVERTED MLTPLCTY GIVEN BY USER     89800002
LXCTL    XCTL  ,SF=L               RESERVE SPACE FOR LIST FORM OF XCTL  89850002
ENDOBUF  DS    A                   CONTAINS MAX BUF ADDR + 1            89900002
ENDOGRP  DS    A                   CONTAINS GROUP STOP ADDRESS          89950002
DATAPR   DS    2F                  MSG PTR LIST FOR IKJEGIO1            90000002
         SPACE                                                          90050002
TYPESAVE DS    X                   CONTAINS SPECIFIED OR DEFAULTED TYPE 90100002
RETRYSAV DS    AL3                 CONTAINS MAINLINES STAE RETRY ADDR   90150002
LSTFLGS  DS    X                   FLAG BYTES TO SAVE PARSE DATA        90200002
TYPEFLG  EQU   B'10000000'         SET TO ONE IF TYPE KEYWORD USED      90250002
LNTHFLG  EQU   B'01000000'         SET TO ONE IF LENGTH KEYWORD USED    90300002
MULTIFLG EQU   B'00100000'         SET TO ONE IF MULTIPLICITY GIVEN     90350002
         SPACE                                                          90400002
         DS    X                   SPILL BYTE FOR HOLDAREA  ON ODD ADDR 90450002
         DS    0D                  ALIGN HOLDAREA                       90500002
HOLDAREA DS    XL32                HOLDS DATA BEING CONVERTED CURRENTLY 90550002
WKWORDS  DS    3F                  3 FWDS-SVC97 DYNAMIC WK AREA         90560002
*                                  WHEN CALLED                          90570002
STAELIST STAE  MF=L                                                     90600002
         SPACE                                                          90650002
LWLNTH   EQU   *-LSTWORK           LENGTH OF DSECT                      90700002
         EJECT                                                          90750002
         EJECT                                                          96250002
         TCOMTAB                                                        96300002
         SPACE 3                                                        96350002
         IKJPARMA                                                       96400002
APL      EQU   PDECHAIN-IKJPARMA   SYMBOLIC LENGTH OF AN ADDRESS PDE    96450002
         SPACE 3                                                        96500002
         TSTCWORK                                                       96550002
         EJECT                                                          96600002
         BRKELEM                                                        96650002
         SPACE 3                                                        96700002
         IKJPPL                                                         96750002
         EJECT                                                          96800002
CVTDSECT DSECT                                                          96850002
         CVT                                                            96900002
         EJECT                                                          96950002
         IKJTCB                                                         97000002
         END                                                            97050002
./  ADD  SSI=52880406,NAME=IKJEGMAP
MAP      TITLE 'IKJEGMAP, LISTMAP FUNCTION OF TEST COMMAND'             00202002
         COPY  IKJEGSIO                                                 00210002
         EJECT                                                          00220002
IKJEGMAP CSECT                                                          00260002
*C187500                                                    @YM07131    00310002
*C256500                                                    @ZA00816    00370000
*C258000                                                    @ZA00816    00430000
*C190500                                                   @ZA04819     00440000
*A208100-208300                                               @ZA06657  00450000
*C199000                                                      @ZA06657  00460000
*********************************************************************   00500002
* STATUS   CHANGE LEVEL 00, VERSION NUMBER 02, OS/VS2  (05/17/73)   *   00550002
*                                                                   *   00600002
* FUNCTION/OPERATION                                                *   00650002
*    THE TASK OF THIS COMMAND IS TO DISPLAY A COMPLETE STORAGE MAP  *   00700002
*    OF THE REGION IN WHICH THE USER'S PROGRAM IS BEING TESTED.     *   00750002
*    THE MAP SHOWS THE LOCATION AND EXTENT OF EACH PROGRAM IN THE   *   00800002
*    REGION, AND THE LOCATION AND EXTENT OF EACH AREA OF GOTTEN     *   00850002
*    STORAGE BY TASK FOR EACH TASK BELOW THE TEST TASK.             *   00900002
*                                                                   *   00950002
* ENTRY POINTS                                                      *   01000002
*         IKJEGMAP-ENTERED AS A RESULT OF A LINK FROM IKJEGMNL      *   01050002
*                                                                   *   01100002
* INPUT                                                             *   01150002
*    ONE LINE OF INPUT FROM THE TERMINAL CONTAINING THE COMMAND     *   01200002
*    PARAMETERS.                                                    *   01250002
*                                                                   *   01300002
* OUTPUT                                                            *   01350002
*    LINES OF OUTPUT TO THE TERMINAL OR SPECIFIED DATA SET CONTAIN  *   01400002
*    THE FOLLOWING DATA.                                            *   01450002
*    1.   EXTENT OF THE REGION IN WHICH THE PROGRAM IS RUNNING.     *   01500002
*    2.   NAME AND EXTENTS OF PROGRAMS ON JOB PACK Q.               *   01550002
*    3.   DISPLAY THE ELEMENTS OF GOTTEN STORAGE FOR EACH SUBPOOL   *   01600002
*    *    OF EACH TASK RUNNING IN THE SAME REGION AS TEST.          *   01650002
*                                                                   *   01700002
* EXTERNAL REFERENCES                                               *   01750002
*         IKJPARS  - TO SCAN THE INPUT BUFFER FOR PRINT KEYWORD.    *   01800002
*         IKJEGIO  - TO OUTPUT DATA TO TERMINAL OR DATA SET         *   01850002
*                                                                   *   01900002
* EXITS,NORMAL                                                      *   01950002
*         IKJEGMNL-RETURN VIA REGISTER 14 WITH ONE OF THE FOLLOWING *   02000002
*    RETURN CODES-                                                  *   02050002
*    0  - NORMAL RETURN                                             *   02100002
*    16 - INDICATING AN ATTENTION INTERRUPT WAS ENCOUNTERED         *   02150002
*                                                                   *   02200002
* EXITS,ERROR                                                       *   02250002
*         IKJEGMNL-VIA REGISTER 14 WITH REGISTER 15 CONTAINING      *   02300002
*    A RETURN CODE OF 20 TO INDICATE THE STAE RETRY ROUTINE WAS     *   02350002
*    ENTERED, AND RETURN CODE OF 24 INDICATING UNABLE TO ISSUE      *   02400002
*    THE ESTAE FOR IKJEGMAP.                                        *   02420002
*                                                                   *   02450002
* TABLES/WORK AREAS                                                 *   02500002
*    TCOMTAB-DSECT CONTAINING THE ADDRESS OF THE OUTPUT BUFFER, THE *   02550002
*    COMMAND BUFFER, AND LISTMAP'S SAVEAREA.                        *   02600002
*                                                                   *   02650002
* ATTRIBUTES                                                        *   02700002
*    REENTRANT AND REFRESHABLE                                      *   02750002
*                                                                   *   02800002
* CHARACTER CODE DEPENDENCY                                         *   02850002
*    THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL          *   02900002
*    REPRESENTATION OF THE EXTERNAL CHARACTER SET WHICH IS          *   02950002
*    EQUIVALENT TO THE ONE USED AT ASSEMBLY TIME.  THE CODING HAS   *   03000002
*    BEEN ARRANGED SO THAT REDEFINITION OF CHARACTER CONSTANTS, BY  *   03050002
*    REASSEMBLY, WILL RESULT IN A CORRECT MODULE FOR THE NEW        *   03100002
*    DEFINITION.                                                    *   03150002
*                                                                   *   03200002
* NOTES                                                             *   03250002
*    ALL LABELS ARE NUMBERED IN SEQUENTIAL FASHION FOR QUICKER      *   03300002
*    IDENTIFICATION.                                                *   03350002
*    COMMENTS ON STAEMENTS BEGIN IN COLUMN 30.                      *   03400002
*    RETRY IS THE ENTRY POINT FOR THE STAE RETRY ROUTINE.  THIS     *   03450002
*    ROUTINE IS ENTERED FROM IKJEGSTA.                              *   03500002
*********************************************************************   03550002
         EJECT                                                          03600002
***********************************************************             03650002
*                                                         *             03700002
*             THIS SECTION CONTAINS ALL EQUATES           *             03750002
*                                                         *             03800002
***********************************************************             03850002
R0       EQU   0             REGISTER 0                                 03900002
R1       EQU   1             REGISTER 1                                 03950002
R2       EQU   2             REGISTER 2                                 04000002
R3       EQU   3             REGISTER 3                                 04050002
R4       EQU   4             REGISTER 4                                 04100002
R5       EQU   5             REGISTER 5                                 04150002
R6       EQU   6             REGISTER 6                                 04200002
R7       EQU   7             REGISTER 7                                 04250002
R8       EQU   8             REGISTER 8                                 04300002
R9       EQU   9             TCOMTAB BASE                               04350002
R10      EQU   10            REGISTER 10                                04400002
R11      EQU   11            REGISTER 11                                04450002
R12      EQU   12            BASE REGISTER                              04500002
R13      EQU   13            REGISTER 13                                04550002
R14      EQU   14            REGISTER 14                                04600002
R15      EQU   15            REGISTER 15                                04650002
N12      EQU   12            LENGTH OR DISPLACEMTN OF 12                04700002
N9       EQU   9             LENGTH OR DISPLACEMENT OF 9                04750002
N112     EQU   112           LENGTH OR DISPLACEMENT OF 112              04800002
N17      EQU   17            LENGTH OR DISPLACEMENT OF 17               04850002
N16      EQU   16            LENGTH OR DISPLACEMENT OF 16               04900002
N0       EQU   0             LENGTH OR DISPLACEMENT OF 0                04950002
N8       EQU   8             LENGTH OR DISPLACEMENT OF 8                05000002
N4       EQU   4             LENGTH OF DISPLACEMENT OF 4                05050002
N24      EQU   24            LENGTH OR DISPLACEMENT OF 24               05100002
N20      EQU   20            LENGTH OR DISPLACEMENT OF 20               05150002
N80      EQU   80            LENGTH OR DISPLACEMENT OF 80               05200002
N33      EQU   33            LENGTH OR DISPLACEMENT OF 33               05250002
N1       EQU   1             LENGTH OR DISPLACEMENT OF 1                05300002
FOUR     EQU   4             NUMBER OF BITS TO SHIFT TO CONVERT TO HEX  05350002
N13      EQU   13            LENGTH OR DISPLACEMENT OF 13               05400002
F0       EQU   X'F0'         USED TO CONVERT TO HEXADECIMAL             05450002
B7       EQU   X'B7'         USED TO CONVERT TO HEXADECIMAL             05500002
HEX01    EQU   X'01'         USED TO TEST FOR KEYWORD                   05550002
HEX04    EQU   X'04'         USED TO TEST FOR AN ALIAS                  05600002
HEXC0    EQU   X'C0'         INDICATES PRB                              05650002
HEX40    EQU   X'40'         INDICATES LAST SPQE                        05700002
HEX80    EQU   X'80'         INDICATES SHARED SUBPOOL                   05750002
N6       EQU   6             LENGTH OR DISPLACEMENT OF 6                05800002
N10      EQU   10            LENGTH OR DISPLACEMENT OF 10               05850002
N27      EQU   27            LENGTH OR DISPLACEMENT OF 27               05900002
HEXFF    EQU   X'FF'         USED TO SET PRINT SW                       05950002
N2       EQU   2             LENGTH OR DISPLACEMENT OF 2                06000002
N3       EQU   3             LENGTH OR DISPLACEMENT OF 3                06050002
N19      EQU   19            LENGTH OR DISPLACEMENT OF 19               06100002
LLFINIS  EQU   B'00000100'   USED TO TURN ON LOAD LIST SW DONE          06150002
N41      EQU   41            LENGTH OR DISPLACEMENT OF 41               06200002
N31      EQU   31            LENGTH OR DISPLACEMENT OF 31               06250002
N32      EQU   32            LENGTH OR DISPLACEMENT OF 32               06300002
N22      EQU   22            LENGTH OR DISPLACEMENT OF 22               06350002
TTCBPKF  EQU   28            SW INDICATING TASK IS IN TEST REGION       06400002
TCBADR   EQU   4             ADDR OF CURRENT TCB                        06450002
N68      EQU   68            LENGTH OR DISPLACEMENT OF 68               06500002
MYBASE   EQU   68            REGISTER 12 IN SAVEAREA                    06550002
SVC61    EQU   61            TEST SVC NUMBER                            06600002
SVC97    EQU   97            TEST SVC NUMBER                            06650002
**********************************************************************  06660002
*        MESSAGE CONSTANTS                                              06662002
**********************************************************************  06670002
MSG050   EQU   50             MAP COMPLETE MESSAGE                      06680002
MSG103   EQU   103            NO CORE MESSAGE (NO SECOND LEVEL)         06682002
MSG104   EQU   104            LISTMAP FAILED----                        06690002
MSG277   EQU   277            PARSE RETURN CODE 12                      06692002
INST17   EQU   17             LISTMAP INSERT NO. (FIXED)                06694002
         EJECT                                                          06700002
         SAVE  (14,12),,*     REGISTERS ARE SAVED BY USING              06750002
*******************************************************                 06800002
** THE FOLLOWING INSTRUCTIONS DO-                    **                 06850002
**                                                   **                 06900002
**   1. ESTABLISH TCOMTAB (TEST COMMUNICATION TABLE) **                 06950002
**      ADDRESSABILITY BY THE USING STATEMENT.       **                 07000002
**   2. FOLLOWS STANDARD IBM LINKAGE CONVENTIONS BY  **                 07050002
**      FORWARD AND BACKWARD CHAIN SAVE AREAS AND    **                 07100002
**      PLACING THE ADDRESS OF MY SAVE AREA INTO R13.**                 07150002
*******************************************************                 07200002
         USING TCOMTAB,R9     ESTABLISH COMMUNICATION                   07250002
*                             REGION ADDRESSABILITY                     07300002
         LR    R12,R15        ESTABLISH A BASE REGISTER                 07350002
         USING IKJEGMAP,R12                                             07400002
         L     R4,REGSAVE2    PLACE ADDR OF MY SAVE AREA INTO REG 4     07450002
         ST    R4,N8(R13)     PLACE INTO CALLER'S SAVEAREA              07500002
*                             AS FORWARD POINTER                        07550002
         ST    R13,N4(N0,R4)  PLACE INTO MY SAVE AREA AS                07600002
*                             BACKWARD CHAIN                            07650002
         LR    R13,R4         PLACE ADDR OF MY SAVEAREA INTO REG 13     07700002
         STM   R14,R12,N12(R13)   SAVE OUR REGISTERS IN SAVEAREA        07750002
         L     R2,WORKAREA    PLACE POINTER TO WORKAREA INTO REG 2      07950002
         USING TSTCWORK,R2    ESTABLISH ADDRESSABILITY TO IT            08000002
         LA    R1,CWORKCMD    SKIP OVER IKJEGCVT'S WORKAREA             08050002
         DROP  R2             DROP ADDRESSABILITY TO ENTIRE WORKAREA    08100002
         XC    N0(N16,R1),N0(R1)  CLEAR THE ESTAE WORKAREA              08150002
         LR    R2,R1          R2= ADDR OF CWORKCMD                      08200002
         ST    R12,N68(R13)   PLACE MY ENTRY POINT INTO MY SAVEAREA     08300002
         L     R3,TSTSTAE     R3= ADDR OF IKJEGSTA                      08310002
         ESTAE (R3),CT,PARAM=MAPSPL,RECORD=YES,MF=(E,(R2))              08350002
         LTR   R15,R15        TEST RETURN CODE FROM STAE                08400002
SMTSTAE  DS    0H             SMT LABEL FOR TEST CASE TMAP1800          08450002
         BZ    A0020          IF ALL OK CONTINUE                        08500002
         STC   R15,TSTESTRC   SAVE THE RETRUN CODE FOR MNL              08510002
         LA    R15,N24        R15= 24 ESTAE MACRO FAILURE               08520002
         B     A00412         EXIT TO MNL                               08530002
************************************************************            08800002
** PROGRAM ADDRESSABILITY IS ESTABLISHED USING REG 12     **            08850002
** AS A BASE REG. SINCE IKJPARS WILL BE USED FOR KEYWORD  **            08900002
** CHECKING, THE ADDRESS OF A WORKAREA IS OBTAINED FROM   **            08950002
** TCOMTAB AND PLACED INTO REG 5. THE UPT, ECT, AND CPECB **            09000002
** POINTERS ARE OBTAINED FROM TCOMTAB AND ARE MOVED INTO  **            09050002
** THE PARAMETER LIST FOR IKJPARS LOCATED IN THE WORKAREA.**            09100002
** THE PCL (PARAMETER CONTROL ENTRIES) IS ALSO  PLACED    **            09150002
** INTO THE PARAMETER LIST. THE PROGRAM THEN LINKS TO     **            09200002
** IKJPARS.                                               **            09250002
************************************************************            09300002
A0020    DS    0H                                                       09350002
         TM    TSTFLGS3,NOPARMS   SEE IF PRINT KEYWORD WAS ENTERED      09400002
         BO    A0030         IF IT WAS NOT THEN GO TO BEGIN PROCESSING  09450002
         L     R4,WORKAREA   OBTAIN ADDR OF WORKAREA FROM TCOMTAB       09500002
         USING TSTCWORK,R4   ESTABLISH ADDRESSABILITY TO IT             09550002
         LA    R5,CWORKCMD   SKIP OVER IKJEGCVT'S WORKAREA              09600002
         USING PPL,R5        ESTABLISH ADDRESSABILITY TO PARSE          09650002
*                            PARAMETER LIST                             09700002
         DROP  R4            DROP ADDRESSABILITY TO ENTIRE              09750002
*                            WORKAREA                                   09800002
         MVC   PPLUPT(N12),PARMLIST  MOVE UPT, ECT, ECB TO PARSE        09810002
         MVC   PPLPCL(N4),PARSEFLD PUT ADDR PCL INTO PARAMETER LIST     10000002
         LA    R4,TSTANSPL   GET ADDRESS OF ANSWER PLACE                10050002
         ST    R4,PPLANS     PUT IT INTO PARAMETER LIST FOR IKJPARS     10100002
         MVC   PPLCBUF(N4),INBUF  PUT ADDR OF COMMAND BUFFER INTO LIST  10150002
         LR    R1,R5         REG 1 POINTS TO PARAMETER LIST             10200002
         LINK  EP=IKJPARS,ERRET=LINKFAIL  LINK TO PARSE TO              10250002
BLOWUP1  DS    0H             LABEL USED BY STAE RETRY ROUTINE          10300002
SMTPARS  DS    0H            SMT LABEL FOR TEST CASE TMAP1800           10350002
         L     R8,PARSERC(R15) PLACE CORRECT ADCON INTO REG 8           10400002
         BR    R8            BRANCH TO PROPER HANDLER                   10450002
A0025    DS    0H             EQUATE LABEL TO THIS ADDRESS              10500002
************************************************************            10550002
** ON RETURN FROM IKJPARS, THE PARAMETER DESCRIPTOR LIST  **            10600002
** (PDL) IS TESTED TO SEE IF THE PRINT KEYWORD HAD BEEN   **            10650002
** SPECIFIED.  A RETURN OF ZERO INDICATES THAT IT WAS NOT.**            10700002
** IF IT HAS BEEN SPECIFIED THE PRINT SWITCH IS SET IN    **            10750002
** TCOMTAB FOR USE BY IKJEGIO.(I/O ROUTINE)               **            10800002
************************************************************            10850002
         L     R2,TSTANSPL   PLACE ADDRESS OF PDE INTO REG 2            10900002
         USING IKJPARMD,R2   USE REG 2 TO ADDRESS PDE DSECT             10950002
         TM    PRINT+N1,HEX01 TEST TO SEE IF KEYWORD WAS ENTERED        11000002
         BNO   A0030         IF NOT SPECIFIED WE PRINT TO TERMINAL      11050002
         OI    TSTFLGS1,TSTPRINT TURN ON PRINT SW IN TCOMTAB            11100002
         LA    R0,DSN        PLACE POINTER TO DSNAME PDE IN REG 0       11150002
A0030    DS    0H                                                       11200002
         L     R4,TSTTCB     OBTAIN TCB ADDRESS OF TEST'S TCB           11250002
         USING TCB,R4        USE TCB DSECT FOR ADDRESSING               11300002
         L     R5,TCBPQE     PLACE DUMMY PQE ADDRESS IN REG 5           11350002
************************************************************            11400002
** TEST TCB ADDRESS IS OBTAINED FROM TCOMTAB. FROM THE    **            11450002
** TCB THE PQE ADDRESS IS OBTAINED. 8 BYTES ARE ADDED TO  **            11500002
** THE PQE TO OBTAIN THE CORRECT ADDRESS. THE PQE IS USED **            11550002
** TO OBTAIN THE REGION SIZE WHICH IS PRINTED OUT TO THE  **            11600002
** TERMINAL. FROM THE TCB THE ADDRESS OF THE CONTENTS     **            11650002
** DIRECTORY QUEUE IS OBTAINED. THE PROGRAM NAME IS       **            11700002
** OBTAINED FROM THE CDE AND PRINTED OUT. THE EXTENT      **            11750002
** ADDRESS IS GOTTEN FROM THE CDE AND USED TO OBTAIN CSECT**            11800002
** INFORMATION. ALL CSECT INFO IS PRINTED OUT. TEST ARE   **            11850002
** MADE TO DETERMINE WHEN THE EXTENT IS EMPTY.            **            11900002
** IF THERE ARE ANY MORE CDES THEY ARE ACCESSED ALSO      **            11950002
** OTHERWISE CONTINUE ON                                  **            12000002
************************************************************            12050002
         LA    R6,N8         BECAUSE  DUMMY PQE ADDRESS IS              12100002
         AR    R5,R6         MINUS 8 BYTES, ADD 8 BYTES TO              12150002
*                            PQE ADDRESS                                12200002
         L     R6,N0(R5)     LOAD FIRST PQE'S ADDRESS INTO              12250002
*                            REG 6                                      12300002
         USING PQESECT,R6    USE PQE DSECT FOR ADDRESSING               12350002
         L     R10,PQESIZE   PLACE REGION SIZE FROM PQE INTO REG 10     12400002
         BAL   R14,A3000     BRANCH TO HAVE CONVERT CHANGE IT           12450002
*                            TO PRINTABLE HEX                           12500002
         MVC   N24(N8,R1),N0(R2) MOVE REGION SIZE TO OUTPUT             12550002
         LA    R2,HDR001     PLACE ADDRESS OF SIZE HDR IN REG 2         12600002
         MVC   N8(N16,R1),N0(R2) MOVE HDR TO OUTPUT AREA                12650002
         BAL   R14,A0100     BRANCH TO PRINT ROUTINE                    12700002
         DROP  R4            DROP REG 4 FOR ADDR TCB DSECT              12750002
         USING TCB,R5        USE REG 5 TO ADDRESS TCB DSECT             12800002
         BAL   R14,CLEARALL  BRANCH TO CLEAR OUT OUTPUT AREA            12850002
***********************************************************             12900002
** THE CVT IS ACCESSED TO OBTAIN THE ADDRESS OF THE TCB  **             12950002
** QUEUE. THIS QUEUE IS FOLLOWED TO ITS END.  THE        **             13000002
** PARENT'S TASK ADDRESS OF EACH TCB IS COMPARED AGAINST **             13050002
** TEST'S TCB ADDRESS.  IF THEY COMPARE EQUAL THE TASK   **             13100002
** IS THEN PROCESSED PUTTING OUT ALL PROGRAMS UNDER THE  **             13150002
** LOAD LIST AND RB CHAINS PLUS ALL SUBPOOL INFORMATION. **             13200002
***********************************************************             13250002
         L     R6,TSTTCB     PLACE TEST TCB ADDR INTO REG 6             13300002
A00411   DS    0H             DAUGHTER                                  13350002
         L     R5,D(R6)      GET ADDR OF LAST DAUGHTER TASK             13400002
         LTR   R5,R5         IS THERE A DAUGHTER TASK                   13450002
         BNZ   IKJEGTSK      YES, START PROCESSING                      13500002
A00411A  DS    0H             SISTER                                    13550002
         L     R5,S(R6)      NO, GET ADDRESS OF NEXT SISTER TCB         13600002
         LTR   R5,R5         WAS THERE A SISTER                         13650002
         BNZ   IKJEGTSK      YES, START PROCESSING                      13700002
*        NOW WORK ON  MOTHER TCB                                        13750002
         L     R6,M(R6)      NO, GET ADDRESS OF MOTHER TASK             13800002
         LA    R6,N0(R6)     CLEAR HIGH ORDER BYTE                      13850002
         L     R5,TSTTCB     GET ADDRESS OF TEST TCB                    13900002
         LA    R5,N0(R5)     CLEAR HIGH ORDER BYTE                      13950002
         CR    R5,R6         DOES MOTHER TASK = TEST TASK               14000002
         BNE   A00411A       NO, GO CHECK FOR A SISTER TASK             14050002
         NI    TSTFLGS1,HEXFF-TSTPRINT TURN OFF PRINT SW IF IT IS ON    14100002
         LA    R2,MSG050     PLACE POINTER TO COMPLETED MSG IN REG 2    14150002
         BAL   R14,A0200     GO TO PUT MSG OUT TO TERMINAL              14200002
         B     A004123       RETURN TO IKJEGMNL                         14250002
RETCODE  DS    0H                                                       14300002
         B     A004123       RETURN TO IKJEGMNL WITH A 0                14350002
         B     A004123       RETURN TO IKJEGMNL WITH A 0                14400002
         B     A004123       RETURN TO IKJEGMNL WITH A 0                14450002
         B     A004123       RETURN TO IKJEGMNL WITH A 0                14500002
         B     A00412        RETURN TO IKJEGMNL WITH A 16               14550002
         B     A00412        RETURN TO IKJEGMNL WITH A 20               14600002
         B     A00412        RETURN TO IKJEGMNL WITH A 24               14610002
NOROOM   DS    0H              EQUATE LABEL TO THIS ADDRESS             14630002
         LA    R2,MSG103      R15= RETURN CODE 24 TO MNL                14640002
         B     A0200          BRANCH TO RETURN                          14642002
A004121  DS    0H                                                       14650002
         LA    R15,N16       INDICATE ATTENTION INTERRUPT               14700002
         B     A00412        RETURN TO IKJEGMNL                         14750002
A004122  DS    0H                                                       14800002
         LA    R15,N20       INDICATE STAE EXIT TAKEN                   14850002
         B     A00412        RETURN TO IKJEGMNL                         14900002
A004123A DS    0H                                                       14950002
         OI    TSTFLGS4,TSTFLUSH INDICATE TO IKJEGMNL TO FLUSH STACK    15000002
A004123  DS    0H                                                       15050002
         XR    R15,R15       NORMAL RETURN CODE TO IKJEGMNL             15100002
A00412   DS    0H             EQUATE LABEL TO THIS ADDRESS              15150002
*-*-*    ISSUE ESTAE 0 AND TURN OFF TSTRERTN SWITCH                     15160002
         LR    R2,R15        SAVE THE RETURN CODE                       15162002
         ESTAE 0             REMOVE THE ESTAE                           15170002
         NI    TSTFLGS4,HEXFF-TSTRERTN  TURN OFF RETRY SWITCH           15180002
         LR    R15,R2        RESTORE THE RETURN CODE                    15190002
         L     R13,N4(R13)   PLACE CALLERS SAVE AREA ADDR INTO REG 13   15200002
         RETURN (14,12),RC=(15)    RETURN TO IKJEGMNL                   15250002
IKJEGTSK EQU  *              EQUATE LABEL TO THIS ADDRESS               15300002
         LR    R10,R5        PLACE TCB ADDR TO BE CVTED IN REG 10       15350002
         BAL   R14,A3000     BRANCH TO CVT TO PRINT HEX                 15400002
         MVC   N27(N6,R1),N2(R2) MOVE CVTED TCB ADDR TO OUTPUT          15450002
         LA    R2,HDR005     PLACE 'UNDER TCB' HDR IN REG 2             15500002
         MVC   N8(N19,R1),N0(R2) MOVE HDR TO OUTPUT AREA                15550002
         BAL   R14,A0100     BRANCH TO PUT HDR OUT TO TERMINAL          15600002
         BAL   R14,CLEARALL  BRANCH TO CLEAR OUT OUTPUT AREA            15650002
         EJECT                                                          15660002
**********************************************************************  15700002
** BECAUSE IKJEGMAP IS DEPENDENT UPON THE CONTENTS OF THE VARIOUS   **  15750002
** CONTROL BLOCKS - THE LLES, THE CDES ETC - THE FOLLOWING CHECKS   **  15800002
** HAVE BEEN PUT IN TO AVOID PROGRAM CHECKS.  IF THE TASK IKJEGMAP  **  15850002
** IS TRYING TO PROCESS IS ACTIVE THE CONTENTS OF THESE CONTROL     **  15900002
** CONTROL BLOCKS MAY BE CHANGING WHILE IKJEGMAP IS PROCESSING. IE. **  15950002
** ABEND MAY BE ACTIVE FOR THIS TASK AND COULD BE FREEING UP THESE  **  16000002
** CONTROL BLOCKS.  WHEN IKJEGMAP IS GIVEN CONTROL, IKJEGMNL HAS    **  16050002
** ISSUED A STATUS SYNCH ON ALL TASKS IN THE TEST REGION.           **  16100002
** THIS WILL STOP ALL TASKS THE TCBSTPP FLAG OF THE TCB IS ON       **  16150002
** IF THE TASK WAS STOPPED BY THE ISSUANCE OF A STATUS STOP.  WHEN  **  16250002
** A TASK HAS TERMINATED THE LLES, CDES, ETC HAVE BEEN REMOVED SO   **  16300002
** IKJEGMAP WILL CONTINUE ON TO PROCESS THE NEXT TASK.  IF THE SVRB **  16350002
** IS A TEST SVC (IE. SVC 61 OR 97) THEN THE TASK IS IN A WAIT STATE**  16400002
** AND IKJEGMAP WILL PROCESS THE TASK.                              **  16450002
**********************************************************************  16500002
         TM    TCBNDSP2,TCBSTPP  STATUS STOP ISSUED AGAINST THIS        16550002
*                            TASK                                       16600002
         BO    A0031C        YES, PROCESS THIS TASK                     16650002
         TM    TCBFLGS5,TCBFC    NO, HAS THIS TASK TERMINATED           16700002
         BZ    A0031A        NO, CHECK FOR A SVRB OFF OF THE TCB        16750002
         LA    R3,HDR007      YES, PREPARE TO WRITE OUT MESSAGE         16800002
         BAL   R14,PUTMSG    PUT MESSAGE OUT                            16900002
         LR    R6,R5         FIND NEXT TCB UNDER TEST                   16950002
         B     A00411        GO GET NEXT TASK                           17000002
A0031A   DS    0H                                                       17050002
         L     R7,TCBRBP     OBTAIN ADDRESS OF SVRB                     17100002
         LA    R3,RBSECT-RBPREFIX  LENGTH OF PREFIX                     17160002
         SR    R7,R3          ADDRESS OF BEGINNING OF PREFIX            17170002
         USING RBPREFIX,R7    MAKE RBPREFIX ADDRESSABLE                 17180002
         CLI   RBINTCOD+N1,SVC61   IS THIS ONE OF THE TEST SVCS WAITING 17200002
         BE    A0031C        YES, PROCESS THIS TASK                     17250002
         CLI   RBINTCOD+N1,SVC97   NO, TEST FOR OTHER TEST SVC          17300002
         BE    A0031C        YES, PROCESS THIS TASK                     17350002
         LA    R3,HDR008     NO, ASSUME TASK IS ACTIVE AND              17400002
         BAL   R14,PUTMSG    GO PUT OUT MESSAGE                         17450002
         LR    R6,R5         FIND NEXT TCB UNDER TEST                   17500002
         B     A00411        GO GET NEXT TASK                           17550002
A0031C   DS    0H                                                       17600002
         USING LLE,R7        USE REG 7 TO ADDR LOAD LIST                17650002
         L     R7,TCBLLS     PLACE ADDRESS OF LOAD LIST INTO REG 7      17700002
         LA    R3,HDR002     PLACE HEADER INTO REG 1                    17750002
         BAL   R14,PUTMSG    BRANCH TO PUT HDR OUT TO TERMINAL          17800002
A0031    DS    0H             EQUATE LABEL TO THIS ADDRESS              17850002
         LA    R7,N0(R7)     ZERO OUT HIGH ORDER DATA                   17900002
         LTR   R7,R7         SEE IF ANY MORE LOAD LIST ELEMENTS EXIST   17950002
         BNZ   A00301        IF MORE EXIST THEN GO PROCESS MORE CDE     18000002
         OI    TSTFLGS2,LLFINIS OTHERWISE TURN ON LOAD LIST DONE SW     18050002
         B     A0038         AND GO TO PROCESS RB QUEUE                 18100002
GETCDE   DS    0H             EQUATE LABEL TO THIS ADDRESS              18150002
         USING CDENTRY,R8    USE REG 8 TO ADDRESS CDE WITH              18200002
         L     R8,CDXLMJP    PLACE ADDRESS OF NEXT CDE INTO REG 8       18250002
         LA    R8,N0(R8)      ZERO THE HIGH ORDER BYTE OF R8            18300002
         B     A00312        GO CHECK THIS BEING A MINOR CDE            18350002
A00301   DS    0H             EQUATE LABEL TO THIS ADDRESS              18400002
         L     R8,LLECDPT    PLACE ADDRESS OF CDE INTO REG 8            18450002
************************************************************            18500002
**  PROGRAM NAME AS CONTAINED WITHIN THE CDE IS PLACED    **            18550002
**  IN THE OUTPUT AREA AND PASSED TO THE PRINTOUT ROUTINE **            18600002
************************************************************            18650002
A00312   DS    0H             EQUATE LABEL TO THIS ADDRESS              18700002
         TM    CDATTR,CDMIN  SEE IF THIS IS AN ALIAS           @YM07131 18750002
         BO    GETCDE        IF IT IS THEN GO TO GET MAJOR CDE          18800002
         L     R1,OUTBUF     PLACE POINTER TO OUTPUT IN REG 1           18850002
         USING XTLST,R6      USE REG 6 TO ADDRESS EXTENT Q              18900002
         MVC   N17(N8,R1),CDNAME   MOVE PROGRAM NAME FROM CDE           18950002
         L     R6,CDXLMJP    PLACE POINTER TO EXTENT IN REG 6           19000002
         L     R3,XTLNRFAC   NUMBER OF RELOCATION FACTORS      @ZA04819 19050000
         XR    R4,R4         ZERO OUT REG 4 FOR INDEX REG               19200002
A00311   DS    0H             EQUATE LABEL TO THIS ADDRESS              19250002
         LTR   R3,R3         SEE IF ANY CSECTS LEFT                     19300002
         BNH   A0035         IF NO MORE THAN BRANCH FOR NEXT CDE        19350002
         L     R10,XTLMSBAA(R4) OTHERWISE PLACE CSECT LOC IN REG 10     19400002
         BAL   R14,A3000     BRANCH TO HAVE THIS CONVERTED TO HEX       19450002
         MVC   N41(N6,R1),N2(R2) MOVE CONVERTED HEX TO OUTPUT           19500002
         L     R10,XTLMSBLA(R4) PLACE LENGTH OF CSECT IN REG 10         19550002
         LA    R10,N0(R10)   ZERO FLAG (80) HIGH ORDER BYTE             19560002
         BAL   R14,A3000     BRANCH TO CONVERT TO PRINT HEX             19600002
         MVC   N31(N6,R1),N2(R2) MOVE PRINTABLE TO OUTPUT               19650002
         MVC   N8(N4,R1),LNSIZE MOVE LENGTH OF LINE INTO OUTPUT         19700002
         BAL   R14,A0100     BRANCH TO PUT INFOR OUT TO TERM            19750002
         BAL   R14,CLEARALL  BRANCH TO CLEAR OUT OUTPUT AREA            19800002
         BCTR  R3,N0         DECREMENT REG 3 BY 1                       19850002
         LA    R4,N8(R4)     ADD 8 TO REG 4                    @ZA06657 19900000
         B     A00311        BRANCH TO PROCESS NEXT CSECT IF ANY        20000002
A0038    DS    0H             EQUATE LABEL TO THIS ADDRESS              20050002
         L     R7,TCBRBP     PLACE POINTER TO FIRST RB INTO REG 7       20100002
         USING RBSECT,R7     USE REG 7 TO ADDRESS RB                    20150002
         LA    R7,N0(R7)     ZERO OUT HIGH ORDER BYTE                   20200002
         LTR   R7,R7         DO WE HAVE A ZERO                          20250002
         BZ    A00413        BRANCH TO PROCESS REST OF RB               20300002
ALABEL   TM    RBSTAB1,RBFTSVRB SEE IF THIS IS AN PRB                   20350002
         BZ    A0037         YES, BRANCH                                20400002
A0036    DS    0H             EQUATE LABEL TO THIS ADDRESS              20450002
         L     R7,RBLINK     PLACE ADDR OF NEXT RB INTO REG 7           20500002
         LA    R7,N0(R7)     ZERO OUT ANY HIGH ORDER DATA               20550002
         CR    R7,R5         SEE IF WE ARE AT THE END OF THE CHAIN      20600002
         BE    A00413        BRANCH TO PROCESS NEXT TCB                 20650002
         B     ALABEL        CONTINUE TO END OF CHAIN                   20700002
A0037    DS    0H                                                       20750002
         L     R8,RBCDE      PLACE NEXT CDE INTO REG 8                  20800002
         LA    R8,0(R8)      ZERO HI BYTE                     @ZA06657  20810000
         LTR   R8,R8         IS THE CDE PTR ZERO ???          @ZA06657  20820000
         BZ    A0036         YES, GET NEXT RB                 @ZA06657  20830000
         B     A00312        BRANCH TO PROCESS THIS CDE                 20850002
A0035    EQU     *           EQUATE LABEL TO THIS ADDRESS               20900002
         TM    TSTFLGS2,LLFINIS SEE IF WE ARE IN THE LL CHAIN           20950002
         BO    A0036         IF WE ARE NOT THEN GO TO PROCESS RB QUEUE  21000002
         USING LLE,R7        USE REG 7 TO ADDRESS LOADLIST              21050002
         L     R7,LLECHN     GET ADDR OF NEXT LOAD LIST                 21100002
         B     A0031         BRANCH TO PROCESS THIS LOAD LIST           21150002
A00413   DS    0H                                                       21200002
         NI    TSTFLGS2,HEXFF-LLFINIS TURN OFF LOAD LIST FINIS SW       21250002
         L     R4,WORKAREA   PLACE WORKAREA ADDR INTO REG 4             21300002
         STM   R0,R15,N112(R4) SAVE ENTERING REGS                       21350002
         LR    R4,R5         SAVE TCB ADDR IN REG 4                     21400002
         LA    R3,HDR003     PLACE 'ACTIVE RB' HDR INTO REG 1           21450002
         BAL   R14,PUTMSG    BRANCH TO PUT HDR OUT                      21500002
         L     R7,TCBRBP     LOAD RB ADDRESS FROM TCB INTO REG 7        21550002
         USING RBSECT,R7     USE REG 7 TO ADDR THE RB DSECT             21600002
************************************************************            21650002
** THE RBS ARE ACCESSED,THE TYPE OF RB IS DETERMINED AND  **            21700002
** THE CDE CONNECTED WITH THE RB ACCESSED TO GET THE      **            21750002
** PROGRAM ID                                             **            21800002
************************************************************            21850002
         LA    R7,N0(R7)     ZERO OUT HIGH ORDER BYTE OF REG 7          21900002
         LTR   R7,R7         ARE THERE ANY RBS                          21950002
         BZ    A0050         IF NOT THEN BRANCH                         22000002
A0042    DS    0H                                                       22050002
         L     R8,RBCDE      LOAD CDE ADDR INTO REG 8                   22100002
         USING CDENTRY,R8    USE REG 8 TO ADDR THE CDE DSECT            22150002
         LA    R8,N0(R8)     ZERO OUT HIGH ORDER BYTE OF REG 8          22200002
         LTR   R8,R8         TEST THAT WE HAVE AN ADDRESS               22250002
         BZ    A0047         IF WE DO NOT THEN BRANCH                   22300002
         TM    RBSTAB1,HEXC0 TEST RB TYPE FOR PRB                       22350002
         BZ    A0043         IF A PRB THEN BRANCH                       22400002
         TM    RBSTAB1,RBFTIRB DO WE HAVE AN IRB                        22450002
         BO    A0044         IF A MATCH THEN BRANCH                     22500002
         TM    RBSTAB1,RBFTSIRB DO WE HAVE AN SIRB                      22550002
         BO    A0045         IF SO THEN BRANCH                          22600002
         LA    R4,N12        PLACE 12 INTO INDEX REG                    22650002
A0046    DS    0H             MAKE LABEL EQUAL TO THIS ADDR             22700002
         L     R1,OUTBUF     PLACE POINTER TO OUTPUT BUFFER INTO REG 1  22750002
         L     R3,TYPE(R4)   LOAD PROPER TYPE INTO REG 3                22800002
         ST    R3,N24(R1)    STORE IN OUTPUT AREA                       22850002
         TM    RBSTAB1,HEXC0 DO WE HAVE A SVC RB OR AN IRB              22900002
         BZ    A00461        IF NOT THEN BRANCH TO MOVE IN NAME         22950002
         MVC   N8(N4,R1),SIZERB2 MOVE IRB MSG SIZE INTO OUTPUT          23000002
         B     A00462        BRANCH TO PROCESS THIS IRB                 23050002
A00461   DS    0H             EQUATE LABEL TO THIS ADDR                 23100002
         MVC   N33(N8,R1),CDNAME   MOVE PROGRAM NAME INTO OUTPUT        23150002
         MVC   N8(N4,R1),SIZERB MOVE SIZE OF LINE TO OUTPUT             23200002
A00462   DS    0H             EQUATE LABEL TO THIS ADDRESS              23250002
         BAL   R14,A0100     BRANCH TO PUT INFOR OUT ROUTINE            23300002
         BAL   R14,CLEARALL  BRANCH TO CLEAR OUT OUTPUT AREA            23350002
A0047    DS    0H             EQUATE LABEL TO THIS ADDRESS              23400002
         L     R7,RBLINK     PLACE ADDR OF NEXT RB INTO REG 7           23450002
         LA    R7,N0(R7)     ZERO OUT ANY HIGH ORDER DATA               23500002
         CR    R5,R7         IS THIS THE LAST RB OF THE CHAIN           23550002
         BE    A0050         IF RBLINK POINTS BACK TO TCB THEN BRANCH   23600002
         B     A0042         BRANCH TO PROCESS THE NEXT RB              23650002
A0043    DS    0H             MAKE LABEL EQUAL TO THIS ADDR             23700002
         XR    R4,R4         ZERO OUT INDEX REG                         23750002
         B     A0046         BRANCH TO GENERALIZED ROUTINE              23800002
A0044    DS    0H             TO PLACE TYPE INTO OUTPUT AREA            23850002
         LA    R4,N4         PLACE A 4 INTO INDEX REGISTER              23900002
         B     A0046         BRANCH TO PUT TYPE INTO OUTPUT             23950002
A0045    DS    0H             MAKE LABEL EQUAL TO THIS ADDR             24000002
         LA    R4,N8         PLACE 8 IN INDEX REG                       24050002
         B     A0046         BRANCH TO PUT TYPE INTO OUTPUT             24100002
A0050    DS    0H             LET LABEL EQUAL THIS ADDRESS              24150002
         LA    R3,HDR004     PLACE SUBPOOL HDR INTO REG 1               24200002
         BAL   R14,PUTMSG    BRANCH TO PUT HDR OUT TO TERMINAL          24250002
         LA    R3,HDR006     PLACE SUBPOOL HEADER IN REG 1              24300002
         BAL   R14,PUTMSG    GO TO PUT HEADING OUT TO TERMINAL          24350002
         XR    R6,R6         ZERO OUT REG 6 FOR AN INDICATOR            24400002
         L     R4,TCBMSS     PLACE SPQE ADDRESS INTO REG 4              24450002
         USING SPQESECT,R4   USE REG 4 TO ADDRESS SPQE                  24500002
************************************************************            24550002
**  THE SPQE ADDRESS IS OBTAINED FROM THE TCB. FROM THE   **            24600002
**  SPQE THE DQE IS OBTAINED. THE DQE IS ASSOCIATED WITH  **            24650002
**  ONE OR MORE 2K BLOCKS OF MAIN STORAGE SET ASIDE AS A  **            24700002
**  RESULT OF GETMAIN MACRO INSTRUCTION. EACH DQE ALSO    **            24750002
**  CONTAINS POINTERS TO FQE (FREE QUEUE). THESE SUBPOOLS **            24800002
**  ARE PUT OUT TO THE TERMINAL IN THE FORM-BLOCKSIZE     **            24850002
**  AND BLOCK LOCATION                                    **            24900002
************************************************************            24950002
         L     R1,OUTBUF     PLACE POINTER TO OUTPUT IN REG 1           25000002
         LA    R4,N0(R4)     ZERO OUT HIGH ORDER BYTE OF REG 4          25050002
         LTR   R4,R4         ARE THERE ANY SPQES PRESENT                25100002
         BZ    A0060         IF NOT THEN BRANCH                         25150002
A00511   DS    0H             EQUATE LABEL TO THIS ADDRESS              25200002
         TM    SPQEFLGS,SPSHARE SEE IF THIS IS OWNED OR SHARED          25250002
         BO    A0054         IF SHARED THE 2 WORD IS THE SPQ ADDR       25300002
         L     R8,SPDQEPTR   GET ADDR OF DQE FROM SPQE                  25350002
         USING DQESECT,R8    USING DQEDSECT FOR ADDRESSING              25400002
A0052    DS    0H             TEST FOR MORE DQES                        25450002
         LA    R8,0(R8)      ZERO OUT HIGH ORDER BYTE OF REG 8          25500002
         LTR   R8,R8         ARE THERE MORE DQES                        25550002
         BZ    A0053         IF NO DQE THEN BRANCH                      25600002
         TM    SPQEID,HEX80  CHECK THE SUBPOOL NUMBER         @ZA00816  25650000
         BO    A0053         IF GREATER THAN 127 THEN BRANCH            25700002
         XR    R0,R0         CLEAR OUT REG 0                            25750002
         IC    R0,SPQEID     PLACE SUBPOOL NUMBER INTO REG 0  @ZA00816  25800000
         L     R5,WORKAREA   PLACE POINTER TO WORKAREA INTO REG 5       25850002
         CVD   R0,N0(R5)     PLACE DECIMAL NUMBER INTO WORKAREA         25900002
         MVC   N8(N4,R5),PATTERN MOVE EDIT PATTERN INTO WORKAREA        25950002
         ED    N8(N4,R5),N6(R5) EDIT PACKED FIELD IN WORKAREA           26000002
         MVC   N13(N3,R1),N9(R5) MOVE SUBPOOL NUMBER TO OUTPUT          26050002
         L     R10,DQELNTH   PLACE BLOCKSIZE INTO REG 10                26100002
         BAL   R14,A3000     BRANCH TO CONVERT TO PRINTABLE HEX         26150002
         MVC   N32(N6,R1),N2(R2) MOVE PRINTABLE QUANTITY TO OUTPUT      26200002
         L     R10,DQEBLKAD  LOAD BLOCK LOCATION INTO REG 10            26250002
         BAL   R14,A3000     BRANCH TO CONVERT TO PRINTABLE HEX         26300002
         MVC   N22(N6,R1),N2(R2) MOVE PRINTABLE TO OUTPUT               26350002
         MVC   N8(N4,R1),SIZESPQ  MOVE LENGTH OF LINE INTO OUTPUT       26400002
         XR    R0,R0         ZERO OUT REG 0 FOR IO MODULE               26450002
         BAL   R14,A0100     GO PUT OUT INFORMATION                     26500002
         BAL   R14,CLEARALL  BRANCH TO CLEAR OUT OUTPUT                 26550002
         L     R8,DQEPTR     LOAD NEXT DQE ADDR INTO REG 8              26600002
         B     A0052         RETURN TO PROCESS NEXT DQE.                26650002
A0053    DS    0H                                                       26700002
         LTR   R6,R6         DOES REG 6 HAVE A SPQ ADDR IN IT           26750002
         BZ    A0055         IF IT DOES NOT THEN BRANCH AROUND CODE     26800002
         LR    R4,R6         OTHERWISE PLACE SPQ ADDR INTO REG 4        26850002
         TM    SPQEFLGS,LASTSPQE SEE IF THIS IS THE LAST SPQ            26900002
         BO    A0060         IF IT IS THEN BRANCH TO CLEAN UP           26950002
         L     R4,N0(R4)     PLACE POINTER TO SPQ INTO REG 4            27000002
         XR    R6,R6         ZERO OUT REG 6 AS AN INDICATOR             27050002
         B     A00511        BRANCH TO PROCESS THIS SPQ                 27100002
A0055    DS    0H             EQUATE LABEL TO THIS ADDRESS              27150002
         TM    SPQEFLGS,LASTSPQE IS THIS THE LAST SPQ                   27200002
         BO    A0060         IF IT IS THEN BRANCH TO RETURN             27250002
         L     R4,SPQEAD     PLACE ADDRESS OF NEXT SPQE INTO REG 4      27300002
         B     A00511        BRANCH TO PROCESS NEXT SPQE                27350002
A0054    DS    0H             EQUATE LABEL TO THIS ADDRESS              27400002
         LR    R6,R4         PLACE NEXT SPQ ADDR IN REG 6               27450002
         L     R4,SPDQEPTR   PLACE 2ND WORD INTO REG 4                  27500002
         L     R8,SPDQEPTR   PLACE NEXT DQE ADDR INTO REG 8             27550002
         B     A0052         BRANCH TO PROCESS THIS DQE                 27600002
A0060    DS    0H                                                       27650002
         L     R4,WORKAREA   PLACE ADDRESS OF WORKAREA INTO REG 4       27700002
         LA    R4,N112(R4)   PLACE ADDR FROM WITHIN WORKAREA IN REG 4   27750002
         LM    R0,R15,N0(R4) RESTORE REG TO ENTERING VALUE              27800002
         LR    R6,R5         FIND NEXT TCB UNDER TEST                   27850002
         B     A00411        RETURN TO MAINLINE LISTMAP                 27900002
         EJECT                                                          27910002
A3000    DS    0H             EQUATE LABEL TO THIS ADDRESS              27950002
** THE FOLLOWING CODE CONVERTS THE DATA TO BE OUTPUTTED TO          **  28000002
** HEXADECIMAL.                                                     **  28050002
         L     R2,WORKAREA   PLACE WORKAREA ADDR INTO REG 2             28100002
         STM   R0,R15,N20(R2) SAVE MY REGISTERS TO FREE SOME UP         28150002
         XR    R5,R5         ZERO OUT REG 5 TO USE IT AS COUNTER        28200002
         LA    R15,N8        WE NEED AN 8 FOR LATER COMPARISON          28250002
         LR    R11,R10       PLACE ADDRESS TO BE CONVERTED INTO REG 11  28300002
A30001   DS    0H             EQUATE LABEL TO THIS ADDRESS              28350002
         XR    R10,R10       ZERO OUT REG 10                            28400002
         SLDL  R10,FOUR      MOVE 4 BITS FROM REG 11 INTO REG 10        28450002
         CL    R10,NINE      SEE IF REG 10 CONTAINS A 9 OR LESS         28500002
         BH    A30005        IF IT DOESNT THEN BRANCH                   28550002
         LA    R10,F0(R10)   OTHERWISE ADD A X'F0' TO REG 10            28600002
A30002   DS    0H             EQUATE LABEL TO THIS ADDRESS              28650002
         STC   R10,N0(R2)    PLACE CONTENTS OF REG 10 INTO WORKAREA     28700002
         LA    R2,N1(R2)     ADDRESS NEXT BYTE IN WORKAREA              28750002
         LA    R5,N1(R5)     ADD 1 TO COUNTER                           28800002
         CR    R5,R15        SEE IF REG 5 CONTAINS AN 8 YET             28850002
         BNE   A30001        IF IT DOES THEN BRANCH                     28900002
         L     R2,WORKAREA   PLACE ADDRESS OF WORKAREA INTO REG 2       28950002
         LM    R0,R15,N20(R2) RESTORE ENTERING REGISTERS                29000002
OUTSETUP L     R1,OUTBUF     PLACE POINTER OUTPUT AREA INTO R 1         29050002
         LA    R2,N8(R1)     PLACE ADDRESS OF OF ACTUAL MSG INTO REG 2  29100002
         ST    R2,N0(R1)     PLACE POINTER TO MSG INTO PARM LIST        29150002
         XR    R2,R2         ZERO REGISTER 2                            29200002
         ST    R2,N4(R1)     PLACE ZEROES INTO 2 WORD OF POINTER        29250002
         L     R2,WORKAREA   PLACE ADDRESS OF WORKAREA INTO REG 2       29300002
         BR    R14           BRANCH TO NEXT INSTRUCTION                 29350002
A30005   DS    0H             EQUATE LABEL TO THIS ADDRESS              29400002
         LA    R10,B7(R10)   ADD A X'B7' TO REG 10                      29450002
         B     A30002        BRANCH TO CONTINUE PROCESSING              29500002
A0100    DS    0H             EQUATE LABEL TO THIS ADDRESS              29550002
         LR    R11,R14       SAVE RETURN ADDRESS IN REG 11              29600002
         L     R2,OUTBUF      R2= ADDR OF THE DATA TO BE PRINTED        29650002
         L     R2,N0(R2)      R2= ADDR OF THE OUTPUT                    29660002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO PARM AREA        29710002
         IKJEGSIO DATA,DATAPTR=(R2),DSNAME=(R0),ID=MAP21,              *29720002
               MF=(E,TSTIOPRM)    CALL IKJEGIO FOR DATA                 29730002
         LTR   R15,R15       TEST RETURN CODE FOR ZERO                  29750002
         BZ    A0103         YES, THEN BRANCH                           29800002
         B     RETCODE(R15)  GO TO BRANCH TABLE INDEXED BY CONTENTS OF  29850002
*                            REGISTER 15                                29900002
A0103    DS    0H             EQUATE LABEL TO THIS ADDRESS              29950002
         TM    TSTFLGS1,TSTPRINT SEE IF THE PRINT SWITCH IS ON          30000002
         BNO   A0104         IF IT IS NOT THEN BRANCH                   30050002
         XR    R0,R0         OTHERWISE ZERO OUT REG O                   30100002
A0104    DS    0H             EQUATE LABEL TO THIS ADDRESS              30150002
         LR    R14,R11       RESTORE RETURN ADDRESS IN REG 14           30200002
         BR    R14           BRANCH TO RETURN TO NEXT INSTRUCTION       30250002
         SPACE                                                          30260002
A0200    DS    0H                                                       30300002
** THE FOLLOWING CODE SETS UP AND PUTS OUT THE MESSAGE FOR LISTMAP   ** 30350002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO PARM AREA        30450002
         IKJEGSIO MSG,FIRST=(R2),ID=MAP21,MF=(E,TSTIOPRM) CALL IKJEGIO  30500002
         B     RETCODE(R15)  NO, GO HANDLE RETURN CODE                  30750002
         SPACE                                                          30760002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         30800002
* THE FOLLOWING SECTION OF CODE OUTPUT MESSAGES BY PLACING THEM         30850002
* OUTPUT BUFFER.     NOTE OUTSETUP SETS R1 TO OUTBUF                    30900002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *         30950002
PUTMSG   L     R2,WORKAREA   GET SPACE TO SAVE RETURN ADDR              31000002
         ST    R14,N0(R2)    SAVE THE RETURN ADDRESS                    31050002
         BAL   R14,OUTSETUP  SETUP THE OUTPUT BUFFER                    31100002
         LH    R2,N0(R3)     GET LENGTH OF THE MESSAGE                  31200002
         BCTR  R2,N0         DECREMENT THE LENGTH BY ONE                31250002
         EX    R2,MOVEMSG    MOVE THE MESSAGE TO THE OUTBUFFER          31300002
         BAL   R14,A0100     LINK TO OUTPUT THE MESSAGE                 31350002
         L     R2,WORKAREA   GET ADDR OF WHERE RETURN IS.               31400002
         L     R14,N0(R2)    RESTORE THE RETURN ADDRESS                 31450002
* THE FOLLOWING CODE CLEARS THE OUTPUT BUFFER IN PREPARATION FOR THE *  31500002
* NEXT LINE OF OUTPUT.                                               *  31550002
CLEARALL DS    0H             EQUATE LABEL TO THIS ADDRESS              31600002
         L     R1,OUTBUF      R1= ADDR OF THE OUTPUT BUFFER             31610002
         MVI   N9(R1),HEX40  MOVE A BLANK INTO FIRST BYTE OF OUTPUT     31650002
         MVC   N10(N80,R1),N9(R1) SPREAD THIS BYTE THRU OUTPUT          31700002
         BR    R14           BRANCH TO RETURN TO NEXT INSTRUCTION       31750002
*  THIS MOVE CHARACTERS IS EXECUTED TO MOVE OUTPUT TO OUTBUF            31800002
MOVEMSG  MVC   N8(N0,R1),N0(R3)                                         31850002
A5006    DS    0H                                                       31900002
         LA    R2,MSG104     PUT MSG ADDR INTO REG 2 (FIRST LEVEL)      31950002
         LA    R4,INST17     R4= INSERT NO. 17 (LISTMAP)                31952002
         LA    R3,MSG277     PUT MSG ADDR INTO REG 3 (SECOND)           31960002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR PARM AREA           31970002
         IKJEGSIO MSG,FIRST=(R2),SECOND=(R3),INST11=(NUM,(R4)),        *32010002
               ID=MAP21,MF=(E,TSTIOPRM)  CALL IKJEGIO                   32020002
         B     RETCODE(R15)   BRANCH AS PER RETURN CODE                 32030002
         SPACE                                                          32032002
LINKFAIL DS    0H                  LINK FAILURE                         32034002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO PARM AREA        32036002
         LR    R2,R15              R2= RETURN CODE                      32038002
         LR    R3,R1               R3= ABEND CODE                       32038402
         IKJEGSIO SVCERR,SVC=6,RC=(R2),ABENDRG=(R3),                   *32038802
               ID=MAP21,MF=(E,TSTIOPRM)                                 32039202
         B     RETCODE(R15)   BRANCH AS PER RETURN CODE                 32040002
         EJECT                                                          32050002
*********************************************************************** 32052002
*        CONSTANTS AND OTHER INFO. SUPERZAP = ZAP AREA                  32052402
*********************************************************************** 32054002
SUPERZAP DC    50CL1'Z'      SUPERZAP AREA OF MAP                       32060002
         DS    0F            TABLE OF RB TYPES                          32100002
TYPE     DC    C' PRB'       PROGRAM REQUEST BLOCK                      32150002
         DC    C' IRB'       INTERRUPT REQUEST BLOCK                    32200002
         DC    C'SIRB'       SYSTEM INTERRUPT REQUEST BLOCK             32250002
         DC    C'SVRB'       SUPERVISOR REQUEST BLOCK                   32300002
NINE     DC    X'00000009'   USED FOR COMPARISON                        32350002
LNSIZE   DC    X'00400000'   LENGTH FOR OUTPUT MSG                      32400002
SIZERB   DC    X'00280000'   LENGTH FOR OUTPUT MSG                      32450002
SIZESPQ  DC    X'00200000'   LENGTH FOR OUTPUT MSG                      32500002
SIZERB2  DC    X'001C0000'   LENGTH FOR OUTPUT MSG                      32550002
PATTERN  DC    X'40202120'   PATTERN FOR EDIT COMMAND                   32600002
PARSERC  DS    0H                                                       32650002
         DC    A(A0025)      RETURN CODE OF 0 FROM IKJPARS              32700002
         DC    A(A004123A)   RETURN CODE OF 4 FROM IKJPARS              32750002
         DC    A(A004121)    RETURN CODE OF 8 FROM IKJPARS              32800002
         DC    A(A5006)      RETURN CODE OF 12 FROM IKJPARS             32850002
         DC    A(NOROOM)     RETURN CODE OF 16 FROM IKJPARS             32900002
         EJECT                                                          33500002
*********************************************************************** 33510002
*        THE FOLLOWING ARE ALL THE POSSIBLE HEADERS PUTOUT FROM LISTMAP 33520002
*********************************************************************** 33530002
HDR001   DS    0H                                                       33540002
         DC    AL2(ENDHDR1-HDR001)               LENGTH OF HEADING      33542002
         DC    AL2(0)                            TWO BYTES OF ZERO      33544002
         DC    C'REGION SIZE         '           HEADER                 33546002
ENDHDR1  DS    0H                                END                    33548002
HDR002   DS    0H                                                       33548402
         DC    AL2(ENDHDR2-HDR002)               LENGTH OF HEADING      33548802
         DC    AL2(0)                            TWO BYTES OF ZERO      33549202
         DC    C'     PROGRAM NAME  LENGTH   LOCATION'    HEADER        33549602
ENDHDR2  DS    0H                                END                    33549702
HDR003   DS    0H                                                       33549802
         DC    AL2(ENDHDR3-HDR003)               LENGTH OF HEADING      33549902
         DC    AL2(0)                            TWO BYTES OF ZERO      33566602
         DC    C'ACTIVE RBS:  TYPE   PROGRAM-ID' HEADER                 33576602
ENDHDR3  DS    0H                                END                    33578602
HDR004   DS    0H                                                       33580602
         DC    AL2(ENDHDR4-HDR004)               LENGTH OF HEADING      33582602
         DC    AL2(0)                            TWO BYTES OF ZERO      33583002
         DC    C'SUBPOOL INFORMATION:'           HEADER                 33583102
ENDHDR4  DS    0H                                                       33583202
HDR005   DS    0H                                                       33588802
         DC    AL2(ENDHDR5-HDR005)               LENGTH OF HEADING      33590802
         DC    AL2(0)                            TWO BYTES OF ZERO      33592802
         DC    C'UNDER TCB AT         '          HEADER                 33593202
ENDHDR5  DS    0H                                END                    33593602
HDR006   DS    0H                                                       33594002
         DC    AL2(ENDHDR6-HDR006)               LENGTH OF HEADING      33594102
         DC    AL2(0)                            TWO BYTES OF ZERO      33594202
         DC    C'NUMBER   LOCATION   LENGTH'     HEADER                 33594302
ENDHDR6  DS    0H                                END                    33608202
HDR007   DS    0H                                                       33618202
         DC    AL2(ENDHDR7-HDR007)               LENGTH OF MESSAGE      33620202
         DC    AL2(0)                            TWO BYTES OF ZERO      33620602
         DC    C'TASK HAS TERMINATED'            MESSAGE TEXT           33621002
ENDHDR7  DS    0H                                END                    33621402
HDR008   DS    0H                                                       33621802
         DC    AL2(ENDHDR8-HDR008)               LENGTH OF MESSAGE      33621902
         DC    AL2(0)                            TWO BYTES OF ZERO      33622002
         DC    C'TASK IS ACTIVE'                 MESSAGE TEXT           33622102
ENDHDR8  DS    0H                                END                    33626702
         EJECT                                                          33628702
IKJEGPCL IKJPARM                                                        33631502
PRINT    IKJKEYWD                                                       33636102
         IKJNAME  'PRINT',SUBFLD=DSNAME                                 33650002
DSNAME   IKJSUBF                                                        33700002
DSN      IKJPOSIT  DSNAME,PROMPT='DSNAME'                               33750002
         IKJENDP                                                        33800002
         EJECT                                                          33850002
PARSEFLD DC    V(IKJEGPCL)   POINTER TO PARSE PCL                       33900002
************************************************************            33950002
**             STAE RETRY CODE AND CONSTANTS              **            34000002
************************************************************            34050002
MAPSPL   IKJEGSPL RTRY=RETRY,ABNTB=STAETAB,MODNM=IKJEGMAP,TNM=LISTMAP   34100002
STAETAB  DS    0F             EQUATE LABEL TO THIS ADDRESS              34250002
         DC    AL1(99)       POINTER TO CORRECT MSG                     34300002
         DC    AL3(BLOWUP1)  POINTER TO INST AFTER LINK TO IKJPARS      34350002
         DC    X'FF'         END OF TABLE                               34400002
         DS    0H            GET US ON A HALF WORD BOUNDARY             34450002
RETRY    DS    0H             BEGINNING OF RETRY ROUTINE                34500002
         L     R4,CVTPTR     PLACE ADDRESS OF CVT INTO REG 4            34550002
         USING CVT,R4        SET UP ADDRESSABILITY TO CVT DSECT         34600002
         L     R4,CVTTCBP    GET ADDRESS OF CURRENT TCB                 34650002
         L     R4,TCBADR(N0,R4) FROM CVT                                34700002
         DROP  R4                                                       34750002
         DROP  R5            BANISH REG 5 AS AN ADDRESSING REGISTER     34800002
         USING TCB,R4        USE REG 4 TO ADDRESS TCB DSECT             34850002
         L     R9,TCBTRN     PLACE TCOMTAB ADDR INTO REG 9              34900002
         L     R13,REGSAVE2  RESTORE MY SAVE REGISTER                   34950002
         L     R12,MYBASE(R13) RESTORE MY BASE REGISTER                 35000002
         B     A004122       RETURN TO MAINLINE                         35250002
         EJECT                                                          35300002
***********************************************************             41100002
*                                                         *             41150002
*              TCOMTAB DSECT                              *             41200002
*                                                         *             41250002
***********************************************************             41300002
COMDSECT TCOMTAB              MACRO WHICH GENERATES TCOMTAB DSECT       41350002
         EJECT                                                          41400002
         TSTCWORK                                                       41450002
         EJECT                                                          41500002
         IKJPPL                                                         41550002
         EJECT                                                          41600002
************************************************************            41650002
*                                                          *            41700002
*                       PARSE PDE DSECT                    *            41750002
*                                                          *            41800002
************************************************************            41850002
PARSEPDE DSECT               DSECT TO ACCESS PDE CREATED BY PARSE       41900002
PRINTFLG DS    CL1           TWO BYTE FIELD USED TO INDICATE PRESENCE   41950002
PRINTBIT DS    CL1           SWITCH TO TELL IF PRINT WAS ENTERED        42000002
NOTUSED  DS    CL2           EMPTY FIELD                                42050002
PTRDSNME DS    A             POINTER TO DSNAME                          42100002
LENGTH1  DS    CL2           LENGTH OF DSNAME UP TO 44 BYTES            42150002
FLAGS    DS    CL1           FLAGS                                      42200002
RESERVE1 DS    CL1           RESERVED                                   42250002
         EJECT                                                          42300002
************************************************************            42350002
** THIS SECTION CONTAINS ALL DSECTS ACCESSED BY IKJEGMAP  **            42400002
************************************************************            42450002
*                                                          *            42500002
*              TCB  TASK CONTROL BLOCK DSECT               *            42550002
*                                                          *            42600002
************************************************************            42650002
TCBDSECT IKJTCB                                                         42700002
M        EQU   TCBOTC-TCB    MOTHER TASK                                42750002
S        EQU   TCBNTC-TCB    SISTER TASK                                42800002
D        EQU   TCBLTC-TCB    DAUGHTER TASK                              42850002
         EJECT                                                          42900002
*********************************************************************   42950002
*        CDE DSECT                                                      43000002
*********************************************************************   43050002
         IHACDE                                                         43100002
         EJECT                                                          43150002
*********************************************************************   43200002
*        EXTENT LIST DSECT                                              43250002
*********************************************************************   43300002
         IHAXTLST                                                       43350002
         EJECT                                                          43400002
*********************************************************************   43450002
*        LOAD LIST DSECT                                                43500002
*********************************************************************   43550002
         IHALLE                                                         43600002
         EJECT                                                          43650002
CVT      DSECT                                                          43700002
         CVT                                                            43750002
         EJECT                                                          43760002
         IKJRB                                                          43800002
         EJECT                                                          43850002
***********************************************************             43900002
*                                                         *             43950002
*              SPQE  SUBPOOL QUEUE DSECT                  *             44000002
*                                                         *             44050002
***********************************************************             44100002
         IHASPQE                                                        44150002
         EJECT                                                          44200002
***********************************************************             44250002
*                                                         *             44300002
*              DQE   DESCRIPTOR QUEUE ELEMENT DSECT       *             44350002
*                                                         *             44400002
***********************************************************             44450002
         IHADQE                                                         44500002
         EJECT                                                          44550002
***********************************************************             44600002
*                                                         *             44650002
*              PQE    DSECT                               *             44700002
*                                                         *             44750002
***********************************************************             44800002
         IHAPQE                                                         44850002
         END                                                            44900002
./  ADD  SSI=81730768,NAME=IKJEGMNL
NL     TITLE 'IKJEGMNL - TSO TEST - MAINLINE MONITOR'                   00050003
         COPY  IKJEGSIO                                                 00070002
IKJEGMNL CSECT                                                          00100002
         EXTRN IKJEGMMT                                                 00150002
         EXTRN IKJEGSTA                                                 00200002
         EJECT                                                          00300002
*A596500-598500                                                @YM00583 00310002
*C640000                                                       @YM04132 00320002
*C215100-215300                                                @YM07109 00330002
*A76500,171600,171800,640100-640400                            @YM07115 00340002
*C7650002,64030002                                             @ZA02701 00342003
*     MOVE TOO MANY BYTES                                      @ZA20612 00343003
*C919500                                                       @Y30NQKK 00345003
*********************************************************************** 00350002
*                                                                       00400002
* STATUS --                                                             00450002
*    CHANGE LEVEL 00, VERSION NO. 03, VS2 RELEASE 3                     00500003
*                                                                       00550002
* FUNCTION --                                                           00600002
*    THIS MODULE RECEIVES CONTROL FROM THE INITIALIZATION MODULE        00650002
*    (IKJEGINT) OF THE TEST DEBUGGING PACKAGE OF TSO AS THE RESULT      00700002
*    OF AN XCTL.IT FINISHES INITIALIZATION AND IS THEREAFTER RE-        00750002
*    SPONSIBLE FOR THE ACQUISITION OF TEST COMMANDS FROM THE TER-       00800002
*    MINAL AND THE ROUTING OF CONTROL TO ONE OR ANOTHER OF THE VAR-     00850002
*    IOUS TEST COMMAND PROCESSORS OR TO THE PROGRAM BEING TESTED,       00900002
*    ACCORDING TO THE USER'S WISHES.                                    00950002
*                                                                       01000002
* ENTRY POINTS --                                                       01050002
*    IKJEGMNL                                                           01100002
*                                                                       01150002
* INPUT  --                                                             01200002
*    TEST COMMUNICATION TABLE (TCOMTAB) POINTER IN GPR 9.               01250002
*                                                                       01300002
* OUTPUT --                                                             01350002
*    NONE                                                               01400002
*                                                                       01450002
* EXTERNAL REFERENCES --                                                01500002
*         IKJEGIO  FOR TERMINAL I/O (VIA IKJEGSIO MACRO)                01550002
*         IKJSCAN  TO SCAN THE SUBCOMMAND INPUT BUFFER                  01600002
*         IKJDAIR  TO UNALLOCATE DATASETS ALLOCATED BY TEST OR THE PP   01650002
*         IKJEGSTA  IS MAINLINE'S ESTAE EXIT ROUTINE                    01700002
*         IKJEGATN  IS MAINLINE'S ATTENTION EXIT ROUTINE                01750002
*         IKJEFT04  IS BOTH THE TMP'S AND MAINLINES' STAI EXIT ROUTINE  01800002
*                                                                       01850002
* EXITS, NORMAL --                                                      01900002
*         LINK TO COMMAND PROCESSING PROGRAM                            01950002
*         RETURN TO TMP ('END' OR 'RUN'),RETURN CODE=0                  02000002
*                                                                       02050002
* EXITS, ERROR --                                                       02100002
*         NONE                                                          02150002
*                                                                       02200002
* TABLES/WORKAREAS --                                                   02250002
*    TCOMTAB  POINTED AT BY REGISTER 9, IS THE COMMUNICATIONS TABLE FOR 02300002
*    THE TEST PROCESSOR                                                 02350002
*                                                                       02400002
*    TPL  POINTED TO BY REGISTER 10 IS THE TEST PARAMETER LIST          02450002
*    THE TPL WAS PASSED TO INITIALIZATION BY THE TMP                    02500002
*                                                                       02550002
*    WORKAREA POINTER IN TCOMTAB IS THE MAIN WORKAREA FOR MAINLINE.     02600002
*                                                                       02750002
* ATTRIBUTES --                                                         02800002
*    RE-ENTRANT                                                         02850002
*    REFRESHABLE                                                        02900002
*                                                                       02950002
* CHARACTER CODE DEPENDENCY --                                          03000002
*    NONE                                                               03050002
*                                                                       03100002
* NOTES --                                                              03150002
*    REGISTER CONVENTIONS FOR MAINLINE ARE AS FOLLOWS                   03200002
*    REG 9  TCOMTAB POINTER                                             03250002
*    REG 10  POSSIBLE SECOND BASE REGISTER                              03300002
*    REG 11  ONLY USED FOR LINK REGISTER                                03350002
*    REG 12 IS THE BASE REGISTER                                        03400002
*    REGISTER 0,1,14,15 ARE USED BY MOST SUBROUTINES BAL-ED TO.         03450002
*                                                                       03500002
*********************************************************************** 03550002
         EJECT                                                          03600002
*********************************************************************** 03650002
*                                                                     * 03700002
*        GENERAL REGISTER EQUATES.                                    * 03750002
*                                                                     * 03800002
*********************************************************************** 03850002
R0       EQU   0              REGISTER 0                                03900002
R1       EQU   1              REGISTER 1                                03950002
R2       EQU   2              REGISTER 2                                04000002
R3       EQU   3              REGISTER 3                                04050002
R4       EQU   4              REGISTER 4                                04100002
R5       EQU   5              REGISTER 5                                04150002
R6       EQU   6              REGISTER 6                                04200002
R7       EQU   7              REGISTER 7                                04250002
R8       EQU   8              REGISTER 8                                04300002
R9       EQU   9              REGISTER 9                                04350002
R10      EQU   10             REGISTER 10                               04400002
R11      EQU   11             REGISTER 11                               04450002
R12      EQU   12             REGISTER 12                               04500002
R13      EQU   13             REGISTER 13                               04550002
R14      EQU   14             REGISTER 14                               04600002
R15      EQU   15             REGISTER 15                               04650002
         EJECT                                                          04700002
         SAVE  (14,12),,*     SAVE ENTRY REGISTERS.                     04750002
         LR    R12,R15        SET-UP BASE REGISTER ADDRESS.             04800002
         LR    R9,R1           SAVE ADDRESS OF TCOMTAB.                 04850002
         USING IKJEGMNL,R12   ESTABLISH ADDRESSABILITY FOR THIS         04900002
*                             CSECT                                     04950002
         LA    R10,4095(R12)  ADDRESS FOR SECOND BASE REG               04960003
         USING IKJEGMNL+4095,R10 ESTABLISH ADDRESSABILTY                04970003
         USING TCOMTAB,R9     ESTABLISH ADDRESSABILITY TO TCOMTAB       05000002
         L     R15,REGSAVE1   ADDRESS OF SAVE AREA.                     05150002
         ST    R13,X4(,R15)   CROSS-CHAIN CURRENT AND PREVIOUS          05200002
         ST    R15,X8(,R13)   SAVE AREAS.                               05250002
         LR    R13,R15        SET-UP SAVE AREA ADDRESS.                 05300002
         EJECT                                                          05650002
*********************************************************************** 05700002
*                                                                     * 05750002
*        COMPLETE INITIALIZATION PHASE --                             * 05800002
*                                                                     * 05850002
*        1 --  STOP ALL SUBTASKS OPERATING UNDER THE TMP/TEST TCB     * 06350002
*        2 --  AUTOMATICALLY QUALIFY TO THE MODULE CURRENTLY          * 06400002
*              OPERATING UNDER TEST.                                  * 06450002
*        3 --  ADD A TERMINAL ELEMENT TO THE INPUT STACK FOR A        * 06500002
*              TASK THAT WAS TAKEN OVER FROM THE TMP.                 * 06550002
*                                                                     * 06600002
*********************************************************************** 06650002
         SPACE 2                                                        06700002
         SPACE 2                                                        07600002
         BAL   R11,STOPALL    INSURE ALL TASKS ARE STOPED INIT @ZA02701 07650003
         SPACE 2                                                        07700002
         BAL   R11,QUAL       AUTOMATIC QUALIFY FIRST TIME IN.          07750002
         SPACE 2                                                        07800002
         BAL   R11,ADD        ADD AN ELEM TO THE STACK, IF NEEDED.      07850002
         EJECT                                                          07900002
*********************************************************************** 07950002
*                                                                     * 08000002
*        ESTABLISH AN ATTENTION EXIT FOR THE TEST COMMAND.            * 08050002
*        THE OUTPUT BUFFER AND LENGTH POINT TO THE TEST MODE          * 08100002
*        MESSAGE WHICH IS A PART OF THE IKJEGATN MODULE.  THE         * 08150002
*        INPUT BUFFER ADDRESS POINTS TO THE STANDARD TEST OUTPUT      * 08200002
*        BUFFER BUT SPECIFIES A LENGTH OF ZERO.  THIS ENABLES A       * 08250002
*        PUTGET WITH THE TERM OPTION TO GET THE LINE OF INPUT         * 08300002
*        DURING ATTENTION PROCESSING.  THE USER ADDRESS IS THE        * 08350002
*        ADDRESS OF TCOMTAB.                                          * 08400002
*                                                                     * 08450002
*********************************************************************** 08500002
         SPACE 2                                                        08550002
         L     R2,OUTBUF      DUMMY INPUT BUFFER ADDRESS.               08600002
         L     R3,MNLEGATN   ADDRESS OF ATTENTION EXIT ROUTINE.         08650002
         MVC   TSTSTAX(MNLSTAXL),MNLSTAX INITIALIZE STAX                08700002
*                             PARAMETER LIST.                           08750002
         STAX  (R3),IBUF=((R2),),USADDR=(R9),REPLACE=NO,               X08800002
               MF=(E,TSTSTAX) ACTIVATE TESTS ATTENTION EXIT.            08850002
         LTR   R15,R15        TEST FOR SUCCESSFUL COMPLETION.           08900002
         BZ    MNLISTAE       IF IF RETURN CODE = 0, BRANCH TO          08950002
*                             ESTABLISH STAE EXIT ROUTINE.              09000002
         LA    R1,RESTART1    SET THE RESTART ADDRESS.                  09050002
         ST    R1,TSTRSTRT    DITTO                                     09100002
         BR    R1             GO TO RESTART1 AND CLEANUP.               09150002
         EJECT                                                          09200002
*********************************************************************** 09250002
*                                                                     * 09300002
*        ESTABLISH AN ABNORMAL END EXIT FOR THE TEST COMMAND.         * 09350002
*        IKJEGSTA PERFORMS ALL EXIT PROCESSING FOR THE TEST           * 09400002
*        COMMAND.  FOR ABENDS OCCURRING IN THE MAINLINE PORTION       * 09450002
*        OF TEST, ALL RETRYS WILL BE ATTEMPTED THROUGH IKJEGSTR       * 09500002
*        IN THIS MODULE.                                              * 09550002
*                                                                     * 09600002
*********************************************************************** 09650002
         SPACE 2                                                        09700002
MNLISTAE EQU   *                                                        09750002
         XC    MNLSVCPL,MNLSVCPL CLEAR SVC PARAMETER LIST               09800002
         L     R15,TSTSTAE   R15=ADDR OF ESTAE EXIT ROUTINE             09810002
         ESTAE (R15),CT,PARAM=MNLSPL,XCTL=NO,RECORD=YES,               *09850002
               MF=(E,MNLSVCPL)  ESTABLISH ABEND EXIT                    09900002
         LTR   R15,R15        TEST FOR SUCCESSFUL COMPLETION.           10000002
         BZ    SCREQ1        SUCCESSFUL,CONTINUE                        10050002
         LA    R1,SVC60NO    R1=ADDR OF SVC NUMBER                      10100002
         BAL   R14,IOSVC     OUTPUT SVC ERROR MESSAGE                   10110002
         B     ENDITERR      TERMINATE                                  10120002
         EJECT                                                          10150002
*********************************************************************** 10200002
*                                                                     * 10250002
*        THE FOLLOWING BEGINS THE MAIN PROCESS LOOP WHICH             * 10300002
*        INTERFACES BETWEEN THE TERMINAL, THE SUBCOMMAND              * 10350002
*        PROCESSOR, AND RETURN CODE CHECK UPON RETURN FROM A          * 10400002
*        SUBCOMMAND PROCESSOR.                                        * 10450002
*                                                                     * 10500002
*        1 --  FREE THE CURRENT INPUT BUFFER AND PDL, IF THEY         * 10550002
*              EXIST.                                                 * 10600002
*        2 --  DETERMINE IF A SUBCOMMAND IS IN CORE AND READY TO      * 10650002
*              BE PROCESSED.  INBUF WILL HAVE BEEN INITIALIZED        * 10700002
*              BY IKJEGATN.                                           * 10750002
*        3 --  DETERMINE IF A SUBCOMMAND IS TO BE PROCESSED FROM      * 10800002
*              A SUBCOMMAND CHAIN ENTERED ON AN AT SUBCOMMAND.        * 10850002
*              SUBCHAIN WILL HAVE BEEN INITIALIZED BY IKJEGCTL        * 10900002
*              WHEN A BREAKPOINT IS HIT.  WHEN SUBCHAIN IS NOT        * 10950002
*              ZERO, JUSTGET(CLOSED SUBROUTINE) IS CALLED TO RETRIEVE * 11000002
*              ONE SUBCOMMAND AT A TIME FROM THE CHAIN.               * 11050002
*        4 --  WHEN NEITHER OF THE ABOVE IS TRUE, INVOKE IKJEGSIO     * 11100002
*              TO PUT THE MODE MESSAGE AND TO GET A SUBCOMMAND.       * 11150002
*                                                                     * 11200002
*********************************************************************** 11250002
         SPACE 2                                                        11300002
SCREQ1   EQU   *                                                        11350002
         BAL   R11,FREINBUF   FREE INBUF AND PDL IF ANY.                11400002
         SPACE 2                                                        11450002
SCREQ    EQU   *                                                        11500002
         NC    INBUF(L'INBUF),INBUF Q.IS A COMMAND IN STORAGE.          11550002
         BNZ   SCAN           YES,LINK TO COMMAND SCAN ROUTINE.         11600002
         SPACE 2                                                        11650002
         NC    SUBCHAIN(L'SUBCHAIN),SUBCHAIN COMMAND CHAIN IN PROGRES   11700002
         BZ    SCREQ2        NO,GO ISSUE 'TEST' MODE MESSAGE            11750002
         L     R15,MNLEGMN1  YES, R15=ADDR OF PROCESSOR                 11760002
         BALR  R14,R15       GO GET NEXT SUBCOMMAND                     11770002
         LTR   R15,R15       SUCCESSFUL COMPLETION?                     11780002
         BZ    SCREQ         YES, GO PROCESS SUBCOMMAND                 11790002
* ISSUE 'GETMAIN SVC ERROR' MESSAGE                                     11790402
         LA    R1,SVC10NO    NO,GETMAIN ERROR OCCURRED                  11792002
*                            R1=ADDR OF SVC NUMBER                      11794002
         BAL   R14,IOSVC     GO ISSUE SVC ERROR MESSAGE                 11796002
         B     ENDITERR      IGNORE RC'S AND TERMINATE                  11798002
         SPACE 2                                                        11800002
SCREQ2   EQU   *                                                        11850002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO PARM LIST        11910002
         TM    TSTFLGS2,TSTLDF WAS LDF LAST IN CONTROL?                 11910402
         BZ    SCREQ2A       NO,BYPASS SPECIAL HANDLING                 11910802
         OI    TSTFLGS1,TSTFIRST TELL IKJEGSTA TO RETURN CONTROL        11911202
         OI    TSTFLGS4,TSTESTAE TELL IKJEGSIO TO NOT SET ESTAE         11911602
SCREQ2A  EQU   *                                                        11911702
* ISSUE 'TEST' MODE MESSAGE AND GET INPUT                               11912002
         IKJEGSIO PTGT,FIRST=M0071,ID=MNL22,MF=(E,TSTIOPRM)             11920002
         NI    TSTFLGS4,XFF-TSTESTAE RESET NO ESTAE BIT                 11932002
         NI    TSTFLGS1,XFF-TSTFIRST RESET IKJEGSTA RETURN BIT          11934002
         NI    TSTFLGS2,XFF-TSTLDF RESET LDF BIT                        11936002
         LTR   R15,R15       TEST FOR ZERO RETURN FROM IO               11938002
         BZ    GOADD         NORMAL RETURN CONTINUE                     11940002
         C     R15,ATTNCODE  IS ATTENTION IN EFFECT                     11942002
         BE    ATTNPROC      YES GO PROCESS IT                          11944002
         B     ENDITERR      CANNOT BE SURE OF VALIDITY OF              11946002
*                            'TEST' MESSAGE SO TERMINATE                11948002
         SPACE 2                                                        11950002
GOADD    EQU   *                                                        11960002
         BAL   R11,ADD        ADD A TERM ELEM TO THE STACK              12000002
         EJECT                                                          12050002
*********************************************************************** 12100002
*                                                                     * 12150002
*        PERFORM A CURSORY EXAMINATION OF THE INPUT BUFFER BY         * 12200002
*        FIRST CHECKING FOR A NULL LINE.  WHEN A NULL LINE WAS        * 12250002
*        ENTERED, IGNORE AND BRANCH TO FREE INPUT BUFFER.  FOR        * 12300002
*        OTHER THAN A NULL LINE, CHECK FOR AN ASSIGNMENT              * 12350002
*        SUBCOMMAND (AN EQUAL SIGN FOLLOWING THE SUBCOMMAND NAME)     * 12400002
*        IF AN ASSIGNMENT SUBCOMMAND IS FOUND, BLANK OUT THE          * 12450002
*        EQUAL SIGN AND SET-UP TO INVOKE IKJEGPCH.  OTHERWISE         * 12500002
*        PROCESSING WILL CONTINUE BY BRANCHING TO INVOKE IKJSCAN.     * 12550002
*                                                                     * 12600002
*        R2 -- CONSTANT 4 FOR COMPARISONS, ADDRESS OF SUBCOMMAND      * 12650002
*              NAME.                                                  * 12700002
*        R3 -- COUNTER OF NUMBER OF BYTES IN BUFFER, LENGTH OF        * 12750002
*              SUBCOMMAND NAME.                                       * 12800002
*        R4 -- POINTER TO CURRENT BYTE IN BUFFER.                     * 12850002
*        R5 -- ADDRESS OF LOAD MODULE NAME FOR ASSIGN.                * 12900002
*                                                                     * 12950002
*********************************************************************** 13000002
         SPACE 2                                                        13050002
SCAN     EQU   *                                                        13100002
         L     R4,INBUF       ADDRESS OF INPUT BUFFER.                  13150002
         LH    R3,X0(,R4)     LENGTH OF INPUT BUFFER.                   13200002
         LA    R2,X4          CONSTANT OF FOUR.                         13250002
         CR    R2,R3          CHECK IF THIS IS A NULL LINE.             13300002
         BE    SCREQ1         IF A NULL LINE, BRANCH TO FREE            13350002
*                             INPUT BUFFER.                             13400002
LOOP0    EQU   *                                                        13450002
         CLI   X4(R4),MNLBLANK CHECK FOR LEADING BLANK                  13500002
         BNE   LOOP           IF NOT A LEADING BLANK, BRANCH TO         13550002
*                             CHECK FOR A ASSIGN SUBCOMMAND.            13600002
         LA    R4,X1(,R4)     INCREMENT BUFFER POINTER BY 1.            13650002
         BCT   R3,LOOP0       CHECK IF ANOTHER LEADING BLANK.           13700002
         B     SCREQ1         IF ALL BLANKS, BRANCH TO REQUEST A        13750002
*                             NEW LINE.                                 13800002
LOOP     EQU   *                                                        13850002
         CLI   X4(R4),MNLBLANK CHECK FOR BLANK AS A DELIMITER.          13900002
         BE    MNLXX000       IF A BLANK ENCOUNTERED, NOT A             13950002
*                             ASSIGN SUBCOMMAND.                        14000002
         CLI   X4(R4),MNLLPARN CHECK FOR A LEFT PARENTHESIS.            14050002
         BE    MNLXX000       IF LEFT PARENTHESIS ENCOUNTERED,          14100002
*                             NOT A ASSIGN SUBCOMMAND.                  14150002
         CLI   X4(R4),MNLEQUAL CHECK FOR AN EQUAL SIGN.                 14200002
         BE    SCPCH          IF AN EQUAL SIGN FOUND, BRANCH TO         14250002
*                             REMOVE.                                   14300002
         LA    R4,X1(,R4)     INCREMENT BUFFER POINTER BY 1.            14350002
         BCT   R3,LOOP        DECREMENT COUNTER, CONTINUE SEARCH.       14400002
         B     MNLXX000       NO SIGNIFICANT CHARACTERS FOUND,          14450002
*                             BRANCH TO INVOKE IKJSCAN.                 14500002
SCPCH    EQU   *                                                        14550002
         MVI   X4(R4),MNLBLANK BLANK OUT EQUAL SIGN FOR PARSE.          14600002
         L     R2,MNLEGPCH    ADDRESS OF ASSIGN ENTRY IN                14650002
*                             SUBCOMMAND TABLE.                         14700002
         SR    R3,R3          ZERO LENGTH REGISTER TO INSURE            14750002
         IC    R3,SCDNAME(,R2) VALIDITY OF ONE BYTE LENGTH.             14800002
         LA    R5,SCDPCHLD(,R2) ADDRESS OF LOAD MODULE NAME FOR         14850002
*                             ASSIGN SUBCOMMAND.                        14900002
         LA    R2,SCDSCPPN(,R2) SET REGISTER TO POINT TO COMMON         14950002
*                             SUBCOMMAND NAME.                          15000002
         B     MNLXX170       BRANCH TO INVOKE ASSIGN SUBCOMMAND.       15050002
         EJECT                                                          15100002
*********************************************************************** 15150002
*                                                                     * 15200002
*        THE INPUT BUFFER CONTAINS A LINE OF INPUT WHICH IS NOT A     * 15250002
*        NULL LINE, A BLANK LINE, OR AN ASSIGNMENT SUBCOMMAND.        * 15300002
*        INVOKE THE COMMAND SCAN SERVICE ROUTINE (IKJSCAN) TO         * 15350002
*        SCAN THE INPUT BUFFER FOR THE SUBCOMMAND NAME.  UPON         * 15400002
*        RETURN FROM IKJSCAN, VALIDITY CHECK THE SPELLING OF THE      * 15450002
*        SUBCOMMAND ENTERED BY THE USER WITH ALL THOSE NAMES THAT     * 15500002
*        EXIST IN THE IBM TABLE AND THE USER TABLE.  WHEN A MATCH     * 15550002
*        IS FOUND, INVOKE THE MODULE INDICATED IN THE CURRENT         * 15600002
*        TABLE ENTRY.                                                 * 15650002
*                                                                     * 15700002
*        R2 -- FLAG WORD FOR IKJSCAN, ADDRESS OF SUBCOMMAND NAME      * 15750002
*              ENTERED BY USER.                                       * 15800002
*        R3 -- IKJSCAN OUTPUT AREA, LENGTH OF SUBCOMMAND NAME         * 15850002
*              ENTERED BY USER.                                       * 15900002
*        R4 -- ADDRESS OF INPUT BUFFER, LENGTH OF SUBCOMMAND NAME     * 15950002
*              OR ABBREVIATION IN CURRENT TABLE ENTRY.                * 16000002
*        R5 -- ADDRESS OF SUBCOMMAND NAME OR ABBREVIATION IN          * 16050002
*              CURRENT TABLE ENTRY, ADDRESS OF LOAD MODULE NAME.      * 16100002
*                                                                     * 16150002
*********************************************************************** 16200002
         SPACE 2                                                        16250002
MNLXX000 EQU   *                                                        16300002
         L     R4,INBUF       ADDRESS OF CURRENT INPUT BUFFER.          16350002
         MVC   MNLSCPRM(L'TSTUPT+L'TSTECT+L'TSTCPECB),PARMLIST          16400002
*                             INITIALIZE POINTERS TO UPT, ECT AND       16450002
*                             ECB FOR IKJSCAN.                          16500002
         LA    R2,MNLCSFLG    ADDRESS OF FLAG WORD FOR IKJSCAN.         16550002
         XC    MNLCSFLG(L'MNLCSFLG),MNLCSFLG ZERO FLAG WORD AND         16600002
         OI    MNLCSFLG,MNLNOCHK INDICATE NO SYNTAX CHECKING.           16650002
         LA    R3,MNLCSOA     ADDRESS OF TWO-WORD OUTPUT AREA.          16700002
         LINK  EP=IKJSCAN,PARAM=(,,,(R2),(R3),(R4)),ERRET=SCANERR,     X16750002
               MF=(E,MNLSCPRM) INVOKE COMMAND SCAN ROUTINE.             16800002
         LTR   R15,R15        TEST FOR ZERO RETURN CODE.                16850002
         BNZ   TMPRTURN       IF NOT ZERO, BRANCH TO RETURN.            16900002
         NI    TSTFLGS3,XFF-NOPARMS RESET OPERAND FLAG.                 16950002
         USING CSOA,R3        ESTABLISH ADDRESSABILITY TO CSOA.         17000002
         TM    CSOAFLG,CSOAVWP DETERMINE IF OPERANDS WERE ENTERED       17050002
         BO    MNLXX010       OPERANDS ENTERED, BRANCH TO               17100002
*                             VALIDATE SUBCOMMAND NAME.                 17150002
         TM    CSOAFLG,CSOAVNP  TEST FOR VALID COMMAND.        @YM07115 17160002
         BZ    NOSHOW1        COMMAND INVALID MSG.             @YM07115 17180002
         OI    TSTFLGS3,NOPARMS INDICATE NO OPERANDS ENTERED.           17200002
MNLXX010 EQU   *                                                        17250002
         L     R2,CSOACNM     ADDRESS OF SUBCOMMAND NAME.               17300002
         LH    R3,CSOALNM     LENGTH OF COMMAND NAME.                   17350002
         DROP  R3                                                       17400002
         SR    R4,R4          INITIALIZE REGISTER TO CONTAIN            17450002
*                             SUBCOMMAND NAME LENGTH.                   17500002
         STH   R4,MNLCFLGS    ZERO FLAG BYTES.                          17550002
         L     R5,MNLIBMTB    ADDRESS OF STANDARD SUBCOMMAND            17600002
*                             TABLE.                                    17650002
MNLXX030 EQU   *                                                        17700002
         IC    R4,X0(,R5)     LENGTH OF CURRENT ENTRY IN                17750002
*                             SUBCOMMAND NAME TABLE.                    17800002
         CR    R3,R4          DETERMINE IF THE LENGTH OF THE            17850002
*                             CURRENT TABLE ENTRY EQUALS THE            17900002
*                             LENGTH OF THE SUBCOMMAND ENTERED.         17950002
         BE    MNLXX090       IF LENGTHS ARE EQUAL, BRANCH TO           18000002
*                             COMPARE SUBCOMMAND NAMES.                 18050002
         CLI   X0(R5),SCDTBEND CHECK FOR END OF TABLE.                  18100002
         BE    MNLXX130       WHEN END OF TABLE HAS BEEN REACHED,       18150002
*                             BRANCH TO DETERMINE IF BOTH TABLES        18200002
*                             HAVE BEEN SEARCHED.                       18250002
         XI    MNLCFLG1,MNLABBRV INDICATE A TEST FOR HALF OF A          18300002
*                             TABLE ENTRY.                              18350002
         BNZ   MNLXX070       WHEN ABBREVIATION FLAG IS OFF,            18400002
*                             BRANCH TO COMPUTE A POINTER TO THE        18450002
*                             ABBREVIATION.                             18500002
         LA    R5,SCDNXTNM(R4,R5) IF AN ABBREVIATION JUST USED,         18550002
*                             COMPUTE POINTER TO NEXT NAME IN           18600002
*                             TABLE.                                    18650002
         B     MNLXX030       BRANCH TO CHECK SUBCOMMAND AGAINST        18700002
*                             NEXT TABLE ENTRY.                         18750002
MNLXX070 EQU   *                                                        18800002
         LA    R5,SCDNXTAB(R4,R5) COMPUTE POINTER TO ABBREVIATION       18850002
*                             FOR CURRENT ENTRY.                        18900002
         B     MNLXX030       BRANCH TO CHECK SUBCOMMAND NAME           18950002
*                             AGAINST ABBREVIATION.                     19000002
MNLXX090 EQU   *                                                        19050002
         BCTR  R4,X0          REDUCE LENGTH FOR COMPARISON.             19100002
         EX    R4,MNLCMDCK    DETERMINE IF SUBCOMMAND NAME              19150002
*                             ENTERED BY USER IS THE SAME AS THE        19200002
*                             CURRENT TABLE ENTRY.                      19250002
         BE    MNLXX150       WHEN A MATCH IS FOUND, BRANCH TO          19300002
*                             INVOKE SUBCOMMAND PROCESSOR.              19350002
         XI    MNLCFLG1,MNLABBRV INDICATE A TEST FOR HALF OF A          19400002
*                             TABLE ENTRY.                              19450002
         BNZ   MNLXX110       IF ABBREVIATION FLAG WAS OFF,             19500002
*                             BRANCH TO COMPUTE POINTER TO THE          19550002
*                             ABBREVIATION.                             19600002
         LA    R5,SCDNXTNM+X1(R4,R5) OTHERWISE, COMPUTE A POINTER       19650002
*                             TO THE SUBCOMMAND NAME IN THE NEXT        19700002
*                             TABLE ENTRY.                              19750002
         B     MNLXX030       BRANCH TO COMPARE LENGTH AGAINST          19800002
*                             CURRENT TABLE ENTRY.                      19850002
MNLXX110 EQU   *                                                        19900002
         LA    R5,SCDNXTAB+X1(R4,R5) COMPUTE ADDRESS OF THE             19950002
*                             ABBREVIATION FOR THIS ENTRY.              20000002
         B     MNLXX030       BRANCH TO COMPARE LENGTH AGAINST          20050002
*                             CURRENT ABBREVIATION.                     20100002
MNLXX130 EQU   *                                                        20150002
         XI    MNLCFLG2,MNLUSERT INDICATE A TABLE HAS BEEN              20200002
*                             SEARCHED AND TEST FOR WHICH TABLE.        20250002
         BZ    NOSHOW1        WHEN BOTH THE IBM TABLE AND THE           20300002
*                             USER TABLE HAVE BEEN SEARCHED,            20350002
*                             BRANCH TO PUT THE INVALID SUBCOM-         20400002
*                             MAND MESSAGE.                             20450002
         L     R5,MNLUSRTB    ADDRESS OF USER SUBCOMMAND TABLE.         20500002
         B     MNLXX030       BRANCH TO RESUME SEARCH USING THE         20550002
*                             NEW SUBCOMMAND NAME TABLE.                20600002
MNLXX150 EQU   *                                                        20650002
         LA    R5,SCDNXTAB+X1(R4,R5) POSSIBLE POINTER TO LOAD           20700002
*                             MODULE NAME IF THIS IS AN                 20750002
*                             ABBREVIATION.                             20800002
         TM    MNLCFLG1,MNLABBRV DETERMINE IF THIS WAS AN               20850002
*                             ABBREVIATION.                             20900002
         BO    MNLXX170       IF AN ABBREVIATION, BRANCH TO             20950002
*                             INVOKE SUBCOMMAND PROCESSOR.              21000002
         IC    R4,SCDABBR(,R5) GET ABBREVIATION LENGTH.                 21050002
         LA    R5,SCDABBRL(R4,R5) COMPUTE ADDRESS TO LOAD MODULE        21100002
*                             NAME.                                     21150002
MNLXX170 EQU   *                                                        21200002
         BCTR  R3,X0          REDUCE SUBCOMMAND NAME LENGTH BY 1.       21250002
         L     R1,TSTECT      ADDRESS OF ECT.                           21300002
         USING ECT,R1         ESTABLISH ADDRESSABILITY TO ECT.          21350002
         MVI   ECTSCMD,MNLBLANK BLANK OUT PREVIOUS SUBCOMMAND           21400002
         MVC   ECTSCMD+X1(L'ECTSCMD-X1),ECTSCMD NAME IN ECT.            21450002
         EX    R3,MNLSCDMV    MOVE CURRENT SUBCOMMAND NAME TO ECT.      21500002
         L    R15,ECTSCMD+X4  R15= LAST HALF COMMAND           @YM07109 21510002
         L    R1,ECTSCMD      R1= FIRST HALF COMMAND           @YM07109 21520002
         TSEVENT PPMODE       RECORD SUBCOMMAND TIME STAMP     @YM07109 21530002
         DROP  R1                                                       21550002
         XC    MNLLINKL(L'MNLLINKL),MNLLINKL ZERO PARAMETER LIST        21600002
*                             FOR LINK MACRO EXPANSION.                 21650002
         NI    TSTFLGS1,XFF-TSTFIRST-RANGESW SET FLAGS TO '0'B.         21700002
         NI    TSTFLGS3,XFF-SYMMESG SET FLAG TO '0'B.                   21750002
         NI    TSTFLGS4,XFF-TSTVALCK TURN OFF VALIDITY CHECK BIT        21760002
         OI    TSTFLGS3,TSTLINK INDICATE THAT LINK TO SUBCOMMAND        21800002
*                             IS IN PROCESS (INDICATOR TO STAE).        21850002
         STM   R14,R12,N12(R13) SAVE REGISTERS FOR STAE RETRY.          21900002
         MVC   TSTRTYCD,X8(R5) SET UP SUBCOMMAND ID FIELD.              21950002
         LINK  EPLOC=(R5),SF=(E,MNLLINKL),ERRET=SUBCERR                 22000002
* INVOKE SUBCOMMAND PROCESSOR                                           22060002
         EJECT                                                          22110002
BLOWSC   EQU   *                                                        22150002
         NI    TSTFLGS3,XFF-TSTLINK  RESET LINK ABEND BIT               22200002
         XC    TSTRSTRT(X4),TSTRSTRT  INSURE RESTART ADDR ZEROED        22250002
         NI    TSTFLGS2,XFF-TSTXCTL  RESET XCTL ABEND BIT               22360002
         NI    TSTFLGS1,XFF-TSTBUILD RESET BUILD BRKPT SWITCH           22370002
         SPACE                                                          22400002
*        RETURN CODE CHECK                                              22450002
         SPACE                                                          22500002
         B     HERE(R15)       BRANCH ACCORDING TO RETURN CODE.         22550002
HERE     EQU   *                                                        22600002
         B     CLEAN          RC=0,GET ANOTHER COMMAND.                 22650002
         B     IKJEGCTL       RC=4,'GO',GO TO CTL SUBROUTINE.           22700002
         B     TMPRTURN       RC=8,'END',FOLD UP TENT.                  22750002
         B     RUNRTURN       RC=12,'RUN',FOLD UP TENT,NO DETACH.       22800002
         B     ATTNPROC       RC=16,ATTENTION INT. PROCESSING.          22850002
         B     STAERTRN       RETURN FROM A S.C. WHICH ABENDED.         22900002
         B     ESTAERR       RC=24 PROCESS ESTAE ERROR                  22910002
CLEAN    EQU   *                                                        22950002
         TM    TSTFLGS4,TSTFLUSH   Q. IS THERE A NEED TO FLUSH.         23000002
         BNO   CLEAN1         NO.                                       23050002
STAERTRN EQU   *                                                        23100002
         NI    TSTFLGS4,XFF-TSTFLUSH  INSURE RESET OF FLAG.             23150002
         BAL   R11,FLUSH      TCLEARQ AND MAYBE STACK FLUSH.            23200002
CLEAN1   EQU   *                                                        23250002
         TM    TSTFLGS1,ENDSW HAS EITHER 'RUN' OR 'END' BEEN ENTERED    23300002
         BO    TMPRTURN       YES.FOLD.                                 23350002
         L     R1,ECBTMPA     GET ATTENTION ECB.                        23400002
         TM    X0(R1),TESTATTN  DID IKJEGATN POST Q.Q.Q.                23450002
         BO    ATTNPROC       YES. PROCESS THE ATTENTION REQUEST.       23500002
         B     SCREQ1          GET ANOTHER COMMAND.                     23550002
ESTAERR  EQU   *             RC=24 RETURNED FROM SOME MODULE            23560002
         SR    R15,R15       ZERO REG 15                                23572002
         IC    R15,TSTESTRC  PUT ESTAE RC IN R15                        23574002
* ISSUE 'ESTAE SVC ERROR' MESSAGE                                       23580002
         LA    R1,SVC60NO    R1=ADDR OF SVC NUMBER                      23590002
         BAL   R14,IOSVC     PUT OUT SVC ERROR MESSAGE                  23590402
         LTR   R15,R15       TEST FOR ZERO RETURN CODE                  23592002
         BZ    CLEAN         ZERO FOUND CONTINUE PROCESSING             23594002
         C     R15,ATTNCODE  IS ATTEN IN EFFECT                         23596002
         BE    ATTNPROC      YES. GO PROCESS IT                         23598002
ESTAERR1 EQU   *                                                        23598402
* ISSUE 'TEST ENDED DUE TO ERROR' MESSAGE                               23599202
         LA    R1,MSG1       R1=ADDR OF MESSAGE NUMBERS                 23599602
         BAL   R14,IOMSG     PUT OUT MESSAGE                            23612202
         B     TMPRTURN      IGNORE RC'S AND TERMINATE                  23624802
         EJECT                                                          23637402
*********************************************************************** 23650002
*                                                                     * 23700002
*        CORE CLEAN-UP FOLLOWING EXECUTION OF A SUBCOMMAND.           * 23750002
*                                                                     * 23800002
*        1 --  FREE LAST INPUT BUFFER, POINTED TO BY INBUF,           * 23850002
*              UNLESS AN ATTENTION INTERRUPT HAS OCCURRED.            * 23900002
*        2 --  FREE LAST PDL RETURNED BY PARSE.                       * 23950002
*        3 --  FREE CHAIN OF SYMBOL INFORMATION BLOCKS IF SUCH        * 24000002
*              A CHAIN EXISTS.                                        * 24050002
*                                                                     * 24100002
*********************************************************************** 24150002
         SPACE 2                                                        24200002
FREINBUF EQU   *                                                        24250002
         L     R1,ECBTMPA     POINT TO ATTN ECB                         24300002
         TM    X0(R1),TESTATTN  HAS ATTENTION BEEN HIT Q.Q.Q.           24350002
         BO    PDLFREE        YES. DON'T FREE INPUT BUFFER.             24400002
         L     R1,INBUF       R1=ADDR OF BUFFER                         24450002
         LTR   R1,R1          Q.IS INBUF ZERO.                          24500002
         BZ    PDLFREE        YES, CHECK ON TSTANSPL.                   24550002
         LH    R0,X0(,R1)     R0=LENGTH OF BUFFER FOR FREEMAIN          24600002
         XC    INBUF(L'INBUF),INBUF CLEAR INPUT BUFFER POINTER.         24700002
         FREEMAIN RC,LV=(0),A=(1),SP=1 FREE THE BUFFER.                 24750002
         LTR   R15,R15       WAS FREEMAIN SUCCESSFUL                    24760002
         BZ    PDLFREE       YES CONTINUE                               24770002
* ISSUE 'FREEMAIN SVC ERROR' MESSAGE                                    24782002
         LA    R1,SVC120NO   R1=ADDR OF SVC NUMBER                      24784002
         BAL   R14,IOSVC     PUT OUT SVC ERROR MESSAGE                  24786002
* IGNORE RETURN CODES AND CONTINUE                                      24792002
         SPACE 2                                                        24800002
PDLFREE  EQU   *                                                        24850002
         IKJRLSA TSTANSPL     RELEASE THE PDL                           24900002
         XC    TSTANSPL(L'TSTANSPL),TSTANSPL ZERO BEFORE FREEING        24950002
         SPACE 2                                                        25000002
         L     R14,SICHAIN    ADDR OF HEAD OF CHAIN                     25050002
         XC    SICHAIN(L'SICHAIN),SICHAIN ZERO IN CASE OF ABEND         25100002
LOOP4    EQU   *                                                        25150002
         LTR   R1,R14         Q. END OF CHAIN.                          25200002
         BCR   Z,R11          RETURN TO CALLER                          25250002
         L     R14,SIBLINK(,R14) R14=ADDR OF NEXT SIB,IF ANY            25300002
         L     R0,MNLSIBLN    SIB CORE SUBPOOL AND LENGTH               25350002
         FREEMAIN  RC,LV=(0),A=(1),SP=1  FREE THIS SIB                  25400002
         LTR   R15,R15       WAS FREEMAIN SUCCESSFUL                    25410002
         BZ    LOOP4         YES CONTINUE                               25420002
* ISSUE 'FREEMAIN SVC ERROR' MESSAGE                                    25440002
         LA    R1,SVC120NO   R1=ADDR OF SVC NUMBER                      25442002
         BAL   R14,IOSVC     PUT OUT SVC ERROR MESSAGE                  25442402
* IGNORE RETURN CODES AND CONTINUE                                      25444002
         B     LOOP4          LOOP ------                               25450002
         EJECT                                                          25500002
NOSHOW1  EQU   *                                                        25550002
*        LINE RECEIVED DID NOT HAVE A VALID VERB AS THE FIRST FIELD.    25600002
*        WRITE A DIAGNOSTIC MESSAGE TO THE TERMINAL AND GET ANOTHER     25650002
*        LINE.                                                          25700002
         SPACE                                                          25750002
* ISSUE 'INVALID COMMAND' MESSAGE                                       25762002
* ISSUE 'COMMAND NOT SUPPORTED' MESSAGE                                 25772002
         LA    R1,MSG2       R1=ADDR OF MESSAGE NUMBERS                 25774002
         BAL   R14,IOMSG     PUT OUT MESSAGES                           25776002
         BAL   R11,IORETCK   GO TEST IO RETURN CODES                    25780002
         B     SCREQ1        GET ANOTHER COMMAND.                       25900002
         EJECT                                                          25950002
ATTNPROC EQU   *                                                        27900002
         TM    TSTFLGS1,ENDSW HAS EITHER 'RUN' OR 'END' BEEN ENTERED.   27950002
         BO    TMPRTURN       YES.FOLD.                                 28000002
         L     R1,ECBTMPA     R1=ATTENTION ECB ADDR.                    28050002
         TM    X0(R1),TESTATTN Q.DID TEST POST ECB (X'48').             28100002
         BNO   ENDIT1         NO,FOLD UP TENT.                          28150002
         XC    X0(X4,R1),X0(R1)  ZERO ATTENTION ECB.                    28200002
         BAL   R11,PDLFREE    FREE PDL BUT NOT INPUT BUFFER.            28250002
         NI    TSTFLGS4,XFF-TSTFLUSH TURN OFF FLUSH SWITCH.             28300002
         B     SCREQ          PROCESS COMMAND RECEIVED.                 28350002
         EJECT                                                          28360002
IORETCK  EQU   *             IO RETURN CODE CHECK ROUTINE               28474002
         B     IORC0(R15)    USE RC AGAINST BRANCH TABLE                28476002
IORC0    EQU   *                                                        28478002
         B     X0(R11)       RC=0 NORMAL RETURN CONTINUE                28480002
         B     X0(R11)       RC=4 IO ERROR TRY TO CONTINUE              28482002
         B     ESTAERR1      RC=8 SHOULD NEVER HAPPEN                   28482402
         B     X0(R11)       RC=12 IO ERROR TRY TO CONTINUE             28482802
         B     ATTNPROC      RC=16 ATTN. GO PROCESS IT                  28483202
         B     X0(R11)       RC=20 RETRY ENTERED TRY TO CONTINUE        28483302
* RC=24 ESTAE ERROR                                                     28493702
         SR    R15,R15       ZERO REG 15                                28506602
         IC    R15,TSTESTRC  PUT ESTAE RETURN CODE IN R15               28508602
* ISSUE 'ESTAE SVC ERROR' MESSAGE                                       28510002
         LA    R1,SVC10NO    R1=ADDR OF SVC NUMBER                      28512002
         BAL   R14,IOSVC     PUT OUT SVC ERROR MESSAGE                  28514002
         LTR   R15,R15       TEST FOR SUCCESSFUL COMPLETION             28516402
         BZ    X0(R11)       IO SUCCESSFUL.RETURN                       28518402
         C     R15,ATTNCODE  IS ATTENTION IN EFFECT                     28518802
         BE    ATTNPROC      YES PROCESS IT                             28518902
         B     ESTAERR1      MESSAGE STILL BAD TERMINATE                28523302
         EJECT                                                          28527902
*********************************************************************** 28532302
*                                                                     * 28536702
*        USER PROGRAM CONTROL AND MONITORING SECTION.                 * 28550002
*                                                                     * 28600002
*        THIS SECTION OF CODE IS GIVEN CONTROL WHENEVER THE GO        * 28650002
*        SUBCOMMAND PROCESSOR HAS COMPLETED PROCESSING NORMALLY.      * 28700002
*        THE FUNCTION OF THIS SECTION OF CODE IS TO MAKE THE          * 28750002
*        USER PROGRAM DISPATCHABLE BY POSTING AN ECB AND TO PLACE     * 28800002
*        TEST IN THE WAIT STATE, WAITING ON ANY ONE OF A NUMBER       * 28850002
*        OF EVENTS.                                                   * 28900002
*                                                                     * 28950002
*        TO MAKE THE USER PROGRAM DISPATCHABLE AFTER EXECUTION OF     * 29000002
*        THE GO SUBCOMMAND PROCESSOR, THE FOLLOWING OCCUR --          * 29050002
*                                                                     * 29100002
*        1 --  THE INPUT BUFFER CONTAINING THE GO SUBCOMMAND IS       * 29150002
*               FREED.                                                * 29200002
*                                                                     * 30300002
*        2 --  TEST'S DISPATCHABILITY ECB IS ZEROED.                  * 30310002
*                                                                     * 30320002
*        3 --  A CHECK IS MADE TO DETERMINE IF A PSEUDO BREAK-        * 30330002
*              POINT IS TO BE DISPATCHED. IF SO, IT IS GIVEN          * 30340002
*              PRIORITY.                                              * 30342002
*                                                                     * 30344002
*        4 --  FOR OTHER THAN PSEUDO BREAKPOINTS, PROCESSING IS       * 30346002
*              RETURNED TO EITHER A SUBCOMMAND PROCESSOR OR TO        * 30348002
*              THE TMP IF AN ATTENTION INTERRUPT HAS OCCURRED         * 30348402
*              SINCE RETURN FROM GO.                                  * 30348802
*                                                                     * 30349202
*        5 --  THE TERMINAL IS REMOVED FROM THE INPUT STACK           * 30349602
*              AND THE USER PROGRAM IS POSTED.                        * 30349702
*                                                                     * 30349802
*        6 --  THE USER PROGRAM IS SET DISPATCHABLE AND TEST GOES     * 30350002
*              INTO THE WAIT STATE.                                   * 30400002
*                                                                     * 30450002
*********************************************************************** 30500002
         SPACE 2                                                        30550002
IKJEGCTL EQU   *                                                        30600002
         BAL   R11,FREINBUF   CLEAN UP AFTER 'GO'.                      30650002
         SPACE 2                                                        30700002
         L     R2,ECBTST      R2=TEST DISPATCHABILITY ECB ADDR.         30750002
         XC    X0(X4,R2),X0(R2)  CLEAR TESTS ECB.                       30800002
         SPACE 2                                                        30850002
         OC    TSTGOPSW(L'TSTGOPSW),TSTGOPSW PSEUDO BREAK NEXT.         30900002
         BNZ   POST           YES. PSEUDO BREAK GETS PRIORITY.          30950002
         SPACE 2                                                        31000002
         L     R1,ECBTMPA     POINT TO ATTN ECB                         31050002
         TM    X0(R1),TESTATTN  HAS ATTENTION BEEN HIT Q.Q.Q.           31100002
         BO    ATTNPROC       PROCESS THE ATTENTION.                    31150002
         SPACE 2                                                        31200002
POST     EQU   *                                                        32200002
         BAL   R11,REMOVE     REMOVE THE TERM ELEM OFF THE STACK        32300002
         POST  ECBPP          MAKE PROGRAM BEING TESTED DISPATCHABLE.   32350002
         SPACE 2                                                        32352003
         SPACE 2                                                        32400002
WAIT     EQU   *                                                        32450002
         BAL   R11,START      START THE TASK OR TASKS.                  32500002
         WAIT  ECBLIST=ECBLIST  TEST CREAKS TO A HALT.                  32550002
         EJECT                                                          32600002
*********************************************************************** 32650002
*                                                                     * 32700002
*        DETERMINE WHICH EVENT OCCURRED TO BRING TEST OUT OF THE      * 32750002
*        WAIT STATE.                                                  * 32800002
*                                                                     * 32850002
*        1 --  IF THE STOP/MODIFY ECB IS POSTED, BRANCH TO CLEAN-     * 32900002
*              UP AND RETURN TO THE TMP.                              * 32950002
*                                                                     * 33000002
*        2 --  IF THE TEST DISPATCHABILITY ECB IS POSTED, PROCESS     * 33050002
*              FOR EITHER SVC 061 OR SVC 097.                         * 33100002
*                                                                     * 33150002
*        3 --  OTHERWISE, BRANCH TO CONTINUE CHECK FOR POSTED ECB     * 33200002
*                                                                     * 33250002
*********************************************************************** 33300002
         SPACE 2                                                        33350002
         BAL   R11,STOP       STOP THE TASK OR TASKS.                   33400002
         SPACE 2                                                        33450002
         L     R1,ECBLOG      CHECK IF STOP/MODIFY WAS ENTERED BY OP.   33500002
         TM    X0(R1),X40     *                                         33550002
         BZ    CKECBTST      NOT POSTED CHECK NEXT ECB                  33600002
         B     ENDIT1        TERMINATE                                  33648002
         SPACE 2                                                        33650002
CKECBTST EQU   *                                                        33660002
         L     R1,ECBTST      TEST'S ECB.                               33700002
         TM    X0(R1),TESTPOST Q.WAS TEST ECB POSTED(40 OR 44).         33750002
         BZ    STAICHK        NO,CHECK STAI ECB.                        33800002
         BM    BKPNT          YES,POSTED BY SVC 97,PROCESS BREAKPOINT   33850002
         EJECT                                                          33900002
*********************************************************************** 33950002
*                                                                     * 34000002
*        POST BY SVC 61.                                              * 34010002
*        ECBTST POSTED COMPLETE WITH A X'44'.  COMPLETION CODE        * 34050002
*        PORTION OF ECBPP CONTAINS A POINTER TO THE SVC 061 SVRB.     * 34100002
*                                                                     * 34150002
*        1 --  IF SVC 061 HAS PLACED A VALID TCB ADDRESS IN ITS       * 34200002
*              EXTENDED SAVE AREA, ISSUE A GETMAIN FOR A SVC          * 34250002
*              INFORMATION BLOCK QUEUE CONTROL BLOCK AND COMPLETE     * 34300002
*                                                                     * 34350002
*        2 --  IF A DEFER BREAKPOINT QUEUE EXISTS, BRANCH TO          * 34400002
*              INVOKE THE AT SUBCOMMAND PROCESSOR TO ACTIVATE         * 34450002
*                             BREAKPOINTS IN THE MODULE JUST LOADED.  * 34500002
*                                                                     * 34550002
*********************************************************************** 34600002
         SPACE 2                                                        34650002
         L     R1,ECBPP       OBTAIN SVRB ADDRESS FOR SVC61.            34700002
         LM    R3,R4,RBEXSAVE-RBSECT(R1) GET THE TCB ADDR AND SVC       34750002
*                             INFO BLOCK POINTER.                       34800002
         LTR   R3,R3          IF TCB ADDRESS IS ZERO, IGNORE.           34850002
         BZ    NOGET          BRANCH TO AVOID GETMAIN.                  34900002
         SPACE 2                                                        34950002
         L     R0,CORETRN     GETMAIN FOR A QUEUE CONTROL BLOCK.        35000002
         GETMAIN RC,LV=(0),SP=1     GET CORE FOR QUEUE CONTROL BLOCK.   35050002
         LTR   R15,R15       WAS GETMAIN SUCCESSFUL                     35060002
         BZ    CONT1         YES CONTINUE                               35070002
* ISSUE 'GETMAIN SVC ERROR' MESSAGE                                     35080002
         LA    R1,SVC10NO    R1=ADDR OF SVC NUMBER                      35082002
         BAL   R14,IOSVC     PUT OUT SVC ERROR MESSAGE                  35084002
         B     ENDITERR      TERMINATE AFTER RETURN FROM IO             35090002
CONT1    EQU   *                                                        35092002
         MVC   X0(X4,R1),TSTTRN SAVE THE LINK FIELD.                    35100002
         STM   R3,R4,X4(R1)   TCB ADDRESS AND SVC INFO BLOCK            35150002
*                             POINTER INTO QUEUE CONTROL BLOCK.         35200002
         ST    R1,TSTTRN      SAVE HEAD QUEUE CONTROL BLOCK ADDRESS.    35250002
         SPACE 2                                                        35300002
NOGET    EQU   *                                                        35350002
         OC    DEFERTAB(L'DEFERTAB),DEFERTAB DEFER BREAKPOINT PRESENT.  35400002
         BZ    IKJEGCTL       IF NOT, BRANCH TO RESUME PROCESSING.      35450002
         SPACE 2                                                        35500002
         OI    TSTFLGS1,TSTBUILD SET SWITCH FOR IKJEGAT.                35550002
*                             CWORKCMD CONTAINS LOADNAME,LOADBGN.       35600002
         L     R2,MNLEGAT     ADDRESS OF AT ENTRY IN SUBCOMMAND         35650002
*                             TABLE.                                    35700002
         SR    R3,R3          ZERO LENGTH REGISTER TO INSURE            35750002
         IC    R3,SCDNAME(,R2) VALIDITY OF ONE BYTE LENGTH.             35800002
         LA    R5,SCDATLD(,R2) ADDRESS OF LOAD MODULE NAME FOR          35850002
*                             AT SUBCOMMAND.                            35900002
         LA    R2,SCDSCPPN(,R2) SET REGISTER TO POINT TO COMMON         35950002
*                             SUBCOMMAND NAME.                          36000002
         B     MNLXX170       BRANCH TO INVOKE AT SUBCOMMAND.           36050002
         EJECT                                                          36100002
*********************************************************************** 36150002
*                                                                     * 36200002
*        POST BY SVC 97.                                              * 36210002
*        ECBTST POSTED COMPLETE WITH A X'40'.  COMPLETION CODE        * 36250002
*        PORTION OF ECBPP CONTAINS A POINTER TO THE SVC 097 SVRB.     * 36300002
*                                                                     * 36350002
*        1 --  QUALIFY THE TCB AND PRB IN WHICH THE BREAKPOINT        * 36400002
*              OCCURRED.                                              * 36450002
*                                                                     * 36500002
*        2 --  REPLACE THE TERMINAL ON THE INPUT STACK.               * 36550002
*                                                                     * 36600002
*        3 --  DETERMINE IF A PSEUDO OR OTHER BREAKPOINT.             * 36650002
*                                                                     * 36700002
*********************************************************************** 36750002
         SPACE 2                                                        36800002
BKPNT    EQU   *                                                        36850002
         TM    TSTFLGS4,TSTSVCAB DID SVC 97 ABEND?                      36860002
         BZ    BKPT1         NO,CONTINUE                                36870002
         LA    R1,MSG3       R1=ADDR OF MESSAGE NUMBERS                 36880002
* ISSUE 'TEST ENDED DUE TO ERROR' MESSAGE                               36890002
* ISSUE 'UNRECOVERABLE SVC ERROR' MESSAGE                               36892002
         BAL   R14,IOMSG     PUT OUT MESSAGES                           36894002
         B     ENDIT1        IGNORE IO RC'S AND TERMINATE               36896002
BKPT1    EQU   *                                                        36898002
         BAL   R11,QUAL       REQUALIFY IF NECESSARY.                   36900002
         SPACE 2                                                        36950002
         BAL   R11,ADD        ADD A TERM ELEM TO THE STACK              37000002
         SPACE 2                                                        37050002
         L     R4,TSTGOPSW    SET R1 FOR POSSIBLE PARAMETER TO SVC97    37100002
         LTR   R4,R4          Q. IST 'TSTGO' FIELD ZERO.                37150002
         BZ    BRKCHK         YES,TEST DID NOT SET THE BREAKPOINT.      37200002
         EJECT                                                          37250002
*********************************************************************** 37300002
*                                                                     * 37350002
*        WHEN TSTGOPSW IS NON-ZERO, A PSEUDO BREAKPOINT IS            * 37400002
*        INDICATED.                                                   * 37450002
*                                                                     * 37500002
*        1 --  DETERMINE IF BREAKPOINT IS IN A BREAK ELEMENT.  IF     * 37550002
*              PSEUDO BREAKPOINT IS NOT WITHIN A BREAK ELEMENT,       * 37600002
*              SET RESUME ADDRESS IN RB TO THE ADDRESS SPECIFIED      * 37650002
*              IN TSTGOPSW.                                           * 37700002
*                                                                     * 37750002
*        2 --  FOR A PSEUDO BREAKPOINT OCCURRING WITHIN A BREAK       * 37800002
*              ELEMENT, COMPUTE ADDRESS OF NEXT SEQUENTIAL            * 37850002
*              INSTRUCTION IN THE USER PROGRAM AND SET RESUME         * 37900002
*              ADDRESS IN RB ACCORDINGLY.                             * 37950002
*                                                                     * 38000002
*        3 --  DETERMINE IF IKJEGLDF WAS RUNNING UNDER THE USER       * 38050002
*              TCB.  IF SO, RESTORE USER PROGRAM REGISTERS AND        * 38100002
*              DELETE IKJEGLDF.  IN ALL CASES RETURN CONTROL TO       * 38150002
*              THE USER AT THE TERMINAL.                              * 38200002
*                                                                     * 38250002
*********************************************************************** 38300002
         SPACE 2                                                        38350002
         L     R5,BREAKTAB    GET THE BREAK ELEMENT QUEUE               38400002
LOOP6    EQU   *                                                        38450002
         LTR   R5,R5          Q. HAVE ALL BREAK ELEMENTS BEEN CHECKED.  38500002
         BZ    PSEUDO1        YES. RESTORE THE SAVED I.C.               38550002
         SPACE 2                                                        38600002
         USING BRKELEM,R5     BREAK ELEMENT ADDRESSABILITY              38650002
         LA    R0,BRKINST     OBTAIN BEGINNING OF INSTR. FIELD          38700002
         LA    R2,BRKINST+X6  OBTAIN END OF INSTR. FIELD.               38750002
         LA    R4,X0(,R4)     CLEAR HIGH BYTE OF TSTGO.                 38800002
         CR    R4,R0          Q. IS IC WITHIN BREAK ELEMENT.            38850002
         BL    MISS           NO. BRANCH.                               38900002
         CR    R4,R2          Q. IS IC WITHIN BREAK ELEMENT.            38950002
         BNH   HIT            YES. BRANCH                               39000002
MISS     EQU   *                                                        39050002
         L     R5,BRKLINK     GET NEXT ELEMENT , IF ONE.                39100002
         B     LOOP6          LOOP                                      39150002
HIT      EQU   *                                                        39200002
         SR    R4,R0          COMPUTE OFFSET INTO BRKINST               39250002
         A     R4,BRKADDR     CREATE A NEW 'TSTGO' ADDRESS              39300002
         SPACE 2                                                        39350002
PSEUDO1  EQU   *                                                        39400002
         L     R5,PPTCB       ADDRESS OF USER TCB.                      39450002
         IKJEGS9G OPSW,TCBADDR=(R5),VALUE=(R4),MF=(E,MNLSVCPL)          39500002
         SPACE 2                                                        39550002
         LTR   R15,R15        CHECK RETURN CODE.                        39600002
         BZ    PSEUDO2        IF ZERO, CONTINUE.                        39650002
SVC97ERR EQU   *                                                        39700002
         NI    TSTFLGS1,XFF-TSTBUILD INDICATE NO DEFER BKPT.            39800002
* ISSUE 'TEST ENDED DUE TO ERROR' MESSAGE                               39812002
* ISSUE 'BREAKPOINT SVC ERROR CODE 4' MESSAGE                           39814002
         LA    R1,MSG4       R1=ADDR OF MESSAGE NUMBERS                 39824002
         BAL   R14,IOMSG     PUT OUT MESSAGES                           39826002
         BAL   R11,IORETCK   TEST IO RETURN CODES                       39830002
         B     PUTEND        TERMINATE.                                 39850002
         SPACE 2                                                        39900002
PSEUDO2  EQU   *                                                        39950002
         XC    TSTGOPSW(L'TSTGOPSW+L'TSTGOWCF+L'TSTRSVD2),TSTGOPSW      40000002
*                             ZERO OUT 'TSTGO' FOR NEXT USE.            40050002
         NI    TSTFLGS3,XFF-TSTSTAI  TURN OFF THE STAI BIT.             40100002
         TM    TSTFLGS2,TSTLDF  COMING FROM LOAD,DEL,GET,FREE.....      40150002
         BZ    SCREQ          NO. GET NEXT SUBCOMMAND.                  40200002
         SPACE 2                                                        40250002
         L     R2,WORKAREA    ADDRESSABILITY.                           40300002
         LA    R2,CWORKLDF-TSTCWORK(,R2) GET PP REGS ADDRESS.           40350002
         L     R5,PPTCB       ADDRESS OF USER TCB.                      40400002
         IKJEGS9G AGPR,TCBADDR=(R5),VALUE=(R2),MF=(E,MNLSVCPL)          40450002
         LTR   R15,R15        CHECK RETURN CODE.                        40500002
         BNZ   SVC97ERR       IF NOT ZERO, PUT MESSAGE.                 40550002
         SPACE 2                                                        40600002
         DELETE EP=IKJEGLDF   DELETE PP PORTION.                        40650002
         SPACE 2                                                        40700002
         NI    TSTFLGS3,XFF-TSTLINK TURN OFF LINK ABEND BIT             40750002
         BAL   R11,DCBFREE    FREE THE DCB IF NOT IN OVERLAY.           40800002
         B     SCREQ          GET THE NEXT SUBCOMMAND.                  41050002
         EJECT                                                          41100002
DCBFREE  EQU   *                                                        41150002
         L     R4,TSTDCB      GET THE Q OF DCBS.                        41200002
         TM    TSTFLGS1,ENDSW IF ENDING CLOSE ALL DCBS AND FREE.        41250002
         BO    FREEDCB        'END' OR 'RUN' HAS BEEN ENTERED.          41300002
         LTR   R4,R4          HIGH BIT ON DON'T FREE,ZERO FIELD ALSO    41350002
         BCR   NEG+Z,R11      NEGATIVE OR ZERO....RETURN.               41400002
FREEDCB  EQU   *                                                        41450002
         LTR   R4,R4          TEST FOR ZERO.                            41500002
         BCR   Z,R11          IF ZERO RETURN.                           41550002
         LA    R5,X4(,R4)     DCB ADDRESS.                              41600002
         TM    DCBOFLGS(R5),X10 CHECK IF OPEN DCB.                      41650002
         BZ    NOCLOSE        DCB ALREADY CLOSED.                       41700002
         MVC   MNLCLOSE(CLLEN),CLFORM CLOSE LIST FORM TO WORKAREA.      41750002
         CLOSE ((R5)),MF=(E,MNLCLOSE) CLOSE.                            41800002
NOCLOSE  EQU   *                                                        41850002
         MVC   TSTDCB(L'TSTDCB),X0(R4) PUSH UP ON QUEUE                 41900002
         FREEMAIN  RC,LV=100,A=(R4),SP=1 FREE DCB CORE.                 41950002
         LTR   R15,R15       WAS FREEMAIN SUCCESSFUL                    41960002
         BZ    DCBFREE       YES CONTINUE                               41970002
* ISSUE 'FREEMAIN SVC ERROR' MESSAGE                                    41990002
         LA    R1,SVC120NO   R1=ADDR OF SVC NUMBER                      41992002
         BAL   R14,IOSVC     PUT OUT SVC ERROR MESSAGE                  41992402
* IGNORE RETURN CODES AND CONTINUE                                      41994002
         B     DCBFREE        GET THE NEXT DCB IF ONE....               42000002
         EJECT                                                          42050002
*********************************************************************** 42100002
*                                                                     * 42150002
*        ENTRY AT THIS LOCATION INDICATES THAT SVC 097 POSTED         * 42200002
*        IKJEGMNL AND THAT TSTGOPSW (IN TCOMTAB) IS ZERO.  THIS       * 42250002
*        SECTION OF CODE DETERMINES IF THE BREAKPOINT LOCATION IS     * 42300002
*        THE SAME AS A LOCATION IN ONE OF THE BREAKPOINT ELEMENTS     * 42350002
*        AND INFORMS THE USER.  IF THE BREAKPOINT LOCATION IS         * 42400002
*        UNKNOWN, A NORMAL TERMINATION MESSAGE IS PUT TO THE USER     * 42450002
*        AND THE USER PROGRAM RESUME ADDRESS IS UPDATED TO POINT      * 42500002
*        TO A SVC 003 INSTRUCTION IN THE CVT.                         * 42550002
*                                                                     * 42600002
*        1 --  DETERMINE IF BREAKPOINT LOCATION IS KNOWN.  IF NOT     * 42650002
*              UPDATE RB RESUME ADDRESS TO POINT TO SVC 003 IN        * 42700002
*              CVT, ISSUE NORMAL TERMINATION MESSAGE, AND BRANCH      * 42750002
*              TO GET NEW SUBCOMMAND.                                 * 42800002
*                                                                     * 42850002
*        2 --  IF BREAKPOINT LOCATION IS KNOWN, BUILD MESSAGE         * 42900002
*              INDICATING LOCATION OF BREAKPOINT AND PUT MESSAGE      * 42950002
*              TO USER IF NOTIFY WAS SPECIFIED ON AT SUBCOMMAND.      * 43000002
*              IF NONOTIFY WAS SPECIFIED OR AFTER MESSAGE IS PUT      * 43050002
*              TO THE TERMINAL, PLACE SUBCOMMAND CHAIN ADDRESS        * 43100002
*              FOR THIS BREAKPOINT IN TCOMTAB AND BRANCH TO GET       * 43150002
*              NEW SUBCOMMAND.                                        * 43200002
*                                                                     * 43250002
*********************************************************************** 43300002
         SPACE 2                                                        43350002
BRKCHK   EQU   *                                                        43400002
         L     R4,ECBPP       R4=ADDR OF SVC 97 SVRB.                   43450002
         L     R4,RBLINK-RBSECT(,R4) ADDRESS OF RB FOR                  43500002
*                             BREAKPOINTED PROGRAM.                     43550002
         L     R5,BREAKTAB    R5=HEAD OF BREAK ELEMENT QUEUE.           43600002
LOOP2A   EQU   *                                                        43650002
         LTR   R5,R5          Q.ANY MORE BREAK ELEMENTS.                43700002
         BNZ   LOOP2B         SEE IF THE PP ENDED.                      43750002
         SPACE 2                                                        43800002
         L     R2,CVTPTR      ADDRESS OF THE CVT                        43850002
         USING CVT,R2         ESTABLISH ADDRESSABILITY TO CVT.          43900002
         LA    R2,CVTEXIT     ADDRESS OF SVC 3 INSTR IN CVT             43950002
         DROP  R2                                                       44000002
         L     R5,PPTCB       ADDRESS OF USER TCB.                      44050002
         IKJEGS9G OPSW,TCBADDR=(R5),VALUE=(R2),MF=(E,MNLSVCPL)          44100002
         LTR   R15,R15        CHECK RETURN CODE.                        44150002
         BNZ   SVC97ERR       IF NOT ZERO, PUT MESSAGE.                 44200002
         SPACE 2                                                        44250002
* ISSUE 'PROGRAM UNDER TEST HAS TERMINATED NORMALLY' MESSAGE            44350002
* ISSUE 'BREAKPOINTS ARE STILL VALID' MESSAGE                           44352002
         LA    R1,MSG5       R1=ADDR OF MESSAGE NUMBERS                 44360002
         BAL   R14,IOMSG     PUT OUT MESSAGES                           44362002
         BAL   R11,IORETCK   TEST IO RETURN CODES                       44370002
         B     SCREQ          ENTER COMMAND MODE.                       44400002
         SPACE 2                                                        44450002
         USING BRKELEM,R5     BREAK ELEMENT ADDRESSABILITY.             44500002
LOOP2B   EQU   *                                                        44550002
         CLC   BRKADDR+X1(X3),RBOPSW+X5-RBSECT(R4) Q.THIS BREAK         44600002
*                             ELEMENT THE ONE.                          44650002
         BE    ATLOC          YES,INITIALIZE CHAIN AND ENTER CMD MODE.  44700002
         L     R5,BRKLINK     NO,CHECK NEXT ELEMENT ON QUEUE.           44750002
         B     LOOP2A         *                                         44800002
         SPACE 2                                                        44850002
* BUILD AND OUTPUT 'AT' MESSAGE WHEN BREAKPOINTS ARE FOUND              44860002
ATLOC    EQU   *                                                        44900002
         L     R1,OUTBUF      R1=OUTPUT BUFFER ADDRESS.                 44950002
         LA    R2,X4(,R1)     R2=IS TO BE CONSTRUCTED MSG PTR.          45000002
         LA    R4,X4         SET INITIAL MESSAGE LENGTH TO 4            45050002
         LA    R3,N160(,R1)   GET WORK ADDRESS FOR CONVERT.             45350002
         UNPK  X1(X5,R3),BRKDISP(X3)  MAKE DISPLACEMENT PRINTABLE.      45400002
         TR    X1(X4,R3),TABLE-XF0    *                                 45450002
         LA    R8,X4          4 BYTES OF OUTPUT FROM UNPK               45500002
ATLOOP   EQU   *                                                        45550002
         CLI   X1(R3),XF0     CHECK IF LEADING ZERO.                    45600002
         BNE   PUTPLUS        PUT A PLUS SIGN BEFORE OFFSET.            45650002
         MVC   X1(X3,R3),X2(R3)  SHIFT LEFT CHARACTER.                  45700002
         BCT   R8,ATLOOP      CHECK FOR MORE LEADING ZEROS.             45750002
         B     ATNAME         BRKDISP EQUALS ZERO.                      45800002
         SPACE 2                                                        45850002
PUTPLUS  EQU   *                                                        45900002
         MVI   X0(R3),PLUS    PUT A PLUS SIGN IN FRONT OF OFFSET        45950002
         LA    R8,X1(,R8)     ADD PLUS SIGN LENGTH.                     46000002
         AR    R4,R8          UPDATE CURRENT LENGTH.                    46050002
         EX    R8,MOVEAT      MOVE '+ (OFFSET)' TO OUTBUFFER.           46100002
         AR    R2,R8          UPDATE OUTBUFFER POINTER.                 46150002
         MVC   X0(FROMLEN,R2),FROM  MOVE ' FROM ' TO OUTBUFFER.         46200002
         LA    R8,FROMLEN     GET LENGTH OF FROM DC                     46250002
         AR    R2,R8          UPDATE OUTBUFFER POINTER.                 46300002
         AR    R4,R8          UPDATE CURRENT LENGTH.                    46350002
ATNAME   EQU   *                                                        46400002
         EX    R4,MOVEAT      MOVE THE 'AT' MSG TO OUTBUFFER.           46450002
         L     R3,BRKNAME     GET THE ADDRESS STRING.                   46500002
         LA    R7,MAXLEN      GET MAX. LENGTH TO PRINT.                 46550002
         SR    R7,R4          R7=MAX.LENGTH-AT MSG LENGTH               46600002
         LH    R6,X0(,R3)     GET ADDR. STRING LENGTH.                  46650002
         CR    R6,R7          DOES ADDR.STRING EXCEED MAX.LENGTH.       46700002
         BL    SKIP1          NO.GO TO SKIP1.                           46750002
         LR    R6,R7          REPLACE WITH MAX. LENGTH.                 46800002
SKIP1    EQU   *                                                        46850002
         LTR   R6,R6          BE SURE LEN GT ZERO              @ZA20612 46900003
         LR    R11,R6         SAVE LENGTH AROUND BCTR INST     @ZA20612 46910003
         BZ    MOVEONE        IF ZERO DO NOT DECREMENT         @ZA20612 46920003
         BCTR  R6,R0          DECREMENT LENGTH FOR MOVE        @ZA20612 46930003
MOVEONE  EQU   *                                               @ZA20612 46940003
         LA    R3,X2(,R3)     POINT TO BRKNAME PLUS TWO                 46950003
         EX    R6,MOVEAT      MOVE THE ADDRESS STRING TO OUTBUFFER      46960003
         LR    R6,R11         RESTORE LENGTH AFTER DECREMENT   @ZA20612 46970003
         AR    R4,R6          GET WHOLE MESSAGE LENGTH                  47000002
         SLL   R4,N16         PUT LENGTH IN 1ST HALF WORD               47050002
         ST    R4,X0(,R1)     PUT LENGTH OF MESSAGE IN OUTBUFFER        47100002
         SPACE 2                                                        47150002
         TM    BRKFLGS,BRKNONOT CHECK IF 'NONOTIFY'                     47200002
         BO    NONOT          YES DON'T PRINT.                          47250002
         LR    R4,R1         R4=ADDRESS OF OUTBUF                       47300002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO PARM LIST        47310002
* ISSUE 'AT' MESSAGE                                                    47320002
         IKJEGSIO MSG,FIRST=M0006,INST11=(ADDR,(R4)),ID=MNL22,         *47330002
               MF=(E,TSTIOPRM)                                          47340002
         BAL   R11,IORETCK   TEST IO RETURN CODES                       47342002
NONOT    EQU   *                                                        47350002
         MVC   SUBCHAIN(L'SUBCHAIN),BRKCHAIN PLACE CHAIN ADDRESS        47400002
*                             IN TCOMTAB.                               47450002
         B     SCREQ          ENTER COMMAND MODE.                       47500002
         EJECT                                                          47550002
**********************************************************************  47600002
*                                                                     * 47650002
*        CONTINUE CHECKING TO DETERMINE THE EVENT WHICH TOOK TEST     * 47700002
*        OUT OF THE WAIT STATE.                                       * 47750002
*                                                                     * 47800002
*        1 --  DETERMINE IF THE STAI RB IS POSTED INDICATING          * 47850002
*              THAT THE USER PROGRAM HAS ABENDED.  IF SO, BRANCH      * 47900002
*              TO PROCESS ABEND.                                      * 47950002
*                                                                     * 48000002
*        2 --  IF STAI ECB IS NOT POSTED, ONLY REMAINING EVENT IS     * 48050002
*              NORMAL TERMINATION OF USER PROGRAM.  ISSUE A           * 48100002
*              MESSAGE THAT USER PROGRAM HAS TERMINATED AND           * 48150002
*              RETURN TO THE TMP.                                     * 48200002
*                                                                     * 48250002
*********************************************************************** 48300002
         SPACE 2                                                        48350002
STAICHK  EQU   *                                                        48400002
         L     R3,ECBTMPS     ADDRESS OF STAI EXIT ECB.                 48450002
         TM    X0(R3),POSTFLAG Q.IS STAI ECB POSTED.                    48500002
         BNZ   STAICHK1       YES,GO PROCESS ABEND                      48550002
* ISSUE 'PROGRAM UNDER TEST HAS TERMINATED' MESSAGE                     48650002
* ISSUE 'BREAKPOINTS ARE NO LONGER VALID' MESSAGE                       48652002
         LA    R1,MSG6       R1=ADDR OF MESSAGE NUMBERS                 48660002
         BAL   R14,IOMSG     PUT OUT MESSAGES                           48662002
         BAL   R11,IORETCK   TEST IO RETURN CODES                       48670002
         B     ENDIT1         FOLD UP TENT.                             48700002
         SPACE 5                                                        48750002
*********************************************************************** 48800002
*                                                                     * 48850002
*        USER PROGRAM HAS ABENDED.  ATTEMPT TO RECOVER ABEND AND      * 48900002
*        NOTIFY USER.                                                 * 48950002
*                                                                     * 49000002
*        1 --  OBTAIN ADDRESS OF TMP (MODULE IKJEFT04) MESSAGE        * 49050002
*              ROUTINE FROM ECB AND BRANCH TO PUT ENDED DUE TO        * 49100002
*              ERROR MESSAGE.                                         * 49150002
*                                                                     * 49200002
*        2 --  DETERMINE IF IKJEGLDF ABENDED WHILE RUNNING UNDER      * 49250002
*              USER TCB.  IF SO, INDICATE A SUBTASK ABEND AND         * 49300002
*              RETURN TO TMP STAI EXIT ROUTINE.                       * 49350002
*                                                                     * 49400002
*        3 --  STARTING WITH THE ABENDING TCB, LOOK FOR MOST          * 49450002
*              RECENT PRB WHICH ABENDED OR WHICH INVOKED THE          * 49500002
*              SUPERVISOR SERVICE WHICH ABENDED.  IF NONE FOUND,      * 49550002
*              ASSUME NOTHING LEFT TO TEST IF USER IS NOT MULTI-      * 49600002
*              TASKING.                                               * 49650002
*                                                                     * 49700002
*        4 --  ONCE A PRB IS FOUND, SAVE THE PRB REGISTERS IN         * 49750002
*              REGSAVE2 AND THE ABEND LOCATION OR PRB RESUME          * 49800002
*              ADDRESS IN TSTGOPSW.  INDICATE A RETRY ADDRESS OF      * 49850002
*              TSTSVC IN TCOMTAB, POST TMP STAI EXIT COMPLETE,        * 49900002
*              AND BRANCH TO WAIT ON PSEUDO BREAKPOINT TO BE HIT.     * 49950002
*                                                                     * 50000002
*********************************************************************** 50050002
         SPACE 2                                                        50100002
STAICHK1 EQU   *                                                        50150002
         MVI   X0(R3),X0      CLEAR ECB.                                50200002
         L     R3,X0(,R3)     LOAD THE ECB.                             50250002
         LTR   R1,R3          PASS PARMS AND CHECK ADDRESS.             50300002
         BZ    SKIP111        DON'T GO.                                 50350002
         L     R15,X0(,R3)    PICK UP THE IKJEFT04 MSG PRINT RTN.       50400002
         BALR  R14,R15        PRINT 'ENDED DUE TO ERROR'                50450002
         SPACE 2                                                        50500002
SKIP111  EQU   *                                                        50550002
         TM    TSTFLGS2,TSTLDF  Q.DID LOAD,DELETE,GET OR FREE BOMB.     50600002
         L     R1,WORKAREA    GET REGS IF LDF ABENDED.                  50650002
         L     R3,REGSAVE2    REGS TO GO TO REGSAVE2 FOR SVC.           50700002
         MVC   X0(N64,R3),CWORKLDF-TSTCWORK(R1) *                       50750002
         BO    SKIP2          YES. WE HAVE PP REGS.                     50800002
         SPACE 2                                                        50850002
         L     R11,TPLPTR    GET TPL ADDRESS                            50860002
         USING TPL,R11       GET TPL ADDRESSABILITY                     50870002
         L     R7,TPLNTCB     GET THE ABENDED TCB.                      50900002
         DROP  R11                                                      50910002
         LA    R7,X0(,R7)     CLEAR THE HIGH BYTE.                      50950002
         ST    R7,PPTCB       SAVE THE TCB FOR STATUS START.            51000002
         L     R6,TCBRBP-TCB(,R7) ADDRESS OF MOST RECENT RB,            51050002
*                             ASSUME PRB FOR STAI EXIT.                 51100002
         TM    RBSTAB1-RBSECT(R6),RBFTP DETERMINE IF A PRB.             51150002
         BNZ   QRETRY         IF FIRST RB IS NOT A PRB, ERROR.          51200002
*                             BRANCH TO CHECK FOR MULTITASKING.         51250002
         TM    RBSTAB2-RBSECT(R6),RBTCBNXT CHECK IF LAST RB.            51300002
         BO    QRETRY         IF ONLY RB ON QUEUE, ERROR.               51350002
         L     R5,RBLINK-RBSECT(,R6) ADDRESS OF NEXT MOST RECENT        51400002
*                             RB, ASSUME SVRB FOR ABEND.                51450002
         TM    RBSTAB1-RBSECT(R5),RBFTSVRB DETERMINE IF A SVRB.         51500002
         BNO   QRETRY         IF NOT A SVRB, ERROR.                     51550002
         TM    RBSTAB2-RBSECT(R5),RBTCBNXT CHECK IF LAST RB.            51600002
         BO    QRETRY         IF LAST RB ON QUEUE, ERROR.               51650002
         L     R4,RBLINK-RBSECT(,R5) ADDRESS OF NEXT MOST RECENT        51700002
*                             RB, ASSUME ABENDING PRB OR IRB.           51750002
         TM    RBSTAB1-RBSECT(R4),RBFTP-RBFTIRB DETERMINE IF A          51800002
*                             PRB OR AN IRB.                            51850002
         BNZ   ABNDSVRB       IF NOT A PRB OR AN IRB, BRANCH TO         51900002
*                             CHECK FOR A SVRB.                         51950002
         LR    R2,R5          SAVE ADDRESS OF PREVIOUS RB IN R2         52250002
         B     AOK            BRANCH TO SET PSEUDO BREAKPOINT.          52300002
         SPACE 2                                                        52350002
ABNDSVRB EQU   *                                                        52400002
         TM    RBSTAB2-RBSECT(R4),RBTCBNXT CHECK IF LAST RB.            52450002
         BO    QRETRY         IF LAST RB ON QUEUE, ERROR.               52500002
         TM    RBSTAB1-RBSECT(R4),RBFTSVRB DETERMINE IF SVRB.           52550002
         BNO   QRETRY         IF NOT A SVRB, ERROR.                     52600002
         LA    R5,RBSECT-RBPREFIX(,R0) LENGTH OF RB PREFIX.             52650002
         SR    R4,R5          SET RB POINTER TO PREFIX.                 52700002
         CLC   RBINTCOD-RBPREFIX(L'RBINTCOD,R4),ABEND DETERMINE         52750002
*                             IF THIS RB ABENDED.                       52800002
         BNE   QRETRY         IF RB DID NOT ABEND, ERROR.               52850002
         AR    R4,R5          RESTORE RB POINTER TO BASIC SECTION       52900002
         SPACE 2                                                        52950002
PRBLOOK  EQU   *                                                        53000002
         LR    R2,R4          SAVE ADDRESS OF PREVIOUS RB IN R2         53010002
         L     R4,RBLINK-RBSECT(,R4) NEXT RB ON QUEUE.                  53050002
         TM    RBSTAB1-RBSECT(R4),RBFTP-RBFTIRB DETERMINE IF PRB        53100002
*                             OR IRB NEXT ON QUEUE.                     53150002
         BZ    AOK            IF A PRB OR IRB, BRANCH TO SET            53200002
*                             PSEUDO BREAKPOINT.                        53250002
         TM    RBSTAB2-RBSECT(R4),RBTCBNXT CHECK IF LAST RB.            53300002
         BZ    PRBLOOK        IF NOT THE END OF THE RB QUEUE,           53350002
*                             CONTINUE SEARCH UNTIL A PRB (OR           53400002
*                             IRB) OR END OF QUEUE OCCURS.              53450002
         SPACE 2                                                        53500002
QRETRY   EQU   *                                                        53550002
         L     R5,TCBOTC-TCB(,R7)  GET THE MOTHER TCB.                  53600002
         LA    R5,X0(,R5)     CLEAR THE HIGH BYTE.                      53650002
         C     R5,TSTTCB      Q. IS THE MOTHER OF TPLNTCB TEST TCB.     53700002
         BNE   SOMTHING       SKIP THE NOTHING CODE.                    53750002
* ISSUE 'NO ACTIVE PROGRAM LEFT' MESSAGE                                53810002
         LA    R1,MSG7       R1=ADDR OF MESSAGE NUMBERS                 53820002
         BAL   R14,IOMSG     PUT OUT MESSAGES                           53822002
         BAL   R11,IORETCK   TEST IO RETURN CODES                       53830002
         B     PUTEND         EXIT.                                     53850002
         SPACE 2                                                        53900002
SOMTHING EQU   *                                                        53950002
         ST    R5,PPTCB       SAVE THE MOTHER AND SET A PSEUDO BRKPT.   54000002
         L     R6,TCBRBP-TCB(,R5) GET THE FIRST RB .                    54050002
LOOP7C   EQU   *                                                        54100002
         TM    RBSTAB1-RBSECT(R6),RBFTSIRB Q.IS THIS A PRB(IRB)         54150002
         BZ    SETPSEUD       YES SET A PSEUDO BRKPT.                   54200002
         L     R6,RBLINK-RBSECT(,R6)  GET THE NEXT RB.                  54250002
         B     LOOP7C         LOOP UNTIL A PRB(IRB) IS FOUND.           54300002
         SPACE 2                                                        54350002
SETPSEUD EQU   *                                                        54400002
         MVC   TSTGOPSW(L'TSTGOPSW),RBOPSW+X4-RBSECT(R6) SAVE THE I.C.  54450002
         MVC   TSTGOWCF(L'TSTGOWCF),RBWCF-RBSECT(R6) SAVE THE WAIT      54500002
*                             COUNT.                                    54550002
         IKJEGS9G WCF,TCBADDR=(R6),MF=(E,MNLSVCPL)                      54600002
         LTR   R15,R15        CHECK RETURN CODE.                        54650002
         BNZ   SVC97ERR       IF NOT ZERO, PUT MESSAGE.                 54700002
         SPACE 2                                                        54750002
         LA    R5,TSTSVC      ADDRESS OF PSEUDO BREAKPT.                54800002
         IKJEGS9G OPSW,TCBADDR=(R6),VALUE=(R5),MF=(E,MNLSVCPL)          54850002
         LTR   R15,R15        CHECK RETURN CODE.                        54900002
         BNZ   SVC97ERR       IF NOT ZERO, PUT MESSAGE.                 54950002
         SPACE 2                                                        55000002
         STATUS START,TCB=(R7) START THE ABENDED TCB.                   55050002
         LA    R0,PPEXIT2     RETRY AT SVC 3                            55100002
         B     STAIPOST       LET THE ABEND CONTINUE.                   55150002
         SPACE 2                                                        55200002
AOK      EQU   *                                                        55250002
         MVC   X0(N64,R3),RBGRSAVE-RBSECT(R2)  SAVE THE REGISTERS.      55300002
         OC    TSTGOPSW(L'TSTGOPSW),RBABOPSW-RBSECT(R4)  SAVE ABEND     55350002
*                             ADDRESS.                                  55400002
         BNZ   SKIP2          SKIP THE NEXT BIT OF CODE.                55450002
         MVC   TSTGOPSW(L'TSTGOPSW),RBOPSW+X4-RBSECT(R4)  SET UP        55500002
*                             TEST GO.                                  55550002
SKIP2    EQU   *                                                        55600002
         OI    TSTFLGS3,TSTSTAI  INDICATE THAT THE DAUGHTER ABENDED.    55650002
         LA    R0,TSTSVC      RETRY ADDRESS.                            55700002
STAIPOST EQU   *                                                        55750002
         L     R11,TPLPTR    GET TPL ADDRESS                            55760002
         USING TPL,R11       GET TPL ADDRESSABILITY                     55770002
         L     R1,TPLECT     GET ECT ADDR FROM TPL          @ZA07137    55777003
         OI    ECTSWS2-ECT(R1),ECTTABND   TELL TMP STAI     @ZA07137    55784003
*                            NOT TO DEQ                     @ZA07137    55791003
         L     R1,TPLNECB     POST ECB FOR THE TMP STAI EXIT RTN.       55800002
         DROP  R11                                                      55810002
         O     R0,POST7F      POST STAI ECB WITH A '7F'                 55850002
         POST  (1),(0)        POST STAI ECB WITH X'7F'.                 55900002
         B     WAIT           ALLOW RECOVERY BY WAITING ON PSEUDO-      55950002
*                             BREAK TO OCCUR.                           56000002
         EJECT                                                          56050002
*********************************************************************** 56100002
*                                                                     * 56150002
*        TERMINATION OF THE TEST SESSION.                             * 56200002
*                                                                     * 56250002
*        THIS SECTION OF CODE WILL TERMINATE THE TEST SESSION.        * 56300002
*        SYSTEM RESOURCES WHICH WERE ALLOCATED ARE CLEANED UP         * 56350002
*        AND CONTROL IS RETURNED TO THE TMP.                          * 56400002
*                                                                     * 56450002
*        1 --  THE TEST ATTENTION EXIT IS CANCELLED.  NOTE-- CARE     * 56500002
*              MUST BE EXERCISED NOT TO CANCEL THE TMP ATTENTION      * 56550002
*              EXIT.                                                  * 56600002
*                                                                     * 56650002
*        2 --  ANY OPEN DCB IS CLOSED AND FREEMAINED.                 * 56700002
*                                                                     * 56750002
*        3 --  DETERMINE IF AN IN-CORE SYMBOL TABLE EXISTS AND        * 56800002
*              FREEMAIN IF PRESENT.                                   * 56850002
*                                                                     * 56900002
*        4 --  DETERMINE IF TERMINATION IS DUE TO AN END OR A RUN     * 56950002
*              SUBCOMMAND.  IF END WAS ENTERED, POST TERMINATION      * 57000002
*              ECB COMPLETE WITH A X'40' AND STOP THE SUBTASK         * 57050002
*              AGAIN.  TMP WILL START AND DETACH SUBTASK NON-         * 57100002
*              DISPATCHABLE. POST THE USER PROGRAM.                   * 57150002
*                                                                     * 57300002
*        5 --  DETERMINE IF A QUEUE OF SVC INFORMATION BLOCKS         * 57350002
*              EXISTS AND FREEMAIN IF PRESENT.                        * 57400002
*                                                                     * 57450002
*        6 --  INVOKE IKJDAIR TO UNALLOCATE DATA SETS FOR USER'S      * 57500002
*              TCB.                                                   * 57550002
*                                                                     * 57600002
*        7 --  ISSUE SVC 097 TO ZERO THE TCBTRN FIELD IN THE TCB.     * 57650002
*                                                                     * 57700002
*        8 --  FREEMAIN THE TCOMTAB AND OTHER WORKAREAS.              * 57750002
*                                                                     * 57800002
*********************************************************************** 57850002
         SPACE 2                                                        57900002
TMPRTURN EQU   *                                                        57950002
         L     R1,TPLPTR      GET TPL ADDRESS            @ZA07137       57950703
         L     R1,TPLECT-TPL(R1)  GET ECT ADDRESS        @ZA07137       57951403
         NI    ECTSWS2-ECT(R1),XFF-ECTTABND RESET NO DEQ @ZA07137       57952103
CANSTAX  LA    R1,RESTART1    IF ABEND DURING END PROCESSING            57989003
         ST    R1,TSTRSTRT    SET RESTART ADDRESS FOR STAE              58050002
         STAX                                                           58100002
         SPACE 2                                                        58150002
RESTART1 EQU   *                                                        58200002
         LA    R1,RESTRT1A    SET NEXT RESTART ADDRESS FOR STAE RTRY    58250002
         ST    R1,TSTRSTRT    DITTO                                     58300002
         L     R1,ECBTMPA     POINT TO ATTN ECB                         58350002
         NI    X0(R1),XFF-TESTATTN+X40  TURN OFF ONE BIT,IF ON          58400002
         BAL   R11,DCBFREE    FREE ALL THE DCBS.                        58450002
         SPACE 2                                                        58500002
RESTRT1A EQU   *                                                        58550002
         LA    R1,RESTRT1B    SET NEXT RESTART ADDRESS FOR STAE RTRY    58600002
         ST    R1,TSTRSTRT    DITTO                                     58650002
         BAL   R11,FREINBUF   CLEAN UP AFTER CP.                        58700002
         SPACE 2                                                        58750002
RESTRT1B EQU   *                                                        58800002
         LA    R1,RESTRT1D    SET NEXT RESTART ADDRESS FOR STAE RTRY    58850002
         ST    R1,TSTRSTRT    DITTO                                     58900002
         L     R2,SYMTABLE    R2=ADDR OF HEAD OF CHAIN.                 58950002
         XC    SYMTABLE(L'SYMTABLE),SYMTABLE  ZERO IN CASE OF ABEND     59000002
LOOP5    EQU   *                                                        59050002
         LTR   R2,R2          Q.END OF CHAIN.                           59100002
         BZ    RESTRT1D       YES,FORTFAHREN MIT DER REINIGUNG.         59150002
         LR    R1,R2          NO,R1=SYMBOL ELEMENT ADDR FOR FREEMAIN.   59200002
         LA    R0,SYSMLEN     GET SYMBOL COMMON SECTION LENGTH          59250002
         AH    R0,SYMBLEN(,R1) GET SYMBOL BLOCK SIZE                    59350002
         L     R2,SYMLINK(,R2) GET THE NEXT ONE.                        59400002
         FREEMAIN RC,LV=(0),A=(1),SP=1  FREE THE SYMBOL ELEMENT.        59450002
         LTR   R15,R15       TEST FOR RC=0                              59460002
         BZ    LOOP5         RC=0,CONTINUE                              59470002
* ISSUE 'FREEMAIN SVC ERROR' MESSAGE                                    59472002
         LA    R1,SVC120NO   R1=ADDR OF SVC NUMBER                      59480002
         BAL   R14,IOSVC     PUT OUT SVC ERROR MESSAGE                  59490002
         B     LOOP5         IGNORE RETURN CODES AND CONTINUE TO        59492002
*                            CHECK FOR ANOTHER SYMBOL ELEMENT.          59500002
         SPACE 2                                                        59550002
RESTRT1D EQU   *                                                        59600002
         LA    R1,ENDIT2      SET NEXT RESTART ADDRESS FOR STA @YM00583 59650002
         ST    R1,TSTRSTRT    DITTO                                     59700002
         BAL   R11,REMOVE     REMOVE THE TERM ELEM OFF THE STACK        59750002
         TM    TSTFLGS1,RUNSW  SHOULD SUBTASK BE DETACHED.              59800002
         BNZ   ENDIT2         YES.DETACH AND WIPE OUT HIS REGI @YM00583 59850002
         L     R3,ECBTERM     TERMONATION ECB FOR THE SUBTASK.          59900002
         XC    X0(X4,R3),X0(R3)  ZERO THE COMPLETION.                   59950002
         MVI   X0(R3),X40     SET TERMINATION ECB FOR DETACH.           60000002
         BAL   R11,STOPALL    FOR END, STOP TWICE - TMP WILL START      60100003
*                              ONCE AND DETACH TASK NON-DISPATCHABLE    60101003
         L     R11,TPLPTR             GET TPL ADDRESS      @ZA07137     60102003
         L     R11,TPLECT-TPL(R11)    GET ECT ADDRESS      @ZA07137     60103003
         OI    ECTSWS-ECT(R11),ECTATRM SET TMP STAI NO POST @ZA07137    60104003
         SPACE 2                                                        60105003
ENDIT2   EQU   *                                                        61050002
         LA    R1,RESTRT1F         SET NEXT RESTART ADDRESS FOR STAE    61060002
         ST    R1,TSTRSTRT         DITTO                                61080002
         L     R2,TSTTRN      GET THE HEAD OF TRN QUEUE.                61100002
         XC    TSTTRN(L'TSTTRN),TSTTRN  ZERO FOR ABEND PROCESSING       61150002
LOOP3    LTR   R1,R2          LINK PTR OR HEAD.                         61200002
         BZ    RESTRT1F       IF ZERO ...END OF QUEUE...                61250002
         L     R14,TSTTCB     LOAD TCB ADDR FOR SVC97   @ZA06226        61260003
         IKJEGS9G FREE,TCBADDR=(R14),VALUE=X0,MF=(E,MNLSVCPL)           61270003
         LTR   R15,R15       TEST FOR RC=0                              61460002
         BZ    RESTRT1F      RC=0,CONTINUE                              61465003
* ISSUE 'FREEMAIN SVC ERROR' MESSAGE                                    61480002
         LA    R1,SVC005NO   R1=ADDR OF SVC NUMBER                      61485003
         BAL   R14,IOSVC     PUT OUT SVC ERROR MESSAGE                  61492002
         SPACE 2                                                        61550002
RESTRT1F EQU   *                                                        61600002
         LA    R1,RESTART2    IF ABEND LINKING TO DAIR                  61650002
         ST    R1,TSTRSTRT    SET RESTART ADDRESS FOR STAE              61700002
         L     R0,TSTTCB      TCB ADDRESS FOR DAIR LIST                 61750002
         L     R1,WORKAREA    ADDRESSABILITY TO GENERAL WORKAREA.       61800002
         MVC   X0(LEN2C,R1),DAIR2C  UNALLOC TCB.                        61850002
         ST    R0,X4(,R1)     TCB TO LIST.                              61900002
         LA    R14,CWORKLDF-TSTCWORK(,R1) ADDR OF DAIR PARM LIST        61950002
         MVC   X0(N12,R14),PARMLIST  MOVE IN FIRST PORTION.             62000002
         L     R11,TPLPTR    GET TPL ADDRESS                            62010002
         USING TPL,R11       GET TPL ADDRESSABILITY                     62020002
         L     R0,TPLPSCB     PSCB TO SECOND PORTION.                   62050002
         DROP  R11                                                      62060002
         STM   R0,R1,N12(R14)  PSCB,DAIR PARMS TO LIST.                 62100002
         LR    R1,R14         OBTAIN ADDRESSABILITY TO CWORKLDF         62150002
         LINK  EP=IKJDAIR     LINK TO DAIR                              62200002
         SPACE 1                                               @YM00538 62200402
BLOWDAIR EQU   *                                                        62202002
RESTART2 EQU   *                                                        62204002
******* IGNORE DAIR RETURN CODES                                        62210002
         SPACE 1                                               @YM00538 62220002
*****    THE FOLLOWING CHANGE IS INSERTED TO FIX A PROBLEM IN  @YM00538 62230002
*****    THE DESIGN OF MAINLINE.  IF THE RUN SUBCOMMAND HAS    @YM00538 62240002
*****    BEEN ISSUED, MAINLINE WILL POST THE P.P. DISPATCH-    @YM00538 62242002
*****    ABILITY ECB AND WAIT ON SVC 97.  SVC 97 WILL IN TURN  @YM00538 62244002
*****    POST MAINLINE WHEN IT HAS FINISHED USE OF TCOMTAB.    @YM00538 62246002
*****    MAINLINE WILL THEN CONTINUE POOCESSING AND FREEMAIN   @YM00538 62248002
*****    TCOMTAB FROM SUBPOOL 1.                               @YM00538 62248402
         TM    TSTFLGS1,RUNSW IS IT THE RUN SUBCOMMAND         @YM00538 62248802
         BZ    RESTRT2B       NO, CONTINUE PROCESSING          @YM00538 62249202
         BAL   R11,START      SET SUBTASK DISPATCHABLE         @YM00538 62249602
         POST  ECBPP          POST PP DISPATCH. ECB            @YM00538 62249702
         L     R1,ECBTST      LOAD R1 WITH ADDR OF ECB         @YM00538 62249902
         XC    X0(X4,R1),X0(R1)  CLEAR THE ECB                 @YM00538 62259902
         WAIT  ECB=(R1)       WAIT FOR SVC 97                  @YM00538 62266602
         BAL   R11,STOP       SET SUBTASK NONDISPATCHABLE      @YM00538 62276602
         SPACE 2                                                        62283302
RESTRT2B EQU   *                                                        62350002
         LA    R1,RESTRT2A    SET NEXT RESTART ADDRESS FOR STAE RTRY    62400002
         ST    R1,TSTRSTRT    DITTO                                     62450002
         L     R5,TSTTCB      ADDRESS OF TMP/TEST TCB.                  62500002
         IKJEGS9G TRN,TCBADDR=(R5),VALUE=X0,MF=(E,MNLSVCPL)             62550002
*****                                                                   62600002
*****    RETURN CODE CHECK IGNORED.                                     62650002
*****                                                                   62700002
         SPACE 2                                                        62790002
RESTRT2A EQU   *                                                        62800002
         ESTAE 0              REMOVE ABEND EXIT                         62850002
         NI    TSTFLGS4,XFF-TSTRERTN TURN OFF RETRY SWITCH              62900002
         LR    R1,R9          R1=TCOMTAB ADDR FOR FREEMAIN.             62950002
         L     R0,MNLTCOML    LENGTH OF AREA TO BE FREED.               63000002
         L     R13,X4(R13)   RELOAD ADDRESS OF TMP SAVE AREA            63050002
         FREEMAIN RU,LV=(0),A=(1),SP=1 FREE TCOMTAB.                    63100002
         SPACE 2                                                        63150002
RESTART4 EQU   *                                                        63200002
         RETURN (14,12),RC=0                                            63250002
         EJECT                                                          63300002
*********************************************************************** 63350002
*                                                                     * 63400002
*        SET SUBTASK NON-DISPATCHABLE SUBROUTINE.                     * 63450002
*                                                                     * 63500002
*********************************************************************** 63550002
         SPACE 2                                                        63600002
STOP     EQU   *                                                        63650002
         NC    TSTGOPSW(L'TSTGOPSW),TSTGOPSW PSEUDO BREAKPOINT.         63700002
         BZ    STOPALL        NO. STOP THEM ALL.                        63750002
         STATUS STOP,TCB=PPTCB  STOP ONLY ONE.                          63800002
         BR    R11            RETURN.                                   63850002
         SPACE 2                                                        63900002
STOPALL  EQU   *                                                        63950002
         TM   TSTFLGS2,TOFFDEF  IS THE STATUS SYNCH INDICATOR  @YM07115 64010002
*                             ON FROM SVC 97..                 @YM07115 64020002
         NOP  STOPSYNH        YES ISSUE THE STATUS SYNCH       @ZA02701 64030003
         STATUS STOP          STOP THEM ALL.                   @YM07115 64040002
         BR    R11            RETURN.                                   64050002
         SPACE 2                                                        64060002
STOPSYNH EQU   *                                                        64070002
         STATUS STOP,SYNCH    STOP THEM ALL.                   @YM04132 64080002
         BR    R11            RETURN.                                   64090002
         SPACE 5                                                        64100002
*********************************************************************** 64150002
*                                                                     * 64200002
*        SET SUBTASK DISPATCHABLE SUBROUTINE.                         * 64250002
*                                                                     * 64300002
*********************************************************************** 64350002
         SPACE 2                                                        64400002
START    EQU   *                                                        64450002
         NC    TSTGOPSW(L'TSTGOPSW),TSTGOPSW PSEUDO BREAKPOINT SET.Q.   64500002
         BZ    STARTALL       NO,START THEM ALL.                        64550002
         STATUS START,TCB=PPTCB YES,START ONLY PP TCB.                  64600002
         BR    R11            RETURN.                                   64650002
         SPACE 2                                                        64700002
STARTALL EQU   *                                                        64750002
         STATUS START         START THEM ALL.                           64800002
         BR    R11            RETURN.                                   64850002
         EJECT                                                          64900002
*********************************************************************** 64950002
*                                                                     * 65000002
*        STACK MANIPULATION SUBROUTINE.                               * 65050002
*                                                                     * 65100002
*        A TERMINAL ELEMENT IS ADDED WHEN TEST INITIALLY              * 65150002
*        DETERMINES THAT INPUT IS FROM THE TERMINAL.  IKJEGIO,        * 65200002
*        UPON GETTING A RETURN CODE FROM PUTGET, TURNS ON A BIT       * 65250002
*        (TSTA IN TCOMTAB) INDICATING INPUT FROM THE TERMINAL.        * 65300002
*        IKJEGMNL WILL PLACE A TERMINAL ELEMENT ON THE STACK          * 65350002
*        WHILE TEST IS RUNNING AND WILL REMOVE IT UPON POSTING        * 65400002
*        THE PROBLEM PROGRAM.  WHEN TEST IS RUNNING FROM ELEMENTS     * 65450002
*        PLACED ON THE INPUT STACK, THIS OPERATION IS NOT DONE.       * 65500002
*                                                                     * 65550002
*********************************************************************** 65600002
         SPACE 2                                                        65650002
ADD      EQU   *                                                        65700002
         SR    R0,R0          ZERO INDICATES 'ADD'                      65750002
         TM    TSTFLGS4,TSTA  RUNNING FROM THE TERMINAL Q.Q.Q.          65800002
         BCR   Z,R11          NO. RETURN.                               65850002
         TM    TSTFLGS4,TSTB  TERM ELEM ALREADY ADDED.                  65900002
         BCR   ONES,R11       YES RETURN.                               65950002
         B     LIKECODE       CONSERVE CODE.                            66000002
         SPACE 2                                                        66050002
REMOVE   EQU   *                                                        66100002
         LA    R0,X1          ONE INDICATES 'REMOVE'                    66150002
         TM    TSTFLGS4,TSTB  IS THERE AN ELEM TO REMOVE.               66200002
         BCR   Z,R11          NO. RETURN.                               66250002
         SPACE 2                                                        66300002
LIKECODE EQU   *                                                        66350002
         MVC   MNLSRPRM(L'TSTUPT+L'TSTECT+L'TSTCPECB),PARMLIST          66400002
*                             INITIALIZE POINTERS TO UPT, ECT AND       66450002
*                             ECB FOR IKJSTCK.                          66500002
         MVC   MNLSTPB(STACKLEN),STACKLST INITIALIZE STACK              66550002
*                             PARAMETER BLOCK.                          66600002
         BCT   R0,ADD1        BRANCH IF REQUEST WAS FOR ADD             66650002
         STACK PARM=MNLSTPB,DELETE=TOP,MF=(E,MNLSRPRM) REMOVE          X66700002
                              TERMINAL FROM STACK.                      66750002
         NI    TSTFLGS4,XFF-TSTB  INDICATES NO ELEMENT.                 66800002
         BR    R11            RETURN.                                   66850002
         SPACE 2                                                        66900002
ADD1     EQU   *                                                        66950002
         STACK PARM=MNLSTPB,TERM=*,MF=(E,MNLSRPRM) ADD TERMINAL        X67000002
                              TO INPUT STACK.                           67050002
         OI    TSTFLGS4,TSTB  INDICATE AN ELEMENT.                      67100002
         BR    R11            RETURN.                                   67150002
         EJECT                                                          67200002
*********************************************************************** 67250002
*                                                                     * 67300002
*        STACK FLUSH SUBROUTINE.                                      * 67350002
*                                                                     * 67400002
*********************************************************************** 67450002
         SPACE 2                                                        67500002
FLUSH    EQU   *                                                        67550002
         XC    SUBCHAIN(L'SUBCHAIN),SUBCHAIN ZERO SUBCOMMAND            67600002
*                             CHAIN POINTER FOR BREAK ELEMENT.          67650002
         SPACE 2                                                        67700002
         TCLEARQ  INPUT                                                 67750002
         TM    TSTFLGS4,TSTA  Q. IS TEST COMING OUT OF A STACK.         67800002
         BCR   ONES,R11       NO. RETURN TO CALLER.                     67850002
         SPACE 2                                                        67900002
         MVC   MNLSRPRM(L'TSTUPT+L'TSTECT+L'TSTCPECB),PARMLIST          67950002
*                             INITIALIZE POINTERS TO UPT, ECT AND       68000002
*                             ECB FOR IKJSTCK.                          68050002
         MVC   MNLSTPB(STACKLEN),STACKLST INITIALIZE STACK              68100002
*                             PARAMETER BLOCK.                          68150002
         STACK PARM=MNLSTPB,DELETE=ALL,MF=(E,MNLSRPRM) DELETE          X68200002
                              ALL BUT FIRST ELEMENT FROM STACK.         68250002
         BR    R11            RETURN.                                   68300002
         EJECT                                                          68350002
*********************************************************************** 68400002
*                                                                     * 68450002
*        RUN SUBCOMMAND EXIT.                                         * 68500002
*                                                                     * 68550002
*        THIS SECTION OF CODE GAINS CONTROL AFTER THE RUN SUBCOM-     * 68600002
*        MAND PROCESSOR HAS COMPLETED.  SPECIAL PROCESSING IS         * 68650002
*        PERFORMED HERE THAT ALLOWS THE USER PROGRAM TO RESUME        * 68700002
*        NORMAL PROCESSING AND TO ALLOW TEST TO RETURN TO THE         * 68750002
*        TMP.                                                         * 68800002
*                                                                     * 68850002
*        1 --  SET-UP TO INVOKE THE END SUBCOMMAND PROCESSOR.         * 68900002
*              END WILL PERFORM PART OF TEST CLEAN-UP AND WILL        * 68950002
*              RETURN TO IKJEGMNL SO THAT NORMAL RETURN IS            * 69000002
*              POSSIBLE.                                              * 69050002
*                                                                     * 69100002
*********************************************************************** 69150002
         SPACE 2                                                        69200002
RUNRTURN EQU   *                                                        69250002
ENDIT1   EQU   *                                                        69300002
         OI    TSTFLGS1,ENDSW TURN ON ENDSW.                            69350002
         L     R2,MNLEGEND    ADDRESS OF END ENTRY IN SUBCOMMAND        69400002
*                             TABLE.                                    69450002
         SR    R3,R3          ZERO LENGTH REGISTER TO INSURE            69500002
         IC    R3,SCDNAME(,R2) VALIDITY OF ONE BYTE LENGTH.             69550002
         LA    R5,SCDENDLD(,R2) ADDRESS OF LOAD MODULE NAME FOR         69600002
*                             END SUBCOMMAND.                           69650002
         LA    R2,SCDSCPPN(,R2) SET REGISTER TO POINT TO COMMON         69700002
*                             SUBCOMMAND NAME.                          69750002
         B     MNLXX170       BRANCH TO INVOKE END SUBCOMMAND.          69800002
         EJECT                                                          69850002
*********************************************************************** 69900002
*                                                                     * 69950002
*        QUALIFICATION SUBROUTINE.                                    * 70000002
*                                                                     * 70050002
*        AUTOMATIC QUALIFICATION TAKES PLACE WHEN A BREAKPOINT IS     * 70100002
*        HIT EITHER UNDER A NEW TCB OR UNDER A NEW RB.                * 70150002
*                                                                     * 70200002
*        1 --  LOCATE ADDRESS OF RB TO BE CHECKED.  THIS ADDRESS      * 70250002
*              IS USED TO UPDATE PPRB IN TCOMTAB.                     * 70300002
*                                                                     * 70350002
*        2 --  WHEN NEW RB IS (A) AN IRB, (B) A PRB FOR A STAE        * 70400002
*              EXIT ROUTINE, OR (C) THE CDE POINTED TO BY THE NEW     * 70450002
*              RB IS FOR THE SAME PROGRAM AT THE SAME ADDRESS,        * 70500002
*              QUALIFICATION IS EITHER NOT POSSIBLE OR NOT            * 70550002
*              NECESSARY.                                             * 70600002
*                                                                     * 70650002
*        3 --  TO QUALIFY A NEW RB, PLACE LOAD MODULE NAME AND        * 70700002
*              ADDRESS IN TCOMTAB AND INVALIDATE CSECT NAME.          * 70750002
*                                                                     * 70800002
*********************************************************************** 70850002
         SPACE 2                                                        70900002
QUAL     EQU   *                                                        70950002
         L     R4,PPTCB       FIND CURRENT RB ADDRESS.                  71000002
         L     R2,TCBRBP-TCB(,R4) *                                     71050002
         L     R1,RBLINK-RBSECT(,R2)  *                                 71100002
         LA    R1,X0(,R1)     CLEAR HIGH BYTE.                          71150002
         L     R2,PPRB        GET LAST BREAKPOINTED RB.                 71200002
         LA    R2,X0(,R2)     CLEAR HIGH BYTE.                          71250002
         ST    R1,PPRB        SAVE THE NEW PRB ADDRESS.                 71300002
         SPACE 2                                                        71350002
         TM    RBSTAB1-RBSECT(R1),RBFTIRB Q.IS THIS AN IRB.             71400002
         BCR   ONES,R11       YES. DO NOT QUALIFY.                      71450002
         SPACE 2                                                        71500002
         L     R14,RBCDE-RBSECT(,R1) GET THE CDE POINTER.               71550002
         LA    R14,X0(,R14)   CLEAR THE HIGH BYTE.                      71600002
         LTR   R14,R14        Q.IS THE CDE PTR. ZERO.                   71650002
         BCR   Z,R11          YES. CANNOT AUTOMATICALLY QUALIFY.        71700002
         SPACE 2                                                        71750002
         CR    R1,R2          Q.IS REQUALIFICATION NEEDED.              71800002
         LR    R2,R14         PUT THE CDE PTR INTO R2                   71850002
         BNE   REQUAL         REQUALIFY TO THIS BREAKPOINTED RB         71900002
         SPACE 2                                                        71950002
         CLC   TSTAQUAL(X8),CDNAME-CDENTRY(R2)  SAME NAME AS BEFORE.    72000002
         BNE   REQUAL         REQUALIFY AUTOMATICLY                     72050002
         CLC   TSTAQUAL+X9(X3),CDENTPT-CDENTRY+X1(R2)  CHECK EPA-ES     72100002
         BCR   EQ,R11         SAME AS BEFORE. RETURN.                   72150002
         SPACE 2                                                        72200002
REQUAL   EQU   *                                                        72250002
         MVC   TSTAQUAL(N12),CDNAME-CDENTRY(R2)  SAVE NAME AND EPA      72300002
         MVI   TSTCURCT,X0    ZERO CURRENT CSECT NAME.                  72350002
         MVC   TSTCURLD(X8),CDNAME-CDENTRY(R2) REINITIALIZE CURRENT     72400002
*                             LOADNAME                                  72450002
         SPACE 2                                                        72500002
MINOR    EQU   *                                                        72550002
         TM    CDATTR-CDENTRY(R2),CDMIN IS IT A MINOR.                  72600002
         LR    R14,R2         SAVE THE CDE ADDRESS                      72650002
         L     R2,CDXLMJP-CDENTRY(,R2) WANT A MAJOR.                    72700002
         BO    MINOR          NOT A MAJOR.                              72750002
         L     R1,XTLNRFAC-XTLST(,R2) GET THE NUMBER OF EXTENTS.        72800002
         SLL   R1,X2          TIMES 4.                                  72850002
         L     R2,XTLMSBLA-XTLST(R1,R2)  GET THE MEMBER ADDRESS.        72900002
         TM    CDATTR2-CDENTRY(R14),CDOLY CHECK IF OVERLAY.             72950002
         BO    OVERLAY        YES. SPECIAL HANDLING.                    73000002
         TM    CDATTR2-CDENTRY(R14),CDSPZ TEST IF OSLOADED              73050002
         BNO   SKIP6          NO --BRANCH                               73100002
         LA    R2,N16(,R2)    ADD 16 TO BYPASS PREFIX.                  73150002
SKIP6    EQU   *                                                        73200002
         ST    R2,PPLOAD      RE-INITIALIZE PPLOAD.                     73250002
         ST    R2,TSTSYMBA    DITTO.                                    73300002
         BR    R11            RETURN.                                   73350002
         SPACE 2                                                        73400002
OVERLAY  EQU   *                                                        73450002
*                             R2=ADDRESS OF SEGTAB CSECT.               73500002
         LR    R15,R2         SAVE THE EXTENT LIST ADDR.                73550002
         LA    R0,X4          SET INDEX,4 REGIONS MAX.                  73600002
         SR    R14,R14        CLEAR FOR INSERT.                         73650002
CKREGION EQU   *                                                        73700002
         IC    R14,X8(,R2)    GET SEG NO. OF REGION                     73750002
         TM    N10(R2),XFF    ARE THEIR ANY MORE REGIONS.               73800002
         BZ    LASTREGN       NO, GO FIGURE LEN OF SEGTAB.              73850002
         BCT   R0,SETNEXT1    YES, GO SET TO CHECK NEXT.                73900002
         SPACE 2                                                        73950002
LASTREGN EQU   *                                                        74000002
         SLL   R14,X2         MULTIPLY LAST SEG NO. BY 4.               74050002
         LA    R2,N24(R14,R15) XLADDR PLUS LENGTH OF SEGTAB.            74100002
*        AT THIS POINT R2'S LOW TWO BITS ARE ZERO.                      74150002
         LA    R14,X4         ALIGN TO A DOUBLE WORD.                   74200002
         NR    R14,R2         DITTO.                                    74250002
*        R14 RESULT IS EITHER 0 OR FOUR.                                74300002
*        IF ON DOUBLE WORD BNDY 0 IS ADDED TO R2                        74350002
*        IF NOT ON A DWORD BNDY 4 IS ADDED TO R2                        74400002
         ALR   R2,R14         DITTO                                     74450002
         B     SKIP6          SAVE ROOT SEG ADDR.                       74500002
SETNEXT1 EQU   *                                                        74550002
         LA    R2,X2(,R2)     DITTO.                                    74600002
         B     CKREGION       LOOP.                                     74650002
         EJECT                                                          74700002
*********************************************************************   74710002
*        THIS IS THE ESTAE RETRY ROUTINE FOR THE MAINLINE MODULE        74750002
*        OF TEST.                                                       74800002
*********************************************************************   74850002
         SPACE                                                          75450002
IKJEGSTR EQU   *                                                        75500002
         DROP  R12                                                      75510002
         USING *,R15           ESTABLISH ADDRESSABILITY                 75550002
         L     R12,BASEAD     *                                         75600002
         DROP  R15            *                                         75650002
         USING IKJEGMNL,R12   REESTABLISH USING                         75660002
         L     R7,CVTPTR      CVTPTR                                    75700002
         USING CVT,R7         ESTABLISH ADDRESSABILITY TO CVT.          75750002
         L     R8,CVTTCBP     NEW/CURRENT WORDS.                        75800002
         DROP  R7                                                       75850002
         L     R8,X4(,R8)     CURRENT TCB.                              75900002
         L     R9,TCBTRN-TCB(R8)  TCOMTAB ADDRESS.                      75950002
         L     R13,REGSAVE1   RESET R13                                 76000002
         LM    R2,R11,N28(R13) RESET R2-R11                             76050002
         B     RETRY1        BRANCH AROUND CONSTANTS                    76150002
BASEAD   DC    A(IKJEGMNL)    MAINLINE ENTRY POINT ADDRESS/BASE         76200002
RETRY1   EQU   *                                                        76300002
         L     R3,TSTRSTRT   FETCH RESTART ADDRESS                      76350002
         LTR   R3,R3         IS THERE ONE?                              76400002
         BZ    RETRY2        NO,GO CHECK FOR END SWITCH                 76450002
         B     REESTAE       GO ISSUE ESTAE                             76500002
RETRY2   EQU   *                                                        76550002
         TM    TSTFLGS1,ENDSW DID ABEND OCCUR AT 'END' TIME?            76600002
         BZ    RETRY3        NO,GO CHECK LINK BIT                       76650002
         LA    R3,TMPRTURN   R3=WHERE TO GO AFTER ESTAE                 76700002
         B     REESTAE       GO ISSUE ESTAE                             76750002
RETRY3   EQU   *                                                        76800002
         TM    TSTFLGS3,TSTLINK DID ABEND OCCUR AT LINK TO SC TIME?     76850002
         BO    RETRY4        YES,GO CHECK FOR PERCOLLATION              76900002
         TM    TSTFLGS2,TSTLDF DID IO AFTER LDF ABEND?                  76910002
         BZ    RETRY3A       NO,CONTINUE                                76920002
         NI    TSTFLGS1,XFF-TSTFIRST TURN OFF IKJEGSTA RETURN BIT       76922002
         NI    TSTFLGS2,XFF-TSTLDF TURN OFF LDF BIT                     76924002
         NI    TSTFLGS4,XFF-TSTESTAE TURN OFF NO ESTAE BIT              76926002
         LA    R3,SCREQ2     R3=WHERE TO GO AFTER ESTAE                 76930002
         B     REESTAE       GO ISSUE ESTAE                             76940002
RETRY3A  EQU   *                                                        76942002
         LA    R3,ENDITERR   RE=WHERE TO GO AFTER ESTAE                 76950002
         B     REESTAE       GO ISSUE ESTAE                             77000002
RETRY4   EQU   *                                                        77050002
         TM    TSTFLGS4,TSTPERC HAS PERCOLLATION HAPPENED?              77100002
         BO    RETRY5        YES,SKIP LINK FAILED MESSAGE               77150002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM LIST         77250002
* ISSUE 'LINK TO SUBCOMMAND FAILED' MESSAGE                             77300002
         IKJEGSIO MSG,FIRST=M0104,INST11=(NUM,I0032),ID=MNL22,         *77350002
               MF=(E,TSTIOPRM)                                          77400002
         BAL   R11,IORETCK   TEST IO RC'S                               77450002
RETRY5   EQU   *                                                        77500002
         NI    TSTFLGS4,XFF-TSTPERC TURN OFF PERCOLLATION BIT           77550002
         NI    TSTFLGS3,XFF-TSTLINK TURN OFF LINK BIT                   77560002
         NI    TSTFLGS1,XFF-TSTPRINT-PCHLSTVL-RANGESW                   77570002
         NI    TSTFLGS2,XFF-TSTXCTL TURN OFF XCTL BIT                   77580002
         TM    TSTFLGS1,TSTBUILD IS BUILD SWITCH ON?                    77590002
         BZ    RETRY6        NO,GO SET UP FOR NEW COMMAND               77592002
         LA    R3,BUILDON    R3=WHERE TO GO AFTER ESTAE                 77594002
         B     REESTAE       GO ISSUE ESTAE                             77596002
RETRY6   EQU   *                                                        77598002
         LA    R3,SCREQ1     R3=WHERE TO GO AFTER ESTAE                 77598402
REESTAE  EQU   *                                                        77598802
         XC    MNLSVCPL,MNLSVCPL CLEAR SVC PARAMETER LIST               77599202
         L     R15,TSTSTAE   R15=ADDR OF ESTAE EXIT ROUTINE             77599302
         ESTAE (R15),OV,PARAM=MNLSPL,XCTL=NO,RECORD=YES,               *77599602
               MF=(E,MNLSVCPL)  OVERLAY PREVIOUS ESTAE                  77599802
         LTR   R15,R15       WAS ESTAE SUCCESSFUL?                      77599902
         BNZ   TMPRTURN      NO,TERMINATE                               77600002
         NI    TSTFLGS4,XFF-TSTRERTN YES,TURN OFF RETRY BIT             77616602
         BR    R3            GO WHERE R3 POINTS TO                      77626602
BUILDON  NI    TSTFLGS1,XFF-TSTBUILD  CONTINUE PROCESSING               77633302
         B     IKJEGCTL       GO TO P.P.                                77650002
PUTEND   EQU   *                                                        77950002
         TM    TSTFLGS1,TSTBUILD  IS THIS A DEFER BREAK POINT           78050002
         BO    BUILDON        YES. IGNORE DEFER BREAK POINT.            78100002
ENDITERR EQU   *                                                        78150002
         BAL   R11,FLUSH      TCLEARQ AND MAYBE STACK FLUSH.            78200002
         B     ENDIT1         GO THRU END PROCESSING.                   78250002
         EJECT                                                          78300002
******************* PROCESS ERRET FOR LINK'S ************************** 78302002
SCANERR  EQU   *                                                        78310002
         LR    R0,R1         LOAD ABEND CODE INTO R0                    78310102
         LA    R1,SVC6NO1    R1=ADDR OF SVC NUMBER AND INSERT NUMBER    78310402
* ISSUE 'LINK SVC ERROR' MESSAGE                                        78310502
         BAL   R14,IOSVC1    PUT OUT SVC ERROR MESSAGE                  78310802
         B     ENDITERR      TERMINATE                                  78311202
SUBCERR  EQU   *                                                        78312002
         LA    R1,SVC6NO2    R1=ADDR OF SVC NUMBER                      78314002
* ISSUE 'LINK SVC ERROR' MESSAGE                                        78316002
         BAL   R14,IOSVC     PUT OUT SVC ERROR MESSAGE                  78318002
         BAL   R11,IORETCK   TEST IO RC'S                               78320002
         SR    R15,R15       CLEAR R15                                  78320402
         B     BLOWSC        RETURN AS THOUGH LINK WAS SUCCESSFUL       78320802
         SPACE 2                                                        78322002
         EJECT                                                          78332002
* COMMON IO MACROS                                                      78342002
IOSVC    EQU   *             COMMON SVC ERROR PROCESSOR                 78372002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM LIST         78382002
         ST    R14,MSAVE14   SAVE RETURN ADDRESS                        78384002
         ST    R2,MSAVE234   SAVE R2 FOR REUSE                          78384102
         LH    R2,X0(R1)     R2=SVC NUMBER                              78384202
         IKJEGSIO SVCERR,SVC=(R2),RC=(R15),ID=MNL22,MF=(E,TSTIOPRM)     78384302
         L     R2,MSAVE234   RESET R2                                   78397402
         L     R14,MSAVE14   RESET RETURN REGISTER                      78407402
         BR    R14           RETURN TO CALLER                           78409402
IOSVC1   EQU   *             COMMON SVC ERROR PROCESSOR                 78409502
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM LIST         78409602
         ST    R14,MSAVE14   SAVE RETURN ADDRESS                        78409702
         STM   R2,R3,MSAVE234 SAVE R2-3 FOR REUSE                       78411302
         LH    R2,X0(R1)     R2=SVC NUMBER                              78413302
         LH    R3,X2(R1)     R3=INSERT NUMBER                           78413402
         IKJEGSIO SVCERR,SVC=(R2),RC=(R15),ABENDRG=(R0),               *78413502
               INST11=(NUM,(R3)),ID=MNL22,MF=(E,TSTIOPRM)               78413902
         LM    R2,R3,MSAVE234 RESET R2-3                                78415002
         L     R14,MSAVE14   RESET RETURN REGISTER                      78415402
         BR    R14           RETURN TO CALLER                           78415802
IOMSG    EQU   *             COMMON MESSAGE PROCESSOR                   78416202
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM LIST         78416602
         STM   R2,R3,MSAVE234 SAVE R2-3 FOR REUSE                       78417002
         ST    R14,MSAVE14   SAVE RETURN ADDRESS                        78418502
         LH    R2,X0(R1)     R2=FIRST LEVEL MESSAGE NUMBER              78420102
         LH    R3,X2(R1)     R3=SECOND LEVEL MESSAGE NUMBER             78421702
         IKJEGSIO MSG,FIRST=(R2),SECOND=(R3),ID=MNL22,MF=(E,TSTIOPRM)   78423302
         LM    R2,R3,MSAVE234 RESET R2-3                                78424902
         L     R14,MSAVE14   RESET RETURN REGISTER                      78426502
         BR    R14           RETURN TO CALLER                           78428102
         EJECT                                                          78601702
MNLCMDCK CLC   X0(*-*,R2),X1(R5)                                        78608602
MNLSCDMV MVC   ECTSCMD-ECT(*-*,R1),X0(R2)                               78615502
MOVEAT   MVC   X0(X0,R2),X0(R3)  MOVE A PART OF AT MSG TO OUTBUF        78622402
*********************************************************************** 78629302
*                                                                     * 78636202
*        CONSTANTS AND DSECTS                                         * 78643102
*                                                                     * 78650002
*********************************************************************** 78700002
         SPACE 5                                                        78750002
MNLEGMN1 DC    V(IKJEGMN1)   ENTRY TO SUBCOMMAND CHAIN PROCESSOR        78760002
MNLEGATN DC    V(IKJEGATN)   ATTENTION EXIT ROUTINE ENTRY POINT.        78800002
MNLSIBLN EQU   *              LENGTH=16  SIB CORE                       78850002
ATTNCODE DC    A(16)          RETURN CODE ON ATTENTION INTERRUPT.       79500002
MNLTCOML DC    A(TCOMLEN+OUTBUFRL+CONAREAL+CWORKLEN+REGSAVEL)           79700002
*                             LENGTH OF TESTS WORK AREA.                79750002
CORETRN  DC    A(12)          CONTROL WORDS FOR SVC INFO BLKS.          79800002
         SPACE                                                          80050002
MNLEGAT  DC    V(IKJEGAID)    AT'S ID                                   80650002
MNLEGEND DC    V(IKJEGEID)    END'S ID                                  80700002
MNLEGPCH DC    V(IKJEGPID)    ADDRESS OF ASSIGN ENTRY IN                80750002
*                             SUBCOMMAND TABLE.                         80800002
MNLIBMTB DC    V(IKJEGSCD)    ADDRESS OF IBM TABLE OF TEST SUBCOMMANDS. 80850002
MNLUSRTB DC    V(IKJEGSCU)    ADDRESS OF USER TABLE OF SUBCOMMANDS.     80900002
POST7F   DC    X'3F000000'   POST CODE OF '7F'                          80950002
TABLE    DC    C'0123456789ABCDEF' TABLE FOR TRANSLATE.                 81050002
FROM     DC    C' FROM '      FROM                                      81100002
FROMLEN  EQU   *-FROM         FROM LENGTH                               81150002
ABEND    DC    XL2'000D'      ABEND CONSTANT.                           81200002
         SPACE                                                          81250002
*        IC TABLE FOR ABENDS                                            81300002
         SPACE                                                          81350002
MNLABTAB DS    0F             ABEND VECTOR TABLE FOR RESIDENT CODE.     81400002
         DC    AL1(DAIRCODE),AL3(BLOWDAIR)  LINK TO DAIR FAILED.        81450002
         DC    AL1(0),AL3(BLOWSC) WILL RETRY, NO MESSAGE PRINTED.       81500002
         DC    X'FFFF'        STOPPER.                                  81550002
SVC6NO1  DC    H'6'          SVC 6 NUMBER                               81552002
         DC    H'43'         INSERT NUMBER FOR ...IKJSCAN...            81554002
SVC6NO2  DC    H'6'          SVC 6 NUMBER                               81556002
SVC10NO  DC    H'10'         SVC 10 NUMBER                              81560002
SVC60NO  DC    H'60'         SVC 60 NUMBER                              81570002
SVC120NO DC    H'120'        SVC 120 NUMBER                             81580002
SVC005NO DC    H'5'           SVC 5 (FREEMAIN)                          81585003
MSG1     DC    H'100'        TEST ENDED DUE TO ERROR                    81590002
         DC    H'0'          NO SECOND LEVEL MESSAGE                    81592002
MSG2     DC    H'3'          INVALID COMMAND                            81594002
         DC    H'200'        COMMAND NOT SUPPORTED                      81596002
MSG3     DC    H'100'        TEST ENDED DUE TO ERROR                    81598002
         DC    H'287'        UNRECOVERABLE SVC ERROR                    81598402
MSG4     DC    H'100'        TEST ENDED DUE TO ERROR                    81598802
         DC    H'273'        BREAKPOINT SVC ERROR CODE 4                81599202
MSG5     DC    H'5'          PROGRAM TERMINATED NORMALLY                81599602
         DC    H'201'        BREAKPOINTS ARE STILL VALID                81599702
MSG6     DC    H'7'          PROGRAM HAS TERMINATED                     81599802
         DC    H'203'        BREAKPOINTS ARE NO LONGER VALID            81599902
MSG7     DC    H'1'          NO ACTIVE PROGRAM LEFT                     81616602
         DC    H'0'          NOSECOND LEVEL MESSAGE                     81626602
         EJECT                                                          81633302
*        LIST FORMS                                                     81650002
         SPACE                                                          81700002
         IKJDAP2C                                                       81750002
DA2CLEN  EQU   *              LENGTH                                    81800002
IKJEGMNL CSECT                                                          81850002
DAIR2C   DC    (DA2CLEN-DAPB2C)X'0'  INITIALIZE BEFORE ORGS             81900002
         ORG   DA2CCD-DAPB2C+DAIR2C    *                                81950002
         DC    XL2'002C'      CODE                                      82000002
         ORG   DA2CLEN-DAPB2C+DAIR2C   *                                82050002
LEN2C    EQU   *-DAIR2C                                                 82100002
         SPACE 5                                                        82150002
MNLSTAX  DS    0F             LIST FORM OF STAX MACRO INSTRUCTION.      82200002
         STAX  0,OBUF=(IKJEGMMT,4),IBUF=(,0),MF=L                       82250002
MNLSTAXL EQU   *-MNLSTAX      LENGTH OF MACRO LIST FORM.                82300002
         SPACE 5                                                        82350002
CLFORM   CLOSE CLFORM,MF=L    *                                         82400002
CLLEN    EQU   *-CLFORM       LENGTH OF CLOSE L-FORM.                   82450002
         SPACE 5                                                        82500002
         SPACE 2                                                        82610002
MNLSPL   IKJEGSPL RTRY=IKJEGSTR,ABNTB=MNLABTAB,MODNM=IKJEGMNL,         *82620002
               TNM=MAINLINE     ESTAE PARAMETER LIST                    82630002
         EJECT                                                          82650002
*        EQUATES                                                        82800002
         SPACE                                                          82850002
DAIRCODE EQU   99             LINK TO DAIR FAILED                       82900002
X0       EQU   0              HEXIDECIMAL 0                             82950002
X1       EQU   1              HEXIDECIMAL 1                             83000002
X2       EQU   2              HEXIDECIMAL 2                             83050002
X3       EQU   3              HEXIDECIMAL 3                             83100002
X4       EQU   4              HEXIDECIMAL 4                             83150002
X5       EQU   5              HEXIDECIMAL 5                             83200002
X6       EQU   6              HEXIDECIMAL 6                             83250002
X7       EQU   7              HEXIDECIMAL 7                             83300002
X8       EQU   8              HEXIDECIMAL 8                             83350002
X9       EQU   9              HEXIDECIMAL 9                             83400002
N0       EQU   0             NUMBER ZERO                                83410002
N2       EQU   2             NUMBER 2                                   83420002
N4       EQU   4             NUMBER 4                                   83430002
N10      EQU   10             NUMBER 10                                 83450002
N12      EQU   12             TWELVE                                    83500002
N16      EQU   16             SIXTEEN                                   83550002
N20      EQU   20            TWENTY                                     83560002
N24      EQU   24             TWENTY FOUR.                              83600002
N28      EQU   28             TWENTY EIGHT.                             83650002
N48      EQU   48            NUMBER 48                                  83660002
N64      EQU   64             SIXTY FOUR.                               83700002
N160     EQU   160            ONE SIXTY                                 83750002
N1       EQU   1             NUMBER 1                                   83760002
N4095    EQU   4095          NUMBER 4095                                83770002
X10      EQU   X'10'                                                    83800002
X40      EQU   X'40'          BLANK,POST FLAG,OR HEX 40                 83850002
XF0      EQU   X'F0'          HEXIDECIMAL F0                            83900002
XFF      EQU   X'FF'          HEXIDECIMAL FF                            83950002
Z        EQU   8              ZERO CODITION CODE.                       84000002
ONES     EQU   1              ONES CONDITION CODE.                      84050002
TESTPOST EQU   X'44'          POST MASK FOR SVC 61 POST.                84100002
MAXLEN   EQU   154            *                                         84150002
POSTFLAG EQU   X'40'          NORMAL POST MASK.                         84200002
HEX00    EQU   X'00'         VALUE OF X00                               84246002
HEXFF    EQU   X'FF'         VALUE OF XFF                               84248002
HEX4D    EQU   X'4D'         VALUE OF X4D-LEFT PAREN                    84248402
HEX5D    EQU   X'5D'         VALUE OF X5D-RIGHT PAREN                   84248802
HEX5E    EQU   X'5E'         VALUE OF X5E-SEMICOLON                     84249202
HEX7D    EQU   X'7D'         VALUE OF X7D-SINGLE QUOTE                  84249602
HEX40    EQU   X'40'         VALUE OF X40-BLANK                         84249702
LEFTPREN EQU   B'00001000'   VALUE OF X08                               84249802
FIRSTQSW EQU   B'00000100'   VALUE OF X04                               84249902
         SPACE 5                                                        84250002
STACKLST STACK MF=L                                                     84300002
STACKLEN EQU   *-STACKLST                                               84350002
         SPACE 5                                                        84400002
SYSMLEN  EQU   16             *                                         84450002
SYMBLEN  EQU   14             DISPLACEMENT INTO BLOCK                   84500002
SYMLINK  EQU   0              LINK FIELD.                               84550002
EQ       EQU   8              EQUAL CONDITION CODE.                     84600002
NE       EQU   7              NE CONDITION CODE.                        84650002
NZ       EQU   7              NZ CONDITION CODE.                        84700002
NEG      EQU   4              NEGATIVE CONDITION.                       84750002
PLUS     EQU   C'+'           PLUS SIGN                                 84800002
MNLLPARN EQU   C'('           LEFT PAREN                                84850002
MNLEQUAL EQU   C'='           EQUAL SIGN                                84900002
TESTATTN EQU   X'48'          TEST ATTN POST CODE.                      84950002
MNLBLANK EQU   C' '           CHARACTER BLANK.                          85000002
SIBLINK  EQU   12             *                                         85050002
DCBOFLGS EQU   48                                                       85100002
         EJECT                                                          85104002
IKJEGMN1 CSECT                                                          85110002
************************************************************            85130002
** HERE WE PROCESS A SUBCOMMAND CHAIN. REGISTER2 WILL BE  **            85140002
** USED TO SCAN THE CHAIN. WE WILL LOOK FOR A SEMI-COLON  **            85142002
** OR ZEROS. WHEN A SEMI-COLON IS FOUND THIS INDICATES    **            85144002
** THE END OF ONE COMMAND. THIS COMMAND WILL BE PLACED    **            85146002
** INTO AN INBUF AREA GOTTEN WITH A GETMAIN. THE ADDRESS  **            85148002
** OF THE GETMAIN AREA IS PLACED INTO INBUF AND RETURN    **            85148402
** TO LABEL SCREQ.WHEN ZERO IS FOUND THIS INDICATES       **            85148802
** END OF THE CHAIN                                       **            85149202
************************************************************            85149602
         SAVE  (14,12),,*    SAVE REGISTERS IN TCOMTAB FOR REUSE        85149702
         USING IKJEGMN1,R12  ESTABLISH ADDRESSABILITY                   85149802
         LR    R12,R15       SET BASE REGISTER                          85154002
         XR    R3,R3         ZERO OUT R3 TO USE IT AS LENGTH COUNTER    85158202
         XR    R4,R4         WE NEED R4 TO ACT AS LENGTH COUNTER        85162402
         L     R2,SUBCHAIN   GET SUBCHAIN ADDRESS FROM TCOMTAB          85166602
         LA    R2,N2(R2)     INCREMENT R2 PASS LENGTH FIELD             85176602
         LR    R6,R2         PLACE BEGINNING ADDR OF CHAIN IN R6        85178602
A005000  EQU   *             EQUATE LABEL TO THS ADDRESS                85180602
         CLI   N0(R2),HEX00  CHECK TO SEE IF WE ARE AT THE END          85182602
         BNE   A00500        IF NOT AT END OF SUBCMD THEN BRANCH        85183002
         NI    TSTFLGS2,HEXFF-LEFTPREN TURN OFF LEFT PREN SW            85183102
         NI    TSTFLGS2,HEXFF-FIRSTQSW TURN OFF FIRST QUOTE SW          85183202
         B     A00519        BRANCH TO TERMINATE SUBCMD PROCESSING      85188802
A00500   EQU   *             EQUATE LABEL TO THIS ADDRESS               85190802
         CLI   N0(R2),HEX4D  DO WE HAVE A LEFT PARENTHESIS              85192802
         BNE   A00501        IF NOT THEN BRANCH TO CHECK SOME MORE      85193202
         TM    TSTFLGS2,FIRSTQSW SEE IF A FIRST QUOTE WAS FOUND         85193602
         BO    A00505        IF ON DONT KEEP COUNT OF THIS PAREN        85194002
         LA    R3,N1(R3)     KEEP A COUNT OF PARENS IN R3               85194102
         OI    TSTFLGS2,LEFTPREN TURN ON LEFT PARENTHESIS FOUND SW      85194202
         B     A00505        BRANCH TO INCREMENT POINTER AND COUNT      85194302
************************************************************            85208202
** THE SUBCOMMAND CHAIN IS SCANNED USING THIS SCAN        **            85218202
** WE CHECK FOR A SEMI-COLON,LEFT AND RIGHT PARENTHESIS   **            85220202
** AND END OF THE CHAIN. IF AN APOSTROPHY IS ENCOUNTERED  **            85220602
** SWITCHES ARE TURNED ON SO THAT SEMI-COLONS AND         **            85221002
** PARENTHESIS OCCURRING WITHIN THE APOSTROPHIES ARE      **            85221402
** DISREGARDED.                                           **            85221802
************************************************************            85221902
A00501   EQU   *             EQUATE LABEL TO THIS ADDRESS               85222002
         CLI   N0(R2),HEX5D  CHECK FOR A RIGHT PAREN                    85222102
         BNE   A00502        IF NOT EQUAL TO ) THEN BRANCH              85226702
         TM    TSTFLGS2,FIRSTQSW  SEE IF A QUOTE HAS BEEN FOUND YET     85228702
         BO    A00505        IF ON THEN DISREGARD THIS PAREN            85230702
         TM    TSTFLGS2,LEFTPREN SEE IF A LEFT PREN SW EXIST            85231102
         BNO   A00505        IF IT DOESNT THEN BRANCH                   85231202
         BCTR  R3,N0         DECREMENT REG3 BY ONE                      85231302
         LTR   R3,R3         SEE IF LEFT AND RIGHT PARENS BALANCE       85231402
         BNZ   A00505        IF THEY DONT THEN BRANCH TO CHECK MORE     85236002
         NI    TSTFLGS2,HEXFF-LEFTPREN TURN OFF LEFT PREN SW SINCE      85238002
*                            RIGHT PARENTHESIS BALANCE IT OUT           85240002
         LA    R4,N1(R4)     INCREMENT LENGTH BY ONE                    85240402
         LA    R2,N1(R2)     LETS SEE IF WE THIS IS THE LAST PAREN      85240502
         CLI   N0(R2),HEX00  CHECK FOR END OF CHAIN INDICATOR           85240602
         BE    A00519        IF WE ARE THEN BRANCH TO LEAVE             85240702
         BCTR  R2,N0         OTHERWISE BACK R2 UP ONE                   85252502
         BCTR  R4,N0         RETURN R4 TO ORIGINAL VALUE                85262502
         B     A00505        BRANCH TO CONTINUE PROCESSING              85264502
A00502   EQU   *             EQUATE LABEL TO THIS ADDRESS               85268402
         CLI   N0(R2),HEX5E  CHECK FOR A SEMICOLON                      85270402
         BNE   A00503        IF NOT A SEMICOLON THEN BRANCH             85272402
         TM    TSTFLGS2,FIRSTQSW SEE IF A QUOTE HAS BEEN FOUND YET      85276302
         BO    A00505        IF ON THEN SKIP THE FOLLOWING CODE         85278302
         TM    TSTFLGS2,LEFTPREN HAS A LEFT PARENTHESIS BEEN FOUND YET  85280302
         BO    A00505        IF ON BRANCH TO CONTINEU THE SCAN          85284202
         BCTR  R2,N0         DECREMENT R2 TO SIMULATE LENGTH FLD        85286202
         B     A00520        OTHERWISE BRANCH TO REMOVE SUBCOMD         85288202
A00503   EQU   *             EQUATE LABEL TO THIS ADDRESS               85298502
         TM    TSTFLGS2,FIRSTQSW SEE IF A QUOTE HAS BEEN FOUND YET      85308502
         BO    A00504        IF ON THEN LEAVE THIS CODE ALONE           85308602
         CLI   N0(R2),HEX7D  IF NOT ON THEN CHECK FOR A QUOTE           85308702
         BNE   A00505        IF NOT PRESENT THEN CONTINUE SCAN          85312102
         OI    TSTFLGS2,FIRSTQSW TURN ON A QUOTE FOUND SW               85314102
         B     A00505        BRANCH TO CONTINUE THE SCAN                85314502
A00504   EQU   *             EQUATE LABEL TO THIS ADDRESS               85314902
         CLI   N0(R2),HEX7D  CHECK FOR AN IMBEDDED QUOTE                85315302
         BNE   A00505        IF NOT ON THEN BRANCH TO CONTINUE SCAN     85315402
         LA    R4,N1(R4)     INCREMENT COUNT REG                        85315502
         LA    R2,N1(R2)     INCREMENT SCAN REG                         85315602
         CLI   N0(R2),HEX7D  CHECK FOR THE MATE OF THE FIRST            85319002
*                            IMBEDDED QUOTE THERE SHOULD BE ONE         85321002
         BE    A00505        IF THERE IS ONE THEN ALL IS OK BRANCH      85321402
*                            TO CONTINUE SCAN                           85321802
         XI    TSTFLGS2,FIRSTQSW TURN OFF THE FIRST QUOTE SW            85322202
         B     A005000       BRANCH TO CONTINUE SCANNING                85322302
************************************************************            85322402
** IN THIS SCAN REGISTER 3 IS USED TO KEEP COUNT OF       **            85322502
** LEFT PARENTHESIS, REGISTER 4 IS USED TO RECORD THE     **            85325902
** LENGTH OF THE INDIVIDUAL COMMANDS IN THE CHAIN         **            85327902
** REGISTER 2 IS USED FOR SCANNING FOR THE VARIOUS        **            85328302
** INDICATORS (EG. SEMI-COLON), REGISTER 6 CONTAINS       **            85328702
** THE BEGINNING ADDRESS OF THE COMMAND. REGISTER         **            85329102
** 5 CONTAINS THE END ADDRESS OF THE CHAIN, REGISTER      **            85329202
** 8 CONTAINS THE LENGTH OF THE CHAIN, REGISTER 7         **            85329302
** IS USED FOR MISCELLANEOUS JOBS.                        **            85329402
************************************************************            85332802
A00505   EQU   *             EQUATE LABEL TO THIS ADDRESS               85334802
         LA    R4,N1(R4)     INCREMENT COUNT REG BY ONE                 85335202
         LA    R2,N1(R2)     INCREMENT SCAN REG BY ONE                  85335602
         B     A005000       BRANCH TO CONTINUE SCAN                    85336002
A00519   EQU   *             EQUATE LABEL TO THIS ADDRESS               85336102
         XR    R2,R2         ZERO OUT REG2                              85336202
A00520   EQU   *             EQUATE LABEL TO THIS ADDRESS               85336302
         ST    R2,SUBCHAIN   UPDATE SUBCHAIN POINTER IN                 85337402
*                            TCOMTAB TO ADDRESS NEXT COMMAND            85339402
A00530   EQU   *             EQUATE LABEL TO THIS ADDRESS               85339502
         LTR   R4,R4         MAKE SURE WE HAVE A LENGTH FOR             85339602
*                            THE SUB-COMMAND                            85348202
         BNZ   A00540        IF WE DO HAVE A CHAIN THEN BRANCH          85350202
         B     A00505        OTHERWISE BRANCH TO PROCESS NEXT CHAIN     85352202
*                            INSTRUCTION                                85354202
A00540   EQU   *             EQUATE LABEL TO THIS ADDRESS               85356202
         LA    R4,N4(N0,R4)  ADD 4 BYTES TO REG4 FOR LL FIELD           85356602
         L     R1,WORKAREA   LOAD ADDR OF WORKAREA FROM                 85356702
*                            TCOMTAB INTO REG1                          85356802
         LA    R7,N48(R1)    PLACE ADDRESS FROM WORKAREA INTO           85356902
*                            REG4 FOR RETURN AREA FROM GETMAIN          85368502
         GETMAIN EC,LV=(4),A=(7),SP=1,MF=(E,(1))                        85378502
*                            ISSUE A GETMAIN FOR INPUT BUF AREA         85378902
         LTR   R15,R15       TEST FOR SUCCESSFUL GETMAIN                85379302
         BNZ   A00600        CANNOT GET REQUESTED CORE,EXIT             85379702
         L     R1,N0(R7)     PLACE ADDR OF GOTTEN CORE IN REG1          85380102
         ST    R1,INBUF      PLACE INPUT ADDRESS INTO TCOMTAB AT        85380202
*                            INBUF                                      85380302
         BCTR  R4,N0         SUBTRACT ONE FROM REG4 SO AS NOT TO        85381102
*                            EXCEED INPUT BUFFER WHEN BLANKED OUT       85381502
         BCTR  R4,N0         DECREMENT FOR EXECUTE                      85381902
         MVI   N0(R1),HEX40  PLACE A BLANK INTO FIRST BYTE OF AREA      85382302
         EX    R4,BLANKOUT   SPREAD THIS BLANK THRU ENTIRE AREA         85382702
         LA    R4,N2(N0,R4)  ADD1 TO R4 TO RESTORE TO ORIGINAL          85385602
         XC    N0(N4,R1),N0(R1) ZERO OUT FIRST 4 BYTES ON INPUT         85387602
         STH   R4,N0(R1)     PLACE LENGTH INTO FIRST 2 BYTES            85389602
*                            OF INPUT BUFFER                            85390002
         LA    R7,N4         PLACE A 4 INTO REG7                        85390402
         SR    R4,R7         SUBTRACT 4 BYTES FOR LENGTH                85390802
         BCTR  R4,N0         DECREMENT R4 BY 1                          85391202
         EX    R4,A00702     MOVE COMMAND FROM SUB-COMMAND              85391302
*                            CHAIN TO INPUT BUFFER                      85393402
A00600   EQU   *             EQUATE LABEL TO THIS ADDRESS               85395402
         RETURN (14,12),RC=(15)                                         85397402
BLANKOUT MVC   N1(N1,R1),N0(R1) BLANKS OUT GETMAIN AREA                 85404402
A00702   MVC   N4(N1,R1),N0(R6)  MOVE SUB-COMMAND FROM CHAIN TO         85404802
*                            INPUT BUFFER                               85404902
IKJEGMNL CSECT                                                          85408502
         EJECT                                                          85412402
         BRKELEM                                                        85416002
         EJECT                                                          85419602
         TSTCWORK                                                       85423202
         EJECT                                                          85426802
         TCOMTAB                                                        85438402
PPEXIT2H EQU   PPEXIT+2       2ND HALF WORD OF PPEXIT                   85450002
         SPACE                                                          85500002
         ORG   TSTMNLWK       DEFINE MAINLINE WORK AREA.                85550002
MNLCFLGS DS    0A             CONTROL FLAGS.                            85600002
MNLCFLG1 DS    X              FLAG BYTE 1.                              85650002
MNLABBRV EQU   B'10000000'    ABBREVIATION FOR SUBCOMMAND NAME.         85700002
*              B'0XXXXXXX'    RESERVED BITS.                            85750002
MNLCFLG2 DS    X              FLAG BYTE 2.                              85800002
MNLUSERT EQU   B'10000000'    USER SUBCOMMAND TABLE CURRENTLY           85850002
*                             BEING SEARCHED.                           85900002
*              B'0XXXXXXX'    RESERVED BITS.                            85950002
MNLRSVD1 DS    H              RESERVED BYTES.                           86000002
         ORG   TSTMNLWK                                                 86010002
MNLSCPRM DS    CL24           SERVICE ROUTINE PARAMETER LIST.           86050002
MNLCSOA  DS    CL8            IKJSCAN OUTPUT AREA.                      86100002
MNLCSFLG DS    F              IKJSCAN FLAG WORD.                        86150002
MNLNOCHK EQU   B'10000000'    DO NOT SYNTAX CHECK COMMAND NAME.         86200002
*              B'0XXXXXXX'    RESERVED BITS.                            86250002
         ORG   TSTMNLWK                                                 86300002
MNLLINKL DS    CL12           LINK SVC PARAMETER LIST.                  86350002
         ORG   TSTMNLWK                                                 86360002
MNLCLOSE DS    F              CLOSE PARAMETER LIST.                     86400002
         ORG   TSTMNLWK                                                 86450002
MNLSVCPL DS    CL16           PARAMETER LIST FOR SVC 097.               86500002
         ORG   TSTMNLWK                                                 86550002
MNLSRPRM DS    CL16          STACK PARM LIST PART 1                     86560002
MNLSTPB  DS    CL8           STACK PARM LIST PART 2                     86600002
         ORG   TSTMNLWK                                                 86610002
MSAVE234 DS    3F            R2-4 SAVE AREA FOR IO                      86620002
MSAVE14  DS    F             R14 SAVE AREA FOR IO                       86630002
         EJECT                                                          86650002
         IKJTPL                                                         86700002
         EJECT                                                          86750002
         IKJPSCB                                                        86760003
         EJECT                                                          86770003
         IKJTCB                                                         86800002
         EJECT                                                          86850002
         IKJECT                                                         86900002
         EJECT                                                          86950002
         IKJCSOA                                                        87000002
         EJECT                                                          87050002
         IKJCSPL                                                        87100002
         EJECT                                                          87150002
         IKJDAPL                                                        87200002
         EJECT                                                          87250002
         IKJRB                                                          87300002
         EJECT                                                          87350002
         IHACDE                                                         87400002
         EJECT                                                          87450002
         IHAXTLST                                                       87500002
         EJECT                                                          87550002
         CVT   DSECT=YES                                                87600002
         EJECT                                                          87650002
         IKJEGSUB (ASSIGN,,IKJEGPCH),                                  X91750002
               (AT,,IKJEGAT),                                          X91800002
               (CALL,,IKJEGCAL),                                       X91850002
               (COPY,C,IKJEGCPY),                                      X91900002
               (DELETE,DEL,IKJEGDEL),                                  X91950003
               (DROP,,IKJEGDRP),                                       X92000002
               (END,,IKJEGEND),                                        X92050002
               (EQUATE,EQ,IKJEGEQU),                                   X92100002
               (FREEMAIN,FREE,IKJEGFRE),                               X92150002
               (GETMAIN,GET,IKJEGGET),                                 X92200002
               (GO,,IKJEGGO),                                          X92250002
               (HELP,H,IKJEGCIV),                                      X92300002
               (LIST,L,IKJEGLST),                                      X92350002
               (LISTDCB,,IKJEGDCB),                                    X92400002
               (LISTDEB,,IKJEGDEB),                                    X92450002
               (LISTMAP,,IKJEGMAP),                                    X92500002
               (LISTPSW,,IKJEGPSW),                                    X92550002
               (LISTTCB,,IKJEGTCB),                                    X92600002
               (LOAD,,IKJEGLOD),                                       X92650002
               (OFF,,IKJEGOFF),                                        X92700002
               (QUALIFY,Q,IKJEGQFY),                                   X92750002
               (RUN,R,IKJEGRUN),                                       X92800002
               (WHERE,W,IKJEGWHR),                                     X92850002
               CSECT=IBM                                                92900002
         EJECT                                                          92950002
         IKJEGSUB CSECT=USER                                            93000002
         EJECT                                                          93050002
IKJEGMNL CSECT                                                          93100002
         DS    0F            FORCE FULLWORD ALIGNMENT                   93110002
MNLPATCH DC    50C'Z'        PATCH AREA                                 93150002
         END                                                            93200002
./  ADD  SSI=33190243,NAME=IKJEGMSG
         TITLE 'IKJEGMSG MODULE - MESSAGES FOR TSO TEST - VS2-REL2     *00001000
                       '                                                00002000
IKJEGMSG CSECT                         ESTABLISH CSECT NAME             00003000
*        END IKJEGMSG;                                             0361 00004000
@DATA    DS    0H                                                       00005000
         DS    0F                                                       00006000
         DS    0F                                                       00007000
         DS    0D                                                       00008000
ATTACHIO DS    CL24                                                     00009000
         ORG   ATTACHIO                                                 00010000
MSG99PTR DC    AL4(MSG99)                                               00011000
MSG199PT DC    AL4(MSG199)                                              00012000
SECONDPT DC    AL4(SECOND)                                              00013000
INSERTPT DC    AL4(INSERT)                                              00014000
SVCTBP   DC    AL4(SVCTB)                                               00015000
SVCTBRCP DC    AL4(SVCTBRC)                                             00016000
         ORG   ATTACHIO+24                                              00017000
MSG99    DS    CL296                                                    00018000
         ORG   MSG99                                                    00019000
@NM00001 DC    F'73'                                                    00020000
@NM00002 DC    AL4(M001)                                                00021000
@NM00003 DC    AL4(M002)                                                00022000
@NM00004 DC    AL4(M003)                                                00023000
@NM00005 DC    AL4(M004)                                                00024000
@NM00006 DC    AL4(M005)                                                00025000
@NM00007 DC    AL4(M006)                                                00026000
@NM00008 DC    AL4(M007)                                                00027000
@NM00009 DC    AL4(M008)                                                00028000
@NM00010 DC    AL4(M009)                                                00029000
@NM00011 DC    AL4(M0010)                                               00030000
@NM00012 DC    AL4(M0011)                                               00031000
@NM00013 DC    AL4(M0012)                                               00032000
@NM00014 DC    AL4(M0013)                                               00033000
@NM00015 DC    AL4(M0014)                                               00034000
@NM00016 DC    AL4(M0015)                                               00035000
@NM00017 DC    AL4(M0016)                                               00036000
@NM00018 DC    AL4(M0017)                                               00037000
@NM00019 DC    AL4(M0018)                                               00038000
@NM00020 DC    AL4(M0019)                                               00039000
@NM00021 DC    AL4(M0020)                                               00040000
@NM00022 DC    AL4(M0021)                                               00041000
@NM00023 DC    AL4(M0022)                                               00042000
@NM00024 DC    AL4(M0023)                                               00043000
@NM00025 DC    AL4(M0024)                                               00044000
@NM00026 DC    AL4(M0025)                                               00045000
@NM00027 DC    AL4(M0026)                                               00046000
@NM00028 DC    AL4(M0027)                                               00047000
@NM00029 DC    AL4(M0028)                                               00048000
@NM00030 DC    AL4(M0029)                                               00049000
@NM00031 DC    AL4(M0030)                                               00050000
@NM00032 DC    AL4(M0031)                                               00051000
@NM00033 DC    AL4(M0032)                                               00052000
@NM00034 DC    AL4(M0033)                                               00053000
@NM00035 DC    AL4(M0034)                                               00054000
@NM00036 DC    AL4(M0035)                                               00055000
@NM00037 DC    AL4(M0036)                                               00056000
@NM00038 DC    AL4(M0037)                                               00057000
@NM00039 DC    AL4(M0038)                                               00058000
@NM00040 DC    AL4(M0039)                                               00059000
@NM00041 DC    AL4(M0040)                                               00060000
@NM00042 DC    AL4(M0041)                                               00061000
@NM00043 DC    AL4(M0042)                                               00062000
@NM00044 DC    AL4(M0043)                                               00063000
@NM00045 DC    AL4(M0044)                                               00064000
@NM00046 DC    AL4(M0045)                                               00065000
@NM00047 DC    AL4(M0046)                                               00066000
@NM00048 DC    AL4(M0047)                                               00067000
@NM00049 DC    AL4(M0048)                                               00068000
@NM00050 DC    AL4(M0049)                                               00069000
@NM00051 DC    AL4(M0050)                                               00070000
@NM00052 DC    AL4(M0051)                                               00071000
@NM00053 DC    AL4(M0052)                                               00072000
@NM00054 DC    AL4(M0053)                                               00073000
@NM00055 DC    AL4(M0054)                                               00074000
@NM00056 DC    AL4(M0055)                                               00075000
@NM00057 DC    AL4(M0056)                                               00076000
@NM00058 DC    AL4(M0057)                                               00077000
@NM00059 DC    AL4(M0058)                                               00078000
@NM00060 DC    AL4(M0059)                                               00079000
@NM00061 DC    AL4(M0060)                                               00080000
@NM00062 DC    AL4(M0061)                                               00081000
@NM00063 DC    AL4(M0062)                                               00082000
@NM00064 DC    AL4(M0063)                                               00083000
@NM00065 DC    AL4(M0064)                                               00084000
@NM00066 DC    AL4(M0065)                                               00085000
@NM00067 DC    AL4(M0066)                                               00086000
@NM00068 DC    AL4(M0067)                                               00087000
@NM00069 DC    AL4(M0068)                                               00088000
@NM00070 DC    AL4(M0069)                                               00089000
@NM00071 DC    AL4(M0070)                                               00090000
@NM00072 DC    AL4(M0071)                                               00091000
@NM00073 DC    AL4(M0072)                                               00092000
@NM00074 DC    AL4(M0073)                                               00093000
@NM00075 DS    0C                                                       00094000
         ORG   MSG99+296                                                00095000
MSG199   DS    CL36                                                     00096000
         ORG   MSG199                                                   00097000
@NM00076 DC    F'107'                                                   00098000
@NM00077 DC    AL4(M0100)                                               00099000
@NM00078 DC    AL4(M0101)                                               00100000
@NM00079 DC    AL4(M0102)                                               00101000
@NM00080 DC    AL4(M0103)                                               00102000
@NM00081 DC    AL4(M0104)                                               00103000
@NM00082 DC    AL4(M0105)                                               00104000
@NM00083 DC    AL4(M0106)                                               00105000
@NM00084 DC    AL4(M0107)                                               00106000
@NM00085 DS    0C                                                       00107000
         ORG   MSG199+36                                                00108000
SECOND   DS    CL404                                                    00109000
         ORG   SECOND                                                   00110000
@NM00086 DC    F'299'                                                   00111000
@NM00087 DC    AL4(M0200)                                               00112000
@NM00088 DC    AL4(M0201)                                               00113000
@NM00089 DC    AL4(M0202)                                               00114000
@NM00090 DC    AL4(M0203)                                               00115000
@NM00091 DC    AL4(M0204)                                               00116000
@NM00092 DC    AL4(M0205)                                               00117000
@NM00093 DC    AL4(M0206)                                               00118000
@NM00094 DC    AL4(M0207)                                               00119000
@NM00095 DC    AL4(M0208)                                               00120000
@NM00096 DC    AL4(M0209)                                               00121000
@NM00097 DC    AL4(M0210)                                               00122000
@NM00098 DC    AL4(M0211)                                               00123000
@NM00099 DC    AL4(M0212)                                               00124000
@NM00100 DC    AL4(M0213)                                               00125000
@NM00101 DC    AL4(M0214)                                               00126000
@NM00102 DC    AL4(M0215)                                               00127000
@NM00103 DC    AL4(M0216)                                               00128000
@NM00104 DC    AL4(M0217)                                               00129000
@NM00105 DC    AL4(M0218)                                               00130000
@NM00106 DC    AL4(M0219)                                               00131000
@NM00107 DC    AL4(M0220)                                               00132000
@NM00108 DC    AL4(M0221)                                               00133000
@NM00109 DC    AL4(M0222)                                               00134000
@NM00110 DC    AL4(M0223)                                               00135000
@NM00111 DC    AL4(M0224)                                               00136000
@NM00112 DC    AL4(M0225)                                               00137000
@NM00113 DC    AL4(M0226)                                               00138000
@NM00114 DC    AL4(M0227)                                               00139000
@NM00115 DC    AL4(M0228)                                               00140000
@NM00116 DC    AL4(M0229)                                               00141000
@NM00117 DC    AL4(M0230)                                               00142000
@NM00118 DC    AL4(M0231)                                               00143000
@NM00119 DC    AL4(M0232)                                               00144000
@NM00120 DC    AL4(M0233)                                               00145000
@NM00121 DC    AL4(M0234)                                               00146000
@NM00122 DC    AL4(M0235)                                               00147000
@NM00123 DC    AL4(M0236)                                               00148000
@NM00124 DC    AL4(M0237)                                               00149000
@NM00125 DC    AL4(M0238)                                               00150000
@NM00126 DC    AL4(M0239)                                               00151000
@NM00127 DC    AL4(M0240)                                               00152000
@NM00128 DC    AL4(M0241)                                               00153000
@NM00129 DC    AL4(M0242)                                               00154000
@NM00130 DC    AL4(M0243)                                               00155000
@NM00131 DC    AL4(M0244)                                               00156000
@NM00132 DC    AL4(M0245)                                               00157000
@NM00133 DC    AL4(M0246)                                               00158000
@NM00134 DC    AL4(M0247)                                               00159000
@NM00135 DC    AL4(M0248)                                               00160000
@NM00136 DC    AL4(M0249)                                               00161000
@NM00137 DC    AL4(M0250)                                               00162000
@NM00138 DC    AL4(M0251)                                               00163000
@NM00139 DC    AL4(M0252)                                               00164000
@NM00140 DC    AL4(M0253)                                               00165000
@NM00141 DC    AL4(M0254)                                               00166000
@NM00142 DC    AL4(M0255)                                               00167000
@NM00143 DC    AL4(M0256)                                               00168000
@NM00144 DC    AL4(M0257)                                               00169000
@NM00145 DC    AL4(M0258)                                               00170000
@NM00146 DC    AL4(M0259)                                               00171000
@NM00147 DC    AL4(M0260)                                               00172000
@NM00148 DC    AL4(M0261)                                               00173000
@NM00149 DC    AL4(M0262)                                               00174000
@NM00150 DC    AL4(M0263)                                               00175000
@NM00151 DC    AL4(M0264)                                               00176000
@NM00152 DC    AL4(M0265)                                               00177000
@NM00153 DC    AL4(M0266)                                               00178000
@NM00154 DC    AL4(M0267)                                               00179000
@NM00155 DC    AL4(M0268)                                               00180000
@NM00156 DC    AL4(M0269)                                               00181000
@NM00157 DC    AL4(M0270)                                               00182000
@NM00158 DC    AL4(M0271)                                               00183000
@NM00159 DC    AL4(M0272)                                               00184000
@NM00160 DC    AL4(M0273)                                               00185000
@NM00161 DC    AL4(M0274)                                               00186000
@NM00162 DC    AL4(M0275)                                               00187000
@NM00163 DC    AL4(M0276)                                               00188000
@NM00164 DC    AL4(M0277)                                               00189000
@NM00165 DC    AL4(M0278)                                               00190000
@NM00166 DC    AL4(M0279)                                               00191000
@NM00167 DC    AL4(M0280)                                               00192000
@NM00168 DC    AL4(M0281)                                               00193000
@NM00169 DC    AL4(M0282)                                               00194000
@NM00170 DC    AL4(M0283)                                               00195000
@NM00171 DC    AL4(M0284)                                               00196000
@NM00172 DC    AL4(M0285)                                               00197000
@NM00173 DC    AL4(M0286)                                               00198000
@NM00174 DC    AL4(M0287)                                               00199000
@NM00175 DC    AL4(M0288)                                               00200000
@NM00176 DC    AL4(M0289)                                               00201000
@NM00177 DC    AL4(M0290)                                               00202000
@NM00178 DC    AL4(M0291)                                               00203000
@NM00179 DC    AL4(M0292)                                               00204000
@NM00180 DC    AL4(M0293)                                               00205000
@NM00181 DC    AL4(M0294)                                               00206000
@NM00182 DC    AL4(M0295)                                               00207000
@NM00183 DC    AL4(M0296)                                               00208000
@NM00184 DC    AL4(M0297)                                               00209000
@NM00185 DC    AL4(M0298)                                               00210000
@NM00186 DC    AL4(M0299)                                               00211000
@NM00187 DS    0C                                                       00212000
         ORG   SECOND+404                                               00213000
INSERT   DS    CL540                                                    00214000
         ORG   INSERT                                                   00215000
@NM00188 DC    F'134'                                                   00216000
@NM00189 DC    AL4(I001)                                                00217000
@NM00190 DC    AL4(I002)                                                00218000
@NM00191 DC    AL4(I003)                                                00219000
@NM00192 DC    AL4(I004)                                                00220000
@NM00193 DC    AL4(I005)                                                00221000
@NM00194 DC    AL4(I006)                                                00222000
@NM00195 DC    AL4(I007)                                                00223000
@NM00196 DC    AL4(I008)                                                00224000
@NM00197 DC    AL4(I009)                                                00225000
@NM00198 DC    AL4(I0010)                                               00226000
@NM00199 DC    AL4(I0011)                                               00227000
@NM00200 DC    AL4(I0012)                                               00228000
@NM00201 DC    AL4(I0013)                                               00229000
@NM00202 DC    AL4(I0014)                                               00230000
@NM00203 DC    AL4(I0015)                                               00231000
@NM00204 DC    AL4(I0016)                                               00232000
@NM00205 DC    AL4(I0017)                                               00233000
@NM00206 DC    AL4(I0018)                                               00234000
@NM00207 DC    AL4(I0019)                                               00235000
@NM00208 DC    AL4(I0020)                                               00236000
@NM00209 DC    AL4(I0021)                                               00237000
@NM00210 DC    AL4(I0022)                                               00238000
@NM00211 DC    AL4(I0023)                                               00239000
@NM00212 DC    AL4(I0024)                                               00240000
@NM00213 DC    AL4(I0025)                                               00241000
@NM00214 DC    AL4(I0026)                                               00242000
@NM00215 DC    AL4(I0027)                                               00243000
@NM00216 DC    AL4(I0028)                                               00244000
@NM00217 DC    AL4(I0029)                                               00245000
@NM00218 DC    AL4(I0030)                                               00246000
@NM00219 DC    AL4(I0031)                                               00247000
@NM00220 DC    AL4(I0032)                                               00248000
@NM00221 DC    AL4(I0033)                                               00249000
@NM00222 DC    AL4(I0034)                                               00250000
@NM00223 DC    AL4(I0035)                                               00251000
@NM00224 DC    AL4(I0036)                                               00252000
@NM00225 DC    AL4(I0037)                                               00253000
@NM00226 DC    AL4(I0038)                                               00254000
@NM00227 DC    AL4(I0039)                                               00255000
@NM00228 DC    AL4(I0040)                                               00256000
@NM00229 DC    AL4(I0041)                                               00257000
@NM00230 DC    AL4(I0042)                                               00258000
@NM00231 DC    AL4(I0043)                                               00259000
@NM00232 DC    AL4(I0044)                                               00260000
@NM00233 DC    AL4(I0045)                                               00261000
@NM00234 DC    AL4(I0046)                                               00262000
@NM00235 DC    AL4(I0047)                                               00263000
@NM00236 DC    AL4(I0048)                                               00264000
@NM00237 DC    AL4(I0049)                                               00265000
@NM00238 DC    AL4(I0050)                                               00266000
@NM00239 DC    AL4(I0051)                                               00267000
@NM00240 DC    AL4(I0052)                                               00268000
@NM00241 DC    AL4(I0053)                                               00269000
@NM00242 DC    AL4(I0054)                                               00270000
@NM00243 DC    AL4(I0055)                                               00271000
@NM00244 DC    AL4(I0056)                                               00272000
@NM00245 DC    AL4(I0057)                                               00273000
@NM00246 DC    AL4(I0058)                                               00274000
@NM00247 DC    AL4(I0059)                                               00275000
@NM00248 DC    AL4(I0060)                                               00276000
@NM00249 DC    AL4(I0061)                                               00277000
@NM00250 DC    AL4(I0062)                                               00278000
@NM00251 DC    AL4(I0063)                                               00279000
@NM00252 DC    AL4(I0064)                                               00280000
@NM00253 DC    AL4(I0065)                                               00281000
@NM00254 DC    AL4(I0066)                                               00282000
@NM00255 DC    AL4(I0067)                                               00283000
@NM00256 DC    AL4(I0068)                                               00284000
@NM00257 DC    AL4(I0069)                                               00285000
@NM00258 DC    AL4(I0070)                                               00286000
@NM00259 DC    AL4(I0071)                                               00287000
@NM00260 DC    AL4(I0072)                                               00288000
@NM00261 DC    AL4(I0073)                                               00289000
@NM00262 DC    AL4(I0074)                                               00290000
@NM00263 DC    AL4(I0075)                                               00291000
@NM00264 DC    AL4(I0076)                                               00292000
@NM00265 DC    AL4(I0077)                                               00293000
@NM00266 DC    AL4(I0078)                                               00294000
@NM00267 DC    AL4(I0079)                                               00295000
@NM00268 DC    AL4(I0080)                                               00296000
@NM00269 DC    AL4(I0081)                                               00297000
@NM00270 DC    AL4(I0082)                                               00298000
@NM00271 DC    AL4(I0083)                                               00299000
@NM00272 DC    AL4(I0084)                                               00300000
@NM00273 DC    AL4(I0085)                                               00301000
@NM00274 DC    AL4(I0086)                                               00302000
@NM00275 DC    AL4(I0087)                                               00303000
@NM00276 DC    AL4(I0088)                                               00304000
@NM00277 DC    AL4(I0089)                                               00305000
@NM00278 DC    AL4(I0090)                                               00306000
@NM00279 DC    AL4(I0091)                                               00307000
@NM00280 DC    AL4(I0092)                                               00308000
@NM00281 DC    AL4(I0093)                                               00309000
@NM00282 DC    AL4(I0094)                                               00310000
@NM00283 DC    AL4(I0095)                                               00311000
@NM00284 DC    AL4(I0096)                                               00312000
@NM00285 DC    AL4(I0097)                                               00313000
@NM00286 DC    AL4(I0098)                                               00314000
@NM00287 DC    AL4(I0099)                                               00315000
@NM00288 DC    AL4(I00100)                                              00316000
@NM00289 DC    AL4(I00101)                                              00317000
@NM00290 DC    AL4(I00102)                                              00318000
@NM00291 DC    AL4(I00103)                                              00319000
@NM00292 DC    AL4(I00104)                                              00320000
@NM00293 DC    AL4(I00105)                                              00321000
@NM00294 DC    AL4(I00106)                                              00322000
@NM00295 DC    AL4(I00107)                                              00323000
@NM00296 DC    AL4(I00108)                                              00324000
@NM00297 DC    AL4(I00109)                                              00325000
@NM00298 DC    AL4(I00110)                                              00326000
@NM00299 DC    AL4(I00111)                                              00327000
@NM00300 DC    AL4(I00112)                                              00328000
@NM00301 DC    AL4(I00113)                                              00329000
@NM00302 DC    AL4(I00114)                                              00330000
@NM00303 DC    AL4(I00115)                                              00331000
@NM00304 DC    AL4(I00116)                                              00332000
@NM00305 DC    AL4(I00117)                                              00333000
@NM00306 DC    AL4(I00118)                                              00334000
@NM00307 DC    AL4(I00119)                                              00335000
@NM00308 DC    AL4(I00120)                                              00336000
@NM00309 DC    AL4(I00121)                                              00337000
@NM00310 DC    AL4(I00122)                                              00338000
@NM00311 DC    AL4(I00123)                                              00339000
@NM00312 DC    AL4(I00124)                                              00340000
@NM00313 DC    AL4(I00125)                                              00341000
@NM00314 DC    AL4(I00126)                                              00342000
@NM00315 DC    AL4(I00127)                                              00343000
@NM00316 DC    AL4(I00128)                                              00344000
@NM00317 DC    AL4(I00129)                                              00345000
@NM00318 DC    AL4(I00130)                                              00346000
@NM00319 DC    AL4(I00131)                                              00347000
@NM00320 DC    AL4(I00132)                                              00348000
@NM00321 DC    AL4(I00133)                                              00349000
@NM00322 DC    AL4(I00134)                                              00350000
@NM00323 DS    0C                                                       00351000
         ORG   INSERT+540                                               00352000
SVCTB    DS    CL32                                                     00353000
         ORG   SVCTB                                                    00354000
@NM00324 DC    AL4(M0499)                                               00355000
@NM00325 DC    F'6'                                                     00356000
@NM00326 DC    AL4(LINKCODE)                                            00357000
@NM00327 DC    AL4(I0036)                                               00358000
@NM00328 DC    F'8'                                                     00359000
@NM00329 DC    AL4(LOADCODE)                                            00360000
@NM00330 DC    AL4(I0023)                                               00361000
@NM00331 DC    F'0'                                                     00362000
         ORG   SVCTB+32                                                 00363000
SVCTBRC  DS    CL32                                                     00364000
         ORG   SVCTBRC                                                  00365000
@NM00420 DC    AL4(M0599)                                               00366000
SVCESTAE DS    CL8                                                      00367000
         ORG   SVCESTAE                                                 00368000
@NM00421 DC    F'60'                                                    00369000
@NM00422 DC    AL4(ESTAERC)                                             00370000
         ORG   SVCTBRC+12                                               00371000
SVCFREEM DS    CL8                                                      00372000
         ORG   SVCFREEM                                                 00373000
@NM00423 DC    F'10'                                                    00374000
@NM00424 DC    AL4(FREERC)                                              00375000
         ORG   SVCTBRC+20                                               00376000
SVCGETMN DS    CL8                                                      00377000
         ORG   SVCGETMN                                                 00378000
@NM00425 DC    F'120'                                                   00379000
@NM00426 DC    AL4(GETRC)                                               00380000
         ORG   SVCTBRC+28                                               00381000
@NM00427 DC    F'0'                                                     00382000
         ORG   SVCTBRC+32                                               00383000
M001     DS    CL44                                                     00384000
         ORG   M001                                                     00385000
@NM00464 DC    AL1(0)                                                   00386000
@NM00465 DC    AL1(0)                                                   00387000
@NM00466 DC    AL1(0)                                                   00388000
@NM00467 DC    AL1(0)                                                   00389000
@NM00468 DC    AL1(0)                                                   00390000
@NM00469 DC    AL1(0)                                                   00391000
@NM00470 DC    H'37'                                                    00392000
@NM00471 DC    H'0'                                                     00393000
@NM00472 DC    CL32'IKJ57002I NO ACTIVE PROGRAM LEFT'                   00394000
@NM00473 DC    CL1' '                                                   00395000
@NM00474 DC    CL1' '                                                   00396000
         ORG   M001+44                                                  00397000
M002     DS    CL45                                                     00398000
         ORG   M002                                                     00399000
@NM00475 DC    AL1(17)                                                  00400000
@NM00476 DC    AL1(33)                                                  00401000
@NM00477 DC    AL1(0)                                                   00402000
@NM00478 DC    AL1(0)                                                   00403000
@NM00479 DC    AL1(0)                                                   00404000
@NM00480 DC    AL1(0)                                                   00405000
@NM00481 DC    H'38'                                                    00406000
@NM00482 DC    H'0'                                                     00407000
@NM00483 DC    CL16'IKJ57005I MEMBER'                                   00408000
@NM00484 DC    CL1' '                                                   00409000
@NM00485 DC    CL15'NOT IN DATA SET'                                    00410000
@NM00486 DC    CL1' '                                                   00411000
@NM00487 DC    CL1' '                                                   00412000
@NM00488 DC    CL1' '                                                   00413000
         ORG   M002+45                                                  00414000
         DS    CL1                                                      00415000
M003     DS    CL37                                                     00416000
         ORG   M003                                                     00417000
@NM00489 DC    AL1(0)                                                   00418000
@NM00490 DC    AL1(0)                                                   00419000
@NM00491 DC    AL1(0)                                                   00420000
@NM00492 DC    AL1(0)                                                   00421000
@NM00493 DC    AL1(0)                                                   00422000
@NM00494 DC    AL1(0)                                                   00423000
@NM00495 DC    H'30'                                                    00424000
@NM00496 DC    H'0'                                                     00425000
@NM00497 DC    CL25'IKJ57021I INVALID COMMAND'                          00426000
@NM00498 DC    CL1' '                                                   00427000
@NM00499 DC    CL1' '                                                   00428000
         ORG   M003+37                                                  00429000
         DS    CL1                                                      00430000
M004     DS    CL74                                                     00431000
         ORG   M004                                                     00432000
@NM00500 DC    AL1(0)                                                   00433000
@NM00501 DC    AL1(0)                                                   00434000
@NM00502 DC    AL1(0)                                                   00435000
@NM00503 DC    AL1(0)                                                   00436000
@NM00504 DC    AL1(0)                                                   00437000
@NM00505 DC    AL1(0)                                                   00438000
@NM00506 DC    H'67'                                                    00439000
@NM00507 DC    H'0'                                                     00440000
@NM00508 DC    CL62'IKJ57022I BREAKPOINT SVC 97 FAILED WITH A PROTECTIOC00441000
               N VIOLATION'                                             00442000
@NM00509 DC    CL1' '                                                   00443000
@NM00510 DC    CL1' '                                                   00444000
         ORG   M004+74                                                  00445000
M005     DS    CL64                                                     00446000
         ORG   M005                                                     00447000
@NM00511 DC    AL1(0)                                                   00448000
@NM00512 DC    AL1(0)                                                   00449000
@NM00513 DC    AL1(0)                                                   00450000
@NM00514 DC    AL1(0)                                                   00451000
@NM00515 DC    AL1(0)                                                   00452000
@NM00516 DC    AL1(0)                                                   00453000
@NM00517 DC    H'57'                                                    00454000
@NM00518 DC    H'0'                                                     00455000
@NM00519 DC    CL52'IKJ57023I PROGRAM UNDER TEST HAS TERMINATED NORMALLC00456000
               Y'                                                       00457000
@NM00520 DC    CL1' '                                                   00458000
@NM00521 DC    CL1' '                                                   00459000
         ORG   M005+64                                                  00460000
M006     DS    CL25                                                     00461000
         ORG   M006                                                     00462000
@NM00522 DC    AL1(13)                                                  00463000
@NM00523 DC    AL1(0)                                                   00464000
@NM00524 DC    AL1(0)                                                   00465000
@NM00525 DC    AL1(0)                                                   00466000
@NM00526 DC    AL1(0)                                                   00467000
@NM00527 DC    AL1(0)                                                   00468000
@NM00528 DC    H'18'                                                    00469000
@NM00529 DC    H'0'                                                     00470000
@NM00530 DC    CL12'IKJ57024I AT'                                       00471000
@NM00531 DC    CL1' '                                                   00472000
@NM00532 DC    CL1' '                                                   00473000
@NM00533 DC    CL1' '                                                   00474000
         ORG   M006+25                                                  00475000
         DS    CL1                                                      00476000
M007     DS    CL56                                                     00477000
         ORG   M007                                                     00478000
@NM00534 DC    AL1(44)                                                  00479000
@NM00535 DC    AL1(0)                                                   00480000
@NM00536 DC    AL1(0)                                                   00481000
@NM00537 DC    AL1(0)                                                   00482000
@NM00538 DC    AL1(0)                                                   00483000
@NM00539 DC    AL1(0)                                                   00484000
@NM00540 DC    H'49'                                                    00485000
@NM00541 DC    H'0'                                                     00486000
@NM00542 DC    CL43'IKJ57025I PROGRAM UNDER TEST HAS TERMINATED'        00487000
@NM00543 DC    CL1' '                                                   00488000
@NM00544 DC    CL1' '                                                   00489000
@NM00545 DC    CL1' '                                                   00490000
         ORG   M007+56                                                  00491000
M008     DS    CL49                                                     00492000
         ORG   M008                                                     00493000
@NM00546 DC    AL1(37)                                                  00494000
@NM00547 DC    AL1(0)                                                   00495000
@NM00548 DC    AL1(0)                                                   00496000
@NM00549 DC    AL1(0)                                                   00497000
@NM00550 DC    AL1(0)                                                   00498000
@NM00551 DC    AL1(0)                                                   00499000
@NM00552 DC    H'42'                                                    00500000
@NM00553 DC    H'0'                                                     00501000
@NM00554 DC    CL36'IKJ57031I INVALID BREAKPOINT ADDRESS'               00502000
@NM00555 DC    CL1' '                                                   00503000
@NM00556 DC    CL1' '                                                   00504000
@NM00557 DC    CL1' '                                                   00505000
         ORG   M008+49                                                  00506000
         DS    CL1                                                      00507000
M009     DS    CL42                                                     00508000
         ORG   M009                                                     00509000
@NM00558 DC    AL1(0)                                                   00510000
@NM00559 DC    AL1(0)                                                   00511000
@NM00560 DC    AL1(0)                                                   00512000
@NM00561 DC    AL1(0)                                                   00513000
@NM00562 DC    AL1(0)                                                   00514000
@NM00563 DC    AL1(0)                                                   00515000
@NM00564 DC    H'35'                                                    00516000
@NM00565 DC    H'0'                                                     00517000
@NM00566 DC    CL30'IKJ57036I NO BREAKPOINTS FOUND'                     00518000
@NM00567 DC    CL1' '                                                   00519000
@NM00568 DC    CL1' '                                                   00520000
         ORG   M009+42                                                  00521000
M0010    DS    CL45                                                     00522000
         ORG   M0010                                                    00523000
@NM00569 DC    AL1(26)                                                  00524000
@NM00570 DC    AL1(0)                                                   00525000
@NM00571 DC    AL1(0)                                                   00526000
@NM00572 DC    AL1(0)                                                   00527000
@NM00573 DC    AL1(0)                                                   00528000
@NM00574 DC    AL1(0)                                                   00529000
@NM00575 DC    H'38'                                                    00530000
@NM00576 DC    H'0'                                                     00531000
@NM00577 DC    CL25'IKJ57060I VALUE BEGINNING'                          00532000
@NM00578 DC    CL1' '                                                   00533000
@NM00579 DC    CL7'INVALID'                                             00534000
@NM00580 DC    CL1' '                                                   00535000
@NM00581 DC    CL1' '                                                   00536000
         ORG   M0010+45                                                 00537000
         DS    CL1                                                      00538000
M0011    DS    CL55                                                     00539000
         ORG   M0011                                                    00540000
@NM00582 DC    AL1(43)                                                  00541000
@NM00583 DC    AL1(0)                                                   00542000
@NM00584 DC    AL1(0)                                                   00543000
@NM00585 DC    AL1(0)                                                   00544000
@NM00586 DC    AL1(0)                                                   00545000
@NM00587 DC    AL1(0)                                                   00546000
@NM00588 DC    H'48'                                                    00547000
@NM00589 DC    H'0'                                                     00548000
@NM00590 DC    CL42'IKJ57063I LENGTH ERROR FOR VALUE BEGINNING'         00549000
@NM00591 DC    CL1' '                                                   00550000
@NM00592 DC    CL1' '                                                   00551000
@NM00593 DC    CL1' '                                                   00552000
         ORG   M0011+55                                                 00553000
         DS    CL1                                                      00554000
M0012    DS    CL58                                                     00555000
         ORG   M0012                                                    00556000
@NM00594 DC    AL1(46)                                                  00557000
@NM00595 DC    AL1(0)                                                   00558000
@NM00596 DC    AL1(0)                                                   00559000
@NM00597 DC    AL1(0)                                                   00560000
@NM00598 DC    AL1(0)                                                   00561000
@NM00599 DC    AL1(0)                                                   00562000
@NM00600 DC    H'51'                                                    00563000
@NM00601 DC    H'0'                                                     00564000
@NM00602 DC    CL45'IKJ57064I DATA TYPE ERROR FOR VALUE BEGINNING'      00565000
@NM00603 DC    CL1' '                                                   00566000
@NM00604 DC    CL1' '                                                   00567000
@NM00605 DC    CL1' '                                                   00568000
         ORG   M0012+58                                                 00569000
M0013    DS    CL55                                                     00570000
         ORG   M0013                                                    00571000
@NM00606 DC    AL1(0)                                                   00572000
@NM00607 DC    AL1(0)                                                   00573000
@NM00608 DC    AL1(0)                                                   00574000
@NM00609 DC    AL1(0)                                                   00575000
@NM00610 DC    AL1(0)                                                   00576000
@NM00611 DC    AL1(0)                                                   00577000
@NM00612 DC    H'48'                                                    00578000
@NM00613 DC    H'0'                                                     00579000
@NM00614 DC    CL43'IKJ57066I DATA AREA CONTAINED BREAKPOINT(S)'        00580000
@NM00615 DC    CL1' '                                                   00581000
@NM00616 DC    CL1' '                                                   00582000
         ORG   M0013+55                                                 00583000
         DS    CL1                                                      00584000
M0014    DS    CL62                                                     00585000
         ORG   M0014                                                    00586000
@NM00617 DC    AL1(0)                                                   00587000
@NM00618 DC    AL1(0)                                                   00588000
@NM00619 DC    AL1(0)                                                   00589000
@NM00620 DC    AL1(0)                                                   00590000
@NM00621 DC    AL1(0)                                                   00591000
@NM00622 DC    AL1(0)                                                   00592000
@NM00623 DC    H'55'                                                    00593000
@NM00624 DC    H'0'                                                     00594000
@NM00625 DC    CL50'IKJ57061I UNABLE TO MODIFY CONTENTS OF REGISTER(S)' 00595000
@NM00626 DC    CL1' '                                                   00596000
@NM00627 DC    CL1' '                                                   00597000
         ORG   M0014+62                                                 00598000
M0015    DS    CL65                                                     00599000
         ORG   M0015                                                    00600000
@NM00628 DC    AL1(0)                                                   00601000
@NM00629 DC    AL1(0)                                                   00602000
@NM00630 DC    AL1(0)                                                   00603000
@NM00631 DC    AL1(0)                                                   00604000
@NM00632 DC    AL1(0)                                                   00605000
@NM00633 DC    AL1(0)                                                   00606000
@NM00634 DC    H'58'                                                    00607000
@NM00635 DC    H'0'                                                     00608000
@NM00636 DC    CL53'IKJ57209I DCB FIELD NAME REQUIRED AFTER FIELD KEYWOC00609000
               RD'                                                      00610000
@NM00637 DC    CL1' '                                                   00611000
@NM00638 DC    CL1' '                                                   00612000
         ORG   M0015+65                                                 00613000
         DS    CL1                                                      00614000
M0016    DS    CL65                                                     00615000
         ORG   M0016                                                    00616000
@NM00639 DC    AL1(0)                                                   00617000
@NM00640 DC    AL1(0)                                                   00618000
@NM00641 DC    AL1(0)                                                   00619000
@NM00642 DC    AL1(0)                                                   00620000
@NM00643 DC    AL1(0)                                                   00621000
@NM00644 DC    AL1(0)                                                   00622000
@NM00645 DC    H'58'                                                    00623000
@NM00646 DC    H'0'                                                     00624000
@NM00647 DC    CL53'IKJ57219I TCB FIELD NAME REQUIRED AFTER FIELD KEYWOC00625000
               RD'                                                      00626000
@NM00648 DC    CL1' '                                                   00627000
@NM00649 DC    CL1' '                                                   00628000
         ORG   M0016+65                                                 00629000
         DS    CL1                                                      00630000
M0017    DS    CL30                                                     00631000
         ORG   M0017                                                    00632000
@NM00650 DC    AL1(18)                                                  00633000
@NM00651 DC    AL1(0)                                                   00634000
@NM00652 DC    AL1(0)                                                   00635000
@NM00653 DC    AL1(0)                                                   00636000
@NM00654 DC    AL1(0)                                                   00637000
@NM00655 DC    AL1(0)                                                   00638000
@NM00656 DC    H'23'                                                    00639000
@NM00657 DC    H'0'                                                     00640000
@NM00658 DC    CL17'IKJ57241I INVALID'                                  00641000
@NM00659 DC    CL1' '                                                   00642000
@NM00660 DC    CL1' '                                                   00643000
@NM00661 DC    CL1' '                                                   00644000
         ORG   M0017+30                                                 00645000
M0018    DS    CL55                                                     00646000
         ORG   M0018                                                    00647000
@NM00662 DC    AL1(0)                                                   00648000
@NM00663 DC    AL1(0)                                                   00649000
@NM00664 DC    AL1(0)                                                   00650000
@NM00665 DC    AL1(0)                                                   00651000
@NM00666 DC    AL1(0)                                                   00652000
@NM00667 DC    AL1(0)                                                   00653000
@NM00668 DC    H'48'                                                    00654000
@NM00669 DC    H'0'                                                     00655000
@NM00670 DC    CL43'IKJ57242I RANGE EXTENDS INTO PROTECTED CORE'        00656000
@NM00671 DC    CL1' '                                                   00657000
@NM00672 DC    CL1' '                                                   00658000
         ORG   M0018+55                                                 00659000
         DS    CL1                                                      00660000
M0019    DS    CL46                                                     00661000
         ORG   M0019                                                    00662000
@NM00673 DC    AL1(34)                                                  00663000
@NM00674 DC    AL1(0)                                                   00664000
@NM00675 DC    AL1(0)                                                   00665000
@NM00676 DC    AL1(0)                                                   00666000
@NM00677 DC    AL1(0)                                                   00667000
@NM00678 DC    AL1(0)                                                   00668000
@NM00679 DC    H'39'                                                    00669000
@NM00680 DC    H'0'                                                     00670000
@NM00681 DC    CL33'IKJ57243I INVALID LENGTH FOR TYPE'                  00671000
@NM00682 DC    CL1' '                                                   00672000
@NM00683 DC    CL1' '                                                   00673000
@NM00684 DC    CL1' '                                                   00674000
         ORG   M0019+46                                                 00675000
M0020    DS    CL44                                                     00676000
         ORG   M0020                                                    00677000
@NM00685 DC    AL1(32)                                                  00678000
@NM00686 DC    AL1(0)                                                   00679000
@NM00687 DC    AL1(0)                                                   00680000
@NM00688 DC    AL1(0)                                                   00681000
@NM00689 DC    AL1(0)                                                   00682000
@NM00690 DC    AL1(0)                                                   00683000
@NM00691 DC    H'37'                                                    00684000
@NM00692 DC    H'0'                                                     00685000
@NM00693 DC    CL31'IKJ57244I INVALID DATA FOR TYPE'                    00686000
@NM00694 DC    CL1' '                                                   00687000
@NM00695 DC    CL1' '                                                   00688000
@NM00696 DC    CL1' '                                                   00689000
         ORG   M0020+44                                                 00690000
M0021    DS    CL50                                                     00691000
         ORG   M0021                                                    00692000
@NM00697 DC    AL1(38)                                                  00693000
@NM00698 DC    AL1(0)                                                   00694000
@NM00699 DC    AL1(0)                                                   00695000
@NM00700 DC    AL1(0)                                                   00696000
@NM00701 DC    AL1(0)                                                   00697000
@NM00702 DC    AL1(0)                                                   00698000
@NM00703 DC    H'43'                                                    00699000
@NM00704 DC    H'0'                                                     00700000
@NM00705 DC    CL37'IKJ57245I INVALID INSTRUCTION CODE AT'              00701000
@NM00706 DC    CL1' '                                                   00702000
@NM00707 DC    CL1' '                                                   00703000
@NM00708 DC    CL1' '                                                   00704000
         ORG   M0021+50                                                 00705000
M0022    DS    CL46                                                     00706000
         ORG   M0022                                                    00707000
@NM00709 DC    AL1(34)                                                  00708000
@NM00710 DC    AL1(0)                                                   00709000
@NM00711 DC    AL1(0)                                                   00710000
@NM00712 DC    AL1(0)                                                   00711000
@NM00713 DC    AL1(0)                                                   00712000
@NM00714 DC    AL1(0)                                                   00713000
@NM00715 DC    H'39'                                                    00714000
@NM00716 DC    H'0'                                                     00715000
@NM00717 DC    CL33'IKJ57246I LIST REQUEST INCOMPLETE'                  00716000
@NM00718 DC    CL1' '                                                   00717000
@NM00719 DC    CL1' '                                                   00718000
@NM00720 DC    CL1' '                                                   00719000
         ORG   M0022+46                                                 00720000
M0023    DS    CL45                                                     00721000
         ORG   M0023                                                    00722000
@NM00721 DC    AL1(0)                                                   00723000
@NM00722 DC    AL1(0)                                                   00724000
@NM00723 DC    AL1(0)                                                   00725000
@NM00724 DC    AL1(0)                                                   00726000
@NM00725 DC    AL1(0)                                                   00727000
@NM00726 DC    AL1(0)                                                   00728000
@NM00727 DC    H'38'                                                    00729000
@NM00728 DC    H'0'                                                     00730000
@NM00729 DC    CL33'IKJ57247I INVALID DATA FOR TYPE P'                  00731000
@NM00730 DC    CL1' '                                                   00732000
@NM00731 DC    CL1' '                                                   00733000
         ORG   M0023+45                                                 00734000
         DS    CL1                                                      00735000
M0024    DS    CL40                                                     00736000
         ORG   M0024                                                    00737000
@NM00732 DC    AL1(28)                                                  00738000
@NM00733 DC    AL1(0)                                                   00739000
@NM00734 DC    AL1(0)                                                   00740000
@NM00735 DC    AL1(0)                                                   00741000
@NM00736 DC    AL1(0)                                                   00742000
@NM00737 DC    AL1(0)                                                   00743000
@NM00738 DC    H'33'                                                    00744000
@NM00739 DC    H'0'                                                     00745000
@NM00740 DC    CL27'IKJ57272I UNABLE TO QUALIFY'                        00746000
@NM00741 DC    CL1' '                                                   00747000
@NM00742 DC    CL1' '                                                   00748000
@NM00743 DC    CL1' '                                                   00749000
         ORG   M0024+40                                                 00750000
M0025    DS    CL58                                                     00751000
         ORG   M0025                                                    00752000
@NM00744 DC    AL1(0)                                                   00753000
@NM00745 DC    AL1(0)                                                   00754000
@NM00746 DC    AL1(0)                                                   00755000
@NM00747 DC    AL1(0)                                                   00756000
@NM00748 DC    AL1(0)                                                   00757000
@NM00749 DC    AL1(0)                                                   00758000
@NM00750 DC    H'51'                                                    00759000
@NM00751 DC    H'0'                                                     00760000
@NM00752 DC    CL46'IKJ57273I LOADNAME REQUIRED WITH TCB PARAMETER'     00761000
@NM00753 DC    CL1' '                                                   00762000
@NM00754 DC    CL1' '                                                   00763000
         ORG   M0025+58                                                 00764000
M0026    DS    CL43                                                     00765000
         ORG   M0026                                                    00766000
@NM00755 DC    AL1(0)                                                   00767000
@NM00756 DC    AL1(0)                                                   00768000
@NM00757 DC    AL1(0)                                                   00769000
@NM00758 DC    AL1(0)                                                   00770000
@NM00759 DC    AL1(0)                                                   00771000
@NM00760 DC    AL1(0)                                                   00772000
@NM00761 DC    H'36'                                                    00773000
@NM00762 DC    H'0'                                                     00774000
@NM00763 DC    CL31'IKJ57274I SPECIFIED TCB IGNORED'                    00775000
@NM00764 DC    CL1' '                                                   00776000
@NM00765 DC    CL1' '                                                   00777000
         ORG   M0026+43                                                 00778000
         DS    CL1                                                      00779000
M0027    DS    CL52                                                     00780000
         ORG   M0027                                                    00781000
@NM00766 DC    AL1(40)                                                  00782000
@NM00767 DC    AL1(0)                                                   00783000
@NM00768 DC    AL1(0)                                                   00784000
@NM00769 DC    AL1(0)                                                   00785000
@NM00770 DC    AL1(0)                                                   00786000
@NM00771 DC    AL1(0)                                                   00787000
@NM00772 DC    H'45'                                                    00788000
@NM00773 DC    H'0'                                                     00789000
@NM00774 DC    CL39'IKJ57277I QUALIFICATION IS UNDER TCB AT'            00790000
@NM00775 DC    CL1' '                                                   00791000
@NM00776 DC    CL1' '                                                   00792000
@NM00777 DC    CL1' '                                                   00793000
         ORG   M0027+52                                                 00794000
M0028    DS    CL39                                                     00795000
         ORG   M0028                                                    00796000
@NM00778 DC    AL1(18)                                                  00797000
@NM00779 DC    AL1(0)                                                   00798000
@NM00780 DC    AL1(0)                                                   00799000
@NM00781 DC    AL1(0)                                                   00800000
@NM00782 DC    AL1(0)                                                   00801000
@NM00783 DC    AL1(0)                                                   00802000
@NM00784 DC    H'32'                                                    00803000
@NM00785 DC    H'0'                                                     00804000
@NM00786 DC    CL17'IKJ57280I ADDRESS'                                  00805000
@NM00787 DC    CL1' '                                                   00806000
@NM00788 DC    CL9'NOT FOUND'                                           00807000
@NM00789 DC    CL1' '                                                   00808000
@NM00790 DC    CL1' '                                                   00809000
         ORG   M0028+39                                                 00810000
         DS    CL1                                                      00811000
M0029    DS    CL56                                                     00812000
         ORG   M0029                                                    00813000
@NM00791 DC    AL1(17)                                                  00814000
@NM00792 DC    AL1(0)                                                   00815000
@NM00793 DC    AL1(0)                                                   00816000
@NM00794 DC    AL1(0)                                                   00817000
@NM00795 DC    AL1(0)                                                   00818000
@NM00796 DC    AL1(0)                                                   00819000
@NM00797 DC    H'49'                                                    00820000
@NM00798 DC    H'0'                                                     00821000
@NM00799 DC    CL16'IKJ57281I SYMBOL'                                   00822000
@NM00800 DC    CL1' '                                                   00823000
@NM00801 DC    CL27'NOT AVAILABLE, SYSTEM ERROR'                        00824000
@NM00802 DC    CL1' '                                                   00825000
@NM00803 DC    CL1' '                                                   00826000
         ORG   M0029+56                                                 00827000
M0030    DS    CL60                                                     00828000
         ORG   M0030                                                    00829000
@NM00804 DC    AL1(0)                                                   00830000
@NM00805 DC    AL1(0)                                                   00831000
@NM00806 DC    AL1(0)                                                   00832000
@NM00807 DC    AL1(0)                                                   00833000
@NM00808 DC    AL1(0)                                                   00834000
@NM00809 DC    AL1(0)                                                   00835000
@NM00810 DC    H'53'                                                    00836000
@NM00811 DC    H'0'                                                     00837000
@NM00812 DC    CL48'IKJ57282I NOT ENOUGH MAIN STORAGE TO USE SYMBOLS'   00838000
@NM00813 DC    CL1' '                                                   00839000
@NM00814 DC    CL1' '                                                   00840000
         ORG   M0030+60                                                 00841000
M0031    DS    CL56                                                     00842000
         ORG   M0031                                                    00843000
@NM00815 DC    AL1(29)                                                  00844000
@NM00816 DC    AL1(44)                                                  00845000
@NM00817 DC    AL1(0)                                                   00846000
@NM00818 DC    AL1(0)                                                   00847000
@NM00819 DC    AL1(0)                                                   00848000
@NM00820 DC    AL1(0)                                                   00849000
@NM00821 DC    H'49'                                                    00850000
@NM00822 DC    H'0'                                                     00851000
@NM00823 DC    CL28'IKJ57293I INVALID LENGTH FOR'                       00852000
@NM00824 DC    CL1' '                                                   00853000
@NM00825 DC    CL14', DEFAULTED TO'                                     00854000
@NM00826 DC    CL1' '                                                   00855000
@NM00827 DC    CL1' '                                                   00856000
@NM00828 DC    CL1' '                                                   00857000
         ORG   M0031+56                                                 00858000
M0032    DS    CL62                                                     00859000
         ORG   M0032                                                    00860000
@NM00829 DC    AL1(0)                                                   00861000
@NM00830 DC    AL1(0)                                                   00862000
@NM00831 DC    AL1(0)                                                   00863000
@NM00832 DC    AL1(0)                                                   00864000
@NM00833 DC    AL1(0)                                                   00865000
@NM00834 DC    AL1(0)                                                   00866000
@NM00835 DC    H'55'                                                    00867000
@NM00836 DC    H'0'                                                     00868000
@NM00837 DC    CL50'IKJ57295I INVALID MULTIPLICITY OR LENGTH SPECIFIED' 00869000
@NM00838 DC    CL1' '                                                   00870000
@NM00839 DC    CL1' '                                                   00871000
         ORG   M0032+62                                                 00872000
M0033    DS    CL43                                                     00873000
         ORG   M0033                                                    00874000
@NM00840 DC    AL1(0)                                                   00875000
@NM00841 DC    AL1(0)                                                   00876000
@NM00842 DC    AL1(0)                                                   00877000
@NM00843 DC    AL1(0)                                                   00878000
@NM00844 DC    AL1(0)                                                   00879000
@NM00845 DC    AL1(0)                                                   00880000
@NM00846 DC    H'36'                                                    00881000
@NM00847 DC    H'0'                                                     00882000
@NM00848 DC    CL31'IKJ57296I SYMBOL TABLE IS EMPTY'                    00883000
@NM00849 DC    CL1' '                                                   00884000
@NM00850 DC    CL1' '                                                   00885000
         ORG   M0033+43                                                 00886000
         DS    CL1                                                      00887000
M0034    DS    CL47                                                     00888000
         ORG   M0034                                                    00889000
@NM00851 DC    AL1(10)                                                  00890000
@NM00852 DC    AL1(0)                                                   00891000
@NM00853 DC    AL1(0)                                                   00892000
@NM00854 DC    AL1(0)                                                   00893000
@NM00855 DC    AL1(0)                                                   00894000
@NM00856 DC    AL1(0)                                                   00895000
@NM00857 DC    H'40'                                                    00896000
@NM00858 DC    H'0'                                                     00897000
@NM00859 DC    CL9'IKJ57297I'                                           00898000
@NM00860 DC    CL1' '                                                   00899000
@NM00861 DC    CL25'NOT FOUND IN SYMBOL TABLE'                          00900000
@NM00862 DC    CL1' '                                                   00901000
@NM00863 DC    CL1' '                                                   00902000
         ORG   M0034+47                                                 00903000
         DS    CL1                                                      00904000
M0035    DS    CL44                                                     00905000
         ORG   M0035                                                    00906000
@NM00864 DC    AL1(0)                                                   00907000
@NM00865 DC    AL1(0)                                                   00908000
@NM00866 DC    AL1(0)                                                   00909000
@NM00867 DC    AL1(0)                                                   00910000
@NM00868 DC    AL1(0)                                                   00911000
@NM00869 DC    AL1(0)                                                   00912000
@NM00870 DC    H'37'                                                    00913000
@NM00871 DC    H'0'                                                     00914000
@NM00872 DC    CL32'IKJ57302I COMMAND CHAIN TOO LONG'                   00915000
@NM00873 DC    CL1' '                                                   00916000
@NM00874 DC    CL1' '                                                   00917000
         ORG   M0035+44                                                 00918000
M0036    DS    CL36                                                     00919000
         ORG   M0036                                                    00920000
@NM00875 DC    AL1(24)                                                  00921000
@NM00876 DC    AL1(0)                                                   00922000
@NM00877 DC    AL1(0)                                                   00923000
@NM00878 DC    AL1(0)                                                   00924000
@NM00879 DC    AL1(0)                                                   00925000
@NM00880 DC    AL1(0)                                                   00926000
@NM00881 DC    H'29'                                                    00927000
@NM00882 DC    H'0'                                                     00928000
@NM00883 DC    CL23'IKJ57303I INVALID COUNT'                            00929000
@NM00884 DC    CL1' '                                                   00930000
@NM00885 DC    CL1' '                                                   00931000
@NM00886 DC    CL1' '                                                   00932000
         ORG   M0036+36                                                 00933000
M0037    DS    CL74                                                     00934000
         ORG   M0037                                                    00935000
@NM00887 DC    AL1(43)                                                  00936000
@NM00888 DC    AL1(62)                                                  00937000
@NM00889 DC    AL1(0)                                                   00938000
@NM00890 DC    AL1(0)                                                   00939000
@NM00891 DC    AL1(0)                                                   00940000
@NM00892 DC    AL1(0)                                                   00941000
@NM00893 DC    H'67'                                                    00942000
@NM00894 DC    H'0'                                                     00943000
@NM00895 DC    CL42'IKJ57305I NO BREAKPOINTS ESTABLISHED FROM+'         00944000
@NM00896 DC    CL1' '                                                   00945000
@NM00897 DC    CL18'OF RANGE BEGINNING'                                 00946000
@NM00898 DC    CL1' '                                                   00947000
@NM00899 DC    CL1' '                                                   00948000
@NM00900 DC    CL1' '                                                   00949000
         ORG   M0037+74                                                 00950000
M0038    DS    CL51                                                     00951000
         ORG   M0038                                                    00952000
@NM00901 DC    AL1(39)                                                  00953000
@NM00902 DC    AL1(0)                                                   00954000
@NM00903 DC    AL1(0)                                                   00955000
@NM00904 DC    AL1(0)                                                   00956000
@NM00905 DC    AL1(0)                                                   00957000
@NM00906 DC    AL1(0)                                                   00958000
@NM00907 DC    H'44'                                                    00959000
@NM00908 DC    H'0'                                                     00960000
@NM00909 DC    CL38'IKJ57306I NO BREAKPOINT ESTABLISHED AT'             00961000
@NM00910 DC    CL1' '                                                   00962000
@NM00911 DC    CL1' '                                                   00963000
@NM00912 DC    CL1' '                                                   00964000
         ORG   M0038+51                                                 00965000
         DS    CL1                                                      00966000
M0039    DS    CL58                                                     00967000
         ORG   M0039                                                    00968000
@NM00913 DC    AL1(0)                                                   00969000
@NM00914 DC    AL1(0)                                                   00970000
@NM00915 DC    AL1(0)                                                   00971000
@NM00916 DC    AL1(0)                                                   00972000
@NM00917 DC    AL1(0)                                                   00973000
@NM00918 DC    AL1(0)                                                   00974000
@NM00919 DC    H'51'                                                    00975000
@NM00920 DC    H'0'                                                     00976000
@NM00921 DC    CL46'IKJ57309I UNABLE TO ESTABLISH DEFER BREAKPOINT'     00977000
@NM00922 DC    CL1' '                                                   00978000
@NM00923 DC    CL1' '                                                   00979000
         ORG   M0039+58                                                 00980000
M0040    DS    CL63                                                     00981000
         ORG   M0040                                                    00982000
@NM00924 DC    AL1(0)                                                   00983000
@NM00925 DC    AL1(0)                                                   00984000
@NM00926 DC    AL1(0)                                                   00985000
@NM00927 DC    AL1(0)                                                   00986000
@NM00928 DC    AL1(0)                                                   00987000
@NM00929 DC    AL1(0)                                                   00988000
@NM00930 DC    H'56'                                                    00989000
@NM00931 DC    H'0'                                                     00990000
@NM00932 DC    CL51'IKJ57334I DEB DOES NOT HAVE A DIRECT ACCESS SECTIONC00991000
               '                                                        00992000
@NM00933 DC    CL1' '                                                   00993000
@NM00934 DC    CL1' '                                                   00994000
         ORG   M0040+63                                                 00995000
         DS    CL1                                                      00996000
M0041    DS    CL65                                                     00997000
         ORG   M0041                                                    00998000
@NM00935 DC    AL1(0)                                                   00999000
@NM00936 DC    AL1(0)                                                   01000000
@NM00937 DC    AL1(0)                                                   01001000
@NM00938 DC    AL1(0)                                                   01002000
@NM00939 DC    AL1(0)                                                   01003000
@NM00940 DC    AL1(0)                                                   01004000
@NM00941 DC    H'58'                                                    01005000
@NM00942 DC    H'0'                                                     01006000
@NM00943 DC    CL53'IKJ57335I DEB FIELD NAME REQUIRED AFTER FIELD KEYWOC01007000
               RD'                                                      01008000
@NM00944 DC    CL1' '                                                   01009000
@NM00945 DC    CL1' '                                                   01010000
         ORG   M0041+65                                                 01011000
         DS    CL1                                                      01012000
M0042    DS    CL62                                                     01013000
         ORG   M0042                                                    01014000
@NM00946 DC    AL1(0)                                                   01015000
@NM00947 DC    AL1(0)                                                   01016000
@NM00948 DC    AL1(0)                                                   01017000
@NM00949 DC    AL1(0)                                                   01018000
@NM00950 DC    AL1(0)                                                   01019000
@NM00951 DC    AL1(0)                                                   01020000
@NM00952 DC    H'55'                                                    01021000
@NM00953 DC    H'0'                                                     01022000
@NM00954 DC    CL50'IKJ57370I DATA HAS BEEN LOST DURING I/O PROCESSING' 01023000
@NM00955 DC    CL1' '                                                   01024000
@NM00956 DC    CL1' '                                                   01025000
         ORG   M0042+62                                                 01026000
M0045    DS    CL44                                                     01027000
         ORG   M0045                                                    01028000
@NM00957 DC    AL1(0)                                                   01029000
@NM00958 DC    AL1(0)                                                   01030000
@NM00959 DC    AL1(0)                                                   01031000
@NM00960 DC    AL1(0)                                                   01032000
@NM00961 DC    AL1(0)                                                   01033000
@NM00962 DC    AL1(0)                                                   01034000
@NM00963 DC    H'37'                                                    01035000
@NM00964 DC    H'0'                                                     01036000
@NM00965 DC    CL32'IKJ57370I UNABLE TO LOAD PROGRAM'                   01037000
@NM00966 DC    CL1' '                                                   01038000
@NM00967 DC    CL1' '                                                   01039000
         ORG   M0045+44                                                 01040000
M0046    DS    CL33                                                     01041000
         ORG   M0046                                                    01042000
@NM00968 DC    AL1(21)                                                  01043000
@NM00969 DC    AL1(0)                                                   01044000
@NM00970 DC    AL1(0)                                                   01045000
@NM00971 DC    AL1(0)                                                   01046000
@NM00972 DC    AL1(0)                                                   01047000
@NM00973 DC    AL1(0)                                                   01048000
@NM00974 DC    H'26'                                                    01049000
@NM00975 DC    H'0'                                                     01050000
@NM00976 DC    CL20'IKJ57375I STORAGE AT'                               01051000
@NM00977 DC    CL1' '                                                   01052000
@NM00978 DC    CL1' '                                                   01053000
@NM00979 DC    CL1' '                                                   01054000
         ORG   M0046+33                                                 01055000
         DS    CL1                                                      01056000
M0047    DS    CL61                                                     01057000
         ORG   M0047                                                    01058000
@NM00980 DC    AL1(0)                                                   01059000
@NM00981 DC    AL1(0)                                                   01060000
@NM00982 DC    AL1(0)                                                   01061000
@NM00983 DC    AL1(0)                                                   01062000
@NM00984 DC    AL1(0)                                                   01063000
@NM00985 DC    AL1(0)                                                   01064000
@NM00986 DC    H'54'                                                    01065000
@NM00987 DC    H'0'                                                     01066000
@NM00988 DC    CL49'IKJ57378I ZERO BYTES IS INVALID COUNT FOR GETMAIN'  01067000
@NM00989 DC    CL1' '                                                   01068000
@NM00990 DC    CL1' '                                                   01069000
         ORG   M0047+61                                                 01070000
         DS    CL1                                                      01071000
M0048    DS    CL52                                                     01072000
         ORG   M0048                                                    01073000
@NM00991 DC    AL1(0)                                                   01074000
@NM00992 DC    AL1(0)                                                   01075000
@NM00993 DC    AL1(0)                                                   01076000
@NM00994 DC    AL1(0)                                                   01077000
@NM00995 DC    AL1(0)                                                   01078000
@NM00996 DC    AL1(0)                                                   01079000
@NM00997 DC    H'45'                                                    01080000
@NM00998 DC    H'0'                                                     01081000
@NM00999 DC    CL40'IKJ57379I MEMBER NAME MISSING, RESPECIFY'           01082000
@NM01000 DC    CL1' '                                                   01083000
@NM01001 DC    CL1' '                                                   01084000
         ORG   M0048+52                                                 01085000
M0049    DS    CL37                                                     01086000
         ORG   M0049                                                    01087000
@NM01002 DC    AL1(25)                                                  01088000
@NM01003 DC    AL1(0)                                                   01089000
@NM01004 DC    AL1(0)                                                   01090000
@NM01005 DC    AL1(0)                                                   01091000
@NM01006 DC    AL1(0)                                                   01092000
@NM01007 DC    AL1(0)                                                   01093000
@NM01008 DC    H'30'                                                    01094000
@NM01009 DC    H'0'                                                     01095000
@NM01010 DC    CL24'IKJ57382I ENTRY POINT AT'                           01096000
@NM01011 DC    CL1' '                                                   01097000
@NM01012 DC    CL1' '                                                   01098000
@NM01013 DC    CL1' '                                                   01099000
         ORG   M0049+37                                                 01100000
         DS    CL1                                                      01101000
M0050    DS    CL34                                                     01102000
         ORG   M0050                                                    01103000
@NM01014 DC    AL1(0)                                                   01104000
@NM01015 DC    AL1(0)                                                   01105000
@NM01016 DC    AL1(0)                                                   01106000
@NM01017 DC    AL1(0)                                                   01107000
@NM01018 DC    AL1(0)                                                   01108000
@NM01019 DC    AL1(0)                                                   01109000
@NM01020 DC    H'27'                                                    01110000
@NM01021 DC    H'0'                                                     01111000
@NM01022 DC    CL22'IKJ57395I MAP COMPLETE'                             01112000
@NM01023 DC    CL1' '                                                   01113000
@NM01024 DC    CL1' '                                                   01114000
         ORG   M0050+34                                                 01115000
M0051    DS    CL41                                                     01116000
         ORG   M0051                                                    01117000
@NM01025 DC    AL1(0)                                                   01118000
@NM01026 DC    AL1(0)                                                   01119000
@NM01027 DC    AL1(0)                                                   01120000
@NM01028 DC    AL1(0)                                                   01121000
@NM01029 DC    AL1(0)                                                   01122000
@NM01030 DC    AL1(0)                                                   01123000
@NM01031 DC    H'34'                                                    01124000
@NM01032 DC    H'0'                                                     01125000
@NM01033 DC    CL29'IKJ57400I PERMANENT I/O ERROR'                      01126000
@NM01034 DC    CL1' '                                                   01127000
@NM01035 DC    CL1' '                                                   01128000
         ORG   M0051+41                                                 01129000
         DS    CL1                                                      01130000
M0052    DS    CL45                                                     01131000
         ORG   M0052                                                    01132000
@NM01036 DC    AL1(0)                                                   01133000
@NM01037 DC    AL1(0)                                                   01134000
@NM01038 DC    AL1(0)                                                   01135000
@NM01039 DC    AL1(0)                                                   01136000
@NM01040 DC    AL1(0)                                                   01137000
@NM01041 DC    AL1(0)                                                   01138000
@NM01042 DC    H'38'                                                    01139000
@NM01043 DC    H'0'                                                     01140000
@NM01044 DC    CL33'IKJ57401I UNABLE TO OPEN DATA SET'                  01141000
@NM01045 DC    CL1' '                                                   01142000
@NM01046 DC    CL1' '                                                   01143000
         ORG   M0052+45                                                 01144000
         DS    CL1                                                      01145000
M0053    DS    CL68                                                     01146000
         ORG   M0053                                                    01147000
@NM01047 DC    AL1(0)                                                   01148000
@NM01048 DC    AL1(0)                                                   01149000
@NM01049 DC    AL1(0)                                                   01150000
@NM01050 DC    AL1(0)                                                   01151000
@NM01051 DC    AL1(0)                                                   01152000
@NM01052 DC    AL1(0)                                                   01153000
@NM01053 DC    H'61'                                                    01154000
@NM01054 DC    H'0'                                                     01155000
@NM01055 DC    CL56'IKJ57404I TEST SVC 61 FAILED WITH A PROTECTION VIOLC01156000
               ATION'                                                   01157000
@NM01056 DC    CL1' '                                                   01158000
@NM01057 DC    CL1' '                                                   01159000
         ORG   M0053+68                                                 01160000
M0054    DS    CL52                                                     01161000
         ORG   M0054                                                    01162000
@NM01058 DC    AL1(40)                                                  01163000
@NM01059 DC    AL1(0)                                                   01164000
@NM01060 DC    AL1(0)                                                   01165000
@NM01061 DC    AL1(0)                                                   01166000
@NM01062 DC    AL1(0)                                                   01167000
@NM01063 DC    AL1(0)                                                   01168000
@NM01064 DC    H'45'                                                    01169000
@NM01065 DC    H'0'                                                     01170000
@NM01066 DC    CL39'IKJ57405I UNABLE TO PRINT INTO DATA SET'            01171000
@NM01067 DC    CL1' '                                                   01172000
@NM01068 DC    CL1' '                                                   01173000
@NM01069 DC    CL1' '                                                   01174000
         ORG   M0054+52                                                 01175000
M0058    DS    CL28                                                     01176000
         ORG   M0058                                                    01177000
@NM01070 DC    AL1(10)                                                  01178000
@NM01071 DC    AL1(0)                                                   01179000
@NM01072 DC    AL1(0)                                                   01180000
@NM01073 DC    AL1(0)                                                   01181000
@NM01074 DC    AL1(0)                                                   01182000
@NM01075 DC    AL1(0)                                                   01183000
@NM01076 DC    H'21'                                                    01184000
@NM01077 DC    H'0'                                                     01185000
@NM01078 DC    CL9'IKJ57430I'                                           01186000
@NM01079 DC    CL1' '                                                   01187000
@NM01080 DC    CL6'FAILED'                                              01188000
@NM01081 DC    CL1' '                                                   01189000
@NM01082 DC    CL1' '                                                   01190000
         ORG   M0058+28                                                 01191000
M0064    DS    CL37                                                     01192000
         ORG   M0064                                                    01193000
@NM01083 DC    AL1(25)                                                  01194000
@NM01084 DC    AL1(0)                                                   01195000
@NM01085 DC    AL1(0)                                                   01196000
@NM01086 DC    AL1(0)                                                   01197000
@NM01087 DC    AL1(0)                                                   01198000
@NM01088 DC    AL1(0)                                                   01199000
@NM01089 DC    H'30'                                                    01200000
@NM01090 DC    H'0'                                                     01201000
@NM01091 DC    CL24'IKJ57456I INVALID LENGTH'                           01202000
@NM01092 DC    CL1' '                                                   01203000
@NM01093 DC    CL1' '                                                   01204000
@NM01094 DC    CL1' '                                                   01205000
         ORG   M0064+37                                                 01206000
         DS    CL1                                                      01207000
M0066    DS    CL42                                                     01208000
         ORG   M0066                                                    01209000
@NM01095 DC    AL1(0)                                                   01210000
@NM01096 DC    AL1(0)                                                   01211000
@NM01097 DC    AL1(0)                                                   01212000
@NM01098 DC    AL1(0)                                                   01213000
@NM01099 DC    AL1(0)                                                   01214000
@NM01100 DC    AL1(0)                                                   01215000
@NM01101 DC    H'35'                                                    01216000
@NM01102 DC    H'0'                                                     01217000
@NM01103 DC    CL30'IKJ57454I INVALID FROM ADDRESS'                     01218000
@NM01104 DC    CL1' '                                                   01219000
@NM01105 DC    CL1' '                                                   01220000
         ORG   M0066+42                                                 01221000
M0067    DS    CL39                                                     01222000
         ORG   M0067                                                    01223000
@NM01106 DC    AL1(0)                                                   01224000
@NM01107 DC    AL1(0)                                                   01225000
@NM01108 DC    AL1(0)                                                   01226000
@NM01109 DC    AL1(0)                                                   01227000
@NM01110 DC    AL1(0)                                                   01228000
@NM01111 DC    AL1(0)                                                   01229000
@NM01112 DC    H'32'                                                    01230000
@NM01113 DC    H'0'                                                     01231000
@NM01114 DC    CL27'IKJ57461I COMMAND NOT FOUND'                        01232000
@NM01115 DC    CL1' '                                                   01233000
@NM01116 DC    CL1' '                                                   01234000
         ORG   M0067+39                                                 01235000
         DS    CL1                                                      01236000
M0068    DS    CL40                                                     01237000
         ORG   M0068                                                    01238000
@NM01117 DC    AL1(10)                                                  01239000
@NM01118 DC    AL1(0)                                                   01240000
@NM01119 DC    AL1(0)                                                   01241000
@NM01120 DC    AL1(0)                                                   01242000
@NM01121 DC    AL1(0)                                                   01243000
@NM01122 DC    AL1(0)                                                   01244000
@NM01123 DC    H'33'                                                    01245000
@NM01124 DC    H'0'                                                     01246000
@NM01125 DC    CL9'IKJ57462I'                                           01247000
@NM01126 DC    CL1' '                                                   01248000
@NM01127 DC    CL18'ENDED DUE TO ERROR'                                 01249000
@NM01128 DC    CL1' '                                                   01250000
@NM01129 DC    CL1' '                                                   01251000
         ORG   M0068+40                                                 01252000
M0069    DS    CL54                                                     01253000
         ORG   M0069                                                    01254000
@NM01130 DC    AL1(0)                                                   01255000
@NM01131 DC    AL1(0)                                                   01256000
@NM01132 DC    AL1(0)                                                   01257000
@NM01133 DC    AL1(0)                                                   01258000
@NM01134 DC    AL1(0)                                                   01259000
@NM01135 DC    AL1(0)                                                   01260000
@NM01136 DC    H'47'                                                    01261000
@NM01137 DC    H'0'                                                     01262000
@NM01138 DC    CL42'IKJ57008I PARAMETER STRING LENGTH EXCEEDED'         01263000
@NM01139 DC    CL1' '                                                   01264000
@NM01140 DC    CL1' '                                                   01265000
         ORG   M0069+54                                                 01266000
M0070    DS    CL42                                                     01267000
         ORG   M0070                                                    01268000
@NM01141 DC    AL1(0)                                                   01269000
@NM01142 DC    AL1(0)                                                   01270000
@NM01143 DC    AL1(0)                                                   01271000
@NM01144 DC    AL1(0)                                                   01272000
@NM01145 DC    AL1(0)                                                   01273000
@NM01146 DC    AL1(0)                                                   01274000
@NM01147 DC    H'35'                                                    01275000
@NM01148 DC    H'0'                                                     01276000
@NM01149 DC    CL30'IKJ57090A ENTER COMMAND FOR CP'                     01277000
@NM01150 DC    CL1' '                                                   01278000
@NM01151 DC    CL1' '                                                   01279000
         ORG   M0070+42                                                 01280000
M0071    DS    CL17                                                     01281000
         ORG   M0071                                                    01282000
@NM02962 DC    X'00'                                                    01283000
         DC    XL5'0'                                                   01284000
@NM02963 DC    H'11'                                                    01285000
@NM02964 DC    H'0'                                                     01286000
@NM02965 DC    CL7' TEST'                                               01287000
         ORG   M0071+17                                                 01288000
         DS    CL1                                                      01289000
M0072    DS    CL41                                                     01290000
         ORG   M0072                                                    01291000
@NM01152 DC    AL1(29)                                                  01292000
@NM01153 DC    AL1(0)                                                   01293000
@NM01154 DC    AL1(0)                                                   01294000
@NM01155 DC    AL1(0)                                                   01295000
@NM01156 DC    AL1(0)                                                   01296000
@NM01157 DC    AL1(0)                                                   01297000
@NM01158 DC    H'34'                                                    01298000
@NM01159 DC    H'0'                                                     01299000
@NM01160 DC    CL28'IKJ57455I INVALID TO ADDRESS'                       01300000
@NM01161 DC    CL1' '                                                   01301000
@NM01162 DC    CL1' '                                                   01302000
@NM01163 DC    CL1' '                                                   01303000
         ORG   M0072+41                                                 01304000
         DS    CL1                                                      01305000
M0073    DS    CL54                                                     01306000
         ORG   M0073                                                    01307000
@NM01164 DC    AL1(42)                                                  01308000
@NM01165 DC    AL1(0)                                                   01309000
@NM01166 DC    AL1(0)                                                   01310000
@NM01167 DC    AL1(0)                                                   01311000
@NM01168 DC    AL1(0)                                                   01312000
@NM01169 DC    AL1(0)                                                   01313000
@NM01170 DC    H'47'                                                    01314000
@NM01171 DC    H'0'                                                     01315000
@NM01172 DC    CL41'IKJ57457I INVALID ADDRESS RANGE BEGINNING'          01316000
@NM01173 DC    CL1' '                                                   01317000
@NM01174 DC    CL1' '                                                   01318000
@NM01175 DC    CL1' '                                                   01319000
         ORG   M0073+54                                                 01320000
M0100    DS    CL45                                                     01321000
         ORG   M0100                                                    01322000
@NM01176 DC    AL1(0)                                                   01323000
@NM01177 DC    AL1(0)                                                   01324000
@NM01178 DC    AL1(0)                                                   01325000
@NM01179 DC    AL1(0)                                                   01326000
@NM01180 DC    AL1(0)                                                   01327000
@NM01181 DC    AL1(0)                                                   01328000
@NM01182 DC    H'38'                                                    01329000
@NM01183 DC    H'0'                                                     01330000
@NM01184 DC    CL33'IKJ57501I TEST ENDED DUE TO ERROR'                  01331000
@NM01185 DC    CL1' '                                                   01332000
@NM01186 DC    CL1' '                                                   01333000
         ORG   M0100+45                                                 01334000
         DS    CL1                                                      01335000
M0101    DS    CL38                                                     01336000
         ORG   M0101                                                    01337000
@NM01187 DC    AL1(26)                                                  01338000
@NM01188 DC    AL1(0)                                                   01339000
@NM01189 DC    AL1(0)                                                   01340000
@NM01190 DC    AL1(0)                                                   01341000
@NM01191 DC    AL1(0)                                                   01342000
@NM01192 DC    AL1(0)                                                   01343000
@NM01193 DC    H'31'                                                    01344000
@NM01194 DC    H'0'                                                     01345000
@NM01195 DC    CL25'IKJ57502I INVALID ADDRESS'                          01346000
@NM01196 DC    CL1' '                                                   01347000
@NM01197 DC    CL1' '                                                   01348000
@NM01198 DC    CL1' '                                                   01349000
         ORG   M0101+38                                                 01350000
M0103    DS    CL64                                                     01351000
         ORG   M0103                                                    01352000
@NM01199 DC    AL1(0)                                                   01353000
@NM01200 DC    AL1(0)                                                   01354000
@NM01201 DC    AL1(0)                                                   01355000
@NM01202 DC    AL1(0)                                                   01356000
@NM01203 DC    AL1(0)                                                   01357000
@NM01204 DC    AL1(0)                                                   01358000
@NM01205 DC    H'57'                                                    01359000
@NM01206 DC    H'0'                                                     01360000
@NM01207 DC    CL52'IKJ57503I NOT ENOUGH MAIN STORAGE TO EXECUTE COMMANC01361000
               D'                                                       01362000
@NM01208 DC    CL1' '                                                   01363000
@NM01209 DC    CL1' '                                                   01364000
         ORG   M0103+64                                                 01365000
M0104    DS    CL50                                                     01366000
         ORG   M0104                                                    01367000
@NM01210 DC    AL1(10)                                                  01368000
@NM01211 DC    AL1(0)                                                   01369000
@NM01212 DC    AL1(0)                                                   01370000
@NM01213 DC    AL1(0)                                                   01371000
@NM01214 DC    AL1(0)                                                   01372000
@NM01215 DC    AL1(0)                                                   01373000
@NM01216 DC    H'43'                                                    01374000
@NM01217 DC    H'0'                                                     01375000
@NM01218 DC    CL9'IKJ57504I'                                           01376000
@NM01219 DC    CL1' '                                                   01377000
@NM01220 DC    CL28'FAILED, COMMAND SYSTEM ERROR'                       01378000
@NM01221 DC    CL1' '                                                   01379000
@NM01222 DC    CL1' '                                                   01380000
         ORG   M0104+50                                                 01381000
M0105    DS    CL42                                                     01382000
         ORG   M0105                                                    01383000
@NM01223 DC    AL1(30)                                                  01384000
@NM01224 DC    AL1(0)                                                   01385000
@NM01225 DC    AL1(0)                                                   01386000
@NM01226 DC    AL1(0)                                                   01387000
@NM01227 DC    AL1(0)                                                   01388000
@NM01228 DC    AL1(0)                                                   01389000
@NM01229 DC    H'35'                                                    01390000
@NM01230 DC    H'0'                                                     01391000
@NM01231 DC    CL29'IKJ57505I THE RETURN CODE WAS'                      01392000
@NM01232 DC    CL1' '                                                   01393000
@NM01233 DC    CL1' '                                                   01394000
@NM01234 DC    CL1' '                                                   01395000
         ORG   M0105+42                                                 01396000
M0106    DS    CL26                                                     01397000
         ORG   M0106                                                    01398000
@NM01235 DC    AL1(10)                                                  01399000
@NM01236 DC    AL1(11)                                                  01400000
@NM01237 DC    AL1(12)                                                  01401000
@NM01238 DC    AL1(13)                                                  01402000
@NM01239 DC    AL1(14)                                                  01403000
@NM01240 DC    AL1(15)                                                  01404000
@NM01241 DC    H'20'                                                    01405000
@NM01242 DC    H'0'                                                     01406000
@NM01243 DC    CL9'IKJ57506I'                                           01407000
@NM01244 DC    CL1' '                                                   01408000
@NM01245 DC    CL1' '                                                   01409000
@NM01246 DC    CL1' '                                                   01410000
@NM01247 DC    CL1' '                                                   01411000
@NM01248 DC    CL1' '                                                   01412000
@NM01249 DC    CL1' '                                                   01413000
@NM01250 DC    CL1' '                                                   01414000
         ORG   M0106+26                                                 01415000
M0107    DS    CL28                                                     01416000
         ORG   M0107                                                    01417000
@NM01251 DC    AL1(10)                                                  01418000
@NM01252 DC    AL1(0)                                                   01419000
@NM01253 DC    AL1(0)                                                   01420000
@NM01254 DC    AL1(0)                                                   01421000
@NM01255 DC    AL1(0)                                                   01422000
@NM01256 DC    AL1(0)                                                   01423000
@NM01257 DC    H'21'                                                    01424000
@NM01258 DC    H'0'                                                     01425000
@NM01259 DC    CL9'IKJ57507I'                                           01426000
@NM01260 DC    CL1' '                                                   01427000
@NM01261 DC    CL6'FAILED'                                              01428000
@NM01262 DC    CL1' '                                                   01429000
@NM01263 DC    CL1' '                                                   01430000
         ORG   M0107+28                                                 01431000
M0200    DS    CL77                                                     01432000
         ORG   M0200                                                    01433000
@NM01264 DC    AL1(0)                                                   01434000
@NM01265 DC    AL1(0)                                                   01435000
@NM01266 DC    AL1(0)                                                   01436000
@NM01267 DC    AL1(0)                                                   01437000
@NM01268 DC    AL1(0)                                                   01438000
@NM01269 DC    AL1(0)                                                   01439000
@NM01270 DC    H'79'                                                    01440000
@NM01271 DC    H'0'                                                     01441000
@NM01272 DC    CL1' '                                                   01442000
@NM01273 DC    CL64'THE COMMAND ENTERED IS NOT SUPPORTED IN TEST MODE IC01443000
               N THIS SYSTEM'                                           01444000
@NM01274 DC    CL1' '                                                   01445000
@NM01275 DC    CL1' '                                                   01446000
         ORG   M0200+77                                                 01447000
         DS    CL1                                                      01448000
M0201    DS    CL44                                                     01449000
         ORG   M0201                                                    01450000
@NM01276 DC    AL1(0)                                                   01451000
@NM01277 DC    AL1(0)                                                   01452000
@NM01278 DC    AL1(0)                                                   01453000
@NM01279 DC    AL1(0)                                                   01454000
@NM01280 DC    AL1(0)                                                   01455000
@NM01281 DC    AL1(0)                                                   01456000
@NM01282 DC    H'46'                                                    01457000
@NM01283 DC    H'0'                                                     01458000
@NM01284 DC    CL1' '                                                   01459000
@NM01285 DC    CL31'BREAKPOINTS SET ARE STILL VALID'                    01460000
@NM01286 DC    CL1' '                                                   01461000
@NM01287 DC    CL1' '                                                   01462000
         ORG   M0201+44                                                 01463000
M0202    DS    CL17                                                     01464000
         ORG   M0202                                                    01465000
@NM01288 DC    AL1(10)                                                  01466000
@NM01289 DC    AL1(11)                                                  01467000
@NM01290 DC    AL1(12)                                                  01468000
@NM01291 DC    AL1(13)                                                  01469000
@NM01292 DC    AL1(14)                                                  01470000
@NM01293 DC    AL1(15)                                                  01471000
@NM01294 DC    H'20'                                                    01472000
@NM01295 DC    H'0'                                                     01473000
@NM01296 DC    CL1' '                                                   01474000
@NM01297 DC    CL1' '                                                   01475000
@NM01298 DC    CL1' '                                                   01476000
@NM01299 DC    CL1' '                                                   01477000
@NM01300 DC    CL1' '                                                   01478000
@NM01301 DC    CL1' '                                                   01479000
@NM01302 DC    CL1' '                                                   01480000
         ORG   M0202+17                                                 01481000
         DS    CL1                                                      01482000
M0203    DS    CL44                                                     01483000
         ORG   M0203                                                    01484000
@NM01303 DC    AL1(0)                                                   01485000
@NM01304 DC    AL1(0)                                                   01486000
@NM01305 DC    AL1(0)                                                   01487000
@NM01306 DC    AL1(0)                                                   01488000
@NM01307 DC    AL1(0)                                                   01489000
@NM01308 DC    AL1(0)                                                   01490000
@NM01309 DC    H'46'                                                    01491000
@NM01310 DC    H'0'                                                     01492000
@NM01311 DC    CL1' '                                                   01493000
@NM01312 DC    CL31'BREAKPOINTS ARE NO LONGER VALID'                    01494000
@NM01313 DC    CL1' '                                                   01495000
@NM01314 DC    CL1' '                                                   01496000
         ORG   M0203+44                                                 01497000
M0204    DS    CL62                                                     01498000
         ORG   M0204                                                    01499000
@NM01315 DC    AL1(0)                                                   01500000
@NM01316 DC    AL1(0)                                                   01501000
@NM01317 DC    AL1(0)                                                   01502000
@NM01318 DC    AL1(0)                                                   01503000
@NM01319 DC    AL1(0)                                                   01504000
@NM01320 DC    AL1(0)                                                   01505000
@NM01321 DC    H'64'                                                    01506000
@NM01322 DC    H'0'                                                     01507000
@NM01323 DC    CL1' '                                                   01508000
@NM01324 DC    CL49'A BREAKPOINT WAS DETECTED IN A PRIVILEGED PROGRAM'  01509000
@NM01325 DC    CL1' '                                                   01510000
@NM01326 DC    CL1' '                                                   01511000
         ORG   M0204+62                                                 01512000
M0205    DS    CL58                                                     01513000
         ORG   M0205                                                    01514000
@NM01327 DC    AL1(0)                                                   01515000
@NM01328 DC    AL1(0)                                                   01516000
@NM01329 DC    AL1(0)                                                   01517000
@NM01330 DC    AL1(0)                                                   01518000
@NM01331 DC    AL1(0)                                                   01519000
@NM01332 DC    AL1(0)                                                   01520000
@NM01333 DC    H'60'                                                    01521000
@NM01334 DC    H'0'                                                     01522000
@NM01335 DC    CL1' '                                                   01523000
@NM01336 DC    CL45'BOTH THE ACTIVE AND DEFERRED QUEUES ARE EMPTY'      01524000
@NM01337 DC    CL1' '                                                   01525000
@NM01338 DC    CL1' '                                                   01526000
         ORG   M0205+58                                                 01527000
M0206    DS    CL65                                                     01528000
         ORG   M0206                                                    01529000
@NM01339 DC    AL1(0)                                                   01530000
@NM01340 DC    AL1(0)                                                   01531000
@NM01341 DC    AL1(0)                                                   01532000
@NM01342 DC    AL1(0)                                                   01533000
@NM01343 DC    AL1(0)                                                   01534000
@NM01344 DC    AL1(0)                                                   01535000
@NM01345 DC    H'67'                                                    01536000
@NM01346 DC    H'0'                                                     01537000
@NM01347 DC    CL1' '                                                   01538000
@NM01348 DC    CL52'UNABLE TO LOCATE ADDRESS ON ACTIVE OR DEFERRED QUEUC01539000
               E'                                                       01540000
@NM01349 DC    CL1' '                                                   01541000
@NM01350 DC    CL1' '                                                   01542000
         ORG   M0206+65                                                 01543000
         DS    CL1                                                      01544000
M0207    DS    CL72                                                     01545000
         ORG   M0207                                                    01546000
@NM01351 DC    AL1(0)                                                   01547000
@NM01352 DC    AL1(0)                                                   01548000
@NM01353 DC    AL1(0)                                                   01549000
@NM01354 DC    AL1(0)                                                   01550000
@NM01355 DC    AL1(0)                                                   01551000
@NM01356 DC    AL1(0)                                                   01552000
@NM01357 DC    H'74'                                                    01553000
@NM01358 DC    H'0'                                                     01554000
@NM01359 DC    CL1' '                                                   01555000
@NM01360 DC    CL59'FIRST ADDRESS OF RANGE MUST NOT BE HIGHER THAN LASTC01556000
                ADDRESS'                                                01557000
@NM01361 DC    CL1' '                                                   01558000
@NM01362 DC    CL1' '                                                   01559000
         ORG   M0207+72                                                 01560000
M0208    DS    CL51                                                     01561000
         ORG   M0208                                                    01562000
@NM01363 DC    AL1(0)                                                   01563000
@NM01364 DC    AL1(0)                                                   01564000
@NM01365 DC    AL1(0)                                                   01565000
@NM01366 DC    AL1(0)                                                   01566000
@NM01367 DC    AL1(0)                                                   01567000
@NM01368 DC    AL1(0)                                                   01568000
@NM01369 DC    H'53'                                                    01569000
@NM01370 DC    H'0'                                                     01570000
@NM01371 DC    CL1' '                                                   01571000
@NM01372 DC    CL38'AN INVALID PDE WAS OBTAINED FROM PARSE'             01572000
@NM01373 DC    CL1' '                                                   01573000
@NM01374 DC    CL1' '                                                   01574000
         ORG   M0208+51                                                 01575000
         DS    CL1                                                      01576000
M0209    DS    CL54                                                     01577000
         ORG   M0209                                                    01578000
@NM01375 DC    AL1(0)                                                   01579000
@NM01376 DC    AL1(0)                                                   01580000
@NM01377 DC    AL1(0)                                                   01581000
@NM01378 DC    AL1(0)                                                   01582000
@NM01379 DC    AL1(0)                                                   01583000
@NM01380 DC    AL1(0)                                                   01584000
@NM01381 DC    H'56'                                                    01585000
@NM01382 DC    H'0'                                                     01586000
@NM01383 DC    CL1' '                                                   01587000
@NM01384 DC    CL41'DATA STRING CONTAINS AN INVALID CHARACTER'          01588000
@NM01385 DC    CL1' '                                                   01589000
@NM01386 DC    CL1' '                                                   01590000
         ORG   M0209+54                                                 01591000
M0210    DS    CL33                                                     01592000
         ORG   M0210                                                    01593000
@NM01387 DC    AL1(0)                                                   01594000
@NM01388 DC    AL1(0)                                                   01595000
@NM01389 DC    AL1(0)                                                   01596000
@NM01390 DC    AL1(0)                                                   01597000
@NM01391 DC    AL1(0)                                                   01598000
@NM01392 DC    AL1(0)                                                   01599000
@NM01393 DC    H'35'                                                    01600000
@NM01394 DC    H'0'                                                     01601000
@NM01395 DC    CL1' '                                                   01602000
@NM01396 DC    CL20'DATA STRING TOO LONG'                               01603000
@NM01397 DC    CL1' '                                                   01604000
@NM01398 DC    CL1' '                                                   01605000
         ORG   M0210+33                                                 01606000
         DS    CL1                                                      01607000
M0211    DS    CL37                                                     01608000
         ORG   M0211                                                    01609000
@NM01399 DC    AL1(0)                                                   01610000
@NM01400 DC    AL1(0)                                                   01611000
@NM01401 DC    AL1(0)                                                   01612000
@NM01402 DC    AL1(0)                                                   01613000
@NM01403 DC    AL1(0)                                                   01614000
@NM01404 DC    AL1(0)                                                   01615000
@NM01405 DC    H'39'                                                    01616000
@NM01406 DC    H'0'                                                     01617000
@NM01407 DC    CL1' '                                                   01618000
@NM01408 DC    CL24'ABSOLUTE VALUE TOO GREAT'                           01619000
@NM01409 DC    CL1' '                                                   01620000
@NM01410 DC    CL1' '                                                   01621000
         ORG   M0211+37                                                 01622000
         DS    CL1                                                      01623000
M0212    DS    CL37                                                     01624000
         ORG   M0212                                                    01625000
@NM01411 DC    AL1(0)                                                   01626000
@NM01412 DC    AL1(0)                                                   01627000
@NM01413 DC    AL1(0)                                                   01628000
@NM01414 DC    AL1(0)                                                   01629000
@NM01415 DC    AL1(0)                                                   01630000
@NM01416 DC    AL1(0)                                                   01631000
@NM01417 DC    H'39'                                                    01632000
@NM01418 DC    H'0'                                                     01633000
@NM01419 DC    CL1' '                                                   01634000
@NM01420 DC    CL24'DATA FORMAT IS INCORRECT'                           01635000
@NM01421 DC    CL1' '                                                   01636000
@NM01422 DC    CL1' '                                                   01637000
         ORG   M0212+37                                                 01638000
         DS    CL1                                                      01639000
M0213    DS    CL50                                                     01640000
         ORG   M0213                                                    01641000
@NM01423 DC    AL1(0)                                                   01642000
@NM01424 DC    AL1(0)                                                   01643000
@NM01425 DC    AL1(0)                                                   01644000
@NM01426 DC    AL1(0)                                                   01645000
@NM01427 DC    AL1(0)                                                   01646000
@NM01428 DC    AL1(0)                                                   01647000
@NM01429 DC    H'52'                                                    01648000
@NM01430 DC    H'0'                                                     01649000
@NM01431 DC    CL1' '                                                   01650000
@NM01432 DC    CL37'DATA LENGTH EXCEEDS REGISTER CAPACITY'              01651000
@NM01433 DC    CL1' '                                                   01652000
@NM01434 DC    CL1' '                                                   01653000
         ORG   M0213+50                                                 01654000
M0214    DS    CL60                                                     01655000
         ORG   M0214                                                    01656000
@NM01435 DC    AL1(0)                                                   01657000
@NM01436 DC    AL1(0)                                                   01658000
@NM01437 DC    AL1(0)                                                   01659000
@NM01438 DC    AL1(0)                                                   01660000
@NM01439 DC    AL1(0)                                                   01661000
@NM01440 DC    AL1(0)                                                   01662000
@NM01441 DC    H'62'                                                    01663000
@NM01442 DC    H'0'                                                     01664000
@NM01443 DC    CL1' '                                                   01665000
@NM01444 DC    CL47'VALID DATA TYPES ARE X OR E FOR REGISTER TYPE E'    01666000
@NM01445 DC    CL1' '                                                   01667000
@NM01446 DC    CL1' '                                                   01668000
         ORG   M0214+60                                                 01669000
M0215    DS    CL60                                                     01670000
         ORG   M0215                                                    01671000
@NM01447 DC    AL1(0)                                                   01672000
@NM01448 DC    AL1(0)                                                   01673000
@NM01449 DC    AL1(0)                                                   01674000
@NM01450 DC    AL1(0)                                                   01675000
@NM01451 DC    AL1(0)                                                   01676000
@NM01452 DC    AL1(0)                                                   01677000
@NM01453 DC    H'62'                                                    01678000
@NM01454 DC    H'0'                                                     01679000
@NM01455 DC    CL1' '                                                   01680000
@NM01456 DC    CL47'VALID DATA TYPES ARE X OR D FOR REGISTER TYPE D'    01681000
@NM01457 DC    CL1' '                                                   01682000
@NM01458 DC    CL1' '                                                   01683000
         ORG   M0215+60                                                 01684000
M0216    DS    CL74                                                     01685000
         ORG   M0216                                                    01686000
@NM01459 DC    AL1(0)                                                   01687000
@NM01460 DC    AL1(0)                                                   01688000
@NM01461 DC    AL1(0)                                                   01689000
@NM01462 DC    AL1(0)                                                   01690000
@NM01463 DC    AL1(0)                                                   01691000
@NM01464 DC    AL1(0)                                                   01692000
@NM01465 DC    H'76'                                                    01693000
@NM01466 DC    H'0'                                                     01694000
@NM01467 DC    CL1' '                                                   01695000
@NM01468 DC    CL61'BREAKPOINTS WERE DEACTIVATED, TO ACTIVATE, USE THE C01696000
               AT COMMAND'                                              01697000
@NM01469 DC    CL1' '                                                   01698000
@NM01470 DC    CL1' '                                                   01699000
         ORG   M0216+74                                                 01700000
M0217    DS    CL99                                                     01701000
         ORG   M0217                                                    01702000
@NM01471 DC    AL1(0)                                                   01703000
@NM01472 DC    AL1(0)                                                   01704000
@NM01473 DC    AL1(0)                                                   01705000
@NM01474 DC    AL1(0)                                                   01706000
@NM01475 DC    AL1(0)                                                   01707000
@NM01476 DC    AL1(0)                                                   01708000
@NM01477 DC    H'101'                                                   01709000
@NM01478 DC    H'0'                                                     01710000
@NM01479 DC    CL1' '                                                   01711000
@NM01480 DC    CL86'NEITHER SYMBOLS NOR BREAKPOINTS ARE AVAILABLE FOR TC01712000
               HE PRIVILEGED MODULE BEING ACCESSED'                     01713000
@NM01481 DC    CL1' '                                                   01714000
@NM01482 DC    CL1' '                                                   01715000
         ORG   M0217+99                                                 01716000
         DS    CL1                                                      01717000
M0218    DS    CL51                                                     01718000
         ORG   M0218                                                    01719000
@NM01483 DC    AL1(0)                                                   01720000
@NM01484 DC    AL1(0)                                                   01721000
@NM01485 DC    AL1(0)                                                   01722000
@NM01486 DC    AL1(0)                                                   01723000
@NM01487 DC    AL1(0)                                                   01724000
@NM01488 DC    AL1(0)                                                   01725000
@NM01489 DC    H'53'                                                    01726000
@NM01490 DC    H'0'                                                     01727000
@NM01491 DC    CL1' '                                                   01728000
@NM01492 DC    CL38'SPECIFIED ADDRESS IS IN PROTECTED CORE'             01729000
@NM01493 DC    CL1' '                                                   01730000
@NM01494 DC    CL1' '                                                   01731000
         ORG   M0218+51                                                 01732000
         DS    CL1                                                      01733000
M0219    DS    CL63                                                     01734000
         ORG   M0219                                                    01735000
@NM01495 DC    AL1(0)                                                   01736000
@NM01496 DC    AL1(0)                                                   01737000
@NM01497 DC    AL1(0)                                                   01738000
@NM01498 DC    AL1(0)                                                   01739000
@NM01499 DC    AL1(0)                                                   01740000
@NM01500 DC    AL1(0)                                                   01741000
@NM01501 DC    H'65'                                                    01742000
@NM01502 DC    H'0'                                                     01743000
@NM01503 DC    CL1' '                                                   01744000
@NM01504 DC    CL50'REGISTER TYPE OF SECOND ADDRESS DIFFERS FROM FIRST' 01745000
@NM01505 DC    CL1' '                                                   01746000
@NM01506 DC    CL1' '                                                   01747000
         ORG   M0219+63                                                 01748000
         DS    CL1                                                      01749000
M0220    DS    CL65                                                     01750000
         ORG   M0220                                                    01751000
@NM01507 DC    AL1(0)                                                   01752000
@NM01508 DC    AL1(0)                                                   01753000
@NM01509 DC    AL1(0)                                                   01754000
@NM01510 DC    AL1(0)                                                   01755000
@NM01511 DC    AL1(0)                                                   01756000
@NM01512 DC    AL1(0)                                                   01757000
@NM01513 DC    H'67'                                                    01758000
@NM01514 DC    H'0'                                                     01759000
@NM01515 DC    CL1' '                                                   01760000
@NM01516 DC    CL52'RANGE CONTAINS BOTH A STORAGE AND A REGISTER ADDRESC01761000
               S'                                                       01762000
@NM01517 DC    CL1' '                                                   01763000
@NM01518 DC    CL1' '                                                   01764000
         ORG   M0220+65                                                 01765000
         DS    CL1                                                      01766000
M0221    DS    CL74                                                     01767000
         ORG   M0221                                                    01768000
@NM01519 DC    AL1(0)                                                   01769000
@NM01520 DC    AL1(0)                                                   01770000
@NM01521 DC    AL1(0)                                                   01771000
@NM01522 DC    AL1(0)                                                   01772000
@NM01523 DC    AL1(0)                                                   01773000
@NM01524 DC    AL1(0)                                                   01774000
@NM01525 DC    H'76'                                                    01775000
@NM01526 DC    H'0'                                                     01776000
@NM01527 DC    CL1' '                                                   01777000
@NM01528 DC    CL61'ADDRESS TYPE IS STORAGE AND SECOND ADDRESS IS LESS C01778000
               THAN FIRST'                                              01779000
@NM01529 DC    CL1' '                                                   01780000
@NM01530 DC    CL1' '                                                   01781000
         ORG   M0221+74                                                 01782000
M0222    DS    CL47                                                     01783000
         ORG   M0222                                                    01784000
@NM01531 DC    AL1(10)                                                  01785000
@NM01532 DC    AL1(0)                                                   01786000
@NM01533 DC    AL1(0)                                                   01787000
@NM01534 DC    AL1(0)                                                   01788000
@NM01535 DC    AL1(0)                                                   01789000
@NM01536 DC    AL1(0)                                                   01790000
@NM01537 DC    H'49'                                                    01791000
@NM01538 DC    H'0'                                                     01792000
@NM01539 DC    CL1' '                                                   01793000
@NM01540 DC    CL34'NOT FOUND RELATED TO SPECIFIED TCB'                 01794000
@NM01541 DC    CL1' '                                                   01795000
@NM01542 DC    CL1' '                                                   01796000
         ORG   M0222+47                                                 01797000
         DS    CL1                                                      01798000
M0223    DS    CL53                                                     01799000
         ORG   M0223                                                    01800000
@NM01543 DC    AL1(0)                                                   01801000
@NM01544 DC    AL1(0)                                                   01802000
@NM01545 DC    AL1(0)                                                   01803000
@NM01546 DC    AL1(0)                                                   01804000
@NM01547 DC    AL1(0)                                                   01805000
@NM01548 DC    AL1(0)                                                   01806000
@NM01549 DC    H'55'                                                    01807000
@NM01550 DC    H'0'                                                     01808000
@NM01551 DC    CL1' '                                                   01809000
@NM01552 DC    CL40'INPUT NOT RESOLVED AS LOADNAME.CSECTNAME'           01810000
@NM01553 DC    CL1' '                                                   01811000
@NM01554 DC    CL1' '                                                   01812000
         ORG   M0223+53                                                 01813000
         DS    CL1                                                      01814000
M0224    DS    CL53                                                     01815000
         ORG   M0224                                                    01816000
@NM01555 DC    AL1(0)                                                   01817000
@NM01556 DC    AL1(0)                                                   01818000
@NM01557 DC    AL1(0)                                                   01819000
@NM01558 DC    AL1(0)                                                   01820000
@NM01559 DC    AL1(0)                                                   01821000
@NM01560 DC    AL1(0)                                                   01822000
@NM01561 DC    H'55'                                                    01823000
@NM01562 DC    H'0'                                                     01824000
@NM01563 DC    CL1' '                                                   01825000
@NM01564 DC    CL40'INPUT NOT RESOLVED AS LOADNAME OR SYMBOL'           01826000
@NM01565 DC    CL1' '                                                   01827000
@NM01566 DC    CL1' '                                                   01828000
         ORG   M0224+53                                                 01829000
         DS    CL1                                                      01830000
M0225    DS    CL53                                                     01831000
         ORG   M0225                                                    01832000
@NM01567 DC    AL1(0)                                                   01833000
@NM01568 DC    AL1(0)                                                   01834000
@NM01569 DC    AL1(0)                                                   01835000
@NM01570 DC    AL1(0)                                                   01836000
@NM01571 DC    AL1(0)                                                   01837000
@NM01572 DC    AL1(0)                                                   01838000
@NM01573 DC    H'55'                                                    01839000
@NM01574 DC    H'0'                                                     01840000
@NM01575 DC    CL1' '                                                   01841000
@NM01576 DC    CL40'ATTEMPT QUALIFICATION AT NEXT BREAKPOINT'           01842000
@NM01577 DC    CL1' '                                                   01843000
@NM01578 DC    CL1' '                                                   01844000
         ORG   M0225+53                                                 01845000
         DS    CL1                                                      01846000
M0226    DS    CL47                                                     01847000
         ORG   M0226                                                    01848000
@NM01579 DC    AL1(0)                                                   01849000
@NM01580 DC    AL1(0)                                                   01850000
@NM01581 DC    AL1(0)                                                   01851000
@NM01582 DC    AL1(0)                                                   01852000
@NM01583 DC    AL1(0)                                                   01853000
@NM01584 DC    AL1(0)                                                   01854000
@NM01585 DC    H'49'                                                    01855000
@NM01586 DC    H'0'                                                     01856000
@NM01587 DC    CL1' '                                                   01857000
@NM01588 DC    CL34'NO TCB EXISTS AT SPECIFIED ADDRESS'                 01858000
@NM01589 DC    CL1' '                                                   01859000
@NM01590 DC    CL1' '                                                   01860000
         ORG   M0226+47                                                 01861000
         DS    CL1                                                      01862000
M0227    DS    CL62                                                     01863000
         ORG   M0227                                                    01864000
@NM01591 DC    AL1(0)                                                   01865000
@NM01592 DC    AL1(0)                                                   01866000
@NM01593 DC    AL1(0)                                                   01867000
@NM01594 DC    AL1(0)                                                   01868000
@NM01595 DC    AL1(0)                                                   01869000
@NM01596 DC    AL1(0)                                                   01870000
@NM01597 DC    H'64'                                                    01871000
@NM01598 DC    H'0'                                                     01872000
@NM01599 DC    CL1' '                                                   01873000
@NM01600 DC    CL49'TCB KEYWORD IS IGNORED WHEN QUALIFYING AN ADDRESS'  01874000
@NM01601 DC    CL1' '                                                   01875000
@NM01602 DC    CL1' '                                                   01876000
         ORG   M0227+62                                                 01877000
M0228    DS    CL75                                                     01878000
         ORG   M0228                                                    01879000
@NM01603 DC    AL1(23)                                                  01880000
@NM01604 DC    AL1(0)                                                   01881000
@NM01605 DC    AL1(0)                                                   01882000
@NM01606 DC    AL1(0)                                                   01883000
@NM01607 DC    AL1(0)                                                   01884000
@NM01608 DC    AL1(0)                                                   01885000
@NM01609 DC    H'77'                                                    01886000
@NM01610 DC    H'0'                                                     01887000
@NM01611 DC    CL1' '                                                   01888000
@NM01612 DC    CL12'NOT FOUND IN'                                       01889000
@NM01613 DC    CL1' '                                                   01890000
@NM01614 DC    CL49'UNDER THE TEST TASK STRUCTURE SYMBOLS UNAVAILABLE'  01891000
@NM01615 DC    CL1' '                                                   01892000
@NM01616 DC    CL1' '                                                   01893000
         ORG   M0228+75                                                 01894000
         DS    CL1                                                      01895000
M0229    DS    CL62                                                     01896000
         ORG   M0229                                                    01897000
@NM01617 DC    AL1(10)                                                  01898000
@NM01618 DC    AL1(0)                                                   01899000
@NM01619 DC    AL1(0)                                                   01900000
@NM01620 DC    AL1(0)                                                   01901000
@NM01621 DC    AL1(0)                                                   01902000
@NM01622 DC    AL1(0)                                                   01903000
@NM01623 DC    H'64'                                                    01904000
@NM01624 DC    H'0'                                                     01905000
@NM01625 DC    CL1' '                                                   01906000
@NM01626 DC    CL49'LOADED BY OS LOADER, INTERNAL SYMBOLS UNAVAILABLE'  01907000
@NM01627 DC    CL1' '                                                   01908000
@NM01628 DC    CL1' '                                                   01909000
         ORG   M0229+62                                                 01910000
M0230    DS    CL74                                                     01911000
         ORG   M0230                                                    01912000
@NM01629 DC    AL1(10)                                                  01913000
@NM01630 DC    AL1(0)                                                   01914000
@NM01631 DC    AL1(0)                                                   01915000
@NM01632 DC    AL1(0)                                                   01916000
@NM01633 DC    AL1(0)                                                   01917000
@NM01634 DC    AL1(0)                                                   01918000
@NM01635 DC    H'76'                                                    01919000
@NM01636 DC    H'0'                                                     01920000
@NM01637 DC    CL1' '                                                   01921000
@NM01638 DC    CL61'NOT BROUGHT INTO MAIN STORAGE UNDER TEST, SYMBOLS UC01922000
               NAVAILABLE'                                              01923000
@NM01639 DC    CL1' '                                                   01924000
@NM01640 DC    CL1' '                                                   01925000
         ORG   M0230+74                                                 01926000
M0231    DS    CL78                                                     01927000
         ORG   M0231                                                    01928000
@NM01641 DC    AL1(10)                                                  01929000
@NM01642 DC    AL1(0)                                                   01930000
@NM01643 DC    AL1(0)                                                   01931000
@NM01644 DC    AL1(0)                                                   01932000
@NM01645 DC    AL1(0)                                                   01933000
@NM01646 DC    AL1(0)                                                   01934000
@NM01647 DC    H'80'                                                    01935000
@NM01648 DC    H'0'                                                     01936000
@NM01649 DC    CL1' '                                                   01937000
@NM01650 DC    CL65'LOADED BY OS LOADER, NOT ENOUGH MAIN STORAGE FOR EXC01938000
               TERNAL SYMBOLS'                                          01939000
@NM01651 DC    CL1' '                                                   01940000
@NM01652 DC    CL1' '                                                   01941000
         ORG   M0231+78                                                 01942000
M0232    DS    CL77                                                     01943000
         ORG   M0232                                                    01944000
@NM01653 DC    AL1(10)                                                  01945000
@NM01654 DC    AL1(0)                                                   01946000
@NM01655 DC    AL1(0)                                                   01947000
@NM01656 DC    AL1(0)                                                   01948000
@NM01657 DC    AL1(0)                                                   01949000
@NM01658 DC    AL1(0)                                                   01950000
@NM01659 DC    H'79'                                                    01951000
@NM01660 DC    H'0'                                                     01952000
@NM01661 DC    CL1' '                                                   01953000
@NM01662 DC    CL64'LINK EDITED WITHOUT TEST PARAMETER, INTERNAL SYMBOLC01954000
               S UNAVAILABLE'                                           01955000
@NM01663 DC    CL1' '                                                   01956000
@NM01664 DC    CL1' '                                                   01957000
         ORG   M0232+77                                                 01958000
         DS    CL1                                                      01959000
M0233    DS    CL47                                                     01960000
         ORG   M0233                                                    01961000
@NM01665 DC    AL1(10)                                                  01962000
@NM01666 DC    AL1(43)                                                  01963000
@NM01667 DC    AL1(44)                                                  01964000
@NM01668 DC    AL1(0)                                                   01965000
@NM01669 DC    AL1(0)                                                   01966000
@NM01670 DC    AL1(0)                                                   01967000
@NM01671 DC    H'49'                                                    01968000
@NM01672 DC    H'0'                                                     01969000
@NM01673 DC    CL1' '                                                   01970000
@NM01674 DC    CL32'NOT IN INTERNAL SYMBOL TABLE FOR'                   01971000
@NM01675 DC    CL1' '                                                   01972000
@NM01676 DC    CL1' '                                                   01973000
@NM01677 DC    CL1' '                                                   01974000
@NM01678 DC    CL1' '                                                   01975000
         ORG   M0233+47                                                 01976000
         DS    CL1                                                      01977000
M0234    DS    CL55                                                     01978000
         ORG   M0234                                                    01979000
@NM01679 DC    AL1(10)                                                  01980000
@NM01680 DC    AL1(33)                                                  01981000
@NM01681 DC    AL1(0)                                                   01982000
@NM01682 DC    AL1(0)                                                   01983000
@NM01683 DC    AL1(0)                                                   01984000
@NM01684 DC    AL1(0)                                                   01985000
@NM01685 DC    H'57'                                                    01986000
@NM01686 DC    H'0'                                                     01987000
@NM01687 DC    CL1' '                                                   01988000
@NM01688 DC    CL22'LINK EDITED IN OVERLAY'                             01989000
@NM01689 DC    CL1' '                                                   01990000
@NM01690 DC    CL19'NOT IN MAIN STORAGE'                                01991000
@NM01691 DC    CL1' '                                                   01992000
@NM01692 DC    CL1' '                                                   01993000
         ORG   M0234+55                                                 01994000
         DS    CL1                                                      01995000
M0235    DS    CL76                                                     01996000
         ORG   M0235                                                    01997000
@NM01693 DC    AL1(10)                                                  01998000
@NM01694 DC    AL1(0)                                                   01999000
@NM01695 DC    AL1(0)                                                   02000000
@NM01696 DC    AL1(0)                                                   02001000
@NM01697 DC    AL1(0)                                                   02002000
@NM01698 DC    AL1(0)                                                   02003000
@NM01699 DC    H'78'                                                    02004000
@NM01700 DC    H'0'                                                     02005000
@NM01701 DC    CL1' '                                                   02006000
@NM01702 DC    CL63'ASSEMBLED WITHOUT TEST PARAMETERS, INTERNAL SYMBOLSC02007000
                UNAVAILABLE'                                            02008000
@NM01703 DC    CL1' '                                                   02009000
@NM01704 DC    CL1' '                                                   02010000
         ORG   M0235+76                                                 02011000
M0240    DS    CL40                                                     02012000
         ORG   M0240                                                    02013000
@NM01705 DC    AL1(34)                                                  02014000
@NM01706 DC    AL1(37)                                                  02015000
@NM01707 DC    AL1(0)                                                   02016000
@NM01708 DC    AL1(0)                                                   02017000
@NM01709 DC    AL1(0)                                                   02018000
@NM01710 DC    AL1(0)                                                   02019000
@NM01711 DC    H'42'                                                    02020000
@NM01712 DC    H'0'                                                     02021000
@NM01713 DC    CL1' '                                                   02022000
@NM01714 DC    CL23'MINIMUM LENGTH FOR TYPE'                            02023000
@NM01715 DC    CL1' '                                                   02024000
@NM01716 DC    CL2'IS'                                                  02025000
@NM01717 DC    CL1' '                                                   02026000
@NM01718 DC    CL1' '                                                   02027000
@NM01719 DC    CL1' '                                                   02028000
         ORG   M0240+40                                                 02029000
M0241    DS    CL40                                                     02030000
         ORG   M0241                                                    02031000
@NM01720 DC    AL1(34)                                                  02032000
@NM01721 DC    AL1(37)                                                  02033000
@NM01722 DC    AL1(0)                                                   02034000
@NM01723 DC    AL1(0)                                                   02035000
@NM01724 DC    AL1(0)                                                   02036000
@NM01725 DC    AL1(0)                                                   02037000
@NM01726 DC    H'42'                                                    02038000
@NM01727 DC    H'0'                                                     02039000
@NM01728 DC    CL1' '                                                   02040000
@NM01729 DC    CL23'MAXIMUM LENGTH FOR TYPE'                            02041000
@NM01730 DC    CL1' '                                                   02042000
@NM01731 DC    CL2'IS'                                                  02043000
@NM01732 DC    CL1' '                                                   02044000
@NM01733 DC    CL1' '                                                   02045000
@NM01734 DC    CL1' '                                                   02046000
         ORG   M0241+40                                                 02047000
M0242    DS    CL45                                                     02048000
         ORG   M0242                                                    02049000
@NM01735 DC    AL1(0)                                                   02050000
@NM01736 DC    AL1(0)                                                   02051000
@NM01737 DC    AL1(0)                                                   02052000
@NM01738 DC    AL1(0)                                                   02053000
@NM01739 DC    AL1(0)                                                   02054000
@NM01740 DC    AL1(0)                                                   02055000
@NM01741 DC    H'47'                                                    02056000
@NM01742 DC    H'0'                                                     02057000
@NM01743 DC    CL1' '                                                   02058000
@NM01744 DC    CL32'PART OF RANGE IS WRITE PROTECTED'                   02059000
@NM01745 DC    CL1' '                                                   02060000
@NM01746 DC    CL1' '                                                   02061000
         ORG   M0242+45                                                 02062000
         DS    CL1                                                      02063000
M0243    DS    CL58                                                     02064000
         ORG   M0243                                                    02065000
@NM01747 DC    AL1(0)                                                   02066000
@NM01748 DC    AL1(0)                                                   02067000
@NM01749 DC    AL1(0)                                                   02068000
@NM01750 DC    AL1(0)                                                   02069000
@NM01751 DC    AL1(0)                                                   02070000
@NM01752 DC    AL1(0)                                                   02071000
@NM01753 DC    H'60'                                                    02072000
@NM01754 DC    H'0'                                                     02073000
@NM01755 DC    CL1' '                                                   02074000
@NM01756 DC    CL45'COMMAND CHAIN LENGTH MAY NOT EXCEED 255 BYTES'      02075000
@NM01757 DC    CL1' '                                                   02076000
@NM01758 DC    CL1' '                                                   02077000
         ORG   M0243+58                                                 02078000
M0244    DS    CL28                                                     02079000
         ORG   M0244                                                    02080000
@NM01759 DC    AL1(0)                                                   02081000
@NM01760 DC    AL1(0)                                                   02082000
@NM01761 DC    AL1(0)                                                   02083000
@NM01762 DC    AL1(0)                                                   02084000
@NM01763 DC    AL1(0)                                                   02085000
@NM01764 DC    AL1(0)                                                   02086000
@NM01765 DC    H'30'                                                    02087000
@NM01766 DC    H'0'                                                     02088000
@NM01767 DC    CL1' '                                                   02089000
@NM01768 DC    CL15'INVALID OP CODE'                                    02090000
@NM01769 DC    CL1' '                                                   02091000
@NM01770 DC    CL1' '                                                   02092000
         ORG   M0244+28                                                 02093000
M0245    DS    CL50                                                     02094000
         ORG   M0245                                                    02095000
@NM01771 DC    AL1(0)                                                   02096000
@NM01772 DC    AL1(0)                                                   02097000
@NM01773 DC    AL1(0)                                                   02098000
@NM01774 DC    AL1(0)                                                   02099000
@NM01775 DC    AL1(0)                                                   02100000
@NM01776 DC    AL1(0)                                                   02101000
@NM01777 DC    H'52'                                                    02102000
@NM01778 DC    H'0'                                                     02103000
@NM01779 DC    CL1' '                                                   02104000
@NM01780 DC    CL37'FULLY QUALIFIED ADDRESS MUST BE GIVEN'              02105000
@NM01781 DC    CL1' '                                                   02106000
@NM01782 DC    CL1' '                                                   02107000
         ORG   M0245+50                                                 02108000
M0246    DS    CL63                                                     02109000
         ORG   M0246                                                    02110000
@NM01783 DC    AL1(0)                                                   02111000
@NM01784 DC    AL1(0)                                                   02112000
@NM01785 DC    AL1(0)                                                   02113000
@NM01786 DC    AL1(0)                                                   02114000
@NM01787 DC    AL1(0)                                                   02115000
@NM01788 DC    AL1(0)                                                   02116000
@NM01789 DC    H'65'                                                    02117000
@NM01790 DC    H'0'                                                     02118000
@NM01791 DC    CL1' '                                                   02119000
@NM01792 DC    CL50'ALL LOADNAMES FOR A DEFER REQUEST MUST BE THE SAVE' 02120000
@NM01793 DC    CL1' '                                                   02121000
@NM01794 DC    CL1' '                                                   02122000
         ORG   M0246+63                                                 02123000
         DS    CL1                                                      02124000
M0247    DS    CL42                                                     02125000
         ORG   M0247                                                    02126000
@NM01795 DC    AL1(0)                                                   02127000
@NM01796 DC    AL1(0)                                                   02128000
@NM01797 DC    AL1(0)                                                   02129000
@NM01798 DC    AL1(0)                                                   02130000
@NM01799 DC    AL1(0)                                                   02131000
@NM01800 DC    AL1(0)                                                   02132000
@NM01801 DC    H'44'                                                    02133000
@NM01802 DC    H'0'                                                     02134000
@NM01803 DC    CL1' '                                                   02135000
@NM01804 DC    CL29'DEBNMEXT FIELD IN DEB IS ZERO'                      02136000
@NM01805 DC    CL1' '                                                   02137000
@NM01806 DC    CL1' '                                                   02138000
         ORG   M0247+42                                                 02139000
M0248    DS    CL78                                                     02140000
         ORG   M0248                                                    02141000
@NM01807 DC    AL1(0)                                                   02142000
@NM01808 DC    AL1(0)                                                   02143000
@NM01809 DC    AL1(0)                                                   02144000
@NM01810 DC    AL1(0)                                                   02145000
@NM01811 DC    AL1(0)                                                   02146000
@NM01812 DC    AL1(0)                                                   02147000
@NM01813 DC    H'80'                                                    02148000
@NM01814 DC    H'0'                                                     02149000
@NM01815 DC    CL1' '                                                   02150000
@NM01816 DC    CL65'DATASET ASSOCIATED WITH DEB NOT ON A DIRECT ACCESS C02151000
               STORAGE DEVICE'                                          02152000
@NM01817 DC    CL1' '                                                   02153000
@NM01818 DC    CL1' '                                                   02154000
         ORG   M0248+78                                                 02155000
M0249    DS    CL23                                                     02156000
         ORG   M0249                                                    02157000
@NM01819 DC    AL1(0)                                                   02158000
@NM01820 DC    AL1(0)                                                   02159000
@NM01821 DC    AL1(0)                                                   02160000
@NM01822 DC    AL1(0)                                                   02161000
@NM01823 DC    AL1(0)                                                   02162000
@NM01824 DC    AL1(0)                                                   02163000
@NM01825 DC    H'25'                                                    02164000
@NM01826 DC    H'0'                                                     02165000
@NM01827 DC    CL1' '                                                   02166000
@NM01828 DC    CL10'OPEN ERROR'                                         02167000
@NM01829 DC    CL1' '                                                   02168000
@NM01830 DC    CL1' '                                                   02169000
         ORG   M0249+23                                                 02170000
         DS    CL1                                                      02171000
M0250    DS    CL30                                                     02172000
         ORG   M0250                                                    02173000
@NM01831 DC    AL1(0)                                                   02174000
@NM01832 DC    AL1(0)                                                   02175000
@NM01833 DC    AL1(0)                                                   02176000
@NM01834 DC    AL1(0)                                                   02177000
@NM01835 DC    AL1(0)                                                   02178000
@NM01836 DC    AL1(0)                                                   02179000
@NM01837 DC    H'32'                                                    02180000
@NM01838 DC    H'0'                                                     02181000
@NM01839 DC    CL1' '                                                   02182000
@NM01840 DC    CL17'BLDL ERROR CODE 4'                                  02183000
@NM01841 DC    CL1' '                                                   02184000
@NM01842 DC    CL1' '                                                   02185000
         ORG   M0250+30                                                 02186000
M0251    DS    CL37                                                     02187000
         ORG   M0251                                                    02188000
@NM01843 DC    AL1(0)                                                   02189000
@NM01844 DC    AL1(0)                                                   02190000
@NM01845 DC    AL1(0)                                                   02191000
@NM01846 DC    AL1(0)                                                   02192000
@NM01847 DC    AL1(0)                                                   02193000
@NM01848 DC    AL1(0)                                                   02194000
@NM01849 DC    H'39'                                                    02195000
@NM01850 DC    H'0'                                                     02196000
@NM01851 DC    CL1' '                                                   02197000
@NM01852 DC    CL24'PROGRAM NOT ON LOAD LIST'                           02198000
@NM01853 DC    CL1' '                                                   02199000
@NM01854 DC    CL1' '                                                   02200000
         ORG   M0251+37                                                 02201000
         DS    CL1                                                      02202000
M0252    DS    CL38                                                     02203000
         ORG   M0252                                                    02204000
@NM01855 DC    AL1(0)                                                   02205000
@NM01856 DC    AL1(0)                                                   02206000
@NM01857 DC    AL1(0)                                                   02207000
@NM01858 DC    AL1(0)                                                   02208000
@NM01859 DC    AL1(0)                                                   02209000
@NM01860 DC    AL1(0)                                                   02210000
@NM01861 DC    H'40'                                                    02211000
@NM01862 DC    H'0'                                                     02212000
@NM01863 DC    CL1' '                                                   02213000
@NM01864 DC    CL25'INVALID QUALIFIED ADDRESS'                          02214000
@NM01865 DC    CL1' '                                                   02215000
@NM01866 DC    CL1' '                                                   02216000
         ORG   M0252+38                                                 02217000
M0253    DS    CL31                                                     02218000
         ORG   M0253                                                    02219000
@NM01867 DC    AL1(28)                                                  02220000
@NM01868 DC    AL1(0)                                                   02221000
@NM01869 DC    AL1(0)                                                   02222000
@NM01870 DC    AL1(0)                                                   02223000
@NM01871 DC    AL1(0)                                                   02224000
@NM01872 DC    AL1(0)                                                   02225000
@NM01873 DC    H'33'                                                    02226000
@NM01874 DC    H'0'                                                     02227000
@NM01875 DC    CL1' '                                                   02228000
@NM01876 DC    CL17'SYSTEM ABEND CODE'                                  02229000
@NM01877 DC    CL1' '                                                   02230000
@NM01878 DC    CL1' '                                                   02231000
@NM01879 DC    CL1' '                                                   02232000
         ORG   M0253+31                                                 02233000
         DS    CL1                                                      02234000
M0255    DS    CL55                                                     02235000
         ORG   M0255                                                    02236000
@NM01880 DC    AL1(0)                                                   02237000
@NM01881 DC    AL1(0)                                                   02238000
@NM01882 DC    AL1(0)                                                   02239000
@NM01883 DC    AL1(0)                                                   02240000
@NM01884 DC    AL1(0)                                                   02241000
@NM01885 DC    AL1(0)                                                   02242000
@NM01886 DC    H'57'                                                    02243000
@NM01887 DC    H'0'                                                     02244000
@NM01888 DC    CL1' '                                                   02245000
@NM01889 DC    CL42'PRINT DATA SET MUST BE PHYSICAL SEQUENTIAL'         02246000
@NM01890 DC    CL1' '                                                   02247000
@NM01891 DC    CL1' '                                                   02248000
         ORG   M0255+55                                                 02249000
         DS    CL1                                                      02250000
M0257    DS    CL80                                                     02251000
         ORG   M0257                                                    02252000
@NM01892 DC    AL1(0)                                                   02253000
@NM01893 DC    AL1(0)                                                   02254000
@NM01894 DC    AL1(0)                                                   02255000
@NM01895 DC    AL1(0)                                                   02256000
@NM01896 DC    AL1(0)                                                   02257000
@NM01897 DC    AL1(0)                                                   02258000
@NM01898 DC    H'82'                                                    02259000
@NM01899 DC    H'0'                                                     02260000
@NM01900 DC    CL1' '                                                   02261000
@NM01901 DC    CL67'OVERLAY PROGRAMS NOT SUPPORTED BY RUN SUBCOMMAND, UC02262000
               SE GO SUBCOMMAND'                                        02263000
@NM01902 DC    CL1' '                                                   02264000
@NM01903 DC    CL1' '                                                   02265000
         ORG   M0257+80                                                 02266000
M0258    DS    CL44                                                     02267000
         ORG   M0258                                                    02268000
@NM01904 DC    AL1(0)                                                   02269000
@NM01905 DC    AL1(0)                                                   02270000
@NM01906 DC    AL1(0)                                                   02271000
@NM01907 DC    AL1(0)                                                   02272000
@NM01908 DC    AL1(0)                                                   02273000
@NM01909 DC    AL1(0)                                                   02274000
@NM01910 DC    H'46'                                                    02275000
@NM01911 DC    H'0'                                                     02276000
@NM01912 DC    CL1' '                                                   02277000
@NM01913 DC    CL31'UNABLE TO CONTINUE TEST SESSION'                    02278000
@NM01914 DC    CL1' '                                                   02279000
@NM01915 DC    CL1' '                                                   02280000
         ORG   M0258+44                                                 02281000
M0259    DS    CL57                                                     02282000
         ORG   M0259                                                    02283000
@NM01916 DC    AL1(13)                                                  02284000
@NM01917 DC    AL1(16)                                                  02285000
@NM01918 DC    AL1(35)                                                  02286000
@NM01919 DC    AL1(41)                                                  02287000
@NM01920 DC    AL1(54)                                                  02288000
@NM01921 DC    AL1(55)                                                  02289000
@NM01922 DC    H'60'                                                    02290000
@NM01923 DC    H'0'                                                     02291000
@NM01924 DC    CL1' '                                                   02292000
@NM01925 DC    CL2'IN'                                                  02293000
@NM01926 DC    CL1' '                                                   02294000
@NM01927 DC    CL2'AT'                                                  02295000
@NM01928 DC    CL1' '                                                   02296000
@NM01929 DC    CL18'ABEND CODE SYSTEM='                                 02297000
@NM01930 DC    CL1' '                                                   02298000
@NM01931 DC    CL5', IC='                                               02299000
@NM01932 DC    CL1' '                                                   02300000
@NM01933 DC    CL12'INSTR IMAGE='                                       02301000
@NM01934 DC    CL1' '                                                   02302000
@NM01935 DC    CL1' '                                                   02303000
@NM01936 DC    CL1' '                                                   02304000
         ORG   M0259+57                                                 02305000
         DS    CL1                                                      02306000
M0260    DS    CL33                                                     02307000
         ORG   M0260                                                    02308000
@NM01937 DC    AL1(0)                                                   02309000
@NM01938 DC    AL1(0)                                                   02310000
@NM01939 DC    AL1(0)                                                   02311000
@NM01940 DC    AL1(0)                                                   02312000
@NM01941 DC    AL1(0)                                                   02313000
@NM01942 DC    AL1(0)                                                   02314000
@NM01943 DC    H'35'                                                    02315000
@NM01944 DC    H'0'                                                     02316000
@NM01945 DC    CL1' '                                                   02317000
@NM01946 DC    CL20'INSUFFICIENT STORAGE'                               02318000
@NM01947 DC    CL1' '                                                   02319000
@NM01948 DC    CL1' '                                                   02320000
         ORG   M0260+33                                                 02321000
         DS    CL1                                                      02322000
M0266    DS    CL66                                                     02323000
         ORG   M0266                                                    02324000
@NM01949 DC    AL1(0)                                                   02325000
@NM01950 DC    AL1(0)                                                   02326000
@NM01951 DC    AL1(0)                                                   02327000
@NM01952 DC    AL1(0)                                                   02328000
@NM01953 DC    AL1(0)                                                   02329000
@NM01954 DC    AL1(0)                                                   02330000
@NM01955 DC    H'68'                                                    02331000
@NM01956 DC    H'0'                                                     02332000
@NM01957 DC    CL1' '                                                   02333000
@NM01958 DC    CL53'LENGTH MAY NOT EXCEED 64 WHEN REGISTERS ARE SPECIFIC02334000
               ED'                                                      02335000
@NM01959 DC    CL1' '                                                   02336000
@NM01960 DC    CL1' '                                                   02337000
         ORG   M0266+66                                                 02338000
M0267    DS    CL55                                                     02339000
         ORG   M0267                                                    02340000
@NM01961 DC    AL1(0)                                                   02341000
@NM01962 DC    AL1(0)                                                   02342000
@NM01963 DC    AL1(0)                                                   02343000
@NM01964 DC    AL1(0)                                                   02344000
@NM01965 DC    AL1(0)                                                   02345000
@NM01966 DC    AL1(0)                                                   02346000
@NM01967 DC    H'57'                                                    02347000
@NM01968 DC    H'0'                                                     02348000
@NM01969 DC    CL1' '                                                   02349000
@NM01970 DC    CL42'REGISTER NOTATION MUST BE GENERAL REGISTER'         02350000
@NM01971 DC    CL1' '                                                   02351000
@NM01972 DC    CL1' '                                                   02352000
         ORG   M0267+55                                                 02353000
         DS    CL1                                                      02354000
M0268    DS    CL90                                                     02355000
         ORG   M0268                                                    02356000
@NM01973 DC    AL1(0)                                                   02357000
@NM01974 DC    AL1(0)                                                   02358000
@NM01975 DC    AL1(0)                                                   02359000
@NM01976 DC    AL1(0)                                                   02360000
@NM01977 DC    AL1(0)                                                   02361000
@NM01978 DC    AL1(0)                                                   02362000
@NM01979 DC    H'92'                                                    02363000
@NM01980 DC    H'0'                                                     02364000
@NM01981 DC    CL1' '                                                   02365000
@NM01982 DC    CL77'REGISTER NOTATION MUST BE INDIRECT GENERAL REGISTERC02366000
                WHEN POINTER IS SPECIFIED'                              02367000
@NM01983 DC    CL1' '                                                   02368000
@NM01984 DC    CL1' '                                                   02369000
         ORG   M0268+90                                                 02370000
M0269    DS    CL39                                                     02371000
         ORG   M0269                                                    02372000
@NM01985 DC    AL1(36)                                                  02373000
@NM01986 DC    AL1(0)                                                   02374000
@NM01987 DC    AL1(0)                                                   02375000
@NM01988 DC    AL1(0)                                                   02376000
@NM01989 DC    AL1(0)                                                   02377000
@NM01990 DC    AL1(0)                                                   02378000
@NM01991 DC    H'41'                                                    02379000
@NM01992 DC    H'0'                                                     02380000
@NM01993 DC    CL1' '                                                   02381000
@NM01994 DC    CL25'SYSTEM COMPLETION CODE IS'                          02382000
@NM01995 DC    CL1' '                                                   02383000
@NM01996 DC    CL1' '                                                   02384000
@NM01997 DC    CL1' '                                                   02385000
         ORG   M0269+39                                                 02386000
         DS    CL1                                                      02387000
M0270    DS    CL37                                                     02388000
         ORG   M0270                                                    02389000
@NM01998 DC    AL1(34)                                                  02390000
@NM01999 DC    AL1(0)                                                   02391000
@NM02000 DC    AL1(0)                                                   02392000
@NM02001 DC    AL1(0)                                                   02393000
@NM02002 DC    AL1(0)                                                   02394000
@NM02003 DC    AL1(0)                                                   02395000
@NM02004 DC    H'39'                                                    02396000
@NM02005 DC    H'0'                                                     02397000
@NM02006 DC    CL1' '                                                   02398000
@NM02007 DC    CL23'USER COMPLETION CODE IS'                            02399000
@NM02008 DC    CL1' '                                                   02400000
@NM02009 DC    CL1' '                                                   02401000
@NM02010 DC    CL1' '                                                   02402000
         ORG   M0270+37                                                 02403000
         DS    CL1                                                      02404000
M0271    DS    CL34                                                     02405000
         ORG   M0271                                                    02406000
@NM02011 DC    AL1(0)                                                   02407000
@NM02012 DC    AL1(0)                                                   02408000
@NM02013 DC    AL1(0)                                                   02409000
@NM02014 DC    AL1(0)                                                   02410000
@NM02015 DC    AL1(0)                                                   02411000
@NM02016 DC    AL1(0)                                                   02412000
@NM02017 DC    H'36'                                                    02413000
@NM02018 DC    H'0'                                                     02414000
@NM02019 DC    CL1' '                                                   02415000
@NM02020 DC    CL21'MAXIMUM LENGTH IS 100'                              02416000
@NM02021 DC    CL1' '                                                   02417000
@NM02022 DC    CL1' '                                                   02418000
         ORG   M0271+34                                                 02419000
M0272    DS    CL52                                                     02420000
         ORG   M0272                                                    02421000
@NM02023 DC    AL1(0)                                                   02422000
@NM02024 DC    AL1(0)                                                   02423000
@NM02025 DC    AL1(0)                                                   02424000
@NM02026 DC    AL1(0)                                                   02425000
@NM02027 DC    AL1(0)                                                   02426000
@NM02028 DC    AL1(0)                                                   02427000
@NM02029 DC    H'54'                                                    02428000
@NM02030 DC    H'0'                                                     02429000
@NM02031 DC    CL1' '                                                   02430000
@NM02032 DC    CL39'REQUEST EXCEEDED GREATEST VALID ADDRESS'            02431000
@NM02033 DC    CL1' '                                                   02432000
@NM02034 DC    CL1' '                                                   02433000
         ORG   M0272+52                                                 02434000
M0273    DS    CL40                                                     02435000
         ORG   M0273                                                    02436000
@NM02035 DC    AL1(0)                                                   02437000
@NM02036 DC    AL1(0)                                                   02438000
@NM02037 DC    AL1(0)                                                   02439000
@NM02038 DC    AL1(0)                                                   02440000
@NM02039 DC    AL1(0)                                                   02441000
@NM02040 DC    AL1(0)                                                   02442000
@NM02041 DC    H'42'                                                    02443000
@NM02042 DC    H'0'                                                     02444000
@NM02043 DC    CL1' '                                                   02445000
@NM02044 DC    CL27'BREAKPOINT SVC ERROR CODE 4'                        02446000
@NM02045 DC    CL1' '                                                   02447000
@NM02046 DC    CL1' '                                                   02448000
         ORG   M0273+40                                                 02449000
M0274    DS    CL64                                                     02450000
         ORG   M0274                                                    02451000
@NM02047 DC    AL1(0)                                                   02452000
@NM02048 DC    AL1(0)                                                   02453000
@NM02049 DC    AL1(0)                                                   02454000
@NM02050 DC    AL1(0)                                                   02455000
@NM02051 DC    AL1(0)                                                   02456000
@NM02052 DC    AL1(0)                                                   02457000
@NM02053 DC    H'66'                                                    02458000
@NM02054 DC    H'0'                                                     02459000
@NM02055 DC    CL1' '                                                   02460000
@NM02056 DC    CL51'REGISTER NOTATION MUST BE INDIRECT GENERAL REGISTERC02461000
               '                                                        02462000
@NM02057 DC    CL1' '                                                   02463000
@NM02058 DC    CL1' '                                                   02464000
         ORG   M0274+64                                                 02465000
M0275    DS    CL37                                                     02466000
         ORG   M0275                                                    02467000
@NM02059 DC    AL1(34)                                                  02468000
@NM02060 DC    AL1(0)                                                   02469000
@NM02061 DC    AL1(0)                                                   02470000
@NM02062 DC    AL1(0)                                                   02471000
@NM02063 DC    AL1(0)                                                   02472000
@NM02064 DC    AL1(0)                                                   02473000
@NM02065 DC    H'39'                                                    02474000
@NM02066 DC    H'0'                                                     02475000
@NM02067 DC    CL1' '                                                   02476000
@NM02068 DC    CL23'INVALID RANGE BEGINNING'                            02477000
@NM02069 DC    CL1' '                                                   02478000
@NM02070 DC    CL1' '                                                   02479000
@NM02071 DC    CL1' '                                                   02480000
         ORG   M0275+37                                                 02481000
         DS    CL1                                                      02482000
M0276    DS    CL59                                                     02483000
         ORG   M0276                                                    02484000
@NM02072 DC    AL1(0)                                                   02485000
@NM02073 DC    AL1(0)                                                   02486000
@NM02074 DC    AL1(0)                                                   02487000
@NM02075 DC    AL1(0)                                                   02488000
@NM02076 DC    AL1(0)                                                   02489000
@NM02077 DC    AL1(0)                                                   02490000
@NM02078 DC    H'61'                                                    02491000
@NM02079 DC    H'0'                                                     02492000
@NM02080 DC    CL1' '                                                   02493000
@NM02081 DC    CL46'SYSTEM CONTROL BLOCK ERROR, TEST SESSION ENDED'     02494000
@NM02082 DC    CL1' '                                                   02495000
@NM02083 DC    CL1' '                                                   02496000
         ORG   M0276+59                                                 02497000
         DS    CL1                                                      02498000
M0277    DS    CL32                                                     02499000
         ORG   M0277                                                    02500000
@NM02084 DC    AL1(0)                                                   02501000
@NM02085 DC    AL1(0)                                                   02502000
@NM02086 DC    AL1(0)                                                   02503000
@NM02087 DC    AL1(0)                                                   02504000
@NM02088 DC    AL1(0)                                                   02505000
@NM02089 DC    AL1(0)                                                   02506000
@NM02090 DC    H'34'                                                    02507000
@NM02091 DC    H'0'                                                     02508000
@NM02092 DC    CL1' '                                                   02509000
@NM02093 DC    CL19'PARSE ERROR CODE 12'                                02510000
@NM02094 DC    CL1' '                                                   02511000
@NM02095 DC    CL1' '                                                   02512000
         ORG   M0277+32                                                 02513000
M0278    DS    CL45                                                     02514000
         ORG   M0278                                                    02515000
@NM02096 DC    AL1(0)                                                   02516000
@NM02097 DC    AL1(0)                                                   02517000
@NM02098 DC    AL1(0)                                                   02518000
@NM02099 DC    AL1(0)                                                   02519000
@NM02100 DC    AL1(0)                                                   02520000
@NM02101 DC    AL1(0)                                                   02521000
@NM02102 DC    H'47'                                                    02522000
@NM02103 DC    H'0'                                                     02523000
@NM02104 DC    CL1' '                                                   02524000
@NM02105 DC    CL32'THE VALID RANGE IS FROM 1 TO 256'                   02525000
@NM02106 DC    CL1' '                                                   02526000
@NM02107 DC    CL1' '                                                   02527000
         ORG   M0278+45                                                 02528000
         DS    CL1                                                      02529000
M0279    DS    CL47                                                     02530000
         ORG   M0279                                                    02531000
@NM02108 DC    AL1(0)                                                   02532000
@NM02109 DC    AL1(0)                                                   02533000
@NM02110 DC    AL1(0)                                                   02534000
@NM02111 DC    AL1(0)                                                   02535000
@NM02112 DC    AL1(0)                                                   02536000
@NM02113 DC    AL1(0)                                                   02537000
@NM02114 DC    H'49'                                                    02538000
@NM02115 DC    H'0'                                                     02539000
@NM02116 DC    CL1' '                                                   02540000
@NM02117 DC    CL34'ADDRESS IN WRITE PROTECTED STORAGE'                 02541000
@NM02118 DC    CL1' '                                                   02542000
@NM02119 DC    CL1' '                                                   02543000
         ORG   M0279+47                                                 02544000
         DS    CL1                                                      02545000
M0280    DS    CL30                                                     02546000
         ORG   M0280                                                    02547000
@NM02120 DC    AL1(10)                                                  02548000
@NM02121 DC    AL1(0)                                                   02549000
@NM02122 DC    AL1(0)                                                   02550000
@NM02123 DC    AL1(0)                                                   02551000
@NM02124 DC    AL1(0)                                                   02552000
@NM02125 DC    AL1(0)                                                   02553000
@NM02126 DC    H'32'                                                    02554000
@NM02127 DC    H'0'                                                     02555000
@NM02128 DC    CL1' '                                                   02556000
@NM02129 DC    CL17'BOUNDARY REQUIRED'                                  02557000
@NM02130 DC    CL1' '                                                   02558000
@NM02131 DC    CL1' '                                                   02559000
         ORG   M0280+30                                                 02560000
M0281    DS    CL51                                                     02561000
         ORG   M0281                                                    02562000
@NM02132 DC    AL1(0)                                                   02563000
@NM02133 DC    AL1(0)                                                   02564000
@NM02134 DC    AL1(0)                                                   02565000
@NM02135 DC    AL1(0)                                                   02566000
@NM02136 DC    AL1(0)                                                   02567000
@NM02137 DC    AL1(0)                                                   02568000
@NM02138 DC    H'53'                                                    02569000
@NM02139 DC    H'0'                                                     02570000
@NM02140 DC    CL1' '                                                   02571000
@NM02141 DC    CL38'SYMBOL LENGTH EXCEEDS EIGHT CHARACTERS'             02572000
@NM02142 DC    CL1' '                                                   02573000
@NM02143 DC    CL1' '                                                   02574000
         ORG   M0281+51                                                 02575000
         DS    CL1                                                      02576000
M0283    DS    CL40                                                     02577000
         ORG   M0283                                                    02578000
@NM02144 DC    AL1(0)                                                   02579000
@NM02145 DC    AL1(0)                                                   02580000
@NM02146 DC    AL1(0)                                                   02581000
@NM02147 DC    AL1(0)                                                   02582000
@NM02148 DC    AL1(0)                                                   02583000
@NM02149 DC    AL1(0)                                                   02584000
@NM02150 DC    H'42'                                                    02585000
@NM02151 DC    H'0'                                                     02586000
@NM02152 DC    CL1' '                                                   02587000
@NM02153 DC    CL27'SVC 97 RETURN CODE NON-ZERO'                        02588000
@NM02154 DC    CL1' '                                                   02589000
@NM02155 DC    CL1' '                                                   02590000
         ORG   M0283+40                                                 02591000
M0284    DS    CL47                                                     02592000
         ORG   M0284                                                    02593000
@NM02156 DC    AL1(0)                                                   02594000
@NM02157 DC    AL1(0)                                                   02595000
@NM02158 DC    AL1(0)                                                   02596000
@NM02159 DC    AL1(0)                                                   02597000
@NM02160 DC    AL1(0)                                                   02598000
@NM02161 DC    AL1(0)                                                   02599000
@NM02162 DC    H'49'                                                    02600000
@NM02163 DC    H'0'                                                     02601000
@NM02164 DC    CL1' '                                                   02602000
@NM02165 DC    CL34'LENGTH MUST BE BETWEEN 0 AND 65535'                 02603000
@NM02166 DC    CL1' '                                                   02604000
@NM02167 DC    CL1' '                                                   02605000
         ORG   M0284+47                                                 02606000
         DS    CL1                                                      02607000
M0285    DS    CL66                                                     02608000
         ORG   M0285                                                    02609000
@NM02168 DC    AL1(0)                                                   02610000
@NM02169 DC    AL1(0)                                                   02611000
@NM02170 DC    AL1(0)                                                   02612000
@NM02171 DC    AL1(0)                                                   02613000
@NM02172 DC    AL1(0)                                                   02614000
@NM02173 DC    AL1(0)                                                   02615000
@NM02174 DC    H'68'                                                    02616000
@NM02175 DC    H'0'                                                     02617000
@NM02176 DC    CL1' '                                                   02618000
@NM02177 DC    CL53'SVC 97 PASSED A RETURN CODE OF 8 AFTER VALIDITY CHEC02619000
               CK'                                                      02620000
@NM02178 DC    CL1' '                                                   02621000
@NM02179 DC    CL1' '                                                   02622000
         ORG   M0285+66                                                 02623000
M0287    DS    CL66                                                     02624000
         ORG   M0287                                                    02625000
@NM02180 DC    AL1(0)                                                   02626000
@NM02181 DC    AL1(0)                                                   02627000
@NM02182 DC    AL1(0)                                                   02628000
@NM02183 DC    AL1(0)                                                   02629000
@NM02184 DC    AL1(0)                                                   02630000
@NM02185 DC    AL1(0)                                                   02631000
@NM02186 DC    H'68'                                                    02632000
@NM02187 DC    H'0'                                                     02633000
@NM02188 DC    CL1' '                                                   02634000
@NM02189 DC    CL53'TEST SESSION CANCELLED DUE TO UNRECOVERABLE SVC ERRC02635000
               OR'                                                      02636000
@NM02190 DC    CL1' '                                                   02637000
@NM02191 DC    CL1' '                                                   02638000
         ORG   M0287+66                                                 02639000
M0294    DS    CL60                                                     02640000
         ORG   M0294                                                    02641000
@NM02192 DC    AL1(10)                                                  02642000
@NM02193 DC    AL1(19)                                                  02643000
@NM02194 DC    AL1(0)                                                   02644000
@NM02195 DC    AL1(0)                                                   02645000
@NM02196 DC    AL1(0)                                                   02646000
@NM02197 DC    AL1(0)                                                   02647000
@NM02198 DC    H'62'                                                    02648000
@NM02199 DC    H'0'                                                     02649000
@NM02200 DC    CL1' '                                                   02650000
@NM02201 DC    CL8'FOUND IN'                                            02651000
@NM02202 DC    CL1' '                                                   02652000
@NM02203 DC    CL38'DSECT FOR WHICH NO BASE ADDRESS EXISTS'             02653000
@NM02204 DC    CL1' '                                                   02654000
@NM02205 DC    CL1' '                                                   02655000
         ORG   M0294+60                                                 02656000
M0295    DS    CL52                                                     02657000
         ORG   M0295                                                    02658000
@NM02206 DC    AL1(10)                                                  02659000
@NM02207 DC    AL1(49)                                                  02660000
@NM02208 DC    AL1(0)                                                   02661000
@NM02209 DC    AL1(0)                                                   02662000
@NM02210 DC    AL1(0)                                                   02663000
@NM02211 DC    AL1(0)                                                   02664000
@NM02212 DC    H'54'                                                    02665000
@NM02213 DC    H'0'                                                     02666000
@NM02214 DC    CL1' '                                                   02667000
@NM02215 DC    CL38'NOT FOUND IN EXTERNAL SYMBOL TABLE FOR'             02668000
@NM02216 DC    CL1' '                                                   02669000
@NM02217 DC    CL1' '                                                   02670000
@NM02218 DC    CL1' '                                                   02671000
         ORG   M0295+52                                                 02672000
M0296    DS    CL44                                                     02673000
         ORG   M0296                                                    02674000
@NM02219 DC    AL1(0)                                                   02675000
@NM02220 DC    AL1(0)                                                   02676000
@NM02221 DC    AL1(0)                                                   02677000
@NM02222 DC    AL1(0)                                                   02678000
@NM02223 DC    AL1(0)                                                   02679000
@NM02224 DC    AL1(0)                                                   02680000
@NM02225 DC    H'46'                                                    02681000
@NM02226 DC    H'0'                                                     02682000
@NM02227 DC    CL1' '                                                   02683000
@NM02228 DC    CL31'LENGTH EXCEEDS EIGHT CHARACTERS'                    02684000
@NM02229 DC    CL1' '                                                   02685000
@NM02230 DC    CL1' '                                                   02686000
         ORG   M0296+44                                                 02687000
M0297    DS    CL30                                                     02688000
         ORG   M0297                                                    02689000
@NM02231 DC    AL1(0)                                                   02690000
@NM02232 DC    AL1(0)                                                   02691000
@NM02233 DC    AL1(0)                                                   02692000
@NM02234 DC    AL1(0)                                                   02693000
@NM02235 DC    AL1(0)                                                   02694000
@NM02236 DC    AL1(0)                                                   02695000
@NM02237 DC    H'32'                                                    02696000
@NM02238 DC    H'0'                                                     02697000
@NM02239 DC    CL1' '                                                   02698000
@NM02240 DC    CL17'BLDL ERROR CODE 8'                                  02699000
@NM02241 DC    CL1' '                                                   02700000
@NM02242 DC    CL1' '                                                   02701000
         ORG   M0297+30                                                 02702000
M0298    DS    CL43                                                     02703000
         ORG   M0298                                                    02704000
@NM02243 DC    AL1(10)                                                  02705000
@NM02244 DC    AL1(0)                                                   02706000
@NM02245 DC    AL1(0)                                                   02707000
@NM02246 DC    AL1(0)                                                   02708000
@NM02247 DC    AL1(0)                                                   02709000
@NM02248 DC    AL1(0)                                                   02710000
@NM02249 DC    H'45'                                                    02711000
@NM02250 DC    H'0'                                                     02712000
@NM02251 DC    CL1' '                                                   02713000
@NM02252 DC    CL30'EXTENDS INTO PROTECTED STORAGE'                     02714000
@NM02253 DC    CL1' '                                                   02715000
@NM02254 DC    CL1' '                                                   02716000
         ORG   M0298+43                                                 02717000
         DS    CL1                                                      02718000
M0299    DS    CL46                                                     02719000
         ORG   M0299                                                    02720000
@NM02255 DC    AL1(0)                                                   02721000
@NM02256 DC    AL1(0)                                                   02722000
@NM02257 DC    AL1(0)                                                   02723000
@NM02258 DC    AL1(0)                                                   02724000
@NM02259 DC    AL1(0)                                                   02725000
@NM02260 DC    AL1(0)                                                   02726000
@NM02261 DC    H'48'                                                    02727000
@NM02262 DC    H'0'                                                     02728000
@NM02263 DC    CL1' '                                                   02729000
@NM02264 DC    CL33'COUNT MUST BE BETWEEN 0 AND 65535'                  02730000
@NM02265 DC    CL1' '                                                   02731000
@NM02266 DC    CL1' '                                                   02732000
         ORG   M0299+46                                                 02733000
I002     DS    CL13                                                     02734000
         ORG   I002                                                     02735000
@NM02267 DC    H'13'                                                    02736000
@NM02268 DC    H'0'                                                     02737000
@NM02269 DC    CL8'HALFWORD'                                            02738000
@NM02270 DC    CL1' '                                                   02739000
         ORG   I002+13                                                  02740000
         DS    CL1                                                      02741000
I003     DS    CL13                                                     02742000
         ORG   I003                                                     02743000
@NM02271 DC    H'13'                                                    02744000
@NM02272 DC    H'0'                                                     02745000
@NM02273 DC    CL8'FULLWORD'                                            02746000
@NM02274 DC    CL1' '                                                   02747000
         ORG   I003+13                                                  02748000
         DS    CL1                                                      02749000
I004     DS    CL15                                                     02750000
         ORG   I004                                                     02751000
@NM02275 DC    H'15'                                                    02752000
@NM02276 DC    H'0'                                                     02753000
@NM02277 DC    CL10'DOUBLEWORD'                                         02754000
@NM02278 DC    CL1' '                                                   02755000
         ORG   I004+15                                                  02756000
         DS    CL1                                                      02757000
I006     DS    CL15                                                     02758000
         ORG   I006                                                     02759000
@NM02279 DC    H'15'                                                    02760000
@NM02280 DC    H'0'                                                     02761000
@NM02281 DC    CL10'ASSIGNMENT'                                         02762000
@NM02282 DC    CL1' '                                                   02763000
         ORG   I006+15                                                  02764000
         DS    CL1                                                      02765000
I007     DS    CL12                                                     02766000
         ORG   I007                                                     02767000
@NM02283 DC    H'12'                                                    02768000
@NM02284 DC    H'0'                                                     02769000
@NM02285 DC    CL7'LISTDCB'                                             02770000
@NM02286 DC    CL1' '                                                   02771000
         ORG   I007+12                                                  02772000
I008     DS    CL12                                                     02773000
         ORG   I008                                                     02774000
@NM02287 DC    H'12'                                                    02775000
@NM02288 DC    H'0'                                                     02776000
@NM02289 DC    CL7'LISTTCB'                                             02777000
@NM02290 DC    CL1' '                                                   02778000
         ORG   I008+12                                                  02779000
I009     DS    CL9                                                      02780000
         ORG   I009                                                     02781000
@NM02291 DC    H'9'                                                     02782000
@NM02292 DC    H'0'                                                     02783000
@NM02293 DC    CL4'LIST'                                                02784000
@NM02294 DC    CL1' '                                                   02785000
         ORG   I009+9                                                   02786000
         DS    CL1                                                      02787000
I0010    DS    CL12                                                     02788000
         ORG   I0010                                                    02789000
@NM02295 DC    H'12'                                                    02790000
@NM02296 DC    H'0'                                                     02791000
@NM02297 DC    CL7'QUALIFY'                                             02792000
@NM02298 DC    CL1' '                                                   02793000
         ORG   I0010+12                                                 02794000
I0011    DS    CL11                                                     02795000
         ORG   I0011                                                    02796000
@NM02299 DC    H'11'                                                    02797000
@NM02300 DC    H'0'                                                     02798000
@NM02301 DC    CL6'EQUATE'                                              02799000
@NM02302 DC    CL1' '                                                   02800000
         ORG   I0011+11                                                 02801000
         DS    CL1                                                      02802000
I0012    DS    CL9                                                      02803000
         ORG   I0012                                                    02804000
@NM02303 DC    H'9'                                                     02805000
@NM02304 DC    H'0'                                                     02806000
@NM02305 DC    CL4'DROP'                                                02807000
@NM02306 DC    CL1' '                                                   02808000
         ORG   I0012+9                                                  02809000
         DS    CL1                                                      02810000
I0013    DS    CL7                                                      02811000
         ORG   I0013                                                    02812000
@NM02307 DC    H'7'                                                     02813000
@NM02308 DC    H'0'                                                     02814000
@NM02309 DC    CL2'AT'                                                  02815000
@NM02310 DC    CL1' '                                                   02816000
         ORG   I0013+7                                                  02817000
         DS    CL1                                                      02818000
I0014    DS    CL12                                                     02819000
         ORG   I0014                                                    02820000
@NM02311 DC    H'12'                                                    02821000
@NM02312 DC    H'0'                                                     02822000
@NM02313 DC    CL7'LISTDEB'                                             02823000
@NM02314 DC    CL1' '                                                   02824000
         ORG   I0014+12                                                 02825000
I0015    DS    CL12                                                     02826000
         ORG   I0015                                                    02827000
@NM02315 DC    H'12'                                                    02828000
@NM02316 DC    H'0'                                                     02829000
@NM02317 DC    CL7'LISTPSW'                                             02830000
@NM02318 DC    CL1' '                                                   02831000
         ORG   I0015+12                                                 02832000
I0016    DS    CL10                                                     02833000
         ORG   I0016                                                    02834000
@NM02319 DC    H'10'                                                    02835000
@NM02320 DC    H'0'                                                     02836000
@NM02321 DC    CL5'WHERE'                                               02837000
@NM02322 DC    CL1' '                                                   02838000
         ORG   I0016+10                                                 02839000
I0017    DS    CL12                                                     02840000
         ORG   I0017                                                    02841000
@NM02323 DC    H'12'                                                    02842000
@NM02324 DC    H'0'                                                     02843000
@NM02325 DC    CL7'LISTMAP'                                             02844000
@NM02326 DC    CL1' '                                                   02845000
         ORG   I0017+12                                                 02846000
I0018    DS    CL7                                                      02847000
         ORG   I0018                                                    02848000
@NM02327 DC    H'7'                                                     02849000
@NM02328 DC    H'0'                                                     02850000
@NM02329 DC    CL2'GO'                                                  02851000
@NM02330 DC    CL1' '                                                   02852000
         ORG   I0018+7                                                  02853000
         DS    CL1                                                      02854000
I0019    DS    CL8                                                      02855000
         ORG   I0019                                                    02856000
@NM02331 DC    H'8'                                                     02857000
@NM02332 DC    H'0'                                                     02858000
@NM02333 DC    CL3'RUN'                                                 02859000
@NM02334 DC    CL1' '                                                   02860000
         ORG   I0019+8                                                  02861000
I0020    DS    CL9                                                      02862000
         ORG   I0020                                                    02863000
@NM02335 DC    H'9'                                                     02864000
@NM02336 DC    H'0'                                                     02865000
@NM02337 DC    CL4'CALL'                                                02866000
@NM02338 DC    CL1' '                                                   02867000
         ORG   I0020+9                                                  02868000
         DS    CL1                                                      02869000
I0022    DS    CL12                                                     02870000
         ORG   I0022                                                    02871000
@NM02339 DC    H'12'                                                    02872000
@NM02340 DC    H'0'                                                     02873000
@NM02341 DC    CL7'QUALIFY'                                             02874000
@NM02342 DC    CL1' '                                                   02875000
         ORG   I0022+12                                                 02876000
I0023    DS    CL9                                                      02877000
         ORG   I0023                                                    02878000
@NM02343 DC    H'9'                                                     02879000
@NM02344 DC    H'0'                                                     02880000
@NM02345 DC    CL4'LOAD'                                                02881000
@NM02346 DC    CL1' '                                                   02882000
         ORG   I0023+9                                                  02883000
         DS    CL1                                                      02884000
I0024    DS    CL11                                                     02885000
         ORG   I0024                                                    02886000
@NM02347 DC    H'11'                                                    02887000
@NM02348 DC    H'0'                                                     02888000
@NM02349 DC    CL6'DELETE'                                              02889000
@NM02350 DC    CL1' '                                                   02890000
         ORG   I0024+11                                                 02891000
         DS    CL1                                                      02892000
I0025    DS    CL12                                                     02893000
         ORG   I0025                                                    02894000
@NM02351 DC    H'12'                                                    02895000
@NM02352 DC    H'0'                                                     02896000
@NM02353 DC    CL7'GETMAIN'                                             02897000
@NM02354 DC    CL1' '                                                   02898000
         ORG   I0025+12                                                 02899000
I0026    DS    CL13                                                     02900000
         ORG   I0026                                                    02901000
@NM02355 DC    H'13'                                                    02902000
@NM02356 DC    H'0'                                                     02903000
@NM02357 DC    CL8'FREEMAIN'                                            02904000
@NM02358 DC    CL1' '                                                   02905000
         ORG   I0026+13                                                 02906000
         DS    CL1                                                      02907000
I0027    DS    CL11                                                     02908000
         ORG   I0027                                                    02909000
@NM02359 DC    H'11'                                                    02910000
@NM02360 DC    H'0'                                                     02911000
@NM02361 DC    CL6'ATTACH'                                              02912000
@NM02362 DC    CL1' '                                                   02913000
         ORG   I0027+11                                                 02914000
         DS    CL1                                                      02915000
I0030    DS    CL9                                                      02916000
         ORG   I0030                                                    02917000
@NM02363 DC    H'9'                                                     02918000
@NM02364 DC    H'0'                                                     02919000
@NM02365 DC    CL4'COPY'                                                02920000
@NM02366 DC    CL1' '                                                   02921000
         ORG   I0030+9                                                  02922000
         DS    CL1                                                      02923000
I0031    DS    CL11                                                     02924000
         ORG   I0031                                                    02925000
@NM02367 DC    H'11'                                                    02926000
@NM02368 DC    H'0'                                                     02927000
@NM02369 DC    CL6'LOADER'                                              02928000
@NM02370 DC    CL1' '                                                   02929000
         ORG   I0031+11                                                 02930000
         DS    CL1                                                      02931000
I0033    DS    CL18                                                     02932000
         ORG   I0033                                                    02933000
@NM02371 DC    H'18'                                                    02934000
@NM02372 DC    H'0'                                                     02935000
@NM02373 DC    CL13'LINK TO PARSE'                                      02936000
@NM02374 DC    CL1' '                                                   02937000
         ORG   I0033+18                                                 02938000
I0034    DS    CL16                                                     02939000
         ORG   I0034                                                    02940000
@NM02375 DC    H'16'                                                    02941000
@NM02376 DC    H'0'                                                     02942000
@NM02377 DC    CL11'LINK TO SYM'                                        02943000
@NM02378 DC    CL1' '                                                   02944000
         ORG   I0034+16                                                 02945000
I0035    DS    CL17                                                     02946000
         ORG   I0035                                                    02947000
@NM02379 DC    H'17'                                                    02948000
@NM02380 DC    H'0'                                                     02949000
@NM02381 DC    CL12'LINK TO DAIR'                                       02950000
@NM02382 DC    CL1' '                                                   02951000
         ORG   I0035+17                                                 02952000
         DS    CL1                                                      02953000
I0036    DS    CL9                                                      02954000
         ORG   I0036                                                    02955000
@NM02383 DC    H'9'                                                     02956000
@NM02384 DC    H'0'                                                     02957000
@NM02385 DC    CL4'LINK'                                                02958000
@NM02386 DC    CL1' '                                                   02959000
         ORG   I0036+9                                                  02960000
         DS    CL1                                                      02961000
I0040    DS    CL12                                                     02962000
         ORG   I0040                                                    02963000
@NM02387 DC    H'12'                                                    02964000
@NM02388 DC    H'0'                                                     02965000
@NM02389 DC    CL7'IKJPARS'                                             02966000
@NM02390 DC    CL1' '                                                   02967000
         ORG   I0040+12                                                 02968000
I0041    DS    CL12                                                     02969000
         ORG   I0041                                                    02970000
@NM02391 DC    H'12'                                                    02971000
@NM02392 DC    H'0'                                                     02972000
@NM02393 DC    CL7'IKJDAIR'                                             02973000
@NM02394 DC    CL1' '                                                   02974000
         ORG   I0041+12                                                 02975000
I0042    DS    CL13                                                     02976000
         ORG   I0042                                                    02977000
@NM02395 DC    H'13'                                                    02978000
@NM02396 DC    H'0'                                                     02979000
@NM02397 DC    CL8'IKJEFF18'                                            02980000
@NM02398 DC    CL1' '                                                   02981000
         ORG   I0042+13                                                 02982000
         DS    CL1                                                      02983000
I0043    DS    CL18                                                     02984000
         ORG   I0043                                                    02985000
@NM02399 DC    H'18'                                                    02986000
@NM02400 DC    H'0'                                                     02987000
@NM02401 DC    CL13'IKJSCAN(SCAN)'                                      02988000
@NM02402 DC    CL1' '                                                   02989000
         ORG   I0043+18                                                 02990000
I0046    DS    CL12                                                     02991000
         ORG   I0046                                                    02992000
@NM02403 DC    H'12'                                                    02993000
@NM02404 DC    H'0'                                                     02994000
@NM02405 DC    CL7'IKJDFLT'                                             02995000
@NM02406 DC    CL1' '                                                   02996000
         ORG   I0046+12                                                 02997000
I0047    DS    CL10                                                     02998000
         ORG   I0047                                                    02999000
@NM02407 DC    H'10'                                                    03000000
@NM02408 DC    H'0'                                                     03001000
@NM02409 DC    CL5'ESTAE'                                               03002000
@NM02410 DC    CL1' '                                                   03003000
         ORG   I0047+10                                                 03004000
I0048    DS    CL35                                                     03005000
         ORG   I0048                                                    03006000
@NM02678 DC    H'35'                                                    03007000
@NM02679 DC    H'0'                                                     03008000
@NM02680 DC    CL30'PROGRAM CHECK OR LOOP IN FETCH'                     03009000
@NM02681 DC    CL1' '                                                   03010000
         ORG   I0048+35                                                 03011000
         DS    CL1                                                      03012000
I0049    DS    CL52                                                     03013000
         ORG   I0049                                                    03014000
@NM02682 DC    H'52'                                                    03015000
@NM02683 DC    H'0'                                                     03016000
@NM02684 DC    CL47'INSUFFICIENT CORE ON GETMAIN OF MODULE BY FETCH'    03017000
@NM02685 DC    CL1' '                                                   03018000
         ORG   I0049+52                                                 03019000
I0050    DS    CL24                                                     03020000
         ORG   I0050                                                    03021000
@NM02686 DC    H'24'                                                    03022000
@NM02687 DC    H'0'                                                     03023000
@NM02688 DC    CL19'INVALID RECORD TYPE'                                03024000
@NM02689 DC    CL1' '                                                   03025000
         ORG   I0050+24                                                 03026000
I0054    DS    CL8                                                      03027000
         ORG   I0054                                                    03028000
@NM02411 DC    H'8'                                                     03029000
@NM02412 DC    H'0'                                                     03030000
@NM02413 DC    CL3'106'                                                 03031000
@NM02414 DC    CL1' '                                                   03032000
         ORG   I0054+8                                                  03033000
I0055    DS    CL8                                                      03034000
         ORG   I0055                                                    03035000
@NM02415 DC    H'8'                                                     03036000
@NM02416 DC    H'0'                                                     03037000
@NM02417 DC    CL3'206'                                                 03038000
@NM02418 DC    CL1' '                                                   03039000
         ORG   I0055+8                                                  03040000
I0056    DS    CL8                                                      03041000
         ORG   I0056                                                    03042000
@NM02419 DC    H'8'                                                     03043000
@NM02420 DC    H'0'                                                     03044000
@NM02421 DC    CL3'306'                                                 03045000
@NM02422 DC    CL1' '                                                   03046000
         ORG   I0056+8                                                  03047000
I0057    DS    CL8                                                      03048000
         ORG   I0057                                                    03049000
@NM02423 DC    H'8'                                                     03050000
@NM02424 DC    H'0'                                                     03051000
@NM02425 DC    CL3'406'                                                 03052000
@NM02426 DC    CL1' '                                                   03053000
         ORG   I0057+8                                                  03054000
I0058    DS    CL8                                                      03055000
         ORG   I0058                                                    03056000
@NM02427 DC    H'8'                                                     03057000
@NM02428 DC    H'0'                                                     03058000
@NM02429 DC    CL3'706'                                                 03059000
@NM02430 DC    CL1' '                                                   03060000
         ORG   I0058+8                                                  03061000
I0059    DS    CL8                                                      03062000
         ORG   I0059                                                    03063000
@NM02431 DC    H'8'                                                     03064000
@NM02432 DC    H'0'                                                     03065000
@NM02433 DC    CL3'806'                                                 03066000
@NM02434 DC    CL1' '                                                   03067000
         ORG   I0059+8                                                  03068000
I0060    DS    CL8                                                      03069000
         ORG   I0060                                                    03070000
@NM02435 DC    H'8'                                                     03071000
@NM02436 DC    H'0'                                                     03072000
@NM02437 DC    CL3'906'                                                 03073000
@NM02438 DC    CL1' '                                                   03074000
         ORG   I0060+8                                                  03075000
I0061    DS    CL8                                                      03076000
         ORG   I0061                                                    03077000
@NM02439 DC    H'8'                                                     03078000
@NM02440 DC    H'0'                                                     03079000
@NM02441 DC    CL3'A06'                                                 03080000
@NM02442 DC    CL1' '                                                   03081000
         ORG   I0061+8                                                  03082000
I0070    DS    CL34                                                     03083000
         ORG   I0070                                                    03084000
@NM02690 DC    H'34'                                                    03085000
@NM02691 DC    H'0'                                                     03086000
@NM02692 DC    CL29'INVALID ADDRESS PASSED TO SVC'                      03087000
@NM02693 DC    CL1' '                                                   03088000
         ORG   I0070+34                                                 03089000
I0071    DS    CL21                                                     03090000
         ORG   I0071                                                    03091000
@NM02694 DC    H'21'                                                    03092000
@NM02695 DC    H'0'                                                     03093000
@NM02696 DC    CL16'I/O ERROR IN SVC'                                   03094000
@NM02697 DC    CL1' '                                                   03095000
         ORG   I0071+21                                                 03096000
         DS    CL1                                                      03097000
I0072    DS    CL46                                                     03098000
         ORG   I0072                                                    03099000
@NM02771 DC    H'46'                                                    03100000
@NM02772 DC    H'0'                                                     03101000
@NM02773 DC    CL41'THE MODULE NOT IN(PRIVATE JOB OR LINKLIB)'          03102000
@NM02774 DC    CL1' '                                                   03103000
         ORG   I0072+46                                                 03104000
I0073    DS    CL14                                                     03105000
         ORG   I0073                                                    03106000
@NM02775 DC    H'14'                                                    03107000
@NM02776 DC    H'0'                                                     03108000
@NM02777 DC    CL9'I/O ERROR'                                           03109000
@NM02778 DC    CL1' '                                                   03110000
         ORG   I0073+14                                                 03111000
I0074    DS    CL39                                                     03112000
         ORG   I0074                                                    03113000
@NM02779 DC    H'39'                                                    03114000
@NM02780 DC    H'0'                                                     03115000
@NM02781 DC    CL34'MODULE NOT IN LPA OR LPA DIRECTORY'                 03116000
@NM02782 DC    CL1' '                                                   03117000
         ORG   I0074+39                                                 03118000
         DS    CL1                                                      03119000
I0077    DS    CL7                                                      03120000
         ORG   I0077                                                    03121000
@NM02443 DC    H'7'                                                     03122000
@NM02444 DC    H'0'                                                     03123000
@NM02445 DC    CL2'04'                                                  03124000
@NM02446 DC    CL1' '                                                   03125000
         ORG   I0077+7                                                  03126000
         DS    CL1                                                      03127000
I0078    DS    CL7                                                      03128000
         ORG   I0078                                                    03129000
@NM02447 DC    H'7'                                                     03130000
@NM02448 DC    H'0'                                                     03131000
@NM02449 DC    CL2'08'                                                  03132000
@NM02450 DC    CL1' '                                                   03133000
         ORG   I0078+7                                                  03134000
         DS    CL1                                                      03135000
I0079    DS    CL7                                                      03136000
         ORG   I0079                                                    03137000
@NM02451 DC    H'7'                                                     03138000
@NM02452 DC    H'0'                                                     03139000
@NM02453 DC    CL2'0C'                                                  03140000
@NM02454 DC    CL1' '                                                   03141000
         ORG   I0079+7                                                  03142000
         DS    CL1                                                      03143000
I0080    DS    CL7                                                      03144000
         ORG   I0080                                                    03145000
@NM02455 DC    H'7'                                                     03146000
@NM02456 DC    H'0'                                                     03147000
@NM02457 DC    CL2'10'                                                  03148000
@NM02458 DC    CL1' '                                                   03149000
         ORG   I0080+7                                                  03150000
         DS    CL1                                                      03151000
I0081    DS    CL7                                                      03152000
         ORG   I0081                                                    03153000
@NM02459 DC    H'7'                                                     03154000
@NM02460 DC    H'0'                                                     03155000
@NM02461 DC    CL2'14'                                                  03156000
@NM02462 DC    CL1' '                                                   03157000
         ORG   I0081+7                                                  03158000
         DS    CL1                                                      03159000
I0082    DS    CL7                                                      03160000
         ORG   I0082                                                    03161000
@NM02463 DC    H'7'                                                     03162000
@NM02464 DC    H'0'                                                     03163000
@NM02465 DC    CL2'18'                                                  03164000
@NM02466 DC    CL1' '                                                   03165000
         ORG   I0082+7                                                  03166000
         DS    CL1                                                      03167000
I0083    DS    CL17                                                     03168000
         ORG   I0083                                                    03169000
@NM02467 DC    H'17'                                                    03170000
@NM02468 DC    H'0'                                                     03171000
@NM02469 DC    CL12'MULTIPLICITY'                                       03172000
@NM02470 DC    CL1' '                                                   03173000
         ORG   I0083+17                                                 03174000
         DS    CL1                                                      03175000
I0084    DS    CL11                                                     03176000
         ORG   I0084                                                    03177000
@NM02471 DC    H'11'                                                    03178000
@NM02472 DC    H'0'                                                     03179000
@NM02473 DC    CL6'LENGTH'                                              03180000
@NM02474 DC    CL1' '                                                   03181000
         ORG   I0084+11                                                 03182000
         DS    CL1                                                      03183000
I0085    DS    CL13                                                     03184000
         ORG   I0085                                                    03185000
@NM02475 DC    H'13'                                                    03186000
@NM02476 DC    H'0'                                                     03187000
@NM02477 DC    CL8'IKJEGSYM'                                            03188000
@NM02478 DC    CL1' '                                                   03189000
         ORG   I0085+13                                                 03190000
         DS    CL1                                                      03191000
I0086    DS    CL8                                                      03192000
         ORG   I0086                                                    03193000
@NM02479 DC    H'8'                                                     03194000
@NM02480 DC    H'0'                                                     03195000
@NM02481 DC    CL3'DEB'                                                 03196000
@NM02482 DC    CL1' '                                                   03197000
         ORG   I0086+8                                                  03198000
I0087    DS    CL13                                                     03199000
         ORG   I0087                                                    03200000
@NM02483 DC    H'13'                                                    03201000
@NM02484 DC    H'0'                                                     03202000
@NM02485 DC    CL8'IKJEGLDF'                                            03203000
@NM02486 DC    CL1' '                                                   03204000
         ORG   I0087+13                                                 03205000
         DS    CL1                                                      03206000
I0089    DS    CL7                                                      03207000
         ORG   I0089                                                    03208000
@NM02487 DC    H'7'                                                     03209000
@NM02488 DC    H'0'                                                     03210000
@NM02489 DC    CL2'1C'                                                  03211000
@NM02490 DC    CL1' '                                                   03212000
         ORG   I0089+7                                                  03213000
         DS    CL1                                                      03214000
I0092    DS    CL25                                                     03215000
         ORG   I0092                                                    03216000
@NM02491 DC    H'25'                                                    03217000
@NM02492 DC    H'0'                                                     03218000
@NM02493 DC    CL20'INSUFFICIENT STORAGE'                               03219000
@NM02494 DC    CL1' '                                                   03220000
         ORG   I0092+25                                                 03221000
         DS    CL1                                                      03222000
I0093    DS    CL25                                                     03223000
         ORG   I0093                                                    03224000
@NM02495 DC    H'25'                                                    03225000
@NM02496 DC    H'0'                                                     03226000
@NM02497 DC    CL20'PROTECTION VIOLATION'                               03227000
@NM02498 DC    CL1' '                                                   03228000
         ORG   I0093+25                                                 03229000
         DS    CL1                                                      03230000
I0094    DS    CL16                                                     03231000
         ORG   I0094                                                    03232000
@NM02499 DC    H'16'                                                    03233000
@NM02500 DC    H'0'                                                     03234000
@NM02501 DC    CL11'LOAD FAILED'                                        03235000
@NM02502 DC    CL1' '                                                   03236000
         ORG   I0094+16                                                 03237000
I0095    DS    CL18                                                     03238000
         ORG   I0095                                                    03239000
@NM02503 DC    H'18'                                                    03240000
@NM02504 DC    H'0'                                                     03241000
@NM02505 DC    CL13'ATTACH FAILED'                                      03242000
@NM02506 DC    CL1' '                                                   03243000
         ORG   I0095+18                                                 03244000
I0096    DS    CL16                                                     03245000
         ORG   I0096                                                    03246000
@NM02507 DC    H'16'                                                    03247000
@NM02508 DC    H'0'                                                     03248000
@NM02509 DC    CL11'OPEN FAILED'                                        03249000
@NM02510 DC    CL1' '                                                   03250000
         ORG   I0096+16                                                 03251000
I0097    DS    CL43                                                     03252000
         ORG   I0097                                                    03253000
@NM02511 DC    H'43'                                                    03254000
@NM02512 DC    H'0'                                                     03255000
@NM02513 DC    CL38'SPECIFIED AREA IS IN PROTECTED STORAGE'             03256000
@NM02514 DC    CL1' '                                                   03257000
         ORG   I0097+43                                                 03258000
         DS    CL1                                                      03259000
I0098    DS    CL24                                                     03260000
         ORG   I0098                                                    03261000
@NM02515 DC    H'24'                                                    03262000
@NM02516 DC    H'0'                                                     03263000
@NM02517 DC    CL19'INVALID DEB ADDRESS'                                03264000
@NM02518 DC    CL1' '                                                   03265000
         ORG   I0098+24                                                 03266000
I0099    DS    CL16                                                     03267000
         ORG   I0099                                                    03268000
@NM02519 DC    H'16'                                                    03269000
@NM02520 DC    H'0'                                                     03270000
@NM02521 DC    CL11'LINK FAILED'                                        03271000
@NM02522 DC    CL1' '                                                   03272000
         ORG   I0099+16                                                 03273000
I00100   DS    CL25                                                     03274000
         ORG   I00100                                                   03275000
@NM02523 DC    H'25'                                                    03276000
@NM02524 DC    H'0'                                                     03277000
@NM02525 DC    CL20'IN A NON-TEST MODULE'                               03278000
@NM02526 DC    CL1' '                                                   03279000
         ORG   I00100+25                                                03280000
         DS    CL1                                                      03281000
I00101   DS    CL24                                                     03282000
         ORG   I00101                                                   03283000
@NM02527 DC    H'24'                                                    03284000
@NM02528 DC    H'0'                                                     03285000
@NM02529 DC    CL19'IN IGC0006A(SVC 61)'                                03286000
@NM02530 DC    CL1' '                                                   03287000
         ORG   I00101+24                                                03288000
I00102   DS    CL24                                                     03289000
         ORG   I00102                                                   03290000
@NM02531 DC    H'24'                                                    03291000
@NM02532 DC    H'0'                                                     03292000
@NM02533 DC    CL19'IN IGC0009G(SVC 97)'                                03293000
@NM02534 DC    CL1' '                                                   03294000
         ORG   I00102+24                                                03295000
I00103   DS    CL16                                                     03296000
         ORG   I00103                                                   03297000
@NM02535 DC    H'16'                                                    03298000
@NM02536 DC    H'0'                                                     03299000
@NM02537 DC    CL11'IN IKJEGASN'                                        03300000
@NM02538 DC    CL1' '                                                   03301000
         ORG   I00103+16                                                03302000
I00104   DS    CL15                                                     03303000
         ORG   I00104                                                   03304000
@NM02539 DC    H'15'                                                    03305000
@NM02540 DC    H'0'                                                     03306000
@NM02541 DC    CL10'IN IKJEGAT'                                         03307000
@NM02542 DC    CL1' '                                                   03308000
         ORG   I00104+15                                                03309000
         DS    CL1                                                      03310000
I00105   DS    CL16                                                     03311000
         ORG   I00105                                                   03312000
@NM02543 DC    H'16'                                                    03313000
@NM02544 DC    H'0'                                                     03314000
@NM02545 DC    CL11'IN IKJEGATD'                                        03315000
@NM02546 DC    CL1' '                                                   03316000
         ORG   I00105+16                                                03317000
I00106   DS    CL16                                                     03318000
         ORG   I00106                                                   03319000
@NM02547 DC    H'16'                                                    03320000
@NM02548 DC    H'0'                                                     03321000
@NM02549 DC    CL11'IN IKJEGATN'                                        03322000
@NM02550 DC    CL1' '                                                   03323000
         ORG   I00106+16                                                03324000
I00107   DS    CL16                                                     03325000
         ORG   I00107                                                   03326000
@NM02551 DC    H'16'                                                    03327000
@NM02552 DC    H'0'                                                     03328000
@NM02553 DC    CL11'IN IKJEGCIV'                                        03329000
@NM02554 DC    CL1' '                                                   03330000
         ORG   I00107+16                                                03331000
I00108   DS    CL16                                                     03332000
         ORG   I00108                                                   03333000
@NM02555 DC    H'16'                                                    03334000
@NM02556 DC    H'0'                                                     03335000
@NM02557 DC    CL11'IN IKJEGCPY'                                        03336000
@NM02558 DC    CL1' '                                                   03337000
         ORG   I00108+16                                                03338000
I00109   DS    CL16                                                     03339000
         ORG   I00109                                                   03340000
@NM02559 DC    H'16'                                                    03341000
@NM02560 DC    H'0'                                                     03342000
@NM02561 DC    CL11'IN IKJEGCVT'                                        03343000
@NM02562 DC    CL1' '                                                   03344000
         ORG   I00109+16                                                03345000
I00110   DS    CL16                                                     03346000
         ORG   I00110                                                   03347000
@NM02563 DC    H'16'                                                    03348000
@NM02564 DC    H'0'                                                     03349000
@NM02565 DC    CL11'IN IKJEGDCB'                                        03350000
@NM02566 DC    CL1' '                                                   03351000
         ORG   I00110+16                                                03352000
I00111   DS    CL16                                                     03353000
         ORG   I00111                                                   03354000
@NM02567 DC    H'16'                                                    03355000
@NM02568 DC    H'0'                                                     03356000
@NM02569 DC    CL11'IN IKJEGDEB'                                        03357000
@NM02570 DC    CL1' '                                                   03358000
         ORG   I00111+16                                                03359000
I00112   DS    CL16                                                     03360000
         ORG   I00112                                                   03361000
@NM02571 DC    H'16'                                                    03362000
@NM02572 DC    H'0'                                                     03363000
@NM02573 DC    CL11'IN IKJEGEND'                                        03364000
@NM02574 DC    CL1' '                                                   03365000
         ORG   I00112+16                                                03366000
I00113   DS    CL16                                                     03367000
         ORG   I00113                                                   03368000
@NM02575 DC    H'16'                                                    03369000
@NM02576 DC    H'0'                                                     03370000
@NM02577 DC    CL11'IN IKJEGEQU'                                        03371000
@NM02578 DC    CL1' '                                                   03372000
         ORG   I00113+16                                                03373000
I00114   DS    CL15                                                     03374000
         ORG   I00114                                                   03375000
@NM02579 DC    H'15'                                                    03376000
@NM02580 DC    H'0'                                                     03377000
@NM02581 DC    CL10'IN IKJEGGO'                                         03378000
@NM02582 DC    CL1' '                                                   03379000
         ORG   I00114+15                                                03380000
         DS    CL1                                                      03381000
I00115   DS    CL16                                                     03382000
         ORG   I00115                                                   03383000
@NM02583 DC    H'16'                                                    03384000
@NM02584 DC    H'0'                                                     03385000
@NM02585 DC    CL11'IN IKJEGINT'                                        03386000
@NM02586 DC    CL1' '                                                   03387000
         ORG   I00115+16                                                03388000
I00116   DS    CL15                                                     03389000
         ORG   I00116                                                   03390000
@NM02587 DC    H'15'                                                    03391000
@NM02588 DC    H'0'                                                     03392000
@NM02589 DC    CL10'IN IKJEGIO'                                         03393000
@NM02590 DC    CL1' '                                                   03394000
         ORG   I00116+15                                                03395000
         DS    CL1                                                      03396000
I00117   DS    CL16                                                     03397000
         ORG   I00117                                                   03398000
@NM02591 DC    H'16'                                                    03399000
@NM02592 DC    H'0'                                                     03400000
@NM02593 DC    CL11'IN IKJEGLDF'                                        03401000
@NM02594 DC    CL1' '                                                   03402000
         ORG   I00117+16                                                03403000
I00118   DS    CL16                                                     03404000
         ORG   I00118                                                   03405000
@NM02595 DC    H'16'                                                    03406000
@NM02596 DC    H'0'                                                     03407000
@NM02597 DC    CL11'IN IKJEGLDR'                                        03408000
@NM02598 DC    CL1' '                                                   03409000
         ORG   I00118+16                                                03410000
I00119   DS    CL16                                                     03411000
         ORG   I00119                                                   03412000
@NM02599 DC    H'16'                                                    03413000
@NM02600 DC    H'0'                                                     03414000
@NM02601 DC    CL11'IN IKJEGLSA'                                        03415000
@NM02602 DC    CL1' '                                                   03416000
         ORG   I00119+16                                                03417000
I00120   DS    CL16                                                     03418000
         ORG   I00120                                                   03419000
@NM02603 DC    H'16'                                                    03420000
@NM02604 DC    H'0'                                                     03421000
@NM02605 DC    CL11'IN IKJEGLST'                                        03422000
@NM02606 DC    CL1' '                                                   03423000
         ORG   I00120+16                                                03424000
I00121   DS    CL16                                                     03425000
         ORG   I00121                                                   03426000
@NM02607 DC    H'16'                                                    03427000
@NM02608 DC    H'0'                                                     03428000
@NM02609 DC    CL11'IN IKJEGMAP'                                        03429000
@NM02610 DC    CL1' '                                                   03430000
         ORG   I00121+16                                                03431000
I00122   DS    CL16                                                     03432000
         ORG   I00122                                                   03433000
@NM02611 DC    H'16'                                                    03434000
@NM02612 DC    H'0'                                                     03435000
@NM02613 DC    CL11'IN IKJEGMNL'                                        03436000
@NM02614 DC    CL1' '                                                   03437000
         ORG   I00122+16                                                03438000
I00123   DS    CL16                                                     03439000
         ORG   I00123                                                   03440000
@NM02615 DC    H'16'                                                    03441000
@NM02616 DC    H'0'                                                     03442000
@NM02617 DC    CL11'IN IKJEGOFF'                                        03443000
@NM02618 DC    CL1' '                                                   03444000
         ORG   I00123+16                                                03445000
I00124   DS    CL16                                                     03446000
         ORG   I00124                                                   03447000
@NM02619 DC    H'16'                                                    03448000
@NM02620 DC    H'0'                                                     03449000
@NM02621 DC    CL11'IN IKJEGPCH'                                        03450000
@NM02622 DC    CL1' '                                                   03451000
         ORG   I00124+16                                                03452000
I00125   DS    CL16                                                     03453000
         ORG   I00125                                                   03454000
@NM02623 DC    H'16'                                                    03455000
@NM02624 DC    H'0'                                                     03456000
@NM02625 DC    CL11'IN IKJEGPSW'                                        03457000
@NM02626 DC    CL1' '                                                   03458000
         ORG   I00125+16                                                03459000
I00126   DS    CL16                                                     03460000
         ORG   I00126                                                   03461000
@NM02627 DC    H'16'                                                    03462000
@NM02628 DC    H'0'                                                     03463000
@NM02629 DC    CL11'IN IKJEGQFY'                                        03464000
@NM02630 DC    CL1' '                                                   03465000
         ORG   I00126+16                                                03466000
I00127   DS    CL16                                                     03467000
         ORG   I00127                                                   03468000
@NM02631 DC    H'16'                                                    03469000
@NM02632 DC    H'0'                                                     03470000
@NM02633 DC    CL11'IN IKJEGSIO'                                        03471000
@NM02634 DC    CL1' '                                                   03472000
         ORG   I00127+16                                                03473000
I00128   DS    CL16                                                     03474000
         ORG   I00128                                                   03475000
@NM02635 DC    H'16'                                                    03476000
@NM02636 DC    H'0'                                                     03477000
@NM02637 DC    CL11'IN IKJEGSRH'                                        03478000
@NM02638 DC    CL1' '                                                   03479000
         ORG   I00128+16                                                03480000
I00129   DS    CL16                                                     03481000
         ORG   I00129                                                   03482000
@NM02639 DC    H'16'                                                    03483000
@NM02640 DC    H'0'                                                     03484000
@NM02641 DC    CL11'IN IKJEGSTA'                                        03485000
@NM02642 DC    CL1' '                                                   03486000
         ORG   I00129+16                                                03487000
I00130   DS    CL16                                                     03488000
         ORG   I00130                                                   03489000
@NM02643 DC    H'16'                                                    03490000
@NM02644 DC    H'0'                                                     03491000
@NM02645 DC    CL11'IN IKJEGSYM'                                        03492000
@NM02646 DC    CL1' '                                                   03493000
         ORG   I00130+16                                                03494000
I00131   DS    CL16                                                     03495000
         ORG   I00131                                                   03496000
@NM02647 DC    H'16'                                                    03497000
@NM02648 DC    H'0'                                                     03498000
@NM02649 DC    CL11'IN IKJEGTCB'                                        03499000
@NM02650 DC    CL1' '                                                   03500000
         ORG   I00131+16                                                03501000
I00132   DS    CL16                                                     03502000
         ORG   I00132                                                   03503000
@NM02651 DC    H'16'                                                    03504000
@NM02652 DC    H'0'                                                     03505000
@NM02653 DC    CL11'IN IKJEGWHR'                                        03506000
@NM02654 DC    CL1' '                                                   03507000
         ORG   I00132+16                                                03508000
I00133   DS    CL16                                                     03509000
         ORG   I00133                                                   03510000
@NM02655 DC    H'16'                                                    03511000
@NM02656 DC    H'0'                                                     03512000
@NM02657 DC    CL11'XCTL FAILED'                                        03513000
@NM02658 DC    CL1' '                                                   03514000
         ORG   I00133+16                                                03515000
I00134   DS    CL12                                                     03516000
         ORG   I00134                                                   03517000
@NM02659 DC    H'12'                                                    03518000
@NM02660 DC    H'0'                                                     03519000
@NM02661 DC    CL7'HEWLOAD'                                             03520000
@NM02662 DC    CL1' '                                                   03521000
         ORG   I00134+12                                                03522000
M0499    DS    CL80                                                     03523000
         ORG   M0499                                                    03524000
@NM02811 DC    AL1(56)                                                  03525000
@NM02812 DC    AL1(75)                                                  03526000
@NM02813 DC    AL1(76)                                                  03527000
@NM02814 DC    AL1(77)                                                  03528000
@NM02815 DC    AL1(0)                                                   03529000
@NM02816 DC    AL1(0)                                                   03530000
@NM02817 DC    H'82'                                                    03531000
@NM02818 DC    H'0'                                                     03532000
@NM02819 DC    CL1' '                                                   03533000
@NM02820 DC    CL45'SVC FAILED WHEN ATTEMPTING TO OBTAIN A MODULE'      03534000
@NM02821 DC    CL1' '                                                   03535000
@NM02822 DC    CL18'THE ABEND CODE WAS'                                 03536000
@NM02823 DC    CL1' '                                                   03537000
@NM02824 DC    CL1' '                                                   03538000
@NM02825 DC    CL1' '                                                   03539000
@NM02826 DC    CL1' '                                                   03540000
@NM02827 DC    CL1' '                                                   03541000
         ORG   M0499+80                                                 03542000
LINKCODE DS    CL100                                                    03543000
         ORG   LINKCODE                                                 03544000
@NM00332 DC    XL4'106'                                                 03545000
@NM00333 DC    AL4(ABEND10X)                                            03546000
@NM00334 DC    AL4(I0054)                                               03547000
@NM00335 DC    XL4'206'                                                 03548000
@NM00336 DC    AL4(ABEND20X)                                            03549000
@NM00337 DC    AL4(I0055)                                               03550000
@NM00338 DC    XL4'306'                                                 03551000
@NM00339 DC    AL4(ABEND30X)                                            03552000
@NM00340 DC    AL4(I0056)                                               03553000
@NM00341 DC    XL4'406'                                                 03554000
@NM00342 DC    AL4(ABEND40X)                                            03555000
@NM00343 DC    AL4(I0057)                                               03556000
@NM00344 DC    XL4'706'                                                 03557000
@NM00345 DC    AL4(ABEND70X)                                            03558000
@NM00346 DC    AL4(I0058)                                               03559000
@NM00347 DC    XL4'806'                                                 03560000
@NM00348 DC    AL4(ABEND80X)                                            03561000
@NM00349 DC    AL4(I0059)                                               03562000
@NM00350 DC    XL4'906'                                                 03563000
@NM00351 DC    AL4(ABEND90X)                                            03564000
@NM00352 DC    AL4(I0060)                                               03565000
@NM00353 DC    XL4'A06'                                                 03566000
@NM00354 DC    AL4(ABENDA0X)                                            03567000
@NM00355 DC    AL4(I0061)                                               03568000
@NM00356 DC    F'0'                                                     03569000
         ORG   LINKCODE+100                                             03570000
LOADCODE DS    CL100                                                    03571000
         ORG   LOADCODE                                                 03572000
@NM00357 DC    XL4'106'                                                 03573000
@NM00358 DC    AL4(ABEND10X)                                            03574000
@NM00359 DC    AL4(I0054)                                               03575000
@NM00360 DC    XL4'206'                                                 03576000
@NM00361 DC    AL4(ABEND20X)                                            03577000
@NM00362 DC    AL4(I0055)                                               03578000
@NM00363 DC    XL4'306'                                                 03579000
@NM00364 DC    AL4(ABEND30X)                                            03580000
@NM00365 DC    AL4(I0056)                                               03581000
@NM00366 DC    XL4'406'                                                 03582000
@NM00367 DC    AL4(ABEND40X)                                            03583000
@NM00368 DC    AL4(I0057)                                               03584000
@NM00369 DC    XL4'706'                                                 03585000
@NM00370 DC    AL4(ABEND70X)                                            03586000
@NM00371 DC    AL4(I0058)                                               03587000
@NM00372 DC    XL4'806'                                                 03588000
@NM00373 DC    AL4(ABEND80X)                                            03589000
@NM00374 DC    AL4(I0059)                                               03590000
@NM00375 DC    XL4'906'                                                 03591000
@NM00376 DC    AL4(ABEND90X)                                            03592000
@NM00377 DC    AL4(I0060)                                               03593000
@NM00378 DC    XL4'A06'                                                 03594000
@NM00379 DC    AL4(ABENDA0X)                                            03595000
@NM00380 DC    AL4(I0061)                                               03596000
@NM00381 DC    F'0'                                                     03597000
         ORG   LOADCODE+100                                             03598000
ABEND10X DS    CL48                                                     03599000
         ORG   ABEND10X                                                 03600000
@NM00382 DC    AL4(M0400)                                               03601000
AB10XRCB DS    CL8                                                      03602000
         ORG   AB10XRCB                                                 03603000
@NM00383 DC    XL4'B'                                                   03604000
@NM00384 DC    AL4(I0048)                                               03605000
         ORG   ABEND10X+12                                              03606000
AB10XRCC DS    CL8                                                      03607000
         ORG   AB10XRCC                                                 03608000
@NM00385 DC    XL4'C'                                                   03609000
@NM00386 DC    AL4(I0049)                                               03610000
         ORG   ABEND10X+20                                              03611000
AB10XRCD DS    CL8                                                      03612000
         ORG   AB10XRCD                                                 03613000
@NM00387 DC    XL4'D'                                                   03614000
@NM00388 DC    AL4(I0050)                                               03615000
         ORG   ABEND10X+28                                              03616000
AB10XRCE DS    CL8                                                      03617000
         ORG   AB10XRCE                                                 03618000
@NM00389 DC    XL4'E'                                                   03619000
@NM00390 DC    AL4(I0070)                                               03620000
         ORG   ABEND10X+36                                              03621000
AB10XRCF DS    CL8                                                      03622000
         ORG   AB10XRCF                                                 03623000
@NM00391 DC    XL4'F'                                                   03624000
@NM00392 DC    AL4(I0071)                                               03625000
         ORG   ABEND10X+44                                              03626000
@NM00393 DC    F'0'                                                     03627000
         ORG   ABEND10X+48                                              03628000
ABEND20X DS    CL8                                                      03629000
         ORG   ABEND20X                                                 03630000
@NM00394 DC    AL4(M0410)                                               03631000
@NM00395 DC    F'0'                                                     03632000
         ORG   ABEND20X+8                                               03633000
ABEND30X DS    CL32                                                     03634000
         ORG   ABEND30X                                                 03635000
@NM00396 DC    AL4(M0420)                                               03636000
AB30XRC4 DS    CL8                                                      03637000
         ORG   AB30XRC4                                                 03638000
@NM00397 DC    XL4'4'                                                   03639000
@NM00398 DC    AL4(I0072)                                               03640000
         ORG   ABEND30X+12                                              03641000
AB30XRC8 DS    CL8                                                      03642000
         ORG   AB30XRC8                                                 03643000
@NM00399 DC    XL4'8'                                                   03644000
@NM00400 DC    AL4(I0073)                                               03645000
         ORG   ABEND30X+20                                              03646000
AB30XRCC DS    CL8                                                      03647000
         ORG   AB30XRCC                                                 03648000
@NM00401 DC    XL4'C'                                                   03649000
@NM00402 DC    AL4(I0074)                                               03650000
         ORG   ABEND30X+28                                              03651000
@NM00403 DC    F'0'                                                     03652000
         ORG   ABEND30X+32                                              03653000
ABEND40X DS    CL8                                                      03654000
         ORG   ABEND40X                                                 03655000
@NM00404 DC    AL4(M0430)                                               03656000
@NM00405 DC    F'0'                                                     03657000
         ORG   ABEND40X+8                                               03658000
ABEND70X DS    CL8                                                      03659000
         ORG   ABEND70X                                                 03660000
@NM00406 DC    AL4(M0440)                                               03661000
@NM00407 DC    F'0'                                                     03662000
         ORG   ABEND70X+8                                               03663000
ABEND80X DS    CL32                                                     03664000
         ORG   ABEND80X                                                 03665000
@NM00408 DC    AL4(M0450)                                               03666000
AB80XRC4 DS    CL8                                                      03667000
         ORG   AB80XRC4                                                 03668000
@NM00409 DC    XL4'4'                                                   03669000
@NM00410 DC    AL4(I0072)                                               03670000
         ORG   ABEND80X+12                                              03671000
AB80XRC8 DS    CL8                                                      03672000
         ORG   AB80XRC8                                                 03673000
@NM00411 DC    XL4'8'                                                   03674000
@NM00412 DC    AL4(I0073)                                               03675000
         ORG   ABEND80X+20                                              03676000
AB80XRCC DS    CL8                                                      03677000
         ORG   AB80XRCC                                                 03678000
@NM00413 DC    XL4'C'                                                   03679000
@NM00414 DC    AL4(I0074)                                               03680000
         ORG   ABEND80X+28                                              03681000
@NM00415 DC    F'0'                                                     03682000
         ORG   ABEND80X+32                                              03683000
ABEND90X DS    CL8                                                      03684000
         ORG   ABEND90X                                                 03685000
@NM00416 DC    AL4(M0460)                                               03686000
@NM00417 DC    F'0'                                                     03687000
         ORG   ABEND90X+8                                               03688000
ABENDA0X DS    CL8                                                      03689000
         ORG   ABENDA0X                                                 03690000
@NM00418 DC    AL4(M0470)                                               03691000
@NM00419 DC    F'0'                                                     03692000
         ORG   ABENDA0X+8                                               03693000
M0400    DS    CL37                                                     03694000
         ORG   M0400                                                    03695000
@NM02663 DC    AL1(22)                                                  03696000
@NM02664 DC    AL1(23)                                                  03697000
@NM02665 DC    AL1(24)                                                  03698000
@NM02666 DC    AL1(0)                                                   03699000
@NM02667 DC    AL1(0)                                                   03700000
@NM02668 DC    AL1(0)                                                   03701000
@NM02669 DC    H'30'                                                    03702000
@NM02670 DC    H'0'                                                     03703000
@NM02671 DC    CL21'IKJ57600I FETCH ERROR'                              03704000
@NM02672 DC    CL1' '                                                   03705000
@NM02673 DC    CL1' '                                                   03706000
@NM02674 DC    CL1' '                                                   03707000
@NM02675 DC    CL1'+'                                                   03708000
@NM02676 DC    CL1' '                                                   03709000
@NM02677 DC    CL1' '                                                   03710000
         ORG   M0400+37                                                 03711000
         DS    CL1                                                      03712000
M0410    DS    CL57                                                     03713000
         ORG   M0410                                                    03714000
@NM02698 DC    AL1(43)                                                  03715000
@NM02699 DC    AL1(44)                                                  03716000
@NM02700 DC    AL1(0)                                                   03717000
@NM02701 DC    AL1(0)                                                   03718000
@NM02702 DC    AL1(0)                                                   03719000
@NM02703 DC    AL1(0)                                                   03720000
@NM02704 DC    H'50'                                                    03721000
@NM02705 DC    H'0'                                                     03722000
@NM02706 DC    CL42'IKJ57601I BAD PARAMETER LIST PASSED TO SVC'         03723000
@NM02707 DC    CL1' '                                                   03724000
@NM02708 DC    CL1' '                                                   03725000
@NM02709 DC    CL1'+'                                                   03726000
@NM02710 DC    CL1' '                                                   03727000
@NM02711 DC    CL1' '                                                   03728000
         ORG   M0410+57                                                 03729000
         DS    CL1                                                      03730000
M0420    DS    CL84                                                     03731000
         ORG   M0420                                                    03732000
@NM02712 DC    AL1(69)                                                  03733000
@NM02713 DC    AL1(70)                                                  03734000
@NM02714 DC    AL1(71)                                                  03735000
@NM02715 DC    AL1(0)                                                   03736000
@NM02716 DC    AL1(0)                                                   03737000
@NM02717 DC    AL1(0)                                                   03738000
@NM02718 DC    H'77'                                                    03739000
@NM02719 DC    H'0'                                                     03740000
@NM02720 DC    CL68'IKJ57603I A NON-AUTHORIZED COPY OF A SYSTEM ROUTINEC03741000
                WAS FOUND BY SVC'                                       03742000
@NM02721 DC    CL1' '                                                   03743000
@NM02722 DC    CL1' '                                                   03744000
@NM02723 DC    CL1' '                                                   03745000
@NM02724 DC    CL1'+'                                                   03746000
@NM02725 DC    CL1' '                                                   03747000
@NM02726 DC    CL1' '                                                   03748000
         ORG   M0420+84                                                 03749000
M0430    DS    CL57                                                     03750000
         ORG   M0430                                                    03751000
@NM02727 DC    AL1(14)                                                  03752000
@NM02728 DC    AL1(44)                                                  03753000
@NM02729 DC    AL1(0)                                                   03754000
@NM02730 DC    AL1(0)                                                   03755000
@NM02731 DC    AL1(0)                                                   03756000
@NM02732 DC    AL1(0)                                                   03757000
@NM02733 DC    H'50'                                                    03758000
@NM02734 DC    H'0'                                                     03759000
@NM02735 DC    CL13'IKJ57602I SVC'                                      03760000
@NM02736 DC    CL1' '                                                   03761000
@NM02737 DC    CL29'REQUESTED TO LOAD ONLY MODULE'                      03762000
@NM02738 DC    CL1' '                                                   03763000
@NM02739 DC    CL1'+'                                                   03764000
@NM02740 DC    CL1' '                                                   03765000
@NM02741 DC    CL1' '                                                   03766000
         ORG   M0430+57                                                 03767000
         DS    CL1                                                      03768000
M0440    DS    CL84                                                     03769000
         ORG   M0440                                                    03770000
@NM02742 DC    AL1(14)                                                  03771000
@NM02743 DC    AL1(15)                                                  03772000
@NM02744 DC    AL1(0)                                                   03773000
@NM02745 DC    AL1(0)                                                   03774000
@NM02746 DC    AL1(0)                                                   03775000
@NM02747 DC    AL1(0)                                                   03776000
@NM02748 DC    H'77'                                                    03777000
@NM02749 DC    H'0'                                                     03778000
@NM02750 DC    CL13'IKJ57603I SVC'                                      03779000
@NM02751 DC    CL1' '                                                   03780000
@NM02752 DC    CL1' '                                                   03781000
@NM02753 DC    CL57'ATTEMPTED TO USE A MODULE FLAGGED NOT EXECUTABLE BYC03782000
                LKED+'                                                  03783000
@NM02754 DC    CL1' '                                                   03784000
@NM02755 DC    CL1' '                                                   03785000
         ORG   M0440+84                                                 03786000
M0450    DS    CL49                                                     03787000
         ORG   M0450                                                    03788000
@NM02756 DC    AL1(34)                                                  03789000
@NM02757 DC    AL1(35)                                                  03790000
@NM02758 DC    AL1(36)                                                  03791000
@NM02759 DC    AL1(0)                                                   03792000
@NM02760 DC    AL1(0)                                                   03793000
@NM02761 DC    AL1(0)                                                   03794000
@NM02762 DC    H'42'                                                    03795000
@NM02763 DC    H'0'                                                     03796000
@NM02764 DC    CL33'IKJ57604I MODULE NOT FOUND BY SVC'                  03797000
@NM02765 DC    CL1' '                                                   03798000
@NM02766 DC    CL1' '                                                   03799000
@NM02767 DC    CL1' '                                                   03800000
@NM02768 DC    CL1'+'                                                   03801000
@NM02769 DC    CL1' '                                                   03802000
@NM02770 DC    CL1' '                                                   03803000
         ORG   M0450+49                                                 03804000
         DS    CL1                                                      03805000
M0460    DS    CL84                                                     03806000
         ORG   M0460                                                    03807000
@NM02783 DC    AL1(14)                                                  03808000
@NM02784 DC    AL1(15)                                                  03809000
@NM02785 DC    AL1(0)                                                   03810000
@NM02786 DC    AL1(0)                                                   03811000
@NM02787 DC    AL1(0)                                                   03812000
@NM02788 DC    AL1(0)                                                   03813000
@NM02789 DC    H'77'                                                    03814000
@NM02790 DC    H'0'                                                     03815000
@NM02791 DC    CL13'IKJ57605I SVC'                                      03816000
@NM02792 DC    CL1' '                                                   03817000
@NM02793 DC    CL1' '                                                   03818000
@NM02794 DC    CL57'CAUSED THE COUNT OF A REUSABLE LOAD MODULE TO EXCEEC03819000
               D 255+'                                                  03820000
@NM02795 DC    CL1' '                                                   03821000
@NM02796 DC    CL1' '                                                   03822000
         ORG   M0460+84                                                 03823000
M0470    DS    CL85                                                     03824000
         ORG   M0470                                                    03825000
@NM02797 DC    AL1(14)                                                  03826000
@NM02798 DC    AL1(15)                                                  03827000
@NM02799 DC    AL1(0)                                                   03828000
@NM02800 DC    AL1(0)                                                   03829000
@NM02801 DC    AL1(0)                                                   03830000
@NM02802 DC    AL1(0)                                                   03831000
@NM02803 DC    H'78'                                                    03832000
@NM02804 DC    H'0'                                                     03833000
@NM02805 DC    CL13'IKJ57606I SVC'                                      03834000
@NM02806 DC    CL1' '                                                   03835000
@NM02807 DC    CL1' '                                                   03836000
@NM02808 DC    CL58'DETECTED AN INTERLOCK IN USING A SERIALLY REUSABLE C03837000
               MODULE+'                                                 03838000
@NM02809 DC    CL1' '                                                   03839000
@NM02810 DC    CL1' '                                                   03840000
         ORG   M0470+85                                                 03841000
         DS    CL1                                                      03842000
M0599    DS    CL46                                                     03843000
         ORG   M0599                                                    03844000
@NM02949 DC    AL1(43)                                                  03845000
@NM02950 DC    AL1(0)                                                   03846000
@NM02951 DC    AL1(0)                                                   03847000
@NM02952 DC    AL1(0)                                                   03848000
@NM02953 DC    AL1(0)                                                   03849000
@NM02954 DC    AL1(0)                                                   03850000
@NM02955 DC    H'48'                                                    03851000
@NM02956 DC    H'0'                                                     03852000
@NM02957 DC    CL1' '                                                   03853000
@NM02958 DC    CL32'SVC FAILED WITH A RETURN CODE OF'                   03854000
@NM02959 DC    CL1' '                                                   03855000
@NM02960 DC    CL1' '                                                   03856000
@NM02961 DC    CL1' '                                                   03857000
         ORG   M0599+46                                                 03858000
ESTAERC  DS    CL88                                                     03859000
         ORG   ESTAERC                                                  03860000
ESTAE04  DS    CL12                                                     03861000
         ORG   ESTAE04                                                  03862000
@NM00428 DC    XL4'4'                                                   03863000
@NM00429 DC    AL4(M0500)                                               03864000
@NM00430 DC    AL4(I0077)                                               03865000
         ORG   ESTAERC+12                                               03866000
ESTAE08  DS    CL12                                                     03867000
         ORG   ESTAE08                                                  03868000
@NM00431 DC    XL4'8'                                                   03869000
@NM00432 DC    AL4(M0501)                                               03870000
@NM00433 DC    AL4(I0078)                                               03871000
         ORG   ESTAERC+24                                               03872000
ESTAE0C  DS    CL12                                                     03873000
         ORG   ESTAE0C                                                  03874000
@NM00434 DC    XL4'C'                                                   03875000
@NM00435 DC    AL4(M0502)                                               03876000
@NM00436 DC    AL4(I0079)                                               03877000
         ORG   ESTAERC+36                                               03878000
ESTAE10  DS    CL12                                                     03879000
         ORG   ESTAE10                                                  03880000
@NM00437 DC    XL4'10'                                                  03881000
@NM00438 DC    AL4(M0503)                                               03882000
@NM00439 DC    AL4(I0080)                                               03883000
         ORG   ESTAERC+48                                               03884000
ESTAE14  DS    CL12                                                     03885000
         ORG   ESTAE14                                                  03886000
@NM00440 DC    XL4'14'                                                  03887000
@NM00441 DC    AL4(M0504)                                               03888000
@NM00442 DC    AL4(I0081)                                               03889000
         ORG   ESTAERC+60                                               03890000
ESTAE18  DS    CL12                                                     03891000
         ORG   ESTAE18                                                  03892000
@NM00443 DC    XL4'18'                                                  03893000
@NM00444 DC    AL4(M0505)                                               03894000
@NM00445 DC    AL4(I0082)                                               03895000
         ORG   ESTAERC+72                                               03896000
ESTAE1C  DS    CL12                                                     03897000
         ORG   ESTAE1C                                                  03898000
@NM00446 DC    XL4'1C'                                                  03899000
@NM00447 DC    AL4(M0506)                                               03900000
@NM00448 DC    AL4(I0089)                                               03901000
         ORG   ESTAERC+84                                               03902000
@NM00449 DC    F'0'                                                     03903000
         ORG   ESTAERC+88                                               03904000
FREERC   DS    CL28                                                     03905000
         ORG   FREERC                                                   03906000
FRE04    DS    CL12                                                     03907000
         ORG   FRE04                                                    03908000
@NM00457 DC    XL4'4'                                                   03909000
@NM00458 DC    AL4(M0520)                                               03910000
@NM00459 DC    AL4(I0077)                                               03911000
         ORG   FREERC+12                                                03912000
FRE08    DS    CL12                                                     03913000
         ORG   FRE08                                                    03914000
@NM00460 DC    XL4'8'                                                   03915000
@NM00461 DC    AL4(M0521)                                               03916000
@NM00462 DC    AL4(I0078)                                               03917000
         ORG   FREERC+24                                                03918000
@NM00463 DC    F'0'                                                     03919000
         ORG   FREERC+28                                                03920000
GETRC    DS    CL28                                                     03921000
         ORG   GETRC                                                    03922000
GET04    DS    CL12                                                     03923000
         ORG   GET04                                                    03924000
@NM00450 DC    XL4'4'                                                   03925000
@NM00451 DC    AL4(M0510)                                               03926000
@NM00452 DC    AL4(I0077)                                               03927000
         ORG   GETRC+12                                                 03928000
GET08    DS    CL12                                                     03929000
         ORG   GET08                                                    03930000
@NM00453 DC    XL4'8'                                                   03931000
@NM00454 DC    AL4(M0511)                                               03932000
@NM00455 DC    AL4(I0078)                                               03933000
         ORG   GETRC+24                                                 03934000
@NM00456 DC    F'0'                                                     03935000
         ORG   GETRC+28                                                 03936000
M0500    DS    CL102                                                    03937000
         ORG   M0500                                                    03938000
@NM02828 DC    AL1(0)                                                   03939000
@NM02829 DC    AL1(0)                                                   03940000
@NM02830 DC    AL1(0)                                                   03941000
@NM02831 DC    AL1(0)                                                   03942000
@NM02832 DC    AL1(0)                                                   03943000
@NM02833 DC    AL1(0)                                                   03944000
@NM02834 DC    H'95'                                                    03945000
@NM02835 DC    H'0'                                                     03946000
@NM02836 DC    CL90'IKJ57606I ESTAE FAILED TO PASS THE EXIT ADDRESS WHEC03947000
               N CANCELING NON-EXISTENT ESTAE REQUEST+'                 03948000
@NM02837 DC    CL1' '                                                   03949000
@NM02838 DC    CL1' '                                                   03950000
         ORG   M0500+102                                                03951000
M0501    DS    CL100                                                    03952000
         ORG   M0501                                                    03953000
@NM02839 DC    AL1(0)                                                   03954000
@NM02840 DC    AL1(0)                                                   03955000
@NM02841 DC    AL1(0)                                                   03956000
@NM02842 DC    AL1(0)                                                   03957000
@NM02843 DC    AL1(0)                                                   03958000
@NM02844 DC    AL1(0)                                                   03959000
@NM02845 DC    H'93'                                                    03960000
@NM02846 DC    H'0'                                                     03961000
@NM02847 DC    CL88'IKJ57607I ESTAE IN A TEST MODULE WAS NOT AN INITIALC03962000
                BRANCH ENTRY WITH THE CREATE OPTION+'                   03963000
@NM02848 DC    CL1' '                                                   03964000
@NM02849 DC    CL1' '                                                   03965000
         ORG   M0501+100                                                03966000
M0502    DS    CL83                                                     03967000
         ORG   M0502                                                    03968000
@NM02850 DC    AL1(0)                                                   03969000
@NM02851 DC    AL1(0)                                                   03970000
@NM02852 DC    AL1(0)                                                   03971000
@NM02853 DC    AL1(0)                                                   03972000
@NM02854 DC    AL1(0)                                                   03973000
@NM02855 DC    AL1(0)                                                   03974000
@NM02856 DC    H'76'                                                    03975000
@NM02857 DC    H'0'                                                     03976000
@NM02858 DC    CL71'IKJ57608I ESTAE IN A TEST MODULE EXIT ROUTINE OR PAC03977000
               RM LIST WAS INVALID+'                                    03978000
@NM02859 DC    CL1' '                                                   03979000
@NM02860 DC    CL1' '                                                   03980000
         ORG   M0502+83                                                 03981000
         DS    CL1                                                      03982000
M0503    DS    CL108                                                    03983000
         ORG   M0503                                                    03984000
@NM02861 DC    AL1(0)                                                   03985000
@NM02862 DC    AL1(0)                                                   03986000
@NM02863 DC    AL1(0)                                                   03987000
@NM02864 DC    AL1(0)                                                   03988000
@NM02865 DC    AL1(0)                                                   03989000
@NM02866 DC    AL1(0)                                                   03990000
@NM02867 DC    H'101'                                                   03991000
@NM02868 DC    H'0'                                                     03992000
@NM02869 DC    CL96'IKJ57609I ESTAE IN A TEST MODULE WAS ISSUED THE SVCC03993000
                ENCOUNTER UNEXPECTED ERROR WHILE PROCESSING+'           03994000
@NM02870 DC    CL1' '                                                   03995000
@NM02871 DC    CL1' '                                                   03996000
         ORG   M0503+108                                                03997000
M0504    DS    CL85                                                     03998000
         ORG   M0504                                                    03999000
@NM02872 DC    AL1(0)                                                   04000000
@NM02873 DC    AL1(0)                                                   04001000
@NM02874 DC    AL1(0)                                                   04002000
@NM02875 DC    AL1(0)                                                   04003000
@NM02876 DC    AL1(0)                                                   04004000
@NM02877 DC    AL1(0)                                                   04005000
@NM02878 DC    H'78'                                                    04006000
@NM02879 DC    H'0'                                                     04007000
@NM02880 DC    CL73'IKJ57610I ESTAE IN A TEST MODULE WAS UNABLE TO OBTAC04008000
               IN STORAGE FOR AN SCB+'                                  04009000
@NM02881 DC    CL1' '                                                   04010000
@NM02882 DC    CL1' '                                                   04011000
         ORG   M0504+85                                                 04012000
         DS    CL1                                                      04013000
M0505    DS    CL84                                                     04014000
         ORG   M0505                                                    04015000
@NM02883 DC    AL1(0)                                                   04016000
@NM02884 DC    AL1(0)                                                   04017000
@NM02885 DC    AL1(0)                                                   04018000
@NM02886 DC    AL1(0)                                                   04019000
@NM02887 DC    AL1(0)                                                   04020000
@NM02888 DC    AL1(0)                                                   04021000
@NM02889 DC    H'77'                                                    04022000
@NM02890 DC    H'0'                                                     04023000
@NM02891 DC    CL72'IKJ57611I ESTAE IN A TEST MODULE SETLOCK ENCOUNTEREC04024000
               D AN ERROR CONDITION+'                                   04025000
@NM02892 DC    CL1' '                                                   04026000
@NM02893 DC    CL1' '                                                   04027000
         ORG   M0505+84                                                 04028000
M0506    DS    CL100                                                    04029000
         ORG   M0506                                                    04030000
@NM02894 DC    AL1(0)                                                   04031000
@NM02895 DC    AL1(0)                                                   04032000
@NM02896 DC    AL1(0)                                                   04033000
@NM02897 DC    AL1(0)                                                   04034000
@NM02898 DC    AL1(0)                                                   04035000
@NM02899 DC    AL1(0)                                                   04036000
@NM02900 DC    H'93'                                                    04037000
@NM02901 DC    H'0'                                                     04038000
@NM02902 DC    CL88'IKJ57612I ESTAE IN A TEST MODULE WAS NOT AN INITIALC04039000
                BRANCH ENTRY WITH THE CREATE OPTION+'                   04040000
@NM02903 DC    CL1' '                                                   04041000
@NM02904 DC    CL1' '                                                   04042000
         ORG   M0506+100                                                04043000
M0510    DS    CL75                                                     04044000
         ORG   M0510                                                    04045000
@NM02905 DC    AL1(0)                                                   04046000
@NM02906 DC    AL1(0)                                                   04047000
@NM02907 DC    AL1(0)                                                   04048000
@NM02908 DC    AL1(0)                                                   04049000
@NM02909 DC    AL1(0)                                                   04050000
@NM02910 DC    AL1(0)                                                   04051000
@NM02911 DC    H'68'                                                    04052000
@NM02912 DC    H'0'                                                     04053000
@NM02913 DC    CL63'IKJ57613I FREEMAIN IN A TEST MODULE WAS UNABLE TO FC04054000
               REE STORAGE+'                                            04055000
@NM02914 DC    CL1' '                                                   04056000
@NM02915 DC    CL1' '                                                   04057000
         ORG   M0510+75                                                 04058000
         DS    CL1                                                      04059000
M0511    DS    CL90                                                     04060000
         ORG   M0511                                                    04061000
@NM02916 DC    AL1(0)                                                   04062000
@NM02917 DC    AL1(0)                                                   04063000
@NM02918 DC    AL1(0)                                                   04064000
@NM02919 DC    AL1(0)                                                   04065000
@NM02920 DC    AL1(0)                                                   04066000
@NM02921 DC    AL1(0)                                                   04067000
@NM02922 DC    H'83'                                                    04068000
@NM02923 DC    H'0'                                                     04069000
@NM02924 DC    CL78'IKJ57614I FREEMAIN IN A TEST MODULE ATTEMPTED TO FRC04070000
               EE STORAGE THAT WAS"FIXED"+'                             04071000
@NM02925 DC    CL1' '                                                   04072000
@NM02926 DC    CL1' '                                                   04073000
         ORG   M0511+90                                                 04074000
M0520    DS    CL87                                                     04075000
         ORG   M0520                                                    04076000
@NM02927 DC    AL1(0)                                                   04077000
@NM02928 DC    AL1(0)                                                   04078000
@NM02929 DC    AL1(0)                                                   04079000
@NM02930 DC    AL1(0)                                                   04080000
@NM02931 DC    AL1(0)                                                   04081000
@NM02932 DC    AL1(0)                                                   04082000
@NM02933 DC    H'80'                                                    04083000
@NM02934 DC    H'0'                                                     04084000
@NM02935 DC    CL75'IKJ57615I GETMAIN IN A TEST MODULE WAS UNABLE TO OBC04085000
               TAIN ADDITIONAL STORAGE+'                                04086000
@NM02936 DC    CL1' '                                                   04087000
@NM02937 DC    CL1' '                                                   04088000
         ORG   M0520+87                                                 04089000
         DS    CL1                                                      04090000
M0521    DS    CL101                                                    04091000
         ORG   M0521                                                    04092000
@NM02938 DC    AL1(0)                                                   04093000
@NM02939 DC    AL1(0)                                                   04094000
@NM02940 DC    AL1(0)                                                   04095000
@NM02941 DC    AL1(0)                                                   04096000
@NM02942 DC    AL1(0)                                                   04097000
@NM02943 DC    AL1(0)                                                   04098000
@NM02944 DC    H'94'                                                    04099000
@NM02945 DC    H'0'                                                     04100000
@NM02946 DC    CL89'IKJ57616I GETMAIN IN A TEST MODULE ATTEMPTED TO OBTC04101000
               AIN REAL PAGE STORAGE FOR SQA ON LSQA+'                  04102000
@NM02947 DC    CL1' '                                                   04103000
@NM02948 DC    CL1' '                                                   04104000
         ORG   M0521+101                                                04105000
NULLMSG  DC    X'FF'                                                    04106000
SUPERZAP DS    CL50                                                     04107000
         ORG   SUPERZAP                                                 04108000
@NM02966 DC    50CL1'Z'                                                 04109000
         ORG   SUPERZAP+50                                              04110000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       04111000
@01      EQU   01                                                       04112000
@02      EQU   02                                                       04113000
@03      EQU   03                                                       04114000
@04      EQU   04                                                       04115000
@05      EQU   05                                                       04116000
@06      EQU   06                                                       04117000
@07      EQU   07                                                       04118000
@08      EQU   08                                                       04119000
@09      EQU   09                                                       04120000
@10      EQU   10                                                       04121000
@11      EQU   11                                                       04122000
@12      EQU   12                                                       04123000
@13      EQU   13                                                       04124000
@14      EQU   14                                                       04125000
@15      EQU   15                                                       04126000
         ENTRY ATTACHIO                                                 04127000
M0043    EQU   NULLMSG                                                  04128000
M0044    EQU   NULLMSG                                                  04129000
M0055    EQU   NULLMSG                                                  04130000
M0056    EQU   NULLMSG                                                  04131000
M0057    EQU   NULLMSG                                                  04132000
M0059    EQU   NULLMSG                                                  04133000
M0060    EQU   NULLMSG                                                  04134000
M0061    EQU   NULLMSG                                                  04135000
M0062    EQU   NULLMSG                                                  04136000
M0063    EQU   NULLMSG                                                  04137000
M0065    EQU   NULLMSG                                                  04138000
M0102    EQU   NULLMSG                                                  04139000
M0236    EQU   NULLMSG                                                  04140000
M0237    EQU   NULLMSG                                                  04141000
M0238    EQU   NULLMSG                                                  04142000
M0239    EQU   NULLMSG                                                  04143000
M0254    EQU   NULLMSG                                                  04144000
M0256    EQU   NULLMSG                                                  04145000
M0261    EQU   NULLMSG                                                  04146000
M0262    EQU   NULLMSG                                                  04147000
M0263    EQU   NULLMSG                                                  04148000
M0264    EQU   NULLMSG                                                  04149000
M0265    EQU   NULLMSG                                                  04150000
M0282    EQU   NULLMSG                                                  04151000
M0286    EQU   NULLMSG                                                  04152000
M0288    EQU   NULLMSG                                                  04153000
M0289    EQU   NULLMSG                                                  04154000
M0290    EQU   NULLMSG                                                  04155000
M0291    EQU   NULLMSG                                                  04156000
M0292    EQU   NULLMSG                                                  04157000
M0293    EQU   NULLMSG                                                  04158000
I001     EQU   NULLMSG                                                  04159000
I005     EQU   NULLMSG                                                  04160000
I0021    EQU   NULLMSG                                                  04161000
I0028    EQU   NULLMSG                                                  04162000
I0029    EQU   NULLMSG                                                  04163000
I0032    EQU   NULLMSG                                                  04164000
I0037    EQU   NULLMSG                                                  04165000
I0038    EQU   NULLMSG                                                  04166000
I0039    EQU   NULLMSG                                                  04167000
I0044    EQU   NULLMSG                                                  04168000
I0045    EQU   NULLMSG                                                  04169000
I0051    EQU   NULLMSG                                                  04170000
I0052    EQU   NULLMSG                                                  04171000
I0053    EQU   NULLMSG                                                  04172000
I0062    EQU   NULLMSG                                                  04173000
I0063    EQU   NULLMSG                                                  04174000
I0064    EQU   NULLMSG                                                  04175000
I0065    EQU   NULLMSG                                                  04176000
I0066    EQU   NULLMSG                                                  04177000
I0067    EQU   NULLMSG                                                  04178000
I0068    EQU   NULLMSG                                                  04179000
I0069    EQU   NULLMSG                                                  04180000
I0075    EQU   NULLMSG                                                  04181000
I0076    EQU   NULLMSG                                                  04182000
I0088    EQU   NULLMSG                                                  04183000
I0090    EQU   NULLMSG                                                  04184000
I0091    EQU   NULLMSG                                                  04185000
@ENDDATA EQU   *                                                        04186000
         END   IKJEGMSG,(C'PL/S-II',0502,73319)                         04187000
./  ADD  SSI=40310054,NAME=IKJEGOFF
         COPY  IKJEGSIO                                                 00100102
         MACRO                                                          00102002
         EXPRPDE                                                        00110002
*********************************************************************** 00112002
*                                                                     * 00114002
*        MAPPING DSECT FOR PDES FOR EXPRESSIONS                       * 00116002
*                                                                     * 00118002
*        STATUS -- VERSION NO. 01 - AOS/2 RELEASE NO. 01              * 00118402
*                                                                     * 00118802
*        CHANGE LEVEL -- 00 - DATE 09/29/71                           * 00119202
*                                                                     * 00119602
*********************************************************************** 00119702
EXPRPDE  DSECT                                                          00119802
EXPRPTR  DS    F -                      POINTER TO CHARACTER STRING,    00119902
*                                       OR ZERO IF NOT PRESENT          00136602
EXPRLNH  DS    H -                      LENGTH OF CHARACTER STRING      00146602
         DS    H -                      RESERVED                        00148602
EXPRFLGS DS    XL1 -                    FLAGS                           00150602
EXPRDEC  EQU   X'04' -                  DECIMAL EXPRESSION FLAG         00152602
EXPRHEX  EQU   X'02' -                  HEX EXPRESSION FLAG             00153002
EXPRSIGN DS    CL1 -                    ARITHMETIC SIGN OR ZERO         00153102
EXPRINDC DS    H -                      INDIRECT COUNT                  00153202
EXPRCHAI DS    F -                      POINTER TO NEXT EXPRESSION      00158802
*                                       PDE OR ZERO                     00160802
EXPRPDL  EQU   *-EXPRPDE -              LENGTH OF EXPRESSION PDE        00162802
         MEND                                                           00163202
         EJECT                                                          00163602
OFF      TITLE 'IKJEGOFF, OFF COMMAND PROCESSOR  OF TEST'               00170002
IKJEGOFF CSECT                     OFF COMMAND PROCESSOR                00180002
*C476400                                                         YM2245 00190002
*C489900                                                         YM4849 00200002
*C531279                                                       @YM07108 00210002
         SPACE 2                                                        00220002
************************************************************            00270002
*                                                         **            00320002
* STATUS                                                  **            00370002
*    CHANGE LEVEL 00, VERSION NUMBER 01, OS/VS2           **            00420002
*                                                         **            00470002
* FUNCTION                                                **            00520002
*    OFF BASICALLY REMOVES WHATEVER BREAKPOINTS THE 'AT'  **            00570002
*    SUB-COMMAND HAD ESTABLISHED. IT HAS THE FACILITY TO  **            00620002
*    REMOVE ALL THE BREAKPOINTS IN EFFECT, OR ONLY THOSE  **            00670002
*    SPECIFIED BY THE USER.                               **            00672002
*                                                         **            00674002
*    WHEN PARAMETERS HAVE BEEN ENTERED PARSE IS CALLED    **            00680002
*    IS PARSE THE INPUT STGRING. PARSE INVOKES 'OFF'      **            00690002
*    VALIDITY CHECK ROUTINE WHICH GOES TO CONVERT 'CVT'   **            00700002
*    TO CONVERT THE ADDRESS PDE. IF CONVERT RETURNS WITH  **            00710002
*    THAT ADDRESS IS SEARCH FOR ON THE ACTIVE QUEUE,      **            00712002
*    (BREAKTAB OF TCOMTAB). NEXT THE DEFERED QUEUE        **            00714002
*    (DEFERTAB OF TCOMTAB), IS SEARCH FOR THE ADDRESS.    **            00716002
*    WHEN SEARCHING THE DEFERED QUEUE A FULLY QUALIFIED   **            00718002
*    ADDRESS MUST HAVE BEEN SPECIFIED.                    **            00718402
*    ALL REFERENCES TO THAT BREAKELEMENT ARE REMOVED FROM **            00718802
*    BOTH QUEUE'S. IF IT WAS AN ACTIVE BREAKPOINT AN      **            00719202
*    ATTEMPT IS MADE TO RESTORE THE PROBLEM PROGRAM INSTR.**            00719602
*                                                         **            00719702
*    END PROCESSING IS DETERMINED BY THE ENDSW OR  RUNSW  **            00719802
*    BEING ON. (ENDSW AND RUNSW ARE IN TCOMTAB).          **            00719902
*    DURNING END PROCESSING ALL BREAKS POINTS ARE         **            00748602
*    REMOVED AS IF NO PARAMETERS WHERE ENTERED ON A       **            00750602
*    'OFF' COMMAND.                                       **            00752602
*                                                         **            01770002
* ENTRY POINTS                                            **            01820002
*         IKJEGOFF - MAIN ENTRY POINT                     **            01870002
*         IKJEGVCK - VALIDITY CHECK ROUTINE               **            01920002
*                                                         **            01970002
* INPUT                                                   **            02020002
*    ONE OR MORE LINES OF INPUT FROM THE TERMINAL INTO    **            02070002
*    THE INPUT BUFFER.                                    **            02120002
*                                                         **            02170002
* OUTPUT                                                  **            02220002
*    1.  ERROR MESSAGES TO THE MESSAGE WRITER             **            02270002
*    2.  RETURN CODES                                     **            02320002
*    *          00 - SUCCESSFUL COMPLETION OR BREAKPOINTS **            02370002
*    *               NOT REMOVED                          **            02420002
*    *          08 - HAVE PARSE ISSUE A 'REENTER'         **            02470002
*    *          12 - PARSE VALIDITY CHECK EXIT ERROR      **            02520002
*    *               RETURN CODE                                        02570002
*    *          16 - AN ATTENTION HAS BEEN SCHEDULED      **            02620002
*    *          20 - STAE RETRY HAS INTERCEPTED AN ABEND  **            02670002
*    *          24 - COULD NOT ISSUE ESTAE MACRO          **            02680002
*                                                         **            02720002
* EXTERNAL REFERENCES                                     **            02770002
*         IKJPARS - CHECKS SYNTAX OF ADDRESSES            **            02820002
*                                                         **            02830002
*         ESTAE   - ESTABLISH ABEND RECOVERY EXIT RTN     **            02840002
*         *         (IKJEGSTA)                            **            02850002
*                                                         **            02870002
*         IKJEGIO - IS INVOKED VIA THE IKJEGSIO MACRO     **            02920002
*                   TO PRINT ERROR MESSAGES.              **            02970002
*                                                         **            03070002
*         IKJEGCVT - CONVERTS AN ABSOLUTE ADDRESS, AN     **            03120002
*         *          EXPRESSION, AN INDIRECT ADDRESS, OR  **            03170002
*         *          A FULLY QUALIFIED ADDRESS TO BINARY. **            03220002
*         *          AT ENTRY, REG 1 CONTAINS THE         **            03270002
*         *          COMPLEMENT OF THE PDL ADDRESS TO     **            03320002
*         *          INDICATE AN ADDRESS CONVERSION, AND  **            03370002
*         *          REG 0 IS SET NEGATIVE TO INDICATE    **            03420002
*         *          CONVERT TO BINARY.                   **            03470002
*                                                         **            03520002
* EXITS, NORMAL                                           **            03570002
*    RETURN TO MAINLINE VIA REGISTER 14                   **            03620002
*                                                         **            03670002
* EXITS, ERROR                                            **            03720002
*    RETURN TO MAINLINE VIA REGISTER 14                   **            03770002
*                                                         **            03820002
* TABLES/WORK AREAS                                       **            03870002
*    TCOMTAB -                                            **            03920002
*    *     BREAKTAB - PTR TO ACTIVE BREAK ELEMENTS        **            03970002
*    *     DEFERTAB - PTR TO DEFERRED BREAK ELEMENTS      **            04020002
*    OFFWORKA - OFF'S WORKAREA                            **            04070002
*                                                         **            04120002
* ATTRIBUTES                                              **            04170002
*    REENTRANT AND REFRESHABLE                            **            04220002
*                                                         **            04270002
* CHARACTER CODE DEPENDENCY                               **            04320002
*    THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL**            04370002
*    REPRESENTATION OF THE EXTERNAL CHARACTER SET WHICH IS**            04420002
*    EQUIVALENT TO THE ONE USED AT ASSEMBLY TIME. THE     **            04470002
*    CODING HAS BEEN ARRANGED SO THAT REDEFINITION OF     **            04520002
*    'CHARACTER' CONSTANTS, BY REASSEMBLY, WILL RESULT IN **            04570002
*    A CORRECT MODULE FOR THE NEW DEFINITIONS.            **            04620002
*                                                         **            04670002
* NOTES                                                   **            04720002
*                                                         **            04770002
************************************************************            04820002
         EJECT                                                          04870002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 04920002
*        THE FOLLOWING ARE THE EQUATES NEEDED BY THE OFF COMMAND        04970002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 05020002
         SPACE                                                          05070002
*        REGISTER EQUATES                                               05120002
R0       EQU   0                   GENERAL WORK REGISTER                05170002
R1       EQU   1                   GENERAL WORK REGISTER (PARAM PASS)   05220002
R2       EQU   2                   GENERAL WORK REGISTER                05270002
R3       EQU   3                   GENERAL WORK REGISTER                05320002
R4       EQU   4                   GENERAL WORK REGISTER                05370002
R5       EQU   5                   GENERAL WORK REGISTER                05420002
R6       EQU   6                   BASE REGISTER FOR CONTROL BLOCKS     05470002
R7       EQU   7                   BASE REGISTER FOR DEFER & ACTIVE Q   05520002
R8       EQU   8                   BASE REGISTER FOR TEMPORARY USE      05570002
R9       EQU   9                   BASE REGISTER FOR TCOMTAB            05620002
R10      EQU   10                  BASE REGISTER FOR OFFWORK AREA       05670002
R11      EQU   11                  EXTRA REGISTER NOT USED              05720002
R12      EQU   12                  BASE REGISTER FOR IKJEGOFF           05770002
R13      EQU   13                  POINTER TO SAVE AREA                 05820002
R14      EQU   14                  USED FOR BAL ALSO WORK REG           05870002
R15      EQU   15                  USED FOR RETURN CODES ALSO WORK REG  05920002
         SPACE                                                          05970002
N0       EQU   0                   CONSTANT 0                           06020002
N1       EQU   1                   CONSTANT 1                           06070002
N2       EQU   2                   CONSTANT 2                           06120002
N3       EQU   3                   CONSTANT 3                           06170002
N4       EQU   4                   CONSTANT 4                           06220002
N5       EQU   5                   CONSTANT 5                           06270002
N6       EQU   6                   CONSTANT 6                           06320002
N7       EQU   7                   CONSTANT 7                           06370002
N8       EQU   8                   CONSTANT 8                           06420002
N9       EQU   9                   CONSTANT 9                           06470002
N10      EQU   10                  CONSTANT 10                          06520002
N12      EQU   12                  CONSTANT 12                          06570002
N16      EQU   16                  CONSTANT 16                          06620002
N20      EQU   20                  CONSTANT 20                          06670002
N24      EQU   24                  CONSTANT 24                          06680002
N32      EQU   32                  CONSTANT 32                          06720002
N56      EQU   56                  CONSTANT 56                          06770002
N60      EQU   60                  CONSTANT 60                          06780002
N72      EQU   72                  CONSTANT 72                          06820002
N120     EQU   120                 CONSTANT 120                         06830002
****     HEXIDECIMAL EQUATES                                            06870002
HEXC0    EQU   X'C0'               HEX CONSTANT C0                      06920002
HEX09    EQU   X'09'               HEX CONSTANT 09                      06930002
HEXFF    EQU   X'FF'               HEX CONSTANT FF                      06970002
HEX0C    EQU   X'0C'               HEX CONSTANT 0C                      07020002
HEX10    EQU   X'10'               HEX CONSTANT 10                      07070002
         EJECT                                                          07120002
         ENTRY IKJEGVCK            ENTRY POINT OF THE VALIDITY CHECK    07170002
OFFSTART DS    0H                  STARTING POSITION OF OFF             07220002
         SAVE  (14,12),,*          SAVE THE CALLERS REGISTERS           07270002
         LR    R12,R15             SETUP REG 12 AS OFF'S BASE           07320002
         USING OFFSTART,R12        ESTABLISH ADDRESSIBILITY             07370002
         USING TCOMTAB,R9          ESTABLISH ADDRESSIBILITY TO TCOMTAB  07420002
         L     R15,REGSAVE2        LOAD ADDR OF NEW SAVEAREA (OFF'S)    07470002
         ST    R13,N4(R15)         PLACE ADDR USER'S SAVEAREA INTO OFF  07520002
         ST    R15,N8(R13)         PLACE ADDR OFF SAVEAREA INTO USERS   07570002
         LR    R13,R15             R13= ADDR OF NEW SAVE AREA           07620002
****     ESTABLISH ADDRESSIBILITY TO OFF WORKAREA -- USE REG 10         07670002
         L     R8,WORKAREA         R1= ADDR OF GENERAL WORKAREA         07720002
         USING TSTCWORK,R8         ESTABLISH ADDRESSIBILITY             07770002
         LA    R10,CWORKCMD        R10= ADDR OF OFFS WORKAREA           07820002
         USING OFFWORKA,R10        COMPLETE ADDRESSIBILITY              07870002
         DROP  R8                  RELEASE REG 8                        07920002
****     SETUP FOR RETRY THRU STAE                                      07970002
         STM   R14,R12,HEX0C(R13)  STORE REGISTERS FOR STAE             08020002
*        LA    R1,ABENDTAB         R1= ADDR OF ABEND TABLE              08070002
*        ST    R1,ABENTAB1         ADDR ABEND TABLE TO OFFS WORKAREA    08120002
*        MVC   TSTRETRY(L'TSTRETRY),ADDRETRY PUT RETRY RTN ADDR IN TCOM 08170002
         L     R2,TSTSTAE          R2= IKJEGSTAE ADDR FROM TCOMTAB      08180002
         XC    STAEWRK(STAELN),STAEWRK  CLEAR AREA FOR ESTAE ISSUANCE   08190002
         ESTAE (R2),PARAM=LIST,MF=(E,OFFWORKA),RECORD=YES  ISSUE ESTAE  08320002
         SPACE                                                          08370002
SMTSTAE  DS    0H                  SMT TESTING LABEL                    08420002
         LTR   R15,R15             TEST THE RETURN CODE FROM STAE       08470002
         BZ    OFF0000             START THE ACTUAL OFF PROCESSING      08520002
         STC   R15,TSTESTRC        PRESERVE ESTAE RETURN CODE           08570002
         LA    R15,N24             SET RETURN CODE TO DECIMAL 24        08620002
         B     OFF0340             GO RETURN WITH R15=24                08730002
         SPACE                                                          08770002
****     OFF PROCESSING BEGINS HERE... FIRST CHECK                      08820002
*        NO PARAMETERS. IF ANY OF THE 3 ARE TRUE REMOVE ALL             08870002
*        BREAK POINTS...                                                08920002
OFF0000  DS    0H                  LABEL DO WE REMOVE ALL BRK PTS       08970002
         NI    TSTFLGS2,HEXFF-TSTXCTL TURN OFF XCTL SW                  08980002
         XC    CHNGSWRK,CHNGSWRK   ZERO FIELD USED TO INDICATES REMOVAL 09020002
         XC    VCKSWWRK,VCKSWWRK   ZERO VALIDITY CHECK FIELD            09030002
         TM    TSTFLGS1,ENDSW      IS THE ENDSW ON                      09070002
         BO    OFF0040             YES  CLEANUP AND REMOVE ALL BRK PTS  09120002
         TM    TSTFLGS1,RUNSW      IS THE RUNSW ON                      09170002
         BO    OFF0040             YES CLEANUP AND REMOVE ALL BRK PTS   09220002
         TM    TSTFLGS3,NOPARMS    IS THERE ANY PARAMETERS ON OFF       09270002
         BO    OFF0040             NO JUST REMOVE ALL BREAK PTS         09320002
         B     OFF0060             PARAMETERS SUPPLIED GO TO PARSE      09370002
         SPACE                                                          09420002
OFF0040  DS    0H                  REMOVE ALL BREAK POINTS              09470002
****     REMOVE ALL THE BREAK PTS BY BAL TO IKJEGALL                    09520002
         BAL   R14,IKJEGALL        REMOVE ALL ACTIVE & DEFERED BRK PTS  09570002
         B     OFF0300             RETURN NORMALLY TO CALLER            09620002
         SPACE                                                          09670002
****     SETUP TO LINK TO PARSE TO OBTAIN THE PARAMETERS                09720002
OFF0060  DS    0H                  SETUP PPL                            09770002
         LA    R8,PPLWRK           R8= ADDR OF THE PPL WORKAREA         09820002
         USING PPL,R8              EST ADDR'ABILITY TO PPL              09870002
****     MOVE THE UPT, ECT, AND ECB POINTERS TO THE PPL WORKAREA        09920002
         MVC   PPLWRK(L'TSTUPT+L'TSTECT+L'TSTCPECB),PARMLIST            09970002
         MVC   PPLPCL,PCLADDR      INSERT PCL ADDR INTO WORK AREA       10020002
         LA    R1,TSTANSPL         R1= ADDR OF TSTANSPL                 10070002
         ST    R1,PPLANS           STORE ADDR OF ANSWER PLACE IN WORKA  10120002
         MVC   PPLCBUF,INBUF       PLACE A POINTER TO INBUF INTO WORKA  10170002
         ST    R13,PPLUWA          STORE POINTER TO SAVE AREA IN WORKA  10220002
         LINK  EP=IKJPARS,MF=(E,PPLWRK),ERRET=ERRET1 LINK TO PARSE      10270002
SMTPARS  DS    0H                  PARSE RETURN                         10280002
         DROP  R8                  RELEASE ADDR'ABILITY TO THE PPL      10320002
         SPACE                                                          10370002
         B     OFF0080(R15)       BRANCH ON RETURN CODE INTO TABLE      10470002
OFF0080  DS    0H                  PARSE BRANCH TABLE FOR RETURN CODES  10520002
         B     OFF0220             ALL THRU RETURN CODE = 0 RETURN      10570002
         B     OFF0100             PARSE RETURN CODE = 04               10620002
         B     OFF0120             PARSE RETURN CODE = 08               10670002
         B     OFF0140             PARSE RETURN CODE = 0C (12)          10720002
         B     OFF0160             PARSE RETURN CODE = 10 (16)          10770002
         B     OFF0180             PARSE RETURN CODE = 14 (20)          10820002
         SPACE                                                          10870002
ERRET1   DS    0H                                                       10872002
         LA    R2,N6               NO-GET LINK SVC NUMBER               10876002
         BAL   R14,SVCERR          GO PUT OUT ERROR MESSAGE             10878402
         B     OFF0300                                                  10878802
         SPACE                                                          10880002
****     THE FOLLOWING CODE HANDLES PARSE ERRORS                        10920002
OFF0100  DS    0H                  RETURN CODE 04                       10970002
         OI    TSTFLGS4,TSTFLUSH   TURN ON SWITCH TO FLUSH STACK        11020002
         B     OFF0300             RETURN TO CALLER                     11070002
OFF0120  DS    0H                  RETURN CODE 08                       11120002
         LA    R15,N16             PLACE 16 INTO REG 5 FOR CALLER       11170002
         B     OFF0320             RETURN TO CALLER WITH 16             11220002
OFF0140  DS    0H                  RETURN CODE X'0C' FROM PARSE         11270002
         LA    R15,N3              INDICATE TO USE 3RD IO MACRO         11280002
         LA    R2,N5               INDICATE APPROPRIATE INSERT NUMBER   11330002
         LA    R1,MSGPRS0C         PLACE MSG ADDR INTO REG1             11370002
         BAL   R14,PUTMSG          OUTPUT THE MESSAGE                   11420002
         B     OFF0300             THATS ALL                            11470002
OFF0160  DS    0H                  PARSE RETURN CODE X'10'              11520002
         LA    R15,N1              INDICATE TO USE 1ST IO MACRO         11530002
         LA    R1,MSGPRS10         PLACE MSG ID INTO REG 1              11620002
         BAL   R14,PUTMSG          OUTPUT THE MSG                       11670002
         B     OFF0300             THATS ALL                            11720002
OFF0180  DS    0H                  RETURN CODE X'14' FROM PARSE         11770002
         CLI   RETCDWRK,N16        WAS THE RETCODE 16 FROM VALIDITY CK  11820002
         BNE   OFF0200             NO THEREFORE LOAD 20 AS A RETCODE    11870002
         LA    R15,N16             YES THEREFORE RETURN X'16' TO CALLER 11920002
         B     OFF0320             RETURN TO CALLER                     11970002
OFF0200  DS    0H                  RETURN TO  CALLER WITH 20            12020002
         CLI   RETCDWRK,N8         WAS RETURN CODE 8 FROM VALIDITY CK   12030002
         BE    OFF0300             YES THEREFORE JUST RETURN            12050002
         LA    R15,N20             PLACE 20 INTO REG 15 FOR CALLER      12070002
         B     OFF0320             RETURN TO CALLER                     12120002
         SPACE                                                          12170002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   12220002
*        BEFORE TERMINATING IS THE PDE NULL (PDEUSER) IN WHICH          12270002
*        CASE ALL BREAKPOINTS SHOULD BE REMOVED                         12320002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   12370002
OFF0220  DS    0H                  CHECK FOR A NULL PDE                 12420002
         L     R6,TSTANSPL         R6= ADDR OF THE RETURNED PDL         12470002
         LA    R6,N8(R6)           R6= ADDR OF THE PDE FROM PARSE       12480002
         USING IKJPARMA,R6         R6= ADDR'ABILITY TO PDE              12520002
         CLC   PDEUSER(L'PDEUSER),ZEROS   IS PDEUSER FIELD +FLAG = 0000 12570002
         DROP  R6                  RELEASE ADDR'ABILITY TO THE PDE      12620002
         BE    OFF0040             YES THEREFORE REMOVE ALL BREAKPOINTS 12670002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   12720002
*        WERE ANY BREAKPOINTS REMOVED IN THE VALIDITY CHECK             12770002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   12820002
         TM    CHNGSWRK,REMOVWRK   WAS ANY BREAKPOINTS REMOVED          12870002
         BO    OFF0300             YES THEREFORE EXIT                   12920002
         LA    R1,MSGNOBRK         R1= ADDR OF THE ERROR MESSAGE SET    12970002
         LA    R15,N1              INDICATE TO USE 1ST IO MACRO         12980002
         BAL   R14,PUTMSG          OUPUT THE MESSAGE                    13070002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   13120002
*   THIS IS THE END OF THE CONTROL PORTION OF THE OFF COMMAND...        13170002
*   RETURN TO CALLER (MNL) WITH EITHER A ZERO OR NON-ZERO RETURN CODE   13220002
*   THE NON-ZERO RETURN CODE IS PRESET IN REGISTER 15.                  13270002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   13320002
OFF0300  DS    0H                  RETURN WITH A NORMAL ZERO RET CODE   13370002
         XR    R15,R15             ZERO REGISTER 15 AS RETURN CODE      13420002
OFF0320  DS    0H                  RETURN WITH AN ERROR NONZERO RET COD 13470002
         LR    R2,R15              PRESERVE THE RETURN CODE             13472002
         ESTAE 0                   REMOVE SCB                           13480002
         LR    R15,R2              RESTORE THE RETURN CODE              13490002
OFF0340  DS    0H                  RETURN WITH THE RETURN CODE IN R15   13500002
         L     R13,N4(R13)         R13= ADDR OF CALLERS SAVE AREA       13520002
         RETURN (14,12),,RC=(15)   THIS WILL RETUNR TO THE CALLER       13570002
         EJECT                                                          13620002
IKJEGALL DS    0H                  ENTRY FOR REMOVING ALL BRK PTS       13670002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   13720002
*   THE FOLLOWING SECTION OF CODE REMOVES ALL BREAK POINTS ACTIVE       13770002
*   AND DEFERED.  ACTIVE BREAK POINTS ARE REMOVED FIRST, BY TAKING      13820002
*   THE BREAK PT FROM THE TOP OF THE LIST AND LINKING THE LIST          13870002
*   AROUND THE BREAK PT AND CALLING  'REMOVACT' WHICH WIIL REMOVE       13920002
*   THE BREAK PT WHOSE ADDR IS IN REGISTER 1. THE PROCESS IS CONTINUED  13970002
*   UNTIL THERE IS A NULL LIST.                                         14020002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   14070002
         ST    R14,REG14WRK        STORE THE RETURN REG UNTIL DONE      14120002
         USING BRKELEM,R8          SETUP ADDR'IBILITY TO ACTIVE BRK PTS 14170002
ALL0020  DS    0H                  GET ADDR FROM THE BREAKTAB (TCOMTAB) 14220002
         L     R8,BREAKTAB         R8= ADDR OF FIRST BRK ELEMENT        14270002
         LA    R1,N0(R8)           R1= ADDR WITH ZERO HIGH ORDER BYTE   14320002
         LTR   R1,R1               ARE THERE ANY ACTIVE BRK PTS         14370002
         BZ    ALL0100             NO THEREFORE CHECK DEFERTAB          14420002
         L     R1,BRKADDR          R1= ADDR TO BE SEARCHED FOR BY SRH   14470002
         XC    SRHAWRK(N12),SRHAWRK CLEAR THE SRH WORK AREA             14580002
         ST    R1,SRH2WRK          INSERT THE ADDR OF BRKPT TO REMOVED  14590002
         LA    R1,SRHAWRK          R1= ADDR OF THE PARAMETER AREA       14600002
         L     R15,TSTSRHRT        R15= ADDR OF THE SEARCH ROUTINE      14610002
         BALR  R14,R15             HAVE THE BREAKPOINT REMOVED          14612002
****     TRANSFER CONTROL WITH RESPECT TO RETURN CODE                   14614002
         B     ALL0040(R15)        BRANCH INTO TABLE                    14616002
         SPACE                                                          14618002
ALL0040  DS    0H                  SRH RETURN CODE TABLE                14618402
         B     ALL0060             OK TURN ON REMOVAL SW                14618802
         B     ALL0060             RC= 04 UNABLE TO FIND CK DEFERED     14619202
         B     ALL0060             RC= 08 INVALID RANGE                 14619602
         B     ALL0080             RC= 12 STAE RETRY BLEW IT            14619702
         B     OFF0320             RC > 12, SO RETURN TO CALLER(MNL)    14621802
         B     OFF0320             RC > 12, SO RETURN TO CALLER(MNL)    14623802
         B     OFF0320             RC > 12, SO RETURN TO CALLER(MNL)    14625802
         SPACE                                                          14626502
ALL0060  DS    0H                  TURN ON REMOVE SW AND CONTINUE       14629802
         B     ALL0020             CONTINUE WITH THE NEXT BREAK PT      14670002
         SPACE                                                          14672002
ALL0080  DS    0H                  RETURN TO MNL W 20                   14680002
         LA    R15,N20             RETURN TO MAINLINE WITH 20           14690002
         B     OFF0320             JUST RETURN TO MNL                   14700002
         DROP  R8                  RELEASE THE ACT BRK PT Q REG         14720002
         SPACE                                                          14770002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   14820002
*   THE NEXT SECTION OF CODE REMOVES THE DEFERED BREAK POINTS.          14870002
*   IT ALSO LINKS AROUND THE DME THEN FREES THE 1) DME, 2) PDL,         14920002
*   3) INBUF, 4) DBE... 2 THROUGH 4 ARE CONTINUED UNTIL THERE ARE NO    14970002
*   MORE DBE'S. THE NEXT DME IS OBTAINED AND THE PROCESS IS CONTINUED   15020002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   15070002
         SPACE                                                          15120002
ALL0100  DS    0H                  REMOVE ALL DEFERED BREAK POINTS      15170002
         USING DME,R8              ESTABLISH ADDR'IBILITY TO THE DME'S  15220002
         USING DBE,R7              ESTABLISH ADDR'IBILITY TO THE DBE'S  15270002
         L     R8,DEFERTAB         R8= ADDR OF FIRST DME                15320002
ALL0120  DS    0H                  BEGIN LOOP OF REMOVING DME'S         15370002
         LA    R8,N0(R8)           ZERO THE HIGH ORDER BYTE             15420002
         LTR   R1,R8               IF ZEROTHERE ARE NO (MORE) DME'S     15470002
         BZ    ALL0200             ALL BREAK POINTS REMOVED RETURN      15520002
         L     R7,DMEDBE           R7= ADDR OF THE DBE...               15620002
         L     R8,DMEDME           R8= ADDR OF NEXT DME TO BE PROCESSED 15670002
         ST    R8,DEFERTAB         LINK AROUND THE DEFERED ELEMENT      15720002
         FREEMAIN RC,LV=16,A=(1),SP=1  FREE THE DME...                  15770002
         LTR   R15,R15             DID ERROR OCCUR IN FREEMAIN          15772002
         BZ    ALL0140             ZERO IMPLIES NO ERROR                15774002
         LA    R2,N120             SET SVC NUMBER                       15780002
         SR    R1,R1               INDICATE THAT THERE IS NO ABEND CODE 15790002
         BAL   R14,SVCERR          GO PUT OUT ERROR MSG                 15800002
ALL0140  DS    0H                  PROCESS THE DBE                      15820002
         LA    R7,N0(R7)           ZERO THE HIGH ORDER BYTE             15870002
         LTR   R7,R7               CKECK IF THERE IS A DBE TO PROCESS   15920002
         BZ    ALL0120             NO THEREFORE CHECK FOR MORE DME'S    15970002
****     RELEASE THE PARSE PDL                                          16020002
         IKJRLSA DBEPDL          RELEASE THE PDL                        16070002
****     FREE THE INPUT BUFFER POINTED TO IN THE DBE                    16120002
         L     R1,DBEINBUF         R1= ADDR OF THE INBUF                16170002
         LH    R0,N0(R1)           R3= LENGTH OF THE BUFFER             16220002
         FREEMAIN RC,LV=(0),A=(1),SP=1   FREE INBUF                     16320002
         LTR   R15,R15             DID ERROR OCCUR IN FREEMAIN          16322002
         BZ    ALL0150             ZERO IMPLIES NO ERROR                16324002
         LA    R2,N120             SET SVC NUMBER                       16330002
         SR    R1,R1               INDICATE THAT THERE IS NO ABEND CODE 16340002
         BAL   R14,SVCERR          GO PUT OUT ERROR MSG                 16350002
****     ISSUE FREEMAIN TO FREE THE DBE LASTLY.                         16370002
ALL0150  DS    0H                                                       16380002
         LR    R1,R7               R1= ADDR OF DBE TO BE FREED          16420002
         L     R7,DBEDBE           R7= ADDR OF NEXT DBE IF ANY          16470002
         FREEMAIN R,LV=12,A=(1),SP=1 ISSUE FREEMAIN OF DBE              16520002
         LTR   R15,R15             DID ERROR OCCUR IN FREEMAIN          16530002
         BZ    ALL0140             ZERO IMPLIES NO ERROR                16540002
         LA    R2,N120             SET SVC NUMBER                       16550002
         SR    R1,R1               INDICATE THAT THERE IS NO ABEND CODE 16560002
         BAL   R14,SVCERR          GO PUT OUT ERROR MSG                 16562002
         B     ALL0140             PROCESS NEXT                         16570002
****     ALL THE BREAK POINTS (ACTIVE AND DEFERED) HAVE BEEN REMOVED    16620002
ALL0200  DS    0H                  RETURN TO MAIN OF OFF                16670002
         L     R14,REG14WRK        R14= ADDR OF CALLER                  16720002
         BR    R14                 RETURN TO CALLER                     16770002
         DROP  R8                  RELEASE ADDR'IBILITY TO DME          16820002
         DROP  R7                  RELEASE ADDR'IBILITY TO DBE          16870002
         EJECT                                                          16920002
         SPACE                                                          16970002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 22120002
*   THE NEXT SECTION OF CODE IS THE VALIDITY CHECK ROUTINE WHICH        22170002
*   PARSE RETURNS CONTROL TO VARIFY AN ADDRESS WHICH THE USER ENTERED   22220002
*   THE PDE IS INPUT TO THE ROUTINE, IT VARIFIES THE ADDRESS AND        22270002
*   REMOVES IT FROM BOTH QUEUE'S....                                    22320002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 22370002
         SPACE                                                          22420002
IKJEGVCK DS    0H                  ENTRY POINT FOR THE VALIDITY CK RTN  22470002
         SAVE  (14,12),,*          SAVE REGISTERS FROM PARSE            22520002
****     RE-ESTABLISH MY ADDRESSIBILITY TO IKJEGOFF...                  22570002
         USING IKJEGOFF,R12        SETUP ADDR'ABILITY TO BASE           22620002
         L     R2,N4(R1)           R13= ADDR OF REGISTER SAVE AREA      22670002
****     RESTORE REGISTER 9 (TCOMTAB), 10 (OFFWORKA), AND 12 (OFF BASE) 22720002
         LM    R9,R12,N56(R2)      RESTORE REGS 9 THRU 12               22770002
****     BEGIN PROCESSING THE PDE FROM PARSE                            22820002
         OI    VCKSWWRK,VCKONWRK   TURN ON VALIDITY CK SW               22830002
         L     R6,N0(R1)           R6=ADDR OF THE PDE FROM PARSE        22870002
         LA    R6,N0(R6)           ZERO THE HIGH ORDER BYTE             22920002
         USING IKJPARMA,R6         EST ADDR'IBILITY TO THE PDE          22970002
****     SAVE PARSE'S REGISTERS AND CHAIN SAVE AREAS TOGETHER           23070002
         ST    R1,PARETWRK         SAVE ADDR OF PARM BLOCK              23120002
         L     R1,REGSAVE3         R1= ADDR OF THE NEW SAVE AREA        23170002
         ST    R13,N4(R1)          STORE THE BACK POINTER               23220002
         ST    R1,N8(R13)          STORE THE FOWARD POINTER             23270002
         LR    R13,R1              R13= ADDR OF NEW SAVE AREA           23320002
         OI    TSTFLGS4,TSTVALCK   TURN ON VALIDITY CHECK INDICATOR     23330002
         L     R2,OUTBUF           GET BUFFER ADDRESS                   23340002
         MVC   N0(N4,R2),ZEROS     SET MESSAGE INDICATOR TO ZERO        23350002
         NI    CHNGSWRK,HEXFF-VCKRMWRK TURNOFF VALIDITY CHECK SW SET    23370002
         L     R2,BREAKTAB         ARE THERE ANY ACTIVE BRK ELEMENTS    23420002
         LA    R2,N0(R2)           ZERO HIGH ORDER BYTE                 23470002
         LTR   R2,R2               DO WE HAVE AN ADDRESS                23520002
         BNZ   VCK0020             YES CONTINUE                         23570002
         L     R2,DEFERTAB         ARE THERE ANY ACTIVE DEF ELEMENTS    23620002
         LA    R2,N0(R2)           ZERO HIGH ORDER BYTE                 23670002
         LTR   R2,R2               DO WE HAVE AN ADDRESS                23720002
         BNZ   VCK0020             YES CONTINUE                         23770002
****     THERE IS NOTHING ON EITHER Q ALL ADDRESSES ARE INVALID         23820002
         LA    R15,N2              INDICATE TO USE 2ND IO MACRO         23830002
         LA    R1,MSGNOQUE         PLACE MSGID INTO REGISTER 1 ERROR    23870002
         LR    R2,R6               R2= ADDR OF PDE (INSERT)             23880002
         NI    TSTFLGS4,HEXFF-TSTVALCK   TURN OFF VALIDITY CHECK SW     23930002
         BAL   R14,PUTMSG          OUTPUT THE ERROR MSG                 23970002
         LA    R1,N8               R1= N8 RETURN CD TO BE SAVED         23980002
         ST    R1,RETCDWRK         SAVE THE RET CD FOR MAIN OFF USE     23990002
         LA    R15,N12             RETURN TO PARSE W/ 12 END IT         24000002
         B     VCK0935             RETURN WITH 12                       24020002
         SPACE                                                          24070002
****     VERFY THAT IT IS A VALID PDE (BOTH HALVES OF THE PDE)          24120002
VCK0020  DS    0H                  FIRST HALF OF PDE                    24170002
         TM    PDEFLG2,CTNAMFLG    WAS AN ENTRYNAME SPECIFIED           24220002
         BO    VCK0050             YES THEREFORE CHECK IT               24270002
         TM    PDEFLG4,GENR        DO WE HAVE A GENERAL REGISTER        24320002
         BNO   VCK0040             CHECK WHAT IT IS ...                 24370002
         LH    R2,PDEINDCT         R7= INDIRECT COUNT FROM PDE          24420002
         LTR   R2,R2               WAS INDIRECTION ALSO SPECIFIED       24470002
         BNZ   VCK0050             YES CHECK REGISTER USAGE             24520002
         B     VCK0045             INVALID REG ERROR MSG                24530002
****     CHECK FOR FLOATING POINT DOUBLE REGISTER USED IF SO INVALID    24820002
VCK0040  DS    0H                  LOOK AT ADDRESS TYPE FIELD           24870002
         TM    PDEFLG4,LFPR        IS IT A DOUBLE PRECISION REGISTER    24920002
         BO    VCK0045             YES THEREFORE ERROR MSG              24970002
         TM    PDEFLG4,SFPR        IS IT A FLOATING POINT REGISTER      25020002
         BNO   VCK0050             NO, THEREFORE CONTINUE               25070002
****     ERROR CONDITION INVALID REGISTER USAGE                         25120002
VCK0045  DS    0H                  ERROR CONDITION                      25170002
         LA    R15,N2              INDICATE TO USE 2ND IO MACRO         25180002
         LR    R2,R6               R2= ADDR OF PDE (INSERT ADDR)        25220002
         LA    R1,MSGFPREG         R1= ADDR OF THE MESSAGE              25270002
         BAL   R14,PUTMSG          GO TO THE MESSAGE ROUTINE            25320002
         B     VCK0930             RETURN TO PARSE W/REENTER RET CODE   25370002
         SPACE                                                          25420002
VCK0050  DS    0H                  SECOND HALF OF PDE                   25430002
         TM    PDE2FLG2,CTNAMFLG   WAS AN ENTRYNAME SPECIFIED           25440002
         BO    VCK0060             YES THEREFORE CHECK IT               25450002
         TM    PDE2FLG4,GENR       DO WE HAVE A GENERAL REGISTER        25460002
         BNO   VCK0055             CHECK WHAT IT IS ...                 25462002
         LH    R2,PDE2INDC         R7= INDIRECT COUNT FROM PDE          25464002
         LTR   R2,R2               WAS INDIRECTION ALSO SPECIFIED       25466002
         BNZ   VCK0060             YES CHECK REGISTER USAGE             25468002
         B     VCK0045             INVALID REG ERROR MSG                25468402
****     CHECK FOR FLOATING POINT DOUBLE REGISTER USED IF SO INVALID    25469802
VCK0055  DS    0H                  LOOK AT ADDRESS TYPE FIELD           25469902
         TM    PDE2FLG4,LFPR       IS IT A DOUBLE PRECISION REGISTER    25486602
         BO    VCK0045             YES THEREFORE ERROR MSG              25496602
         TM    PDE2FLG4,SFPR       IS IT A FLOATING POINT REGISTER      25498602
         BO    VCK0045             NO, THEREFORE CONTINUE               25500602
         SPACE                                                          25512802
****     BEGIN ACTUAL PROCESSING GO TO CONVERT TO RESOLVE ADDRESS       25514402
VCK0060  DS    0H                  SETUP FOR COVERT                     25520002
         TM    PDEFLG1,LDNAMFLG    WAS A LOAD NAME ENTERED...           25570002
         BNO   VCK0080             NO THEREFORE DO NOT TURN ON SYM SW   25620002
         OI    TSTFLGS3,SYMMESG    SW=ON TO STOP SYM MESSAGES           25670002
VCK0080  DS    0H                  SETUP FOR A CALL TO PARSE            25720002
         OI    TSTFLGS1,RANGESW    TURN ON THE RANGE SW FOR CVT         25770002
         LCR   R1,R6               R1= COMPLEMENT ADDR OF PDE           25820002
         XR    R0,R0               R0= ZERO FOR CONVERT                 25870002
         L     R15,TSTCONVT        R15= ADDR OF THE CONVERT ROUTINE     25920002
         BALR  R14,R15             GO TO THE CONVERT SUBROUTINE         25970002
         TM    TSTFLGS1,RANGESW    IS THE RANGE SW ON                   25980002
         BO    VCK0085             YES GET AND SAVE FIRST PDEUSER       26000002
         L     R2,PDE2USER         R2=ADDR IN PDEUSER 2 (SEC LEVEL MSG) 26010002
         B     VCK0090             CONTINUE CHECKING                    26012002
VCK0085  DS    0H                  USE ADDR IN PDEUSER 1                26014002
         L     R2,PDEUSER          R2=ADDR IN PDEUSER 1 (SEC LEVEL MSG) 26016002
VCK0090  DS    0H                  CONTINUE CLEANING UP AFTER CONVERT   26018002
****     TURN OFF SYMMESG AND RANGESW SWITCHS SAVE PDEUSER (ERROR MSG)  26020002
         NI    TSTFLGS3,HEXFF-SYMMESG TURN OFF SYM MESSAGE SWITCH       26070002
         NI    TSTFLGS1,HEXFF-RANGESW TURN OFF RANGE MESSAGE SWITCH     26120002
****     TRANSFER CONTROL WITH RESPECT TO THE RETURN CODE               26220002
         SPACE                                                          26270002
         B     VCK0100(R15)        BRANCH INTO THE TABLE                26320002
VCK0100  DS    0H                  CVT RETURN CODE TABLE                26370002
         B     VCK0200             ZERO RETURN CODE THEREFORE CONTINUE  26420002
         B     VCK0140             RET CD= 04 UNABLE TO CONVERT PDE     26470002
         B     VCK0140             RET CD= 08 UNABLE TO RESOLVE SYMBOLS 26520002
         B     VCK0120             RET CD= 12 IO ERROR                  26570002
         B     VCK0120             RET CD= 16 AN ATTN WAS POSTED        26620002
         B     VCK0120             RET CD= 20 IO PROBLEMS SYM OR CVT    26670002
         SPACE                                                          26720002
****     RETURN TO PARSE WITH A '12' SAVE THE RETURN CODE FROM CVT      26770002
VCK0120  DS    0H                  RETURN TO PARSE WITH '12'            26820002
*        ESTAE 0,OV                REMOVE SCB                           26830002
         ST    R15,RETCDWRK        SAVE CONVERTS RET CODE IN WORKAREA   26870002
         LA    R15,N12             R15= '12' AS A RETURN CODE           26920002
         B     VCK0960             BRANCH TO RETURN TO PARSE            26970002
         SPACE                                                          27020002
****     CHECK IF THE PROBLEM IS AN UNRESOLVED LOADNAME ON DEFERED Q    27070002
VCK0140  DS    0H                  IS THERE A LOADNAME IN PDE1          27120002
         TM    PDEFLG1,LDNAMFLG    IS AN LOADNAME PRESENT               27170002
         BZ    VCK0160             NO ASK PARSE FOR REENTER RET CD 08   27220002
         TM    PDE2FLG3,AFLG       DOES SECOND HALF OF THE PDE EXIST    27270002
         BZ    VCK0400             NO THEREFORE  A SINGLE DEFERED ENTRY 27320002
         TM    PDE2FLG1,LDNAMFLG   DOES A LOADNAME EXIST                27370002
         BO    VCK0400             YES THEREFORE DEFERED RANGE          27420002
****     WE HAVE A BAD  NAME SYM OR CONVERT PROBLEM                     27470002
         L     R2,PDE2USER         R2= SECOND LEVEL ERROR MESSAGE       27480002
         B     VCK0930             RETURN TO PARSE WITH REENTER         27482002
VCK0160  DS    0H                  PDEUSER CONTAINS SECOND LEVEL        27490002
         L     R2,PDEUSER          R2= SECOND LEVEL MESSAGE             27500002
         B     VCK0930             RETURN TO PARSE WITH REENTER         27870002
         EJECT                                                          27920002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   27970002
*    START PROCESSING OF THE ACTUAL ADDRESS, 1) PDEUSER, 2) SIB PTR,    28020002
*    3) QUALIFIED NAME. CONDITIONS 1 AND 2 INDICATE ACTIVE, CONDITION   28070002
*    3 INDICATES DEFERED. ALL ENTERIES ARE REMOVED ON BOTH QUEUE'S...   28120002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   28170002
VCK0200  DS    0H                  START WITH PDE USER FIELD            28220002
         XC    SRHAWRK(N12),SRHAWRK CLEAR PARAMETER AREA                28230002
         L     R2,PDEUSER          R2= ADDR IN FROM PDEUSER OF THE PDE  28270002
         TM    PDEUSER,PDESIB      IS IT THE ACTUAL ADDRESS OR SIB PTR  28320002
         BZ    VCK0220             IF POSITIVE A VALID ADDRESS          28370002
         L     R2,N0(R2)           GET THE ACTUAL ADDRESS FROM THE SIB  28420002
         ST    R2,PDEUSER          VALIDATE THE ADDRESS YOU RECIEVED    28470002
         SPACE                                                          28520002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   28570002
*    REMOVE FROM THE ACTIVE BREAK Q THE BREAK POINT WHOSE ADDR IS       28620002
*    IN THE PDEUSER FIELD OF THE PDE. THE BREAK Q IS IN INCREASING      28670002
*    ORDER BY ADDRESS.                                                  28720002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   28770002
VCK0220  DS    0H                  BEGIN THE REMOVAL PROCESSING         28820002
         LA    R2,N0(R2)           CLEAR OUT THE HIGH ORDER BYTE        28870002
         ST    R2,SRH2WRK          INSERT ADDRESS OF BRKPT TO REMOVE    28880002
         L     R3,PDE2USER         R3= ADDR OF SECOND PDEUSER FIELD     29020002
         TM    PDE2USER,PDESIB     IS THE 2 PDE AN ADDR OR SIB POINTER  29170002
         BZ    VCK0240             IT IS THE ACTUAL ADDRESS             29220002
         L     R3,N0(R3)           R3=THE ACTUAL ADDRESS                29270002
         ST    R3,PDE2USER         PLACE THE ADDRESS IN PDE2USER        29320002
****    WE HAVE THE SECOND ADDRESS OF THE RANGE                         29370002
****     MAKE SURE ADDR 1 IS LESS THAN ADDR 2 OF RANGE                  29420002
VCK0240  DS    0H                  VARIFY THE ADDRESS OF A RANGE        29470002
         LA    R3,N0(R3)           CLEAR-HIGH-ORDER-BYTE                29480002
         ST    R3,SRH3WRK          INSERT ENDING RANGE ADDR (OR ZERO)   29490002
         LA    R1,SRHAWRK          R1= ADDR OF THE PARM AREA            29540002
         L     R15,TSTSRHRT        R15= ADDR OF THE SEARCH ROUTINE      29590002
         BALR  R14,R15             GO TO REMOVAL ROUTINE                29640002
****     TRANSFER CONTROL WITH RESPECT OT RETURN CODE                   29650002
         B     VCK0260(R15)        BRANCH INTO TABLE                    29660002
         SPACE                                                          29662002
VCK0260  DS    0H                  SRH RETURN CODE TABLE                29664002
         B     VCK0280             OK TURN ON REMOVAL SW                29666002
         B     VCK0400             RC= 04 UNABLE TO FIND CK DEFERED     29668002
         B     VCK0300             RC= 08 INVALID RANGE                 29668402
         B     VCK0320             DUMMY                                29668502
         B     VCK0320             DUMMY                                29672002
         B     VCK0320             RC= 20 STAE RETRY BLEW IT            29674902
         B     VCK0320             RC= 24 STAE RETRY BLEW IT            29676902
         SPACE                                                          29681602
VCK0280  DS    0H                  OK JUST TURN ON REMOVED SW           29688002
         OI    CHNGSWRK,VCKRMWRK+REMOVWRK INDICATE SOMETHING REMOVED    29694402
         B     VCK0400             CHECK THE DEFERED QUEUE              29700802
         SPACE                                                          29707202
VCK0300  DS    0H                  INVALID RANGE ERROR CONDITION        29713602
         LA    R1,MSGIVRNG         R1= ADDR OF ERROR MSG                29720002
         LA    R15,N2              INDICATE TO USE 2ND IO MACRO         29730002
         LR    R2,R6               R2= ADDR OF PDE (INSERT ADDR)        29770002
         BAL   R14,PUTMSG          GO TO THE ERROR OUTPUT ROUTINE       29820002
         B     VCK0930             RETURN TO PARSE W/REENTER CODE       29870002
         SPACE                                                          29920002
VCK0320  DS    0H                  RETURN TO MNL W 20                   29970002
         LA    R1,N16              R1 = 16 SAVE INDICATOR               29980002
         ST    R1,RETCDWRK         SAVE RETRY INDICATOR                 29990002
         LA    R15,N12             R15= 12 RETURN CODE TO MNL TROUBLE   30020002
         B     VCK0960             RETURN TO PARSE                      30070002
         EJECT                                                          32770002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   32820002
*    ALL ACTIVE BREAKPOINTS HAVE BEEN REMOVED IF ANY. NOW WE MUST       32870002
*    REMOVE ALL DEFERED BREAKPOINTS THAT HAVE BEEN INDICATED IN THE     32920002
*    PDE FROM PARSE...                                                  32970002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   33020002
         SPACE                                                          33070002
VCK0400  DS    0H                  BEGIN DEFERED PROCESSING             33120002
         L     R8,DEFERTAB         R7= ADDR OF FIRST ELEMENT OF DEFER Q 33170002
         USING DME,R8              EST ADDR'ABILITY TO DEFERED DME'S    33220002
         USING DBE,R7              EST ADDR'ABILITY TO DEFERED DBE'S    33270002
************************ START DEFERED  -DME- SEARCH ****************** 33320002
****     START THE DEFERED PROCESSING VARIFY DEFER Q.                   33370002
         SPACE                                                          33420002
         XC    DMEBKWRK(N4),DMEBKWRK   ZERO BACK POINTER FOR DME        33470002
         NI    VCKSWWRK,HEXFF-RANSWWRK TURN OFF RANGE SWITCH            33480002
         LA    R1,DEFERTAB         R1= ADDR OF DEFERED TABLE ADDRESS    33520002
         ST    R1,DMEBKWRK         SAVE THE ADDRESS FOR BACK CHAINING   33570002
VCK0420  DS    0H                  EMPTY DEFERED Q                      33620002
         LA    R8,N0(R8)           ZERO THE HIGH ORDER BYTE             33670002
         LTR   R8,R8               NULL DEFERED QUEUE                   33720002
         BZ    VCK0920             YES THEREFORE WE ARE DONE            33770002
****     GET BOTH LOADNAMES AND COMPARE THEM                            33820002
         LA    R2,DMELOAD          R2= ADDR OF LOADNAME FROM DME        33870002
         L     R3,PDELDNAM         R3= ADDR OF THE PDE LOADNMAE         33920002
         LH    R4,PDELEN1          R4= LENGTH OF THE PDE LOAD NAME      33970002
         BCTR  R4,N0               DECREAMENT R4 FOR COMPARE            34020002
         EX    R4,COMPARE          EXECUTE A COMPARE OF THE LOADNAMES   34070002
         BE    VCK0440             WE HAVE THE CORRECT DME              34120002
         LA    R1,DMEDME           R1= ADDR OF DME POINTER              34130002
         ST    R1,DMEBKWRK         SAVE THE ADDR OF THE PREVIOUS DME    34140002
         L     R8,DMEDME           R8= ADDR OF THE NEXT DME             34220002
         B     VCK0420             CONTINUE SEARCH FOR THE CORRECT DME  34270002
         SPACE                                                          34320002
************************ START DEFERED -DBE- SEARCH ******************* 34370002
****     SEARCH FOR THE CORRECT DBE OF THAT DME                         34420002
VCK0440  DS    0H                  START SEARCH INITIALIZE              34470002
         XC    DBEBKWRK(N4),DBEBKWRK ZERO BACK POINTER FOR THE DBE      34520002
         L     R7,DMEDBE           R7= ADDR OF FIRST DBE                34570002
VCK0460  DS    0H                  CHECK IF DBE EXISTS                  34620002
         LA    R7,N0(R7)           ZERO THE HIGH ORDER BYTE             34670002
         LTR   R7,R7               IS THE DME PTR NULL                  34720002
         BZ    VCK0920             WE ARE DONE ...                      34770002
****     GET THE ADDR TO THE PDE WHICH CREATED THIS DEFERED BREAK POINT 34820002
****     ESTABLIST ADDRESSABILITY TO THIS PDE                           34870002
         L     R5,DBEPDL           GET THE PDE WHICH CREATED THE DBE    34920002
         LA    R5,N8(R5)           INCREMENT PDE ADDR TO BODY OF PDE    34970002
         USING DBEPDECT,R5         EST ADDR'ABILITY TO THE DBE-PDE      35020002
VCK0470  DS    0H             CONTINUE THE DBE-PDE SEARCH               35030002
         L     R2,DBECTNAM         R2= ADDR OF DBE CSECT NAME           35070002
         L     R3,PDECTNAM         R3= ADDR OF PDE CSECT NAME           35120002
         LH    R4,PDELEN2          R4= LENGTH OF THE PDE CSECT NAME     35170002
         BCTR  R4,N0               DECREAMENT R4 FOR COMPARE            35220002
         EX    R4,COMPARE          ARE THE CSECT NAME EQUAL             35270002
         BE    VCK0540             YES THEREFORE MUST CHECK FURTHER     35320002
         SPACE                                                          35370002
****     FIRST CHECK IF THERE IS A CHAIN OF PDE'S OFF THE DBE           35380002
VCK0500  DS    0H                  RESTART THE SEARCH FOR DBE           35382002
         L     R1,DBE2CHAI         R2= ADDR OF NEXT DBE(PDE) OFF DBE    35390002
         LA    R1,N0(R1)           ZERO HIGH ORDER BYTE                 35400002
         LTR   R1,R1               IS THERE ANOTHER DBEPDE              35410002
         BNZ   VCK0510             YES THEREFORE CHECK IT FOR A MATCH   35412002
****     THIS DBE IS FINISHED SAVE ADDRESS FOR BACKUP AND GET NEXT DBE  35414002
         ST    R7,DBEBKWRK         SAVE THE PREVIOUS DBE ADDRESS        35470002
         L     R7,DBEDBE           OTHERWISE GET THE NEXT DBE           35520002
         B     VCK0460             CONTINUE THE CSECT SCEARCH           35570002
         SPACE                                                          35572002
****     CONTINUE SEARCH WITH NEXT DBE-PDE CHAINED OFF OF PREVIOUS      35580002
VCK0510  DS    0H                  ADDR'ABILITY TO THE DBE-PDE          35590002
         LR    R5,R1               R5= ADDR OF DBE-PDE TO BE SEARCHED   35600002
         B     VCK0470             CONTINUE THE SEARCH FOR A MATCH      35610002
         SPACE                                                          35620002
****     RESTORE THE DBE PTR AS ADDR STRING SEARCH FAILED               35670002
VCK0520  DS    0H                  RESTORE DBE                          35720002
         L     R5,DBEPDWRK         R5= SAVED ADDR OF DBE-PDE WHERE STOP 35730002
         L     R7,DBESVWRK         R7= ADDR OF DBE WHICH FAILED         35740002
         NI    VCKSWWRK,HEXFF-RANSWWRK TURN OFF RANGE SWITCH            35750002
         B     VCK0500             CONTINUE CSECT NAME SEARCH           35820002
         DROP  R7                  RELEASE ADDR'ABILITY TO THE DBE      35870002
         SPACE                                                          35920002
****     WE HAVE A MATCH FOR THE LOAD AND CSECT NAMES, NOW CHECK THE    35970002
****     ADDRESS STRING(S) AND/OR THE THIRD QUALIFIER                   36020002
VCK0540  DS    0H                  STORE THE DBE ADDR FOR RESTART       36070002
         ST    R5,DBEPDWRK         SAVE THE ADDR OF THE DBE-PDE         36080002
         ST    R7,DBESVWRK         SAVE THE CURRENT DBE                 36090002
         TM    PDEFLG4,CTONLY      IS THIS A CSECT ONLY SEARCH          36100002
         BO    VCK0920             YES THEREFORE WE HAVE A VALID MATCH  36110002
VCK0545  DS    0H                  RESTART POSITION FOR SECOND HALF PDE 36170002
****     ZERO THE TEMPORARY ADDR EXPRESSION SUMS                        36220002
         XC    DBESMWRK(N4),DBESMWRK ZERO DBE SUM IN WORKAREA           36270002
         XC    PDESMWRK(N4),PDESMWRK ZERO PDE SUM IN WORKAREA           36320002
         XC    DBEIDWRK(N2),DBEIDWRK ZERO DBE INDIRECT COUNT IN WRKAREA 36370002
         XC    PDEIDWRK(N2),PDEIDWRK ZERO PDE INDIRECT COUNT IN WRKAREA 36420002
         TM    PDEFLG3,AFLG        CHECK IF THE ADDR STRING PRESENT     36470002
         BZ    VCK0550             THIS SHOULD NEVER HAPPEN IF PARSE OK 36520002
         TM    PDEFLG4,RELADDR     IS ADDR STRING NUMERIC               36570002
         BO    VCK0580             YES THERFORE PROCESS                 36620002
         TM    PDEFLG4,SYMADDR     IS IT SYMBOLIC                       36670002
         BO    VCK0560             YES AS IT BETTER BE                  36720002
****     IN THEORY THIS PIECE OF CODE SHOULD NEVER BE EXECUTED          36770002
****     IT INDICATES AN INVALID PDE WAS ENCOUNTERED                    36820002
VCK0550  DS    0H                  OUT PUT THE ERROR MESSAGE            36870002
         LA    R15,N2              INDICATE TO USE 2ND IO MACRO         36880002
         LR    R2,R6               R2= ADDRESS PDE INSERT ADDR          36920002
         LA    R1,MSGIVPDE         R1= ADDR OF INVALID PDE MSG          36970002
         BAL   R14,PUTMSG          OUTPUT THE MESSAGE                   37020002
         B     VCK0930             CONTINUE WITH NEXT PDE               37120002
         SPACE                                                          37170002
****     COMPARE THIRD QUALIFIER                                        37220002
****     A NON NUMERIC ADDR STRING COMPARE IF EQUAL                     37270002
VCK0560  DS    0H                  COMPARE THE ADDR STRINGS             37320002
         L     R2,DBEADRPT         R2= ADDR OF DBE SYMBOL               37370002
         L     R3,PDEADRPT         R3= ADDR OF PDE SYMBOL               37420002
         LH    R4,PDELEN3          R3= LENGTH OF PDE SYMBOL             37470002
         BCTR  R4,N0               DECREMENT R4 FOR EXECUTN OF COMPARE  37520002
         EX    R4,COMPARE          ARE THE TWO SYMBOLS EQUAL            37570002
         BNE   VCK0520             RESTART CSECT SEARCH                 37620002
****     THEY ARE EQUAL BUT BOTH INDIRECT                               37670002
         LH    R2,DBEINDCT         R2= DBE INDIRECT COUNT               37720002
         LH    R3,PDEINDCT         R3= PDE INDIRECT COUNT               37770002
         CR    R2,R3               ARE THE COUNTS THE SAME              37820002
         BNE   VCK0520             NO CONTINUE CSECT SEARCH             37870002
         B     VCK0600             CONTINUE WITH THE EXPRESIONS IF ANY  37920002
         SPACE                                                          37970002
****     BEGIN EVALUATING THE EXPRESSION, THE  NUMERIC ADDR STRING      38020002
****     WILL BE THE FIRST OF THE SUM. TERMINATION IS EITHER A NULL     38070002
****     EXPRESSION OF AN INDIRECT COUNT                                38120002
VCK0580  DS    0H                  START WITH ADDR STRING               38170002
         LH    R2,PDEINDCT         R2= PDE INDIRECT COUNT               38220002
         LTR   R2,R2               DOES AN INDIRECT COUNT EXIST         38270002
         BNZ   VCK0560             COMPARE AS THOUGH NON NUMERIC        38320002
****     PDE INDIRECT COUNT = 0 SO MUST DBE INDIRECT COUNT              38370002
         LH    R2,DBEINDCT         R2=DBE INDIRECT COUNT                38420002
         LTR   R2,R2               IS THE DBE INDIRECT COUNT = 0        38470002
         BNZ   VCK0520             NO THEREFORE CONTINUE CSECT SEARCH   38520002
****     CONVERT BOTH TO BINARY AND ADD TO THE APPROPRIATE SUMS         38570002
         L     R1,PDEADRPT         R1= ADDR OF THE PDE NUMERIC          38620002
         LH    R3,PDELEN3          R3= LENGTH OF THE EXPRESSION         38670002
         BAL   R14,HEXCVT          CONVERT THE NUMBER TO HEX            38720002
         ST    R1,PDESMWRK         PLACE THE VALUE IN PDE SUM           38770002
         L     R1,DBEADRPT         R1= ADDR OF THE DBE NUMERIC          38820002
         LH    R3,DBELEN3          R3= LENGTH OF THE EXPRESSION         38870002
         BAL   R14,HEXCVT          CONVERT THE NUMBER TO HEX            38920002
         ST    R1,DBESMWRK         PLACE THE VALUE IN DBE SUM           38970002
         SPACE                                                          39020002
****     UPON ENTERING BOTH PDE SUM AND DBE SUM CONTAIN EITHER A        39070002
****     PARTIAL SUM OR THE ARE ZERO                                    39120002
****     START BY LOADING THE APPROPRIATE SIGNS FOR USE                 39170002
VCK0600  DS    0H                  GET THE CURRENT SIGN                 39220002
         XR    R2,R2               ZERO REGISTER 2                      39270002
         IC    R2,PDESIGN          R2= SIGN OF FIRST ADDR EXPRESSION    39320002
         L     R1,PDEEXPTR         R1= ADDR OF THE FIRST EXPRESSION     39370002
****     SAVE THE INITIAL INFORMATION FOR THE DBE EXPRESSION EVALUATION 39420002
         MVC   DBEXPWRK(N4),DBEEXPTR SAVE THE ADDR OF FIRST DBE EXP     39470002
         XR    R3,R3               ZERO REGISTER 3                      39520002
         IC    R3,DBESIGN          R3= SIGN OF FIRST DBE EXPRESSION     39570002
         STH   R3,DBESNWRK         SAVE THE SIGN                        39620002
         SPACE                                                          39670002
****     START SUMMING UP THE PDE ADDR EXPRESSIONS                      39720002
VCK0620  DS    0H                  START OF LOOP SUMMING EXPRESSIONS    39770002
         LA    R1,N0(R1)           ZERO THE HIGH ORDER BYTE             39820002
         LTR   R7,R1               IS IT A NULL EXPRESSION POINTER      39870002
         USING EXPRPDE,R7          EST ADDR'ABILITY TO EXPRESSION PDE   39920002
         BZ    VCK0700             THIS EXPRESSION IS THRU              39970002
         L     R1,EXPRPTR           R1= ADDR OF THE NUMBER              40020002
         LH    R3,EXPRLNH           R3= LENGTH OF THE EXPRESSION        40070002
         TM    EXPRFLGS,EXPRHEX    IS THE NUMBER DECIMAL                40120002
         BZ    VCK0640             YES GO TO DECIMAL CONVERSION         40170002
         BAL   R14,HEXCVT          IT IS HEX CONVERT IT FOR SUM         40220002
         B     VCK0660             CONTINUE BY ADDING IN THE VALUE      40270002
VCK0640  DS    0H                  BAL TO THE DECIMAL CONVERSION        40320002
         BAL   R14,DECCVT          CONVERT THE VALUE FROM DECIMAL       40370002
VCK0660  DS    0H                  IS THE NUMBER PLUS OR MINUS          40420002
         CH    R2,PLUSIGN          IS IT A POSITIVE NUMBER              40470002
         BE    VCK0680             YES THEREFORE OK AS IT IS            40520002
         LCR   R1,R1               MUST COMPLEMENT AS IT IS NEGITIVE    40570002
VCK0680  DS    0H                  ADD IN THE CONVERTED VALUE           40620002
         A     R1,PDESMWRK         R1= SUM OF THE VALUES                40670002
         ST    R1,PDESMWRK         PLACE THE SUM IN PDE SUM (PDESMWRK)  40720002
         L     R1,EXPRCHAI         R1= ADDR OF THE NEXT EXPRESSION      40770002
         IC    R2,EXPRSIGN         R2= SIGN OF THE NEW EXPRESSION       40820002
         LH    R3,EXPRINDC         R3= PDE INDIRECT COUNT               40870002
         LTR   R3,R3               IF IT IS ZERO                        40920002
         BZ    VCK0620             CONTINUE WITH PDE EXPRESSIONS        40970002
         STH   R3,PDEIDWRK         SAVE THE INDIRECT COUNT              41020002
         SPACE                                                          41070002
****     THE PDE EXPRESSIONS HAVE BEEN SUMMED UP TO THE FIRST           41120002
****     DELIMITER (AN INDIRECT EXPRESSION, OR A NULL POINTER).         41170002
****     NOW LOOP THRU THE DBE EXPRESSIONS AND SUMM THEM UP             41220002
****     UNTIL A DELIMITER IS REACHED.                                  41270002
VCK0700  DS    0H                  GET THE CURRENT SIGN                 41320002
         LR    R4,R1               SAVE POINTER TO THE NEXT PDE EXP     41370002
         STH   R2,PDESNWRK         SAVE THE CURRENT SIGN LATTER USE     41420002
         L     R1,DBEXPWRK         R1= ADDR OF THE STARTING DBE EXP     41470002
         LH    R2,DBESNWRK         R2= SIGN OF THE STARTING DBE EXP     41520002
         SPACE                                                          41570002
VCK0720  DS    0H                  START OF LOOP SUMMING EXPRESSIONS    41620002
         LA    R1,N0(R1)           ZERO THE HIGH ORDER BYTE             41670002
         LTR   R7,R1               IS IT A NULL EXPRESSION POINTER      41720002
         BZ    VCK0800             THIS EXPRESSION IS THRU              41770002
         L     R1,EXPRPTR          R1= ADDR OF THE NUMBER               41820002
         LH    R3,EXPRLNH          R3= LENGTH OF THE EXPRESSION         41870002
         TM    EXPRFLGS,EXPRHEX    IS THE NUMBER DECIMAL                41920002
         BZ    VCK0740             YES GO TO DECIMAL CONVERSION         41970002
         BAL   R14,HEXCVT          IT IS HEX CONVERT IT FOR SUM         42020002
         B     VCK0760             CONTINUE BY ADDING IN THE VALUE      42070002
VCK0740  DS    0H                  BAL TO THE DECIMAL CONVERSION        42120002
         BAL   R14,DECCVT          CONVERT THE VALUE FROM DECIMAL       42170002
VCK0760  DS    0H                  IS THE NUMBER PLUS OR MINUS          42220002
         CH    R2,PLUSIGN          IS IT A POSITIVE NUMBER              42270002
         BE    VCK0780             YES THEREFORE OK AS IT IS            42320002
         LCR   R1,R1               MUST COMPLEMENT AS IT IS NEGITIVE    42370002
VCK0780  DS    0H                  ADD IN THE CONVERTED VALUE           42420002
         A     R1,DBESMWRK         R1= SUM OF THE VALUES                42470002
         ST    R1,DBESMWRK         PLACE THE SUM IN DBE SUM (DBESMWRK)  42520002
         L     R1,EXPRCHAI         R1= ADDR OF THE NEXT EXPRESSION      42570002
         IC    R2,EXPRSIGN         R2= SIGN OF THE NEW EXPRESSION       42620002
         LH    R3,EXPRINDC         R3= DBE INDIRECT COUNT               42670002
         LTR   R3,R3               IF IT IS ZERO                        42720002
         BZ    VCK0720             CONTINUE WITH DBE EXPRESSIONS        42770002
         STH   R3,DBEIDWRK         SAVE THE INDIRECT COUNT              42820002
         SPACE                                                          42870002
****     THERE NOW EXISTS TWO SUMS PDE SUM (PDESMWRK) AND DBE SUM       42920002
****    (DBESMWRK) ARE THESE SUM THE EQUAL                              42970002
VCK0800  DS    0H                  COMPARE THE SUMS                     43020002
         STH   R2,DBESNWRK         SAVE THE DBE SIGN IN WORKAREA        43070002
         L     R2,PDESMWRK         R2= PDE SUM (PDESMWRK)               43120002
         L     R3,DBESMWRK         R3= DBE SUM (DBESMWRK)               43170002
         CR    R2,R3               ARE THE TWO SUMS THE SAME            43220002
         BNE   VCK0520             RESTART THE CSECT SEARCH             43270002
****     SO FAR THE EXPRESSIONS MATCH CONTINUE                          43320002
****     NOW CHECK IF THE INDIRECT COUNTS MATCH                         43370002
         LH    R2,DBEIDWRK         R2= DBE INDIRECT COUNT               43420002
         LH    R3,PDEIDWRK         R3= PDE INDIRECT COUNT               43470002
         CR    R2,R3               ARE THE TWO INDIRECT COUNTS EQUAL    43520002
         BNE   VCK0520             NO THEREFORE RESTART CSECT SEARCH    43570002
         SPACE                                                          43620002
****     WERE THE INDIRECT COUNTS ZERO OR NON ZERO (THEY ARE EQUAL)     43670002
         LTR   R2,R2               WHAT TERMINATED THE PDE SCAN         43720002
         BNZ   VCK0820             TERMINATED BY AN INDIRECT COUNT      43770002
****     R1= ADDR OF NEXT DBE EXPRESSION, R4= ADDR OF NEXT PDE EXP      43820002
         LA    R1,N0(R1)           CLEAR HIGH ORDER BYTE OF DBE PTR     43870002
         LTR   R1,R1               IS IT A NULL DBE PTR                 43920002
         BNZ   VCK0820             NO CONTINUE EXPRESSION EVALUATION    43970002
         LA    R4,N0(R4)           CLEAR HIGH ORDER BYTE OF PDE PTR     44020002
         LTR   R4,R4               IS IT A NULL PDE PTR ALSO            44070002
         BZ    VCK0840             YES THEREFORE FREE THE CORE          44120002
         SPACE                                                          44170002
****     SAVE THE DBE INFORMATION (PTR AND SIGN) AND RESTART THE PDE    44220002
****     EXPRESSION EVALUATION                                          44270002
VCK0820  DS    0H                  SETUP TO RESTART EXP EVALUATION      44320002
         ST    R1,DBEXPWRK         SAVE THE DBE PTR IN WORKAREA         44370002
         LR    R1,R4               R1= PTR TO NEXT PDE EXPRESSION       44420002
         LH    R2,PDESNWRK         R2= PDE EXPRESSION SIGN              44470002
         XC    DBEIDWRK(N2),DBEIDWRK ZERO DBE INDIRECT COUNT IN WRKAREA 44520002
         XC    PDEIDWRK(N2),PDEIDWRK ZERO PDE INDIRECT COUNT IN WRKAREA 44570002
         B     VCK0620             RESTART THE SEARCH                   44620002
         SPACE                                                          44670002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 44720002
*        UPON ENTRY A MATCH HAS BEEN FOUND BETWEEN THE CURRENT PDE      44770002
*        AND A PDE OF A DEFERED BREAK POINT.                            44820002
*        NEXT SEE IF BOTH ARE A RANGE IF SO THE PROCESS MUST BE         44870002
*        REPEATED. ONCE THEY HAVE BEEN DETERMINED EQUAL THEY MAY BE     44920002
*        FREED. MAKE SURE THAT A NULL DME IS NOT CREATED.               44970002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 45020002
VCK0840  DS    0H                  DOES A SECOND PDE EXIST              45070002
         TM    VCKSWWRK,RANSWWRK   IS RANGE SW ON                       45080002
         BO    VCK0860             YES THEREFORE REMOVE                 45090002
         L     R1,DBECHAIN         R1= ZERO IF A RANGE NOT SPECIFIED    45120002
         LA    R1,N0(R1)           ZERO HIGH ORDER BYTE                 45170002
         LTR   R1,R1               DOES THE DBE PDE HAVE A SECOND HALF  45220002
         BZ    VCK0850             NO THEREFORE CK ORIGINAL PDE         45270002
****     THE DBE PDE WAS A RANGE WAS THE ORIGINAL PDE ALSO  A RANGE     45320002
         L     R1,PDECHAIN         R1= ZERO IF A RANGE NOT SPECIFIED    45370002
         LA    R1,N0(R1)           ZERO HIGH ORDER BYTE                 45420002
         LTR   R1,R1               DOES THE INPUT PDE HAVE SECOND HALF  45470002
         BZ    VCK0520             NO RESTART THE CSECT SEARCH          45520002
****     SAVE THE INITIAL INFORMATION FOR THE DBE EXPRESSION EVALUATION 45570002
         MVC   DBEXPWRK(N4),DBEEXPTR SAVE THE ADDR OF FIRST DBE EXP     45620002
         XR    R3,R3               ZERO REGISTER 3                      45670002
         IC    R3,DBESIGN          R3= SIGN OF CURRENT DBE EXPRESSION   45720002
         STH   R3,DBESNWRK         SAVE THE SIGN                        45770002
****     SETUP ADDRESSABILITY TO THE SECOND HALF OF THE RESPECTIVE      45820002
****     DBE AND INPUT PDE'S...                                         45870002
         LA    R6,PDECHAIN         R6= ADDR OF SECOND HALF OF INPUT PDE 45920002
         LA    R5,DBECHAIN         R5= ADDR OF SECOND HALF OF DBE PDE   45970002
****     GET BOTH LOADNAMES AND COMPARE THEM                            46020002
         LA    R2,DMELOAD          R2= ADDR OF LOADNAME FROM DME        46070002
         L     R3,PDELDNAM         R3= ADDR OF THE PDE LOADNMAE         46120002
         LH    R4,PDELEN1          R4= LENGTH OF THE PDE LOAD NAME      46170002
         BCTR  R4,N0               DECREMENT R4 FOR EXECUTN OF COMPARE  46220002
         EX    R4,COMPARE          EXECUTE A COMPARE OF THE LOADNAMES   46270002
         BNE   VCK0520             LOADNAMES DO NOT AGREE RESTART CSECT 46320002
****                               SEARCH WITH NEXT DBE                 46370002
****     GET BOTH CSECT NAMES AND COMPARE THEM                          46420002
         L     R2,DBECTNAM         R2= ADDR OF CSECT NAME FROM DME PDE  46470002
         L     R3,PDECTNAM         R3= ADDR OF INPUT PDE CSECT NAME     46520002
         LH    R4,PDELEN1          R4= LENGTH OF INPUT PDE CSECT NAME   46570002
         BCTR  R4,N0               DECREMENT R4 FOR EXECUTN OF COMPARE  46620002
         EX    R4,COMPARE          EXECUTE A COMPARE OF THE LOADNAMES   46670002
         BNE   VCK0520             CSECTNAME DO NOT AGREE RESTART CSECT 46720002
****                               SEARCH WITH NEXT DBE                 46770002
         OI    VCKSWWRK,RANSWWRK   TURN ON THE RANGE INDICATOR          46780002
         B     VCK0545             CHECK IF THE SECOND HALF PDE'S EQUAL 46820002
         DROP  R7                  RELEASE ADDR'ABILITY TO EXP DSECT    46870002
         SPACE                                                          46920002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 46970002
*        THE GENERAL COMPARE INSTRUCTION WHICH IS EXECUTED IN THE       47020002
*        SEARCH FOR MATCH PDE'S AND DEFERED BREAK ELEMENTS.             47070002
*        R4 = LENGTH OF FIRST CHARACTER STRING (R3).                    47120002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 47170002
COMPARE  CLC   N0(N0,R3),N0(R2)    COMPARE THE STRINGS (R3 TO R2)       47220002
         SPACE                                                          47270002
VCK0850  DS    0H                  CHECK IF DE IS A RANGE               47272002
****     THE DBE PDE WAS NOT A RANGE WAS THE ORIGINAL PDE  A RANGE      47274002
         L     R1,PDECHAIN         R1= ZERO IF A RANGE NOT SPECIFIED    47276002
         LA    R1,N0(R1)           ZERO HIGH ORDER BYTE                 47278002
         LTR   R1,R1               DOES THE INPUT PDE HAVE SECOND HALF  47278402
         BNZ   VCK0520             YES RESTART THE CSECT SEARCH         47278802
         SPACE                                                          47280002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   47320002
*        WE NOW HAVE COMPLETELY VARIFIED THAT THE TWO PDE'S (INPUT      47370002
*        AND DBE'S) MATCH, THEREFORE WE CAN NOW DELETE THE DBE,         47420002
*        THE PDE, THE INBUF, AND THE DME IF THIS WAS ITS ONLY DBE       47470002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   47520002
         SPACE                                                          47570002
VCK0860  DS    0H                  RELEASE THE DEFERED CORE             47620002
         L     R5,DBEPDWRK         R5= START OF CURRENT DBE-PDE         47630002
         OI    CHNGSWRK,VCKRMWRK+REMOVWRK  SET REMOVE SW         YM2245 47640002
         MVI   DBEFLG5,PDEYECH     TURN ON USELESS INDICATOR            47650002
         USING DBE,R7              RE-ESTABLISH ADDR'ABILITY TO THE DBE 47660002
         L     R7,DBESVWRK         R7= ADDR OF THE DBE TO BE FREED      47662002
****     START AT TOP OF DBE-PDE'S FOR USELESS CHECK (R5= ADDR'ABILITY) 47664002
         L     R5,DBEPDL           R5= ADDR OF THE FIRST PDE 0F DBE     47666002
         LA    R5,N8(R5)           R5= ADDR OF THE DBE-PDE BODY         47668002
****     MAKE SURE ALL OF THE DBE-PDE'S ARE USELESS IF SO FREE THE CORE 47668402
VCK0870  DS    0H                  SEARCH ALL DBE-PDE'S FOR USELESS     47668802
         TM    DBEFLG5,PDEYECH     IS THE USELESS BTI ON                47669202
         BZ    VCK0520             NO THEREFORE CONTINUE THE SEARCH     47669602
         L     R5,DBE2CHAI         R5= ADDR OF THE NEXT DBE-PDE         47669702
         LA    R5,N0(R5)           ZERO HIGH ORDER BYTE                 47669802
         LTR   R5,R5               IS THERE ANOTHER DBE-PDE             47669902
         BNZ   VCK0870             YES THRERFORE CONTINUE CHECK         47686602
         USING DBE,R7              RE-ESTABLISH ADDR'ABILITY TO THE DBE 47703302
         L     R7,DBESVWRK         R7= ADDR OF THE DBE TO BE FREED      47720002
         OI    CHNGSWRK,VCKRMWRK+REMOVWRK SET SW INDICATE BREAKPT REMOV 47770002
****     RELEASE THE PARSE PDL                                          47820002
         IKJRLSA DBEPDL            RELEASE THE PDL                      47870002
****     FREE THE INPUT BUFFER POINTED TO IN THE DBE                    47920002
         L     R1,DBEINBUF         R1= ADDR OF THE INBUF                47970002
         LH    R3,N0(R1)           R3= LENGTH OF THE BUFFER             48020002
         FREEMAIN RC,LV=(3),A=(1),SP=1 FREE INBUF                       48070002
****     ISSUE FREEMAIN TO FREE THE DBE                                 48072002
         LTR   R15,R15             DID ERROR OCCUR IN FREEMAIN          48080002
         BZ    VCK0775              ZERO IMPLIES NO ERROR               48090002
         LA    R2,N120             SET SVC NUMBER                       48100002
         SR    R1,R1               INDICATE THAT THERE IS NO ABEND CODE 48110002
         BAL   R14,SVCERR          GO PUT OUT ERROR MSG                 48112002
VCK0775  DS    0H                                                       48162002
         LR    R1,R7               R1= ADDR OF DBE TO BE FREED          48170002
         L     R2,DBEDBE           R7= ADDR OF NEXT DBE IF ANY          48220002
         FREEMAIN RC,LV=12,A=(1),SP=1  ISSUE FREEMAIN OF DBE            48270002
****     R2= NEXT DBE, AND DBEBKWRK=PREVIOUS DBE OR ZERO (NO PREVIOUS)  48320002
         LTR   R15,R15             DID ERROR OCCUR IN FREEMAIN          48330002
         BZ    VCK0778              ZERO IMPLIES NO ERROR               48340002
         LA    R2,N120             SET SVC NUMBER                       48350002
         SR    R1,R1               INDICATE THAT THERE IS NO ABEND CODE 48360002
         BAL   R14,SVCERR          GO PUT OUT ERROR MSG                 48362002
VCK0778  DS    0H                                                       48364002
         L     R7,DBEBKWRK         R7= ADDR OF PREVIOUS DBE             48370002
         LA    R7,N0(R7)           ZERO HIGH ORDER BYTE                 48420002
         LTR   R7,R7               IF ZERO FIRST DBE OF CHAIN           48470002
         BNZ   VCK0900             THERE ARE ADITIONAL DBE ELEMENTS     48520002
         LA    R2,N0(R2)           ZERO HIGH ORDER BYTE OF NEXT DBE PTR 48570002
         LTR   R7,R2               IF ZERO THERE IS NO NEXT DBE         48620002
         BNZ   VCK0880             NO THEREFORE PLACE ADDR IN DME       48670002
****     NO DBE ARE HANGING OFF THE DME SO FREE THE DME                 48720002
         LA    R1,N0(R8)           R1= ADDR OF THE DME TO BE FREED      48770002
         L     R3,DMEDME           R3= ADDR OF THE NEXT DME OR ZERO     48820002
         L     R2,DMEBKWRK         R2= ADDR OF DME POINTER OR DEFERTAB  48870002
         ST    R3,N0(R2)           LINK AROUND THE DME TO BE FREED      48920002
         FREEMAIN RC,LV=16,A=(1),SP=1  FREE THE DME...                  48970002
         LTR   R15,R15             DID ERROR OCCUR IN FREEMAIN          48980002
         BZ    VCK0920              ZERO IMPLIES NO ERROR        YM4849 48990002
         LA    R2,N120             SET SVC NUMBER                       49000002
         SR    R1,R1               INDICATE THAT THERE IS NO ABEND CODE 49010002
         BAL   R14,SVCERR          GO PUT OUT ERROR MSG                 49012002
         B     VCK0920             ALL THRU WITH THIS ELEMENT ANY MORE  49020002
         SPACE                                                          49070002
****     PLACE THE ADDR OF THE NEXT DBE INTO THE DME                    49120002
VCK0880  DS    0H                  LINK IN THE DBE TO THE DME           49170002
         ST    R2,DMEDBE           DME PTS TO A DBE CHAIN               49220002
         B     VCK0460             ALL THRU WITH THIS ELEMENT ANY MORE  49270002
         SPACE                                                          49320002
****     JUST LINK AROUND THE REMOVED DBE                               49370002
****     ADDR'ABILITY CURRENTY IS TO THE PREVIOUS DBE                   49420002
VCK0900  DS    0H                  R2= ADDR OF DBE TO BE LINKED IN      49470002
         ST    R2,DBEDBE           RELINK THE DBE CHAIN                 49520002
         LR    R7,R2               R7= ADDR OF DBE TO RESTART SEARCH    49530002
         B     VCK0460             ALL THRU WITH THIS ELEMENT ANY MORE  49570002
         SPACE                                                          49620002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   49670002
*        THE PROCESSING IS NOW COMPLETE CHECK IF ANY BREAK POINTS       49720002
*        WERE REMOVED. THEN RETURN TO PARSE WITH THE RESPECTIVE         49770002
*        RETURN CODE.                                                   49820002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   49870002
VCK0920  DS    0H                  THE EXIT PORTION OF VALIDITY CHECK   49920002
         TM    CHNGSWRK,VCKRMWRK   WERE ANY BREAKPOINTS REMOVED         49970002
         BO    VCK0940             YES RETURN WITH A ZERO RET CODE      50020002
         LA    R15,N2              INDICATE TO USE 2ND IO MACRO         50030002
         LR    R2,R6               R2= ADDR OF ADDR PDE (INSERT MSG)    50070002
         LA    R1,MSGIVBRK         SETUP MSG ID                         50120002
         BAL   R14,PUTMSG          SEND THE MESSAGE TO THE TERMINAL     50170002
VCK0930  DS    0H                  PARSE RE-ENTER ROUTINE               50180002
****     NOTE THAT REGISTER 2 CONTAINS ANY SECOND LEVEL OR ZERO         50190002
         LA    R15,N8              R15= 8, REENTER RETURN CODE          50220002
VCK0935  DS    0H                  RETURN TO PARSE WITH THE PARM BLOCK  50222002
         L     R1,PARETWRK         R1= ADDR OF PARSE PARM BLOCK         50230002
         L     R14,OUTBUF          GET OF POSSIBLE 2ND LEVEL MSG        50232002
         LH    R2,N0(R14)          GET POSSIBLE MESSAGE LENGTH          50234002
         LTR   R2,R2               DOES 2ND LEVEL EXIST                 50236002
         BZ    VCK0960             NO - RETURN TO PARS                  50238002
         ST    R14,N8(N0,R1)       SET PARS PTR TO 2ND LEVEL MESSAGE    50238402
         B     VCK0960             RETURN TO PARSE                      50270002
VCK0940  DS    0H                  SET RETURN CODE TO ZERO              50320002
         XR    R15,R15             R15= ZERO                            50370002
VCK0960  DS    0H                  RETURN TO PARSE                      50420002
         L     R13,N4(R13)         R13=ADDR OF CALLERS SAVE AREA        50470002
         NI    VCKSWWRK,HEXFF-VCKONWRK TURN OFF VALIDITY CK SW          50480002
         NI    TSTFLGS4,HEXFF-TSTVALCK TURN OFF VALIDITY CHECK INDIC    50490002
         RETURN (14,12),,RC=(15)   THE END (VALIDITY CHECK)             50520002
         DROP  R5                  RELEASE ADDR'ABILITY TO DBE'S PDE    50570002
         DROP  R6                  RELEASE ADDR'ABILITY TO THE PDE      50620002
         DROP  R7                  RELEASE ADDR'ABILITY TO THE DBE'S    50670002
         DROP  R8                  RELEASE ADDR'ABILITY TO THE DME'S    50720002
         EJECT                                                          50770002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     50820002
*        THIS ROUTINE OUTPUTS ALL ERROR MESSAGES                        50870002
*        INPUT IS REGISTER 1, POINTS TO 2 WORD MESSAGE POINTER, AND     50920002
*        REGISTER 2 WHICH POINTS TO ADDR PDE IF ANY, (OR ZERO)          50970002
*        REGISTERS USED 1 THROUGH 5                                     51020002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     51070002
         SPACE                                                          51120002
PUTMSG   DS    0H                  THE GENERAL ERROR MSG HANDLER        51170002
         ST    R14,PUTREWRK        SAVE THE RETURN ADDR OF CALLER       51220002
****     FIRST SETUP  SECOND LEVEL POINTER**************                51270002
         L     R3,N4(R1)           GET SECOND LEVEL MSG ID              51280002
         L     R4,N0(R1)           GET FIRST LEVEL MSG ID               51290002
         XC    TSTOIPRM(L'TSTOIPRM),TSTOIPRM  CLEAR MSG AREA            51370002
         SLL   R15,N2              MULTIPLY CODE BY 4                   51370402
         B     CHOICE(R15)         BRANCH TO APPROPRIATE IO MACRO       51372002
CHOICE   B     CHOICE1             R15 = 0                              51374002
         B     CHOICE1             R15 = 1                              51376002
         B     CHOICE2             R15 = 2                              51378002
         B     CHOICE3             R15 = 3                              51378402
CHOICE1  DS    0H                 MESSAGE WITH NO INSERTS               51392002
         IKJEGSIO MSG,FIRST=(R4),SECOND=(R3),ID=OFF23,MF=(E,TSTOIPRM)   51400002
CHKIORC  SR    R1,R1              WAS IO SUCCESSFUL                     51402002
         LA    R1,N12             PUT DEC 12 IN R1                      51402402
         CR    R15,R1             WAS IO SUCCESSFUL                     51404002
         BNH   SETRC              YES, CONTINUE                         51410002
         B     VCK0960            RET TO CALLER (PARSE) WITH IO RET CD  51412002
SETRC    L     R14,PUTREWRK       PREPARE TO RET TO PARSE WITH APPR CD  51414002
         BR    R14                 RETURN                               51416002
         SPACE                                                          51420002
CHOICE2  DS    0H                  MESSAGES WITH PDE INSERTS            51430002
         IKJEGSIO MSG,FIRST=(R4),INST11=(APDE,(R2)),                   *51440002
               SECOND=(R3),ID=OFF23,MF=(E,TSTOIPRM)                     51442002
         B     CHKIORC   GO DETERMINE PROPER RETCODE AND RETURN         51444002
         SPACE                                                          51444402
CHOICE3  DS    0H                  MESSAGES WITH INSERT FROM MSG CSECT  51446002
         IKJEGSIO MSG,FIRST=(R4),INST11=(NUM,(R2)),                    *51448002
               SECOND=(R3),ID=OFF23,MF=(E,TSTOIPRM)                     51448402
         B     CHKIORC   GO DETERMINE PROPER RETCODE AND RETURN         51448802
         SPACE                                                          51450002
         SPACE                                                          52110002
         EJECT                                                          53070002
SVCERR   ST    R14,PUTREWRK      SAVE RETURN ADDRESS                    53072002
         LR    R3,R1              SET ABEND CODE FOR ABENDREG           53072402
         LR    R4,R15             SET RETURN CODE                       53074002
         XC    TSTOIPRM(L'TSTOIPRM),TSTOIPRM                            53076002
         LTR   R1,R1              ARE WE COMMING FROM ESTAE             53076402
         ST    R2,REGSVWRK        PRESERVE REGISTER 2                   53076502
         BNZ   SVCLINK            NO                                    53076802
         IKJEGSIO SVCERR,SVC=(R2),ID=OFF23,MF=(E,TSTOIPRM)              53078002
         L     R2,REGSVWRK        RESTORE REGISTER 2                    53078402
         B     CHKIORC            GO RETURN WITH APPROPRIATE RC         53078802
SVCLINK  IKJEGSIO SVCERR,SVC=(R2),ABENDRG=(R3),MF=(E,TSTOIPRM),        *53079202
               ID=OFF23,INST11=(NUM,I0033)                              53079302
         L     R2,REGSVWRK        RESTORE REGISTER 2                    53081302
         B     CHKIORC            GO RETURN WITH APPROPRIATE RC         53081602
MSGFPREG DC    F'101'               INVALID ADDRESS                     53086302
         DC    F'274'               REG NOTATN MUST BE IND GEN REG      53088602
MSGPRS0C DC    F'104'               OFF FAILED                          53090902
         DC    F'277'               PARSE ERROR CODE 12                 53093202
MSGPRS10 DC    F'103'               NOT ENOUGH STORAGE TO EXECUTE CMD   53103202
         DC    F'000'                                                   53105202
MSGNOQUE DC    F'101'               INVALID ADDRESS                     53105602
         DC    F'205'               BREAKPOINT QUEUES EMPTY             53106002
MSGNOBRK DC    F'9'                 NO BRKPTS FOUND ON ACT OR DEF QUE   53106102
         DC    F'000'               THERE IS NO 2ND LEVEL MSG           53106202
MSGIVPDE DC    F'101'               INVALID ADDRESS                     53106402
         DC    F'208'               INVALID PDE OBTAINED FROM PARSE     53106502
MSGIVADR DC    F'101'               INVALID ADDRESS                     53117002
         DC    F'204'               UNABLE TO CONVERT ADDR TO BINARY    53127002
MSGIVRNG DC    F'073'               INVALID RANGE              @YM07108 53127902
         DC    F'207'               1ST ADDR OF RNG MUST NOT BE > LAST  53131402
MSGIVBRK DC    F'8'                 INVALID BREAKPT ADDR                53135002
         DC    F'206'               UNABLE TO LOCATE BREAKPT            53138502
         EJECT                                                          53149002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     53159502
*        THIS ROUTINE CONVERTS HEXIDECIMAL INPUT TO BINARY FORM         53170002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     53220002
         SPACE                                                          53270002
HEXCVT   DS    0H                  CONVERT THE VALUE TO BINARY          53320002
         SPACE                                                          53370002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   53420002
*        R1 = THE ADDRESS OF THE EXPRESSION TO BE CONVERTED             53470002
*        R3 = THE LENGTH OF THE EXPRESSION                              53520002
*        REGISTERS USED ARE 1,2,3. ONLY REGISTER 2 IS SAVED.....        53530002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   53570002
         SPACE                                                          53620002
         ST    R2,REGSVWRK         SAVE THE CURRENT VALUE OF R2         53630002
         STH   R3,TEMCTWRK         SAVE THE COUNT FOR LATTER USE        53670002
         BCTR  R3,N0               DECREMENT R3 FOR EXECUTION OF MOVE   53720002
         EX    R3,MOVEHEX          PLACE THE STRING IN THE WORKAREA     53770002
         LR    R1,R3               R1= LENGTH TO BE CONVERTED           53780002
         XR    R3,R3               ZERO REGISTER THREE                  53820002
         XR    R2,R2               ZERO REGISTER 0                      53870002
HEX0020  DS    0H                  START OF LOOP OF CONVERSION          53920002
         IC    R2,CONVTWRK(R1)     R2= RIGHT HAND CHARACTER OF STRING   53970002
         CH    R2,HEXCVTC7         IS THE CHARACTER A THRU F            54020002
         BH    HEX0040             NO THEREFORE NEED LOWER HALF BYTE    54070002
         LA    R2,HEX09(R2)        INCREMENT LOWER HALF BYTE            54120002
HEX0040  DS    0H                  R1 = PORTION OF CONVERTED NUMBER     54170002
         SRDL  R2,N4               PLACE NUMERIC PORTION INTO R3        54220002
         BCTR  R1,N0               DECREMENT R1 FOR LOOPING             54270002
         LTR   R1,R1               IS THERE MORE OF THE STRING          54320002
         BNM   HEX0020             YES CONTINUE UNTIL STRING EMPTY      54370002
         LH    R2,TEMCTWRK         R2= ORIGINAL LENGTH OF LIST          54420002
         SLL   R2,N2               MULTIPLY LENGTH BY FOUR              54470002
         LA    R1,N32              R1= NUMERIC 32 (DECIMAL)             54520002
         SR    R1,R2               R1= 32-(LENGTH*4)                    54570002
         SRL   R3,N0(R1)           R3= CONVERTED NUMBER IN LOWER HALF   54620002
         LR    R1,R3               R1= VALUE OF CONVERT HEX NUMBER      54630002
         L     R2,REGSVWRK         RESTORE THE VALUE OF R2              54640002
         BR    R14                 RETURN TO THE CALLER                 54670002
MOVEHEX  MVC   CONVTWRK(N0),N0(R1) MOVE STRING TO WORKAREA              54720002
         EJECT                                                          54770002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     54820002
*        THIS ROUTINE CONVERTS DECIMAL INPUT TO BINARY FORM             54870002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *     54920002
         SPACE                                                          54970002
DECCVT   DS    0H                  CONVERT THE VALUE TO BINARY          55020002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   55070002
*        R1 = THE ADDRESS OF THE EXPRESSION TO BE CONVERTED             55120002
*        R3 = THE LENGTH OF THE EXPRESSION                              55170002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   55220002
         SPACE                                                          55270002
         BCTR  R3,N0               DECREMENT R3 FOR EXECUTION OF PACK   55320002
         EX    R3,DECPACK          PACK THE EXPRESSION                  55370002
         CVB   R1,CONVTWRK         R1= EXPRESSION CONVERTED TO BINARY   55420002
         BR    R14                 RETURN TO THE CALLER                 55470002
DECPACK  PACK  CONVTWRK(N8),N0(N0,R1) PACK INTO THE WORKAREA            55520002
         EJECT                                                          55570002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 55620002
*        THE STAE MACRO, RETRY ROUTINE, AND ABEND TABLE                 55670002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   55720002
STAELIST ESTAE MF=L                LIST FORM OF ESTAE MACRO             55730002
STAELN   EQU   *-STAELIST          END OF STAE EXPANSION                55820002
ABENDTAB DS    0H                  THE ABEND TABLE FOR STAE             55920002
         DC    X'63'               CORRECT MESSAGE POINTER              56070002
         DC    AL3(SMTPARS)        EXPAND                               56120002
         DC    X'FF'               END OF TABLE INDICATOR               56170002
****     THE BEGINING OF THE RETRY ROUTINE                              56220002
RETRYRTN DS    0H                  THE RETRY ROUTINE                    56270002
         L     R5,CVTPTR           R5= ADDR OF THE CVT                  56320002
         USING CVT,R5              ESTABLISH ADDR'ABILITY TO THE CVT    56370002
         L     R1,CVTTCBP          R1= ADDR OF NEW CURRENT TCB'S        56420002
         L     R5,N4(,R1)          R5= ADDR OF CURRENT TCB (TEST TCB)   56470002
         DROP  R5                  RELEASE ADDR'ABILITY TO THE CVT      56520002
         USING TCB,R5              ESTABLISH ADDR'ABILITY TO THE TCB    56570002
         L     R9,TCBTRN           R9= ADDR OF TCOMTAB (RESTORE)        56620002
         DROP  R5                  RELEASE ADDR'ABILITY TO TCB          56670002
****     REESTABLISH ADDRESSABILITY TO OFF WORKAREA                     56720002
         L     R8,WORKAREA         R8= ADDR OF GENERAL WORKAREA         56770002
         USING TSTCWORK,R8         ADDR'ABILITY TO TSTCWORK             56820002
         LA    R10,CWORKCMD        R10= ADDRESS OF OFF'S WORKAREA       56870002
         DROP  R8                  RELEASE ADDRABILITY                  56880002
         USING OFFWORKA,R10        COMPLETE ADDRABILITY                 56890002
         TM    VCKSWWRK,VCKONWRK   CURRENTLY IN VALIDITY CHECK          56900002
         BO    STA0000             WE ARE IN VALIDITY CHECK ROUTINE     56910002
         L     R13,REGSAVE2        R13= ADDR OF REGULAR SAVEAREA        56912002
         B     STA0020             CONTINUE STAE PROCESSING             56914002
STA0000  DS    0H                  IN VALIDITY CHECK                    56916002
         L     R13,REGSAVE3        R13= ADDR OF VALIDITY CHECK SAVEAREA 56918002
STA0020  DS    0H                  CONTINUE RESTORING INSTRUCTION       56918402
         LM    R14,R12,N12(R13)    RESTORE ALL REGISTERS FOR OFF        56919202
         SPACE                                                          56970002
****     CHECK IF WE ARE CURRENTLY IN THE VALIDITY CHECK ROUTINE        57320002
         LA    R15,N20             R15= DEC 20 (RETURN CODE)            57330002
         TM    VCKSWWRK,VCKONWRK   CURRENTLY IN VALIDITY CHECK          57370002
         NI    TSTFLGS4,HEXFF-TSTRERTN TURN OFF RETRY INDICATOR         57380002
         BO    VCK0120             RETURN TO PARSE WITH 12              57420002
         B     OFF0320             RETURN TO CALLER (MAINLINE)          57520002
ADDRETRY DC    A(RETRYRTN)         ADDRESS OF RETRY ROUTINE             57522002
LIST     IKJEGSPL RTRY=RETRYRTN,ABNTB=ABENDTAB,MODNM=IKJEGOFF,TNM=OFF   57530002
         EJECT                                                          57570002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 57620002
*          CONSTANTS USED BY THE OFF COMMAND                            57670002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   57720002
         DS    0F                  ALIGNMENT                            57770002
TWELVE   DC    F'12'              CONSTANT USED TO CHECK RETURN CODES   57780002
MASKF8   DC    X'00FFFFF8'         MASK TO ZERO TOP BYTE LOWER 3 BITS   57820002
ZEROS    DC    X'00000000'         FULL WORD OF ZEROS                   57870002
SUBPOOL1 DC    X'01000000'         SUBPOOL ONE                          57920002
HEXCVTC7 DC    X'00C7'             FIRST HEX ALPHA NOT ACCEPTABLE       57970002
PLUSIGN  DC    X'004E'             PLUS SIGN                            58020002
TEXTPLUS EQU   C'+'                PLUS SIGN FOR THE ERROR MESSAGES     58070002
DCBOFLGS EQU   X'30'               DISPLACEMENT IN TSTSYMWK TO DCB ADDR 58120002
SUPERZAP DC    50CL1'Z'            PATCH AREA                           58130002
         SPACE 2                                                        58170002
****     PCL   ADDRESS VCON                                             58820002
PCLADDR  DC    V(IKJEGPCL)         ADDRESS OF THE PCL CSECT             58870002
         EJECT                                                          58920002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   58970002
*        PARSE PARMETER CONTROL LIST                                    59020002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   59070002
IKJEGPCL IKJPARM                                                        59120002
GETADDR  IKJPOSIT ADDRESS,LIST,RANGE,VALIDCK=IKJEGVCK                   59170002
         IKJENDP                                                        59220002
         EJECT                                                          59270002
         EJECT                                                          66220002
************************************************************            66270002
**                                                        **            66320002
**                  TCOMTAB DSECT                         **            66370002
**                                                        **            66420002
************************************************************            66470002
TCOMTAB TCOMTAB                                                         66520002
         EJECT                                                          66570002
************************************************************            66620002
**                                                        **            66670002
**                TCB DSECT                               **            66720002
**                                                        **            66770002
************************************************************            66820002
          IKJTCB                                                        66870002
************************************************************            66920002
**                                                        **            66970002
**             CVT DSECT MACRO EXPANSION                  **            67020002
**                                                        **            67070002
************************************************************            67120002
CVT      DSECT                                                          67170002
         CVT                                                            67220002
         EJECT                                                          67270002
************************************************************            67320002
**                                                        **            67370002
**                  RB DSECT                              **            67420002
**                                                        **            67470002
************************************************************            67520002
         SPACE                                                          67570002
         IKJRB               REQUEST BLOCK DSECT                        67620002
         EJECT                                                          67670002
         IKJEGDME            DEFERED BREAKELEMENT                       67720002
         SPACE                                                          67770002
         IKJEGDBE            DEFERED MODULE ELEMENT                     67820002
         EJECT                                                          67870002
************************************************************            67920002
**                                                        **            67970002
**                     BREAKPOINT QUEUE DSECT             **            68020002
**                                                        **            68070002
************************************************************            68120002
         BRKELEM                                                        68170002
         EJECT                                                          68220002
************************************************************            68270002
**                                                        **            68320002
**             DSECT DESCRIBING  PARSE ADDR*SS PDE        **            68370002
**                                                        **            68420002
************************************************************            68470002
         IKJPARMA                                                       68520002
         EJECT                                                          68570002
************************************************************            68620002
**                                                        **            68670002
**                           WORKAREA DSECT               **            68720002
**                                                        **            68770002
************************************************************            68820002
OFFWORKA DSECT                     DSECT TO ADDRESS OFF'S WORKAREA      68870002
STAEWRK  DS    3F                  STAE EXPANSION AREA                  68920002
PPLWRK   DS    7F                  PARSE'S PPL EXPANSION AREA           68970002
REG14WRK DS    1F                  TEMPORARY SAVE AREA FOR REG 14       69020002
RETCDWRK DS    A                   RETURN CODE SAVE AREA                69070002
DBEPDWRK DS    A                   SAVE AREA FOR DBE-PDE ADDRESS        69130002
PARETWRK DS    A                   VALIDITY CK RETURN CD                69170002
DBESVWRK DS    A                   VALIDITY CK CSECT SEARCH RESUME ADDR 69220002
DBESMWRK DS    1F                  DBE SUM OF THE EXPRESSION VALUES     69270002
PDESMWRK DS    1F                  PDE SUM OF THE EXPRESSION VALUES     69320002
DBESNWRK DS    H                   DBE SIGN OF NEXT EXPRESSION          69370002
PDESNWRK DS    H                   PDE SIGN OF NEXT EXPRESSION          69420002
DBEXPWRK DS    A                   DBE RESUME EXPRESSION POINTER        69470002
DMEBKWRK DS    A                   PREVIOUS DME ENCOUNTERED IN SEARCH   69520002
DBEBKWRK DS    A                   PREVIOUS DBE ENCOUNTERED IN SEARCH   69570002
DBEIDWRK DS    H                   DBE INDIRECT COUNT                   69620002
PDEIDWRK DS    H                   PDE INDIRECT COUNT                   69670002
CHNGSWRK DS    1X                  SWITCH INDICATES WHAT'S BEEN REMOVED 69720002
VCKRMWRK EQU   X'08'               SW TO VALIDITY CK INDICATING REMOVAL 69770002
REMOVWRK EQU   X'02'               SW TO MAIN RTN INDICATING REMOVAL    69820002
VCKSWWRK DS    1X                  SW INDICATING IN VALIDITY ROUTINE    69830002
RANSWWRK EQU   X'04'               INDICATES RANGE IN PROCESS           69840002
VCKONWRK EQU   X'08'               SW IS ON AT PRESENT                  69880002
TEMCTWRK DS    2X                  TEMPORARY COUNT FOR HEXCVT           69920002
CONVTWRK DS    D                   DOUBLE WORD USED BY CONVERSION RTN'S 69970002
DCBARWRK DS    F                   TEMPORARY AREA FOR DCB ADDRESS       70020002
PUTREWRK DS    F                   PUT MESSAGE RETURN REGISTER          70070002
SRHAWRK  DS    0F                  PARAMETER AREA FOR SEARCH ROUTINE    70080002
SRH1WRK  DS    1F                  FIRST WORD FOR FLAGS                 70090002
SRH2WRK  DS    1F                  SECOND WORD FOR BEGINNING ADDRESS    70100002
SRH3WRK  DS    1F                  THIRD WORD FOR ENDING ADDR (OR ZERO) 70110002
REGSVWRK DS    1F                  TEMP SAVE AREA FOR A REGISTER        70160002
         EJECT                                                          70170002
         IKJPPL               PARSE PARAMETER LIST DSECT                70220002
         EJECT                                                          70270002
         TSTCWORK             TEST WORKAREA DSECT                       70320002
         EJECT                                                          70370002
************************************************************            70420002
**         DEFER QUEUE  PDE                               **            70470002
************************************************************            70520002
DBEPDECT DSECT                     DSECT USED TO ADDR PDE ON DEFERRED Q 70570002
*                                                                       70620002
DBELDNAM DS    A                   POINTER TO LOADNAME                  70670002
DBELEN1  DS    H                   LENGTH OF LOADNAME                   70720002
DBEFLG1  DS    X                   FLAG FOR LOADNAME                    70770002
DBERSV1  DS    X                   NOT USED                             70820002
DBECTNAM DS    A                   POINTER TO ENTRYNAME                 70870002
DBELEN2  DS    H                   LENGTH OF ENTRYNAME                  70920002
DBEFLG2  DS    X                   FLAG FOR ENTRY NAME                  70970002
DBERSV2  DS    X                   NOT USED                             71020002
DBEADRPT DS    A                   POINTER TO THE ADDRESS STRING        71070002
DBELEN3  DS    H                   LENGTH OF ADDRESS STRING             71120002
DBEFLG3  DS    X                   FLAG FOR THE ADDRESS STRING          71170002
DBERSV3  DS    X                   NOT USED                             71220002
DBEFLG4  DS    X                   ADDRESS TYPE FLAG                    71270002
DBESIGN  DS    C                   EXPRESSION SIGN                      71320002
DBEINDCT DS    H                   INDIRECT COUNT                       71370002
DBEEXPTR DS    A                   POINTER TO FIRST EXPRESSION PDE      71420002
DBEFLG5  DS    0X                  FLAG BYTE PDEUSER WORD               71470002
DBEUSER  DS    A                   RESOLVED ADDR OR SIB POINTER         71520002
DBECHAIN DS    A                   CHAIN POINTER FOR ADDR LIST          71570002
         ORG   DBECHAIN            RANGE                                71580002
DBE2LDNA DS    A                   POINTER TO LOADNAME                  71590002
DBE2LEN1 DS    H                   LENGTH OF LOADNAME                   71600002
DBE2FLG1 DS    X                   FLAG FOR LOADNAME                    71610002
DBE2RSV1 DS    X                   NOT USED                             71612002
DBE2CTNA DS    A                   POINTER TO ENTRYNAME                 71614002
DBE2LEN2 DS    H                   LENGTH OF ENTRYNAME                  71616002
DBE2FLG2 DS    X                   FLAG FOR ENTRY NAME                  71618002
DBE2RSV2 DS    X                   NOT USED                             71618402
DBE2ADRP DS    A                   POINTER TO THE ADDRESS STRING        71618802
DBE2LEN3 DS    H                   LENGTH OF ADDRESS STRING             71619202
DBE2FLG3 DS    X                   FLAG FOR THE ADDRESS STRING          71619602
DBE2RSV3 DS    X                   NOT USED                             71619702
DBE2FLG4 DS    X                   ADDRESS TYPE FLAG                    71619802
DBE2SIGN DS    C                   EXPRESSION SIGN                      71619902
DBE2INDC DS    H                   INDIRECT COUNT                       71636602
DBE2EXPT DS    A                   POINTER TO FIRST EXPRESSION PDE      71646602
DBE2FLG5 DS    0X                  FLAG BYTE PDEUSER WORD               71648602
DBE2USER DS    A                   RESOLVED ADDR OR SIB POINTER         71650602
DBE2CHAI DS    A                   CHAIN POINTER FOR ADDR LIST          71652602
         EJECT                                                          71653302
         EXPRPDE                                                        71670002
         END                                                            72270002
./  ADD  SSI=33180545,NAME=IKJEGPCH
         TITLE 'IKJEGPCH, ''ASSIGN'' SUBCOMMAND OF TEST, INITIALIZE'    00070002
         COPY  IKJEGSIO                                                 00080002
         EJECT                                                          00090002
         MACRO                                                          00100002
         VALUPDE                                                        00150002
*********************************************************************** 00200002
*                                                                     * 00250002
*        MAPPING DSECT FOR PDES FOR VALUES                            * 00300002
*                                                                     * 00350002
*        STATUS --  VERSION NO. 02                                    * 00400002
*                                                                     * 00450002
*        CHANGE LEVEL -- 00 - DATE 03/09/72                           * 00500002
*                                                                     * 00550002
*********************************************************************** 00600002
VALUPDE  DSECT                                                          00650002
VALUPTR  DS    F -                      POINTER TO CHARACTER STRING,    00700002
*                                       FIRST BYTE AFTER QUOTE          00750002
VALULNH  DS    H -                      LENGTH OF CHARACTER STRING,     00800002
*                                       EXCLUDING QUOTES                00850002
VALUFLG  DS    XL1 -                    FLAG                            00900002
VALUBIT  EQU   B'10000000' -            BIT ON MEANS VALUE PRESENT      00950002
VALUTYPE DS    CL1 -                    TYPE CHARACTER (CHARACTER       01000002
*                                       PRECEDING QUOTE)                01050002
VALUCHAI DS    F -                      ADDRESS OF NEXT VALUE           01100002
*                                       PDE ON CHAIN                    01150002
VALUPDL  EQU   *-VALUPDE -              LENGTH OF VALUE PDE             01200002
         MEND                                                           01250002
         EJECT                                                          01300002
*********************************************************************** 01350002
*                                                                     * 01400002
* STATUS--                                                            * 01450002
*    CHANGE LEVEL 00, VERSION NUMBER 02, OS/VS2 (5/17/73)             * 01500002
*                                                                     * 01550002
* FUNCTION--                                                          * 01600002
*                                                                     * 01650002
*    IKJEGPCH IS THE FIRST OF TWO LOAD MODULES THAT PROCESS           * 01700002
*    THE ASSIGNMENT OF VALUES FUNCTION OF TEST.  THE ASSIGNMENT       * 01750002
*    FUNCTION MODIFIES VALUES IN MAIN STORAGE AND IN REGISTERS.       * 01800002
*                                                                     * 01850002
*    IKJEGPCH IS LINKED TO FROM IKJEGMNL WITH REGISTER NINE           * 01900002
*    POINTING TO THE TEST COMMUNICATION TABLE (TCOMTAB).  WORK        * 01950002
*    AREAS ARE INITIALIZED THAT WILL LATER BE USED BY IKJEGASN,       * 02000002
*    THE SECOND OF TWO LOAD MODULES THAT PROCESS THE ASSIGNMENT       * 02050002
*    FUNCTION.                                                        * 02100002
*                                                                     * 02150002
*    THE BUFFER IS SCANNED FOR THE SUBCOMMAND PARAMETERS AFTER        * 02200002
*    ISSUING A LINK TO IKJPARS.  IKJPARS IS USED TO BUILD             * 02250002
*    PARAMETER DESCRIPTOR ELEMENTS IN THE PARAMETER DESCRIPTOR        * 02300002
*    LIST.  THE VALUES SCANNED BY IKJPARS ARE VALIDITY CHECKED        * 02350002
*    WHEN IKJEGPCH IS ENTERED AT 1) PCHVALAD TO CHECK THE             * 02400002
*    SPECIFIED ADDRESS AND 2) PCHVALTP TO CHECK THE DATA TYPES        * 02450002
*    AND VALUES.                                                      * 02500002
*                                                                     * 02550002
*    IF THE SCAN IS SUCCESSFUL, A BRANCH TO IKJEGASN IS               * 02600002
*    ISSUED.  IF UNSUCCESSFUL, A RETURN CODE IS SET AND CONTROL       * 02650002
*    IS RETURNED TO IKJEGMNL WITH A BR 14.                            * 02700002
*                                                                     * 02750002
* ENTRY POINTS--                                                      * 02800002
*         IKJEGPCH  MAIN ENTRY POINT, ENTERED FROM IKJEGMNL           * 02850002
*         PCHVALTP  PARSE EXIT ROUTINE FOR VALIDITY CHECKING VALUES   * 02900002
*         PCHVALAD  PARSE EXIT ROUTINE FOR ADDRESS CONVERSION         * 02950002
*                                                                     * 03000002
* INPUT--                                                             * 03050002
*    THE SUBCOMMAND BUFFER AS ENTERED BY THE USER.                    * 03100002
*    REGISTER NINE POINTS TO THE TCOMTAB                              * 03150002
*                                                                     * 03200002
* OUTPUT--                                                            * 03250002
*    AREA 'PCHWORK' INITIALIZED TO PERFORM THE PATCH REQUESTED.       * 03300002
*    REGISTER FIFTEEN CONTAINS A RETURN CODE                          * 03350002
*                                                                     * 03400002
* EXTERNAL REFERENCES--                                               * 03450002
*         IKJEGCVT FOR CONVERSION OF ADDRESSES TO BINARY.             * 03500002
*         IKJEGI0  FOR OUTPUTTING MESSAGES.                           * 03550002
*         IKJPARSE FOR PARSING THE SUBCOMMAND STRING.                 * 03600002
*                                                                     * 03650002
* EXITS, NORMAL--                                                     * 03700002
*         BRANCH TO MODULE 'IKJEGASN'                                 * 03750002
*                                                                     * 03800002
* EXITS, ERROR--                                                      * 03850002
*         BRANCH REGISTER 14 TO CALLER WITH A RETURN CODE OF ZERO     * 03900002
*         IF AN ERROR OCCURED DURING PARSE OR CONVERT.                * 03950002
*         BRANCH REGISTER 14 TO CALLER WITH RETURN CODE SIXTEEN IF    * 04000002
*         AN ATTENTION IS SCHEDULED.                                  * 04050002
*         BRANCH REGISTER 14 RETURNING TO CALLER WITH A CONDITION CODE* 04100002
*         OF TWENTY (20) FROM THE STAE RETRY ROUTINE AFTER AN ABEND.  * 04150002
*         ALSO A 24 INDICATING THE ESTAE COULD NOT BE ISSUED          * 04160002
*                                                                     * 04200002
* TABLES/WORK AREAS --                                                * 04250002
*    1 TCOMTAB, POINTED AT BY REG 9 IS THE TEST COMMUNICATIONS TABLE  * 04300002
*    2 PCHWORK, A DESECT WHICH DESCRIBES PART OF THE COMMON WORKING   * 04350002
*    CORE MAINTAINED BY TEST AND POINTED AT BY HWORKAREA' IN TCOMTAB. * 04400002
*    3 PARAMETER DESCRIPTOR LIST (PDL) PREPARED BY IKJPARSE TO        * 04450002
*    DESCRIBE THE VARIOUS FIELDS OF THE PARSED SUBCOMMAND             * 04500002
*                                                                     * 04550002
* ATTRIBUTES--                                                        * 04600002
*    REENTRANT, REFRESHABLE, PROBLEM PROGRAM.                         * 04650002
*                                                                     * 04700002
* CHARACTER CODE DEPENDENCY--                                         * 04750002
*    OPERATION OF THIS MODULE REQUIRES AND DEPENDS ON THE BIT         * 04800002
*    PATTERNS AND BINARY VALUES OF THE EBCDIC CHARACTER SET.          * 04850002
*    THE DEPENDENCY IS IN TABLE 'PCHTRTBL'. OTHER PORTIONS OF         * 04900002
*    THIS MODULE REQUIRES ONLY REASSEMBLY FOR CHANGE OF CODE.         * 04950002
*                                                                     * 05000002
* NOTES--                                                             * 05050002
*    THIS MODULE REQUIRES THE STANDARD INSTRUCTION SET.               * 05100002
*                                                                     * 05150002
*********************************************************************** 05200002
IKJEGPCH CSECT                                                          05250002
         SPACE                                                          05300002
* REGISTER EQUATES.                                                     05350002
         SPACE                                                          05400002
R0       EQU   0                   GENERAL USE AND PARAMETER REG        05450002
R1       EQU   1                   GENERAL USE AND PARAMETER REG        05500002
R2       EQU   2                   GENERAL USE REG                      05550002
R3       EQU   3                   GENERAL USE REG                      05600002
R4       EQU   4                   GENERAL USE REG                      05650002
R5       EQU   5                   GENERAL USE REG                      05700002
R6       EQU   6                   GENERAL USE REG                      05750002
R7       EQU   7                   GENERAL USE REG                      05800002
R8       EQU   8                   BASE REG FOR PDE'S                   05850002
R9       EQU   9                   BASE REG FOR TCOMTAB, COMM. DSECT    05900002
R10      EQU   10                  INTERNAL LINK REG FOR THIS MODULE    05950002
R11      EQU   11                  BASE REG FOR THIS PROGRAM.           06000002
R12      EQU   12                  *                                    06050002
R13      EQU   13                  PTR TO CURRENT SAVE AREA.            06100002
R14      EQU   14                  GENERAL USE, AND RETURN ADDR REG     06150002
R15      EQU   15                  GENERAL USE, RETURN CODE, CALL REG   06200002
         SPACE 2                                                        06250002
*  DATA EQUATES FOR OPERANDS OF IMMEDIATE TYPE INSTRUCTIONS.            06300002
         SPACE                                                          06350002
CHARA    EQU   C'A'                                                     06400002
CHARZ    EQU   C'Z'                                                     06450002
NULL     EQU   0                   USED FOR BALR R,0 AND BCTR R,0.      06500002
ZERO     EQU   0                                                        06550002
ONE      EQU   1                   SYMBOLIC FOR THE NUMBER 1            06600002
TWO      EQU   2                   SYMBOLIC FOR THE NUMBER '2'          06650002
FOUR     EQU   4                                                        06750002
EIGHT    EQU   8                                                        06800002
TWELVE   EQU   12                  SYMBOLIC FOR 12, USED AS AN RC       06850002
SIXTEEN  EQU   16                                                       06900002
TWENTY   EQU   20                  VALUE FOR COMPARE                    06950002
B24      EQU   24                  SHIFT VALUE                          07000002
R5OFF    EQU   40                  OFFSET INTO SAVE AREA FOR REG 5      07150002
R6OFF    EQU   44                  OFFSET INTO SAVE AREA FOR REG 6      07200002
R10OFF   EQU   60                  OFFSET INTO SAVE AREA FOR R10        07250002
R1OFF    EQU   24                  OFFSET INTO SAVE AREA FOR R1         07260002
DEC0     EQU   C'0'                                                     07300002
DEC1     EQU   C'1'                EBCDIC ONE FOR IMMEDIATE OPERANDS    07350002
DEC9     EQU   C'9'                                                     07400002
LCE      EQU   X'85'               EBCDIC CODE FOR A LOWER CASE 'E'     07450002
UCE      EQU   C'E'                USED IN IMMEDIATE OPERANDS           07500002
PLUS     EQU   C'+'                USED IN IMMEDIATE OPERANDS           07550002
MINUS    EQU   C'-'                USED IN IMMEDIATE OPERANDS           07600002
QUOTE    EQU   C''''               USED FOR SCANNING CHAR STRINGS.      07650002
RPAREND  EQU   C')'                END DELIMITER FOR SCON               07700002
LOW      EQU   4                   SYMBOLIC FOR BR ON COND CODE 1       07750002
HIGH     EQU   2                   SYMBOLIC FOR BR ON COND CODE 2       07800002
HIGHMASK EQU   X'20'               MASK FOR BRANCH HIGH                 07850002
LOEQMASK EQU   X'D0'               MASK FOR BRANCH LOW OR EQUAL         07900002
ODD      EQU   X'01'               FOR TESTING WHETHER AN ADDR IS ODD.  07950002
SIDATAPT EQU   0                   OFFSET INTO SYM-INFO BLOCK FOR DATA  08050002
M2OFFSET EQU   80                  OFFSET INTO BUFFER FOR 2ND LEVEL MSG 08150002
LL00IDL  EQU   14                  LENGTH OF LL00 AND ID FLDS OF MSG    08200002
         SPACE                                                          08450002
FOREPTR  EQU   8                   OFFSET TO FOREWARD PTR IN SAVE AREA  08500002
BACKPTR  EQU   4                   OFFSET TO BACKWARD PTR IN SAVE AREA  08550002
         SPACE                                                          09100002
HEXFF    EQU   X'FF'                                                    09150002
*  SYMBOLIC OFFSETS INTO THE MESSAGE CSECT FOR VARIOUS MESSAGE          10100002
         SPACE                                                          10150002
MSG101   EQU   101                 INVALID ADDRESS MSG                  10200002
MSG279   EQU   279                 WRITE PROTECT                        10250002
MSG212   EQU   212                 DATA FORMAT INCORRECT                10350002
MSG010   EQU   10                  VALUE BEGINNING---                   10400002
MSG209   EQU   209                 DATA STRING CONTAINS                 10450002
MSG210   EQU   210                 DATA STRING TO LONG                  10500002
MSG211   EQU   211                 ABSOLUTE VALUE TO GREAT              10550002
MSG103   EQU   103                 NO CORE MESSAGE (NO SECOND LEVEL)    10552002
MSG104   EQU   104                 ASSIGNMENT FAILED--                  10560002
MSG277   EQU   277                 PARSE RETURN CODE 12                 10570002
INST6    EQU   6                   FIXED INSERT NO. 6 (ASSIGNMENT)      10580002
         EJECT                                                          10600002
         TITLE 'IKJEGPCH, ''SET'' SUBCOMMAND OF TEST, INITIALIZATION'   10650002
*********************************************************************** 10700002
*                                                                     * 10750002
*  BEGIN WITH THE STANDARD LINKAGE CONVENTIONS.                       * 10800002
*                                                                     * 10850002
*********************************************************************** 10900002
         SAVE  (14,12),,*                                               10950002
         LR    R11,R15             PICK UP ENTRY POINT ADDR FOR BASE    11000002
         USING IKJEGPCH,R11                                             11050002
         USING TCOMTAB,R9                                               11100002
         L     R6,REGSAVE2         ADDR OF SAVE AREA                    11150002
         ST    R6,FOREPTR(R13)     FORWARD AND BACKWARD CHAIN           11200002
         ST    R13,BACKPTR(R6)         THE SAVE AREAS.                  11250002
         LR    R13,R6              SET PTR TO NEW SAVE AREA             11300002
         SPACE                                                          11350002
         L     R10,WORKAREA        GET PTR TO WORKING CORE              11400002
         USING TSTCWORK,R10                                             11450002
         LA    R10,CWORKCMD        SET UP BASE OF SUB-CMD WORK CORE     11500002
         USING PCHWORK,R10                                              11550002
         XC    PCHWORK(LPCHWORK),PCHWORK  CLEAR THE CORE                11600002
*                                                                       11650002
*        ISSUE ESTAE MACRO                                              11700002
*                                                                       11750002
         STM   R10,R12,R10OFF(R13)      SAVE BASE PTR                   12000002
         L     R2,TSTSTAE          R2= ADDR OF IKJEGSTA                 12010002
         ESTAE (R2),CT,PARAM=PCHSPL,RECORD=YES,MF=(E,PCHWORK)           12050002
         LTR   R15,R15             TEST RETURN CODE                     12100002
         BZ    STAEOK              CONTINUE IF ZERO                     12150002
         STC   R15,TSTESTRC        SAVE THE RETURN CODE FOR MNL         12160002
         LA    R15,B24             R15= RETURN CODE 24                  12170002
         B     PCHRET1A            PRINT ERROR MESSAGE IF SO            12200002
STAEOK   EQU   *                                                        12250002
         SPACE                                                          12400002
*********************************************************************** 12450002
*                                                                     * 12500002
*  SET UP PARAMETER LIST FOR CALLING PARSE.                           * 12550002
*                                                                     * 12600002
*********************************************************************** 12650002
         SPACE                                                          12700002
         LA    R1,PPCL             PTR TO PARSE LIST                    12750002
         USING PPL,R1              ADDRESSABILITY FOR LIST              12800002
         L     R2,TSTUPT           PTR TO UPT                           12850002
         L     R3,TSTECT           PTR TO ECT                           12900002
         L     R4,TSTCPECB         PTR TO P/P ECB                       12950002
         STM   R2,R4,PPLUPT        PUT PTR TO UPT ECT ECB TO PARSE LIST 13000002
         L     R2,PARSEPCL         PTR TO PARSE PCL                     13150002
         LA    R3,TSTANSPL         PTR TO ANSWER PLACE                  13200002
         L     R4,INBUF            PTR TO INPUT BUFFER                  13250002
         STM   R2,R4,PPLPCL        PUT PTR TO PARSE PCL INTO PARSE LIST 13300002
*                                  PUT PTR TO ANS PLACE INTO PARSE LIST 13350002
*                                  PUT PTR TO INPUT BUF INTO PARSE LIST 13400002
         SPACE                                                          13450002
*  R6 SHOULD STILL CONTAIN THE SAVE AREA ADDRESS AT THIS POINT.         13500002
         SPACE                                                          13550002
         ST    R6,PPLUWA           PUT INTO PARSE LIST                  13600002
         DROP  R1                                                       13650002
         SPACE                                                          13700002
         LINK  EP=IKJPARS,ERRET=LINKFAIL      LINK TO THE PARSE RTN.    13750002
PARSEBLO EQU   *                                                        13800002
         SPACE                                                          13850002
*********************************************************************** 13900002
*                                                                     * 13950002
*  TEST RETURN CODE FROM PARSE.                                       * 14000002
*       IF 0 FALL THRU AND SET UP TO GO TO IKJEGCVT TO CONVERT VALUE. * 14050002
*       IF NON-ZERO, GO ANALYZE FURTHER.                              * 14100002
*                                                                     * 14150002
*********************************************************************** 14200002
         SPACE                                                          14250002
         LTR   R15,R15             TEST RETURN CODE FROM PARSE.         14300002
* PLEASE NOTE THAT A BRANCH TABLE HAS BEEN USED IN LIEU OF NUMEROUS   * 14350002
* TESTS FOR RETURN CODE.                                              * 14400002
         BNZ   PARSRC(R15)         IF NON-ZERO, GO ANALYZE FURTHER.     14450002
         L     R8,TSTANSPL         GET PTR TO THE PDL                   14500002
         USING IKJPARMD,R8                                              14550002
         MVC   VPDE(VALUPDL),VAL   COPY THE CURRENT VALUE PDE           14600002
         LA    R8,ADDR             SET UP A BASE REG FOR ADDR PDE       14650002
         USING IKJPARMA,R8                                              14700002
         TM    PDEFLG4,GENR+SFPR+LFPR  IS ADDRESS TYPE REGISTER         14750002
         BZ    PCH010              IF NOT REG, BRANCH                   14800002
         NC    PDEINDCT,PDEINDCT   IF REG, IS IT INDIRECTED             14850002
         BNZ   PCH012              IF INDIRECTED, BRANCH                14900002
PCH010   EQU   *                                                        14950002
         MVC   A1TYPE,PDEFLG4      MOVE ADDR TYPE TO WORKING CORE       15000002
PCH012   EQU   *                                                        15050002
         L     R2,PDEUSER          GET RESOLVED ADDRESS OR SI PTR       15100002
         LTR   R2,R2               IS ADDR SYMBOLIC                     15150002
         BNM   PCH018              IF NOT SYMBOLIC, BRANCH              15200002
         L     R2,SIDATAPT(R2)     GET ACTUAL ADDR FROM SI BLOCK        15250002
PCH018   EQU   *                                                        15300002
         ST    R2,A1               SAVE RESOLVED ADDR IN WORKING CORE   15350002
         DROP  R8                                                       15400002
         SPACE                                                          15450002
*        AT THIS POINT CONTROL IS PASSED TO 'IKJEGASN', THE MAIN        15500002
*        PROCESSING MODULE FOR THE 'SET' SUBCOMMAND.                    15550002
         L     R15,ASNVCON         R15= ADDR OF IKJEGASN ENTRY          15650002
         BR    R15                 PASS CONTROL TO IKJEGASN             15900002
         SPACE 2                                                        15950002
*     RETURN TO MAINLINE IN AN ERROR CASE.                              16000002
PCHRET1  EQU   *                                                        16100002
         SPACE                                                          16150002
*  TURN OFF SWITCHES USED BY PATCH, AND ISSUE ESTAE 0                   16200002
         SPACE                                                          16250002
         L     R15,PCHRETCD        PICK UP PRESET RETURN CODE.          16350002
PCHRET1A DS    0H                  RETURN TO MNL                        16352002
         NI    TSTFLGS1,HEXFF-PCHLSTVL                                  16360002
         LR    R2,R15              SAVE THE RETURN CODE                 16362002
         ESTAE 0                   REMOVE THE ESTAE                     16370002
         NI    TSTFLGS4,HEXFF-TSTRERTN  TURN OFF ABEND SWITCH           16380002
         LR    R15,R2              RESTORE THE RETURN CODE              16390002
         L     R13,BACKPTR(R13)    GET ADDR OF PREVIOUS SAVE AREA.      16400002
         RETURN  (14,12),T,RC=(15) RETURN TO THE CALLER                 16450002
         EJECT                                                          16500002
PCHVALTP EQU   *                                                        16550002
         SAVE  (14,12)                                                  16600002
         LA    R14,OFFSETTP(R15)   SET UP CORRECT VALIDITY RTN ADDR.    16650002
* PLEASE NOTE THAT A BRANCH TABLE HAS BEEN USED IN LIEU OF NUMEROUS   * 16700002
* TESTS FOR CORRECT COMMON LINK ROUTINE.                              * 16750002
         B     OFFSET1(R15)        GO TO COMMON LINK CONVENTION RTN.    16800002
         SPACE                                                          16850002
PCHVALAD EQU   *                                                        16900002
         SAVE  (14,12)                                                  16950002
         LA    R14,OFFSETAD(R15)   SET UP CORRECT VALIDITY RTN ADDR.    17000002
OFFSET1  EQU   *-PCHVALTP          OFFSET TO GET TO COMMON LINK RTN.    17100002
         L     R12,FOUR(R1)        R12=PTR TO LIST'S SAVE AREA          17150002
         LR    R3,R1               SAVE REG1                            17200002
         LM    R6,R12,R6OFF(R12)   RESTORE REQUIRED REGS OF LIST        17250002
         L     R2,REGSAVE3         PTR TO NEW SAVE AREA                 17300002
         ST    R2,FOREPTR(R13)     FOREWARD CHAIN SAVE AREAS.           17350002
         ST    R13,BACKPTR(R2)     BACKWARD CHAIN SAVE AREAS.           17400002
         LR    R13,R2              SET NEW SAVE AREA                    17450002
         L     R1,ZERO(R3)         GET ADDR OF PDE TO VALIDITY CHECK.   17500002
         L     R2,OUTBUF           R2= ADDR OF OUTBUF                   17550002
         XC    ZERO(FOUR,R2),ZERO(R2)    CLEAR FIRST WORD OF OUTBUF     17600002
         OI    TSTFLGS4,TSTVALCK   INDICATE WE ARE IN A VALIDITY CK     17620002
         BR    R14                 GO TO REQUESTED ROUTINE.             17650002
         SPACE 2                                                        17700002
*  MAIN PORTION OF THE ADDRESS VALIDITY CHECKING ROUTINE.               17750002
         SPACE                                                          17800002
OFFSETAD EQU   *-PCHVALAD          OFFSET FOR ADDR VALIDITY CHECK RTN.  17900002
         LCR   R1,R1               INDICATE REGISTER CONVERSION.        17950002
         L     R15,TSTCONVT        ADDR OF CONVERT ROUTINE FOR CALL.    18000002
         BALR  R14,R15             GO TO CONVERT ROUTINE.               18050002
         LTR   R15,R15             TEST THE RETURN CODE FROM CVT.       18100002
         BNZ   PRCNOTZ             IF RC FROM IKJEGCVT NON-ZERO, BRANCH 18150002
         SPACE                                                          18160002
         L     R4,ZERO(ZERO,R3)    PICK UP PTR TO ADDRESS PDE           18162002
         ST    R4,APDEADDR         SAVE THE ADDR OFPDE FOR USE BY ASN   18162402
         USING IKJPARMA,R4         ESTABLISH ADDRESSABILITY             18164002
         TM    PDEFLG4,GENR+SFPR+LFPR  IS THIS ADDRESS A REGISTER       18166002
         BZ    TSTWRT              BRANCH IF IT IS NOT                  18168002
         NC    PDEINDCT,PDEINDCT   IS REGISTER USED WITH INDIRECT       18168402
         BZ    RETTOPAR            BRANCH IF NOT                        18168802
TSTWRT   TM    PDEFLG5,PDEWRITE    IS ADDRESS IN WRITE PROTECT STORAGE  18170002
         BZ    WRTMSG              INFORM THE USER IF SO                18170402
         DROP  R4                  FREE BASE REGISTER                   18172002
RETTOPAR EQU    *                                                       18200002
         NI    TSTFLGS4,HEXFF-TSTVALCK  TURN OFF VALIDITY CK SW         18210002
         L     R1,OUTBUF           R1= ADDR OF OUTBUF                   18220002
         L     R13,BACKPTR(R13)    GET ADDR OF PREVIOUS SAVE AREA.      18226002
         L     R2,R1OFF(ZERO,R13)  GET THE ADDR OF PARSE PARM LIST      18228002
         OC    ZERO(FOUR,R1),ZERO(R1)  IS THE OUTBUF = ZERO             18230002
         BZ    RETCONT             CONTINUE THE EXIT                    18240002
         ST    R1,EIGHT(R2)        PLACE ADDR IN PARSE PARM LIST        18242402
RETCONT  EQU   *                   EXIT TO PARSE                        18244002
         RETURN (14,12),,RC=(15)   RETURN TO THE PARSE ROUTINE.         18400002
WRTMSG   EQU    *                                                       18410002
         LA    R2,MSG101           R2= MSGNO 101                        18420002
         LA    R3,MSG279           R3= SECOND LEVEL 279                 18430002
         B     MSGOUTA             OUTPUT AN ADDRESS PDE                18440002
         SPACE                                                          18483302
PRCNOTZ  EQU   *                                                        18500002
         CH    R15,HSIXTEEN        IS RC 16 OR 20                       18550002
         BNL   RET12               IF 16 OR 20, BRANCH                  18600002
PRC8     EQU   *                                                        18900002
         LA    R15,EIGHT           SET RC TO PARSE TO 8                 18950002
         B     RETTOPAR            GO RETURN TO PARSE                   19000002
RET12    EQU   *                                                        19050002
         ST    R15,PCHRETCD        SAVE RETURN CODE FROM CVT            19100002
         LA    R15,TWELVE          SET RC TO 12 FOR PARSE               19150002
         B     RETTOPAR            GO RETURN TO PARSE                   19200002
         EJECT                                                          19250002
*  MAIN PORTION OF THE VALUE VALIDITY CHECKING ROUTINE.                 19300002
         SPACE                                                          19350002
OFFSETTP EQU   *-PCHVALTP          OFFSET FOR VALUE VALIDITY CHECK RTN. 19400002
         USING VALUPDE,R1                                               19450002
         TR    VALUTYPE(ONE),PCHTRTBL TRANSLATE TYPE TO UPPER CASE      19500002
         SR    R5,R5               INITIALIZE FOR LATER INSERT CHAR.    19550002
         CLI   VALUTYPE,CHARA      IS TYPE BELOW 'A' IN COLLATING SEQ   19600002
         BL    INVTYPE             IF YES, GO TO ERROR ROUTINE.         19650002
         CLI   VALUTYPE,CHARZ      IS TYPE ABOVE 'Z' IN COLLATING SEQ.  19700002
         BH    INVTYPE             IF YES, TO TO ERROR ROUTINE.         19750002
         IC    R5,VALUTYPE         PICK UP TYPE CHAR FROM PDE.          19800002
         STC   R5,TYPESAVE         SAVE CHARACTER USED FOR TYPE.        19850002
         LA    R14,TYPETBL(R5)     SET UP ADDR OF CORRESPONDING CODE.   19900002
         CLI   ZERO(R14),HEXFF     IS THE TYPE CODE X'FF'               19950002
         BE    INVTYPE             IF EQUAL, TYPE IS INVALID, BRANCH.   20000002
         IC    R5,ZERO(R14)        PICK UP HEX CODE FOR TYPE.           20050002
         STC   R5,VALUTYPE         STORE TYPE CODE IN VALUE PDE.        20100002
         LH    R2,VALULNH          R2=LENGTH OF DATA STRING.            20150002
         L     R6,VALUPTR          R6=ADDR OF DATA STRING               20200002
         LTR   R2,R2               IS THE STRING LNTH ZERO              20250002
         LR    R7,R1               SAVE PTR TO VALUE PDE IN R7.         20300002
         USING VALUPDE,R7                                               20350002
         BZ    INVTYPE             IF STRING LNTH 0,BRANCH              20400002
* PLEASE NOTE THAT A BRANCH TABLE HAS BEEN USED IN LIEU OF NUMEROUS   * 20450002
* TESTS FOR TYPE.                                                     * 20500002
         B     VBTABLE(R5)         BRANCH TO BRANCH TABLE OFFSET BY TYP 20550002
VBTABLE  EQU   *                                                        20600002
         B     CVAL                CODE X'00' FOR CHAR                  20650002
         B     XVAL                CODE X'04' FOR HEXADECIMAL           20700002
         B     BVAL                CODE X'08' FOR BINARY                20750002
         B     XVAL                CODE X'0C' THIS CODE NOT USED.       20800002
         B     FVAL                CODE X'10' FOR FULLWORD FIXED PT     20850002
         B     HVAL                CODE X'14' FOR HALFWORD FIXED PT     20900002
         B     EVAL                CODE X'18' FOR SHORT FLT PT          20950002
         B     DVAL                CODE X'1C' FOR LONG FLT PT           21000002
         B     AQVAL               CODE X'20' FOR A AND Q ADDR CNSTNTS  21050002
         B     YVAL                CODE X'24' FOR Y ADDR CONSTANTS      21100002
         B     SVAL                CODE X'28' FOR S ADDR CONSTANTS      21150002
         B     AQVAL               CODE X'2C' FOR V ADDR CONSTANTS      21200002
         B     PVAL                CODE X'30' FOR PACKED DECIMAL        21250002
         B     ZVAL                CODE X'34' FOR ZONED DECIMAL         21300002
         SPACE                                                          21350002
VALOK    EQU   *                                                        21400002
CVAL     EQU   *                                                        21450002
         SR    R15,R15             SET THE RETURN CODE TO ZERO.         21500002
         B     RETTOPAR            GO RETURN TO PARSE.                  21550002
         EJECT                                                          21600002
*********************************************************************** 21650002
*                                                                     * 21700002
*  THE FOLLOWING ROUTINES CHECK THE VALIDITY OF THE INPUT STRING      * 21750002
*  AGAINST THE REQUIREMENTS FOR THE PARTICULAR TYPE SPECIFIED.        * 21800002
*  AT ENTRY, THE REGISTERS ARE SET AS FOLLOWS.                        * 21850002
*        R1    PTR TO VALUE PDE                                       * 21900002
*        R2    LENGTH OF STRING                                       * 21950002
*        R5    TYPE CODE (IN HEX)                                     * 22000002
*        R6    PTR TO START OF STRING                                 * 22050002
*        R7    PTR TO VALUE PDE                                       * 22100002
*                                                                     * 22150002
*********************************************************************** 22200002
         SPACE                                                          22250002
FVAL     EQU   *                                                        22300002
         LA    R5,FMAX             SET UP TPR TO MAX VALUE FOR F TYPE   22350002
         B     VALNUM              GO TO NUMERIC CHECK ROUTINE          22400002
HVAL     EQU   *                                                        22450002
         LA    R5,HMAX             SET UP TPR TO MAX VALUE FOR H TYPE   22500002
         B     VALNUM              GO TO NUMERIC CHECK ROUTINE          22550002
AQVAL    EQU   *                                                        22600002
         CLI   ZERO(R6),MINUS      A - SIGN  IS INVAL, CHECK FOR IT     22650002
         BE    INVCHAR             IF - SIGN, BRANCH TO ERROR ROUTINE   22700002
         B     FVAL                GO TO NUMERIC CHECK ROUTINE          22750002
YVAL     EQU   *                                                        22800002
         CLI   ZERO(R6),MINUS      A - SIGN IS INVAL, CHECK FOR IT      22850002
         BE    INVCHAR             IF - SIGN, BRANCH TO ERROR ROUTINE   22900002
         B     HVAL                GO TO NUMERIC CHECK ROUTINE          22950002
         SPACE                                                          23000002
*  THE FOLLOWING ROUTINE SETS UP FOR AND CALLS THE NUMERIC SCAN RTN.    23050002
*  IT THE CHECKS THAT THE VALUE DOESN'T EXCEED THE MAXIMUM.             23100002
         SPACE                                                          23150002
VALNUM   EQU   *                                                        23200002
         CLI   ZERO(R6),MINUS      IS CONSTANT PRECEDED BY A - SIGN     23250002
         BE    SIGNIST             IF YES, BRANCH                       23300002
         CLI   ZERO(R6),PLUS       IF NOT A - SIGN, IS IT A + SIGN      23350002
         BNE   DIGITIST            IF NOT A SIGN, GO CHECK DIGITS       23400002
SIGNIST  EQU   *                                                        23450002
         BCTR  R2,NULL             DECREMENT LENGTH 1 FOR SIGN          23500002
         LA    R6,ONE(R6)          INCREMENT STRING PTR PAST SIGN       23550002
DIGITIST EQU   *                                                        23600002
         LR    R3,R2               SAVE LENGTH                          23650002
         LR    R4,R6                   AND PTR TO START OF DATA         23700002
         BAL   R14,NUMSCAN         GO CERTIFY FIELD AS NUMERIC          23750002
         LTR   R15,R15             TEST RETURN CODE                     23800002
         BNZ   INVCHAR             IF RC NON-ZERO, BRANCH TO ERROR RTN  23850002
         CH    R3,ZERO(R5)         CHECK LENGTH OF INPUT STRING         23900002
         BL    VALOK               LENGTH LESS THAN MAX, BRANCH         23950002
         BH    TOOBIG1             LENGTH GREATER THAN MAX, BRANCH      24000002
         SPACE                                                          24050002
*  IF LENGTH EQUALS MAX, COMPARE TO MAX NUMBER FOR THIS CONSTANT TYPE   24100002
         SPACE                                                          24150002
         BCTR  R3,NULL             DECREMENT LENGTH FOR CLC INSTR       24200002
         EX    R3,DATACLC1         COMPARE STRING TO MAX                24250002
         BL    VALOK               IF LOW, BRANCH, CONSTANT OK          24300002
         BH    TOOBIG2             IF HIGH, BRANCH, CONSTANT IN ERROR   24350002
         L     R6,VALUPTR          RESET PTR TO START OF VALUE STRING   24400002
         CLI   ZERO(R6),MINUS      IS THE FIRST CHAR A MINUS SIGN       24450002
         BE    VALOK               IF YES, VALUE IS OK                  24500002
         B     TOOBIG2             IF NOT, BRANCH, CONSTANT IN ERROR    24550002
         SPACE 2                                                        24600002
*  THE FOLLOWING ROUTINE CHECKS THE VALIDITY OF PACKED AND ZONED CONS   24650002
         SPACE                                                          24700002
ZVAL     EQU   *                                                        24750002
         LA    R5,ZMAX             SET UP PTR TO MAX LEN                24800002
         B     ZPVAL02             GO TO COMMON RTN                     24850002
PVAL     EQU   *                                                        24900002
         LA    R5,PMAX             SET UP PTR TO MAX LEN                24950002
ZPVAL02  EQU   *                                                        25000002
         CLI   ZERO(R6),MINUS      IS THE FIRST CHAR A MINUS SIGN       25050002
         BE    ZPVAL04             IF - SIGN, BRANCH                    25100002
         CLI   ZERO(R6),PLUS       IS THE FIRST CHAR A PLUS SIGN        25150002
         BNE   ZPVAL06             IF NOT SIGN, GO TEST FOR NUMBERS     25200002
ZPVAL04  EQU   *                                                        25250002
         BCTR  R2,NULL             DECREMENT LENGTH FOR SIGN            25300002
         LA    R6,ONE(R6)          INCRE THE PTR PAST SIGN              25350002
ZPVAL06  EQU   *                                                        25400002
         CH    R2,ZERO(R5)         IS LENGTH OK                         25450002
         BH    TOOBIG1             IF TOO LONG, BRANCH TO ERROR         25500002
         BAL   R14,NUMSCAN         GO CHECK THAT STRING IS NUMERIC      25550002
         LTR   R15,R15             TEST RETURN CODE                     25600002
         BZ    VALOK               IF RC=0, VALUE IS VALID              25650002
         B     INVCHAR             IF RC NON-ZERO, CONSTANT IN ERROR    25700002
         SPACE                                                          25750002
XVAL     EQU   *                                                        25800002
         LR    R4,R2               R4=INPUT STRING LENGTH               25850002
         CH    R4,XMAX             TEST LENGTH FOR MAX                  25900002
         BH    TOOBIG1             IF GREATER THAN MAX, BRANCH TO ERR   25950002
         BCTR  R4,NULL             DECRE LNTH FOR TRT INSTR             26000002
         EX    R4,VTRT1            TRANSLATE AND TEST FOR VALID CHARS   26050002
         BZ    VALOK               IF CC=0, STRING IS VALID HEX         26100002
         B     INVCHAR             OTHERWISE, BRANCH TO ERROR           26150002
VTRT1    TRT   ZERO(NULL,R6),XTRTT  FOR TESTING FOR VALID HEX DIGITS    26200002
         SPACE                                                          26250002
         SPACE                                                          26300002
DVAL     EQU   *                                                        26350002
         LA    R5,DMAX             SET UP PTRS TO MAX VALUES FOR D TYPE 26400002
         LA    R8,DMAXNEG          POINT TO CONSTANTS FOR NEG EXPONENT  26450002
         B     VALFPNUM            GO TO COMMON FLOATING PT NUM RTN.    26500002
         SPACE                                                          26550002
EVAL     EQU   *                                                        26600002
         LA    R5,EMAX             MAXIMUM VALUES FOR E TYPE            26650002
         LA    R8,DMAXNEG          POINT TO CONSTANTS FOR NEG EXPONENT  26700002
VALFPNUM EQU   *                                                        26750002
         CLI   ZERO(R6),MINUS      DOES STRING BEGIN WITH A - SIGN      26800002
         BE    FPSIGN1             IF YES, BRANCH                       26850002
         CLI   ZERO(R6),PLUS       DOES IT BEGIN WITH A + SIGN          26900002
         BNE   NOFPS1              IF NO SIGN, SKIP PTR ADJUSTMENT      26950002
FPSIGN1  EQU   *                                                        27000002
         LA    R6,ONE(R6)          INCRE PTR PAST SIGN                  27050002
         BCTR  R2,NULL             REDUCE LENGTH 1 FOR SIGN             27100002
NOFPS1   EQU   *                                                        27150002
         LR    R4,R6               SAVE START OF NUMERIC FIELD IN R4    27200002
         LR    R3,R2               SAVE ADJUSTED LENGTH IN R3           27250002
         BAL   R14,NUMSCAN         GO SCAN FOR DECIMAL DIGITS           27300002
         LTR   R15,R15             TEST RETURN CODE                     27350002
         BZ    FPEXP               IF ZERO, FIELD HAS NO EXPONENT       27400002
         CLI   ZERO(R6),LCE        WAS NON-NUMERIC CHAR A LOWER CASE E  27450002
         BE    FPEXP               IF YES, BRANCH                       27500002
         CLI   ZERO(R6),UCE        WAS IT AN UPPER CASE E               27550002
         BNE   INVCHAR             IF NEITHER, BRANCH TO ERROR          27600002
         SPACE 2                                                        27650002
*********************************************************************** 27700002
* THE FOLLOWING CODE CHECKS THAT THE USER ENTERED VALUE IS NOT TOO    * 27750002
* LARGE OR TOO SMALL. THE PROBLEM THIS POSES IS CLEAR IF WE NOTE THAT,* 27800002
* FOR EXAMPLE, 1E+60,10E+59,100E+58 AND 1000E+57 ARE IDENTICAL VALUES.* 27850002
* FOR INTEGRAL VALUES THE EXPONENT PLUS THE LENGTH OF THE COEFFICIENT * 27900002
* MUST NOT EXCEED 76. IF THE SUM IS LESS THAN 76 THE VALUE IS VALID.  * 27950002
* IF THE SUM IS EXACTLY 76 THEN THE COEFFICIENT MUST BE CHECKED TO SEE* 28000002
* THAT THE VALUE ENTERED DOES NOT EXCEED 7.237005...E+75. FOR         * 28050002
* FRACTION VALUES IE VALUES WITH A NEGATIVE EXPONENT THE UNSIGNED     * 28100002
* EXPONENT MINUS THE COEFFICIENT LENGTH MUST NOT EXCEED 78. IF THE SUM* 28150002
* IS LESS THAN 78 THE VALUE IS VALID. IF THE SUM IS EXACTLY 78 THEN   * 28200002
* THE COEFFICIENT MUST BE CHECKED TO SEE THAT THE VALUE ENTERED IS    * 28250002
* GREATER THAN 5.397605...E-79. ONE ALSO MIGHT EXPECT THE SINGLE      * 28300002
* PRECISION POSITIVE LIMIT TO BE 7.2370055E+75. THE LIMIT IS LOWER    * 28350002
* BECAUSE THE FLOATING POINT CONVERSION ROUTINE IN IKJEGCVT ROUNDS    * 28400002
* THE RESULT.                                                         * 28450002
*********************************************************************** 28500002
         SPACE 2                                                        28550002
FPEXP    EQU   *                                                        28600002
         SR    R3,R2               R3 IS NOW COEFFICIENT LENGTH         28650002
         BZ    INVFORMT            IF ZERO LENGTH PUT OUT MESSAGE       28700002
         LR    R15,R3              SAVE A COPY OF COEFFICIENT LENTH     28750002
         LR    R14,R4              SAVE START ADDR OF COEFFICIENT       28800002
VALCHK1  EQU   *                                                        28850002
         CLI   ZERO(R4),DEC0       IS LEADING DIGIT A ZERO              28900002
         BNE   VALCHK3             IF NO BRANCH                         28950002
         LA    R4,ONE(R4)          OTHERWISE POINT TO NEXT DIGIT        29000002
         BCT   R3,VALCHK1          IF MORE DIGITS CHECK NEXT DIGIT      29050002
         LR    R3,R15              RESTORE COEFFICIENT LENGTH           29100002
         LR    R4,R14              RESTORE COEFFICIENT START ADDR       29150002
VALCHK3  EQU   *                                                        29200002
         CH    R3,ZERO(R5)         HOW LONG IS COEFFICIENT              29250002
         BH    TOOBIG1             IF TOO LONG PUT OUT MESSAGE          29300002
         LR    R0,R3               SAVE COEFFICIENT LENGTH              29350002
         LTR   R2,R2               WAS AN EXPONENT ENTERED              29400002
         BZ    VALOK               IF NO VALUE IS OKAY, BRANCH          29450002
         CLI   ONE(R6),MINUS       IS EXPONENT NEGATIVE                 29500002
         BNE   PLUSEXP             IF NO SKIP CODE FOR FRACTION VALUE   29550002
         LCR   R3,R3               MAKE NEGATIVE                        29600002
         B     VALCHK2             SKIP CODE FOR POSITIVE EXPONENT      29650002
PLUSEXP  EQU   *                                                        29700002
         CLI   ONE(R6),PLUS        IS EXPONENT EXPLICITLY POSITIVE      29750002
         BNE   NOEXPSGN            IF NO SKIP CODE FOR AN EXPLICIT SIGN 29800002
VALCHK2  EQU   *                                                        29850002
         LA    R6,ONE(R6)          INCREMENT FOR SIGN                   29900002
         BCTR  R2,NULL             DECREMENT FOR SIGN                   29950002
NOEXPSGN EQU   *                                                        30000002
         LA    R6,ONE(R6)          INCREMENT FOR E                      30050002
         BCTR  R2,NULL             DECREMENT FOR E                      30100002
         CH    R2,TWO(R5)          HOW LONG IS EXPONENT                 30150002
         BH    TOOBIG2             IF TOO LONG PUT OUT MESSAGE          30200002
         LR    R15,R2              SAVE EXPONENT LENGTH                 30250002
         BCTR  R15,NULL            DECREMENT FOR EXECUTE                30300002
         EX    R15,DATAPACK        PACK THE EXPONENT                    30350002
         BAL   R14,NUMSCAN         GO CHECK FOR NUMERIC DIGITS ONLY     30400002
         LTR   R15,R15             WERE THEY ALL NUMERIC                30450002
         BNZ   INVCHAR             IF NO PUT OUT MESSAGE                30500002
         CVB   R0,HOLDAREA+ONE     CONVERT EXPONENT TO BINARY           30550002
         AR    R0,R3               ADD (OR SUBTRACT) COEFFICIENT LENGTH 30600002
         LA    R5,FOUR(R5)         POINT TO POSITIVE CONSTANTS          30650002
         LA    R15,HIGHMASK        LOAD MASK FOR EXECUTION OF BRANCH    30700002
         LTR   R3,R3               IS EXPONENT NEGATIVE                 30750002
         BNM   VALCHK4             IF NOT BRANCH                        30800002
         LR    R5,R8               POINT TO NEGATIVE CONSTANTS          30850002
         LA    R15,LOEQMASK        LOAD MASK FOR BRANCH LOW OR EQUAL    30900002
VALCHK4  EQU   *                                                        30950002
         CH    R0,ZERO(R5)         HOW LARGE IS EXPONENT                31000002
         BH    TOOBIG2             IF TOO LARGE PUT OUT MESSAGE         31050002
         BL    VALOK               IF LOWER THAN LIMIT VALUE IS OKAY    31100002
         LPR   R3,R3               MAKE COEFFICIENT LENGTH POSITIVE     31150002
         BCTR  R3,NULL             DECREMENT FOR COMPARISON TO LIMIT    31200002
         EX    R3,DATACLC1         COMPARE TO LIMITING COEFFICIENT      31250002
         EX    R15,BRANCH          BRANCH IF COEFFICIENT IS NOT VALID   31300002
         B     VALOK               OTHERWISE VALUE IS VALID             31350002
DATAPACK PACK  HOLDAREA+ONE(EIGHT),ZERO(ZERO,R6)                        31400002
BRANCH   NOP   TOOBIG2                                                  31450002
         SPACE                                                          31500002
BVAL     EQU   *                                                        31550002
         CH    R2,XMAX             TEST LENGTH, DOES IT EXCEED MAX      31600002
         BH    TOOBIG1             IF YES, BRANCH TO ERROR              31650002
BINVLOOP EQU   *                                                        31700002
         CLI   ZERO(R6),DEC0       IS CURRENT CHAR A ZERO               31750002
         BE    BIN0                IF YES, BRANCH, CHAR IS VALID        31800002
         CLI   ZERO(R6),DEC1       IS CURRENT CHAR A ONE                31850002
         BNE   INVCHAR             IF NEITHER 0, NOR 1, CHAR INVALID    31900002
BIN0     EQU   *                                                        31950002
         LA    R6,ONE(R6)          INCREMENT PTR TO NEXT CHAR           32000002
         BCT   R2,BINVLOOP         DECRE LNTH AND TEST FOR DONE         32050002
         B     VALOK               RETURN, ALL CHARS VALID              32100002
DATACLC1 CLC   ZERO(NULL,R4),TWO(R5)  COMPARES DIGIT STRINGS TO MAX     32150002
         SPACE 2                                                        32200002
*  ROUTINE TO TEST VALIDITY OF S TYPE VALUES.                           32250002
         SPACE                                                          32300002
SVAL     EQU   *                                                        32350002
         LA    R5,SMAX1            SET PTR TO SCON LIMITS               32400002
SCON04   EQU   *                                                        32450002
         LR    R3,R2               SAVE A COPY OF ORIGINAL LNTH         32500002
         LR    R4,R6               SAVE A COPY OF DATA START ADDR       32550002
         BAL   R14,NUMSCAN         GO SCAN FOR VALID DIGITS             32600002
* PLEASE NOTE THAT A BRANCH TABLE HAS BEEN USED IN LIEU OF NUMEROUS   * 32650002
* TESTS FOR RETURN CODE.                                              * 32700002
         B     SCON06(R15)         USE RETURN CODE AS BRANCH INDEX      32750002
         SPACE                                                          32800002
*  IF RETURN CODE IS ZERO, DATA DOES NOT CONTAIN PARENDS, AN ERROR.     32850002
         SPACE                                                          32900002
SCON06   B     INVFORMT            IF RC=0, BRANCH                      32950002
         SPACE                                                          33000002
*  IF RETURN CODE IS 4, CHECK NON-NUMERIC FOR LEFT OR RIGHT PAREND      33050002
         SPACE                                                          33100002
         SR    R3,R2               CALCULATE LNTH OF NUMERIC PORTION    33150002
         BZ    INVCHAR             IF NO NUMERICS, BRANCH               33200002
         CH    R3,ZERO(R5)         DOES LNTH EXCEED MAX                 33250002
         BH    TOOBIG1             IF LNTH EXCEEDS MAX, BRANCH          33300002
         BL    SCON12              IF LNTH IS LESS THAN MAX, BRANCH     33350002
         SPACE                                                          33400002
*  IF LENGTH EQUALS MAXIMUM, COMPARE VALUE TO MAX VALUE.                33450002
         SPACE                                                          33500002
         BCTR  R3,NULL             DECREMENT LNTH FOR CLC INSTR         33550002
         EX    R3,DATACLC1         COMPARE DATA TO MAX VALUE            33600002
         BH    TOOBIG2             IF VALUE EXCEEDS MAX, BRANCH         33650002
SCON12   EQU   *                                                        33700002
         CLC   ZERO(ONE,R6),SMAXL(R5) COMPARE NON-NUMERIC TO EXPECTED   33750002
         BNE   INVCHAR             IF NOT EXPECTED DELIMITER, BRANCH    33800002
         CLI   ZERO(R6),RPAREND    IS THIS THE FINAL DELIMITER          33850002
         LA    R5,SMAX2            INCRE LIMIT PTR TO REG LIMITS        33900002
         LA    R6,ONE(R6)          INCRE DATA PTR TO NEXT DATA BYTE     33950002
         BE    SCON20              IF FINAL DELIMITER, BRANCH OUT       34000002
         BCT   R2,SCON04           IF MORE CHARACTERS, BRANCH BACK      34050002
         B     INVCHAR             GO TO ERROR ROUTINE                  34100002
         SPACE                                                          34150002
SCON20   EQU   *                                                        34200002
         BCT   R2,INVCHAR          IF MORE CHARACTERS, ERROR, BRANCH    34250002
         B     VALOK               OTHERWISE, VALUE IS OK, RETURN       34300002
         SPACE 2                                                        34350002
INVFORMT EQU   *                                                        34400002
         LA    R2,MSG010           R2= MSG NO 70 FIRST LEVEL            34450002
         LA    R3,MSG212           R3= MSG NO 212 SECOND LEVEL          34500002
         B     MSGOUTV             OUTPUT THE MESSAGE WITH VALUE PDE    34550002
         SPACE                                                          34600002
INVCHAR  EQU   *                                                        34650002
         LA    R2,MSG010           R2= MSG NUMBER 10 FIRST LEVEL        34700002
         LA    R3,MSG209           R3= MSG NUMBER 209 SECOND LEVEL      34750002
         B     MSGOUTV             OUTPUT THE MESSAGE WITH VALUE PDE    34800002
         SPACE                                                          34850002
TOOBIG1  EQU   *                                                        34900002
         LA    R2,MSG010           R2= MSG NUMBER 10 FIRST LEVEL        34950002
         LA    R3,MSG210           R3= MSG NUMBER 210 SECOND LEVEL      35000002
         B     MSGOUTV             OUTPUT THE MESSAGE WITH VALUE PDE    35050002
         SPACE                                                          35100002
TOOBIG2  EQU   *                                                        35150002
         LA    R2,MSG010           R2= MSG NUMBER 10 FIRST LEVEL        35200002
         LA    R3,MSG211           R3= MSG NUMBER 211 SECOND LEVEL      35250002
         B     MSGOUTV             OUTPUT THE MESSAGE WITH VALUE PDE    35300002
         EJECT                                                          35310002
**********************************************************************  35360002
*        MESSAGE PORTION OF THE MODULE                                  35370002
**********************************************************************  35410002
         SPACE                                                          35460002
MSGOUTA  DS    0H                  CALL IO TO OUTPUT MESSAGE            35510002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO PARMETER AREA    35560002
         IKJEGSIO MSG,FIRST=(R2),SECOND=(R3),INST11=(APDE,APDEADDR),   *35610002
               ID=PCH24,MF=(E,TSTIOPRM)     INVOKE IO...                35660002
         B     RETCKTAB(R15)       BRANCH ON THE RETUNR CODE            35710002
         SPACE                                                          35760002
MSGOUTV  DS    0H                  CALL IO TO OUTPUT MESSAGE            35810002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO PARMETER AREA    35860002
         IKJEGSIO MSG,FIRST=(R2),SECOND=(R3),INST11=(VPDE,(R7)),       *35910002
               ID=PCH24,MF=(E,TSTIOPRM)     INVOKE IO...                35960002
         B     RETCKTAB(R15)       BRANCH ON THE RETUNR CODE            36010002
         SPACE                                                          36010402
MSGOUTN  DS    0H                  FIXED INSERT IN THE FIRST MSG        36012002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM AREA         36014002
         IKJEGSIO MSG,FIRST=(R2),SECOND=(R3),INST11=(NUM,(R4)),        *36016002
               ID=PCH24,MF=(E,TSTIOPRM)  CALL IO                        36018002
IOCHECK  DS    0H                  CHECK OUT RETURN CODES FROM IO       36018402
         CH    R15,HSIXTEEN        IS THE RETURN CODE 16, 20, 24        36018802
         BNL   PCHRET1A            RETURN TO MNL                        36019202
         SR    R15,R15             ZERO R15                             36019602
         B     PCHRET1A            RETURN TO MNL                        36019702
         SPACE                                                          36020002
LINKFAIL DS    0H                  LINK FAIL IO MESSAGE ROUTINE         36030002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO PARM AREA        36040002
         LR    R3,R15              R3= RETURN CODE                      36042002
         LR    R4,R1               R4= ABEND CODE                       36044002
         IKJEGSIO SVCERR,SVC=6,ABENDRG=(R4),RC=(R3),                   *36050002
               ID=PCH24,MF=(E,TSTIOPRM)   INVOKE IO                     36052002
         B     IOCHECK             CHECK THE RETURN CODES               36054002
         SPACE                                                          36060002
RETCKTAB DS    0H                  RETURN CODE FROM IO TABLE            36110002
         B     PRC8                ASK FOR A REENTER                    36160002
         B     PRC8                ASK FOR A REENTER                    36210002
         B     PRC8                ASK FOR A REENTER                    36260002
         B     PRC8                ASK FOR A REENTER                    36310002
         B     RET12               RETURN TO PARSE AND CLEAN UP         36360002
         B     RET12               RETURN TO PARSE AND CLEAN UP         36410002
         B     RET12               RETURN TO PARSE AND CLEAN UP         36460002
         EJECT                                                          38550002
INVTYPE  EQU   *                                                        38600002
         LA    R15,FOUR            SET RC=J SO PARSE WILL PROMPT        38650002
         B     RETTOPAR            GO RETURN TO PARSE.                  38700002
CVTRC    EQU   *                                                        38750002
         CH    R15,HSIXTEEN        IS THE RETURN CODE 16                38800002
         BE    PCHCC16             IF RC=16, BRANCH TO RC=16 RTN.       38850002
         B     PCHRET1             OTHERWISE, BRANCH TO WRAPUP RTN.     38900002
         SPACE 2                                                        38950002
*********************************************************************** 39000002
*                                                                     * 39050002
*  THE FOLLOWING ROUTINE CHECKS THAT EACH CHAR IN A STRING IS NUMERIC * 39100002
*        INPUT IS   R2 CONTAINS LENGTH OF STRING                      * 39150002
*                   R6 CONTAINS PTR TO START OF STRING                * 39200002
*                   R14 CONTAINS RETURN ADDRESS                       * 39250002
*                                                                     * 39300002
*********************************************************************** 39350002
         SPACE                                                          39400002
NUMSCAN  EQU   *                                                        39450002
         LA    R15,FOUR            SET ERROR RETURN CODE                39500002
NUMSCAN2 EQU   *                                                        39550002
         CLI   ZERO(R6),DEC0       IS CHAR EQ OR GT AN EBCDIC '0'       39600002
         BCR   LOW,R14             IF NOT, RETURN WITH RC=4             39650002
         CLI   ZERO(R6),DEC9       IS CHAR EQ OR LT AN EBCDIC '9'       39700002
         BCR   HIGH,R14            IF NOT, RETURN WITH RC=4             39750002
         LA    R6,ONE(R6)          INCREMENT PTR TO STRING              39800002
         BCT   R2,NUMSCAN2         DECREMENT LENGTH AND LOOP IF MORE    39850002
         SR    R15,R15             SET RETURN CODE TO 0                 39900002
         BR    R14                 RETURN TO CALLER                     39950002
         TITLE 'IKJEGPCH, ASSIGN SUBCOMMAND OF TEST, ERROR ROUTINES'    40000002
PCHCC16  EQU   *                                                        40050002
         LA    R15,SIXTEEN         SETUP A RETURN CODE OF 16.           40100002
         ST    R15,PCHRETCD        STORE RETURN CODE IN RC FIELD.       40150002
         B     PCHRET1             GO RETURN TO CALLER                  40200002
         ORG   *-4                 REUSE SPACE NOT NEEDED FOR RC=0      40250002
PARSRC   EQU   *                                                        40300002
         ORG                                                            40350002
         B     PARSRC04            RETURN CODE OF 4 ROUTINE.            40400002
         B     PCHCC16             GO SET RETURN CODE FOR ATTN DETECTED 40450002
         B     PARSRC12            GO TO ROUTINE FOR RC 12.             40500002
         B     PARSRC16            RETURN CODE IS 16                    40550002
         B     PCHRET1             RETURN TO MAINLINE IMMEDIATELY       40600002
         SPACE                                                          40650002
*  IF PARSE RETURN CODE WAS 4, ENTER HERE AFTER PARSE                   40700002
         SPACE                                                          40750002
PARSRC04 EQU   *                                                        40800002
         OI    TSTFLGS4,TSTFLUSH   TELL MNLINE TO FLUSH STACK           40850002
         XR    R15,R15             ZERO RETURN CODE TO MNLINE           40900002
         ST    R15,PCHRETCD        STORE RETURN CODE IN RC FIELD        40950002
         B     PCHRET1             RETURN TO MNLINE                     41000002
         SPACE                                                          41050002
*  IF PARSE RETURN CODE WAS 12, ENTER HERE AFTER PARSE                  41100002
         SPACE                                                          41150002
PARSRC12 EQU   *                                                        41200002
         LA    R4,INST6            R4= INSERT NO 6 (ASSIGNMENT)         41300002
         LA    R2,MSG104           R2= FIRST LEVEL MSG NO               41302002
         LA    R3,MSG277           R3= SECOND LEVEL MSG NO              41304002
         B     MSGOUTN             FIXED INSET IN FIRST LEVEL           41306002
         SPACE                                                          41308002
*  IF THE RETURN CODE WAS 16, THIS ROUTINE IS BRANCHED TO AFTER PARSE.* 41400002
         SPACE                                                          41450002
PARSRC16 EQU   *                                                        41500002
*        ISSUE THE OUT OF CORE MESSAGE                                  41550002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO WORK AREA        41600002
         LA    R2,MSG103           R2= 103 FIRST LEVEL MSG INDICATOR    41650002
         IKJEGSIO MSG,FIRST=(R2),ID=PCH24,MF=(E,TSTIOPRM)               41660002
         B     IOCHECK             RETURN TO MNL                        41700002
         EJECT                                                          41750002
*********************************************************************** 41800002
*                                                                       41850002
*        STAE RETRY ROUTINE                                             41900002
*                                                                       41950002
*********************************************************************** 42000002
         SPACE 3                                                        42050002
RETRY    EQU   *                                                        42100002
         L     R4,CVTPTR           PTR TO CVT                           42150002
         USING CVT,R4              ADDRESSABILITY FOR CVT               42200002
         L     R4,CVTTCBP          TCB PTR                              42250002
         L     R4,FOUR(R4)         CURRENT TCB PTR                      42300002
         DROP  R4                                                       42350002
         USING TCB,R4              TCB ADDRESSABILITY                   42400002
         L     R9,TCBTRN           TCOMTAB PTR                          42450002
         L     R13,REGSAVE2        PTR TO SAVE AREA                     42500002
         LM    R10,R12,R10OFF(R13)     RESTORE MODULE ADDRESSABILITY    42550002
         LA    R15,TWENTY          INDICATE ERROR RETURN                42560002
*-*-*    NOTE IN BOTH CSECT'S (IKJEGPCH AND IKJEGASN) PCHRET1A WILL     42610002
*-*-*    EXIT TO IKJEGMNL WITH R15 AS THE RETURN CODE.                  42710002
         B     PCHRET1A            RETURN                               42900002
         TITLE 'IKJEGPCH, ASSIGN, CONSTANTS, DSECTS, AND PARSE MACROS'  42950002
         SPACE 2                                                        43200002
****     ADDRESS CONSTANT FOR IKJEGASN                                  43202002
ASNVCON  DC    V(IKJEGASN)         ADDRESS OF IKJEGASN                  43202402
         SPACE 2                                                        43210002
HSIXTEEN DC    H'16'               USED TO TEST FOR RC=16               43900002
         SPACE                                                          44750002
FMAX     DC    H'10'               MAX NUMBER OF CHAR IN F CONSTANT     44800002
         DC    C'2147483648'       MAX NUMBER FOR A,F,Q, AND V TYPES    44850002
HMAX     DC    H'5'                MAX NUMBER OF CHAR IN H CONSTANT     44900002
         DC    C'32768'            MAX NUMBER FOR H AND Y TYPES         44950002
ZMAX     DC    H'16'               MAX NUMBER OF DIGITS IN ZONED DATA   45000002
PMAX     DC    H'31'               MAX LENGTH FOR PACKED STRING         45050002
         SPACE                                                          45100002
*  LIMITS FOR 'D' TYPE FLOATING POINT CONSTANTS.                        45150002
         SPACE                                                          45200002
DMAX     DC    H'17'               COEFFICIENT LENGTH LIMIT             45250002
         DC    H'2'                EXPONENT LENGTH LIMIT                45300002
         DC    H'76'               POSITIVE EXPONENT VALUE LIMIT        45350002
         DC    C'72370055773322621'     POS COEFFICIENT VALUE LIMIT     45400002
DMAXNEG  DC    H'78'               NEGATIVE EXPONENT VALUE LIMIT        45450002
         DC    C'53976053469340278'     NEG COEFFICIENT VALUE LIMIT     45500002
         SPACE                                                          45550002
*  LIMITS FOR 'E' TYPE FLOATING POINT CONSTANTS.                        45600002
         SPACE                                                          45650002
EMAX     DC    H'8'                COEFFICIENT LENGTH LIMIT             45700002
         DC    H'2'                EXPONENT LENGTH LIMIT                45750002
         DC    H'76'               POSITIVE EXPONENT VALUE LIMIT        45800002
         DC    C'72370053'         POSITIVE COEFFICIENT VALUE LIMIT     45850002
         SPACE                                                          45900002
XMAX     DC    H'64'               LIMITS FOR X, C, AND B TYPE CONSTANT 45950002
         SPACE                                                          46000002
SMAX1    DC    H'4'                MAX LNTH FOR SCON DISPLACEMENT FLD   46050002
         DC    C'4095'             MAX VALUE FOR DISPLACEMENT           46100002
SMAXL    EQU   *-SMAX1             SYMBOLIC OFFSET TO DELIMITER         46150002
         DC    C'('                BEGIN DELIMITER FOR REG NUMBER       46200002
         SPACE                                                          46250002
SMAX2    DC    H'2'                MAX LNTH FOR SCON REG NUMBER FLD     46300002
         DC    CL4'15'             MAX VALUE FOR SCON REG NUMBER        46350002
         DC    C')'                END DELIMITER FOR REG NUMBER         46400002
         SPACE                                                          46450002
         SPACE                                                          46550002
PARSEPCL DC    V(IKJEGPMB)         ADDRESS OF PARSE PARM CNTRL LIST     46600002
         SPACE                                                          46650002
*        THE ABEND TABLE FOR PCH AND ASN                                46700002
PCHABEND EQU   *                                                        46800002
         DS    0F                                                       46802002
         DC    AL1(97)             CODE FOR USER CAUSED PROTECTION CHK  46810002
         DC    VL3(PCHABND1)       ANTICIPATED ABEND ADDR FROM DATA MVC 46820002
         DC    AL1(99)             CODE FOR LINK TO PARSE FAILED        46900002
         DC    AL3(PARSEBLO)       ADDRESS OF POTENTIAL ABEND           46950002
         DC    X'FF'               TABLE STOPPER                        47000002
         SPACE                                                          47010002
PCHSPL   IKJEGSPL RTRY=RETRY,ABNTB=PCHABEND,MODNM=IKJEGPCH,            *47020002
               TNM=ASSIGNMENT                                           47030002
         EJECT                                                          47050002
         DS    0D                                                       47100002
PCHTRTBL DC    256AL1(*-PCHTRTBL)  LOWER TO UPPER CASE TR TABLE         47150002
         ORG   PCHTRTBL+C'A'-X'40' SET LOCATION CTR TO LOWER CASE 'A'   47200002
         DC    (C'Z'-C'A'+1)AL1(*-PCHTRTBL+X'40')  DEFINES UPPER CASE   47250002
         ORG                                                            47300002
         SPACE 2                                                        47350002
*********************************************************************** 47400002
*  THE FOLLOWING TABLE IS USED TO CHECK AND TO CONVERT THE ASSEMBLER  * 47450002
*  TYPE CODES FOR VALUES INTO A HEX CODE FOR INTERNAL PROCESSING. THIS* 47500002
*  CODE IS THE SAME AS THAT USED BY THE ASSEMBLER IN SYM RECORDS.     * 47550002
         SPACE                                                          47600002
         ORG   *-C'A'              BACK UP LOC CTR TO ORGIN TABLE       47650002
TYPETBL  EQU   *                                                        47700002
         ORG   *+C'A'              ONLY USE SPACE FOR UPPER CASE ALPHA  47750002
         DC    X'2008001C'         CODES FOR A, B, C, AND D TYPE CONS.  47800002
         DC    X'1810FF14'         CODES FOR E, F, INV, AND H CONS.     47850002
         DC    (C'P'-C'H'-1)X'FF'  CODES FOR INV'S BETWEEN H AND P      47900002
         DC    X'30'               CODE FOR P TYPE CONSTANTS.           47950002
         DC    (C'S'-C'P'-1)X'FF'  CODES FOR INV'S BETWEEN P AND S.     48000002
         DC    X'28FFFFFF'         CODE FOR S TYPE CONS AND 3 INVS.     48050002
         DC    X'FF042434'         CODES FOR INV, X, Y, AND Z CONS.     48100002
*********************************************************************** 48150002
         SPACE 2                                                        48200002
XTRTT    EQU   *                                                        48250002
         DC    256X'01'            NON-ZERO VALUE FOR NON-HEX DIGITS    48300002
         ORG   XTRTT+C'A'-C' '     POSITION FOR LOWER CASE 'ABCDEF'     48350002
         DC    6AL1(0)             DEFINE LOWER CASE ABCDEF             48400002
         ORG   XTRTT+C'A'          POSITION FOR UPPER CASE 'ABCDEF'     48450002
         DC    6AL1(0)             DEFINE UPPER CASE ABCDEF             48500002
         ORG   XTRTT+C'0'          POSITION FOR DECIMAL DIGITS 0-9      48550002
         DC    10AL1(0)            DEFINE DECIMAL DIGITS 0-9            48600002
         DC    50C'Z'              MAINTENANCE AREA                     48650002
         EJECT                                                          48700002
*  PARSE MACROS                                                         48750002
         SPACE                                                          48800002
IKJEGPMB IKJPARM                                                        48850002
ADDR     IKJPOSIT  ADDRESS,PROMPT='ADDRESS',VALIDCK=PCHVALAD            48900002
VAL      IKJPOSIT  VALUE,LIST,ASIS,PROMPT='VALUE',VALIDCK=PCHVALTP      48950002
         IKJENDP                                                        49000002
         EJECT                                                          49050002
*                                                                       49100002
*        FOLLOWING IS A MAP OF THE WORK AREA USED BY THE PATCH AND      49150002
*        ASSIGN MODULES. NOTE THEY MUST BE KEPT IDENTICAL.......        49160002
*                                                                       49200002
PCHWORK  DSECT                                                          49250002
PPCL     DS    7F                  SPACE FOR PARSE PARM LIST            49450002
         SPACE                                                          49500002
ADDRINCR DS    F                   FULLWORD TO HOLD CONSTANTS FOR REGS  49550002
MAXRADDR EQU   ADDRINCR+2          OFFSET FOR MAX REG NUMBER            49600002
PCHRETCD DS    F                   HOLDS CURRENT RETURN CODE            49650002
VPDE     DS    3F                  HOLDS CURRENT COPY OF THE VALUE PDE  49700002
A1       DS    F                   HOLDS CURRENT ADDR TO BE PATCHED     49750002
DUMMYPDE DS    3F                  RESERVE SPACE FOR COPY OF VALUE PDE. 49800002
A1L      DS    H                   HOLDS CURRENT STRING LNTH FOR 'C'    49850002
A1TYPE   DS    X                   CONTAINS TYPE ASSOCIATED WITH VALUE  49900002
         DS    AL3                 RESERVED                             49950002
         DS    XL1                 RESERVED                             50000002
         DS    0D                                                       50050002
         ORG   *-1                 POSITION FOR LENGTH BYTE OF HOLDAREA 50100002
CONAREA1 DS    XL41                USED FOR ADDRESSING PURPOSES ONLY.   50150002
         ORG   CONAREA1            RE-USE SPACE FOR ACTUAL HOLDAREA     50200002
HOLDAREA DS    XL65                TEMP HOLD AREA FOR DATA CONVERSION   50250002
MSGPLIST DS    2F                  PARM LIST FOR CALLING IKJEGIO1.      50300002
TYPESAVE DS    C                   FOR SAVING USER SUPPLIED TYPE CODE   50400002
REGDATA  DS    F                   PATCH VALUE TO BE PLACED IN REGISTER 50410002
ASNSVCL  DS    3F                  3 WORD PARMETER LISTS                50420002
APDEADDR DS    F                   ADDR OF THE ADDR PDE                 50422002
ASNFLGS1 DS    X                   FLAGS FOR USE BY ASN                 50430002
LPCHWORK EQU   *-PCHWORK           LENGTH OF TOTAL DSECT.               50450002
         EJECT                                                          50500002
         VALUPDE                                                        50550002
         EJECT                                                          50600002
         TCOMTAB                                                        50650002
         TITLE 'IKJEGPCH, MESSAGE CSECT'                                50700002
         EJECT                                                          54400002
         IKJPARMA                  EXPAND THE ADDR PDE MAPPING DSECT    54450002
         SPACE 3                                                        54500002
         TSTCWORK                  EXPAND TEST'S CORE MAPPING DSECT     54550002
         EJECT                                                          54600002
CVT      DSECT                                                          54650002
         CVT                                                            54700002
         IKJTCB                                                         54750002
         IKJPPL                                                         54800002
         END                                                            54850002
./  ADD  SSI=81730772,NAME=IKJEGPSW
         EJECT                                                          00020002
PSW      TITLE 'IKJEGPSW - TSO TEST LIST PSW ROUTINE'                   00050002
         COPY  IKJEGSIO                                                 00060002
         EJECT                                                          00070002
IKJEGPSW CSECT                                                          00100002
*A086600,099924,292100                                           YA2414 00110002
*C259000,259220                                                  YM4111 00120002
* A 148000,148030                                    @ZA07138,@ZA09259  00130000
*********************************************************************** 00150002
*                                                                     * 00250002
* STATUS --                                                           * 00300002
*    CHANGE LEVEL 00, VERSION NUMBER 02, OS/VS2  (05/17/73)           * 00350002
*                                                                     * 00400002
* FUNCTION/OPERATION --                                               * 00450002
*    THIS COMMAND PROGRAM RECEIVES CONTROL FROM THE TEST SUBCOMMAND   * 00500002
*    PROCESSOR.  IT DISPLAYS THE PSW OF THE PROBLEM PROG OR THE PSW   * 00550002
*    AT A SPECIFIED ADDRESS. IT DISPLAYS THE PSW IN EITHER BC OR EC   * 00600002
*    MODE; BIT NUMBER 13 OF THE PSW IS THE INDICATOR; (0= BCMODE) AND * 00610002
*    (1= EC MODE).                                                    * 00610402
*                                                                     * 00650002
* ENTRY POINTS --                                                     * 00700002
*         IKJEGPSW    MAIN ENTRY TO LISTPSW ROUTINE                   * 00750002
*         PSWVALCK    ENTRY TO PARSE ADDRESS VALIDITY CHECK EXIT RT   * 00800002
*                                                                     * 00850002
* INPUT --                                                            * 00900002
*    ONE LINE OF INPUT FROM THE TERMINAL CONTAINING THE SUBCOMMAND    * 00950002
*                                                                     * 01000002
* OUTPUT --                                                           * 01050002
*    LINES OF OUTPUT TO THE TERMINAL OR TO A SPECIFIED DATA SET,      * 01100002
*    THE FIRST BEING A HEADER AND THE SECOND THE PSW FIELDS           * 01150002
*                                                                     * 01200002
* EXTERNAL REFERENCES --                                              * 01250002
*         1.  IKJPARS  - TO SCAN THE INPUT BUFFER                     * 01300002
*         2.  IKJEGCVT - TO CHECK AND CONVERT THE ADDR, IF SPECIFIED, * 01350002
*         AND TO CONVERT THE PSW TO PRINTABLE HEX                     * 01400002
*         3.  IKJEGIO  - TO OUTPUT THE HEADER AND PSW                 * 01450002
*                                                                     * 01500002
* EXITS, NORMAL --                                                    * 01550002
*         RETURN TO IKJEGMNL VIA REGISTER14                           * 01600002
*                                                                     * 01650002
* EXITS, ERROR --                                                     * 01700002
*         NONE                                                        * 01750002
*                                                                     * 01800002
* TABLES/WORK AREAS --                                                * 01850002
*    TCOMTAB - TEST TABLE AND WORKAREA                                * 01900002
*                                                                     * 01950002
* ATTRIBUTES --                                                       * 02000002
*    REENTRANT ROUTINE                                                * 02050002
*    REFRESHABLE ROUTINE                                              * 02100002
*                                                                     * 02150002
* CHARACTER CODE DEPENDENCY --                                        * 02200002
*    RE-ASSEMBLY IS REQUIRED FOR CHANGE OF CODE                       * 02250002
*                                                                     * 02300002
* NOTES --                                                            * 02350002
*    IF AN ADDRESS IS SPECIFIED NEITHER BOUNDARY ALIGNMENT OR DATA    * 02400002
*    VALIDITY IS CHECKED                                              * 02450002
*                                                                       02457000
* CHANGE-ACTIVITY -                                                     02464000
*                 APAR OZ07138 - CHANGES TO USE THE CORRECT RB          02471000
*                 POINTER TO FETCH THE PSW FOR DISPLAY. THE             02478000
*                 POINTER IS IN TCOMTAB AT ECBPP+1.                     02485000
*                 APAR OZ09259 - THE SAME AS ABOVE.                     02488000
*                                                                       02492000
*                                                                     * 02500002
*********************************************************************** 02550002
         EJECT                                                          02600002
*********************************************************************** 02650002
*                                                                     * 02700002
*          REGISTER EQUATES                                           * 02750002
*                                                                     * 02800002
*********************************************************************** 02850002
         SPACE 2                                                        02900002
R0       EQU   0                   REGISTER 0                           02950002
R1       EQU   1                   REGISTER 1                           03000002
R2       EQU   2                   REGISTER 2                           03050002
R3       EQU   3                   REGISTER 3                           03100002
R4       EQU   4                   REGISTER 4                           03150002
R5       EQU   5                   CONTAINS ADDRESS OF WORKAREA         03200002
R6       EQU   6                   REGISTER 6                           03250002
R7       EQU   7                   REGISTER 7                           03300002
R8       EQU   8                   REGISTER 8                           03350002
R9       EQU   9                   BASE FOR TCOMTAB                     03400002
R10      EQU   10                  REGISTER 10                          03450002
R11      EQU   11                  NOT USED                             03500002
R12      EQU   12                  BASE FOR IKJEGPSW                    03550002
R13      EQU   13                  REGISTER 13                          03600002
R14      EQU   14                  REGISTER 14                          03650002
R15      EQU   15                  REGISTER 15                          03700002
         SPACE 2                                                        03750002
*********************************************************************** 03800002
*                                                                     * 03850002
*        OTHER EQUATES                                                * 03900002
*                                                                     * 03950002
*********************************************************************** 04000002
N0       EQU   0                   DECIMAL 0                            04050002
N1       EQU   1                   DECIMAL 1                            04100002
N2       EQU   2                   DECIMAL 2                            04150002
N3       EQU   3                   DECIMAL 3                            04200002
N4       EQU   4                   DECIMAL 4                            04250002
N5       EQU   5                   DECIMAL 5                            04300002
N6       EQU   6                   DECIMAL 6                            04350002
N7       EQU   7                   DECIMAL 7                            04400002
N8       EQU   8                   DECIMAL 8                            04450002
N9       EQU   9                   DECIMAL 9                            04500002
N10      EQU   10                  DECIMAL 10                           04550002
N11      EQU   11                  DECIMAL 11                           04600002
N12      EQU   12                  DECIMAL 12                           04650002
N16      EQU   16                  DECIMAL 16                           04700002
N20      EQU   20                  DECIMAL 20                           04750002
N22      EQU   22                  DECIMAL 22                           04800002
N24      EQU   24                  DECIMAL 24                           04850002
N26      EQU   26                  DECIMAL 26                           04900002
N28      EQU   28                  DECIMAL 28                           04950002
N30      EQU   30                  DECIMAL 30                           05000002
N31      EQU   31                  DECIMAL 31                           05010002
N32      EQU   32                  DECIMAL 32                           05050002
N40      EQU   40                  DECIMAL 40                           05100002
N52      EQU   52                  DECIMAL 52                           05110002
N53      EQU   53                  DECIMAL 53                           05120002
N65      EQU   65                  DECIMAL 65                           05150002
N66      EQU   66                  DECIMAL 66                           05200002
N67      EQU   67                  DECIMAL 67                           05250002
N68      EQU   68                  DECIMAL 68                           05300002
N79      EQU   79                  DECIMAL 79                           05350002
N80      EQU   80                  DECIMAL 80                           05400002
N104     EQU   104                 DECIMAL 104                          05450002
PLUSSIGN EQU   C'+'                PLUS SIGN INDICATE 1ST LEV HAS A 2ND 05500002
NOTSYM   EQU   10                  BC INSTR MASK, BRANCH POSTIVE OR 0   05550002
ADDR     EQU   X'80'               ADDRESS STRING INDICATOR IN PDE      05600002
         SPACE                                                          05610002
*********************************************************************** 05620002
*        MESSAGE EQUATES                                                05622002
*********************************************************************** 05630002
MSG101   EQU   101                 INVALID ADDR MSG (APDE INSERT)       05640002
MSG274   EQU   274                 REG MUST BE INDIRECT GEN (SECOND)    05642002
MSG282   EQU   282                 PSW EXTENDS INTO PROTECTED CORE      05644002
MSG103   EQU   103                 NO CORE MSG NO SECOND LEVEL          05644402
MSG104   EQU   104                 LISTPSW FAILED----                   05646002
INST15   EQU   15                  LISTPSW FIXED INSERT NO.             05648002
MSG277   EQU   277                 PARSE ERROR CODE 12 (SECOND LEVEL)   05648402
         EJECT                                                          05650002
         SAVE  (14,12),,*          SAVE MAINLINE'S REGS                 05700002
         LR    R12,R15             USE ENTRY POINT FOR BASE             05750002
         USING IKJEGPSW,R12        ESTABLISH PROGRAM ADDRESSABILITY     05800002
         USING TCOMTAB,R9          ESTABLISH TCOMTAB ADDRESSABILITY     05850002
         L     R15,REGSAVE2        LOAD ADDRESS OF NEW SAVE AREA        05900002
         ST    R13,N4(R15)         STORE REG 13 IN NEW SAVE AREA        05950002
         ST    R15,N8(R13)         STORE NEW SAVE AREA ADDRESS          06000002
         LR    R13,R15             R13 NOW HAS NEW SAVE AREA ADDRESS    06050002
         L     R7,WORKAREA         LOAD ADDRESS OF TEST WORKAREA        06100002
         USING TSTCWORK,R7                                              06150002
         LA    R5,CWORKCMD         ADDRESS OF WORK AREA FOR CMDS        06200002
         USING PSWAREA,R5          ESTABLISH ADDRESSABILITY             06250002
         DROP  R7                                                       06300002
         ST    R12,N68(R13)        SAVE MY BASE IN MY SAVE AREA         06650002
         XC    STAELIST(N16),STAELIST  CLEAR THE STAE PARM LIST         06700002
         L     R2,TSTSTAE          R2= ADDR OF IKJEGSTA                 06710002
         ESTAE (R2),CT,PARAM=PSWSPL,RECORD=YES,MF=(E,STAELIST)          06750002
         LTR   R15,R15             WAS STAE ISSUED SUCCESSFULLY         06800002
SMTSTAE  DS    0H                  SMT TESTCASE LABEL                   06850002
         BZ    GOPARSE             YES, GO SET UP TO PARSE COMMAND      07000002
         STC   R15,TSTESTRC        SAVE THE RETURN CODE FOR MNL         07050002
         LA    R15,N24             R15=24 RETURN CODE TO MNL ESTAE FAIL 07150002
         B     RETURN2             EXIT TO MNL                          07200002
         EJECT                                                          07250002
GOPARSE  EQU   *                                                        07300002
         LR    R1,R5               ADDR OF WORK AREA, BUILD PARSE LIST  07350002
         USING PPL,R1                                                   07400002
         MVC   PPLUPT(N12),PARMLIST MOVE ECT, UPT, ECB TO PARSE         07410002
         MVC   PPLPCL(N4),PCLADDR  POINTER TO PCL FOR PARSE             07600002
         LA    R2,TSTANSPL         LOAD ADDRESS OF PARSE ANSWER PLACE   07650002
         ST    R2,PPLANS           STORE IN PARM LIST FOR PARSE         07700002
         MVC   PPLCBUF(N4),INBUF   POINTER TO COMMAND INPUT BUFFER      07750002
         ST    R9,PPLUWA           STORE ADDRESS OF TCOMTAB             07800002
         DROP  R1                                                       07850002
         LINK  EP=IKJPARS,ERRET=LINKFAIL  PARSE THE COMMAND             07900002
PABEND1  EQU   *                   POSSIBLE ABEND RESUME ADDRESS        07950002
SMTPARS  DS    0H                  SMT TESTCASE LABEL                   08000002
*                                   LINK TO PARSE FAILED                08050002
*                                   TESTCASE ID  TPSW2100               08100002
         B     PARSEEND            AFTER PARSE IS COMPLETE, BRANCH      08150002
         EJECT                                                          08200002
********************  VALIDITY CHECK ROUTINE  ************************  08210002
         SPACE                                                          08220002
*********************************************************************** 08250002
*        THE FOLLOWING IS EXECUTED IMMEDIATELY BEFORE A BRANCH TO     * 08300002
*        IKJEGCVT WHICH VALIDITY CHECKS THE ADDRESS SPECIFIED BY USER * 08350002
*        THIS CODE WILL NOT BE EXECUTED IF THE USER DOES NOT SPECIFY  * 08400002
*        AN ADDRESS                                                   * 08450002
*********************************************************************** 08500002
         SPACE                                                          08550002
PSWVALCK SAVE  (14,12),,*          SAVE PARSE REGISTERS                 08600002
         LR    R2,R1               R2 = ADDR OF PDE                     08650002
         L     R9,N4(R1)           RESTORE TCOMTAB ADDRESSABILITY       08652002
         OI    TSTFLGS4,TSTVALCK   INDICATE VALIDITY CHECK              08654002
         L     R12,REGSAVE2        LOAD ADDRESS OF PSW REGISTERS        08656002
         L     R5,N40(R12)         RESTORE WORKAREA ADDRESS             08658002
         ST    R1,PARMPTR          ADR OF PARSE LST FOR EXIT RT  YM4111 08660002
         L     R1,OUTBUF           R1= ADDR OF OUTBUFFER                08710002
         XC    N0(N4,R1),N0(R1)    CLEAR THE FIRST WORD OF OUTBUF       08720002
         L     R12,N68(R12)        RESTORE PROGRAM ADDRESSABILITY       08850002
         L     R15,REGSAVE3        LOAD ADDRESS OF NEW SAVE AREA        08900002
         ST    R13,N4(R15)         STORE REG 13 IN NEW SAVE AREA        08950002
         ST    R15,N8(R13)         STORE NEW SAVE AREA ADDRESS          09000002
         LR    R13,R15             R13 NOW HAS NEW SAVE AREA ADDRESS    09050002
****     R7 NOW CONTAINS THE ADDR OF THE PDE                            09060002
         USING IKJPARMA,R7         ADDR'ABILITY TO THE PDE              09070002
         L     R7,N0(R2)           POINTER TO ADDRESS PDE               09100002
         LNR   R1,R7               NEGATIVE, ADDR CONVERSION            09150002
         LPR   R0,R7               POSTIVE, CONVERT TO BINARY           09200002
         L     R15,TSTCONVT        LOAD ADDRESS OF IKJEGCVT             09250002
         BALR  R14,R15             VALIDITY CHECK THE ADDRESS           09300002
         SPACE 1                                                        09350002
*********************************************************************** 09400002
*        THE FOLLOWING CODE IS EXECUTED UPON RETURN FROM IKJEGCVT     * 09450002
*********************************************************************** 09500002
         SPACE 1                                                        09550002
         LTR   R15,R15             IS RETURN CODE 0                     09650002
         BZ    CHKADDR             YES, GO CHECK ADDRESS                09700002
         LA    R6,N4               CONVERT UNSUCCESSFUL RETURN CODE     09800002
         CR    R6,R15              WAS CONVERT UNSUCCESSFUL             09850002
         BNE   STOP                NO, WORST TROUBLES, GO SET ENDUP     09900002
         LA    R15,N8              R.C.=8, HAVE PARSE PRINT REENTER     09950002
PARSRTRN EQU   *                                                        09960002
         NI    TSTFLGS4,HEXFF-TSTVALCK  TURN OFF VALIDITY CHECK SWITCH  09970002
         L     R1,OUTBUF           R1= ADDR OF THE OUTPUT BUFFER        09980002
         OC    N0(N4,R1),N0(R1)    IS OUTBUF CLEAR                      09990002
         BZ    RETCONT             CONTINUE TO EXIT TO PARSE            09992002
         L     R2,PARMPTR          RESTORE THE PARM POINTER      YM4111 09992402
         ST    R1,N8(R2)           PLACE ADDR OF SEC LEVEL MSG IN PPL.  09994002
RETCONT  EQU   *                   WE NOW ARE READY TO RETURN TO PARSE  09996002
         L     R13,N4(R13)                                              10000002
         RETURN (14,12),,RC=(15)   RESTORE REGISTERS AND RETURN         10050002
CHKADDR  EQU   *                                                        10100002
         L     R3,PDEUSER          CONVERTED ADDR - USER WORD IN PDE    10150002
         TM    PDEFLG5,PDESIB      IS PDEUSER A SIB POINTER             10160002
         BNO   CHKMORE             NO CONTINUE CHECKING                 10170002
         L     R3,N0(R3)           R3 = ACTUAL ADDRESS FROM SIB         10180002
CHKMORE  EQU   *                                                        10350002
         LA    R3,N0(R3)           ZERO HIGH ORDER BYTE OF PDEUSER      10360002
         ST    R3,PDEUSER          REPLACE ACTUAL ADDRESS IN PDEUSER    10370002
         SR    R15,R15             SUCCESSFUL RETCODE FOR PARSE         10400002
         LH    R4,PDEINDCT         INDIRECT COUNT                       10550002
         LTR   R4,R4               IS ADDRESS INDIRECT                  10600002
         BZ    CHKREG              NO, CHECK FOR REGISTER ADDRESS       10650002
         SPACE                                                          10916602
*-*-*    THE FOLLOWING CALL TO IGC0009G IS TO VALIDITY CHECK THE END OF 10918602
*-*-*    THE PSW                                                        10920602
CHKEND   DS    0H                  ADDRESS CHECK END OF PSW             10926602
         LA    R3,N7(R3)           R3= ADDRESS OF END OF PSW            10936602
         L     R4,PPTCB            R4= ADDR OF THE PP TCB               10946602
         IKJEGS9G ADDRCHK,TCBADDR=(R4),VALUE=(R3),MF=(E,TEMPWRK) SVC 97 10956602
         LA    R4,N16              R4= 16 IS THE RETURN CODE 20 OR 24.  10957002
         CR    R15,R4              IS THE R. C. GREATER THAN 16.        10957102
         BNL   STOP                SVC 97 HAD A PROBLEM SO END IT.      10957402
         LA    R4,N8               R4=8 RETURN CODE BAD ADDRESS         10958602
         CR    R15,R4              COMPARE WITH RETURN CD FROM SVC 97   10960602
         BL    ADDROK              THE ADDRESS IS VALID                 10962602
         LA    R2,MSG101           R2= 101 FIRST LEVEL MSG              10964602
         LA    R3,MSG282           R3= 282 SECOND LEVEL MSG             10965002
         B     MSGOUTA             OUTPUT MESSAGE WITH ADDR PDE INSERT  10965402
         SPACE                                                          10965802
ADDROK   DS    0H                  RETURN WITH ZERO RETURN CODE         10966202
         SR    R15,R15             R15= ZERO                            10966302
         B     PARSRTRN            RETURN TO PARSE                      10966402
         SPACE                                                          10966602
CHKREG   EQU   *                                                        11050002
         TM    PDEFLG4,HEX38       WAS ADDRESS A REGISTER               11100002
         BZ    CHKEND              NO, GO SEE IF COMPLETE PSW IN CORE   11150002
         LA    R2,MSG101           R2= 101 FIRST LEVEL MSG NO           11200002
         LA    R3,MSG274           R3= 274 SECOND LEVEL MSG NO.         11250002
         B     MSGOUTA             OUTPUT THE MESSAGE WITH ADDR PDE     11260002
         EJECT                                                          11270002
*********************************************************************** 11280002
*        MESSAGE OUTPUTTING SECTION NOTE R2= FIRST LEVEL NUMBER,        11282002
*        R3= SECOND LEVEL NUMBER.                                       11284002
*********************************************************************** 11290002
         SPACE                                                          11340002
MSGOUTA  DS    0H                  OUTPUT MESSAGE R7= ADDR PDE INSERT   11390002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARM AREA         11440002
         IKJEGSIO MSG,FIRST=(R2),SECOND=(R3),INST11=(APDE,(R7)),       *11490002
               ID=PSW25,MF=(E,TSTIOPRM)   OUTPUT CALL                   11540002
         LTR   R15,R15             IS R.C. 0, I/O SUCCESSFUL            12250002
         BNE   IOFAILED            NO, GO CHECK R.C. FROM I/O           12300002
         LA    R15,N8              YES, PROMPT R.C. FOR PARSE           12350002
         B     PARSRTRN            GO RETURN TO PARSE                   12400002
         DROP  R7                  RELEASE PDE ADDR'ABILITY             12410002
IOFAILED EQU   *                                                        12450002
         LA    R6,N16              I/O UNSUCCESSFUL RETURN CODE         12500002
         CR    R6,R15              WAS I/O UNSUCCESSFUL                 12550002
         BNL   STOP                NO, WORST TROUBLES, GO SET ENDUP     12600002
         SR    R15,R15             YES, CREATE 0 R.C. FOR MAINLINE      12650002
STOP     EQU   *                                                        12700002
         ST    R15,ANSWPLAC        SAVE ENDUP RETURN CODE               12750002
         LA    R15,N12             SET ENDUP R.C. FOR PARSE             12800002
         B     PARSRTRN            GO RETURN TO PARSE                   12850002
         SPACE                                                          12860002
LINKFAIL DS    0H                  LINK FAILURE                         12870002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO PARM AREA        12880002
         LR    R2,R15              R2= RETURN CODE                      12882002
         LR    R3,R1               R3= ABEND CODE                       12884002
         IKJEGSIO SVCERR,SVC=6,RC=(R2),ABENDRG=(R3),                   *12890002
               ID=PSW25,MF=(E,TSTIOPRM)                                 12892002
         LA    R8,N16              R8= 16 (RETURN CODE CHECKING)        12892802
         CR    R8,R15              IS THE RETURN CODE 16 OR GREATER     12893202
         BNL   RETURN2             YES THEREFORE LEAVE AS IS            12893602
         LA    R15,N20             SET RETURN CODE TO 20.               12893702
         B     RETURN2             EXIT WITH 20.                        12893802
         SPACE                                                          12896002
MSGOUT   DS    0H                  OUTPUT A MESSAGE FIXED INSERT(R4)    12898002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR PARM AREA            12898402
         IKJEGSIO MSG,FIRST=(R2),SECOND=(R3),INST11=(NUM,(R4)),        *12898802
               ID=PSW25,MF=(E,TSTIOPRM)  OUT PUT THE MESSAGE            12899202
         B     PSWRET              EXIT TO MNL                          12899602
         EJECT                                                          12933302
*********************************************************************** 12950002
*        THE FOLLOWING IS THE CODE EXECUTED UPON RETURN FROM PARSE    * 13000002
*********************************************************************** 13050002
         SPACE 1                                                        13100002
PARSEEND EQU   *                                                        13150002
         LTR   R15,R15             IS RETURN CODE 0                     13200002
         BNZ   PSWRET1             IF NO, BRANCH                        13250002
         L     R8,TSTANSPL         LOAD ADDRESS OF PDL                  13300002
         USING IKJPARMD,R8         ESTABLISH PDL ADDRESSABILITY         13350002
         LA    R4,N40              A OUTPUT LINE LENGTH                 13400002
         CH    R4,TMPLL            IS USER SPECIFIED LINE LENGTH LESS   13450002
         BH    LL80                YES, GO USE 80 FOR LINE LENGTH       13500002
         LA    R4,N80              NO, ANOTHER LINE LENGTH              13550002
         CH    R4,TMPLL            IS SPECIFIED LINE LENGTH GREATER     13600002
         BL    LL80                YES, GO USE 80 FOR LINE LENGTH       13650002
         LH    R4,TMPLL            NO, USE SPECIFIED LINE LENGTH        13700002
         B     LINESET             GO SET LINE LENGTH                   13750002
LL80     LA    R4,N80              DEFAULT LINE LENGTH TO 80            13800002
LINESET  ST    R4,LINELEN          STORE OUTPUT LINE LENGTH             13850002
         CLI   PRINTIT+N1,HEX00    WAS PRINT SPECIFIED                  13900002
         BNZ   PRINTSPC            BRANCH IF YES                        13950002
         XC    PRINTFLG(N4),PRINTFLG                                    14000002
         B     ADDRCHK             GO CHECK FOR ADDRESS                 14050002
PRINTSPC OI    TSTFLGS1,TSTPRINT   INDICATE I/O TO DATA SET             14100002
         LA    R3,DSNAME           ADDRESS OF DSNAME PDE                14150002
         ST    R3,PRINTFLG         STORE ADDRESS OF PDE                 14200002
ADDRCHK  EQU   *                                                        14200402
         LA    R8,ADDRESS          R8= ADDRESS OF THE PARSE (PDE)       14202002
         DROP  R8                  RELEASE ADDRESSIBILITY TO PARMD(PDL) 14210002
         USING IKJPARMA,R8         ESTABLISH ADDRIBILITY TO PARMA (PDE) 14220002
         L     R3,PDEUSER          USER WORD IN ADDR PDE                14300002
         LTR   R3,R3               WAS ADDRESS SPECIFIED BY USER        14350002
         BNZ   ADRSPECF            IF YES GO TO ADRSPECF                14400002
         TM    PDEFLG3,AFLG        WAS ADDRESS SPECIFIED BY USER        14450002
         BO    ADRSPECF            YES, GO GET SPECIFIED PSW            14500002
         SPACE 1                                                        14550002
*********************************************************************** 14600002
*        THE FOLLOWING CODE LOCATES THE PROBLEM PROGRAM PSW           * 14650002
*********************************************************************** 14700002
         SPACE 1                                                        14750002
         L     R2,ECBPP            GET POINTER TO SVRB         @ZA07138 14800000
*                                                              @ZA09259 14820000
         L     R2,RBLINK-RBSECT(R2) GET POINTER TO PP RB       @ZA07138 14840000
*                                                              @ZA09259 14860000
         MVC   PSWBUF(N8),RBOPSW-RBSECT(R2)  MOVE PSW TO WORK AREA      14950002
         B     PSWCONVT            BRANCH TO CONVERT PSW TO PRINTABLE   15000002
ADRSPECF EQU   *                                                        15050002
         L     R3,PDEUSER          USER WORD OF PDE                     15100002
PSWNOSYM MVC   PSWBUF(N8),N0(R3)   MOVE PSW TO WORK AREA                15300002
         DROP  R8                  RELEASE ADDRIBILITY TO THE (PDE)     15302002
RESTRBLO DS    0H                  STAE TABLE ENTRY FOR BAD ADDRESS     15310002
         SPACE 1                                                        15350002
*********************************************************************** 15400002
*        THE FOLLOWING CODE WILL CONVERT THE PSW FROM MACHINE         * 15450002
*        REPRESENTATION TO PRINTABLE HEX                              * 15500002
*********************************************************************** 15550002
         SPACE 1                                                        15600002
PSWCONVT EQU   *                                                        15650002
         L     R15,TSTCONVT        LOAD ADDRESS OF IKJEGCVT             15700002
         LA    R14,PSWBUF          POINT TO BINARY PSW                  15750002
         ST    R14,STRNGPTR        STORE IN PDE FOR IKJEGCVT            15800002
         MVC   CVTLL(N2),PSWLEN    STORE LENGTH OF PSW IN LIST          15850002
         MVI   FLAGS,FLAG          STORE FLAG IN PDE                    15900002
         MVI   TYPECODE,TYPE       STORE TYPE (HEX) IN PDE              15950002
         LA    R1,STRNGPTR         LOAD ADDRESS OF PDE                  16000002
         LNR   R0,R1               R0 NEGATIVE - CONVERT TO PRINTABLE   16050002
         BALR  R14,R15             GO CONVERT THE PSW TO PRINTABLE      16100002
         LTR   R15,R15             RETURN CODE 0                        16150002
         BNZ   PSWRET              IF NO, BRANCH                        16200002
         SPACE 1                                                        16250002
*********************************************************************** 16300002
*        THE FOLLOWING MOVES THE THREE FIELDS TO BE PRINTED IN HEX TO * 16350002
*        THE OUTPUT FIELD BUFFER                                      * 16400002
*********************************************************************** 16450002
         SPACE 1                                                        16500002
         L     R2,CONAREA          LOAD ADDRESS OF HEX PSW              16550002
         MVI   START,BLANK         BLANK OUT FIRST BYTE OF PSW BUFFER   16600002
         MVC   START+N1(N67),START   BLANK OUT REMAINDER OF PSW BUFFER  16650002
*********************************************************************** 16660002
*        DETERMINE WHAT MODE PSW WE HAVE, EC OR BC MODE                 16662002
*        BIT 13 = 0 IS BC, BIT 13 = 1 IS EC MODE                        16664002
*********************************************************************** 16670002
         TM    PSWBUF+N1,ECMODBIT    IS THE PSW AN ECMODE PSW           16680002
         BO    ECMODPSW              YES THE PSW IS EC MOD              16690002
         MVC   KEY(N1),N3(R2)        MOVE KEY TO OUTPUT BUFFER          16700002
         MVC   INTRPTCD(N4),N5(R2)   MOVE INTRPT CODE TO OUTPUT BUFFER  16750002
         MVC   INSTRADR(N6),N11(R2)  MOVE INSTR ADDR TO OUTPUT BUFFER   16800002
         SPACE 1                                                        16850002
*********************************************************************** 16900002
*        THE FOLLOWING CONVERTS THE REMAINING PSW FIELDS TO PRINTABLE * 16950002
*        BINARY AND TRANSFERS THEM TO THE OUTPUT BUFFER               * 17000002
*        THE SECTION OF THE BINARY PSW TO BE CONVERTED IS PUT IN REG7.* 17050002
*        BITS ARE SHIFTED ONE BY ONE INTO REG6.  ACCORDING AS THE BIT * 17100002
*        IS A ZERO OR A ONE A PRINTABLE ZERO OR ONE IS ADDED INTO R10 * 17150002
*        WHEN REG10 IS FULL (AFTER 4 BITS ARE CONVERTED) IT IS STORED * 17200002
*        IN THE WORKAREA.                                             * 17250002
*********************************************************************** 17300002
         SPACE 1                                                        17350002
         MVC   PSWBUF+N2(N1),PSWBUF+N4    MOVE BINARY FIELDS TOGETHER   17400002
         SR    R3,R3                                                    17450002
         SR    R2,R2                                                    17500002
         IC    R3,ZERO             LOAD CHARACTER 0 INTO REGISTER       17550002
         IC    R2,ONE              LOAD CHARACTER 1 INTO REGISTER       17600002
         SR    R6,R6                                                    17650002
         LA    R4,N4               BIT COUNTER                          17700002
         L     R7,PSWBUF           LOAD BINARY PSW                      17750002
         LA    R8,SYSMASK          POINT TO OUTPUT AREA FOR FIELDS      17800002
LOOP1    SLDL  R6,N1(R0)           SHIFT ONE BIT INTO R6                17850002
         LTR   R6,R6               IS IT A ZERO                         17900002
         BE    ZEROBIT             IF YES, BRANCH                       17950002
ONEBIT   SLL   R10,N8(R0)          OTHERWISE IT IS A ONE                18000002
         AR    R10,R2              PUT A CHARACTER ONE IN LOW BYTE      18050002
         SR    R6,R6               ZERO OUT R6 FOR NEXT BIT             18100002
         B     EIGHTBCT            GO CHECK IF R10 IS FULL              18150002
ZEROBIT  SLL   R10,N8(R0)                                               18200002
         AR    R10,R3              PUT A CHARACTER ZERO IN LOW BYTE     18250002
EIGHTBCT BCT   R4,LOOP1            IF R10 IS NOT FULL, BRANCH           18300002
         ST    R10,N0(R8)          STORE R10 IN WORK AREA               18350002
         LA    R8,N4(R8)           INCREMENT OUTPUT POINTER             18400002
         LA    R4,TABLE            LOAD END OF PROCESSING CHECK         18450002
         CR    R8,R4               ARE ALL BITS CONVERTED               18500002
         BE    OUTPUTIT            IF YES, OUTPUT DATA                  18550002
         LA    R4,N4               RESET COUNTER FOR 4 MORE BITS        18600002
         B     LOOP1               CONVERT NEXT FOUR BITS               18650002
         SPACE                                                          18700002
*********************************************************************** 18750002
*        THE FOLLOWING SECTION OF CODE FORMATS THE EC MODE PSW          18752002
*        FIRST MOVE THE TO HEX FIELDS CONVERTED BY IKJEGCVT TO THE      18754002
*        OUTPUT FIELD BUFFER  (R2 = ADDRESS OF CONAREA)                 18756002
*********************************************************************** 18760002
ECMODPSW DS    0H                    EC MODE PSW FORMATTING             18760102
         USING CONAREAD,R2           SETUP DSECT FOR CONAREA            18760402
         MVC   ECKEY(N1),CONKEY      MOVE SYSTEM KEY TO PRINT AREA      18760802
         MVC   ECINADDR(N8),CONINADR MOVE INST ADDR INTO PRINT AREA     18761202
         DROP  R2                    RELEASE CONAREA ADDR'ABILITY       18761602
         SPACE                                                          18761702
**********************************************************************  18761802
*        THE NEXT SECTION SETS UP THE BIT PATTERN IN A TEMPORARY        18769402
*        WORKAREA AND THEN MOVES THE AREA TO OUTPUT AREA                18771402
**********************************************************************  18777202
         LA    R7,N31                R7= 31 COUNT BITS TO BE FORMATTED  18778002
         L     R2,PSWBUF             R2= FIRST HALF OF THE PSW          18779202
ECLOOP   SRDL  R2,N1                 PLACE 1 BIT INTO REG 3             18781202
         SRL   R3,N31                MOVE BIT T0 LOWER POSITION         18783202
         A     R3,F0MASK             ADD THE 'F' INTO REG 3 (PRINTABLE) 18783602
         STC   R3,ECTEMPST(R7)       PLACE CHARACTER IN TEMPORARY AERA  18784002
         BCTR  R7,N0                 DECREMENT R7 BY ONE (COUNTER)      18784402
         LTR   R7,R7                 IS THE COUNT ZERO                  18784502
         BNM   ECLOOP                NO WE ARE NOT DONE CONTINUE        18784602
         MVC   ECSYSMK2(N8),ECSYSMSK MOVE TO LINE BUFFER                18784702
         MVC   ECAMWP2(N4),ECAMWP    MOVE TO LINE BUFFER                18797702
         MVC   ECSPM2(N1),ECSPM      MOVE TO LINE BUFFER                18807702
         MVC   ECCC2(N2),ECCONDC     MOVE TO LINE BUFFER                18809702
         MVC   ECPROGMK(N4),ECPRGMSK MOVE TO LINE BUFFER                18810102
         L     R10,OUTBUF            R10= ADDR OF THE OUTPUT BUFFER     18810202
         CLI   LINELEN+N3,HEX36      IS LINE LEN LESS THAN HEADER LEN   18810302
         BL    ECBUILD               YES, BUILD A SECOND LINE           18810402
         LA    R2,N53                R2= HEADER LENGTH - 1              18813802
         LA    R3,ECHEADER           R3= ADDRESS OF EC MODE HEADER      18815802
         LA    R6,START2             R6= ADDR OF START OF ACTUAL OUTPUT 18816202
         BAL   R8,PSWIO              PUT OUT THE LINES                  18816602
         B     PSWRET                CONTINUE TO OUTPUT THE LINE        18817202
         SPACE                                                          18817602
****     BUILD TWO LINES OF THE HEADER                                  18819202
ECBUILD  DS    0H                    BUILD TWO LINES OF OUTPUT          18819602
         LA    R2,N31                MINIMUM LINE LENGTH                18820002
         LA    R3,N11(R2)            WILL PROGRAM MASK FIT IN LINE      18820102
         C     R3,LINELEN            DOES THE PROGRAM MASK FIT          18820202
         BH    ECFULINE              NO OUTPUT THE LINE AS IS           18820402
         LR    R2,R3                 YES OUTPUT THE LINE WITH PROG MASK 18821002
ECFULINE DS    0H                    LINE IS FULL AND OUTPUT IS READY   18822602
         BCTR  R2,N0                 OUTPUT DATA LEN -1                 18823302
         LA    R3,ECHEADER           R3= ADDR OF THE EC MODE HEADER     18824002
         LA    R6,START2             R6= ADDR OF START OF ACTUAL OUTPUT 18824602
         BAL   R8,PSWIO              GO AND OUTPUT THE LINES            18826602
         LA    R3,N1(R2,R3)          ADDR OF REMAINING HEADER TO OUTPUT 18828602
         LA    R6,N1(R2,R6)          ADDR OF REMAINING DATA TO OTUPUT   18828702
         LA    R8,N52                MAXIMUM LENGTH OF HEADER MINUS TWO 18832902
         SR    R8,R2                 LENGTH OF THE DATA MINUS ONE       18834902
         LR    R2,R8                 R2= PROPER LENGTH                  18836902
         BAL   R8,PSWIO              OUTPUT THE REMAINING TWO LINES     18837302
         B     PSWRET                RETURN TO CALLER                   18847702
         SPACE                                                          18858402
*********************************************************************** 18868802
*        THE FOLLOWING CODE SETS THE OUTPUT LINE LENGTH               * 18879202
*********************************************************************** 18889602
         SPACE 1                                                        18900002
OUTPUTIT MVC   SYSMASK2(N8),SYSMASK     MOVE TO FIELD BUFFER            18950002
         MVC   AMWP2(N4),AMWP           MOVE TO FIELD BUFFER            19000002
         MVC   ILC2(N2),ILC             MOVE TO FIELD BUFFER            19050002
         MVC   CC2(N2),CC               MOVE TO FIELD BUFFER            19100002
         MVC   PROGM2(N4),PROGMASK      MOVE TO FIELD BUFFER            19150002
         L     R10,OUTBUF               POINT TO OUTPUT BUFFER          19200002
         CLI   LINELEN+N3,HEX43    IS LINE LEN LESS THAN HEADER LEN     19250002
         BL    BUILDIT             YES, GO BUILD 2 OUTPUT LINES         19300002
         LA    R2,N66              OUTPUT DATA LENGTH-1                 19350002
         LA    R3,HEADER           ADDRESS OF HEADER TO PUT OUT         19400002
         LA    R6,START            ADDRESS OF PSW DATA TO PUT OUT       19450002
         BAL   R8,PSWIO            GO PUT OUT LINES                     19500002
         B     PSWRET              GO SET UP FOR RETURN TO CALLER       19550002
BUILDIT  EQU   *                                                        19600002
         LA    R2,N40              MINIMUN LINE LENGTH                  19650002
         LA    R3,N4(R2)           MINMIUN LL PLUS CC FIELD             19700002
         C     R3,LINELEN          WILL CC FIELD FIT IN LINE            19750002
         BH    FULLLINE            NO, LINE FULL, GO PUT OUT            19800002
         LR    R2,R3               LENGTH SO FAR                        19850002
         LA    R3,N11(R2)          LEN SO FAR PLUS PROG MASK FIELD      19900002
         C     R3,LINELEN          WILL PROG MASK FIT IN LINE           19950002
         BH    FULLLINE            NO, LINE FULL, GO PUT OUT            20000002
         LR    R2,R3               YES, PUT IT OUT                      20050002
FULLLINE EQU   *                                                        20100002
         BCTR  R2,N0               OUTPUT DATA LENGTH-1                 20150002
         LA    R3,HEADER           ADDRESS OF HEADER TO PUT OUT         20200002
         LA    R6,START            ADDRESS OF PSW DATA TO PUT OUT       20250002
         BAL   R8,PSWIO            GO PUT OUT LINES                     20300002
         LA    R3,N1(R2,R3)        ADDR OF REST OF HEADER TO PUT OUT    20350002
         LA    R6,N1(R2,R6)        ADDR OF REST OF PSW DATA             20400002
         LA    R8,N65              MAXMIUN LENGTH OF HEADER MINUS 2     20450002
         SR    R8,R2               LEN OF DATA MINUS ONE                20500002
         LR    R2,R8               IN PROPER REGISTER                   20550002
         BAL   R8,PSWIO            GO PUT OUT LAST TWO LINES            20600002
         B     PSWRET              GO SET FOR RETURN TO CALLER          20650002
         EJECT                                                          20700002
*********************************************************************** 20750002
*        THE FOLLOWING ROUTINE BUILDS AND PUTS OUT THE HEADER AND PSW * 20800002
*        LINES.  R2 IS THE LENGTH-1 OF OUTPUT, R3 IS THE STARTING     * 20850002
*        ADDRESS OF THE HEADER AND R6 IS THE STARTING ADDRESS OF THE  * 20900002
*        PSW DATA.  R8 IS THE RETURN ADDRESS.                         * 20950002
*********************************************************************** 21000002
         SPACE 1                                                        21050002
PSWIO    EQU   *                                                        21100002
         L     R10,OUTBUF          ADDRESS OF COMMON TEST OUTPUT BUFF   21150002
         MVI   N0(R10),HEX40       BLANK                                21200002
         MVC   N1(N79,R10),N0(R10)     OUTBUF                           21250002
         EX    R2,MOVE2            MOVE HEADER TO OUTBUF                21400002
         LA    R2,N5(R2)           LENGTH OF OUTPUT FOR I/O             21450002
         SLL   R2,N16              LENGTH IN HIGH ORDER HALF WORD       21500002
         ST    R2,N0(R10)          PREFIX OUTPUT WITH LENGTH            21550002
         BAL   R14,DATAOUT         GO TO I/O ROUTINE, PUT OUT HEADER    21800002
         XC    PRINTFLG(N4),PRINTFLG   REMOVE THE PRINT DSN INDICATOR   21850002
         SRL   R2,N16              LENGTH IN LOW ORDER HALFWORD OF REG  21950002
         SH    R2,FOUR             LEN-1 OF PSW DATA TO MOVE            22000002
         EX    R2,MOVE3            MOVE PSW DATA TO OUTBUF              22050002
         BAL   R14,DATAOUT         GO TO I/O ROUTINE, PUT OUT PSW       22200002
         BR    R8                  YES, RETURN TO CALLER                22350002
         SPACE 1                                                        22400002
*********************************************************************** 22450002
*        DATA IS A CALL TO IKJEGIO USING IKJEGSIO MACRO AND THE DATA    22450402
*        OPTION.  OUTBUF CONTAINS THE DATA PRINTFLG THE DS ADDR         22451202
*********************************************************************** 22452002
         SPACE                                                          22454002
DATAOUT  DS    0H                  OUTPUT THE  DATA LINE                22456002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR THE OUTPUT AREA     22458002
         ST    R14,TEMPWRK         SAVE THE RETURN ADDR                 22458402
         ST    R3,TEMPWRK2         SAVE THE CURRENT R3                  22462102
         L     R3,PRINTFLG         R3= ADDR OF DATA SET FOR IO.         22464102
         EJECT                                                          22465202
         L     R4,OUTBUF           R4=ADDR OF THE OUTPUT                22466702
         IKJEGSIO DATA,DATAPTR=(R4),DSNAME=(R3),ID=PSW25,              *22470402
               MF=(E,TSTIOPRM)     OUTPUT DATA                          22474102
         L     R14,TEMPWRK         PICK UP RETURN ADDR                  22477802
         L     R3,TEMPWRK2         RESTORE THE OLD VALUE TO R3.         22479802
         LTR   R15,R15             WHAT IS THE RETURN CODE              22481502
         BNZ   PSWRET              IF NON-ZERO EXIT                     22485202
         BR    R14                 RETURN TO CALLER                     22488902
         SPACE 1                                                        22492602
*********************************************************************** 22496302
* THE FOLLOWING CODE PROCESSES RETURN CODES AND SETS UP FOR OUTPUT OF * 22500002
* MESSAGES.  PSWRET ANALYSES CODES FROM IKJEGIO1 AND IKJEGCVT.        * 22550002
* PSWRET1 ANALYSES RETURN CODES FROM PARSE.                           * 22600002
*********************************************************************** 22650002
         SPACE 1                                                        22700002
PSWRETRY EQU   *                                                        22750002
         L     R9,CVTPTR           ADDRESS OF CVT                       22800002
         L     R9,CVTTCBP-CVT(R9)  POINTER TO NEW, CURRENT TCBS         22850002
         L     R9,N4(R9)           ADDRESS OF CURRENT TCB IS TEST TCB   22900002
         L     R9,TCBTRN-TCB(R9)   ADDRESS OF TCOMTAB                   22950002
         L     R13,REGSAVE2        ADDRESS OF MY SAVE AREA              23000002
         L     R12,N68(R13)        MY BASE                              23050002
         LA    R8,N20              ABEND RETURN CODE FOR MAINLINE       23100002
         B     RETURN              GO RETURN TO MAINLINE                23300002
EXITERR  EQU   *                                                        23350002
         L     R15,ANSWPLAC        VALIDITY EXIT SAVED RETURN CODE      23400002
PSWRET   EQU   *                                                        23450002
         LA    R8,N16                                                   23500002
         CR    R8,R15              RETURN CODE 16                       23550002
         BNL   RETURN2             IF YES (16 OR GREATER) BRANCH        23600002
         SR    R8,R8               SET RETURN CODE TO 0                 23800002
         B     RETURN              GO SET UP RETURN                     23850002
PSWRET1  EQU   *                   PARSE RETURN CODE ANALYSIS           23900002
         LA    R8,N8               PARSE ATTENTION R.C.                 24050002
         CR    R8,R15              WAS AN ATTENTIOM SCHEDULED           24100002
         LA    R8,N16              MAINLINE ATTENTION RETURN CODE       24150002
         BE    RETURN              IF ATT SCHEDULED, GO SET UP RETURN   24200002
         LA    R8,N20              VALIDITY EXIT SEEKS END, R.C.  PARSE 24250002
         CR    R8,R15              DID VALIDITY EXIT SEEK TERMINATION   24300002
         BE    EXITERR             IF YES, GO SET UP RETURN             24350002
         LA    R8,N16              PARSE R.C. FOR NO CORE AVAILABLE     24400002
         CR    R8,R15              WAS PARSE ABLE TO GET CORE           24450002
         BE    MNLRC24             RETURN TO MNL WITH 24                24550002
         LA    R8,N12              PARSE R.C. FOR INVALID PARAMETERS    24600002
         CR    R8,R15              WERE INVALID PARMS SPECIFIED         24650002
         LA    R2,MSG104           R2= 104 FIRST LEVEL MSG NO.          24700002
         LA    R3,MSG277           R3= 277 SECOND LEVEL MSG NO.         24710002
         LA    R4,INST15           R4= FIXED INST NO. 15 (LISTPSW)      24720002
         BE    MSGOUT              GO HAVE MESSAGE PUT OUT              24750002
         SR    R8,R8               PARSE RC=4, NO MESSAGE               24850002
         OI    TSTFLGS4,TSTFLUSH   IF STACK, TELL MNL TO FLUSH          24900002
         B     RETURN              GO RETURN TO CALLER                  24950002
         SPACE                                                          25210002
MNLRC24  DS    0H                  RETURN WITH A 24                     25220002
         LA    R2,MSG103           R2= 103 ADDR OF NO CORE MSG          25230002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO PARAM AREA        25240002
         IKJEGSIO MSG,FIRST=(R2),ID=PSW25,MF=(E,TSTIOPRM)               25242002
         B     PSWRET              HANDLE IO RETURN CODES               25244002
RETURN   EQU   *                                                        25250002
         LR    R15,R8              RETCODE IN PROPER REGISTER           25350002
RETURN2  DS    0H                  RETURN WITH WHAT IS IN R15           25352002
         NI    TSTFLGS1,(HEXFF-TSTPRINT)                                25352402
*-*-*    ISSUE ESTAE 0 AND TURN OFF TSTRERTN SWITCH                     25354002
         LR    R2,R15              SAVE THE RETURN CODE                 25354402
         ESTAE 0                   REMOVE THE ESTAE                     25356002
         LR    R15,R2              RESTORE THE RETURN CODE              25356402
         NI    TSTFLGS4,(HEXFF-TSTRERTN)  TURN OFF RETRY SWITCH         25358002
         L     R13,N4(R13)                                              25400002
         RETURN  (14,12),T,RC=(15)                                      25450002
         EJECT                                                          25500002
************************************************************            25550002
*                                                          *            25600002
*            MISCELLANEOUS CONSTANTS                       *            25650002
*                                                          *            25700002
************************************************************            25750002
         SPACE 2                                                        25800002
HEADER   DC    C'  XRXXXTIE   KEY  CMWP  INTRPT CODE  ILC  CC  PROG MAS*25850002
               K  INSTR ADDR'                                    YA2414 25900002
ECHEADER DC    C'  XRXXXTIE   KEY  CMWP  SPM  CC  PROG MASK  INSTR ADDR*25920002
               '                                                 YA2414 25922002
OFFSET   EQU   64                  OFFSET OF PSWAREA INTO TEST AREA     25950002
HEX00    EQU   X'00'                                                    26000002
HEX38    EQU   X'38'                                                    26050002
HEX36    EQU   X'36'               HEXIDECIMAL 36                       26060002
HEX43    EQU   X'43'                                                    26100002
HEX40    EQU   X'40'                                                    26150002
PSWLEN   DC    X'0008'             LENGTH OF PSW                        26200002
FLAG     EQU   X'80'               FLAG FOR IKJEGCVT                    26250002
TYPE     EQU   X'04'               TYPE OF VALUE (HEX)                  26300002
ZERO     DC    C'0'                CHARACTER ZERO                       26350002
ONE      DC    C'1'                CHARACTER ONE                        26400002
TABLEVAL DC    X'0A0B04050D06050D' LENGTH OF PSW OUTPUT FIELDS, ONE     26450002
*                                  BYTE PER FIELD IN REVERSE ORDER      26500002
HEXFF    EQU   X'FF'                                                    26550002
ECMODBIT EQU   X'08'                 INDICATES EC MOD PSW               26570002
         DS    0F                  ALIGNMENT                            26572002
SUPERZAP DC    50CL1'Z'            PATCH AREA                           26580002
         DS    0F                  ALIGNMENT                            26582002
F0MASK   DC    X'000000F0'           MASK FOR FORMATTING BITS           26590002
PCLADDR  DC    A(IKJEGPWP)         ADDRESS OF PARSE CSECT               26600002
ABENDTAB DS    0F                                                       26650002
         DC    AL1(99)             LINK FAILED CODE                     26700002
         DC    AL3(PABEND1)        RESUME IC AFTER LINK                 26750002
         DC    AL1(97)             INVALID ADDRESS CODE                 26760002
         DC    AL3(RESTRBLO)       RESUME ADDRESS FOLLOWING PROT CHECK  26770002
         DC    X'FF'               END OF TABLE INDICATOR               26800002
PSWSPL   IKJEGSPL RTRY=PSWRETRY,ABNTB=ABENDTAB,MODNM=IKJEGPSW,         *26850002
               TNM=LISTPSW                                              26950002
MOVE2    MVC   N4(N1,R10),N0(R3)   MOVE HEADER TO OUTBUF                27000002
MOVE3    MVC   N4(N1,R10),N0(R6)   MOVE PSW DATA TO OUTBUF              27050002
FOUR     DC    H'4'                AMOUNT TO SUBTRACT FOR MOVE3         27100002
BLANK    EQU   C' '                                                     27150002
         EJECT                                                          27272202
*********************************************************************** 27282202
*        WORK AREA DESECT                                               27282602
*********************************************************************** 27284202
         SPACE                                                          27284602
PSWAREA  DSECT                                                          27286102
PARSELST DS    7F                  PARSE PARM LIST                      27300002
TEMPWRK2 DS    0F                  ALSO USED FOR TEMP SAVING REGS.      27310002
ANSWPLAC DS    1F                  VALIDITY CHECK EXIT RC FOR MAINLINE  27350002
PSWBUF   DS    2F                  BUFFER FOR PSW                       27400002
* IT IS ESSENTIAL THAT THE FOLLOWING 4 AREAS BE CONTIGUOUS AND IN ORDER 27450002
STRNGPTR DS    1F                  POINTER TO PSW                       27500002
CVTLL    DS    CL2                 LENGTH OF PSW                        27550002
FLAGS    DS    CL1                 FLAG FOR IKJEGCVT                    27600002
TYPECODE DS    CL1                 TYPE CODE (HEX) FOR IKJEGCVT         27650002
LINELEN  DS    1F                  OUTPUT LINE LENGTH                   27700002
PRINTFLG DS    1F                  ADDRESS OF DSNAME PDE OR ZERO        27750002
* IT IS ESSENTIAL THAT THE FOLLOWING 7 AREAS BE CONTIGUOUS AND IN ORDER 27800002
SYSMASK  DS    2F                  PRINTABLE SYSTEM MASK                27850002
         DS    1F                  WORD                                 27900002
AMWP     DS    1F                  PRINTABLE AMWP                       27950002
ILC      DS    CL2                 PRINTABLE ILC                        28000002
CC       DS    CL2                 PRINTABLE CC                         28050002
PROGMASK DS    1F                  PRINTABLE PROGRAM MASK               28100002
TABLE    DS    2F                  TABLE                                28150002
*IT IS ESSENTIAL THAT THE FOLLOWING 17 AREAS BE CONTIGUOUS AND IN ORDER 28200002
START    DS    CL2                 BLANKS                               28250002
SYSMASK2 DS    CL8                 PRINTABLE SYSTEM MASK                28300002
         DS    CL4                 BLANKS                               28350002
KEY      DS    CL1                 PRINTABLE KEY                        28400002
         DS    CL3                 BLANKS                               28450002
AMWP2    DS    CL4                 PRINTABLE AMWP                       28500002
         DS    CL5                 BLANKS                               28550002
INTRPTCD DS    CL4                 PRINTABLE INTERRUPTION CODE          28600002
         DS    CL7                 BLANKS                               28650002
ILC2     DS    CL2                 PRINTABLE INSTRUCTION LENGTH CODE    28700002
         DS    CL2                 BLANKS                               28750002
CC2      DS    CL2                 PRINTABLE CONDITION CODE             28800002
         DS    CL5                 BLANKS                               28850002
PROGM2   DS    CL4                 PRINTABLE PROGRAM MASK               28900002
         DS    CL6                 BLANKS                               28950002
INSTRADR DS    CL6                 PRINTABLE INSTRUCTION COUNTER        29000002
         DS    CL2                 BLANKS                               29050002
* IT IS ESSENTIAL THAT THE FOLLOWING 2 AREAS BE CONTIGUOUS AND IN ORDER 29100002
OUTPTR1  DS    1F                  POINTER TO FIRST OUTPUT BUFFER       29150002
OUTPTR2  DS    1F                  POINTER TO SECOND OUTPUT BUFFER      29200002
PARMPTR  DS    1F                  POINTER TO PARSE PARM LIST    YM4111 29210002
         ORG   PSWAREA             GO BACK TO BEGINNING OF WORK AREA    29250002
TEMPWRK  DS    0H                  LABEL FOR VALIDITY CHECK WORKAERA    29260002
STAELIST DS    4F                  PARAMETER LIST FOR STAE              29300002
* * * * * * * * * ** * * * * * * * * * * * * * * * * * * * * * * * * *  29310002
*        THE FOLLOWING IS A CONTINUATION OF THE PSW WORKAREA DSECT      29312002
*        THIS PORTION IS USED FOR FORMATTING THE EC MODE PSW (AOS/2)    29314002
* * * * * * * * * ** * * * * * * * * * * * * * * * * * * * * * * * * *  29320002
         ORG  SYSMASK              OVERLAY BC MODE AREA                 29330002
ECTEMPST DS   0H                   LABEL FOR MOVING FORMATTED BITS IN   29332002
ECSYSMSK DS   2F                   PRINTABLE SYSMASK AREA               29340002
ECDUMMY1 DS   1F                   FILLER FOR PROTECT AREA              29340402
ECAMWP   DS   1F                   FILLER FOR PROTECT MASK              29342002
ECDUMMY2 DS   CL2                  FILLER FOR UNUSED SPACE              29344002
ECCONDC  DS   CL2                  PRINTABLE CC AREA                    29346002
ECPRGMSK DS   1F                   PRINTABLE PROGRAM MASK AREA          29348002
ECSPM    DS   CL1                  PRINTABLE SEG PROTECTION MODE AREA   29348402
ECDUMMY3 DS   CL7                  FILLER FOR UNUSED SPACE              29348802
****     FORMATTED AREA FOR EC MODE PSW -- KEEP CONTIGUOUS--            29349202
         ORG  START                START OF THE OUTPUT AREA             29349602
START2   DS   CL2                  BLANKS                               29349702
ECSYSMK2 DS   CL8                  FORMATTED PRINTABLE SYSTEM MASK      29349802
         DS   CL4                  BLANKS                               29349902
ECKEY    DS   CL1                  FORMATTED PROTECTION KEY             29366602
         DS   CL3                  BLANKS                               29376602
ECAMWP2  DS   CL4                  FORMATTED AMWP                       29378602
         DS   CL3                  BLANKS                               29380602
ECSPM2   DS   CL1                  FORMATTED SEGMENT PROTECTION MODE    29382602
         DS   CL3                  BLANKS                               29383002
ECCC2    DS   CL2                  FORMATTED CONDITION CODE             29383102
         DS   CL5                  BLANKS                               29388802
ECPROGMK DS   CL4                  FORMATTED PROGRAM MASK               29390802
         DS   CL6                  BLANKS                               29392802
ECINADDR DS   CL6                  FORMATTED INSTRUCTION ADDRESS        29393202
         DS   CL13                 BLANKS                               29393602
IKJEGPSW CSECT                                                          29394402
         EJECT                                                          29400002
*                                                                       29400102
*        PARSE MACROS                                                   29400302
*                                                                       29400702
IKJEGPWP IKJPARM                                                        29400902
PRINTIT  IKJKEYWD                                                       29401302
         IKJNAME  'PRINT',SUBFLD=PRINTDSN                               29401402
PSWADDR  IKJKEYWD                                                       29401502
         IKJNAME  'ADDR',SUBFLD=ADDRPSW                                 29401902
ADDRPSW  IKJSUBF                                                        29402302
ADDRESS  IKJPOSIT  ADDRESS,VALIDCK=PSWVALCK,PROMPT='ADDRESS OF PSW'     29402702
PRINTDSN IKJSUBF                                                        29402802
DSNAME   IKJPOSIT  DSNAME,PROMPT='DATA SET NAME'                        29403202
         IKJENDP                                                        29403602
         SPACE 2                                                        29404002
PDEUSWD  EQU   ADDRESS+N32         IN ADDRESS PDE, USER WORD            29404102
PDEFLAG3 EQU   ADDRESS+N22         IN ADDR PDE, FLAGS FOR ADDR STRING   29404202
         EJECT                                                          29404302
CONAREAD DSECT                       DESCRIBES CONAREA FOR EC MOD PSW   29406002
         SPACE                                                          29408402
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   29411002
*        A DSECT DESCRIBING CONAREA (FROM CONVERT) FOR EC MOD PSW       29413602
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   29416202
         SPACE                                                          29418802
         DS    CL3                   NULL POSITION BLOCK                29421402
CONKEY   DS    CL1                   PRINTABLE PROT KEY                 29424002
         DS    CL5                   NULL POSITION BLOCK                29426602
CONINADR DS    CL8                   PRINTABLE INSTRUCTION ADDRESS      29429202
         EJECT                                                          29431802
**********************************************************************  29434402
*        DSECT DESCRIBING PARSE ADDRESS PDE                             29437002
**********************************************************************  29439602
         SPACE                                                          29442202
         IKJPARMA                                                       29444802
         EJECT                                                          29447402
         TCOMTAB                                                        29450002
         EJECT                                                          29500002
         TSTCWORK                                                       29550002
         EJECT                                                          29600002
         IKJPPL                                                         29650002
         EJECT                                                          29700002
CVT      DSECT                                                          32550002
         CVT                                                            32600002
         EJECT                                                          32650002
         IKJTCB                                                         32700002
         EJECT                                                          32750002
         IKJRB                                                          32800002
         END                                                            32850002
./  ADD  SSI=53150226,NAME=IKJEGQFY
 TITLE 'IKJEGQFY'                                                       00014002
*A65680                                                        @ZA04118 00015003
* /* START OF SPECIFICATIONS ****                                       00016002
*02*  PROCESSOR = ASSEMBLER                                             00018002
**** END OF SPECIFICATIONS ***/                                         00018402
*********************************************************************** 00020002
*                                                                     * 00030002
* STATUS                                                              * 00040002
*    VERSION NO.  00, OS/VS2 RELEASE NO. 02                           * 00050002
*                                                                     * 00060002
* FUNCTION/OPERATION                                                  * 00070002
*    THIS ROUTINE IS CALLED BY THE SUBCOMMAND PROCESSOR (OS TIME-     * 00080002
*    SHARING OPTION FOR MVT) TO SET AND RESET THE BASE ADDRESS USED TO* 00090002
*    RESOLVE RELATIVE AND SYMBOLIC ADDRESSES.  IT CAN ALSO ASSOCIATE  * 00100002
*    THE LOAD MODULE NAME AND CSECT NAME WITH THEIR CURRENT ADDRESS IN* 00110002
*    THE REGION.                                                      * 00120002
*                                                                     * 00130002
* ENTRY POINTS                                                        * 00140002
*         IKJEGQFY - GOES TO PARSE TO EXAMINE THE SUBCOMMAND          * 00150002
*                                                                     * 00160002
* INPUT                                                               * 00170002
*    ONE LINE OF INPUT FROM THE TERMINAL INTO THE INPUT BUFFER        * 00180002
*                                                                     * 00190002
* OUTPUT                                                              * 00200002
*    1.  ERROR MESSAGES TO THE MESSAGE WRITER                         * 00210002
*    2.  RETURN CODES                                                 * 00220002
*    *       0 - SUCCESSFUL COMPLETION OR MODULE NOT FOUND            * 00230002
*    *       4 - QUALIFICATION TO A NEW TCB                           * 00240002
*    *       8 - RETURN CODE TO HAVE PARSE ISSUE A 'REENTER'          * 00250002
*    *      12 - PARSE VALIDITY CHECK EXIT ERROR RETURN CODE          * 00260002
*    *      16 - AN ATTENTION HAS BEEN SCHEDULED                      * 00270002
*    *      24 - ESTAE RETRY HAS INTERCEPTED AN ABEND                 * 00280002
*                                                                     * 00290002
* EXTERNAL REFERENCES                                                 * 00300002
*         IKJPARS - TO SCAN THE INPUT BUFFER FOR SYNTAX CHECKING OF   * 00310002
*         ADDRESSES AND KEYWORD IF SPECIFIED AND TO PROMPT THE USER   * 00320002
*         FOR VALID INPUT WHEN NECESSARY.  AT ENTRY TO IKJPARS, REG   * 00330002
*         ONE POINTS TO A PARAMETER LIST WITH THE FOLLOWING FORMAT -  * 00340002
*         00 - POINTER TO UPT                                         * 00350002
*         04 - POINTER TO ECT                                         * 00360002
*         08 - POINTER TO CP ECB                                      * 00370002
*         12 - POINTER TO PARAMETER DESCRIPTOR LIST (PDL)             * 00380002
*         16 - POINTER TO ANSWER PLACE                                * 00390002
*         20 - POINTER TO COMMAND BUFFER                              * 00400002
*         24 - POINTER TO USERWORK AREA (QUALIFY'S SAVE AREA)         * 00410002
*                                                                     * 00420002
*         IKJEGCVT - CONVERTS AN ABSOLUTE ADDRESS, AN EXPRESSION, AN  * 00430002
*         INDIRECT ADDRESS, OR A FULLY QUALIFIED ADDRESS TO BINARY.   * 00440002
*         AT ENTRY REGISTER ONE CONTAINS THE COMPLEMENT OF THE PDL    * 00450002
*         ADDRESS TO INDICATE AN ADDRESS CONVERSION AND REGISTER ZERO * 00460002
*         IS SET NEGATIVE TO INDICATE CONVERT TO BINARY.              * 00470002
*                                                                     * 00480002
*         IKJEGI01 - OUTPUTS ERROR MESSAGES.  AT ENTRY REGISTER ONE   * 00490002
*         CONTAINS THE ADDRESS OF THE LENGTH FIELD OF THE OUTPUT      * 00500002
*         BUFFER.                                                     * 00510002
*                                                                     * 00520002
*         IKJEGSYM - RESOLVES THE ENTRYNAME ADDRESS ASSOCIATED WITH   * 00530002
*         THE GIVEN LOADNAME.                                         * 00540002
*                                                                     * 00550002
* EXITS,NORMAL                                                        * 00560002
*         RETURN VIA REGISTER 14 TO THE CALLER                        * 00570002
*                                                                     * 00580002
* EXITS,ERROR                                                         * 00590002
*         RETURN TO CALLER VIA REGISTER 14                            * 00600002
*                                                                     * 00610002
* TABLES/WORK AREAS                                                   * 00620002
*    TCOMTAB                                                          * 00630002
*    *    PPTCB - UPDATED WHEN QUALIFICATION IS TO A NEW TCB          * 00640002
*    *    PPRB  - QUALIFICATION IS TO A NEW TCB                       * 00650002
*    *    PPLOAD - UPDATED FOR ALL QUALIFICATION                      * 00660002
*    *    TSTSYMBA - UPDATED FOR LOADNAME/LOADNAME.ENTRYNAME          * 00670002
*    *               QUALIFICATION.                                   * 00680002
*    *    TSTCURLD - UPDATED FOR QUALIFICATION TO A NEW LOADNAME      * 00690002
*    *    TSTCURCT - UPDATED FOR QUALIFICATION TO A NEW ENTRYNAME     * 00700002
*                                                                     * 00710002
*    WORKSP - QUALIFY WORKAREA                                        * 00720002
*                                                                     * 00730002
* ATTRIBUTES                                                          * 00740002
*    REENTRANT                                                        * 00750002
*                                                                     * 00760002
* CHARACTER CODE DEPENDENCY                                           * 00770002
*    THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL            * 00780002
*    REPRESENTATION OF THE EXTERNAL CHARACTER SET WHICH IS            * 00790002
*    EQUIVALENT TO THE ONE USED AT ASSEMBLY TIME. THE CODING HAS BEEN * 00800002
*    ARRANGED SO THAT REDEFINITION OF 'CHARACTER' CONSTANTS, BY       * 00810002
*    REASSEMBLY, WILL RESULT IN A CORRECT MODULE FOR THE NEW          * 00820002
*    DEFINITIONS.                                                     * 00830002
*                                                                     * 00840002
* NOTES                                                               * 00850002
*                                                                     * 00860002
*********************************************************************** 00870002
         EJECT                                                          00880002
         COPY IKJEGSIO             OBTAIN CALLING MACROS                00882002
IKJEGQFY CSECT                                                          00890002
ZERO     EQU   0                        PARAMETER REGISTER              00900002
PARAMREG EQU   1                        PARAMETER REGISTER              00910002
WORKE    EQU   2                        EVEN WORK REGISTER              00920002
WORKO    EQU   3                        ODD WORK REGISTER               00930002
REG4     EQU   4                        WORK REGISTERS                  00940002
REG5     EQU   5                        *                               00950002
REG6     EQU   6                        *                               00960002
REG7     EQU   7                        *                               00970002
REG8     EQU   8                        *                               00980002
REG9     EQU   9                        POINTER TO TCOMTAB              00990002
REG10    EQU   10                       POINTER TO WORK AREA            01000002
R11      EQU   11                       WORK REGISTER - POINTER TO PDL  01010002
BASEREG  EQU   12                       BASE FOR CSECT                  01020002
SAVEREG  EQU   13                       SAVE AREA ADDRESS REG           01030002
RETREG   EQU   14                       ADDRESS OF RETURN POINT         01040002
ADDREG   EQU   15                       ADDRESS REGISTER                01050002
RETCODE EQU    15                       RETURN CODE REGISTER            01060002
         SPACE                                                          01070002
* FIELD AND NUMBER EQUATES                                              01080002
ONE      EQU   1                        ONE                             01090002
TWO      EQU   2                        NUMBER 2                        01100002
THREE    EQU   3                        NO. 3                           01110002
PARSCODE EQU   3                        PARSE LINK FAILED CODE          01120002
FOUR     EQU   4                        FOUR                            01130002
TCBADR   EQU   4                        DISPLACEMENT FOR CURRENT        01140002
*                                       TCB ADDR                        01150002
FIVE     EQU   5                        NO. 5                           01160002
SIX      EQU   6                        SIX                             01170002
EIGHT    EQU   8                        EIGHT                           01180002
SYMCODE  EQU   8                        SYM LINK FAILED CODE            01190002
NINE     EQU   9                        NINE                            01200002
TEN      EQU   10                       TEN                             01210002
TWELVE   EQU   12                       NUMBER 12                       01220002
N14      EQU   14                       NUMBER 14                       01230002
SIXTEEN  EQU   16                       SIXTEEN                         01240002
TWENTY   EQU   20                       NO. 20                          01250002
THIRTY2  EQU   32                       OFFSET FOR MESSAGE              01260002
FORTY    EQU   40                       OFFSET                          01270002
FIFTY6   EQU   56                       NUMBER 56                       01280002
FIFTY8   EQU   58                       NUMBER 58                       01290002
SIXTY    EQU   60                       NO. 60                          01300002
OFFSET   EQU   64                       OFFSET INTO COMMON WORK AREA    01310002
SIXTY8   EQU   68                       NUMBER 68                       01320002
REG15    EQU   15                       USED FOR REGISTER 15            01322002
REG2     EQU   2                        USED FOR REGISTER 2             01322402
I0010    EQU   10                       INSERT NUMBER 10 WITHIN I/O     01324002
I0040    EQU   40                       INSERT NUMBER 40 WITHIN I/O     01326002
I0085    EQU   85                       INSERT NUMBER 85 WITHIN I/O     01328002
M0026    EQU   26                       MESSAGE NUMBER 26 WITHIN I/O    01328402
M0025    EQU   25                       MESSAGE NUMBER 25 WITHIN I/O    01328802
M0227    EQU   227                      MESSAGE NUMBER 227 WITHIN I/O   01329202
M0103    EQU   103                      MESSAGE NUMBER 103 WITHIN I/O   01329602
M0296    EQU   296                      MESSAGE NUMBER 296 WITHIN I/O   01329702
M0268    EQU   268                      MESSAGE NUMBER 268 WITHIN I/O   01329802
M0226    EQU   226                      MESSAGE NUMBER 226 WITHIN I/O   01329902
BADESTAE EQU   24                       CODE FOR UNABLE TO ISSUE ESTAE  01333202
HEX03    EQU   X'03'                    INDICATES FULLWORD BOUNDARY     01336702
REGTYPE  EQU   X'38'                    INDICATES REGISTER TYPE ADDR    01340002
LLCHAIN  EQU   0                        POINTER TO NEXT LLE             01360002
LLCDPTR  EQU   4                        POINTER TO CDE FROM LLE         01370002
CDATTRX  EQU   0                        ATTRIBUTES FOUND IN CDE         01380002
ZEROIT   EQU   X'00'                    ZERO                            01390002
ZEROBYTE EQU   X'00'                    BYTE OF ZEROES                  01400002
HEX01    EQU   X'01'                    MASK FOR TESTING P-BIT OF       01410002
*                                       PSW'S AMWP FIELD                01420002
NOPRINT  EQU   X'20'                    NOPRINT SETTING                 01430002
PRINT    EQU   X'DF'                    SETTING TO RESET SWITCH         01440002
ONBIT    EQU   X'80'                    INDICATES HIGH ORDER BIT ON     01450002
MINOR    EQU   X'04'                    MINOR CDE                       01460002
HEXF0    EQU   X'F0'                    MASK FOR PROTECTION KEY OF PSW  01470002
HEXFF    EQU   X'FF'                    STAE ADDR TABLE END INDICATOR   01480002
CDNAMEX  EQU   8                        MODULE OR ALIAS NAME            01490002
CDXL     EQU   20                       POINTER TO EXTENT LIST          01500002
XLCSECTS EQU   4                        NUMBER OF CSECTS                01510002
BLANK    EQU   C' '                     BLANK                           01520002
L1       EQU   1                        LENGTH OF 1                     01540002
L3       EQU   3                        LENGTH OF 3                     01550002
L4       EQU   4                        LENGTH OF 4                     01560002
L6       EQU   6                        LENGTH OF 6                     01570002
L7       EQU   7                        LENGTH OF 7                     01580002
L8       EQU   8                        LENGTH OF 8                     01590002
         SPACE                                                          01600002
         SAVE  (14,12),,IKJEGQFY        SAVE REGISTERS                  01610002
         LR    BASEREG,ADDREG           SET UP ADDRESSABILITY           01620002
         USING IKJEGQFY,BASEREG         *                               01630002
         USING TCOMTAB,REG9             SET UP ADDRESSABILITY TO        01640002
*                                          COMMUNICATION WORK AREA      01650002
         L     REG5,REGSAVE2            GET POINTER TO MY SAVE AREA     01660002
         ST    SAVEREG,FOUR(ZERO,REG5)  SAVE ADDR OF CALLER'S SAVE AREA 01670002
         ST    REG5,EIGHT(SAVEREG)      SAVE ADDR OF MY SAVE AREA       01680002
         LR    SAVEREG,REG5             PUT ADDRESS OF MY SAVE AREA     01690002
*                                          IN REGISTER 13               01700002
         L     REG10,WORKAREA           GET ADDRESS OF COMMON WORK AREA 01710002
         USING TSTCWORK,REG10           ESTABLISH ADDRESSABILITY TO     01720002
*                                          WORK AREA                    01730002
         LA    REG10,CWORKCMD           R10=ADDRESS OF QUALIFY'S WORK   01740002
*                                          AREA                         01750002
         DROP  REG10                                                    01760002
         USING WORKSP,REG10             SET UP ADDRESSABILITY TO MY     01770002
*                                          WORK AREA                    01780002
         SAVE  (14,12)                  SAVE REGISTERS IN MY SAVE AREA  01790002
*                                          IN CASE STAE EXIT GETS       01800002
*                                          CONTROL                      01810002
         SPACE                                                          01820002
         MVC   PPTCBSAV(FOUR),PPTCB        SAVE CURRENT PPTCB           01830002
         MVC   PPRBSAV(FOUR),PPRB          SAVE CURRENT RB PTR          01840002
         SPACE                                                          01850002
*                                                                       01860002
*        ISSUE STAE FOR PARSE AND SYM LINK                              01870002
*                                                                       01880002
         SPACE                                                          01920002
         L     REG4,TSTSTAE             GET ADDR OF STAE EXIT           01940002
*                                       ROUTINE                         01950002
         LA    ADDREG,BLDMSG            GET WKAREA ADDR                 01960002
         MVC   ZERO(STAELEN,ADDREG),STAELIST  MOVE STAE LIST            01970002
         SPACE                                                          01980002
         ESTAE (4),CT,PARAM=IKJEGSPL,XCTL=NO,RECORD=YES,MF=(E,(15))     01990002
         SPACE                                                          02000002
         LTR   RETCODE,RETCODE          CHECK FOR A VALID RETURN        02010002
*                                       CODE                            02020002
SMTSTAE  DS    0H                       SMT TEST LABEL FOR STAE MACRO   02030002
         BZ    SETUP                    YES...                          02040002
         STC   REG15,TSTESTRC           SAVE RETURN CODE FOR MAINLINE   02042002
         LA    REG15,BADESTAE           SEND BACK RETURN CODE 24        02044002
         B     QFYRET                   RETURN TO CALLER                02046002
         SPACE                                                          02090002
* THIS SECTION PREPARES FOR PASSING CONTROL TO THE PARSE ROUTINE        02100002
         SPACE                                                          02110002
SETUP    DS    0H                       SET UP FOR PARSE                02120002
         DROP  REG10                                                    02130002
         SPACE                                                          02140002
         USING PPLUPT,REG10             SET UP ADDRESSABILITY TO        02150002
*                                       PARSE PARAMETER LIST            02160002
         SPACE                                                          02170002
         MVC   PPLUPT(FOUR),TSTUPT      MOVE USER PROFILE TABLE INTO    02180002
*                                       WORKAREA                        02190002
         MVC   PPLECT(FOUR),TSTECT      MOVE ENVIRONMENT CONTROL TABLE  02200002
         MVC   PPLECB(FOUR),TSTCPECB    MOVE COMMAND PROCESSOR EVENT    02210002
*                                       CONTROL BLOCK                   02220002
         MVC   PPLPCL(FOUR),PCLISTA     MOVE ADDR OF PARAMETER CONTROL  02230002
*                                       LIST                            02240002
         LA    REG4,TSTANSPL            GET PTR TO ANSWER PLACE         02250002
         ST    REG4,PPLANS              STORE IN WORKAREA               02260002
         MVC   PPLCBUF(FOUR),INBUF      MOVE PTR TO COMMAND BUFFER      02270002
         ST    SAVEREG,PPLUWA           SAVE PTR TO QUALIFY'S WORKAREA  02280002
         DROP  REG10                                                    02290002
         USING WORKSP,REG10             SET UP ADDRESSABILITY TO        02300002
*                                       WORKAREA                        02310002
         LR    PARAMREG,REG10           PUT ADDRESS OF PARAMETER LIST   02320002
*                                          INTO REGISTER 1              02330002
         LINK  EP=IKJPARS,ERRET=LKFAIL1 GO TO PARSE ROUTINE             02340002
PARSBLOW DS    0H                                                       02340402
         B     LINKOK1                  IF CONTROL COMES HERE OK - GO   02342002
LKFAIL1  DS    0H                                                       02344002
         LR    REG6,PARAMREG            TRANSFER ABEND CODE             02346002
         LR    REG4,RETCODE             TRANSFER RETURN CODE            02346402
         XC    TSTIOPRM,TSTIOPRM        ZERO OUT PARM LIST              02348002
         IKJEGSIO SVCERR,SVC=6,ABENDRG=(REG6),INST11=(NUM,I0040), CALL *02348402
               RC=(REG4),ID=QFY26,MF=(E,TSTIOPRM) FOR ERROR MSG         02348802
         CH    RETCODE,H16              TEST FOR SUCCESSFUL IO CALL     02349202
         BL    QFYCCO                   BRANCH TO ZERO OUT RTN CODE     02349602
         B     QFYRET                   GO BACK WITH RETURN CODE        02349702
LINKOK1  DS    0H                                                       02349802
         SPACE                                                          02350002
SMTPARS  DS    0H                       SMT TEST LABEL FOR PARSE LINK   02360002
         SPACE                                                          02370002
         LTR   RETCODE,RETCODE          DID PARSE COMPLETE SUCCESSFULLY 02390002
         BNZ   CHKCODE                  NO, FIND TYPE OF ERROR          02400002
         L     R11,TSTANSPL             GET ADDRESS OF PDL              02410002
         USING IKJPARMD,R11             GET ADDRESSABILITY TO PDL       02420002
         LA    R11,ADDR                 R11=ADDRESS OF ADDRESS PDE      02430002
         DROP  R11                                                      02440002
         USING IKJPARMA,R11             GET ADDRESSABILITY TO PDE       02450002
         SPACE                                                          02460002
CHECKADR DS    0H                       CHECK FOR ARGUMENT BEING LOAD-  02470002
*                                          NAME OR ADDRESS              02480002
         CLC   PDEUSER(L4),NOBINARY     IS ARGUMENT BINARY ADDRESS      02490002
         BE    CHKSYM                   NO, CHECK FOR SYMBOL.SYMBOL     02500002
         L     WORKE,PDEUSER            PICK UP CONVERTED ADDRESS       02510002
         LA    WORKE,ZERO(ZERO,WORKE)   CLEAR HIGH ORDER BYTE OF REG    02520002
         ST    WORKE,PPLOAD             STORE ADDRESS IN FIELD OF       02530002
*                                          TCOMTAB FOR CURRENTLY        02540002
*                                          QUALIFIED BASE FOR RELATIVES 02550002
         SPACE                                                          02560002
         DROP  R11                      DROP ADDRESS PDE BASE           02570002
         L     R11,TSTANSPL             R11 = ADDRESS OF PDL            02580002
         USING IKJPARMD,R11             GET ADDRESSABILITY TO PDL       02590002
         SR    REG4,REG4                CLEAR REG                       02600002
         CH    REG4,TCBNAME             WAS TCB SPECIFIED W/O LOADNM    02610002
         SPACE                                                          02620002
         LA    R11,ADDR                 SET R11 TO ADDR OF PDE          02630002
         DROP  R11                      DROP PDL ADDRESSABILITY         02640002
         USING IKJPARMA,R11             SET UP ADDRESSABILITY TO PDE    02650002
         SPACE                                                          02660002
         BE    SYMCHK                   TCB NOT SPECIFIED...            02670002
         SPACE                                                          02680002
         TM    PDEFLG1,ONBIT            WAS ADDR FULLY QUALIFIED        02690002
         BZ    TCBINVAL                 NO, PUT OUT 'TCB INVALID' MSG   02700002
         SPACE                                                          02710002
         LA    REG4,M0026               GET MESSAGE NUMBER INTO REG     02720002
         LA    REG5,M0227               GET MESSAGE NUMBER INTO REG     02726002
         B     PUTMSG                   PRINT INFORMATION MSG           02730002
         SPACE                                                          02740002
TCBINVAL DS    0H                                                       02752002
         LA    REG4,M0025               GET MESSAGE NUMBER INTO REG     02754002
         SR    REG5,REG5                INDICATE NO SECOND LEVEL        02756002
*                                       INVALID' MSG                    02760002
         B     PUTMSG                   PRINT ERROR MESSAGE             02770002
         SPACE                                                          02780002
SYMCHK   TM    PDEFLG3,ONBIT            TEST FOR .CSECT.SYMBOL          02790002
         BO    QFYCCO                   YES...RETURN                    02800002
         SPACE                                                          02810002
         TM    PDEFLG4,RELADDR          TEST FOR RELATIVE ADDR          02820002
         BO    QFYCCO                   YES...                          02830002
         SPACE                                                          02840002
         ST    WORKE,TSTSYMBA           QUALIFICATION MUST BE           02850002
*                                       .ENTRYNAME...SAVE NEW BASE      02860002
*                                       FOR SYMBOLICS                   02870002
         MVI   TSTCURCT,BLANK           BLANK OUT CSECTNAME IN          02880002
         MVC   CSECTNM1(L7),TSTCURCT    TCOMTAB                         02890002
         LA    REG4,TSTCURCT            GET FIELD ADDR                  02900002
         LH    REG5,PDELEN2             AND LENGTH OF CSECT NAME        02910002
         BCTR  REG5,ZERO                DECREMENT BY 1 FOR MOVE         02920002
         L     WORKO,PDECTNAM           GET PTR TO NAME                 02930002
         EX    REG5,EXMOVE              MOVE CSECT NAME TO TCOMTAB      02940002
         B     QFYCCO                   GO TO WRAP UP ROUTINE           02950002
         SPACE                                                          02960002
CHKCODE  DS    0H                       EXAMINE RETURN CODE FROM PARSE  02970002
         STC   RETCODE,CODESAVE         SAVE RETURN CODE                02980002
         LA    REG5,RTNCODE             GO TO PROPER BRANCH             02990002
RTNCODE  B     ZERO(RETCODE,REG5)       IN BRANCH TABLE                 03000002
         SPACE                                                          03010002
         B     RC04                     RC=4  UNABLE TO PROMPT          03020002
         B     CODE16                   RC=8  ATTN SCHEDULED            03030002
         B     NOPARSE                  RC=12 UNABLE TO PARSE           03040002
         B     NOCORE                   RC=16 NO CORE AVAILABLE         03050002
NOCONVRT DS    0H                       RC=20 CONVERT FAILED            03060002
         SPACE                                                          03070002
         CLI   CONVRTCD,SIXTEEN         GET RETURN CODE SAVED           03080002
*                                       FROM BAD CONVERT                03090002
         BL    QFYCCO                   IF 0,4,8, OR 12, SET RETURN     03100002
*                                       CODE TO 0 FOR MAINLINE          03110002
         SR    RETCODE,RETCODE          ZERO OUT HIGH ORDER BYTES       03120002
         IC    RETCODE,CONVRTCD         PICK UP RETURN CODE FOR MNL     03134002
         B     QFYRET                   RETURN TO MAINLINE              03138002
         SPACE                                                          03180002
RC04     OI    TSTFLGS4,TSTFLUSH        INITILIAZE STACK FLUSH          03190002
*                                       FOR MAINLINE                    03200002
         B     QFYCCO                   RETURN TO MAINLINE              03210002
         SPACE                                                          03220002
NOCORE   DS    0H                       STORAGE NOT AVAILABLE           03230002
         LA    REG4,M0103               GET MESSAGE NUMBER INTO REG     03260002
         SR    REG5,REG5                INDICATE NO SECOND LEVEL MSG    03262002
         B     PUTMSG                   BRANCH TO ISSUE MESSAGE         03264002
         SPACE                                                          03270002
CODE16   DS    0H                       SET RETURN CODE TO 16 FOR       03280002
*                                          ATTENTION SCHEDULED          03290002
         XR    RETCODE,RETCODE          CLEAR REGISTER                  03300002
         LA    RETCODE,SIXTEEN(ZERO,RETCODE) SET RETURN CODE TO 16      03310002
*                                          FOR ATTENTION SCHEDULED      03320002
         B     QFYRET                   GO TO WRAP UP PROCEDURE         03330002
         SPACE                                                          03340002
NOPARSE  DS    0H                       UNABLE TO PARSE                 03350002
         XC    TSTIOPRM,TSTIOPRM        CLEAR PARM LIST FOR I/O CALL    03360002
         IKJEGSIO MSG,FIRST=M0104,INST11=(NUM,I0010), CALL I/O         *03370002
               SECOND=M0277,ID=QFY26,MF=(E,TSTIOPRM) TO ISSUE ERR MSG   03380002
         CH    REG15,H16                TEST FOR SERIOUS ERROR          03400002
         BL    QFYCCO                   IF NOT CONTINUE                 03410002
         B     QFYRET                   IF SERIOUS RTN TO MAINLINE      03420002
         SPACE                                                          03570002
PUTMSG   DS    0H                                                       03572002
         XC    TSTIOPRM,TSTIOPRM        CLEAR PARM LIST FOR I/O CALL    03574002
         IKJEGSIO MSG,FIRST=(REG4),     CALL I/O                       *03576002
               SECOND=(REG5),ID=QFY26,MF=(E,TSTIOPRM) TO ISSUE ERR MSG  03578002
         CH    REG15,H16                TEST FOR SERIOUS ERROR          03578802
         BL    QFYCCO                   IF NOT CONTINUE                 03579202
         B     QFYRET                   IF SERIOUS RTN TO MAINLINE      03579602
CHKSYM   DS    0H                       CHECK FOR SYMBOL.SYMBOL         03580002
         TM    PDEFLG2,ONBIT            IS THERE AN ENTRYNAME           03590002
*                                          PARAMETER IN THE PDE         03600002
         BO    MOVENM                   YES, ARGUMENT IS                03610002
*                                          LOADNAME.CSECTNAME           03620002
ONLYSYM  DS    0H                       FOUND PDE TO CONTAIN ONLY A     03630002
*                                          SYMBOL                       03640002
         LM    WORKE,WORKO,PDEADRPT     PICK UP PTR TO SYMBOL AND FLAGS 03650002
         STM   WORKE,WORKO,PDELDNAM     STORE IN LOADNAME ENTRIES OF    03660002
*                                          PDE                          03670002
         MVI   PDEADRPT,ZEROIT          CLEAR OUT STRING FIELD          03680002
         MVC   STRING1(L7),PDEADRPT     COMPLETE CLEARING FIELD         03690002
         SPACE                                                          03700002
MOVENM   DS    0H                       MOVE LOADNAME TO TEST FIELD     03710002
         MVI   NEWLOAD,BLANK            BLANK OUT NEWLOAD FIELD IN      03720002
         MVC   NEWLOAD1(L7),NEWLOAD        THE WORK AREA                03730002
         LH    WORKE,PDELEN1            PICK UP LENGTH OF LOADNAME      03740002
         L     WORKO,PDELDNAM           GET POINTER TO NAME             03750002
         LA    REG4,NEWLOAD             GET ADDR OF WORK AREA FIELD     03760002
         BCTR  WORKE,ZERO               DECREMENT LENGTH BY ONE         03770002
         EX    WORKE,EXMOVE             MOVE NEW NAME TO WORK AREA      03780002
         DROP  R11                                                      03790002
         L     R11,TSTANSPL             R11=ADDRESS OF PDL              03800002
         USING IKJPARMD,R11             GET ADDRESSABILITY TO PDL       03810002
         SPACE                                                          03820002
ISTCB    DS    0H                       CHECK FOR TCB SPECIFIED         03830002
         XR    REG4,REG4                CLEAR REGISTER                  03840002
         CH    REG4,TCBNAME             WAS TCB PARAMETER GIVEN         03850002
         BNE   YESTCB                   YES, SET UP SEARCH FOR NAME     03860002
         LA    R11,ADDR                 R11=ADDRESS OF ADDRESS PDE      03870002
         DROP  R11                                                      03880002
         USING IKJPARMA,R11             GET ADDRESSABILITY TO PDE       03890002
         MVI   TCBFLG,TCBNOSP           INDICATE TCB NOT SPECIFIED      03900002
         EJECT                                                          03910002
*****************************************************************       03920002
*                                                               *       03930002
*        THIS ROUTINE INITIALIZES A SEARCH FOR THE LOADNAME     *       03940002
*        THROUGH EACH TASK UNDER THE TEST TCB.                  *       03950002
*                                                               *       03960002
*****************************************************************       03970002
         SPACE                                                          03980002
         L     WORKO,TSTTCB             GET THE ADDR OF TEST'S TCB      03990002
*                                       FROM TCOMTAB                    04000002
         USING TCB,WORKO                SET UP ADDRESSABILITY TO TCB    04010002
         SPACE                                                          04020002
DAUGHTER L     WORKE,D(WORKO)           GET ADDR OF DAUGHTER TCB        04030002
         LTR   WORKE,WORKE              IS THERE A DAUGHTER             04040002
         BNZ   SETSRCH                  YES...GO SEARCH FOR LOADNAME    04050002
         SPACE                                                          04060002
SISTER   L     WORKE,S(WORKO)           GET ADDR OF SISTER TCB          04070002
         LTR   WORKE,WORKE              IS THERE A SISTER               04080002
         BNZ   SETSRCH                  YES...SEARCH FOR LOADNAME       04090002
         SPACE                                                          04100002
MOTHER   CLC   M+ONE(THREE,WORKO),TSTTCB+ONE  DOES MOTHER = TEST TCB    04110002
         BE    NOFIND                   YES...PUT OUT ' NO FIND' MSG    04120002
         SPACE                                                          04130002
         L     WORKO,M(WORKO)           NO...GET ADDR OF MOTHER TCB     04140002
         B     SISTER                   SEARCH 'SISTER' CHAIN           04150002
         SPACE                                                          04160002
SETSRCH  ST    WORKE,TCBUSED            SAVE TCB ADDRESS                04170002
         DROP  WORKO                    DROP ADDRESSABILITY TO          04180002
*                                       TEST'S TCB                      04190002
         USING TCB,WORKE                ADDRESSABILITY FOR TCB BEING    04200002
*                                       USED                            04210002
         CLC   TCBUSED+ONE(THREE),ONE(WORKE)   IS THERE AN RB           04220002
         BE    NORB                     NO....(TCBRBP FIELD POINTS      04230002
*                                       TO THE TCB ITSELF RATHER THAN   04240002
*                                       TO AN RB)                       04250002
         SPACE                                                          04260002
         TM    TCBFLGS5,TCBFC           IS THIS TASK TERMINATED         04270002
         BNO   SEARCHRB                 NO...SEARCH THE RB CHAIN        04280002
*                                       FOR THIS TCB                    04290002
         SPACE                                                          04300002
NORB     LR    WORKO,WORKE              INITIALIZE TO SEARCH FOR        04310002
         B     DAUGHTER                 THE NEXT LOWER TCB              04320002
         EJECT                                                          04330002
*********************************************************************   04340002
*                                                                   *   04350002
* THE SEARCH IS NOW BEGUN THROUGH RB'S AND LLE'S TO GET TO CDE'S AND*   04360002
* LOOK FOR MATCHING LOADNAME                                        *   04370002
*                                                                   *   04380002
*********************************************************************   04390002
         SPACE                                                          04400002
SEARCHRB DS    0H                       BEGIN SEARCH OF RB CHAIN        04410002
         L     WORKO,TCBRBP             GET PTR TO RB QUE               04420002
         USING RBSECT,WORKO             SET UP ADDRESSABILITY           04430002
         SPACE                                                          04440002
ISRBOK   DS    0H                       CHECK FOR TYPE OF RB            04450002
         TM    RBSTAB1,RBFTP            IS RB A PRB                     04460002
         BNZ   NEXTRB                   NO, CHECK FOR NEXT RB           04470002
         SPACE                                                          04480002
GETCODE  L     REG4,RBCDE               GET PTR TO CDE                  04490002
         BAL   REG8,GETXL               BRANCH TO EXAMINE CDE           04500002
         SPACE                                                          04510002
NEXTRB   DS    0H                       SET UP FOR SEARCHING NEXT RB    04520002
         L     WORKO,RBLINK             GET PTR TO NEXT RB              04530002
         LA    WORKO,ZERO(ZERO,WORKO)   CLEAR HIGH ORDER BYTE           04540002
         CLR   WORKO,WORKE              IS POINTER TO TCB               04550002
         BE    CHKLLE                   YES, BEGIN SEARCH THRU LOAD     04560002
*                                          LIST                         04570002
         BNE   ISRBOK                   NO, CHECK FOR TYPE OF RB        04580002
         SPACE                                                          04590002
         DROP  WORKO                                                    04600002
         SPACE                                                          04610002
GETXL    DS    0H                       LOOK FOR LOAD NAME              04620002
         USING CDENTRY,REG4             SET UP ADDRESSABILITY           04622002
         L     REG5,CDXLMJP             PICK UP XL POINTER              04630002
TESTNM   DS    0H                       CHECK FOR NAME                  04640002
         CLC   CDNAME,NEWLOAD           DO LOADNAMES MATCH              04650002
         BE    CHKATTR                  YES, CHECK ATTRIBUTES           04660002
         TM    CDATTR,MINOR             IS THIS A MINOR CDE             04670002
         BO    MINORCDE                 YES, MINOR CDE                  04680002
         BR    REG8                     NO, RETURN TO CALLER            04690002
         SPACE                                                          04700002
MINORCDE DS    0H                                                       04710002
         LR    REG4,REG5                THIS IS A MINOR CDE             04720002
         B     GETXL                    CHECK LOADNAME IN MAJOR CDE     04730002
         SPACE                                                          04740002
CHKATTR  DS    0H                       LOADNAMES MATCHED - FIND XL     04750002
         TM    CDATTR,MINOR             IS THIS A MINOR CDE             04760002
         BZ    GOTOXL                   NO GO TO XL                     04770002
         DROP  REG4                                                     04770402
         USING CDENTRY,REG5             SET UP ADDRESSABILITY           04772002
         L     REG5,CDXLMJP             THIS IS A MINOR CDE, GET PTR    04780002
*                                          TO XL                        04790002
         SPACE                                                          04800002
GOTOXL   DS    0H                       GET FIRST CSECT ADDRESS FROM XL 04810002
         LA    REG6,FOUR                PUT A FOUR IN REG               04820002
         DROP  REG5                                                     04822002
         USING XTLST,REG5               SET UP ADDRESSABILITY           04824002
         L     REG7,XTLNRFAC            PICK UP NUMBER CSECTS           04830002
         DROP  REG5                                                     04832002
         LA    REG7,TWO(ZERO,REG7)      ACCOUNT FOR PRECEEDING 8 BYTES  04840002
         MR    REG6,REG6                GET DISPLACEMENT INTO XL        04850002
*                                          FOR ADDRESS OF FIRST CSECT   04860002
         L     REG7,ZERO(REG7,REG5)     PICK UP ADDRESS OF FIRST CSECT  04870002
         ST    REG7,CSECTADR            SAVE ADDRESS OF CSECT           04880002
         B     CHKCSECT                 CHECK FOR CSECT GIVEN           04890002
         SPACE                                                          04900002
CHKLLE   DS    0H                       RB CHAIN EXHAUSTED WITHOUT A    04910002
*                                          MATCH - BEGIN SEARCH THRU    04920002
*                                          LLE'S                        04930002
         L     REG4,TCBLLS              GET PTR TO LOAD LIST            04940002
TESTREG  LTR   REG4,REG4                HAS A MODULE BEEN LOADED        04950002
         BZ    NOMATCH                  NO, UNSUCCESSFUL SEARCH         04960002
         LR    REG6,REG4                SAVE LOAD LIST ADDR             04970002
         USING LLE,REG4                 SET UP ADDRESSABILITY           04972002
         L     REG4,LLECDPT             GET POINTER TO CDE              04980002
         BAL   REG8,GETXL               BRANCH TO EXAMINE CDE           04990002
NEXTLLE  DS    0H                       GET POINTER TO NEXT LLE         05000002
         LR    REG4,REG6                RESTORE LOAD LIST ADDR          05010002
         L     REG4,LLECHN              PICK UP POINTER                 05020002
         B     TESTREG                  CHECK FOR MODULE BEING LOADED   05030002
         DROP  REG4                                                     05032002
         SPACE                                                          05040002
* THIS CODE IS ENTERED WHEN IT IS INITIALLY DETERMINED THAT A TCB       05050002
* ADDRESS WAS SPECIFIED.                                                05060002
         SPACE                                                          05070002
YESTCB   DS    0H                       BEGIN PREPARATION TO SEARCH     05080002
*                                          FROM SPECIFIED TCB THROUGH   05090002
*                                          RB'S AND LLE'S TO CDE'S TO   05100002
*                                          FIND MATCHING LOADNAME       05110002
         MVI   TCBFLG,TCBGIVEN          SET SWITCH TO INDICATE TCB      05120002
*                                          SPECIFIED                    05130002
         DROP  R11                                                      05140002
         L     R11,TSTANSPL             R11=ADDRESS OF PDL              05150002
         USING IKJPARMD,R11             GET ADDRESSABILITY TO PDL       05160002
         LA    R11,ADDRTCB              R11=ADDRESS OF TCB PDE          05170002
         DROP  R11                                                      05180002
         USING IKJPARMA,R11             GET ADDRESSABILITY TO PDE       05190002
         L     WORKE,PDEUSER            GET BINARY ADDRESS OF TCB       05200002
         ST    WORKE,TCBUSED            SAVE TCB ADDRESS                05210002
         LA    WORKE,ZERO(ZERO,WORKE)   ZERO HIGH ORDER BYTE            05212002
         DROP  R11                                                      05220002
         L     R11,TSTANSPL             R11=ADDRESS OF PDL              05230002
         USING IKJPARMD,R11             GET ADDRESSABILITY TO PDL       05240002
         LA    R11,ADDR                 R11=ADDRESS OF ADDRESS PDE      05250002
         DROP  R11                                                      05260002
         USING IKJPARMA,R11             GET ADDRESSABILITY TO PDE       05270002
         B     SEARCHRB                 BEGIN SEARCH OF RB CHAIN        05280002
         SPACE                                                          05290002
* THIS CODE IS ENTERED WHEN A SEARCH THROUGH RB QUEUES AND LLE'S HAS    05300002
* FOUND NO MATCH IN LOADNAME FOR THE TCB SEARCHED                       05310002
NOMATCH  DS    0H                       HERE IT IS DETERMINED WHETHER   05320002
*                                          MORE TCB'S CAN BE CHECKED    05330002
*                                          FOR OR NOT                   05340002
         TM    TCBFLG,TCBGIVEN          WAS A TCB SPECIFIED BY THE      05350002
*                                          USER                         05360002
         BO    ERRCOND                  YES, PUT OUT ERROR MESSAGE      05370002
         LR    WORKO,WORKE              GET ADDR OF NEXT LOWER TCB      05380002
         B     DAUGHTER                 GO THROUGH LOOP AGAIN           05390002
         SPACE                                                          05400002
ERRCOND  DS    0H                       SET UP MESSAGE FOR MODULE NOT   05410002
*                                          FOUND                        05420002
         SPACE                                                          05510002
         L     WORKO,PDELDNAM           GET POINTER TO LOADNAME         05520002
         L     REG5,OUTBUF              GET ADDRESS OF OUTBUF IN REG    05530002
         MVI   ZERO(REG5),BLANK         MOVE BLANK INTO FIRST BYTE      05532002
         MVC   ONE(OUTBUFRL,REG5),ZERO(REG5) BLANK OUT BUFFER           05534002
         LA    REG4,FOUR(REG5)          ESTAB POINTER FOR TEXT MOVE     05540002
         SPACE                                                          05550002
         LH    REG6,PDELEN1             GET LENGTH OF LOADNAME          05560002
         BCTR  REG6,ZERO                DECREMENT BY ONE FOR MOVE INSTR 05570002
         EX    REG6,EXMOVE              MOVE LOADNAME TO FIRST LEVEL    05580002
*                                       MESSAGE                         05590002
         SPACE                                                          05600002
         LA    REG6,SIX(REG6)           CALCULATE LENGTH OF INSERT      05830002
         STH   REG6,ZERO(REG5)          STORE INTO INSERT               05832002
         XC    TSTIOPRM,TSTIOPRM        CLEAR PARM LIST FOR I/O CALL    05834002
         IKJEGSIO MSG,FIRST=M0024,INST11=(ADDR,(REG5)), CALL I/O       *05836002
               SECOND=M0222,INST21=(ADDR,(REG5)),ID=QFY26, TO ISSUE    *05838002
               MF=(E,TSTIOPRM)                          AN ERROR MSG    05838402
         CH    REG15,H16                TEST FOR SERIOUS ERROR          05838802
         BL    QFYCCO                   IF NOT CONTINUE                 05839202
         B     QFYRET                   IF SERIOUS RTN TO MAINLINE      05839602
         SPACE                                                          05850002
NOFIND   DS    0H                       SINCE LOADNAME COULD NOT BE     05860002
*                                          FOUND TESTS ARE MADE TO SEE  05870002
*                                          IF USER SPECIFIED LOADNAME.  05880002
*                                          ENTRYNAME OR JUST SYMBOL     05890002
         TM    PDEFLG2,ONBIT            WAS SYMBOL.SYMBOL INDICATED     05900002
         BZ    FIXPDE                   NO, CLEAN UP PDE                05910002
         SPACE                                                          05920002
LDCST    DS    0H                       SET UP MESSAGE FOR UNABLE TO    05930002
*                                          QUALIFY ARGUMENT AS          05940002
*                                          LOADNAME.CSECTNAME           05950002
         XC    TSTIOPRM,TSTIOPRM        CLEAR PARM LIST FOR I/O CALL    05960002
         IKJEGSIO MSG,FIRST=M0024,INST11=(APDE,(R11)), CALL I/O        *05970002
               SECOND=M0223,ID=QFY26,MF=(E,TSTIOPRM) TO ISSUE ERR MSG   05980002
         CH    REG15,H16                TEST FOR SERIOUS ERROR          06000002
         BL    QFYCCO                   IF NOT CONTINUE                 06010002
         B     QFYRET                   IF SERIOUS RTN TO MAINLINE      06020002
         SPACE                                                          06170002
CONVERT  DS    0H                       THIS ROUTINE GIVES CONTROL TO   06180002
*                                       CONVERT TO GET A BINARY ADDR    06190002
         LCR   PARAMREG,R11             PUT COMPLEMENT OF POINTER TO    06200002
*                                          PDE INTO REG 1 TO INDICATE   06210002
*                                          AN ADDRESS CONVERT NEEDED    06220002
         XR    ZERO,ZERO                INDICATE THAT A BINARY CONVERT  06230002
*                                          IS NEEDED                    06240002
         OI    TSTFLGS3,NOPRINT         SET SWITCH FOR IKJEGSYM NOT TO  06250002
*                                          PRINT A MESSAGE IF AN ERROR  06260002
*                                          OCCURS                       06270002
         L     ADDREG,TSTCONVT          GET ADDRESS OF CONVERT ROUTINE  06280002
         BALR  RETREG,ADDREG            GO TO CONVERT ROUTINE           06290002
         NI    TSTFLGS3,PRINT           RESET SWITCH                    06300002
         LTR   RETCODE,RETCODE          WAS CONVERT SUCCESSFUL          06310002
         BNZ   CHKATTN                  NO, CHECK FOR ATTENTION         06320002
*                                          SCHEDULED                    06330002
         TM    PDEUSER,ONBIT            IS ADDRESS IN USERWORD          06340002
         BZ    SETPPLD                  YES...GO SET PPLOAD             06350002
         SPACE                                                          06360002
         L     WORKE,PDEUSER            NO...MUST PICK UP PTR           06370002
*                                       TO SI BLOCK                     06380002
         MVC   PDEUSER(L4),ZERO(WORKE)  MOVE ADDR INTO USER WORD        06390002
         SPACE                                                          06400002
SETPPLD  DS    0H                       PUT CONVERTED ADDRESS INTO      06410002
*                                          TCOMTAB                      06420002
         MVC   PPLOAD(L4),PDEUSER       SET NEW BASE FOR RELATIVES      06430002
         B     QFYRET                   RETURN                          06440002
         SPACE                                                          06450002
CHKATTN  DS    0H                       CHECK FOR ATTENTION SCHEDULED   06460002
         STC   RETCODE,CODESAVE         STORE CODE                      06470002
         CLI   CODESAVE,SIXTEEN         WAS ATTENTION SCHEDULED         06480002
         BE    QFYRET                   YES, RETURN                     06490002
         L     WORKO,PDEADRPT           GET ADDRESS OF STRING           06540002
         LH    REG7,PDELEN3                GET LENGTH OF NAME           06550002
         BCTR  REG7,ZERO                DECREMENT ONE FOR EX INSTR      06560002
         L     REG8,OUTBUF              GET ADDR OF MSG BUFFER @ZA04118 06568003
         LA    REG4,FOUR(REG8)          ESTAB POINTER FOR TEXT MOVE     06576002
         EX    REG7,EXMOVE              MOVE LOADNAME OR SYMBOL INTO    06580002
*                                       MESSAGE INSERT                  06590002
         LA    REG7,FIVE(REG7)          CALCULATE INSERT LENGTH         06600002
         STH   REG7,ZERO(REG8)          STORE INTO INSERT HEADER        06610002
         XC    TSTIOPRM,TSTIOPRM        CLEAR PARM LIST FOR I/O CALL    06620002
         IKJEGSIO MSG,FIRST=M0024,INST11=(ADDR,(REG8)), CALL I/O       *06630002
               SECOND=M0224,ID=QFY26,MF=(E,TSTIOPRM) TO ISSUE ERR MSG   06640002
         CH    REG15,H16                TEST FOR SERIOUS ERROR          06660002
         BL    QFYCCO                   IF NOT CONTINUE                 06670002
         B     QFYRET                   IF SERIOUS RTN TO MAINLINE      06680002
*                                          TO QUALIFY AS LOADNAME       06710002
*                                          NOR SYMBOL                   06720002
         SPACE                                                          06730002
FIXPDE   DS    0H                       ADJUSTMENTS MUST BE MADE FOR    06740002
*                                          PDE                          06750002
         MVC   PDEADRPT(L8),PDELDNAM    MOVE SYMBOL INFORMATION BACK    06760002
*                                          TO SYMBOL SLOT IN PDE        06770002
         MVI   PDELDNAM,ZERO            CLEAR OUT LOADNAME SLOT         06780002
         MVC   LDNM1(L7),PDELDNAM                                       06790002
         B     CONVERT                  GO TO CONVERT TO RESOLVE        06800002
*                                          ADDRESS                      06810002
         SPACE                                                          06820002
CHKCSECT DS    0H                       THIS CODE IS ENTERED IF A MATCH 06830002
*                                          WERE FOUND TO LOADNAME       06840002
         C     WORKE,PPTCB              WAS LOADNAME FOUND ON A NEW     06850002
*                                          TCB                          06860002
         BNE   NEWTCB                   YES, NEW TCB GIVEN              06870002
         MVI   TCBUSED,NOTNEW           SET HIGH ORDER BYTE EQUAL TO    06880002
*                                          X'80' TO INDICATE LOADNAME   06890002
*                                          FOUND ON OLD TCB             06900002
TSTENTRY TM    PDEFLG2,ONBIT            WAS ENTRYNAME SPECIFIED         06910002
         BNO   NOENTRY                  NO, SET UP TCOMTAB INFO         06920002
         SPACE                                                          06930002
* SET UP TO GO TO IKJEGSYM                                              06940002
         LR    PARAMREG,R11             PUT POINTER TO PDE IN REG1      06950002
         MVI   PDEADRPT,ZEROBYTE        CLEAR STRING ADDRESS AREA       06960002
         MVC   STRING1(L6),PDEADRPT        IN PDE                       06970002
         LA    ADDREG,BLDMSG            GET WKAREA ADDR                 06980002
         MVC   ZERO(SYMLEN,ADDREG),SYMLIST  MOVE SYM LIST               06990002
         SPACE                                                          07000002
         LINK  MF=(E,(1)),SF=(E,(15)),ERRET=LKFAIL2   RESOLVE SYMBOLS   07010002
         B     LINKOK2                  IF CONTROL GETS HERE -OK        07012002
LKFAIL2  DS    0H                                                       07014002
         LR    REG10,PARAMREG           TRANSFER ABEND CODE             07016002
         LR    REG4,RETCODE             TRANSFER RETURN CODE            07016402
         XC    TSTIOPRM,TSTIOPRM        CLEAR PARM LIST                 07016502
         IKJEGSIO SVCERR,SVC=6,ABENDRG=(REG10),INST11=(NUM,I0085), CALL*07016802
               RC=(REG4),ID=QFY26,MF=(E,TSTIOPRM) TO ISSUE ERROR MSG    07017202
         CH    RETCODE,H16              COMPARE RC FOR SERIOUS ERROR    07019202
         BL    QFYCCO                   CONTINUE INTO NORMAL EXIT       07019602
         B     QFYRET                   SERIOUS RETURN WITH RTN CODE    07019702
         SPACE                                                          07020002
         SPACE                                                          07030002
LINKOK2  DS    0H                                                       07032002
SYMBLOW  DS    0H                                                       07040002
         LTR   RETCODE,RETCODE          IS RETURN CODE ZERO             07050002
         BNZ   TESTCODE                 NO, CHECK FURTHER               07060002
         MVI   TSTCURCT,BLANK           BLANK OUT CSECT NAME            07070002
         MVC   CSECTNM1(L7),TSTCURCT       IN TCOMTAB                   07080002
         LA    REG4,TSTCURCT            GET ADDR OF FIELD               07090002
         LH    REG5,PDELEN2             GET LENGTH OF NAME              07100002
         BCTR  REG5,ZERO                DECREMENT BY ONE                07110002
         L     WORKO,PDECTNAM           GET POINTER TO NAME             07120002
         EX    REG5,EXMOVE              MOVE CSECT NAME TO TCOMTAB      07130002
         SPACE                                                          07140002
         L     REG7,PDEUSER             PICK UP ADDRESS RETURNED        07150002
         S     REG7,TSTWHR              GET DISPLACEMENT OF CSECT       07160002
*                                       FROM BEGIN OF LOAD MODULE       07170002
         A     REG7,CSECTADR            ADD LOAD MODULE ADDR            07180002
*                                       (FIRST CSECT ADDR) FOUND BY     07190002
*                                       QUALIFY'S SEARCH                07200002
         SPACE                                                          07210002
SETTCOM  DS    0H                       PUT LATEST INFO IN TCOMTAB      07220002
         ST    REG7,TSTSYMBA            STORE NEW BASE ADDRESS IN       07230002
         ST    REG7,PPLOAD                 FIELDS OF TCOMTAB            07240002
         LM    REG6,REG7,NEWLOAD        PICK UP NEW LOADNAME            07250002
         STM   REG6,REG7,TSTCURLD       STORE IN QUALIFIED LOADNAME     07260002
*                                       FIELD OF TCOMTAB                07270002
         SPACE                                                          07280002
**************************************************************          07290002
*                                                            *          07300002
*        THE FOLLOWING ROUTINE WILL INITIALIZE TO PRINT      *          07310002
*        A MESSAGE INDICATING THE TCB ADDRESS UNDER WHICH    *          07320002
*        QUALIFICATION HAS TAKEN PLACE.                      *          07330002
*                                                            *          07340002
**************************************************************          07350002
         SPACE                                                          07360002
         ST    WORKE,TCBSAVE            SAVE TCB ADDR                   07370002
         XC    TSTIOPRM,TSTIOPRM        ZERO OUT PARM AREA FOR I/O      07380002
         IKJEGSIO MSG,FIRST=M0027,INST11=(REG,(WORKE)), CALL I/O FOR   *07390002
               ID=QFY26,MF=(E,TSTIOPRM)   ERROR MESSAGE                 07400002
         CH    RETCODE,H16              TEST FOR SERIOUS ERROR          07410002
         BL    CKTCB                    IF NOT CONTINUE WITH EXIT       07420002
         B     QFYRET                   RETURN FAST                     07430002
         SPACE                                                          07432002
CKTCB    DS    0H                                                       07440002
         OI    TSTFLGS2,TSTQUAL         TURN ON-QUALIFY STARTING TCB    07490002
         OC    TSTGO(FOUR),TSTGO        TEST IF A NEW TCB WAS           07640002
*                                       QUALIFIED                       07650002
         LA    RETCODE,FOUR             IF SO, SET RETURN CODE TO 4     07660002
         BNZ   QFYRET1                  AND BRANCH                      07670002
         SPACE                                                          07680002
QFYCCO   DS    0H                       THIS IS A WRAP UP ROUTINE       07690002
         NI    TSTFLGS2,HEXFF-TSTQUAL   TURN ON-QUALIFY STARTING TCB    07692002
         XR    RETCODE,RETCODE          SET RETURN CODE TO ZERO         07700002
QFYRET   DS    0H                       RETURN TO MAINLINE              07710002
         MVC   PPTCB(FOUR),PPTCBSAV     RESTORE ORIGINAL PPTCB IN       07720002
*                                       TCOMTAB                         07730002
         MVC   PPRB(FOUR),PPRBSAV       RESTORE ORIGINAL RB             07740002
QFYRET1  DS    0H                       EQUATE LABEL                    07750002
         LR    REG2,REG15               TRANSFER RETURN CODE            07752002
         ESTAE 0,OV                     REMOVE ESTAE                    07754002
         LR    REG15,REG2               TRANSFER RETURN CODE            07756002
         NI    TSTFLGS4,HEXFF-TSTRERTN  TURN OFF RETRY SW IF ON         07758002
         SPACE                                                          07760002
         L     SAVEREG,FOUR(ZERO,SAVEREG) RESTORE REG 13                07770002
         RETURN (14,12),,RC=(15)        RETURN TO CALLER - IKJEGMN1     07780002
         SPACE                                                          07790002
         SPACE                                                          07800002
NEWTCB   DS    0H                       LOADNAME FOUND ON A NEW TCB     07810002
         L     REG4,PPRB                GET CURRENT RB                  07820002
         L     REG5,BREAKTAB            GET PTR TO BREAK TABLE          07830002
*                                       FROM TCOMTAB                    07840002
         USING BRKELEM,REG5             SET UP ADDRESSABILITY TO        07850002
*                                       BREAK TABLE                     07860002
         SPACE                                                          07870002
         L     REG6,TCBRBP              GET PTR TO RB QUE               07880002
         USING RBSECT,REG6              SET UP ADDRESSABILITY TO        07890002
*                                       NEW RB                          07900002
         SPACE                                                          07910002
         LTR   REG5,REG5                HAS A BREAKPOINT BEEN SET       07920002
         BZ    SETTCB                   NO, BRANCH                      07930002
         SPACE                                                          07940002
         SPACE                                                          07950002
PRBTST   LA    REG6,ZERO(ZERO,REG6)     CLEAR HIGH-ORDER BYTE           07960002
         TM    RBSTAB1,RBFTSIRB         IS RB A PRB OR AN IRB           07970002
         BZ    RBTST                    YES...                          07980002
         SPACE                                                          07990002
         L     REG6,RBLINK              NO...BUMP TO NEXT RB            08000002
         B     PRBTST                   CHECK AGAIN                     08010002
         SPACE                                                          08020002
RBTST    TM    RBOPSW+ONE,HEXF0         CHECK PSW FOR KEY 0             08030002
         BZ    NOQUAL                   KEY IS ZERO, NO QUALIFICATION   08040002
         SPACE                                                          08050002
         TM    RBOPSW+ONE,HEX01         CHECK P-BIT OF PSW'S AMWP       08060002
         BZ    NOQUAL                   P-BIT OFF INDICATES             08070002
*                                       SUPERVISOR STATE...NO GOOD      08080002
         SPACE                                                          08090002
         DROP  REG6                                                     08100002
         USING RBSECT,REG4              SET UP ADDRESSABILITY TO        08110002
*                                       OLD RB                          08120002
         SPACE                                                          08130002
CHKBRK   CLC   RBOPSW+FIVE(THREE),BRKADDR+ONE   COMPARE INSTR ADDR      08140002
*                                               OF CURRENT RB'S PSW     08150002
*                                               TO BRKADDR              08160002
         BE    MATCH                    BRANCH IF MATCH IS FOUND        08170002
         SPACE                                                          08180002
         L     REG5,BRKLINK             GET BRKLINK ENTRY               08190002
         LTR   REG5,REG5                IS IT ZERO (END OF CHAIN)       08200002
         BZ    SETTCB                   YES...GO SET PPTCB              08210002
         B     CHKBRK                   NO...CHK NEXT BREAK ELEMENT     08220002
         SPACE                                                          08230002
MATCH    LA    REG5,BRKINST             PTR TO BRKINSTR IN              08240002
*                                       BREAK TABLE                     08250002
         L     ZERO,PPTCB               GET CUR TCB ADDR FROM TCOMTAB   08260002
         IKJEGS9G  OPSW,TCBADDR=(ZERO),VALUE=(REG5),MF=(E,TESTSVC)      08280002
         CH    RETCODE,H16              TEST FOR SERIOUS ERROR          08282002
         BL    SETTCB                   IF NOT CONTINUE WITH EXIT       08284002
         B     QFYRET                   RETURN FAST                     08286002
         SPACE                                                          08290002
SETTCB   L     REG5,PPTCB               GET CUR PROB PGM TCB ADDR       08300002
         ST    REG5,TCBUSED             SAVE ADDRESS OF OLD TCB         08310002
         LA    WORKE,ZERO(ZERO,WORKE)   CLEAR HIGH-ORDER BYTE           08320002
         ST    WORKE,PPTCB              PUT THE NEW TCB ADDRESS IN      08330002
*                                          TCOMTAB                      08340002
         SPACE                                                          08350002
         DROP  REG4                                                     08360002
         USING RBSECT,REG6              ADDRESSABILITY TO NEW RB        08370002
         SPACE                                                          08380002
SETPRB   LA    ZERO,ZERO(REG6)          GET ADDR OF NEW RB              08390002
         ST    ZERO,PPRB                SAVE NEW RB ADDR                08400002
         SPACE                                                          08410002
         L     WORKO,RBCDE              GET PTR TO CDE                  08420002
         LA    WORKO,ZERO(WORKO)        CLEAR HIGH BYTE                 08430002
         LTR   WORKO,WORKO              CHECK IF CDE ADDR IS ZERO       08440002
         BNZ   SETAQUAL                 IF NOT, CHANGE 'TSTAQUAL'       08450002
*                                       IN TCOMTAB                      08460002
         SPACE                                                          08470002
         MVI   TSTAQUAL,ZEROBYTE        IF SO, SET FIRST BYTE OF        08480002
*                                       TSTAQUAL TO ZERO                08490002
         B     SETTSTGO                 BRANCH TO SET 'TSTGO' IN        08500002
*                                       TCOMTAB                         08510002
         SPACE                                                          08520002
SETAQUAL DS    0H                       INITIALIZE TO REQUALIFY         08530002
         MVC   TSTAQUAL(TWELVE),CDNAMEX(WORKO)   PUT LOADNAME AND       08540002
*                                       ENTRY POINT ADDR INTO TSTAQUAL  08550002
         SPACE                                                          08560002
SETTSTGO MVC   TSTGO(FOUR),RBOPSW+FOUR  SAVE NEW RB'S PSW INSTR ADDR    08570002
         SPACE                                                          08580002
         LA    REG4,TSTGO+SIX           REG1 = PTR TO SVC               08590002
         IKJEGS9G  OPSW,TCBADDR=(WORKE),VALUE=(REG4),MF=(E,TESTSVC)     08610002
         CH    RETCODE,H16              TEST FOR SERIOUS ERROR          08612002
         BL    CONT1                    IF NOT CONTINUE WITH EXIT       08614002
         B     QFYRET                   RETURN FAST                     08616002
         SPACE                                                          08620002
CONT1    DS    0H                                                       08622002
         L     ZERO,PPRB                REG0 = PTR TO NEW RB            08630002
         MVC   TSTGO+FOUR(ONE),RBWCF    SAVE WAIT COUNT OF NEW RB       08640002
         DROP  REG6                                                     08650002
*                                       ORDER BYTE.                     08660002
         IKJEGS9G  WCF,TCBADDR=(WORKE),MF=(E,TESTSVC)                   08670002
         CH    RETCODE,H16              TEST FOR SERIOUS ERROR          08672002
         BL    TSTENTRY                 BRANCH TO TEST FOR ENTRY NAME   08674002
         B     QFYRET                   RETURN FAST                     08676002
         SPACE                                                          08678002
NOQUAL   DS    0H                                                       08730002
         XC    TSTIOPRM,TSTIOPRM        ZERO OUT PARM LIST              08740002
         IKJEGSIO MSG,FIRST=M0107,INST11=(NUM,I0022), CALL I/O FOR     *08750002
               SECOND=M0225,ID=QFY26,MF=(E,TSTIOPRM)  ERR MSG           08752002
         CH    RETCODE,H16              TEST FOR SERIOUS ERROR          08754002
         BL    QFYCCO                   NOT SERIOUS CONTINUE            08756002
         B     QFYRET                   RETURN TO MAINLINE              08758002
         SPACE                                                          08760002
NOENTRY  DS    0H                       LOADNAME WAS FOUND BUT          08770002
*                                          ENTRYNAME NOT SPECIFIED      08780002
         MVI   TSTCURCT,ZEROBYTE        ZERO OUT FIELD IN TCOMTAB FOR   08790002
         MVC   CSECTNM1(L7),TSTCURCT       CURRENTLY QUALIFIED CSECT    08800002
*                                          NAME                         08810002
         B     SETTCOM                  FINISH PUTTING INFO IN TCOMTAB  08820002
         SPACE                                                          08830002
TESTCODE DS    0H                       CHECK CODE ON RETURN FROM       08840002
*                                          IKJEGSYM                     08850002
         CLI   TCBUSED,NOTNEW           WAS NEW TCB USED                08860002
         BE    STOREC                   NO, CHECK RETURN CODE           08870002
         MVC   PPTCB(L4),TCBUSED        RESTORE PPTCB                   08880002
         SPACE                                                          08890002
STOREC   DS    0H                       CHECK RETURN CODE               08900002
         STC   RETCODE,CODESAVE         SAVE CODE TO TEST               08910002
         CLI   CODESAVE,SIXTEEN         WAS AN ATTENTION SCHEDULED      08920002
         BE    QFYRET                   YES, RETURN TO CALLER           08930002
         B     LDCST                    NO, PUT OUT MESSAGE FOR UNABLE  08940002
*                                          TO QUALIFY LOADNAME.         08950002
*                                          CSECTNAME                    08960002
         SPACE                                                          08970002
         EJECT                                                          09100002
********************************************************************    09110002
*                                                                  *    09120002
*THIS ROUTINE WILL BE ENTERED BY PARSE TO MAKE A VALIDITY CHECK ON *    09130002
* THE FIRST QUALIFY POSITIONAL PARAMTER.  IF THE PARAMETER IS AN   *    09140002
* EXPRESSION, AN INDIRECT ADDRESS, AN ABSOLUTE ADDRESS, OR A FULLY *    09150002
* QUALIFIED ADDRESS CONTROL IS GIVEN TO THE CONVERT ROUTINE TO CONVERT  09160002
* THE ADDRESS TO BINARY.                                           *    09170002
*                                                                  *    09180002
********************************************************************    09190002
         SPACE                                                          09200002
QFYVALCK DS    0H                       VALIDITY CHECK ROUTINE          09210002
         SAVE  (14,12),,QFYVALCK        SAVE REGISTERS FROM PARSE       09220002
         L     REG5,FOUR(ZERO,PARAMREG) GET ADDRESS OF QUALIFY'S SAVE   09230002
*                                          AREA                         09240002
         L     BASEREG,SIXTY8(ZERO,REG5) SET UP ADDRESSABILITY WITH     09250002
*                                          MAINLINE OF QUALIFY          09260002
         L     REG9,FIFTY6(ZERO,REG5)   RESTORE REGISTER 9 WITH ADDR    09270002
*                                          OF TCOMTAB                   09280002
         L     REG10,SIXTY(ZERO,REG5)   WORKAREA ADDRESSABILITY         09290002
         SPACE                                                          09300002
         L     REG6,REGSAVE3            GET ADDRESS OF SAVE AREA FOR    09310002
*                                          THIS ROUTINE                 09320002
         ST    SAVEREG,FOUR(ZERO,REG6)  SAVE ADDRESS OF PARSE SAVE AREA 09330002
         ST    REG6,EIGHT(ZERO,SAVEREG) STORE ADDRESS OF NEW SAVE AREA  09340002
*                                          IN PARSE SAVE AREA           09350002
         LR    SAVEREG,REG6             PUT ADDRESS OF NEW SAVE AREA    09360002
*                                          IN REGISTER 13               09370002
         SPACE                                                          09380002
* BEGIN TESTS OF PARAMETER                                              09390002
         XR    REG4,REG4                CLEAR REGISTER FOR TEST         09392002
         L     R11,OUTBUF               PICK UP ADDRESS OF OUTBUF       09394002
         ST    REG4,ZERO(R11)           SET IN NO 2ND MSG DEFAULT VALUE 09396002
         OI    TSTFLGS4,TSTVALCK        TURN ON THE VALIDITY CHECK SW   09398402
         L     R11,ZERO(ZERO,PARAMREG)   PUT ADDRESS OF PDE IN REG 11   09400002
         ST    PARAMREG,PDESAVE         SAVE PARSE PARAM LIST ADDR      09410002
         CH    REG4,PDEINDCT            IS ADDRESS INDIRECT             09430002
         BNE   PREPCONV                 YES, SET UP FOR CONVERT ROUTINE 09440002
         TM    PDEFLG4,REGTYPE          IS IT A REGISTER ADDRESS        09450002
         BM    REGMSG                   YES, PUT OUT MESSAGE FOR        09460002
*                                          INVALID ADDRESS              09470002
         CLI   PDEFLG4,SYMADDR          IS ADDRESS A SYMBOLIC           09480002
         BNE   WHATISIT                 NO, DETERMINE WHETHER OR NOT    09490002
*                                          TO CONVERT                   09500002
         CLI   PDESIGN,ZEROBYTE         IS ADDRESS AN EXPRESSION        09510002
         BNE    PREPCONV                 YES, SET UP FOR CONVERT RTN    09520002
         TM    PDEFLG1,ONBIT            IS ADDRESS FULLY QUALIFIED      09530002
         BZ    CHKCT                    NO, SET UP FOR RETURN TO PARSE  09540002
         SPACE                                                          09550002
PREPCONV DS    0H                       SET UP FOR CONVERT ROUTINE      09560002
         LCR   PARAMREG,R11             PUT TWO'S COMPLEMENT OF ADDR    09570002
*                                          OF PDE IN REGISTER 1 TO      09580002
*                                          INDICATE THAT THIS IS TO BE  09590002
*                                          AN ADDRESS CONVERT           09600002
         XR    ZERO,ZERO                INDICATE THAT A BINARY CONVERT  09610002
*                                          IS DESIRED                   09620002
         L     ADDREG,TSTCONVT          GET ADDRESS OF CONVERT ROUTINE  09630002
         BALR  RETREG,ADDREG            GO TO CONVERT ROUTINE           09640002
         LTR   RETCODE,RETCODE          WAS CONVERT SUCCESSFUL          09650002
         BNZ   BADCONV                  NO...HAVE PARSE PUT OUT         09660002
*                                       'REENTER'                       09670002
         TM    PDEUSER,ONBIT            IS ADDRESS IN USERWORD          09680002
         BZ    GOBACK                   YES, RETURN TO PARSE            09690002
         L     WORKE,PDEUSER            GET POINTER TO SI BLOCK         09700002
         L     WORKO,ZERO(ZERO,WORKE)   PICK UP ADDR                    09710002
         ST    WORKO,PDEUSER            STORE IN USERWORD               09720002
         B     GOBACK                   RETURN TO PARSE                 09730002
         SPACE                                                          09740002
CHKLENG  DS    0H                       CHECK LENGTH OF SYMBOLIC        09750002
         XR    REG5,REG5                CLEAR REGISTER                  09760002
         LA    REG5,L8(ZERO,REG5)       PUT AN 8 IN REGISTER            09770002
         CH    REG5,PDELEN3             DOES SYMBOL EXCEED 8 BYTES      09780002
         BL    EXCEEDS                  YES, PUT OUT MESSAGE            09790002
BACK     L     REG4,NOBINARY            PICK UP INDICATION FOR ADDRESS  09800002
*                                          NOT CONVERTED TO BINARY      09810002
         ST    REG4,PDEUSER             PLACE IN PDE                    09820002
         SPACE                                                          09830002
GOBACK   DS    0H                       RETURN                          09840002
         XR    RETCODE,RETCODE          SET RETURN CODE TO ZERO         09850002
         NI    TSTFLGS4,HEXFF-TSTVALCK  TURN OFF THE VALIDITY CHECK SW  09852002
         L     SAVEREG,FOUR(ZERO,SAVEREG) RESTORE REG 13                09860002
         RETURN (14,12),,RC=(15)        RETURN TO PARSE                 09870002
         SPACE                                                          09880002
CHKCT    DS    0H                       TEST FOR CSECTNAME.SYMBOL       09890002
         TM    PDEFLG2,ONBIT            CSECTNAME GIVEN                 09900002
         BZ    CHKLENG                  NO, TEST LENGTH OF SYMBOLIC     09910002
         B     PREPCONV                 RESOLVE CSECTNAME ADDRESS       09920002
         SPACE                                                          09930002
WHATISIT  EQU  *                        DETERMINE WHETHER OR NOT TO     09940002
*                                          CONVERT ADDRESS              09950002
         TM    PDEFLG1,ONBIT            LOADNAME GIVEN                  09960002
         BZ    PREPCONV                 NO, CONVERT ADDRESS             09970002
         TM    PDEFLG3,ONBIT            FULLY QUALIFIED NAME GIVEN      09980002
         BO    PREPCONV                 YES, CONVERT ADDRESS            09990002
         B     BACK                     INPUT WAS LOADNAME.CSECTNAME    10000002
*                                          RETURN TO IKJPARS WITH CODE  10010002
*                                          OF ZERO                      10020002
         SPACE                                                          10030002
EXCEEDS  DS    0H                       PREPARE TO PUT OUT MESSAGE FOR  10040002
*                                          LENGTH OF SYMBOL TOO GREAT   10050002
         LA    REG2,M0268               GET MESSAGE NUMBER INTO REG     10060002
         B     MSGOUT                   BRANCH TO PUT OUT MESSAGE       10070002
         SPACE                                                          10080002
REGMSG   DS    0H                                                       10090002
         LA    REG2,M0268               GET MESSAGE NUMBER INTO REG     10092002
         SPACE                                                          10100002
MSGOUT   DS    0H                                                       10110002
         XC    TSTIOPRM,TSTIOPRM        CLEAR I/O PARM LIST             10120002
         IKJEGSIO MSG,FIRST=M0101,INST11=(APDE,(R11)), CALL I/O FOR    *10130002
               SECOND=(REG2),ID=QFY26,MF=(E,TSTIOPRM) ERROR MESSAGE     10140002
CKRC     DS    0H                                                       10150002
         LTR   RETCODE,RETCODE          WAS MESSAGE SUCCESSFULLY        10230002
*                                          HANDLED                      10240002
         BNZ   SAVECODE                 NO, SAVE RETURN CODE            10250002
         B     SETCODE8                 HAVE PARSE PUT OUT 'REENTER'    10260002
         EJECT                                                          10590002
********************************************************************    10600002
*                                                                  *    10610002
*   THIS ROUTINE WILL BE ENTERED BY PARSE TO MAKE A VALIDITY CHECK *    10620002
*   ON THE ADDRESS SPECIFIED FOR THE TCB KEYWORD.                  *    10630002
*                                                                  *    10640002
********************************************************************    10650002
         SPACE 2                                                        10660002
QFYCHECK DS    0H                                                       10670002
         SAVE  (14,12),,QFYCHECK        SAVE REGISTERS FROM PARSE       10680002
         L     REG5,FOUR(ZERO,PARAMREG) GET ADDRESS OF QUALIFY'S        10690002
*                                          SAVE AREA                    10700002
         L     BASEREG,SIXTY8(ZERO,REG5) GET ADDRESSABILITY WITH        10710002
*                                          MAINLINE OF QUALIFY          10720002
         L     REG9,FIFTY6(ZERO,REG5)   RESTORE REG9 WITH ADDRESS OF    10730002
*                                          TCOMTAB                      10740002
         L     REG10,SIXTY(ZERO,REG5)   WORKAREA ADDRESSABILITY         10750002
         SPACE                                                          10760002
         L     REG6,REGSAVE3            GET ADDRESS OF SAVE AREA FOR    10770002
*                                          THIS ROUTINE                 10780002
         ST    SAVEREG,FOUR(ZERO,REG6)  SAVE ADDRESS OF PARSE SAVE AREA 10790002
         ST    REG6,EIGHT(ZERO,SAVEREG) STORE ADDRESS OF NEW SAVE AREA  10800002
*                                          IN PARSE SAVE AREA           10810002
         LR    SAVEREG,REG6             PUT ADDRESS OF NEW SAVE AREA    10820002
*                                          IN REGISTER 13               10830002
* GET TCB ADDRESS CONVERTED TO BINARY                                   10840002
         XR    ZERO,ZERO                INDICATE BINARY CONVERT         10842002
         L     R11,OUTBUF               PICK UP ADDRESS TO OUTBUF       10844002
         ST    ZERO,ZERO(R11)           STORE NO MSG DEFAULT            10846002
         OI    TSTFLGS4,TSTVALCK        TURN ON VALIDITY CHECK SW       10848002
         L     R11,ZERO(ZERO,PARAMREG)  GET ADDR OF PDE                 10850002
         ST    PARAMREG,PDESAVE         SAVE PARSE PARAM LIST ADDR      10860002
         LCR   PARAMREG,R11             PUT COMPLEMENT OF ADDRESS OF    10870002
*                                          PDE IN REGISTER TO INDICATE  10880002
*                                          ADDRESS CONVERT              10890002
         L     ADDREG,TSTCONVT          GET ADDRESS OF CONVERT ROUTINE  10910002
         BALR  RETREG,ADDREG            GO TO CONVERT ADDR              10920002
         LTR   RETCODE,RETCODE          WAS CONVERT SUCCESSFUL          10930002
         BNZ   BADCONV                  NO, SET ERROR CODE              10940002
         L     WORKO,PDEUSER                                            10950002
         TM    PDEUSER,ONBIT            IS CONVERTED ADDR IN USER WORD  10960002
         BZ    NOSYM                    YES...                          10970002
         SPACE                                                          10980002
         L     WORKO,ZERO(ZERO,WORKO)   NO, GET ADDR FROM SI BLOCK      10990002
         ST    WORKO,PDEUSER            AND SAVE                        11000002
NOSYM    DS    0H                                                       11010002
         LH    WORKO,PDEINDCT           GET INDIRECT ADDR COUNT         11020002
         LTR   WORKO,WORKO              IS IT ZERO                      11030002
         BNZ   FULLWORD                 NO...CHECK BOUNDARY             11040002
         SPACE                                                          11050002
         TM    PDEFLG4,REGTYPE          IS THIS A REGISTER ADDR         11060002
         BZ    FULLWORD                 NO...                           11070002
         SPACE                                                          11080002
         B     REGMSG                   SET UP FOR 'INVALID REGISTER    11090002
*                                       ADDR' MSG                       11100002
         SPACE                                                          11110002
FULLWORD TM    PDEUSER3,HEX03           FULLWORD BOUNDARY               11120002
         BZ    CHKTCB                   YES...CHECK IF TCB EXISTS       11130002
*                                       AT SPECIFIED ADDRESS            11140002
         SPACE                                                          11150002
         XC    TSTIOPRM,TSTIOPRM        ZERO OUT PARM FIELD             11160002
         IKJEGSIO MSG,FIRST=M0101,INST11=(APDE,(R11)), CALL I/O FOR    *11162002
               SECOND=M0280,INST21=(NUM,I0003), ERROR MSG              *11164002
               ID=QFY26,MF=(E,TSTIOPRM)         TO USER                 11166002
         B     CKRC                     CHECK RETURN CODE               11170002
         SPACE                                                          11180002
*****************************************************************       11190002
*                                                               *       11200002
*        THE FOLLOWING ROUTINE WILL CHECK WHETHER OR NOT A TCB  *       11210002
*        UNDER TEST ACTUALLY EXISTS AT THE SPECIFIED ADDRESS.   *       11220002
*                                                               *       11230002
*****************************************************************       11240002
         SPACE                                                          11250002
CHKTCB   L     REG7,PDEUSER             GET SPECIFIED TCB ADDR          11260002
         LA    REG7,ZERO(ZERO,REG7)     CLEAR HIGH BYTE AND SAVE        11270002
         SPACE                                                          11280002
         L     REG4,TSTTCB              TEST'S TCB                      11290002
         LA    REG8,ZERO(REG4)          CLEAR HIGH BYTE AND SAVE        11300002
DAU      L     REG5,D(REG4)             GET ADDR OF DAUGHTER TCB        11310002
         LTR   REG5,REG5                IS THERE A DAUGHTER             11320002
         BNZ   CHKADDR                  YES...CHECK IF VALID            11330002
         SPACE                                                          11340002
SIS      L     REG5,S(REG4)             GET ADDR OF SISTER TCB          11350002
         LTR   REG5,REG5                IS THERE A SISTER               11360002
         BNZ   CHKADDR                  YES...CHECK IF VALID            11370002
         SPACE                                                          11380002
MOTH     L     REG4,M(REG4)             GET ADDR OF MOTHER TCB          11390002
         LA    REG4,ZERO(REG4)          CLEAR HIGH BYTE                 11400002
         CR    REG4,REG8                DOES MOTHER = TEST TASK         11410002
         BNE   SIS                      NO...CHECK SISTER TASK          11420002
         SPACE                                                          11430002
         LA    REG2,M0226               GET MESSAGE NUMBER INTO REG     11440002
         B     MSGOUT                   MESSAGE                         11450002
         SPACE                                                          11460002
CHKADDR  LA    REG5,ZERO(ZERO,REG5)     CLEAR HIGH BYTE                 11470002
         CR    REG5,REG7                DOES THIS TCB ADDR MATCH        11480002
*                                       THE GIVEN TCB ADDR              11490002
         BE    RETPARSE                 YES...ADDR IS VALID, RETURN     11500002
*                                       TO PARSE                        11510002
         SPACE                                                          11520002
         LR    REG4,REG5                GET NEXT LOWER TCB IN CHAIN     11530002
         B     DAU                      LOOP UNTIL DONE                 11540002
         SPACE                                                          11550002
*****************************************************************       11560002
         SPACE 2                                                        11570002
RETPARSE DS    0H                       RETURN TO PARSE                 11580002
         NI    TSTFLGS4,HEXFF-TSTVALCK  TURN OFF VALIDITY CHECK BIT     11580102
         L     REG4,OUTBUF              PICK UP ADDR OF SECOND LEV MSG  11580402
         LH    REG2,ZERO(REG4)          PREPARE TO TEST FOR 2ND LEV     11581202
         LTR   REG2,REG2                TEST FOR ZERO MSG LENGTH        11581702
         BZ    NO2NDLEV                 BRANCH AROUND NEXT INSTRUCTION  11581902
         L     REG4,PDESAVE             GET PARSE PARAM LIST ADDR       11582002
         MVC   EIGHT(FOUR,REG4),OUTBUF  PUT ADDR OF SECOND LEVEL        11584002
*                                       MSG IN PARSE PARAMETER LIST     11586002
NO2NDLEV DS    0H                                                       11588002
         L     SAVEREG,FOUR(ZERO,SAVEREG) RESTORE REG 13                11590002
         RETURN (14,12),,RC=(15)        RETURN TO PARSE                 11600002
         SPACE                                                          11610002
BADCONV  DS    0H                       CONVERT RTN NOT SUCCESSFUL      11620002
         SPACE                                                          11660002
SAVECODE STC   RETCODE,CONVRTCD         SAVE RETURN CODE                11670002
         CLI   CONVRTCD,EIGHT           COMPARE TO EIGHT                11680002
         BNH   SETCODE8                 IF 4 OR 8, SET RETURN CODE      11690002
*                                       TO 8 FOR PARSE                  11700002
         SPACE                                                          11710002
         LA    RETCODE,TWELVE           ELSE, SET RETURN CODE TO 12     11720002
*                                       FOR PARSE                       11730002
         B     RETPARSE                 RETURN TO PARSE                 11740002
         SPACE                                                          11750002
SETCODE8 XR    RETCODE,RETCODE          CLEAR REGISTER                  11760002
         LA    RETCODE,EIGHT(ZERO,RETCODE) RETURN CODE OF 8 FOR PARSE   11770002
*                                          TO ISSUE 'REENTER'           11780002
         B     RETPARSE                 RETURN TO PARSE                 11790002
         EJECT                                                          11800002
*************************************************************           11810002
*                                                           *           11820002
*        STAE RETRY ROUTINE                                 *           11830002
*                                                           *           11840002
*************************************************************           11850002
         SPACE 2                                                        11860002
RETRY    DS    0H                       RETRY ADDR                      11870002
         L     REG4,CVTPTR              GET CVT ADDR                    11880002
         USING CVTDSECT,REG4            ADDRESSABILITY TO CVT           11890002
         SPACE                                                          11900002
         L     REG4,CVTTCBP             GET ADDR OF CURRENT             11910002
         L     REG4,TCBADR(ZERO,REG4)   TCB (TEST'S TCB)                11920002
         DROP REG4                                                      11930002
         SPACE                                                          11940002
         USING TCB,REG4                 ADDRESSABILITY TO TCB           11950002
         L     REG9,TCBTRN              TCBTRN FIELD OF TEST'S TCB      11960002
         OI    TSTFLGS4,TSTRERTN        TURN ON RETRY SW                11962002
*                                       CONTAINS PTR TO TCOMTAB         11970002
         SPACE                                                          11980002
         L     SAVEREG,REGSAVE2         GET ADDR OF QUALIFY'S           11990002
*                                       SAVEAREA                        12000002
         L     BASEREG,SIXTY8(ZERO,SAVEREG)  RE-ESTABLISH MODULE        12010002
*                                            ADDRESSABILITY             12020002
         SPACE                                                          12030002
NOWORK   LA    RETCODE,TWENTY           SET RETURN CODE TO 20           12100002
         B     QFYRET                   RETURN TO MAINLINE              12110002
         EJECT                                                          12120002
EXMOVE   MVC   ZERO(ZERO,REG4),ZERO(WORKO) MOVE INSTRUCTION TO BE       12130002
*                                          EXECUTED                     12140002
         EJECT                                                          12150002
******************************************************************      12160002
*                                                                *      12170002
*              CONSTANTS                                         *      12180002
*                                                                *      12190002
******************************************************************      12200002
*                                                                       12210002
         SPACE                                                          12220002
         DS    0F                       ALIGNMENT                       12230002
IKJEGSPL IKJEGSPL RTRY=RETRY,ABNTB=STATBL,MODNM=IKJEGQFY,TNM=QUALIFY    12230402
         DS    0F                       ALIGNMENT                       12230802
ZZZZZZZZ DC    52C'Z'                   TO BE USED FOR MAINTENANCE      12232002
NOEXP    DC    X'FF000000'              SYMBOLIC OF NOT AN ADDRESS      12240002
*                                          EXPRESSION                   12250002
MASKUP   DC    X'FFFFFFFE'              MASK FOR ROUNDING UP            12260002
NOBINARY DC    X'FFFFFFFF'              SYMBOLIC FOR ADDRESS NOT        12270002
*                                          CONVERTED TO BINARY          12280002
ICCHNG   DC    X'08000000'              IC CHANGE FLAG                  12290002
WAITCNT  DC    X'01000000'              FLAG TO TURN OFF WAIT CNT       12300002
TAB      DC    C'0123456789ABCDEF'      TABLE FOR TCB ADDR TRANSLATE    12310002
PCLISTA  DC    V(IKJEGPCL)              ADDRESS OF PCLIST CSECT         12320002
         SPACE                                                          12460002
RETRYADR DC    AL3(RETRY)               RETRY ROUTINE ADDR FOR STAE     12470002
         SPACE                                                          12480002
STAELIST ESTAE STAELIST,MF=L            LIST FORM OF STAE               12490002
STAELEN  EQU   *-STAELIST               LENGTH OF STAE LIST             12500002
         SPACE                                                          12510002
         SPACE                                                          12520002
SYMLIST  LINK  EP=IKJEGSYM,SF=L         LIST FORM OF LINK               12530002
SMTSYM   DS    0H                       SMT TEST LABEL FOR SYM LINK     12540002
         SPACE                                                          12550002
SYMLEN   EQU   *-SYMLIST                LENGTH OF SYM LIST              12560002
         SPACE                                                          12570002
ZEROH    DC    H'0'                     HALFWORD OF ZERO                12580002
H16      DC    H'16'                    FOR RETURN CODE TEST            12582002
         SPACE 2                                                        12590002
*****************************************************************       12600002
*                                                               *       12610002
*        STAE ADDRESS TABLE                                     *       12620002
*                                                               *       12630002
*****************************************************************       12640002
         SPACE 2                                                        12650002
STATBL   DS    0H                                                       12660002
         DC    AL1(99),AL3(PARSBLOW)    PARSE LINK FAILED               12670002
         DC    AL1(99),AL3(SYMBLOW)     SYM LINK FAILED                 12680002
         DC    AL1(HEXFF)               TABLE END                       12690002
         EJECT                                                          12700002
         DS    0F                       ALIGNMENT                       14170002
IKJEGPCL IKJPARM DSECT=IKJPARMD                                         14180002
ADDR     IKJPOSIT ADDRESS,PROMPT='ADDRESS',VALIDCK=QFYVALCK             14190002
TCBNAME  IKJKEYWD                                                       14200002
         IKJNAME 'TCB',SUBFLD=TCBADDR                                   14210002
TCBADDR  IKJSUBF                                                        14220002
ADDRTCB  IKJPOSIT  ADDRESS,PROMPT='TCB ADDRESS',VALIDCK=QFYCHECK        14230002
         IKJENDP                                                        14240002
         EJECT                                                          14250002
         TCOMTAB                        COMMUNICATIONS WORK AREA        14260002
CSECTNM1 EQU   TSTCURCT+1               SECOND BYTE OF TSTCURCT         14270002
PPTCB1   EQU   PPTCB+1                  SECOND BYTE OF FIELD            14280002
         EJECT                                                          14290002
WORKSP   DSECT                          WORK AREA DSECT                 14300002
PARSPARM DS    0H                       PARAMETER LIST FOR PARSE        14310002
PTUPT    DS    A                        POINTER TO UPT                  14320002
PTECT    DS    A                        POINTER TO ECT                  14330002
PTCPECB  DS    A                        POINTER TO CP ECB               14340002
PTPCL    DS    A                        POINTER TO PCL                  14350002
PTANSW   DS    A                        POINTER TO ANSWER PLACE         14360002
PTBUFF   DS    A                        POINTER TO COMMAND BUFFER       14370002
PTAREA   DS    A                        POINTER TO USER WORK AREA       14380002
NEWLOAD  DS    2F                       LOADNAME GIVEN BY USER          14390002
NEWLOAD1 EQU   NEWLOAD+1                SECOND BYTE OF NEWLOAD FIELD    14400002
PPRBSAV  DS    A                        SAVE AREA FOR PPRB              14410002
PPTCBSAV DS    A                        SAVE AREA FOR PPTCB             14420002
TCBSAVE  DS    A                        SAVE AREA FOR QUALIFIED TCB     14430002
PDESAVE  DS    A                        PTR TO PARSE PARAMETER LIST     14440002
PROTKEY  DS    X                        PROTECTION KEY FOR TEST         14450002
TCBFLG   DS    X                        SWITCH FOR TCB                  14460002
TCBGIVEN EQU   X'80'                    TCB SPECIFIED                   14470002
TCBNOSP  EQU   X'00'                    TCB NOT SPECIFIED               14480002
CODESAVE DS    X                        RETURN CODE SAVED FOR TESTING   14490002
CONVRTCD DS    X                        CONVERT RETURN CODE             14500002
         DS    0F                       ALIGNMENT                       14510002
CSECTADR DS    A                        ADDRESS OF FIRST CSECT          14520002
TCBUSED  DS    A                        ADDRESS OF TCB USED             14530002
TESTSVC  DS    3F                       PARM LIST FOR TEST SVC          14532002
BLDMSG   DS    18C                      WORK AREA TO BUILD MESSAGE      14540002
BLDMSG1  EQU   BLDMSG+1                 SECOND BYTE                     14550002
NEWADDR  EQU   X'00'                    INDICATES NEW TCB ADDR          14560002
NOTNEW   EQU   X'80'                    INDICATES TCB ADDR IN PPTCB     14570002
*                                          IS THE ONE LOADNAME WAS      14580002
*                                          FOUND ON                     14590002
TCBUSED1 EQU   TCBUSED+1                SECOND BYTE OF TCBUSED          14600002
         EJECT                                                          14610002
         IKJPARMA                                                       14620002
LDNM1    EQU   PDELDNAM+1               SECOND BYTE OF LOADNAME SLOT    14630002
STRING1  EQU   PDEADRPT+1               SECOND BYTE OF STRING           14640002
USEWRD   EQU   PDEUSER+1                SECOND BYTE OF USERWORD         14650002
PDEUSER3 EQU   PDEUSER+3                FOURTH BYTE OF USER WORD        14660002
         EJECT                                                          14670002
         TSTCWORK                                                       14680002
         EJECT                                                          14690002
         BRKELEM                                                        14700002
         EJECT                                                          14710002
CVTDSECT DSECT                                                          14720002
         CVT                                                            14730002
         EJECT                                                          14740002
         IHACDE                                                         14740402
         IHAXTLST                                                       14740802
         IHALLE                                                         14741202
         EJECT                                                          14742002
         IKJTCB                         TCB DSECT                       14750002
         SPACE                                                          14760002
S        EQU   TCBNTC-TCB               SISTER TASK                     14770002
M        EQU   TCBOTC-TCB               MOTHER TASK                     14780002
D        EQU   TCBLTC-TCB               DAUGHTER TASK                   14790002
         EJECT                                                          14800002
         IKJRB                          RB DSECT                        14810002
         EJECT                                                          14820002
         IKJPPL                         PARSE PARAMETER LIST DSECT      14830002
         END                                                            14840002
./  ADD  SSI=80750429,NAME=IKJEGSRH
SRH      TITLE 'IKJEGSRH, SERVICE ROUTINE REMOVES ACTIVEBRK POINTS'     00100002
         COPY  IKJEGSIO                                                 00104002
IKJEGSRH CSECT                     SEARCH AND REMOVAL SERVICE ROUTINE   00110002
* A75984, 75987                                                  YM2246 00120002
* A056084,095000                                               @YM00572 00130002
* C056020                                                      @YM00574 00140002
* A145100,145200                                               @YM06114 00142002
* C097972                                                      @ZA27728 00146003
         EJECT                                                          00150002
************************************************************            00200002
*                                                                       00250002
* STATUS                                                                00300002
*    CHANGE LEVEL 00, VERSION NUMBER 01, OS/VS2                         00350002
*                                                                       00400002
* FUNCTION                                                              00450002
*    SRH SEARCHS AND REMOVES WHATEVER BREAKPOINTS ARE EITHER AT         00500002
*    THE SPECIFIED ADDRESS OR WITHIN THE SPECIFIED RANGE                00550002
*    THE ADDRESS OF WHERE THE INSTRUCTION IS TO BE REPLACED IS          00600002
*    VALIDITY CHECKED AND IF THIS ADDRESS IS 'WRITTABLE' THE            00650002
*    INSTRUCTION IS PUT BACK.                                           00700002
*                                                                       00750002
* ENTRY POINTS                                                          00800002
*         IKJEGSRH - MAIN ENTRY POINT                                   00850002
*                                                                       00900002
* INPUT                                                                 00950002
*    THREE WORDS POINTED TO BY REGISTER 1.                              01000002
*    WORD 1 FLAGS 4=SEARCH ONLY, 0=SEARCH AND REMOVE, 8=SEARCH BACKUP   01050002
*    WORD 2 ADDRESS IN QUESTION (OR BEGINNING OF RANGE)                 01100002
*    WORD 3 END ADDRESS OF RANGE (OR ZERO IF NO RANGE)                  01150002
*                                                                       01200002
* OUTPUT                                                                01250002
*    1.  RETURN CODES                                                   01300002
*    *          00 - SUCCESSFUL COMPLETION OR BREAKPOINT(S) REMOVED     01350002
*    *          04 - NO BREAKPOINT FOUND                                01400002
*    *          08 - INVALID RANGE                                      01450002
*                                                                       01500002
* EXTERNAL REFERENCES                                                   01550002
*      ESATE    - ESTABLISH ABEND RECOVERY EXIT RTN (IKJEGSTA)          01600002
*                                                                       01610002
*      FREEMAIN - FREE CORE                                             01612002
*                                                                       01620002
*      IKJEGS9G - VALIDITY CHECK ADDRESS FOR WRITE ACCESS               01630002
*                                                                       01640002
*      IKJEGIO  - PRINT ERROR MESSAGES (INVOKED VIA 'IKJEGSIO'          01642002
*                 MACRO )                                               01642102
*                                                                       01644002
* EXITS,NORMAL                                                          01650002
*    RETURN TO CALLER VIA REGISTER 14                                   01700002
*                                                                       01750002
* EXITS,ERROR                                                           01800002
*    RETURN TO CALLER VIA REGISTER 14                                   01850002
*                                                                       01900002
* TABLES/WORK AREAS                                                     01950002
*    TCOMTAB -                                                          02000002
*    *    BREAKTAB - PTR TO ACTIVE BREAK ELEMENTS                       02050002
*    *    CWORKSRH - GENERAL WORK AREA FOR IKJEGSRH                     02060002
*                                                                       02100002
* ATTRIBUTES                                                            02150002
*    REENTRANT AND REFRESHABLE                                          02200002
*                                                                       02250002
* CHARACTER CODE DEPENDENCY                                             02300002
*    THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL              02350002
*    REPRESENTATION OF THE EXTERNAL CHARSRHER SET WHICH IS              02400002
*    EQUIVALENT TO THE ONE USED AT ASSEMBLY TIME. THE                   02450002
*    CODING HAS BEEN ARRANGED SO THAT REDEFINITION OF                   02500002
*    'CHARACTER' CONSTANTS, BY REASSEMBLY, WILL RESULT IN               02550002
*    A CORRECT MODULE FOR THE NEW DEFINITIONS.                          02600002
*                                                                       02650002
* NOTES                                                                 02700002
*                                                                       02750002
************************************************************            02800002
* CHANGE ACTIVITY:                                                      02810000
*    @ZA17788 - ENTRY POINT OF STAE EXIT RTN SPECIFIED INCORRECTLY      02820000
*               IN STAE MACRO NEAR LABEL 'SRHSTART'.                    02830000
************************************************************            02840000
         EJECT                                                          02850002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 02900002
*        THE FOLLOWING ARE THE EQUATES NEEDED BY THE SEARCH ROUTINE     02950002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 03000002
         SPACE                                                          03050002
*        REGISTER EQUATES                                               03100002
R0       EQU   0                   GENERAL WORK REGISTER (INPUT REG)    03150002
R1       EQU   1                   GENERAL WORK REGISTER (PARAM PASS)   03200002
R2       EQU   2                   GENERAL WORK REGISTER                03250002
R3       EQU   3                   GENERAL WORK REGISTER                03300002
R4       EQU   4                   GENERAL WORK REGISTER                03350002
R5       EQU   5                   GENERAL WORK REGISTER                03400002
R6       EQU   6                   BASE REGISTER FOR CONTROL BLOCKS     03450002
R7       EQU   7                   BASE REGISTER FOR ACTIVE Q           03500002
R8       EQU   8                   BASE REGISTER FOR TEMPORARY USE      03550002
R9       EQU   9                   BASE REGISTER FOR TCOMTAB            03600002
R10      EQU   10                  BASE REGISTER FOR SRHWORK AREA       03650002
R11      EQU   11                  EXTRA REGISTER NOT USED              03700002
R12      EQU   12                  BASE REGISTER FOR IKJEGSRH           03750002
R13      EQU   13                  POINTER TO SAVE AREA                 03800002
R14      EQU   14                  USED FOR BAL ALSO WORK REG           03850002
R15      EQU   15                  USED FOR RETURN CODES ALSO WORK REG  03900002
         SPACE                                                          03950002
N0       EQU   0                   CONSTANT 0                           04000002
N1       EQU   1                   CONSTANT 1                           04050002
N2       EQU   2                   CONSTANT 2                           04100002
N3       EQU   3                   CONSTANT 3                           04150002
N4       EQU   4                   CONSTANT 4                           04200002
N5       EQU   5                   CONSTANT 5                           04250002
N6       EQU   6                   CONSTANT 6                           04300002
N7       EQU   7                   CONSTANT 7                           04350002
N8       EQU   8                   CONSTANT 8                           04400002
N9       EQU   9                   CONSTANT 9                           04450002
N10      EQU   10                  CONSTANT 10                          04500002
N12      EQU   12                  CONSTANT 12                          04550002
N16      EQU   16                  CONSTANT 16                          04600002
N20      EQU   20                  CONSTANT 20                          04650002
N24      EQU   24                  CONSTANT 24                          04660002
N32      EQU   32                  CONSTANT 32                          04700002
N56      EQU   56                  CONSTANT 56                          04750002
N60      EQU   60                  CONSTANT 60                          04760002
N72      EQU   72                  CONSTANT 72                          04800002
N120     EQU   120                 CONSTANT 120                         04810002
****     HEXIDECIMAL EQUATES                                            04850002
HEXC0    EQU   X'C0'               HEX CONSTANT C0                      04900002
HEX0A    EQU   X'0A'               HEX CONSTANT 0A                      04950002
HEXFF    EQU   X'FF'               HEX CONSTANT FF                      05000002
HEX0C    EQU   X'0C'               HEX CONSTANT 0C                      05050002
HEX10    EQU   X'10'               HEX CONSTANT 10                      05100002
****     BINARY MASK EQUATES                                            05102002
INSTMASK EQU   B'11000000'         INSTRUCTION LENGTH MASK              05110002
         EJECT                                                          05150002
SRHSTART DS    0H                  STARTING POSITION OF SRH             05200002
         SAVE  (14,12),,*          SAVE THE CALLERS REGISTERS           05250002
         LR    R12,R15             SETUP REG 12 AS SRH'S BASE           05300002
         USING SRHSTART,R12        ESTABLISH ADDRESSIBILITY             05350002
         USING TCOMTAB,R9          ESTABLISH ADDRESSIBILITY TO TCOMTAB  05400002
         L     R15,REGSAVE6        LOAD ADDR OF NEW SAVEAREA (SRH'S)    05450002
         ST    R13,N4(R15)         PLACE ADDR USER'S SAVEAREA INTO SRH  05500002
         ST    R15,N8(R13)         PLACE ADDR OFF SAVEAREA INTO USERS   05550002
         LR    R13,R15             R13= ADDR OF NEW SAVE AREA           05600002
         L     R3,WORKAREA         POINT TO TSTCWORK            @YM0574 05602002
         USING TSTCWORK,R3         ESTABLISH ADDRESSABILITY TO TSTCWORK 05604002
         LA    R3,CWORKSRH         POINT TO CWORKSRH                    05606002
         DROP  R3                  DISCONTINUE R3 AS TSTCWORK BASE      05606402
         USING SRHWORK,R3          ESTABLISH ADDRESSABILITY TO SRHWORK  05608002
         LR    R7,R1               R7= PTR TO 3 INPUT WORDS    @YM00572 05608402
         SPACE                                                          05610002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   05650002
*                                                                       05652002
*        SETUP TO INTERCEPT AN ABEND                                    05660002
*                                                                       05670002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   05700002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   05700402
*********  WE MUST STANDARDIZE RETURN CODES FROM THIS MODULE *****      05700502
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   05700602
         XC    SRHWORK(ESTAELN),SRHWORK CLEAR ESTAE PARM LIST AREA      05700802
         L     R4,TSTSTAE          POINT TO IKJEGSTA           @ZA17788 05702800
         ESTAE (R4),PARAM=LIST,MF=(E,SRHWORK)                  @ZA17788 05704800
         LR    R1,R7               RESTORE REGISTER 1          @YM00572 05711002
         LTR   R15,R15             WAS 'ESTAE' ACCEPTED                 05712002
         BZ    SRH0020             IF R15 = 0, START SEARCHING          05712402
         STC   R15,TSTESTRC        PRESERVE ESTAE RETURN CODE>          05712502
         LA    R15,N24             INDICATE ESTAE WAS NOT ACCEPTED      05712802
         B     SRH0600             RETURN WITHOUT TRYING TO REMOVE SCB  05713202
         EJECT                                                          05728402
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   05735602
*        START PROCESSING BY SAVIVG INPUT                               05742802
*        REGISTER 1 = ORGINAL INPUT                                     05750002
*        REGISTER 2 = ADDR 1 (OR BEGINNING OF RANGE)                    05800002
*        ENDRANGE   = ADDR 2 (OR END OF RANGE)                          05850002
*        REGISTER 6 = FLAGS PASSED                                      05900002
*        REGISTER 7 = ORGINAL INPUT OF R1 (ADDR OF 3 WORDS)             05950002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   06000002
         SPACE                                                          06050002
SRH0020  DS    0H                  START WITH PDE USER FIELD            06100002
         LR    R7,R1               R7= POINTER TO 3 INPUT WORDS         06150002
         LA    R7,N0(R7)           ZERO HIGH ORDER BYTE, WILL BE A FLAG 06200002
         L     R6,N0(R1)           R6= FLAGS PASSED TO ROUTINE          06250002
         L     R2,N4(R1)           R2= FLAGS PASSED TO REMOVAL          06300002
         ST    R2,BGNRANGE         SAVE FIRST ADDRESS                   06360002
         ST    R1,SAVE1            SAVE ORIGINAL INPUT PTR              06360402
         L     R1,N8(R1)           R1= SECOND ADDR IF ANY (RANGE)       06362002
         ST    R1,ENDRANGE         SAVE SECOND ADDR IF ANY              06370002
         LTR   R1,R1               DOES 2ND ADDRESS EXIST YES=RANGE     06400002
         BZ    SRH0100             NO THEREFORE SINGLE ADDR             06450002
****    WE HAVE THE SECOND ADDRESS OF THE RANGE                         06500002
****     MAKE SURE ADDR 1 IS LESS THAN ADDR 2 OF RANGE                  06550002
         USING BRKELEM,R8          SETUP ADDR'ABILITY TO BREAK ELEMENT  06600002
SRH0040  DS    0H                  VARIFY THE ADDRESS OF A RANGE        06650002
         CLC   ENDRANGE,BGNRANGE   IS THE 2ND ADDR LESS THAN FIRST      06700002
         BNL   SRH0045             NO THE RANGE IS OK                   06750002
****     ERROR CONDITION INVALID RANGE                                  06800002
         B     SRH0460             RETURN ERROR CODE 8                  06850002
****     INITIALIZE RANGE LOOP                                          06900002
SRH0045  DS    0H                  SETUP INITIAL CONDITIONS             06950002
         CH    R6,EIGHT            WAS THE FLAG AN EIGHT                07060002
         BNE   SRH0050             NO THEREFORE USE ADDR AS IS          07070002
         LA    R4,N5               R4= N5 BACKUP INDEX                  07080002
         SR    R2,R4               BACKUP START OF THE RANGE            07090002
SRH0050  DS    0H                  SETUP INITIAL CONDITIONS             07092002
         L     R8,BREAKTAB         R8= ADDR OF ACTIVE BRK POINT QUEUE   07094002
         LA    R5,BREAKTAB         INITIALIZE LOOP WITH BACK POINTER    07096002
****     BEGIN LOOP LOOKING FOR BREAKPOINTS IN THE RANGE                07100002
SRH0060  DS    0H                  START FOR SEARCH LOOP                07150002
         LTR   R1,R8               DO WE HAVE A LINK TO WORK WITH       07200002
         BZ    SRH0440             NO STOP SEARCH                       07250002
         L     R4,BRKADDR          R4=ADDR OF THIS BREAK POINT          07300002
         CR    R4,R2               IS BRKADDR GREATER THAN START OF RNG 07350002
         BL    SRH0080             NO CONTINUE WITH NEXT ELEMENT        07400002
         C     R4,ENDRANGE         IS BRKADDR LESS THAN END OF RANGE    07450002
         BH    SRH0440             OUTSIDE OF UPPER LIMIT DONE SEARCH   07500002
****     WE HAVE AN ADDRESS WITHIN THE RANGE. LINK AROUND IT AND REMOVE 07550002
****     FIRST CHECK TO MAKE SURE THE ADDR IS NOT ON EXTENDED START     07552002
         CH    R6,EIGHT            WAS THE FLAG 8 (BACKUP)              07560002
         BNE   SRH0070             NO THEREFORE REMOVE ELEMENT          07570002
         LA    R10,N5(R2)          R10= ORIGINAL START OF RANGE         07580002
         CR    R4,R10              IS INST WITHIN RANGE                 07590002
         BNL   SRH0070             YES THEREFORE REMOVE INSTR           07592002
         TM    BRKINST,INSTMASK    WHAT IS THE LENGTH OF INST           07594002
         BO    SRH0070             LENGTH IS 6 THEREFORE REMOVE IT      07596002
         BM    SRH0064             LENGTH IS 4                          07598002
         LA    R0,N1(R4)           R0= ADDR OF END OF INSTR      YM2246 07598402
         B     SRH0068             DOES THIS OVERLAP ORIG RANGE         07598502
SRH0064  DS    0H                  INCREMENT INSTR ADDR BY 4            07598602
         LA    R0,N3(R4)           R0= END OF INSTR ADDR         YM2246 07598702
SRH0068  DS    0H                  IS (R0) WITHIN THE ORIGINAL RANGE    07611502
         CR    R0,R10              END OF INSTR WITHIN RANGE            07621502
         BL    SRH0080             NO THEREFORE CONTINUE SEARCH         07623502
****     THE ELEMENT IS WITH IN A RANGE AND THEREFORE CAN BE REMOVED    07623902
SRH0070  DS    0H                  REMOVE THE LOCATED ELEMENT           07624402
         L     R8,BRKLINK          GET ADDR OF THE NEXT ELEMENT         07637202
         B     SRH0180             BRANCH TO THE REMOVAL ROUTINE        07800002
         SPACE                                                          07850002
****     CONTINUE THE SEARCH WITH THE NEXT ELEMENT                      07900002
****     SAVE THE ADDR (R5) OF THE CURRENT BRKLINK FIELD FOR RELINKING  07950002
****     UPDATE R8 TO POINT TO THE NEXT LINK                            08000002
SRH0080  DS    0H                  SAVE CURRENT LINK ADDR AND CONTINUE  08050002
         LA    R5,BRKLINK          SAVE ADDR OF PREVIOUS BRKLINK        08100002
         L     R8,BRKLINK          PLACE ADDR OF NEXT ELEMENT INTO R8   08150002
         B     SRH0060             CONTINUE THE SEARCH                  08200002
         SPACE                                                          08250002
****     WE HAVE A SINGLE ADDR MUST SEARCH FOR A MATCH                  08300002
****     SEARCH THRU Q'S FOR A MATCH OF THE SINGLE ADDRESS              08350002
SRH0100  DS    0H                  SETUP FOR SEARCH                     08400002
         L     R8,BREAKTAB         R8= ADDR OF ACTIVE BRK POINT QUEUE   08450002
         LA    R5,BREAKTAB         SAVE AS A BACK POINTER               08500002
****     BEGIN LOOP LOOKING FOR ALL ENTRIES OF THE BREAK POINT          08550002
SRH0120  DS    0H                  START FOR SEARCH LOOP                08600002
         LTR   R1,R8               DO WE HAVE A LINK TO WORK WITH       08650002
         BZ    SRH0450             NO STOP SEARCH                       08700002
         L     R4,BRKADDR          R4=ADDR OF THIS BREAK POINT          08750002
         C     R4,BGNRANGE         BRKADDR SAME AS ADDR TO BE DELETED   08800002
         BL    SRH0160             NO CONTINUE WITH NEXT ELEMENT        08850002
****     WAS SOMETHING PREVIOUSLY REMOVED IF SO RETURN CODE = 0         08900002
         BH    SRH0440             IT IS OUT OF RANGE CHECK DEFERED     08950002
         SPACE                                                          09000002
****     WE HAVE THE CORRECT BREAKELEMENT. LINK AROUND IT AND REMOVE    09050002
SRH0140  DS    0H                  REMOVE THE BREAKPOINT                09100002
         L     R8,BRKLINK          GET ADDR OF THE NEXT ELEMENT         09150002
****     R5= ADDR OF THE PREVIOUS BRKLINK THIS MUST LINK TO THE NEXT    09200002
****     BREAK ELEMENT IN THE CHAIN                                     09250002
         B     SRH0180             BRANCH TO THE REMOVAL ROUTINE        09350002
         SPACE                                                          09400002
****     CONTINUE THE SEARCH WITH THE NEXT ELEMENT                      09450002
****     SAVE THE ADDR (R5) OF THE CURRENT BRKLINK FIELD FOR RELINKING  09500002
****     UPDATE R8 TO POINT TO THE NEXT LINK                            09550002
SRH0160  DS    0H                  SAVE CURRENT LINK ADDR AND CONTINUE  09600002
         LA    R5,BRKLINK          SAVE ADDR OF PREVIOUS BRKLINK        09650002
         L     R8,BRKLINK          PLACE ADDR OF NEXT ELEMENT INTO R8   09700002
         B     SRH0120             CONTINUE THE SEARCH                  09750002
SVCERR   EQU   *                                                        09760002
         ST    R14,SAVE14          PRESERVE RETURN ADDR                 09762002
         ST    R2,SAVE2            PRESERVE REGISTER 2                  09764002
         DROP  R3                  DISCONTINUE R3 AS SRHWORK BASE       09766002
         LR    R3,R15              PLACE RETURN CODE IN REG 2           09770002
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO PARM LIST AREA   09780002
         IKJEGSIO SVCERR,SVC=(R2),RC=(R3),ID=SRH28,MF=(E,TSTOIPRM)      09790002
         LA    R2,N12              PLACE DEC 12 IN REG 2                09792002
         CR    R15,R2              IS RC FROM IO > DEC 12               09794002
         BH    SRH0500         IF RC FROM IO > DEC 12 RET WITH IO RC    09796002
         L     R3,WORKAREA         POINT TO TSTCWORK                    09796402
         USING TSTCWORK,R3         ESTABLISH ADDRESSABILITY TO TSTCWORK 09796802
         LA    R3,CWORKSRH         POINT TO CWORKSRH           @ZA27728 09797203
         DROP  R3                  DISCONTINUE R3 AS TSTCWORK BASE      09797602
         USING SRHWORK,R3          ESTABLISH ADDRESSABILITY TO SRHWORK  09797702
         L     R2,SAVE2            RESTORE REGISTER 2                   09798002
         L     R14,SAVE14          RESTORE R14                          09808402
         BR    R14                 GO RETURN                            09829202
         EJECT                                                          09839602
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 09850002
*   THIS SECTION OF CODE REMOVES THE ACTIVE BREAKPOINT WHOSE ADDR IS    09900002
*   IN REGISTER 1. A CHECK IS MADE TO SEE IF THE BRK PT IS OF A RANGE   09950002
*   IF SO THE ADDR STRING IS CHECKED TO SEE IF IT IS SHARED, IF IT IS   10000002
*   THEN IT IS NOT FREED.                                               10050002
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 10100002
         SPACE                                                          10150002
SRH0180  DS    0H                  CHECK IF SEARCH ONLY WAS INDICATED   10200002
         CH    R6,FOUR             WHERE WE TO REMOVE THE BREAK POINT   10250002
         BNE   SRH0200             YES THEREFORE REMOVE IT              10300002
         ST    R1,N4(R7)           STORE THE ADDRESS OF THE BREAKELEMNT 10350002
         B     SRH0480             RETURN WITH RETURN CODE OF 0         10400002
         SPACE                                                          10450002
****     R8 CURRENTLY POINTS TO NEXT ELEMENT (OR ZERO)                  10460002
****     R5 CURRENTLY CONTAINS THE ADDRESS OF THE PREVIOUS BRKLINKAGE   10470002
****     R1 POINTS TO THE ELEMENT TO BE DELETED                         10480002
SRH0200  DS    0H                  REMOVAL OF THE BREAK POINT INDICATED 10500002
         ST    R8,N0(R5)           LINK AROUND ELEMENT TO BE DELETED    10510002
         LR    R8,R1               R8= ADDR OF BEARKPOINT TO BE REMOVED 10550002
         O     R7,HIGHBIT          TURN ON HIGH BIT INDICATING REMOVAL  10600002
         L     R4,BRKNAME          R4=ADDR OF ADDR STRING TO REMOVE     10650002
         L     R5,BRKCHAIN         R5= ADDR OF SUBCOMMAND CHAIN         10700002
         LR    R10,R8              R4= ADDR OF BREAKPOINT TO BE REMOVED 10750002
         TM    BRKFLGS,BRKRANGE    IS THE BREAK PT OF A RANGE           10800002
         BNO   SRH0240             NO THEREFORE FREE ADDR STRING        10850002
****     MUST CHECK IF ADDRESS STRING IS SHARED                         10900002
         L     R8,BREAKTAB         R8= ADDR OF FIRST BREAK ELEMENT      10950002
SRH0220  DS    0H                  LOOK FOR MATCH OF ADDR STRING ADDRES 11000002
         LTR   R8,R8               DO WE HAVE A BREAK ELEMENT           11050002
         BZ    SRH0240             NO MORE THEREFORE FREE ADDR STRING   11100002
         L     R1,BRKNAME          R1= ADDR OF ADDR STRING TO COMPARE   11150002
         CR    R1,R4               ARE THE 2 ADDR STRINGS EQUAL         11200002
         BE    SRH0260             THEY ARE EQUAL DO NOT FREE           11250002
         L     R8,BRKLINK          GET ADDR OF THE NEXT BRK ELEMENT     11300002
         B     SRH0220             CONTINUE LOOKING FOR MATCH           11350002
****     FREE THE ADDRESS STRING (BREAK NAME) IN THE ACTIVE BREAK POINT 11400002
SRH0240  DS    0H                  REMOVE ADDR STRING                   11450002
         LA    R1,N0(R4)           ZERO OUT ANY HIGH ORDER DATA         11500002
         LH    R4,N0(R1)           R5= LENGTH OF THE BREAKNAME          11550002
         LA    R0,N9(R4)           INCREMENT LENGTH BY 9 FOR ROUNDING   11600002
         N     R0,MASKF8           ZERO LOWER 3 BITS                    11650002
         FREEMAIN RC,LV=(0),A=(1),SP=1  FREE THE ADDR STRING            11750002
         LTR   R15,R15             IS RETURN CODE = ZERO                11760002
         BZ    SRH0260             IF ZERO, BRANCH TO SRH0260           11770002
         LA    R2,N120             GET PRESCRIBED FREEMAIN SVC NUMBER   11772002
         BAL   R14,SVCERR          GO WRITE ERROR MESSAGE               11780002
         SPACE                                                          11800002
****     FREE THE SUBCOMMAND CHAIN IF ONE EXIST'S AND IT IS NOT SHARED  11850002
SRH0260  DS    0H                  SEE IF A SUBCHAIN EXISTS             11900002
         LA    R5,N0(R5)           ZERO HIGH ORDER BYTE                 11950002
         LTR   R5,R5               CHECK IF THE SUBCHAIN EXISTS         12000002
         BZ    SRH0340             NO THEREFORE RESTORE THE INST        12050002
         L     R8,BREAKTAB         R8= ADDR OF THE ACTIVE BRK POINTS    12100002
****     THE FOLLOWING LOOP CHECK IF THE SUBCOMMAND CHAIN IS SHARED     12150002
SRH0280  DS    0H                  IS SUBCOMMAND CHAIN SHARED           12200002
         LA    R8,N0(R8)           ZERO THE HIGH ORDER BYTE             12250002
         LTR   R8,R8               IS THERE A BREAK ELEMENT             12300002
         BZ    SRH0300             NO THEREFORE REMOVE THE SUBCHAIN     12350002
         L     R1,BRKCHAIN         R1= ADDR OF SUBCHAIN TO COMPARE      12400002
         CR    R1,R5               IF EQUAL SUBCHAIN SHARED             12450002
         BE    SRH0340             EQUAL THEN RESTORE INST AND FREE     12500002
         L     R8,BRKLINK          R8= ADDR OF THE NEXT BREAK ELEMENT   12550002
         B     SRH0280             CONTINUE SEARCH FOR MATCH            12600002
         SPACE                                                          12650002
****     IS THE CURRENT COMMAND IN THE SUBCOMMAND CHAIN                 12660002
****     IF SO FREE THE CHAIN ANYWAY AND TURN ON FLUSH BIT              12670002
SRH0300  DS    0H                  CHECK IF COMMAND IS IN THE CHAIN     12700002
         L     R1,SUBCHAIN         R1= ADDR OF THE SUBCHAIN IF ANY      12750002
         LA    R1,N0(R1)           ZERO OUT HIGH ORDER BYTE             12800002
         LTR   R1,R1               DOES A SUBCHAIN CURRENTLY EXIST      12850002
         BZ    SRH0320             NO THEREFORE FREE OFF BRK CHAIN      12900002
****     A SUBCHAIN EXISTS SEE IF 'OFF' IS PART OF THE SUBCHAIN         12950002
         CLR   R1,R5               IS SUBCHAIN ADDR LESS THAN BRKCHAIN  13000002
         BL    SRH0320             YES THEREFORE FREE BRKCHAIN          13050002
         LR    R0,R5               R0= ADDR OF START OF CHAIN           13060002
         AH    R0,N0(R5)           R0= END OF BRKCHAIN ADDR             13100002
         CLR   R1,R0               IS CURRENT COMMAND WITHIN SUBCHAIN   13150002
         BNL   SRH0320             NO THEREFORE FREE THE CHAIN          13200002
         XC    SUBCHAIN,SUBCHAIN   ZERO THE SUBCOMMOAND CHAIN PTR       13202002
         OI    TSTFLGS4,TSTFLUSH   TURN ON THE FLUSH BIT                13210002
         SPACE                                                          13250002
****     FREE THE BREAK CHAIN FOUND IN BREAK ELEMENT R5= ADDR BRKCHAIN  13300002
SRH0320  DS    0H                  FREE THE BRKCHAIN                    13350002
         LA    R1,N0(R5)           ZERO OUT ANY HIGH ORDER DATA         13400002
         LH    R5,N0(R1)           R5= LENGTH OF THE BREAKNAME          13450002
         LA    R0,N10(R5)          INCREMENT LENGTH BY 10 FOR ROUNDING  13500002
         N     R0,MASKF8           ZERO LOWER 3 BITS                    13550002
         FREEMAIN RC,LV=(0),A=(1),SP=1   FREE THE ADDR STRING           13650002
         LTR   R15,R15             IS RETURN CODE = ZERO                13670002
         BZ    SRH0340             IF ZERO, BRANCH TO SRH0340           13680002
         LA    R2,N120             GET PRESCRIBED FREEMAIN SVC NUMBER   13690002
         BAL   R14,SVCERR          GO WRITE ERROR MESSAGE               13692002
         SPACE                                                          13700002
****     NOW RESTORE THE INSTRUCTION AND FREE THE BREAK ELEMENT         13750002
SRH0340  DS    0H                  RESTORE THE INST IF ANY              13800002
         LR    R8,R10              RESTORE ADDR'ABILITY TO BREAKELEMENT 13850002
****     IF ENDSW IS ON AND RUNSW IS NOT - DO NOT RESTORE INSTR         13900002
         TM    TSTFLGS1,ENDSW+RUNSW ARE THEY BOTH ON                    13950002
         BM    SRH0420             OMIT RESTORING THE INSTRUCTION       14000002
         L     R5,BRKADDR          R5= ADDROF WHERE THE INST BELONGS    14500002
         TM    TSTFLGS1,RUNSW      IF RUN DON'T VALIDITY CHECK @YM06114 14510002
         BO    SRH0400             CONTINUE PROCESSING         @YM06114 14520002
****     VALIDITY CHECK THE ADDRESS FOR WRITTABLE                       14550002
         L     R10,PPTCB           R10= ADDR OF PP TCB                  14600002
         IKJEGS9G ADDRCHK,TCBADDR=(R10),VALUE=(R5),MF=(E,(R7))          14650002
         LTR   R15,R15             A NONZERO RETURN CODE                14700002
         BZ    SRH0400             GO RESTORE THE INSTRUCTION           14750002
         CH    R15,EIGHT           COMPARE RC TO  '8'                   14750402
         BNH   SRH0420             DO NOT RESTORE THE INSTRUCTION       14750802
         B     SRH0500             RETURN WITH RC FROM SVC97            14750902
SRH0400  DS    0H                                                       14751202
         OI    TSTFLGS1,TSTFIRST   TURN ON THE ABEND SW        @YM06114 14751602
         STM   R14,R12,N12(R13)    SAVE REGS IN CASE OF AN ABEND        14752002
         MVC   N0(N2,R5),BRKINST   RESTOR THE BREAK POINT INSTR         14760002
****     FREE THE ACTIVE BREAK ELEMENT                                  14850002
SRH0420  DS    0H                  ISSUE A FREEMAIN ON THE BRK ELEMENT  14900002
         NI    TSTFLGS1,HEXFF-TSTFIRST TURN OFF THE ABEND SW            14910002
         LA    R1,N0(R8)           R1= ADDR OF BRK ELEM HIGH BYTE IS 0  14950002
         FREEMAIN RC,LV=40,A=(1),SP=1  ISSUE THE FREEMAIN               15000002
         LTR   R15,R15             IS RETURN CODE = ZERO                15010002
         BZ    SRH0430             IF ZERO, BRANCH TO SRH0260           15020002
         LA    R2,N10              GET REGULAR FREEMAIN SVC NUMBER      15030002
         BAL   R14,SVCERR          GO WRITE ERROR MESSAGE               15040002
         B     SRH0480             RETURN WITH A ZERO                   15042002
****     WE ARE DONE WITH THE ELEMENT IN QUESTION BUT IF WE ARE         15050002
****     WORKING ON A RANGE WE MUST CONTINUE                            15100002
SRH0430  DS    0H                  DETERMINE IF THERE IS A RANGE        15110002
         CLC   ENDRANGE,ZEROWORD   IS THERE A RANGE IN PROCESS          15150002
         BE    SRH0480             NO RETURN WITH A ZERO                15200002
         B     SRH0050             CONTINUE SCANNING THE RANGE          15250002
SRH0440  DS    0H                  RETURN WITH A CODE OF 4              15300002
         LTR   R7,R7               HIGH BIT ON INDICATING BRK PT REMOVE 15350002
         BM    SRH0480             BRK PT WAS REMOVED RET CODE = 0      15400002
SRH0450  DS    0H                  RETURN WITH RETURN CODE OF FOUR      15410002
         LA    R15,N4              R15= RETURN CODE 04                  15450002
         B     SRH0500             RETURN TO CALLER                     15500002
SRH0460  DS    0H                  RETURN CODE OF 08                    15550002
         LA    R15,N8              R15= RETURN CODE 08                  15600002
         B     SRH0500             RETURN TO CALLER                     15650002
SRH0480  DS    0H                  RETURN WITH A NORMAL ZERO RET CODE   15700002
         XR    R15,R15             ZERO REGISTER 15 AS RETURN CODE      15750002
SRH0500  DS    0H                  RETURN WITH AN ERROR NONZERO RET COD 15800002
         LR    R2,R15              PRESERVE RETURN CODE                 15800402
         ESTAE 0                   REMOVE SCB                           15800802
         LR    R15,R2              PLACE RETURN CODE                    15801202
SRH0600  DS    0H                  RETURN WITH RETURN CODE IN REG 15    15801602
         L     R2,WORKAREA         POINT TO TSTCWORK                    15802002
         USING TSTCWORK,R2         ESTABLISH ADDRESSABILITY TO TSTCWORK 15804002
         L     R2,CWORKSRH         POINT TO CWORKSRH                    15806002
         DROP  R2                  DISCONTINUE R2 AS TSTCWORK BASE      15808002
         USING SRHWORK,R2         ESTABLISH ADDRESSABILITY TO CWORKSRH  15808402
         MVC   ABENTAB1(N4),MISC    RESTORE OLD ABEND INFORMATION       15810002
         L     R13,N4(R13)         R13= ADDR OF CALLERS SAVE AREA       15850002
         RETURN (14,12),,RC=(15)   THIS WILL RETUNR TO THE CALLER       15900002
         DROP  R8                  RELEASE BRK'S ADDR'IBILITY           16000002
         EJECT                                                          16010002
**********************************************************************  16020002
*        THE RETRY ROUTINE AND ABEND TABLE                              16030002
**********************************************************************  16030402
         SPACE                                                          16030802
STAELIST STAE  MF=L                LIST FORM OF THE STAE                16032802
STAELN   EQU   *-STAELIST          END OF STAE EXPANSION                16034802
ADDRETRY DC    A(RETRYRTN)         ADDRESS OF THE RETRY ROUTINE         16036802
ABENDTAB DS    0H                  THE ABEND TABLE FOR STAE             16038002
         DC    X'00'               ZERO POINTER                         16038402
         DC    AL3(SRH0420)        POINTER WHERE INSTRUCTION IS REPLACE 16038802
         DC    X'FF'               END OF TABLE INDICATOR               16039702
****     THE BEGINING OF THE RETRY ROUTINE                              16039802
RETRYRTN DS    0H                  THE RETRY ROUTINE                    16039902
         L     R5,CVTPTR           R5= ADDR OF THE CVT                  16043202
         USING CVT,R5              ESTABLISH ADDR'ABILITY TO THE CVT    16045202
         L     R1,CVTTCBP          R1= ADDR OF NEW CURRENT TCB'S        16045602
         L     R5,N4(,R1)          R5= ADDR OF CURRENT TCB (TEST TCB)   16046002
         DROP  R5                  RELEASE ADDR'ABILITY TO THE CVT      16046402
         USING TCB,R5              ESTABLISH ADDR'ABILITY TO THE TCB    16046502
         L     R9,TCBTRN           R9= ADDR OF TCOMTAB (RESTORE)        16046602
         DROP  R5                  RELEASE ADDR'ABILITY TO TCB          16059902
         L     R13,REGSAVE6        R13= ADDR OF CURRENT SAVEAREA        16069902
         LM    R14,R12,N12(R13)    RESTORE ALL REGISTERS FOR SRH        16071902
         SPACE                                                          16077702
*****************************************************************       16083202
*                                                                       16083602
*  MUST TURN OFF RETRY INDICATOR BEFORE BRANCHING OUT,                  16084002
*  FOR OTHERWISE IF ANOTHER ABEND OCCURS PERCOLATION                    16084402
*  WILL TAKE PLACE                                                      16084802
*                                                                       16084902
*****************************************************************       16085602
         SPACE                                                          16087302
         NI    TSTFLGS4,HEXFF-TSTRERTN  TURN OFF RETRY INDICATOR        16088002
         TM    TSTFLGS1,TSTFIRST   ABEND 0C4 WHILE RESTORING INSTRUCTON 16088702
         BO    SRH0420             CONTINUE BY FREEING THE BREAKELEMENT 16089402
         NI    TSTFLGS1,HEXFF-TSTFIRST TURN OFF THE ABEND SWITCH        16090602
         LA    R15,N20             R15= DEC 20 (RETURN CODE)            16091002
         B     SRH0500             RETURN TO CALLER (MAINLINE)          16091102
         EJECT                                                          16095602
**********************************************************************  16100002
*        CONSTANTS USED BY THE SRH ROUTINE                              16150002
**********************************************************************  16200002
         DS    0F                  ALIGNMENT                            16250002
ZEROWORD DC    X'00000000'         ONE WORD OF 0'S                      16260002
MASKF8   DC    X'00FFFFF8'         MASK TO ZERO TOP BYTE LOWER 3 BITS   16300002
SUBPOOL1 DC    X'01000000'         SUBPOOL ONE                          16350002
HIGHBIT  DC    X'80000000'         TURNS ON THE HIGH ORDER BIT          16400002
FOUR     DC    H'04'               CONSTANT FOUR                        16402002
EIGHT    DC    H'08'               CONSTANT EIGHT                       16404002
SUPERZAP DC    50CL1'Z'            SUPERZAP PATCHING AREA               16410002
ESTAEL   ESTAE MF=L                                                     16420002
ESTAELN  EQU   *-ESTAEL                                                 16430002
LIST     IKJEGSPL RTRY=RETRYRTN,ABNTB=ABENDTAB,MODNM=IKJEGSRH,TNM=SRH   16440002
         EJECT                                                          16450002
************************************************************            16500002
**                                                        **            16550002
**                  TCOMTAB DSECT                         **            16600002
**                                                        **            16650002
************************************************************            16700002
TCOMTAB TCOMTAB                                                         16750002
         EJECT                                                          16800002
************************************************************            16850002
**                                                        **            16900002
**                     BREAKPOINT QUEUE DSECT             **            16950002
**                                                        **            17000002
************************************************************            17050002
         BRKELEM                                                        17100002
         EJECT                                                          17110002
************************************************************            17120002
**                                                        **            17130002
**                     TCB DSECT                          **            17140002
**                                                        **            17142002
************************************************************            17144002
         IKJTCB                                                         17146002
         EJECT                                                          17149902
************************************************************            17199902
**                                                        **            17209902
**                     CVT DSECT                          **            17219902
**                                                        **            17229902
************************************************************            17239902
CVT      DSECT                                                          17241902
         CVT                                                            17242002
         TSTCWORK                  TEST WORKAREA DSECT                  17242402
         SPACE                                                          17242902
*********************************************************************** 17243302
*                                                                     * 17243702
*     THIS DSECT DESCRIBES THE SRH WORK-AREA                          * 17243802
*                                                                     * 17293802
*********************************************************************** 17303802
SRHWORK  DSECT                                                          17313802
SAVE1    DS    F                   SAVE REG1                            17323802
SAVE2    DS    F                   SAVE REG2                            17333802
SAVE14   DS    F                   SAVE REG14                           17334202
BGNRANGE DS    F                   SAVE START OF RANGE ADDR             17335802
ENDRANGE DS    F                   SAVE END OF RANGE ADDR               17336202
MISC     DS    12X                 MISCELLANEOUS WRK-AREA               17337802
         EJECT                                                          17343802
         END                                                            17393802
./  ADD  SSI=81730773,NAME=IKJEGSTA
         TITLE 'IKJEGSTA'                                               00100002
* /* START OF SPECIFICATIONS ****                                       00150002
*02*  PROCESSOR = ASSEMBLER                                             00160002
**** END OF SPECIFICATIONS ***/                                         00170002
         COPY IKJEGSIO                                                  00180002
*c177600                                                       @ZA00918 00190003
*C173000,266220                                                @ZA04792 00192003
*C001690-001700                                                @ZA07737 00194003
********************************************************************    00200002
*                                                                  *    00300002
* STATUS                                                           *    00400002
*    CHANGE LEVEL 000, VERSION 01, OS/VS2                          *    00500002
*                                                                  *    00600002
* FUNCTION/OPERATION                                               *    00700002
*    THIS ROUTINE IS GIVEN CONTROL WHEN AN ABEND SITUATION OCCURS  *    00800002
*    IN ANY OF THE TEST COMMAND MODULES. UNLESS THE 'NO MESSAGES'  *    00900002
*    OPTION IS REQUESTED, IT WILL INITIALIZE TO PRINT A STANDARD   *    01000002
*    1ST AND 2ND LEVEL MESSAGE. THE 1ST LEVEL MESSAGE WILL HAVE    *    01100002
*    THE NAME OF THE ABENDING COMMAND MODULE INSERTED.  THE SECOND *    01200002
*    LEVEL MSG WILL HAVE AN APPROPRIATE ERROR DESCRIPTION APPENDED.*    01300002
*    OBTAINS ADDRESS OF APPROPRIATE RETRY ROUTINE FROM THE ESTAE   *    01500002
*    PARAMETER LIST WHICH IS MADE AVAILABLE VIA THE 'LIST' KEYWORD *    01550002
*    OF THE ESTAE MACRO, AND PASSES THE ADDRESS BACK TO THE        *    01560002
*    ABEND/STAE INTERFACE ROUTINE.                                 *    01600002
* ENTRY POINTS                                                     *    01800002
*         IKJEGSTA                                                 *    01900002
*                                                                  *    02000002
* INPUT                                                            *    02100002
*                                                                  *    02200002
* OUTPUT                                                           *    02300002
*    1.  ERROR MESSAGES TO THE MESSAGE WRITER                      *    02400002
*    2.  RETURN CODE - R15                                         *    02500002
*    *              0     TO INDICATE THAT ABEND PROCESSING SHOULD *    02600002
*    *                    CONTINUE. (THIS RETURN CODE RESULTS WHEN *    02700002
*    *                    EITHER TCOMTAB WAS FREED PRIOR TO ENTRY  *    02800002
*    *                    TO THIS ROUTINE OR AN ERROR WAS ENCOUNT- *    02900002
*    *                    ERED BY IKJEGIO1 WHEN CALLED TO WRITE    *    03000002
*    *                    OUT MESSAGES.)                           *    03100002
*    *              4     TO INDICATE THAT CONTROL IS TO BE GIVEN  *    03200002
*    *                    TO A RETRY ROUTINE.                      *    03300002
*    3.  R0 = ADDRESS OF RETRY ROUTINE                                  03400002
*                                                                  *    03500002
* EXTERNAL REFERENCES                                              *    03600002
*         IKJEGIO  - OUTPUTS ERROR MESSAGES. INVOKED BY THE        *    03700002
*         *          IKJEGSIO MACRO.                               *    03800002
*         IKJEGSCD - USED IN SEARCH FOR NAME OF ABENDING MODULE.   *    03900002
*                                                                  *    04100002
* EXITS,NORMAL                                                     *    04200002
*         RETURN VIA REGISTER 14 TO THE CALLER                     *    04300002
*                                                                  *    04400002
* EXITS,ERROR                                                      *    04500002
*         RETURN VIA REGISTER 14 TO THE CALLER                     *    04600002
*                                                                  *    04700002
* TABLES/WORK AREAS                                                *    04800002
*    TCOMTAB                                                       *    04900002
*    STAWORK - STAE WORK AREA                                      *    05000002
*                                                                  *    05100002
* ATTRIBUTES                                                       *    05200002
*    REENTRANT                                                     *    05300002
*                                                                  *    05400002
* CHARACTER CODE DEPENDENCY                                        *    05500002
*    THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL         *    05600002
*    REPRESENTATION OF THE EXTERNAL CHARACTER SET WHICH IS         *    05700002
*    EQUIVALENT TO THE ONE USED AT ASSEMBLY TIME. THE CODING HAS   *    05800002
*    BEEN ARRANGED SO THAT REDEFINITION OF 'CHARACTER' CONSTANTS,  *    05900002
*    BY REASSEMBLY, WILL RESULT IN A CORRECT MODULE FOR THE NEW    *    06000002
*    DEFINITIONS.                                                  *    06100002
*                                                                  *    06200002
* NOTES                                                            *    06300002
*    1.  AT ENTRY, THE REGISTER CONTENTS WILL BE -                 *    06400002
*    * 1A. IF A 512-BYTE WORKAREA IS AVAILABLE...                  *    06500002
*    *     REG0 = 0   ACTIVE I/O WAS QUISCED AND IS RESTORABLE     *    06600002
*    *            4   ACTIVE I/O WAS HALTED AND IS NOT RESTORABLE  *    06700002
*    *            8   NO I/O WAS ACTIVE                            *    06800002
*    *                                                             *    06900002
*    *     REG1 = PTR TO 512 BYTE WORK AREA                        *    07000002
*    *     REGS 2-12 = UNPREDICTABLE                               *    07100002
*    *     REG13 = ADDR OF A REG SAVE AREA                         *    07200002
*    *     REG14 = RETURN ADDR                                     *    07300002
*    *     REG15 = ADDR OF STAE EXIT ROUTINE                       *    07400002
*                                                                  *    07500002
*    * 1B. IF STORAGE FOR THE 512-BYTE WORKAREA WAS NOT AVAILABLE..*    07600002
*    *     REG0  = 12                                              *    07700002
*    *     REG1  = ABEND COMPLETION CODE                           *    07800002
*    *     REG2  = PTR TO STAE EXIT PARAM LIST                     *    07900002
*    *     REGS 3-12 = SAME AS ABOVE                               *    08000002
*    *     REG13 = UNPREDICTABLE                                   *    08100002
*    *     REGS 14-15 = SAME AS ABOVE                              *    08200002
*                                                                  *    08300002
*    2.  AT EXIT, THE REGISTER CONTENTS WILL BE -                  *    08400002
*                                                                  *    08500002
*    *     REG0  = ADDRESS OF RETRY ROUTINE                        *    08600002
*    *     REG1  = ADDR OF WORK AREA OR ZERO IF NOT AVAILABLE      *    08700002
*    *     REGS 2-12 = UNPREDICTABLE                               *    08800002
*    *     REGS 13-14 = SAME AS AT ENTRY                           *    08900002
*    *     REG15= RETURN CODE OF 4                                 *    09000002
*    3.  PLM = SY35-0004                                           *    09050002
*    *     TSO COMMAND PROCESSOR LOGIC                             *    09060002
*    *     VOLUME III - TEST                                       *    09070002
*                                                                  *    09100002
********************************************************************    09200002
*    CHANGE ACTIVITY:                                              *    09220003
*        @AZ17298 - REMOVED JOB STEP DEPENDENCY FOR TEST.          *    09240003
********************************************************************    09260003
         EJECT                                                          09300002
IKJEGSTA CSECT                                                          09400002
******************************************************************      09500002
*                                                                       09600002
*        REGISTER EQUATES                                               09700002
*                                                                       09800002
R0       EQU   0                   REFLECTS STATUS OF TASK/WORKAREA     09900002
R1       EQU   1                   COMPLETION CODE / WORKAREA PTR       10000002
R2       EQU   2                   PTR TO PARM LIST                     10100002
R3       EQU   3                   WORK REG                             10200002
R4       EQU   4                   *                                    10300002
R5       EQU   5                   *                                    10400002
R6       EQU   6                   *                                    10500002
R7       EQU   7                   *                                    10600002
R8       EQU   8                   *                                    10700002
R9       EQU   9                   TCOMTAB BASE REG                     10800002
R10      EQU   10                  STA WORKAREA BASE                    10900002
R11      EQU   11                  MODULE BASE REG                      11000002
R13      EQU   13                  SAVE AREA PTR                        11100002
R12      EQU   12                  NOT USED                             11200002
R14      EQU   14                  RETURN ADDR                          11300002
R15      EQU   15                  STAE ADDR                            11400002
*                                                                       11500002
******************************************************************      11600002
         SPACE 2                                                        11700002
******************************************************************      11800002
*                                                                       11900002
*        SYMBOL AND NUMBER EQUATES                                      12000002
*                                                                       12100002
ZERO     EQU   0                   NO. 0                                12200002
ONE      EQU   1                   NO. 1                                12300002
TWO      EQU   2                   NO. 2                                12400002
THREE    EQU   3                   NO. 3                                12500002
FOUR     EQU   4                   NO. 4                                12600002
TCBADDR  EQU   4                   DISPLACEMENT FOR TEST'S TCB ADDR     12700002
FIVE     EQU   5                   NO. 5                                12800002
SIX      EQU   6                   NO. 6                                12900002
SEVEN    EQU   7                   NO. 7                                13000002
EIGHT    EQU   8                   NO. 8 (DISPL FOR 1ST LEVEL MSG)      13100002
NINE     EQU   9                   NO. 9                                13200002
TEN      EQU   10                  NO. 10                               13300002
TWELVE   EQU   12                  NO. 12                               13400002
THIRTN   EQU   13                  NO. 13                               13500002
N15      EQU   15                  NO. 15                               13600002
SIXTEEN  EQU   16                  CVT DISPL                            13700002
TWENTY2  EQU   22                  NO. 22                               13800002
TWENTY4  EQU   24                  NO. 24                               13850002
TWENTY9  EQU   29                  NO. 29                               13860002
THIRTY5  EQU   35                  NO. 35                               13900002
THIRTY7  EQU   37                  NO. 37                               14000002
THIRTY8  EQU   38                  NO. 38                               14100002
FORTY4   EQU   44                  NO. 44                               14200002
FORTY5   EQU   45                  NO. 45                               14250002
FIFTY3   EQU   53                  NO. 53                               14300002
SIXTY9   EQU   69                  NO. 69                               14400002
EIGHTY1  EQU   81                  NO. 81                               14500002
NINETY3  EQU   93                  NO. 93                               14600002
NINETY5  EQU   95                  NO. 95                               14700002
HEX00    EQU   X'00'               'NO MESSAGE' CODE                    14800002
HEX07    EQU   7                   NO. 7                                14900002
BLANK    EQU   X'40'               BLANK                                15000002
HEX80    EQU   X'80'               NO. 80                               15050002
RBOK     EQU   X'C0'               INDICATES A PRB                      15100002
HEXF0    EQU   X'F0'               MASK TO SET SIGN BYTE                15200002
HEXFF    EQU   X'FF'               MASK BYTE FOR ABEND COMPL CODE       15300002
*                                                                       15400002
******************************************************************      15500002
         EJECT                                                          15600002
*        START OF MODULE CODE                                           15700002
*                                                                       15800002
         LR    R11,R15             SET UP MODULE ADDRESSABILITY         15900002
         USING IKJEGSTA,R11                                             16000002
         SPACE                                                          16100002
         L     R8,CVTPTR           ADDR OF CVT                          16200002
         USING CVTDSECT,R8         ADDRESSABILITY TO CVT                16300002
         L     R8,CVTTCBP          PTR TO TCB ADDR                      16400002
         DROP  R8                                                       16500002
         L     R8,TCBADDR(ZERO,R8) TCB ADDR                             16600002
         SPACE                                                          16700002
         USING TCB,R8              ADDRESSABILITY TO TCB                16800002
*        L     R4,TCBJSTCB        GET JOB STEP TCB ADDR    @ZA06995     16810003
*                                 DELETED                  @ZA17298     16820003
*        DROP  R8                 DELETED                  @ZA17298     16826003
*        USING TCB,R4             DELETED                  @ZA17298     16840003
         SLR   R9,R9               TCBTRN FIELD OF TEST'S TCB  @ZA07737 16900003
         ICM   R9,HEX07,TCBTRN+1   CONTAINS PTR TO TCOMTAB     @ZA07737 16950003
*        DROP  R4                 DELETED                  @ZA17298     16970003
*        USING TCB,R8             DELETED                  @ZA17298     17000003
         SPACE                                                          17100002
*********************************************************************** 17150002
*  CHECK TO DETERMINE IF THE TCOMTAB HAS BEEN FREED.  IF SO, ISSUE    * 17152002
*  THE 'SETRP' MACRO AND PERCOLATE.                                   * 17154002
*********************************************************************** 17160002
         LTR   R9,R9               CHECK IF TCOMTAB HAS BEEN FREED      17200002
         BZ    OOPS            IF SO, RECORD IN LOGREC AND RETURN       17250003
*                                                              @ZA04792 17300003
         SPACE                                                          17400002
         USING TCOMTAB,R9          ADDRESSABILITY TO COMMUNICATION AREA 17500002
*                                                                       17600002
         SPACE                                                          17700002
         LR    R4,R0               SAVE R0                     ZXCZXCZX 17710002
         LR    R3,R1               SAVE R1                     ZXCZXCZX 17720002
         L     R0,SAVELNGH         R0 = SAVE AREA LENGTH       ZXCZXCZX 17750002
         GETMAIN RU,LV=(0),SP=78   GETMAIN FOR NEW SAVEAREA CHAIN.      17760003
         L     R10,WORKAREA        ADDRESS OF COMMON WORK AREA          17800002
         USING TSTCWORK,R10        ESTABLISH ADDRESSABILITY             17900002
         SPACE                                                          18000002
         LA    R10,CWORKSTA        R10 = ADDR OF STAE'S WORK AREA       18100002
         DROP  R10                                                      18200002
         SPACE                                                          18300002
         USING STAWORK,R10         ESTABLISH ADDRESSABILITY             18400002
         MVC   FLAGS4(ONE),TSTFLGS4     PRESERVE TSTFLGS4 UNTIL EXIT    18410002
         NI    TSTFLGS4,HEXFF-TSTVALCK  TURN OFF VALIDITY CK INDICATOR  18420002
         ST    R8,TCBPTR           SAVE TCB ADDRESS                     18450002
         SPACE                                                          18500002
         STM   R13,R14,REGSAV      SAVE REGS 13 AND 14                  18800002
         LR    R13,R1              R13=ADDR NEW SAVEAREA CHAIN ZXCZXCZX 18800402
         LR    R1,R3               RESTORE R1 TO RTCA          ZXCZXCZX 18800802
         LR    R0,R4               RESTORE R0                  ZXCZXCZX 18801202
         L     R3,ECBTST           GET PTR TO TEST DESPATCHABILITY ECB  18802002
         TM    ZERO(R3),HEX80      IS SVC 97 OR 61 ACTIVE               18804002
         BZ    CKRETRY             NO - GO CHECK FOR RETRY FAILURE      18806002
         OI    FLAGS,SVCFAIL       INDICATE SVC 97 OR 61 FAILURE        18808002
         SPACE                                                          18810002
*********************************************************************** 18820002
*  CHECK TO DETERMINE IF RETRY WAS IN PROCESS OR IF I/O WAS TRYING TO   18822002
*  SERVICE  AN ESTAE REQUEST WHEN THE ABEND OCCURRED                    18824002
*********************************************************************** 18830002
CKRETRY  DS    0H                                                       18832002
         TM    TSTFLGS4,TSTRERTN   WAS A RETRY IN PROCESS               18840002
         BNZ   DETERMN             IF SO, TURN OFF FLAGS AND PERCOLATE  18842002
         SPACE                                                          18848002
*********************************************************************** 18848402
*  DETERMINE IF THE SYSTEM SUCCEEDED IN ESTABLISHING THE RTCA           18848502
*  (RECOVERY TERMINATION COMMUNICATION AREA)                            18848602
*********************************************************************** 18848802
         LA    R3,TWELVE           GET DECIMAL TWELVE                   18850002
         CR    R0,R3               DO WE HAVE HAVE THE RTCA             18860002
         BE    FINDRB              NO - WE MUST GET INFORMATION ELSEWHR 18880002
         B     HAVRTCA             YES                                  18890002
         SPACE 2                                                        18900002
*********************************************************************** 18948902
*  DETERMINE IF THE RTCA IS AVAILABLE FOR RECORDING                     18958902
*  IF THERE IS NO RTCA, THERE CAN BE NO RECORDING                       18960902
*********************************************************************** 18968902
NOTCOMTB DS    0H                                                       18970902
DETERMN  DS    0H                                                       18972902
         LA    R3,TWELVE           GET DECIMAL TWELVE                   18978902
         CR    R0,R3               DO WE HAVE HAVE THE RTCA             18988902
         BE    PERCOLA1            NO, GO SKIP RECORDING AND PERCOLATE  18990902
         B     PERCOLAT            OTHERWISE, RECORD AND PERCOLATE      19045702
         EJECT                                                          19063802
*****************************************************************       19081902
*                                                               *       19100002
*        THE OPSW ENTRY IN THE HIGHEST RB ON THE CHAIN, AFTER   *       19200002
*        THE FIRST SVRB/SIRB, WILL CONTAIN THE ABENDING         *       19300002
*        MODULE'S PSW IC. (IF THIS RB IS ASSOCIATED WITH A      *       19400002
*        MODULE THAT IS BEING FETCHED, THE NEXT LOWER RB WILL   *       19500002
*        BE USED).  THIS IC WILL BE COMPARED WITH THE IC TABLE  *       19600002
*        OF THE LAST MODULE TO ISSUE THE STAE MACRO. A POINTER  *       19700002
*        TO THIS TABLE IS FOUND IN TCOMTAB AT THE ABENTAB OR    *       19800002
*        ABENTAB1 ENTRIES.                                      *       19900002
*                                                               *       20000002
*****************************************************************       20100002
         SPACE 2                                                        20200002
FINDRB   DS    0H                                                       20300002
         NI    FLAGS,RTCAN         INDICATE THAT RTCA DOES NOT EXIST    20300102
         ST    R2,PARMLST@         SAVE PARAM LIST ADDRESS              20300402
         DROP  R8                                                       20302002
         LR    R2,R8               GET TCB ADDRESS                      20304002
         USING TCB,R2              RESTABLISH ADDRESSABILITY TO TCB     20310002
         L     R3,TCBRBP           GET PTR TO FIRST RB                  20350002
         USING RBSECT,R3           SET UP ADDRESSABILITY                20400002
         ST    R3,SVRB@            SAVE LAST SVRB ADDRESS               20450002
         SPACE                                                          20500002
SVRBCHK  TM    RBSTAB1,RBFTSIRB    IS THIS AN SVRB/SIRB                 20600002
         BO    RBCHK               YES...GO FIND FIRST RB               20700002
         ST    R3,SVRB@            SAVE LAST SVRB ADDRESS               20750002
         SPACE                                                          20800002
         L     R3,RBLINK           CHECK AGAIN                          20900002
         B     SVRBCHK             CHECK AGAIN                          21000002
         SPACE                                                          21100002
RBCHK    TM    RBSTAB1,RBFTP       IS RB A PRB                          21200002
         BZ    GETIC               YES...                               21300002
         ST    R3,SVRB@            SAVE LAST SVRB ADDRESS               21350002
         L     R3,RBLINK           GET PTR TO NEXT RB                   21400002
         B     RBCHK               CHECK AGAIN                          21500002
         SPACE                                                          21600002
GETIC    EQU   *                                                        21700002
         TM    FLAGS,SVCFAIL       ARE WE PROCESSING AN SVC ABEND       21770002
         BZ    GETCDE              NO - GO GET CDE POINTER              21770402
         L     R3,SVRB@            GET SVRB ADDRESS                     21772002
         B     GETAPSW             GO GET PSW                           21774002
GETCDE   DS    0H                                                       21780002
         L     R4,RBCDE            GET CDE ADDR                         21800002
         LTR   R4,R4               IS IT ZERO                           21900002
         BZ    NEXTRB              YES...USE NEXT RB                    22000002
         SPACE                                                          22100002
         USING CDENTRY,R4          ESTABLISH ADDRESSABILITY TO CDE      22150002
         TM    CDATTR,BLANK        CHECK FOR 'HEX 40'--MODULE IS        22200002
*                                  BEING FETCHED                        22300002
         BZ    GETAPSW             NO...USE THIS RB                     22400002
         DROP  R4                  RELEASE CDE BASE REGISTER            22450002
         SPACE                                                          22500002
NEXTRB   L     R3,RBLINK           GET NEXT LOWER RB                    22600002
         SPACE                                                          22700002
* R3 CONTAINS THE CORRECT RB ADDRESS                                    22800002
GETAPSW  LA    R4,RBABOPSW         GET APSW LOCATION OF RB              22900002
         L     R5,ZERO(ZERO,R4)    GET APSW ITSELF                      23000002
         LTR   R5,R5               IS IT ZERO                           23100002
         BNZ   USEAPSW             NO...APSW = OPSW                     23200002
         SPACE                                                          23300002
         LA    R4,RBOPSW+FOUR      USE RIGHT HALF OF ABENDING           23400002
*                                  MODULE'S PSW                         23500002
         DROP  R3                                                       23600002
USEAPSW  LA    R3,0(ZERO,R4)       PTR TO IC                            23700002
         SPACE                                                          23800002
         SPACE                                                          23900002
         BAL   R14,INSERT          BUILD FIRST LEVEL MESSAGE            24000002
         SPACE                                                          24010002
         L     R5,PARMLST@         GET PARAM LIST ADDRESS               24050002
         L     R5,ABENTAB@-LIST(R5)     GET ADDRESS OF ABEND TABLE      24060002
         LTR   R5,R5               IS ABENTAB1 = 0  (IF SO, THERE       24300002
*                                  IS NO COMMAND MODULE IN CORE)        24400002
         BZ    SRCHABTB            SET UP TO SEARCH ABENTAB             24500002
         SPACE                                                          24600002
         BAL   R14,SEARCH          SEARCH IC'S OF USER'S ABEND TABLE    24700002
         SPACE                                                          24800002
SRCHABTB L     R5,ABENTAB          GET ADDR OF RESIDENT IC TABLE        24900002
SRCH2    DS    0H                                                       24950002
         BAL   R14,SEARCH          SEARCH IC'S OF ABENTAB               25000002
         B     MSGIO               GO ISSUE MESSAGES                    25050002
         SPACE 6                                                        25100002
*********************************************************************** 25150002
*  GET INFORMATION FORM THE RTCA AS FOLLOWS:                            25200002
*  DETERMINE IF PERCOLATION HAS OCCURRED;                               25250002
*  GET PARAM LIST ADDRESS;                                              25252002
*  GET ABEND INSTRUCTION COUNTER.                                       25260002
*********************************************************************** 25270002
HAVRTCA  DS    0H                                                       25280002
         USING SDWA,R1             ESTABLISH ADDR TO RTCA(SDWA)         25290002
         ST    R1,RTCA@            SAVE ADDRESS OF THE RTCA             25290402
         TM    SDWAERRC,SDWAPERC   IS THIS EXIT RTN BEING PERCOLATED TO 25290502
         BZ    INDICATE            NO - GO INDICATE EXISTENCE OF RTCA   25290602
         OI    TSTFLGS4,TSTPERC    INDICATE THAT PERCOLATION HAPPENED   25290702
*        B     RETURN              GO ALLOW RETRY TO BE ATTEMPTED       25292002
INDICATE OI    FLAGS,RTCA          INDICATE THAT RTCA EXISTS            25294802
         MVC   PARMLST@(FOUR),SDWAPARM  GET PARAM LIST ADDRESS          25295202
         LA    R4,SDWANXTA         GET INSTRUCTION COUNTER POINTER      25348002
         LA    R3,ZERO(ZERO,R4)    PTR TO IC                            25398002
         N     R3,MASKUP           POINT TO FULL WORD BOUNDARY          25408002
*                                                                       25448002
         BAL   R14,INSERT          BUILD FIRST LEVEL MESSAGE            25498002
         L     R5,PARMLST@         GET PARAM LIST ADDRESS               25508002
         CLC   MODNAME-LIST(EIGHT,R5),SVC97  DID SVC 97 ABEND  ZXCZXCZX 25518002
         BE    INDSVC              YES SET SVC FLAG            ZXCZXCZX 25520002
         CLC   MODNAME-LIST(EIGHT,R5),SVC61  DID SVC 61 ABEND  ZXCZXCZX 25528002
         BE    INDSVC              YES SET SVC FLAG            ZXCZXCZX 25538002
CONTABND DS    0H                  CONTINUE                    ZXCZXCZX 25540002
         L     R5,ABENTAB@-LIST(R5)     GET ADDRESS OF ABEND TABLE      25548002
         LTR   R5,R5               DID MODULE PROVIDE ABEND TABLE       25598002
         BZ    SRCHABTB            IF NOT, SEARCH RESIDENT TABLE        25648002
         B     SRCH2               GO SEARCH MODULE ABEND TABLE         25648502
         SPACE                                                          25648902
INDSVC   DS    0H                  SET SVCFLAG INDICATING SVCS FAILED   25649302
         OI    FLAGS,SVCFAIL       SET THE FLAG                ZXCZXCZX 25649702
         B     CONTABND            CONTINUE                    ZXCZXCZX 25649802
         EJECT                                                          25650002
         SPACE 6                                                        25660002
RETURN   EQU   *                   RETURN FOR RETRY                     25700002
         MVC   TSTFLGS4(ONE),FLAGS4     RESTORE TSTFLGS4                25710002
         NI    TSTFLGS4,HEXFF-TSTESTAE I/O FINISHED ESATE REQUEST       25750002
         OI    TSTFLGS4,TSTRERTN   INDICATE RETRY BENIG ATTEMPTED       25760002
         LA    R15,FOUR            INDICATE CONTROL TO BE GIVEN         25800002
*                                  TO RETRY ROUTINE                     25900002
         L     R1,PARMLST@         GET ADDR OF PARAM LIST               26000002
         L     R0,ZERO(R1)         GET ADDR OF RETRY ROUTINE            26050002
         L     R1,RTCA@            GET ADDR OF 152-BYTE WORKAREA        26100002
         LR    R7,R13              SAVE ADDR OF CORE TO FREE  @ZAZZZZZ  26150003
         LM    R13,R14,REGSAV      RESTORE SAVE AND RETURN REGS         26300002
         TM    FLAGS,SVCFAIL       DID THE SVCS FAIL.                   26350002
         BO    NOSETRP             YES DO NOT ISSUE SETRP      ZXCZXCZX 26400002
         SETRP RETADDR=(R0),RECORD=YES,FRESDWA=YES,RC=4                 26450002
NOSETRP  DS    0H                  RETURN.                     ZXCZXCZX 26452002
         BAL   R8,FREECORE         GO FREE WORK AREA           @ZAZZZZZ 26456003
         BR    R14                 RETURN TO CALLER                     26460002
         SPACE                                                          26500002
PERCOLAT EQU   *                                                        26600002
         LR    R7,R13         SAVE ADDR OF CORE TO FREE       @ZAZZZZZ  26601003
         LM    R13,R14,REGSAV      RESTORE SAVE AND RETURN REGS         26602002
         BAL   R8,FREECORE         FREE WORK AREA              @ZAZZZZZ 26606003
         NI    TSTFLGS4,HEXFF-TSTESTAE TURN OFF I/O SERVING ESTAE FLAG  26610002
         NI    TSTFLGS4,HEXFF-TSTRERTN TURN OFF RETRY IN PROCESS FLAG   26620002
OOPS     LA    R3,TWELVE           GET DECIMAL TWELVE          @ZA04792 26621003
         CR    R0,R3               DO WE HAVE HAVE THE RTCA             26624002
         BE    PERCOLA1            NO - WE MUST NOT ATTEMPT TO RECORD   26626002
         SETRP RECORD=YES,RC=0                                          26630002
PERCOLA1 EQU   *                                                        26650002
         SR    R0,R0               SET RETRY ADDRESS TO 0               26700002
         SR    R15,R15             SET RETURN CODE TO 0 TO ALLOW        26750002
*                                  ABEND TO CONTINUE (PERCOLATION)      26800002
         BR    R14                 RETURN TO CALLER                     26900002
         EJECT                                                          27000002
FREECORE EQU   *                                                        27005003
*******                                                                 27010003
*  FREE THE WORK AREA BEFORE EXITING                          @ZAZZZZZ  27015003
*      R7 POINTS TO THE CORE TO FREE ON ENTRY                 @ZAZZZZZ  27020003
*******                                                                 27025003
         SPACE 3                                                        27030003
         LR    R2,R0         SAVE REG 0 ACROSS THE FREEMAIN   @ZAZZZZZ  27035003
         LR    R3,R1         SAVE R1                          @ZAZZZZZ  27040003
         LR    R4,R15        SAVE R15                         @ZAZZZZZ  27045003
         L     R0,SAVELNGH   R0 = WORK AREA LENGTH            @ZAZZZZZ  27050003
         FREEMAIN RU,LV=(0),A=(7),SP=78                        @ZAZZZZZ 27055003
         LR    R0,R2         RESTORE REG0                     @ZAZZZZZ  27060003
         LR    R1,R3         RESTORE REG1                     @ZAZZZZZ  27065003
         LR    R15,R4        RESTORE REG15                    @ZAZZZZZ  27070003
         BR    R8            RETURN TO CALLER                 @ZAZZZZZ  27075003
         EJECT                                                          27080003
**********************************************************************  27100002
*                                                                    *  27150002
*****    CONSTRUCT INSERT FOR FIRST LEVEL MESSAGE                 ****  27200002
*                                                                    *  27250002
**********************************************************************  27300002
INSERT   EQU   *                                                        27400002
         L     R15,OUTBUF          ADDR OF OUTPUT BUFFER                27800002
         USING INSERTS,R15         EXTABLISH ADDRESSABILITY TO INSERTS  27850002
*                                  DSECT                                27860002
         SPACE                                                          27900002
         TM    FLAGS,SVCFAIL       IS THIS AN SVC 97 OR 61 FAILURE      27950002
         BO    MOVSVC              YES - GET SVC INSERT FOR 1ST LEVEL   28000002
         SPACE                                                          28200002
         SPACE                                                          28700002
         TM    TSTFLGS1,ENDSW+RUNSW  TEST FOR 'END' COMMAND             28800002
         BM    MOVEND                YES...                             28900002
         SPACE                                                          29000002
         SR    R7,R7               CLEAR REG                            29100002
         IC    R7,TSTRTYCD         HIGH-ORDER BYTE IS THE               29200002
*                                  MODULE ID                            29300002
         LTR   R7,R7               IF ZERO, NO SUB-COMMAND IN CORE      29400002
         BZ    MOVETEST            ZERO...GO INSERT 'TEST'              29500002
*                                  INTO 1ST LEVEL MSG                   29600002
         SPACE                                                          29700002
         L     R6,SCDADDR          GET ADDR OF CSECT CONTAINING         29800002
*                                  LIST OF MODULE NAMES                 29900002
         BAL   R7,TSTID            SEARCH LIST                          30000002
         L     R6,SCDADDR2         GET ADDR OF CSECT CONTAINING         30100002
*                                  USERS LIST OF MODULE NAMES           30200002
         BAL   R7,TSTID            SEARCH LIST                          30300002
         B     NOFIND              NOT FOUND                            30400002
         SPACE                                                          30500002
TSTID    SR    R5,R5               CLEAR REG                            30600002
         SPACE 1                                                        30700002
TSTID1   IC    R5,ZERO(ZERO,R6)    GET LENGTH OF MODULE NAME IN         30800002
*                                  LIST                                 30900002
         CLI   ZERO(R6),HEXFF      END OF MODULE NAME LIST              31000002
         BCR   8,R7                YES...                               31100002
         SPACE                                                          31200002
         SR    R4,R4               CLEAR REG                            31300002
         IC    R4,ONE(R6,R5)       GET ABBREVIATION LENGTH              31400002
         LA    R4,TEN(R4,R5)       DISPLACEMENT OF ID                   31500002
         AR    R4,R6               ADDRESS OF ID                        31600002
         CLC   TSTRTYCD(ONE),ZERO(R4) COMPARE ID TO TSTRETRY ID         31700002
         SPACE                                                          31800002
         BE    FOUND               BRANCH TO ADD NAME TO MSG            31900002
         SPACE                                                          32000002
         LA    R6,ONE(R4)          BUMP TO NEXT MODULE NAME ENTRY       32100002
         B     TSTID               GO CHECK NEXT ID                     32200002
         SPACE                                                          32300002
NOFIND   TM    TSTFLGS1,TSTBUILD   TEST FOR 'DEFER' COMMAND             32400002
         BO    MOVDEFER            YES...                               32500002
         SPACE                                                          32600002
         LA    R6,ASSIGN           GET ADDR OF 'ASSIGNMENT'             32700002
         B     STA001              GO MOVE NAME                         32800002
         SPACE                                                          32900002
MOVEND   LA    R6,ENDNAME          PTR TO 'END'                         33000002
         B     STA001              GO MOVE NAME                         33100002
         SPACE                                                          33200002
MOVSVC   LA    R6,SVCMSG           PTR TO 'SVC INSERT'                  33250002
         B     STA001              GO MOVE INSERT TO BUFFER             33260002
         SPACE                                                          33270002
MOVDEFER LA    R6,DEFERNM          PTR TO 'DEFER'                       33300002
         B     STA001              GO MOVE NAME                         33400002
         SPACE                                                          33500002
MOVETEST LA    R6,TSTNAME          GET PTR TO 'TEST'                    33600002
STA001   DS    0H                                                       33700002
         SR    R5,R5               CLEAR REG                            33750002
         IC    R5,ZERO(ZERO,R6)    GET LENGTH                           33800002
         SPACE                                                          33900002
*********************************************************************** 33950002
* AT ENTRY TO THIS ROUTINE, REGISTER CONTENT IS ASSUMED TO BE AS      * 33960002
* FOLLOWS:                                                            * 33970002
* R5 = LENGTH OF NAME TO BE INSERTED                                  * 34000002
* R6 = @ CORRECT ENTRY IN MOD LIST                                    * 34100002
*********************************************************************** 34150002
FOUND    DS    0H                                                       34200002
         MVI   SUBCMDNM,BLANK     PUT A BLANK AT END OF NAME            34210002
         MVC   SUBCMDNM+ONE(TWELVE),SUBCMDNM PLACE BLANKS IN CMD NAME   34220002
         BCTR  R5,R0               DECR LENGTH BY ONE FOR MOVE          34250002
         EX    R5,MOVENAME         MOVE MODULE NAME INTO INSERT         34300002
         MVC   LEN1(FOUR),ZERO4    INITIALIZE CONTROL PORTION OF INSERT 34350002
*                                  LEVEL MSG                            34400002
         LA    R5,SIX(R5)          GET LENGTH OF INSERT                 34450002
         STC   R5,LEN1+ONE         STORE LENGTH OF COMPLETE INSERT      34460002
         SPACE 4                                                        34600002
**********************************************************************  35450002
* SET UP SECOND LEVEL MESSAGE INSERT FOR THE ENTRY POINT                35500002
**********************************************************************  35550002
         L     R5,PARMLST@         GET ADDRESS OF PARAM LIST            35600002
         USING LIST,R5             ESTABLISH R5 AS PARAM LIST BASE      35650002
         UNPK  ENTPOINT(NINE),ENTRYPT(FIVE) UNPACK ENTRY POINT          35700002
         TR    ENTPOINT(EIGHT),TAB-HEXF0   TRANSLATE ENTRY POINT        35750002
         MVC   LEN2(FOUR),ZERO4    INITIALIZE CONTROL PORTION OF INSERT 35800002
         MVI   LEN2+ONE,THIRTN     PLACE LENGTH OF COMPLETE INSERT      35850002
         MVI   ENTPOINT+EIGHT,BLANK  PUT A BLANK AT END OF NAME         35860002
         DROP  R5                  RELEASE PARAM LIST BASE              35900002
         SPACE                                                          36100002
**********************************************************************  36150002
* SET UP SECOND LEVEL MESSAGE INSERT FOR THE COMPLETION CODE            36160002
**********************************************************************  36170002
         SPACE                                                          36180002
         DROP  R2                  FREE R2 AS BASE                      36610002
         L     R2,TCBPTR           GET TCB ADDRESS                      36650002
         USING TCB,R2              REESTABLISH ADDRESSABILITY TO TCB    36660002
         SPACE                                                          36700002
         UNPK  COMPCODE(THREE),TCBCMPC(TWO)   UNPACK                    36800002
*                                  COMPLETION CODE                      36900002
         OI    COMPCODE+TWO,HEXF0   SET SIGN PORTION OF LAST BYTE       37000002
         TR    COMPCODE(THREE),TAB-HEXF0   TRANSLATE COMPLETION         37100002
*                                            CODE TO PRINTABLE HEX      37200002
         MVI   COMPCODE+THREE,BLANK PLACE A BLANK AFTER COMPLETION CODE 37210002
         MVC   LEN3(FOUR),ZERO4    INITIALIZE CONTROL PORTION OF INSERT 37250002
         MVI   LEN3+ONE,EIGHT      PLACE LENGTH OF COMPLETE INSERT      37260002
         SPACE                                                          37300002
**********************************************************************  37350002
* SET UP SECOND LEVEL MESSAGE INSERT FOR THE INSTRUCTION COUNTER        37360002
**********************************************************************  37370002
         UNPK  INSTCTR(NINE),ZERO(FIVE,R3)   UNPACK PSW IC              37400002
         MVI   INSTCTR+EIGHT,BLANK    CLEAR LAST BYTE                   37500002
         TR    INSTCTR(EIGHT),TAB-HEXF0   TRANSLATE PSW IC TO           37600002
         MVC   LEN4(FOUR),ZERO4    INITIALIZE CONTROL PORITON OF INSERT 37650002
         MVI   LEN4+ONE,THIRTN     PLACE LENGTH OF COMPLETE INSERT      37660002
         L     R7,ZERO(R3)         GET ACTUAL IC                        37700002
         LA    R7,0(R7)            CLEAR HIGH ORDER BYTE                37800002
         BCTR  R7,R0               ADDR OF LAST BYTE                    37900002
         BAL   R6,ADDRCHK          CHECK IT                             38000002
         L     R7,ADDRESS          GET ADDRESS                          38010002
         SPACE                                                          38050002
**********************************************************************  38060002
* SET UP SECOND LEVEL MESSAGE INSERT FOR THE INSTRUCTION IMAGE          38070002
*********************************************************************** 38080002
         LA    R6,TWELVE-ONE       BACK UP THE IC A                     38100002
         SR    R7,R6               TOTAL OF TWELVE BYTES                38200002
         BAL   R6,ADDRCHK          CHECK THIS ADDRESS                   38300002
         L     R7,ADDRESS          GET ADDRESS                          38310002
         LA    R6,INST25@          GET ADDRESS OF 5TH INSERT            38350002
         OI    FLAGS,INSERT25      INDICATE THAT THERE IS A 5TH INSERT  38400002
         UNPK  INSTIMGE(THIRTN),ZERO(SEVEN,R7)   UNPACK PORTION         38450002
*                                  OF INSTRUCTION IMAGE                 38500002
         TR    INSTIMGE(TWELVE),TAB-HEXF0   TRANSLATE                   38600002
         SPACE                                                          38700002
         UNPK  INSTIMGE+TWELVE(THIRTN),SIX(SEVEN,R7)   UNPACK REST OF   38800002
*                                  THE INSTRUCTION IMAGE                38900002
         MVI   INSTIMGE+TWENTY4,BLANK   CLEAR LAST BYTE                 39000002
         TR    INSTIMGE+TWELVE(TWELVE),TAB-HEXF0  TRANSLATE INSTR IMAGE 39100002
*                                  TO PRINTABLE HEX                     39200002
         MVC   LEN5(FOUR),ZERO4    INITIALIZE CONTROL PORTION OF INSERT 39260002
         MVI   LEN5+ONE,TWENTY9    ESTABLISH LEN OF COMPLETE INSERT     39270002
RET      BR    R14                 RETURN                               39300002
         SPACE 1                                                        39400002
ADDRCHK  ST    R7,ADDRESS          SAVE ADDRESS                         39550002
         LTR   R7,R7               IF NOT POSITIVE,                     39560002
         BNP   NOIMAGE             DON'T PRINT IMAGE.                   39600002
         L     R5,TCBPQE           ADDRESS DUMMY-PQE                    39700002
         USING PQESECT,R5                                               39800002
         L     R5,PQEFPQE          ADDRESS OF PQE FOR THIS REGION       39900002
         C     R7,PQEREGN          START OF REGION.                     40000002
         BL    NOIMAGE             DON'T PRINT IMAGE.                   40200002
         L     R7,PQEREGN          START OF REGION.                     40252002
         A     R7,PQESIZE          END OF REGION.                       40300002
         C     R7,ADDRESS          IF ADDRESS IS WITHIN REGION,         40400002
         BCR   TWO,R6              RETURN.                              40500002
*                                  ELSE, DON'T PRINT IMAGE.             40600002
         SPACE                                                          40700002
NOIMAGE  EQU   *                   DON'T PRINT INSTR IMAGE              40800002
         LA    R6,INST25@          GET ADDRESS OF 4TH INSERT            41160002
         OI    FLAGS,INSERT25      INDICATE THAT THERE IS A 5TH INSERT  41170002
         SR    R7,R7               CLEAR REG7                           41190002
         IC    R7,OUTRGN           GET TEXT LENGTH                      41194102
         LA    R7,FIVE(R7)         GET TOTAL LENGTH OF INSERT           41194402
         MVC   LEN5(FOUR),ZERO4    INITIALIZE CONTROL PORTION OF INSERT 41194802
         STC   R7,LEN5+ONE         STORE TOTAL LENGTH OF INSERT         41196002
         LA    R7,OUTRGN+ONE       GET ADDRESS OF INSERT TEXT           41196402
         MVC   INSTIMGE(TWENTY2),ZERO(R7) PLACE TEXT INTO INSERT        41198002
         B     RET                 RETURN                               41200002
         EJECT                                                          41574902
******************************************************************      41600002
*                                                                *      41700002
*        IC SEARCH ROUTINE -- THIS ROUTINE WILL COMPARE THE      *      41800002
*        ADDRESS PORTION OF THE ABENDING MODULE'S PSW TO THE     *      41900002
*        ADDRESSES CONTAINED IN THE IC TABLE. IF A MATCH IS      *      42000002
*        FOUND, THE APPROPRIATE MESSAGE WILL BE INSERTED INTO    *      42100002
*        THE STANDARD 2ND LEVEL MESSAGE, AND CONTROL GIVEN TO    *      42200002
*        THE I/O ROUTINE TO WRITE OUT THE MESSAGES. CONTROL IS   *      42300002
*        THEN GIVEN TO THE RETRY ROUTINE.                        *      42400002
*        IF NO MATCH IS FOUND, RETURN IS MADE TO THE CALLING     *      42500002
*        ROUTINE.                                                *      42600002
*                                                                *      42700002
*        AT ENTRY-- REG3 = PTR TO ABENDING RB'S OPSW+4           *      42800002
*                   REG5 = PTR TO MODULE'S IC TABLE              *      43000002
*                                                                *      43100002
*        AT EXIT -- REG3 = PTR TO ABENDING RB'S OPSW+4           *      43150002
*                   REG5 = PTR TO MODULE'S IC TABLE              *      43170002
*                   REG7 = INSERT # CORRESPONDING TO IC TABLE    *      43172002
*                          ENTRY                                 *      43180002
*                                                                *      43190002
******************************************************************      43200002
         SPACE 2                                                        43300002
SEARCH   EQU   *                                                        43400002
         TM    TSTFLGS1,TSTFIRST      IS THIS FLAG ON                   43410002
         BO    RETURN                 YES - DO NOT PUT OUT A MESSAGE    43420002
SEARCH2  EQU   *                                                        43450002
         SPACE                                                          43700002
         MVC   CODESAV(ONE),ZERO(R5)   GET CODE FROM ENTRY              43800002
         CLI   CODESAV,HEXFF       CHECK IF CODE = X'FF' (END OF        43900002
*                                  TABLE)                               44000002
         BE    SRCHOUT             YES...EXIT                           44100002
         SPACE                                                          44200002
         CLC   ONE(THREE,R5),ONE(R3)  COMPARE IC TABLE ENTRY TO         44300002
*                                     ABENDING RB'S OPSW+5              44400002
         BE    MATCH               BRANCH IF EQUAL                      44500002
         SPACE                                                          44600002
         LA    R5,FOUR(ZERO,R5)    BUMP TO NEXT IC TABLE ENTRY          44700002
         B     SEARCH2             COMPARE THIS NEXT ENTRY              44800002
         SPACE                                                          44900002
MOVEXCTL DS    0H                                                       45000002
         SR    R7,R7               CLEAR INSERT NUMBER REGISTER         45050002
         IC    R7,MSGXCTL          GET NUMBER OF XCTL MSG INSERT        45060002
         B     MOVEINIT            INDICATE THAT THERE IS A 6TH INSERT  45100002
         SPACE                                                          45200002
MATCH    CLI   CODESAV,HEX00       IS IC CODE = 0                       45300002
         BE    RETURN              YES...NO MESSAGES, GO TO RETRY       45400002
         SPACE                                                          45500002
         SR    R7,R7               CLEAR REG                            45600002
         IC    R7,CODESAV          GET CODE                             45700002
MOVEINIT DS    0H                                                       46500002
         OI    FLAGS,INSERT26      INDICATE 6TH INSERT EXISTS           46760002
         SR    R6,R6               CLEAR REG                            46800002
         SPACE                                                          47200002
MOVEMSG  DS    0H                                                       47300002
         SPACE                                                          47800002
         B     MSGIO               GO PRINT                             48400002
         SPACE                                                          48500002
         SPACE                                                          48800002
SRCHOUT  DS    0H                                                       48900002
         TM    TSTFLGS2,TSTXCTL    CHECK FOR 'XCTL' BIT ON              48902002
         BO    MOVEXCTL            YES...GO INSERT 'XCTL FAILED'        48912002
         SR    R7,R7               CLEAR REG 7                          48914002
         NI    FLAGS,NOINST26      INDICATE NO 6TH INSERT               48920002
         BR    R14                 RETURN TO CALLING ROUTINE            48950002
         EJECT                                                          49000002
*********************************************************************** 49010002
*                                                                       49020002
*  THESE FORMS OF THE IO MACRO ARE USED TO ISSUE THE FIRST AND SECOND   49030002
*  LEVEL MESSAGES.                                                      49040002
*                                                                       49042002
*********************************************************************** 49044002
MSGIO    DS    0H                  ISSUE MESSAGES                       49046002
         OI    TSTFLGS4,TSTESTAE   INDICATE I/O SERVICING ESTAE REQUEST 49046402
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR REMOTE PARM LIST     49048002
         LR    R4,R15              GET ADDRESS OF INSERTS               49048402
         DROP  R15                 DISCONTINUE R15 AS INSERTS BASE      49048802
         USING INSERTS,R4          ESTABLISH R4 AS INSERTS BASE         49049202
         L     R5,PARMLST@         GET POINTER TO PARAM LIST            49049302
         USING LIST,R5             ESTABLISH R4 AS INSERTS BASE         49049602
         TM    FLAGS,INSERT26      DOES 6TH INSERT EXIST                49049702
         BZ    IOMACRO2            NO - CHECK SECOND FORM OF MACRO      49049802
         TM    FLAGS,INSERT25      DOES 5TH INSERT EXIST                49049902
         BZ    IOMACRO3            NO - USE THIRD FORM OF MACRO         49050102
IOMACRO1 DS    0H                                                       49050202
         IKJEGSIO MSG,FIRST=M0058,INST11=(ADDR,INST11@),SECOND=M0259,  *49050302
               INST21=(ADDR,INST21@),INST22=(ADDR,INST22@),            *49050402
               INST23=(ADDR,INST23@),INST24=(ADDR,INST24@),            *49053702
               INST25=(ADDR,INST25@),INST26=(NUM,(R7)),                *49054902
               ID=STA29,MF=(E,TSTIOPRM)                                 49056103
         B     RETURN                   GO RETURN WITH APPROPRIATE RC   49057302
         SPACE 4                                                        49057702
IOMACRO2 DS    0H                                                       49058502
         TM    FLAGS,INSERT25      IS THERE A 5TH INSERT FOR 2ND LEVEL  49059702
         BZ    IOMACRO4            NO - USE FOURTH FORM OF MACRO        49060902
         IKJEGSIO MSG,FIRST=M0058,INST11=(ADDR,INST11@),SECOND=M0259,  *49062102
               INST21=(ADDR,INST21@),INST22=(ADDR,INST22@),            *49063302
               INST23=(ADDR,INST23@),INST24=(ADDR,INST24@),            *49063702
               INST25=(ADDR,INST25@),ID=STA29,MF=(E,TSTIOPRM)           49064503
         B     RETURN                   GO RETURN WITH APPROPRIATE RC   49065702
         SPACE 4                                                        49066902
IOMACRO3 DS    0H                                                       49067002
         IKJEGSIO MSG,FIRST=M0058,INST11=(ADDR,INST11@),SECOND=M0259,  *49067302
               INST21=(ADDR,INST21@),INST22=(ADDR,INST22@),            *49067702
               INST23=(ADDR,INST23@),INST24=(ADDR,INST24@),            *49072302
               INST26=(NUM,(R7)),ID=STA29,MF=(E,TSTIOPRM)               49073603
         B     RETURN                   GO RETURN WITH APPROPRIATE RC   49074902
         SPACE 4                                                        49076202
IOMACRO4 DS    0H                                                       49077502
         IKJEGSIO MSG,FIRST=M0058,INST11=(ADDR,INST11@),SECOND=M0259,  *49078802
               INST21=(ADDR,INST21@),INST22=(ADDR,INST22@),            *49080102
               INST23=(ADDR,INST23@),INST24=(ADDR,INST24@),            *49080502
               ID=STA29,MF=(E,TSTIOPRM)                                 49081403
         B     RETURN                   GO RETURN WITH APPROPRIATE RC   49082702
         EJECT                                                          49176702
*                                                                       49178702
         SPACE 8                                                        49186702
**** MOVE INSTRUCTIONS   ****                                           49200002
*                                                                       49300002
*MOVE1    MVC   EIGHT(ZERO,R1),ZERO(R7)  MOVE 1ST LEV MSG TO BUFFER     49400002
*                                      OUTPUT BUFFER                    49500002
MOVE2    MVC   ZERO(ZERO,R4),ZERO(R8)  MOVE 2ND LEVEL MESSAGE TO        49600002
*                                         OUTPUT BUFFER                 49700002
MOVE3    MVC   ZERO(ZERO,R4),ONE(R8)     MOVE INSERT TO 2ND LEVEL       49800002
*                                        MESSAGE                        49900002
MOVENAME MVC   FOUR(ZERO,R15),ONE(R6)    MOVE INSERT TO FIRST           50000002
*                                        LEVEL MESSAGE                  50100002
*                                                                       50200002
         SPACE                                                          50300002
*                                                                       50400002
*        CONSTANTS                                                      50500002
*                                                                       50600002
         DS    0F                                                       50700002
MASKUP   DC    X'FFFFFFFC'         MASK FOR ROUNDING UP                 50800002
ZERO4    DC    X'00000000'         CONSTANT USED TO INITIALIZE INSERT   50850002
SCDADDR  DC    V(IKJEGSCD)         @ MODULE LIST CSECT-IBM SUBCOMMANDS  51200002
SCDADDR2 DC    V(IKJEGSCU)         @ MODULE LIST CSECT-USER'S "         51300002
SVC61    DC    CL8'IGC0006A'       SVC 61 NAME                 ZXCZXCZX 51350002
SVC97    DC    CL8'IGC0009G'       SVC 97 NAME                 ZXCZXCZX 51400002
SAVELNGH DC    X'00000048'         LENGTH OF GET MAIN 20       @ZA00918 51402003
BLANK9   DC    CL9' '              USED TO INITIALIZE TO BLANKS         51410002
MSGXCTL  DC    X'85'               INSERT # OF XCTL MSG INSERT          51440002
         EJECT                                                          51450002
*********************************************************************** 51500002
*                                                                       51550002
* THIS IS A SEQUENCE OF COMMAND NAMES THAT ARE USED IN CONSTRUCTING     51600002
* THE FIRST LEVEL MESSAGE                                               51650002
*********************************************************************** 51700002
ENDNAME  DS    0H                                                       52292002
         DC    X'03'               LENGTH OF NAME                       52300002
         DC    C'END'              COMMAND NAME                         52400002
*************************PLEASE DO NOT DISTERB THIS INSERT************  52550002
         SPACE 4                                                        52560002
ASSIGN   DS    0H                                                       52560402
         DC    X'0A'               LENGTH OF NAME                       52560502
         DC    C'ASSIGNMENT'       MODULE NAME (WILL BE CHANGED         52561202
*                                  TO 'SET')                            52561302
*************************PLEASE DO NOT DISTERB THIS INSERT************  52561602
         SPACE 4                                                        52561702
DEFERNM  DS    0H                                                       52562002
         DC    X'05'               LENGTH OF NAME                       52570002
         DC    C'DEFER'            COMMAND NAME                         52590002
*************************PLEASE DO NOT DISTERB THIS INSERT************  52640002
         SPACE 4                                                        52690002
TSTNAME  DS    0H                                                       52740002
         DC    X'04'               LENGTH OF NAME                       52750002
         DC    C'TEST'             COMMAND NAME                         52840002
*************************PLEASE DO NOT DISTERB THIS INSERT************  52890002
         SPACE 4                                                        52940002
SVCMSG   DS    0H                                                       52990002
         DC    X'0C'               LENGTH OF INSERT TEXT                52992002
         DC    C'SVC(97 V 61)'     INSERT TEXT                          52994002
*************************PLEASE DO NOT DISTERB THIS INSERT************  52996002
         EJECT                                                          52998002
TAB      DC    C'0123456789ABCDEF' TRANSLATE TABLE FOR ABEND CODE       53000002
*                                                                       53100002
         SPACE 1                                                        53150002
OUTRGN   DS    0X                                                       53150402
         DC    AL1(OUTRGN2-OUTRGN)      TEXT LENGTH                     53150802
         DC    C'NOT WITHIN THIS REGION'  INSERT TEXT                   53151202
OUTRGN2  DS    0X                                                       53151602
*                                                                       53152002
         SPACE 1                                                        53154002
CONSTANT DC    60C'Z'              PATCH AREA                           53160002
         EJECT                                                          53200002
         SPACE                                                          54400002
*                                                                       61300002
*                                                                       61450002
STAWORK  DSECT                     STAE WORK AREA DSECT                 61600002
*                                                                       61700002
REGSAV   DS    2F                  SAVE AREA FOR REGS 13 AND 14         61800002
RTCA@    DS    F                   ADDR OF 512-BYTE WORKAREA SAVE       61900002
CODESAV  DS    X                   IC TABLE CODE SAVE                   62000002
FLAGS    DS    X                   FLAGS TO INDICATE RESOURCE STATUS    62148002
RTCA     EQU   B'10000000'         RTCA OBTAINED                        62148402
RTCAN    EQU   B'01111111'         RTCA COMPLEMENT                      62148802
INSERT25 EQU   B'01000000'         5TH INSERT TO ERROR MSG  EXISTS      62148902
NOINST25 EQU   B'10111111'         NO 5TH INSERT TO ERROR MSG           62149002
INSERT26 EQU   B'00100000'         6TH INSERT TO ERROR MSG  EXISTS      62149102
NOINST26 EQU   B'11011111'         NO 6TH INSERT TO ERROR MSG           62149502
SVCFAIL  EQU   B'00010000'         WE ARE PROCESSING AN SVC ABEND       62149902
FLAGS4   DS    X                   STORAGE SPACE FOR TSTFLGS4           62150102
         DS    X                   UNASSIGNED                           62150302
ADDRESS  DS    F                   AREA FOR ADDRESS BEING VALIDITY CKED 62151002
PARMLST@ DS    F                   ADDR OF PARAM LIST FROM ESTAE MACRO  62151202
TCBPTR   DS    F                   ADDR OF TCB                          62151402
SVRB@    DS    F                   ADDR OF SVRB FOR SVC'S 97 AND 61     62151502
*                                                                       62151602
         SPACE 6                                                        62151802
LIST     DSECT                     PARAM LIST                           62152002
RETRY@   DS    F                   RETRY ROUTINE ADDRESS                62152202
ABENTAB@ DS    F                   ABEND TABLE ADDRESS DSECT            62152402
ENTRYPT  DS    F                   ENTRY POINT OF ABENDING MODULE       62156102
MODNAME  DS    CL8                 MODULE NAME                          62158102
INST21@  DS    0H             ***  1ST INSERT FOR 2ND LEVEL MESSAGE     62162002
INSERTLN DS    H                   LENGTH OF COMPLETE TEXT NAME INSERT  62165402
         DS    H                                                        62172802
TEXTNM   DS    C                   ABENDING MODULE TEXT NAME            62176202
         EJECT                                                          62179602
*                                                                       62183002
**********************************************************************  62186402
* THIS DSECT MAPS THE INSERTS FOR THE FIRST AND SECOND LEVEL            62189802
* MESSAGES                                                              62193202
**********************************************************************  62196602
         SPACE                                                          62200002
INSERTS  DSECT                                                          62200602
INST11@  DS    0H                  ADDRESS OF INSERT TO 1ST LEVEL MSG   62205302
LEN1     DS    H                   LENGTH OF INST11 + 5                 62210002
         DS    H                   AREA USED BY IKJEGIO                 62220002
SUBCMDNM DS    CL13                SUBCOMMAND NAME                      62230002
*                                                                       62240002
INST22@  DS    0H                  ADDRESS OF 2ND INSERT TO 2ND LEVEL   62250002
LEN2     DS    H                   LENGTH OF INST22 + 4                 62254002
         DS    H                   AREA USED BY IKJEGIO                 62256002
ENTPOINT DS    CL9                 ENTRY POINT                          62258002
*                                                                       62258402
INST23@  DS    0H                  ADDRESS OF 3RD INSERT TO ERROR MSG   62258802
LEN3     DS    H                   LENGTH OF INST23 + 5                 62259202
         DS    H                   AREA USED BY IKJEGIO                 62259602
COMPCODE DS    CL4                 COMPLETION CODE                      62259702
*                                                                       62259802
INST24@  DS    0H                  ADDRESS OF 4TH INSERT TO 2ND LEVEL   62260002
LEN4     DS    H                   LENGTH OF INST24 + 5                 62262002
         DS    H                   AREA USED BY IKJEGIO                 62264002
INSTCTR  DS    CL9                 INSTRUCTION COUNTER                  62266002
*                                                                       62268002
INST25@  DS    0H                  ADDRESS OF 5TH INSERT TO 2ND LEVEL   62270002
LEN5     DS    H                   LENGTH OF INST25 + 5                 62320002
         DS    H                   AREA USED BY IKJEGIO                 62370002
INSTIMGE DS    CL25                INSTRUCTION IMAGE                    62380002
*                                                                       62382002
INST26@  DS    0H                  ADDRESS OF 6TH INSERT TO 2ND LEVEL   62390002
LEN6     DS    H                   LENGTH OF INST26 + 5                 62392002
         DS    H                   AREA USED BY IKJEGIO                 62394002
ABENDMSG DS    CL38                MESSAGE CORRESPONDING TO CODE IN     62396002
*                                  COMMAND IC TABLE                     62398002
         EJECT                                                          62400002
         TCOMTAB                   COMMUNICATION TABLE                  62500002
         EJECT                                                          62600002
         TSTCWORK                                                       62700002
         EJECT                                                          62800002
CVTDSECT DSECT                                                          62900002
         CVT                       CVT DSECT                            63000002
         EJECT                                                          63100002
         IHAPQE                    PQE DSECT                            63200002
         EJECT                                                          63250002
         IHACDE                    CDE DSECT                            63260002
         EJECT                                                          63300002
         IKJRB                     RB DSECT                             63400002
         EJECT                                                          63500002
         IKJTCB                    TCB DSECT                            63600002
         EJECT                                                          63650002
         IHASDWA                   RTCA DSECT                           63660002
         END                                                            63700002
./  ADD  SSI=80750554,NAME=IKJEGSYM
         COPY IKJEGSIO                                                  00008000
IKJEGSYM CSECT                                                          00016000
SYM      TITLE 'IKJEGSYM - TSO TEST ASSEMBLER SYMBOL PROCESSOR'         00024000
*C352800,A889000                                               @YA00074 00032000
*C258000                                                       @YM07131 00040000
*C180700              WRONG MSGID R3                           @ZA***** 00045000
*                     R14 IS ZERO FOR BR RETURN INST           @ZA09494 00047000
*C066500                                                       @ZA27196 00048003
*********************************************************************** 00050000
*                                                                     * 00060000
* STATUS --                                                           * 00070000
*    CHANGE LEVEL 00, VERSION NUMBER 01, OS/VS2                       * 00080000
*                                                                     * 00090000
* FUNCTION/OPERATION --                                               * 00100000
*    THE TEST SYMBOL PROCESSOR PROVIDES MAIN STORAGE ADDRESSES,       * 00110000
*    ASSEMBLER SYMBOL ATTRIBUTES AND CSECT NAMES FOR SYMBOLIC         * 00120000
*    DEBUGGING.                                                       * 00130000
*    BASICALLY MAIN STORAGE ADDRESSES ARE FOUND BY ADDING UP THE      * 00140000
*    MODULES LOADED MAIN STORAGE ADDRESS, CSECT DISPLACEMENT INTO     * 00150000
*    THE MODULE AND SYMBOL DISPLACEMENT INTO THE CSECT.               * 00160000
*    CSECT NAMES AND DISPLACEMENTS ARE FOUND IN THE CESD RECORDS      * 00170000
*    FOR THE MODULE.  IF IT IS A LOAD MODULE THEY RESIDE ON           * 00180000
*    SECONDARY STORAGE. IF IT IS A OBJECT MODULE LOADED VIA THE       * 00190000
*    OS LOADER THE CESD RECORDS ARE IN MAIN STORAGE.                  * 00200000
*    ASSEMBLER SYMBOL ATTRIBUTES AND DISPLACEMENTS ARE ONLY           * 00210000
*    AVAILIABLE FOR LOAD MODULES AND THE TEST PARM MUST BE PASSED     * 00220000
*    TO THE ASSEMBLER AND LINKAGE EDITOR TO OBTAIN THEM.              * 00230000
*    CESD AND SYMBOL INFORMATION CAN ONLY BE OBTAINED FROM LOAD       * 00240000
*    MODULES IF SVC 061 HAS PROCESSED DURING THEIR FETCH TIME.        * 00250000
*    CESD INFORMATION MAY BE OBTAINED FROM AN OBJECT MODULE WHEN      * 00260000
*    CHAINNED FROM THE P/P TCB AND THE CDE INDICATES LOADED BY        * 00270000
*    THE OS LOADER AND THAT CESD RECORDS ARE PRESENT.                 * 00280000
*                                                                     * 00290000
* ENTRY POINTS --                                                     * 00300000
*         IKJEGSYM     ONLY ENTRY POINT TO IKJEGSYM                   * 00310000
*                                                                     * 00320000
* INPUT --                                                            * 00330000
*    REGISTER 1 POINTS TO A PDE CONTAINING THE FOLLOWING ACCEPTED     * 00340000
*    ARGUMENTS                                                        * 00350000
*    LOADNAME ENTRYNAME                                               * 00360000
*    RETURN MAIN STORAGE ADDRESS IN USER FIELD OF PDE                 * 00370000
*    LOADNAME ENTRYNAME SYMBOL                                        * 00380000
*    RETURN SYMINFO BLOCK POINTED TO FROM USER FIELD                  * 00390000
*    IN PDE WITH THE HIGH ORDER BYTE EQUAL TO X'80'                   * 00400000
*    LOADNAME           OFFSET                                        * 00410000
*    RETURN CSECT NAME POINTED TO FROM PTR TO ENTRYNAME               * 00420000
*    FIELD IN PDE                                                     * 00430000
*    MISSING FIELDS ARE FILLED IN FROM THE CURRENTLY QUALIFIED        * 00440000
*    LOADNAME.ENTRYNAME OR IN THE CASE OF ENTRYNAME, DEFAULTED        * 00450000
*    TO THE FIRST CSECT OF THE MODULE                                 * 00460000
*                                                                     * 00470000
* OUTPUT --                                                           * 00480000
*    FILLED IN PDE, POSSIBLE SYMINFO BLOCK AND RETURN CODES           * 00490000
*                                                                     * 00500000
* EXTERNAL REFERENCES --                                              * 00510000
*         ESATE      - ESTABLISH ABEND RECOVERY EXIT RTN (IKJEGSTA)   * 00520000
*         IKJEGIO    - ERROR MESSAGES TO TERMINAL                     * 00530000
*         DAIR       - ALLOCATE SYS1.LINKLIB                          * 00540000
*         GETMAIN    - FOR WORK AREA, SYMINFO BLK, DAIR PARM LIST     * 00550000
*         FREEMAIN   - DAIR PARM LIST, STAE WORK AREA                 * 00560000
*         OPEN       - A BPAM DCB FOR READING SYMBOLS                 * 00570000
*         CLOSE      - THE DCB FOR READING SYMBOLS                    * 00580000
*         READ       - SYMBOLS FROM SECONDARY STORAGE                 * 00590000
*         CHECK      - VERIFY READ, WAIT FOR READ TO COMPLETE         * 00600000
*         NOTE       - TTR OF FIRST CESD RECORD IN LOADNAME MEMBER    * 00610000
*         FIND       - POINT TO SYMBOL RCDS IN LOADNAME MEMBER OF PDS * 00620000
*         SYNADAF    - FOR AN I/O ERROR, OBTAIN SYSTEM INFO MESG      * 00630000
*         SYNADRLS   - RELEASE SYNADAF WORK AREA                      * 00640000
*                                                                     * 00650000
* EXITS, NORMAL --                                                    * 00660000
*         RETURN TO CALLER WITH RETURN CODES                          * 00670000
*         0     SUCCESSFULLY COMPLETED                                * 00680000
*         4     PASSED SYMBOLIC NAME NOT FOUND, EITHER LOADNAME       * 00690000
*         ENTRYNAME OR SYMBOLNAME, OR NO CORE AVAILABLE               * 00700000
*         8     UNABLE TO RESOLVE SYMBOLICS AT THIS TIME,             * 00710000
*         CANNOT ISSUE STAE, OPEN DCB, OR ALLOCATE LINKLIB            * 00720000
*         12     AN I/O ERROR HAS OCCURRED WHILE READING SECONDARY    * 00730000
*         STORAGE                                                     * 00740000
*         16     AN ATTENTION OR LOGON/LOGOFF ECB HAS BEEN POSTED     * 00750000
*         20     AN ABEND HAS BEEN INTERCEPTED BY STAE                * 00760000
*         MESSAGES     - MESSAGES ARE SENT TO THE TERMINAL IF AN I/O  * 00770000
*         ERROR HAS OCURRED WHILE READING SECONDARY STORAGE           * 00780000
*         OR WHEN SYMMESG SWITCH, EQUATED TO B'00100000', IN          * 00790000
*         THE TSTFLGS3 FIELD OF TCOMTAB DSECT IS OFF                  * 00800000
*         NO MESSAGES ARE PRINTED WHEN THE REQUEST IS TO RESOLVE      * 00810000
*         A PASSED OFFSET                                             * 00820000
*                                                                     * 00830000
* EXITS, ERROR --                                                     * 00840000
*         N/A                                                         * 00850000
*                                                                     * 00860000
* TABLES/WORK AREAS --                                                * 00870000
*    TCOMTAB    - COMMUNICATIONS DSECT FOR ALL OF TEST                * 00880000
*    PDE        - CNTRL BLOCK CONTAINNING INPUTED ARGUMENTS           * 00890000
*    SYM RCDS   - ON SECONDARY STORAGE                                * 00900000
*    CESD RCDS  - ON SECONDARY OR IN MAIN STORAGE                     * 00910000
*    SYMTAB     - INCORE SYMBOL TABLE                                 * 00920000
*    SYMWORK    - INTERNAL WORK AREA                                  * 00930000
*    SVCINFO    - TABLE OF SAVED LOAD MODULE INFO BUILT BY            * 00940000
*    TESTRAN SVC 61 (IN DECIMAL)                                      * 00950000
*    SYMINFO    - ANSWER BLOCK RETURNED FOR A SYMBOL REQUEST          * 00960000
*                                                                     * 00970000
* ATTRIBUTES --                                                       * 00980000
*    REENTRANT AND REFRESHABLE                                        * 00990000
*                                                                     * 01000000
* CHARACTER CODE DEPENDENCY --                                        * 01010000
*    RE-ASSEMBLY IS REQUIRED FOR CHANGE OF CODE                       * 01020000
*                                                                     * 01030000
* NOTES --                                                            * 01040000
*    THE SYMBOL PROCESSOR IS SET UP FOR BEST RESPONSE TIME WHILE      * 01050000
*    RESOLVING SYMBOLS PLACED IN THE INCORE SYMBOL TABLE AND THEN     * 01060000
*    PREFIXED WITH THE CURRENTLY QUALIFIED LOADNAME ENTRYNAME.        * 01070000
*                                                                     * 01080000
*********************************************************************** 01090000
         EJECT                                                          01100000
         SPACE                                                          01110000
*        REGISTER EQUATES                                               01120000
*                                                                       01130000
PARMREG0 EQU   0                            REGISTER 0                  01140000
PARMREG1 EQU   1                            REGISTER 1                  01150000
PDEB     EQU   2                            CONTAIN ADDRESS PASSED PDE  01160000
WORK1    EQU   3                            REGISTER 3                  01170000
WORK2    EQU   4                            REGISTER 4                  01180000
WORK3    EQU   5                            REGISTER 5                  01190000
WORK4    EQU   6                            REGISTER 6                  01200000
WORK5    EQU   7                            REGISTER 7                  01210000
WORK6    EQU   8                            REGISTER 8                  01220000
TCOMTABB EQU   9                            BASE FOR TCOMTAB DSECT      01230000
INFOBLKB EQU   10                           BASE FOR INFO BLOCK         01240000
SYMB2    EQU   11                           BASE FOR IKJEGMYS CSECT     01250000
SYMB     EQU   12                           BASE FOR IKJEGSYM CSECT     01260000
SYMWKB   EQU   13                           BASE FOR SYM WORK AREA      01270000
RETURN   EQU   14                           REGISTER 14                 01280000
RETCODE  EQU   15                           REGISTER 15                 01290000
*                                                                       01300000
*        EQUATES FOR SI INSTRUCTION IMEDIATE OPERANDS                   01310000
*                                                                       01320000
V00      EQU   X'00'                        HEX 00                      01330000
V01      EQU   X'01'                        HEX 01                      01340000
V02      EQU   X'02'                        HEX 02                      01350000
V03      EQU   X'03'                        HEX 03                      01360000
V04      EQU   X'04'                        HEX 04                      01370000
V07      EQU   X'07'                        HEX 07                      01380000
V08      EQU   X'08'                        HEX 08                      01390000
V0F      EQU   X'0F'                        HEX 0F                      01400000
V10      EQU   X'10'                        HEX 10                      01410000
V20      EQU   X'20'                        HEX 20                      01420000
V40      EQU   X'40'                        HEX 40                      01430000
V60      EQU   X'60'                        HEX 60                      01440000
V80      EQU   X'80'                        HEX 80                      01450000
V0C      EQU   X'0C'                        HEX 0C                      01460000
V50      EQU   X'50'                        HEX 50                      01470000
V7F      EQU   X'7F'                        HEX 7F                      01480000
V90      EQU   X'90'                        HEX 90                      01490000
V91      EQU   X'91'                        HEX 91                      01500000
V9F      EQU   X'9F'                        HEX 9F                      01510000
VBF      EQU   X'BF'                        HEX BF                      01520000
VC0      EQU   X'C0'                        HEX C0                      01530000
VDF      EQU   X'DF'                        HEX DF                      01540000
VE0      EQU   X'E0'                        HEX E0                      01550000
VE2      EQU   X'E2'                        HEX E2                      01560000
VEF      EQU   X'EF'                        HEX EF                      01570000
VF0      EQU   X'F0'                        HEX F0                      01580000
VFF      EQU   X'FF'                        HEX FF                      01590000
LSYMRCD  EQU   C'S'                         IDENTIFY LOGICAL SYM RCD    01600000
*                                                                       01610000
*        NUMBER EQUATES                                                 01620000
*                                                                       01630000
N0       EQU   0                            DECIMAL 0                   01640000
N1       EQU   1                            DECIMAL 1                   01650000
N2       EQU   2                            DECIMAL 2                   01660000
N3       EQU   3                            DECIMAL 3                   01670000
N4       EQU   4                            DECIMAL 4                   01680000
N5       EQU   5                            DECIMAL 5                   01690000
N6       EQU   6                            DECIMAL 6                   01700000
N7       EQU   7                            DECIMAL 7                   01710000
N8       EQU   8                            DECIMAL 8                   01720000
N9       EQU   9                            DECIMAL 9                   01730000
N10      EQU   10                           DECIMAL 10                  01740000
N11      EQU   11                           DECIMAL 11                  01750000
N12      EQU   12                           DECIMAL 12                  01760000
N13      EQU   13                           DECIMAL 13                  01770000
N14      EQU   14                           DECIMAL 14                  01780000
N15      EQU   15                           DECIMAL 15                  01790000
N16      EQU   16                           DECIMAL 16                  01800000
N17      EQU   17                           DECIMAL 17                  01810000
N18      EQU   18                           DECIMAL 18                  01820000
N20      EQU   20                           DECIMAL 20                  01830000
N21      EQU   21                           DECIMAL 21                  01840000
N22      EQU   22                           DECIMAL 22                  01850000
N23      EQU   23                           DECIMAL 23                  01860000
N24      EQU   24                           DECIMAL 24                  01870000
N25      EQU   25                           DECIMAL 25                  01880000
N26      EQU   26                           DECIMAL 26                  01890000
N28      EQU   28                           DECIMAL 28                  01900000
N29      EQU   29                           DECIMAL 29                  01910000
N30      EQU   30                           DECIMAL 30                  01920000
N31      EQU   31                           DECIMAL 31                  01930000
N32      EQU   32                           DECIMAL 32                  01940000
N33      EQU   33                           DECIMAL 33                  01950000
N34      EQU   34                           DECIMAL 34                  01960000
N36      EQU   36                           DECIMAL 36                  01970000
N37      EQU   37                           DECIMAL 37                  01980000
N38      EQU   38                           DECIMAL 38                  01990000
N40      EQU   40                           DECIMAL 40                  02000000
N41      EQU   41                           DECIMAL 41                  02010000
N42      EQU   42                           DECIMAL 42                  02020000
N44      EQU   44                           DECIMAL 44                  02030000
N45      EQU   45                           DECIMAL 45                  02040000
N46      EQU   46                           DECIMAL 46                  02050000
N47      EQU   47                           DECIMAL 47                  02060000
N48      EQU   48                           DECIMAL 48                  02070000
N49      EQU   49                           DECIMAL 49                  02080000
N50      EQU   50                           DECIMAL 50                  02090000
N51      EQU   51                           DECIMAL 51                  02100000
N52      EQU   52                           DECIMAL 52                  02110000
N53      EQU   53                           DECIMAL 53                  02120000
N54      EQU   54                           DECIMAL 54                  02130000
N56      EQU   56                           DECIMAL 56                  02140000
N57      EQU   57                           DECIMAL 57                  02150000
N58      EQU   58                           DECIMAL 58                  02160000
N59      EQU   59                           DECIMAL 59                  02170000
N60      EQU   60                           DECIMAL 60                  02180000
N61      EQU   61                           DECIMAL 61                  02190000
N62      EQU   62                           DECIMAL 62                  02200000
N63      EQU   63                           DECIMAL 63                  02210000
N64      EQU   64                           DECIMAL 64                  02220000
N65      EQU   65                           DECIMAL 65                  02230000
N66      EQU   66                           DECIMAL 66                  02240000
N68      EQU   68                           DECIMAL 68                  02250000
N69      EQU   69                           DECIMAL 69                  02260000
N70      EQU   70                           DECIMAL 70                  02270000
N71      EQU   71                           DECIMAL 71                  02280000
N72      EQU   72                           DECIMAL 72                  02290000
N73      EQU   73                           DECIMAL 73                  02300000
N74      EQU   74                           DECIMAL 74                  02310000
N75      EQU   75                           DECIMAL 75                  02320000
N80      EQU   80                           DECIMAL 80                  02330000
N83      EQU   83                           DECIMAL 83                  02340000
N88      EQU   88                           DECIMAL 88                  02350000
N90      EQU   90                           DECIMAL 90                  02360000
N94      EQU   94                           DECIMAL 94                  02370000
N100     EQU   100                          DECIMAL 100                 02380000
N104     EQU   104                          DECIMAL 104                 02390000
N110     EQU   110                          DECIMAL 110                 02400000
N120     EQU   120                          DECIMAL 120                 02410000
N256     EQU   256                          DECIMAL 256                 02420000
N800     EQU   800                          DECIMAL 800                 02430000
*                                                                       02440000
*        CONDITION CODE EQUATES FOR BCR INSTRUCTIONS                    02450000
*                                                                       02460000
ZERO     EQU   8                            BRANCH IF ZERO              02470000
ONES     EQU   1                            BRANCH IF ONES              02480000
NOTZERO  EQU   7                            BRANCH IF NOT ZERO          02490000
LOW      EQU   4                            BRANCH IF LOW               02500000
         SPACE 3                                                        02510000
*********************************************************************** 02520000
*                                                                     * 02530000
*        THIS IS THE ENTRY INITILIZATION AND MAINLINE ROUTINE.        * 02540000
*        SUB-ROUTINES ARE USED TO ANALYZE REQUESTS, GATHER INFO       * 02550000
*        ABOUT THE REQUEST AND RESOLVE THE REQUEST.                   * 02560000
*                                                                     * 02570000
*********************************************************************** 02580000
         SPACE 2                                                        02590000
*                                                                       02600000
*        ENTRY  INITILIZATION                                           02610000
*                                                                       02620000
         STM   RETURN,SYMB,N12(SYMWKB)      SAVE CALLER'S REGISTERS     02630000
         LR    SYMB,RETCODE                 USE ENTRY PT FOR BASE       02640000
         USING IKJEGSYM,SYMB                ESTABLISH ADDRESSABILITY    02650000
         LR    PDEB,PARMREG1                ADDR OF PASSED PDE          02660000
         USING IKJPARMA,PDEB                BASE FOR PDE DSECT          02670000
         MVC   PDEUSER(N4),NO2NDMSG         NO 2ND LEV MSG TO CALLER    02680000
         USING TCOMTAB,TCOMTABB             BASE FOR TCOMTAB DSECT      02690000
         L     WORK1,TSTSYMWK               ADDR OF SYMWORK IN TCOMTAB  02700000
         LTR   WORK1,WORK1                  IS IT FIRST ENTRY           02710000
         BZ    FIRSTENT                     YES, GO GET CORE-INITILIZE  02720000
         ST    WORK1,N8(SYMWKB)             NO, DO LINKAGE CONVENTIONS  02730000
         ST    SYMWKB,N4(WORK1)                                         02740000
         LR    SYMWKB,WORK1                 ADDR OF SYMWORK, SAVE AREA  02750000
         USING SYMWORK,SYMWKB                                           02760000
         USING INFOBLK,INFOBLKB             BASE FOR INFO BLK DSECT     02770000
*                                                                       02780000
*        BEGIN PROCESSING  -  RESOLVE REQUEST INTO ACTION               02790000
*                                                                       02800000
IKJEGBEG EQU   *                                                        02810000
         ST    SYMB,BASEADDR                MY BASE ADDR IN WORK AREA   02820000
         L     WORK1,TSTSTAE                STAE EXIT ADDRESS           02830000
         LA    PARMREG1,STAELIST            ADDRESS OF ESTAE LIST       02840000
         XC    STAELIST(N16),STAELIST       CLEAR ESTAE LIST AREA       02850000
         ESTAE  (WORK1),CT,PARAM=LIST,XCTL=NO,RECORD=YES,MF=(E,(1))     02860000
         LTR   RETCODE,RETCODE              WAS STAE SUCCESSFUL         02870000
SMTSTAE  DS    0H                           SMT TESTCASE LABEL          02880000
*                                            INSUFFICIENT CORE TO ISSUE 02890000
*                                            STAE-RC FROM SYM IS 4      02900000
*                                            TESTCASE ID  TTSTC160      02910000
*                                            TESTCASE ID  TEQU4800      02920000
         BZ    STAEON                       ACS IS ESTABLISHED          02930000
         STC   RETCODE,TSTESTRC             PRESERVE RETURN CODE        02940000
         LA    RETCODE,N24                  SET RC TO 24                02950000
         B     TOCALL                       RETURN TO CALLER            02960000
         SPACE 1                                                        02970000
STAEON   DS    0H                                                       02980000
         XC    TSTWHR(N4),TSTWHR            LOADED ADDR FIELD TO 0      02990000
         TM    PDEFLG3,AFLG                 IS AN ADDR STRING PASSED    03000000
         BZ    ONWARD1                      NO, GO ON                   03010000
         TM    PDEFLG4,SYMADDR              IS A SYMBOL PASSED          03020000
         BZ    ONWARD1                      NO, GO ON                   03030000
         TM    PDEFLG2,CTNAMFLG             IS SYMBOL QUALIFIED         03040000
         BO    ONWARD1                      YES, SKIP INCORE SYM TAB    03050000
         BAL   RETURN,SINCORES              NO, GO SEARCH INCORE SYMTB  03060000
         LTR   RETCODE,RETCODE              WAS THE SYMBOL FOUND        03070000
         BZ    FOUNDSYM                     YES, GO BUILD ANSWER BLOCK  03080000
ONWARD1  BAL   RETURN,GETINFO               EVALUATE, GET INFO FOR REQ  03090000
         MVC   TSTWHR(N4),LOADNAMA          LOADED ADDR OF MOD          03100000
         TM    WHATPASS,V02                 WAS A SYMBOL PASSED         03110000
         BO    FINDSYM                      YES, GO FIND SYMBOL         03120000
         TM    WHATPASS,V01                 WAS AN OFFSET PASSED        03130000
         BZ    ENTRYPSD                     NO, GO SEARCH USE ENTRYNAME 03140000
         OI    SWSB,V40                     INDICATE SEARCH USE OFFSET  03150000
         BAL   RETURN,FINDCESD              GO RESOLVE CESD REQUEST     03160000
         B     FENTRY                       FOUND ENTRYNAME DISPLACMENT 03170000
*                                           USING ENTRYNAME AS SEARCH   03180000
ENTRYPSD OI    SWSB,V20                     SEARCH USING ENTRYNAME      03190000
         BAL   RETURN,FINDCESD              GO RESOLVE CESD REQUEST     03200000
         B     FOFFSET                      FOUND ENTRYNAME USING       03210000
*                                           OFFSET AS THE SEARCH        03220000
         SPACE 1                                                        03230000
SVCERR3  DS    0H                                                       03240000
         TM    TSTFLGS3,SYMMESG             SHOULD WE ISSUE MSG         03250000
         BCR   ONES,RETURN                  IF NO, RETURN               03260000
         TM    WHATPASS,V01                 WAS AN OFFSET PASSED        03270000
         BCR   ONES,RETURN                  IF NO, RETURN               03280000
         ST    RETURN,TERMIO14              SAVE RETURN ADDRESS         03290000
         LR    WORK3,RETCODE                PUT RETURN CODE IN WORK3    03300000
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO DYNAM AREA       03310000
         IKJEGSIO SVCERR,SVC=(WORK2),ID=SYM30,RC=(WORK3),              *03320000
               MF=(E,TSTIOPRM)                                          03330000
         L     RETURN,TERMIO14              RESTORE RETURN REGISTER     03340000
         BR    RETURN                       RETURN TO CALLER            03350000
         SPACE 3                                                        03360000
*********************************************************************** 03370000
*                                                                     * 03380000
*        THE FOLLOWING SUB ROUTINES ARE SERVICE ROUTINES FOR THE      * 03390000
*        MAIN PROCESSING ROUTINES                                     * 03400000
*                                                                     * 03410000
*********************************************************************** 03420000
         SPACE 2                                                        03430000
*                                                                       03440000
*        THIS  ROUTINE FILLS IN THE PDE AFTER A SUCCESSFUL SEARCH       03450000
*        FOR AN ENTRYNAME USING AN OFFSET AS THE SEARCH ARGUMENT        03460000
*                                                                       03470000
FENTRY   LA    WORK1,ENTRYNAM               ADDR OF FOUND ENTRYNAME     03480000
         ST    WORK1,PDECTNAM               RETURN IN THE PASSED PDE    03490000
         LA    WORK1,N8                     LENGTH OF PASSED ENTRYNAME  03500000
         STH   WORK1,PDELEN2                RETURN IN THE PASSED PDE    03510000
         OI    PDEFLG2,CTNAMFLG             INDICATE ENTRYNAME FOUND    03520000
         SR    RETCODE,RETCODE              SUCCESSFUL RET CODE=0       03530000
         B     TOCALLER                     GO RETURN TO CALLER         03540000
*                                                                       03550000
*        THIS  ROUTINE FILLS IN THE PDE AFTER A SUCCESSFUL SEARCH       03560000
*        FOR A LOADED ADDRESS USING AN ENTRYNAME AS THE SEARCH ARGUMENT 03570000
*                                                                       03580000
FOFFSET  L     WORK1,LOADNAMA               LOADED ADDR OF MODULE       03590000
         A     WORK1,ENTRNAMD               PLUS DISPL OF ENTRYNAME     03600000
         ST    WORK1,PDEUSER                RETURN IN PASSED PDE        03610000
         SR    RETCODE,RETCODE              SUCCESSFUL RET CODE=0       03620000
         B     TOCALLER                     GO RETURN TO CALLER         03630000
*                                                                       03640000
*        THIS ROUTINE CHECKS THE ATTENTION AND LOGON/LOGOFF ECBS.  IF   03650000
*        THEY HAVE BEEN POSTED, SYM RETURNS TO ITS CALLER WITH A        03660000
*        RETCODE OF 16.  IF NOT THIS ROUTINE RETURNS TO ITS CALLER      03670000
*                                                                       03680000
CHECKECB L     WORK1,ECBTMPA                ADDRESS OF ATTENTION ECB    03690000
         TM    N0(WORK1),V40                HAS ATTENTION ECB BEEN POST 03700000
SMTATTN  DS    0H                           SMT TESTCASE LABEL          03710000
*                                            ATTN DURING SYM PROCESSING 03720000
*                                            RC FROM SYM IS 16          03730000
*                                            TESTCASE ID  TTSTC040      03740000
         BO    CODE16                       YES, RET TO CALLER          03750000
         L     WORK1,ECBLOG                 ADDR OF LOGON/LOGOFF ECB    03760000
         TM    N0(WORK1),V40                HAS LOGON/LOGOFF BEEN POSTD 03770000
         BCR   ZERO,RETURN                  NO, GO BACK TO WHAT YOU     03780000
*                                            WERE DOING                 03790000
CODE16   LA    RETCODE,N16                  REQ TO END, RETCODE=16      03800000
         B     TOCALLER                     GO RETURN TO CALLER         03810000
*                                                                       03820000
*                                                                       03830000
*        THIS IS THE STAE RETRY ROUTINE.                                03840000
*                                                                       03850000
STAERTRY EQU   *                                                        03860000
         L     TCOMTABB,CVTPTR              ADDRESS OF CVT              03870000
         L     TCOMTABB,CVTTCBP-CVT(TCOMTABB)   NEW, CURRENT TCBS       03880000
         L     TCOMTABB,N4(TCOMTABB)        CURRENT TCB IS TEST TCB     03890000
         L     TCOMTABB,TCBTRN-TCB(TCOMTABB)    ADDRESS OF TCOMTAB      03900000
         L     SYMWKB,TSTSYMWK              ADDR OF MY WORK AREA-TCOMTB 03910000
         L     SYMB,BASEADDR                MY BASE REG FROM WORK ARA   03920000
DAIRCORE EQU   *                                                        03930000
         TM    SWSC,V40                     CORE FOR DAIR PARM LIST     03940000
         BZ    CODE20                       NO, GO GIVE RET CODE=20     03950000
         L     PARMREG1,ADAIRCOR            YES, GET ADDR OF GOTTEN COR 03960000
         FREEMAIN   RC,LV=N100,A=(PARMREG1),SP=N1   FREE DAIR PARM LIST 03970000
         LTR   RETCODE,RETCODE              WAS RETURN CODE NONZERO     03980000
         BZ    TURNOFF                      IF ZERO, TURNOFF CORE SW    03990000
         LA    WORK2,N120                   GET SVC NUMBER              04000000
         BAL   RETURN,SVCERR3               GO ISSUE ERROR MESSAGE      04010000
**  THERE IS NO REASON TO PUT OUT A MESSAGE HERE IF WE FAIL             04020000
** SINCE WE ARE ON OUR WAY OUT ANYHOW                                   04030000
** AND THERE HAS ALREADY BEEN ONE MESSAGE PUT OUT                       04040000
** NOTE: WE ARE PROCESSING AN ABEND.                                    04050000
         B     CODE20                     SET CODE TO 20 AND RETURN     04060000
TURNOFF  EQU   *                                                        04070000
         NI    SWSC,VBF                     TURN DAIR CORE SWITCH OFF   04080000
CODE20   EQU   *                                                        04090000
         NI    TSTFLGS4,VFF-TSTVALCK        TURN OFF INDICATOR          04100000
         NI    TSTFLGS4,VFF-TSTRERTN        TURN OFF INDICATOR          04110000
         LA    RETCODE,N20                  STAE ENTRY RET CODE         04120000
         B     TOCALLER                     GO RETURN                   04130000
         EJECT                                                          04140000
*                                                                       04150000
*        THIS ROUTINE ISSUES THE IKJEGSIO MACRO TO OUTPUT               04160000
*        ERROR MESSAGES TO THE TERMINAL                                 04170000
*                                                                       04180000
TERMIO   EQU   *                                                        04190000
         TM    TSTFLGS3,SYMMESG             SHOULD WE PRINT A MESSAGE   04200000
         BCR   ONES,RETURN                  NO, RETURN TO CALLER        04210000
         TM    WHATPASS,V01                 WAS AN OFFSET PASSED        04220000
         BCR   ONES,RETURN                  YES, RETURN, NO MESSAGE     04230000
         SPACE 1                                                        04240000
PRINT    DS    0H                                                       04250000
         ST    RETURN,TERMIO14              SAVE RETURN ADDRESS         04260000
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM  CLEAR IO DYNM AREA        04270000
         SLL   WORK5,N2                     MULTIPLY WORK5 BY 4         04280000
         B     PRINT2                       GO PRINT A MESSAGE          04290000
*                                                                       04300000
*        THIS ROUTINE RETURNS TO THE CALLER OF IKJEGSYM                 04310000
*                                                                       04320000
TOCALLER EQU   *                                                        04330000
*        MVC   TSTRETRY(N4),CALRETRY        RESTORE CALLERS STAE RETRY  04340000
*        MVC   ABENTAB1(N4),CABENDTB        RESTORE CALLERS ABEND TABLE 04350000
         L     SYMWKB,N4(SYMWKB)            ADDR OF CALLERS SAVE AREA   04360000
TOCALL   EQU   *                                                        04370000
         RETURN    (14,12),,RC=(15)                                     04380000
         SPACE 3                                                        04390000
*********************************************************************** 04400000
*                                                                     * 04410000
*        THIS SUB-ROUTINE ANALYZES THE REQUEST AND GATHERS ALL INFO   * 04420000
*        AVAILIABLE ABOUT THE MODULE INVOLVED.                        * 04430000
*                                                                     * 04440000
*********************************************************************** 04450000
         SPACE 2                                                        04460000
GETINFO  XC    WHATPASS(N3),WHATPASS        SET SWITCHES TO ZERO        04470000
         LA    INFOBLKB,TINFOBLK            ADDR OF TEMP INFO BLOCK     04480000
         MVI   LOADNAME,V40                 BLANK TO TEMP INFO BLOCK    04490000
         MVC   LOADNAME+N1(N23),LOADNAME    CHAR INFO TO BLANKS         04500000
         XC    LOADNAMA(N32),LOADNAMA       OTHER INFO TO ZEROES        04510000
*                                                                       04520000
*        ANALYZE THE PASSED INFORMATION AND REFLECT THE ARGUMENT FORM   04530000
*                                                                       04540000
         TM    PDEFLG3,AFLG                 IS AN ADDRESS STRING PASSED 04550000
         BZ    NOADDRST                     NO, GO CHECK FUTHER         04560000
         TM    PDEFLG4,SYMADDR              IS ADDR STRING A SYM REQ    04570000
         BZ    OFFSETRQ                     NO, GO CHECK FOR OFFSET     04580000
         OI    WHATPASS,VE2                 INDICATE SYMBOL PASSED AND  04590000
*                                            ARGUMENT FORM IS           04600000
*                                            LOADNAME.ENTRYNAME.SYMBOL  04610000
         MVC   PSYMBOL(N8),BLANKS           CLEAR PASSED SYMBOL FIELD   04620000
         LH    WORK1,PDELEN3                LENGTH OF SYMBOL            04630000
         BCTR  WORK1,N0                     LEN-1 FOR EXECUTE INSTR     04640000
         LA    WORK2,PSYMBOL                MOVE TO PASSED SYMBOL FIELD 04650000
         L     WORK3,PDEADRPT               MOVE FROM LOCATION          04660000
         EX    WORK1,MOVEINST               MOVE SYMBOL TO PSYMBOL      04670000
         B     MODINFO                      GO RESOLVE STATUS OF MODULE 04680000
OFFSETRQ EQU   *                                                        04690000
         OI    WHATPASS,V91                 INDICATE OFFSET PASSED AND  04700000
*                                            THE ARGUMENT FORM IS       04710000
*                                            LOADNAME    OFFSET         04720000
         XC    POFFSET(N4),POFFSET          OFFSET FIELD TO ZEROES      04730000
         LH    WORK1,PDELEN3                LENGTH OF OFFSET            04740000
         LA    WORK2,POFFSET                MOVE TO LOCATION            04750000
         LA    WORK4,N4                     NO. OF BYTES IN A WORD      04760000
         SR    WORK4,WORK1                  NO. OF INDEX BYTES-ALIGN    04770000
         AR    WORK2,WORK4                  OFFSET IN INFO BLOCK        04780000
         L     WORK3,PDEADRPT               MOVE FROM LOCATION          04790000
         BCTR  WORK1,N0                     LEN-1 FOR EXECUTE INSTR     04800000
         EX    WORK1,MOVEINST               MOVE OFFSET TO POFFSET      04810000
         B     MODINFO                      GO RESOLVE STATUS OF MODULE 04820000
NOADDRST OI    WHATPASS,VC0                 INDICATE ARGUMENT IS        04830000
*                                            LOADNAME.ENTRYNAM          04840000
*                                                                       04850000
*        BUILD AN INFO BLOCK REFLECTING THE MODULE PRESENTLY WORKING    04860000
*        WITH                                                           04870000
*                                                                       04880000
MODINFO  TM    WHATPASS,VC0                 IS ARGUMENT L.E OR JUST L   04890000
         BO    LE                           ARGUMENT IS L.E, GO RESOLVE 04900000
         TM    PDEFLG1,LDNAMFLG             ARGUMENT=L, IS IT PASSED    04910000
         BZ    USECURR                      NO, GO GET CURRENT LOADNAME 04920000
         OI    WHATPASS,V08                 INDICATE LOADNAME PASSED    04930000
         LH    WORK1,PDELEN1                LENGTH OF PASSED LOADNAME   04940000
         BCTR  WORK1,N0                     LEN-1 FOR EXECUTE INSTR     04950000
         LA    WORK2,TINFOBLK               MOVE TO TEMP INFO BLOCK     04960000
         L     WORK3,PDELDNAM               MOVE FROM LOCATION          04970000
         EX    WORK1,MOVEINST               MOVE ENTRYNAME TO INFO BLK  04980000
         CLC   TINFOBLK(N8),TSTCURLD        IS IT THE CURRENT LOADNAME  04990000
         BE    USECURR                      YES, GO USE CURRENT L       05000000
         B     FILLBLK                      GO FILL IN TEMP BLOCK       05010000
LE       TM    PDEFLG2,CTNAMFLG             IS ENTRYNAME PASSED         05020000
         BZ    USECURR                      NO, GO USE CURRENT L.E      05030000
         OI    WHATPASS,V04                 INDICATE ENTRYNAME PASSED   05040000
         LH    WORK1,PDELEN2                LENGTH OF PASSED ENTRYNAME  05050000
         BCTR  WORK1,N0                     LEN-1 FOR EXECUTE INSTR     05060000
         LA    WORK2,ENTRYNAM               MOVE TO LOCATION IN INFO BK 05070000
         L     WORK3,PDECTNAM               MOVE FROM LOCATION          05080000
         EX    WORK1,MOVEINST               MOVE ENTRYNAME TO TEMP INFO 05090000
         TM    PDEFLG1,LDNAMFLG             IS LOADNAME PASSED          05100000
         BO    ONWARD01                     YES, GO MOVE TO INFO BLK    05110000
         MVC   LOADNAME(N8),TSTCURLD        NO, USE CURRENTLY QUALIFIED 05120000
         B     ONWARD02                     GO ON                       05130000
ONWARD01 LH    WORK1,PDELEN1                LENGTH OF PASSED LOADNAME   05140000
         BCTR  WORK1,N0                     LEN-1 FOR EXECUTE INSTR     05150000
         L     WORK3,PDELDNAM               ADDR OF PASSED LOADNAME     05160000
         LA    WORK2,LOADNAME               MOVE TO LOCATION IN INFO BK 05170000
         EX    WORK1,MOVEINST               MOVE LOADNAME TO INFO BLOCK 05180000
         OI    WHATPASS,V08                 INDICATE LOADNAME PASSED    05190000
ONWARD02 CLC   TSTCURLD(N16),TINFOBLK       IS IT CURRENT L.E           05200000
         BE    USECURR                      YES, GO USE CURRENT L.E     05210000
         LA    INFOBLKB,TINFOBLK            USE TEMP BLK FOR BASE       05220000
         B     FILLBLK                      GO FILL IN TEMP BLOCK       05230000
USECURR  LA    INFOBLKB,CINFOBLK            USE CURRENT INFO BLOCK      05240000
         CLC   TSTCURLD(N16),CINFOBLK       IS CURR L.E KNOWN BY SYM    05250000
         BNE   GETCURR                      NO, GO CLEAR AND RE-BUILD   05260000
         CLC   TCBADDR(N4),PPTCB            CURRENT ON SAME TCB         05270000
         BNE   GETCURR                      NO, GO CLEAR AND RE-BUILD   05280000
         L     WORK1,TSTSYMBA               QUALIFIED SYMBOLIC BASE     05290000
         LTR   WORK1,WORK1                  QUALIFING TO A LOADNAME     05300000
         BCR   NOTZERO,RETURN               NO, CURR OK, RET TO CALLER  05310000
GETCURR  MVC   DDNAME(N8),BLANKS            CLEAR DDNAME FIELD          05320000
         MVC   CINFOBLK(N16),TSTCURLD       GET CURRENT L.E             05330000
         XC    LOADNAMA(N32),LOADNAMA       OTHER INFO TO ZEROES        05340000
*                                                                       05350000
*        SEARCH THE INFO BLOCKS CREATED BY THE TESTRAN SVC 61 (IN DEC)  05360000
*                                                                       05370000
FILLBLK  L     WORK1,TSTTRN                 ADDR OF FIRST SVC SAVE INFO 05380000
         LTR   WORK1,WORK1                  IS THEIR A TCB CNTRL BLK    05390000
*                                            FOR THE SVCINFO BLK CHAIN  05400000
         BZ    NOSVCINF                     NO SVCINFO, GO CHECK RB     05410000
         ST    RETURN,SVCBLK14              SAVE RET ADDR IN MAIN RT    05420000
         L     WORK2,PPTCB                  ADDR OF CURR QUALIFIED TCB  05430000
CURRTCB1 EQU   *                                                        05440000
         C     WORK2,N4(WORK1)              IS THIS TCB CNTRL BLK FOR   05450000
*                                            THE CURR QUALIFIED TCB     05460000
         BE    CURRTCB2                     YES, GO SET SEARCH SVC BLKS 05470000
         L     WORK1,N0(WORK1)              NEXT TCB CNTRL BLK ON CHAIN 05480000
         LTR   WORK1,WORK1                  IS THEIR ANYMORE            05490000
         BNZ   CURRTCB1                     YES, GO CHECK FOR CURR TCB  05500000
         B     VERFYTCB                     NO, GO SEARCH ALL VALID TCB 05510000
CURRTCB2 EQU   *                                                        05520000
         LR    WORK5,WORK1                  ADDR OF TCB CNTRL BLK FOR   05530000
*                                            CURRENT QUALIFIED TCB      05540000
         BAL   RETURN,VIEWSVC1              GO SEARCH SVCINFO BLK CHAIN 05550000
*                                                                       05560000
*        GET A TCB ADDRESS FROM THE TCB CNTRL BLK CHAIN FOR EACH        05570000
*        SVCINFO BLOCK CHAIN, VERIFY THE TCB STILL EXISTS AND SEARCH    05580000
*        THE SVCINFO BLOCKS USING LOADNAME AS THE SEARCH ARGUMENT       05590000
*                                                                       05600000
VERFYTCB EQU   *                                                        05610000
         L     WORK1,TSTTRN                 HEAD OF TCB CNTRL BLK CHAIN 05620000
VERFYBEG EQU   *                                                        05630000
         L     WORK2,TSTTCB                 ADDRESS OF TEST TCB         05640000
         LA    WORK3,N0(WORK2)              CLEAR HIGH ORDER BYTE, SAVE 05650000
VERFYDAU EQU   *                                                        05660000
         L     WORK4,TCBLTC-TCB(WORK2)      ADDRESS OF DAUGHTER         05670000
         LA    WORK4,N0(WORK4)              CLEAR HIGH ORDER BYTE       05680000
         LTR   WORK4,WORK4                  IS THEIR A DAUGHTER         05690000
         BNZ   CHKTCB                       YES, GO SEE IF ONE WE WANT  05700000
VERFYSIS EQU   *                                                        05710000
         L     WORK4,TCBNTC-TCB(WORK2)      ADDRESS OF SISTER           05720000
         LA    WORK4,N0(WORK4)              CLEAR HIGH ORDER BYTE       05730000
         LTR   WORK4,WORK4                  IS THEIR A SISTER           05740000
         BNZ   CHKTCB                       YES, GO SEE IF ONE WE WNAT  05750000
VERFYMOM EQU   *                                                        05760000
         L     WORK2,TCBOTC-TCB(WORK2)      ADDRESS OF MOTHER           05770000
         LA    WORK2,N0(WORK2)              CLEAR HIGH ORDER BYTE       05780000
         CR    WORK2,WORK3                  IS MOTHER THE TEST TCB      05790000
         BNE   VERFYSIS                     NO, GO CHECK FOR A SISTER   05800000
         B     VERFYEND                     YES, TCB FROM TCB CNTRL BLK 05810000
*                                            HAS BEEN DETACHED, GO GET  05820000
*                                            NEXT TCB CNTRL BLK         05830000
CHKTCB   EQU   *                                                        05840000
         C     WORK4,N4(WORK1)              IS THIS THE TCB WE WANT     05850000
         BE    TCBMATCH                     YES, GO SET UP TO SEARCH    05860000
*                                            SVC BLKS FOR THIS TCB      05870000
         LR    WORK2,WORK4                  FIND NEXT TCB UNDER TEST    05880000
         B     VERFYDAU                     LOOP UNTIL MATCH OR ALL TCB 05890000
*                                            UNDER TEST HAVE BEEN CHKED 05900000
TCBMATCH EQU   *                                                        05910000
         LR    WORK5,WORK1                  ADDR OF TCB CNTRL BLK       05920000
         BAL   RETURN,VIEWSVC1              GO SEARCH SVC BLK CHAIN     05930000
VERFYEND EQU   *                                                        05940000
         L     WORK1,N0(WORK1)              ADDR OF NEXT TCB CNTRL BLK  05950000
         LTR   WORK1,WORK1                  IS THEIR ANOTHER CHAIN      05960000
         BNZ   VERFYBEG                     YES, GO VERFIY ITS TCB      05970000
         L     RETURN,SVCBLK14              RESTORE RET ADDR IN MAIN RT 05980000
         B     NOSVCINF                     GO SEARCH RB CHAIN          05990000
VIEWSVC1 EQU   *                                                        06000000
         L     WORK5,N8(WORK5)              ADDR OF FIRST BLK ON CHAIN  06010000
         USING SVCINFO,WORK5                                            06020000
VIEWSVC2 EQU   *                                                        06030000
         CLC   LOADNAME(N8),LMODNAME        IS THIS THE SVC BLOCK       06040000
         BE    FOUND1                       YES, GO EXTRACT INFORMATION 06050000
         L     WORK5,NEXTBLK                NO, ADDR OF NEXT SVC BLOCK  06060000
         LTR   WORK5,WORK5                  IS THEIR ANOTHER SVC BLOCK  06070000
         BNZ   VIEWSVC2                     YES, GO SEE IF ITS THE ONE  06080000
         BR    RETURN                       NO, RETURN TO CALLER        06090000
FOUND1   EQU   *                                                        06100000
         L     RETURN,SVCBLK14              ADDR OF MAIN ROUTINE CALLER 06110000
         MVC   LOADNAMA(N4),LMLADDR         GET MAIN STORAGE ADDRESS    06120000
         MVC   ATTRIBUT(N4),LMATTRIB        GET MEMBER ATTRIBUTES       06130000
         MVC   TCBADDR(N4),LMTCB            GET LOADNAME'S TCB ADDRESS  06140000
         MVC   POINTER(N4),BEGTTR           GET TTR OF BEGIN OF MEMBER  06150000
         OI    MODSWS,V90                   INDICATE IT IS A LOAD MOD   06160000
*                                            AND THE TTSVC HAS OPERATED 06170000
         TM    LMFLAGS,V80                  DO WE HAVE A DDNAME FOR PDS 06180000
         BZ    SEELIB                       NO, GO SEE IF LIB=LINKLIB   06190000
         MVC   DDNAME(N8),LMDDNAME          GET DDNAME ALLOCATING PDS   06200000
         OI    MODSWS,V04                   YES, INDICATE DDNAME KNOWN  06210000
         BR    RETURN                       RETURN TO CALLER            06220000
SEELIB   EQU   *                                                        06230000
         TM    LMFLAGS,V40                  IS DATASET LINKLIB          06240000
         BCR   ONES,RETURN                  YES, CAN ALLOCATE, RETURN   06250000
         LA    RETCODE,N44                  NO, SECOND LEV MESG NUMBER  06260000
         B     NOFIND                       GO GIVE MESG, RETURN CODE   06270000
         DROP  WORK5                                                    06280000
*                                                                       06290000
*        SEARCH THE CDE CHAIN AND USE CDE AND EXTENT LIST INFO          06300000
*                                                                       06310000
NOSVCINF EQU   *                                                        06320000
         L     WORK3,PPRB                   ADDRESS OF CURRENT P/P RB   06330000
         L     WORK3,RBCDE-RBSECT(WORK3)    ADDRESS OF CDE              06340000
         USING CDENTRY,WORK3                ESTABLISH ADDRESS. TO CDE   06350000
         CLC   CDNAME(N8),LOADNAME          IS THIS THE PASSED LOADNAME 06360000
         BE    FOUND2                       YES, GO EXTRACT INFORMATION 06370000
CDECHAIN EQU   *                                                        06380000
         SR    WORK1,WORK1                  CLEAR REGISTER TO ZERO      06390000
         L     WORK3,TSTTCB                 ADDRESS OF TEST TCB         06400000
         L     WORK3,TCBJPQ-TCB(WORK3)      HEAD OF CDE CHAIN           06410000
         LA    WORK3,N0(WORK3)              CLEAR HIGH ORDER BYTE       06420000
CDE1     EQU   *                                                        06430000
         LTR   WORK3,WORK3                  END OF CDE CHAIN            06440000
         BNZ   CDE2                         NO, GO CONTINUE SEARCH      06450000
         LA    RETCODE,N4                   ERROR, LOADNAME NOT FOUND   06460000
         B     NOFIND                       GO SET UP ERROR MESSAGE     06470000
CDE2     EQU   *                                                        06480000
         CLC   CDNAME(N8),LOADNAME          IS CDE FOR PASSED LOADNAME  06490000
         BE    FOUND2                       YES, GO EXTRACT INFORMATION 06500000
         L     WORK3,CDCHAIN                ADDRESS OF NEXT CDE         06510000
         LA    WORK3,N0(WORK3)              CLEAR HIGH ORDER BYTE       06520000
         B     CDE1                         GO CHECK NEXT CDE           06530000
FOUND2   EQU   *                                                        06540000
         TM    CDATTR,CDMIN                 IS IT A MINOR CDE           06550000
         BZ    XL                           NO, GO GET XL ADDRESS       06560000
         L     WORK3,CDXLMJP                YES, ADDRESS OF MAJOR CDE   06570000
XL       EQU   *                                                        06580000
         L     WORK2,CDXLMJP                ADDRESS OF EXTENT LIST      06590000
         USING XTLST,WORK2                  ESTABLISH ADDRESS. XTLST    06600000
         L     WORK1,XTLNRFAC               NO. SCATTERED BLOCKS        06610000
         SLL   WORK1,N2                     TIMES NO. BYTES IN A WORD   06620000
         LA    WORK1,XTLMSBLA(WORK1)        ADDR OF FIRST LOADED BLOCK  06630000
         MVC   LOADNAMA+N1(N3),N1(WORK1)    MOVE IT TO INFO BLOCK       06640000
         TM    CDATTR2,CDSPZ                IS IT LOAD VIA OS  @ZA27196 06650003
         BO    OSLOADER                     YES, GO EXTRACT INFO        06660000
         OI    MODSWS,V80                   INDICATE IT IS A LOAD MOD   06670000
         BR    RETURN                       RETURN TO CALLER            06680000
OSLOADER CLI   N7(WORK2),V02                IS THEIR MORE EXTENT INFO   06690000
         BCR   LOW,RETURN                   NO, RETURN TO CALLER        06700000
         L     WORK5,N12(WORK2)             LENGTH OF SECOND EXTENT     06710000
         LA    WORK5,N0(WORK5)              CLEAR HIGH ORDER BYTE       06720000
         LTR   WORK5,WORK5                  IS LEN ZERO                 06730000
         BCR   ZERO,RETURN                  YES, RETURN TO CALLER       06740000
         ST    WORK5,CESDTTR                NO, LENGTH OF CESD INFO     06750000
         MVC   POINTER+N1(N3),N5(WORK1)     ADDR OF OS LOADER CESD INFO 06760000
*                                            INTO INFO BLOCK            06770000
         OI    MODSWS,V20                   INDICATE OS LOADER CESD AVA 06780000
         BR    RETURN                       RETURN TO CALLER            06790000
         SPACE 3                                                        06800000
*********************************************************************** 06810000
*                                                                     * 06820000
*        FOR A REQUEST FOR A SYMBOL, THIS ROUTINE SEARCHES SYM RCDS   * 06830000
*        IN THE LOADNAME MEMBER OF A PDS ON SECONDARY STORAGE.        * 06840000
*                                                                     * 06850000
*********************************************************************** 06860000
         SPACE 2                                                        06870000
FINDSYM  EQU   *                                                        06880000
         TM    MODSWS,V80                   IS IT A LOAD MODULE         06890000
         BO    LMOD                         YES, GO CHECK FOR SYM RCDS  06900000
         LA    RETCODE,N8                   NO, NO SYMS WITH OBJ        06910000
         B     NOFIND                       GO GIVE ERROR MESG          06920000
LMOD     EQU   *                                                        06930000
         TM    ATTRIBUT,V10                 WAS MOD LINKEDIT WITH TEST  06940000
         BO    ONWARDA                      YES, GO ON                  06950000
         LA    RETCODE,N20                  LOADNAME LKED, NO TEST PARM 06960000
         B     NOFIND                       NO, SYM CANNOT BE FOUND     06970000
ONWARDA  TM    ATTRIBUT+N1,V04              ARE SYMBOL RCDS PRESENT     06980000
         BO    ONWARDB                      YES, GO ON                  06990000
         LA    RETCODE,N36                  ENTRYNAME NOT ASM WITH TEST 07000000
         B     NOFIND                       NO, SYM CANNOT BE FOUND     07010000
ONWARDB  CLC   TSTCURLD(N16),LOADNAME       IS IT CURR LOADNAME-ENTRYNA 07020000
         BNE   MBASE                        NO, GO CREATE BASE FOR SYMS 07030000
         CLI   ENTRYNAM,V00                 IS CURR E DEFAULTED TO 1ST  07040000
         BNE   CURROK                       NO, GO USE TCOMTAB SYM BASE 07050000
         OI    SWSB,V10                     SEARCH FOR FIRST CSECT      07060000
         BAL   RETURN,FINDCESD              GO GET FIRST CSECT + DISPL  07070000
         MVI   SWSB,V00                     TURN OFF CESD SWITCHES      07080000
         MVC   TSTCURCT(N8),ENTRYNAM        MAKE FIRST CSECT CURRENT    07090000
         L     WORK1,LOADNAMA               GET LOADED ADDRESS          07100000
         A     WORK1,ENTRNAMD               ADD FIRST CSECT'S DISPL     07110000
         ST    WORK1,TSTSYMBA               CURR SYM BASE TO TCOMTAB    07120000
         ST    WORK1,BASEFSYM               ALSO IN CURRENT INFO BLOCK  07130000
         B     SYMBACK1                     GO ON                       07140000
CURROK   MVC   BASEFSYM(N4),TSTSYMBA        YES, SYM BASE FROM TCOMTAB  07150000
         B     SYMBACK1                     GO ON                       07160000
MBASE    CLI   ENTRYNAM,V00                 IS ENTRY DEFAULTED-1ST CSEC 07170000
         BNE   ENTRYPRS                     NO, ENTRYNAME IS PRESENT    07180000
         OI    SWSB,V10                     SEARCH FOR FIRST CSECT      07190000
         BAL   RETURN,FINDCESD              GO GET FIRST CSECT + DISPL  07200000
         MVI   SWSB,V00                     TURN OFF CESD SWITCHES      07210000
ENTRYPRS TM    MODSWS,V40                   IS ENTRYNAME DISPL PRESENT  07220000
         BO    ADDTOLA                      YES, GO CREATE SYM BASE     07230000
         OI    SWSB,V20                     SEARCH USING ENTRYNAME      07240000
         BAL   RETURN,FINDCESD              GO GET DISPL FOR ENTRYNAME  07250000
         MVI   SWSB,V00                     TURN OFF CESD SWITCHES      07260000
ADDTOLA  L     WORK1,LOADNAMA               LOADED ADDR OF MODULE       07270000
         A     WORK1,ENTRNAMD               ADD DISP OF ENTRYNAME       07280000
         ST    WORK1,BASEFSYM               BASE FOR SYMBOL DISPLACMENT 07290000
SYMBACK1 DS    0H                                                       07300000
         BAL   RETURN,OPENDCB               GO SET UP DCB FOR READ      07310000
         LA    PARMREG1,PDSDCB              ADDR OF DCB FOR POINT       07320000
SMTSYND1 DS    0H                           SMT TESTCASE LABEL          07330000
*                                            ENTER SYNAD ON SYMBOL READ 07340000
*                                            RC FROM SYM IS 12          07350000
*                                            TESTCASE ID  TTSTC150      07360000
         LA    PARMREG0,POINTER             ADDR OF TTR FOR POINT       07370000
         BAL   RETURN,DOPOINT               GO DO POINT                 07380000
READSYM  BAL   RETURN,DOREAD                GO READ SECONDARY STORAGE   07390000
         CLI   BUFFER,V40                   WAS A SYM/ESD RCD READ      07400000
         BE    SYMRCD1                      YES, GO CHECK FOR GOOD SYM  07410000
         TM    SWSA,V80                     WAS A PART ENTRY SAVED      07420000
         BZ    NOSYM1                       NO, GO GIVE UNRESOLVED CODE 07430000
         BAL   RETURN,INPARTAL              YES, GO CHECK PART ENTRY    07440000
NOSYM1   EQU   *                                                        07450000
         TM    SWSA,V10                     DID WE FIND ENTRYNAME       07460000
         BZ    NOTASM1                      NO, GO GIVE NOT ASEM CODE   07470000
         LA    RETCODE,N24                  YES, SYM NOT FOUND          07480000
         B     NOFIND                       GO GIVE RET CODE, MESG      07490000
NOTASM1  LA    RETCODE,N36                  ENTRYNAME NOT ASM WITH TEST 07500000
         B     NOFIND                       GO GIVE RET CODE, MESG      07510000
SYMRCD1  EQU   *                                                        07520000
         CLI   BUFFER+N1,V00                IS IT A GOOD SYM/ESD RECORD 07530000
         BE    SETUPSYM                     YES, GO SET UP TO ANALYZE   07540000
         TM    SWSA,V80                     NO, WAS A PART ENTRY SAVED  07550000
         BZ    READSYM                      NO, GO READ ANOTHER RECORD  07560000
         BAL   RETURN,INPARTAL              YES, GO CHECK PART ENTRY    07570000
         B     READSYM                      GO READ ANOTHER RECORD      07580000
*                                                                       07590000
*        THIS  ROUTINE ANALYZES A SYMBOL RECORD READ FROM SECONDARY     07600000
*        STORAGE. WORK1 POINTS TO THE BEGINNING OF THE LOGICAL RECORD,  07610000
*        WORK2 POINTS TO THE END OF THE PHYSICAL RECORD, WORK3 POINTS   07620000
*        TO THE CURRENT POSITION IN THE PHYSICAL RECORD, WORK4 WILL     07630000
*        CONTAIN THE NUMBER OF REMAINING DATA BYTES IN THE PRESENT      07640000
*        LOGICAL RECORD AND WORK5 WILL CONTAIN THE NUMBER OF BYTES IN   07650000
*        THE CURRENT ENTRY.                                             07660000
*                                                                       07670000
SETUPSYM EQU   *                                                        07680000
         LA    WORK1,BUFFER                 ADDR BEG OF PHSYICAL RCD    07690000
         LH    WORK2,N2(WORK1)              LENGTH OF PHSYICAL RECORD   07700000
         LA    WORK2,N4(WORK1,WORK2)        ADDR OF END OF PHSYICAL RCD 07710000
         LA    WORK3,N4(WORK1)              ADDR OF FIRST LOGICAL RCD   07720000
         LR    WORK1,WORK3                  ADDR OF FIRST LOGICAL RCD   07730000
ISITASYM CLI   N1(WORK3),LSYMRCD            IS THIS A LOGICAL SYM RCD   07740000
         BE    ONWARDS1                     YES, GO ON                  07750000
         TM    SWSA,V80                     WAS A PART ENTRY SAVED      07760000
         BZ    NOPART                       NO, GO ON                   07770000
         BAL   RETURN,INPARTAL              YES, GO CHECK PART ENTRY    07780000
NOPART   EQU   *                                                        07790000
         LA    WORK3,N80(WORK1)             ADDR OF NEXT LOGICAL RCD    07800000
         LR    WORK1,WORK3                  ADDR OF CURRENT LOGICAL RCD 07810000
         CR    WORK3,WORK2                  IS IT END OF PHSYICAL RCD   07820000
         BNL   READSYM                      YES, GO READ ANOTHER        07830000
         B     ISITASYM                     NO, GO CHECK NEXT LOGICAL   07840000
ONWARDS1 LH    WORK4,N10(WORK3)             LEN DATA IN LOGICAL RCD     07850000
         LA    WORK3,N16(WORK3)             ADDR OF FIRST ENTRY IN RCD  07860000
         TM    SWSA,V80                     WAS LAST ENTRY CONTINUED    07870000
         BO    ALIGNSYM                     YES, GO ALIGN ENTRY         07880000
BACKSYM1 LA    PARMREG1,N20                 MAXIUM ENTRY LENGTH         07890000
         CR    WORK4,PARMREG1               COULD NEXT ENTRY OVERFLOW   07900000
         BL    SAVEPART                     YES, SAVE POSSIBLE PART ENT 07910000
         BAL   RETURN,ENTRYLEN              GO CALCULATE SYM ENTRY LEN  07920000
         TM    N0(WORK3),V80                IS IT A DATA TYPE ENTRY     07930000
         BO    DATATYPE                     YES, GO CHECK               07940000
         BAL   RETURN,NOTDATA               NO, GO ANALYZE NON-DATA     07950000
         B     ENDENTRY                     GO END THIS ENTRY           07960000
DATATYPE TM    SWSA,V40                     SHOULD WE ANALZE ENTRY      07970000
         BZ    ENDENTRY                     NO, GO BYPASS THIS ONE      07980000
         TM    N0(WORK3),V08                IS A NAME PRESENT           07990000
         BO    ENDENTRY                     NO, DO NOT ANALYZE          08000000
         STM   WORK1,WORK3,WORKSAV2         SAVE POINTERS               08010000
         MVC   WAREA3(N8),BLANKS            CLEAR WORK AREA             08020000
         IC    WORK1,N0(WORK3)              GET ORGANIZATION BYTE       08030000
         LA    WORK2,N15                    CREATE 'AND' BYE - 0F       08040000
         NR    WORK1,WORK2                  LEN OF SYMBOL-1             08050000
         LA    WORK2,WAREA3                 MOVE TO LOCATION IN SYMWORK 08060000
         LA    WORK3,N4(WORK3)              ADDRESS OF SYMBOL TO MOVE   08070000
         EX    WORK1,MOVEINST               MOVE SYM TO WORK AREA       08080000
         LM    WORK1,WORK3,WORKSAV2         RESTORE POINTERS            08090000
         CLC   WAREA3(N8),PSYMBOL           IS THIS THE SYMBOL          08100000
         BE    FOUNDSYM                     YES, GO CREATE SYMINFO BLK  08110000
ENDENTRY AR    WORK3,WORK5                  ADDR OF NEXT ENTRY          08120000
         SR    WORK4,WORK5                  LEN OF DATA REMAIN IN RCD   08130000
         LTR   WORK4,WORK4                  IS IT END OF A LOGICAL RCD  08140000
         BP    BACKSYM1                     NO, GO LOOK AT NEXT ENTRY   08150000
         LA    WORK3,N80(WORK1)             YES, ADDR OF NEXT LOGICAL   08160000
         LR    WORK1,WORK3                  ADDR OF CURRENT LOGICAL RCD 08170000
         CR    WORK3,WORK2                  IS IT END OF PHSYICAL RCD   08180000
         BNL   READSYM                      YES, GO READ NEXT PHSYICAL  08190000
         B     ISITASYM                     NO, GO LOOK AT NEXT LOGICAL 08200000
*                                                                       08210000
*        THIS ROUTINE WILL ALIGN A LOGICAL SYM RCD.  PARTIAL SYM INFO   08220000
*        FROM THE PREVIOUS LOGICAL RCD WILL BE PLACED IN FRONT OF THIS  08230000
*        PRESENT SYM RECORD.                                            08240000
*                                                                       08250000
ALIGNSYM STM   WORK1,WORK3,WORKSAVE         SAVE POINTERS               08260000
         L     WORK1,PENTRYLN               LEN OF PART TO ALIGIN       08270000
         AR    WORK4,WORK1                  NEW LEN OF DATA IN LOGICAL  08280000
         LR    WORK2,WORK3                  PRESENT ENTRY ADDRESS       08290000
         SR    WORK2,WORK1                  NEW PRESENT ENTRY ADDRESS   08300000
         LA    WORK3,PARTENTY               MOVE FROM LOCATION          08310000
         BCTR  WORK1,N0                     LEN-1 FOR EXECUTE INSTR     08320000
         EX    WORK1,MOVEINST               PREFIX LOG RCD WITH PARTENT 08330000
         LR    WORK3,WORK2                  NEXT ENTRY ADDRESS          08340000
         LM    WORK1,WORK2,WORKSAVE         RESTORE BEGIN-END POINTERS  08350000
         NI    SWSA,V7F                     TURN PARTIAL LAST ENTRY OFF 08360000
         B     BACKSYM1                     GO ANALYZE SYMBOL           08370000
*                                                                       08380000
*        THIS ROUTINE WILL CALCULATE THE LENGTH OF A SYM ENTRY          08390000
*                                                                       08400000
ENTRYLEN STM   WORK1,WORK3,WORKSAV2         SAVE POINTERS               08410000
         LA    WORK5,N4                     BASIC SYM LENGTH-ORGANIZATN 08420000
*                                             PLUS DISP FROM CSECT      08430000
         SR    WORK1,WORK1                  INITIAL LEN OF NAME         08440000
         TM    N0(WORK3),V08                IS NAME PRESENT             08450000
         BO    NONAME                       NO, GO ON                   08460000
         IC    WORK1,N0(WORK3)              GET ORGANIZATION BYTE       08470000
         LA    WORK2,N15                    CREATE 'AND' FIELD - 0F     08480000
         NR    WORK1,WORK2                  LEN OF NAME-1               08490000
         LA    WORK1,N1(WORK1)              LENGTH OF NAME              08500000
         AR    WORK5,WORK1                  ENTRY LEN  PLUS NAME LENGTH 08510000
NONAME   TM    N0(WORK3),V80                IS IT A DATA TYPE           08520000
         BO    DATAENTY                     YES, GO CALCULATE LEN       08530000
         TM    N0(WORK3),VF0                IS NON-DATA TYPE A SPACE    08540000
         BM    GOTLEN                       NO, HAVE LEN, GO RETURN     08550000
         LA    WORK5,N1(WORK5)              YES, ADD ALIGN BYTE FIELD   08560000
         B     GOTLEN                       HAVE LENGTH, GO RETURN      08570000
DATAENTY EQU   *                                                        08580000
         LA    WORK5,N1(WORK5)              YES, ADD LEN OF DATA FIELD  08590000
         TM    N0(WORK3),V40                IS THEIR ANY MULTIPLICITY   08600000
         BZ    NOMULTIP                     NO, GO ON                   08610000
         LA    WORK5,N3(WORK5)              ENTRY LEN PLUS LEN M FIELD  08620000
NOMULTIP TM    N0(WORK3),V10                IS A SCALE FIELD PRESENT    08630000
         BZ    NOSCALE                      NO, GO ON                   08640000
         LA    WORK5,N2(WORK5)              ENTRY LEN PLUS LEN S FIELD  08650000
NOSCALE  LA    WORK2,N4(WORK3,WORK1)        ADDR OF DATA FIELD          08660000
         CLI   N0(WORK2),V08                IS LENGTH FIELD 1 OR 2 BYTE 08670000
         BH    ONEBYTE                      LEN FIELD IS ONE BYTE       08680000
         LA    WORK5,N1(WORK5)              ENTRY LEN +2 BYTE LEN FIELD 08690000
ONEBYTE  LA    WORK5,N1(WORK5)              ENTRY LEN +1 BYTE LEN FIELD 08700000
GOTLEN   LM    WORK1,WORK3,WORKSAV2         RESTORE POINTERS            08710000
         BR    RETURN                       GO CHECK NEXT ENTRY         08720000
*                                                                       08730000
*        THIS ROUTINE WILL SAVE A POSSIBLE PARTIAL ENTRY FOR PREFIXING  08740000
*        TO THE NEXT LOGICAL SYM RCD                                    08750000
*                                                                       08760000
SAVEPART STM   WORK1,WORK3,WORKSAVE         SAVE POINTERS               08770000
         ST    WORK4,PENTRYLN               LENGTH OF PART TO SAVE      08780000
         LR    WORK1,WORK4                  LEN OF PART TO SAVE         08790000
         BCTR  WORK1,N0                     LEN-1 FOR EXECUTE INSTR     08800000
         LA    WORK2,PARTENTY               MOVE TO LOCATION            08810000
         EX    WORK1,MOVEINST               SAVE PART ENTRY IN SYMWORK  08820000
         OI    SWSA,V80                     SET LAST ENTRY CONTINUED SW 08830000
         LR    WORK5,WORK4                  SET LEN TO REMAIN DATA BYTS 08840000
         LM    WORK1,WORK3,WORKSAVE         RESTORE POINTERS            08850000
         B     ENDENTRY                     GO END LOGICAL RECORD       08860000
*                                                                       08870000
*        THIS ROUTINE WILL HANDLE NON-DATA TYPES AND DECIDE WHEN TO     08880000
*        ANALYZE SYM ENTRIES.                                           08890000
*                                                                       08900000
NOTDATA  STM   WORK1,WORK3,WORKSAV2         SAVE POINTERS               08910000
         MVC   WAREA2(N8),BLANKS            BLANK OUT WORK AREA         08920000
         SR    WORK1,WORK1                  CLEAR REG FOR IC INSTRUCTON 08930000
         IC    WORK1,N0(WORK3)              GET ORGANIZATION BYTE       08940000
         STC   WORK1,WAREA3                 SAVE ORGANIZATION BYTE      08950000
         TM    N0(WORK3),V08                IS THEIR A NAME             08960000
         BO    SEETYPE                      NO, GO CHECK NON-DATA TYPE  08970000
         LA    WORK2,N15                    CREATE 'AND' FIELD - 0F     08980000
         NR    WORK1,WORK2                  LEN OF NAME-1               08990000
         LA    WORK2,WAREA2                 MOVE TO LOC IN SYMWORK      09000000
         LA    WORK3,N4(WORK3)              ADDRESS OF SYMBOL TO MOVE   09010000
         EX    WORK1,MOVEINST               MOVE NAME TO A WORK AREA    09020000
         L     WORK3,WKSAVE3A               RESTORE ADDRESS OF  YA00074 09030000
*                                           ENTRY                       09040000
SEETYPE  NI    WAREA3,VF0                   NON-DATA TYPE INFO          09050000
         CLI   WAREA3,V10                   IS IT A CSECT               09060000
         BNE   ISITDSEC                     NO, GO CHECK FOR A DSECT    09070000
         CLC   WAREA2(N8),ENTRYNAM          IS IT THE ENTRYNAME CSECT   09080000
         BNE   NOCHECK                      NO, GO TURN SWS OFF         09090000
         OI    SWSA,V50                     YES, TURN ANALYZE SWITCH ON 09100000
*                                            AND INDICATE SYMS ARE      09110000
*                                            AVAILABLE FOR THIS         09120000
*                                            ENTRYNAME                  09130000
         NI    SWSA,VDF                     TURN DSECT SW OFF           09140000
RNDATA1  LM    WORK1,WORK3,WORKSAV2         RESTORE POINTERS            09150000
         BR    RETURN                       GO RETURN TO CALLER         09160000
NOCHECK  NI    SWSA,V9F                     TURN OFF ANALYZE,DSECT SWS  09170000
         B     RNDATA1                      GO BACK                     09180000
ISITDSEC CLI   WAREA3,V20                   IS IT A DSECT               09190000
         BNE   ISASWON                      NO, GO CHECK ANALYZE SWITCH 09200000
         OI    SWSA,V60                     YES, TURN ON ANALYZE,DSECT  09210000
         MVC   WAREA1(N8),WAREA2            SAVE DSECT NAME NOW SEARCH- 09220000
*                                            ING THROUGH                09230000
         B     RNDATA1                      GO RETURN                   09240000
ISASWON  TM    SWSA,V40                     ARE WE ANALYZING            09250000
         BZ    RNDATA1                      NO, RETURN                  09260000
         CLC   WAREA2(N8),PSYMBOL           YES, IS THIS THE SYMBOL     09270000
         BNE   RNDATA1                      NO, RETURN                  09280000
*                                                                       09290000
*        SYMBOL FOUND, BUT NOT DATA TYPE, WORK3 POINTS TO ENTRY,        09300000
*        WORK1 IS LENGTH OF SYMBOL MINUS ONE                            09310000
*                                                                       09320000
         LA    WORK2,N5(WORK3,WORK1)        WORK2 POINT TO DATA FIELD   09330000
         CLI   WAREA3,V40                   IS IT AN INSTRUCTION        09340000
         BNE   CHECKCCW                     NO, GO CHECK FOR A CCW      09350000
         MVI   N0(WORK2),V0C                YES- TYPE IS 0C             09360000
         NI    N0(WORK3),V0F                TURN OFF ANY ERRENOUS BITS  09370000
         MVI   N1(WORK2),V00                CREATE 1 BYTE LEN FIELD=0   09380000
         B     FOUNDSYM                     GO CREATE ANSWER BLOCK      09390000
CHECKCCW CLI   WAREA3,V50                   IS IT A CCW                 09400000
         BNE   DEFAULT                      NO, GO DEFAULT IT           09410000
         MVI   N0(WORK2),V04                YES, - MAKE IT HEX          09420000
         NI    N0(WORK3),V0F                TURN OFF ANY ERRENOUS BITS  09430000
         MVC   N1(N2,WORK2),CCWLENFD        LENGTH FIELD FOR A CCW      09440000
         B     FOUNDSYM                     GO CREATE ANSWER BLOCK      09450000
DEFAULT  NI    N0(WORK3),V0F                TURN OFF ANY ERRENOUS BITS  09460000
         MVI   N0(WORK2),V04                MAKE IT HEX                 09470000
         MVC   N1(N2,WORK2),DEFLENFD        LEN FIELD FOR DEFAULT       09480000
         B     FOUNDSYM                     GO BUILD ANSWER BLOCK       09490000
*                                                                       09500000
*        THIS ROUTINE WILL SEARCH A PARTIAL SAVED ENTRY FROM A          09510000
*        LOGICAL SYM RECORD FROM SECONDARY STORAGE                      09520000
*                                                                       09530000
INPARTAL EQU   *                                                        09540000
         STM   WORK1,WORK3,WORKSAVE         SAVE POINTERS               09550000
         ST    RETURN,PART14                SAVE RETURN ADDRESS         09560000
         NI    SWSA,V7F                     TURN PARTIAL ENTRY SW OFF   09570000
         LA    WORK3,PARTENTY               ADDRESS OF SAVED PART ENTRY 09580000
         L     WORK4,PENTRYLN               LEN OF SAVED PARTIAL ENTRY  09590000
         LA    WORK2,N0(WORK3,WORK4)        END OF SAVED PART ENTRY     09600000
LENCHECK BAL   RETURN,ENTRYLEN              GO CALCUATE LEN NEXT ENTRY  09610000
         CR    WORK4,WORK5                  IS THEIR A COMPLETE ENTRY   09620000
         BNL   LOOKAT                       YES, GO ON                  09630000
         LM    WORK1,WORK3,WORKSAVE         RESTORE POINTERS            09640000
         L     RETURN,PART14                NO, GET RETURN ADDRESS      09650000
         BR    RETURN                       RETURN TO CALLER            09660000
LOOKAT   TM    N0(WORK3),V80                IS IT A DATA TYPE           09670000
         BO    TYPEDATA                     YES, GO CHECK FUTHER        09680000
         BAL   RETURN,NOTDATA               NO, GO CHECK NON-DATA TYPE  09690000
         B     ENTRYEND                     GO END THIS ENTRY           09700000
TYPEDATA TM    SWSA,V40                     SHOULD WE ANALYZE ENTRY     09710000
         BZ    ENTRYEND                     NO, GO END ENTRY            09720000
         TM    N0(WORK3),V08                IS A NAME PRESENT           09730000
         BO    ENTRYEND                     NO, GO, WE NEED A NAME      09740000
         STM   WORK1,WORK3,WORKSAV2         SAVE POINTERS               09750000
         MVC   WAREA3(N8),BLANKS            CLEAR WORK AREA             09760000
         SR    WORK1,WORK1                  CLEAR REG FOR IC INSTR      09770000
         IC    WORK1,N0(WORK3)              GET ORGANIZATION BYTE       09780000
         LA    WORK2,N15                    CREATE 'AND' BYTE - 0F      09790000
         NR    WORK1,WORK2                  LEN OF SYMBOL-1             09800000
         LA    WORK2,WAREA3                 MOVE TO LOCATION            09810000
         LA    WORK3,N4(WORK3)              ADDRESS OF SYMBOL TO MOVE   09820000
         EX    WORK1,MOVEINST               MOVE SYM TO WORK AREA       09830000
         LM    WORK1,WORK3,WORKSAV2         RESTORE POINTERS            09840000
         CLC   WAREA3(N8),PSYMBOL           IS THIS THE SYMBOL REQUESTD 09850000
         BE    FOUNDSYM                     YES, GO CREATE ANSWER BLOCK 09860000
ENTRYEND AR    WORK3,WORK5                  ADDR OF NEXT ENTRY          09870000
         SR    WORK4,WORK5                  LEN OF DATA REMAIN IN RCD   09880000
         CR    WORK3,WORK2                  ANY MORE ENTRIES IN PARTIAL 09890000
         BL    LENCHECK                     YES, GO CHECK FOR NEXT ONE  09900000
         L     RETURN,PART14                NO, SYMBOL NOT FOUND        09910000
         LM    WORK1,WORK3,WORKSAVE         RESTORE POINTERS            09920000
         BR    RETURN                       RETURN TO CALLER            09930000
         SPACE 3                                                        09940000
*********************************************************************** 09950000
*                                                                     * 09960000
*        FOR A REQUEST FOR A SYMBOL, THIS ROUTINE SEARCHS THE INCORE  * 09970000
*        SYMBOL TABLE                                                 * 09980000
*        IF THE SEARCH IS FOR A DSECT, THE DSECT NAME WILL BE         * 09990000
*        IN WAREA1                                                    * 10000000
*                                                                     * 10010000
*********************************************************************** 10020000
         SPACE 2                                                        10030000
SINCORES MVC   WAREA1(N8),BLANKS            CLEAR SYMBOL WORK AREA      10040000
         LH    WORK1,PDELEN3                LENGTH OF PASSED SYMBOL     10050000
         BCTR  WORK1,N0                     LEN-1 FOR EXECUTE INSTR     10060000
         L     WORK3,PDEADRPT               ADDR OF PASSED SYMBOL       10070000
         LA    WORK2,WAREA1                 MOVE TO LOCATION            10080000
         EX    WORK1,MOVEINST               MOVE SYMBOL TO WORK AREA    10090000
DSECTIN  L     WORK4,SYMTABLE               ADDR OF INCORE SYM TABLE    10100000
         USING INCORE,WORK4                 BASE FOR DESCRIPTIVE DSECT  10110000
SEARCH3  LTR   WORK4,WORK4                  IS IT LAST INCORE SYM TABLE 10120000
         BC    N7,CSEARCH3                  NO, GO CONTINUE SEARCH      10130000
         LA    RETCODE,N4                   YES, SYMBOL NOT FOUND       10140000
         BR    RETURN                       RETURN TO CALLER            10150000
CSEARCH3 MVC   WAREA2(N8),BLANKS            CLEAR SYMBOL WORK AREA      10160000
         LH    WORK1,LENSYM                 LENGTH OF SYMBOL NAME       10170000
         BCTR  WORK1,N0                     LEN-1 FOR EXECUTE INSTR     10180000
         LA    WORK3,INSYM                  ADDRESS OF SYMBOL           10190000
         LA    WORK2,WAREA2                 MOVE TO LOCATION IN SYMWORK 10200000
         EX    WORK1,MOVEINST               MOVE SYMBOL TO WORK AREA    10210000
         CLC   WAREA1(N8),WAREA2            IS THIS THE SYMBOL          10220000
         BE    FOUND3                       YES, GO EXTRACT INFO        10230000
         L     WORK4,NXINCORE               NO, POINT TO NEXT INCORE    10240000
         B     SEARCH3                      GO LOOK AT NEXT SYM INCORE  10250000
FOUND3   LNR   WORK3,WORK4                  SYM FOUND IN INCORE TABLE   10260000
         DROP  WORK4                                                    10270000
         SR    RETCODE,RETCODE              RETCODE IS ZERO             10280000
         BR    RETURN                       RETURN TO CALLER            10290000
         SPACE 3                                                        10300000
*********************************************************************** 10310000
*                                                                     * 10320000
*        THIS  SUB-ROUTINE OBTAINS CESD INFORMATION EITHER FROM CESD  * 10330000
*        RCDS ON SECONDARY STORAGE OR FROM INCORE CESD INFO SAVED BY  * 10340000
*        THE OS LOADER.  HOW TO SEARCH IS INDICATED BY SWITCHES, SWSB * 10350000
*        AND THEIR ARE THREE POSSIBLTIES- SEARCH USING OFFSET, SEARCH * 10360000
*        USING ENTRYNAME OR SEARCH FOR THE FIRST CSECT.               * 10370000
*********************************************************************** 10380000
         SPACE 2                                                        10390000
*                                                                       10400000
*        FOR   LOAD MODULES THIS ROUTINE READS SECONDARY STORAGES       10410000
*        AND RETURNS THE DESIRED INFORMATION                            10420000
*                                                                       10430000
FINDCESD ST    RETURN,CESD14                SAVE RETURN ADDRESS         10440000
         TM    MODSWS,V80                   IS IT A LOAD OR OBJ MODULE  10450000
         BZ    OBJMOD                       OBJ MOD, GO ANALYZE         10460000
         TM    MODSWS,V10                   HAS THE TTSVC OPERATED      10470000
         BO    SVCDID                       YES, GO ON                  10480000
         LA    RETCODE,N12                  NOT LOADED BY TEST          10490000
         B     NOFIND                       NO, ERROR, NO CESD INFO     10500000
SVCDID   DS    0H                                                       10510000
         BAL   RETURN,OPENDCB               GO OPEN DCB                 10520000
         TM    MODSWS,V08                   IS A CESD RCD TTR AVAILABLE 10530000
         BZ    USESYMS                      NO, GO USE SYMS TTR         10540000
SMTSYND2 DS    0H                           SMT TESTCASE LABEL          10550000
*                                            ENTER SYNAD ON CESD READ   10560000
*                                            RC FROM SYM IS 12          10570000
*                                            TESTCASE ID  TTSTC150      10580000
         LA    PARMREG0,CESDTTR             YES, USE CESD TTR           10590000
         B     ONWARD99                     GO ON                       10600000
SMTSYND3 DS    0H                           SMT TESTCASE LABEL          10610000
*                                            ENTER SYNAD ON CESD READ   10620000
*                                            RC FROM SYM IS 12          10630000
*                                            TESTCASE ID  TTSTC150      10640000
USESYMS  LA    PARMREG0,POINTER             USE SYM TTR FOR POINT       10650000
ONWARD99 LA    PARMREG1,PDSDCB              ADDR OF DCB FOR POINT       10660000
         BAL   RETURN,DOPOINT               GO ISSUE POINT              10670000
READCESD BAL   RETURN,DOREAD                GO READ FROM SECONDARY STOR 10680000
         CLI   BUFFER,V20                   IS IT A CESD RECORD         10690000
         BE    PROCESS1                     YES, GO PROCESS             10700000
         TM    SWSB,V80                     NO, HAS A CESD RCD BEEN RED 10710000
         BZ    READCESD                     NO, GO READ AGAIN           10720000
         TM    SWSB,V10                     IS SEARCH FOR FIRST CSECT   10730000
         BZ    GIVEERR                      NO, GO SET ERROR CODE       10740000
         MVC   ENTRYNAM(N8),BLANKS          FIRST CSECT NAME IS BLANK   10750000
         MVC   ENTRNAMD(N4),POFFSET         DISPLACEMENT IS OFFSET      10760000
         OI    MODSWS,V40                   INDICATE DISPL PRESENT      10770000
         L     RETURN,CESD14                GET RETURN ADDRESS          10780000
         BR    RETURN                       RETURN TO CALLER            10790000
GIVEERR  EQU   *                                                        10800000
         LA    RETCODE,N32                  ENTRYNAME NOT IN CESD RCDS  10810000
         B     NOFIND                       ERROR, NO MORE CESD RCDS    10820000
PROCESS1 OI    SWSB,V80                     INDICATE CESD RCD READ      10830000
         TM    MODSWS,V08                   IS A CESD TTR AVAILABLE     10840000
         BO    ONWARD98                     YES, GO ON                  10850000
         LA    PARMREG1,PDSDCB              NO, OBTAIN ONE              10860000
         BAL   RETURN,DONOTE                GO NOTE FIRST CESD RECORD   10870000
         ST    PARMREG1,CESDTTR             SAVE TTR                    10880000
         MVC   CESDTTR+N3(N1),POINTER+N3    CONCATENATION NO. TO TTR    10890000
         OI    MODSWS,V08                   INDICATE CESD TTR AVALIABLE 10900000
ONWARD98 LA    WORK2,BUFFER                 ADDR OF PHYSICAL RCD        10910000
         LH    WORK3,N6(WORK2)              LENGTH OF DATA PORTION      10920000
         LA    WORK2,N8(WORK2)              ADDR OF FIRST ENTRY         10930000
         LA    WORK3,N0(WORK3,WORK2)        ADDR OF END OF PHYSICAL RCD 10940000
         TM    SWSB,V20                     IS SEARCH USING ENTRYNAME   10950000
         BO    FINDNAME                     YES, SEARCH USING ENTRYNAME 10960000
         TM    SWSB,V10                     IS SEARCH FOR FIRST CSECT   10970000
         BZ    SEARCH4                      NO, SEARCH USING OFFSET     10980000
         SR    WORK1,WORK1                  YES, CREATE A ZERO OFFSET   10990000
         ST    WORK1,POFFSET                 AND USE OFFSET SEARCH RT   11000000
         TM    ATTRIBUT,V20                 IS LMOD LINK EDITED IN OVLY 11010000
         BZ    SEARCH4                      NO, OFFSET OK, GO SEARCH    11020000
         STM   WORK1,WORK3,WORKSAV2         SAVE POINTERS               11030000
         LA    WORK1,N4                     SET INDEX, 4 REGIONS MAX    11040000
         L     WORK3,LOADNAMA               ADDRESS OF SEGTAB CSECT     11050000
         SR    WORK4,WORK4                  CLEAR REGISTER TO ZERO      11060000
CKREGION EQU   *                                                        11070000
         IC    WORK4,N8(WORK3)              GET LAST SEG. NO. IN REGION 11080000
         TM    N10(WORK3),VFF               ARE THEIR ANY MORE REGIONS  11090000
         BZ    LASTREGN                     NO, GO FIGURE LEN OF SEGTAB 11100000
         BCT   WORK1,SETNEXT1               YES, GO SET TO CHECK NEXT   11110000
         B     LASTREGN                     NO, HAVE 4 REGNS, GO        11120000
SETNEXT1 EQU   *                                                        11130000
         LA    WORK3,N2(WORK3)              SEGTAB PTR TO NEXT REGION   11140000
         B     CKREGION                     GO CHECK NEXT REGION        11150000
LASTREGN EQU   *                                                        11160000
         SLL   WORK4,N2                     MULTIPLY LAST SEG NO. BY 4  11170000
         LA    WORK2,N24(WORK4)             LENGTH OF SEGTAB CSECT      11180000
         ST    WORK2,POFFSET                SAVE                        11190000
         TM    POFFSET+N3,V04               TEST FOR ALIGNMENT          11200000
         BZ    SETSEACH                     ON DOUBLE WORD, GO SEARCH   11210000
         LA    WORK2,N4(WORK2)              ALIGNED ON NEXT DOUBLE WORD 11220000
         ST    WORK2,POFFSET                OFFSET FOR 1ST CSECT SEARCH 11230000
SETSEACH EQU   *                                                        11240000
         LM    WORK1,WORK3,WORKSAV2         RESTORE POINTERS            11250000
*                                                                       11260000
*        SEARCH CESD RCD USING PASSED OFFSET, RETURN ENTRYNAME CONTAIN- 11270000
*        THAT  OFFSET                                                   11280000
*                                                                       11290000
SEARCH4  NI    N8(WORK2),V0F                TURN OFF L.E. SUBCLASS      11300000
         CLI   N8(WORK2),V00                IS IT A SECTION DEFINITION  11310000
         BE    SD                           YES, CHECK FOR RIGHT ONE    11320000
BACK99   LA    WORK2,N16(WORK2)             POINT TO NEXT ENTRY         11330000
         CR    WORK2,WORK3                  IS IT END OF RCD            11340000
         BL    SEARCH4                      NO, CONTINUE SEARCH         11350000
         B     READCESD                     YES, GO READ ANOTHER RCD    11360000
SD       L     WORK4,N8(WORK2)              DISP OF SD ENTRY            11370000
         C     WORK4,POFFSET                IS SD ORGIN PAST OFFSET     11380000
         BH    BACK99                       YES, GO CHECK NEXT CESD     11390000
         L     WORK5,N12(WORK2)             SEGMENT NO. AND LENGTH      11400000
         LA    WORK5,N0(WORK5)              LENGTH OF CSECT             11410000
         ST    WORK5,WAREA1                 LENGTH TO WORK AREA         11420000
         TM    WAREA1+N3,V07                IS LEN DOUBLE WORD MULTIPLE 11430000
         BZ    ONDWORD                      YES, GO CONTINUE            11440000
         SRL   WORK5,N3                     DISCARD 3 LOW ORDER BITS    11450000
         SLL   WORK5,N3                     3 LOW ORDER BITS ARE ZERO   11460000
         LA    WORK5,N8(WORK5)              LEN IS MULTIPLE OF DOUBLE   11470000
ONDWORD  EQU   *                                                        11480000
         AR    WORK4,WORK5                  LEN OF MEMBER, SO FAR       11490000
         L     WORK1,POFFSET                OFFSET PASSED IN PDE        11500000
         CR    WORK1,WORK4                  IS OFFSET IN THIS CSECT     11510000
         BL    FOUND4                       YES, GO FILL IN INFOBLK     11520000
         B     BACK99                       NO, SEARCH SOME MORE        11530000
FOUND4   EQU   *                                                        11540000
         TM    ATTRIBUT,V20                 IS LMOD LINK EDITED IN OVLY 11550000
         BZ    INCORE4                      NO, CSECT INCORE, GO PASS   11560000
         ST    WORK3,WKSAVE3                SAVE END OF CESD RCD ADDR   11570000
         BAL   RETURN,CHKSEGMT              YES, GO SEE IF CSECT INCORE 11580000
         L     WORK3,WKSAVE3                RESTORE END OF CESD RCD PTR 11590000
         LTR   RETCODE,RETCODE              IS CSECT IN CORE            11600000
         BNZ   BACK99                       NO, GO BACK, CONTUNE SEARCH 11610000
INCORE4  EQU   *                                                        11620000
         MVC   ENTRYNAM(N8),N0(WORK2)       CSECT NAME TO ENTRYNAME FLD 11630000
         MVC   ENTRNAMD+N1(N3),N9(WORK2)    GET ENTRYNAME DISPLACMENT   11642000
         OI    MODSWS,V40                   ENTRYNAME DISPLACMENT HERE  11650000
         L     RETURN,CESD14                GET RETURN ADDR             11660000
         BR    RETURN                       RETURN                      11670000
*                                                                       11680000
*        SEARCH CESD RCDS USING PASSED ENTRYNAME  RETURN DISPLACEMENT   11690000
*        BASED ON LINKAGE EDITOR ADDR 00, OF THAT CSECT                 11700000
*                                                                       11710000
FINDNAME CLC   ENTRYNAM(N8),N0(WORK2)       IS THIS THE CSECT           11720000
         BE    FOUND5                       YES, GO EXTRACT DISPLACMENT 11730000
         LA    WORK2,N16(WORK2)             NO, POINT TO NEXT ENTRY     11740000
         CR    WORK2,WORK3                  IS IT THE END OF THE RCD    11750000
         BL    FINDNAME                     NO, GO CHECK NEXT CESD ENTY 11760000
         B     READCESD                     YES, GO READ ANOTHER RECORD 11770000
FOUND5   EQU   *                                                        11780000
         TM    ATTRIBUT,V20                 IS LMOD LINK EDITED IN OVLY 11790000
         BZ    INCORE5                      NO, CSECT INCORE, GO PASS   11800000
         BAL   RETURN,CHKSEGMT              YES, GO SEE IF CSECT INCORE 11810000
         LTR   RETCODE,RETCODE              IS CSECT IN CORE            11820000
         BZ    INCORE5                      YES, GO PASS TO CALLER      11830000
         LA    RETCODE,N40                  NO, PASS 2ND LEVEL MESG NO. 11840000
         B     NOFIND                       GO GIVE RET CODE, MESSAGE   11850000
INCORE5  EQU   *                                                        11860000
         MVC   ENTRNAMD+N1(N3),N9(WORK2)    GET ENTRYNAME DISPLACEMENT  11870000
         OI    MODSWS,V40                   INDICATE DISPLACMENT PRESNT 11880000
         L     RETURN,CESD14                GET RETURN ADDR             11890000
         BR    RETURN                       RETURN                      11900000
*                                                                       11910000
*        IF THE LOAD MODULE IS LINK EDITTED IN OVERLAY, SEE IF SEGMENT  11920000
*        CONTAINNING ENTRYNAME IS IN CORE                               11930000
*                                                                       11940000
CHKSEGMT EQU   *                                                        11950000
         SR    RETCODE,RETCODE              INITIAL INDCATE, SEG INCORE 11960000
         SR    WORK1,WORK1                  CLEAR REGISTER TO ZERO      11970000
         IC    WORK1,N12(WORK2)             SEG NO. OF FOUND ENTRYNAME  11980000
         SLL   WORK1,N2                     MULTIPLY BY FOUR            11990000
         L     WORK3,LOADNAMA               ADDRESS OF SEGTAB CSECT     12000000
         LA    WORK3,N23(WORK3,WORK1)       PTR TO STATUS IND FOR SEGMT 12010000
         TM    N0(WORK3),V03                ARE LOW ORDER 2 BITS 00     12020000
         BCR   ZERO,RETURN                  YES, SEGMENT INCORE, RETURN 12030000
         BO    NOTINMS                      NO, NOT INCORE, GO SET ERR  12040000
         TM    N0(WORK3),V02                ARE LOW ORDER 2 BITS 10     12050000
         BCR   ONES,RETURN                  YES, SEGMENT INCORE, RETURN 12060000
NOTINMS  EQU   *                                                        12070000
         LA    RETCODE,N4                   INDICATE SEGMENT NOT INCORE 12080000
         BR    RETURN                       RETURN TO CALLER            12090000
*                                                                       12100000
*        THIS ROUTINE SEARCHS INCORE CESD INFO BUILT BY THE OS LOADER   12110000
*                                                                       12120000
OBJMOD   TM    MODSWS,V20                   IS OS LOADER CESD INFO AVAB 12130000
SMTOBJ   DS    0H                           SMT TESTCASE LABEL          12140000
*                                            OBJ CESD NOT AVAILABLE     12150000
*                                            RC FROM SYM IS 4           12160000
*                                            TESTCASE ID  TEQU6100      12170000
         BO    CESDHERE                     YES, GO ON                  12180000
         LA    RETCODE,N16                  NO OS LOADER CESD INFO      12190000
         B     NOFIND                       NO, CANNOT RESOLVE          12200000
CESDHERE L     WORK2,POINTER                ADDR OF OS LOADER CESD INFO 12210000
         L     WORK3,CESDTTR                LENGTH OF CESD INFO         12220000
         AR    WORK3,WORK2                  END ADDR OF CESD INFO       12230000
         XC    WAREA1(N16),WAREA1           CLEAR WORK AREAS TO ZEROES  12240000
         TM    SWSB,V20                     IS SEARCH USING ENTRYNAME   12250000
         BO    SEARCH6                      YES, GO FIND DISPLACMENT    12260000
         L     WORK1,POFFSET                SEARCH USING OFFSET         12270000
         LA    WORK1,N8(WORK1)              ADD LEN OF **GO             12280000
         ST    WORK1,POFFSET                NEW OFFSET                  12290000
         B     OBJOFFST                     GO SEARCH USING OFFSET      12300000
*                                                                       12310000
*        THIS ROUTINE SEARCHS OS LOADER CESD INFO FOR A DISPLACEMENT    12320000
*        USING A CSECT NAME AS THE SEARCH ARGUMENT. WORK2 CONTAINS      12330000
*        THE PRESENT ENTRY ADDRESS, WORK3 CONTAINS THE END ADDRESS      12340000
*                                                                       12350000
SEARCH6  CR    WORK2,WORK3                  ANY MORE OS LOADER CESDS    12360000
         BL    CHECK6                       YES, GO CHECK THIS ENTRY    12370000
         LA    RETCODE,N32                  ENTRYNAME NOT IN CESD RCDS  12380000
         B     NOFIND                       NO, ERROR, CANNOT RESOLVE   12390000
CHECK6   CLC   ENTRYNAM(N8),N0(WORK2)       IS THIS THE CSECT           12400000
         BE    FOUND6                       YES, GO EXTRACT DISPLACEMNT 12410000
         LA    WORK2,N12(WORK2)             POINT TO NEXT ENTRY         12420000
         B     SEARCH6                      GO CHECK NEXT ENTRY         12430000
FOUND6   MVC   WAREA1+N1(N3),N9(WORK2)      LOADED ADDR OF THIS CSECT   12440000
         L     WORK4,WAREA1                 ADDR OF ENTRYNAME IN CORE   12450000
         S     WORK4,LOADNAMA               DISPL FROM LOADED ADDR      12460000
         ST    WORK4,ENTRNAMD               SAVE IN INFO BLOCK          12470000
         OI    MODSWS,V40                   INDICATE DISPLACEMENT PRSNT 12480000
         L     RETURN,CESD14                GET RETURN ADDRESS          12490000
         BR    RETURN                       RETURN                      12500000
*                                                                       12510000
*        THIS ROUTINE SEARCHS OS LOADER CESD INFO FOR A CSECT NAME      12520000
*        USING AN OFFSET AS A SEARCH ARGUMENT.  WORK2 CONTAINS THE      12530000
*        PRESENT ENTRY ADDRESS AND WORK3 CONTAINS THE END ADDRESS       12540000
*                                                                       12550000
OBJOFFST L     WORK4,LOADNAMA               MAIN STORAGE LOADED ADDRESS 12560000
         A     WORK4,POFFSET                CREATE WHERE ADDRESS        12570000
         LA    WORK5,N1                     CREATE SMALL ADDRESS        12580000
         SR    WORK1,WORK1                  INDICATE NO CESD ENTRY ADDR 12590000
SEARCH7  CR    WORK2,WORK3                  ANY MORE CESD INFO          12600000
         BL    CHECK7                       YES, GO CHECK THIS ENTRY    12610000
         B     MAYBE7                       NO, GO SEE IF WE FOUND ONE  12620000
CHECK7   MVC   WAREA2+N1(N3),N9(WORK2)      GET LOADED ADDR OF THIS SEC 12630000
         C     WORK4,WAREA2                 IS WHERE ADDR AFTER THIS    12640000
         BNL   FOUND17                      YES, GO CHECK FUTHER        12650000
PTRTONXT LA    WORK2,N12(WORK2)             POINT TO NEXT ENTRY         12661900
         B     SEARCH7                      GO CHECK NEXT ENTRY         12671900
FOUND17  C     WORK5,WAREA2                 IS THIS ADDR AFTER LAST ONE 12681900
         BH    PTRTONXT                     NO, LAST SAVED ONE HIGHER   12691900
         L     WORK5,WAREA2                 YES, GET ITS LOADED ADDR    12705600
         LR    WORK1,WORK2                  POINT TO CLOSEST CSECT ENTY 12712800
         B     PTRTONXT                     GO POINT TO NEXT ONE        12720000
MAYBE7   LTR   WORK1,WORK1                  DID WE FIND ONE             12730000
         BC    N7,FOUND7                    YES, GO MOVE TO ENTRY BLOCK 12740000
         LA    RETCODE,N4                   NO ENTRYNAME FOR OFFSET     12750000
         B     TOCALLER                     NO, ERROR, NO CSECT FOUND   12760000
FOUND7   MVC   ENTRYNAM(N8),N0(WORK1)       ENTRYNAME TO INFO BLK       12770000
         S     WORK5,LOADNAMA               CALCULATE DISPLACEMENT      12780000
         ST    WORK5,ENTRNAMD               DISPLACMENT TO INFO BLOCK   12790000
         OI    MODSWS,V40                   ENTRYNAME DISPLACMENT HERE  12800000
         L     RETURN,CESD14                GET RETURN ADDRESS          12810000
         BR    RETURN                       RETURN                      12820000
         SPACE 3                                                        12830000
*********************************************************************** 12840000
*                                                                     * 12850000
*        THE FOLLOWING SUB-ROUTINES HANDLE SECONDARY STORAGE I/O      * 12860000
*                                                                     * 12870000
*********************************************************************** 12880000
         SPACE 2                                                        12890000
*                                                                       12900000
*        THIS ROUTINE OPENS THE DCB FOR READING SECONDARY STORAGE.      12910000
*        DAIR IS LINKED TO IF IT IS NECESSARY TO ALLOCATE AND OBTAIN    12920000
*        A DDNAME FOR SYS1.LINKLIB                                      12930000
*                                                                       12940000
OPENDCB  ST    RETURN,OPDCB14               SAVE RETURN ADDRESS         12950000
         LA    WORK5,PDSDCB                 ADDR OF DCB IN WORK AREA    12960000
         USING IHADCB,WORK5                 BASE FOR DESCRIPTIVE DSECT  12970000
         TM    MODSWS,V04                   DO WE HAVE A PASSED DDNAME  12980000
         BZ    LINKLIB                      NO, PDS=LINKLIB, GO ALLOCAT 12990000
CHECKDCB TM    DCBOFLGS,V10                 IS DCB OPENED               13000000
         BZ    DOOPEN                       NO, GO OPEN DCB             13010000
         CLC   DDNAME(N8),OPENFDD           IS DCB OPENED FOR PASSED DD 13020000
         BNE   DOCLOSE                      NO, GO DO CLOSE AND OPEN    13030000
OPENDONE L     RETURN,OPDCB14               RESTORE RETURN ADDRESS      13040000
         BR    RETURN                       RETURN TO CALLER            13050000
DOCLOSE  BAL   RETURN,CHECKECB              GO CHECK FOR REQ TO END     13060000
         LA    PARMREG1,CLOSELST            ADDRESS OF CLOSE LIST       13070000
         CLOSE ((WORK5)),MF=(E,(PARMREG1))                              13080000
DOOPEN   DS    0H                                                       13090000
         MVC   DCBDDNAM(N8),DDNAME          OPEN DCB FOR PASSED DDNAME  13100000
         BAL   RETURN,CHECKECB              GO CHECK FOR REQ TO END     13110000
         LA    PARMREG1,OPENLIST            ADDRESS OF OPEN LIST        13120000
         OPEN  ((WORK5)),MF=(E,(PARMREG1))                              13130000
PABEND3  EQU   *                            POSSIBLE ABEND RESUME ADDR  13140000
         TM    DCBOFLGS,V10                 WAS DCB OPENED SUCCESSFULLY 13150000
         DROP  WORK5                                                    13160000
SMTOPEN  DS    0H                           SMT TESTCASE LABEL          13170000
*                                            OPEN UNSUCCESSFUL          13180000
*                                            RC FROM SYM IS 8           13190000
*                                            TESTCASE ID  TEQU5400      13200000
*                                            TESTCASE ID  TPCH6300      13210000
         BO    OPENOK                       YES, GO ON                  13220000
         LA    RETCODE,N4                   CANNOT OPEN DCB             13230000
         B     SYSERR                       GO SET UP END AND GIVE MESG 13240000
OPENOK   MVC   OPENFDD(N8),DDNAME           INDICATE DD DCB OPENED FOR  13250000
         B     OPENDONE                     GO BACK AND RETURN TO CALLR 13260000
LINKLIB  TM    SWSC,V80                     IS A DDNAME FOR LINKLIB ON  13270000
         BZ    ALLOC                        NO, GO SET TO ALLOC - DAIR  13280000
         MVC   DDNAME(N8),LINKLBDD          YES, MOVE TO INFO BLOCK     13290000
         OI    MODSWS,V04                   INDICATE WE HAVE A DDNAME   13300000
         B     CHECKDCB                     GO CHECK STATUS OF DCB      13310000
ALLOC    EQU   *                                                        13320000
         GETMAIN   RC,LV=N100,SP=N1         GET PARM BLOCK TO PASS-DAIR 13330000
PABEND2  EQU   *                            POSSIBLE ABEND RESUME ADDR  13340000
         LTR   RETCODE,RETCODE              IS RETURNCODE NON-ZERO      13350000
         BZ    SMTGET01                     IF ZERO, GO SET INDICATOR   13360000
         MVI   WAREA3,N8                    SAVE RETURN CODE            13370000
         LA    WORK2,N10                    GET SVC NUMBER              13380000
         LA    WORK5,N5                     INDICATE TO USE 5TH MACRO   13390000
         SPACE                                                          13400000
DOPRINT1  BAL   RETURN,TERMIO               GO PUT MESG TO TERMINAL     13410000
         SR    RETCODE,RETCODE              CLEAR FOR RETURN CODE       13420000
         IC    RETCODE,WAREA3               RETURN CODE FOR CALLER      13430000
         B     TOCALLER                     RETURN TO CALLER            13440000
SMTGET01 DS    0H                           SMT TESTCASE LABEL          13450000
*                                           GET FAILED-DAIR PARM LIST   13460000
*                                           TESTCASE ID  TTSTC160       13470000
         OI    SWSC,V40                     INDICATE THEIR IS A PARM    13480000
*                                           LIST TO FREE IN THE STAE    13490000
*                                           RETRY RT IF WE ABEND IN     13500000
*                                           DAIR                        13510000
         ST    PARMREG1,ADAIRCOR            SAVE ADDR OF DAIR LIST CORE 13520000
         USING DAPL,PARMREG1                                            13530000
         MVC   DAPLUPT(N4),TSTUPT           POINTER TO UPT FOR DAIR     13540000
         MVC   DAPLECT(N4),TSTECT           POINTER TO ECT FOR DAIR     13550000
         MVC   DAPLECB(N4),TSTCPECB         POINTER TO CP ECB FOR DAIR  13560000
         L     WORK1,TPLPTR                 OBTAIN POINTER TO THE       13570000
         USING TPL,WORK1                     PROTECTED STEP CONTROL     13580000
         MVC   DAPLPSCB(N4),TPLPSCB          BLOCK FOR DAIR             13590000
         DROP  WORK1                                                    13600000
         LA    WORK1,N20(PARMREG1)          ADDR OF DAIR LIST FOR X'08' 13610000
         ST    WORK1,DAPLDAPB               INTO STANDARD LIST FOR DAIR 13620000
         DROP  PARMREG1                                                 13630000
         USING DAPB08,WORK1                                             13640000
         LA    WORK2,N8                     DAIR REQ TYPE IS X'08'      13650000
         STH   WORK2,DA08CD                 PUT IN DAIR PARM LIST       13660000
         SR    WORK2,WORK2                  CLEAR REG TO ZEROES         13670000
         STH   WORK2,DA08FLG                FLAGS - ZERO                13680000
         ST    WORK2,DA08DARC               ERROR CODES - ZERO          13690000
         LA    WORK2,LINKPDS                ADDR OF DS NAME - LINKLIB   13700000
         ST    WORK2,DA08PDSN               INTO DAIR PARM LIST         13710000
         MVC   DA08DDN(N4),BLANKS           DDNAME IS BLANK             13720000
         MVC   DA08UNIT(N4),BLANKS          UNIT IS BLANK               13730000
         MVC   DA08SER(N4),BLANKS           VOL SER IS BLANK            13740000
         LA    WORK2,N256                   BLOCKSIZE IS 256            13750000
         ST    WORK2,DA08BLK                INTO DAIR LIST              13760000
         XC    DA08PQTY(N12),DA08PQTY       DASD SPACE REQ IS ZERO      13770000
         MVC   DA08MNM(N4),BLANKS           MEMBER NAME IS BLANKS       13780000
         MVC   DA08PSWD(N4),BLANKS          PASSWORD IS BLANK           13790000
         MVI   DA08DSP1,DA08SHR             DISP1 FIELD SET TO SHR      13800000
         MVI   DA08DPS2,DA08KEEP            DISP2 FIELD SET TO KEEP     13810000
         MVI   DA08DPS3,DA08KEP             DISP3 FIELD SET TO KEEP     13820000
         MVI   DA08CTL,V00                  CONTROL FIELD SET TO ZERO   13830000
         LA    RETURN,ALLOCOK               IF LINK FAILS GO TO ALLOCOK 13840000
         LINK  EP=IKJDAIR,ERRET=LINKERR1    GO TO DAIR                  13850000
PABEND4  EQU   *                            POSSIBLE ABEND RESUME ADDR  13860000
         B     SMTDAIR                      SKIP LINK ERROR ROUTINE     13870000
LINKERR1 EQU   *                                                        13880000
         LA    WORK5,N6                     USE 6TH FORM OF MACRO       13890000
         LA    WORK2,N6                     SET SVC #                   13900000
         MVI   WAREA3,N8                    SAVE RETURN CODE            13910000
         LR    PARMREG0,PARMREG1            SHIFT ABEND CODE TO REG0    13920000
         B     DOPRINT1                     GO PRINT MSG                13930000
SMTDAIR  DS    0H                           SMT TESTCASE LABEL          13940000
*                                            LINK TO DAIR FAILED        13950000
*                                            TESTCASE ID  TTSTC160      13960000
         LR    WORK4,RETCODE                SAVE DAIR RETURN CODE       13970000
         LTR   PARMREG0,RETCODE             WAS DAIR SUCCESSFUL         13980000
         BZ    ALLOCOK                      YES, GO GET DDNAME          13990000
         B     DAIRFAIL                     NO, GO PRINT MSG            14000000
ALLOCOK  EQU   *                                                        14010000
         MVC   LINKLBDD(N8),DA08DDN         GET LINKLIB DD OR BLANKS    14020000
         DROP  WORK1                                                    14030000
         FREEMAIN  RC,LV=N100,A=(PARMREG1),SP=N1                        14040000
         LTR   RETCODE,RETCODE              WAS RETURN CODE ZERO        14050000
         BZ    TURNOFF2                     YES, TURNOFF PARM LIST SW   14060000
         LA    WORK2,N120                   INDICATE SVC NUMBER         14070000
         MVI   WAREA3,N8                    SAVE RETURN CODE            14080000
         LA    WORK5,N5                     USE 1ST FORM OF SVCERR MAC  14090000
         B     DOPRINT1                     GO ISSUE ERROR MESSAGE      14100000
TURNOFF2 NI    SWSC,VBF                     TURN PARM LIST GOT SW OFF   14110000
         LTR   PARMREG0,WORK4               DID WE ALLOC LINKLIB        14120000
         BZ    ALLOCOK1                     YES, GO EXTRACT DDNAME      14130000
         BAL   RETURN,TERMIO                GO PUT MESG OUT             14140000
CODE8    LA    RETCODE,N8                   RC=8 FOR CALLER             14150000
         B     TOCALLER                     GO RETURN TO CALLER         14160000
ALLOCOK1 EQU   *                                                        14170000
         MVC   DDNAME(N8),LINKLBDD          MOVE IT TO INFO BLOCK       14180000
         OI    MODSWS,V04                   INDICATE DDNAME PRESENT     14190000
         OI    SWSC,V80                     WE HAVE A DDNAME FOR LINKLB 14200000
         B     CHECKDCB                     GO CHECK STATUS OF DCB      14210000
*                                                                       14220000
*        THIS ROUTINE PERFORMS A POINT TO THE LOADNAME INFO IN THE PDS  14230000
*                                                                       14240000
DOPOINT  ST    RETURN,POINT14               SAVE RETURN ADDRESS         14250000
         BAL   RETURN,CHECKECB              GO CHECK FOR REQ FOR END    14260000
         FIND  (PARMREG1),(PARMREG0),C                                  14270000
         L     RETURN,POINT14               RETURN ADDRESS              14280000
         BR    RETURN                       RETURN TO CALLER            14290000
*                                                                       14300000
*        THIS ROUTINE READS SECONDARY STORAGE                           14310000
*                                                                       14320000
DOREAD   ST    RETURN,READ14                SAVE RETURN ADDRESS         14330000
         LA    WORK4,LSTFREAD               ADDR OF DECB FOR E FORM     14340000
         BAL   RETURN,CHECKECB              GO CHECK FOR REQ FOR END    14350000
         LA    WORK3,BUFFER                 ADDRESS OF INPUT BUFFER     14360000
         LA    WORK5,PDSDCB                 ADDRESS OF DCB              14370000
         READ  (WORK4),SF,(WORK5),(WORK3),,,MF=E                        14380000
         CHECK (WORK4)                                                  14390000
         L     RETURN,READ14                GET RETURN ADDRESS          14400000
         BR    RETURN                       RETURN TO CALLER            14410000
*                                                                       14420000
*        THIS ROUTINE WILL ISSUE A NOTE FOR THE LAST RECORD READ        14430000
*                                                                       14440000
DONOTE   ST    RETURN,NOTE14                SAVE RETURN ADDRESS         14450000
         BAL   RETURN,CHECKECB              GO CHECK FOR REQ TO END     14460000
         NOTE  (PARMREG1)                                               14470000
         L     RETURN,NOTE14                GET RETURN ADDR             14480000
         BR    RETURN                       RETURN TO CALLER            14490000
         SPACE 3                                                        14500000
*********************************************************************** 14510000
*                                                                     * 14520000
*        THESE ROUTINES PERFORM LINKAGE TO THE SECOND SECTION OF SYM  * 14530000
*                                                                     * 14540000
*********************************************************************** 14550000
         SPACE 2                                                        14560000
DAIRFAIL EQU   *                                                        14570000
         LA    PARMREG1,N20                 FIFTH ROUTINE IN 2ND SEC    14580000
         B     GOTO2SEC                     GO SET UP FOR 2ND SECTION   14590000
PRINT2   EQU   *                                                        14600000
         LR    RETURN,WORK1                 PRESERVE REG WORK1          14610000
         LA    PARMREG1,N16                 FORTH ROUTINE IN 2ND SEC    14620000
         B     GOTO2SEC                     GO SET UP FOR 2ND SECTION   14630000
FOUNDSYM EQU   *                                                        14640000
         LA    PARMREG1,N12                 FORTH ROUTINE IN 2ND SEC    14650000
         B     GOTO2SEC                     GO SET UP FOR 2ND SECTION   14660000
SYSERR   EQU   *                                                        14670000
         LA    PARMREG1,N8                  THIRD ROUTINE IN 2ND SEC    14680000
         B     GOTO2SEC                     GO SET UP FOR 2ND SECTION   14690000
NOFIND   EQU   *                                                        14700000
         LA    PARMREG1,N4                  SECOND ROUTINE IN 2ND SEC   14710000
         B     GOTO2SEC                     GO SET FOR 2ND SECTION      14720000
FIRSTENT EQU   *                                                        14730000
         SR    PARMREG1,PARMREG1            FIRST ROUTINE IN 2ND SEC    14740000
GOTO2SEC L     WORK1,SECENTRY               ADDR OF ENTRY TO 2ND        14750000
         BR    WORK1                        GO TO SECOND CSECT          14760000
         SPACE 3                                                        14770000
*********************************************************************** 14780000
*                                                                     * 14790000
*        CONSTANTS                                                    * 14800000
*                                                                     * 14810000
*********************************************************************** 14820000
         SPACE 2                                                        14830000
DEFAULTM DC    X'000001'                    DEFAULT MULTIPLICITY VALUE  14840000
WLENRCD  DC    C'WRNG.LEN.RECORD'           SYNADAF MESSAGE FOR WRONG   14850000
*                                            LENGTH RECORD              14860000
CCWLENFD DC    H'7'                         CCW LENGTH FIELD            14870000
DEFLENFD DC    H'0'                         DEFAULT LENGTH FIELD        14880000
LINKPDS  DC    H'12'                        LENGTH AND NAME OF LINKLIB  14890000
         DC    C'SYS1.LINKLIB'              FOR DAIR PARM LIST          14900000
SECENTRY DC    A(IKJEGMYS)                  ADDRESS OF SECOND CSECT     14910000
MOVEINST MVC   N0(N1,WORK2),N0(WORK3)       TARGET OF EX INSTR          14920000
RETRYADR DC    AL3(STAERTRY)                ADDR OF STAE RETRY ROUTINE  14930000
BLANKS   DC    8C' '                        BLANKS FOR CLEARING AREAS   14940000
NO2NDMSG DC    X'FF000000'                  RC NOT 0, NO 2ND LEV MSG IN 14950000
ABENDTAB DS    0F                           ABEND IC TABLE FOR STAE     14960000
         DC    X'5C'                        NO CORE CODE                14970000
         DC    AL3(PABEND1)                 RESUME IC AFTER GETMAIN     14980000
         DC    X'5C'                        NO CORE CODE                14990000
         DC    AL3(PABEND2)                 RESUME IC AFTER GETMAIN     15000000
         DC    X'60'                        OPEN FAILED CODE            15010000
         DC    AL3(PABEND3)                 RESUME IC AFTER OPEN        15020000
         DC    X'60'                        LINK FAILED CODE            15030000
         DC    AL3(PABEND4)                 RESUME IC AFTER LINK        15040000
         DC    X'FF'                        END OF ABEND IC TABLE       15050000
         SPACE 1                                                        15060000
LIST     IKJEGSPL RTRY=STAERTRY,ABNTB=ABENDTAB,MODNM=IKJEGSYM,TNM=SYM   15070000
         SPACE 1                                                        15080000
SUPERZAP DC    50CL1'Z'                     PATCH AREA                  15090000
         EJECT                                                          15100000
IKJEGMYS CSECT                                                          15110000
*                                                                       15120000
*                                                                       15130000
         LR    SYMB2,WORK1                  ADDRESSABILITY              15140000
         USING IKJEGMYS,SYMB2                IKJEGMYS CSECT             15150000
         B     BTABLE(PARMREG1)             GO TO DESIRED ROUTINE       15160000
BTABLE   B     FIRSTIME                     FIRST TIME ROUTINE          15170000
         B     NOTFOUND                     UNRESOLVED SYMBOL ROUTINE   15180000
         B     NOTABLE                      CANNOT PROCESS SYMS ROUTINE 15190000
         B     BUILDSIB                     BUILD SYMINFO BLK ROUTINE   15200000
         B     PRINT3                       GO PRINT A MESSAGE          15210000
         B     DAIRERR                      GO DAIR ERROR ANALYSIS RTN  15220000
         SPACE 3                                                        15230000
*********************************************************************** 15240000
*                                                                     * 15250000
*        THIS SUB-ROUTINE PERFORMS FIRST TIME INITILIZATION.          * 15260000
*        A WORK AREA IS GOTTEN AND INITILIZED.                        * 15270000
*                                                                     * 15280000
*********************************************************************** 15290000
         SPACE 2                                                        15300000
FIRSTIME EQU   *                                                        15310000
         GETMAIN   RC,LV=N72,SP=N1          GET A TEMPORARY SAVE AREA   15320000
         LTR   RETCODE,RETCODE              IS RETURN CODE ZERO         15330000
         BZ    SMTGET02                     IF SO, GO TO SMTGET02       15340000
         LA    RETURN,RC4                   SET RETURN ADDRESS          15350000
         LA    WORK5,N5                     USE SECOND FORM OF MACRO    15360000
         LA    WORK2,N10                    SET SVC NUMBER              15370000
         LA    WORK4,N8                     SET RETURN CODE             15380000
         MVI   WAREA3,N8                    SAVE RETRUN CODE            15390000
         B     DOPRINT                      GO ISSUE ERROR MSG          15400000
SMTGET02 DS    0H                           SMT TESTCASE LABEL          15410000
*                                            GET FAILED-TEMP SAVE AREA  15420000
*                                            TESTCASE ID  TTSTC160      15430000
         LR    WORK5,PARMREG1               ADDRESS OF GOTTEN CORE      15440000
         L     WORK1,WORKAREA               ADDR OF GENERAL CMD WKAREA  15450000
         USING TSTCWORK,WORK1               BASE FOR DESCRIPTIVE DSECT  15460000
         LA    WORK2,CWORKSYM               ADDR OF SYM PART OF WKAREA  15470000
         MVC   N4(N12,WORK2),LFGET          LIST FORM OF GET TO WKAREA  15480000
         LA    PARMREG1,N4(WORK2)           ADDR OF LIST FORM FOR GET   15490000
         GETMAIN   EC,LV=N800,A=(WORK2),SP=N1,MF=(E,(PARMREG1))         15500000
         LTR   RETCODE,RETCODE              DID WE GET THE CORE         15512000
SMTGET03 DS    0H                           SMT TESTCASE LABEL          15521000
*                                            INSUFFICIENT CORE FOR WORK 15530000
*                                            AREA-RC FROM SYM IS 4      15539000
*                                            TESTCASE ID  TTSTC160      15548000
         BZ    GETOK                        YES, GO CONTINUE PROCESSING 15560000
*                                                                       15570000
*        SETUP TO GIVE INSUFFICIENT MAIN STORAGE MESSAGE                15580000
*                                                                       15590000
         ST    SYMWKB,N4(WORK5)              TO PUT OUT INSUFFICIENT    15600000
         LR    SYMWKB,WORK5                  STORAGE MESSAGE            15610000
         SR    WORK5,WORK5                  CLEAR REG FOR LATER USE     15620000
         TM    TSTFLGS3,SYMMESG             SHOULD WE PRINT A MESSAGE   15630000
         BO    FREECORE                     NO, GO FREE TEMP SAVE AREA  15640000
         ST    WORK5,N8(SYMWKB)             USE TEMPORARY SAVE AREA     15650000
         L     WORK6,NOCOREMG               ADDRESS OF NO CORE MESSAGE  15660000
         LA    WORK5,N5                     USE FOURTH FORM OF MACRO    15670000
         LA    WORK2,N10                    SET SVC NUMBER              15680000
         MVI   WAREA3,N8                    SAVE RETURN CODE            15690000
         BAL   RETURN,DOPRINT               GO ISSUE ERROR MSG          15700000
         LR    WORK5,RETCODE                SAVE RETCODE FROM I/O       15710000
FREECORE EQU   *                                                        15720000
         LR    WORK3,SYMWKB                 ADDR OF TEMP SAVE TO FREE   15730000
         L     SYMWKB,N4(SYMWKB)            ADDR OF CALLERS SAVE AREA   15740000
         FREEMAIN  RC,LV=N72,A=(WORK3),SP=N1 FREE TEMPORARY SAVE AREA   15750000
*  THERE IS NO REASON TO CHECK RETURN CODE HERE SINCE WE ARE ON OUR     15760000
* WAY OUT BECAUSE OF ERROR IN GETMAIN ABOVE                             15770000
         LTR   WORK5,WORK5                  WAS I/O SUCCESSFUL          15780000
         BZ    RC4                          YES, GO GIVE RETURN CODE 4  15790000
         LR    RETCODE,WORK5                NO, PASS BACK I/O RET CODE  15800000
         B     TOCALL                       GO RETURN TO CALLER         15810000
RC4      EQU   *                                                        15820000
         LA    RETCODE,N4                   NO CORE RETURN CODE IS 4    15830000
         B     TOCALL                       GO RETURN TO CALLER         15840000
*                                                                       15850000
*        INITILIZE WORK AREA                                            15860000
*                                                                       15874000
GETOK    EQU   *                                                        15883000
         FREEMAIN  RC,LV=N72,A=(WORK5),SP=N1 FREE TEMPORARY SAVE AREA   15892000
         LTR   RETCODE,RETCODE              IS RETURN CODE ZERO         15901000
         BZ    GETADDR                      IF SO, GET ADDRESS OF CORE  15910000
         LA    WORK5,N5                     USE FIFTH FORM OF MACRO     15919000
         LA    WORK2,N120                   GET SVC NUMBER              15928000
         BAL   RETURN,TERMIO                GO PRINT MSG                15937000
         LA    RETCODE,N8                   SET RETURN CODE TO 8        15946000
         B     TOCALLER                     RETURN                      15955000
GETADDR  EQU   *                                                        15964000
         L     WORK5,CWORKSYM               ADDRESS OF GOTTEN CORE      15973000
         DROP  WORK1                                                    15982000
         ST    WORK5,N8(SYMWKB)             MYSAVE ADDR IN CALLERS AREA 15991000
         ST    SYMWKB,N4(WORK5)             HIS SAVE ADDR IN MY AREA    16000000
         LR    SYMWKB,WORK5                 MY SAVE ADDR IN PROPER REG  16009000
         ST    SYMWKB,TSTSYMWK              WKAREA ADDR INTO TCOMTAB    16018000
         MVC   STAELIST(LENSTAE),LFSTAE  ESTAE LIST FORM  TO WKAREA     16040000
         MVC   OPENLIST(N8),LFOPEN          OPEN LIST TO THE WORK AREA  16050000
         MVC   CLOSELST(N8),LFCLOSE         CLOSE LIST TO THE WORK AREA 16060000
         MVC   LSTFREAD(N24),SSDECB         LIST FORM READ TO WORK AREA 16070000
         MVC   PDSDCB(N88),BPAMDCB          MOVE DCB TO WORK AREA       16080000
         LA    WORK1,PDSDCB                 ADDR OF DCB                 16090000
         ST    WORK1,PDSDCBA                INTO ADDR PART OF WORK AREA 16100000
         LA    WORK1,CINFOBLK               ADDR OF CURRENT INFO BLOCK  16110000
         ST    WORK1,CINFOBKA               INTO ADDR PART OF WORK AREA 16120000
         LA    WORK1,TINFOBLK               ADDR OF TEMP INFO BLOCK     16130000
         ST    WORK1,TINFOBKA               INTO ADDR PART OF WORK AREA 16140000
         LA    WORK1,BUFFER                 ADDR OF BUFFER              16150000
         ST    WORK1,BUFFERA                INTO ADDR PART OF WORK AREA 16160000
         LA    INFOBLKB,CINFOBLK            ADDR OF WORK AREA TO CLEAR  16170000
         MVI   CINFOBLK,V40                 BLANK TO CURR INFO BLK AREA 16180000
         MVC   CINFOBLK+N1(N23),CINFOBLK    BLANK CHAR INFO             16190000
         XC    LOADNAMA(N32),LOADNAMA       ZERO OUT OUT DATA           16200000
         XC    WHATPASS(N4),WHATPASS        SET ALL SWITCHES TO ZEROES  16210000
         B     IKJEGBEG                     GO BACK TO MAIN STREAM IN   16220000
*                                            FIRST SECTION              16230000
         SPACE 2                                                        16240000
*********************************************************************** 16250000
*                                                                     * 16260000
*        SYMBOL FOUND, BUILD ANSWER BLOCK, RET CODE= ZERO, RETURN     * 16270000
*        WORK3 POINTS TO FOUND SYMBOL                                 * 16280000
*        IF THE SYMBOL WAS FOUND IN A DSECT, THE DSECT NAME WILL BE   * 16290000
*        IN WAREA1                                                    * 16300000
*                                                                     * 16310000
*********************************************************************** 16320000
         SPACE 2                                                        16330000
BUILDSIB EQU   *                                                        16340000
         GETMAIN   RC,LV=N16,SP=N1           GET A SYMINFO ANSWER BLOCK 16350000
PABEND1  EQU   *                            POSSIBLE ABEND RESUME ADDR  16360000
         LTR   RETCODE,RETCODE              IS RETURN CODE ZERO         16370000
         BZ    SMTGET04                     IF SO, GO TO SMTGET04       16380000
         LA    WORK5,N5                     USE 5TH FJORM OF MACRO      16390000
         LA    WORK2,N10                    SET SVC #                   16400000
         BAL   RETURN,TERMIO                GO PRINT MSG                16410000
         LA    RETCODE,N8                   SET RETURN CODE             16420000
         B     TOCALLER                     RETURN TO CALLER            16430000
SMTGET04 DS    0H                           SMT TESTCASE LABEL          16440000
*                                            GET FAILED-SYMINFO BLK-SIB 16450000
*                                            TESTCASE ID  TTSTC160      16460000
         LA    WORK2,N0(PARMREG1)           ADDR OF GOTTEN CORE         16470000
         LA    WORK1,N1                     CREATE 'OR' REG TO SET HIGH 16480000
         SLL   WORK1,N31                     ORDER BIT ON               16490000
         OR    WORK2,WORK1                  INDICATE POINTER TO ANSW BK 16500000
         ST    WORK2,PDEUSER                RETURN IT TO CALLER IN PDE  16510000
         LA    WORK2,N0(WORK2)              CLEAR HIGH ORDER BYTE       16520000
         SR    PARMREG1,PARMREG1            CLEAR REGISTER              16530000
         ST    PARMREG1,N12(WORK2)          LAST BLOCK POINTER IS ZERO  16540000
         L     WORK1,SICHAIN                HEAD OF ANSWER BLOCK CHAIN  16554700
         LTR   WORK1,WORK1                  IS THEIR A CHAIN            16560000
         BC    N7,SEARCH9                   YES, GO SEARCH FOR LAST ONE 16570000
         ST    WORK2,SICHAIN                NO, START CHAIN             16580000
         B     GOTBLK                       GO FILL IN ANSWER BLOCK     16590000
SEARCH9  C     PARMREG1,N12(WORK1)          IS IT END OF CHAIN          16600000
         BE    FOUND9                       YES, GO ADD TO CHAIN        16610000
         L     WORK1,N12(WORK1)             NO, POINT TO NEXT BLOCK     16620000
         B     SEARCH9                      GO CHECK FOR END OF CHAIN   16630000
FOUND9   ST    WORK2,N12(WORK1)             LAST BLOCK POINTS TO NEW 1  16640000
         USING SYMINFO,WORK2                BASE FOR DESCRIPTIVE DSECT  16650000
GOTBLK   LTR   WORK3,WORK3                  WHERE WAS SYMBOL FOUND      16660000
         BP    SYMRCD                       IN A SYM RCD ON SEC STORAGE 16670000
         LPR   WORK3,WORK3                  ADDR OF INCORE SYMBOL       16680000
         USING INCORE,WORK3                 BASE FOR INCORE SYMTAB DSEC 16690000
         MVC   ZERO1(N10),ZERO2             INCORE SYM INFO-SYMINFO BLK 16700000
         DROP  WORK3                                                    16710000
         SR    RETCODE,RETCODE              RET CODE EQUAL ZERO         16720000
         B     TOCALLER                     GO BACK TO RET TO CALLER    16730000
*                                                                       16740000
SYMRCD   TM    SWSA,V20                     WAS SYMBOL FOUND IN A DSECT 16750000
         BZ    GOODSYM                      NO, USE BASE FOR SYMS       16760000
         STM   WORK1,WORK3,WORKSAVE         SAVE POINTERS               16770000
         BAL   RETURN,DSECTIN               GO SEARCH INCORE SYMS-DSECT 16780000
         LTR   RETCODE,RETCODE              WAS THE DSECT FOUND         16790000
         BZ    FOUNDD                       YES, GO EXTRACT ADDR        16800000
         LA    RETCODE,N28                  UNRESOLVED, 2ND LEV MESG 28 16810000
         B     NOFIND                       NO, ERROR CANNOT RESOLVE    16820000
FOUNDD   LPR   WORK3,WORK3                  ADDR OF ADDR BASE FOR DSECT 16830000
         L     WORK4,N4(WORK3)              BASE FOR SYMBOL             16840000
         LM    WORK1,WORK3,WORKSAVE         RESTORE POINTERS            16850000
         B     DSECTIN2                     GO FILL IN ANSWER BLOCK     16860000
GOODSYM  L     WORK4,BASEFSYM               BASE FOR SYMBOLS            16870000
DSECTIN2 MVC   WAREA2+N1(N3),N1(WORK3)      ALIGN SYMBOL DISPL          16880000
         L     WORK5,WAREA2                 SYM DISPLACEMENT            16890000
         LA    WORK5,N0(WORK5)              SYM DISP FOR ADDING         16900000
         AR    WORK4,WORK5                  LOADED ADDR OF SYMBOL       16910000
         ST    WORK4,ZERO1                  RETURN IN SYMINFO ANSWER BK 16920000
         SR    WORK1,WORK1                  CLEAR REG FOR IC INSTR      16930000
         IC    WORK1,N0(WORK3)              GET ORGANIZATION TYPE BYTE  16940000
         LA    WORK4,N15                    CREATE 'AND' BYTE           16950000
         NR    WORK1,WORK4                  LENGTH OF NAME-1            16960000
         LA    WORK1,N5(WORK1,WORK3)        ADDR OF DATA TYPE FIELD     16970000
         MVC   TYPE(N1),N0(WORK1)           DATA TYPE TO ANSWER BLOCK   16980000
         CLI   N0(WORK1),V08                DATA TYPE TELLS LEN FIELD   16990000
         BH    LEN1BYTE                     LENGTH FIELD-1 BYTE LONG    17000000
         MVC   LENGTH(N2),N1(WORK1)         2 BYTE LEN FIELD TO ANS BLK 17010000
         LH    WORK5,LENGTH                 LENGTH-1 OF SYMBOL'S CORE   17020000
         LA    WORK5,N1(WORK5)              LENGTH OF RESERVED M.S.     17030000
         STH   WORK5,LENGTH                 LEN TO ANSWER BLOCK         17040000
         LA    WORK1,N3(WORK1)              ADDR OF MULITIPLICITY FIELD 17050000
         B     CHECKM                       GO CHECK FOR MULITIPLICITY  17060000
LEN1BYTE SR    WORK5,WORK5                  CLEAR REGISTER              17070000
         IC    WORK5,N1(WORK1)              GET 1 BYTE LENGTH FIELD     17080000
         LA    WORK5,N1(WORK5)              LEN OF RESERVED CORE        17090000
         STH   WORK5,LENGTH                 LEN FIELD TO ANSWER BLOCK   17100000
         LA    WORK1,N2(WORK1)              ADDR OF MULTIPLICITY FIELD  17110000
CHECKM   TM    N0(WORK3),V40                IS MULTIPLICITY PRESENT     17120000
         BZ    NOM                          NO, GO GET DEFAULT          17130000
         MVC   MULTIPLT(N3),N0(WORK1)       MULTIPLICITY TO ANSWER BLK  17140000
         B     BUILTBLK                     ANSWER BLK BUILT, GO ON     17150000
NOM      EQU   *                                                        17160000
         MVC   MULTIPLT(N3),DEFAULTM        MOVE 1 TO ANSWER BLOCK      17170000
BUILTBLK SR    RETCODE,RETCODE              RETCODE = ZERO              17180000
         B     TOCALLER                     GO RETURN TO CALLER         17190000
         DROP  WORK2                                                    17200000
         SPACE 2                                                        17210000
*********************************************************************** 17220000
*                                                                     * 17230000
*        THIS ROUTINE RETURNS TO THE CALLER WHEN NOT ABLE TO RESOLVE  * 17240000
*        A REQUEST.  ERROR MESSAGES ARE PRINTED IF                    * 17250000
*                  SYMMESG SWITCH, EGUATED TO B'00100000', IN THE     * 17260000
*                  TSTFLGS3 FIELD OF TCOMTAB DSECT IS OFF             * 17270000
*                                                                     * 17280000
*********************************************************************** 17290000
         SPACE 2                                                        17300000
*                                                                       17310000
*        MESSAGE   IKJ57280I                                            17320000
*                                                                       17330000
NOTFOUND EQU   *                                                        17340000
         BAL   RETURN,MSGRT1                GO SET UP FOR MESSAGES      17350000
*                                                                       17360000
*        SECOND LEVEL FOR IKJ57280I                                     17370000
*                                                                       17380000
         B     M0GETSEC(WORK5)              GO GET PROPER SECOND LEVEL  17390000
M0GETSEC B     CODEONLY                     GO GIVE RETCODE ONLY        17400000
         B     NOFIND04                     ERROR CODE 04, MESG M0L2A   17410000
         B     NOFIND08                     ERROR CODE 08, MESG M0L2B   17420000
         B     NOFIND12                     ERROR CODE 12, MESG M0L2C   17430000
         B     NOFIND16                     ERROR CODE 16, MESG M0L2D   17440000
         B     NOFIND20                     ERROR CODE 20, MESG M0L2E   17450000
         B     NOFIND24                     ERROR CODE 24, MESG M0L2F   17460000
         B     NOFIND28                     ERROR CODE 28, MESG M0L2G   17470000
         B     NOFIND32                     ERROR CODE 32, MESG M0L2H   17480000
         B     NOFIND36                     ERROR CODE 36, MESG M0L2I   17490000
         B     NOFIND40                     ERROR CODE 40, MESG M0L2J   17500000
         B     NOFIND44                     ERROR CODE 44, MESG M0L2K   17510000
         SPACE                                                          17520000
**********************************************************************  17530000
*  WORK1 - WILL POINT TO AN INSERT WHICH CONTAINS THE LOADNAME          17540000
*  WORK2 - WILL CONTAIN SECOND LEVEL MESSAGE ID NUMBER (M0L2AP1)        17550000
*  WORK5 - WILL INDICATE WHICH FORM OF THE IKJEGSIO MACRO TO USE        17560000
*  WORK6 - WILL CONTAIN FIRST LEVEL MESSAGE ID NUMBER (M0L1P1)          17570000
**********************************************************************  17580000
NOFIND04 MVC   N0(N4,WORK1),INSRTLEN        MOVE LENGTH INDIC TO INSERT 17590000
         MVC   N4(N8,WORK1),LOADNAME        LOADNAME TO INSERT          17600000
         MVI   N12(WORK1),V40               BLANK AT END OF INSERT      17610000
         L     WORK2,M0L2AP1                ID # OF SECOND LEVEL MESG   17620000
         L     WORK6,M0L1P1                 ID # OF FIRST LEVEL MESG    17630000
         LA    WORK5,N1                     USE FIRST FORM OF MACRO     17640000
         B     DOPRINT                      GO PRINT MESSAGE            17650000
         SPACE                                                          17660000
**********************************************************************  17670000
*  WORK1 - WILL POINT TO AN INSERT WHICH CONTAINS THE LOADNAME       *  17680000
*  WORK2 - WILL CONTAIN SECOND LEVEL MESSAGE ID NUMBER (MOL2BP1)     *  17690000
*  WORK5 - WILL INDICATE WHICH FORM OF THE IKJEGSIO MACRO TO USE     *  17700000
*  WORK6 - WILL CONTAIN FIRST LEVEL MESSAGE ID NUMBER (M0L1P1)          17710000
**********************************************************************  17720000
**********************************************************************  17730000
NOFIND08 DS    0H                                                       17740000
         MVC   N0(N4,WORK1),INSRTLEN        MOVE LENGTH INDIC TO INSERT 17750000
         MVC   N4(N8,WORK1),LOADNAME        LOADNAME TO INSERT          17760000
         MVI   N12(WORK1),V40               BLANK AT END OF INSERT      17770000
         L     WORK2,M0L2BP1                ID # OF SECOND LEVEL MESG   17780000
         L     WORK6,M0L1P1                 ID # OF FIRST LEVEL MESG    17790000
         LA    WORK5,N1                     USI FIRST FORM OF MACRO     17800000
         B     DOPRINT                      GO PRINT MESSAGE            17810000
         SPACE                                                          17820000
**********************************************************************  17830000
*  WORK1 - WILL POINT TO AN INSERT WHICH CONTAINS THE LOADNAME       *  17840000
*  WORK2 - WILL CONTAIN SECOND LEVEL MESSAGE ID NUMBER (MOS2CP1)     *  17850000
*  WORK5 - WILL INDICATE WHICH FORM OF THE MACRO TO USE              *  17860000
*  WORK6 - WILL CONTAIN FIRST LEVEL MESSAGE ID NUMBER (M0L1P1)          17870000
**********************************************************************  17880000
**********************************************************************  17890000
NOFIND12 MVC   N0(N4,WORK1),INSRTLEN        MOVE LENGTH INDIC TO INSERT 17900000
         MVC   N4(N8,WORK1),LOADNAME        LOADNAME TO INSERT          17910000
         MVI   N12(WORK1),V40               BLANK AT END OF INSERT      17920000
         L     WORK2,M0L2CP1                GET SECOND LEVEL MESG  ID # 17930000
         L     WORK6,M0L1P1                 GET FIRST LEVEL MESG  ID #  17940000
         LA    WORK5,N1                     USE FIRST FORM OF MACRO     17950000
         B     DOPRINT                      GO PRINT MESSAGE            17960000
         SPACE                                                          17970000
**********************************************************************  17980000
*  WORK1 - WILL POINT TO AN INSERT WHICH CONTAINS THE LOADNAME          17990000
*  WORK2 - WILL CONTAIN SECOND LEVEL MESSAGE ID NUMBER (M0L2DP1)        18000000
*  WORK5 - WILL INDICATE WHICH FORM OF THE MACRO TO USE                 18010000
*  WORK6 - WILL CONTAIN FIRST LEVEL MESSAGE ID NUMBER (M0L1P1)          18020000
**********************************************************************  18030000
NOFIND16 MVC   N0(N4,WORK1),INSRTLEN        MOVE LENGTH INDIC TO INSERT 18040000
         MVC   N4(N8,WORK1),LOADNAME        LOADNAME TO INSERT          18050000
         MVI   N12(WORK1),V40               BLANK AT END OF INSERT      18060000
         L     WORK2,M0L2DP1      GET SECOND LEVEL MSG ID # @ZA*****    18070000
         LA    WORK5,N1                     USE FIRST FORM OF MACRO     18080000
         L     WORK6,M0L1P1                 GET FIRST LEVEL MESG ID #   18090000
         B     DOPRINT                      GO PRINT MESSAGE            18100000
         SPACE                                                          18110000
**********************************************************************  18120000
*  WORK1 - WILL POINT TO AN INSERT WHICH CONTAINS THE LOADNAME          18130000
*  WORK2 - WILL CONTAIN SECOND LEVEL MESSAGE ID NUMBER (MOL2EP1)        18140000
*  WORK5 - WILL INDICATE WHICH FORM OF THE IKJEGSIO MACRO TO USE        18150000
*  WORK6 - WILL CONTAIN FIRST LEVEL MESSAGE ID NUMBER (M0L1P1)          18160000
**********************************************************************  18170000
**********************************************************************  18180000
NOFIND20 MVC   N0(N4,WORK1),INSRTLEN        MOVE LENGTH INDIC TO INSERT 18190000
         MVC   N4(N8,WORK1),LOADNAME        LOADNAME TO INSERT          18200000
         MVI   N12(WORK1),V40               BLANK AT END OF INSERT      18210000
         L     WORK2,M0L2EP1                GET SECOND LEVEL MESG ID #  18220000
         LA    WORK5,N1                     USE FIRST FJORM OF MACRO    18230000
         L     WORK6,M0L1P1                 GET FIRST LEVEL MESG ID #   18240000
         B     DOPRINT                      GO PRINT MESSAGE            18250000
         SPACE                                                          18260000
**********************************************************************  18270000
*  WORK1 - WILL POINT TO AN INSERT WHICH CONTAINS THE PSYMBOL           18280000
*  WORK2 - WILL CONTAIN SECOND LEVEL MESSAGE ID NUMBER (M0L2FP1)        18290000
*  WORK3 - WILL POINT TO AN INSERT WHICH CONTAINS THE LOADNAME          18300000
*  WORK4 - WILL POINT TO AN INSERT WHICH CONTAINS THE ENTRYNAM          18310000
*  WORK5 - WILL INDICATE WHICH FORM OF THE IKJEGSIO MACRO TO USE        18320000
*  WORK6 - WILL CONTAIN FIRST LEVEL MESSAGE ID NUMBER (M0L1P1)          18330000
**********************************************************************  18340000
NOFIND24 DS    0H                                                       18350000
         LR    WORK3,WORK1                  GET POINTER TO WORKAREA     18360000
         MVC   N0(N4,WORK3),INSRTLEN        MOVE LENGTH INDIC TO INSERT 18370000
         MVC   N4(N8,WORK3),LOADNAME        LOADNAME TO INSERT          18380000
         MVI   N12(WORK1),V40               BLANK AT END OF INSERT      18390000
         LA    WORK1,N13(WORK3)             GET POINTER TO NEXT INSERT  18400000
         MVC   N0(N4,WORK1),INSRTLEN        MOVE LENGTH INDIC TO INSERT 18410000
         MVC   N4(N8,WORK1),PSYMBOL         PSYMBOL TO INSERT           18420000
         MVI   N12(WORK1),V40               BLANK AT END OF INSERT      18430000
         LA    WORK4,N13(WORK1)             GET POINTER TO NEXT INSERT  18440000
         MVC   N0(N4,WORK4),INSRTLEN        MOVE LENGTH INDIC TO INSERT 18450000
         MVC   N4(N8,WORK4),ENTRYNAM        PSYMBOL TO INSERT           18460000
         MVI   N12(WORK4),V40               BLANK AT END OF INSERT      18470000
         L     WORK2,M0L2FP1                GETSECOND LEVEL MESG ID #   18480000
         LA    WORK5,N3                     USE THIRD FORM OF MACRO     18490000
         L     WORK2,M0L2FP1                GETSECOND LEVEL MESG ID #   18500000
         L     WORK6,M0L1P1                 GET FIRST LEVEL MESG ID #   18510000
         B     DOPRINT                      GO PRINT MESSAGE            18520000
         SPACE                                                          18530000
**********************************************************************  18540000
*  WORK1 - WILL POINT TO AN INSERT WHICH CONTAINS THE PSYMBOL           18550000
*  WORK2 - WILL CONTAIN SECOND LEVEL MESSAGE ID NUMBER (M0L2FP1)        18560000
*  WORK3 - WILL POINT TO AN INSERT WHICH CONTAINS THE DSECT NAME        18570000
*  WORK5 - WILL INDICATE WHICH FORM OF THE IKJEGSIO MACRO TO USE        18580000
*  WORK6 - WILL CONTAIN FIRST LEVEL MESSAGE ID NUMBER (M0L1P1)          18590000
**********************************************************************  18600000
NOFIND28 MVC   N0(N4,WORK1),INSRTLEN        MOVE LENGTH INDIC TO INSERT 18610000
         MVC   N4(N8,WORK1),PSYMBOL         PSYMBOL TO INSERT           18620000
         MVI   N12(WORK1),V40               BLANK AT END OF INSERT      18630000
         LA    WORK3,N13(WORK1)             NEXT INSERT POSITION        18640000
         MVC   N0(N4,WORK3),INSRTLEN        MOVE LENGTH INDIC TO INSERT 18650000
         MVC   N4(N8,WORK3),WAREA1          DSECT NAME TO INSERT        18660000
         MVI   N12(WORK3),V40               BLANK AT END OF INSERT      18670000
         L     WORK2,M0L2GP2                ID # OF SECOND LEVEL MESG   18680000
         LA    WORK5,N2                     USE SECOND FORM OF MACRO    18690000
         L     WORK6,M0L1P1                 ID # OF FIRST LEVEL MESG    18700000
         B     DOPRINT                      GO PRINT MESSAGE            18710000
         SPACE                                                          18720000
**********************************************************************  18730000
*  WORK1 - WILL POINT TO AN INSERT WHICH CONTAINS THE ENTRYNAM          18740000
*  WORK2 - WILL CONTAIN SECOND LEVEL MESSAGE ID NUMBER (M0L2HP1)        18750000
*  WORK3 - WILL POINT TO AN INSERT WHICH CONTAINS THE LOADNAME          18760000
*  WORK5 - WILL INDICATE WHICH FORM OF THE MACRO IKJEGSIO TO USE        18770000
*  WORK6 - WILL CONTAIN FIRST LEVEL MESSAGE ID NUMBER (M0L1P1)          18780000
**********************************************************************  18790000
NOFIND32 MVC   N0(N4,WORK1),INSRTLEN        MOVE LENGTH INDIC TO INSERT 18800000
         MVC   N4(N8,WORK1),ENTRYNAM        ENTRYNAM TO INSERT          18810000
         MVI   N12(WORK1),V40               BLANK AT END OF INSERT      18820000
         LA    WORK3,N13(WORK1)             NEXT INSERT POSITION        18830000
         MVC   N0(N4,WORK3),INSRTLEN        MOVE LENGTH INDIC TO INSERT 18840000
         MVC   N4(N8,WORK3),LOADNAME        LOADNAME TO INSERT          18850000
         MVI   N12(WORK3),V40               BLANK AT END OF INSERT      18860000
         L     WORK2,M0L2HP1                ID OF SECOND LEVEL MESG     18870000
         LA    WORK5,N2                     USE SECOND FORM OF MACRO    18880000
         L     WORK6,M0L1P1                 ID OF FIRST LEVEL MESG      18890000
         B     DOPRINT                      GO PRINT MESSAGE            18900000
         SPACE                                                          18910000
**********************************************************************  18920000
*  WORK1 - WILL POINT TO AN INSERT WHICH CONTAINS THE ENTRYNAM          18930000
*  WORK2 - WILL CONTAIN SECOND LEVEL MESSAGE ID NUMBER (M0L2IP1)        18940000
*  WORK5 - WILL INDICATE WHICH FORM OF THE MACRO, IKJEGSIO, TO USE      18950000
*  WORK6 - WILL CONTAIN FIRST LEVEL MESSAGE ID NUMBER (M0L1P1)          18960000
**********************************************************************  18970000
NOFIND36 MVC   N0(N4,WORK1),INSRTLEN        MOVE LENGTH INDIC TO INSERT 18980000
         MVC   N4(N8,WORK1),ENTRYNAM        ENTRYNAM TO INSERT          18990000
         MVI   N12(WORK1),V40               BLANK AT END OF INSERT      19000000
         L     WORK2,M0L2IP1                ID # OF SECOND LEVEL MESG   19010000
         LA    WORK5,N1                     USE FIRTST FORM OF MACRO    19020000
         L     WORK6,M0L1P1                 ID # OF FIRST LEVEL MESG    19030000
         B     DOPRINT                      GO PRINT MESSAGE            19040000
         SPACE                                                          19050000
**********************************************************************  19060000
*  WORK1 - WILL POINT TO AN INSERT WHICH CONTAINS THE LOADNAME          19070000
*  WORK2 - WILL CONTAIN SECOND LEVEL MESSAGE ID NUMBER (M0L2JP1)        19080000
*  WORK3 - WILL POINT TO AN INSERT WHICH CONTAINS THE ENTRYNAM          19090000
*  WORK5 - WILL INDICATE WHICH FORM OF THE MACRO IKJEGSIO TO USE        19100000
*  WORK6 - WILL CONTAIN THE FIRST LEVEL MESSAGE ID NUMBER (M0L1P1)      19110000
**********************************************************************  19120000
NOFIND40 MVC   N0(N4,WORK1),INSRTLEN        MOVE LENGTH INDIC TO INSERT 19130000
         MVC   N4(N8,WORK1),LOADNAME        LOADNAME TO INSERT          19140000
         MVI   N12(WORK1),V40               BLANK AT END OF INSERT      19150000
         LA    WORK3,N13(WORK1)             NEXT INSERT POSITION        19160000
         MVC   N0(N4,WORK3),INSRTLEN        MOVE LENGTH INDIC TO INSERT 19170000
         MVC   N4(N8,WORK3),ENTRYNAM        ENTRYNAM TO INSERT          19180000
         MVI   N12(WORK1),V40               BLANK AT END OF INSERT      19190000
         L     WORK2,M0L2JP1                ID # OF SECOND LEVEL MESG   19200000
         LA    WORK5,N2                     USE SECOND FORM OF MACRO    19210000
         L     WORK6,M0L1P1                 ID # OF FIRST LEVEL MESG    19220000
         B     DOPRINT                      GO PRINT MESSAGE            19230000
         SPACE                                                          19240000
**********************************************************************  19250000
*  WORK1 - WILL POINT TO AN INSERT WHICH CONTAINS THE LOADNAME          19260000
*  WORK2 - WILL CONTAIN SECOND LEVEL MESSAGE ID NUMBER (M0L2KP1)        19270000
*  WORK5 - WILL INDICATE WHICH FORM OF THE MACRO, IKJEGSIO, TO USE      19280000
*  WORK6 - WILL CONTAIN FIRST LEVEL MESSAGE ID NUMBER (M0L1P1)          19290000
**********************************************************************  19300000
NOFIND44 MVC   N0(N4,WORK1),INSRTLEN        MOVE LENGTH INDIC TO INSERT 19310000
         MVC   N4(N8,WORK1),LOADNAME        LOADNAME TO INSERT          19320000
         MVI   N12(WORK1),V40               BLANK AT END OF INSERT      19330000
         L     WORK2,M0L2KP1                ID # OF SECOND LEVEL MESG   19340000
         LA    WORK5,N1                     USE FIRST FORM OF MACRO     19350000
         L     WORK6,M0L1P1                 ID # OF FIRST LEVEL MESG    19360000
         B     DOPRINT                      GO PRINT MESSAGE            19370000
*                                                                       19380000
*        MESSAGE   IKJ57281I                                            19390000
*                                                                       19400000
         SPACE                                                          19410000
**********************************************************************  19420000
*  WORK2 - WILL CONTAIN SECOND LEVEL MESSAGE ID NUMBER (M2L2AP1)        19430000
*  WORK5 - WILL INDICATE WHICH FORM OF THE IKJEGSIO MACRO TO USE        19440000
*  WORK6 - WILL CONTAIN FISRT LEVEL MESSAGE ID NUMBER (M1L211)          19450000
**********************************************************************  19460000
NOTABLE  EQU   *                                                        19470000
         BAL   RETURN,MSGRT1                GO SET UP FOR MESSAGES      19480000
         L     WORK2,M1L2BP1                ID # OF 2ND LEVEL MESSAGE   19490000
         L     WORK6,M1L1P1                 ID # OF 1ST LEVEL MESSAGE   19500000
*                                                                       19510000
*        SECOND LEVEL FOR IKJ57281I                                     19520000
*                                                                       19530000
         B     M1GETSEC(WORK5)              GO GET PROPER SECOND LEVEL  19540000
M1GETSEC B     CODEONLY                     GO GIVE RET CODE ONLY       19550000
         B     SYSERR04                     ERROR CODE 04, MESG M1L2B   19560000
         SPACE                                                          19570000
**********************************************************************  19580000
*  WORK1 - WILL POINT TO AN INSERT WHICH CONTAINS THE DDNAME            19590000
*  WORK2 - WILL CONTAIN SECOND LEVEL MESSAGE ID NUMBER (PRESET)         19600000
*  WORK5 - WILL INDICATE WHICH FORM OF THE MACRO, IKJEGSIO, TO USE      19610000
*  WORK6 - WILL CONTAIN FIRST LEVEL MESSAGE ID NUMBER (M0L1P1)          19620000
**********************************************************************  19630000
SYSERR04 MVC   N0(N4,WORK1),INSRTLEN        INSERT LENGTH INDIC TO MESG 19640000
         MVC   N4(N8,WORK1),DDNAME          DDNAME TO MESSAGE           19650000
         LA    WORK5,N1                     INDICATE 1ST MACRO FORM     19660000
         B     DOPRINT                      GO PRINT MESSAGE            19670000
*                                                                       19680000
*        SUB ROUTINES FOR MESSAGE BUILDING                              19690000
*                                                                       19700000
MSGRT1   EQU   *                                                        19710000
         LR    WORK4,PARMREG1               RETURN CODE FOR CALLER      19720000
         STC   WORK4,WAREA3                 SAVE RETURN CODE            19730000
         LR    WORK5,RETCODE                SECOND LEVEL MESSAGE NUMBER 19740000
         TM    TSTFLGS3,SYMMESG             SHOULD WE PRINT A MESSAGE   19750000
         BO    CODEONLY                     NO, GO GIVE RETURN CODE     19760000
         LTR   RETCODE,RETCODE              IS UNRESOLVED RETURN CODE 0 19770000
         BZ    CODEONLY                     YES, GO GIVE RETURN CODE    19780000
         LA    WORK1,BUFFER                 ADDR OF FIRST LEVEL BUFFER  19790000
         BR    RETURN                       RETURN TO CALLER            19800000
MSGRT2   EQU   *                                                        19810000
         ST    RETURN,MSGRT214              SAVE RETURN ADDRESS         19820000
         LA    PARMREG1,N0(WORK1,WORK2)     NEXT LOCATION IN BUFFER     19830000
         LR    PARMREG0,PDEB                POINTER TO ADDRESS PDE      19840000
         L     RETCODE,TSTADDR              PTR TO ADDRESS BUILD RT     19850000
         BALR  RETURN,RETCODE               GO ADD ADDRESS TO MESSAGE   19860000
         AR    WORK2,PARMREG0               LENGTH OF MESSAGE, SO FAR   19870000
         L     RETURN,MSGRT214              RETURN ADDRESS              19880000
         BR    RETURN                       RETURN TO CALLER            19890000
MSGRT3   EQU   *                                                        19900000
         SLL   WORK2,N16                    LL00 FIELD FOR FIRST LEV    19910000
         ST    WORK2,BUFFER                 PREFIX MESG WITH LL00 FIELD 19920000
         LA    WORK1,MIDBUFF                ADDR OF SECOND LEVEL BUFFER 19930000
         MVC   N4(N10,WORK1),N0(WORK3)      MESG ID FOR SECOND LEVEL    19940000
         LA    WORK2,N14                    LENGTH OF SECOND LEV SO FAR 19950000
         LA    WORK1,N0(WORK1,WORK2)        NEXT LOATION IN BUFFER      19960000
         BR    RETURN                       RETURN TO CALLER            19970000
*                                                                       19980000
*        PUT OUT MESSAGE                                                19990000
*                                                                       20000000
DOPRINT  EQU   *                                                        20010000
         BAL   RETURN,TERMIO                GO PUT MESG TO TERMINAL     20020000
CODEONLY EQU   *                                                        20030000
         SR    RETCODE,RETCODE              CLEAR FOR RETURN CODE       20040000
         IC    RETCODE,WAREA3               RETURN CODE FOR CALLER      20050000
         B     TOCALLER                     GO BACK                     20060000
         SPACE 2                                                        20070000
*********************************************************************** 20080000
*                                                                     * 20090000
*        THIS IS THE SYNAD ROUTINE FOR READING SECONDARY  STORAGE.    * 20100000
*        THE SYNADAF ROUTINE IS USED TO OBTAIN A SYSTEM INFO MESG.    * 20110000
*        THE SYNAD ROUTINE WILL CHECK FOR AN ATTEMPT TO READ A RECORD * 20120000
*        GREATER THAN 256 BYTES.  SUCH A RECORD WOULD IMPLY THE END   * 20130000
*        OF CESD RECORDS AND WOULD NOT BE A REAL I/O ERROR            * 20140000
*                                                                     * 20150000
*********************************************************************** 20160000
         SPACE 2                                                        20170000
SYMSYNAD EQU   *                                                        20180000
         L     SYMB2,SECENTRY               ESTABLISH ADDRESSABILITY    20190000
         SYNADAF   ACSMETH=BPAM                                         20200000
         LR    WORK2,SYMWKB                 SAVE ADDR OF SYNADAF SAVE   20210000
         L     SYMWKB,N4(SYMWKB)            ADDRESS OF MY WORK AREA     20220000
         LA    WORK1,MIDBUFF                ADDR OF SECOND LEVEL BUFFER 20230000
         MVC   N0(N4,WORK1),LENGTH45        INSERT LENGTH INDICATOR     20240000
         MVC   N50(N4,WORK1),LENGTH45        INSERT LENGTH INDICATOR    20250000
         MVC   N4(N45,WORK1),N38(PARMREG1)  SYNADAF MESG TO BUFFER      20260000
         MVC   N54(N45,WORK1),N83(PARMREG1)  SYNADAF MESG TO BUFFER     20270000
         LR    SYMWKB,WORK2                 RESTORE SYNADAF SAVE PTR    20280000
         SYNADRLS                                                       20290000
         LA    PARMREG1,CLOSELST            ADDR OF LIST FORM OF CLOSE  20300000
         LA    WORK1,PDSDCB                 ADDR OF DCB TO CLOSE        20310000
         CLOSE ((WORK1)),MF=(E,(PARMREG1))                              20320000
         LA    WORK1,MIDBUFF                ADDR OF SECOND LEV BUFFER   20330000
         CLC   WLENRCD(N15),N53(WORK1)      IS ERR WRONG LEN RECORD     20340000
         BNE   GIVEMESG                     NO, GO GIVE I/O ERROR MESG  20350000
         LA    RETCODE,N32                  ENTRYNAME NOT IN CESD RCDS  20360000
         B     NOFIND                       ERROR, NO MORE CESD RCDS    20370000
         SPACE                                                          20380000
*********************************************************************** 20390000
*      WORK2 - CONTAINS THE SECOND LEVEL MESSAGE ID #                 * 20400000
*********************************************************************** 20410000
GIVEMESG EQU   *                                                        20420000
         L     WORK2,M1L2AP1                GET 2ND LEVEL MSG ID #      20430000
         LA    WORK2,N50(WORK1)             POINT TO 2ND INSERT         20440000
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR MSG AREA             20450000
         IKJEGSIO MSG,FIRST=M0029,INST11=(APDE,(PDEB)),SECOND=M0237,   *20460000
               INST21=(ADDR,WORK1),INST22=(ADDR,WORK2),                *20470000
               ID=SYM30,MF=(E,TSTIOPRM)                                 20480000
         LA    RETCODE,N12                  IO ERR, RET CODE=12, GO     20500000
         B     TOCALLER                     RETURN TO CALLER            20510000
PRINT3   DS    0H                                                       20520000
         LR    WORK1,RETURN                 RESTORE REG WORK1           20530000
         B     MACRO(WORK5)                 GO TO PROPER MACRO FORM     20540000
MACRO    B     MAC                       0= GO TO FIRST FORM OF MACRO   20550000
MAC      B     MACRO1                    1= GO TO FIRST FORM OF MACRO   20560000
         B     MACRO2                    2= GO TO SECOND FORM OF MACRO  20570000
         B     MACRO3                    3= GO TO THIRD FORM OF MACRO   20580000
         B     MACRO4                    4= GO TO FOURTH FORM OF MACRO  20590000
         B     SVCERR1                   5= GO TO FIFTH FORM OF MACRO   20600000
         B     SVCERR2                   6= GO TO SIXTH FORM OF MACRO   20610000
**********************************************************************  20620000
*  WORK1 - WILL POINT TO AN INSERT                                      20630000
*  WORK2 - WILL CONTAIN SECOND LEVEL MESSAGE ID NUMBER (M0L2AP1)        20640000
*  WORK5 - WILL INDICATE THIS FORM OF THE IKJEGSIO MACRO IS TO BE USED  20650000
*  WORK6 - WILL CONTAIN FIRST LEVEL MESSAGE ID NUMBER (M0L1P1)          20660000
**********************************************************************  20670000
MACRO1   DS    0H                          ONE 2ND LEVEL INSERT         20680000
         IKJEGSIO MSG,FIRST=(WORK6),INST11=(APDE,(PDEB)),              *20690000
               SECOND=(WORK2),INST21=(ADDR,(WORK1)),ID=SYM30,          *20700000
               MF=(E,TSTIOPRM)                                          20710000
         B     CHECKIO                   GO CHECK IO RETURN CODE        20720000
**********************************************************************  20730000
*  WORK1 - POINTS TO AN INSERT                                          20740000
*  WORK2 - CONTAINS SECOND LEVEL MESSAGE ID NUMBER                      20750000
*  WORK3 - POINTS TO AN INSERT                                          20760000
*  WORK5 - INDICATES SECOND FORM OF THE IKJEGSIO MACRO IS TO BE USED    20770000
*  WORK6 - CONTAINS FIRST LEVEL MESSAGE ID NUMBER                       20780000
**********************************************************************  20790000
MACRO2   DS    0H                        TWO 2ND LEVEL INSERTS          20800000
         IKJEGSIO MSG,FIRST=(WORK6),INST11=(APDE,(PDEB)),              *20810000
               SECOND=(WORK2),INST21=(ADDR,(WORK1)),                   *20820000
               INST22=(ADDR,(WORK3)),ID=SYM30,MF=(E,TSTIOPRM)           20830000
         B     CHECKIO                   GO CHECK IO RETURN CODE        20840000
**********************************************************************  20850000
*  WORK1 - POINTS TO AN INSERT                                          20860000
*  WORK2 - CONTAINS SECOND LEVEL MESSAGE ID NUMBER                      20870000
*  WORK3 - POINTS TO AN INSERT                                          20880000
*  WORK4 - POINTS TO AN INSERT                                          20890000
*  WORK5 - INDICATES THIRD FORM OF THE IKJEGSIO MACRO IS TO BE USED     20900000
*  WORK6 - CONTAINS FIRST LEVEL MESSAGE ID NUMBER                       20910000
**********************************************************************  20920000
MACRO3   DS    0H                          THREE 2ND LEVEL INSERTS      20930000
         IKJEGSIO MSG,FIRST=(WORK6),INST11=(APDE,(PDEB)),              *20940000
               SECOND=(WORK2),INST21=(ADDR,(WORK1)),                   *20950000
               INST22=(ADDR,(WORK3)),INST23=(ADDR,(WORK4)),            *20960000
               ID=SYM30,MF=(E,TSTIOPRM)                                 20970000
         B     CHECKIO                   GO CHECK IO RETURN CODE        20980000
MACRO4   DS    0H                           NO 2ND LEVEL INSERT         20990000
         IKJEGSIO MSG,FIRST=(WORK6),SECOND=(WORK2),ID=SYM30,           *21000000
               MF=(E,TSTIOPRM)                                          21010000
CHECKIO  LA    WORK1,N16                    ATTENTION RETURN CODE       21020000
         CR    RETCODE,WORK1                ATTENTION OR ABEND RET CODE 21030000
         BNL   TOCALLER                     YES, GO PASS IT TO CALLER   21040000
         L     RETURN,TERMIO14              RETURN ADDRESS              21050000
         BR    RETURN                       RETURN TO CALLER            21060000
         SPACE 2                                                        21070000
*********************************************************************** 21080000
* INPUT -                                                               21090000
* WORK5 - WILL INDICATE WHICH FORM OF MACRO TO USE                      21100000
* RETCODE - WILL CONTAIN MACRO RETURN CODE                              21110000
* PARMREG0 - WILL CONTAIN ABEND CODE FROM LINK MACRO IF APPLICABLE      21120000
*********************************************************************** 21130000
SVCERR1  EQU   *                                                        21140000
         LR    WORK1,PARMREG0               TRANSFER CONTENT OF REG0    21150000
         LR    WORK3,RETCODE                TRANSFER CONTENT OF REG15   21160000
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO AREA              21170000
         SPACE 2                                                        21180000
GETFRERR IKJEGSIO SVCERR,SVC=(WORK2),RC=(WORK3),ID=SYM30,              *21190000
               MF=(E,TSTIOPRM)                                          21200000
         B     CHECKIO                                                  21210000
SVCERR2  EQU   *                                                        21220000
         LR    WORK1,PARMREG0               TRANSFER CONTENT OF REG0    21230000
         LR    WORK3,RETCODE                TRANSFER CONTENT OF REG15   21240000
         XC    TSTIOPRM(L'TSTIOPRM),TSTIOPRM CLEAR IO AREA              21250000
LINKERR  IKJEGSIO SVCERR,SVC=(WORK2),ABENDRG=(WORK1),RC=(WORK3),       *21260000
               INST11=(NUM,I0035),ID=SYM30,MF=(E,TSTIOPRM)              21270000
         B     CHECKIO                      GO CHECK IO RETURN CODES    21280000
         SPACE 3                                                        21290000
********************************************************************    21300000
***  *****    THIS IS THE DAIR ERROR ANALYSIS ROUTINE  *********        21310000
********************************************************************    21320000
DAIRERR  DS    0H                                                       21330000
         L     WORK2,WORKAREA   ACCESS WORKAREA PTR                     21340000
         USING TSTCWORK,WORK2 ESTABLISH BASE FOR WORKAREA               21350000
         XC    CWORKSYM(N32),CWORKSYM ZERO WORKAREA                     21360000
         ST    RETCODE,DAIRRC-TSTCWORK(WORK2) STORE RC IN WORKAREA      21370000
         LA    PARMREG1,DAIRRC-TSTCWORK(WORK2) R1=ADDR OF RET CODE      21380000
         ST    PARMREG1,DAIRCPTR-TSTCWORK(WORK2) 2ND WORD OF PARAM LIST 21390000
         LA    PARMREG1,N1         SET UP CALLER ID                     21400000
         STH   PARMREG1,CALLERID-TSTCWORK(WORK2) STORE IN WORK AREA     21410000
         LA    PARMREG1,CALLERID-TSTCWORK(WORK2) R1=ADDR OF CALLER ID   21420000
         ST    PARMREG1,IDPTR-TSTCWORK(WORK2)   4TH WORD OF PARAM LIST  21430000
         L     PARMREG1,ADAIRCOR GET DAPL POINTER                       21440000
         ST    PARMREG1,DAPLPTR-TSTCWORK(WORK2) 1ST WORD OF PARAM LIST  21450000
         LA    PARMREG1,MSGENTPT-TSTCWORK(WORK2) SET UP MSG WRITER ENT  21460000
         ST    PARMREG1,MENTPTR-TSTCWORK(WORK2) STORE IN THIRD WORD     21470000
         LA    PARMREG1,CWORKSYM      POINT TO PARAMETER LIST           21480000
         LINK  EP=IKJEFF18,ERRET=LINKERR1 LINK TO DAIRFAIL              21490000
         LA    RETCODE,N8     INDICATE SYMBOL CAN BE RESOLVED           21500000
         B     TOCALLER      RETURN TO CALLER                           21510000
         SPACE 4                                                        21520000
*********************************************************************** 21530000
*                                                                     * 21540000
*        CONSTANTS                                                    * 21550000
*                                                                     * 21560000
*********************************************************************** 21570000
         SPACE 2                                                        21580000
         DS    0F                                                       21590000
INSRTLEN DC    X'000D0000'   LENGTH INDICATOR FOR 13 CHARACTER INSERTS  21600000
         SPACE 2                                                        21610000
         DS    0F                                                       21620000
LENGTH45 DC    X'003D0000'   LENGTH INDICATOR FOR 45 CHARACTER INSERTS  21630000
         SPACE 2                                                        21640000
BPAMDCB  DCB   DSORG=PO,MACRF=(R),RECFM=U,BLKSIZE=N256,                C21650000
               SYNAD=SYMSYNAD                                           21660000
ENDBPAM  EQU   *                                                        21670000
         READ  SSDECB,SF,,,'S',,,MF=L                                   21680000
ENDSDECB EQU   *                                                        21690000
LFSTAE   DS    0F                                                       21700000
         ESTAE MF=L                                                     21710000
ELFSTAE  EQU   *                                                        21720000
LFOPEN   OPEN  (,),MF=L                                                 21730000
ELFOPEN  EQU   *                                                        21740000
LFCLOSE  CLOSE (,),MF=L                                                 21750000
ELFCLOSE EQU   *                                                        21760000
LFGET    GETMAIN   MF=L                                                 21770000
ELFGET   EQU   *                                                        21780000
         SPACE 3                                                        21790000
         EJECT                                                          21800000
         SPACE                                                          21810000
*********************************************************************** 21820000
* THIS SECTION OF IKJEGSYM CONTAINS THE ERROR MESSAGE NUMBERS.        * 21830000
* MESSAGES RESIDE IN THE TSO TEST MESSAGE CSECT IN THE IO MODULE      * 21840000
* (IKJEGIO).  PERTINENT SYMBOLIC NAMES ARE ADDED VIA INSERTS THAT     * 21850000
* ARE CONTRUCTED IN THE WORKAREA NAMED 'BUFFER'.                      * 21860000
*                                                                     * 21870000
*********************************************************************** 21880000
         SPACE 2                                                        21890000
*                                                                       21900000
*        MESSAGE   IKJ57280I                                            21910000
*                                                                       21920000
M0L1P1   DC    F'028' ADDRESS NOT FOUND                                 21930000
M0L2AP1  DC    F'228' NOT FOUND UNDER THE TEST TASK STRUCTURE NO SYMB'S 21940000
M0L2BP1  DC    F'229' LOADED BY OS LOADER, INTERNAL SYMBOL UNAVAILABLE  21950000
M0L2CP1  DC    F'230' NOT BROUGHT TO MAIN STORAGE UNDER TEST NO SYMB'S  21960000
M0L2DP1  DC    F'231' LOADED BY OS LOADER, NOT ENOUGH MAIN              21970000
*                     STORAGE FOR EXTERNAL SYMBOLS                      21980000
M0L2EP1  DC    F'232' LINK EDITED WITHOUT TEST PARAMETER,               21990000
*                     INTERNAL SYMBOLS UNAVAILABLE                      22000000
M0L2FP1  DC    F'233' NOT IN INTERNAL SYMBOL TABLE FOR                  22010000
M0L2GP2  DC    F'294' FOUND IN DSECT                                    22020000
*                     FOR WHICH NO BASE ADDRESS EXISTS                  22030000
M0L2HP1  DC    F'295' NOT FOUND IN EXTERNAL SYMBOL TABLE FOR            22040000
M0L2IP1  DC    F'235' ASSEMBLED WITHOUT TEST PARAMETER,                 22050000
*                     INTERNAL SYMBOLS UNAVAILABLE                      22060000
M0L2JP1  DC    F'234' LINK EDITED IN OVERLAY,                           22070000
*                     NOT IN MAIN STORAGE                               22080000
M0L2KP1  DC    F'236' FROM DATASET IN A LINK LIBRARY LIST,              22090000
*                     SYMBOLS UNAVAILABLE                               22100000
*                                                                       22110000
*        MESSAGE   IKJ57281I                                            22120000
*                                                                       22130000
M1L1P1   DC    F'29'  SYMBOL                                            22140000
*                     AVAILABLE, SYSTEM ERROR+                          22150000
M1L2AP1  DC    F'237' I/O SYNAD ERROR                                   22160000
M1L2BP1  DC    F'238' CANNOT OPEN DATASET, DDNAME                       22170000
*                                                                       22180000
*        MESSAGE   IKJ57282I                                            22190000
*                                                                       22200000
NOCOREMG DC    F'30' NOT ENOUGH STORAGE TO USE SYMBOLS                  22210000
M2L2AP1  DC    F'239' ABSOLUTE OR RELATIVE ADDRESS MAY BE USED          22220000
         EJECT                                                          22230000
*                                                                       22240000
*        OTHER EQUATES                                                  22250000
*                                                                       22260000
LENDCB   EQU   ENDBPAM-BPAMDCB              LEN OF DCB                  22270000
LENDECB  EQU   ENDSDECB-SSDECB              LEN OF LIST FORM OF READ    22280000
LENSTAE  EQU   ELFSTAE-LFSTAE               LEN OF LIST FORM OF ESTAE   22290000
LENOPEN  EQU   ELFOPEN-LFOPEN               LEN OF LIST FORM OF OPEN    22300000
LENCLOSE EQU   ELFCLOSE-LFCLOSE             LEN OF LIST FORM OF CLOSE   22310000
LENGET   EQU   ELFGET-LFGET                 LEN OF LIST FORM OF GETMAIN 22320000
         EJECT                                                          22330000
*********************************************************************** 22340000
*                                                                     * 22350000
*        DSECTS                                                       * 22360000
*                                                                     * 22370000
*********************************************************************** 22380000
         TCOMTAB                                                        22390000
         EJECT                                                          22400000
         TSTCWORK                                                       22410000
DAPLPTR  EQU   CWORKSYM        DAIR PARAMETER LIST PTR                  22420000
DAIRCPTR EQU   CWORKSYM+N4    DAIR RETURN CODE POINTER                  22430000
MENTPTR  EQU   CWORKSYM+N8    MSG WTR ENTRY POINT POINTER               22440000
IDPTR    EQU   CWORKSYM+N12   CALLER ID POINTER                         22450000
DAIRRC   EQU   CWORKSYM+N16   DAIR RETURN CODE                          22460000
MSGENTPT EQU   CWORKSYM+N20   MESSAGE WTR ENTRY POINT                   22470000
CALLERID EQU   CWORKSYM+N24   CALLER ID                                 22480000
         EJECT                                                          22490000
         IKJPARMA       THIS DSECT DESCRIBES THE PASSED PDE CONTAIN-    22500000
*                       ING THE ACCEPTED ARGUMENTS                      22510000
*                                                                       22520000
         SPACE 2                                                        22530000
INFOBLK  DSECT     ,    THIS DSECT DESCRIBES THE INFO BLOCK BUILT TO    22540000
*                       REFLECT THE REQUEST AND INFO KNOWN ABOUT THE    22550000
*                       MODULE                                          22560000
*                                                                       22570000
LOADNAME DS    D             LOADNAME                                   22580000
ENTRYNAM DS    D             ENTRYNAME                                  22590000
DDNAME   DS    D             DDNAME FROM TT SVC OR BLANKS               22600000
LOADNAMA DS    A             LOADNAME MAIN STORAGE ADDRESS              22610000
ENTRNAMD DS    A             ENTRYNAME DISPLACEMENT INTO MODULE         22620000
MODSWS   DS    X             SWITCHES REFLECTING MOULE PASSED           22630000
*                                BIT 0  IF 0 - OBJECT MODULE            22640000
*                                       IF 1 - LOAD MODULE              22650000
*                                BTI 1  IF 0 - NO ENTRYNAME DISPL       22660000
*                                       IF 1 - ENTRYNAME DISPL PRESENT  22670000
*                                BIT 2  IF 0 - NO OS LOADER CESD INFO   22680000
*                                       IF 1 - OS LOADER CESD INFO      22690000
*                                BIT 3  IF 1 - SVC 61 HAS OPERATED      22700000
*                                       IF 0 - SVC 61 DID NOT OPERATE   22710000
*                                BIT 4  IF 1 - LMOD CESD TTR AVALIABLE  22720000
*                                       IF 0 - CESD TTR NOT AVALIABLE   22730000
*                                BIT 5  IF 1 - DDNAME PRESENT           22740000
*                                       IF 0 - LMOD IN SYS1.LINKLIB     22750000
POINTER  DS    F             OBJ-ADDR OF CESD, LOAD-TTR OF SYMBOLS      22760000
CESDTTR  DS    F             LOAD-TTR OF FIRST CESD RCD,                22770000
*                             OBJ-LENGTH OF CESD INFO                   22780000
ATTRIBUT DS    F             LOAD MODULE ATTRIBUTES OR ZERO             22790000
BASEFSYM DS    A             MAIN STORAGE ADDRESS TO ADD SYM DISPL TO   22800000
TCBADDR  DS    F             ADDRESS OF TCB LOADNAME HUNG OFF OF        22810000
         SPACE 2                                                        22820000
SYMINFO  DSECT     ,    THIS DSECT DESCRIBES THE ANSWER BLOCK BUILT     22830000
*                       BY SYM FOR A REQUEST FOR A SYMBOL               22840000
*                                                                       22850000
ZERO1    DS    X             ONE BYTE EQUAL TO ZEROES                   22860000
LOADEDAD DS    AL3           MAIN STORAGE ADDR OF SYMBOL                22870000
TYPE     DS    X             TYPE OF DATA AT THIS LOCATION              22880000
MULTIPLT DS    3X            MULTIPLICITY FACTOR                        22890000
LENGTH   DS    H             LENGTH OF STORAGE RESERVED                 22900000
RESERVD1 DS    H             RESERVED                                   22910000
NEXTANSB DS    F             ADDRESS OF NEXT ANSWER BLOCK               22920000
         SPACE 2                                                        22930000
INCORE   DSECT     ,    THIS DSECT DESCRIBES THE INCORE SYMBOL TABLE    22940000
*                                                                       22950000
NXINCORE DS    F             ADDRESS OF NEXT SYMBOL IN INCORE SYM TABLE 22960000
ZERO2    DS    X             ONE BYTE OF ZEROES                         22970000
LADDRESS DS    AL3           MAIN STORAGE ADDRESS OF SYMBOL             22980000
INCTYPE  DS    X             TYPE OF DATA AT THIS LOCATION              22990000
MULTIPCY DS    3X            MULTIPLICITY FACTOR                        23000000
SIZEFILD DS    H             LENGTH OF STORAGE RESERVED                 23010000
LENSYM   DS    H             NO. BYTES IN SYMBOL NAME                   23020000
INSYM    DS    2F            SYMBOL NAME                                23030000
         SPACE 2                                                        23040000
SVCINFO  DSECT     ,    THIS DSECT DESCRIBES THE INFO BLKS BUILT BY     23050000
*                       THE TESTRAN SVC 61 (IN DEC)                     23060000
*                                                                       23070000
LMODNAME DS    D             NAME OF MEMBER                             23080000
LMLADDR  DS    F             MAIN STORAGE ADDRESS WHERE LOADED          23090000
BEGTTR   DS    F             TTR OF BEGINNING OF MEMBER                 23100000
LMATTRIB DS    H             ATTRIBUTES FOR MEMBER                      23110000
LMFLAGS  DS    X             FLAGS REFLECTING CONTENTS OF SVCINFO BLOCK 23120000
*                                 BIT 0 DDNAME PRESENT                  23130000
*                                 BIT 1 DATASET IS SYS1.LINKLIB         23140000
CONCATNO DS    X             CONCATENATION NO. OF PDS                   23150000
LMDDNAME DS    2F            DDNAME FOR PDS CONTAINING MEMBER           23160000
LMTCB    DS    F             ADDRESS OF TCB LOADNAME HUNG OFF OF        23170000
NEXTBLK  DS    A             ADDR OF NEXT SVC SAVED INFO BLOCK          23180000
         SPACE 2                                                        23190000
SYMWORK  DSECT     ,    THIS DSECT DESCRIBES THE GOTTEN WORK AREA       23200000
*                                                                       23210000
MYSAVE   DS    18F           IKJEGSYM SAVE AREA                         23220000
PDSDCBA  DS    A             CONTAINS ADDR OF DCB FOR  READING SYMS     23230000
CINFOBKA DS    A             CONTAINS ADDR OF CURRENT INFO BLOCK        23240000
TINFOBKA DS    A             CONTAINS ADDR OF TEMPORARY INFO BLOCK      23250000
BUFFERA  DS    A             CONTAINS ADDR OF BUFFER                    23260000
WHATPASS DS    X             REFLECTION OF ARGUEMENT AND WHAT PASSED    23270000
*                                 BIT  0    LOADNAME                    23280000
*                                      1    ENTRYNAME                   23290000
*                                      2    SYMBOL                      23300000
*                                      3    OFFSET                      23310000
*                                      4    LOADNAME PASSED             23320000
*                                      5    ENTRYNAME PASSED            23330000
*                                      6    SYMBOL PASSED               23340000
*                                      7    OFFSET PASSED               23350000
SWSA     DS    X             SWITHCES USED DURING ANALYST OF SYM RCDS   23360000
*                                 BIT  0    LAST ENTRY CONTINUED        23370000
*                                      1    ANALYZE PRESENT ENTRY       23380000
*                                      2    SEARCHING A DSECT           23390000
*                                      3    SYMS AVAILABLE IN SYM RCDS  23400000
*                                           FOR THIS ENTRYNAME          23410000
SWSB     DS    X             CESD PROCESSING SWITCHS                    23420000
*                                 BIT  0    A CESD RCD HAS BEEN READ    23430000
*                                      1    SEARCH USING OFFSET         23440000
*                                      2    SEARCH USING ENTRYNAME      23450000
*                                      3    SEARCH FOR FIRST CSECT      23460000
SWSC     DS    X             UNIQUE SWITCHES                            23470000
*                                 BIT  0    DDNAME FOR LINKLIB KNOWN    23480000
*                                      1    STORAGE PARM LIST FOR DAIR  23490000
PDSDCB   DS    22F           BPAM DCB FOR READING SYMS                  23500000
STAELIST DS    4F            CONTAIN LIST FORM OF ESTAE MACRO           23510000
OPENLIST DS    2F            CONTAIN LIST FORM OF OPEN MACRO            23520000
CLOSELST DS    2F            CONTAINS LIST FORM OF CLOSE MACRO          23530000
LSTFREAD DS    6F            CONTAINS LIST FORM OF READ MACRO           23540000
OPENFDD  DS    2F            DDNAME DCB CURRENTLY OPENED FOR            23550000
CINFOBLK DS    16F           CURRENTLY QUALIFIED INFOBLK                23560000
TINFOBLK DS    16F           TEMPORARY INFOBLK FOR PRESENT REQUEST      23570000
BUFFER   DS    69F           READ SYM RCDS, BUILD ERROR MESGS           23580000
MIDBUFF  EQU   BUFFER+N100   MIDDLE OF BUFFER, ADDR OF 2ND LEV MESG     23590000
BASEADDR DS    F             BASE FOR IKJEGSYM CSECT                    23600000
WAREA1   DS    D             WORK AREA                                  23610000
WAREA2   DS    D             WORK AREA                                  23620000
WAREA3   DS    D             WORK AREA                                  23630000
ADAIRCOR DS    F             ADDRESS OF GOTTEN CORE FOR DAIR PARM LIST  23640000
PARTENTY DS    5F            POSSIBLE PART ENTRY SAVED BY SYM ANALYZIER 23650000
PENTRYLN DS    F             LEN OF POSSIBLE PART SYM ENTRY SAVED       23660000
PSYMBOL  DS    D             CONTAINS  SYMBOL THAT IS PASSED            23670000
POFFSET  DS    F             CONTAINS  OFFSET THAT IS PASSED            23680000
LINKLBDD DS    2F            IF KNOWN, CONTAINS A DDNAME FOR LINKLIB    23690000
WORKSAVE DS    3F            SAVE AREA FOR WORK REGISTERS               23700000
WKSAVE3  EQU   WORKSAVE+N8   WORK3 SAVE AREA                            23710000
WORKSAV2 DS    3F            INTERNAL ROUTINES SAVE AREA FOR WORK REGS  23720000
WKSAVE3A EQU   WORKSAV2+N8   THIRD WORD OF SAVE AREA            YA00074 23730000
CESD14   DS    F             SAVED RETURN ADDR DURING CESD PROCESSING   23740000
NOTE14   DS    F             SAVED RETURN ADDR DURING NOTE PROCESSING   23750000
TERMIO14 DS    F             RETURN ADDR FOR TERMIO PROCESSING          23760000
PART14   DS    F             RETURN ADDR FROM PART ENTRY PROCESSING     23770000
OPDCB14  DS    F             SAVED RETURN ADDR DURING DCB OPEN PROCESS  23780000
POINT14  DS    F             RETURN ADDRESS FOR POINT ROUTINE           23790000
READ14   DS    F             RETURN ADDRESS FOR READ ROUTINE            23800000
SVCBLK14 DS    F             RET ADDR FROM SVCINFO BLK SEARCH ROUTINE   23810000
MSGRT214 DS    F             RET ADDR FROM ADDR BUILD ROUTINE           23820000
ESYMWORK EQU   *          END OF SYMWORK DSECT                          23830000
         SPACE 2                                                        23840000
IHADCB   DCBD  DEVD=DA,DSORG=PO                                         23850000
         SPACE 4                                                        23860000
         IKJTPL                                                         23870000
         EJECT                                                          23880000
         IKJDAPL                                                        23890000
         SPACE 2                                                        23900000
         IKJDAP08                                                       23910000
         EJECT                                                          23920000
CVT      DSECT                                                          23930000
         CVT                                                            23940000
         EJECT                                                          23950000
         IHAXTLST                                                       23960000
         EJECT                                                          23970000
         IHACDE                                                         23980000
         EJECT                                                          23990000
         IKJTCB                                                         24000000
         EJECT                                                          24010000
         IKJRB                                                          24020000
         END                                                            24030000
./  ADD  SSI=33180125,NAME=IKJEGTCB
         TITLE 'IKJEGTCB, THE LISTTCB FUNCTION OF THE TEST COMMAND'     00060002
         COPY  IKJEGSIO                                                 00110002
IKJEGTCB CSECT                                                          00120002
*********************************************************************** 00180002
* STATUS                                                              * 00240002
*    CHANGE LEVEL 000, VERSION 02, OS/VS2                             * 00290002
*                                                                     * 00300002
* FUNCTION/OPERATION                                                  * 00360002
*    THIS SUBCOMMAND PROGRAM RECEIVES CONTROL FROM THE TEST SUBCOMMAND* 00420002
*    PROCESSOR.  IT DISPLAYS ALL OR PART OF THE PROBLEM PROGRAM TCB OR* 00480002
*    THE TCB AT A SPECIFIED ADDRESS.                                  * 00540002
*                                                                     * 00600002
* ENTRY POINTS                                                        * 00660002
*         IKJEGTCB - ENTERED FROM IKJEGMNL                            * 00720002
*         IKJEGVCK - ENTERED FROM IKJPARS                             * 00780002
*                                                                     * 00840002
* INPUT                                                               * 00900002
*    ONE LINE OF INPUT FROM THE TERMINAL CONTAINING THE SUBCOMMAND    * 00960002
*                                                                     * 01020002
* OUTPUT                                                              * 01080002
*    LINES OF OUTPUT TO THE TERMINAL CONTAINING DESCRIPTIVE HEADERS   * 01140002
*    AND THE REQUESTED TCB FIELDS                                     * 01200002
*                                                                     * 01260002
* EXTERNAL REFERENCES                                                 * 01320002
*         IKJPARS  - TO SCAN THE INPUT BUFFER                         * 01380002
*         IKJEGCVT - TO CHECK AND CONVERT THE ADDRESS, IF SPECIFIED   * 01440002
*    AND TO CONVERT THE TCB FIELDS TO PRINTABLE                       * 01500002
*         IKJEGIO  - TO OUTPUT THE HEADER AND TCB FIELDS              * 01560002
*         IKJEGBLD - TO BUILD AN ADDRESS STRING FOR A MESSAGE         * 01620002
*                                                                     * 01680002
* EXITS,NORMAL                                                        * 01740002
*                                                                     * 01800002
*         IKJPARS-VIA A BRANCH REGISTER 14 FROM IKJEGVCK WITH ONE OF  * 01860002
*    THE FOLLOWING RETURN CODES IN REGISTER 15-                       * 01920002
*    0  - INDICATING TO CONTINUE PROCESSING THE COMMAND BUFFER        * 01980002
*    8  - INDICATING IKJPARS SHOULD PROMPT WITH REENTER               * 02040002
*    12 - INDICATING IKJPARS SHOULD RETURN TO IKJEGTCB WITH A         * 02100002
*    *    RETURN CODE OF 20 IN REGISTER 15                            * 02160002
*                                                                     * 02220002
*         IKJEGMNL VIA REGISTER 14 WITH ONE OF THE FOLLOWING          * 02280002
*    RETURN CODES PASSED VIA REGISTER 15.                             * 02340002
*    0  - NORMAL RETURN                                               * 02400002
*    16 - INDICATING AN ATTENTION INTERRUPT WAS ENCOUNTERED           * 02460002
*                                                                     * 02520002
* EXITS,ERROR                                                         * 02580002
*         IKJEGMNL-VIA BRANCH REGISTER 14 WITH A RETURN CODE OF 20    * 02640002
*    IN REGISTER 15 INDICATING THE ESTAE RETRY ROUTINE WAS ENTERED.   * 02700002
*    A RETURN CODE OF 24 INDICATES THAT THE ESTAE COULD NOT BE ISSUED.* 02750002
*                                                                     * 02760002
* TABLES/WORK AREAS                                                   * 02820002
*    TCOMTAB - TEST TABLE AND WORKAREA                                * 02880002
*                                                                     * 02940002
* ATTRIBUTES                                                          * 03000002
*    REENTRANT ROUTINE                                                * 03060002
*    REFRESHABLE ROUTINE                                              * 03120002
*                                                                     * 03180002
* CHARACTER CODE DEPENDENCY                                           * 03240002
*    THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL            * 03300002
*    REPRESENTATION OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT * 03360002
*    TO THE ONE USED AT ASSEMBLY TIME.  THE CODING HAS BEEN ARRANGED  * 03420002
*    SO THAT REDEFINITION OF CHARACTER CONSTANTS, BY REASSEMBLY,      * 03480002
*    WILL RESULT IN A CORRECT MODULE FOR THE NEW DEFINITION.          * 03540002
*                                                                     * 03600002
* NOTES                                                               * 03660002
*    COMMENTS ON THE ASSEMBLER STATEMENTS USUALLY START IN COLUMN 36. * 03720002
*    TCBRTRY IS THE ENTRY POINT INTO THE STAE RETRY ROUTINE AND IS    * 03780002
*    GIVEN CONTROL FROM IKJEGSTA.                                     * 03840002
*    PLM = SY35-0004                                                  * 03890002
*          TSO COMMAND PROCESSOR LOGIC                                * 03892002
*          VOLUME III - TEST                                          * 03894002
*********************************************************************** 03900002
         EJECT                                                          03960002
*********************************************************************** 04020002
*                                                                     * 04080002
*              REGISTER EQUATES                                       * 04140002
*                                                                     * 04200002
*********************************************************************** 04260002
R0       EQU   0                   WILL BE ZERO OR NEG FOR CONVERT      04320002
R1       EQU   1                   PARAMETER REGISTER                   04380002
R2       EQU   2                   WORK REG                             04440002
R3       EQU   3                   WORK REG & BASE REG FOR TCB DSECT    04500002
R4       EQU   4                   WORK REG                             04560002
R5       EQU   5                   PT TO WORK AREA                      04620002
R6       EQU   6                   WORK REG                             04680002
R7       EQU   7                   WORK REG                             04740002
R8       EQU   8                   USED TO REF TCB ENTRIES              04800002
R9       EQU   9                   BASE REG FOR TCOMTAB                 04860002
R10      EQU   10                  WORK REG                             04920002
R11      EQU   11                  WORK REG & WORKAREA BASE             04980002
R12      EQU   12                  MODULE BASE REG                      05040002
R13      EQU   13                  PT TO SAVE AREA                      05100002
R14      EQU   14                  LINKAGE RETURN REG                   05160002
R15      EQU   15                  LINKAGE BRANCH REG                   05220002
         SPACE 2                                                        05280002
*********************************************************************** 05340002
*                                                                     * 05400002
*        SYMBOLIC EQUATES                                             * 05460002
*                                                                     * 05520002
*********************************************************************** 05580002
         SPACE                                                          05640002
ZERO     EQU   0                   NO. 0                                05700002
ONE      EQU   1                   NO. 1                                05760002
TWO      EQU   2                   NO. 2                                05820002
THREE    EQU   3                   NO. 3                                05880002
FOUR     EQU   4                   NO. 4                                05940002
FIVE     EQU   5                   NO. 5                                06000002
EIGHT    EQU   8                   NO. 8                                06060002
TEN      EQU   10                  NO. 10                               06120002
ELEVEN   EQU   11                  NO. 11                               06180002
TWELVE   EQU   12                  NO. 12                               06240002
SIXTEEN  EQU   16                  NO. 16                               06300002
EIGHTEEN EQU   18                  NO. 18                               06350002
TWENTY   EQU   20                  NO. 20                               06360002
TWENTY4  EQU   24                  NO. 24                               06410002
THIRTY2  EQU   32                  NO. 32                               06420002
THIRTY5  EQU   35                  NO. 35                               06480002
FORTY    EQU   40                  NO. 40                               06540002
FIFTY6   EQU   56                  NO. 56                               06600002
SIXTY8   EQU   68                  NO. 68                               06660002
EIGHTY   EQU   80                  NO. 80                               06720002
EIGHTY4  EQU   84                  NO. 84                               06780002
EIGHTY9  EQU   89                  NO. 89                               06840002
NINETY   EQU   90                  NO. 90                               06900002
ONE59    EQU   159                 NO. 159                              06960002
ONE63    EQU   163                 NO. 163                              07020002
ONE84    EQU   184                 NO. 184                              07080002
HEX00    EQU   X'00'               NO. 0                                07140002
HEX01    EQU   X'01'               NO. 1                                07200002
HEX03    EQU   X'03'               NO. 3                                07260002
HEX04    EQU   X'04'               NO. 4                                07320002
HEXFF    EQU   X'FF'               USED IN NI INST                      07380002
BLANK    EQU   C' '                USED TO CLEAR BUFFERS                07440002
TYPE     EQU   X'04'               INDICATES CONVERT TO HEX             07500002
FLAG     EQU   X'80'               VALUE CONVERSION                     07560002
LINKCODE EQU   X'03'               STAE CODE FOR LINK FAILED            07620002
PROTCHK  EQU   7                   STAE CODE FOR PROTECTION CHK         07670002
CVTADDR  EQU   16                  ADDRESS OF CVT                       07680002
HEX38    EQU   X'38'               USED IN TM INSTRUCTION               07740002
PLUS     EQU   C'+'                PLUS SIGN                            07800002
* THE FOLLOWING ARE 1ST LEVEL MESSAGE NO. EQUATES.                      07850002
M0016    EQU   16                  TCB FIELD NAME REQUIRED              07852002
M0101    EQU   101                 INVALID ADDRESS ...                  07854002
M0103    EQU   103                 NOT ENOUGH MAIN STORAGE              07856002
M0104    EQU   104                 LISTTCB FAILED, COMND SYS ERR        07858002
* THE FOLLOWING ARE 2ND LEVEL MESSAGE NO. EQUATES.                      07858402
M0274    EQU   274                 REG NOT. MUST BE INDRCT GEN REG      07858802
M0277    EQU   277                 PARSE ERROR CODE 12                  07859202
M0280    EQU   280                 FULLWORD BOUNDARY REQ.               07859602
* THE FOLLOWING ARE CONSTANT MESSAGE INSERT EQUATES.                    07859702
I0040    EQU   40                  IKJPARS                              07859802
I0008    EQU   8                   LISTTCB                              07859902
I0003    EQU   3                   FULL                                 07879902
I0099    EQU   99                  ABEND CODE INSERT NO.                07889902
I0097    EQU   97                  ABEND CODE INSERT NO. (ICTABLE)      07899902
**********************************************************************  07900002
         EJECT                                                          07920002
*  ENTRY POINT FROM IKJEGMNL.  REGISTER 9 POINTS TO TCOMTAB UPON     *  07980002
*  ENTRY.                                                            *  08040002
         SPACE                                                          08100002
         SAVE  (14,12),,*          SAVE CALLING PROGRAM REGISTERS       08160002
         LR    R12,R15             SAVE ADDRESS OF THIS PROGRAM         08220002
         USING IKJEGTCB,R12        SET UP MODULE BASE                   08280002
         USING TCOMTAB,R9          ADDRESSABILITY FOR TCOMTAB           08340002
         L     R15,REGSAVE2        POINT TO MODULE SAVE AREA            08400002
         L     R7,PARSADR          POINT TO PARSE PCL                   08460002
         ST    R13,FOUR(R15)       STORE POINT TO OLD SAVE AREA         08520002
         ST    R15,EIGHT(R13)      STORE NEW AREA ADDR OLD SAVE AREA    08580002
         LR    R13,R15             POINT TO NEW SAVE AREA               08640002
         STM   R14,R12,TWELVE(R13) SAVE REGISTERS FOR SAFETY            08700002
         L     R6,WORKAREA         GET ADDRESS OF WORKAREA              08760002
         USING TSTCWORK,R6         ESTABLISH ADDRESSABILITY TO IT       08820002
         LA    R5,CWORKCMD         SKIP CONVERT WORKAREA                08880002
         DROP  R6                  DROP ADDRESSABILITY TO CONVERT AREA  08940002
         USING MYWKAREA,R5         ESTABLISH ADDRESSABILITY TO OUR AREA 09000002
         L     R2,TSTSTAE          POINT TO IKJEGSTA                    09010002
         XC    STAESTUF(SIXTEEN),STAESTUF   CLEAR STAE PARAMETER AREA   09050002
         ESTAE (R2),PARAM=LISTESTA,RECORD=YES,MF=(E,(R5))  ISSUE ESTAE  09052002
         LTR   R15,R15             RETURN CODE 0                        09420002
SMTSTAE  DS    0H                  SMT LABEL FOR TEST CASE TTCB0400     09480002
         BZ    SETPARSE            YES, CONTINUE PROCESSING             09540002
         STC   R15,TSTESTRC        STORE RET CODE IN TCOMTAB            09550002
         LA    R15,TWENTY4         SEND RC=24 TO MAINLINE               09560002
         B     RETURNS             RETURN TO MAINLINE                   09570002
SETPARSE EQU   *                                                        09840002
**  THIS CODE SETS UP TO GO TO IKJPARS TO VALIDITY CHECK THE INPUT  **  09900002
**  BUFFER.                                                         **  09960002
         DROP  R5                  RELEASE REGISTER 5                   10020002
         USING PPL,R5              ESTABLISH ADDRESSABILITY TO PARSE    10080002
         LR    R1,R5               PARAMETER LIST                       10140002
         LA    R2,TSTANSPL         LOAD ADDRESS OF ANSWER PLACE         10200002
         MVC   PPLUPT(FOUR),TSTUPT PUT ADDR UPT INTO PARAMETER LIST     10260002
         MVC   PPLECT(FOUR),TSTECT PUT ADDR ECT INTO PARAMETER LIST     10320002
         MVC   PPLECB(FOUR),TSTCPECB PUT ADDR ECB INTO PARAMETER LIST   10380002
         ST    R7,PPLPCL           PT TO PCL                            10440002
         ST    R2,PPLANS           PT TO ANSWER PLACE FOR PARSE         10500002
         MVC   PPLCBUF(FOUR),INBUF PT TO COMMAND BUFFER                 10560002
         ST    R13,PPLUWA          PT TO SAVE AREA FOR TCB REGS         10620002
         DROP  R5                  RELEASE REGISTER 5                   10680002
         USING MYWKAREA,R5                                              10740002
         LINK  EP=IKJPARS,ERRET=LINKFAIL LINK TO PARSE                  10850002
PARSEBLO EQU   *                   LABEL USED BY STAE RETRY ROUTINE     10860002
SMTPARS  DS    0H                  SMT LABEL FOR TEST CASE TTCB0500     10920002
         B     PARSDONE            GO TO PARSDONE                       10980002
IKJEGVCK EQU   *                                                        11040002
**  THIS IS THE VALIDITY CHECK ROUTINE FOR IKJEGTCB.  IT RECEIVES   **  11100002
**  CONTROL FROM IKJPARS.  REGISTER 1 POINTS TO THE THREE WORD      **  11160002
**  PARAMETER LIST FROM IKJPARS.  THE FIRST WORD POINTS TO THE PDE  **  11220002
**  BUILT BY IKJPARS, THE SECOND WORD POINTS TO IKJEGTCB'S SAVEAREA **  11280002
**  AND THE THIRD WORD IS USED TO PASS THE ADDRESS OF THE SECOND    **  11340002
**  LEVEL MESSAGE PASSED BY IKJEGCVT OR IKJEGSYM BACK TO IKJPARS.   **  11400002
         SAVE  (14,12),,*          SAVE PARSE'S REGS                    11460002
         L     R9,FOUR(R1)         GET ADDR OF SAVE AREA                11520002
         L     R12,SIXTY8(R9)      RESTORE PROG ADDRESSABILITY          11580002
         L     R5,FORTY(R9)        RESTORE WORK AREA ADDRESSABILITY     11640002
         L     R9,FIFTY6(R9)       RESTORE POINTER TO TCOMTAB           11700002
         ST    R1,OUTPTR2          SAVE ADDR OF PARSE PARM LIST         11760002
         L     R1,ZERO(R1)         POINT TO PDE FOR IKJEGCVT            11820002
         LR    R10,R1              GET ADDRESS OF PDL                   11880002
         USING IKJPARMA,R10        ESTABLISH ADDRESSABILITY TO PDL      11940002
         LCR   R1,R1               R1 NEGATIVE FOR ADDRESSES            12000002
         SPACE                                                          12060002
         L     R15,REGSAVE3        PT TO VALIDITY ROUTINE SAVE AREA     12120002
         LCR   R0,R1               R0 INDICATES CONVERT TO BINARY       12180002
         ST    R13,FOUR(R15)       STORE OLD SAVE AREA ADDR             12240002
         ST    R15,EIGHT(R13)      STORE NEW SAVE AREA ADDR             12300002
         LR    R13,R15             POINT TO NEW SAVE AREA               12360002
         SR    R14,R14             ZERO OUT REG 14                      12410002
         L     R4,OUTBUF           ACCESS OUTBUF                        12412002
         ST    R14,ZERO(R4)        CLEAR 1ST WORD OF OUTBUF             12414002
         OI    TSTFLGS4,TSTVALCK   INDICATE VALIDITY CHECK TO IO        12416002
         L     R15,TSTCONVT        EP OF IKJEGCVT                       12420002
         BALR  R14,R15             GO TO IKJEGCVT                       12480002
         LPR   R1,R1               RESET REGISTER 1 TO POSITIVE         12540002
         B     CONVTAB(R15)        BRANCH INTO TABLE INDEXED BY         12600002
*                                  CONTENTS OF REGISTER 15              12660002
CONVTAB  EQU   *                                                        12720002
         B     BOUNDCK             0-CONTINUE PROCESSING                12780002
         B     SET8                4-SET BY IKJEGCVT-MOVE MSG ADDR      12840002
         B     SET12               8-SET BY IKJEGSYM-MOVE MSG ADDR      12900002
         B     SET12               12-SET BY IKJEGSYM-MOVE MSG ADDR     12960002
         B     SET12               16-ATTENTION INTERRUPT-RETURN        13020002
         B     SET12               20-IKJEGCVT OR IKJEGSYM BLEW         13080002
SET12    EQU   *                                                        13380002
         ST    R15,REG15           SAVE RETURN CODE FOR LATER USE       13440002
         LA    R15,TWELVE          SET RETURN CODE TO 12                13500002
         B     PARSRTRN            GO RETURN TO IKJPARS                 13560002
SET8     EQU   *                                                        13860002
         LA    R15,EIGHT           SET RETURN CODE TO 8                 13920002
         B     PARSRTRN            GO RETURN TO IKJEGMNL                13980002
SET0     EQU   *                                                        14040002
         XR    R15,R15             SET RETURN CODE TO 0                 14100002
         SPACE                                                          14160002
PARSRTRN EQU   *                                                        14220002
         L     R4,OUTBUF           ACCESS OUTBUF                        14270002
         L     R4,ZERO(R4)         FIRST WORD OF OUTBUF TO REG 4        14272002
         LTR   R4,R4               IS THERE A SECOND LEVEL MESSAGE      14274002
         BZ    PARSRET             NO, RETURN TO PARSE                  14278002
         L     R7,OUTPTR2          GET ADDR OF PARM LIST FROM PARSE     14278402
         LA    R7,EIGHT(R7)        GET ADDR OF 3RD WORD OF PARM LIST    14278802
         MVC   ZERO(FOUR,R7),OUTBUF PUT MSG ADDR INTO PARM LIST         14279202
PARSRET  EQU   *                   RETURN TO PARSE                      14279602
         NI    TSTFLGS4,HEXFF-TSTVALCK CLEAR VALIDITY CHECK FLAG        14279702
         L     R13,FOUR(R13)       RESTORE REGISTER 13                  14280002
         RETURN (14,12),,RC=(15)   RESTORE REGS AND RETURN              14340002
*********************************************************************** 14400002
*THE FOLLOWING CODE PERFORMS FURTHER ADDRESS VALIDITY CHECKING.  IT     14460002
*CHECKS THAT THE ADDRESS IS NOT A REGISTER AND THAT THE ADDRESS IS ON   14520002
*A FULL WORD BOUNDARY.                                                  14580002
*********************************************************************** 14640002
BOUNDCK  EQU   *                                                        14700002
         L     R3,PDEUSER          LOAD USER WORD                       14880002
         TM    PDEUSER,PDESIB      IS CONVERTED ADDRESS IN USER WORD    14940002
         BZ    NOSYM               YES, PICK UP THE ADDRESS             15000002
         L     R3,ZERO(ZERO,R3)    NO, GET ADDR FROM SI BLOCK           15060002
         ST    R3,THIRTY2(R1)      PUT ADDRESS INTO USER WORD           15120002
NOSYM    EQU   *                                                        15180002
         L     R6,REGSAVE2         GET ADDR OF SAVE AREA                15240002
         ST    R3,THIRTY2(R6)      SAVE TCB ADDR                        15300002
REGTEST  EQU   *                   CHECK FOR INVALID REGISTER ADDR      15540002
         LH    R4,PDEINDCT         GET INDIRECT COUNT                   15600002
         LTR   R4,R4               IS IT ZERO                           15660002
         BNZ   FULLWORD            NO, INDIRECT ADDRESS, BRANCH         15720002
         TM    PDEFLG4,HEX38       YES, IS THIS A REGISTER ADDR         15780002
         BZ    FULLWORD            NO, GO CHECK BOUNDARY                15840002
         LA    R2,M0101            MSG-INVALID ADDRESS ...              15890002
         LA    R3,M0274            MSG-REG NOT. MUST BE IND GEN REG     15892002
         LR    R4,R10              ADDRESS PDE                          15894002
         B     MSG2                GO OUTPUT THE MESSAGES               15896002
         SPACE                                                          16020002
FULLWORD EQU   *                                                        16080002
         TM    THIRTY5(R1),HEX03   FULLWORD BOUNDARY                    16140002
         BZ    SET0                RETURN TO PARSE                      16310002
         LA    R2,M0101            MSG-INVALID ADDRESS ...              16312002
         LA    R3,M0280            MSG-FULLWORD BOUNDARY REQ.           16314002
         LR    R4,R10              ADDRESS PDE                          16316002
         B     MSG3                GO OUTPUT THE MESSAGES               16318002
         SPACE                                                          16320002
*        THE FOLLOWING CODE IS EXECUTED UPON COMPLETION OF PARSE      * 18223002
PARSDONE EQU   *                                                        18240002
         LTR   R15,R15             IS RETURN CODE 0 (SUCCESSFUL PARSE   18300002
*                                  COMPLETION)                          18360002
         BNZ   TCBRET1             NO, BRANCH TO TCBRET                 18420002
         ST    R15,REG14           REG15=0...CLEAR REG14 SAVE           18480002
         L     R10,TSTANSPL        LOAD ADDR OF PARSE PDL               18540002
         USING IKJPARMD,R10        ESTABLISH PDL ADDRESSABILITY         18600002
FIELDCHK EQU   *                                                        18660002
         MVI   EXTENTFG,HEX00      CLEAR EXTENT FLAG                    18714002
         MVI   NOFLDFLG,HEX00      CLEAR NO FIELDS FLAG                 18716002
         CLI   TCBFIELD+ONE,HEX00  WERE FIELDS SPECIFIED BY USER        18720002
         BNE   PRINTCHK            YES,  GO TO PRINTCHK                 18780002
*********************************************************************** 18840002
*        OTHERWISE FIELD WAS NOT SPECIFIED AND THE USER DESIRES ALL   * 18900002
*        FIELDS OF THE TCB.  IT IS NECESSARY TO MAKE THE PDE'S FOR ALL* 18960002
*        THE FIELDS OF THE TCB NON-ZERO.                              * 19020002
*********************************************************************** 19080002
         MVI   RBP,HEXFF           INDICATE THAT ALL FIELDS OF THE TCB  19140002
         MVC   RBP+ONE(CNT*2-ONE),RBP  WERE REQUESTED BY THE USER       19200002
         MVI   NOFLDFLG,HEXFF      SET NO FIELDS FLAG                   19250002
PRINTCHK EQU   *                                                        19260002
         CLI   PRINTIT+ONE,HEX00   IS PRINT KEYWORD SPECIFIED           19320002
         BNE   PRINTSPC            YES...GO TURN ON PRINT FLAG          19380002
         NI    TSTFLGS1,(HEXFF-TSTPRINT)  NO...TURN OFF FLAG BIT        19440002
         SR    R4,R4               ZERO FOR OUTPUT TO TERMINAL          19500002
         B     ADDRCHK             GO CHECK FOR ADDR PARAMETERS         19560002
PRINTSPC EQU   *                                                        19620002
         OI    TSTFLGS1,TSTPRINT   SWITCH ON FOR OUTPUT TO DATA SET     19680002
         LA    R4,DSNAM            GET ADDR OF DSNAME PDE               19740002
ADDRCHK  EQU   *                                                        19800002
         LA    R10,ADDRESS         GET POINTER TO ADDRESS FIELD         19860002
         DROP  R10                 RELEASE REGISTER 10                  19920002
         USING IKJPARMA,R10        ESTABLISH ADDRESSABILITY             19980002
         L     R7,PDEADRPT         GET POINTER TO ADDRESS               20040002
         DROP  R10                 RELEASE REGISTER 10                  20100002
         L     R10,TSTANSPL        LOAD ADDR OF PARSE PDL               20160002
         USING IKJPARMD,R10        ESTABLISH PDL ADDRESSABILITY         20220002
         SPACE                                                          20280002
         ST    R4,PRINTFLG         MOVE ADDR OF DSNAME PDE OR 0 INTO    20340002
*                                  WORKAREA                             20400002
         LTR   R7,R7               WAS ADDR SPECIFIED BY USER           20460002
         BNZ   TABLESCN            YES, IF ADDR SPECIFIED, BRANCH       20520002
         L     R3,PPTCB            NO, PT TO THE PROBLEM PROGRAM TCB    20580002
*********************************************************************** 20640002
*        THE FOLLOWING CODE WILL SCAN THE STRING OF PARSE PDES ONE BY * 20700002
*        ONE AND BRANCH TO THE APPROPRIATE SUBROUTINE.                * 20760002
*********************************************************************** 20820002
TABLESCN EQU   *                                                        20880002
         L     R11,OUTBUF          POINT TO OUTPUT BUFFER               20940002
         SPACE                                                          21000002
         USING TCB,R3              ESTABLISH ADDRESSABILITY TO TCB      21060002
         SPACE                                                          21120002
         LA    R4,EIGHTY           LOAD DEFAULT OUTPUT LENGTH           21180002
         CH    R4,TMPLL            COMPARE WITH TERMINAL LINE LENGTH    21240002
         BNH   LINESET             IF 80 IS LOW, BRANCH                 21300002
         LA    R4,FORTY                                                 21360002
         CH    R4,TMPLL            COMPARE 40 WITH TMP LINE LENGTH      21420002
         BH    DEFAULT             BRANCH IF 40 IS HIGHER THAN TERMINAL 21480002
         LH    R4,TMPLL            USE SPECIFIED LINE LENGTH            21540002
         B     LINESET             GO SET LINE LENGTH                   21600002
DEFAULT  EQU   *                                                        21660002
         LA    R4,EIGHTY           DEFAULT LINE LENGTH TO 80            21720002
LINESET  EQU   *                                                        21780002
         ST    R4,LINELEN          STORE OUTPUT LINE LENGTH             21840002
         SR    R2,R2               ZERO OUTPUT LENGTH COUNTER           21900002
         ST    R2,LENGTH           CLEAR OUT AREA                       21960002
         STH   R2,GRSFLAG1         TURN OFF GRS FLAGS                   22020002
         MVI   ZERO(R11),BLANK     CLEAR OUT                            22080002
         MVC   ONE(ONE63,R11),ZERO(R11)  OUTPUT BUFFERS                 22140002
         LA    R6,RBP              POINT TO STRING OF FIELD PDE'S       22200002
         LA    R4,RBP+CNT*2        PT TO END OF STRING OF PDES          22260002
         ST    R4,ENDPDECK         OF FIELD KEYWORDS                    22320002
PDECHECK EQU   *                                                        22380002
         CLI   ONE(R6),HEX00       IS KEYWORD PRESENT                   22440002
         BNE   SBRTNSVR            YES, GO TO CORRESPONDING SUBROUTINE  22500002
         LA    R6,TWO(R6)          NO, POINT TO NEXT PDE                22560002
         C     R6,ENDPDECK         IS THERE ANOTHER PDE                 22620002
         BE    PDLEND              NO, GO TO PDLEND                     22680002
         B     PDECHECK            YES, CHECK NEXT PDE                  22740002
         SPACE                                                          22800002
SBRTNSVR EQU   *                                                        22860002
         L     R7,ENDPDECK         END OF PDE STRING                    22920002
         LA    R10,CNT*2           LENGTH OF PDE STRING                 22980002
         SR    R7,R6               SUBTRACT CURRENT PDE LOCATION        23040002
         SR    R10,R7              FIND RELATIVE POSITION OF PDE        23100002
         LA    R11,ELEVEN          HALF THE NO. OF BYTES FOR EACH       23160002
*                                  PDE BLOCK OF CODE                    23220002
         SPACE                                                          23280002
         LA    R7,SBRTNTAB         LOAD ADDRESS OF SUBROUTINE TABLE     23340002
         MR    R10,R10             MULTIPLY FOR PROPER ADDRESSING IN    23400002
*                                  TABLE                                23460002
         AR    R7,R11              ADD THE OFFSET                       23520002
         L     R11,TCBEXT2         PTR TO EXTENSION TO TCB              23530002
         USING TCBXTNT2,R11        ESTABLISH ADDRESSABILITY             23540002
         BR    R7                  BRANCH TO THE PROPER SECTION BELOW   24120002
         EJECT                                                          24180002
SBRTNTAB EQU   *                                                        24240002
         SPACE                                                          24300002
*********************************************************************** 24360002
*       FOLLOWING ARE 81 BLOCKS CONTAINING 5 LINES EACH               * 24420002
*       THESE BLOCKS CORRESPOND TO THE FIELDS OF THE TCB.             * 24480002
*       THEY SET THE FIELD AND HEADER LENGTHS, THE RELATIVE           * 24540002
*       ADDRESS OF THE FIELD IN THE TCB, AND THE HEADER.              * 24600002
*       CONTROL IS THEN PASSED TO A COMMON OUTPUT AND                 * 24660002
*       CONVERSION ROUTINE.                                           * 24720002
*********************************************************************** 24780002
         SPACE                                                          24840002
TCB000S  EQU   *                                                        24900002
         MVC   HDRBUF(L'HDRRBP),HDRRBP   HEADER TO HEADER BUFFER        24960002
         MVI   HDRLEN,L'HDRRBP     LENGTH OF FIELD HEADER               25020002
         MVI   FLDLEN,FOUR         NO. OF BYTES FOR THIS FIELD          25080002
         LA    R8,TCBRBP           RBP ENTRY IN TCB                     25140002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      25200002
TCB004S  EQU   *                                                        25260002
         MVC   HDRBUF(L'HDRPIE),HDRPIE   HEADER TO HEADER BUFFER        25320002
         MVI   HDRLEN,L'HDRPIE     LENGTH OF FIELD HEADER               25380002
         MVI   FLDLEN,FOUR         NO. OF BYTES FOR THIS FIELD          25440002
         LA    R8,TCBPIE           PIE ENTRY IN TCB                     25500002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      25560002
TCB008S  EQU   *                                                        25620002
         MVC   HDRBUF(L'HDRDEB),HDRDEB   HEADER TO HEADER BUFFER        25680002
         MVI   HDRLEN,L'HDRDEB     LENGTH OF FIELD HEADER               25740002
         MVI   FLDLEN,FOUR         NO OF BYTES FOR THIS FIELD           25800002
         LA    R8,TCBDEB           DEB ENTRY IN TCB                     25860002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      25920002
TCB012S  EQU   *                                                        25980002
         MVC   HDRBUF(L'HDRTIO),HDRTIO   HEADER TO HEADER BUFFER        26040002
         MVI   HDRLEN,L'HDRTIO     LENGTH OF FIELD HEADER               26100002
         MVI   FLDLEN,FOUR         NO. OF BYTES FOR THIS FIELD          26160002
         LA    R8,TCBTIO           TIO ENTRY IN TCB                     26220002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      26280002
TCB016S  EQU   8                                                        26340002
         MVC   HDRBUF(L'HDRCMP),HDRCMP  HEADER TO HEADER BUFFER         26400002
         MVI   HDRLEN,L'HDRCMP     LENGTH OF FIELD HEADER               26460002
         MVI   FLDLEN,FOUR         NO. OF BYTES FOR THIS FIELD          26520002
         LA    R8,TCBCMP           CMP ENTRY IN TCB                     26580002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      26640002
TCB020S  EQU   *                                                        26700002
         MVC   HDRBUF(L'HDRTRN),HDRTRN  HEADER TO HEADER BUFFER         26760002
         MVI   HDRLEN,L'HDRTRN     LENGTH OF FIELD HEADER               26820002
         MVI   FLDLEN,FOUR         NO. OF BYTES IN THIS FIELD           26880002
         LA    R8,TCBTRN           TRN ENTRY IN TCB                     26940002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      27000002
TCB024S  EQU   *                                                        27060002
         MVC   HDRBUF(L'HDRMSS),HDRMSS   HEADER TO HEADER BUFFER        27120002
         MVI   HDRLEN,L'HDRMSS     LENGTH OF FIELD HEADER               27180002
         MVI   FLDLEN,FOUR         NO. OF BYTES IN THIS FIELD           27240002
         LA    R8,TCBMSS           MSS ENTRY IN TCB                     27300002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      27360002
TCB028S  EQU   *                                                        27420002
         MVC   HDRBUF(L'HDRPKF),HDRPKF  HEADER TO HEADER BUFFER         27480002
         MVI   HDRLEN,L'HDRPKF     LENGTH OF FIELD HEADER               27540002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              27600002
         LA    R8,TCBPKF           PKF ENTRY IN TCB                     27660002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      27720002
TCB029S  EQU   *                                                        27780002
         MVC   HDRBUF(L'HDRFLGS),HDRFLGS   HEADER TO HEADER BUFFER      27840002
         MVI   HDRLEN,L'HDRFLGS    LENGTH OF FIELD HEADER               27900002
         MVI   FLDLEN,FIVE         NO. BYTES IN THIS FIELD              27960002
         LA    R8,TCBFLGS          FLGS ENTRY IN TCB                    28020002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      28080002
TCB034S  EQU   *                                                        28140002
         MVC   HDRBUF(L'HDRLMP),HDRLMP  HEADER TO HEADER BUFFER         28200002
         MVI   HDRLEN,L'HDRLMP     LENGTH OF FIELD HEADER               28260002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              28320002
         LA    R8,TCBLMP           LMP ENTRY IN TCB                     28380002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      28440002
TCB035S  EQU   *                                                        28500002
         MVC   HDRBUF(L'HDRDSP),HDRDSP   HEADER TO HEADER BUFFER        28560002
         MVI   HDRLEN,L'HDRDSP     LENGTH OF FIELD HEADER               28620002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              28680002
         LA    R8,TCBDSP           DSP ENTRY IN TCB                     28740002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      28800002
TCB036S  EQU   *                                                        28860002
         MVC   HDRBUF(L'HDRLLS),HDRLLS   HEADER TO HEADER BUFFER        28920002
         MVI   HDRLEN,L'HDRLLS     LENGTH OF FIELD HEADER               28980002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              29040002
         LA    R8,TCBLLS           LLS ENTRY IN TCB                     29100002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      29160002
TCB040S  EQU   *                                                        29220002
         MVC   HDRBUF(L'HDRJLB),HDRJLB   HEADER TO HEADER BUFFER        29280002
         MVI   HDRLEN,L'HDRJLB     LENGTH OF FIELD HEADER               29340002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              29400002
         LA    R8,TCBJLB           JLB ENTRY IN TCB                     29460002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      29520002
TCB044S  EQU   *                                                        29580002
         MVC   HDRBUF(L'HDRJPQ),HDRJPQ   HEADER TO HEADER BUFFER        29640002
         MVI   HDRLEN,L'HDRJPQ     LENGTH OF FIELD HEADER               29700002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              29760002
         LA    R8,TCBJPQ           JPQ ENTRY IN TCB                     29820002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      29880002
* THE FOLLOWING BLOCK SETS UP FOR THE GRS FIELD OF THE TCB            * 29940002
TCB048S  EQU   *                                                        30000002
         MVC   HDRBUF(L'HDRGRS),HDRGRS   HEADER TO HEADER BUFFER        30060002
         MVI   HDRLEN,L'HDRGRS     LENGTH OF FIELD HEADER               30120002
         MVI   FLDLEN,FOUR         NO. OF BYTES FOR EACH REGISTER       30180002
         LA    R8,TCBGRS           GRS ENTRY IN TCB                     30240002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      30300002
TCB112S  EQU   *                                                        30360002
         MVC   HDRBUF(L'HDRQEL),HDRQEL   HEADER TO HEADER BUFFER        30420002
         MVI   HDRLEN,L'HDRQEL     LENGTH OF FIELD HEADER               30480002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              30540002
         LA    R8,TCBQEL           QEL ENTRY IN TCB                     30600002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      30660002
TCB113S  EQU   *                                                        30720002
         MVC   HDRBUF(L'HDRFSAB),HDRFSAB  HEADER TO HEADER BUFFER       30780002
         MVI   HDRLEN,L'HDRFSAB    LENGTH OF FIELD HEADER               30840002
         MVI   FLDLEN,THREE        NO. BYTES IN THIS FIELD              30900002
         LA    R8,TCBFSAB          FSA ENTRY IN TCB                     30960002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      31020002
TCB116S  EQU   *                                                        31080002
         MVC   HDRBUF(L'HDRTCB),HDRTCB   HEADER TO HEADER BUFFER        31140002
         MVI   HDRLEN,L'HDRTCB     LENGTH OF FIELD HEADER               31200002
         MVI   FLDLEN,FOUR         NO. OF BYTES IN THIS FIELD           31260002
         LA    R8,TCBTCB           CUR TCB ENTRY IN TCB                 31320002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      31380002
TCB120S  EQU   *                                                        31440002
         MVC   HDRBUF(L'HDRTME),HDRTME   HEADER TO HEADER BUFFER        31500002
         MVI   HDRLEN,L'HDRTME     LENGTH OF FIELD HEADER               31560002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              31620002
         LA    R8,TCBTME           TME ENTRY IN TCB                     31680002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      31740002
TCB124S  EQU   *                                                        31800002
         MVC   HDRBUF(L'HDRJSTCB),HDRJSTCB   HEADER TO HEADER BUFFER    31860002
         MVI   HDRLEN,L'HDRJSTCB   LENGTH OF FIELD HEADER               31920002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              31980002
         LA    R8,TCBJSTCB         JSTCB ENTRY IN TCB                   32040002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      32100002
TCB128S  EQU   *                                                        32160002
         MVC   HDRBUF(L'HDRNTC),HDRNTC  HEADER TO HEADER BUFFER         32220002
         MVI   HDRLEN,L'HDRNTC     LENGTH OF FIELD HEADER               32280002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              32340002
         LA    R8,TCBNTC           NTC ENTRY IN TCB                     32400002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      32460002
TCB132S  EQU   *                                                        32520002
         MVC   HDRBUF(L'HDROTC),HDROTC   HEADER TO HEADER BUFFER        32580002
         MVI   HDRLEN,L'HDROTC     LENGTH OF FIELD HEADER               32640002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              32700002
         LA    R8,TCBOTC           OTC ENTRY IN TCB                     32760002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      32820002
TCB136S  EQU   *                                                        32880002
         MVC   HDRBUF(L'HDRLTC),HDRLTC   HEADER TO HEADER BUFFER        32940002
         MVI   HDRLEN,L'HDRLTC     LENGTH OF FIELD HEADER               33000002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              33060002
         LA    R8,TCBLTC           LTC ENTRY IN TCB                     33120002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      33180002
TCB140S  EQU   *                                                        33240002
         MVC   HDRBUF(L'HDRIQE),HDRIQE   HEADER TO HEADER BUFFER        33300002
         MVI   HDRLEN,L'HDRIQE     LENGTH OF FIELD HEADER               33360002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              33420002
         LA    R8,TCBIQE           IQE ENTRY IN TCB                     33480002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      33540002
TCB144S  EQU   *                                                        33600002
         MVC   HDRBUF(L'HDRECB),HDRECB   HEADER TO HEADER BUFFER        33660002
         MVI   HDRLEN,L'HDRECB     LENGTH OF FIELD HEADER               33720002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              33780002
         LA    R8,TCBECB           ECB ENTRY IN TCB                     33840002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      33900002
TCB148S  EQU   *                                                        33960002
         MVC   HDRBUF(L'HDRTSFLG),HDRTSFLG   HEADER TO HEADER BUFFER    34020002
         MVI   HDRLEN,L'HDRTSFLG   LENGTH OF HEADER BUFFER              34080002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              34140002
         LA    R8,TCBTSFLG         TSFLG ENTRY IN TCB                   34200002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      34260002
TCB149S  EQU   *                                                        34320002
         MVC   HDRBUF(L'HDRSTPCT),HDRSTPCT   HEADER TO HEADER BUFFER    34380002
         MVI   HDRLEN,L'HDRSTPCT   LENGTH OF FIELD HEADER               34440002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              34500002
         LA    R8,TCBSTPCT         STPCT ENTRY IN TCB                   34560002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      34620002
TCB150S  EQU   *                                                        34680002
         MVC   HDRBUF(L'HDRTSLP),HDRTSLP  HEADER TO HEADER BUFFER       34740002
         MVI   HDRLEN,L'HDRTSLP    LENGTH OF FIELD HEADER               34800002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              34860002
         LA    R8,TCBTSLP          TSLP ENTRY IN TCB                    34920002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      34980002
TCB151S  EQU   *                                                        35040002
         MVC   HDRBUF(L'HDRTSDP),HDRTSDP  HEADER TO HEADER BUFFER       35100002
         MVI   HDRLEN,L'HDRTSDP    LENGTH OF FIELD HEADER               35160002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              35220002
         LA    R8,TCBTSDP          TSDP ENTRY IN TCB                    35280002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      35340002
TCB152S  EQU   *                                                        35400002
         MVC   HDRBUF(L'HDRPQE),HDRPQE   HEADER TO HEADER BUFFER        35460002
         MVI   HDRLEN,L'HDRPQE     LENGTH OF FIELD HEADER               35520002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              35580002
         LA    R8,TCBPQE           PQE ENTRY IN TCB                     35640002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      35700002
* THE FOLLOWING BLOCK SETS UP FOR THE AQE FIELD OF THE TCB            * 35760002
TCB156S  EQU   *                                                        35820002
         MVC   HDRBUF(L'HDRAQE),HDRAQE  HEADER TO HEADER BUFFER         35880002
         MVI   HDRLEN,L'HDRAQE     LENGTH OF FIELD HEADER               35940002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              36000002
         LA    R8,TCBAQE           AQE ENTRY IN TCB                     36060002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      36120002
TCB160S  EQU   *                                                        36180002
         MVC   HDRBUF(L'HDRNSTAE),HDRNSTAE   HEADER TO HEADER BUFFER    36240002
         MVI   HDRLEN,L'HDRNSTAE   LENGTH OF FIELD HEADER               36300002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              36360002
         LA    R8,TCBNSTAE         STAE FLAGS ENTRY IN TCB              36420002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      36480002
TCB161S  EQU   *                                                        36540002
         MVC   HDRBUF(L'HDRSTABB),HDRSTABB  HEADER TO HEADER BUFFER     36600002
         MVI   HDRLEN,L'HDRSTABB   LENGTH OF FIELD HEADER               36660002
         MVI   FLDLEN,THREE        NO. BYTES IN THIS FIELD              36720002
         LA    R8,TCBSTABB         STAE ADDR ENTRY IN TCB               36780002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      36840002
TCB164S  EQU   *                                                        36900002
         MVC   HDRBUF(L'HDRTCT),HDRTCT   HEADER TO HEADER BUFFER        36960002
         MVI   HDRLEN,L'HDRTCT     LENGTH OF FIELD HEADER               37020002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              37080002
         LA    R8,TCBTCT           TCT ENTRY IN TCB                     37140002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      37200002
TCB168S  EQU   *                                                        37260002
         MVC   HDRBUF(L'HDRUSER),HDRUSER   HEADER TO HEADER BUFFER      37320002
         MVI   HDRLEN,L'HDRUSER    LENGTH OF FIELD HEADER               37380002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              37440002
         LA    R8,TCBUSER          USER ENTRY IN TCB                    37500002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      37560002
TCB172S  EQU   *                                                        37620002
         MVC   HDRBUF(L'HDRNDSP0),HDRNDSP0   HEADER TO HEADER BUFFER    37680002
         MVI   HDRLEN,L'HDRNDSP0   LENGTH OF FIELD HEADER               37740002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              37800002
         LA    R8,TCBNDSP0         NDSP0 ENTRY IN TCB                   37860002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      37920002
TCB173S  EQU   *                                                        37980002
         MVC   HDRBUF(L'HDRNDSP1),HDRNDSP1  HEADER TO HEADER BUFFER     38040002
         MVI   HDRLEN,L'HDRNDSP1   LENGTH OF FIELD HEADER               38100002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              38160002
         LA    R8,TCBNDSP1         NDSP1 ENTRY                          38220002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      38280002
TCB174S  EQU   *                                                        38340002
         MVC   HDRBUF(L'HDRNDSP2),HDRNDSP2   HEADER TO HEADER BUFFER    38400002
         MVI   HDRLEN,L'HDRNDSP2   LENGTH OF FIELD HEADER               38460002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              38520002
         LA    R8,TCBNDSP2         NDSP2 ENTRY IN TCB                   38580002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      38640002
TCB175S  EQU   *                                                        38700002
         MVC   HDRBUF(L'HDRNDSP3),HDRNDSP3  HEADER TO HEADER BUFFER     38760002
         MVI   HDRLEN,L'HDRNDSP3   LENGTH OF FIELD HEADER               38820002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              38880002
         LA    R8,TCBNDSP3         NDSP3 ENTRY IN TCB                   38940002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      39000002
TCB176S  EQU   *                                                        39060002
         MVC   HDRBUF(L'HDRRSVD),HDRRSVD   HEADER TO HEADER BUFFER      39120002
         MVI   HDRLEN,L'HDRRSVD    LENGTH OF FIELD HEADER               39180002
         MVI   FLDLEN,FOUR         NO. OF BYTES IN FIELD                39240002
         LA    R8,TCBNDSP3+ONE     RESERVED ENTRY IN TCB                39300002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      39360002
TCB180S  EQU   *                                                        39420002
         MVC   HDRBUF(L'HDRJSCB),HDRJSCB   HEADER TO HEADER BUFFER      39480002
         MVI   HDRLEN,L'HDRJSCB    LENGTH OF FIELD HEADER               39540002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              39600002
         LA    R8,TCBJSCB          JSCB ENTRY IN TCB                    39660002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      39720002
TCB181S  EQU   *                   DDEXC ROUTINE                        39770002
         MVC   HDRBUF(L'HDRDDEXC),HDRDDEXC   HEADER TO HEADER BUFFER    39772002
         MVI   HDRLEN,L'HDRDDEXC   LENGTH OF FIELD HEADER               39774002
         MVI   FLDLEN,TWO          NO. BYTES IN THIS FIELD              39776002
         LA    R8,TCBDDEXC         DDEXC ENTRY IN TCB                   39778002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      39778402
TCB182S  EQU   *                   DDWTC ROUTINE                        39778802
         MVC   HDRBUF(L'HDRDDWTC),HDRDDWTC   HEADER TO HEADER BUFFER    39779202
         MVI   HDRLEN,L'HDRDDWTC   LENGTH OF FIELD HEADER               39779602
         MVI   FLDLEN,TWO          NO. BYTES IN THIS FIELD              39779702
         LA    R8,TCBDDWTC         DDWTC ENTRY IN TCB                   39779802
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      39779902
TCB183S  EQU   *                   IOBRC ROUTINE                        39799902
         MVC   HDRBUF(L'HDRIOBRC),HDRIOBRC   HEADER TO HEADER BUFFER    39809902
         MVI   HDRLEN,L'HDRIOBRC   LENGTH OF FIELD HEADER               39819902
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              39826602
         LA    R8,TCBIOBRC         IOBRC FIELD IN TCB                   39828602
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      39830602
TCB184S  EQU   *                                                        39833302
         MVC   HDRBUF(L'HDRRSVD),HDRRSVD   HEADER TO HEADER BUFFER      39840002
         MVI   HDRLEN,L'HDRRSVD    LENGTH OF FIELD HEADER               39900002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              39960002
         LA    R8,TCBIOBRC+FOUR     RESERVED ENTRY IN TCB               40020002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      40080002
TCB196S  EQU   *                                                        40140002
         MVC   HDRBUF(L'HDREXT1),HDREXT1   HEADER TO HEADER BUFFER      40200002
         MVI   HDRLEN,L'HDREXT1    LENGTH OF FIELD HEADER               40260002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              40320002
         LA    R8,TCBEXT1          RESERVED ENTRY IN TCB                40380002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      40440002
         SPACE 1                                                        40500002
TCB200S  EQU   *                                                        40860002
         MVC   HDRBUF(L'HDRNDSP4),HDRNDSP4  HEADER TO HEADER BUFFER     40920002
         MVI   HDRLEN,L'HDRNDSP4   LENGTH OF FIELD HEADER               40980002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              41040002
         LA    R8,TCBNDSP4         NDSP4 ENTRY IN TCB                   41100002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      41160002
TCB201S  EQU   *                                                        41220002
         MVC   HDRBUF(L'HDRNDSP5),HDRNDSP5  HEADER TO HEADER BUFFER     41280002
         MVI   HDRLEN,L'HDRNDSP5   LENGTH OF FIELD HEADER               41340002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              41400002
         LA    R8,TCBNDSP5         NDSP5 ENTRY IN TCB                   41460002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      41520002
TCB202S  EQU   *                                                        41580002
         MVC   HDRBUF(L'HDRFLGS6),HDRFLGS6  HEADER TO HEADER BUFFER     41640002
         MVI   HDRLEN,L'HDRFLGS6   LENGTH OF FIELD HEADER               41700002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              41760002
         LA    R8,TCBFLGS6         FLGS6 ENTRY IN TCB                   41820002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      41880002
TCB203S  EQU   *                                                        41940002
         MVC   HDRBUF(L'HDRFLGS7),HDRFLGS7  HEADER TO HEADER BUFFER     42000002
         MVI   HDRLEN,L'HDRFLGS7   LENGTH OF FIELD HEADER               42060002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              42120002
         LA    R8,TCBFLGS7         FLGS7 ENTRY IN TCB                   42180002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      42240002
TCB204S  EQU   *                                                        42300002
         MVC   HDRBUF(L'HDRDAR),HDRDAR  HEADER TO HEADER BUFFER         42360002
         MVI   HDRLEN,L'HDRDAR     LENGTH OF FIELD HEADER               42420002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              42480002
         LA    R8,TCBDAR           DAR ENTRY IN TCB                     42540002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      42600002
TCB205S  EQU   *                                                        42660002
         MVC   HDRBUF(L'HDRRSVD),HDRRSVD  HEADER TO HEADER BUFFER       42720002
         MVI   HDRLEN,L'HDRRSVD    LENGTH OF FIELD HEADER               42780002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              42840002
         LA    R8,TCBDAR+ONE       RESERVED ENTRY IN TCB                42900002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      42960002
TCB206S  EQU   *                   SYSCT ROUTINE                        43010002
         MVC   HDRBUF(L'HDRSYSCT),HDRSYSCT   HEADER TO HEADER BUFFER    43012002
         MVI   HDRLEN,L'HDRSYSCT   LENGTH OF FIELD HEADER               43014002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              43016002
         LA    R8,TCBSYSCT         SYSCT FIELD IN TCB                   43018002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      43018402
TCB207S  EQU   *                   STMCT ROUTINE                        43018802
         MVC   HDRBUF(L'HDRSTMCT),HDRSTMCT   HEADER TO HEADER BUFFER    43019202
         MVI   HDRLEN,L'HDRSTMCT   LENGTH OF FIELD HEADER               43019602
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              43019702
         LA    R8,TCBSTMCT         STMCT FIELD IN TCB                   43019802
         B     FLDOUTPT            TO COMMON CONVERSION ROUTINE         43019902
TCB208S  EQU   *                                                        43020002
         MVC   HDRBUF(L'HDREXT2),HDREXT2  HEADER TO HEADER BUFFER       43080002
         MVI   HDRLEN,L'HDREXT2    LENGTH OF FIELD HEADER               43140002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              43200002
         LA    R8,TCBEXT2          EXT2 ENTRY IN TCB                    43260002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      43320002
TCB212S  EQU   *                                                        43680002
         MVC   HDRBUF(L'HDRAECB),HDRAECB  HEADER TO HEADER BUFFER       43740002
         MVI   HDRLEN,L'HDRAECB    LENGTH OF FIELD HEADER               43800002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              43860002
         LA    R8,TCBAECB          RESERVED ENTRY IN TCB                43920002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      43980002
TCB216S  EQU   *                                                        45120002
         MVC   HDRBUF(L'HDRTIRB),HDRTIRB  HEADER TO HEADER BUFFER       45180002
         MVI   HDRLEN,L'HDRTIRB    LENGTH OF FIELD HEADER               45240002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              45300002
         LA    R8,TCBTIRB          TIRB ENTRY IN TCB                    45360002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      45420002
TCB220S  EQU   *                                                        45480002
         MVC   HDRBUF(L'HDRBACK),HDRBACK  HEADER TO HEADER BUFFER       45540002
         MVI   HDRLEN,L'HDRBACK    LENGTH OF FIELD HEADER               45600002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              45660002
         LA    R8,TCBBACK          BACK ENTRY IN TCB                    45720002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      45780002
TCB224S  EQU   *                                                        45840002
         MVC   HDRBUF(L'HDRRTWA),HDRRTWA HEADER TO HEADER BUFFER        45890002
         MVI   HDRLEN,L'HDRRTWA    LENGTH OF FIELD HEADER               45892002
         MVI   FLDLEN,FOUR         NO BYTES IN THE FIELD                45894002
         LA    R8,TCBRTWA          RTWA ENTRY IN TCB                    45896002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      46140002
TCB228S  EQU   *                                                        46200002
         MVC   HDRBUF(L'HDRIOTIM),HDRIOTIM  HEADER TO HEADER BUFFER     46260002
         MVI   HDRLEN,L'HDRIOTIM   LENGTH OF FIELD HEADER               46320002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              46380002
         LA    R8,TCBIOTIM         IOTIM ENTRY IN TCB                   46440002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      46500002
TCB232S  EQU   *                                                        46560002
         MVC   HDRBUF(L'HDRTMSAV),HDRTMSAV  HEADER TO HEADER BUFFER     46620002
         MVI   HDRLEN,L'HDRTMSAV   LENGTH OF FIELD HEADER               46680002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              46740002
         LA    R8,TCBTMSAV         TMSAV ENTRY IN TCB                   46800002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      46860002
TCB236S  EQU   *                                                        46920002
         MVC   HDRBUF(L'HDRABCUR),HDRABCUR  HEADER TO HEADER BUFFER     46980002
         MVI   HDRLEN,L'HDRABCUR   LENGTH OF FIELD HEADER               47040002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              47100002
         LA    R8,TCBABCUR         TMSAV ENTRY IN TCB                   47160002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      47220002
TCB237S  EQU   *                   RESERVED ROUTINE                     47270002
         MVC   HDRBUF(L'HDRRSVD),HDRRSVD   HEADER TO HEADER BUFFER      47320002
         MVI   HDRLEN,L'HDRRSVD    LENGTH OF FIELD HEADER               47370002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              47420002
         LA    R8,TCBABCUR+ONE     RESERVED FIELD IN TCB                47470002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      47520002
TCB238S  EQU   *                                                        47640002
         MVC   HDRBUF(L'HDRTID),HDRTID  HEADER TO HEADER BUFFER         47700002
         MVI   HDRLEN,L'HDRTID     LENGTH OF FIELD HEADER               47760002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              47820002
         LA    R8,TCBTID           TID ENTRY IN TCB                     47880002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      47940002
TCB239S  EQU   *                                                        48000002
         MVC   HDRBUF(L'HDRRSVD),HDRRSVD  HEADER TO HEADER BUFFER       48060002
         MVI   HDRLEN,L'HDRRSVD    LENGTH OF FIELD HEADER               48120002
         MVI   FLDLEN,FIVE         NO. BYTES IN THIS FIELD              48180002
         LA    R8,TCBTID+ONE       RESERVED ENTRY IN TCB                48240002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      48300002
TCB244S  EQU   *                                                        49080002
         MVC   HDRBUF(L'HDRFOE),HDRFOE  HEADER TO HEADER BUFFER         49140002
         MVI   HDRLEN,L'HDRFOE     LENGTH OF FIELD HEADER               49200002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              49260002
         LA    R8,TCBFOE           FOE ENTRY IN TCB                     49320002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      49380002
TCB248S  EQU   *                                                        49440002
         MVC   HDRBUF(L'HDRSWA),HDRSWA  HEADER TO HEADER BUFFER         49500002
         MVI   HDRLEN,L'HDRSWA     LENGTH OF FIELD HEADER               49560002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              49620002
         LA    R8,TCBSWA           SWA ENTRY IN TCB                     49680002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      49740002
TCB249S  EQU   *                                                        49790002
         MVC   HDRBUF(L'HDRRSVD),HDRRSVD  HEADER TO HEADER BUFFER       49792002
         MVI   HDRLEN,L'HDRRSVD    LENGTH OF FIELD HEADER               49794002
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              49796002
         LA    R8,TCBSWA+FOUR      RSVD ENTRY IN TCB                    49798002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      49798402
TCB250S  EQU   *                                                        49798802
         MVC   HDRBUF(L'HDRTCBID),HDRTCBID  HEADER TO HEADER BUFFER     49799202
         MVI   HDRLEN,L'HDRTCBID   LENGTH OF FIELD HEADER               49799602
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              49799702
         LA    R8,TCBTCBID         TCBID ENTRY IN TCB                   49799802
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      49799902
TCB251S  EQU   *                                                        49819902
         MVC   HDRBUF(L'HDRRTM12),HDRRTM12  HEADER TO HEADER BUFFER     49829902
         MVI   HDRLEN,L'HDRRTM12   LENGTH OF FIELD HEADER               49839902
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              49846602
         LA    R8,TCBRTM12         GTFA ENTRY IN TCB                    49848602
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      49850602
TCB2511S EQU   *                                                        49852602
         MVC   HDRBUF(L'HDRESTAE),HDRESTAE  HEADER TO HEADER BUFFER     49853002
         MVI   HDRLEN,L'HDRESTAE   LENGTH OF FIELD HEADER               49853102
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              49853202
         LA    R8,TCBESTAE         ESTAE ENTRY IN TCB                   49869902
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      49879902
TCB2512S EQU   *                                                        49881902
         MVC   HDRBUF(L'HDRRSVD),HDRRSVD  HEADER TO HEADER BUFFER       49883902
         MVI   HDRLEN,L'HDRRSVD    LENGTH OF FIELD HEADER               49885902
         MVI   FLDLEN,FOUR         NO. BYTES IN THIS FIELD              49886302
         LA    R8,TCBESTAE+FOUR    RSVD ENTRY IN TCB                    49886402
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      49886502
TCB2513S EQU   *                                                        49892102
         MVC   HDRBUF(L'HDRCCPVI),HDRCCPVI  HEADER TO HEADER BUFFER     49894102
         MVI   HDRLEN,L'HDRCCPVI   LENGTH OF FIELD HEADER               49896102
         MVI   FLDLEN,TWO          NO. BYTES IN THIS FIELD              49896502
         LA    R8,TCBCCPVI         CCPVI ENTRY IN TCB                   49896902
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      49897302
TCB2514S EQU   *                                                        49897402
         MVC   HDRBUF(L'HDRAFFN),HDRAFFN  HEADER TO HEADER BUFFER       49897502
         MVI   HDRLEN,L'HDRAFFN    LENGTH OF FIELD HEADER               49897602
         MVI   FLDLEN,TWO          NO. BYTES IN THIS FIELD              49903202
         LA    R8,TCBAFFN          AFFN ENTRY IN TCB                    49905202
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      49907202
TCB2515S EQU   *                   FBYT1 ROUTINE                        49907602
         MVC   HDRBUF(L'HDRFBYT1),HDRFBYT1   HEADER TO HEADER BUFFER    49908002
         MVI   HDRLEN,L'HDRFBYT1   LENGTH OF FIELD HEADER               49908402
         MVI   FLDLEN,TWO          NO. BYTES IN THIS FIELD              49908502
         LA    R8,TCBFBYT1         FBYT1 FIELD IN TCB                   49908602
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      49908702
TCB2517S EQU   *                   RESERVED ROUTINE                     49944002
         MVC   HDRBUF(L'HDRRSVD),HDRRSVD   HEADER TO HEADER BUFFER      49946002
         MVI   HDRLEN,L'HDRRSVD    LENGTH OF FIELD HEADER               49946402
         MVI   FLDLEN,EIGHTEEN     NO. BYTES IN THIS FIELD              49946802
         LA    R8,TCBFBYT2+ONE     RESERVED FIELD IN TCB                49951502
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      49953502
TCB252S  EQU   *                                                        49956402
         MVC   HDRBUF(L'HDRTFLG),HDRTFLG  HEADER TO HEADER BUFFER       49961102
         MVI   HDRLEN,L'HDRTFLG    LENGTH OF FIELD HEADER               49965802
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              49980002
         LA    R8,TCBTFLG          TFLG ENTRY IN TCB                    50040002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      50100002
TCB253S  EQU   *                                                        50160002
         MVC   HDRBUF(L'HDRGTFA),HDRGTFA  HEADER TO HEADER BUFFER       50220002
         MVI   HDRLEN,L'HDRGTFA    LENGTH OF FIELD HEADER               50280002
         MVI   FLDLEN,THREE        NO. BYTES IN THIS FIELD              50340002
         LA    R8,TCBGTFA          GTFA ENTRY IN TCB                    50400002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      50460002
TCB254S  EQU   *                   RESERVED ROUTINE                     50510002
         MVC   HDRBUF(L'HDRRSVD),HDRRSVD   HEADER TO HEADER BUFFER      50560002
         MVI   HDRLEN,L'HDRRSVD    LENGTH OF FIELD HEADER               50610002
         MVI   FLDLEN,ONE          NO. BYTES IN THIS FIELD              50660002
         LA    R8,TCBGTFA+THREE    RESERVED FIELD IN TCB                50710002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      50760002
TCB257S  EQU   *                                                        50880002
         MVC   HDRBUF(L'HDRRCMP),HDRRCMP  HEADER TO HEADER BUFFER       50940002
         MVI   HDRLEN,L'HDRRCMP    LENGTH OF FIELD HEADER               51000002
         MVI   FLDLEN,THREE        NO. BYTES IN THIS FIELD              51060002
         LA    R8,TCBRCMP          RCMP ENTRY IN TCB                    51120002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      51180002
TCB258S  EQU   *                   RESERVED ROUTINE                     51230002
         MVC   HDRBUF(L'HDRRSVD),HDRRSVD   HEADER TO HEADER FUFFER      51232002
         MVI   HDRLEN,L'HDRRSVD    LENGTH OF THIS HEADER FIELD          51234002
         MVI   FLDLEN,TWENTY4      NO. BYTES IN THIS FIELD              51236002
         LA    R8,TCBRCMP+THREE    RESERVED FIELD IN TCB                51238002
         B     FLDOUTPT            GO TO COMMON CONVERSION ROUTINE      51238402
         SPACE 2                                                        51240002
CNT      EQU   (*-TCB000S)/22                                           51300002
         EJECT                                                          51360002
FLDOUTPT EQU   *                                                        51420002
         L     R10,OUTBUF          POINT TO OUTPUT BUFFER               51480002
         CLI   NOFLDFLG,HEX00      IS NO FIELDS FLAG SET                51530002
         BE    FIELDSON            NO, BRANCH TO CONTINUE               51532002
         CLC   HDRBUF(FOUR),HDRTFLG IS THIS THE TFLG FIELD              51534002
         BNE   FIELDSON            NO, BRANCH TO CONTINUE               51536002
         MVI   EXTENTFG,HEXFF      SET ENTENT FLAG ON                   51538002
         B     GRSFIELD            BRANCH TO OUTPUT TCB EXTENT HDR      51538402
FIELDSON EQU   *                                                        51538802
         CLC   HDRBUF(THREE),HDRGRS  IS THIS THE GRS FIELD              51540002
         BE    GRSFIELD            YES...                               51600002
         SPACE                                                          51660002
         SR    R7,R7               NO, CLEAR OUT REGISTER               51720002
         IC    R7,FLDLEN           LOAD LENGTH OF FIELD                 51780002
         AR    R7,R7               WILL BE TWICE AS LONG WHEN CONVERTED 51840002
*                                  TO PRINTABLE HEXADECIMAL             51900002
         SR    R11,R11             CLEAR OUT REGISTER                   51960002
         IC    R11,HDRLEN          LOAD HEADER LENGTH                   52020002
         CR    R7,R11              WHICH IS LONGER                      52080002
         BH    LENTHSET            BRANCH IF FIELD OUTPUT IS LONGER     52140002
HDRLONGR EQU   *                                                        52200002
         IC    R7,HDRLEN           HEADER IS LONGER                     52260002
LENTHSET EQU   *                                                        52320002
         AR    R7,R2               ADD LENGTH TO CURRENT OFFSET         52380002
         C     R7,LINELEN          WILL FIELD FIT IN LINE               52440002
         BNH   MOREROOM            IF LINE IS NOT FULL GO TO MOREROOM   52500002
OUTPTBUF EQU   *                                                        52560002
         SR    R7,R2               BUFFER IS FULL...GET CURRENT         52620002
*                                  FIELD LENGTH                         52680002
         BAL   R14,TCBIO           OUTPUT THE FIELD HEADERS             52740002
         EX    R2,MOVEINS3         MOVE FIELDS TO OUTPUT BUFFER         52800002
         BAL   R14,TCBIO           OUTPUT THE FIELDS                    52860002
         SPACE                                                          52920002
         BAL   R14,IOSPACE         GO SKIP A LINE                       52980002
         SPACE                                                          53040002
         SR    R2,R2               RESET OUTPUT COUNTER                 53100002
*********************************************************************** 53160002
*        THE FOLLOWING CODE WILL CONVERT A FIELD OF THE TCB TO        * 53220002
*        PRINTABLE HEX, STORE IT IN A TEMPORARY BUFFER, AND MOVE THE  * 53280002
*        CORRESPONDING HEADER TO THE OUTPUT BUFFER.                   * 53340002
*********************************************************************** 53400002
MOREROOM EQU   *                                                        53460002
         LR    R11,R8              GET ADDR OF TCB FIELD                53520002
GRSENTRY EQU   *                                                        53580002
         SR    R1,R1               GET LENGTH                           53630002
         IC    R1,FLDLEN           * OF FIELD TO CONVERT                53632002
         AR    R1,R11              * PLUS START OF FIELD                53632402
         BCTR  R1,R0               * - 1 = END OF FIELD                 53634002
PROTBLO1 EQU   *                   PROT CHECK HERE, IF ABEND            53636002
         IC    R1,ZERO(R1)         FORCE PROT CHK HERE IF BAD           53638002
PROTBLO2 EQU   *                   PROT CHECK HERE, IF ABEND.           53638102
*                                                                       53638402
         ST    R11,STRNGPTR        STORE ADDRESS IN PDE FOR IKJEGCVT    53640002
         MVC   LENGTH+ONE(ONE),FLDLEN   SAVE FIELD LENGTH               53700002
         MVI   FLAGS,FLAG          X'80' TO INDICATE VALUE CONVERT      53760002
         MVI   TYPECODE,TYPE       X'04' TO INDICATE CONVERT TO HEX     53820002
         SPACE                                                          53880002
         LA    R1,STRNGPTR         POINT TO TCB FIELD TO BE CONVERTED   53940002
         LCR   R0,R1               R0 NEGATIVE FOR CONVERSION FROM      54000002
*                                  BINARY TO PRINTABLE HEX              54060002
         L     R15,TSTCONVT        GET ADDR OF CONVERT                  54120002
         BALR  R14,R15             GO TO IKJEGCVT                       54180002
         LPR   R1,R1               RESTORE REGISTER 1 TO POSITIVE       54240002
         LTR   R15,R15             RETURN CODE FROM IO A ZERO           54300002
         BNZ   SEVRET              NO, GO HANDLE SERVICE ROUTINE CODE   54360002
         SPACE                                                          54420002
         L     R1,OUTBUF           YES, POINT TO OUTPUT BUFFER          54480002
         LA    R1,EIGHTY4(R1)      POINT TO FIELD BUFFER                54540002
         AR    R1,R2               ADD DISPLACEMENT                     54600002
         L     R15,CONAREA         GET CONVERTED FIELD                  54660002
         SPACE                                                          54720002
         SR    R14,R14             CLEAR OUT REGISTER                   54780002
         IC    R14,FLDLEN          GET FIELD LENGTH                     54840002
         AR    R14,R14             HEX REPRESENTATION OF FIELD WILL     54900002
*                                  BE DOUBLE ITS BINARY LENGTH          54960002
         BCTR  R14,R0              SUBTRACT ONE FOR MOVE INST           55020002
         EX    R14,MOVEINS1        MOVE CONVERTED FIELD TO WORKAREA     55080002
         IC    R14,HDRLEN          GET HEADER LENGTH                    55140002
         BCTR  R14,R0              SUBTRACT ONE FOR MOVE INST           55200002
         LR    R1,R10              GET ADDR OF HDR OUTPUT BUFFER        55260002
         AR    R1,R2               ADD CURRENT DISPLACEMENT             55320002
         EX    R14,MOVEINS2        MOVE HEADER TO OUTPUT BUFFER         55380002
         LR    R2,R7               UPDATE OUTPUT LINE LENGTH COUNTER    55440002
         LA    R2,TWO(R2)          TWO SPACES BETWEEN FIELDS            55500002
         CLI   GRSFLAG1,HEX00      GRS FIELD BEING PROCESSED            55560002
         BNE   GRSCHECK            YES...                               55620002
         LA    R6,TWO(R6)          NO, POINT TO NEXT PDE                55680002
         C     R6,ENDPDECK         ANY MORE FIELDS TO PROCESS           55740002
         BE    PDLEND              NO, GO FINISH UP                     55800002
         B     PDECHECK            YES, CHECK NEXT PDE                  55860002
*********************************************************************** 55920002
*        THE FOLLOWING CODE WILL PRINT OUT THE CONTENTS OF THE GENERAL* 55980002
*        REGISTER SAVE AREA                                           * 56040002
*********************************************************************** 56100002
GRSFIELD EQU   *                                                        56160002
         LTR   R2,R2               IS THE OUTPUT BUFFER EMPTY           56220002
         BZ    GRSSETUP            YES...DO NOT WRITE OUT BUFFER        56280002
         BAL   R14,TCBIO           NO, PUT OUT HEADERS                  56340002
         EX    R2,MOVEINS3         MOVE FIELDS TO OUTPUT BUFFER         56400002
         BAL   R14,TCBIO           PUT OUT FIELDS                       56460002
         BAL   R14,IOSPACE         GO SKIP A LINE                       56520002
         SPACE                                                          56580002
         SR    R2,R2               RESET LINE COUNTER                   56640002
GRSSETUP EQU   *                                                        56700002
         CLI   EXTENTFG,HEX00      IS EXTENT FLAG SET                   56750002
         BNE   EXTSETUP            YES, BRANCH TO OUTPUT EXT HDR        56752002
         LR    R11,R8              LOAD ADDR OF GRS FIELD               56760002
         MVI   GRSFLAG1,HEX01      INITILIZE COUNT OF REGISTERS         56820002
         MVI   GRSFLAG2,HEX01      AND LINE COUNT TO ONE                56880002
         MVC   FOUR(L'HDRGRS,R10),HDRGRS  MOVE HDR TO OUTPUT BUFFER     56940002
         IC    R2,HDRLEN           SET LENGTH OF OUTPUT                 57000002
         LA    R2,TWO(R2)          ADD 2 TO AVOID TRUNCATION OF HEADER  57060002
         BAL   R14,TCBIO           OUTPUT THE HEADER                    57120002
         MVI   FOUR(R10),BLANK                                          57180002
         MVC   FIVE(L'HDRGRS,R10),FOUR(R10)  CLEAR THE OUTPUT BUFFER    57240002
         SPACE                                                          57300002
         SR    R2,R2               SET OUTPUT LINE COUNT TO ZERO        57360002
         LA    R7,EIGHT            INITILIZE OUTPUT BUFFER OFFSET       57420002
         LA    R4,REGHDRS          PUT HDR OF 1ST REG                   57480002
         MVC   HDRBUF(THREE),ZERO(R4)  INTO OUTPUT BUFFER               57540002
         LA    R4,THREE(R4)        BUMP REG HDR POINTER                 57600002
         B     GRSENTRY            GO PROCESS FIELD                     57660002
         SPACE                                                          57720002
GRSCHECK EQU   *                                                        57780002
         CLI   GRSFLAG1,HEX04      IS THE LINE FULL YET                 57840002
         MVC   HDRBUF(THREE),ZERO(R4)  MOVE NEXT HDR TO OUTPUT BUFFER   57900002
         LA    R4,THREE(R4)        BUMP TO NEXT REG HDR                 57960002
         BE    GRSOUTPT            LINE IS FULL...PUT IT OUT            58020002
         SPACE                                                          58080002
         SR    R14,R14             NO, CLEAR OUT REGISTER               58140002
         IC    R14,GRSFLAG1        BUMP COUNTER FOR                     58200002
         LA    R14,ONE(R14)        NO. REGS PER LINE                    58260002
         STC   R14,GRSFLAG1        SAVE INCREMENTED COUNTER             58320002
         SPACE                                                          58380002
         LA    R11,FOUR(R11)       BUMP TO NEXT GRS FIELD               58440002
         LA    R7,TEN(R7)          BUMP DISPLACEMENT COUNT              58500002
         B     GRSENTRY            GO PROCESS NEXT FIELD                58560002
         SPACE                                                          58620002
GRSOUTPT EQU   *                                                        58680002
*********************************************************************** 58740002
* THIS CODE GOES TO THE TCB IO ROUTINE TO OUTPUT THE GENERAL REGISTERS* 58800002
*********************************************************************** 58860002
         BAL   R14,TCBIO           PUT OUT HEADER                       58920002
         EX    R2,MOVEINS3         MOVE FIELDS TO BUFFER                58980002
         BAL   R14,TCBIO           PUT OUT FIELDS                       59040002
         MVI   FOUR(R10),BLANK     MOVE BLANK TO HDR                    59100002
         MVC   FIVE(ONE59,R10),FOUR(R10)  OUTPUT BUFFER                 59160002
         SR    R14,R14             CLEAR OUT REGISTER                   59220002
         SR    R2,R2               RESET OUTPUT COUNTER                 59280002
         CLI   GRSFLAG2,HEX04      FOUR LINES YET                       59340002
         BE    GRSDONE             YES...                               59400002
         SPACE                                                          59460002
         LA    R7,EIGHT            NO, INIT DISPL FOR NEXT LINE         59520002
         IC    R14,GRSFLAG2        LOAD FLAG                            59580002
         LA    R14,ONE(R14)        BUMP LINE COUNTER                    59640002
         STC   R14,GRSFLAG2        STORE UPDATED FLAG                   59700002
         SPACE                                                          59760002
         LA    R11,FOUR(R11)       BUMP POINTER TO NEXT REGISTER        59820002
         MVI   GRSFLAG1,HEX01      RESET REG FIELD COUNTER              59880002
         B     GRSENTRY            GO PROCESS NEXT REG FIELD            59940002
         SPACE                                                          60000002
GRSDONE  EQU   *                                                        60060002
         LA    R6,TWO(R6)          BUMP TO NEXT PDE                     60120002
         STH   R14,GRSFLAG1        CLEAR OUT BOTH REG COUNTERS          60180002
         SPACE                                                          60240002
         BAL   R14,IOSPACE         GO SKIP A LINE                       60300002
         SPACE                                                          60360002
         B     PDECHECK            GO CHECK FOR MORE PDE'S              60420002
PDLEND   EQU   *                                                        60480002
         LTR   R2,R2               IS THE OUTPUT BUFFER EMPTY           60540002
         BZ    CHKFLD              OUTPUT BUFFER IS EMPTY...CHECK FOR   60600002
*                                  FIELD( ) SITUATION                   60660002
         SPACE                                                          60720002
         BAL   R14,TCBIO           PUT OUT HEADERS                      60780002
         EX    R2,MOVEINS3         MOVE FIELDS TO BUFFER                60840002
         BAL   R14,TCBIO           PUT OUT FIELDS                       60900002
         SPACE                                                          60960002
         BAL   R14,IOSPACE         GO SKIP A LINE                       61020002
         SPACE                                                          61080002
         B     SEVRET              GO CHECK RETURN CODES                61140002
* THIS ROUTINE OUTPUTS 'TCB EXTENT' WHEN ALL TCB IS PRINTED.            61190002
EXTSETUP EQU   *                                                        61194002
         MVC   FOUR(L'HDRTEXT,R10),HDRTEXT HEADER TO OUTPUT BUFFER      61196002
         MVI   HDRLEN,L'HDRTEXT    SET LENGTH OF OUTPUT                 61198002
         IC    R2,HDRLEN           OUTPUT LENGTH TO REG 2               61198402
         LA    R2,TWO(R2)          ADD TWO TO AVOID TRUNCATION          61198802
         BAL   R14,TCBIO           GO OUTPUT HEADER                     61199202
         MVI   FOUR(R10),BLANK     PREPARE TO CLEAR BUFFER              61199602
         MVC   FIVE(L'HDRTEXT,R10),FOUR(R10)  CLEAR OUTPUT BUFFER       61199702
         SR    R2,R2               RESET LINE COUNTER                   61199802
         MVI   EXTENTFG,HEX00      TURN OFF EXTENT FLAG                 61199902
         MVI   NOFLDFLG,HEX00      TURN OFF FIELDS FLAG                 61219902
         B     TCB252S             PICK UP TFLG ENTRY IN TCB            61229902
TCBIO    EQU   *                                                        61240002
*********************************************************************** 61260002
* THIS IS THE IO ROUTINE FOR IKJEGTCB RESPONSIBLE FOR OUTPUTTING FIELD* 61320002
* HEADERS AND FIELD CONTENTS.                                         * 61380002
*********************************************************************** 61440002
         ST    R14,REG14           SAVE REGISTER 14                     61500002
         LA    R1,OUTPTR1          POINT TO PARAMETER LIST              61560002
         L     R0,PRINTFLG         LOAD ADDRESS OF DSNAME PDE IF ANY    61620002
         LA    R14,TWO(R2)                                              61680002
         ST    R10,OUTPTR1         STORE POINTER TO OUTPUT BUFFER       61740002
         STH   R14,ZERO(R10)       STORE LENGTH OF OUTPUT BFFR          61800002
         SR    R14,R14             CLEAR OUT REGISTER                   61860002
TCBIO1   EQU   *                                                        61920002
         ST    R14,OUTPTR2         ZERO OUT SECOND WORD                 61980002
         ST    R14,PRINTFLG        INDICATE OPEN DATA SET NOW           62040002
         XC    TSTIOPRM,TSTIOPRM CLEAR PARAMETER AREA                   62090002
         IKJEGSIO DATA,DATAPTR=(R10),DSNAME=(R0),ID=TCB31,             *62090402
               MF=(E,TSTIOPRM)     CALL IO                              62094002
         LTR   R15,R15             TEST RET CODE FROM IO                62094402
         BNZ   TESTRC1             NOT ZERO, CLEAN UP AND EXIT          62094802
         L     R14,REG14           YES, RESTORE REGISTER 14             62340002
         BR    R14                 RETURN TO MAIN LINE OF MODULE        62400002
         SPACE                                                          62460002
*********************************************************************** 62520002
*                                                                     * 62580002
*        THE FOLLOWING CODE WILL SPACE ONE LINE                       * 62640002
*                                                                     * 62700002
*********************************************************************** 62760002
         SPACE                                                          62820002
IOSPACE  EQU   *                                                        62880002
         MVI   FOUR(R10),BLANK     CLEAR THE                            62940002
         MVC   FIVE(ONE59,R10),FOUR(R10)  OUTPUT BUFFER                 63000002
         SPACE                                                          63060002
         ST    R14,REG14           SAVE RETURN REG                      63120002
         XR    R14,R14             CLEAR OUT REGISTER                   63180002
         ST    R14,ZERO(R10)       ZERO LENGTH TO SPACE ONE LINE        63240002
         LA    R1,OUTPTR1          POINT TO PARAMETER LIST              63300002
         B     TCBIO1              GO SKIP A LINE                       63360002
*                                                                     * 63420002
*********************************************************************** 63480002
*   THE FOLLOWING CODE PROCESSES THE VARIOUS RETURN CODES AND         * 63540002
*   INITIALIZES TO PRINT ANY NECESSARY MESSAGES.                      * 63600002
*********************************************************************** 63660002
CHKFLD   EQU   *                                                        63720002
         L     R14,REG14           CHECK IF 'FIELD( )' WAS              63780002
         LTR   R14,R14             SPECIFIED...IF SO, THE TCBIO RTN     63840002
*                                  WAS NOT ENTERED & REG14 = 0.         63900002
         BNZ   RETURN              OK...RETURN                          63960002
         SPACE                                                          64020002
         LA    R2,M0016            MSG-TCB FIELD NAME REQUIRED          64070002
         LA    R3,ZERO             NO SECOND LEVEL MESSAGE              64072002
         B     MSG1                GO OUTPUT THE MESSAGE                64074002
         SPACE                                                          64320002
         SPACE                                                          64380002
TCBRET1  EQU   *                   PARSE RETURN CODE                    64440002
         AR    R15,R15             DOUBLE FOR PROPER ADDRESSING         64500002
         LA    R3,PARSETAB(R15)    POINT TO CORRECT SECTION IN TABLE    64560002
         BR    R3                  GO TO PROPER SECTION FOR R.C.        64740002
PARSETAB EQU   *                                                        64800002
         NOP   PARSETAB            RC=0, NEVER EXECUTED                 64860002
         NOP   PARSETAB            RC=0, NEVER EXECUTED                 64920002
         B     FLUSHIT             INDICATE IKJEGMNL SHOULD FLUSH STACK 64980002
         NOP   PARSETAB            PUT IN FOR ALIGNMENT PURPOSES        65040002
         LA    R15,SIXTEEN         RC=8, ATTENTION                      65100002
         B     RETURN              RETURN TO IKJEGMNL                   65160002
         LA    R2,M0104            RC=12, MSG-TCB FAILED                65210002
         B     RC12MSG             BRANCH TO SET UP REST OF IO          65212002
         LA    R2,M0103            RC=16, MSG-NOT ENOUGH CORE           65214002
         B     RC16MSG             BRANCH TO SET UP REST OF IO          65216002
         B     CHKRTN              RC=20-CHECK SERVICE RTN RETURN CODE  65460002
         NOP   PARSETAB            NOT EXECUTED                         65520002
RC12MSG  LA    R3,M0277            MSG-PARSE ERROR CODE 12              65570002
         B     MSG4                GO OUTPUT THE MESSAGES               65572002
RC16MSG  LA    R3,ZERO             NO SECOND LEVEL MESSAGE              65574002
         B     MSG1                GO OUTPUT THE MESSAGE                65576002
CHKRTN   EQU   *                                                        66180002
         L     R15,REG15           PUT SAVED RETURN CODE INTO REG 15    66240002
SEVRET   EQU   *                                                        66300002
         CH    R15,ATTNCODE        COMPARE RET CODE TO 16               66350002
         BNL   RETURN              RET CODE IS 16 OR GREATER            66352002
         B     RETURN0             RET CODE IS LESS THAN 16             66354002
         SPACE                                                          66900002
RETURN   EQU   *                                                        66960002
         LR    R2,R15              SAVE RET CODE OVER ESTAE             66970002
         ESTAE 0                   REMOVE ESTAE REQUEST                 67010002
         LR    R15,R2              RESTORE RET CODE                     67010402
         NI    TSTFLGS4,HEXFF-TSTRERTN  SHUT OFF RETRY FLAG             67012002
RETURNS  EQU   *                   RETURN TO MAINLINE                   67014002
         NI    TSTFLGS1,(HEXFF-TSTPRINT)  TURN OFF PRINT FLG            67020002
         L     R13,FOUR(R13)       RESTORE IKJEGMNL REGISTERS AND       67080002
         RETURN (14,12),T,RC=(15)  RETURN TO MAINLINE                   67140002
FLUSHIT  EQU   *                                                        67200002
         OI    TSTFLGS4,TSTFLUSH   INDICATE TO IKJEGMNL TO FLUSH STACK  67260002
RETURN0  EQU   *                                                        67320002
         XR    R15,R15             SET RETURN CODE TO 0                 67380002
         B     RETURN              GO RETURN TO IKJEGMNL                67440002
         EJECT                                                          67500002
*  ENTRY POINT TO THE STAE RETRY ROUTINE.  ENTERED FROM IKJEGSTA     *  67560002
         SPACE                                                          67620002
TCBRTRY  EQU   *                                                        67680002
         USING *,R15                                                    67740002
         L     R4,CVTADDR          LOAD ADDRESS OF CVT                  67800002
         USING CVTDSECT,R4         ESTABLISH ADDRESSABILITY             67860002
         L     R4,CVTTCBP          LOAD ADDRESS OF TCB POINTERS         67920002
         DROP  R4                  RELEASE REG 4                        67980002
         L     R4,ZERO(R4)         LOAD ADDRESS OF TEST TCB             68040002
         USING TCB,R4              ESTABLISH ADDRESSABILITY             68100002
         L     R9,TCBTRN           LOAD ADDRESS OF TCOMTAB              68160002
         L     R12,TCBADR                                               68220002
         USING IKJEGTCB,R12                                             68280002
         DROP  R15                                                      68340002
         DROP  R4                  RELEASE REG 4                        68400002
         L     R13,REGSAVE2        POINT TO TCB REGISTERS               68700002
         LA    R15,TWENTY          SET RETURN CODE                      68760002
         B     RETURN              RETURN TO IKJEGMNL                   68820002
ICTABLE  EQU   *                                                        68880002
         DC    AL1(I0099),AL3(PARSEBLO)  *                              68940002
         DC    AL1(I0097),AL3(PROTBLO1)   *                             68990002
         DC    AL1(I0097),AL3(PROTBLO2)   *                             68992002
         DC    AL1(HEXFF)                   *                           69000002
         SPACE 1                                                        69170002
CONSTANT DC    50C'Z'              PATCH AREA                           69220002
ATTNCODE DC    H'16'               HALFWORD OF 16                       69270002
         EJECT                                                          69420002
* THE FOLLOWING ARE MESSAGE OUTPUTTING ROUTINES.                        69470002
MSG1     XC    TSTIOPRM,TSTIOPRM   CLEAR THE PARAMETER AREA             69472002
         IKJEGSIO MSG,FIRST=(R2),SECOND=(R3),ID=TCB31,                 *69474002
               MF=(E,TSTIOPRM)     CALL IO                              69476002
TESTRC1  CH    R15,ATTNCODE        IS RET CODE LESS 16                  69478002
         BNL   RETURN              NO, RETURN                           69478402
         B     RETURN0             YES, SET RC=0, RETURN                69478802
         SPACE                                                          69479202
MSG2     XC    TSTIOPRM,TSTIOPRM   CLEAR THE PARAMETER AREA             69479602
         IKJEGSIO MSG,FIRST=(R2),INST11=(APDE,(R4)),SECOND=(R3),       *69479702
               ID=TCB31,MF=(E,TSTIOPRM)  CALL IO                        69479802
TESTRC2  CH    R15,ATTNCODE        IS RET CODE LESS 16                  69479902
         BNL   SET12               NO, GIVE RC=12 TO PARSE              69499902
         B     SET8                YES, GIVE RC=8 TO PARSE              69509902
         SPACE                                                          69519902
MSG3     XC    TSTIOPRM,TSTIOPRM   CLEAR PARAMETER AREA                 69526602
         IKJEGSIO MSG,FIRST=(R2),INST11=(APDE,(R4)),SECOND=(R3),       *69528602
               INST21=(NUM,I0003),ID=TCB31,MF=(E,TSTIOPRM)              69530602
         B     TESTRC2             BRANCH TO TEST RET CODE              69531002
         SPACE                                                          69533202
MSG4     XC    TSTIOPRM,TSTIOPRM   CLEAR PARAMETER AREA                 69549902
         IKJEGSIO MSG,FIRST=(R2),INST11=(NUM,I0008),SECOND=(R3),       *69559902
               ID=TCB31,MF=(E,TSTIOPRM)  CALL IO                        69561902
         B     TESTRC1             BRANCH TO TEST RET CODE              69562302
         SPACE                                                          69566402
LINKFAIL XC    TSTIOPRM,TSTIOPRM   CLEAR PARAMETER AREA                 69566502
         LR    R3,R1               ABEND CODE TO REG 3                  69572102
         LR    R4,R15              RET CODE TO REG 4                    69574102
         IKJEGSIO SVCERR,SVC=6,ABENDRG=(R3),RC=(R4),                   *69576202
               ID=TCB31,INST11=(NUM,I0040),MF=(E,TSTIOPRM) CALL IO      69576502
         B     TESTRC1             BRANCH TO TEST RET CODE              69576602
         SPACE                                                          69577002
LISTESTA IKJEGSPL RTRY=TCBRTRY,ABNTB=ICTABLE,MODNM=IKJEGTCB,           *69577402
               TNM=LISTTCB  BUILD PARAMETER LIST FOR ESTAE              69581902
         EJECT                                                          69586502
MYWKAREA DSECT                                                          69591002
* IT IS ESSENTIAL THAT THE FOLLOWING 7 AREAS BE CONTIGUOUS AND IN ORDER 69595502
STAESTUF DS    4F                  AREA FOR STAE LIST                   69600002
GRSFLAG1 DS    CL1                 TCBGRS FIELD FLAG                    69660002
GRSFLAG2 DS    CL1                 TCBGRS FIELD FLAG                    69720002
FLDLEN   DS    CL1                 LENGTH OF TCB FIELD                  69780002
HDRLEN   DS    CL1                 LENGTH OF HEADER                     69840002
HDRBUF   DS    2F                  BUFFER FOR HEADER                    69900002
LINELEN  DS    1F                  OUTPUT LINE LENGTH                   69960002
ENDPDECK DS    1F                  ADDR OF LAST FIELD PDE +2            70020002
PRINTFLG DS    1F                  ADDR OF DSNAME PDE                   70080002
REG14    DS    1F                  REGISTER 14                          70140002
REG15    DS     F                  RETURN CODE FROM SERVICE             70200002
NOFLDFLG DS    CL1                 NO FIELDS SPECIFIED FLAG             70250002
EXTENTFG DS    CL1                 EXTENT PRINTED FLAG                  70252002
*                                  ROUTINE SAVEAREA                     70260002
* IT IS ESSENTIAL THAT THE FOLLOWING 4 AREAS BE CONTIGUOUS AND IN ORDER 70320002
STRNGPTR DS    1F                  PT TO FIELD TO BE CONVERTED          70380002
LENGTH   DS    CL2                 LENGTH OF FIELD TO BE CONVERTED      70440002
FLAGS    DS    CL1                 FLAG FOR IKJEGCVT                    70500002
TYPECODE DS    CL1                 TYPE OF DATA TO BE CONVERTED (HEX)   70560002
* IT IS ESSENTIAL THAT THE FOLLOWING 2 AREAS BE CONTIGUOUS AND IN ORDER 70620002
OUTPTR1  DS    1F                  PT TO FIRST OUTPUT BUFFER            70680002
OUTPTR2  DS    1F                  PT TO SECOND LEVEL MSG IF ANY        70740002
TEMP3    DS    3F                  WORK AREA FOR SVC 97                 70790002
         EJECT                                                          70800002
IKJEGTCB CSECT                                                          74760002
** THE DECLARED CONSTANTS FOR THE IKJEGTCB MODULE.                  **  74820002
HDRRBP   DC    C'RBP'              RBP HEADER OF TCB                    74880002
HDRPIE   DC    C'PIE'              PROGRAM INTERRUPT ELEMENT HDR        74940002
HDRDEB   DC    C'DEB'              DATA EXTENT BLOCK HDR                75000002
HDRTIO   DC    C'TIO'              TASK I/O HEADER                      75060002
HDRCMP   DC    C'CMP'              TASK COMPLETION CODE HDR             75120002
HDRTRN   DC    C'TRN'              TESTRAN HDR                          75180002
HDRMSS   DC    C'MSS'              SUBPOOL SPQE HDR                     75240002
HDRPKF   DC    C'PKF'              PROTECTION KEY HDR                   75300002
HDRFLGS  DC    C'FLGS'             MISC FLAGS HDR                       75360002
HDRLMP   DC    C'LMP'              LIMIT PRIORITY HDR                   75420002
HDRDSP   DC    C'DSP'              DISPATCHING PRIORITY HDR             75480002
HDRLLS   DC    C'LLS'              LOAD LIST ADDR HDR                   75540002
HDRJLB   DC    C'JLB'              JOBLIB DCB ADDR HDR                  75600002
HDRJPQ   DC    C'JPQ'              JOB PACK CDE ADDR HDR                75660002
HDRGRS   DC    C'GRS'              GENERAL REGISTER HDR                 75720002
HDRQEL   DC    C'QEL'              ENQUEUE COUNT HDR                    75780002
HDRFSAB  DC    C'FSAB'             FIRST PARM SAVE AREA ADDR HDR        75840002
HDRTCB   DC    C'TCB'              DAUGHTER TCB ADDR HDR                75900002
HDRTME   DC    C'TME'              TIMER ADDR HDR                       75960002
HDRJSTCB DC    C'JSTCB'            JOB STEP TCB ADDR HDR                76020002
HDRNTC   DC    C'NTC'              PREVIOUS SUBTASK TCB ADDR HDR        76080002
HDROTC   DC    C'OTC'              ORIGINATING TCB ADDR HDR             76140002
HDRLTC   DC    C'LTC'              SUBTASK LAST TCB ADDR HDR            76200002
HDRIQE   DC    C'IQE'              IQE ADDR HDR                         76260002
HDRECB   DC    C'ECB'              EVENT CONTROL BLOCK ADDR HDR         76320002
HDRTSFLG DC    C'TSFLG'            FLAG HDR                             76380002
HDRSTPCT DC    C'STPCT'            STPCT HDR                            76440002
HDRTSLP  DC    C'TSLP'             TSLP HDR                             76500002
HDRTSDP  DC    C'TSDP'             TSDP HDR                             76560002
HDRPQE   DC    C'PQE'              PARTITION QUEUE ELEMENT ADDR HDR     76620002
HDRAQE   DC    C'AQE'              ALLOCATED QUEUE ELEMENT ADDR HDR     76680002
HDRNSTAE DC    C'NSTAE'            STAE FLAGS HDR                       76740002
HDRSTABB DC    C'STABB'            CURRENT STAE ADDR HDR                76800002
HDRTCTR  DC    C'TCTR'             TCT FLAG HDR                         76860002
HDRTCT   DC    C'TCT'              TIMING CONTROL TABLE ADDR HDR        76920002
HDRUSER  DC    C'USER'             USER FIELD HDR                       76980002
HDRNDSP0 DC    C'NDSP0'            -                                    77040002
HDRNDSP1 DC    C'NDSP1'            NON - DISPATCHABILITY                77100002
HDRNDSP2 DC    C'NDSP2'            HEADERS                              77160002
HDRNDSP3 DC    C'NDSP3'            HEADER                               77220002
HDRRSVD  DC    C'RESERVED'         RESERVED WORD HEADER                 77280002
HDRJSCB  DC    C'JSCB'             JOB STEP CONTROL BLOCK ADDR HDR      77340002
HDREXT1  DC    C'EXT1'             ADDR OS-AOS COMMON TCB EXTENSION     77400002
HDRNDSP4 DC    C'NDSP4'            SECONDARY NONDISPATCHABILITY FLAGS   77460002
HDRNDSP5 DC    C'NDSP5'            SEC NON FLAGS UNIQUE TO AOS/2        77520002
HDRFLGS6 DC    C'FLGS6'            TASK RELATED FLAGS COMMON TO AOS1-2  77580002
HDRFLGS7 DC    C'FLGS7'            TASK RELATED FLAGS UNIQUE TO AOS2    77640002
HDRDAR   DC    C'DAR'              DAMAGE ASSESSMENT RTN HDR            77700002
HDREXT2  DC    C'EXT2'             ADDR AOS1-AOS2 COMMON TCB EXTENSION  77760002
HDRTIRB  DC    C'TIRB'             ADDRESS OF TIRB FOR TASK             78000002
HDRBACK  DC    C'BACK'             ADDR OF PREVIOUS TCB ON READY QUE    78060002
HDRRTWA  DC    C'RTWA'             ADDR OF CURRENT RTM2 WORKAREA        78170002
HDRIOTIM DC    C'IOTIM'            TIME                                 78180002
HDRTMSAV DC    C'TMSAV'            TIME                                 78240002
HDRABCUR DC    C'ABCUR'            ABEND RECURSION BYTE                 78300002
HDRSYSCT DC    C'SYSCT'            'SYSTEM MUST CONPLETE' COUNT         78360002
HDRTID   DC    C'TID'              TASK ID NUMBER                       78420002
HDRFOE   DC    C'FOE'              @ 1ST FIX OWNERSHIP ELEMENT          78600002
HDRSWA   DC    C'SWA'              ADDRESS OF 1ST SCHEDULER WORK AREA   78660002
HDRTFLG  DC    C'TFLG'             GTF FLAG BYTE                        78720002
HDRGTFA  DC    C'GTFA'             ADDRESS OF TEMPORARY TRACE BUFFER    78780002
HDRRCMP  DC    C'RCMP'             ABTERM COMP CODE ON VALID STAE REC   78840002
HDRDDEXC DC    C'DDEXC'            DDEXC HEADER                         78890002
HDRDDWTC DC    C'DDWTC'            DDWTC HEADER                         78892002
HDRIOBRC DC    C'IOBRC'            IOBRC HEADER                         78894002
HDRSTMCT DC    C'STMCT'            STMCT HEADER                         78896002
HDRAECB  DC    C'AECB'             AECB HEADER                          78898002
HDRTCBID DC    C'TCBID'            TCBID HEADER                         78898402
HDRRTM12 DC    C'RTM12'            RTM12 HEADER                         78898802
HDRESTAE DC    C'ESTAE'            ESTAE HEADER                         78899202
HDRCCPVI DC    C'CCPVI'            CCPVI HEADER                         78899602
HDRAFFN  DC    C'AFFN'             AFFN HEADER                          78899702
HDRFBYT1 DC    C'FBYT1-2'            FBYT1 HEADER                       78899802
HDRTEXT  DC    C'TCB EXTENT'       TCB EXTENT HEADER                    78919902
         SPACE 1                                                        78940002
TCBADR   DC    A(IKJEGTCB)         ADDRESS OF BEGINNING OF MODULE       78960002
         SPACE                                                          79080002
PARSADR  DC    V(IKJEGPCL)         ADDR OF PARAMETER LIST FOR PARSE     79140002
MOVEINS1 MVC   ZERO(ZERO,R1),ONE(R15)   MOVE CONVERTED FIELDS           79260002
MOVEINS2 MVC   FOUR(ZERO,R1),HDRBUF     MOVE HEADER TO OUTPUT BUFFER    79320002
MOVEINS3 MVC   FOUR(ZERO,R10),EIGHTY4(R10)  INST TO MOVE TCB FIELDS     79380002
*                                  TO OUTPUT BUFFER                     79440002
         DS    0F                                                       79560002
REGHDRS  DC    C'R0 R1 R2 R3 '     REGISTER HEADERS                     79620002
         DC    C'R4 R5 R6 R7 '     *                                    79680002
         DC    C'R8 R9 R10R11'     *                                    79740002
         DC    C'R12R13R14R15'     *                                    79800002
         EJECT                                                          79860002
IKJEGPCL IKJPARM                                                        79920002
ADDRTCB  IKJKEYWD                                                       79980002
         IKJNAME  'ADDR',SUBFLD=TCBADDR                                 80040002
PRINTIT  IKJKEYWD                                                       80100002
         IKJNAME   'PRINT',SUBFLD=DSNAME                                80160002
TCBFIELD IKJKEYWD                                                       80220002
         IKJNAME   'FIELD',SUBFLD=FIELDNAM                              80280002
DSNAME   IKJSUBF                                                        80340002
DSNAM    IKJPOSIT  DSNAME,PROMPT='DSNAME'                               80400002
TCBADDR  IKJSUBF                                                        80460002
ADDRESS  IKJPOSIT  ADDRESS,VALIDCK=IKJEGVCK,PROMPT='ADDRESS'            80520002
FIELDNAM IKJSUBF                                                        80580002
RBP      IKJKEYWD                                                       80640002
         IKJNAME   'TCBRBP'                                             80700002
PIE      IKJKEYWD                                                       80760002
         IKJNAME   'TCBPIE'                                             80820002
DEB      IKJKEYWD                                                       80880002
         IKJNAME   'TCBDEB'                                             80940002
TIO      IKJKEYWD                                                       81000002
         IKJNAME   'TCBTIO'                                             81060002
CMP      IKJKEYWD                                                       81120002
         IKJNAME   'TCBCMP'                                             81180002
TRN      IKJKEYWD                                                       81240002
         IKJNAME   'TCBTRN'                                             81300002
MSS      IKJKEYWD                                                       81360002
         IKJNAME   'TCBMSS'                                             81420002
PKF      IKJKEYWD                                                       81480002
         IKJNAME   'TCBPKF'                                             81540002
FLGS     IKJKEYWD                                                       81600002
         IKJNAME   'TCBFLGS'                                            81660002
LMP      IKJKEYWD                                                       81720002
         IKJNAME   'TCBLMP'                                             81780002
DSP      IKJKEYWD                                                       81840002
         IKJNAME   'TCBDSP'                                             81900002
LLS      IKJKEYWD                                                       81960002
         IKJNAME   'TCBLLS'                                             82020002
JLB      IKJKEYWD                                                       82080002
         IKJNAME   'TCBJLB'                                             82140002
JPQ      IKJKEYWD                                                       82200002
         IKJNAME   'TCBJPQ'                                             82260002
GRS      IKJKEYWD                                                       82320002
         IKJNAME   'TCBGRS'                                             82380002
QEL      IKJKEYWD                                                       82440002
         IKJNAME   'TCBQEL'                                             82500002
FSAB     IKJKEYWD                                                       82560002
         IKJNAME   'TCBFSAB'                                            82620002
TCB1     IKJKEYWD                                                       82680002
         IKJNAME   'TCBTCB'                                             82740002
TME      IKJKEYWD                                                       82800002
         IKJNAME   'TCBTME'                                             82860002
JSTCB    IKJKEYWD                                                       82920002
         IKJNAME   'TCBJSTCB'                                           82980002
NTC      IKJKEYWD                                                       83040002
         IKJNAME   'TCBNTC'                                             83100002
OTC      IKJKEYWD                                                       83160002
         IKJNAME   'TCBOTC'                                             83220002
LTC      IKJKEYWD                                                       83280002
         IKJNAME   'TCBLTC'                                             83340002
IQE      IKJKEYWD                                                       83400002
         IKJNAME   'TCBIQE'                                             83460002
ECB      IKJKEYWD                                                       83520002
         IKJNAME   'TCBECB'                                             83580002
TSFLG    IKJKEYWD                                                       83640002
         IKJNAME   'TCBTSFLG'                                           83700002
STPCT    IKJKEYWD                                                       83760002
         IKJNAME   'TCBSTPCT'                                           83820002
TSLP     IKJKEYWD                                                       83880002
         IKJNAME   'TCBTSLP'                                            83940002
TSDP     IKJKEYWD                                                       84000002
         IKJNAME   'TCBTSDP'                                            84060002
PQE      IKJKEYWD                                                       84120002
         IKJNAME  'TCBPQE'                                              84180002
AQE      IKJKEYWD                                                       84240002
         IKJNAME   'TCBAQE'                                             84300002
NSTAE    IKJKEYWD                                                       84360002
         IKJNAME  'TCBNSTAE'                                            84420002
STABB    IKJKEYWD                                                       84480002
         IKJNAME   'TCBSTABB'                                           84540002
TCT      IKJKEYWD                                                       84600002
         IKJNAME   'TCBTCT'                                             84660002
USER     IKJKEYWD                                                       84720002
         IKJNAME  'TCBUSER'                                             84780002
NDSP0    IKJKEYWD                                                       84840002
         IKJNAME   'TCBNDSP0'                                           84900002
NDSP1    IKJKEYWD                                                       84960002
         IKJNAME   'TCBNDSP1'                                           85020002
NDSP2    IKJKEYWD                                                       85080002
         IKJNAME   'TCBNDSP2'                                           85140002
NDSP3    IKJKEYWD                                                       85200002
         IKJNAME   'TCBNDSP3'                                           85260002
RSRVD    IKJKEYWD                                                       85320002
         IKJNAME   'RESERVED'                                           85380002
JSCB     IKJKEYWD                                                       85440002
         IKJNAME   'TCBJSCB'                                            85500002
DDEXC    IKJKEYWD                                                       85550002
         IKJNAME   'TCBDDEXC'                                           85552002
DDWTC    IKJKEYWD                                                       85554002
         IKJNAME   'TCBDDWTC'                                           85556002
IOBRC    IKJKEYWD                                                       85558002
         IKJNAME   'TCBIOBRC'                                           85558402
RSVD2    IKJKEYWD                                                       85560002
         IKJNAME   'RSVD2'                                              85620002
EXT1    IKJKEYWD                                                        85680002
         IKJNAME   'TCBEXT1'                                            85740002
NDSP4    IKJKEYWD                                                       85800002
         IKJNAME   'TCBNDSP4'                                           85860002
NDSP5    IKJKEYWD                                                       85920002
         IKJNAME   'TCBNDSP5'                                           85980002
FLGS6    IKJKEYWD                                                       86040002
         IKJNAME   'TCBFLGS6'                                           86100002
FLGS7    IKJKEYWD                                                       86160002
         IKJNAME   'TCBFLGS7'                                           86220002
DAR      IKJKEYWD                                                       86280002
         IKJNAME   'TCBDAR'                                             86340002
RSVD     IKJKEYWD                                                       86400002
         IKJNAME   'TCBRSVD'                                            86460002
SYSCT    IKJKEYWD                                                       86510002
         IKJNAME   'TCBSYSCT'                                           86512002
STMCT    IKJKEYWD                                                       86514002
         IKJNAME   'TCBSTMCT'                                           86516002
EXT2     IKJKEYWD                                                       86520002
         IKJNAME   'TCBEXT2'                                            86580002
AECB     IKJKEYWD                                                       86640002
         IKJNAME   'TCBAECB'                                            86700002
TIRB     IKJKEYWD                                                       87120002
         IKJNAME   'TCBTIRB'                                            87180002
BACK     IKJKEYWD                                                       87240002
         IKJNAME   'TCBBACK'                                            87300002
RTWA     IKJKEYWD                                                       87350002
         IKJNAME   'TCBRTWA'                                            87352002
IOTIM    IKJKEYWD                                                       87480002
         IKJNAME   'TCBIOTIM'                                           87540002
TMSAV    IKJKEYWD                                                       87600002
         IKJNAME   'TCBTMSAV'                                           87660002
ABCUR    IKJKEYWD                                                       87720002
         IKJNAME   'TCBABCUR'                                           87780002
RSVD3    IKJKEYWD                                                       87830002
         IKJNAME   'RSVD3'                                              87880002
TID      IKJKEYWD                                                       87960002
         IKJNAME   'TCBTID'                                             88020002
RSVD4    IKJKEYWD                                                       88080002
         IKJNAME   'RSVD4'                                              88140002
FOE      IKJKEYWD                                                       88440002
         IKJNAME   'TCBFOE'                                             88500002
SWA      IKJKEYWD                                                       88560002
         IKJNAME   'TCBSWA'                                             88620002
RSVD5    IKJKEYWD                                                       88670002
         IKJNAME   'RSVD5'                                              88672002
TCBID    IKJKEYWD                                                       88674002
         IKJNAME   'TCBTCBID'                                           88676002
RTM12    IKJKEYWD                                                       88678002
         IKJNAME   'TCBRTM12'                                           88678402
ESTAE    IKJKEYWD                                                       88678802
         IKJNAME   'TCBESTAE'                                           88679202
RSVD6    IKJKEYWD                                                       88679602
         IKJNAME   'RSVD6'                                              88679702
CCPVI    IKJKEYWD                                                       88679802
         IKJNAME   'TCBCCPVI'                                           88679902
AFFN     IKJKEYWD                                                       88699902
         IKJNAME   'TCBAFFN'                                            88709902
FBYT1    IKJKEYWD                                                       88719902
         IKJNAME   'TCBFBYT1'                                           88726602
RSVD7    IKJKEYWD                                                       88732602
         IKJNAME   'RSVD7'                                              88733002
TFLG     IKJKEYWD                                                       88733302
         IKJNAME   'TCBTFLG'                                            88740002
GTFA     IKJKEYWD                                                       88800002
         IKJNAME   'TCBGTFA'                                            88860002
RSVD8    IKJKEYWD                                                       88910002
         IKJNAME   'RSVD8'                                              88960002
RCMP     IKJKEYWD                                                       89040002
         IKJNAME   'TCBRCMP'                                            89100002
RSVD9    IKJKEYWD                                                       89150002
         IKJNAME   'RSVD9'                                              89152002
         IKJENDP                                                        89160002
         EJECT                                                          89220002
CVTDSECT DSECT                                                          89280002
         CVT                                                            89340002
         EJECT                                                          89400002
         IKJTCB                                                         89460002
         SPACE 1                                                        89510002
         EJECT                                                          89520002
         TCOMTAB                                                        89580002
         SPACE                                                          89640002
         TSTCWORK                                                       89700002
         SPACE                                                          89760002
         IKJPPL                                                         89820002
         EJECT                                                          89880002
         IKJPARMA                                                       89940002
         END                                                            90000002
./  ADD  SSI=62720108,NAME=IKJEGWHR
         TITLE 'IKJEGWHR, ''WHERE'' SUBCOMMAND OF TEST'                 00080000
*C55300,65600,69400,75000                                      @YM07131 00160000
*D143200,144000,148000,160000-162400                           @ZA07138 00180003
*C144800,147200                                                @ZA07138 00200003
*********************************************************************** 00240000
*                                                                     * 00320000
* STATUS -- CHANGE LEVEL 000   VERSION NO. 02  OS/VS2                 * 00400000
*                                                                     * 00480000
* FUNCTION -- THIS SUBCOMMAND RESULTS IN THE QUALIFICATION (ABSOLUTE  * 00560000
*    ADDRESS) FOR THE SPECIFIED ADDRESS BEING DISPLAYED AT THE        * 00640000
*    TERMINAL. IF NO ADDRESS IS ENTERED THE INSTRUCTION COUNTER OF THE* 00720000
*    CURRENT PROBLEM PROGRAM IS DISPLAYED. IF AN ADDRESS IS AN        * 00800000
*    UNQUALIFIED SYMBOLIC OR RELATIVE, THE CURRENT INPLICIT           * 00880000
*    QUALIFICATION IS DISPLAYED. IF THE ADDRESS IS ABSOLUTE ADDRESS,  * 00960000
*    OR AN ADDRESS EXPRESSION, AN ATTEMPT IS MADE TO LOCATE THE       * 01040000
*    ADDRESS WITHIN THE SUBTASK CONTENTS STRUCTURE. IF THE ADDRESS IS * 01120000
*    FOUND TO FALL WITHIN THE STORAGE EXTENT OF ANY PROGRAM ASSIGNED  * 01200000
*    TO THE PROBLEM PROGRAM TASK OR ANY OF ITS SUBTASKS, THE LOCATION * 01280000
*    WITHIN THE PROGRAM OF THE SPECIFIED ADDRESS IS DISPLAYED AT THE  * 01360000
*    TERMINAL. IT IS IDENTIFIED BY LOAD MODULE NAME, ENTRYNAME (IF    * 01440000
*    THE CESD IS AVAILABLE) AND DISPLACEMENT FROM THE BEGINNING OF    * 01520000
*    THE LOWEST LEVEL OF QUALIFICATION AVAILABLE. IF MORE THAN ONE    * 01600000
*    TASK EXISTS ON THE SUB-TASK QUEUE, THE TCB ADDRESS IS ALSO       * 01680000
*    DISPLAYED. IF LOADNAME.ENTRYNAME IS SPECIFIED THE ABSOLUTE       * 01760000
*    ADDRESS OF THE SPECIFIED LOAD MODULE ENTRY POINT IS DISPLAYED.   * 01840000
*    ENTRYNAME MAY HAVE BEEN OMITTED, IN WHICH CASE THE BEGINNING     * 01920000
*    ADDRESS AT WHICH THE LOAD MODULE IS LOADED IS DISPLAYED. IF MORE * 02000000
*    THEN ONE TASK EXISTS ON THE SUBTASK QUEUE, THE TCB ADDRESS IS    * 02080000
*    ALSO DISPLAYED. IF AN IDENTICAL LOAD MODULE EXISTS ON ANOTHER    * 02160000
*    SUBTASK, THE SAME INFORMATION IS DISPLAYED AS ABOVE FOR THE      * 02240000
*    SECOND OCCURRENCE OF THE MODULE.                                 * 02320000
*                                                                     * 02400000
* ENTRY POINTS --                                                     * 02480000
*         IKJEGWHR -- INITIAL ENTRY POINT.                            * 02560000
*         ADDRVLCK -- VALIDITY CHECK ROUTINE.                         * 02640000
*                                                                     * 02720000
* INPUT -- IS IS EXPECTED THAT REGISTER 9 POINTS TO TCOMTAB UPON      * 02800000
*    ENTRY TO IKJEGWHR. TCOMTAB IS THE COMMUNICATIONS AREA FROM       * 02880000
*    WHICH ALL NEEDED INFORMATION MAY BE ACCESSED.                    * 02960000
*                                                                     * 03040000
* OUTPUT -- DATA MESSAGES CONTAINING PERTINENT INFORMATION, I.E.,     * 03120000
*    ABSOLUTE QUALIFICATION, OFFSET, LOADNAME, CSECTNAME AND TCB      * 03200000
*    ADDRESS, ARE PRINTED ON THE TERMINAL LISTING.                    * 03280000
*                                                                     * 03360000
* EXTERNAL REFERENCES --                                              * 03440000
*         IKJPARS IS ENTERED TO CHECK SYNTAX OF WHERE SUBCOMMANDS. IN * 03520000
*         ADDITION, MUCH OF THE ADDRESS PROCESSING IS DONE WHILE IN   * 03600000
*         IKJPARS.                                                    * 03680000
*                                                                     * 03760000
*         IKJEGCVT IS ENTERED TO CONVERT THE USER SUPPLIED ADDRESS    * 03840000
*         TO HEXIDECIMAL                                              * 03920000
*                                                                     * 04000000
*         IKJEGSYM IS ENTERED FIRST TO ACCESS A CSECT NAME IN THE     * 04080000
*         INDICATED LOADNAME, AND SECOND TO SEARCH THE SYMBOL TABLE   * 04160000
*         FOR A GIVEN LOADNAME.CSECT.                                 * 04240000
*                                                                     * 04320000
*         IKJEGIO IS CALLED TO PRINT INDICATED MESSAGES.              * 04400000
*                                                                     * 04480000
* EXITS, NORMAL -- WHEN ALL ADDRESS PROCESSING IS COMPLETED, IKJEGWHR * 04560000
*         RETURNS TO MAINLINE.                                        * 04640000
*                                                                     * 04720000
* EXITS, ERROR  --                                                    * 04800000
*         NONE                                                        * 04880000
*                                                                     * 04960000
* TABLES/WORK AREAS -- THE WORKAREA POINTER PROVIDED IN TCOMTAB IS    * 05040000
*    THE ONLY WORKAREA USED.                                          * 05120000
*                                                                     * 05200000
* ATTRIBUTES -- REFRESHABLE AND REENTRANT                             * 05280000
*                                                                     * 05360000
* CHARACTER CODE DEPENDENCY --                                        * 05440000
*                                                                     * 05520000
* NOTES -- IBM STANDARD LINKAGE CONVENTIONS WERE USED.                * 05600000
*                                                                     * 05680000
* CHANGE-ACTIVITY --                                                  * 05690003
*                 APAR OZ07138 - CHANGES TO USE A POINTER TO THE      * 05700003
*                 BREAKPOINT SVRB IN TCOMTAB WHEN LOOKING FOR THE     * 05710003
*                 PSW FOR THE PROBLEM PROGRAM. THE POINTER IS AT      * 05720003
*                 ECBPP+1.                                            * 05730003
*                                                                     * 05760000
*********************************************************************** 05840000
         EJECT                                                          05920000
         COPY  IKJEGSIO                                                 06000000
         EJECT                                                          06080000
IKJEGWHR CSECT                                                          06160000
         ENTRY IKJEGVLC       ENTRY POINT FOR VALIDITY CHECK            06240000
         USING TCOMTAB,R9     OF ADDRESS. ESTABLISH TCOMTAB             06320000
         SAVE (14,12)         ADDRESSIBILITY. SAVE REGISTERS            06400000
************************************************************            06480000
**                                                        **            06560000
** AFTER REGISTERS HAVE BEEN SAVED THE ADDRESS OF A       **            06640000
** SAVE AREA IS OBTAINED FROM TCOMTAB. FORWARD AND BACK   **            06720000
** WARD CHAINING IS ACCOMPLISHED. THE ADDRESS OF THE PCL  **            06800000
** (PARAMETER CONTROL LIST) IS PLACED INTO A REGISTER TO  **            06880000
** BE PUT WITHIN THE PARAMETER LIST TO BE PASSED TO PARSE.**            06960000
** THE PARAMETER LIST WILL BE BUILT IN THE WORKAREA WHOSE **            07040000
** ADDRESS IS GOTTEN FROM TCOMTAB. PARMLIST  ADDRESS IS   **            07120000
** ALSO GOTTEN FROM TCOMTAB. PARMLIST CONTAINS UPT, ECT   **            07200000
** AND CHECK ELEMENTS OF THE PARAMETER LIST. ADDRESS OF   **            07280000
** MY SAVE AREA IS ALSO PLACED INTO THE LIST. THE COMPLETE**            07360000
** LIST IS PASSED TO THE PARSING ROUTINE VIA REG 1 AND    **            07440000
** THE LINK MACRO                                         **            07520000
************************************************************            07600000
         LR    R12,R15        RESTORE R12 TO BEGINNING ADDR             07680000
         USING IKJEGWHR,R12   USE ENTERING ADDRESS FOR ADDRESSING       07760000
         L     R2,REGSAVE2    GET ADDR OF MY SAVE AREA FROM TCOMTAB     07840000
*                             ADDRESS OBTAINED FROM TCOMTAB             07920000
         ST    R13,@4(@0,R2)  STORE CALLERS SAVE AREA ADDR              08000000
         ST    R2,@8(R13)     STORE MY SAVE IN CALLERS                  08080000
         LR    R13,R2         PLACE ADDR OF MY SAVEAREA INTO            08160000
*                             REG13                                     08240000
         L      R10,WORKAREA  ACCESS WORKAREA ADDR FROM TCOMTAB         08320000
         MVC   CWORKCMD-TSTCWORK(ENDLIST,R10),LISTSTAE STAE IN WORKAREA 08400000
         LA    R1,CWORKCMD-TSTCWORK(R10)  PARAMETER TO STAE             08480000
         L     R2,TSTSTAE     ADDR OF STAE EXIT ROUTINE                 08560000
         ST    R12,@68(R13)   SAVE BASE REGISTER                        08640000
         ESTAE (R2),PARAM=LISTESTA,RECORD=YES,MF=(E,(R1))  ISSUE ESTAE  08720000
         LTR   R15,R15        TEST STAE RETURN CODE                     08800000
SMTSTAE  DS    0H             TEST CASE TWHR2700                        08880000
         BZ    ESTAEOK        BRANCH IF ESTAE ISSUED IS OK              08960000
         STC   R15,TSTESTRC   STORE RET. CODE IN TCOMTAB                09040000
         LA    R15,@24        SEND RC=24 TO MAINLINE                    09120000
         B     RETS           BRANCH TO RETURN                          09200000
ESTAEOK  EQU   *              ESTAE WAS ISSUED                          09280000
         TM    TSTFLGS3,NOPARMS TEST FOR PARM FIELD WITH WHERE          09360000
         BO    A0009          IF ON, SKIP PARSE AND PROCESS IC          09440000
         EJECT                                                          09520000
         L     R4,PARSELST    LOAD PARSE TABLE ADDR INTO REG4           09600000
         L     R1,WORKAREA    LOAD WORKAREA ADDR FROM TCOMTAB           09680000
         LA     R1,PPLSAVE-TSTCWORK(R1) ACCESS COMMAND PORTION          09760000
         USING PPL,R1         ESTABLISH PPL ADDRESSABILITY              09840000
         MVC   PPLUPT(@4),TSTUPT PTR TO UPT FOR PARSE                   09920000
         MVC   PPLECT(@4),TSTECT PTR TO ECT FOR PARSE                   10000000
         MVC   PPLECB(@4),TSTCPECB PTR TO CP ECB FOR PARSE              10080000
         ST    R4,PPLPCL      PTR TO PCL FOR PARSE                      10160000
         ST    R13,PPLUWA     PTR TO MY SAVE AREA FOR PARSE             10240000
         LA    R4,TSTANSPL    ACCESS ADDR OF ANSWER PLACE               10320000
         ST    R4,PPLANS      PTR TO ANSWER PLACE FOR PARSE             10400000
         MVC   PPLCBUF(@4),INBUF PTR TO COMMAND BUFFER                  10480000
         DROP  R1             DROP PPL ADDRESSABILITY                   10560000
         LA    R4,I0040       IKJPARS INSERT                            10640000
         LINK  EP=IKJPARS,ERRET=LINKFL1                                 10720000
BLOW1    DS    0X              STAE ENTRY POINT                         10800000
SMTPARS  DS    0H             TEST CASE TWHR2600                        10880000
         BAL   R14,CHKCDE     TO TEST PARSE RETURN CODE                 10960000
         EJECT                                                          11040000
         L     R2,TSTANSPL    ACCESS PDE POINTER                        11120000
         USING IKJPARMD,R2    ESTABLISH PDL ADDRESSABILITY              11200000
         LA    R2,GETADDR     ACCESS ADDR OF PDE                        11280000
         DROP  R2             DROP PDL ADDRESSABILITY                   11360000
         USING IKJPARMA,R2    ESTABLISH PDE ADDRESSABILITY              11440000
         L     R3,PDEUSER     ACCESS USER WORD                          11520000
         LTR   R3,R3          TEST IF NO PARAMETERS ENTERED             11600000
*                             (ONLY APPLIES IF NULL RETURN IS USED      11680000
*                             DURING REENTER MODE)                      11760000
         BNZ   A0008          BYPASS PUTTING OUT IC                     11840000
         TM    PDEFLG4,ABSADDR+SYMADDR TEST FOR ABSOLUTE 0              11920000
         BZ    A0009          TO PUT OUT IC                             12000000
A0008    EQU    *             EQUATE LABEL TO THIS ADDRESS              12080000
         XR    R15,R15        ZERO OUT R15 FOR RETURN CODE              12160000
         DROP  R2                                                       12200003
         EJECT                                                          12240000
RET      DS    0X                                                       12320000
         LR    R2,R15         SAVE RET CODE OVER ESTAE                  12400000
         ESTAE 0              REMOVE ESTAE REQUEST                      12480000
         LR    R15,R2         RESTORE RETURN CODE                       12560000
         NI    TSTFLGS4,HEXFF-TSTRERTN  SHUT OFF RETRY FLAG             12640000
RETS     DS    0X             RETURN TO MAINLINE                        12720000
         L     R13,@4(R13)                                              12800000
         RETURN (14,12),RC=(15) RETURN TO MAINLINE                      12880000
         EJECT                                                          12960000
CHKCDE   DS    0X                                                       13040000
         B     *+@4(R15)      BRANCH ACCORDING TO CODE                  13120000
         BR    R14            RETURN CODE = 0                           13200000
         BR    R14            FOR ALIGNMENT PURPOSES                    13280000
         B     RETCDE4        RETURN CODE = 4                           13360000
         B     RETCDE8        RETURN CODE = 8                           13440000
         B     RETCDE12       RETURN CODE = 12                          13520000
         B     RETCDE16       RETURN CODE = 16                          13600000
         B     RETCDE20       RETURN CODE = 20                          13680000
         EJECT                                                          13760000
A0009    DS    0X              EQUATE LABEL TO ADDRESS                  13840000
*************************************************************           13920000
**AT THIS POINT WE ASSUME NO SUB-COMMANDS HAVE BEEN ENTERED**           14000000
**AND WILL RETURN TO THE TERMINAL THE CURRENT INSTRUCTION  **           14080000
**COUNTER ADDRESS.                                         **           14160000
*************************************************************           14240000
         L     R4,ECBPP       GET ADDRESS OF SVC 97 REQUEST BLK@ZA07138 14480003
         USING RBSECT,R4      USE REG4 TO ADDRESS RB                    14640000
         L     R4,RBLINK      GET ADDRESS OF PROBLEM PROG PRB  @ZA07138 14720003
         L     R2,RBOPSW+@4   LOAD RESUME PSW                           14880000
         BAL   R14,CONVERT    BRANCH TO CONVERT ROUTINE                 14960000
         L     R1,OUTBUF      PLACE POINTER TO OUTPUT AREA IN R1        15040000
         EX    R10,ICMVC      PUT CONVERTED IC IN BUFFER                15120000
         LA    R3,@6(R10)     CREATE LENGTH COUNT                       15200000
         STH   R3,@0(R1)      PLACE LENGTH FIELD INTO FIRST WORD        15280000
         LA    R10,@5(R10,R1) UPDATE BUFFER POINTER                     15360000
         MVI   @0(R10),DOT    PERIOD TO INDICATE ABSOLUTE ADDRESS       15440000
         XC    TSTIOPRM,TSTIOPRM  CLEAR PARAMETER AREA                  15520000
         LR    R4,R1          REG 4=PTR TO DATA                         15600000
         IKJEGSIO DATA,DATAPTR=(R4),ID=WHR32,MF=(E,TSTIOPRM)            15680000
         NI    TSTFLGS2,HEXFF-TADDROUT TURN OFF MSG PUT TO TERM SW      15760000
         B     COMMON         GO CHECK RET CODE FROM IO                 15840000
ICMVC    MVC   @4(@1,R1),@0(R2)  MOVE EBCDIC ADDRESS INTO OUTPU T       15920000
         DROP  R4                                                       15970003
RETCDE4  DS    0X                                                       16320000
         OI    TSTFLGS4,TSTFLUSH TELL MNLINE TO FLUSH STACK             16400000
         B     A0008          RETURN TO MNLINE WITH ZERO                16480000
RETCDE12 DS    0X                                                       16560000
         LA    R2,M0104       MSG-WHERE FAILED, CMMND SYS ERR           16640000
         LA    R3,M0277       MSG-PARSE ERROR CODE 12                   16720000
         BAL   R6,MSG2        GO OUTPUT THE MESSAGES                    16800000
         B     COMMON         CHECK RET CODES, RETURN                   16880000
RETCDE16 DS    0X                                                       16960000
         LA    R2,M0103       MSG-NOT ENOUGH CORE                       17040000
         LA    R3,@0          NO SECOND LEVEL MESSAGE                   17120000
         BAL   R6,MSG1        GO OUTPUT THE MESSAGES                    17200000
         B     COMMON         CHECK RET CODES, RETURN                   17280000
RETCDE20 DS    0X                                                       17360000
         L     R8,WORKAREA    ACCESS PTR TO WORKAREA                    17440000
         L     R15,CODESAVE-TSTCWORK(R8) ACCESS STORED RETURN CODE      17520000
         LA    R14,@16        FOR RETURN CODE COMPARISON                17600000
         CR    R15,R14        TEST RETURN CODE                          17680000
         BE    RET            IF EQUAL RETURN 16 TO MNLINE              17760000
         BH    SEND20         OHTERWISE SEND 20 TO MNLINE               17840000
         XR    R15,R15        SEND 0 IF LESS THAN 16                    17920000
         B     RET            RETURN TO MNLINE                          18000000
SEND20   DS    0X                                                       18080000
         LA    R15,@20        RETURN CODE TO MAINLINE                   18160000
         B     RET            RETURN TO MNLINE                          18240000
RETCDE8  DS    0X                                                       18320000
         LA    R15,@16        RETURN CODE TO MNLINE                     18400000
         B     RET            RETURN TO MNLINE                          18480000
COMMON   DS    0X                                                       18560000
         L     R2,WORKAREA    ACCESS WORKAREA PTR                       18640000
         CH    R15,ATTNCODE   COMPARE RET CODE TO 16                    18720000
         BNL   RET            RET CODE NOT LESS THAN 16                 18800000
         B     A0008          RETURN TO MNLINE WITH ZERO                18880000
         EJECT                                                          18960000
RETRY    DS    0X                                                       19040000
         L     R2,@16         ACCESS PTR TO CVT                         19120000
         USING CVT,R2         ESTABLISH CVT ADDRESSABILITY              19200000
         L     R3,CVTTCBP     ACCESS TCB PTR                            19280000
         L     R3,@4(R3)      ACCESS CURRENT TCB PTR                    19360000
         USING TCB,R3         ESTABLISH TCB ADDRESSABILITY              19440000
         L     R9,TCBTRN      PTR TO TCOMTAB                            19520000
         L     R13,REGSAVE2   ACCESS SAVE AREA                          19600000
         L     R12,@68(R13)   ACCESS BASE REGISTER                      19680000
         DROP  R2             DROP CVT ADDRESSABILITY                   19760000
         DROP  R3             DROP TCB ADDRESSABILITY                   19840000
         NI    TSTFLGS2,HEXFF-TADDROUT-TOFFDEF  TURN OFF FLAGS          19920000
         NI    TSTFLGS1,HEXFF-TSTFIRST TURN OF FLAG                     20000000
         LA    R15,@20        RETURN CODE OF 20 TO MAINLINE             20080000
         B     RET            RETURN CONVENTIONS                        20160000
         EJECT                                                          20240000
************************************************************            20320000
** PARSE WILL LINK TO THIS ADDRESS SO THAT WE MAY         **            20400000
**VALIDITY CHECK THE ADDRESS ENTERED THRU THE TERMINAL    **            20480000
** WE WILL TRY USING IKJEGCVT AND IKJEGSYM PLUS ACTUALLY  **            20560000
** LOOKING FOR THE ADDRESS WITHIN THE CONTROL BLOCKS      **            20640000
** STRUCTRUE TO CHECK WHETHER THE ADDRESS IS VALID        **            20720000
** INVALID ADDRESSES ARE FLAGGED AS SUCH AND ASKED TO BE  **            20800000
** REENTERED.                                             **            20880000
************************************************************            20960000
IKJEGVLC DS    0X                                                       21040000
         SAVE  (14,12)        SAVE REGISTERS             ***            21120000
         DROP  R12            DROP R12 AS BASE REGISTER    *            21200000
         USING IKJEGVLC,R15   ESTABLISH E.P. ADDRESSABILITY* ESTABLISH  21280000
         L     R2,@4(R1)      ACCESS MY REGISTER SAVEAREA  *            21360000
         LM    R3,R12,@32(R2) RESTORE REGISTERS 3 THRU 12  *ADDRSABLITY 21440000
         USING IKJEGWHR,R12   ESTABLISH ADDRESSABILITY     *            21520000
         DROP  R15            DROP R15 AS BASE REGISTER  ***            21600000
*                                                        ***            21680000
         L     R2,REGSAVE3    ACCESS MY SAVE AREA ADDRESS  * STANDARD   21760000
         ST    R13,@4(R2)     SAVE CALLERS SAVEAREA        *            21840000
         ST    R2,@8(R13)     STORE MY SAVE IN CALLERS     * LINKAGE    21920000
         LR    R13,R2         MY SAVE AREA INTO R13        *            22000000
*                                                        ***CONVENTIONS 22080000
         SR    R14,R14        CLEAR REG 14                              22160000
         L     R4,OUTBUF      ACCESS POINTER TO OUTBUF                  22240000
         ST    R14,@0(R4)     CLEAR 1ST WORD OF OUTBUF                  22320000
         OI    TSTFLGS4,TSTVALCK  INDICATE VALIDITY ROUTINE             22400000
         NI    TSTFLGS2,HEXDF-TADDROUT TURN OFF MSG PUT TO TERM SW      22480000
*                                       AND INIT LOAD LIST INDICATOR    22560000
         L     R2,WORKAREA    ACCESS PTR TO WORKAREA                    22640000
         LA    R3,@8(R1)      CREATE PTR TO PARSE 3RD WORD              22720000
         ST    R3,MSGADDR-TSTCWORK(R2) FUTURE PTR TO 2ND LEVEL MSG      22800000
*                                                                       22880000
         L     R7,@0(R1)      ACCESS PDE ADDRESS                        22960000
         USING IKJPARMA,R7    ESTABLISH PDE ADDRESSABILITY              23040000
         TM    PDEFLG4,GENR   TEST FOR REGISTER NOTATION                23120000
         BNO   FLTREG         BRANCH FOR FURTHER VALIDITY CHECK         23200000
         LH    R3,PDEINDCT    ACCESS INDIRECT COUNT                     23280000
         LTR   R3,R3          IF 0, THEN INVALID REGISTER SPECIFICATION 23360000
         BNZ   FLTREG         BRANCH FOR FURTHER VALIDITY CHECK         23440000
         B     BADADDR        BRANCH TO OUTPUT ERROR MESSAGES           23520000
FLTREG   DS    0X                                                       23600000
         TM    PDEFLG4,LFPR+SFPR TEST FOR FLOATING POINT REGISTER       23680000
         BZ    PROCESS        IF NOT SPECIFIED, PROCESS ADDRESS STING   23760000
BADADDR  DS    0X             OUTPUT ERROR MESSAGES                     23840000
         LA    R2,M0101       MSG-INVALID ADDRESS                       23920000
         LA    R3,M0274       MSG-REG NOT. MUST BE INDRT GEN REG        24000000
         LR    R4,R7          ADDRESS PDE                               24080000
         B     MSG3           GO OUTPUT THE MESSAGES                    24160000
PROCESS  DS    0X                                                       24240000
         L     R3,WORKAREA              ***                             24320000
         LA    R3,PDESAVE-TSTCWORK(R3)    * SAVE PDE IN WORKAREA        24400000
         MVC   @0(@25,R3),@0(R7)        ***                             24480000
*                                                          ***          24560000
         TM    PDEFLG2,CTNAMFLG TEST IF CSECT NAME SPECIFIED *          24640000
         BO    QUALSYM        IF SPECIFIED, BRANCH           * TEST FOR 24720000
         L     R3,PDEEXPTR    ACCESS ADDRESS OF ADDR EXP     *          24800000
         LA    R3,@0(R3)      ZERO HI ORDER BYTE             *          24880000
         LTR   R3,R3          TEST FOR ADDR EXP              *          24960000
         BNZ   ADDRPROC       IF ADDR EXP, BRANCH            *          25040000
         TM    PDEFLG3,AFLG   TEST FOR ADDR STRING           *QUALIFIED 25120000
         BNO   ADDRPROC       IF NOT SPECIFIED, BRANCH       * SYMBOL   25200000
         TM    PDEFLG4,SYMADDR TEST FOR SYMBOLIC ADDR        *          25280000
         BNO   ADDRPROC       IF NOT SYMBOL, BRANCH        ***          25360000
         B     SYMBOL         BRANCH IF IT IS A SYMBOL                  25440000
SYMBOL   DS    0X                                                       25520000
         MVC   PDELDNAM(@6),PDEADRPT SYMBOL AND LEN INTO LDNAME         25600000
         L     R1,TSTTCB      ACCESS TEST'S TCB                         25680000
         L     R2,WORKAREA    ACCESS WORKAREA PTR                       25760000
         LA    R1,@0(R1)      CLEAR HI ORDER BYTE                       25840000
         ST    R1,TCBCHAI-TSTCWORK(R2) STORE MOTHER TCB                 25920000
GOCDE    DS    0X                                                       26000000
         BAL R14,TCBCHAIN     BRANCH TO GET TCB ON CHAIN                26080000
         LTR   R1,R1          TEST FOR END OF TCB CHAIN                 26160000
         BZ    ENDTCB         BRANCH IF END OF CHAIN                    26240000
         USING TCB,R1         ESTABLISH TCB ADDRESSABILITY              26320000
         TM    TCBFLGS5,TCBFC TEST IF TCB TERMINATED                    26400000
         BO    GOCDE          IF TERMINATED, GET NEXT TCB ON CHAIN      26480000
         DROP  R1             DROP ADDRESSABILITY TO TCB                26560000
         BAL   R14,CDESRCH    SEARCH CDE FOR LOADNAME MATCH             26640000
         LTR   R0,R0          TEST IF LOADNAME MATCH FOUND              26720000
         BZ    GOCDE          IF NOT GET NEXT TCB                       26800000
         ST    R0,PDEUSER     IF FOUND, STORE LOCATED AT ADDR           26880000
         OI    TSTFLGS2,TADDROUT INDICATE MATCH FOUND (MSG OUTPUT)      26960000
         BAL   R14,LDNMSG     TO BUILD AND OUTPUT MSG                   27040000
         L     R1,TCBSAVE-TSTCWORK(R8) ACCESS STORED TCB                27120000
         LTR   R11,R11        IS THERE A RETURN ADDRESS INDICATED       27200000
         BZ    GOCDE          GET NEXT TCB                              27280000
         BR    R11            TO CONTINUE PROCESSING THE PRESENT TCB    27360000
ENDTCB   DS    0X                                                       27440000
         XR    R15,R15        INDICATE ZERO RETURN CODE                 27520000
         TM    TSTFLGS2,TADDROUT WAS ANY LOADNAME MATCH FOUND           27600000
         BO    GOHOME         IF SO, RETURN TO PARSE                    27680000
         L     R2,WORKAREA    OTHERWISE, ACCESS WORKAREA PTR            27760000
         MVC   PDELDNAM(@25),PDESAVE-TSTCWORK(R2) RESTORE PDE           27840000
         B     ADDRPROC       BRANCH TO FURTHER SEARCH                  27920000
QUALSYM  DS    0X                                                       28000000
         TM    PDEFLG1,LDNAMFLG TEST IF LOADNAME IS WITH CSECT NAME     28080000
         BO    ADDRPROC       IF SO PROCESS ADDRESS                     28160000
         L     R3,WORKAREA    ACCESS WORKAREA POINTER                   28240000
         MVC   CURLD-TSTCWORK(@8,R3),TSTCURLD MOVE CURRENT LOADNAME     28320000
         LA    R4,@8          INITIALIZE REG WITH MAX LEN 8             28400000
         LA    R5,CURLD-TSTCWORK(R3) CREATE PTR TO LOADNAME             28480000
         ST    R5,PDELDNAM    STORE PTR IN PDE                          28560000
         LA    R5,@7(R5)      UPDATE PTR TO END OF LOADNAME             28640000
CHKBLNK  DS    0X                                       *****           28720000
         CLI   @0(R5),BLANK   TEST LAST CHAR FOR BLANK     * REMOVE     28800000
         BNE   STLEN          IF NOT BLANK, BRANCH         *  BLANK     28880000
         BCTR  R4,R0          DECREMENT LENGTH COUNTER     * PADDING    28960000
         BCTR  R5,R0          DECREMENT PTR TO LOADNAME    *  IF ANY    29040000
         B     CHKBLNK        TO TEST FOR BLANK        *****            29120000
STLEN    DS    0X                                                       29200000
         STH   R4,PDELEN1     STORE CALCULATED LENGTH IN PDE            29280000
         B     ADDRPROC       TO PROCESS ADDR                           29360000
ADDRPROC DS    0X                                    ***                29440000
         LA    R0,@4          MAKE R0 POSITIVE        *                 29520000
         LR    R1,R7          ACCESS ADDR OF PDE      *                 29600000
         LCR   R1,R1          INDICATOR TO TSTCONVT   * CONVERT ADDRESS 29680000
         NI    TSTFLGS3,HEXFF-SYMMESG INDICATE PRINT  *                 29760000
         L     R15,TSTCONVT   ACCESS ADDR OF TSTCONVT *                 29840000
         BALR  R14,R15        BRANCH TO CONVERT     ***                 29920000
         BAL   R14,CODECHK    TO TEST RETURN CODE                       30000000
*                                                                       30080000
         L     R2,PDEUSER     ADDR FROM TSTCONVT                        30160000
         LA    R2,@0(R2)      CLEAR HI ORDER BYTE                       30240000
         TM    PDEFLG5,PDESIB IF ADDR IS NOT SYMBOLIC                   30320000
         BZ    GOXLST         ...THEN BRANCH                            30400000
         L     R2,@0(R2)      ...ELSE GET ADDR FROM SIB                 30480000
         LA    R2,0(R2)       ZERO HIGH ORDER BYTE                      30560000
         B     GOXLST         TO SEARCH XTENT LIST                      30640000
         EJECT                                                          30720000
*********************************************************************** 30800000
*                                                                     * 30880000
* THIS CODE ACCESS EACH TCB AND PASSES ITS ADDR IN REGISTER 1 TO CODE * 30960000
* WHICH SEACHES THE EXTENT LISTS FOR THE SAME ADDRESS IN PDEUSER. WHEN* 31040000
* THE ADDRESS IS FOUND, THE CORRESPONDING LOADNAME IS RETURNED IN R0  * 31120000
* IF NOT SUCCESSFUL, R0 WILL CONTAIN ZEROES.                          * 31200000
*                                                                     * 31280000
*********************************************************************** 31360000
GOXLST   DS    0X                                                       31440000
         ST    R2,PDEUSER     PUT ACTUAL ADDR IN PDEUSER                31520000
         L     R3,WORKAREA    ACCESS WORKAREA ADDR                      31600000
         ST    R2,USERSAVE-TSTCWORK(R3) SAVE ORIG CONVERTED ADDR        31680000
         L     R1,TSTTCB      ACCESS TEST TCB                           31760000
         LA    R1,@0(R1)      CLEAR HI ORDER BYTE                       31840000
         ST    R1,TCBCHAI-TSTCWORK(R3) STORE MOTHER TCB IN WORKAREA     31920000
NXTCB    DS    0X                                                       32000000
         BAL   R14,TCBCHAIN   TO GET NEXT TCB ON CHAIN                  32080000
         LTR   R1,R1          ANOTHER TCB FOUND                         32160000
         BZ    ENDCHAIN       NO, END XLST SEARCH                       32240000
         USING TCB,R1         ESTABLISH TCB ADDRESSABILITY              32320000
         TM    TCBFLGS5,TCBFC TEST IF TCB TERMINATED                    32400000
         BO    NXTCB          IF TERMINATED, GET NEXT TCB               32480000
         DROP  R1             DROP TCB ADDRESSABILITY                   32560000
         BAL   R14,XLSTSRCH   YES,SEARCH XLST                           32640000
         LTR   R0,R0          XLST SEARCH SUCCESSFUL                    32720000
         BZ    NXTCB          GET NEXT TCB                              32800000
         TM    PDEFLG1,LDNAMFLG TEST IF USER ENTERED LDNAM              32880000
         BO    GETCTN         IF SO, DO NOT ALTER PDE                   32960000
         LR    R2,R0          ACCESS PTR TO LOADNAME                    33040000
         LA    R2,@7(R2)      CREATE PTR TO END OF LOAD NAME            33120000
         LA    R8,@8          MAX LENGTH OF LOADNAME                    33200000
BLNKOFF  DS    0X                                       ****            33280000
         CLI   @0(R2),BLANK   TEST FOR BLANK              * REMOVE      33360000
         BNE   MVCPROG        NO BLANK, BRANCH            *  BLANK      33440000
         BCTR  R8,R0          DECREMENT LENGTH COUNTER    * PADDING     33520000
         BCTR  R2,R0          DECREMENT PTR TO LOADNAME   *  IF ANY     33600000
         B     BLNKOFF        TO TEST FOR BLANK        ****             33680000
PNAMVC   MVC   @0(@1,R6),@0(R2)                                         33760000
TRYALIAS DS    0X              REPLACE LDNAM WITH ALIAS                 33840000
         LA    R8,@8          MAX LENGTH OF ALIAS NAME                  33920000
         L     R6,WORKAREA    ACCESS WORKAREA PTR                       34000000
         LA    R2,ALIASAVE-TSTCWORK(R6) ACCESS PTR TO ALIAS SAVE        34080000
         TM    TSTFLGS1,TSTFIRST  HAVE WE ALREADY TRIED ALIAS           34160000
         BO    NOCTN          IF SO, BRANCH                             34240000
         OI    TSTFLGS1,TSTFIRST  SET FLAG TO INDICATE TRYING ALIAS     34320000
         LR    R0,R2          SAVE PTR TO ALIAS NAME                    34400000
         CLI   @0(R2),BLANK   TEST IF ALIAS EXISTS                      34480000
         BE    NOCTN          GO TO RECOVERY ROUTINE                    34560000
         LA    R2,@7(R2)      CREATE PTR TO END OF ALIAS NAME           34640000
         B     BLNKOFF        TO REMOVE BLANK PADDING                   34720000
NOCTN    DS    0X              RECOVERY ROUTINE IF CSECT NAME NOT FOUND 34800000
         NI    TSTFLGS1,HEXFF-TSTFIRST TURN FLAG OFF                    34880000
         STH   R8,PDELEN2       ST LENGTH OF 8                          34960000
         MVI   @0(R2),BLANK     PUT BLANK IN ALIASAVE                   35040000
         MVC   @1(@7,R2),@0(R2) SPREAD BLANKS THROUGH ALIASAVE @ZA00920 35120000
         ST    R2,PDECTNAM      STORE PTR TO BLANKS AS CSECT NAME PTR   35200000
         NI    TSTFLGS3,HEXFF-SYMMESG TURN OF SUPPRESS MSG FLAG         35280000
         MVC   OFFSET2-TSTCWORK(@4,R6),OFFSET-TSTCWORK(R6) MOVE OFFSET  35360000
         B     RECOVER          RESUME RECOVERY PROCESS                 35440000
MVCPROG  DS    0X                                                       35520000
         OI    PDEFLG1,LDNAMFLG  TURN ON LOADNAME FLAG                  35600000
         STH   R8,PDELEN1     STORE LOADNAME LENGTH                     35680000
         BCTR  R8,R0          DECREMENT FOR EX                          35760000
         L     R6,WORKAREA    ACCESS WORKAREA PTR                       35840000
         LA    R6,LOADNAME-TSTCWORK(R6) CREATE PTR TO LOADNAME AREA     35920000
         ST    R6,PDELDNAM    ST PTR IN PDE                             36000000
         LR    R2,R0          ACCESS LOADNAME PTR                       36080000
         EX    R8,PNAMVC      TO MOVE INTO WORKAREA                     36160000
GETCTN   DS    0X                                                       36240000
         MVI   PDEFLG2,HEX00  INDICATE CSECT NAME NOT PRESENT           36320000
*                                                                       36400000
         LA    R2,@4          LENGTH OF OFFSET (ADDR STRING)            36480000
         STH   R2,PDELEN3     STORE IN PDE LENGTH POINTER               36560000
         L     R6,WORKAREA    ACCESS WORKAREA PTR                       36640000
         LA    R2,OFFSET-TSTCWORK(R6) ACCESS GROSS OFFSET               36720000
         ST    R2,PDEADRPT    STORE OFFSET PTR IN PDE                   36800000
         OI    PDEFLG3,AFLG   TURN ON ADDRESS STRING INDICATOR          36880000
         MVI   PDEFLG4,RELADDR TURN ON RELADDR FLAG AND TURN OFF OTHERS 36960000
         OI    TSTFLGS3,SYMMESG  INDICATE TO SUPPRESS MSG               37040000
         LA    R1,IKJPARMA                                              37120000
         BAL   R11,LINKSYM    LINK TO IKJEGSYM TO GET CSECT NAME        37200000
         BAL   R14,CODECHK2   TEST SYM RETURN CODE                      37280000
         L     R6,WORKAREA    REINITIALIZE WORKAREA PTR                 37360000
         XC    PDEADRPT(@7),PDEADRPT CLEAR ADDR PTR, LENGTH AND FLAGS   37440000
         LH    R2,PDELEN2     ACCESS LENGTH OF CSECT NAME               37520000
         BCTR  R2,R0          DECREMENT FOR EXECUTE                     37600000
         L     R1,PDECTNAM    ACCESS PTR TO CSECT NAME                  37680000
         EX    R2,CSECTMVC    MOVE CSECT NAME TO MY WORKAREA            37760000
         LA    R2,CSECTNAM-TSTCWORK(R6) CREATE PTR TO CSECT NAME        37840000
         ST    R2,PDECTNAM    STORE PTR IN PDE                          37920000
         NI    TSTFLGS3,HEXFF-SYMMESG TURN OFF SUPPRESS MSG FLAG        38000000
         LA    R1,IKJPARMA                                              38080000
         BAL   R11,LINKSYM    LINK TO SYM FOR CSECT LOCATION            38160000
         BAL   R14,CODECHK2   TEST SYM RETURN CODE                      38240000
         L     R6,WORKAREA    REINITIALIZE WORKAREA PTR                 38320000
         L     R2,TSTWHR      ACCESS LOADED AT ADDRESS FROM IKJEGSYM    38400000
         L     R3,PDEUSER     CSECT LOCATION                            38480000
         SR    R3,R2          OFFSET OF CSECT FROM LOADED AT ADDR       38560000
         L     R4,OFFSET-TSTCWORK(R6) ACCESS SAVED GROSS OFFSET         38640000
         SR    R4,R3          CALCULATE OFFSET INTO CSECT               38720000
         ST    R4,OFFSET2-TSTCWORK(R6) STORE OFFSET IN WORKAREA         38800000
RECOVER  DS    0X              ENTER HERE IF CSECT NAME WAS NOT FOUND   38880000
         L     R1,TSTTCB      ACCESS TCB ADDRESS                        38960000
         LA    R1,@0(R1)      CLEAR HI ORDER BYTE                       39040000
         ST    R1,TCBCHAI-TSTCWORK(R6) SAVE MOTHER TCB                  39120000
GOTCB1   DS    0X                                                       39200000
         BAL   R14,TCBCHAIN   GET NEXT TCB ON CHAIN                     39280000
         XR    R15,R15        INDICATE ZERO RETURN CODE                 39360000
         LTR   R1,R1          TEST FOR END OF TCB CHAIN                 39440000
         BZ    GOHOME         BRANCH IF END OF CHAIN                    39520000
         USING TCB,R1         ESTABLISH TCB ADDRESSABILITY              39600000
         TM    TCBFLGS5,TCBFC TEST IF TCB TERMINATED                    39680000
         BO    GOTCB1         IF TERMINATED, GET NEXT TCB               39760000
         DROP  R1             DROP TCB ADDRESSABILITY                   39840000
         BAL   R14,CDESRCH    TO SEARCH CDE FOR LOADNAME MATCH          39920000
         LTR   R0,R0          TEST IF MATCH WAS FOUND                   40000000
         BZ    GOTCB1         TO GET NEXT TCB ON CHAIN                  40080000
         L     R6,OFFSET-TSTCWORK(R8)  ACCESS GROSS OFFSET              40160000
         AR    R6,R0          LOAD ADDR + GROSS OFFSET = ASOLUTE ADDR   40240000
         LA    R6,@0(R6)      CLEAR HI ORDER BYTE                       40320000
         LA    R10,PDESAVE-TSTCWORK(R8) ACCESS ADDR OF ORIGINAL PDE     40400000
         TM    @14(R10),CTNAMFLG TEST IF CSECT NAME PRESENT             40480000
         BNO   TPRINT         TO PRINT MSG                              40560000
GOPRNT   DS    0X                                                       40640000
         ST    R6,PDEUSER     STORE ABSOLUTE ADDR IN PDEUSER            40720000
         BAL   R14,OFFMSG     BRANCH TO PRINT MESSAGE                   40800000
         L     R1,TCBSAVE-TSTCWORK(R8) ACCESS CURRENT TCB               40880000
         LTR   R11,R11        TEST FOR RETURN ADDRESS FROM CDESRCH      40960000
         BZ    GOTCB1         IF NONE, GET NEXT TCB                     41040000
         BR    R11            OTHERWISE BRANCH BACK TO CDESRCH          41120000
TPRINT   DS    0X                                                       41200000
         L     R10,USERSAVE-TSTCWORK(R8) ACCESS ORIG CONVERTED ADDR     41280000
         CR    R6,R10         DOES ORIG ADDR = CALCULATED ADDR          41360000
         BE    GOPRNT         IF SO, PRINT MSG                          41440000
         LTR   R11,R11        OTHERWISE CHECK FOR CDESRCH RETURN ADDR   41520000
         BZ    GOTCB1         IF NONE, GET NEXT TCB                     41600000
         BR    R11            OTHERWISE, BRANCH INTO CDESRCH            41680000
ENDCHAIN DS    0X                                                       41760000
         BAL   R14,REGMSG     TO PUT OUT DIAGNOSTIC  MSG                41840000
         XR    R15,R15        INDICATE ZERO RETURN CODE                 41920000
         B     GOHOME         RETURN TO PARSE                           42000000
*                                                                       42080000
LINKSYM  DS    0X                                                       42160000
NOBLDL   LA    R4,I0085       IKJEGSYM INSERT                           42240000
         LINK  EP=IKJEGSYM,ERRET=LINKFL2  LINK TO SYM                   42320000
BLOW2    DS    0X                                                       42400000
BLOW3    DS    0X              STAE RESUME ADDRESS                      42480000
SMTSYM02 DS    0X             TEST CASE TTSTC120                        42560000
         BR    R11            RETURN IN LINE                            42640000
         EJECT                                                          42720000
*********************************************************************** 42800000
* THIS CODE SEARCHES THE EXTENT LISTS ON THE TCB PASSED IN REG 1      * 42880000
* FOR THE ADDRESS IN PDEUSER.  THE LOADED AT ADDRESS IS USED TO       * 42960000
* ASSOCIATE AN ADDRESS WITH A LOADNAME. A POINTER TO THE LOADNAME     * 43040000
* IS RETURNED IN REG 0, AND A GROSS OFFSET (PDEUSER-LOADED AT         * 43120000
* ADDRESS) IS STORED IN WORKAREA.                                     * 43200000
*********************************************************************** 43280000
XLSTSRCH DS    0X                                                       43360000
         XR    R0,R0          INIT R0 TO INDICATE CTN NOT FOUND         43440000
         L     R8,WORKAREA    ACCESS WORKAREA POINTER                   43520000
         LA    R8,ALIASAVE-TSTCWORK(R8) ACCESS PTR TO ALIAS SAVE AREA   43600000
         MVI   @0(R8),BLANK   TO BLANK OUT ALIAS SAVE                   43680000
         MVC   @1(@7,R8),@0(R8)  INITIALIZE ALIAS SAVE                  43760000
         USING TCB,R1         ESTABLISH TCB ADDRESSABILITY              43840000
         L     R2,TCBRBP      ACCESS RB PTR                             43920000
         USING RBSECT,R2      ESTABLISH RB ADDRESSABILITY               44000000
RBLOOP   DS    0X                                                       44080000
         TM    RBSTAB,HEXC0   TEST IF PRB                               44160000
         BNZ   NXTRB          IF NOT, GET NEXT RB                       44240000
         L     R3,RBCDE       IF SO, ACCESS CDE PTR                     44320000
         LA    R3,@0(R3)      CLEAR HI ORDER BYTE                       44400000
         LTR   R3,R3          PTR EQUAL ZERO                            44480000
         BZ    NXTRB          IF SO, SKIP THIS CDE                      44560000
CDELOOP  DS    0X                                                       44640000
         USING CDENTRY,R3     ESTABLISH CDE ADDRESSABILITY              44720000
         TM    CDATTR,CDMIN   CHECK FOR ALIAS (MINOR CDE)      @YM07131 44800000
         BNO   CONTCDE        IF NOT ALIAS, GET XLST PTR                44880000
         L     R8,WORKAREA    ACCESS WORKAREA POINTER                   44960000
         MVC   ALIASAVE-TSTCWORK(@8,R8),CDNAME SAVE ALIAS IN WORKAREA   45040000
         L     R3,CDXLMJP     ACCESS MAJOR CDE                          45120000
         LA    R3,@0(R3)      CLEAR HI ORDER BYTE                       45200000
CONTCDE  DS    0X                                                       45280000
         L     R5,CDXLMJP     ACCESS XLST PTR                           45360000
         USING XTLST,R5       ESTABLISH XLST ADDRESSABILITY             45440000
         TM    CDATTR2,HEX80  TEST FOR OBJECT                           45520000
         L     R6,XTLMSBAA    ACCESS LOADED AT ADDRESS                  45600000
         BNO   GETLOC         CONTINUE PROCESSING                       45680000
         LA    R15,@2         FOR FUTURE COMPARISON                     45760000
         CL    R15,XTLNRFAC   DETERMINE IF TWO ENTRIES                  45840000
         BNE   GETLOC         CONTINUE PROCESSING                       45920000
         L     R6,XTLMSBAA+@4    ACCESS LOADED AT ADDRESS               46000000
GETLOC   DS    0X                                                       46080000
         LA    R6,@0(R6)      CLEAR HI ORDER BYTE                       46160000
         L     R11,XTLMSBLA   ACCESS LENGTH OF CSECT                    46240000
         LA    R11,@0(R6,R11) CREATE END ADDR FOR CSECT                 46320000
         L     R8,PDEUSER     ACCESS ADDR IN PDEUSER                    46400000
         CLR   R6,R8          PDEUSER G.T. THIS LOADED AT ADDR          46480000
         BH    XLSTLOOP       IF NOT GET NEXT CDE                       46560000
         CLR   R11,R8         PDEUSER L.T. CSECT END ADDR               46640000
         BNH   XLSTLOOP       IF NOT, GET NEXT CDE                      46720000
         SLR   R8,R6          COMPUTE OFFSET                            46800000
         L     R2,WORKAREA    ACCESS WORKAREA PTR                       46880000
         ST    R8,OFFSET-TSTCWORK(R2) STORE GROSS OFFSET                46960000
         LA    R0,CDNAME      RETURN PTR TO LOADNAME                    47040000
RETHOME  DS    0X                                                       47120000
         NI    TSTFLGS2,HEXDF TURN OFF LOAD LIST INDICATOR              47200000
         BR    R14            RETURN AND GET ANOTHER TCB                47280000
XLSTLOOP DS    0X                                                       47360000
         TM    TSTFLGS2,TOFFDEF ARE WE USING LOAD LIST CDE'S            47440000
         BO    GOLLE          IF SO, GET NEXT LLE                       47520000
NXTRB    DS    0X                                                       47600000
         L     R2,RBLINK      OTHERWISE ACCESS NEXT RB                  47680000
         LA    R2,@0(R2)      CLEAR HI ORDER BYTE                       47760000
         CR    R1,R2          DOES RBLINK POINT TO TCB                  47840000
         BNE   RBLOOP         IF NOT, PROCESS THIS RB                   47920000
         L     R2,TCBLLS      OTHERWISE, ACCESS LOAD LIST PTR           48000000
         OI    TSTFLGS2,TOFFDEF INDICATE USING LOAD LIST, NOT RB        48080000
         DROP  R2                                                       48120003
         USING LLE,R2         ESTABLISH LOAD LIST ADDRESSABILITY        48160000
LLELOOP  DS    0X                                                       48240000
         LA    R2,@0(R2)      CLEAR HI ORDER BYTE                       48320000
         LTR   R2,R2          TEST FOR END OF LOAD LIST                 48400000
         BZ    RETHOME        IF END OF LOAD LIST, BRANCH               48480000
         L     R3,LLECDPT     OTHERWISE, GET CDE PTR                    48560000
         LA    R3,@0(R3)      CLEAR HI ORDER BYTE                       48640000
         LTR   R3,R3          PTR EQUAL ZERO                            48720000
         BZ    XLSTLOOP       IF SO, SKIP THIS CDE                      48800000
         B     CDELOOP        TO PROCESS NEXT CDE                       48880000
GOLLE    DS    0X                                                       48960000
         L     R2,LLECHN      ACCESS PTR TO NEXT LLE                    49040000
         B     LLELOOP        TO PROCESS LLE                            49120000
         DROP  R1                                                       49130003
         DROP  R2                                                       49140003
         DROP  R3                                                       49150003
         DROP  R5                                                       49160003
         EJECT                                                          49200000
*********************************************************************** 49280000
* THIS CODE SEARCHES THE TCB PASSED IN REG1 FOR THE LOADNAME INDICATED* 49360000
* IN PDELDNAM. WHEN THE LOADNAME IS FOUND, THE LOADED AT ADDRESS IS   * 49440000
* PASSED BACK IN REG0. IF NOT FOUND, REG0 CONTAINS ZEROES. IF R11     * 49520000
* IS ZERO THE NEXT TCB TO BE SEARCHED SHOULD BE RETURNED IN REG1. IF  * 49600000
* REG11 HAS AN ADDR THEN THE CALLER SHOULD BRANCH ON REG11 SO THAT    * 49680000
* THE REST OF THE CDE'S ON THE PRESENT TCB CAN BE SEARCHED.           * 49760000
*********************************************************************** 49840000
CDESRCH  DS    0X              REG1 POINTS TO TCB- REG7 POINTS TO PDE   49920000
         L     R8,WORKAREA    ACCESS WORKAREA                           50000000
         ST    R14,RETURN-TSTCWORK(R8) SAVE RETURN ADDR                 50080000
         XR    R0,R0          INIT R0 TO INDICATE LO                    50160000
         XR    R11,R11        ZERO POSSIBLE RETURN ADDR                 50240000
         USING TCB,R1         ESTABLISH TCB ADDRESSABILITY              50320000
         L     R3,TCBRBP      ACCESS RB POINTER                         50400000
         USING RBSECT,R3      ESTABLISH RB ADDRESSABILITY               50480000
RBPROC   DS    0X                                                       50560000
         LA    R3,@0(R3)      ZERO HI ORDER BYTE                        50640000
         CR    R1,R3          DOES RBLINK POINT TO TCB                  50720000
         BE    INITLLE        IF SO,USE LLE CDE                         50800000
         TM    RBSTAB,HEXC0   TEST IF PRB                               50880000
         BNZ   NEXTRB         IF NOT, GET NEXT RB IN CHAIN              50960000
         L     R5,RBCDE       ACCESS ADDR OF CDE                        51040000
         LA    R5,0(R5)       CLEAR HI ORDER BYTE                       51120000
         LTR   R5,R5          DOES PTR EQUAL ZERO                       51200000
         BZ    NEXTRB         IF SO, SKIP THIS CDE                      51280000
USECDE   DS    0X                                                       51360000
         USING CDENTRY,R5     ESTABLISH CDE ADDRESSABILITY              51440000
CDEPROC  DS    0X                                                       51520000
         LA    R8,CDNAME      ACCESS ADDR OF LOADNAME                   51600000
         LA    R8,@7(R8)      UPDATE TO END OF LOADNAME                 51680000
         LA    R6,@8          INITIALIZE LENGTH COUNTER                 51760000
REMBLNK  DS    0X                                                       51840000
         CLI   @0(R8),BLANK   TEST FOR BLANK PADDING                    51920000
         BNE   COMPLEN        ALL PADDING REMOVED                       52000000
         BCTR  R8,R0          DECREMENT POINTER                         52080000
         BCTR  R6,R0          DECREMENT COUNTER                         52160000
         B     REMBLNK        TEST FOR BLANK PADDING LOOP               52240000
COMPLEN  DS    0X                                                       52320000
         LH    R15,PDELEN1    ACCESS LENGTH OF LOADNAME IN PDE          52400000
         CLR   R15,R6         ARE LOADNAME LENGTHS EQUAL                52480000
         BNE   NOCOMP         IF NOT, DO NOT COMPARE LOADNAMES          52560000
         BCTR  R6,R0          DECREMENT FOR EXECUTE                     52640000
         L     R8,PDELDNAM    ACCESS PTR TO LOADNAME                    52720000
         EX    R6,LDNCOMPR    TO COMPARE FOR LOADNAME MATCH             52800000
         BE    CHKDUP         IF = CHECK IF ITS A DUPLICATE             52880000
NOCOMP   DS    0X                                                       52960000
         TM    CDATTR,CDMIN   CHECK FOR ALIAS (MINOR CDE)      @YM07131 53040000
         BNO   NEXTRB         IF NOT ALIAS, BRANCH                      53120000
         L     R5,CDXLMJP     ACCESS MAJOR CDE                          53200000
         LA    R5,@0(R5)      CLEAR HI ORDER BYTE                       53280000
         B     CDEPROC        PROCESS MINOR CDE                         53360000
LDNCOMPR CLC   @0(@1,R8),CDNAME  COMPARE LOADNAMES                      53440000
NEXTRB   DS    0X                                                       53520000
         TM    TSTFLGS2,TOFFDEF TEST IF SEARCHING LOAD LIST CDE         53600000
         BO    GETLLE         IF SO, GET NEXT LLE                       53680000
         L     R3,RBLINK      OTHERWISE ACESS NEXT RB                   53760000
         B     RBPROC         PROCESS RB                                53840000
INITLLE  DS    0X             GET CDE POINTER FROM LLE                  53920000
         L     R3,TCBLLS      OTHERWISE, ACCESS ADDR OF LOADLIST        54000000
         OI    TSTFLGS2,TOFFDEF INDICATE USING LOAD LIST, NOT RB        54080000
         DROP  R3                                                       54120003
USELLE   DS    0X                                                       54160000
         USING LLE,R3         ESTABLISH LOAD LIST ADDRESSABILITY        54240000
         LA    R3,@0(R3)      ZERO HI ORDER BYTE                        54320000
         LTR   R3,R3          END OF LOAD LIST                          54400000
         BZ    RETCALL        IF SO, RETURN TO CALLER                   54480000
         L     R5,LLECDPT     ACCESS PTR TO CDE                         54560000
         LA    R5,0(R5)       CLEAR HI ORDER BYTE                       54640000
         LTR   R5,R5          DOES PTR EQUAL ZERO                       54720000
         BZ    GETLLE         IF SO, SKIP THIS CDE                      54800000
         B     USECDE         BRANCH TO PROCESS CDE                     54880000
GETLLE   DS    0X                                                       54960000
         L     R3,LLECHN      ACCESS PTR TO NEXT LLE                    55040000
         B     USELLE         TO PROCESS LLE                            55120000
         DROP  R3                                                       55160003
RETCALL  DS    0X                                                       55200000
         NI    TSTFLGS2,HEXDF TURN OFF LOAD LIST INDICATOR              55280000
         L     R8,WORKAREA    ACCESS WORKAREA                           55360000
         L     R14,RETURN-TSTCWORK(R8) ACCESS RETURN ADDRESS            55440000
         BR    R14            RETURN TO CALLER                          55520000
CHKDUP   DS    0X                                                       55600000
         L     R8,WORKAREA    ACCESS WORKAREA PTR                       55680000
         ST    R5,CDESAVE-TSTCWORK(R8)  STORE CDE ADDRESS               55760000
         ST    R1,TCBSAVE-TSTCWORK(R8)  STORE TCB ADDRESS               55840000
         LA    R3,@0(R3)                CLEAR HI ORDER BYTE             55920000
         ST    R3,RBSAVE-TSTCWORK(R8)   STORE RB ADDRESS                56000000
         TM    CDATTR,CDMIN   TEST IF ALIAS (MINOR CDE)        @YM07131 56080000
         BNO   CONTDUP        BRANCH IF NOT ALIAS                       56160000
         L     R5,CDXLMJP     ACCESS MAJOR CDE                          56240000
         LA    R5,@0(R5)      CLEAR HI ORDER BYTE                       56320000
CONTDUP  DS    0X                                                       56400000
         L     R4,CDXLMJP     ACCESS POINTER TO XTENT LIST              56480000
         USING XTLST,R4       ESTABLISH XTENT LIST ADDRESSABILITY       56560000
         TM    CDATTR2,HEX80  TEST FOR OBJECT                           56640000
         L     R0,XTLMSBAA    ACCESS LOADED AT ADDRESS                  56720000
         BNO   GETLOC2        CONTINUE PROCESSING                       56800000
         LA    R15,@2         FOR FUTURE COMPARISON                     56880000
         CL    R15,XTLNRFAC   DETERMINE IF TWO ENTRIES                  56960000
         BNE   GETLOC2        CONTINUE PROCESSING                       57040000
         L     R0,XTLMSBAA+@4  ACCESS LOADED AT ADDRESS                 57120000
         DROP  R4                                                       57160003
GETLOC2  DS    0X                                                       57200000
         ST    R0,LOADSAVE-TSTCWORK(R8) STORE LOADED AT ADDRESS         57280000
         BAL   R10,CDESRCH2   TO TEST FOR DUPLICATE LOADNAMES           57360000
         LTR   R0,R0          TEST IF DUPLICATE FOUND                   57440000
         BZ    NEXTRB         IF DUPLICATE, BRANCH TO CONTINUE CHAIN    57520000
         L     R14,RETURN-TSTCWORK(R8) RELOAD RETURN ADDRESS            57600000
         BALR  R11,R14        TO TELL CALLER TO PUT OUT MSG             57680000
         XR    R0,R0          INITIALIZE REGISTER 0                     57760000
         L     R8,WORKAREA    ACCESS WORKAREA ADDRESS                   57840000
         L     R3,RBSAVE-TSTCWORK(R8)  RESTORE RB POINTER               57920000
         L     R1,TCBSAVE-TSTCWORK(R8) RESTORE TCB POINTER              58000000
         B     NEXTRB         CONTINUE PROCESSING CHAIN                 58080000
CDESRCH2 DS    0X                                                       58160000
         L     R3,TCBRBP      ACCESS FIRST RB ON CHAIN                  58240000
         USING RBSECT,R3      ESTABLISH RB ADDRESSABILITY               58320000
RBPROC2  DS    0X                                                       58400000
         LA    R3,@0(R3)      CLEAR HI ORDER BYTE                       58480000
         CR    R1,R3          DOES RB POINT TO TCB                      58560000
         BE    INITLLE2       ACCESS LOAD LIST                          58640000
         TM    RBSTAB,HEXC0   TEST IF PRB                               58720000
         BNZ   NEXTRB2        IF NOT, GET NEXT RB                       58800000
         L     R5,RBCDE       ACCESS POINTER TO CDE                     58880000
         LA    R5,0(R5)       CLEAR HI ORDER BYTE                       58960000
         LTR   R5,R5          DOES PTR EQUAL ZERO                       59040000
         BZ    NEXTRB2        IF SO, SKIP THIS CDE                      59120000
USECDE2  DS    0X                                                       59200000
         L     R6,CDESAVE-TSTCWORK(R8) ACCESS STORED CDE                59280000
         CR    R5,R6          COMPARE CDE POINTERS                      59360000
         BNE   TSTMJCDE       GET NEXT RB                               59440000
         L     R6,RBSAVE-TSTCWORK(R8) ACCESS STORED RB OR LLE           59520000
         LA    R6,@0(R6)      CLEAR HI ORDER BYTE                       59600000
         CR    R6,R3          COMPARE RB OR LLE                         59680000
         BCR   @8,R10         IF EQUAL, DUPLICATE SEARCH ENDED          59760000
         XR    R0,R0          INDICATE DUPLICATE - DO NOT PRINT MSG     59840000
         LR    R3,R6          RESTORE ORIGINAL RB OR LLE                59920000
         BR    R10            CONTINUE PROCESSING                       60000000
NEXTRB2  DS    0X                                                       60080000
         CLI   RBSAVE-TSTCWORK(R8),HEX80 TEST IF SEARCHING LOAD LIST    60160000
         BE    GETLLE2        IF SO, GET NEXT LLE                       60240000
         L     R3,RBLINK      IF NOT, GET NEXT RB                       60320000
         B     RBPROC2        PROCESS RB                                60400000
TSTMJCDE DS    0X                                                       60480000
         TM    CDATTR,CDMIN   CHECK FOR ALIAS (MINOR CDE)      @YM07131 60560000
         BNO   NEXTRB2        GET NEXT RB                               60640000
         L     R5,CDXLMJP     ACCESS MAJOR CDE                          60720000
         LA    R5,@0(R5)      CLEAR HI ORDER BYTE                       60800000
         B     USECDE2        PROCESS MAJOR CDE                         60880000
INITLLE2 DS    0X                                                       60960000
         L     R3,TCBLLS      OTHERWISE, ACCESS LOAD LIST PTR           61040000
         MVI   RBSAVE-TSTCWORK(R8),HEX80 TURN ON LLE INDICATOR          61120000
USELLE2  DS    0X                                                       61200000
         USING LLE,R3         ESTABLISH LLE ADDRESSABILITY              61280000
         LA    R3,@0(R3)      CLEAR HI ORDER BYTE                       61360000
         LTR   R3,R3          * THIS SITUATION SHOULD *                 61440000
         BCR   @8,R10         *   NEVER HAPPEN        *                 61520000
         L     R5,LLECDPT     ACCESS CDE PTR                            61600000
         LA    R5,@0(R5)      CLEAR HI ORDER BYTE                       61680000
         B     USECDE2        IF NOT, PROCESS CDE                       61760000
GETLLE2  DS    0X                                                       61840000
         L     R3,LLECHN      ACCESS NEXT LLE                           61920000
         B     USELLE2        PROCESS LLE                               62000000
         DROP  R1                                                       62020003
         DROP  R3                                                       62040003
         DROP  R5                                                       62060003
         EJECT                                                          62080000
*********************************************************************** 62160000
* THIS ROUTINE EXPECTS A TCB POINTER IN R1 AND THE ORIGINAL TCB MOTHER* 62240000
* STORED IN TCBCHAI IN WORKAREA  IT USES A MOTHER-DAUGHTER-SISTER     * 62320000
* CHAIN SEARCH AND RETURNS THE NEXT TCB IN R1. IF END OF CHAIN, R1=0  * 62400000
*********************************************************************** 62480000
TCBCHAIN DS    0X                                                       62560000
         LR    R2,R1          PUT TCB ADDRESS IN R2                     62640000
         L     R1,TCBLTC-TCB(R2) ACCESS DAUGHTER TASK PTR               62720000
         LA    R1,@0(R1)      CLEAR HI ORDER BYTE                       62800000
         LTR   R1,R1          TEST IF DAUGHTER EXISTS                   62880000
         BCR   @2,R14         IF NOT ZERO, RETURN TCB IN R1             62960000
SISTER   DS    0X                                                       63040000
         L     R1,TCBNTC-TCB(R2) IF NO DAUGHTER, GET SISTER             63120000
         LA    R1,@0(R1)      CLEAR HI ORDER BYTE                       63200000
         LTR   R1,R1          TEST IF SISTER EXISTS                     63280000
         BCR   @2,R14         IF NOT ZERO, RETURN TCB IN R1             63360000
         L     R2,TCBOTC-TCB(R2) IF NO SISTER, GET MOTHER               63440000
         LA    R2,@0(R2)      CLEAR HI ORDER BYTE                       63520000
         L     R11,WORKAREA   ACCESS WORKAREA PTR                       63600000
         L     R11,TCBCHAI-TSTCWORK(R11) ACCESS MOTHER TCB              63680000
         CR    R2,R11         DOES MOTHER = TEST TASK                   63760000
         BNE   SISTER         IF NOT GET MOTHER'S SISTER                63840000
         XR    R1,R1          INDICATE END OF TCB CHAIN                 63920000
         BR    R14            RETURN TCB ADDR TO CALLER                 64000000
         EJECT                                                          64080000
*********************************************************************** 64160000
*                          MESSAGE TEXT                               * 64240000
* ......LOCATED AT +... IN ..............UNDER TCB LOCATED AT.......  * 64320000
*********************************************************************** 64400000
OFFMSG   DS    0X                                                       64480000
         LR    R3,R14         SAVE RETURN ADDRESS                       64560000
         L     R4,OUTBUF      POINTER TO OUTBUF                         64640000
         XR    R2,R2          ZERO REGISTER TWO                         64720000
         STH   R2,@2(R4)     ZERO UNUSED FIELD                          64800000
         LA    R2,@81         ACCESS LENGTH OF MSG                      64880000
         STH   R2,@0(R4)      CONSTANT MSG LENGTH = 81                  64960000
         LA    R4,@4(R4)      POINTER TO ACTUAL MSG DATA                65040000
         MVI   @0(R4),BLANK   PUT BLANK IN MSG BUFFER                   65120000
         MVC   @1(@77,R4),@0(R4)  BLANK OUT MSG BUFFER                  65200000
         USING IKJPARMA,R7    ESTABLISH PDE ADDRESSABILITY              65280000
         L     R2,PDEUSER     ACCESS ABSOLUTE ADDRESS                   65360000
         BAL   R14,CONVERT    TO CONVERT ADDRESS TO PRINTABLE EBCDIC    65440000
         EX    R10,ADDRMVC    PUT CONVERTED ADDRESS IN BUFFER           65520000
         LA    R10,@2(R10,R4) UPDATE BUFFER POINTER                     65600000
         MVI   @0(R10),DOT    PUT PERIOD AFTER ABSOLUTE ADDRESS         65680000
         LA    R2,MDATA1      ACCESS PTR TO 'LOCATED AT'                65760000
         MVC   @8(@12,R4),@0(R2) PUT 'LOCATED AT' IN MSG BUFFER         65840000
         MVI   @20(R4),HEX4E  PUT PLUS SIGN BEFORE OFFSET               65920000
         L     R2,WORKAREA    ACCESS WORKAREA PTR                       66000000
         L     R2,OFFSET2-TSTCWORK(R2) ACCESS CALCULATED OFFSET         66080000
         BAL   R14,CONVERT    TO CONVERT OFFSET TO PRINTABLE EBCDIC     66160000
         EX    R10,OFFMVC     PUT CONVERTED OFFSET IN BUFFER            66240000
         LA    R2,MDATA2      ACCESS 'IN'                               66320000
         MVC   @28(@2,R4),@9(R2) PUT 'IN' INTO MSG BUFFER               66400000
         LH    R2,PDELEN1     ACCESS LENGTH OF LOADNAME                 66480000
         BCTR  R2,R0          DECREMENT FOR EXECUTE                     66560000
         L     R5,PDELDNAM    ACCESS PTR TO LOADNAME                    66640000
         EX    R2,LDNMVC      TO MOVE LOADNAME INTO MESSAGE             66720000
         MVI   @39(R4),DOT    PUT PERIOD TO INDICATE ABSOLUTE ADDR      66800000
         LH    R2,PDELEN2     ACCESS LENGTH OF CSECTNAME                66880000
         BCTR  R2,R0          DECREMENT FOR EXECUTE                     66960000
         L     R5,PDECTNAM    ACCESS PTR TO CSECT NAME                  67040000
         EX    R2,CTNMVC      TO MOVE CSECTNAME INTO MESSAGE            67120000
         LA    R2,MDATA3      ACCESS 'UNDER TCB'                        67200000
         MVC   @48(@22,R4),@0(R2) PUT 'UNDER TCB' IN MSG BUFFER         67280000
         LR    R2,R1          ACCESS TCB ADDR                           67360000
         BAL   R14,CONVERT    TO CONVERT TCB ADDRESS                    67440000
         EX    R10,TCBMVC     PUT CONVERTED TCB ADDRESS IN BUFFER       67520000
         LA    R10,@71(R10,R4) UPDATE BUFFER POINTER                    67600000
         MVI   @0(R10),DOT    PUT PERIOD AFTER TCB ADDRESS              67680000
         L     R1,OUTBUF      ACCESS PTR TO OUTPUT BUFFER               67760000
         BAL   R14,PUTMSG     TO BRANCH TO IO                           67840000
         BR    R3             RETURN TO CALLER                          67920000
ADDRMVC  MVC   @1(@1,R4),@0(R2) PUT CONVERTED ADDRESS IN MSG BUFFER     68000000
OFFMVC   MVC   @21(@1,R4),@0(R2) PUT CONVERTED OFFSET INTO MSG BUFFER   68080000
TCBMVC   MVC   @70(@1,R4),@0(R2) PUT CONVERTED ADDR INTO MSG BUFFER     68160000
*********************************************************************** 68240000
*                          MESSAGE TEXT                               * 68320000
*  .......LOCATED IN................UNDER TCB LOCATED AT.......       * 68400000
*********************************************************************** 68480000
LDNMSG   DS    0X                                                       68560000
         LR    R3,R14         SAVE RETURN ADDRESS                       68640000
         L     R4,OUTBUF      ACCESS PTR TO OUTPUT BUFFER               68720000
         XR    R2,R2          ZERO REGISTER TWO                         68800000
         STH   R2,@2(R4)      ZERO UNUSED FIELD                         68880000
         LA    R2,@71         ACCESS LENGTH OF MSG                      68960000
         STH   R2,@0(R4)      CONSTANT MSG LENGTH =71                   69040000
         LA    R4,@4(R4)      POINTER TO ACTUAL MSG DATA                69120000
         MVI   @0(R4),BLANK   PUT BLANK IN MSG BUFFER                   69200000
         MVC   @1(@67,R4),@0(R4)  BLANK OUT MSG BUFFER                  69280000
         USING IKJPARMA,R7    ESTABLISH PDE ADDRESSABILITY              69360000
         LH    R2,PDELEN1     ACCESS LENGTH OF LOADNAME                 69440000
         BCTR  R2,R0          DECREMENT FOR EXECUTE                     69520000
         L     R5,PDELDNAM    ACCESS PTR TO LOADNAME                    69600000
         EX    R2,LDNMVC2     TO MOVE LOADNAME INTO MSG                 69680000
         TM    PDEFLG2,CTNAMFLG TEST IF CSECT NAME SPECIFIED            69760000
         BNO   CONTMSG        DO NOT PUT IN CSECT NAME                  69840000
         MVI   @9(R4),DOT     PUT PERIOD BETWEEN LOADNAME-CSECTNAME     69920000
         LH    R2,PDELEN2     ACCESS LENGTH OF CSECTNAME                70000000
         BCTR  R2,R0          DECREMENT FOR EXECUTE                     70080000
         L     R5,PDECTNAM    ACCESS PTR TO CSECT NAME                  70160000
         EX    R2,CTNMVC2     TO MOVE CSECT NAME INTO MSG               70240000
         LA    R4,@9(R4)      UPDATE FOR POINTER UNIFORMITY             70320000
CONTMSG  DS    0X                                                       70400000
         LA    R2,MDATA1      ACCESS 'LOCATED AT'                       70480000
         MVC    @9(@12,R4),@0(R2) PUT'LOCATED AT' IN MSG BUFFER         70560000
         L     R2,PDEUSER     ACCESS ABSOLUTE ADDRESS                   70640000
         BAL   R14,CONVERT    TO CONVERT ADDRESS TO PRINTABLE EBCDIC    70720000
         EX    R10,A2MVC      PUT CONVERTED ADDRESS IN BUFFER           70800000
         LA    R10,@22(R10,R4) UPDATE BUFFER POINTER                    70880000
         MVI   @0(R10),DOT    PUT PERIOD AFTER ABSOLUTE ADDRESS         70960000
         LA    R2,MDATA3      ACCESS 'UNDER TCB'                        71040000
         MVC   @28(@22,R4),@0(R2) PUT'UNDER TCB' IN MSG BUFFER          71120000
         LR    R2,R1          ACCESS TCB ADDRESS                        71200000
         BAL   R14,CONVERT    TO CONVERT TCB ADDRESS                    71280000
         EX    R10,T2MVC      PUT CONVERTED TCB ADDRESS IN BUFFER       71360000
         LA    R10,@51(R10,R4) UPDATE BUFFER POINTER                    71440000
         MVI   @0(R10),DOT    PUT PERIOD AFTER TCB ADDRESS              71520000
         L     R1,OUTBUF      ACCESS ADDR OF OUTPUT BUFFER              71600000
         BAL   R14,PUTMSG     TO BRANCH TO IO                           71680000
         BR    R3             RETURN TO CALLER                          71760000
A2MVC    MVC   @21(@1,R4),@0(R2) PUT CONVERTED ADDRESS IN MSG BUFFER    71840000
T2MVC    MVC   @50(@1,R4),@0(R2) PUT CONVERTE ADDR INTO MSG BUFFER      71920000
*********************************************************************** 72000000
*                          MESSAGE TEXT                               * 72080000
*                   'NOT WITHIN ANY PROGRAM EXTENT'                   * 72160000
*********************************************************************** 72240000
REGMSG   DS    0X                                                       72320000
         LR    R3,R14         SAVE RETURN ADDRESS                       72400000
         L     R4,OUTBUF      POINTER TO OUTBUF                         72480000
         XR    R2,R2          ZERO REGISTER TWO                         72560000
         STH   R2,@2(R4)      ZERO UNUSED FIELD                         72640000
         LA    R4,@4(R4)      POINTER TO ACTUAL MSG DATA                72720000
         MVI   @0(R4),BLANK   PUT BLANK IN MSG BUFFER                   72800000
         MVC   @1(@48,R4),@0(R4)  BLANK OUT MSG BUFFER                  72880000
         USING IKJPARMA,R7    ESTABLISH PDE ADDRESSABILITY              72960000
         L     R2,PDEUSER     ACCESS ABSOLUTE ADDRESS                   73040000
         BAL   R14,CONVERT    TO CONVERT ADDRESS TO PRINTABLE EBCDIC    73120000
         EX    R10,A3MVC      PUT CONVERTED ADDRESS IN BUFFER           73200000
         LA    R4,@2(R10,R4)  UPDATE BUFFER POINTER                     73280000
         LA    R5,@38         BASE LENGTH OF MESSAGE                    73360000
         LA    R5,@1(R10,R5)  ADD VARIABLE LENGTH TO BASE LENGTH        73440000
         MVI   @0(R4),DOT     PUT PERIOD AFTER ABSOLUTE ADDRESS         73520000
         LA    R1,@2(R4)      CREATE PTR TO BUFFER FOR TSTADDR          73600000
         LR    R0,R7          PTR TO PDE FOR TSTADDR                    73680000
         L     R15,TSTADDR    ACCESS ADDR OF TSTADDR                    73760000
         BALR  R14,R15        BRANCH TO TSTADDR                         73840000
         LR    R10,R0         ACCESS LENGTH OF ADDR STRING              73920000
         LA    R5,@0(R10,R5)  ADD VARIABLE LENGTH TO CURRENT MSG LENGTH 74000000
         L     R10,OUTBUF     ACCESS ADDR OF OUTBUF                     74080000
         STH   R5,@0(R10)     STORE MSG LENGTH IN OUTBUF                74160000
         LA    R4,@1(R1)      CREATE POINTER TO NEXT AVAILABLE SPACE    74240000
         LA    R2,MDATA4      ACCESS MSG DATA                           74320000
         MVC   @0(@30,R4),@0(R2) PUT DATA IN MSG BUFFER                 74400000
         L     R1,OUTBUF      ACCESS ADDRESS OF OUTBUF                  74480000
         BAL   R14,PUTMSG     TO BRANCH TO IO                           74560000
         BR    R3             RETURN TO CALLER                          74640000
A3MVC    MVC   @1(@1,R4),@0(R2) PUT CONVERTED ADDRESS IN MSG BUFFER     74720000
PUTMSG   DS    0X             TO BRANCH TO IO                           74800000
PUTC     DS    0X                                                       74880000
         LR    R2,R14         SAVE RETURN ADDRESS                       74960000
         LR    R4,R1          REG 4 = PTR TO DATA                       75040000
         XC    TSTIOPRM,TSTIOPRM  CLEAR PARAMETER AREA                  75120000
         IKJEGSIO DATA,DATAPTR=(R4),ID=WHR32,MF=(E,TSTIOPRM)            75200000
         CH    R15,ATTNCODE   IS RET CODE LESS 16                       75280000
         BNL   PARS12         NO, GO SAVE RET CODE                      75360000
         BR    R2             YES, RETURN TO CALLER                     75440000
PARS12   EQU   *              RETURN TO PARSE WITH 12                   75520000
         L     R14,WORKAREA   ACCESS WORKAREA PTR                       75600000
         ST    R15,CODESAVE-TSTCWORK(R14)                               75680000
         LA    R15,@12        IN CASE RET CODE IS 16                    75760000
         B     GOHOME         RETURN TO PARSE WITH 12                   75840000
CONVERT  DS    0X              TO CONVERT TO PRINTABLE EBCDIC           75920000
         L     R5,WORKAREA    ACCESS ADDR OF WORKAREA                   76000000
         LA    R5,CWORKCMD-TSTCWORK(R5) ACCESS COMMAND PORTION          76080000
         ST    R2,@12(R5)     STORE ADDR TO BE CONVERTED                76160000
         UNPK  @0(@7,R5),@13(@4,R5) UNPACK ADDRESS                      76240000
         TR    @0(@6,R5),TRTAB-@240 CONVERT TO EBCDIC                   76320000
         LR    R2,R5          PUT ADDR OF CONVERTED STRING IN R2        76400000
         LA    R10,@5         INITIALIZE LENGTH COUNTER                 76480000
REMZ     DS    0X              THIS LOOP WILL REMOVE LEADING ZEROES     76560000
         CLI   @0(R2),ZERO    TEST FOR LEADING ZERO                     76640000
         BCR   @7,R14         IF NOT ZERO RETURN TO CALLER              76720000
         LA    R2,@1(R2)      INCREMENT ADDRESS POINTER                 76800000
         BCT   R10,REMZ       DECREMENT COUNTER AND BRANCH IF NOT ZERO  76880000
         BR    R14            RETURN TO CALLER IF COUNTER = ZERO        76960000
         EJECT                                                          77040000
GOHOME   DS    0X                                                       77120000
         NI    TSTFLGS4,HEXFF-TSTVALCK  SHUT OFF VALIDITY FLAG          77200000
         L     R4,OUTBUF      ACCESS POINTER TO OUTBUF                  77280000
         L     R4,@0(R4)      ACCESS 1ST WORD OF OUTBUF                 77360000
         LTR   R4,R4          IS THERE A SECOND LEVEL MSG               77440000
         BZ    PARSRET        NO, RETURN TO PARSE                       77520000
         L     R8,WORKAREA    ACCESS WORKAREA                           77600000
         L     R11,MSGADDR-TSTCWORK(R8) ACCESS PTR TO PARSE PARMLIST    77680000
         MVC   @0(@4,R11),OUTBUF GIVE IT TO PARSE                       77760000
PARSRET  EQU   *              RETURN TO PARSE                           77840000
         L     R2,WORKAREA    ACCESS WORKAREA ADDR                      77920000
         MVC   @0(@25,R7),PDESAVE-TSTCWORK(R2) RESTORE ORIGINAL PDE     78000000
         L     R13,@4(R13)    ACCESS CALLER'S SAVE AREA                 78080000
         RETURN (14,12),RC=(15) RETURN TO PARSE                         78160000
         EJECT                                                          78240000
CODECHK  DS    0X             CHECK RETURN CODE FROM CONVERT            78320000
         B     BTAB(R15)      BRANCH ACCORDING TO RETURN CODE           78400000
BTAB     BR    R14            IF RETURN CODE = 0                        78480000
         BR    R14            FOR ALIGNMENT PURPOSES                    78560000
         B     CONVMSG        IF RETURN CODE = 4                        78640000
         B     CONVMSG        IF RETURN CODE = 8                        78720000
         B     CONVMSG        IF RETURN CODE = 12                       78800000
         B     SYMSTAE        IF RETURN CODE = 16                       78880000
         B     CONVMSG        IF RETURN CODE = 20                       78960000
CODECHK2 DS    0X             CHECK RETURN CODE FROM SYM                79040000
         B     BTAB2(R15)     BRANCH ACCORDING TO RETURN CODE           79120000
BTAB2    BR    R14            IF RETURN CODE = 0                        79200000
         BR    R14            FOR ALIGNMENT PURPOSES                    79280000
         B     TRYALIAS       IF RETURN CODE = 4                        79360000
         B     TRYALIAS       IF RETURN CODE = 8                        79440000
         B     CONVMSG        IF RETURN CODE = 12                       79520000
         B     SYMSTAE        IF RETURN CODE = 16                       79600000
         B     SYMSTAE        IF RETURN CODE = 20                       79680000
CONVMSG  DS    0X             ENTER HERE FOR RETURN CODE 8              79760000
         LA    R15,@8         SET RETURN CODE TO 8                      79840000
         B     GOHOME         RETURN TO PARSE                           79920000
SYMSTAE  DS    0X              ENTER HERE IF RETURN CODE = 20           80000000
         L     R8,WORKAREA    ACCESS PTR TO WORKAREA                    80080000
         ST    R15,CODESAVE-TSTCWORK(R8) STORE RETURN CODE              80160000
         LA    R15,@12        SET RETURN CODE TO PARSE                  80240000
         B     GOHOME         RETURN TO PARSE                           80320000
         EJECT                                                          80400000
* THE FOLLOWING ARE MESSAGE OUTPUTTING ROUTINES.                        80480000
MSG1     XC    TSTIOPRM,TSTIOPRM CLEAR PARAMETER AREA                   80560000
         IKJEGSIO MSG,FIRST=(R2),SECOND=(R3),ID=WHR32,                 *80640000
               MF=(E,TSTIOPRM)  CALL IO                                 80720000
         BR    R6             RETURN TO CALLER                          80800000
         SPACE                                                          80880000
MSG2     XC    TSTIOPRM,TSTIOPRM  CLEAR PARAMETER AREA                  80960000
         IKJEGSIO MSG,FIRST=(R2),INST11=(NUM,I0016),SECOND=(R3),       *81040000
               ID=WHR32,MF=(E,TSTIOPRM)  CALL IO                        81120000
         BR    R6             RETURN TO CALLER                          81200000
         SPACE                                                          81280000
MSG3     XC    TSTIOPRM,TSTIOPRM  CLEAR PARAMETER AREA                  81360000
         IKJEGSIO MSG,FIRST=(R2),INST11=(APDE,(R4)),SECOND=(R3),       *81440000
               ID=WHR32,MF=(E,TSTIOPRM)  CALL IO                        81520000
         CH    R15,ATTNCODE   IS RET CODE LESS 16                       81600000
         BNL   PARS12         NO, RETURN WITH 12                        81680000
         LA    R15,@8         YES, RC=8 (RE-ENTER)                      81760000
         B     GOHOME         RETURN TO PARSE                           81840000
         SPACE                                                          81920000
LINKFL1  BAL   R5,LINKFAIL    PUT OUT ERR MSG                           82000000
         CH    R15,ATTNCODE   IS RET CODE LESS THAN 16                  82080000
         BNL   RET            NO,SEND RC BACK TO MAINLINE               82160000
         B     A0008          YES, SET RC=0, RETURN                     82240000
         SPACE                                                          82320000
LINKFL2  BAL   R5,LINKFAIL    PUT OUT ERR MSG                           82400000
         CH    R15,ATTNCODE   IS RET CODE LESS THAN 16                  82480000
         BNL   PARS12         NO, SET RC=12 FOR PARSE                   82560000
         LA    R15,@8         YES, SET RC=8                             82640000
         B     GOHOME         RETURN TO PARSE                           82720000
         SPACE                                                          82800000
LINKFAIL LR    R3,R1          ABEND CODE TO REG 3                       82880000
         LR    R2,R15         RET CODE TO REG 2                         82960000
         XC    TSTIOPRM,TSTIOPRM CLEAR PARAMETER AREA                   83040000
         IKJEGSIO SVCERR,SVC=6,ABENDRG=(R3),RC=(R2),                   *83120000
               INST11=(NUM,(R4)),ID=WHR32,MF=(E,TSTIOPRM) CALL IO       83200000
         BR    R5             RETURN TO CALLER                          83280000
         SPACE                                                          83360000
LISTESTA IKJEGSPL RTRY=RETRY,ABNTB=STAETAB,MODNM=IKJEGWHR,             *83440000
               TNM=WHERE      BUILD ESTAE PARAMETER LIST                83520000
         TITLE 'IKJEGWHR, ''WHERE'' SUBCOMMAND, MACROS AND CONSTANTS'   83600000
PARSELST DC    V(IKJEGPRS)    ADDRESS OF PARAMETER PASSED TO PARSE      83680000
IKJEGPRS IKJPARM                                                        83760000
GETADDR  IKJPOSIT   ADDRESS,VALIDCK=IKJEGVLC                            83840000
*                             MACRO USED TO CHECK ADDRESS               83920000
         IKJENDP                                                        84000000
         SPACE 5                                                        84080000
LDNMVC2  MVC   @1(@1,R4),@0(R5) PUT LOADNAME IN MSG BUFFER              84160000
CTNMVC2  MVC   @10(@1,R4),@0(R5) PUT CSECT NAME IN MSG BUFFER           84240000
LDNMVC   MVC   @31(@1,R4),@0(R5) PUT LOADNAME IN MSG BUFFER             84320000
CTNMVC   MVC   @40(@1,R4),@0(R5) PUT CSECT NAME IN MSG BUFFER           84400000
MOVNAME  MVC   @0(@1,R1),@0(R3) MOVE NAME FROM PDE TO WORKAREA          84480000
MOVDISPL MVC   @30(@1,R1),@1(R10)  MOVE OFFSET TO OUTPUT                84560000
INVLD    MVC   @0(@1,R2),@0(R11) MSG DATA INTO OUTPUT BUFFER            84640000
CSECTMVC MVC   CSECTNAM-TSTCWORK(@1,R6),@0(R1) MOVE CSECT NAME          84720000
         SPACE 5                                                        84800000
TRTAB    DC    C'0123456789ABCDEF' TRANSLATE TABLE                      84880000
MDATA1   DC    C' LOCATED AT ' MSG DATA                                 84960000
MDATA2   DC    C' LOCATED IN ' MSG DATA                                 85040000
MDATA3   DC    C' UNDER TCB LOCATED AT ' MSG DATA                       85120000
MDATA4   DC    C'NOT WITHIN ANY PROGRAM EXTENT ' MSG DATA               85200000
ADDRSIZE DC    X'000B0000'    SIZE OF ADDRESS                           85280000
ATTNCODE DC    H'16'          ATTENTION RET CODE                        85360000
CONSTANT DC    50C'Z'         ZAP AREA                                  85440000
         SPACE 5                                                        85520000
************************************************************            85600000
*                                                          *            85680000
*                    EQUATES                               *            85760000
*                                                          *            85840000
************************************************************            85920000
ZERO     EQU   C'0'                                                     86000000
HEX11    EQU   X'11'                                                    86080000
HEX10    EQU   X'10'                                                    86160000
HEX04    EQU   X'04'                                                    86240000
HEX80    EQU   X'80'                                                    86320000
HEXDF    EQU   X'DF'                                                    86400000
HEXFF    EQU   X'FF'                                                    86480000
HEX4E    EQU   X'4E'                                                    86560000
HEX00    EQU   X'00'                                                    86640000
HEXC0    EQU   X'C0'                                                    86720000
BLANK    EQU   X'40'                                                    86800000
TTCBPKF  EQU   28                                                       86880000
DOT      EQU   X'4B'                                                    86960000
@0       EQU   0                                                        87040000
@1       EQU   1                                                        87120000
@2       EQU   2                                                        87200000
@3       EQU   3                                                        87280000
@4       EQU   4                                                        87360000
@5       EQU   5                                                        87440000
@6       EQU   6                                                        87520000
@7       EQU   7                                                        87600000
@8       EQU   8                                                        87680000
@9       EQU   9                                                        87760000
@10      EQU   10                                                       87840000
@12      EQU   12                                                       87920000
@13      EQU   13                                                       88000000
@14      EQU   14                                                       88080000
@16      EQU   16                                                       88160000
@18      EQU   18                                                       88240000
@20      EQU   20                                                       88320000
@21      EQU   21                                                       88400000
@22      EQU   22                                                       88480000
@24      EQU   24                                                       88560000
@25      EQU   25                                                       88640000
@27      EQU   27                                                       88720000
@28      EQU   28                                                       88800000
@30      EQU   30                                                       88880000
@31      EQU   31                                                       88960000
@32      EQU   32                                                       89040000
@36      EQU   36                                                       89120000
@38      EQU   38                                                       89200000
@39      EQU   39                                                       89280000
@40      EQU   40                                                       89360000
@41      EQU   41                                                       89440000
@44      EQU   44                                                       89520000
@48      EQU   48                                                       89600000
@49      EQU   49                                                       89680000
@50      EQU   50                                                       89760000
@51      EQU   51                                                       89840000
@52      EQU   52                                                       89920000
@53      EQU   53                                                       90000000
@56      EQU   56                                                       90080000
@57      EQU   57                                                       90160000
@58      EQU   58                                                       90240000
@60      EQU   60                                                       90320000
@64      EQU   64                                                       90400000
@67      EQU   67                                                       90480000
@68      EQU   68                                                       90560000
@70      EQU   70                                                       90640000
@71      EQU   71                                                       90720000
@76      EQU   76                                                       90800000
@77      EQU   77                                                       90880000
@81      EQU   81                                                       90960000
@92      EQU   92                                                       91040000
@96      EQU   96                                                       91120000
@240     EQU   240                                                      91200000
R0       EQU   0                                                        91280000
R1       EQU   1                                                        91360000
R2       EQU   2                                                        91440000
R3       EQU   3                                                        91520000
R4       EQU   4                                                        91600000
R5       EQU   5                                                        91680000
R6       EQU   6                                                        91760000
R7       EQU   7                                                        91840000
R8       EQU   8                                                        91920000
R9       EQU   9                                                        92000000
R10      EQU   10                                                       92080000
R11      EQU   11                                                       92160000
R12      EQU   12                                                       92240000
R13      EQU   13                                                       92320000
R14      EQU   14                                                       92400000
R15      EQU   15                                                       92480000
* THE FOLLOWING ARE 1ST LEVEL MESSAGE NO. EQUATES.                      92560000
M0101    EQU   101            INVALID ADDRESS ...                       92640000
M0103    EQU   103            NOT ENOUGH MAIN STORAGE                   92720000
M0104    EQU   104            WHERE FAILED, CMMND SYS ERR               92800000
* THE FOLLOWING ARE 2ND LEVEL MESSAGE NO. EQUATES.                      92880000
M0274    EQU   274            REG NOT. MUST BE INDRT GEN REG            92960000
M0277    EQU   277            PARSE ERROR CODE 12                       93040000
* THE FOLLOWING ARE CONSTANT MESSAGE INSERTS.                           93120000
I0016    EQU   16             WHERE                                     93200000
I0040    EQU   40             IKJPARS                                   93280000
I0085    EQU   85             IKJEGSYM                                  93360000
I0099    EQU   99             BLOW CODES FOR ABENDTABLE                 93440000
         EJECT                                                          93520000
STAETAB  DS    0F             TO ALIGN TO FULL WORD BOUNDRY             93600000
         DC    AL1(I0099)     STAE ABEND CODE FOR SYM LINK              93680000
         DC    AL3(BLOW1)     RESUME ADDR FOR STAE                      93760000
         DC    AL1(I0099)     STAE ABEND CODE FOR SYM LINK              93840000
         DC    AL3(BLOW2)     RESUME ADDR FOR STAE                      93920000
         DC    AL1(I0099)     STAE ABEND CODE FOR SYM LINK              94000000
         DC    AL3(BLOW3)     RESUME ADDR FOR STAE                      94080000
         DC    X'FF'          INDICATE END OF TABLE                     94160000
         DS    0F                                                       94240000
LISTSTAE ESTAE MF=L           LIST FORM OF ESTAE                        94320000
ENDLIST  EQU   *-LISTSTAE                                               94400000
SUBPOOL  EQU   *                                                        94480000
         DC    AL1(0)         SUBPOOL NUMBER                            94560000
         DC    AL3(104)       WORKAREA LENGTH IN BYTES                  94640000
ARETRY   DC    AL3(RETRY)     ADDR OF STAE RETRY RTN                    94720000
SYM      DC    C'SYM'         FOR BLDL ENTRY TO SYM                     94800000
SMTSYM01 DS    0C             TEST CASE TTSTC120                        94880000
LINKF    LINK  SF=L           LIST FORM FOR LINK                        94960000
LINKL    EQU   *-LINKF        LENGTH OF LIST FORM OF LINK               95040000
        EJECT                                                           95120000
*                                                          *            95200000
*         TEST COMMUNICATION TABLE DSECT                   *            95280000
*                                                          *            95360000
************************************************************            95440000
TCOMTAB TCOMTAB              MACRO THAT GENERATES TCOMTAB DSECT         95520000
        EJECT                                                           95600000
************************************************************            95680000
*                                                          *            95760000
*              EXTENT BLOCK DSECT                          *            95840000
*                                                          *            95920000
************************************************************            96000000
         IHAXTLST                                                       96080000
         EJECT                                                          96160000
         IKJPPL                                                         96240000
         EJECT                                                          96320000
TCBDSECT IKJTCB             TCB DSECT                                   96400000
         EJECT                                                          96480000
         IHACDE                                                         96560000
         EJECT                                                          96640000
         IKJRB                                                          96720000
         EJECT                                                          96800000
************************************************************            96880000
*                                                          *            96960000
*             ADDRESS PDE CREATED BY PARSE                 *            97040000
*                                                          *            97120000
************************************************************            97200000
         IKJPARMA                                                       97280000
         EJECT                                                          97360000
CVT      DSECT               CVT DSECT                                  97440000
         CVT                                                            97520000
         EJECT                                                          97600000
         IHALLE                                                         97680000
         EJECT                                                          97760000
         TSTCWORK                                                       97840000
MYWORK   ORG   CWORKCMD       ORGANIZATION OF THIS MODULE WORKAREA      97920000
MYBUFFER DS    7A             THIS MODULE WORK BUFFER                   98000000
ALIASAVE DS    2A             ALIA SAVE AREA                            98080000
CSECTNAM DS    2A             CSECTNAMES                                98160000
PPLSAVE  DS    7A             SAVE AREA                                 98240000
CODESAVE DS    1A             RETURN CODE SAVE AREA                     98320000
PDESAVE  DS    7A             SAVE AREA                                 98400000
CURLD    DS    2A             CURRENT LOAD NAME                         98480000
LOADNAME DS    2A             LOAD NAME                                 98560000
LOADSAVE DS    1A             SAVE AREA                                 98640000
USERSAVE DS    1A             USER SAVE                                 98720000
TCBCHAI  DS    1A             TCB CHAIN ADDRESS                         98800000
TCBSAVE  DS    1A             TCB SAVE AREA                             98880000
RBSAVE   DS    1A             RB SAVE AREA                              98960000
CDESAVE  DS    1A             CDESAVE AREA                              99040000
OFFSET2  DS    1A             OFFSET  VARIABLE                          99120000
OFFSET   DS    1A             OFFSET  VARIABLE                          99200000
MSGADDR  DS    1A             MSSG POINTER                              99280000
MSGHOLD  DS    1A             MSSG HOLDING AREA                         99360000
MSGHOLD2 DS    1A             MSSG HOLDING AREA                         99440000
RETURN   DS    1A             RETURN ADDRESS SAVE AREA                  99520000
          END                                                           99600000
