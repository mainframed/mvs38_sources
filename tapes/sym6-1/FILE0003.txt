./  ADD  SSI=73180612,NAME=IGG019AH
         TITLE 'IGG019AH SAM SUBSYSTEM INTERFACE SYNAD MODULE          *00001000
                        '                                               00002000
IGG019AH CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL2(@EP00001-@MAINENT)                                   00007000
INTSYDAF DS    0H                                                  0001 00008000
         USING *,@15                                               0001 00009000
         B     @PROLOG                                             0001 00010000
         DC    AL2(@EP00181-INTSYDAF)                                   00011000
         ENTRY INTSYDAF                                                 00012000
         DROP  @15                                                      00013000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00014000
         BALR  @12,0                                               0001 00015000
@PSTART  DS    0H                                                  0001 00016000
         USING @PSTART,@12                                         0001 00017000
         AH    @15,4(,@15)                                         0001 00018000
         BR    @15                                                 0001 00019000
@EP00001 DS    0H                                                  0002 00020000
*                                                                  0073 00021000
*        /* AT ENTRY REGISTER 1 POINTS TO THE RPL                  */   00022000
*                                                                  0074 00023000
*        /***********************************************************/  00024000
*        /* ESTABLISH CONTROL BLOCK BASES                           */  00025000
*        /***********************************************************/  00026000
*                                                                  0074 00027000
*        RRPL= R1;                      /* RPL BASE                 */  00028000
         LR    RRPL,R1                                             0074 00029000
*        RESPECIFY IFGRPL BASED(RRPL);                             0075 00030000
*                                                                  0075 00031000
*        RCICB = RPLCICB;               /* CICB BASE                */  00032000
         L     RCICB,RPLCICB(,RRPL)                                0076 00033000
*        RESPECIFY IFGJCICB BASED (RCICB);                         0077 00034000
*                                                                  0077 00035000
*        RDCB = CIDCBPTR;               /* DCB BASE                 */  00036000
         L     RDCB,CIDCBPTR(,RCICB)                               0078 00037000
*        RESPECIFY IFGSDCB  BASED (RDCB);                          0079 00038000
*                                                                  0079 00039000
*        RDECB = RPLDECB;               /* DECB BASE                */  00040000
         L     RDECB,RPLDECB(,RRPL)                                0080 00041000
*        RESPECIFY DECB BASED(RDECB);                              0081 00042000
*                                                                  0081 00043000
*                                       /****************************/  00044000
*                                       /* IF NO SYNAD SUPPLIED     */  00045000
*        IF DCBSYNAD = 1                /* BYPASS SYNAD EXIT SECTION*/  00046000
*          THEN                         /****************************/  00047000
         CLC   DCBSYNAD(3,RDCB),@CF00088+1                         0082 00048000
         BE    @RT00082                                            0082 00049000
*            GOTO EROPT;                                           0083 00050000
*                                                                  0083 00051000
*                                                                  0083 00052000
*/*******************************************************************/  00053000
*/*      GET AND CHAIN A SAVE AREA FOR USE ACROSS USER EXIT         */  00054000
*/*******************************************************************/  00055000
*                                                                  0084 00056000
*        RCSAVE = R13;                  /* SAVE PTR TO CALLER SAVE  */  00057000
         LR    RCSAVE,R13                                          0084 00058000
*        R13 = CIREGBC;                 /* POINT TO USER SAVE       */  00059000
         L     R13,CIREGBC(,RCICB)                                 0085 00060000
*        R0 = LENGTH(REGSAVE);          /* GET A NEW SAVE AREA      */  00061000
         LA    R0,72                                               0086 00062000
*        GEN (GETMAIN R,LV=(0));                                   0087 00063000
         GETMAIN R,LV=(0)                                               00064000
*        IF DCBMACRF(3)   = '1'B        /* IF CALLER IS IGG019BB    */  00065000
*          THEN                         /* YES                      */  00066000
         TM    DCBMACRF(RDCB),B'00100000'                          0088 00067000
         BNO   @RF00088                                            0088 00068000
*            DO;                        /* COMPENSATE - NONSTD SAVE */  00069000
*              R1->SAVE141 = R13->SAVE141; /* COPY USER X, X, 14, 15*/  00070000
         MVC   SAVE141(16,R1),SAVE141(R13)                         0090 00071000
*              R1->SAVE28 = R13->SAVE410; /* COPY USER 2 - 8        */  00072000
         MVC   SAVE28(28,R1),SAVE410(R13)                          0091 00073000
*              R1->SAVE912 = RCSAVE->SAVE912; /* COPY USER 9 - 12   */  00074000
         MVC   SAVE912(16,R1),SAVE912(RCSAVE)                      0092 00075000
*              /* NOTE THAT 9 - 12 ARE COMING FROM CALLERS SAVE AREA*/  00076000
*              /* IGG019BB DOES NOT SAVE OR USE THESE REGISTERS     */  00077000
*            END;                                                  0093 00078000
*                                                                  0093 00079000
*          ELSE                         /* NO, FOR ALL OTHER CALLERS*/  00080000
*            R1->SAVE1412 = R13->SAVE1412;/* SAVE USER REGS         */  00081000
*                                                                  0094 00082000
         B     @RC00088                                            0094 00083000
@RF00088 MVC   SAVE1412(60,R1),SAVE1412(R13)                       0094 00084000
*        R1->SAVEPREV = RCSAVE;         /* BACKCHAIN NEW TO CALLER  */  00085000
@RC00088 ST    RCSAVE,SAVEPREV(,R1)                                0095 00086000
*        RCSAVE->SAVENEXT = R1;         /* FORCHAIN CALLER TO NEW   */  00087000
         ST    R1,SAVENEXT(,RCSAVE)                                0096 00088000
*        R1->SAVENEXT = R13;            /* FORCHAIN NEW TO USER     */  00089000
         ST    R13,SAVENEXT(,R1)                                   0097 00090000
*        RCSAVE = R1;                   /* KEEP POINTER TO NEW      */  00091000
         LR    RCSAVE,R1                                           0098 00092000
*        R13->SAVE1 = R1;                                          0099 00093000
*                                                                  0099 00094000
         ST    R1,SAVE1(,R13)                                      0099 00095000
*/*******************************************************************/  00096000
*/*      SET UP PARAMETERS TO PASS TO USER EXIT                     */  00097000
*/*******************************************************************/  00098000
*                                                                  0100 00099000
*        CISYNADA = ADDR(INTSYDAF);     /* PLACE SYNADAF ENTRY POINT    00100000
*                                            ADDRESS IN CICB FOR   0100 00101000
*                                            SVC EXIT               */  00102000
*                                                                  0100 00103000
         L     @14,@CA01129                                        0100 00104000
         ST    @14,CISYNADA(,RCICB)                                0100 00105000
*        DCBCIND2(4) = '1'B;            /* INDICATE PERMANENT I/O  0101 00106000
*                                            ERROR IN DCB            */ 00107000
         OI    DCBCIND2(RDCB),B'00010000'                          0101 00108000
*        IF DCBCIND2(8) = '1'B THEN     /* IS THIS A QSAM DCB? Y02144*/ 00109000
*                                                                  0102 00110000
         TM    DCBCIND2(RDCB),B'00000001'                          0102 00111000
         BNO   @RF00102                                            0102 00112000
*          DO;                          /* YES SET UP FOR QSAM Y02144*/ 00113000
*            R0 = ADDR(CIIOB);          /* POINT REG 0 TO IOB  Y02144*/ 00114000
         LA    R0,CIIOB(,RCICB)                                    0104 00115000
*            CIRESID = RPLBUFL - RPLRLEN;/* SET 'CSW' COUNT    Y02144*/ 00116000
         L     @14,RPLBUFL(,RRPL)                                  0105 00117000
         SL    @14,RPLRLEN(,RRPL)                                  0105 00118000
         ST    @14,CIRESID(,RCICB)                                 0105 00119000
*            IF CIRESID < 1 THEN        /* DID WE GO NEGATIVE? Y02144*/ 00120000
         LTR   @14,@14                                             0106 00121000
         BP    @RF00106                                            0106 00122000
*              CIRESID = 0;             /* THEN RESET TO ZERO  Y02144*/ 00123000
         SLR   @14,@14                                             0107 00124000
         ST    @14,CIRESID(,RCICB)                                 0107 00125000
*          END;                         /* END OF QSAM SETUP   Y02144*/ 00126000
*                                                                  0108 00127000
*        ELSE                           /* NOT QSAM            Y02144*/ 00128000
*          DO;                          /* SET UP FOR BSAM     Y02144*/ 00129000
         B     @RC00102                                            0109 00130000
@RF00102 DS    0H                                                  0110 00131000
*            CIFLAG1 = DECBCOND;        /* ERR INDEX FROM DECB Y02144*/ 00132000
         MVC   CIFLAG1(1,RCICB),DECBCOND(RDECB)                    0110 00133000
*            IF CIFLAG1 = 0 THEN        /* IF INDEX IS ZERO,   Y02144*/ 00134000
         CLI   CIFLAG1(RCICB),0                                    0111 00135000
         BNE   @RF00111                                            0111 00136000
*              CIFLAG1 = ERR7;          /* ITS INVALID CHECK   Y02144*/ 00137000
         MVI   CIFLAG1(RCICB),X'07'                                0112 00138000
*            R0 = RDECB;                /* POINT REG 0 TO DECB Y02144*/ 00139000
@RF00111 LR    R0,RDECB                                            0113 00140000
*            CIRESID = DECRESDU;        /* RESID COUNT TO IOB  Y02144*/ 00141000
         LH    @14,DECRESDU(,RDECB)                                0114 00142000
         N     @14,@CF01196                                        0114 00143000
         ST    @14,CIRESID(,RCICB)                                 0114 00144000
*            DECIOBPT = ADDR(CIIOB);    /* SET UP IOB PTR      Y02144*/ 00145000
         LA    @14,CIIOB(,RCICB)                                   0115 00146000
         ST    @14,DECIOBPT(,RDECB)                                0115 00147000
*          END;                         /* END OF BSAM SETUP   Y02144*/ 00148000
*                                                                  0116 00149000
*        /* DO SETUP COMMON TO BSAM AND QSAM                         */ 00150000
*                                                                  0117 00151000
*        R1 = RDCB;                     /* REG 1 IS DCB PTR    Y02144*/ 00152000
@RC00102 LR    R1,RDCB                                             0117 00153000
*        RWORK = ADDR(SYNSTAT(CIFLAG1));/* GET SYNAD CODE FROM Y02144   00154000
*                                          TBL USING ERR INDEX       */ 00155000
         SLR   RWORK,RWORK                                         0118 00156000
         IC    RWORK,CIFLAG1(,RCICB)                               0118 00157000
         LA    RWORK,SYNSTAT-1(RWORK)                              0118 00158000
*        GEN (ICM R1,8,0(RWORK));       /* INSERT CODE TO REG1 Y02144*/ 00159000
*                                                                  0119 00160000
*                                                                  0119 00161000
         ICM R1,8,0(RWORK)                                              00162000
*                                                                  0120 00163000
*        /***********************************************************/  00164000
*        /*                                                         */  00165000
*        /* GO TO USER SYNAD                                        */  00166000
*        /*                                                         */  00167000
*        /***********************************************************/  00168000
*                                                                  0120 00169000
*        R15 = DCBSYNAD;                /* GET EP TO USER ROUTINE   */  00170000
         L     R15,DCBSYNAD-1(,RDCB)                               0120 00171000
         LA    R15,0(,R15)                                         0120 00172000
*        GEN;                           /* GEN ASSEMBLER CODE       */  00173000
*                                                                  0121 00174000
         STM   @2,@C,SAVE2(R13)         SAVE MY REGS IN USER AREA       00175000
         LM    @2,@C,SAVE2(RCSAVE)      LOAD USER REGISTERS             00176000
         BALR  @E,@F                    TAKE USER EXIT                  00177000
         L     R1,SAVE1(R13)            FIND NEW SAVE AREA              00178000
         STM   @2,@C,SAVE2(R1)          SAVE USER REGS THERE            00179000
         LM    @2,@C,SAVE2(R13)         RESTORE MY REGISTERS            00180000
*        RCSAVE = RCSAVE->SAVEPREV;     /* BACK UP TO CALLER SAVE   */  00181000
         L     RCSAVE,SAVEPREV(,RCSAVE)                            0122 00182000
*        IF DCBMACRF(3)   = '1'B        /* IS CALLER IGG019BB       */  00183000
*          THEN                                                    0123 00184000
         TM    DCBMACRF(RDCB),B'00100000'                          0123 00185000
         BNO   @RF00123                                            0123 00186000
*            DO;                        /* COMPENSATE - NONSTD SAVE */  00187000
*              R13->SAVE141 = R1->SAVE141; /*RESTORE X, X, 14, 15   */  00188000
         MVC   SAVE141(16,R13),SAVE141(R1)                         0125 00189000
*              R13->SAVE410 = R1->SAVE28;  /* RESTORE REG 2 - 8     */  00190000
         MVC   SAVE410(28,R13),SAVE28(R1)                          0126 00191000
*              RCSAVE->SAVE912 = R1->SAVE912; /* AND REG 9 - 12     */  00192000
         MVC   SAVE912(16,RCSAVE),SAVE912(R1)                      0127 00193000
*           END;                                                   0128 00194000
*                                                                  0128 00195000
*          ELSE                         /* FOR ALL OTHER CALLERS    */  00196000
*             R13->SAVE1412 = R1->SAVE1412; /* RESTORE USER SAVE    */  00197000
*                                                                  0129 00198000
         B     @RC00123                                            0129 00199000
@RF00123 MVC   SAVE1412(60,R13),SAVE1412(R1)                       0129 00200000
*        R13 = RCSAVE;                  /* RESTORE ORIG R13 VALUE   */  00201000
@RC00123 LR    R13,RCSAVE                                          0130 00202000
*        R0 = LENGTH(REGSAVE);          /* FREE NEW SAVE AREA       */  00203000
         LA    R0,72                                               0131 00204000
*        GEN (FREEMAIN R,LV=(0),A=(1)); /* ADDR IS STILL IN R1      */  00205000
*                                                                  0132 00206000
         FREEMAIN R,LV=(0),A=(1)                                        00207000
*        CISYNADA = 0;                  /* CLEAR SYNADAF EP ADDRESS */  00208000
         SLR   @14,@14                                             0133 00209000
         ST    @14,CISYNADA(,RCICB)                                0133 00210000
*        CISYNRC = '08'X;               /* RESTORE RETURN CODE      */  00211000
         MVI   CISYNRC(RCICB),X'08'                                0134 00212000
*        /***********************************************************/  00213000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00214000
         EJECT                                                          00215000
*                                                                  0136 00216000
*EROPT:  /***********************************************************/  00217000
*        /*    TEST DCBEROPT SPECIFIED                              */  00218000
*        /***********************************************************/  00219000
*                                                                  0136 00220000
*        IF DCBMACRF(3)   = '1'B | DCBMACRF(11)  = '1'B/*          0136 00221000
*                                          IF BSAM                  */  00222000
*          THEN IF DCBSYNAD ¬= 1        /* AND NO SYNAD SPECIFIED   */  00223000
EROPT    TM    DCBMACRF(RDCB),B'00100000'                          0136 00224000
         BO    @RT00136                                            0136 00225000
         TM    DCBMACRF+1(RDCB),B'00100000'                        0136 00226000
         BNO   @RF00136                                            0136 00227000
@RT00136 DS    0H                                                  0137 00228000
*                 THEN RETURN;                                     0137 00229000
         CLC   DCBSYNAD(3,RDCB),@CF00088+1                         0137 00230000
         BNE   @RT00137                                            0137 00231000
*                 ELSE;                                            0139 00232000
*          ELSE IF DCBMACRF(2)   = '1'B | DCBMACRF(10)  = '1'B/*   0140 00233000
*                                          IF QSAM                  */  00234000
*                 THEN IF DCBEROPT(1) = '1'B |  /* AND IF ERROR     */  00235000
         B     @RC00136                                            0140 00236000
@RF00136 TM    DCBMACRF(RDCB),B'01000000'                          0140 00237000
         BO    @RT00140                                            0140 00238000
         TM    DCBMACRF+1(RDCB),B'01000000'                        0140 00239000
         BNO   @RF00140                                            0140 00240000
@RT00140 DS    0H                                                  0141 00241000
*                         DCBEROPT(2) = '1'B    /* OPTIONS SPECIFIED*/  00242000
*                        THEN RETURN;   /* THEN RETURN TO USER      */  00243000
         TM    DCBEROPT(RDCB),B'11000000'                          0141 00244000
         BNZ   @RT00141                                            0141 00245000
*                        ELSE;                                     0143 00246000
*                 ELSE;                                            0144 00247000
*                                                                  0144 00248000
@RF00140 DS    0H                                                  0145 00249000
*        /***********************************************************/  00250000
*        /*   BEFORE ABEND, ISSUE PROBLEM DETERMINATION MESSAGES    */  00251000
*        /***********************************************************/  00252000
*                                                                  0145 00253000
*        R0 = LENGTH(WTOMSG);           /* MESSAGE BUFFER SIZE      */  00254000
@RC00136 LA    R0,52                                               0145 00255000
*        GEN (GETMAIN R,LV=(0));        /* REQUEST CORE FOR BUFFER  */  00256000
         GETMAIN R,LV=(0)                                               00257000
*        R6 = R1;                       /* SAVE BUFFER ADDRESS      */  00258000
         LR    R6,R1                                               0147 00259000
*        RESPECIFY WTOMSG BASED(R6);                               0148 00260000
*                                                                  0148 00261000
*        RTIODD = DCBTIOT + ADDR(IEFTIOT); /* ADDR OF TIOT ENTRY    */  00262000
         L     @14,DCBDEBAD-1(,RDCB)                               0149 00263000
         L     @14,DEBTCBAD(,@14)                                  0149 00264000
         LH    RTIODD,DCBTIOT(,RDCB)                               0149 00265000
         AL    RTIODD,TCBTIO(,@14)                                 0149 00266000
*        RESPECIFY TIODDENT BASED(RTIODD);                         0150 00267000
*                                                                  0150 00268000
*        WTOMSGLN = LENGTH(WTOPRFIX)    /* SET MSG LENGTH FIELD     */  00269000
*                  + LENGTH(WTOTEXT);   /*     FOR WTO SVC          */  00270000
         MVC   WTOMSGLN(2,R6),@CH01192                             0151 00271000
*        WTOMCSFL = '8000'X;            /* DENOTE ROUTE INFO PRESENT*/  00272000
*                                                                  0152 00273000
         MVC   WTOMCSFL(2,R6),@CB01169                             0152 00274000
*        WTOTEXT = IEC020I;             /* MOVE MSG INTO BUFFER     */  00275000
         MVC   WTOTEXT(44,R6),IEC020I                              0153 00276000
*        IF DCBCIND2(8) = '1'B          /* IF QSAM - RESET AM CODE  */  00277000
*          THEN WTOSAMID = '4';         /* CHANGE FROM BSAM TO QSAM */  00278000
         TM    DCBCIND2(RDCB),B'00000001'                          0154 00279000
         BNO   @RF00154                                            0154 00280000
         MVI   WTOSAMID(R6),C'4'                                   0155 00281000
*        IF CIFLAG1 = '05'X             /* IS USER TRYING TO @ZA25657*/ 00282000
*        THEN WTOSAMID = '5';           /* READ BEYOND EOD ? @ZA25657*/ 00283000
@RF00154 CLI   CIFLAG1(RCICB),X'05'                                0156 00284000
         BNE   @RF00156                                            0156 00285000
         MVI   WTOSAMID(R6),C'5'                                   0157 00286000
*        WTOJOB = TIOCNJOB;             /* INSERT JOB NAME          */  00287000
@RF00156 L     @14,DCBDEBAD-1(,RDCB)                               0158 00288000
         L     @14,DEBTCBAD(,@14)                                  0158 00289000
         L     @14,TCBTIO(,@14)                                    0158 00290000
         MVC   WTOJOB(8,R6),TIOCNJOB(@14)                          0158 00291000
*        WTOSTEP = TIOCSTP;             /* INSERT STEP NAME         */  00292000
         MVC   WTOSTEP(8,R6),TIOCSTP(@14)                          0159 00293000
*        WTODDN = TIOEDDNM;             /* INSERT DD NAME           */  00294000
*                                                                  0160 00295000
         MVC   WTODDN(8,R6),TIOEDDNM(RTIODD)                       0160 00296000
*        WTOSUFIX = WTOSUFIX && WTOSUFIX; /* CLEAR MSG TYPE FLAGS   */  00297000
         XC    WTOSUFIX(4,R6),WTOSUFIX(R6)                         0161 00298000
*        WTODESC(6) = '1'B;             /* JOB STATUS TYPE MSG      */  00299000
         OI    WTODESC(R6),B'00000100'                             0162 00300000
*        WTOROUT(11) = '1'B;            /* WRITE TO PROGRAMMER TYPE */  00301000
         OI    WTOROUT+1(R6),B'00100000'                           0163 00302000
*        R1 = R6;                       /* MSG ADDRESS FOR WTO      */  00303000
         LR    R1,R6                                               0164 00304000
*        GEN (WTO MF=(E,(1)));          /* WRITE MESSAGE            */  00305000
*                                                                  0165 00306000
         WTO MF=(E,(1))                                                 00307000
*        R0 = LENGTH(WTOMSG);           /* MSG BUFFER SIZE          */  00308000
         LA    R0,52                                               0166 00309000
*        R1 = R6;                       /* MSG BUFFER ADDRESS       */  00310000
         LR    R1,R6                                               0167 00311000
*        GEN (FREEMAIN R,LV=(0),A=(1)); /* RELEASE MSG BUFFER       */  00312000
*                                                                  0168 00313000
         FREEMAIN R,LV=(0),A=(1)                                        00314000
*        IF DCBCIND2(8) = '1'B          /* TEST FOR QSAM            */  00315000
*          THEN R1 = ADDR(QSAMNOTE);    /* YES- ADDR OF QSAM REMARK */  00316000
         TM    DCBCIND2(RDCB),B'00000001'                          0169 00317000
         BNO   @RF00169                                            0169 00318000
         LA    R1,QSAMNOTE                                         0170 00319000
*          ELSE R1 = ADDR(BSAMNOTE);    /* NO - ADDR OF BSAM REMARK */  00320000
         B     @RC00169                                            0171 00321000
@RF00169 LA    R1,BSAMNOTE                                         0171 00322000
*        GEN (WTO MF=(E,(1)));          /* WRITE SAM REMARK         */  00323000
*                                                                  0172 00324000
@RC00169 DS    0H                                                  0172 00325000
         WTO MF=(E,(1))                                                 00326000
*        R1 = 1;                        /* REG1 W/ ABEND CODE  Y02120*/ 00327000
         LA    R1,1                                                0173 00328000
*        GEN  (ABEND (1),DUMP,STEP,SYSTEM);  /* ISSUE ABEND    Y02120*/ 00329000
*                                                                  0174 00330000
         ABEND (1),DUMP,STEP,SYSTEM                                     00331000
*        GEN;                                                      0175 00332000
BSAMNOTE WTO   'IEC020I NO SYNAD EXIT SPECIFIED',                      *00333000
               ROUTCDE=(11),DESC=6,MF=L                                 00334000
QSAMNOTE WTO   'IEC020I EROPT IS ''ABE'' OR NOT SPECIFIED',            *00335000
               ROUTCDE=(11),DESC=6,MF=L                                 00336000
*        RESPECIFY IFGJCICB BASED(NOBASE);                         0176 00337000
*        RESPECIFY IFGSDCB BASED(NOBASE);                          0177 00338000
*        RESPECIFY IFGRPL BASED(NOBASE);                           0178 00339000
*        RESPECIFY DECB BASED(NOBASE);                             0179 00340000
*/*******************************************************************/  00341000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00342000
         EJECT                                                          00343000
*        /***********************************************************/  00344000
*        /* ENTRY POINT FOR SYNADAF PROCESSING                      */  00345000
*        /***********************************************************/  00346000
*                                                                  0181 00347000
*INTSYDAF: ENTRY;                                                  0181 00348000
@EP00181 DS    0H                                                  0182 00349000
*/*******************************************************************/  00350000
*/* ON ENTRY, REG 1 POINTS TO SYNADAF MESSAGE AREA, WHICH HAS BEEN  */  00351000
*/* PARTIALLY FORMATTED BY SYNADAF.                                 */  00352000
*/*      -LENGTH FIELDS HAVE BEEN INITIALIZED                       */  00353000
*/*      -STANDARD VARIABLE FIELDS HAVE HAD ASTERISKS INSERTED      */  00354000
*/*      -COMMAS HAVE BEEN INSERTED BETWEEN FIELDS                  */  00355000
*/* IMMEDIATELY BEYOND THE MESSAGE AREA ARE TWO WORDS, WHICH ARE    */  00356000
*/* REG 0 AND REG 1 AS AT ENTRY TO SYNADAF.                         */  00357000
*/*      -THE VALUE IN REG 1 IS THE DCB ADDRESS, AND CAN BE USED TO */  00358000
*/*       FIND ALL NECESSARY CONTROL BLOCKS.                        */  00359000
*/* REG 13 AT ENTRY POINTS TO A SAVE AREA WHICH CAN BE USED HERE    */  00360000
*/*                                                                 */  00361000
*/* ON EXIT, REG 0 MUST CONTAIN THE RETURN CODE WHICH SYNADAF WILL  */  00362000
*/* PASS BACK TO THE USER, AND THE MESSAGE AREA MUST HAVE BEEN      */  00363000
*/* COMPLETED.                                                      */  00364000
*/*******************************************************************/  00365000
*                                                                  0182 00366000
*        RESPECIFY SYNADMSG BASED(R1);  /* AREA PASSED BY SYNADAF   */  00367000
*        RDCB = ADDR(SYNADMSG)+SYNBLKSI;/* TEMP PTR TO SAVED R0,R1  */  00368000
         LR    RDCB,R1                                             0183 00369000
         AH    RDCB,SYNBLKSI(,R1)                                  0183 00370000
*        RESPECIFY SYNREGSV BASED(RDCB);                           0184 00371000
*        RDCB = SYNPARM1;               /* GET ADDR OF DCB          */  00372000
         L     RDCB,SYNPARM1(,RDCB)                                0185 00373000
*        RESPECIFY IFGSDCB BASED(RDCB);                            0186 00374000
*        RESPECIFY SYNREGSV BASED(NOBASE);/* NO LONGER ADDRESSABLE  */  00375000
*                                                                  0187 00376000
*        RCICB = DCBCICB;               /* ADDR OF JCICB            */  00377000
         L     RCICB,DCBCICB(,RDCB)                                0188 00378000
*        RESPECIFY IFGJCICB BASED (RCICB);                         0189 00379000
*                                                                  0189 00380000
*        RRPL = ADDR(CIRPL);            /* ADDR OF RPL              */  00381000
         LA    RRPL,CIRPL(,RCICB)                                  0190 00382000
*        RESPECIFY IFGRPL BASED (RRPL);                            0191 00383000
*                                                                  0191 00384000
*        IF DCBMACRF(2)   = '1'B | DCBMACRF(3)   = '1'B THEN/*     0192 00385000
*                                          ONLY FOR INPUT ERR  Y02144*/ 00386000
         TM    DCBMACRF(RDCB),B'01100000'                          0192 00387000
         BZ    @RF00192                                            0192 00388000
*          DO;                          /* DO WE FILL THESE    Y02144*/ 00389000
*            SYNBUFAD = RPLAREA;        /* BUFFER ADDRESS      Y02144*/ 00390000
         L     @14,RPLAREA(,RRPL)                                  0194 00391000
         ST    @14,SYNBUFAD(,R1)                                   0194 00392000
*            SYNBYTES = DCBBLKSI - CIRESID;/* NO. BYTES READ   Y02144*/ 00393000
         LH    @14,DCBBLKSI(,RDCB)                                 0195 00394000
         N     @14,@CF01196                                        0195 00395000
         SL    @14,CIRESID(,RCICB)                                 0195 00396000
         STH   @14,SYNBYTES(,R1)                                   0195 00397000
*            SYNDEVTY = 'SI';           /* DENOTE 'SYSIN'      Y02144*/ 00398000
         MVC   SYNDEVTY(2,R1),@CC01186                             0196 00399000
*          END;                         /* END OF INPUT SETUP  Y02144*/ 00400000
*        ELSE                           /* IT IS OUTPUT        Y02144*/ 00401000
*          SYNDEVTY = 'SO';             /* DENOTE 'SYSOUT'     Y02144*/ 00402000
*                                                                  0198 00403000
         B     @RC00192                                            0198 00404000
@RF00192 MVC   SYNDEVTY(2,R1),@CC01187                             0198 00405000
*        SYNBLANK = ' ';                /* CLEAR UNUSED AREA        */  00406000
@RC00192 MVI   SYNBLANK+1(R1),C' '                                 0199 00407000
         MVC   SYNBLANK+2(33,R1),SYNBLANK+1(R1)                    0199 00408000
         MVI   SYNBLANK(R1),C' '                                   0199 00409000
*        SYNJOBNM = TIOCNJOB;           /* FILL IN JOB NAME         */  00410000
         L     @14,DCBDEBAD-1(,RDCB)                               0200 00411000
         L     @14,DEBTCBAD(,@14)                                  0200 00412000
         L     @14,TCBTIO(,@14)                                    0200 00413000
         MVC   SYNJOBNM(8,R1),TIOCNJOB(@14)                        0200 00414000
*        SYNSTPNM = TIOCSTP;            /* FILL IN STEP NAME        */  00415000
         MVC   SYNSTPNM(8,R1),TIOCSTP(@14)                         0201 00416000
*        RTIODD = DCBTIOT + ADDR(IEFTIOT); /* ADD TIOT OFFSET TO    */  00417000
         AH    @14,DCBTIOT(,RDCB)                                  0202 00418000
         LR    RTIODD,@14                                          0202 00419000
*                                       /* GET TO DD ENTRY          */  00420000
*        RESPECIFY TIODDENT BASED(RTIODD);                         0203 00421000
*        SYNUNIT = 'JES';               /* UNIT = JES               */  00422000
         MVC   SYNUNIT(3,R1),@CC01189                              0204 00423000
*        SYNDDNAM = TIOEDDNM;           /* DDNAME FROM TIOT ENTRY   */  00424000
*                                                                  0205 00425000
         MVC   SYNDDNAM(8,R1),TIOEDDNM(RTIODD)                     0205 00426000
*        RWORK = CIFLAG1;               /* GET ERROR INDEX     Y02144*/ 00427000
         SLR   RWORK,RWORK                                         0206 00428000
         IC    RWORK,CIFLAG1(,RCICB)                               0206 00429000
*        SYNERDES = MESSAGE(RWORK);     /* MOVE IN ERR TEXT    Y02144*/ 00430000
         LR    @14,RWORK                                           0207 00431000
         MH    @14,@CH00060                                        0207 00432000
         LA    @11,MESSAGE-15(@14)                                 0207 00433000
         MVC   SYNERDES(15,R1),0(@11)                              0207 00434000
*        SYNOPER = OPER(RWORK);         /* MOVE IN OPERATION   Y02144*/ 00435000
*                                                                  0208 00436000
         LR    @14,RWORK                                           0208 00437000
         MH    @14,@CH00070                                        0208 00438000
         LA    @11,OPER-6(@14)                                     0208 00439000
         MVC   SYNOPER(6,R1),0(@11)                                0208 00440000
*        GEN(XC    20(4,R13),20(R13));  /* CLEAR R0 FOR RETURN CODE */  00441000
         XC    20(4,R13),20(R13)                                        00442000
*        RETURN;                        /* RETURN TO SYNADAF SVC    */  00443000
*                                                                  0210 00444000
*                                                                  0210 00445000
*                                                                  0210 00446000
@EL00001 DS    0H                                                  0210 00447000
@EF00001 DS    0H                                                  0210 00448000
@ER00001 LM    @14,@12,12(@13)                                     0210 00449000
         BR    @14                                                 0210 00450000
*        END IGG019AH                   /* END OF IGG019AH MODULE   */  00451000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 00452000
*/*%INCLUDE SYSLIB  (IFGJCICB)                                        * 00453000
*/*%INCLUDE SYSLIB  (IFGRPL  )                                        * 00454000
*/*%INCLUDE SYSLIB  (IFGSDCB )                                        * 00455000
*/*%INCLUDE SYSLIB  (IEZDEB  )                                        * 00456000
*/*%INCLUDE SYSLIB  (IKJTCB  )                                        * 00457000
*;                                                                 0211 00458000
         B     @EL00001                                            0211 00459000
@DATA    DS    0H                                                       00460000
@CH00070 DC    H'6'                                                     00461000
@CH00060 DC    H'15'                                                    00462000
@CH01192 DC    H'48'                                                    00463000
@DATD    DSECT                                                          00464000
         DS    0F                                                       00465000
@ZTEMPS  DS    C                                                        00466000
@ZTEMPND EQU   *                                                        00467000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         00468000
@TEMPS   EQU   @ZTEMPS                                                  00469000
@L       EQU   @ZLEN                                                    00470000
IGG019AH CSECT                                                          00471000
         DS    0F                                                       00472000
@CF00088 DC    F'1'                                                     00473000
@CF01196 DC    XL4'0000FFFF'                                            00474000
@DATD    DSECT                                                          00475000
         DS    0D                                                       00476000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00477000
@ENDDATD EQU   *                                                        00478000
@DATEND  EQU   *                                                        00479000
IGG019AH CSECT                                                          00480000
         DS    0F                                                       00481000
@SIZDATD DC    AL1(0)                                                   00482000
         DC    AL3(@ENDDATD-@DATD)                                      00483000
@SIZ001  EQU   @SIZDATD                                                 00484000
@CA01129 DC    A(INTSYDAF)                                              00485000
         DS    0D                                                       00486000
@CC01189 DC    C'JES'                                                   00487000
@CC01186 DC    C'SI'                                                    00488000
@CC01187 DC    C'SO'                                                    00489000
@CB01169 DC    X'8000'                                                  00490000
IEC020I  DC    CL44'IEC020I 001-1,        ,        ,        ,JES'       00491000
PATCH    DC    CL60' '                                                  00492000
SYNSTAT  DC    XL1'90'                                                  00493000
         DC    XL1'80'                                                  00494000
         DC    XL1'40'                                                  00495000
         DC    XL1'90'                                                  00496000
         DC    XL1'80'                                                  00497000
         DC    XL1'40'                                                  00498000
         DC    XL1'08'                                                  00499000
MESSAGE  DC    CL15'WRONG LEN RECRD'                                    00500000
         DC    CL15'READ ERROR'                                         00501000
         DC    CL15'WRITE ERROR'                                        00502000
         DC    CL15'WRONG LEN RECRD'                                    00503000
         DC    CL15'READ ERROR'                                         00504000
         DC    CL15'WRITE ERROR'                                        00505000
         DC    CL15'INVALID REQUEST'                                    00506000
OPER     DC    CL6'READ'                                                00507000
         DC    CL6'READ'                                                00508000
         DC    CL6'WRITE'                                               00509000
         DC    CL6'GET'                                                 00510000
         DC    CL6'GET'                                                 00511000
         DC    CL6'PUT'                                                 00512000
         DC    CL6'CHECK'                                               00513000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00514000
@01      EQU   01                                                       00515000
@02      EQU   02                                                       00516000
@03      EQU   03                                                       00517000
@04      EQU   04                                                       00518000
@05      EQU   05                                                       00519000
@06      EQU   06                                                       00520000
@07      EQU   07                                                       00521000
@08      EQU   08                                                       00522000
@09      EQU   09                                                       00523000
@10      EQU   10                                                       00524000
@11      EQU   11                                                       00525000
@12      EQU   12                                                       00526000
@13      EQU   13                                                       00527000
@14      EQU   14                                                       00528000
@15      EQU   15                                                       00529000
@0       EQU   00                                                       00530000
@1       EQU   01                                                       00531000
@2       EQU   02                                                       00532000
@3       EQU   03                                                       00533000
@4       EQU   04                                                       00534000
@5       EQU   05                                                       00535000
@6       EQU   06                                                       00536000
@7       EQU   07                                                       00537000
@8       EQU   08                                                       00538000
@9       EQU   09                                                       00539000
@A       EQU   10                                                       00540000
@B       EQU   11                                                       00541000
@C       EQU   12                                                       00542000
@D       EQU   13                                                       00543000
@E       EQU   14                                                       00544000
@F       EQU   15                                                       00545000
R0       EQU   @00                                                      00546000
R1       EQU   @01                                                      00547000
RWORK    EQU   @02                                                      00548000
RRPL     EQU   @03                                                      00549000
RCICB    EQU   @04                                                      00550000
RTIODD   EQU   @05                                                      00551000
R6       EQU   @06                                                      00552000
RDECB    EQU   @07                                                      00553000
RDCB     EQU   @08                                                      00554000
RCSAVE   EQU   @09                                                      00555000
R13      EQU   @13                                                      00556000
R15      EQU   @15                                                      00557000
R11      EQU   @11                                                      00558000
R12      EQU   @12                                                      00559000
R14      EQU   @14                                                      00560000
NOBASE   EQU   0                                                        00561000
DECB     EQU   0                                                        00562000
DECSDECB EQU   DECB                                                     00563000
DECBCODE EQU   DECSDECB                                                 00564000
DECBCOND EQU   DECSDECB+1                                               00565000
DECRESDU EQU   DECSDECB+2                                               00566000
DECIOBPT EQU   DECB+16                                                  00567000
REGSAVE  EQU   0                                                        00568000
SAVEPREV EQU   REGSAVE+4                                                00569000
SAVENEXT EQU   REGSAVE+8                                                00570000
SAVE1412 EQU   REGSAVE+12                                               00571000
SAVE141  EQU   SAVE1412                                                 00572000
SAVE1    EQU   SAVE141+12                                               00573000
SAVE28   EQU   SAVE1412+16                                              00574000
SAVE4    EQU   SAVE28+8                                                 00575000
SAVE912  EQU   SAVE1412+44                                              00576000
IFGJCICB EQU   0                                                        00577000
CIDUMIOB EQU   IFGJCICB                                                 00578000
CIIOB    EQU   CIDUMIOB+8                                               00579000
CIRESID  EQU   CIDUMIOB+20                                              00580000
CIDCBPTR EQU   CIDUMIOB+28                                              00581000
CIREGSAV EQU   IFGJCICB+116                                             00582000
CIREGBC  EQU   CIREGSAV+4                                               00583000
CIFLAGS  EQU   IFGJCICB+188                                             00584000
CIFLAG1  EQU   CIFLAGS                                                  00585000
CIFLAG2  EQU   CIFLAGS+1                                                00586000
CIFLAG3  EQU   CIFLAGS+2                                                00587000
CIRPL    EQU   IFGJCICB+192                                             00588000
CIIOCNT  EQU   IFGJCICB+308                                             00589000
CISVCLST EQU   IFGJCICB+336                                             00590000
CISYNADA EQU   CISVCLST                                                 00591000
CISYNRC  EQU   CISYNADA                                                 00592000
CIBLDL   EQU   CISVCLST+4                                               00593000
CIBSP    EQU   CISVCLST+8                                               00594000
CIFEOV   EQU   CISVCLST+12                                              00595000
CISTOW   EQU   CISVCLST+16                                              00596000
IFGRPL   EQU   0                                                        00597000
RPLCOMN  EQU   IFGRPL                                                   00598000
RPLIDWD  EQU   RPLCOMN                                                  00599000
RPLLEN   EQU   RPLIDWD+3                                                00600000
RPLECB   EQU   RPLCOMN+8                                                00601000
RPLFDBWD EQU   RPLCOMN+12                                               00602000
RPLFDBK  EQU   RPLFDBWD+1                                               00603000
RPLRTNCD EQU   RPLFDBK                                                  00604000
RPLCNDCD EQU   RPLFDBK+1                                                00605000
RPLCMPON EQU   RPLCNDCD                                                 00606000
RPLFDB2  EQU   RPLCMPON                                                 00607000
RPLERRCD EQU   RPLCNDCD+1                                               00608000
RPLFDB3  EQU   RPLERRCD                                                 00609000
RPLKEYLE EQU   RPLCOMN+16                                               00610000
RPLAREA  EQU   RPLCOMN+32                                               00611000
RPLARG   EQU   RPLCOMN+36                                               00612000
RPLOPTCD EQU   RPLCOMN+40                                               00613000
RPLOPT1  EQU   RPLOPTCD                                                 00614000
RPLECBSW EQU   RPLOPT1                                                  00615000
RPLOPT2  EQU   RPLOPTCD+1                                               00616000
RPLADR   EQU   RPLOPT2                                                  00617000
RPLOPT3  EQU   RPLOPTCD+2                                               00618000
RPLNXTRP EQU   RPLCOMN+44                                               00619000
RPLRLEN  EQU   RPLCOMN+48                                               00620000
RPLBUFL  EQU   RPLCOMN+52                                               00621000
RPLOPTC2 EQU   RPLCOMN+56                                               00622000
RPLOPT5  EQU   RPLOPTC2                                                 00623000
RPLWRTYP EQU   RPLOPT5                                                  00624000
RPLOPT6  EQU   RPLOPTC2+1                                               00625000
RPLUNTYP EQU   RPLOPT6                                                  00626000
RPLOPT7  EQU   RPLOPTC2+2                                               00627000
RPLCNOPT EQU   RPLOPT7                                                  00628000
RPLOPT8  EQU   RPLOPTC2+3                                               00629000
RPLRBAR  EQU   RPLCOMN+60                                               00630000
RPLAIXID EQU   RPLRBAR+2                                                00631000
RPLEXTDS EQU   RPLCOMN+68                                               00632000
RPLEXTD1 EQU   RPLEXTDS                                                 00633000
RPLEXTEN EQU   76                                                       00634000
RPLCICB  EQU   RPLEXTEN                                                 00635000
RPLDECB  EQU   RPLEXTEN+8                                               00636000
IFGSDCB  EQU   0                                                        00637000
DCBBUFCB EQU   IFGSDCB+20                                               00638000
DCBIOBAD EQU   IFGSDCB+28                                               00639000
@NM00014 EQU   IFGSDCB+32                                               00640000
DCBHIARC EQU   @NM00014                                                 00641000
DCBBFTEK EQU   DCBHIARC                                                 00642000
DCBDDNAM EQU   IFGSDCB+40                                               00643000
DCBTIOT  EQU   DCBDDNAM                                                 00644000
DCBMACRF EQU   DCBDDNAM+2                                               00645000
DCBDEBAD EQU   DCBDDNAM+5                                               00646000
DCBREAD  EQU   IFGSDCB+49                                               00647000
DCBWRITE EQU   DCBREAD                                                  00648000
DCBGET   EQU   DCBWRITE                                                 00649000
DCBPUT   EQU   DCBGET                                                   00650000
DCBCHECK EQU   IFGSDCB+53                                               00651000
DCBGERR  EQU   DCBCHECK                                                 00652000
DCBSYNAD EQU   IFGSDCB+57                                               00653000
DCBCIND2 EQU   IFGSDCB+61                                               00654000
DCBBLKSI EQU   IFGSDCB+62                                               00655000
DCBIOBA  EQU   IFGSDCB+68                                               00656000
DCBCICB  EQU   DCBIOBA                                                  00657000
DCBEOBAD EQU   IFGSDCB+72                                               00658000
DCBLCCW  EQU   DCBEOBAD                                                 00659000
DCBEOBR  EQU   DCBLCCW                                                  00660000
@NM00015 EQU   IFGSDCB+76                                               00661000
DCBEOBW  EQU   @NM00015                                                 00662000
DCBRECAD EQU   DCBEOBW                                                  00663000
DCBDIRCT EQU   IFGSDCB+80                                               00664000
@NM00016 EQU   IFGSDCB+84                                               00665000
DCBEROPT EQU   @NM00016                                                 00666000
DCBCNTRL EQU   @NM00016+1                                               00667000
DCBNOTE  EQU   DCBCNTRL                                                 00668000
DEBBASIC EQU   0                                                        00669000
DEBTCBAD EQU   DEBBASIC                                                 00670000
DEBDEBAD EQU   DEBBASIC+4                                               00671000
DEBIRBAD EQU   DEBBASIC+8                                               00672000
DEBOFLGS EQU   DEBIRBAD                                                 00673000
DEBOPATB EQU   DEBBASIC+12                                              00674000
DEBFLGS1 EQU   DEBBASIC+14                                              00675000
DEBUSRPG EQU   DEBBASIC+16                                              00676000
DEBRRQ   EQU   DEBBASIC+20                                              00677000
DEBECBAD EQU   DEBRRQ                                                   00678000
DEBDCBAD EQU   DEBBASIC+24                                              00679000
DEBPROTG EQU   DEBDCBAD                                                 00680000
DEBAPPAD EQU   DEBBASIC+28                                              00681000
DEBBASND EQU   DEBBASIC+32                                              00682000
DEBDASD  EQU   0                                                        00683000
DEBUCBAD EQU   DEBDASD                                                  00684000
DEBACSMD EQU   0                                                        00685000
DEBVOLSQ EQU   DEBACSMD                                                 00686000
DEBVOLBT EQU   DEBVOLSQ                                                 00687000
DEBDSNM  EQU   DEBACSMD+4                                               00688000
DEBUTSAA EQU   DEBDSNM                                                  00689000
DEBACS01 EQU   0                                                        00690000
DEBDSNAM EQU   DEBACS01                                                 00691000
DEBACS02 EQU   0                                                        00692000
DEBDBLK  EQU   DEBACS02                                                 00693000
DEBACS03 EQU   0                                                        00694000
DEBACS04 EQU   0                                                        00695000
DEBTBFRA EQU   DEBACS04                                                 00696000
DEBTCCWA EQU   DEBACS04+4                                               00697000
DEBACS05 EQU   0                                                        00698000
DEBFUCBA EQU   DEBACS05                                                 00699000
DEBLUCBA EQU   DEBACS05+4                                               00700000
DEBACS06 EQU   0                                                        00701000
DEBACS07 EQU   0                                                        00702000
DEBACS08 EQU   0                                                        00703000
DEBSUBNM EQU   0                                                        00704000
DEB      EQU   0                                                        00705000
DEBAVT   EQU   DEB                                                      00706000
DEBEOEA  EQU   DEBAVT                                                   00707000
DEBEOEAB EQU   DEBEOEA                                                  00708000
DEBSIOA  EQU   DEBAVT+4                                                 00709000
DEBSIOAB EQU   DEBSIOA                                                  00710000
DEBPCIA  EQU   DEBAVT+8                                                 00711000
DEBPCIAB EQU   DEBPCIA                                                  00712000
DEBCEA   EQU   DEBAVT+12                                                00713000
DEBCEAB  EQU   DEBCEA                                                   00714000
DEBXCEA  EQU   DEBAVT+16                                                00715000
DEBXCEAB EQU   DEBXCEA                                                  00716000
DEBPREFX EQU   DEB+20                                                   00717000
DEBXTNP  EQU   DEBPREFX+8                                               00718000
DEBXTN   EQU   0                                                        00719000
DEBXFLG1 EQU   DEBXTN+2                                                 00720000
TCBFIX   EQU   -32                                                      00721000
TCBFRS   EQU   TCBFIX                                                   00722000
TCB      EQU   0                                                        00723000
TCBPIE   EQU   TCB+4                                                    00724000
TCBPMASK EQU   TCBPIE                                                   00725000
TCBTIO   EQU   TCB+12                                                   00726000
TCBCMP   EQU   TCB+16                                                   00727000
TCBCMPF  EQU   TCBCMP                                                   00728000
TCBCPP   EQU   TCBCMPF                                                  00729000
TCBSTCC  EQU   TCBCMPF                                                  00730000
TCBCDBL  EQU   TCBCMPF                                                  00731000
TCBCWTO  EQU   TCBCMPF                                                  00732000
TCBCIND  EQU   TCBCMPF                                                  00733000
TCBCMSG  EQU   TCBCMPF                                                  00734000
TCBTRN   EQU   TCB+20                                                   00735000
TCBABF   EQU   TCBTRN                                                   00736000
TCBMSS   EQU   TCB+24                                                   00737000
TCBPKF   EQU   TCB+28                                                   00738000
TCBFLGS  EQU   TCB+29                                                   00739000
TCBFLGS1 EQU   TCBFLGS                                                  00740000
TCBFLGS2 EQU   TCBFLGS+1                                                00741000
TCBFLGS3 EQU   TCBFLGS+2                                                00742000
TCBFLGS4 EQU   TCBFLGS+3                                                00743000
TCBFLGS5 EQU   TCBFLGS+4                                                00744000
TCBABWF  EQU   TCBFLGS5                                                 00745000
TCBJPQ   EQU   TCB+44                                                   00746000
TCBPURGE EQU   TCBJPQ                                                   00747000
TCBGRS   EQU   TCB+48                                                   00748000
TCBFSA   EQU   TCB+112                                                  00749000
TCBTME   EQU   TCB+120                                                  00750000
TCBJSTCB EQU   TCB+124                                                  00751000
TCBTSFLG EQU   TCB+148                                                  00752000
TCBTSTSK EQU   TCBTSFLG                                                 00753000
TCBSTAB  EQU   TCB+160                                                  00754000
TCBNSTAE EQU   TCBSTAB                                                  00755000
TCBTCT   EQU   TCB+164                                                  00756000
TCBTCTGF EQU   TCBTCT                                                   00757000
TCBSCNDY EQU   TCB+172                                                  00758000
TCBNDSP  EQU   TCBSCNDY                                                 00759000
TCBNDSP1 EQU   TCBNDSP+1                                                00760000
TCBNDSP2 EQU   TCBNDSP+2                                                00761000
TCBNDSP3 EQU   TCBNDSP+3                                                00762000
TCBJSCB  EQU   TCB+180                                                  00763000
TCBRECDE EQU   TCBJSCB                                                  00764000
TCBEXT1  EQU   TCB+196                                                  00765000
TCBBITS  EQU   TCB+200                                                  00766000
TCBNDSP4 EQU   TCBBITS                                                  00767000
TCBNDSP5 EQU   TCBBITS+1                                                00768000
TCBFLGS6 EQU   TCBBITS+2                                                00769000
TCBFLGS7 EQU   TCBBITS+3                                                00770000
TCBDAR   EQU   TCB+204                                                  00771000
TCBDARC  EQU   TCBDAR                                                   00772000
TCBEXT2  EQU   TCB+208                                                  00773000
TCBFOE   EQU   TCB+244                                                  00774000
TCBESTAE EQU   TCB+264                                                  00775000
TCBESTRM EQU   TCBESTAE+1                                               00776000
TCBFBYT1 EQU   TCB+276                                                  00777000
TCBFBYT2 EQU   TCB+277                                                  00778000
TCBRV124 EQU   TCB+278                                                  00779000
TCBRV133 EQU   TCB+279                                                  00780000
TCBXTNT2 EQU   0                                                        00781000
TCBGTF   EQU   TCBXTNT2                                                 00782000
TCBTFLG  EQU   TCBGTF                                                   00783000
TCBRV146 EQU   TCBXTNT2+28                                              00784000
TCBRV155 EQU   TCBXTNT2+29                                              00785000
TCBRV164 EQU   TCBXTNT2+30                                              00786000
TCBRV173 EQU   TCBXTNT2+31                                              00787000
IEFTIOT  EQU   0                                                        00788000
TIOCNJOB EQU   IEFTIOT                                                  00789000
TIOCSTP  EQU   IEFTIOT+8                                                00790000
TIODDENT EQU   0                                                        00791000
TIOEDDNM EQU   TIODDENT+4                                               00792000
WTOMSG   EQU   0                                                        00793000
WTOPRFIX EQU   WTOMSG                                                   00794000
WTOMSGLN EQU   WTOPRFIX                                                 00795000
WTOMCSFL EQU   WTOPRFIX+2                                               00796000
WTOTEXT  EQU   WTOMSG+4                                                 00797000
WTOSAMID EQU   WTOTEXT+12                                               00798000
WTOJOB   EQU   WTOTEXT+14                                               00799000
WTOSTEP  EQU   WTOTEXT+23                                               00800000
WTODDN   EQU   WTOTEXT+32                                               00801000
WTOSUFIX EQU   WTOMSG+48                                                00802000
WTODESC  EQU   WTOSUFIX                                                 00803000
WTOROUT  EQU   WTOSUFIX+2                                               00804000
SYNADMSG EQU   0                                                        00805000
SYNLNWRD EQU   SYNADMSG                                                 00806000
SYNBLKSI EQU   SYNLNWRD                                                 00807000
SYNINBUF EQU   SYNADMSG+8                                               00808000
SYNBUFAD EQU   SYNINBUF                                                 00809000
SYNBYTES EQU   SYNINBUF+4                                               00810000
SYNBLANK EQU   SYNADMSG+14                                              00811000
SYNJOBNM EQU   SYNADMSG+50                                              00812000
SYNSTPNM EQU   SYNADMSG+59                                              00813000
SYNUNIT  EQU   SYNADMSG+68                                              00814000
SYNDEVTY EQU   SYNADMSG+72                                              00815000
SYNDDNAM EQU   SYNADMSG+75                                              00816000
SYNOPER  EQU   SYNADMSG+84                                              00817000
SYNERDES EQU   SYNADMSG+91                                              00818000
SYNREGSV EQU   0                                                        00819000
SYNPARM1 EQU   SYNREGSV+4                                               00820000
SAVE410  EQU   SAVE4                                                    00821000
DEBBAS02 EQU   DEBBASND                                                 00822000
DEBDDS1  EQU   DEBBAS02                                                 00823000
DEBSUCBA EQU   DEBDDS1                                                  00824000
DEBDEVED EQU   DEBDDS1+4                                                00825000
DEBRDCB  EQU   DEBDDS1+4                                                00826000
DEBPDCB  EQU   DEBDDS1+8                                                00827000
DEBWDCB  EQU   DEBDDS1+12                                               00828000
DEBACS09 EQU   DEBDEVED                                                 00829000
DEBASC09 EQU   DEBACS09                                                 00830000
DEBEAMFG EQU   DEBASC09+3                                               00831000
DEBDSID  EQU   DEBASC09+4                                               00832000
DEBEOD   EQU   DEBASC09+12                                              00833000
DEBBOE   EQU   DEBEOD                                                   00834000
DEBEODRV EQU   DEBBOE                                                   00835000
DEBEODTT EQU   DEBBOE+1                                                 00836000
DEBEOD0  EQU   DEBBOE+2                                                 00837000
DEBEODSS EQU   DEBBOE+3                                                 00838000
DEBBAS01 EQU   DEBBASND                                                 00839000
DEBISAM  EQU   DEBBAS01                                                 00840000
DEBFIEAD EQU   DEBISAM                                                  00841000
DEBFPEAD EQU   DEBISAM+4                                                00842000
DEBFOEAD EQU   DEBISAM+8                                                00843000
DEBEXPT  EQU   DEBISAM+12                                               00844000
DEBRPSID EQU   DEBEXPT                                                  00845000
*                                      START UNREFERENCED COMPONENTS    00846000
DEBEXPTA EQU   DEBEXPT+1                                                00847000
DEBRSV12 EQU   DEBRPSID                                                 00848000
DEBRSV11 EQU   DEBRPSID                                                 00849000
DEBRSV10 EQU   DEBRPSID                                                 00850000
DEBRSV09 EQU   DEBRPSID                                                 00851000
DEBRPSAP EQU   DEBRPSID                                                 00852000
DEBRPSO  EQU   DEBRPSID                                                 00853000
DEBRPSI  EQU   DEBRPSID                                                 00854000
DEBRPSP  EQU   DEBRPSID                                                 00855000
DEBFOEB  EQU   DEBFOEAD+1                                               00856000
DEBNOEE  EQU   DEBFOEAD                                                 00857000
DEBFPEB  EQU   DEBFPEAD+1                                               00858000
DEBNPEE  EQU   DEBFPEAD                                                 00859000
DEBFIEB  EQU   DEBFIEAD+1                                               00860000
DEBNIEE  EQU   DEBFIEAD                                                 00861000
DEBBOESS EQU   DEBEODSS                                                 00862000
DEBBOE0  EQU   DEBEOD0                                                  00863000
DEBBOETT EQU   DEBEODTT                                                 00864000
DEBBOERV EQU   DEBEODRV                                                 00865000
DEBRV008 EQU   DEBDSID+7                                                00866000
DEBWTPTI EQU   DEBDSID+6                                                00867000
DEBEXDTE EQU   DEBDSID                                                  00868000
DEBRV007 EQU   DEBEAMFG                                                 00869000
DEBRV006 EQU   DEBEAMFG                                                 00870000
DEBRV005 EQU   DEBEAMFG                                                 00871000
DEBRV004 EQU   DEBEAMFG                                                 00872000
DEBSECVL EQU   DEBEAMFG                                                 00873000
DEBVAMSG EQU   DEBEAMFG                                                 00874000
DEBDSOPN EQU   DEBEAMFG                                                 00875000
DEBMULTI EQU   DEBEAMFG                                                 00876000
DEBVSEQU EQU   DEBASC09+2                                               00877000
DEBDSSQL EQU   DEBASC09+1                                               00878000
DEBVOLAC EQU   DEBASC09                                                 00879000
DEBWDCBA EQU   DEBWDCB+1                                                00880000
DEBRSV08 EQU   DEBWDCB                                                  00881000
DEBPDCBA EQU   DEBPDCB+1                                                00882000
DEBRSV07 EQU   DEBPDCB                                                  00883000
DEBRDCBA EQU   DEBRDCB+1                                                00884000
DEBRSV06 EQU   DEBRDCB                                                  00885000
DEBSUCBB EQU   DEBSUCBA+1                                               00886000
DEBSDVM  EQU   DEBSUCBA                                                 00887000
SYNPARM2 EQU   SYNREGSV                                                 00888000
@NM00039 EQU   SYNADMSG+90                                              00889000
@NM00038 EQU   SYNADMSG+83                                              00890000
@NM00037 EQU   SYNADMSG+74                                              00891000
@NM00036 EQU   SYNADMSG+71                                              00892000
@NM00035 EQU   SYNADMSG+67                                              00893000
@NM00034 EQU   SYNADMSG+58                                              00894000
@NM00033 EQU   SYNADMSG+49                                              00895000
@NM00032 EQU   SYNLNWRD+6                                               00896000
SYNLRECL EQU   SYNLNWRD+4                                               00897000
@NM00031 EQU   SYNLNWRD+2                                               00898000
@NM00030 EQU   WTOTEXT+40                                               00899000
@NM00029 EQU   WTOTEXT+31                                               00900000
@NM00028 EQU   WTOTEXT+22                                               00901000
@NM00027 EQU   WTOTEXT+13                                               00902000
@NM00026 EQU   WTOTEXT                                                  00903000
TIOERLOC EQU   TIODDENT+2                                               00904000
TIOESTTA EQU   TIODDENT+1                                               00905000
TIOELNGT EQU   TIODDENT                                                 00906000
@NM00025 EQU   TCBXTNT2+32                                              00907000
TCBRV181 EQU   TCBRV173                                                 00908000
TCBRV180 EQU   TCBRV173                                                 00909000
TCBRV179 EQU   TCBRV173                                                 00910000
TCBRV178 EQU   TCBRV173                                                 00911000
TCBRV177 EQU   TCBRV173                                                 00912000
TCBRV176 EQU   TCBRV173                                                 00913000
TCBRV175 EQU   TCBRV173                                                 00914000
TCBRV174 EQU   TCBRV173                                                 00915000
TCBRV172 EQU   TCBRV164                                                 00916000
TCBRV171 EQU   TCBRV164                                                 00917000
TCBRV170 EQU   TCBRV164                                                 00918000
TCBRV169 EQU   TCBRV164                                                 00919000
TCBRV168 EQU   TCBRV164                                                 00920000
TCBRV167 EQU   TCBRV164                                                 00921000
TCBRV166 EQU   TCBRV164                                                 00922000
TCBRV165 EQU   TCBRV164                                                 00923000
TCBRV163 EQU   TCBRV155                                                 00924000
TCBRV162 EQU   TCBRV155                                                 00925000
TCBRV161 EQU   TCBRV155                                                 00926000
TCBRV160 EQU   TCBRV155                                                 00927000
TCBRV159 EQU   TCBRV155                                                 00928000
TCBRV158 EQU   TCBRV155                                                 00929000
TCBRV157 EQU   TCBRV155                                                 00930000
TCBRV156 EQU   TCBRV155                                                 00931000
TCBRV154 EQU   TCBRV146                                                 00932000
TCBRV153 EQU   TCBRV146                                                 00933000
TCBRV152 EQU   TCBRV146                                                 00934000
TCBRV151 EQU   TCBRV146                                                 00935000
TCBRV150 EQU   TCBRV146                                                 00936000
TCBRV149 EQU   TCBRV146                                                 00937000
TCBRV148 EQU   TCBRV146                                                 00938000
TCBRV147 EQU   TCBRV146                                                 00939000
TCBRV145 EQU   TCBXTNT2+26                                              00940000
TCBRV144 EQU   TCBXTNT2+24                                              00941000
TCBRV143 EQU   TCBXTNT2+20                                              00942000
TCBRV142 EQU   TCBXTNT2+16                                              00943000
TCBRSV49 EQU   TCBXTNT2+12                                              00944000
TCBEVENT EQU   TCBXTNT2+8                                               00945000
TCBRCMP  EQU   TCBXTNT2+5                                               00946000
TCBRSVAB EQU   TCBXTNT2+4                                               00947000
TCBGTFA  EQU   TCBGTF+1                                                 00948000
TCBRSV47 EQU   TCBTFLG                                                  00949000
TCBRSV46 EQU   TCBTFLG                                                  00950000
TCBRSV45 EQU   TCBTFLG                                                  00951000
TCBRSV44 EQU   TCBTFLG                                                  00952000
TCBRSV43 EQU   TCBTFLG                                                  00953000
TCBDSPIT EQU   TCBTFLG                                                  00954000
TCBERRTN EQU   TCBTFLG                                                  00955000
TCBASYNC EQU   TCBTFLG                                                  00956000
@NM00024 EQU   TCB+296                                                  00957000
TCBSVCA2 EQU   TCB+292                                                  00958000
TCBSWASA EQU   TCB+288                                                  00959000
TCBDBTB  EQU   TCB+284                                                  00960000
TCBRPT   EQU   TCB+280                                                  00961000
TCBRV141 EQU   TCBRV133                                                 00962000
TCBRV140 EQU   TCBRV133                                                 00963000
TCBRV139 EQU   TCBRV133                                                 00964000
TCBRV138 EQU   TCBRV133                                                 00965000
TCBRV137 EQU   TCBRV133                                                 00966000
TCBRV136 EQU   TCBRV133                                                 00967000
TCBRV135 EQU   TCBRV133                                                 00968000
TCBRV134 EQU   TCBRV133                                                 00969000
TCBRV132 EQU   TCBRV124                                                 00970000
TCBRV131 EQU   TCBRV124                                                 00971000
TCBRV130 EQU   TCBRV124                                                 00972000
TCBRV129 EQU   TCBRV124                                                 00973000
TCBRV128 EQU   TCBRV124                                                 00974000
TCBRV127 EQU   TCBRV124                                                 00975000
TCBRV126 EQU   TCBRV124                                                 00976000
TCBRV125 EQU   TCBRV124                                                 00977000
TCBRV123 EQU   TCBFBYT2                                                 00978000
TCBRV122 EQU   TCBFBYT2                                                 00979000
TCBECBNV EQU   TCBFBYT2                                                 00980000
TCBSSSYN EQU   TCBFBYT2                                                 00981000
TCBFPRAP EQU   TCBFBYT2                                                 00982000
TCBFDW   EQU   TCBFBYT2                                                 00983000
TCBFMW   EQU   TCBFBYT2                                                 00984000
TCBCNCB  EQU   TCBFBYT2                                                 00985000
TCBLLH   EQU   TCBFBYT1                                                 00986000
TCBRV113 EQU   TCBFBYT1                                                 00987000
TCBEOT   EQU   TCBFBYT1                                                 00988000
TCBRTM2  EQU   TCBFBYT1                                                 00989000
TCBPGNLY EQU   TCBFBYT1                                                 00990000
TCBNDIOS EQU   TCBFBYT1                                                 00991000
TCBACTIV EQU   TCBFBYT1                                                 00992000
TCBEOTFM EQU   TCBFBYT1                                                 00993000
TCBAFFN  EQU   TCB+274                                                  00994000
TCBCCPVI EQU   TCB+272                                                  00995000
TCBUKYSP EQU   TCB+268                                                  00996000
TCBMODE  EQU   TCBESTAE+3                                               00997000
TCBERTYP EQU   TCBESTAE+2                                               00998000
TCBRV314 EQU   TCBESTRM                                                 00999000
TCBRV313 EQU   TCBESTRM                                                 01000000
TCBRV312 EQU   TCBESTRM                                                 01001000
TCBRV311 EQU   TCBESTRM                                                 01002000
TCBRV310 EQU   TCBESTRM                                                 01003000
TCBRV309 EQU   TCBESTRM                                                 01004000
TCBRV308 EQU   TCBESTRM                                                 01005000
TCBETERM EQU   TCBESTRM                                                 01006000
TCBSCBKY EQU   TCBESTAE                                                 01007000
TCBRTM12 EQU   TCB+260                                                  01008000
TCBTCBID EQU   TCB+256                                                  01009000
TCBRSV96 EQU   TCB+252                                                  01010000
TCBSWA   EQU   TCB+248                                                  01011000
TCBFOEA  EQU   TCBFOE+1                                                 01012000
TCBRSV42 EQU   TCBFOE                                                   01013000
TCBRV306 EQU   TCB+240                                                  01014000
TCBRSV41 EQU   TCB+239                                                  01015000
TCBTID   EQU   TCB+238                                                  01016000
TCBRSVAA EQU   TCB+237                                                  01017000
TCBABCUR EQU   TCB+236                                                  01018000
TCBTMSAV EQU   TCB+232                                                  01019000
TCBIOTIM EQU   TCB+228                                                  01020000
TCBRTWA  EQU   TCB+224                                                  01021000
TCBBACK  EQU   TCB+220                                                  01022000
TCBTIRB  EQU   TCB+216                                                  01023000
TCBAECB  EQU   TCB+212                                                  01024000
TCBEXT2A EQU   TCBEXT2+1                                                01025000
TCBRSV39 EQU   TCBEXT2                                                  01026000
TCBSTMCT EQU   TCB+207                                                  01027000
TCBSYSCT EQU   TCB+206                                                  01028000
TCBRSV37 EQU   TCB+205                                                  01029000
TCBEXSVC EQU   TCBDAR                                                   01030000
TCBDARMS EQU   TCBDAR                                                   01031000
TCBDARWT EQU   TCBDAR                                                   01032000
TCBDARO  EQU   TCBDAR                                                   01033000
TCBDARMC EQU   TCBDARC                                                  01034000
TCBDARD  EQU   TCBDAR                                                   01035000
TCBDARS  EQU   TCBDAR                                                   01036000
TCBDARP  EQU   TCBDAR                                                   01037000
TCBGTOFM EQU   TCBFLGS7                                                 01038000
TCBADMP  EQU   TCBFLGS7                                                 01039000
TCBRSTSK EQU   TCBFLGS7                                                 01040000
TCBSVCS  EQU   TCBFLGS7                                                 01041000
TCBSTACK EQU   TCBFLGS7                                                 01042000
TCBRSV34 EQU   TCBFLGS7                                                 01043000
TCBRSV33 EQU   TCBFLGS7                                                 01044000
TCBGPECB EQU   TCBFLGS7                                                 01045000
TCBNTJS  EQU   TCBFLGS6                                                 01046000
TCBAPG   EQU   TCBFLGS6                                                 01047000
TCBMIGR  EQU   TCBFLGS6                                                 01048000
TCBRV303 EQU   TCBFLGS6                                                 01049000
TCBSPVLK EQU   TCBFLGS6                                                 01050000
TCBCPU   EQU   TCBFLGS6                                                 01051000
TCBPIE17 EQU   TCBFLGS6                                                 01052000
TCBRV    EQU   TCBFLGS6                                                 01053000
TCBRSV79 EQU   TCBNDSP5                                                 01054000
TCBRSV78 EQU   TCBNDSP5                                                 01055000
TCBRSV77 EQU   TCBNDSP5                                                 01056000
TCBRSV76 EQU   TCBNDSP5                                                 01057000
TCBRSV75 EQU   TCBNDSP5                                                 01058000
TCBRSV74 EQU   TCBNDSP5                                                 01059000
TCBRSV95 EQU   TCBNDSP5                                                 01060000
TCBRSV94 EQU   TCBNDSP5                                                 01061000
TCBRSV93 EQU   TCBNDSP4                                                 01062000
TCBRSV92 EQU   TCBNDSP4                                                 01063000
TCBRSV91 EQU   TCBNDSP4                                                 01064000
TCBRSV90 EQU   TCBNDSP4                                                 01065000
TCBRSV89 EQU   TCBNDSP4                                                 01066000
TCBRSV88 EQU   TCBNDSP4                                                 01067000
TCBRSV87 EQU   TCBNDSP4                                                 01068000
TCBRSV86 EQU   TCBNDSP4                                                 01069000
TCBEXT1A EQU   TCBEXT1+1                                                01070000
TCBRSV32 EQU   TCBEXT1                                                  01071000
TCBEXCPD EQU   TCB+192                                                  01072000
TCBIOBRC EQU   TCB+188                                                  01073000
TCBDDWTC EQU   TCB+186                                                  01074000
TCBDDEXC EQU   TCB+184                                                  01075000
TCBJSCBB EQU   TCBJSCB+1                                                01076000
@NM00023 EQU   TCBRECDE                                                 01077000
TCBREC   EQU   TCBRECDE                                                 01078000
TCBMDIDS EQU   TCB+176                                                  01079000
TCBNDINT EQU   TCBNDSP3                                                 01080000
TCBRSV27 EQU   TCBNDSP3                                                 01081000
TCBRSV26 EQU   TCBNDSP3                                                 01082000
TCBRSV25 EQU   TCBNDSP3                                                 01083000
TCBRSV24 EQU   TCBNDSP3                                                 01084000
TCBSRBND EQU   TCBNDSP3                                                 01085000
TCBRV302 EQU   TCBNDSP3                                                 01086000
TCBLJSND EQU   TCBNDSP3                                                 01087000
TCBABE   EQU   TCBNDSP2                                                 01088000
TCBDSS   EQU   TCBNDSP2                                                 01089000
TCBOWAIT EQU   TCBNDSP2                                                 01090000
TCBIWAIT EQU   TCBNDSP2                                                 01091000
TCBNDTS  EQU   TCBNDSP2                                                 01092000
TCBNDSVC EQU   TCBNDSP2                                                 01093000
TCBSTPP  EQU   TCBNDSP2                                                 01094000
TCBABD   EQU   TCBNDSP2                                                 01095000
TCBRSV22 EQU   TCBNDSP1                                                 01096000
TCBPIEND EQU   TCBNDSP1                                                 01097000
TCBTPSP  EQU   TCBNDSP1                                                 01098000
TCBDDRND EQU   TCBNDSP1                                                 01099000
TCBRSPND EQU   TCBNDSP1                                                 01100000
TCBRSTND EQU   TCBNDSP1                                                 01101000
TCBDARPN EQU   TCBNDSP1                                                 01102000
TCBDARTN EQU   TCBNDSP1                                                 01103000
TCBNDSP0 EQU   TCBNDSP                                                  01104000
TCBUSER  EQU   TCB+168                                                  01105000
TCBTCTB  EQU   TCBTCT+1                                                 01106000
TCBRSV9C EQU   TCBTCTGF                                                 01107000
TCBRSV9B EQU   TCBTCTGF                                                 01108000
TCBRSV9A EQU   TCBTCTGF                                                 01109000
TCBRSV99 EQU   TCBTCTGF                                                 01110000
TCBRSV98 EQU   TCBTCTGF                                                 01111000
TCBRSV97 EQU   TCBTCTGF                                                 01112000
TCBRSV20 EQU   TCBTCTGF                                                 01113000
TCBSMFGF EQU   TCBTCTGF                                                 01114000
TCBSTABB EQU   TCBSTAB+1                                                01115000
TCBSTCUR EQU   TCBNSTAE                                                 01116000
TCBRV301 EQU   TCBNSTAE                                                 01117000
TCBSYNCH EQU   TCBNSTAE                                                 01118000
TCBHALT  EQU   TCBNSTAE                                                 01119000
TCBPPSUP EQU   TCBNSTAE                                                 01120000
TCB33E   EQU   TCBNSTAE                                                 01121000
TCBQUIES EQU   TCBNSTAE                                                 01122000
TCBSTABE EQU   TCBNSTAE                                                 01123000
TCBAQE   EQU   TCB+156                                                  01124000
TCBPQE   EQU   TCB+152                                                  01125000
TCBTSDP  EQU   TCB+151                                                  01126000
TCBTSLP  EQU   TCB+150                                                  01127000
TCBSTPCT EQU   TCB+149                                                  01128000
TCBCPUBN EQU   TCBTSFLG                                                 01129000
TCBDYDSP EQU   TCBTSFLG                                                 01130000
TCBRSV18 EQU   TCBTSFLG                                                 01131000
TCBRSV17 EQU   TCBTSFLG                                                 01132000
TCBTIOTG EQU   TCBTSFLG                                                 01133000
TCBATT   EQU   TCBTSFLG                                                 01134000
TCBSTPPR EQU   TCBTSFLG                                                 01135000
TCBRV300 EQU   TCBTSTSK                                                 01136000
TCBECB   EQU   TCB+144                                                  01137000
TCBIQE   EQU   TCB+140                                                  01138000
TCBLTC   EQU   TCB+136                                                  01139000
TCBOTC   EQU   TCB+132                                                  01140000
TCBNTC   EQU   TCB+128                                                  01141000
TCBJSTCA EQU   TCBJSTCB+1                                               01142000
TCBRSV16 EQU   TCBJSTCB                                                 01143000
TCBTQET  EQU   TCBTME                                                   01144000
TCBTCB   EQU   TCB+116                                                  01145000
TCBFSAB  EQU   TCBFSA+1                                                 01146000
TCBQEL   EQU   TCBFSA                                                   01147000
TCBGRS15 EQU   TCBGRS+60                                                01148000
TCBGRS14 EQU   TCBGRS+56                                                01149000
TCBGRS13 EQU   TCBGRS+52                                                01150000
TCBGRS12 EQU   TCBGRS+48                                                01151000
TCBGRS11 EQU   TCBGRS+44                                                01152000
TCBGRS10 EQU   TCBGRS+40                                                01153000
TCBGRS9  EQU   TCBGRS+36                                                01154000
TCBGRS8  EQU   TCBGRS+32                                                01155000
TCBGRS7  EQU   TCBGRS+28                                                01156000
TCBGRS6  EQU   TCBGRS+24                                                01157000
TCBGRS5  EQU   TCBGRS+20                                                01158000
TCBGRS4  EQU   TCBGRS+16                                                01159000
TCBGRS3  EQU   TCBGRS+12                                                01160000
TCBGRS2  EQU   TCBGRS+8                                                 01161000
TCBGRS1  EQU   TCBGRS+4                                                 01162000
TCBGRS0  EQU   TCBGRS                                                   01163000
TCBJPQB  EQU   TCBJPQ+1                                                 01164000
TCBRSV15 EQU   TCBPURGE                                                 01165000
TCBRSV14 EQU   TCBPURGE                                                 01166000
TCBRSV13 EQU   TCBPURGE                                                 01167000
TCBRSV12 EQU   TCBPURGE                                                 01168000
TCBRSV11 EQU   TCBPURGE                                                 01169000
TCBRSV10 EQU   TCBPURGE                                                 01170000
TCBRSV09 EQU   TCBPURGE                                                 01171000
TCBJPQF  EQU   TCBPURGE                                                 01172000
TCBJLB   EQU   TCB+40                                                   01173000
TCBLLS   EQU   TCB+36                                                   01174000
TCBDSP   EQU   TCB+35                                                   01175000
TCBLMP   EQU   TCB+34                                                   01176000
TCBPNDSP EQU   TCBFLGS5                                                 01177000
TCBFCD1  EQU   TCBFLGS5                                                 01178000
TCBSTP   EQU   TCBFLGS5                                                 01179000
TCBSYS   EQU   TCBFLGS5                                                 01180000
TCBANDSP EQU   TCBFLGS5                                                 01181000
TCBPAGE  EQU   TCBFLGS5                                                 01182000
TCBUXNDF EQU   TCBABWF                                                  01183000
TCBFC    EQU   TCBFLGS5                                                 01184000
TCBONDSP EQU   TCBFLGS4                                                 01185000
TCBMPCND EQU   TCBFLGS4                                                 01186000
TCBMPCVQ EQU   TCBFLGS4                                                 01187000
TCBUXNDV EQU   TCBFLGS4                                                 01188000
TCBHNDSP EQU   TCBFLGS4                                                 01189000
TCBRQENA EQU   TCBFLGS4                                                 01190000
TCBSER   EQU   TCBFLGS4                                                 01191000
TCBNDUMP EQU   TCBFLGS4                                                 01192000
TCBDWSTA EQU   TCBFLGS3                                                 01193000
TCBRSV08 EQU   TCBFLGS3                                                 01194000
TCBRSV07 EQU   TCBFLGS3                                                 01195000
TCBRSV06 EQU   TCBFLGS3                                                 01196000
TCBABGM  EQU   TCBFLGS3                                                 01197000
TCBABTRM EQU   TCBFLGS3                                                 01198000
TCBADINP EQU   TCBFLGS3                                                 01199000
TCBFSM   EQU   TCBFLGS3                                                 01200000
TCBFTS   EQU   TCBFLGS2                                                 01201000
TCBFETXR EQU   TCBFLGS2                                                 01202000
TCBFDSOP EQU   TCBFLGS2                                                 01203000
TCBFJMC  EQU   TCBFLGS2                                                 01204000
TCBFSMC  EQU   TCBFLGS2                                                 01205000
TCBFABOP EQU   TCBFLGS2                                                 01206000
TCBFSTI  EQU   TCBFLGS2                                                 01207000
TCBFOINP EQU   TCBFLGS2                                                 01208000
TCBFX    EQU   TCBFLGS1                                                 01209000
TCBFS    EQU   TCBFLGS1                                                 01210000
TCBFT    EQU   TCBFLGS1                                                 01211000
TCBPDUMP EQU   TCBFLGS1                                                 01212000
TCBNONPR EQU   TCBFLGS1                                                 01213000
TCBFERA  EQU   TCBFLGS1                                                 01214000
TCBFE    EQU   TCBFLGS1                                                 01215000
TCBFA    EQU   TCBFLGS1                                                 01216000
TCBZERO  EQU   TCBPKF                                                   01217000
TCBFLAG  EQU   TCBPKF                                                   01218000
TCBMSSB  EQU   TCBMSS+1                                                 01219000
TCBRSV03 EQU   TCBMSS                                                   01220000
TCBTRNB  EQU   TCBTRN+1                                                 01221000
TCBRSV02 EQU   TCBABF                                                   01222000
TCBOLTEP EQU   TCBABF                                                   01223000
TCBTCP   EQU   TCBABF                                                   01224000
TCBTCPP  EQU   TCBABF                                                   01225000
TCBRSV01 EQU   TCBABF                                                   01226000
TCBGRPH  EQU   TCBABF                                                   01227000
TCBNOCHK EQU   TCBABF                                                   01228000
TCBMOD91 EQU   TCBABF                                                   01229000
TCBCMPC  EQU   TCBCMP+1                                                 01230000
TCBRV318 EQU   TCBCMSG                                                  01231000
TCBRV317 EQU   TCBCIND                                                  01232000
TCBRV316 EQU   TCBCWTO                                                  01233000
TCBCASID EQU   TCBCDBL                                                  01234000
TCBNOCC  EQU   TCBSTCC                                                  01235000
TCBDMPO  EQU   TCBCPP                                                   01236000
TCBCSTEP EQU   TCBCMPF                                                  01237000
TCBCREQ  EQU   TCBCMPF                                                  01238000
TCBDEB   EQU   TCB+8                                                    01239000
TCBPIEA  EQU   TCBPIE+1                                                 01240000
TCBPM    EQU   TCBPMASK                                                 01241000
@NM00022 EQU   TCBPMASK                                                 01242000
TCBRBP   EQU   TCB                                                      01243000
TCBFRS6  EQU   TCBFRS+24                                                01244000
TCBFRS4  EQU   TCBFRS+16                                                01245000
TCBFRS2  EQU   TCBFRS+8                                                 01246000
TCBFRS0  EQU   TCBFRS                                                   01247000
DEBXSAMB EQU   DEBXTN+28                                                01248000
DEBXOPNJ EQU   DEBXTN+24                                                01249000
DEBXXARG EQU   DEBXTN+20                                                01250000
DEBXMCF2 EQU   DEBXTN+19                                                01251000
DEBXMCF1 EQU   DEBXTN+18                                                01252000
DEBXDSO2 EQU   DEBXTN+17                                                01253000
DEBXDSO1 EQU   DEBXTN+16                                                01254000
DEBXDBPR EQU   DEBXTN+12                                                01255000
DEBXDCBM EQU   DEBXTN+8                                                 01256000
DEBXDSAB EQU   DEBXTN+4                                                 01257000
DEBXRV48 EQU   DEBXTN+3                                                 01258000
DEBXRV47 EQU   DEBXFLG1                                                 01259000
DEBXRV46 EQU   DEBXFLG1                                                 01260000
DEBXRV45 EQU   DEBXFLG1                                                 01261000
DEBXRV44 EQU   DEBXFLG1                                                 01262000
DEBXRV43 EQU   DEBXFLG1                                                 01263000
DEBXDSSI EQU   DEBXFLG1                                                 01264000
DEBXTSKC EQU   DEBXFLG1                                                 01265000
DEBXCDCB EQU   DEBXFLG1                                                 01266000
DEBXLNGH EQU   DEBXTN                                                   01267000
DEBTBLOF EQU   DEBPREFX+14                                              01268000
DEBAMTYP EQU   DEBPREFX+13                                              01269000
DEBLNGTH EQU   DEBPREFX+12                                              01270000
DEBDCBMK EQU   DEBXTNP                                                  01271000
DEBDSCBA EQU   DEBPREFX+1                                               01272000
DEBWKARA EQU   DEBPREFX                                                 01273000
DEBXCEAD EQU   DEBXCEA+1                                                01274000
DEBXCENP EQU   DEBXCEAB                                                 01275000
DEBRSV35 EQU   DEBXCEAB                                                 01276000
DEBRSV34 EQU   DEBXCEAB                                                 01277000
DEBRSV33 EQU   DEBXCEAB                                                 01278000
DEBRSV32 EQU   DEBXCEAB                                                 01279000
DEBCEAD  EQU   DEBCEA+1                                                 01280000
DEBCENP  EQU   DEBCEAB                                                  01281000
DEBRSV31 EQU   DEBCEAB                                                  01282000
DEBRSV30 EQU   DEBCEAB                                                  01283000
DEBRSV29 EQU   DEBCEAB                                                  01284000
DEBRSV28 EQU   DEBCEAB                                                  01285000
DEBPCIAD EQU   DEBPCIA+1                                                01286000
DEBPCINP EQU   DEBPCIAB                                                 01287000
DEBRSV27 EQU   DEBPCIAB                                                 01288000
DEBRSV26 EQU   DEBPCIAB                                                 01289000
DEBRSV25 EQU   DEBPCIAB                                                 01290000
DEBRSV24 EQU   DEBPCIAB                                                 01291000
DEBSIOAD EQU   DEBSIOA+1                                                01292000
DEBSIONP EQU   DEBSIOAB                                                 01293000
DEBFIX   EQU   DEBSIOAB                                                 01294000
DEBIOVR  EQU   DEBSIOAB                                                 01295000
DEBSIOX  EQU   DEBSIOAB                                                 01296000
DEBPGFX  EQU   DEBSIOAB                                                 01297000
DEBEOEAD EQU   DEBEOEA+1                                                01298000
DEBEOENP EQU   DEBEOEAB                                                 01299000
DEBRSV22 EQU   DEBEOEAB                                                 01300000
DEBRSV21 EQU   DEBEOEAB                                                 01301000
DEBRSV20 EQU   DEBEOEAB                                                 01302000
DEBESMVR EQU   DEBEOEAB                                                 01303000
DEBSUBID EQU   DEBSUBNM                                                 01304000
DEBSIOA2 EQU   DEBACS08+24                                              01305000
DEBRPSIO EQU   DEBACS08+20                                              01306000
DEBFREED EQU   DEBACS08+16                                              01307000
@NM00021 EQU   DEBACS08+12                                              01308000
@NM00020 EQU   DEBACS08+8                                               01309000
DEBDISAD EQU   DEBACS08+4                                               01310000
@NM00019 EQU   DEBACS08                                                 01311000
DEBRPSST EQU   DEBACS07+64                                              01312000
DEBARECK EQU   DEBACS07+60                                              01313000
DEBAREWT EQU   DEBACS07+56                                              01314000
DEBACHK  EQU   DEBACS07+52                                              01315000
DEBAWRIT EQU   DEBACS07+48                                              01316000
DEBASETL EQU   DEBACS07+44                                              01317000
DEBAREAD EQU   DEBACS07+40                                              01318000
DEBCRECK EQU   DEBACS07+36                                              01319000
DEBCREWT EQU   DEBACS07+32                                              01320000
DEBCCHK  EQU   DEBACS07+28                                              01321000
DEBCWRIT EQU   DEBACS07+24                                              01322000
DEBCSETL EQU   DEBACS07+20                                              01323000
DEBCREAD EQU   DEBACS07+16                                              01324000
DEBWKPT5 EQU   DEBACS07+12                                              01325000
DEBWKPT4 EQU   DEBACS07+8                                               01326000
DEBGET   EQU   DEBACS07+4                                               01327000
@NM00018 EQU   DEBACS07                                                 01328000
DEBPUT   EQU   DEBACS06+4                                               01329000
DEBDCBFA EQU   DEBACS06                                                 01330000
DEBLUCBB EQU   DEBLUCBA+1                                               01331000
DEBRSV18 EQU   DEBLUCBA                                                 01332000
DEBFUCBB EQU   DEBFUCBA+1                                               01333000
DEBRSV17 EQU   DEBFUCBA                                                 01334000
DEBTCCWB EQU   DEBTCCWA+1                                               01335000
DEBRSV16 EQU   DEBTCCWA                                                 01336000
DEBTBFRB EQU   DEBTBFRA+1                                               01337000
DEBRSV15 EQU   DEBTBFRA                                                 01338000
DEBDBPEF EQU   DEBACS03+8                                               01339000
DEBDBPP  EQU   DEBACS03+4                                               01340000
DEBDTPP  EQU   DEBACS03                                                 01341000
DEBDBPE  EQU   DEBDBLK+1                                                01342000
DEBDBPT  EQU   DEBDBLK                                                  01343000
DEBEXTNM EQU   DEBDSNAM                                                 01344000
DEBLRECL EQU   DEBACSMD+14                                              01345000
DEBBLKSI EQU   DEBACSMD+12                                              01346000
DEBRSV14 EQU   DEBDSNM+4                                                01347000
DEBUTSAB EQU   DEBUTSAA+1                                               01348000
DEBRSV13 EQU   DEBUTSAA                                                 01349000
DEBVOLNM EQU   DEBACSMD+2                                               01350000
DEBVLSEQ EQU   DEBVOLSQ+1                                               01351000
DEBRSV42 EQU   DEBVOLBT                                                 01352000
DEBRSV41 EQU   DEBVOLBT                                                 01353000
DEBRSV40 EQU   DEBVOLBT                                                 01354000
DEBRSV39 EQU   DEBVOLBT                                                 01355000
DEBRSV38 EQU   DEBVOLBT                                                 01356000
DEBRSV37 EQU   DEBVOLBT                                                 01357000
DEBRSV36 EQU   DEBVOLBT                                                 01358000
DEBEXFUL EQU   DEBVOLBT                                                 01359000
DEBNMTRK EQU   DEBDASD+14                                               01360000
DEBENDHH EQU   DEBDASD+12                                               01361000
DEBENDCC EQU   DEBDASD+10                                               01362000
DEBSTRHH EQU   DEBDASD+8                                                01363000
DEBSTRCC EQU   DEBDASD+6                                                01364000
DEBBINUM EQU   DEBDASD+4                                                01365000
DEBUCBA  EQU   DEBUCBAD+1                                               01366000
DEBDVMOD EQU   DEBUCBAD                                                 01367000
DEBAPPB  EQU   DEBAPPAD+1                                               01368000
DEBEXSCL EQU   DEBAPPAD                                                 01369000
DEBDCBB  EQU   DEBDCBAD+1                                               01370000
DEBDEBID EQU   DEBPROTG                                                 01371000
DEBECBB  EQU   DEBECBAD+1                                               01372000
DEBPRIOR EQU   DEBECBAD                                                 01373000
DEBUSRPB EQU   DEBUSRPG+1                                               01374000
DEBNMEXT EQU   DEBUSRPG                                                 01375000
DEBRSV05 EQU   DEBBASIC+15                                              01376000
DEBXTNIN EQU   DEBFLGS1                                                 01377000
DEBAPFIN EQU   DEBFLGS1                                                 01378000
DEBF1CEV EQU   DEBFLGS1                                                 01379000
DEBCINDI EQU   DEBFLGS1                                                 01380000
DEBRSV02 EQU   DEBFLGS1                                                 01381000
DEBRSIOA EQU   DEBFLGS1                                                 01382000
DEBEOFDF EQU   DEBFLGS1                                                 01383000
DEBPWCKD EQU   DEBFLGS1                                                 01384000
DEBQSCNT EQU   DEBBASIC+13                                              01385000
DEBACCS  EQU   DEBOPATB                                                 01386000
DEBPOSIT EQU   DEBOPATB                                                 01387000
DEBZERO  EQU   DEBOPATB                                                 01388000
DEBABEND EQU   DEBOPATB                                                 01389000
DEBIRBB  EQU   DEBIRBAD+1                                               01390000
DEBRERR  EQU   DEBOFLGS                                                 01391000
DEBLABEL EQU   DEBOFLGS                                                 01392000
DEBSPLIT EQU   DEBOFLGS                                                 01393000
DEBDCB   EQU   DEBOFLGS                                                 01394000
DEBRLSE  EQU   DEBOFLGS                                                 01395000
DEBEOF   EQU   DEBOFLGS                                                 01396000
DEBDISP  EQU   DEBOFLGS                                                 01397000
DEBDEBB  EQU   DEBDEBAD+1                                               01398000
DEBAMLNG EQU   DEBDEBAD                                                 01399000
DEBTCBB  EQU   DEBTCBAD+1                                               01400000
DEBNMSUB EQU   DEBTCBAD                                                 01401000
DCBEOB   EQU   IFGSDCB+92                                               01402000
DCBPRECL EQU   IFGSDCB+90                                               01403000
@NM00017 EQU   IFGSDCB+88                                               01404000
DCBPOINT EQU   DCBNOTE                                                  01405000
DCBLRECL EQU   IFGSDCB+82                                               01406000
DCBQSWS  EQU   DCBDIRCT                                                 01407000
DCBCCCW  EQU   DCBRECAD                                                 01408000
DCBNCP   EQU   DCBEOBR                                                  01409000
DCBOFFSW EQU   IFGSDCB+67                                               01410000
DCBOFFSR EQU   IFGSDCB+66                                               01411000
DCBWCPL  EQU   IFGSDCB+65                                               01412000
DCBWCPO  EQU   IFGSDCB+64                                               01413000
DCBCIND1 EQU   IFGSDCB+60                                               01414000
DCBIOBL  EQU   IFGSDCB+56                                               01415000
DCBPERR  EQU   DCBGERR                                                  01416000
DCBOPTCD EQU   IFGSDCB+52                                               01417000
DCBMACR  EQU   DCBPUT+1                                                 01418000
DCBIFLG  EQU   DCBPUT                                                   01419000
DCBOFLGS EQU   IFGSDCB+48                                               01420000
DCBIFLGS EQU   DCBDDNAM+4                                               01421000
DCBEXLST EQU   IFGSDCB+37                                               01422000
DCBRECFM EQU   IFGSDCB+36                                               01423000
DCBEODAD EQU   IFGSDCB+33                                               01424000
DCBBFALN EQU   DCBBFTEK                                                 01425000
DCBSVCXL EQU   DCBIOBAD                                                 01426000
DCBDSORG EQU   IFGSDCB+26                                               01427000
DCBBUFL  EQU   IFGSDCB+24                                               01428000
DCBBUFNO EQU   DCBBUFCB                                                 01429000
@NM00013 EQU   IFGSDCB+16                                               01430000
@NM00012 EQU   IFGSDCB                                                  01431000
RPLRPLPT EQU   RPLEXTEN+12                                              01432000
RPLSAVE  EQU   RPLEXTEN+4                                               01433000
RPLERMSA EQU   RPLCOMN+72                                               01434000
RPLEMLEN EQU   RPLCOMN+70                                               01435000
RPLACTIV EQU   RPLCOMN+69                                               01436000
RPLBRANC EQU   RPLEXTD1                                                 01437000
RPLNIB   EQU   RPLEXTD1                                                 01438000
@NM00011 EQU   RPLEXTD1                                                 01439000
RPLEXIT  EQU   RPLEXTD1                                                 01440000
RPLNEXIT EQU   RPLEXTD1                                                 01441000
RPLEXSCH EQU   RPLEXTD1                                                 01442000
RPLDDDD  EQU   RPLRBAR+4                                                01443000
@NM00010 EQU   RPLRBAR+3                                                01444000
@NM00009 EQU   RPLAIXID                                                 01445000
RPLAXPKP EQU   RPLAIXID                                                 01446000
RPLAIXPC EQU   RPLRBAR                                                  01447000
RPLRSV88 EQU   RPLOPT8                                                  01448000
RPLUNCON EQU   RPLOPT8                                                  01449000
RPLACTV  EQU   RPLOPT8                                                  01450000
RPLSESS  EQU   RPLOPT8                                                  01451000
RPLPEND  EQU   RPLOPT8                                                  01452000
RPLODPRM EQU   RPLOPT8                                                  01453000
RPLODACP EQU   RPLOPT8                                                  01454000
RPLODACQ EQU   RPLOPT8                                                  01455000
RPLRSV78 EQU   RPLOPT7                                                  01456000
RPLRSV77 EQU   RPLOPT7                                                  01457000
RPLRLSOP EQU   RPLOPT7                                                  01458000
RPLTPOST EQU   RPLOPT7                                                  01459000
RPLQOPT  EQU   RPLOPT7                                                  01460000
RPLCNIMM EQU   RPLCNOPT                                                 01461000
RPLCNANY EQU   RPLCNOPT                                                 01462000
RPLCNALL EQU   RPLCNOPT                                                 01463000
RPLRSV68 EQU   RPLOPT6                                                  01464000
RPLRSV67 EQU   RPLOPT6                                                  01465000
RPLLOCK  EQU   RPLOPT6                                                  01466000
RPLNCOND EQU   RPLOPT6                                                  01467000
RPLCOND  EQU   RPLOPT6                                                  01468000
RPLEOT   EQU   RPLUNTYP                                                 01469000
RPLEOM   EQU   RPLUNTYP                                                 01470000
RPLEOB   EQU   RPLUNTYP                                                 01471000
RPLWROPT EQU   RPLOPT5                                                  01472000
RPLNODE  EQU   RPLOPT5                                                  01473000
RPLERACE EQU   RPLWRTYP                                                 01474000
RPLEAU   EQU   RPLWRTYP                                                 01475000
RPLNERAS EQU   RPLWRTYP                                                 01476000
RPLPSOPT EQU   RPLOPT5                                                  01477000
RPLSSNIN EQU   RPLOPT5                                                  01478000
RPLDLGIN EQU   RPLOPT5                                                  01479000
RPLCHAIN EQU   RPLNXTRP                                                 01480000
RPLOPT4  EQU   RPLOPTCD+3                                               01481000
RPLALIGN EQU   RPLOPT3                                                  01482000
RPLFMT   EQU   RPLOPT3                                                  01483000
RPLFLD   EQU   RPLOPT3                                                  01484000
RPLVFY   EQU   RPLOPT3                                                  01485000
RPLBLK   EQU   RPLOPT3                                                  01486000
RPLSFORM EQU   RPLOPT3                                                  01487000
RPLEODS  EQU   RPLOPT3                                                  01488000
RPLNSP   EQU   RPLOPT2                                                  01489000
RPLUPD   EQU   RPLOPT2                                                  01490000
RPLWAITX EQU   RPLOPT2                                                  01491000
RPLLRD   EQU   RPLOPT2                                                  01492000
RPLBWD   EQU   RPLOPT2                                                  01493000
RPLCNV   EQU   RPLOPT2                                                  01494000
RPLADD   EQU   RPLADR                                                   01495000
RPLKEY   EQU   RPLOPT2                                                  01496000
RPLECBIN EQU   RPLECBSW                                                 01497000
RPLGEN   EQU   RPLOPT1                                                  01498000
RPLKGE   EQU   RPLOPT1                                                  01499000
RPLASY   EQU   RPLOPT1                                                  01500000
RPLSKP   EQU   RPLOPT1                                                  01501000
RPLSEQ   EQU   RPLOPT1                                                  01502000
RPLDIR   EQU   RPLOPT1                                                  01503000
RPLLOC   EQU   RPLOPT1                                                  01504000
RPLDAF   EQU   RPLARG+2                                                 01505000
RPLSAF   EQU   RPLARG                                                   01506000
RPLTCBPT EQU   RPLCOMN+28                                               01507000
RPLDACB  EQU   RPLCOMN+24                                               01508000
RPLCCHAR EQU   RPLCOMN+20                                               01509000
RPLSTRID EQU   RPLCOMN+18                                               01510000
RPLKEYL  EQU   RPLKEYLE                                                 01511000
RPLRDSOH EQU   RPLFDB3                                                  01512000
RPLRLG   EQU   RPLFDB3                                                  01513000
RPLLGFRC EQU   RPLFDB3                                                  01514000
RPLREOT  EQU   RPLFDB3                                                  01515000
RPLREOM  EQU   RPLFDB3                                                  01516000
RPLREOB  EQU   RPLFDB3                                                  01517000
RPLSV32  EQU   RPLFDB3                                                  01518000
RPLUINPT EQU   RPLFDB3                                                  01519000
RPLSTSAV EQU   RPLFDB2                                                  01520000
RPLCUERR EQU   RPLFDB2                                                  01521000
RPLDLGFL EQU   RPLFDB2                                                  01522000
RPLIOERR EQU   RPLFDB2                                                  01523000
RPLDVUNS EQU   RPLFDB2                                                  01524000
RPLATND  EQU   RPLFDB2                                                  01525000
RPLRVID  EQU   RPLFDB2                                                  01526000
RPLERLK  EQU   RPLFDB2                                                  01527000
RPLERREG EQU   RPLRTNCD                                                 01528000
RPLSTAT  EQU   RPLFDBWD                                                 01529000
RPLPOST  EQU   RPLECB                                                   01530000
RPLWAIT  EQU   RPLECB                                                   01531000
RPLPLHPT EQU   RPLCOMN+4                                                01532000
RPLLEN2  EQU   RPLLEN                                                   01533000
RPLREQ   EQU   RPLIDWD+2                                                01534000
RPLSTYP  EQU   RPLIDWD+1                                                01535000
RPLID    EQU   RPLIDWD                                                  01536000
CISTOWRC EQU   CISTOW                                                   01537000
CIFEOVRC EQU   CIFEOV                                                   01538000
CIBSPRC  EQU   CIBSP                                                    01539000
CIBLDLRC EQU   CIBLDL                                                   01540000
CIWK2    EQU   IFGJCICB+332                                             01541000
CIWK1    EQU   IFGJCICB+328                                             01542000
CISAMWA  EQU   IFGJCICB+324                                             01543000
CIRECPTR EQU   IFGJCICB+320                                             01544000
CIRAREA  EQU   IFGJCICB+316                                             01545000
CIBLKPTR EQU   IFGJCICB+312                                             01546000
CISEGLEN EQU   CIIOCNT                                                  01547000
CILWAREA EQU   IFGJCICB+304                                             01548000
CIFDBCK  EQU   IFGJCICB+284                                             01549000
CIRPLEXT EQU   IFGJCICB+268                                             01550000
CIFLAG4  EQU   CIFLAGS+3                                                01551000
@NM00008 EQU   CIFLAG3                                                  01552000
CIFPOINT EQU   CIFLAG3                                                  01553000
CIFERROR EQU   CIFLAG3                                                  01554000
CIFVSEOB EQU   CIFLAG3                                                  01555000
CIFVSRI  EQU   CIFLAG3                                                  01556000
CIFRAGM  EQU   CIFLAG3                                                  01557000
CIFCLOSE EQU   CIFLAG3                                                  01558000
CIFFSTP  EQU   CIFLAG3                                                  01559000
@NM00007 EQU   CIFLAG2                                                  01560000
CIFMDEVT EQU   CIFLAG2                                                  01561000
CIFMDSOR EQU   CIFLAG2                                                  01562000
CIREGS   EQU   CIREGSAV+12                                              01563000
CIREGFC  EQU   CIREGSAV+8                                               01564000
@NM00006 EQU   CIREGSAV                                                 01565000
CISYNNAM EQU   IFGJCICB+108                                             01566000
CIACBED  EQU   IFGJCICB+88                                              01567000
CIACBD   EQU   IFGJCICB+32                                              01568000
@NM00005 EQU   CIDUMIOB+24                                              01569000
@NM00004 EQU   CIDUMIOB+16                                              01570000
CIECBPTR EQU   CIDUMIOB+12                                              01571000
@NM00003 EQU   CIDUMIOB+5                                               01572000
CIECBCD  EQU   CIDUMIOB+4                                               01573000
CINXTIOB EQU   CIDUMIOB                                                 01574000
SAVE12   EQU   SAVE912+12                                               01575000
SAVE11   EQU   SAVE912+8                                                01576000
SAVE10   EQU   SAVE912+4                                                01577000
SAVE9    EQU   SAVE912                                                  01578000
SAVE8    EQU   SAVE28+24                                                01579000
SAVE7    EQU   SAVE28+20                                                01580000
SAVE6    EQU   SAVE28+16                                                01581000
SAVE5    EQU   SAVE28+12                                                01582000
SAVE3    EQU   SAVE28+4                                                 01583000
SAVE2    EQU   SAVE28                                                   01584000
SAVE0    EQU   SAVE141+8                                                01585000
SAVE15   EQU   SAVE141+4                                                01586000
SAVE14   EQU   SAVE141                                                  01587000
@NM00002 EQU   REGSAVE                                                  01588000
DECNEXT  EQU   DECB+20                                                  01589000
DECAREA  EQU   DECB+12                                                  01590000
DECDCBAD EQU   DECB+8                                                   01591000
DECLNGTH EQU   DECB+6                                                   01592000
DECTYPE  EQU   DECB+5                                                   01593000
DECTYP   EQU   DECB+4                                                   01594000
@NM00001 EQU   DECBCODE                                                 01595000
DECBCOMP EQU   DECBCODE                                                 01596000
DECBWAIT EQU   DECBCODE                                                 01597000
*                                      END UNREFERENCED COMPONENTS      01598000
@RT00082 EQU   EROPT                                                    01599000
@RF00106 EQU   @RC00102                                                 01600000
@RT00137 EQU   @EL00001                                                 01601000
@RT00141 EQU   @EL00001                                                 01602000
@EL01    EQU   @EL00001                                                 01603000
@ENDDATA EQU   *                                                        01604000
         END   IGG019AH,(C'PLS2045',0701,77318)                         01605000
./  ADD  SSI=72550363,NAME=IGG019DJ
         TITLE 'IGG019DJ -- SAM-SI QSAM PROCESSOR                      *00001000
                        '                                               00002000
IGG019DJ CSECT ,                                                   0001 00003000
@PROLOG  DS    0H                                                  0002 00004000
         EJECT                                                          00005000
         EJECT                                                          00006000
         EJECT                                                          00007000
         EJECT                                                          00008000
         EJECT                                                          00009000
         EJECT                                                          00010000
         EJECT                                                          00011000
EIGHT    EQU   8                        SYMBOLIC EQUATE                 00012000
TWELVE   EQU   12                       SYMBOLIC EQUATE                 00013000
TWENTY   EQU   20                       SYMBOLIC EQUATE                 00014000
*                                                                       00015000
         DC    A(GETENTRY)              ADDR FOR GET IN BRANCH TABLE    00016000
         DC    A(PUTENTRY)              ADDR FOR PUT IN BRANCH TABLE    00017000
         DC    A(CNTRLENT)              ADDR FOR CNTRL IN TABLE  XM3766 00018000
*                                                                   **  00019000
*********************************************************************/  00020000
*                                                                   */  00021000
*   ENTRY BRANCH TABLE                                              */  00022000
*                                                                   */  00023000
**********************************************************************  00024000
*                                                                   **  00025000
         USING GETENTRY,R15             /* ENTRY ADDRESSABILITY     */  00026000
         USING @DATD-CIWK1,RCICB                                        00027000
GETENTRY B     GETROUTN                 /* ENTRY FOR GET            */  00028000
         B     NOOPRTN                  /* DUMMY ENTRY -- INVALID   */  00029000
         B     RELSERTN                 /* BRANCH TO RELSE EP       */  00030000
         DROP  R15                                                      00031000
         USING PUTENTRY,R15             /* TEMP ADDRESSABILITY      */  00032000
PUTENTRY B     PUTROUTN                 /* ENTRY FOR USER PUT       */  00033000
         B     PUTXRTN                  /* BRANCH TO PUTX EP        */  00034000
         B     TRUNCRTN                 /* BRANCH TO TRUNC EP       */  00035000
         DROP  R15                                                      00036000
         USING CNTRLENT,R15             TEMORARY ADDRESSABILITY  XM3766 00037000
CNTRLENT B     CNTRLRTN                 BRANCH TO CNTRL ROUTINE  XM3766 00038000
         DROP  R15                                               XM3766 00039000
         USING GETENTRY,R11             /* RESET BASE ADDRESS       */  00040000
         EJECT                                                          00041000
GETROUTN STM R14,R12,12(R13)                                            00042000
*        RDCB = R1;                     /* ESTABLISH DCB BASE       */  00043000
         LR    RDCB,R1                                             0102 00044000
*        RCICB = DCBCICB;               /* ESTABLISH CICB BASE      */  00045000
         L     RCICB,DCBCICB(,RDCB)                                0103 00046000
*        R11 = R15;                     /* ESTABLISH BASE REGISTER  */  00047000
         LR    R11,R15                                             0104 00048000
*        CIREGBC = R13;                 /* KEEP USER SAVE POINTER   */  00049000
         ST    R13,CIREGBC(,RCICB)                                 0105 00050000
*        R13 = ADDR(CIREGSAV);          /* SET CI SAVE ADDRESS      */  00051000
         LA    R13,CIREGSAV(,RCICB)                                0106 00052000
*        RRPL = ADDR(CIRPL);            /* ESTABLISH RPL BASE       */  00053000
         LA    RRPL,CIRPL(,RCICB)                                  0107 00054000
*        RPLRLEN = ZERO;                /* ZERO LENGTH FIELD        */  00055000
*                                                                  0108 00056000
         MVC   RPLRLEN(4,RRPL),ZERO                                0108 00057000
*        IF DCBMACRF(5)   = '1'B THEN   /* GET-LOCATE MODE ?         */ 00058000
         TM    DCBMACRF(RDCB),B'00001000'                          0109 00059000
         BNO   @RF00109                                            0109 00060000
*                                       /* YES, BUFR PTR ALREADY SET */ 00061000
*          IF DCBRECFM(1:2) = '01'B THEN/* IS IT ALSO V FORMAT ?     */ 00062000
         TM    DCBRECFM(RDCB),B'01000000'                          0110 00063000
         BNO   @RF00110                                            0110 00064000
         TM    DCBRECFM(RDCB),B'10000000'                          0110 00065000
         BNZ   @RF00110                                            0110 00066000
*            RPLAREA = RPLAREA + FOUR;  /* THEN ADJUST BUFR PTR TO 0111 00067000
*                                       ALLOW SPACE FOR AN RDW.      */ 00068000
         LH    @10,FOUR                                            0111 00069000
         AL    @10,RPLAREA(,RRPL)                                  0111 00070000
         ST    @10,RPLAREA(,RRPL)                                  0111 00071000
*          ELSE;                        /* NOT V, USE BUFR PTR AS IS.*/ 00072000
@RF00110 DS    0H                                                  0113 00073000
*        ELSE                           /* NOT LOCATE,IS MOVE OR SUBS*/ 00074000
*          IF DCBRECFM(1:2) = '01'B THEN/* V FORMAT ?                */ 00075000
         B     @RC00109                                            0113 00076000
@RF00109 TM    DCBRECFM(RDCB),B'01000000'                          0113 00077000
         BNO   @RF00113                                            0113 00078000
         TM    DCBRECFM(RDCB),B'10000000'                          0113 00079000
         BNZ   @RF00113                                            0113 00080000
*            RPLAREA = R0 + FOUR;       /* YES, SET BUFR PTR TO CALLERS 00081000
*                                       AREA AND LEAVE ROOM FOR RDW. */ 00082000
         LR    @10,R0                                              0114 00083000
         AH    @10,FOUR                                            0114 00084000
         ST    @10,RPLAREA(,RRPL)                                  0114 00085000
*          ELSE                         /* IS U OR F FORMAT          */ 00086000
*            RPLAREA = R0;              /* USE CALLERS BUFR PTR      */ 00087000
*                                                                  0115 00088000
         B     @RC00113                                            0115 00089000
@RF00113 ST    R0,RPLAREA(,RRPL)                                   0115 00090000
*/*******************************************************************/  00091000
*JESGET: GEN   (GET RPL=(RRPL));        /* JES GET REQUEST          */  00092000
@RC00113 DS    0H                                                  0116 00093000
@RC00109 DS    0H                                                  0116 00094000
JESGET   GET RPL=(RRPL)                                                 00095000
*/*******************************************************************/  00096000
*                                                                  0117 00097000
*        IF R15 = 0 THEN                /* NORMAL JES RETURN ? Y02082*/ 00098000
         LTR   R15,R15                                             0117 00099000
         BNZ   @RF00117                                            0117 00100000
*          IF DCBRECFM(1:2) = '10'B &   /* BUT IF F FORMAT AND Y02082*/ 00101000
*          RPLRLEN ¬= RPLBUFL THEN      /* NOT EXACT LENGTH,   Y02082*/ 00102000
         TM    DCBRECFM(RDCB),B'10000000'                          0118 00103000
         BNO   @RF00118                                            0118 00104000
         TM    DCBRECFM(RDCB),B'01000000'                          0118 00105000
         BNZ   @RF00118                                            0118 00106000
         CLC   RPLRLEN(4,RRPL),RPLBUFL(RRPL)                       0118 00107000
         BE    @RF00118                                            0118 00108000
*            DO;                        /* FORCE LOGICAL ERROR Y02082*/ 00109000
*              RPLRTNCD = 8;            /* SET LOGICAL ERR     Y02082*/ 00110000
         MVI   RPLRTNCD(RRPL),X'08'                                0120 00111000
*              RPLERRCD = RPLINBUF;     /* SET LENGTH ERR      Y02144*/ 00112000
         MVC   RPLERRCD(1,RRPL),RPLINBUF                           0121 00113000
*            END;                       /*                     Y02082*/ 00114000
*          ELSE                         /* VALID NORMAL RETURN Y02082*/ 00115000
*            GO TO FINGET;              /* RESUME NORMAL PATH  Y02082*/ 00116000
*        ELSE                           /* ABNORMAL JES RETURN Y02082*/ 00117000
*          IF RPLRTNCD = 8              /* IS IT LOGICAL ERR,  Y02082*/ 00118000
*          & RPLERRCD = RPLEODER        /* DUE TO END OF DATA  Y02144*/ 00119000
*          & DCBIFLGS(1:2) ¬= '11'B THEN/* FOR FIRST TIME?   @ZA15667*/ 00120000
         B     @RC00117                                            0124 00121000
@RF00117 CLI   RPLRTNCD(RRPL),8                                    0124 00122000
         BNE   @RF00124                                            0124 00123000
         CLC   RPLERRCD(1,RRPL),RPLEODER                           0124 00124000
         BNE   @RF00124                                            0124 00125000
         TM    DCBIFLGS(RDCB),B'11000000'                          0124 00126000
         BNO   @RT00124                                            0124 00127000
*             GO TO EODADDR;            /* BRANCH IF END OF FILE     */ 00128000
*          ELSE;                        /* MUST BE A REAL ERROR      */ 00129000
*                                                                  0126 00130000
@RF00124 DS    0H                                                  0127 00131000
*        /* SET THE ERROR INDEX FOR SYNAD HANDLER                    */ 00132000
*        IF RPLRTNCD = '08'X            /* FOR LOGICAL ERROR   Y02144*/ 00133000
*        & RPLERRCD = RPLINBUF THEN     /* DUE TO WRONG LEN    Y02144*/ 00134000
@RC00117 CLI   RPLRTNCD(RRPL),8                                    0127 00135000
         BNE   @RF00127                                            0127 00136000
         CLC   RPLERRCD(1,RRPL),RPLINBUF                           0127 00137000
         BNE   @RF00127                                            0127 00138000
*          CIFLAG1 = ERR4;              /* SET QSAM LEN ERROR  Y02144*/ 00139000
         MVC   CIFLAG1(1,RCICB),ERR4                               0128 00140000
*        ELSE                           /* FOR ANY OTHER,      Y02144*/ 00141000
*          CIFLAG1 = ERR5;              /* SET QSAM READ ERROR Y02144*/ 00142000
*                                                                  0129 00143000
         B     @RC00127                                            0129 00144000
@RF00127 MVC   CIFLAG1(1,RCICB),ERR5                               0129 00145000
*        IF DCBEROPT(2)   = '1'B THEN   /* IF USER EROPT=SKIP        */ 00146000
@RC00127 TM    DCBEROPT(RDCB),B'01000000'                          0130 00147000
         BNO   @RF00130                                            0130 00148000
*          RETREG = ADDR(JESGET);       /* SET FOR ANOTHER GET       */ 00149000
         LA    RETREG,JESGET                                       0131 00150000
*        ELSE                           /* YES                       */ 00151000
*          RETREG = ADDR(FINGET);       /* OTHERWISE TO FINISH       */ 00152000
*                                                                  0132 00153000
         B     @RC00130                                            0132 00154000
@RF00130 LA    RETREG,FINGET                                       0132 00155000
*        GO TO ERROR;                   /* GO TO SUBROUTINE          */ 00156000
*                                                                  0133 00157000
*                                                                  0133 00158000
         B     ERROR                                               0133 00159000
*FINGET: IF DCBRECFM(1:2) = '01'B       /* VARIABLE LENGTH RECORD   */  00160000
*          THEN                         /* IF YES,                  */  00161000
FINGET   TM    DCBRECFM(RDCB),B'01000000'                          0134 00162000
         BNO   @RF00134                                            0134 00163000
         TM    DCBRECFM(RDCB),B'10000000'                          0134 00164000
         BNZ   @RF00134                                            0134 00165000
*            DO;                        /* DO THE FOLLOWING         */  00166000
*              RPLAREA = RPLAREA - FOUR;/* MOVE BUFFER POINTER TO   */  00167000
         LH    @10,FOUR                                            0136 00168000
         L     @09,RPLAREA(,RRPL)                                  0136 00169000
         SLR   @09,@10                                             0136 00170000
         ST    @09,RPLAREA(,RRPL)                                  0136 00171000
*                                       /*   INCLUDE RDW            */  00172000
*              RDW = RPLRLEN + FOUR;    /*PUT REC LGTH IN RDW YM5231*/  00173000
         AL    @10,RPLRLEN(,RRPL)                                  0137 00174000
         STH   @10,RDW(,@09)                                       0137 00175000
*            END;                       /* END OF VLR DO GROUP      */  00176000
*          ELSE;                        /* NOT VLR RECORD           */  00177000
*                                                                  0139 00178000
*                                                                  0139 00179000
@RF00134 DS    0H                                                  0140 00180000
*/*******************************************************************/  00181000
*/*          RETURN TO USER                                         */  00182000
*/*******************************************************************/  00183000
*                                                                  0140 00184000
*        R13 = CIREGBC;                 /* GET POINTER TO USER SAVE */  00185000
         L     R13,CIREGBC(,RCICB)                                 0140 00186000
*        CIREGSV1 = RPLAREA;            /* SET POINTER TO RECORD    */  00187000
         MVC   CIREGSV1(4,R13),RPLAREA(RRPL)                       0141 00188000
*        IF DCBRECFM(1:2) = '10'B       /* IF RECFM IS FIXED    */ 0142 00189000
*          THEN                         /* YES, FIXED               */  00190000
         TM    DCBRECFM(RDCB),B'10000000'                          0142 00191000
         BNO   @RF00142                                            0142 00192000
         TM    DCBRECFM(RDCB),B'01000000'                          0142 00193000
         BZ    @RT00142                                            0142 00194000
*            GO TO FIXRCD;              /* DO NOT UPDATE DCBLRECL   */  00195000
*        IF DCBRECFM(1:2) = '01'B  /*IF RECFM VARIABLE @ZA02426*/  0144 00196000
*          THEN                         /*@ZA02426*/               0144 00197000
@RF00142 TM    DCBRECFM(RDCB),B'01000000'                          0144 00198000
         BNO   @RF00144                                            0144 00199000
         TM    DCBRECFM(RDCB),B'10000000'                          0144 00200000
         BNZ   @RF00144                                            0144 00201000
*            DCBLRECL=RDW;              /*@ZA02426*/               0145 00202000
         L     @10,RPLAREA(,RRPL)                                  0145 00203000
         MVC   DCBLRECL(2,RDCB),RDW(@10)                           0145 00204000
*        ELSE DCBLRECL=RPLRLEN;         /*@ZA02426*/               0146 00205000
         B     @RC00144                                            0146 00206000
@RF00144 MVC   DCBLRECL(2,RDCB),RPLRLEN+2(RRPL)                    0146 00207000
*FIXRCD:                                /* END OF RETURN SETUP      */  00208000
*        GEN (LM R14,R12,12(R13));      /* RESTORE USERS REGISTERS  */  00209000
@RC00144 DS    0H                                                  0147 00210000
FIXRCD   LM R14,R12,12(R13)                                             00211000
*        GEN (BR R14);                  /* RETURN TO USER           */  00212000
         BR R14                                                         00213000
*/*******************************************************************/  00214000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00215000
         EJECT                                                          00216000
*                                                                  0150 00217000
*                                                                  0150 00218000
*/*******************************************************************/  00219000
*/*     END OF DATA EXIT TO QSAM GERR MODULE                        */  00220000
*/*******************************************************************/  00221000
*                                                                  0150 00222000
*EODADDR:                                                          0150 00223000
*        DCBIFLGS (1:2) = '11'B;        /* SET ERROR FLAGS  @ZA15667*/  00224000
EODADDR  OI    DCBIFLGS(RDCB),B'11000000'                          0150 00225000
*        R15 = DCBGERR;                 /* QSAM GERR ADDRESS        */  00226000
         SLR   R15,R15                                             0151 00227000
         ICM   R15,7,DCBGERR(RDCB)                                 0151 00228000
*        R13 = CIREGBC;                 /* GET POINTER TO USER SAVE */  00229000
         L     R13,CIREGBC(,RCICB)                                 0152 00230000
*        GEN;                                                      0153 00231000
         L     R14,TWELVE(R13)          USER RETURN ADDR                00232000
         LM    @0,R12,TWENTY(R13)       RESTORE USERS REGS              00233000
         STM   R14,@8,TWENTY(R13)       STORE USER REGS FOR GERR        00234000
         LR    @2,@1                    DCB ADDR TO R2 FOR GERR         00235000
         BR    R15                      BR TO QSAM GERR                 00236000
*/*******************************************************************/  00237000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00238000
         EJECT                                                          00239000
*                                                                  0155 00240000
*                                                                  0155 00241000
*/*******************************************************************/  00242000
*/*                                                                 */  00243000
*/* PUT ENTRY FROM USER                                             */  00244000
*/*                                                                 */  00245000
*/*******************************************************************/  00246000
*                                                                  0155 00247000
*PUTROUTN:                                                         0155 00248000
*        GEN   (STM R14,R12,12(R13));   /* SAVE USER'S REGISTERS    */  00249000
PUTROUTN STM R14,R12,12(R13)                                            00250000
*        RDCB = R1;                     /* ESTABLISH DCB BASE       */  00251000
         LR    RDCB,R1                                             0156 00252000
*        RCICB = DCBCICB;               /* ESTABLISH CICB BASE      */  00253000
         L     RCICB,DCBCICB(,RDCB)                                0157 00254000
*        RBUF = R0;                     /* SAVE USER BUF ADDRESS    */  00255000
         LR    RBUF,R0                                             0158 00256000
*        GEN   (LA RBUF,0(RBUF));       /* CLEAR HI BYTE    @ZA08245*/  00257000
         LA RBUF,0(RBUF)                                                00258000
*        R11 = R15;                     /* CHANGE BASE REGISTER     */  00259000
         LR    R11,R15                                             0160 00260000
*        GEN;                                                      0161 00261000
         LA    R7,PUTENTRY-GETENTRY     DISPLACEMENT-ENTRY TO BASE      00262000
         SR    R11,R7                   POINT TO GETENTRY               00263000
*/*******************************************************************/  00264000
*                                                                  0162 00265000
*        IF CIFCLOSE = '1'B             /* ENTRY FROM CLOSE         */  00266000
*          THEN                         /* YES                      */  00267000
         TM    CIFCLOSE(RCICB),B'01000000'                         0162 00268000
         BNO   @RF00162                                            0162 00269000
*            CIWK2 = R14;               /* SAVE REG 14 FOR CLOSE    */  00270000
         ST    R14,CIWK2(,RCICB)                                   0163 00271000
*        CIREGBC = R13;                 /* KEEP POINTER TO USER SAVE*/  00272000
@RF00162 ST    R13,CIREGBC(,RCICB)                                 0164 00273000
*        R13 = ADDR(CIREGSAV);          /* POINTER TO CI SAVE AREA  */  00274000
         LA    R13,CIREGSAV(,RCICB)                                0165 00275000
*        RRPL = ADDR(CIRPL);            /* ESTABLISH RPL BASE       */  00276000
*                                                                  0166 00277000
         LA    RRPL,CIRPL(,RCICB)                                  0166 00278000
*/*******************************************************************/  00279000
*/*      TEST FOR LOCATE MODE, RECORD FORMAT TYPE                   */  00280000
*/*******************************************************************/  00281000
*                                                                  0167 00282000
*        IF DCBMACRF(13)  = '1'B        /* LOCATE MODE              */  00283000
*          THEN                         /* YES                      */  00284000
         TM    DCBMACRF+1(RDCB),B'00001000'                        0167 00285000
         BNO   @RF00167                                            0167 00286000
*            RBUF = RPLAREA;            /* SET RBUF = DATA AREA ADR */  00287000
         L     RBUF,RPLAREA(,RRPL)                                 0168 00288000
*          ELSE                         /* NO, PUT MOVE MODE        */  00289000
*            GO TO PUTMOVE;             /* GO TO PROCESS IT         */  00290000
*                                       /* LOCATE MODE, CONTINUE    */  00291000
*        IF CIFFSTP = '0'B              /* TEST IF FIRST PASS       */  00292000
*          THEN                         /* YES, CALLER HAS PROVIDED */  00293000
         TM    CIFFSTP(RCICB),B'10000000'                          0170 00294000
         BNZ   @RF00170                                            0170 00295000
*            DO;                        /* NO DATA FOR PUT YET      */  00296000
*              CIFFSTP = '1'B;          /* CLEAR FIRST PASS CONDIT  */  00297000
         OI    CIFFSTP(RCICB),B'10000000'                          0172 00298000
*              GO TO GOBACK;            /* AND RETURN TO CALLER     */  00299000
         B     GOBACK                                              0173 00300000
*            END;                       /* END OF FIRST PASS LOGIC  */  00301000
*                                       /* NOT FIRST PASS, CONTINUE */  00302000
*        IF DCBRECFM(1:2) = '10'B | DCBRECFM(1:2) = '11'B/*        0175 00303000
*                                          U OR F FORMAT ?          */  00304000
*          THEN                         /* YES, PERFORM CHECKING    */  00305000
@RF00170 TM    DCBRECFM(RDCB),B'10000000'                          0175 00306000
         BNO   @GL00005                                            0175 00307000
         TM    DCBRECFM(RDCB),B'01000000'                          0175 00308000
         BZ    @RT00175                                            0175 00309000
@GL00005 TM    DCBRECFM(RDCB),B'11000000'                          0175 00310000
         BNO   @RF00175                                            0175 00311000
@RT00175 DS    0H                                                  0176 00312000
*            DO;                        /* SEQUENCE REQD FOR COBOL  */  00313000
*              IF DCBRECAD ¬= DCBEOBAD  /* TEST 'EOB' CONDITION     */  00314000
*                THEN                   /* NOT 'EOB'                */  00315000
         L     @10,DCBRECAD(,RDCB)                                 0177 00316000
         C     @10,DCBEOBAD(,RDCB)                                 0177 00317000
         BNE   @RT00177                                            0177 00318000
*                  GO TO GOBACK;        /* SUPPRESS PUT             */  00319000
*              IF DCBRECFM(1:2) = '11'B /* U FORMAT ?               */  00320000
*                THEN                   /* YES, CALC RECORD SIZE    */  00321000
         TM    DCBRECFM(RDCB),B'11000000'                          0179 00322000
         BNO   @RF00179                                            0179 00323000
*                  RPLRLEN = DCBRECAD - RPLAREA; /* FROM RECAD VALUE*/  00324000
         SL    @10,RPLAREA(,RRPL)                                  0180 00325000
         ST    @10,RPLRLEN(,RRPL)                                  0180 00326000
*              GO TO JESPUT;            /* GO TO ISSUE PUT          */  00327000
         B     JESPUT                                              0181 00328000
*            END;                       /* END OF U, F GROUP        */  00329000
*                                       /* NOT U OR F, CONTINUE     */  00330000
*        IF DCBRECFM(1:2) = '01'B       /* V FORMAT ?               */  00331000
*          THEN                         /* YES, VARIABLE LENGTH     */  00332000
@RF00175 TM    DCBRECFM(RDCB),B'01000000'                          0183 00333000
         BNO   @RF00183                                            0183 00334000
         TM    DCBRECFM(RDCB),B'10000000'                          0183 00335000
         BNZ   @RF00183                                            0183 00336000
*            IF DCBRECFM(5)   = '1'B    /* SPANNED RECORDS ?        */  00337000
*              THEN                     /* YES, VS                  */  00338000
         TM    DCBRECFM(RDCB),B'00001000'                          0184 00339000
         BO    @RT00184                                            0184 00340000
*                GO TO SPANNED;         /* GO PROCESS SEGMENT       */  00341000
*              ELSE                     /* NO, V ONLY               */  00342000
*                GO TO LENTEST;         /* GO TEST RDW              */  00343000
         B     LENTEST                                             0186 00344000
*                                       /* NOT V FORMAT, RECFM=?    */  00345000
*        GO TO PUTMOVE;                 /* DEFAULT TO PUT-MOVE      */  00346000
         B     PUTMOVE                                             0187 00347000
*/*******************************************************************/  00348000
*/*      PROCESS VARIABLE-SPANNED RECORD SEGMENTS (LOCATE MODE)     */  00349000
*/*******************************************************************/  00350000
*                                                                  0188 00351000
*SPANNED:                                                          0188 00352000
*        IF RDW < FOUR THEN             /* IF A NULL RECORD?  XA01145*/ 00353000
SPANNED  LH    @10,FOUR                                            0188 00354000
         L     @09,RPLAREA(,RRPL)                                  0188 00355000
         LH    @06,RDW(,@09)                                       0188 00356000
         CR    @06,@10                                             0188 00357000
         BL    @RT00188                                            0188 00358000
*          GO TO GOBACK;                /* RETURN...NO DATA   XA01145*/ 00359000
*        CISEGLEN = RDW - FOUR;         /* COMPUTE SEGMENT LENGTH   */  00360000
         SLR   @06,@10                                             0190 00361000
         ST    @06,CISEGLEN(,RCICB)                                0190 00362000
*        IF SEGCC = '00'B               /* IS SEGMENT COMPLETE ?    */  00363000
*          THEN                         /* YES                      */  00364000
         TM    SEGCC(@09),B'00000011'                              0191 00365000
         BNZ   @RF00191                                            0191 00366000
*            DO;                        /* PROCESS COMPLETE RECORD  */  00367000
*              RPLRLEN = 0;             /* SET RECD LENGTH TO 0     */  00368000
         SLR   @10,@10                                             0193 00369000
         ST    @10,RPLRLEN(,RRPL)                                  0193 00370000
*              GO TO COMPLRCD;          /* GO TO WRITE RECORD       */  00371000
         B     COMPLRCD                                            0194 00372000
*            END;                       /* END OF COMPL RCD GROUP   */  00373000
*                                       /* NOT COMPLETE RECORD      */  00374000
*        IF SEGCC = '01'B               /* FIRST SEGMENT OF RECORD ?*/  00375000
*          THEN                         /* YES                      */  00376000
@RF00191 L     @10,RPLAREA(,RRPL)                                  0196 00377000
         TM    SEGCC(@10),B'00000001'                              0196 00378000
         BNO   @RF00196                                            0196 00379000
         TM    SEGCC(@10),B'00000010'                              0196 00380000
         BNZ   @RF00196                                            0196 00381000
*            DO;                        /* PROCESS FIRST SEGMENT    */  00382000
*              RPLRLEN = 0;             /* INITIALIZE RECORD LENGTH */  00383000
         SLR   @10,@10                                             0198 00384000
         ST    @10,RPLRLEN(,RRPL)                                  0198 00385000
*CONTIN01:                              /* POINT TO LAST WORD OF SEG*/  00386000
*              RPLAREA = RPLAREA + CISEGLEN;                       0199 00387000
CONTIN01 L     @10,CISEGLEN(,RCICB)                                0199 00388000
         L     @09,RPLAREA(,RRPL)                                  0199 00389000
         ALR   @09,@10                                             0199 00390000
         ST    @09,RPLAREA(,RRPL)                                  0199 00391000
*              CIRECPTR = RPLAREA;      /* SAVE POINTER             */  00392000
         ST    @09,CIRECPTR(,RCICB)                                0200 00393000
*                                       /* SAVE LAST WORD OF SEG    */  00394000
*              CILWAREA = RPLAREA -> SEGMENT(1:4);                 0201 00395000
         MVC   CILWAREA(4,RCICB),SEGMENT(@09)                      0201 00396000
*              RPLRLEN = RPLRLEN + CISEGLEN;  /* UPDATE RECORD LEN  */  00397000
         AL    @10,RPLRLEN(,RRPL)                                  0202 00398000
         ST    @10,RPLRLEN(,RRPL)                                  0202 00399000
*              RBUF = RPLAREA;          /* PTR FOR NEXT SEGMENT     */  00400000
         LR    RBUF,@09                                            0203 00401000
*              GO TO GOBACK;            /* RETURN TO USER           */  00402000
         B     GOBACK                                              0204 00403000
*            END;                       /* END OF 1ST SEGMENT GROUP */  00404000
*                                                                  0205 00405000
*          ELSE                         /* NOT 1ST SEGMT OF RECORD  */  00406000
*            DO;                        /* SEE IF LAST OR INTERMED  */  00407000
@RF00196 DS    0H                                                  0207 00408000
*              IF SEGCC = '11'B         /* INTERMEDIATE SEGMENT ?   */  00409000
*                THEN                   /* YES                      */  00410000
         L     @10,RPLAREA(,RRPL)                                  0207 00411000
         TM    SEGCC(@10),B'00000011'                              0207 00412000
         BO    @RT00207                                            0207 00413000
*                  GO TO CONTIN01;      /* PREPARE RETURN TO USER   */  00414000
*                ELSE                   /* NO, MUST BE LAST SEGMENT */  00415000
*                  DO;                                             0209 00416000
*                    /* RESTORE LAST WORD OF PRECEDING SEGMENT      */  00417000
*                    CIRECPTR -> SEGMENT(1:4) = CILWAREA;          0210 00418000
*                                                                  0210 00419000
         L     @10,CIRECPTR(,RCICB)                                0210 00420000
         MVC   SEGMENT(4,@10),CILWAREA(RCICB)                      0210 00421000
*COMPLRCD:           /* POINT TO BEGINNING OF RECORD                */  00422000
*                    RPLAREA = CIRAREA + 4;                        0211 00423000
*                                                                  0211 00424000
COMPLRCD L     @10,CIRAREA(,RCICB)                                 0211 00425000
         LA    @09,4                                               0211 00426000
         ALR   @09,@10                                             0211 00427000
         ST    @09,RPLAREA(,RRPL)                                  0211 00428000
*                    RBUF = CIRAREA;    /* INIT RECORD POINTER      */  00429000
*                                                                  0212 00430000
         LR    RBUF,@10                                            0212 00431000
*                    /* UPDATE RECORD LENGTH                        */  00432000
*                    RPLRLEN = RPLRLEN + CISEGLEN;                 0213 00433000
*                                                                  0213 00434000
         L     @10,RPLRLEN(,RRPL)                                  0213 00435000
         AL    @10,CISEGLEN(,RCICB)                                0213 00436000
         ST    @10,RPLRLEN(,RRPL)                                  0213 00437000
*                    GO TO JESPUT;      /* GO TO WRITE RECORD       */  00438000
         B     JESPUT                                              0214 00439000
*                  END;                 /* END OF LAST SEGMT GROUP  */  00440000
*            END;                       /* END OF NOT 1ST SEG GRP   */  00441000
*/*******************************************************************/  00442000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00443000
         EJECT                                                          00444000
*                                                                  0218 00445000
*                                                                  0218 00446000
*/*******************************************************************/  00447000
*/*       THIS ROUTINE HANDLES MOVE MODE OF PUT                     */  00448000
*/*******************************************************************/  00449000
*                                                                  0218 00450000
*PUTMOVE:                                                          0218 00451000
*                                                                  0218 00452000
*        RPLAREA = RBUF;                /* STORE BUFFER PTR IN RPL  */  00453000
PUTMOVE  ST    RBUF,RPLAREA(,RRPL)                                 0218 00454000
*        IF DCBRECFM(1:2) = '01'B       /* VARIABLE LENGTH RECORD   */  00455000
*          THEN                         /* YES                      */  00456000
         TM    DCBRECFM(RDCB),B'01000000'                          0219 00457000
         BNO   @RF00219                                            0219 00458000
         TM    DCBRECFM(RDCB),B'10000000'                          0219 00459000
         BNZ   @RF00219                                            0219 00460000
*            DO;                        /* DO FOLLOWING FOR VLR     */  00461000
*              IF DCBMACRF(10)  = '1'B & DCBMACRF(16) = '1'B/*     0221 00462000
*                                               DATA MODE SPECIFIED */  00463000
*                THEN                   /* YES                      */  00464000
         TM    DCBMACRF+1(RDCB),B'01000001'                        0221 00465000
         BNO   @RF00221                                            0221 00466000
*                  DO;                                             0222 00467000
*                    RPLRLEN = DCBPRECL;/* GET DATA RECORD LENGTH   */  00468000
         LH    @10,DCBPRECL(,RDCB)                                 0223 00469000
         ST    @10,RPLRLEN(,RRPL)                                  0223 00470000
*                    GO TO JESPUT;      /* GO TO ISSUE PUT          */  00471000
         B     JESPUT                                              0224 00472000
*                  END;                 /* END OF DATA MODE GROUP   */  00473000
*                ELSE                   /* NOT DATA MODE            */  00474000
*                  GO TO LENTEST;       /* GO TEST RDW LENGTH       */  00475000
*            END;                       /* END OF DO GROUP          */  00476000
*          ELSE                         /* NOT VLR                  */  00477000
*            DO;                        /* DO THE FOLLOWING         */  00478000
@RF00219 DS    0H                                                  0229 00479000
*              RPLRLEN = DCBLRECL;      /* SET UP RPL LENGTH        */  00480000
         SLR   @10,@10                                             0229 00481000
         ICM   @10,3,DCBLRECL(RDCB)                                0229 00482000
         ST    @10,RPLRLEN(,RRPL)                                  0229 00483000
*              GO TO JESPUT;            /* BRANCH TO ISSUE JES PUT  */  00484000
         B     JESPUT                                              0230 00485000
*             END;                      /* END OF DO GROUP          */  00486000
*                                                                  0231 00487000
*/********************************************************************/ 00488000
*/*     TEST FOR EXCESS LENGTH FOR VARIABLE LENGTH RECORD            */ 00489000
*/*     NOTE: LOCATE MODE SPANNED RECORDS NOT CHECKED HERE           */ 00490000
*/********************************************************************/ 00491000
*                                                                  0232 00492000
*LENTEST:                               /* EXAMINE CALLER'S RDW      */ 00493000
*                                                                  0232 00494000
*        IF RDW < ZERO THEN             /* IS RDW NEGATIVE   @ZA09636*/ 00495000
LENTEST  L     @10,RPLAREA(,RRPL)                                  0232 00496000
         LH    @10,RDW(,@10)                                       0232 00497000
         C     @10,ZERO                                            0232 00498000
         BNL   @RF00232                                            0232 00499000
*          GEN (DMABCOND 213,SVC=YES,DCB=(RDCB)); /* YES -         0233 00500000
*                                          REQUEST 002 ABEND @ZA09636*/ 00501000
*                                                                  0233 00502000
         DMABCOND 213,SVC=YES,DCB=(RDCB)                                00503000
*        IF RDW < FOUR THEN             /* IS IT A NULL RECORD ?     */ 00504000
@RF00232 LH    @10,FOUR                                            0234 00505000
         L     @09,RPLAREA(,RRPL)                                  0234 00506000
         LH    @09,RDW(,@09)                                       0234 00507000
         CR    @09,@10                                             0234 00508000
         BL    @RT00234                                            0234 00509000
*          GO TO GOBACK;                /* YES, BYPASS PUT PROCESS   */ 00510000
*                                                                  0235 00511000
*        IF DCBRECFM(1:2) = '01'B & DCBRECFM(5)   = '1'B THEN/*    0236 00512000
*                                          SPANNED RECORDS SPECIFIED */ 00513000
         TM    DCBRECFM(RDCB),B'01000000'                          0236 00514000
         BNO   @RF00236                                            0236 00515000
         TM    DCBRECFM(RDCB),B'10000000'                          0236 00516000
         BNZ   @RF00236                                            0236 00517000
         TM    DCBRECFM(RDCB),B'00001000'                          0236 00518000
         BNO   @RF00236                                            0236 00519000
*          DO;                          /* YES DO SPANNED LEN CHECK  */ 00520000
*            IF RDW > DCBLRECL THEN     /* TEST RDW VALUE            */ 00521000
         SLR   @06,@06                                             0238 00522000
         ICM   @06,3,DCBLRECL(RDCB)                                0238 00523000
         CR    @09,@06                                             0238 00524000
         BNH   @RF00238                                            0238 00525000
*              DO;                      /* RDW IS TOO LARGE          */ 00526000
*                RPLRLEN=DCBLRECL-FOUR; /* TRUNC TO LRECL SIZE       */ 00527000
         SLR   @06,@10                                             0240 00528000
         ST    @06,RPLRLEN(,RRPL)                                  0240 00529000
*                GO TO LENTEST3;        /* GO PREPARE FOR JESPUT     */ 00530000
         B     LENTEST3                                            0241 00531000
*              END;                     /* END OF OVERSIZE RECORD    */ 00532000
*            ELSE GO TO LENTEST2;       /* RDW IS ACCEPTABLE         */ 00533000
*          END;                         /* END SPANNED LEN CHECK     */ 00534000
*        ELSE;                          /* NOT SPANNED RECORDS       */ 00535000
*                                                                  0245 00536000
@RF00236 DS    0H                                                  0246 00537000
*        IF RDW > DCBBLKSI - FOUR THEN  /* RDW > MAX ALLOWED ?       */ 00538000
         L     @10,RPLAREA(,RRPL)                                  0246 00539000
         SLR   @09,@09                                             0246 00540000
         ICM   @09,3,DCBBLKSI(RDCB)                                0246 00541000
         SH    @09,FOUR                                            0246 00542000
         CH    @09,RDW(,@10)                                       0246 00543000
         BNL   @RF00246                                            0246 00544000
*          GEN (DMABCOND 213,SVC=YES,DCB=(RDCB)); /* YES,      Y02144   00545000
*                                       REQUEST 002 ABEND            */ 00546000
         DMABCOND 213,SVC=YES,DCB=(RDCB)                                00547000
*        ELSE;                          /* RDW ¬> MAX ALLOWED        */ 00548000
*                                                                  0248 00549000
@RF00246 DS    0H                                                  0249 00550000
*LENTEST2:                                                         0249 00551000
*        RPLRLEN = RDW - FOUR;          /* PUT RECORD LENGTH IN RPL  */ 00552000
LENTEST2 L     @10,RPLAREA(,RRPL)                                  0249 00553000
         LH    @10,RDW(,@10)                                       0249 00554000
         SH    @10,FOUR                                            0249 00555000
         ST    @10,RPLRLEN(,RRPL)                                  0249 00556000
*LENTEST3:                                                         0250 00557000
*        RPLAREA = RPLAREA + FOUR;      /* POINT BUFFER PAST RDW     */ 00558000
LENTEST3 LH    @10,FOUR                                            0250 00559000
         AL    @10,RPLAREA(,RRPL)                                  0250 00560000
         ST    @10,RPLAREA(,RRPL)                                  0250 00561000
*/*******************************************************************/  00562000
*                                                                  0251 00563000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00564000
         EJECT                                                          00565000
*                                                                  0252 00566000
*                                                                  0252 00567000
*/*******************************************************************/  00568000
*/*  ISSUE JES PUT REQUEST                                          */  00569000
*/*******************************************************************/  00570000
*                                                                  0252 00571000
*JESPUT:                                                           0252 00572000
*                                                                  0252 00573000
*/*******************************************************************/  00574000
*/* TEST FOR CONTROL CHARACTER SPECIFIED IN DCB                     */  00575000
*/*******************************************************************/  00576000
*                                                                  0252 00577000
*        IF DCBRECFM(6:7) = '10'B | DCBRECFM(6:7) = '01'B          0252 00578000
*          THEN DO;                                                0252 00579000
JESPUT   TM    DCBRECFM(RDCB),B'00000100'                          0252 00580000
         BNO   @GL00007                                            0252 00581000
         TM    DCBRECFM(RDCB),B'00000010'                          0252 00582000
         BZ    @RT00252                                            0252 00583000
@GL00007 TM    DCBRECFM(RDCB),B'00000010'                          0252 00584000
         BNO   @RF00252                                            0252 00585000
         TM    DCBRECFM(RDCB),B'00000100'                          0252 00586000
         BNZ   @RF00252                                            0252 00587000
@RT00252 DS    0H                                                  0253 00588000
*            RPLCCHAR = RPLAREA;        /* PTR TO CONTROL CHARACTER */  00589000
         L     @10,RPLAREA(,RRPL)                                  0254 00590000
         ST    @10,RPLCCHAR(,RRPL)                                 0254 00591000
*            RPLAREA = RPLAREA + ONE;   /* STORE BUFFER POINTER     */  00592000
         LH    @09,ONE                                             0255 00593000
         ALR   @10,@09                                             0255 00594000
         ST    @10,RPLAREA(,RRPL)                                  0255 00595000
*            RPLRLEN = RPLRLEN - ONE;   /* STORE ADJUSTED LENGTH    */  00596000
         LCR   @09,@09                                             0256 00597000
         AL    @09,RPLRLEN(,RRPL)                                  0256 00598000
         ST    @09,RPLRLEN(,RRPL)                                  0256 00599000
*               END;                    /* END OF DO GROUP          */  00600000
*          ELSE;                                                   0258 00601000
@RF00252 DS    0H                                                  0259 00602000
*/*******************************************************************/  00603000
*                                                                  0259 00604000
*        GEN (PUT RPL=(RRPL));          /* JES PUT REQUEST          */  00605000
*                                                                  0259 00606000
         PUT RPL=(RRPL)                                                 00607000
*/*******************************************************************/  00608000
*/*  LOAD BUFFER ADDRESS INTO REGISTER ONE AND RETURN               */  00609000
*/*******************************************************************/  00610000
*                                                                  0260 00611000
*        IF R15 ¬= 0 THEN               /* ABNORMAL RETURN          */  00612000
         LTR   R15,R15                                             0260 00613000
         BZ    @RF00260                                            0260 00614000
*          DO;                                                     0261 00615000
*            CIFLAG1 = ERR6;            /* SET QSAM WRITE ERR  Y02144*/ 00616000
         MVC   CIFLAG1(1,RCICB),ERR6                               0262 00617000
*            RETREG = ADDR(GOBACK);     /* SET SUBROUTINE RETURN    */  00618000
         LA    RETREG,GOBACK                                       0263 00619000
*            GOTO ERROR;                /* AND GO TO SUBROUTINE     */  00620000
         B     ERROR                                               0264 00621000
*          END;                                                    0265 00622000
*                                                                  0265 00623000
*GOBACK:                                                           0266 00624000
*        R13 = CIREGBC;                 /* GET PTR TO USER SAVE AREA */ 00625000
@RF00260 DS    0H                                                  0266 00626000
GOBACK   L     R13,CIREGBC(,RCICB)                                 0266 00627000
*        CIREGSV1 = RBUF;               /* SAVE BUFFER ADDR IN USERS    00628000
*                                          REG 1 LOCATION.           */ 00629000
*                                                                  0267 00630000
         ST    RBUF,CIREGSV1(,R13)                                 0267 00631000
*        IF DCBMACRF(13)  = '1'B        /* PUT LOCATE MODE          */  00632000
*          THEN                         /* YES                      */  00633000
         TM    DCBMACRF+1(RDCB),B'00001000'                        0268 00634000
         BNO   @RF00268                                            0268 00635000
*            DO;                        /* DO FOLLOWING             */  00636000
*                                                                  0269 00637000
*              IF DCBRECFM(1:2) = '01'B THEN/*                     0270 00638000
*                                          IF V FORMAT,       XA01145*/ 00639000
         TM    DCBRECFM(RDCB),B'01000000'                          0270 00640000
         BNO   @RF00270                                            0270 00641000
         TM    DCBRECFM(RDCB),B'10000000'                          0270 00642000
         BNZ   @RF00270                                            0270 00643000
*                RBUF -> RDW = 0;       /* CLEAR OUT RDW      XA01145*/ 00644000
*                                                                  0271 00645000
         SLR   @10,@10                                             0271 00646000
         STH   @10,RDW(,RBUF)                                      0271 00647000
*              IF DCBRECFM(1:2) = '01'B & DCBRECFM(5)   = '1'B/*   0272 00648000
*                                          SPANNED RECORDS ?        */  00649000
*                THEN                   /* YES, SPANNED RECORDS     */  00650000
@RF00270 TM    DCBRECFM(RDCB),B'01000000'                          0272 00651000
         BNO   @RF00272                                            0272 00652000
         TM    DCBRECFM(RDCB),B'10000000'                          0272 00653000
         BNZ   @RF00272                                            0272 00654000
         TM    DCBRECFM(RDCB),B'00001000'                          0272 00655000
         BNO   @RF00272                                            0272 00656000
*                  /* RETURN REMAINDER OF BLOCK TO USER IN R0. THIS */  00657000
*                  /* IS USED FOR SPANNED RECORDS ONLY.             */  00658000
*                  CIREGSV0 = CIRAREA + RPLBUFL - RBUF;            0273 00659000
         L     @10,CIRAREA(,RCICB)                                 0273 00660000
         AL    @10,RPLBUFL(,RRPL)                                  0273 00661000
         SLR   @10,RBUF                                            0273 00662000
         ST    @10,CIREGSV0(,R13)                                  0273 00663000
*                ELSE;                  /* NOT SPANNED RECORDS      */  00664000
@RF00272 DS    0H                                                  0275 00665000
*              IF DCBRECFM(1:2) = '10'B | DCBRECFM(1:2) = '11'B/*  0275 00666000
*                                          F OR U FORMAT ?          */  00667000
*                THEN                   /* YES, MAINTAIN DCB FIELDS */  00668000
         TM    DCBRECFM(RDCB),B'10000000'                          0275 00669000
         BNO   @GL00009                                            0275 00670000
         TM    DCBRECFM(RDCB),B'01000000'                          0275 00671000
         BZ    @RT00275                                            0275 00672000
@GL00009 TM    DCBRECFM(RDCB),B'11000000'                          0275 00673000
         BNO   @RF00275                                            0275 00674000
@RT00275 DS    0H                                                  0276 00675000
*                  DO;                  /* FOR COBOL PROGRAMS       */  00676000
*                    DCBRECAD = RBUF + DCBLRECL; /* SET 'NEXT' BUFR */  00677000
         LR    @10,RBUF                                            0277 00678000
         SLR   @09,@09                                             0277 00679000
         ICM   @09,3,DCBLRECL(RDCB)                                0277 00680000
         ALR   @10,@09                                             0277 00681000
         ST    @10,DCBRECAD(,RDCB)                                 0277 00682000
*                    DCBEOBAD = DCBRECAD;  /* SET 'EOB' CONDITION   */  00683000
         ST    @10,DCBEOBAD(,RDCB)                                 0278 00684000
*                  END;                 /* END OF U/F GROUP         */  00685000
*              RPLRLEN = DCBLRECL;      /* SET LENGTH FOR NEXT PUT  */  00686000
@RF00275 SLR   @10,@10                                             0280 00687000
         ICM   @10,3,DCBLRECL(RDCB)                                0280 00688000
         ST    @10,RPLRLEN(,RRPL)                                  0280 00689000
*              RPLAREA = RBUF;          /* RESET PTR TO RPLAREA     */  00690000
         ST    RBUF,RPLAREA(,RRPL)                                 0281 00691000
*            END;                       /* END OF DO GROUP          */  00692000
*/*******************************************************************/  00693000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00694000
@RF00268 DS    0H                                                  0283 00695000
         EJECT                                                          00696000
*                                                                  0284 00697000
*                                                                  0284 00698000
*/*******************************************************************/  00699000
*/* IF PUT REQUEST IS FROM CLOSE, REGISTERS ARE NOT RESTORED        */  00700000
*/*******************************************************************/  00701000
*                                                                  0284 00702000
*                                                                  0284 00703000
*        IF CIFCLOSE = '1'B             /* WAS ENTRY FROM CLOSE RTN */  00704000
*          THEN                         /* YES                      */  00705000
         TM    CIFCLOSE(RCICB),B'01000000'                         0284 00706000
         BNO   @RF00284                                            0284 00707000
*            DO;                                                   0285 00708000
*              R14 = CIWK2;             /* RESTORE REGISTER 14      */  00709000
         L     R14,CIWK2(,RCICB)                                   0286 00710000
*              GOTO CLOSE;              /* GO RETURN TO CLOSE       */  00711000
         B     CLOSE                                               0287 00712000
*            END;                       /* END OF DO GROUP          */  00713000
*          ELSE;                                                   0289 00714000
@RF00284 DS    0H                                                  0290 00715000
*          GEN;                                                    0290 00716000
         LM    R14,R12,TWELVE(R13)      /* RESTORE USER'S REGSISTER */  00717000
*/*******************************************************************/  00718000
*CLOSE:  GEN   (BR R14);                /*   RETURN TO USER         */  00719000
CLOSE    BR R14                                                         00720000
*/*******************************************************************/  00721000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00722000
         EJECT                                                          00723000
*                                                                  0293 00724000
*                                                                  0293 00725000
*/*******************************************************************/  00726000
*/*  SEE IF ERROR PROCESSING IS REQUIRED                            */  00727000
*/*******************************************************************/  00728000
*                                                                  0293 00729000
*ERROR:                                                            0293 00730000
*        IF CIFCLOSE = '1'B THEN        /* ENTRY FROM CLOSE  XA00008*/  00731000
ERROR    TM    CIFCLOSE(RCICB),B'01000000'                         0293 00732000
         BNO   @RF00293                                            0293 00733000
*          GOTO RETREG;                 /* YES - DON'T GO    XA00008*/  00734000
         BR    RETREG                                              0294 00735000
*                                       /* TO SYNAD ROUTINE  XA00008*/  00736000
*                                                                  0295 00737000
*        IF CIFERROR = '0'B THEN        /* SYNAD RTN NOT YET INVOKED*/  00738000
@RF00293 TM    CIFERROR(RCICB),B'00000100'                         0295 00739000
         BNZ   @RF00295                                            0295 00740000
*          DO;                          /* NO                       */  00741000
*            R0 = ADDR(CISYNNAM);       /* COMING FROM INTERF. RTN  */  00742000
         LA    R0,CISYNNAM(,RCICB)                                 0297 00743000
*            GEN  (LOAD  EPLOC=(0));    /* LOAD SYNAD ROUTINE       */  00744000
         LOAD  EPLOC=(0)                                                00745000
*            R15 = R0;                  /* SET UP ADDRESS FOR CALL  */  00746000
         LR    R15,R0                                              0299 00747000
*            R1 = RRPL;                 /* SET UP LINKAGE AS IF     */  00748000
         LR    R1,RRPL                                             0300 00749000
*            GEN (BALR R14,R15);        /* GO TO SYNAD ROUTINE      */  00750000
         BALR R14,R15                                                   00751000
*            R0 = ADDR(CISYNNAM);       /* POINT TO NAME AGAIN      */  00752000
         LA    R0,CISYNNAM(,RCICB)                                 0302 00753000
*            GEN (DELETE EPLOC=(0));    /* AND DELETE SYNAD MODULE  */  00754000
         DELETE EPLOC=(0)                                               00755000
*          END;                         /* END OF PROCESSING FOR NOT*/  00756000
*        CIFERROR = '0'B;               /* TURN OFF 'SYNAD ENTERED' */  00757000
@RF00295 NI    CIFERROR(RCICB),B'11111011'                         0305 00758000
*        GOTO RETREG;                   /* AND EXIT ERROR PROCESSING*/  00759000
         BR    RETREG                                              0306 00760000
*/*******************************************************************/  00761000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00762000
         EJECT                                                          00763000
*                                                                  0308 00764000
*                                                                  0308 00765000
*/********************************************************************/ 00766000
*/*                                                                  */ 00767000
*/* ENTRY POINTS FOR RELSE, CNTRL,  AND TRUNC                        */ 00768000
*/*                                                                  */ 00769000
*/********************************************************************/ 00770000
*                                                                  0308 00771000
*RELSERTN:                              /* RELSE EP                  */ 00772000
*TRUNCRTN:                              /* TRUNC EP                  */ 00773000
*CNTRLRTN:                              /* CNTRL EP            XM3766*/ 00774000
*NOOPRTN:                               /* INVALID EP (NO-OP)        */ 00775000
*                                                                  0308 00776000
*/********************************************************************/ 00777000
*/* BECAUSE NO FUNCTION IS PERFORMED BY CI, CONTROL IS RETURNED      */ 00778000
*/*                                          TO THE USER.            */ 00779000
*/********************************************************************/ 00780000
*                                                                  0308 00781000
*                                                                  0308 00782000
*        GEN   (BR 14);                 /* RETURN TO USER OR CLOSE   */ 00783000
RELSERTN DS    0H                                                  0308 00784000
TRUNCRTN DS    0H                                                  0308 00785000
CNTRLRTN DS    0H                                                  0308 00786000
NOOPRTN  BR 14                                                          00787000
*/********************************************************************/ 00788000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00789000
         EJECT                                                          00790000
*                                                                  0310 00791000
*                                                                  0310 00792000
*/*******************************************************************/  00793000
*/*                                                                 */  00794000
*/*  PUTX ROUTINE                                                   */  00795000
*/*                                                                 */  00796000
*/*******************************************************************/  00797000
*                                                                  0310 00798000
*PUTXRTN:                                                          0310 00799000
*        GEN (STM R14,R12,12(R13));     /* SAVE USERS REGISTERS     */  00800000
PUTXRTN  STM R14,R12,12(R13)                                            00801000
*        RBUF = R0;                     /* SAVE POINTER TO INPUT DCB*/  00802000
         LR    RBUF,R0                                             0311 00803000
*        RDCB = R1;                     /* ESTABLISH DCB BASE       */  00804000
         LR    RDCB,R1                                             0312 00805000
*        RCICB = DCBCICB;               /* ESTABLISH CICB BASE      */  00806000
         L     RCICB,DCBCICB(,RDCB)                                0313 00807000
*        R11 = R15;                     /* SET UP BASE REGISTER     */  00808000
         LR    R11,R15                                             0314 00809000
*        GEN;                                                      0315 00810000
         LA    R7,PUTENTRY-GETENTRY     DISPLACEMENT-ENTRY TO BASE      00811000
         SR    R11,R7                   POINT TO GETENTRY               00812000
*/*******************************************************************/  00813000
*                                                                  0316 00814000
*        CIREGBC = R13;                 /* BACK POINTER TO USER SAVE*/  00815000
         ST    R13,CIREGBC(,RCICB)                                 0316 00816000
*        R13 = ADDR(CIREGSAV);          /* SET CI SAVE ADDRESS      */  00817000
         LA    R13,CIREGSAV(,RCICB)                                0317 00818000
*        RRPL = ADDR(CIRPL);            /* ESTABLISH RPL BASE       */  00819000
*                                                                  0318 00820000
         LA    RRPL,CIRPL(,RCICB)                                  0318 00821000
*/*******************************************************************/  00822000
*/* RBUF POINTS TO THE INPUT DCB, WHICH CONTAINS THE ADDRESS OF THE */  00823000
*/* INPUT RECORD TO BE WRITTEN OUT BY PUTX FOR SIMPLE BUFFERING,    */  00824000
*/* OR THE ADDR OF A CCW WHICH POINTS TO THE RECORD FOR EXCHANGE    */  00825000
*/* BUFFERING.                                                      */  00826000
*/* THIS ROUTINE PUTS THE BUFFER ADDR IN RBUF AND BRANCHES TO THE   */  00827000
*/* PUT MOVE ROUTINE.                                               */  00828000
*/*******************************************************************/  00829000
*                                                                  0319 00830000
*        R7 = RBUF;                     /* INPUT DCB ADDR           */  00831000
         LR    R7,RBUF                                             0319 00832000
*        RBUF = R7 ->DCBRECAD;          /* ADDR OF INPUT BUFFER     */  00833000
         L     RBUF,DCBRECAD(,R7)                                  0320 00834000
*        IF R7 ->DCBCIND1(8) = '1'B     /* EXCH BUFFERING SUPPORTED?*/  00835000
*         THEN                          /* YES, DCBRECAD POINTS TO  */  00836000
         TM    DCBCIND1(R7),B'00000001'                            0321 00837000
         BNO   @RF00321                                            0321 00838000
*          DO;                          /* CCW WHICH POINTS TO THE  */  00839000
*           RBUF = RBUF -> IOBCCW;      /* THE BUFFER               */  00840000
         L     RBUF,IOBCCW(,RBUF)                                  0323 00841000
*          END;                                                    0324 00842000
*        GO TO PUTMOVE;                 /* GO TO PUT MOVE ROUTINE   */  00843000
         B     PUTMOVE                                             0325 00844000
*/*******************************************************************/  00845000
*        END   IGG019DJ                 /* END OF QSAM PUT MODULE   */  00846000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 00847000
*/*%INCLUDE SYSLIB  (IFGSDCB )                                        * 00848000
*/*%INCLUDE SYSLIB  (IFGJCICB)                                        * 00849000
*/*%INCLUDE SYSLIB  (IFGRPL  )                                        * 00850000
*/*%INCLUDE SYSLIB  (IDARMRCD)                                        * 00851000
*;                                                                 0326 00852000
@EL00001 DS    0H                                                  0326 00853000
@EF00001 DS    0H                                                  0326 00854000
@ER00001 BR    @14                                                 0326 00855000
@DATA    DS    0H                                                       00856000
@DATD    DSECT                                                          00857000
         DS    0F                                                       00858000
@ZTEMPS  DS    C                                                        00859000
@ZTEMPND EQU   *                                                        00860000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         00861000
@TEMPS   EQU   @ZTEMPS                                                  00862000
@L       EQU   @ZLEN                                                    00863000
IGG019DJ CSECT                                                          00864000
         DS    0F                                                       00865000
@DATD    DSECT                                                          00866000
         DS    0D                                                       00867000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00868000
@ENDDATD EQU   *                                                        00869000
@DATEND  EQU   *                                                        00870000
IGG019DJ CSECT                                                          00871000
         DS    0F                                                       00872000
@SIZDATD DC    AL1(0)                                                   00873000
         DC    AL3(@ENDDATD-@DATD)                                      00874000
@SIZ001  EQU   @SIZDATD                                                 00875000
         DS    0D                                                       00876000
GREQTYP  DC    XL4'00000000'                                            00877000
PREQTYP  DC    XL4'00000001'                                            00878000
ZERO     DC    F'0'                                                     00879000
ONE      DC    AL2(1)                                                   00880000
FOUR     DC    AL2(4)                                                   00881000
RPLDVOL  DC    AL1(4)                                                   00882000
RPLMOKEY DC    AL1(8)                                                   00883000
RPLWTBFR DC    AL1(12)                                                  00884000
RPLEODER DC    AL1(4)                                                   00885000
RPLDUP   DC    AL1(8)                                                   00886000
RPLSEQCK DC    AL1(12)                                                  00887000
RPLNOREC DC    AL1(16)                                                  00888000
RPLEXCL  DC    AL1(20)                                                  00889000
RPLNOMNT DC    AL1(24)                                                  00890000
RPLNOEXT DC    AL1(28)                                                  00891000
RPLINRBA DC    AL1(32)                                                  00892000
RPLNOKR  DC    AL1(36)                                                  00893000
RPLNOVRT DC    AL1(40)                                                  00894000
RPLINBUF DC    AL1(44)                                                  00895000
RPLNOPLH DC    AL1(64)                                                  00896000
RPLINACC DC    AL1(68)                                                  00897000
RPLINKEY DC    AL1(72)                                                  00898000
RPLINADR DC    AL1(76)                                                  00899000
RPLERSER DC    AL1(80)                                                  00900000
RPLINLOC DC    AL1(84)                                                  00901000
RPLNOPTR DC    AL1(88)                                                  00902000
RPLINUPD DC    AL1(92)                                                  00903000
RPLKEYCH DC    AL1(96)                                                  00904000
RPLDLCER DC    AL1(100)                                                 00905000
RPLINVP  DC    AL1(104)                                                 00906000
RPLINLEN DC    AL1(108)                                                 00907000
RPLKEYLC DC    AL1(112)                                                 00908000
RPLINLRQ DC    AL1(116)                                                 00909000
RPLINTCB DC    AL1(120)                                                 00910000
RPLSRLOC DC    AL1(132)                                                 00911000
RPLARSRK DC    AL1(136)                                                 00912000
RPLSRISG DC    AL1(140)                                                 00913000
RPLNBRCD DC    AL1(144)                                                 00914000
RPLNXPTR DC    AL1(148)                                                 00915000
RPLNOBFR DC    AL1(152)                                                 00916000
RPLIRRNO DC    AL1(192)                                                 00917000
RPLRRADR DC    AL1(196)                                                 00918000
RPLPAACI DC    AL1(200)                                                 00919000
RPLPUTBK DC    AL1(204)                                                 00920000
RPLRDERD DC    AL1(4)                                                   00921000
RPLRDERI DC    AL1(8)                                                   00922000
RPLRDERS DC    AL1(12)                                                  00923000
RPLWTERD DC    AL1(16)                                                  00924000
RPLWTERI DC    AL1(20)                                                  00925000
RPLWTERS DC    AL1(24)                                                  00926000
RPLBASER DC    AL1(0)                                                   00927000
RPLBASUM DC    AL1(1)                                                   00928000
RPLAIXER DC    AL1(2)                                                   00929000
RPLAIXUM DC    AL1(3)                                                   00930000
RPLUPGER DC    AL1(4)                                                   00931000
RPLUPGUM DC    AL1(5)                                                   00932000
ERR4     DC    AL1(4)                                                   00933000
ERR5     DC    AL1(5)                                                   00934000
ERR6     DC    AL1(6)                                                   00935000
PATCH    DC    CL60' '                                                  00936000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00937000
@01      EQU   01                                                       00938000
@02      EQU   02                                                       00939000
@03      EQU   03                                                       00940000
@04      EQU   04                                                       00941000
@05      EQU   05                                                       00942000
@06      EQU   06                                                       00943000
@07      EQU   07                                                       00944000
@08      EQU   08                                                       00945000
@09      EQU   09                                                       00946000
@10      EQU   10                                                       00947000
@11      EQU   11                                                       00948000
@12      EQU   12                                                       00949000
@13      EQU   13                                                       00950000
@14      EQU   14                                                       00951000
@15      EQU   15                                                       00952000
@0       EQU   00                                                       00953000
@1       EQU   01                                                       00954000
@2       EQU   02                                                       00955000
@3       EQU   03                                                       00956000
@4       EQU   04                                                       00957000
@5       EQU   05                                                       00958000
@6       EQU   06                                                       00959000
@7       EQU   07                                                       00960000
@8       EQU   08                                                       00961000
@9       EQU   09                                                       00962000
@A       EQU   10                                                       00963000
@B       EQU   11                                                       00964000
@C       EQU   12                                                       00965000
@D       EQU   13                                                       00966000
@E       EQU   14                                                       00967000
@F       EQU   15                                                       00968000
R0       EQU   @00                                                      00969000
R1       EQU   @01                                                      00970000
RRPL     EQU   @02                                                      00971000
RCICB    EQU   @03                                                      00972000
RDCB     EQU   @04                                                      00973000
RBUF     EQU   @05                                                      00974000
R7       EQU   @07                                                      00975000
RETREG   EQU   @08                                                      00976000
R11      EQU   @11                                                      00977000
R12      EQU   @12                                                      00978000
R13      EQU   @13                                                      00979000
R14      EQU   @14                                                      00980000
R15      EQU   @15                                                      00981000
IFGSDCB  EQU   0                                                        00982000
DCBBUFCB EQU   IFGSDCB+20                                               00983000
DCBIOBAD EQU   IFGSDCB+28                                               00984000
@NM00003 EQU   IFGSDCB+32                                               00985000
DCBHIARC EQU   @NM00003                                                 00986000
DCBBFTEK EQU   DCBHIARC                                                 00987000
DCBRECFM EQU   IFGSDCB+36                                               00988000
DCBDDNAM EQU   IFGSDCB+40                                               00989000
DCBMACRF EQU   DCBDDNAM+2                                               00990000
DCBIFLGS EQU   DCBDDNAM+4                                               00991000
DCBREAD  EQU   IFGSDCB+49                                               00992000
DCBWRITE EQU   DCBREAD                                                  00993000
DCBGET   EQU   DCBWRITE                                                 00994000
DCBPUT   EQU   DCBGET                                                   00995000
DCBCHECK EQU   IFGSDCB+53                                               00996000
DCBGERR  EQU   DCBCHECK                                                 00997000
DCBCIND1 EQU   IFGSDCB+60                                               00998000
DCBBLKSI EQU   IFGSDCB+62                                               00999000
DCBIOBA  EQU   IFGSDCB+68                                               01000000
DCBCICB  EQU   DCBIOBA                                                  01001000
DCBEOBAD EQU   IFGSDCB+72                                               01002000
DCBLCCW  EQU   DCBEOBAD                                                 01003000
DCBEOBR  EQU   DCBLCCW                                                  01004000
@NM00004 EQU   IFGSDCB+76                                               01005000
DCBEOBW  EQU   @NM00004                                                 01006000
DCBRECAD EQU   DCBEOBW                                                  01007000
DCBDIRCT EQU   IFGSDCB+80                                               01008000
DCBLRECL EQU   IFGSDCB+82                                               01009000
@NM00005 EQU   IFGSDCB+84                                               01010000
DCBEROPT EQU   @NM00005                                                 01011000
DCBCNTRL EQU   @NM00005+1                                               01012000
DCBNOTE  EQU   DCBCNTRL                                                 01013000
DCBPRECL EQU   IFGSDCB+90                                               01014000
IFGJCICB EQU   0                                                        01015000
CIDUMIOB EQU   IFGJCICB                                                 01016000
CISYNNAM EQU   IFGJCICB+108                                             01017000
CIREGSAV EQU   IFGJCICB+116                                             01018000
CIREGBC  EQU   CIREGSAV+4                                               01019000
CIFLAGS  EQU   IFGJCICB+188                                             01020000
CIFLAG1  EQU   CIFLAGS                                                  01021000
CIFLAG2  EQU   CIFLAGS+1                                                01022000
CIFLAG3  EQU   CIFLAGS+2                                                01023000
CIFFSTP  EQU   CIFLAG3                                                  01024000
CIFCLOSE EQU   CIFLAG3                                                  01025000
CIFERROR EQU   CIFLAG3                                                  01026000
CIRPL    EQU   IFGJCICB+192                                             01027000
CILWAREA EQU   IFGJCICB+304                                             01028000
CIIOCNT  EQU   IFGJCICB+308                                             01029000
CISEGLEN EQU   CIIOCNT                                                  01030000
CIRAREA  EQU   IFGJCICB+316                                             01031000
CIRECPTR EQU   IFGJCICB+320                                             01032000
CIWK2    EQU   IFGJCICB+332                                             01033000
CISVCLST EQU   IFGJCICB+336                                             01034000
CISYNADA EQU   CISVCLST                                                 01035000
CIBLDL   EQU   CISVCLST+4                                               01036000
CIBSP    EQU   CISVCLST+8                                               01037000
CIFEOV   EQU   CISVCLST+12                                              01038000
CISTOW   EQU   CISVCLST+16                                              01039000
IFGRPL   EQU   0                                                        01040000
RPLCOMN  EQU   IFGRPL                                                   01041000
RPLIDWD  EQU   RPLCOMN                                                  01042000
RPLLEN   EQU   RPLIDWD+3                                                01043000
RPLECB   EQU   RPLCOMN+8                                                01044000
RPLFDBWD EQU   RPLCOMN+12                                               01045000
RPLFDBK  EQU   RPLFDBWD+1                                               01046000
RPLRTNCD EQU   RPLFDBK                                                  01047000
RPLCNDCD EQU   RPLFDBK+1                                                01048000
RPLCMPON EQU   RPLCNDCD                                                 01049000
RPLFDB2  EQU   RPLCMPON                                                 01050000
RPLERRCD EQU   RPLCNDCD+1                                               01051000
RPLFDB3  EQU   RPLERRCD                                                 01052000
RPLKEYLE EQU   RPLCOMN+16                                               01053000
RPLCCHAR EQU   RPLCOMN+20                                               01054000
RPLAREA  EQU   RPLCOMN+32                                               01055000
RPLARG   EQU   RPLCOMN+36                                               01056000
RPLOPTCD EQU   RPLCOMN+40                                               01057000
RPLOPT1  EQU   RPLOPTCD                                                 01058000
RPLECBSW EQU   RPLOPT1                                                  01059000
RPLOPT2  EQU   RPLOPTCD+1                                               01060000
RPLADR   EQU   RPLOPT2                                                  01061000
RPLOPT3  EQU   RPLOPTCD+2                                               01062000
RPLNXTRP EQU   RPLCOMN+44                                               01063000
RPLRLEN  EQU   RPLCOMN+48                                               01064000
RPLBUFL  EQU   RPLCOMN+52                                               01065000
RPLOPTC2 EQU   RPLCOMN+56                                               01066000
RPLOPT5  EQU   RPLOPTC2                                                 01067000
RPLWRTYP EQU   RPLOPT5                                                  01068000
RPLOPT6  EQU   RPLOPTC2+1                                               01069000
RPLUNTYP EQU   RPLOPT6                                                  01070000
RPLOPT7  EQU   RPLOPTC2+2                                               01071000
RPLCNOPT EQU   RPLOPT7                                                  01072000
RPLOPT8  EQU   RPLOPTC2+3                                               01073000
RPLRBAR  EQU   RPLCOMN+60                                               01074000
RPLAIXID EQU   RPLRBAR+2                                                01075000
RPLEXTDS EQU   RPLCOMN+68                                               01076000
RPLEXTD1 EQU   RPLEXTDS                                                 01077000
BUFFER   EQU   0                                                        01078000
ALLROW   EQU   BUFFER                                                   01079000
RDW      EQU   ALLROW                                                   01080000
@NM00016 EQU   ALLROW+2                                                 01081000
SEGCC    EQU   @NM00016                                                 01082000
REGSAVE  EQU   0                                                        01083000
CIREGSV0 EQU   REGSAVE+20                                               01084000
CIREGSV1 EQU   REGSAVE+24                                               01085000
SEGMENT  EQU   0                                                        01086000
IOBCCW   EQU   0                                                        01087000
*                                      START UNREFERENCED COMPONENTS    01088000
CIREGSV7 EQU   REGSAVE+48                                               01089000
@NM00019 EQU   REGSAVE+28                                               01090000
CIREGSVF EQU   REGSAVE+16                                               01091000
@NM00018 EQU   REGSAVE                                                  01092000
BUFREC   EQU   BUFFER+4                                                 01093000
FILLER   EQU   ALLROW+3                                                 01094000
@NM00017 EQU   @NM00016                                                 01095000
RPLERMSA EQU   RPLCOMN+72                                               01096000
RPLEMLEN EQU   RPLCOMN+70                                               01097000
RPLACTIV EQU   RPLCOMN+69                                               01098000
RPLBRANC EQU   RPLEXTD1                                                 01099000
RPLNIB   EQU   RPLEXTD1                                                 01100000
@NM00015 EQU   RPLEXTD1                                                 01101000
RPLEXIT  EQU   RPLEXTD1                                                 01102000
RPLNEXIT EQU   RPLEXTD1                                                 01103000
RPLEXSCH EQU   RPLEXTD1                                                 01104000
RPLDDDD  EQU   RPLRBAR+4                                                01105000
@NM00014 EQU   RPLRBAR+3                                                01106000
@NM00013 EQU   RPLAIXID                                                 01107000
RPLAXPKP EQU   RPLAIXID                                                 01108000
RPLAIXPC EQU   RPLRBAR                                                  01109000
RPLRSV88 EQU   RPLOPT8                                                  01110000
RPLUNCON EQU   RPLOPT8                                                  01111000
RPLACTV  EQU   RPLOPT8                                                  01112000
RPLSESS  EQU   RPLOPT8                                                  01113000
RPLPEND  EQU   RPLOPT8                                                  01114000
RPLODPRM EQU   RPLOPT8                                                  01115000
RPLODACP EQU   RPLOPT8                                                  01116000
RPLODACQ EQU   RPLOPT8                                                  01117000
RPLRSV78 EQU   RPLOPT7                                                  01118000
RPLRSV77 EQU   RPLOPT7                                                  01119000
RPLRLSOP EQU   RPLOPT7                                                  01120000
RPLTPOST EQU   RPLOPT7                                                  01121000
RPLQOPT  EQU   RPLOPT7                                                  01122000
RPLCNIMM EQU   RPLCNOPT                                                 01123000
RPLCNANY EQU   RPLCNOPT                                                 01124000
RPLCNALL EQU   RPLCNOPT                                                 01125000
RPLRSV68 EQU   RPLOPT6                                                  01126000
RPLRSV67 EQU   RPLOPT6                                                  01127000
RPLLOCK  EQU   RPLOPT6                                                  01128000
RPLNCOND EQU   RPLOPT6                                                  01129000
RPLCOND  EQU   RPLOPT6                                                  01130000
RPLEOT   EQU   RPLUNTYP                                                 01131000
RPLEOM   EQU   RPLUNTYP                                                 01132000
RPLEOB   EQU   RPLUNTYP                                                 01133000
RPLWROPT EQU   RPLOPT5                                                  01134000
RPLNODE  EQU   RPLOPT5                                                  01135000
RPLERACE EQU   RPLWRTYP                                                 01136000
RPLEAU   EQU   RPLWRTYP                                                 01137000
RPLNERAS EQU   RPLWRTYP                                                 01138000
RPLPSOPT EQU   RPLOPT5                                                  01139000
RPLSSNIN EQU   RPLOPT5                                                  01140000
RPLDLGIN EQU   RPLOPT5                                                  01141000
RPLCHAIN EQU   RPLNXTRP                                                 01142000
RPLOPT4  EQU   RPLOPTCD+3                                               01143000
RPLALIGN EQU   RPLOPT3                                                  01144000
RPLFMT   EQU   RPLOPT3                                                  01145000
RPLFLD   EQU   RPLOPT3                                                  01146000
RPLVFY   EQU   RPLOPT3                                                  01147000
RPLBLK   EQU   RPLOPT3                                                  01148000
RPLSFORM EQU   RPLOPT3                                                  01149000
RPLEODS  EQU   RPLOPT3                                                  01150000
RPLNSP   EQU   RPLOPT2                                                  01151000
RPLUPD   EQU   RPLOPT2                                                  01152000
RPLWAITX EQU   RPLOPT2                                                  01153000
RPLLRD   EQU   RPLOPT2                                                  01154000
RPLBWD   EQU   RPLOPT2                                                  01155000
RPLCNV   EQU   RPLOPT2                                                  01156000
RPLADD   EQU   RPLADR                                                   01157000
RPLKEY   EQU   RPLOPT2                                                  01158000
RPLECBIN EQU   RPLECBSW                                                 01159000
RPLGEN   EQU   RPLOPT1                                                  01160000
RPLKGE   EQU   RPLOPT1                                                  01161000
RPLASY   EQU   RPLOPT1                                                  01162000
RPLSKP   EQU   RPLOPT1                                                  01163000
RPLSEQ   EQU   RPLOPT1                                                  01164000
RPLDIR   EQU   RPLOPT1                                                  01165000
RPLLOC   EQU   RPLOPT1                                                  01166000
RPLDAF   EQU   RPLARG+2                                                 01167000
RPLSAF   EQU   RPLARG                                                   01168000
RPLTCBPT EQU   RPLCOMN+28                                               01169000
RPLDACB  EQU   RPLCOMN+24                                               01170000
RPLSTRID EQU   RPLCOMN+18                                               01171000
RPLKEYL  EQU   RPLKEYLE                                                 01172000
RPLRDSOH EQU   RPLFDB3                                                  01173000
RPLRLG   EQU   RPLFDB3                                                  01174000
RPLLGFRC EQU   RPLFDB3                                                  01175000
RPLREOT  EQU   RPLFDB3                                                  01176000
RPLREOM  EQU   RPLFDB3                                                  01177000
RPLREOB  EQU   RPLFDB3                                                  01178000
RPLSV32  EQU   RPLFDB3                                                  01179000
RPLUINPT EQU   RPLFDB3                                                  01180000
RPLSTSAV EQU   RPLFDB2                                                  01181000
RPLCUERR EQU   RPLFDB2                                                  01182000
RPLDLGFL EQU   RPLFDB2                                                  01183000
RPLIOERR EQU   RPLFDB2                                                  01184000
RPLDVUNS EQU   RPLFDB2                                                  01185000
RPLATND  EQU   RPLFDB2                                                  01186000
RPLRVID  EQU   RPLFDB2                                                  01187000
RPLERLK  EQU   RPLFDB2                                                  01188000
RPLERREG EQU   RPLRTNCD                                                 01189000
RPLSTAT  EQU   RPLFDBWD                                                 01190000
RPLPOST  EQU   RPLECB                                                   01191000
RPLWAIT  EQU   RPLECB                                                   01192000
RPLPLHPT EQU   RPLCOMN+4                                                01193000
RPLLEN2  EQU   RPLLEN                                                   01194000
RPLREQ   EQU   RPLIDWD+2                                                01195000
RPLSTYP  EQU   RPLIDWD+1                                                01196000
RPLID    EQU   RPLIDWD                                                  01197000
CISTOWRC EQU   CISTOW                                                   01198000
CIFEOVRC EQU   CIFEOV                                                   01199000
CIBSPRC  EQU   CIBSP                                                    01200000
CIBLDLRC EQU   CIBLDL                                                   01201000
CISYNRC  EQU   CISYNADA                                                 01202000
CIWK1    EQU   IFGJCICB+328                                             01203000
CISAMWA  EQU   IFGJCICB+324                                             01204000
CIBLKPTR EQU   IFGJCICB+312                                             01205000
CIFDBCK  EQU   IFGJCICB+284                                             01206000
CIRPLEXT EQU   IFGJCICB+268                                             01207000
CIFLAG4  EQU   CIFLAGS+3                                                01208000
@NM00012 EQU   CIFLAG3                                                  01209000
CIFPOINT EQU   CIFLAG3                                                  01210000
CIFVSEOB EQU   CIFLAG3                                                  01211000
CIFVSRI  EQU   CIFLAG3                                                  01212000
CIFRAGM  EQU   CIFLAG3                                                  01213000
@NM00011 EQU   CIFLAG2                                                  01214000
CIFMDEVT EQU   CIFLAG2                                                  01215000
CIFMDSOR EQU   CIFLAG2                                                  01216000
CIREGS   EQU   CIREGSAV+12                                              01217000
CIREGFC  EQU   CIREGSAV+8                                               01218000
@NM00010 EQU   CIREGSAV                                                 01219000
CIACBED  EQU   IFGJCICB+88                                              01220000
CIACBD   EQU   IFGJCICB+32                                              01221000
CIDCBPTR EQU   CIDUMIOB+28                                              01222000
@NM00009 EQU   CIDUMIOB+24                                              01223000
CIRESID  EQU   CIDUMIOB+20                                              01224000
@NM00008 EQU   CIDUMIOB+16                                              01225000
CIECBPTR EQU   CIDUMIOB+12                                              01226000
CIIOB    EQU   CIDUMIOB+8                                               01227000
@NM00007 EQU   CIDUMIOB+5                                               01228000
CIECBCD  EQU   CIDUMIOB+4                                               01229000
CINXTIOB EQU   CIDUMIOB                                                 01230000
DCBEOB   EQU   IFGSDCB+92                                               01231000
@NM00006 EQU   IFGSDCB+88                                               01232000
DCBPOINT EQU   DCBNOTE                                                  01233000
DCBQSWS  EQU   DCBDIRCT                                                 01234000
DCBCCCW  EQU   DCBRECAD                                                 01235000
DCBNCP   EQU   DCBEOBR                                                  01236000
DCBOFFSW EQU   IFGSDCB+67                                               01237000
DCBOFFSR EQU   IFGSDCB+66                                               01238000
DCBWCPL  EQU   IFGSDCB+65                                               01239000
DCBWCPO  EQU   IFGSDCB+64                                               01240000
DCBCIND2 EQU   IFGSDCB+61                                               01241000
DCBSYNAD EQU   IFGSDCB+57                                               01242000
DCBIOBL  EQU   IFGSDCB+56                                               01243000
DCBPERR  EQU   DCBGERR                                                  01244000
DCBOPTCD EQU   IFGSDCB+52                                               01245000
DCBMACR  EQU   DCBPUT+1                                                 01246000
DCBIFLG  EQU   DCBPUT                                                   01247000
DCBOFLGS EQU   IFGSDCB+48                                               01248000
DCBDEBAD EQU   DCBDDNAM+5                                               01249000
DCBTIOT  EQU   DCBDDNAM                                                 01250000
DCBEXLST EQU   IFGSDCB+37                                               01251000
DCBEODAD EQU   IFGSDCB+33                                               01252000
DCBBFALN EQU   DCBBFTEK                                                 01253000
DCBSVCXL EQU   DCBIOBAD                                                 01254000
DCBDSORG EQU   IFGSDCB+26                                               01255000
DCBBUFL  EQU   IFGSDCB+24                                               01256000
DCBBUFNO EQU   DCBBUFCB                                                 01257000
@NM00002 EQU   IFGSDCB+16                                               01258000
@NM00001 EQU   IFGSDCB                                                  01259000
*                                      END UNREFERENCED COMPONENTS      01260000
@RF00118 EQU   FINGET                                                   01261000
@RT00124 EQU   EODADDR                                                  01262000
@RC00130 EQU   ERROR                                                    01263000
@RT00142 EQU   FIXRCD                                                   01264000
@RF00167 EQU   PUTMOVE                                                  01265000
@RT00177 EQU   GOBACK                                                   01266000
@RF00179 EQU   JESPUT                                                   01267000
@RT00184 EQU   SPANNED                                                  01268000
@RF00184 EQU   LENTEST                                                  01269000
@RF00183 EQU   PUTMOVE                                                  01270000
@RT00188 EQU   GOBACK                                                   01271000
@RT00207 EQU   CONTIN01                                                 01272000
@RF00221 EQU   LENTEST                                                  01273000
@RT00234 EQU   GOBACK                                                   01274000
@RF00238 EQU   LENTEST2                                                 01275000
@RF00321 EQU   PUTMOVE                                                  01276000
@EL01    EQU   @EL00001                                                 01277000
@ENDDATA EQU   *                                                        01278000
         END   IGG019DJ,(C'PLS1815',0701,76336)                         01279000
./  ADD  SSI=80760076,NAME=IGG019DK
         TITLE 'IGG019DK -- SAM-SI BSAM PROCESSING MODULE.             *00001000
                        '                                               00002000
IGG019DK CSECT                          START CSECT AT ZERO             00003000
        DC    A(ENTREAD)                READ ROUTINE ENTRY              00004000
        DC    A(ENTWRITE)               WRITE ROUTINE ENTRY             00005000
        DC    A(ENTCHECK)               CHECK ROUTINE ENTRY             00006000
        DC    A(ENTCNTRL)               CNTRL ROUTINE ENTRY             00007000
        DC    A(ENTNOTE)                NOTE ROUTINE ENTRY              00008000
        DC    A(ENTPOINT)               POINT ROUTINE ENTRY             00009000
         EJECT                                                          00010000
         EJECT                                                          00011000
         EJECT                                                          00012000
         EJECT                                                          00013000
         EJECT                                                          00014000
         EJECT                                                          00015000
         EJECT                                                          00016000
         EJECT                                                          00017000
         USING  *,15                                                    00018000
ENTREAD  SAVE  (14,12)                                                  00019000
*       RDECB = R1;                     /* PTR TO DECB  (REG 7)     */  00020000
         LR    RDECB,R1                                            0117 00021000
*       RDCB  = DECDCBAD;               /* PTR TO DCB   (REG 8)     */  00022000
         L     RDCB,DECDCBAD(,RDECB)                               0118 00023000
*       R6 = 0;                         /* OFFSET INTO BRANCH TABLE */  00024000
         SLR   R6,R6                                               0119 00025000
*       GEN (B  BEGIN-ENTREAD(,R15));   /* BRANCH DOWN              */  00026000
*                                                                  0120 00027000
         B  BEGIN-ENTREAD(,R15)                                         00028000
*/*******************************************************************/  00029000
*                                                                  0121 00030000
*                                                                  0121 00031000
*ENTWRITE:                              /* ENTRY FOR WRITE MACRO    */  00032000
*       GEN (SAVE  (14,12));            /* SAVE BSAM USER'S REGS    */  00033000
ENTWRITE SAVE  (14,12)                                                  00034000
*       RDECB = R1;                     /* PTR TO DECB  (REG 7)     */  00035000
         LR    RDECB,R1                                            0122 00036000
*       RDCB  = DECDCBAD;               /* PTR TO DCB   (REG 8)     */  00037000
         L     RDCB,DECDCBAD(,RDECB)                               0123 00038000
*       R6 = 4;                         /* OFFSET INTO BRANCH TABLE */  00039000
         LA    R6,4                                                0124 00040000
*       GEN  (B  BEGIN-ENTWRITE(,R15)); /* BRANCH DOWN              */  00041000
*                                                                  0125 00042000
         B  BEGIN-ENTWRITE(,R15)                                        00043000
*/*******************************************************************/  00044000
*                                                                  0126 00045000
*                                                                  0126 00046000
*ENTCHECK:                              /* ENTRY FOR CHECK MACRO    */  00047000
*       GEN (SAVE  (14,12));            /* SAVE BSAM USER'S REGS    */  00048000
ENTCHECK SAVE  (14,12)                                                  00049000
*       RDECB = R1;                     /* PTR TO DECB  (REG 7)     */  00050000
         LR    RDECB,R1                                            0127 00051000
*       RDCB  = DECDCBAD;               /* PTR TO DCB   (REG 8)     */  00052000
         L     RDCB,DECDCBAD(,RDECB)                               0128 00053000
*       R6 = 8;                         /* OFFSET INTO BRANCH TABLE */  00054000
         LA    R6,8                                                0129 00055000
*       GEN (B  BEGIN-ENTCHECK(,R15));  /* BRANCH DOWN              */  00056000
*                                                                  0130 00057000
         B  BEGIN-ENTCHECK(,R15)                                        00058000
*/*******************************************************************/  00059000
*                                                                  0131 00060000
*                                                                  0131 00061000
*ENTCNTRL:                              /* ENTRY FOR CNTRL MACRO    */  00062000
*       GEN (SAVE  (14,12));            /* SAVE BSAM USER'S REGS    */  00063000
ENTCNTRL SAVE  (14,12)                                                  00064000
*       RDCB = R1;                      /* PTR TO DCB (REG 8)       */  00065000
         LR    RDCB,R1                                             0132 00066000
*       R6 = 12;                        /* OFFSET INTO BRANCH TABLE */  00067000
         LA    R6,12                                               0133 00068000
*       GEN (B  BEGIN-ENTCNTRL(,R15));  /* BRANCH DOWN              */  00069000
*                                                                  0134 00070000
         B  BEGIN-ENTCNTRL(,R15)                                        00071000
*/*******************************************************************/  00072000
*                                                                  0135 00073000
*                                                                  0135 00074000
*ENTPOINT:                              /* ENTRY FOR POINT MACRO    */  00075000
*       GEN (B ENTNOTE-ENTPOINT(,R15)); /* BRANCH IF NOTE           */  00076000
ENTPOINT B ENTNOTE-ENTPOINT(,R15)                                       00077000
*       GEN (SAVE  (14,12));            /* SAVE BSAM USER'S REGS    */  00078000
         SAVE  (14,12)                                                  00079000
*       RDCB = R1;                      /* PTR TO DCB (REG 8)       */  00080000
         LR    RDCB,R1                                             0137 00081000
*       R6 = 20;                        /* OFFSET INTO BRANCH TABLE */  00082000
         LA    R6,20                                               0138 00083000
*       GEN  (B  BEGIN-ENTPOINT(,R15)); /* BRANCH DOWN              */  00084000
*                                                                  0139 00085000
         B  BEGIN-ENTPOINT(,R15)                                        00086000
*/*******************************************************************/  00087000
*                                                                  0140 00088000
*                                                                  0140 00089000
*ENTNOTE:                               /* ENTRY FOR NOTE MACRO     */  00090000
*       GEN (SAVE  (14,12));            /* SAVE BSAM USER'S REGS    */  00091000
ENTNOTE  SAVE  (14,12)                                                  00092000
*       RDCB = R1;                      /* PTR TO DCB (REG 8)       */  00093000
         LR    RDCB,R1                                             0141 00094000
*       R6 = 16;                        /* OFFSET INTO BRANCH TABLE */  00095000
*                                                                  0142 00096000
         LA    R6,16                                               0142 00097000
*/*******************************************************************/  00098000
*                                                                  0143 00099000
*                                                                  0143 00100000
*        GEN;                           /* GENERATE ASSEMBLY CODE   */  00101000
*                                                                  0143 00102000
BEGIN    BALR  R11,0                    LOAD R11 FOR BASE REG           00103000
         USING *,R11                    ASSIGN ASSEMBLER BASE REG       00104000
*/*******************************************************************/  00105000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00106000
         EJECT                                                          00107000
*                                                                  0145 00108000
*                                                                  0145 00109000
*/*******************************************************************/  00110000
*                                                                  0145 00111000
*                                                                  0145 00112000
*        RCICB = DCBCICB;               /* PTR TO JCICB (REG 4)     */  00113000
*                                                                  0145 00114000
         L     RCICB,DCBCICB(,RDCB)                                0145 00115000
*/*******************************************************************/  00116000
*                                                                  0146 00117000
*                                                                  0146 00118000
*        GEN;                           /* GENERATE ASSEMBLY CODE   */  00119000
*                                                                  0146 00120000
         ST    R13,CIREGBC(,RCICB)      BACKCHAIN                       00121000
         LA    R13,CIREGSAV(,RCICB)     ADDR THIS SAVEAREA              00122000
         USING @DATD-CIWK1,RCICB        ADDRESSIBILITY FOR TEMPS        00123000
*/*******************************************************************/  00124000
*                                                                  0147 00125000
*                                                                  0147 00126000
*        RRPL=ADDR(CIRPL);              /* PTR TO RPL (REG 2)       */  00127000
*                                                                  0147 00128000
         LA    RRPL,CIRPL(,RCICB)                                  0147 00129000
*/******BRANCH TO APPROPRIATE PROCESSING ROUTINE*********************/  00130000
*                                                                  0148 00131000
*                                                                  0148 00132000
*        R6 = R6+ADDR(BRNCHTAB);        /* POINT TO BRNCH TAB ENTRY */  00133000
         LA    @12,BRNCHTAB                                        0148 00134000
         ALR   R6,@12                                              0148 00135000
*        GEN (L    R6,0(,R6)                GET ADDRESS CORRECT RTN);   00136000
         L    R6,0(,R6)                GET ADDRESS CORRECT RTN          00137000
*        GEN (BR   R6                       GO TO CORRECT ROUTINE );    00138000
*                                                                  0150 00139000
*                                                                  0150 00140000
         BR   R6                       GO TO CORRECT ROUTINE            00141000
*        RELEASE (R6);                  /* RELEASE TO COMPILER      */  00142000
*                                                                  0151 00143000
*/*******************************************************************/  00144000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00145000
         EJECT                                                          00146000
*                                                                  0153 00147000
*                                                                  0153 00148000
*/*******************************************************************/  00149000
*/*                                                                 */  00150000
*/*             JES TRANSLATOR BSAM READ ROUTINE                    */  00151000
*/*                                                                 */  00152000
*/*******************************************************************/  00153000
*                                                                  0153 00154000
*                                                                  0153 00155000
*READRTN: ;                             /* ENTER READ ROUTINE       */  00156000
*                                                                  0153 00157000
*                                                                  0153 00158000
READRTN  DS    0H                                                  0154 00159000
*/*******************************************************************/  00160000
*                                                                  0154 00161000
*                                                                  0154 00162000
*        RPLDECB = RDECB;               /* RPL PTR TO DECB          */  00163000
*                                                                  0154 00164000
         ST    RDECB,RPLDECB(,RRPL)                                0154 00165000
*/*******************************************************************/  00166000
*                                                                  0155 00167000
*                                                                  0155 00168000
*        IF CIFPOINT = '0'B             /* TEST IF POINT ERROR      */  00169000
*          THEN DECSDECB = 0;           /* NO - ZERO OUT ENTIRE ECB */  00170000
         TM    CIFPOINT(RCICB),B'00000010'                         0155 00171000
         BNZ   @RF00155                                            0155 00172000
         SLR   @12,@12                                             0156 00173000
         ST    @12,DECSDECB(,RDECB)                                0156 00174000
*          ELSE DO;                     /* INVALID POINT REQUEST    */  00175000
         B     @RC00155                                            0157 00176000
@RF00155 DS    0H                                                  0158 00177000
*               DECSDECB = '41200000'X; /* SET ERROR CODE IN ECB    */  00178000
         MVC   DECSDECB(4,RDECB),@CF00501                          0158 00179000
*               GO TO EXIT;             /* RETURN TO CALLER         */  00180000
         B     EXIT                                                0159 00181000
*               END;                                               0160 00182000
*                                                                  0160 00183000
*/*******************************************************************/  00184000
*                                                                  0161 00185000
*                                                                  0161 00186000
*        RPLAREA = DECAREA;             /* INIT RPL I/O AREA FIELD  */  00187000
*                                                                  0161 00188000
@RC00155 L     @12,DECAREA(,RDECB)                                 0161 00189000
         ST    @12,RPLAREA(,RRPL)                                  0161 00190000
*/*******************************************************************/  00191000
*                                                                  0162 00192000
*                                                                  0162 00193000
*                                                                  0162 00194000
*        IF DCBRECFM(1:2) = '01'B       /* VARIABLE LENGTH RECORD   */  00195000
*          THEN DO;                     /* YES, DO FOLLOWING        */  00196000
         TM    DCBRECFM(RDCB),B'01000000'                          0162 00197000
         BNO   @RF00162                                            0162 00198000
         TM    DCBRECFM(RDCB),B'10000000'                          0162 00199000
         BNZ   @RF00162                                            0162 00200000
*            RPLAREA = RPLAREA + 8;     /* MOVE PTR > BDW & RDW     */  00201000
         AH    @12,@CH00059                                        0164 00202000
         ST    @12,RPLAREA(,RRPL)                                  0164 00203000
*            GO TO GTCNT;               /* GO TO SET I/O COUNTER    */  00204000
         B     GTCNT                                               0165 00205000
*               END;                    /* END OF DO GROUP          */  00206000
*          ELSE;                        /* NO, NOT VARIABLE LENGTH  */  00207000
*                                                                  0167 00208000
@RF00162 DS    0H                                                  0168 00209000
*/*******************************************************************/  00210000
*                                                                  0168 00211000
*                                                                  0168 00212000
*        IF DCBRECFM(4)   = '1'B        /* TEST IF BLOCKED RECORDS  */  00213000
*          THEN DO;                     /* YES - MULTIPLE RECORDS   */  00214000
         TM    DCBRECFM(RDCB),B'00010000'                          0168 00215000
         BNO   @RF00168                                            0168 00216000
*            CIIOCNT = DCBBLKSI/DCBLRECL;/* NUMBER OF BLOCKS        */  00217000
         SLR   @15,@15                                             0170 00218000
         ICM   @15,3,DCBBLKSI(RDCB)                                0170 00219000
         SLR   @14,@14                                             0170 00220000
         SLR   @12,@12                                             0170 00221000
         ICM   @12,3,DCBLRECL(RDCB)                                0170 00222000
         DR    @14,@12                                             0170 00223000
         ST    @15,CIIOCNT(,RCICB)                                 0170 00224000
*            CIWK1 = CIIOCNT;           /* FOR TEST FOR SHORT BLOCK */  00225000
         ST    @15,CIWK1(,RCICB)                                   0171 00226000
*            GO TO GETIT;               /* GO TO GET MACRO          */  00227000
         B     GETIT                                               0172 00228000
*               END;                    /* END OF DO GROUP          */  00229000
*          ELSE;                        /* UNBLOCKED RECORDS        */  00230000
*                                                                  0174 00231000
@RF00168 DS    0H                                                  0175 00232000
*/*******************************************************************/  00233000
*                                                                  0175 00234000
*                                                                  0175 00235000
*GTCNT:  CIIOCNT = 1;                   /* SET I/O COUNTER TO 1     */  00236000
*                                                                  0175 00237000
*                                                                  0175 00238000
GTCNT    MVC   CIIOCNT(4,RCICB),@CF00061                           0175 00239000
*/*******************************************************************/  00240000
*/*                                                                 */  00241000
*/*            ISSUE JES GET MACRO                                  */  00242000
*/*                                                                 */  00243000
*/*******************************************************************/  00244000
*                                                                  0176 00245000
*                                                                  0176 00246000
*GETIT:  GEN  (GET   RPL=(RRPL));       /* JES GET MACRO            */  00247000
*                                                                  0176 00248000
GETIT    GET   RPL=(RRPL)                                               00249000
*/******AFTER RETURN FROM JES ***************************************/  00250000
*                                                                  0177 00251000
*                                                                  0177 00252000
*                                                                  0177 00253000
*        IF R15 = 0 THEN                /* NORMAL COMPLETION?  Y02082*/ 00254000
         LTR   R15,R15                                             0177 00255000
         BNZ   @RF00177                                            0177 00256000
*          IF DCBRECFM(1:2) = '10'B     /* YES, BUT IF FIXED,  Y02082*/ 00257000
*           & RPLRLEN ¬= RPLBUFL THEN   /* AND NOT EXACT LEN,  Y02082*/ 00258000
         TM    DCBRECFM(RDCB),B'10000000'                          0178 00259000
         BNO   @RF00178                                            0178 00260000
         TM    DCBRECFM(RDCB),B'01000000'                          0178 00261000
         BNZ   @RF00178                                            0178 00262000
         CLC   RPLRLEN(4,RRPL),RPLBUFL(RRPL)                       0178 00263000
         BE    @RF00178                                            0178 00264000
*            DO;                        /* TREAT AS LOGIC ERR. Y02082*/ 00265000
*              RPLRTNCD = '08'X;        /* SET LOGIC ERROR     Y02082*/ 00266000
         MVI   RPLRTNCD(RRPL),X'08'                                0180 00267000
*              RPLERRCD = RPLINBUF;     /* SET WRONG LEN CODE  Y02144*/ 00268000
         MVC   RPLERRCD(1,RRPL),RPLINBUF                           0181 00269000
*            END;                       /*                     Y02082*/ 00270000
*          ELSE                         /* NO ERROR CONDITION  Y02082*/ 00271000
*            DO;                        /* ENCOUNTERED.        Y02082*/ 00272000
         B     @RC00178                                            0183 00273000
@RF00178 DS    0H                                                  0184 00274000
*              DECBCODE = '7F'X;        /* SET NORMAL ECB CODE Y02082*/ 00275000
         MVI   DECBCODE(RDECB),X'7F'                               0184 00276000
*              GO TO RECV;              /* GO CHECK FOR V FMT  Y02082*/ 00277000
         B     RECV                                                0185 00278000
*            END;                       /*                     Y02082*/ 00279000
*        ELSE;                          /* AN ERROR EXISTS     Y02082*/ 00280000
@RF00177 DS    0H                                                  0188 00281000
*        IF RPLRTNCD = '08'X            /* FOR LOGICAL ERRORS, Y02082*/ 00282000
*           & RPLERRCD = RPLEODER THEN  /* DUE TO END OF DATA, Y02144*/ 00283000
@RC00177 CLI   RPLRTNCD(RRPL),8                                    0188 00284000
         BNE   @RF00188                                            0188 00285000
         CLC   RPLERRCD(1,RRPL),RPLEODER                           0188 00286000
         BE    @RT00188                                            0188 00287000
*          GO TO EODADRTN;              /* GO SET UP FOR EODAD Y02082*/ 00288000
*        ELSE                           /* OTHER LOGICAL ERROR Y02082*/ 00289000
*          GO TO QMAPPED;               /* GO SET UP FOR SYNAD Y02082*/ 00290000
*                                                                  0190 00291000
         B     QMAPPED                                             0190 00292000
*/*******************************************************************/  00293000
*                                                                  0191 00294000
*                                                                  0191 00295000
*RECV:   IF DCBRECFM(1:2) = '01'B       /* VARIABLE LENGTH RECORDS  */  00296000
*          THEN DO;                     /* YES, DO FOLLOWING        */  00297000
RECV     TM    DCBRECFM(RDCB),B'01000000'                          0191 00298000
         BNO   @RF00191                                            0191 00299000
         TM    DCBRECFM(RDCB),B'10000000'                          0191 00300000
         BNZ   @RF00191                                            0191 00301000
*            RDW = RPLRLEN + 4;         /* SET LENGTH OF RECORD     */  00302000
         L     @12,RPLAREA(,RRPL)                                  0193 00303000
         LA    @10,4                                               0193 00304000
         L     @09,RPLRLEN(,RRPL)                                  0193 00305000
         ALR   @09,@10                                             0193 00306000
         LR    @06,@12                                             0193 00307000
         AL    @06,@CF00554                                        0193 00308000
         ST    @09,RDW+4(,@06)                                     0193 00309000
*            FILLER = 0;                /* ZERO OUT FILLER          */  00310000
         SLR   @09,@09                                             0194 00311000
         LR    @06,@12                                             0194 00312000
         BCTR  @06,0                                               0194 00313000
         BCTR  @06,0                                               0194 00314000
         STH   @09,FILLER+2(,@06)                                  0194 00315000
*            BDW = RDW + 4;             /* SET LENGTH OF BLOCK      */  00316000
         L     @06,DECAREA(,RDECB)                                 0195 00317000
         AL    @12,@CF00554                                        0195 00318000
         AL    @10,RDW+4(,@12)                                     0195 00319000
         ST    @10,BDW(,@06)                                       0195 00320000
*            FILLERB = 0;               /* ZERO OUT FILLER          */  00321000
         STH   @09,FILLERB(,@06)                                   0196 00322000
*            GO TO REND;                /* BYPASS FOLLOWING TEST    */  00323000
         B     REND                                                0197 00324000
*               END;                    /* END OF DO GROUP          */  00325000
*          ELSE;                        /* NOT VARIABLE LENGTH RCD  */  00326000
*                                                                  0199 00327000
@RF00191 DS    0H                                                  0200 00328000
*/*******************************************************************/  00329000
*                                                                  0200 00330000
*                                                                  0200 00331000
*        CIIOCNT = CIIOCNT - 1;         /* REDUCE I/O COUNTER BY 1  */  00332000
*                                                                  0200 00333000
         L     @12,CIIOCNT(,RCICB)                                 0200 00334000
         BCTR  @12,0                                               0200 00335000
         ST    @12,CIIOCNT(,RCICB)                                 0200 00336000
*        IF CIIOCNT ¬= 0                /* MORE RECORDS             */  00337000
*          THEN DO;                     /* YES                      */  00338000
         LTR   @12,@12                                             0201 00339000
         BZ    @RF00201                                            0201 00340000
*            IF DCBLRECL = 0            /* TEST FOR RECORD LENGTH   */  00341000
*               THEN RPLAREA = RPLAREA + DCBBLKSI;/* USE BLKSIZE    */  00342000
         ICM   @12,3,DCBLRECL(RDCB)                                0203 00343000
         BNZ   @RF00203                                            0203 00344000
         SLR   @12,@12                                             0204 00345000
         ICM   @12,3,DCBBLKSI(RDCB)                                0204 00346000
         AL    @12,RPLAREA(,RRPL)                                  0204 00347000
         ST    @12,RPLAREA(,RRPL)                                  0204 00348000
*               ELSE RPLAREA = RPLAREA + DCBLRECL;/* USE RCD LENGTH */  00349000
         B     @RC00203                                            0205 00350000
@RF00203 SLR   @12,@12                                             0205 00351000
         ICM   @12,3,DCBLRECL(RDCB)                                0205 00352000
         AL    @12,RPLAREA(,RRPL)                                  0205 00353000
         ST    @12,RPLAREA(,RRPL)                                  0205 00354000
*            GO TO GETIT;               /* GET ANOTHER RECORD       */  00355000
         B     GETIT                                               0206 00356000
*               END;                    /* END OF DO GROUP          */  00357000
*          ELSE;                        /* NO MORE RECORDS          */  00358000
*                                                                  0208 00359000
@RF00201 DS    0H                                                  0209 00360000
*/*******************************************************************/  00361000
*/*   TEST FOR FIXED BLOCKED RECORDS AND DCBNCP NOT EQUAL TO @ZA29473*/ 00362000
*/*   ONE AND IF FOUND - PLACE RESIDUAL COUNT IN PSEUSE IOB  @ZA29473*/ 00363000
*/********************************************************** @ZA29473*/ 00364000
*                                                                  0209 00365000
*REND:   IF DCBRECFM(1:2) = '10'B & DCBRECFM(4)   = '1'B/*         0209 00366000
*                                          IF FIXED BLOCK RECORDS    */ 00367000
*        & DCBNCP >  '01'X              /* GO STORE RESIDUAL @ZA29473*/ 00368000
*             THEN GO TO FIXBLOCK;      /* IN PSEUDO IOB     @ZA29473*/ 00369000
REND     TM    DCBRECFM(RDCB),B'10000000'                          0209 00370000
         BNO   @RF00209                                            0209 00371000
         TM    DCBRECFM(RDCB),B'01000000'                          0209 00372000
         BNZ   @RF00209                                            0209 00373000
         TM    DCBRECFM(RDCB),B'00010000'                          0209 00374000
         BNO   @RF00209                                            0209 00375000
         CLI   DCBNCP(RDCB),1                                      0209 00376000
         BH    @RT00209                                            0209 00377000
*        IF DCBRECFM(1:2) = '10'B & DCBRECFM(4)   = '1'B/*         0211 00378000
*                                                            @ZA29473*/ 00379000
*          THEN DECRESDU = RPLRLEN * CIIOCNT;                      0211 00380000
@RF00209 TM    DCBRECFM(RDCB),B'10000000'                          0211 00381000
         BNO   @RF00211                                            0211 00382000
         TM    DCBRECFM(RDCB),B'01000000'                          0211 00383000
         BNZ   @RF00211                                            0211 00384000
         TM    DCBRECFM(RDCB),B'00010000'                          0211 00385000
         BNO   @RF00211                                            0211 00386000
         L     @15,RPLRLEN(,RRPL)                                  0212 00387000
         M     @14,CIIOCNT(,RCICB)                                 0212 00388000
         STH   @15,DECRESDU(,RDECB)                                0212 00389000
*          ELSE DECRESDU = DCBBLKSI - RPLRLEN;                     0213 00390000
*                                                                  0213 00391000
         B     @RC00211                                            0213 00392000
@RF00211 SLR   @12,@12                                             0213 00393000
         ICM   @12,3,DCBBLKSI(RDCB)                                0213 00394000
         SL    @12,RPLRLEN(,RRPL)                                  0213 00395000
         STH   @12,DECRESDU(,RDECB)                                0213 00396000
*        IF DECRESDU < '0000'X          /* TEST IF NEGATIVE         */  00397000
*          THEN DECRESDU = '0000'X;     /* SET TO ZERO VALUE        */  00398000
*                                                                  0214 00399000
@RC00211 CLC   DECRESDU(2,RDECB),@CB00519                          0214 00400000
         BNL   @RF00214                                            0214 00401000
         MVC   DECRESDU(2,RDECB),@CB00519                          0215 00402000
*        CIRESID = DECRESDU;            /* COUNT INTO DUMY IOB Y02082*/ 00403000
@RF00214 SLR   @12,@12                                             0216 00404000
         ICM   @12,3,DECRESDU(RDECB)                               0216 00405000
         ST    @12,CIRESID(,RCICB)                                 0216 00406000
*        DECIOBPT = ADDR(CIIOB);        /* POINT DECB TO 'IOB' Y02082*/ 00407000
*                                                                  0217 00408000
         LA    @12,CIIOB(,RCICB)                                   0217 00409000
         ST    @12,DECIOBPT(,RDECB)                                0217 00410000
*        GO TO EXIT;                    /* RETURN TO REQUESTOR      */  00411000
         B     EXIT                                                0218 00412000
*FIXBLOCK:                              /*                   @ZA29473*/ 00413000
*         DECRESDU = RPLRLEN * CIIOCNT; /*SAVE RESIDUAL CNT  @ZA29473*/ 00414000
FIXBLOCK L     @15,RPLRLEN(,RRPL)                                  0219 00415000
         M     @14,CIIOCNT(,RCICB)                                 0219 00416000
         STH   @15,DECRESDU(,RDECB)                                0219 00417000
*         CIRESID  = DUMMYPTR;          /*POINT TO NEXT IOB  @ZA29473*/ 00418000
         L     @12,CIRESID(,RCICB)                                 0220 00419000
         L     @12,DUMMYPTR(,@12)                                  0220 00420000
         ST    @12,CIRESID(,RCICB)                                 0220 00421000
*         DUMMYCNT = DECRESDU;          /*STORE CNT IN IOB   @ZA29473*/ 00422000
         ST    @15,DUMMYCNT(,@12)                                  0221 00423000
*         DECIOBPT = ADDR(DUMMYIOB);    /*POINT DECB TO IOB  @ZA29473*/ 00424000
         LA    @12,DUMMYIOB(,@12)                                  0222 00425000
         ST    @12,DECIOBPT(,RDECB)                                0222 00426000
*         GO TO EXIT;                   /*RETURN TO REQUESTOR@ZA29473*/ 00427000
         B     EXIT                                                0223 00428000
*/*******************************************************************/  00429000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00430000
         EJECT                                                          00431000
*                                                                  0225 00432000
*                                                                  0225 00433000
*/*******************************************************************/  00434000
*/*                                                                 */  00435000
*/*                 JES TRANSLATOR BSAM WRITE ROUTINE               */  00436000
*/*                                                                 */  00437000
*/*******************************************************************/  00438000
*                                                                  0225 00439000
*                                                                  0225 00440000
*WRITERTN: ;                            /* ENTRY TO WRITE ROUTINE   */  00441000
*                                                                  0225 00442000
WRITERTN DS    0H                                                  0226 00443000
*        DECSDECB=0;                    /* ZERO OUT ENTIRE ECB      */  00444000
*                                                                  0226 00445000
         SLR   @12,@12                                             0226 00446000
         ST    @12,DECSDECB(,RDECB)                                0226 00447000
*        RPLAREA = DECAREA;             /* INIT RPL I/O AREA FIELD  */  00448000
*                                                                  0227 00449000
         MVC   RPLAREA(4,RRPL),DECAREA(RDECB)                      0227 00450000
*        RPLDECB = RDECB;               /* RPL PTR TO DECB          */  00451000
*                                                                  0228 00452000
         ST    RDECB,RPLDECB(,RRPL)                                0228 00453000
*/*******************************************************************/  00454000
*                                                                  0229 00455000
*        IF DCBRECFM(1:2) = '11'B       /* UNDEFINED RECORDS        */  00456000
*          THEN IF DECTYP(1) = '1'B     /* LENGTH SPECIFIED AS 'S'  */  00457000
         TM    DCBRECFM(RDCB),B'11000000'                          0229 00458000
         BNO   @RF00229                                            0229 00459000
*            THEN DO;                   /* YES                      */  00460000
         TM    DECTYP(RDECB),B'10000000'                           0230 00461000
         BNO   @RF00230                                            0230 00462000
*              RPLRLEN = DCBBLKSI;      /* GET LENGTH FROM BLOCKSIZE*/  00463000
         SLR   @12,@12                                             0232 00464000
         ICM   @12,3,DCBBLKSI(RDCB)                                0232 00465000
         ST    @12,RPLRLEN(,RRPL)                                  0232 00466000
*              GO TO WRCNT;             /* PUT ONE RECORD           */  00467000
         B     WRCNT                                               0233 00468000
*                 END;                  /* END OF DO GROUP          */  00469000
*            ELSE DO;                   /* OTHERWISE                */  00470000
@RF00230 DS    0H                                                  0236 00471000
*              RPLRLEN = DECLNGTH;      /* GET LENGTH FROM DECB     */  00472000
         LH    @12,DECLNGTH(,RDECB)                                0236 00473000
         ST    @12,RPLRLEN(,RRPL)                                  0236 00474000
*              GO TO WRCNT;             /* PUT ONE RECORD           */  00475000
         B     WRCNT                                               0237 00476000
*                 END;                  /* END OF DO GROUP          */  00477000
*          ELSE;                        /* NOT UNDEFINED RECORDS    */  00478000
*                                                                  0239 00479000
@RF00229 DS    0H                                                  0240 00480000
*        IF DCBRECFM(1:2) = '10'B       /* FIXED LENGTH RECORD      */  00481000
*          THEN DO;                     /* YES                      */  00482000
         TM    DCBRECFM(RDCB),B'10000000'                          0240 00483000
         BNO   @RF00240                                            0240 00484000
         TM    DCBRECFM(RDCB),B'01000000'                          0240 00485000
         BNZ   @RF00240                                            0240 00486000
*            RPLRLEN = DCBBLKSI;        /* GET LENGTH FROM BLOCKSIZE*/  00487000
         SLR   @12,@12                                             0242 00488000
         ICM   @12,3,DCBBLKSI(RDCB)                                0242 00489000
         ST    @12,RPLRLEN(,RRPL)                                  0242 00490000
*            IF DCBRECFM(4)   = '1'B    /* BLOCKED RECORD FORMAT    */  00491000
*              THEN DO;                 /* YES                      */  00492000
         TM    DCBRECFM(RDCB),B'00010000'                          0243 00493000
         BNO   @RF00243                                            0243 00494000
*                RPLRLEN = DCBLRECL;    /* GET LENGTH FROM DCBLRECL */  00495000
         SLR   @10,@10                                             0245 00496000
         ICM   @10,3,DCBLRECL(RDCB)                                0245 00497000
         ST    @10,RPLRLEN(,RRPL)                                  0245 00498000
*                CIIOCNT = DCBBLKSI/DCBLRECL;  /* DETERMINE COUNTER */  00499000
         LR    @15,@12                                             0246 00500000
         SLR   @14,@14                                             0246 00501000
         DR    @14,@10                                             0246 00502000
         ST    @15,CIIOCNT(,RCICB)                                 0246 00503000
*                GO TO WRITIT;          /* GO TO TEST CONTROL CHAR  */  00504000
         B     WRITIT                                              0247 00505000
*                   END;                /* END OF DO GROUP          */  00506000
*              ELSE GO TO WRCNT;        /* UNBLOCKED RECORD FORMAT  */  00507000
*               END;                    /* END OF DO GROUP          */  00508000
*          ELSE;                        /* NOT FIXED OR FIXED BLOCK */  00509000
*                                                                  0251 00510000
@RF00240 DS    0H                                                  0252 00511000
*/*******************************************************************/  00512000
*                                                                  0252 00513000
*        /* VARIABLE LENGTH SPANNED RECORDS ?                       */  00514000
*        IF DCBRECFM(1:2)='01'B & DCBRECFM(5)='1'B THEN            0252 00515000
*                                                                  0252 00516000
         TM    DCBRECFM(RDCB),B'01000000'                          0252 00517000
         BNO   @RF00252                                            0252 00518000
         TM    DCBRECFM(RDCB),B'10000000'                          0252 00519000
         BNZ   @RF00252                                            0252 00520000
         TM    DCBRECFM(RDCB),B'00001000'                          0252 00521000
         BNO   @RF00252                                            0252 00522000
*          DO;                          /* YES PROCESS VS RECORDS    */ 00523000
*            IF BDWLL > DCBBLKSI THEN   /* BDW GT BLKSIZE?    XA01441*/ 00524000
         L     @12,DECAREA(,RDECB)                                 0254 00525000
         SLR   @10,@10                                             0254 00526000
         ICM   @10,3,DCBBLKSI(RDCB)                                0254 00527000
         CH    @10,BDWLL(,@12)                                     0254 00528000
         BL    @RT00254                                            0254 00529000
*              GO TO ABEND;             /* BAD BDW, TERMINATE XA01441*/ 00530000
*                                                                  0255 00531000
*            RPLAREA = RPLAREA + 8;     /* ADJUST PTR TO RPLAREA    */  00532000
*                                                                  0256 00533000
         LA    @12,8                                               0256 00534000
         AL    @12,RPLAREA(,RRPL)                                  0256 00535000
         ST    @12,RPLAREA(,RRPL)                                  0256 00536000
*            IF CIFVSRI = '0'B          /* INCOMPLETE RECORD BEING 0257 00537000
*                                          PROCESSED ?              */  00538000
*              THEN                     /* NO                       */  00539000
         TM    CIFVSRI(RCICB),B'00010000'                          0257 00540000
         BNZ   @RF00257                                            0257 00541000
*                CIRECPTR = CIRAREA;    /* PTR TO RECORD AREA       */  00542000
         MVC   CIRECPTR(4,RCICB),CIRAREA(RCICB)                    0258 00543000
*              ELSE;                    /* PROCESSING INCOMPLETE   0259 00544000
*                                          RECORD                   */  00545000
@RF00257 DS    0H                                                  0260 00546000
*            CIFVSRI = '0'B;            /* RESET INCOMPL RECORD FLG */  00547000
*                                                                  0260 00548000
         NI    CIFVSRI(RCICB),B'11101111'                          0260 00549000
*            CIBLKPTR = RPLAREA - 8;    /* PTR TO USER BLOCK        */  00550000
         L     @12,RPLAREA(,RRPL)                                  0261 00551000
         SH    @12,@CH00059                                        0261 00552000
         ST    @12,CIBLKPTR(,RCICB)                                0261 00553000
*CONTIN01:   CISEGLEN = RDWLL - 4;      /* GET SEGMENT LENGTH       */  00554000
*                                                                  0262 00555000
CONTIN01 L     @12,RPLAREA(,RRPL)                                  0262 00556000
         AL    @12,@CF00554                                        0262 00557000
         LH    @12,RDWLL+4(,@12)                                   0262 00558000
         SH    @12,@CH00147                                        0262 00559000
         ST    @12,CISEGLEN(,RCICB)                                0262 00560000
*            IF CIRECPTR = CIRAREA + CILWAREA  /* IS REC AREA FILLED*/  00561000
*              THEN GO TO NOMOVE;       /* YES, DONT MOVE SEGMENT IN*/  00562000
         L     @10,CIRECPTR(,RCICB)                                0263 00563000
         L     @09,CIRAREA(,RCICB)                                 0263 00564000
         AL    @09,CILWAREA(,RCICB)                                0263 00565000
         CR    @10,@09                                             0263 00566000
         BE    @RT00263                                            0263 00567000
*                                       /* NO, WILL ENTIRE SEG FIT ?*/  00568000
*            RWORK = CIRECPTR + CISEGLEN; /* CALC SPACE NEEDED      */  00569000
         ALR   @12,@10                                             0265 00570000
         LR    RWORK,@12                                           0265 00571000
*            IF RWORK > CIRAREA + CILWAREA /* DOES IT FIT IN AREA?  */  00572000
*              THEN                     /* NO, FILL IN WHAT FITS    */  00573000
         CR    RWORK,@09                                           0266 00574000
         BNH   @RF00266                                            0266 00575000
*                CISEGLEN = CIRAREA + CILWAREA - CIRECPTR;         0267 00576000
*                                                                  0267 00577000
         SLR   @09,@10                                             0267 00578000
         ST    @09,CISEGLEN(,RCICB)                                0267 00579000
*/******MOVE SEGMENT TO RECORD AREA**********************************/  00580000
*         GEN;                                                     0268 00581000
@RF00266 DS    0H                                                  0268 00582000
             L    R14,RPLAREA(,RRPL)                 /*     @ZA09150*/  00583000
             LR   R0,R11                             /*     @ZA09150*/  00584000
             L    R15,CISEGLEN(,RCICB)               /*     @ZA09150*/  00585000
             LR   R11,R15                            /*     @ZA09150*/  00586000
             L    R10,CIRECPTR(,RCICB)               /*     @ZA09150*/  00587000
             MVCL R10,R14                            /*     @ZA09150*/  00588000
             LR   R11,R0                             /*     @ZA09150*/  00589000
             LR   R0,R0                              /*     @ZA09150*/  00590000
*            CIRECPTR = CIRECPTR + CISEGLEN; /* UPDATE SEGMENT PTR  */  00591000
         L     @12,CISEGLEN(,RCICB)                                0269 00592000
         L     @10,CIRECPTR(,RCICB)                                0269 00593000
         ALR   @10,@12                                             0269 00594000
         ST    @10,CIRECPTR(,RCICB)                                0269 00595000
*            RPLRLEN = RPLRLEN + CISEGLEN; /* UPDATE RECORD LENGTH  */  00596000
*                                                                  0270 00597000
         AL    @12,RPLRLEN(,RRPL)                                  0270 00598000
         ST    @12,RPLRLEN(,RRPL)                                  0270 00599000
*/******IS THIS END OF BLOCK ****************************************/  00600000
*NOMOVE:                                                           0271 00601000
*            RWORK = RPLAREA + RDWLL;   /* CALC END OF THIS SEGMENT */  00602000
NOMOVE   L     @12,RPLAREA(,RRPL)                                  0271 00603000
         LR    @10,@12                                             0271 00604000
         AL    @10,@CF00554                                        0271 00605000
         LH    RWORK,RDWLL+4(,@10)                                 0271 00606000
         ALR   RWORK,@12                                           0271 00607000
*            IF RWORK = CIBLKPTR + BDWLL + 4  /* IS IT ALSO EOB?    */  00608000
*              THEN                     /* YES, END OF BLOCK        */  00609000
         L     @10,DECAREA(,RDECB)                                 0272 00610000
         LH    @10,BDWLL(,@10)                                     0272 00611000
         AL    @10,CIBLKPTR(,RCICB)                                0272 00612000
         AH    @10,@CH00147                                        0272 00613000
         CR    RWORK,@10                                           0272 00614000
         BNE   @RF00272                                            0272 00615000
*                DO;                                               0273 00616000
*                /* COMPLETE RECORD OR LAST SEGMENT OF RECORD       */  00617000
*                IF SEGCC = '00'X | SEGCC = '02'X                  0274 00618000
*                  THEN DO;             /* YES                      */  00619000
         LR    @10,@12                                             0274 00620000
         BCTR  @10,0                                               0274 00621000
         BCTR  @10,0                                               0274 00622000
         CLI   SEGCC+2(@10),X'00'                                  0274 00623000
         BE    @RT00274                                            0274 00624000
         BCTR  @12,0                                               0274 00625000
         BCTR  @12,0                                               0274 00626000
         CLI   SEGCC+2(@12),X'02'                                  0274 00627000
         BNE   @RF00274                                            0274 00628000
@RT00274 DS    0H                                                  0275 00629000
*                    CIFVSEOB = '1'B;   /* INDICATE END OF BLOCK    */  00630000
         OI    CIFVSEOB(RCICB),B'00001000'                         0276 00631000
*                    GO TO CONTIN02;    /* RECORD READY FOR WRITE   */  00632000
         B     CONTIN02                                            0277 00633000
*                       END;            /* END OF DO GROUP          */  00634000
*                  ELSE DO;             /* NOT COMPLETE RECORD NOR 0279 00635000
*                                          LAST SEGMENT             */  00636000
@RF00274 DS    0H                                                  0280 00637000
*                    CIFVSRI = '1'B;    /* INDICATE INCOMPLETE RECD */  00638000
         OI    CIFVSRI(RCICB),B'00010000'                          0280 00639000
*                    DECBCODE = '7F'X;  /* POST AS COMPLETE W/NO ER */  00640000
         MVI   DECBCODE(RDECB),X'7F'                               0281 00641000
*                    GO TO EXIT;        /* WAIT FOR NEXT BLOCK      */  00642000
         B     EXIT                                                0282 00643000
*                       END;            /* END OF DO GROUP          */  00644000
*                END;                   /* DO GROUP-NOT LAST SEG    */  00645000
*              ELSE;                    /* NOT END OF BLOCK         */  00646000
@RF00272 DS    0H                                                  0286 00647000
*              /* IS POINTER WITHIN BOUNDS ?                        */  00648000
*              RWORK = RPLAREA + RDWLL; /* CALC END OF SEGMENT      */  00649000
         L     @12,RPLAREA(,RRPL)                                  0286 00650000
         LR    @10,@12                                             0286 00651000
         AL    @10,@CF00554                                        0286 00652000
         LH    @10,RDWLL+4(,@10)                                   0286 00653000
         ALR   @10,@12                                             0286 00654000
         LR    RWORK,@10                                           0286 00655000
*              IF RWORK > CIBLKPTR + BDWLL + 4 THEN   /* TOO LONG?  */  00656000
         L     @12,DECAREA(,RDECB)                                 0287 00657000
         LH    @12,BDWLL(,@12)                                     0287 00658000
         AL    @12,CIBLKPTR(,RCICB)                                0287 00659000
         AH    @12,@CH00147                                        0287 00660000
         CR    RWORK,@12                                           0287 00661000
         BH    @RT00287                                            0287 00662000
*                                       /* POINTER NOT WITHIN BOUNDS*/  00663000
*                  GO TO ABEND;         /* ISSUE ABEND FOR USER     */  00664000
*              ELSE;                    /* POINTER IS WITHIN BOUNDS */  00665000
*                                                                  0289 00666000
*              CIRECPTR = RPLAREA + RDWLL;/* UPDATE RECORD PTR      */  00667000
         ST    @10,CIRECPTR(,RCICB)                                0290 00668000
*CONTIN02:     RPLAREA = CIRAREA;       /* SAVE AREA POINTER        */  00669000
CONTIN02 MVC   RPLAREA(4,RRPL),CIRAREA(RCICB)                      0291 00670000
*              GO TO WRITIT;            /* GO WRITE RECORD          */  00671000
*                                                                  0292 00672000
         B     WRITIT                                              0292 00673000
*CONTIN03:     RPLAREA = CIRECPTR;      /* RESTORE RECORD POINTER   */  00674000
CONTIN03 MVC   RPLAREA(4,RRPL),CIRECPTR(RCICB)                     0293 00675000
*              RPLRLEN = 0;             /* INITIALIZE RECORD LENGTH */  00676000
         SLR   @12,@12                                             0294 00677000
         ST    @12,RPLRLEN(,RRPL)                                  0294 00678000
*              CIRECPTR = CIRAREA;      /* INITIALIZE RECORD PTR    */  00679000
         MVC   CIRECPTR(4,RCICB),CIRAREA(RCICB)                    0295 00680000
*              GO TO CONTIN01;          /* CONTINUE WITH BLOCK      */  00681000
         B     CONTIN01                                            0296 00682000
*          END;                         /* END OF SPANNED RCD GROUP */  00683000
*                                                                  0297 00684000
*/*******************************************************************/  00685000
*                                       /* NOT VARIABLE SPANNED     */  00686000
*        IF DCBRECFM(1:2) = '01'B THEN  /* VARIABLE LENGTH RECORD ? */  00687000
@RF00252 TM    DCBRECFM(RDCB),B'01000000'                          0298 00688000
         BNO   @RF00298                                            0298 00689000
         TM    DCBRECFM(RDCB),B'10000000'                          0298 00690000
         BNZ   @RF00298                                            0298 00691000
*          DO;                          /* YES                      */  00692000
*            IF BDWLL > DCBBLKSI THEN   /* IS BDW TOO BIG?    XA01441*/ 00693000
         L     @12,DECAREA(,RDECB)                                 0300 00694000
         LH    @12,BDWLL(,@12)                                     0300 00695000
         SLR   @10,@10                                             0300 00696000
         ICM   @10,3,DCBBLKSI(RDCB)                                0300 00697000
         CR    @12,@10                                             0300 00698000
         BH    @RT00300                                            0300 00699000
*              GO TO ABEND;             /* YES, TERMINATE     XA01441*/ 00700000
*            RPLAREA = RPLAREA + 8;     /* SET POINTER > BDW & RDW  */  00701000
         LA    @10,8                                               0302 00702000
         AL    @10,RPLAREA(,RRPL)                                  0302 00703000
         ST    @10,RPLAREA(,RRPL)                                  0302 00704000
*            RPLRLEN = RDWLL - 4;       /* GET LENGTH FROM RDWLL    */  00705000
         LA    @09,4                                               0303 00706000
         AL    @10,@CF00554                                        0303 00707000
         LH    @10,RDWLL+4(,@10)                                   0303 00708000
         LR    @06,@10                                             0303 00709000
         SLR   @06,@09                                             0303 00710000
         ST    @06,RPLRLEN(,RRPL)                                  0303 00711000
*            CIIOCNT = RDWLL;           /* SET RECORD LENGTH        */  00712000
         ST    @10,CIIOCNT(,RCICB)                                 0304 00713000
*            CISAMWA = BDWLL - 4;       /* SET BLOCK LENGTH         */  00714000
         SLR   @12,@09                                             0305 00715000
         ST    @12,CISAMWA(,RCICB)                                 0305 00716000
*            GO TO WRITIT;              /* GO TO TEST CONTROL CHAR  */  00717000
         B     WRITIT                                              0306 00718000
*          END;                         /* END OF DO GROUP          */  00719000
*        ELSE                           /* LOGICAL ERROR-NO RECFM   */  00720000
*          RPLRLEN = DCBBLKSI;          /* ASSUME U,TYPE S          */  00721000
*                                                                  0308 00722000
@RF00298 SLR   @12,@12                                             0308 00723000
         ICM   @12,3,DCBBLKSI(RDCB)                                0308 00724000
         ST    @12,RPLRLEN(,RRPL)                                  0308 00725000
*/*******************************************************************/  00726000
*                                                                  0309 00727000
*WRCNT:  CIIOCNT = 1;                   /* SET I/O COUNTER TO 1.    */  00728000
*                                                                  0309 00729000
WRCNT    MVC   CIIOCNT(4,RCICB),@CF00061                           0309 00730000
*/*******************************************************************/  00731000
*/*                                                                 */  00732000
*/*            ISSUE JES PUT MACRO                                  */  00733000
*/*                                                                 */  00734000
*/*******************************************************************/  00735000
*                                                                  0310 00736000
*                                       /* CARRIAGE CONTROL CHAR    */  00737000
*WRITIT: IF DCBRECFM(6:7)='10'B | DCBRECFM(6:7)='01'B  /* SPECIFIED */  00738000
*              THEN DO;                 /* YES                      */  00739000
WRITIT   TM    DCBRECFM(RDCB),B'00000100'                          0310 00740000
         BNO   @GL00008                                            0310 00741000
         TM    DCBRECFM(RDCB),B'00000010'                          0310 00742000
         BZ    @RT00310                                            0310 00743000
@GL00008 TM    DCBRECFM(RDCB),B'00000010'                          0310 00744000
         BNO   @RF00310                                            0310 00745000
         TM    DCBRECFM(RDCB),B'00000100'                          0310 00746000
         BNZ   @RF00310                                            0310 00747000
@RT00310 DS    0H                                                  0311 00748000
*                   RPLCCHAR = RPLAREA;  /* POINTER TO CONTROL CHAR */  00749000
         L     @12,RPLAREA(,RRPL)                                  0312 00750000
         ST    @12,RPLCCHAR(,RRPL)                                 0312 00751000
*                   RPLAREA  = RPLAREA + 1;  /* SET PTR > CTL CHAR  */  00752000
         AL    @12,@CF00061                                        0313 00753000
         ST    @12,RPLAREA(,RRPL)                                  0313 00754000
*                   RPLRLEN  = RPLRLEN - 1;  /* REDUCE LENGTH BY 1  */  00755000
         L     @12,RPLRLEN(,RRPL)                                  0314 00756000
         BCTR  @12,0                                               0314 00757000
         ST    @12,RPLRLEN(,RRPL)                                  0314 00758000
*                   END;                                           0315 00759000
*              ELSE;                    /* NO CONTROL CHARACTER     */  00760000
*                                                                  0316 00761000
@RF00310 DS    0H                                                  0317 00762000
*/*******************************************************************/  00763000
*                                                                  0317 00764000
*        GEN (PUT   RPL=(RRPL));        /* JES PUT MACRO            */  00765000
         PUT   RPL=(RRPL)                                               00766000
*/*******************************************************************/  00767000
*                                                                  0318 00768000
*                                                                  0318 00769000
*                                                                  0318 00770000
*        IF R15 ¬= 0 THEN               /* TEST FOR ANY ERRORS       */ 00771000
         LTR   R15,R15                                             0318 00772000
         BZ    @RF00318                                            0318 00773000
*          DO;                          /* JES DETECTED AN ERROR     */ 00774000
*            DECBCODE = '41'X;          /* POST ECB IN ERROR         */ 00775000
         MVI   DECBCODE(RDECB),X'41'                               0320 00776000
*            DECBCOND = ERR3;           /* SET BSAM WRITE ERR  Y02144*/ 00777000
         MVC   DECBCOND(1,RDECB),ERR3                              0321 00778000
*            GO TO EXIT;                /* RETURN TO USER     ZA02178*/ 00779000
         B     EXIT                                                0322 00780000
*          END;                                                    0323 00781000
*        ELSE                           /* WRITE WAS OK              */ 00782000
*          DECBCODE = '7F'X;            /* POST ECB AS NORMAL        */ 00783000
*                                                                  0324 00784000
@RF00318 MVI   DECBCODE(RDECB),X'7F'                               0324 00785000
*/*******************************************************************/  00786000
*                                                                  0325 00787000
*        IF DCBRECFM(1:2) = '01'B & DCBRECFM(5)   = '1'B THEN/*    0325 00788000
*                                          VAR LENGTH SPANNED RCDS  */  00789000
*                                                                  0325 00790000
         TM    DCBRECFM(RDCB),B'01000000'                          0325 00791000
         BNO   @RF00325                                            0325 00792000
         TM    DCBRECFM(RDCB),B'10000000'                          0325 00793000
         BNZ   @RF00325                                            0325 00794000
         TM    DCBRECFM(RDCB),B'00001000'                          0325 00795000
         BNO   @RF00325                                            0325 00796000
*          DO;                          /* YES                      */  00797000
*            RPLRLEN = 0;               /* INITIALIZE RECORD LENGTH */  00798000
         SLR   @12,@12                                             0327 00799000
         ST    @12,RPLRLEN(,RRPL)                                  0327 00800000
*            IF CIFVSEOB = '1'B THEN    /* IS IT END OF BLOCK ?     */  00801000
         TM    CIFVSEOB(RCICB),B'00001000'                         0328 00802000
         BNO   @RF00328                                            0328 00803000
*              DO;                      /* YES                      */  00804000
*                CIFVSEOB = '0'B;       /* RESET END OF BLOCK FLAG  */  00805000
         NI    CIFVSEOB(RCICB),B'11110111'                         0330 00806000
*                GO TO EXIT;            /* WAIT FOR NEXT BLOCK      */  00807000
         B     EXIT                                                0331 00808000
*              END;                     /* END OF EOB GROUP         */  00809000
*            ELSE                       /* NOT END OF BLOCK         */  00810000
*              GO TO CONTIN03;          /* PROCESS NEXT SEGMENT     */  00811000
*          END;                         /* END OF SPANNED RECD GROUP*/  00812000
*        ELSE;                          /* NOT SPANNED RECORDS      */  00813000
*                                                                  0335 00814000
@RF00325 DS    0H                                                  0336 00815000
*        IF DCBRECFM(1:2) = '01'B THEN  /* VARIABLE LENGTH RECORDS  */  00816000
         TM    DCBRECFM(RDCB),B'01000000'                          0336 00817000
         BNO   @RF00336                                            0336 00818000
         TM    DCBRECFM(RDCB),B'10000000'                          0336 00819000
         BNZ   @RF00336                                            0336 00820000
*          DO;                          /* YES, DO FOLLOWING        */  00821000
*            CISAMWA = CISAMWA - CIIOCNT;/* REDUCE BLOCK COUNT      */  00822000
         L     @12,CISAMWA(,RCICB)                                 0338 00823000
         SL    @12,CIIOCNT(,RCICB)                                 0338 00824000
         ST    @12,CISAMWA(,RCICB)                                 0338 00825000
*            IF CISAMWA =< 0 THEN       /* TEST IF MORE TO WRITE    */  00826000
         LTR   @12,@12                                             0339 00827000
         BNP   @RT00339                                            0339 00828000
*              GO TO EXIT;              /* NO, PROCESSING COMPLETE  */  00829000
*            ELSE                       /* YES, DO FOLLOWING        */  00830000
*              DO;                      /* MORE DATA TO WRITE       */  00831000
*                RPLAREA = RPLAREA + RPLRLEN + 4;/* POINT PAST RCD  */  00832000
         LA    @12,4                                               0342 00833000
         L     @10,RPLAREA(,RRPL)                                  0342 00834000
         AL    @10,RPLRLEN(,RRPL)                                  0342 00835000
         ALR   @10,@12                                             0342 00836000
         ST    @10,RPLAREA(,RRPL)                                  0342 00837000
*                RPLRLEN = RDWLL - 4;   /* SUBTRACT LENGTH OF RDWLL */  00838000
         AL    @10,@CF00554                                        0343 00839000
         LH    @10,RDWLL+4(,@10)                                   0343 00840000
         LCR   @12,@12                                             0343 00841000
         ALR   @12,@10                                             0343 00842000
         ST    @12,RPLRLEN(,RRPL)                                  0343 00843000
*                CIIOCNT = RDWLL;       /* SET TO RECORD LENGTH     */  00844000
         ST    @10,CIIOCNT(,RCICB)                                 0344 00845000
*                GO TO WRITIT;          /* GO TO TEST CONTROL CHAR  */  00846000
         B     WRITIT                                              0345 00847000
*              END;                     /* END OF DO GROUP          */  00848000
*          END;                         /* END OF DO GROUP          */  00849000
*                                                                  0347 00850000
*        ELSE;                          /* NOT VARIABLE RECORDS     */  00851000
@RF00336 DS    0H                                                  0349 00852000
*        CIIOCNT = CIIOCNT - 1;         /* DECREMENT COUNT          */  00853000
         L     @12,CIIOCNT(,RCICB)                                 0349 00854000
         BCTR  @12,0                                               0349 00855000
         ST    @12,CIIOCNT(,RCICB)                                 0349 00856000
*        IF CIIOCNT ¬= 0 THEN           /* FIXED BLOCKED | UNBLOCKED*/  00857000
         LTR   @12,@12                                             0350 00858000
         BZ    @RF00350                                            0350 00859000
*          DO;                          /* FIXED LENGTH BLOCKED     */  00860000
*            IF DCBLRECL = 0 THEN       /* USE LRECL OR BLKSIZE     */  00861000
         ICM   @12,3,DCBLRECL(RDCB)                                0352 00862000
         BNZ   @RF00352                                            0352 00863000
*              RPLAREA = RPLAREA + DCBBLKSI;  /* BLOCKSIZE          */  00864000
         SLR   @12,@12                                             0353 00865000
         ICM   @12,3,DCBBLKSI(RDCB)                                0353 00866000
         AL    @12,RPLAREA(,RRPL)                                  0353 00867000
         ST    @12,RPLAREA(,RRPL)                                  0353 00868000
*            ELSE                                                  0354 00869000
*              RPLAREA = RPLAREA + DCBLRECL;  /* USE LRECL          */  00870000
         B     @RC00352                                            0354 00871000
@RF00352 SLR   @12,@12                                             0354 00872000
         ICM   @12,3,DCBLRECL(RDCB)                                0354 00873000
         AL    @12,RPLAREA(,RRPL)                                  0354 00874000
         ST    @12,RPLAREA(,RRPL)                                  0354 00875000
*            /* CARRIAGE CONTROL CHARACTER SPECIFIED ?              */  00876000
*            IF DCBRECFM(6:7)='10'B | DCBRECFM(6:7)='01'B THEN     0355 00877000
@RC00352 TM    DCBRECFM(RDCB),B'00000100'                          0355 00878000
         BNO   @GL00010                                            0355 00879000
         TM    DCBRECFM(RDCB),B'00000010'                          0355 00880000
         BZ    @RT00355                                            0355 00881000
@GL00010 TM    DCBRECFM(RDCB),B'00000010'                          0355 00882000
         BNO   @RF00355                                            0355 00883000
         TM    DCBRECFM(RDCB),B'00000100'                          0355 00884000
         BNZ   @RF00355                                            0355 00885000
@RT00355 DS    0H                                                  0356 00886000
*              DO;                      /* YES, CONTROL CHARACTER   */  00887000
*                RPLAREA = RPLAREA - 1; /* REPOSITION RPLAREA       */  00888000
         L     @12,RPLAREA(,RRPL)                                  0357 00889000
         BCTR  @12,0                                               0357 00890000
         ST    @12,RPLAREA(,RRPL)                                  0357 00891000
*                RPLRLEN = RPLRLEN +1;  /* RESTORE LENGTH           */  00892000
         LA    @12,1                                               0358 00893000
         AL    @12,RPLRLEN(,RRPL)                                  0358 00894000
         ST    @12,RPLRLEN(,RRPL)                                  0358 00895000
*              END;                                                0359 00896000
*            GO TO WRITIT;              /* PUT ANOTHER RECORD       */  00897000
         B     WRITIT                                              0360 00898000
*          END;                         /* END OF DO GROUP          */  00899000
*        ELSE;                          /* UNBLOCKED                */  00900000
*                                                                  0362 00901000
@RF00350 DS    0H                                                  0363 00902000
*        GO TO EXIT;                    /* RETURN TO REQUESTOR      */  00903000
         B     EXIT                                                0363 00904000
*/*******************************************************************/  00905000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00906000
         EJECT                                                          00907000
*                                                                  0365 00908000
*                                                                  0365 00909000
*/*******************************************************************/  00910000
*/*                                                                 */  00911000
*/*             JES TRANSLATOR BSAM CHECK ROUTINE                   */  00912000
*/*                                                                 */  00913000
*/*                 FOR OUTPUT ONLY                                 */  00914000
*/*                 FOR INPUT, IGG019BB IS ENTERED                  */  00915000
*/*                                                                 */  00916000
*/*******************************************************************/  00917000
*                                                                  0365 00918000
*                                                                  0365 00919000
*CHECKRTN: ;                            /* ENTER CHECK ROUTINE      */  00920000
*                                                                  0365 00921000
CHECKRTN DS    0H                                                  0366 00922000
*/*******************************************************************/  00923000
*/*                                                                 */  00924000
*/* TEST FOR ANY ERRORS - ALL BITS ON EXCEPT FIRST                  */  00925000
*/*                                                                 */  00926000
*/*******************************************************************/  00927000
*                                                                  0366 00928000
*        RESTRICT (R12);                /* RESTRICT FROM COMPILER   */  00929000
*                                                                  0366 00930000
*                                                                  0366 00931000
*        IF DECBCODE='7F'X              /* TEST FOR ANY ERRORS      */  00932000
*          THEN                         /* NO                       */  00933000
         CLI   DECBCODE(RDECB),X'7F'                               0367 00934000
         BE    @RT00367                                            0367 00935000
*            GO TO EXIT;                /* BRANCH OUT IF NONE       */  00936000
*                                                                  0368 00937000
*          ELSE DO;                     /* IF AN ERROR IS PRESENT   */  00938000
*            R0 = ADDR(CISYNNAM);       /* COMING FROM INTERF. RTN  */  00939000
         LA    R0,CISYNNAM(,RCICB)                                 0370 00940000
*      GEN  (LOAD  EPLOC=(0));          /* LOAD SYNAD ROUTINE       */  00941000
         LOAD  EPLOC=(0)                                                00942000
*            R15 = R0;                  /* SET UP ADDRESS FOR CALL  */  00943000
         LR    R15,R0                                              0372 00944000
*            R1 = RRPL;                 /* SET UP LINKAGE AS IF     */  00945000
         LR    R1,RRPL                                             0373 00946000
*      GEN  (BALR  R14,R15);            /* CALL SYNAD ROUTINE       */  00947000
*                                                                  0374 00948000
         BALR  R14,R15                                                  00949000
*            R0 = ADDR(CISYNNAM);       /* POINT TO NAME AGAIN      */  00950000
         LA    R0,CISYNNAM(,RCICB)                                 0375 00951000
*      GEN  (DELETE EPLOC=(0));         /* AND DELETE SYNAD MODULE  */  00952000
         DELETE EPLOC=(0)                                               00953000
*               END;                                               0377 00954000
*                                                                  0377 00955000
*        RELEASE (R12);                 /* RELEASE REG TO COMPILER  */  00956000
*                                                                  0378 00957000
*/*******************************************************************/  00958000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00959000
         EJECT                                                          00960000
*                                                                  0380 00961000
*                                                                  0380 00962000
*/*******************************************************************/  00963000
*/*                                                                 */  00964000
*/*             SAVE ERROR DATA IN CURRENT DECB FOR CHECK           */  00965000
*/*                                                                 */  00966000
*/*******************************************************************/  00967000
*                                                                  0380 00968000
*                                                                  0380 00969000
*                                                                  0380 00970000
*        RESTRICT (R6);                 /* RESTRICT FROM COMPILER   */  00971000
*                                                                  0380 00972000
*QMAPPED:                               /* BSAM ERROR               */  00973000
*                                                                  0381 00974000
*        DECBCODE = '41'X;              /* SET ERROR CONDITION      */  00975000
*                                                                  0381 00976000
QMAPPED  MVI   DECBCODE(RDECB),X'41'                               0381 00977000
*        /* MAP JES RETURN CODE TO SAM-SI ERROR INDEX FOR SYNAD      */ 00978000
*                                                                  0382 00979000
*        IF RPLRTNCD = '08'X            /* FOR LOGICAL ERROR   Y02144*/ 00980000
*           & RPLERRCD = RPLINBUF THEN  /* DUE TO WRONG LENGTH Y02144*/ 00981000
         CLI   RPLRTNCD(RRPL),8                                    0382 00982000
         BNE   @RF00382                                            0382 00983000
         CLC   RPLERRCD(1,RRPL),RPLINBUF                           0382 00984000
         BNE   @RF00382                                            0382 00985000
*          DECBCOND = ERR1;             /* SET BSAM LEN ERROR  Y02144*/ 00986000
         MVC   DECBCOND(1,RDECB),ERR1                              0383 00987000
*        ELSE                           /* OTHERWISE ,         Y02144*/ 00988000
*          DECBCOND = ERR2;             /* SET BSAM READ ERROR Y02144*/ 00989000
*                                                                  0384 00990000
         B     @RC00382                                            0384 00991000
@RF00382 MVC   DECBCOND(1,RDECB),ERR2                              0384 00992000
*        /* CHECK ROUTINE WILL PICK UP CODE AND PUT IT IN REGISTER  */  00993000
*                                                                  0385 00994000
*        GO TO REND;                    /* RETURN TO REQUESTOR      */  00995000
*                                                                  0385 00996000
         B     REND                                                0385 00997000
*        RELEASE (R6);                  /* RELEASE REG TO COMPILER  */  00998000
*                                                                  0386 00999000
*/*******************************************************************/  01000000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  01001000
         EJECT                                                          01002000
*                                                                  0388 01003000
*                                                                  0388 01004000
*/*******************************************************************/  01005000
*/*                                                                 */  01006000
*/*            RETURN TO REQUESTOR                                  */  01007000
*/*                                                                 */  01008000
*/*******************************************************************/  01009000
*                                                                  0388 01010000
*                                                                  0388 01011000
*        GEN;                           /* GENERATE EXIT            */  01012000
*                                                                  0388 01013000
*                                                                  0388 01014000
*                                                                  0388 01015000
*                                                                  0388 01016000
*                                                                  0388 01017000
EXIT     L     R13,CIREGBC(,RCICB)      POINT TO USER SAVEAREA          01018000
         RETURN (14,12)                 RESTORE USER REGS               01019000
*/********************************************************************/ 01020000
*/*                                                                  */ 01021000
*/*      SCHEDULE 002 ABEND FOR INVALID BDW OR RDW                   */ 01022000
*/*                                                                  */ 01023000
*/********************************************************************/ 01024000
*                                                                  0389 01025000
*ABEND:  GEN (DMABCOND 204,SVC=YES,DCB=(RDCB)); /* REQUEST     Y02144   01026000
*                                       ABEND VIA PROB. DETERMINATION*/ 01027000
ABEND    DMABCOND 204,SVC=YES,DCB=(RDCB)                                01028000
*/********************************************************************/ 01029000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  01030000
         EJECT                                                          01031000
*                                                                  0391 01032000
*                                                                  0391 01033000
*/*******************************************************************/  01034000
*/*                                                                 */  01035000
*/*            JES TRANSLATOR BSAM CNTRL ROUTINE                    */  01036000
*/*                                                                 */  01037000
*/*******************************************************************/  01038000
*                                                                  0391 01039000
*                                                                  0391 01040000
*/*******************************************************************/  01041000
*/*   THE REQUEST IS IGNORED AND                                    */  01042000
*/*   CONTROL IS RETURNED TO THE PROGRAM                            */  01043000
*/*   REQUESTING THIS FUNCTION.                                     */  01044000
*/*******************************************************************/  01045000
*                                                                  0391 01046000
*                                                                  0391 01047000
*                                                                  0391 01048000
*CNTRLRTN: ;                            /* ENTER CNTRLRTN           */  01049000
*                                                                  0391 01050000
*/*******************************************************************/  01051000
*                                                                  0392 01052000
*        GO TO EXIT;                    /* RETURN TO REQUESTOR      */  01053000
*                                                                  0392 01054000
         B     EXIT                                                0392 01055000
*/*******************************************************************/  01056000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  01057000
         EJECT                                                          01058000
*                                                                  0394 01059000
*                                                                  0394 01060000
*/*******************************************************************/  01061000
*/*                                                                 */  01062000
*/*            JES TRANSLATOR NOTE ROUTINE                          */  01063000
*/*                                                                 */  01064000
*/*******************************************************************/  01065000
*                                                                  0394 01066000
*                                                                  0394 01067000
*                                                                  0394 01068000
*NOTERTN: ;                             /*  ENTRY TO NOTERTN        */  01069000
*                                                                  0394 01070000
NOTERTN  DS    0H                                                  0395 01071000
*        USERSAV(25:28) = RPLDDDD;      /* MOVE RBA TO REG 1 AREA   */  01072000
*                                                                  0395 01073000
         L     @12,CIREGBC(,RCICB)                                 0395 01074000
         MVC   USERSAV+24(4,@12),RPLDDDD(RRPL)                     0395 01075000
*/*******************************************************************/  01076000
*                                                                  0396 01077000
*        GO TO EXIT;                    /* RETURN TO REQUESTOR      */  01078000
*                                                                  0396 01079000
         B     EXIT                                                0396 01080000
*/*******************************************************************/  01081000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  01082000
         EJECT                                                          01083000
*                                                                  0398 01084000
*                                                                  0398 01085000
*/*******************************************************************/  01086000
*/*                                                                 */  01087000
*/*           JES TRANSLATOR POINT ROUTINE                          */  01088000
*/*                                                                 */  01089000
*/*******************************************************************/  01090000
*                                                                  0398 01091000
*                                                                  0398 01092000
*        RESTRICT (R5);                 /* RESTRICT FROM COMPILER   */  01093000
*                                                                  0398 01094000
*                                                                  0398 01095000
*POINTRTN: ;                            /* ENTRY TO POINT ROUTINE   */  01096000
*                                                                  0399 01097000
POINTRTN DS    0H                                                  0400 01098000
*        IF DCBMACRF(11)  = '1'B | DCBMACRF(10)  = '1'B/*          0400 01099000
*                                          DCB OPENED FOR OUTPUT    */  01100000
*          THEN DO;                     /* YES                      */  01101000
         TM    DCBMACRF+1(RDCB),B'01100000'                        0400 01102000
         BZ    @RF00400                                            0400 01103000
*            CIFPOINT = '1'B;           /* INVALID POINT REQUEST    */  01104000
         OI    CIFPOINT(RCICB),B'00000010'                         0402 01105000
*            GO TO EXIT;                /* SKIP PROCESSING          */  01106000
         B     EXIT                                                0403 01107000
*               END;                    /* END OF DO GROUP          */  01108000
*          ELSE;                        /* THIS IS INPUT            */  01109000
*                                                                  0405 01110000
@RF00400 DS    0H                                                  0406 01111000
*/*******************************************************************/  01112000
*                                                                  0406 01113000
*                                                                  0406 01114000
*        RPLARG  = R0;                  /* PTR TO ARGUMENT          */  01115000
         ST    R0,RPLARG(,RRPL)                                    0406 01116000
*        R5 = R0;                       /* ADDRESSIBILITY - RPLARGAR*/  01117000
         LR    R5,R0                                               0407 01118000
*        RPLDDDD = RPLARGAR;            /* MOVE ARGUMENT INTO RPL   */  01119000
         MVC   RPLDDDD(4,RRPL),RPLARGAR(R5)                        0408 01120000
*        RPLARG = ADDR(RPLRBAR);        /* ADDRESS OF POINT ARGUMENT*/  01121000
*                                                                  0409 01122000
         LA    @12,RPLRBAR(,RRPL)                                  0409 01123000
         ST    @12,RPLARG(,RRPL)                                   0409 01124000
*        RELEASE  (R5);                 /* RELEASE REG TO COMPILER  */  01125000
*                                                                  0410 01126000
*                                                                  0410 01127000
*        IF R15 ¬= 0                    /* TEST FOR ANY ERRORS      */  01128000
*          THEN CIFPOINT = '1'B;        /* YES - JES ERROR          */  01129000
         LTR   R15,R15                                             0411 01130000
         BZ    @RF00411                                            0411 01131000
         OI    CIFPOINT(RCICB),B'00000010'                         0412 01132000
*          ELSE CIFPOINT = '0'B;        /* NO ERRORS                */  01133000
*                                                                  0413 01134000
         B     @RC00411                                            0413 01135000
@RF00411 NI    CIFPOINT(RCICB),B'11111101'                         0413 01136000
*/*******************************************************************/  01137000
*                                                                  0414 01138000
*        GO TO EXIT;                    /* RETURN TO REQUESTOR      */  01139000
*                                                                  0414 01140000
         B     EXIT                                                0414 01141000
*/*******************************************************************/  01142000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  01143000
         EJECT                                                          01144000
*                                                                  0416 01145000
*                                                                  0416 01146000
*/*******************************************************************/  01147000
*/*                                                                 */  01148000
*/*            EODAD (END OF DATA) ROUTINE                          */  01149000
*/*                                                                 */  01150000
*/*******************************************************************/  01151000
*                                                                  0416 01152000
*                                                                  0416 01153000
*EODADRTN: ;                            /* ENTRY TO EODAD ROUTINE   */  01154000
*                                                                  0416 01155000
EODADRTN DS    0H                                                  0417 01156000
*/*******************************************************************/  01157000
*                                                                  0417 01158000
*        IF DCBRECFM(1:2) = '10'B &     /* IF FIXED                 */  01159000
*           DCBRECFM(4)   = '1'B &      /* AND BLOCKED              */  01160000
*           CIWK1 ¬= CIIOCNT            /* AND SHORT BLOCK          */  01161000
*          THEN DECBCODE = '7F'X;       /* SET COMPLETION CODE      */  01162000
         TM    DCBRECFM(RDCB),B'10000000'                          0417 01163000
         BNO   @RF00417                                            0417 01164000
         TM    DCBRECFM(RDCB),B'01000000'                          0417 01165000
         BNZ   @RF00417                                            0417 01166000
         TM    DCBRECFM(RDCB),B'00010000'                          0417 01167000
         BNO   @RF00417                                            0417 01168000
         CLC   CIWK1(4,RCICB),CIIOCNT(RCICB)                       0417 01169000
         BE    @RF00417                                            0417 01170000
         MVI   DECBCODE(RDECB),X'7F'                               0418 01171000
*          ELSE DECBCODE = '42'X;       /* SET COMPLETION CODE - EOF*/  01172000
         B     @RC00417                                            0419 01173000
@RF00417 MVI   DECBCODE(RDECB),X'42'                               0419 01174000
*        GO TO REND;                    /* RETURN TO CALLER         */  01175000
*                                                                  0420 01176000
         B     REND                                                0420 01177000
*/*******************************************************************/  01178000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  01179000
         EJECT                                                          01180000
*                                                                  0422 01181000
*                                                                  0422 01182000
*/*******************************************************************/  01183000
*                                                                  0422 01184000
*        GEN;                           /* ADDRESS CONSTANTS        */  01185000
*                                                                  0422 01186000
BRNCHTAB DC    A(READRTN)               ADDRESS READ ROUTINE            01187000
         DC    A(WRITERTN)              ADDRESS WRITE ROUTINE           01188000
         DC    A(CHECKRTN)              ADDRESS CHECK ROUTINE           01189000
         DC    A(CNTRLRTN)              ADDRESS CONTROL ROUTINE         01190000
         DC    A(NOTERTN)               ADDRESS NOTE ROUTINE            01191000
         DC    A(POINTRTN)              ADDRESS POINT ROUTINE           01192000
*/*******************************************************************/  01193000
*                                                                  0423 01194000
*                                                                  0423 01195000
*       END IGG019DK                    /* END OF BSAM MODULE       */  01196000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 01197000
*/*%INCLUDE SYSLIB  (IFGSDCB )                                        * 01198000
*/*%INCLUDE SYSLIB  (IFGRPL  )                                        * 01199000
*/*%INCLUDE SYSLIB  (IDARMRCD)                                        * 01200000
*/*%INCLUDE SYSLIB  (IFGJCICB)                                        * 01201000
*;                                                                 0423 01202000
@EL00001 DS    0H                                                  0423 01203000
@EF00001 DS    0H                                                  0423 01204000
@ER00001 BR    @14                                                 0423 01205000
@DATA    DS    0H                                                       01206000
@CH00147 DC    H'4'                                                     01207000
@CH00059 DC    H'8'                                                     01208000
@DATD    DSECT                                                          01209000
         DS    0F                                                       01210000
@ZTEMPS  DS    C                                                        01211000
@ZTEMPND EQU   *                                                        01212000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         01213000
@TEMPS   EQU   @ZTEMPS                                                  01214000
@L       EQU   @ZLEN                                                    01215000
IGG019DK CSECT                                                          01216000
         DS    0F                                                       01217000
@CF00061 DC    F'1'                                                     01218000
@CF00554 DC    F'-4'                                                    01219000
@CF00501 DC    XL4'41200000'                                            01220000
@DATD    DSECT                                                          01221000
         DS    0D                                                       01222000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01223000
@ENDDATD EQU   *                                                        01224000
@DATEND  EQU   *                                                        01225000
IGG019DK CSECT                                                          01226000
         DS    0F                                                       01227000
@SIZDATD DC    AL1(0)                                                   01228000
         DC    AL3(@ENDDATD-@DATD)                                      01229000
@SIZ001  EQU   @SIZDATD                                                 01230000
         DS    0D                                                       01231000
ERR1     DC    AL1(1)                                                   01232000
ERR2     DC    AL1(2)                                                   01233000
ERR3     DC    AL1(3)                                                   01234000
RPLDVOL  DC    AL1(4)                                                   01235000
RPLMOKEY DC    AL1(8)                                                   01236000
RPLWTBFR DC    AL1(12)                                                  01237000
RPLEODER DC    AL1(4)                                                   01238000
RPLDUP   DC    AL1(8)                                                   01239000
RPLSEQCK DC    AL1(12)                                                  01240000
RPLNOREC DC    AL1(16)                                                  01241000
RPLEXCL  DC    AL1(20)                                                  01242000
RPLNOMNT DC    AL1(24)                                                  01243000
RPLNOEXT DC    AL1(28)                                                  01244000
RPLINRBA DC    AL1(32)                                                  01245000
RPLNOKR  DC    AL1(36)                                                  01246000
RPLNOVRT DC    AL1(40)                                                  01247000
RPLINBUF DC    AL1(44)                                                  01248000
RPLNOPLH DC    AL1(64)                                                  01249000
RPLINACC DC    AL1(68)                                                  01250000
RPLINKEY DC    AL1(72)                                                  01251000
RPLINADR DC    AL1(76)                                                  01252000
RPLERSER DC    AL1(80)                                                  01253000
RPLINLOC DC    AL1(84)                                                  01254000
RPLNOPTR DC    AL1(88)                                                  01255000
RPLINUPD DC    AL1(92)                                                  01256000
RPLKEYCH DC    AL1(96)                                                  01257000
RPLDLCER DC    AL1(100)                                                 01258000
RPLINVP  DC    AL1(104)                                                 01259000
RPLINLEN DC    AL1(108)                                                 01260000
RPLKEYLC DC    AL1(112)                                                 01261000
RPLINLRQ DC    AL1(116)                                                 01262000
RPLINTCB DC    AL1(120)                                                 01263000
RPLSRLOC DC    AL1(132)                                                 01264000
RPLARSRK DC    AL1(136)                                                 01265000
RPLSRISG DC    AL1(140)                                                 01266000
RPLNBRCD DC    AL1(144)                                                 01267000
RPLNXPTR DC    AL1(148)                                                 01268000
RPLNOBFR DC    AL1(152)                                                 01269000
RPLIRRNO DC    AL1(192)                                                 01270000
RPLRRADR DC    AL1(196)                                                 01271000
RPLPAACI DC    AL1(200)                                                 01272000
RPLPUTBK DC    AL1(204)                                                 01273000
RPLINVEQ DC    AL1(208)                                                 01274000
RPLRDERD DC    AL1(4)                                                   01275000
RPLRDERI DC    AL1(8)                                                   01276000
RPLRDERS DC    AL1(12)                                                  01277000
RPLWTERD DC    AL1(16)                                                  01278000
RPLWTERI DC    AL1(20)                                                  01279000
RPLWTERS DC    AL1(24)                                                  01280000
RPLBASER DC    AL1(0)                                                   01281000
RPLBASUM DC    AL1(1)                                                   01282000
RPLAIXER DC    AL1(2)                                                   01283000
RPLAIXUM DC    AL1(3)                                                   01284000
RPLUPGER DC    AL1(4)                                                   01285000
RPLUPGUM DC    AL1(5)                                                   01286000
@CB00519 DC    X'0000'                                                  01287000
PATCH    DC    CL100' '                                                 01288000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01289000
@01      EQU   01                                                       01290000
@02      EQU   02                                                       01291000
@03      EQU   03                                                       01292000
@04      EQU   04                                                       01293000
@05      EQU   05                                                       01294000
@06      EQU   06                                                       01295000
@07      EQU   07                                                       01296000
@08      EQU   08                                                       01297000
@09      EQU   09                                                       01298000
@10      EQU   10                                                       01299000
@11      EQU   11                                                       01300000
@12      EQU   12                                                       01301000
@13      EQU   13                                                       01302000
@14      EQU   14                                                       01303000
@15      EQU   15                                                       01304000
@0       EQU   00                                                       01305000
@1       EQU   01                                                       01306000
@2       EQU   02                                                       01307000
@3       EQU   03                                                       01308000
@4       EQU   04                                                       01309000
@5       EQU   05                                                       01310000
@6       EQU   06                                                       01311000
@7       EQU   07                                                       01312000
@8       EQU   08                                                       01313000
@9       EQU   09                                                       01314000
@A       EQU   10                                                       01315000
@B       EQU   11                                                       01316000
@C       EQU   12                                                       01317000
@D       EQU   13                                                       01318000
@E       EQU   14                                                       01319000
@F       EQU   15                                                       01320000
R0       EQU   @00                                                      01321000
RWORK    EQU   @00                                                      01322000
R1       EQU   @01                                                      01323000
RRPL     EQU   @02                                                      01324000
RCICB    EQU   @04                                                      01325000
R5       EQU   @05                                                      01326000
R6       EQU   @06                                                      01327000
RDECB    EQU   @07                                                      01328000
RDCB     EQU   @08                                                      01329000
R11      EQU   @11                                                      01330000
R12      EQU   @12                                                      01331000
R15      EQU   @15                                                      01332000
R10      EQU   @10                                                      01333000
R13      EQU   @13                                                      01334000
R14      EQU   @14                                                      01335000
DECB     EQU   0                                                        01336000
DECSDECB EQU   DECB                                                     01337000
DECBCODE EQU   DECSDECB                                                 01338000
DECBCOND EQU   DECSDECB+1                                               01339000
DECRESDU EQU   DECSDECB+2                                               01340000
DECTYP   EQU   DECB+4                                                   01341000
DECLNGTH EQU   DECB+6                                                   01342000
DECDCBAD EQU   DECB+8                                                   01343000
DECAREA  EQU   DECB+12                                                  01344000
DECIOBPT EQU   DECB+16                                                  01345000
IFGSDCB  EQU   0                                                        01346000
DCBBUFCB EQU   IFGSDCB+20                                               01347000
DCBIOBAD EQU   IFGSDCB+28                                               01348000
@NM00004 EQU   IFGSDCB+32                                               01349000
DCBHIARC EQU   @NM00004                                                 01350000
DCBBFTEK EQU   DCBHIARC                                                 01351000
DCBRECFM EQU   IFGSDCB+36                                               01352000
DCBDDNAM EQU   IFGSDCB+40                                               01353000
DCBMACRF EQU   DCBDDNAM+2                                               01354000
DCBREAD  EQU   IFGSDCB+49                                               01355000
DCBWRITE EQU   DCBREAD                                                  01356000
DCBGET   EQU   DCBWRITE                                                 01357000
DCBPUT   EQU   DCBGET                                                   01358000
DCBCHECK EQU   IFGSDCB+53                                               01359000
DCBGERR  EQU   DCBCHECK                                                 01360000
DCBBLKSI EQU   IFGSDCB+62                                               01361000
DCBIOBA  EQU   IFGSDCB+68                                               01362000
DCBCICB  EQU   DCBIOBA                                                  01363000
DCBEOBAD EQU   IFGSDCB+72                                               01364000
DCBLCCW  EQU   DCBEOBAD                                                 01365000
DCBEOBR  EQU   DCBLCCW                                                  01366000
DCBNCP   EQU   DCBEOBR                                                  01367000
@NM00005 EQU   IFGSDCB+76                                               01368000
DCBEOBW  EQU   @NM00005                                                 01369000
DCBRECAD EQU   DCBEOBW                                                  01370000
DCBDIRCT EQU   IFGSDCB+80                                               01371000
DCBLRECL EQU   IFGSDCB+82                                               01372000
@NM00006 EQU   IFGSDCB+84                                               01373000
DCBCNTRL EQU   @NM00006+1                                               01374000
DCBNOTE  EQU   DCBCNTRL                                                 01375000
IFGRPL   EQU   0                                                        01376000
RPLCOMN  EQU   IFGRPL                                                   01377000
RPLIDWD  EQU   RPLCOMN                                                  01378000
RPLLEN   EQU   RPLIDWD+3                                                01379000
RPLECB   EQU   RPLCOMN+8                                                01380000
RPLFDBWD EQU   RPLCOMN+12                                               01381000
RPLFDBK  EQU   RPLFDBWD+1                                               01382000
RPLRTNCD EQU   RPLFDBK                                                  01383000
RPLCNDCD EQU   RPLFDBK+1                                                01384000
RPLCMPON EQU   RPLCNDCD                                                 01385000
RPLFDB2  EQU   RPLCMPON                                                 01386000
RPLERRCD EQU   RPLCNDCD+1                                               01387000
RPLFDB3  EQU   RPLERRCD                                                 01388000
RPLKEYLE EQU   RPLCOMN+16                                               01389000
RPLCCHAR EQU   RPLCOMN+20                                               01390000
RPLAREA  EQU   RPLCOMN+32                                               01391000
RPLARG   EQU   RPLCOMN+36                                               01392000
RPLOPTCD EQU   RPLCOMN+40                                               01393000
RPLOPT1  EQU   RPLOPTCD                                                 01394000
RPLECBSW EQU   RPLOPT1                                                  01395000
RPLOPT2  EQU   RPLOPTCD+1                                               01396000
RPLADR   EQU   RPLOPT2                                                  01397000
RPLOPT3  EQU   RPLOPTCD+2                                               01398000
RPLNXTRP EQU   RPLCOMN+44                                               01399000
RPLRLEN  EQU   RPLCOMN+48                                               01400000
RPLBUFL  EQU   RPLCOMN+52                                               01401000
RPLOPTC2 EQU   RPLCOMN+56                                               01402000
RPLOPT5  EQU   RPLOPTC2                                                 01403000
RPLWRTYP EQU   RPLOPT5                                                  01404000
RPLOPT6  EQU   RPLOPTC2+1                                               01405000
RPLUNTYP EQU   RPLOPT6                                                  01406000
RPLOPT7  EQU   RPLOPTC2+2                                               01407000
RPLCNOPT EQU   RPLOPT7                                                  01408000
RPLOPT8  EQU   RPLOPTC2+3                                               01409000
RPLRBAR  EQU   RPLCOMN+60                                               01410000
RPLAIXID EQU   RPLRBAR+2                                                01411000
RPLDDDD  EQU   RPLRBAR+4                                                01412000
RPLEXTDS EQU   RPLCOMN+68                                               01413000
RPLEXTD1 EQU   RPLEXTDS                                                 01414000
IFGJCICB EQU   0                                                        01415000
CIDUMIOB EQU   IFGJCICB                                                 01416000
CIIOB    EQU   CIDUMIOB+8                                               01417000
CIRESID  EQU   CIDUMIOB+20                                              01418000
CISYNNAM EQU   IFGJCICB+108                                             01419000
CIREGSAV EQU   IFGJCICB+116                                             01420000
CIREGBC  EQU   CIREGSAV+4                                               01421000
CIFLAGS  EQU   IFGJCICB+188                                             01422000
CIFLAG2  EQU   CIFLAGS+1                                                01423000
CIFLAG3  EQU   CIFLAGS+2                                                01424000
CIFVSRI  EQU   CIFLAG3                                                  01425000
CIFVSEOB EQU   CIFLAG3                                                  01426000
CIFPOINT EQU   CIFLAG3                                                  01427000
CIRPL    EQU   IFGJCICB+192                                             01428000
CILWAREA EQU   IFGJCICB+304                                             01429000
CIIOCNT  EQU   IFGJCICB+308                                             01430000
CISEGLEN EQU   CIIOCNT                                                  01431000
CIBLKPTR EQU   IFGJCICB+312                                             01432000
CIRAREA  EQU   IFGJCICB+316                                             01433000
CIRECPTR EQU   IFGJCICB+320                                             01434000
CISAMWA  EQU   IFGJCICB+324                                             01435000
CIWK1    EQU   IFGJCICB+328                                             01436000
CISVCLST EQU   IFGJCICB+336                                             01437000
CISYNADA EQU   CISVCLST                                                 01438000
CIBLDL   EQU   CISVCLST+4                                               01439000
CIBSP    EQU   CISVCLST+8                                               01440000
CIFEOV   EQU   CISVCLST+12                                              01441000
CISTOW   EQU   CISVCLST+16                                              01442000
RPLEXT   EQU   76                                                       01443000
RPLCICB  EQU   RPLEXT                                                   01444000
RPLSAVE  EQU   RPLEXT+4                                                 01445000
RPLDECB  EQU   RPLEXT+8                                                 01446000
USERSAV  EQU   0                                                        01447000
BDW      EQU   0                                                        01448000
BDWLL    EQU   BDW                                                      01449000
FILLERB  EQU   BDW+2                                                    01450000
RDW      EQU   -4                                                       01451000
RDWLL    EQU   RDW                                                      01452000
FILLER   EQU   RDW+2                                                    01453000
SEGCC    EQU   FILLER                                                   01454000
RPLARGAR EQU   0                                                        01455000
DUMMYIO  EQU   0                                                        01456000
DUMMYPTR EQU   DUMMYIO                                                  01457000
DUMMYIOB EQU   DUMMYIO+8                                                01458000
DUMMYCNT EQU   DUMMYIO+20                                               01459000
SEGMENT  EQU   0                                                        01460000
*                                      START UNREFERENCED COMPONENTS    01461000
DUMMYDCB EQU   DUMMYIO+28                                               01462000
@NM00023 EQU   DUMMYIO+24                                               01463000
@NM00022 EQU   DUMMYIO+16                                               01464000
DUMMYEPT EQU   DUMMYIO+12                                               01465000
@NM00021 EQU   DUMMYIO+5                                                01466000
DYMMYECB EQU   DUMMYIO+4                                                01467000
@NM00020 EQU   FILLER+1                                                 01468000
RPLRPLPT EQU   RPLEXT+12                                                01469000
@NM00019 EQU   RPLDECB+1                                                01470000
RPLRUDYN EQU   RPLDECB                                                  01471000
@NM00018 EQU   RPLSAVE+1                                                01472000
RPLBFREL EQU   RPLSAVE                                                  01473000
@NM00017 EQU   RPLCICB+1                                                01474000
RPLCIFLG EQU   RPLCICB                                                  01475000
CISTOWRC EQU   CISTOW                                                   01476000
CIFEOVRC EQU   CIFEOV                                                   01477000
CIBSPRC  EQU   CIBSP                                                    01478000
CIBLDLRC EQU   CIBLDL                                                   01479000
CISYNRC  EQU   CISYNADA                                                 01480000
CIWK2    EQU   IFGJCICB+332                                             01481000
CIFDBCK  EQU   IFGJCICB+284                                             01482000
CIRPLEXT EQU   IFGJCICB+268                                             01483000
CIFLAG4  EQU   CIFLAGS+3                                                01484000
@NM00016 EQU   CIFLAG3                                                  01485000
CIFERROR EQU   CIFLAG3                                                  01486000
CIFRAGM  EQU   CIFLAG3                                                  01487000
CIFCLOSE EQU   CIFLAG3                                                  01488000
CIFFSTP  EQU   CIFLAG3                                                  01489000
@NM00015 EQU   CIFLAG2                                                  01490000
CIFMDEVT EQU   CIFLAG2                                                  01491000
CIFMDSOR EQU   CIFLAG2                                                  01492000
CIFLAG1  EQU   CIFLAGS                                                  01493000
CIREGS   EQU   CIREGSAV+12                                              01494000
CIREGFC  EQU   CIREGSAV+8                                               01495000
@NM00014 EQU   CIREGSAV                                                 01496000
CIACBED  EQU   IFGJCICB+88                                              01497000
CIACBD   EQU   IFGJCICB+32                                              01498000
CIDCBPTR EQU   CIDUMIOB+28                                              01499000
@NM00013 EQU   CIDUMIOB+24                                              01500000
@NM00012 EQU   CIDUMIOB+16                                              01501000
CIECBPTR EQU   CIDUMIOB+12                                              01502000
@NM00011 EQU   CIDUMIOB+5                                               01503000
CIECBCD  EQU   CIDUMIOB+4                                               01504000
CINXTIOB EQU   CIDUMIOB                                                 01505000
RPLERMSA EQU   RPLCOMN+72                                               01506000
RPLEMLEN EQU   RPLCOMN+70                                               01507000
RPLACTIV EQU   RPLCOMN+69                                               01508000
RPLBRANC EQU   RPLEXTD1                                                 01509000
RPLNIB   EQU   RPLEXTD1                                                 01510000
@NM00010 EQU   RPLEXTD1                                                 01511000
RPLEXIT  EQU   RPLEXTD1                                                 01512000
RPLNEXIT EQU   RPLEXTD1                                                 01513000
RPLEXSCH EQU   RPLEXTD1                                                 01514000
@NM00009 EQU   RPLRBAR+3                                                01515000
@NM00008 EQU   RPLAIXID                                                 01516000
RPLAXPKP EQU   RPLAIXID                                                 01517000
RPLAIXPC EQU   RPLRBAR                                                  01518000
RPLRSV88 EQU   RPLOPT8                                                  01519000
RPLUNCON EQU   RPLOPT8                                                  01520000
RPLACTV  EQU   RPLOPT8                                                  01521000
RPLSESS  EQU   RPLOPT8                                                  01522000
RPLPEND  EQU   RPLOPT8                                                  01523000
RPLODPRM EQU   RPLOPT8                                                  01524000
RPLODACP EQU   RPLOPT8                                                  01525000
RPLODACQ EQU   RPLOPT8                                                  01526000
RPLRSV78 EQU   RPLOPT7                                                  01527000
RPLRSV77 EQU   RPLOPT7                                                  01528000
RPLRLSOP EQU   RPLOPT7                                                  01529000
RPLTPOST EQU   RPLOPT7                                                  01530000
RPLQOPT  EQU   RPLOPT7                                                  01531000
RPLCNIMM EQU   RPLCNOPT                                                 01532000
RPLCNANY EQU   RPLCNOPT                                                 01533000
RPLCNALL EQU   RPLCNOPT                                                 01534000
RPLRSV68 EQU   RPLOPT6                                                  01535000
RPLRSV67 EQU   RPLOPT6                                                  01536000
RPLLOCK  EQU   RPLOPT6                                                  01537000
RPLNCOND EQU   RPLOPT6                                                  01538000
RPLCOND  EQU   RPLOPT6                                                  01539000
RPLEOT   EQU   RPLUNTYP                                                 01540000
RPLEOM   EQU   RPLUNTYP                                                 01541000
RPLEOB   EQU   RPLUNTYP                                                 01542000
RPLWROPT EQU   RPLOPT5                                                  01543000
RPLNODE  EQU   RPLOPT5                                                  01544000
RPLERACE EQU   RPLWRTYP                                                 01545000
RPLEAU   EQU   RPLWRTYP                                                 01546000
RPLNERAS EQU   RPLWRTYP                                                 01547000
RPLPSOPT EQU   RPLOPT5                                                  01548000
RPLSSNIN EQU   RPLOPT5                                                  01549000
RPLDLGIN EQU   RPLOPT5                                                  01550000
RPLCHAIN EQU   RPLNXTRP                                                 01551000
RPLOPT4  EQU   RPLOPTCD+3                                               01552000
RPLALIGN EQU   RPLOPT3                                                  01553000
RPLFMT   EQU   RPLOPT3                                                  01554000
RPLFLD   EQU   RPLOPT3                                                  01555000
RPLVFY   EQU   RPLOPT3                                                  01556000
RPLBLK   EQU   RPLOPT3                                                  01557000
RPLSFORM EQU   RPLOPT3                                                  01558000
RPLEODS  EQU   RPLOPT3                                                  01559000
RPLNSP   EQU   RPLOPT2                                                  01560000
RPLUPD   EQU   RPLOPT2                                                  01561000
RPLWAITX EQU   RPLOPT2                                                  01562000
RPLLRD   EQU   RPLOPT2                                                  01563000
RPLBWD   EQU   RPLOPT2                                                  01564000
RPLCNV   EQU   RPLOPT2                                                  01565000
RPLADD   EQU   RPLADR                                                   01566000
RPLKEY   EQU   RPLOPT2                                                  01567000
RPLECBIN EQU   RPLECBSW                                                 01568000
RPLGEN   EQU   RPLOPT1                                                  01569000
RPLKGE   EQU   RPLOPT1                                                  01570000
RPLASY   EQU   RPLOPT1                                                  01571000
RPLSKP   EQU   RPLOPT1                                                  01572000
RPLSEQ   EQU   RPLOPT1                                                  01573000
RPLDIR   EQU   RPLOPT1                                                  01574000
RPLLOC   EQU   RPLOPT1                                                  01575000
RPLDAF   EQU   RPLARG+2                                                 01576000
RPLSAF   EQU   RPLARG                                                   01577000
RPLTCBPT EQU   RPLCOMN+28                                               01578000
RPLDACB  EQU   RPLCOMN+24                                               01579000
RPLSTRID EQU   RPLCOMN+18                                               01580000
RPLKEYL  EQU   RPLKEYLE                                                 01581000
RPLRDSOH EQU   RPLFDB3                                                  01582000
RPLRLG   EQU   RPLFDB3                                                  01583000
RPLLGFRC EQU   RPLFDB3                                                  01584000
RPLREOT  EQU   RPLFDB3                                                  01585000
RPLREOM  EQU   RPLFDB3                                                  01586000
RPLREOB  EQU   RPLFDB3                                                  01587000
RPLSV32  EQU   RPLFDB3                                                  01588000
RPLUINPT EQU   RPLFDB3                                                  01589000
RPLSTSAV EQU   RPLFDB2                                                  01590000
RPLCUERR EQU   RPLFDB2                                                  01591000
RPLDLGFL EQU   RPLFDB2                                                  01592000
RPLIOERR EQU   RPLFDB2                                                  01593000
RPLDVUNS EQU   RPLFDB2                                                  01594000
RPLATND  EQU   RPLFDB2                                                  01595000
RPLRVID  EQU   RPLFDB2                                                  01596000
RPLERLK  EQU   RPLFDB2                                                  01597000
RPLERREG EQU   RPLRTNCD                                                 01598000
RPLSTAT  EQU   RPLFDBWD                                                 01599000
RPLPOST  EQU   RPLECB                                                   01600000
RPLWAIT  EQU   RPLECB                                                   01601000
RPLPLHPT EQU   RPLCOMN+4                                                01602000
RPLLEN2  EQU   RPLLEN                                                   01603000
RPLREQ   EQU   RPLIDWD+2                                                01604000
RPLSTYP  EQU   RPLIDWD+1                                                01605000
RPLID    EQU   RPLIDWD                                                  01606000
DCBEOB   EQU   IFGSDCB+92                                               01607000
DCBPRECL EQU   IFGSDCB+90                                               01608000
@NM00007 EQU   IFGSDCB+88                                               01609000
DCBPOINT EQU   DCBNOTE                                                  01610000
DCBEROPT EQU   @NM00006                                                 01611000
DCBQSWS  EQU   DCBDIRCT                                                 01612000
DCBCCCW  EQU   DCBRECAD                                                 01613000
DCBOFFSW EQU   IFGSDCB+67                                               01614000
DCBOFFSR EQU   IFGSDCB+66                                               01615000
DCBWCPL  EQU   IFGSDCB+65                                               01616000
DCBWCPO  EQU   IFGSDCB+64                                               01617000
DCBCIND2 EQU   IFGSDCB+61                                               01618000
DCBCIND1 EQU   IFGSDCB+60                                               01619000
DCBSYNAD EQU   IFGSDCB+57                                               01620000
DCBIOBL  EQU   IFGSDCB+56                                               01621000
DCBPERR  EQU   DCBGERR                                                  01622000
DCBOPTCD EQU   IFGSDCB+52                                               01623000
DCBMACR  EQU   DCBPUT+1                                                 01624000
DCBIFLG  EQU   DCBPUT                                                   01625000
DCBOFLGS EQU   IFGSDCB+48                                               01626000
DCBDEBAD EQU   DCBDDNAM+5                                               01627000
DCBIFLGS EQU   DCBDDNAM+4                                               01628000
DCBTIOT  EQU   DCBDDNAM                                                 01629000
DCBEXLST EQU   IFGSDCB+37                                               01630000
DCBEODAD EQU   IFGSDCB+33                                               01631000
DCBBFALN EQU   DCBBFTEK                                                 01632000
DCBSVCXL EQU   DCBIOBAD                                                 01633000
DCBDSORG EQU   IFGSDCB+26                                               01634000
DCBBUFL  EQU   IFGSDCB+24                                               01635000
DCBBUFNO EQU   DCBBUFCB                                                 01636000
@NM00003 EQU   IFGSDCB+16                                               01637000
@NM00002 EQU   IFGSDCB                                                  01638000
DECNEXT  EQU   DECB+20                                                  01639000
DECTYPE  EQU   DECB+5                                                   01640000
@NM00001 EQU   DECBCODE                                                 01641000
DECBCOMP EQU   DECBCODE                                                 01642000
DECBWAIT EQU   DECBCODE                                                 01643000
*                                      END UNREFERENCED COMPONENTS      01644000
@RC00178 EQU   @RC00177                                                 01645000
@RT00188 EQU   EODADRTN                                                 01646000
@RF00188 EQU   QMAPPED                                                  01647000
@RC00203 EQU   GETIT                                                    01648000
@RT00209 EQU   FIXBLOCK                                                 01649000
@RF00243 EQU   WRCNT                                                    01650000
@RT00254 EQU   ABEND                                                    01651000
@RT00263 EQU   NOMOVE                                                   01652000
@RT00287 EQU   ABEND                                                    01653000
@RT00300 EQU   ABEND                                                    01654000
@RF00328 EQU   CONTIN03                                                 01655000
@RT00339 EQU   EXIT                                                     01656000
@RF00355 EQU   WRITIT                                                   01657000
@RT00367 EQU   EXIT                                                     01658000
@RC00382 EQU   REND                                                     01659000
CNTRLRTN EQU   EXIT                                                     01660000
@RC00411 EQU   EXIT                                                     01661000
@RC00417 EQU   REND                                                     01662000
@EL01    EQU   @EL00001                                                 01663000
@ENDDATA EQU   *                                                        01664000
         END   IGG019DK,(C'PLS0858',0701,78076)                         01665000
./  ADD  SSI=72350444,NAME=IGG0198L
         TITLE 'IGG0198L  -  SAM-SI OPEN EXECUTOR                      *00001000
                        '                                               00002000
IGG0198L CSECT ,                                                   0001 00003000
@PROLOG  BALR  @12,0                                               0001 00004000
@PSTART  DS    0H                                                  0001 00005000
         USING @PSTART,@12                                         0001 00006000
         EJECT                                                          00007000
         EJECT                                                          00008000
PROCESS  MODESET EXTKEY=DATAMGT                                         00009000
*        RDCB = PARCDCB;                /* SET BASE FOR DCB         */  00010000
         SLR   RDCB,RDCB                                           0042 00011000
         ICM   RDCB,7,PARCDCB(RPARC)                               0042 00012000
*        RDCB = RDCB + 0;               /* CLEAR HIGH ORDER BYTE    */  00013000
*        RCICB = DCBCICB;               /* SET BASE FOR CICB        */  00014000
         L     RCICB,DCBCICB(,RDCB)                                0044 00015000
*        RCORE = WTGCWA;                /* SET BASE ADDR 4 IECDSECT */  00016000
*                                                                  0045 00017000
         SLR   RCORE,RCORE                                         0045 00018000
         ICM   RCORE,7,WTGCWA(RWTGC)                               0045 00019000
*        /***********************************************************/  00020000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00021000
         EJECT                                                          00022000
*        /***********************************************************/  00023000
*        /*                                                         */  00024000
*        /* HAVE LOAD PUT NECESSARY MODULES IN USER'S REGION        */  00025000
*        /*                                                         */  00026000
*        /***********************************************************/  00027000
*                                                                  0047 00028000
*LOADCIPM:                                                         0047 00029000
*                                                                  0047 00030000
*        IF DCBCIND2(8) = '0'B THEN     /* DOES DCB INDICATE QSAM   */  00031000
LOADCIPM TM    DCBCIND2(RDCB),B'00000001'                          0047 00032000
         BNZ   @RF00047                                            0047 00033000
*          DO;                          /* NO - LOAD BSAM MODULES   */  00034000
*                                                                  0048 00035000
*        /***********************************************************/  00036000
*        /* LOAD BSAM PROCESSING MODULE                             */  00037000
*        /***********************************************************/  00038000
*                                                                  0049 00039000
*               R1 = CVTLINK;           /* LINKLIB'S DCB PTR ZA02501*/  00040000
         L     @04,CVTPTR                                          0049 00041000
         L     R1,CVTLINK(,@04)                                    0049 00042000
*               WTGMDNAM = 'IGG019DK';  /* NAME OF MODULE TO LOAD   */  00043000
         MVC   WTGMDNAM(8,RWTG),@CC00381                           0050 00044000
*               GEN (LOAD  EPLOC=(RWTG),DCB=(R1));        /* ZA02501*/  00045000
         LOAD  EPLOC=(RWTG),DCB=(R1)                                    00046000
*               WTGMDNAM = 'IGG0198L';  /* RESTORE MODULE NAME      */  00047000
         MVC   WTGMDNAM(8,RWTG),@CC00382                           0052 00048000
*               RMOD = R0;              /* SET BASE FOR ENTRY PT    */  00049000
         LR    RMOD,R0                                             0053 00050000
*                                       /* TABLE AT BEGINNING OF    */  00051000
*                                       /* MODULE...R0 POINTS TO    */  00052000
*                                       /* MODULE JUST LOADED       */  00053000
*                                                                  0054 00054000
*               ATFBSAM = '1'B;         /* SET BSAM MOD LOADED Y02144*/ 00055000
*                                                                  0054 00056000
         OI    ATFBSAM(RCORE),B'00000100'                          0054 00057000
*        /* SET CNTRL ENTRY ADDRESS                                 */  00058000
*                                                                  0055 00059000
*                                       /* IS CNTRL WANTED          */  00060000
*               IF DCBMACRF(7) = '1'B | DCBMACRF(15) = '1'B        0055 00061000
*                 THEN                  /* YES                      */  00062000
         TM    DCBMACRF(RDCB),B'00000010'                          0055 00063000
         BO    @RT00055                                            0055 00064000
         TM    DCBMACRF+1(RDCB),B'00000010'                        0055 00065000
         BNO   @RF00055                                            0055 00066000
@RT00055 DS    0H                                                  0056 00067000
*                   DCBCNTRL = EPCNTRL; /* ENTRY PT TO CONTROL RTN  */  00068000
         MVC   DCBCNTRL(3,RDCB),EPCNTRL+1(RMOD)                    0056 00069000
*                 ELSE;                 /* CONTROL NOT SPECIFIED    */  00070000
*                                                                  0057 00071000
@RF00055 DS    0H                                                  0058 00072000
*        /* SET READ ENTRY ADDRESS                                  */  00073000
*                                                                  0058 00074000
*                                       /* OPENED FOR IN OR INOUT   */  00075000
*               IF PARCOPOP = '0000'B | PARCOPOP = '0011'B THEN    0058 00076000
         TM    PARCOPOP(RPARC),B'00001111'                         0058 00077000
         BZ    @RT00058                                            0058 00078000
         TM    PARCOPOP(RPARC),B'00000011'                         0058 00079000
         BNO   @RF00058                                            0058 00080000
         TM    PARCOPOP(RPARC),B'00001100'                         0058 00081000
         BNZ   @RF00058                                            0058 00082000
@RT00058 DS    0H                                                  0059 00083000
*                   DO;                 /* YES, DO THE FOLLOWING    */  00084000
*                     DCBREAD = EPREAD; /* ENTRY FOR CI READ        */  00085000
*                                                                  0060 00086000
         MVC   DCBREAD(3,RDCB),EPREAD+1(RMOD)                      0060 00087000
*        /* LOAD CHECK MODULE IF CONCATENATION NOT IN PROGRESS      */  00088000
*                                                                  0061 00089000
*                    IF DCBOFLGS(3) = '0'B/*                       0061 00090000
*                                          CONCATENATION INDICATOR  */  00091000
*                      THEN             /* NOT CONCATENATED         */  00092000
         TM    DCBOFLGS(RDCB),B'00100000'                          0061 00093000
         BNZ   @RF00061                                            0061 00094000
*                        DO;            /* YES, DO THE FOLLOWING    */  00095000
*                                                                  0062 00096000
*                        /* SET NAME AND DCB ADDR OF MODULE TO LOAD */  00097000
*                        R1=CVTLINK;    /* LINKLIB DCB ADDR  ZA02501*/  00098000
         L     @04,CVTPTR                                          0063 00099000
         L     R1,CVTLINK(,@04)                                    0063 00100000
*                        WTGMDNAM = 'IGG019BB';                    0064 00101000
         MVC   WTGMDNAM(8,RWTG),@CC00387                           0064 00102000
*                        GEN (LOAD EPLOC=(RWTG),DCB=(R1)); /*ZA02501*/  00103000
*                                                                  0065 00104000
         LOAD EPLOC=(RWTG),DCB=(R1)                                     00105000
*                        /* RESTORE MODULE NAME                     */  00106000
*                        WTGMDNAM = 'IGG0198L';                    0066 00107000
*                                                                  0066 00108000
         MVC   WTGMDNAM(8,RWTG),@CC00382                           0066 00109000
*                        /* ENTRY FOR BSAM CHECK                    */  00110000
*                        DCBCHECK = R0;                            0067 00111000
         STCM  R0,7,DCBCHECK(RDCB)                                 0067 00112000
*                        ATFCHECK = '1'B;/*                        0068 00113000
*                                          CHECK MOD IS LOADED Y02144*/ 00114000
         OI    ATFCHECK(RCORE),B'00000001'                         0068 00115000
*                        END;           /* END OF NOT CONCAT GROUP  */  00116000
*                      ELSE;            /* CONCAT IS INDICATED      */  00117000
@RF00061 DS    0H                                                  0071 00118000
*                   END;                /* END OF IN|INOUT GROUP    */  00119000
*                 ELSE                  /* NOT INPUT OR INOUT       */  00120000
*                   DO;                 /* OPENED FOR OUT|OUTIN     */  00121000
*                                                                  0072 00122000
         B     @RC00058                                            0072 00123000
@RF00058 DS    0H                                                  0073 00124000
*        /* SET WRITE ENTRY ADDRESS                                 */  00125000
*                                                                  0073 00126000
*               DCBWRITE = EPWRITE;     /* SET WRITE ENTRY ADDR     */  00127000
*                                                                  0073 00128000
         MVC   DCBWRITE(3,RDCB),EPWRITE+1(RMOD)                    0073 00129000
*        /* SET CHECK (OUTPUT) ENTRY ADDRESS                        */  00130000
*                                                                  0074 00131000
*               DCBCHECK = EPCHECK;     /* SET CHECK ENTRY ADDR     */  00132000
         MVC   DCBCHECK(3,RDCB),EPCHECK+1(RMOD)                    0074 00133000
*               END;                    /* END OF OUT|OUTIN GROUP   */  00134000
*                                                                  0075 00135000
*                                                                  0075 00136000
*              END;                         /* END OF BSAM GROUP     */ 00137000
*                                                                  0076 00138000
*            ELSE DO;                       /* NOT BSAM DCB          */ 00139000
         B     @RC00047                                            0077 00140000
@RF00047 DS    0H                                                  0078 00141000
*        GEN (EJECT);                                              0078 00142000
         EJECT                                                          00143000
*                                                                  0079 00144000
*        /***********************************************************/  00145000
*        /* LOAD QSAM PROCESSING MODULE                             */  00146000
*        /***********************************************************/  00147000
*                                                                  0079 00148000
*QSAMMOD:                                                          0079 00149000
*                R1 = CVTLINK;          /* LINKLIB DCB ADDR  ZA02501*/  00150000
QSAMMOD  L     @04,CVTPTR                                          0079 00151000
         L     R1,CVTLINK(,@04)                                    0079 00152000
*                WTGMDNAM = 'IGG019DJ'; /* NAME OF MOD TO LOAD      */  00153000
         MVC   WTGMDNAM(8,RWTG),@CC00390                           0080 00154000
*                GEN (LOAD  EPLOC=(RWTG),DCB=(R1));       /* ZA02501*/  00155000
         LOAD  EPLOC=(RWTG),DCB=(R1)                                    00156000
*                WTGMDNAM = 'IGG0198L'; /* RESTORE MODULE NAME      */  00157000
*                                                                  0082 00158000
         MVC   WTGMDNAM(8,RWTG),@CC00382                           0082 00159000
*                RMOD = R0;             /* SET BASE FOR ENTRY PT    */  00160000
         LR    RMOD,R0                                             0083 00161000
*                                       /* TABLE AT BEGINNING OF    */  00162000
*                                       /* MODULE...R0 POINTS TO    */  00163000
*                                       /* MODULE JUST LOADED       */  00164000
*                ATFQSAM = '1'B;        /* SET QSAM MOD LOADED Y02144*/ 00165000
*                                                                  0084 00166000
         OI    ATFQSAM(RCORE),B'00001000'                          0084 00167000
*        /* SET CNTRL ENTRY ADDRESS IF REQUESTED IN DCB.             */ 00168000
*                                                                  0085 00169000
*        IF DCBMACRF(7) = '1'B | DCBMACRF(15) = '1'B THEN   /* XM3766*/ 00170000
         TM    DCBMACRF(RDCB),B'00000010'                          0085 00171000
         BO    @RT00085                                            0085 00172000
         TM    DCBMACRF+1(RDCB),B'00000010'                        0085 00173000
         BNO   @RF00085                                            0085 00174000
@RT00085 DS    0H                                                  0086 00175000
*          DCBCNTRL = EPQCNTRL;         /* SET CNTRL ADDRESS   XM3766*/ 00176000
*                                                                  0086 00177000
         MVC   DCBCNTRL(3,RDCB),EPQCNTRL+1(RMOD)                   0086 00178000
*        /* SET GET ENTRY ADDRESS                                   */  00179000
*                                                                  0087 00180000
*                                       /* OPENED FOR INPUT         */  00181000
*               IF PARCOPOP = '0000'B THEN                         0087 00182000
@RF00085 TM    PARCOPOP(RPARC),B'00001111'                         0087 00183000
         BNZ   @RF00087                                            0087 00184000
*                 DO;                   /* YES - PROCESS INPUT DCB  */  00185000
*                     DCBGET = EPGET;       /* ENTRY FOR CI GET      */ 00186000
*                                                                  0089 00187000
         MVC   DCBGET(3,RDCB),EPGET+1(RMOD)                        0089 00188000
*                     /***********************************************/ 00189000
*                     /*                                             */ 00190000
*                     /* TEST FOR CONCATENATION IN PROGRESS. IF YES, */ 00191000
*                     /* DO NOT LOAD QSAM SYNCHRONIZING MODULE, AS   */ 00192000
*                     /* IT WAS LOADED FOR PREVIOUS DATA SET.        */ 00193000
*                     /*                                             */ 00194000
*                     /***********************************************/ 00195000
*                                                                  0090 00196000
*                     IF DCBOFLGS(3) = '0'B/*                      0090 00197000
*                                          CONCATENATION IND. ?     */  00198000
*                       THEN            /* NOT CONCATENATION        */  00199000
         TM    DCBOFLGS(RDCB),B'00100000'                          0090 00200000
         BNZ   @RF00090                                            0090 00201000
*                            DO;                                   0091 00202000
*                                                                  0091 00203000
*                         /******************************************/  00204000
*                         /* LOAD QSAM SYNCHRONIZING MODULE         */  00205000
*                         /******************************************/  00206000
*                                                                  0092 00207000
*                         /* SET NAME AND DCB ADDR OF MODULE TO LOAD*/  00208000
*                         R1 = CVTLINK;                   /* ZA02501*/  00209000
         L     @04,CVTPTR                                          0092 00210000
         L     R1,CVTLINK(,@04)                                    0092 00211000
*                         WTGMDNAM = 'IGG019AQ';                   0093 00212000
         MVC   WTGMDNAM(8,RWTG),@CC00391                           0093 00213000
*                         GEN (LOAD EPLOC=(RWTG),DCB=(R1)); /*ZA02501*/ 00214000
*                                                                  0094 00215000
         LOAD EPLOC=(RWTG),DCB=(R1)                                     00216000
*                         /* RESET MODULE NAME IN WTG TABLE          */ 00217000
*                         WTGMDNAM = 'IGG0198L';                   0095 00218000
*                                                                  0095 00219000
         MVC   WTGMDNAM(8,RWTG),@CC00382                           0095 00220000
*                         /* ENTRY FOR QSAM SYNCHRONIZING MODULE     */ 00221000
*                         DCBGERR = R0;                            0096 00222000
         STCM  R0,7,DCBGERR(RDCB)                                  0096 00223000
*                         ATFSYNC = '1'B;/*                        0097 00224000
*                                          SET SYNC MOD LOADED Y02144*/ 00225000
         OI    ATFSYNC(RCORE),B'00000010'                          0097 00226000
*                            END;           /* END OF NOT CONCAT GRP */ 00227000
*                       ELSE;           /* CONCAT IS INDICATED      */  00228000
@RF00090 DS    0H                                                  0100 00229000
*                            END;       /* END OF INPUT GROUP       */  00230000
*                   ELSE                /* NOT INPUT                */  00231000
*                                                                  0101 00232000
*        /* SET PUT ENTRY ADDRESS                                   */  00233000
*                                                                  0101 00234000
*               DCBPUT = EPPUT;         /* SET PUT RTN ADDR         */  00235000
         B     @RC00087                                            0101 00236000
@RF00087 MVC   DCBPUT(3,RDCB),EPPUT+1(RMOD)                        0101 00237000
*                 END;                  /* END OF ¬BSAM DCB GROUP   */  00238000
@RC00087 DS    0H                                                  0103 00239000
*        /***********************************************************/  00240000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00241000
@RC00047 DS    0H                                                  0103 00242000
         EJECT                                                          00243000
*        /***********************************************************/  00244000
*        /*                                                         */  00245000
*        /* PERFORM HOUSEKEEPING FUNCTIONS ON SAM DCB               */  00246000
*        /*                                                         */  00247000
*        /***********************************************************/  00248000
*                                                                  0104 00249000
*                                                                  0104 00250000
*        /* SET CI BIT ON                                           */  00251000
*        DCBCIND1(5)   = '1'B;                                     0104 00252000
*                                                                  0104 00253000
         OI    DCBCIND1(RDCB),B'00001000'                          0104 00254000
*        /***********************************************************/  00255000
*        /*         USER KEY REQUIRED TO REFRESH USER'S DCB         */  00256000
*        /***********************************************************/  00257000
*                                                                  0105 00258000
*        RDCBSAVE = RDCB;           /* SAVE CONTENTS OF REG 2 Y02082*/  00259000
         LR    RDCBSAVE,RDCB                                       0105 00260000
*        RUKEY = DXUKEY;            /*  USER KEY IN REG 2     Y02082*/  00261000
         SLR   RUKEY,RUKEY                                         0106 00262000
         IC    RUKEY,DXUKEY(,RCORE)                                0106 00263000
*        GEN (MODESET KEYADDR=(2)); /*DCB REFRSH REQ USER KEY Y02082*/  00264000
         MODESET KEYADDR=(2)                                            00265000
*        RDCB = RDCBSAVE;           /* RESTORE DCB PTR        Y02082*/  00266000
         LR    RDCB,RDCBSAVE                                       0108 00267000
*        DXUDCBAD -> IFGSDCB(21:88) = IFGSDCB(21:88); /* REFRESH REAL   00268000
*                                   FROM PROTECTED COPY DCB ZA00623*/   00269000
*                                                                  0109 00270000
         L     @04,DXUDCBAD(,RCORE)                                0109 00271000
         MVC   IFGSDCB+20(68,@04),IFGSDCB+20(RDCB)                 0109 00272000
*        /***********************************************************/  00273000
*        /*            REESTABLISH DATA MANAGEMENT KEY              */  00274000
*        /***********************************************************/  00275000
*                                                                  0110 00276000
*        GEN (MODESET EXTKEY=DATAMGT); /* RESET TO DTAMGT KEY Y02082*/  00277000
*                                                                  0110 00278000
         MODESET EXTKEY=DATAMGT                                         00279000
*ZROCHAIN:                                                         0111 00280000
*        XCTLREG = ADDR (IBMCLOSE);        /* ENTRY IN XCTL TABLE   */  00281000
*                                                                  0111 00282000
ZROCHAIN LA    XCTLREG,IBMCLOSE                                    0111 00283000
*        /* ZERO OUT ID OF ENTRY IN WTG TABLE                       */  00284000
*        WTGCID = XCTLID;                                          0112 00285000
*                                                                  0112 00286000
         MVC   WTGCID(2,RWTGC),XCTLID(XCTLREG)                     0112 00287000
*        /* ZERO OUT TTR OF ENTRY IN WTG TABLE                      */  00288000
*        WTGCTTR = XCTLTTR;                                        0113 00289000
*                                                                  0113 00290000
         MVC   WTGCTTR(3,RWTGC),XCTLTTR(XCTLREG)                   0113 00291000
*        /* RESET BASE FOR CICB                                     */  00292000
*        RCICB = DCBCICB;                                          0114 00293000
*                                                                  0114 00294000
         L     RCICB,DCBCICB(,RDCB)                                0114 00295000
*NEXTNTRY:                                                         0115 00296000
*        /* EXAMINE THE REMAINING ENTRIES IN THE WTG TABLE AND OPEN */  00297000
*        /* PARAMETER LIST TO DETERMINE IF THIS MODULE IS NEEDED.   */  00298000
*                                                                  0115 00299000
*        RWTGC = RWTGC + 8;             /* NEXT ENTRY IN WTG TABLE  */  00300000
NEXTNTRY LA    RWTGC,8(,RWTGC)                                     0115 00301000
*        RPARC = RPARC + 4;             /* NEXT ENTRY IN PARM LIST  */  00302000
*                                                                  0116 00303000
         LA    RPARC,4(,RPARC)                                     0116 00304000
*        /* IS THIS MODULE NEEDED                                   */  00305000
*                                                                  0117 00306000
*        IF WTGCID = '8L'                                          0117 00307000
*          THEN                         /* YES                      */  00308000
         CLC   WTGCID(2,RWTGC),@CC00398                            0117 00309000
         BE    @RT00117                                            0117 00310000
*            GO TO PROCESS;             /* GO PROCESS THE DCB       */  00311000
*          ELSE                                                    0119 00312000
*                                                                  0119 00313000
*          /* IS THIS THE END OF THE WTG TABLE                      */  00314000
*                                                                  0119 00315000
*            IF WTGCID = '0S'                                      0119 00316000
*              THEN                     /* YES                      */  00317000
         CLC   WTGCID(2,RWTGC),@CC00399                            0119 00318000
         BE    @RT00119                                            0119 00319000
*                GO TO TRANSFER;        /* GO TO TRANSFER CONTROL   */  00320000
*                                                                  0120 00321000
*              ELSE                     /* NO                       */  00322000
*                GO TO NEXTNTRY;        /* GO CHECK ENTRY ID        */  00323000
         B     NEXTNTRY                                            0121 00324000
*        /***********************************************************/  00325000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00326000
         EJECT                                                          00327000
*TRANSFER:                                                         0123 00328000
*        /* RESET POINTERS IN THE WTG TABLE AND PARM LIST TO THE    */  00329000
*        /* FIRST ENTRIES, AND PREPARE TO TRANSFER CONTROL TO THE   */  00330000
*        /* NEXT LOAD.                                              */  00331000
*                                                                  0123 00332000
*        /* FIRST ENTRY IN THE WTG TABLE                            */  00333000
*        RWTGC = RWTG + 32;                                        0123 00334000
*                                                                  0123 00335000
TRANSFER LA    RWTGC,32(,RWTG)                                     0123 00336000
*        /* FIRST ENTRY IN PARM LIST                                */  00337000
*        RPARC = RPAR;                                             0124 00338000
*                                                                  0124 00339000
         LR    RPARC,RPAR                                          0124 00340000
*CHECKID:                                                          0125 00341000
*        /* CHECK THE ENTRIES IN THE WTG TABLE FOR A NON-ZERO ID    */  00342000
*                                                                  0125 00343000
*        /* IS ID OF CURRENT ENTRY IN WTG TABLE ZERO ?              */  00344000
*                                                                  0125 00345000
*        IF WTGCID(1) = '00'X                                      0125 00346000
*          THEN                         /* YES                      */  00347000
CHECKID  CLI   WTGCID(RWTGC),X'00'                                 0125 00348000
         BNE   @RF00125                                            0125 00349000
*            DO;                        /* STEP TO NEXT ENTRY       */  00350000
*              RWTGC = RWTGC + 8;       /* NEXT WTG-TBL ENTRY       */  00351000
         LA    RWTGC,8(,RWTGC)                                     0127 00352000
*              RPARC = RPARC + 4;       /* NEXT PARM-LIST ENTRY     */  00353000
         LA    RPARC,4(,RPARC)                                     0128 00354000
*              GO TO CHECKID;           /* GO CHECK NEXT ENTRY      */  00355000
         B     CHECKID                                             0129 00356000
*            END;                                                  0130 00357000
*                                                                  0130 00358000
*          ELSE                         /* ID IS NOT ZERO           */  00359000
*            DO;                                                   0131 00360000
@RF00125 DS    0H                                                  0132 00361000
*              WTGID = WTGCID;          /* MOVE ID TO BASIC SECTION */  00362000
         MVC   WTGID(2,RWTG),WTGCID(RWTGC)                         0132 00363000
*              WTGTTR = WTGCTTR;        /* MOVE TTR                 */  00364000
         MVC   WTGTTR(3,RWTG),WTGCTTR(RWTGC)                       0133 00365000
*            END;                                                  0134 00366000
*                                                                  0134 00367000
*        R15 = ADDR (DXCCW1);           /* PARM LIST ADDR      Y02082*/ 00368000
         LA    R15,DXCCW1(,RCORE)                                  0135 00369000
*        GEN (XCTL  EPLOC=(RWTG),SF=(E,(15)),DCB=0); /* LOAD   Y02082*/ 00370000
*                                                                  0136 00371000
*                                                                  0136 00372000
         XCTL  EPLOC=(RWTG),SF=(E,(15)),DCB=0                           00373000
*        END IGG0198L                   /* END OF MODULE            */  00374000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 00375000
*/*%INCLUDE SYSLIB  (IECDSECT)                                        * 00376000
*/*%INCLUDE SYSLIB  (IFGSDCB )                                        * 00377000
*/*%INCLUDE SYSLIB  (IFGJCICB)                                        * 00378000
*;                                                                 0137 00379000
@EL00001 DS    0H                                                  0137 00380000
@EF00001 DS    0H                                                  0137 00381000
@ER00001 BR    @14                                                 0137 00382000
@DATA    DS    0H                                                       00383000
@DATD    DSECT                                                          00384000
         DS    0F                                                       00385000
@ZTEMPS  DS    C                                                        00386000
@ZTEMPND EQU   *                                                        00387000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         00388000
@TEMPS   EQU   @ZTEMPS                                                  00389000
@L       EQU   @ZLEN                                                    00390000
IGG0198L CSECT                                                          00391000
         DS    0F                                                       00392000
@DATD    DSECT                                                          00393000
         DS    0D                                                       00394000
IGG0198L CSECT                                                          00395000
         DS    0F                                                       00396000
@SIZDATD DC    AL1(0)                                                   00397000
         DC    AL3(@ENDDATD-@DATD)                                      00398000
@SIZ001  EQU   @SIZDATD                                                 00399000
         DS    0D                                                       00400000
@CC00381 DC    C'IGG019DK'                                              00401000
@CC00382 DC    C'IGG0198L'                                              00402000
@CC00387 DC    C'IGG019BB'                                              00403000
@CC00390 DC    C'IGG019DJ'                                              00404000
@CC00391 DC    C'IGG019AQ'                                              00405000
@CC00398 DC    C'8L'                                                    00406000
@CC00399 DC    C'0S'                                                    00407000
@DATD    DSECT                                                          00408000
IGG0198L CSECT                                                          00409000
         ORG   IGG0198L+736             START OF XCTL        @ZA02890   00410000
XCTLTABL EQU   *                                                        00411000
IBMCLOSE DC    X'0000'                  INDICATE NO NEXT LOAD           00412000
         DC    X'00000000'              INDICATE NO NEXT LOAD           00413000
         DC    X'0000'                  END OF TABLE                    00414000
         DC    XL4'0'                   PAD TO LEAVE 4 BYTES            00415000
         DC    C'019'                   SVC CODE                        00416000
         DC    X'7E'                    DISPLACEMENT TO TABLE           00417000
@DATD    DSECT                                                          00418000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00419000
@ENDDATD EQU   *                                                        00420000
@DATEND  EQU   *                                                        00421000
IGG0198L CSECT                                                          00422000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00423000
@01      EQU   01                                                       00424000
@02      EQU   02                                                       00425000
@03      EQU   03                                                       00426000
@04      EQU   04                                                       00427000
@05      EQU   05                                                       00428000
@06      EQU   06                                                       00429000
@07      EQU   07                                                       00430000
@08      EQU   08                                                       00431000
@09      EQU   09                                                       00432000
@10      EQU   10                                                       00433000
@11      EQU   11                                                       00434000
@12      EQU   12                                                       00435000
@13      EQU   13                                                       00436000
@14      EQU   14                                                       00437000
@15      EQU   15                                                       00438000
@0       EQU   00                                                       00439000
@1       EQU   01                                                       00440000
@2       EQU   02                                                       00441000
@3       EQU   03                                                       00442000
@4       EQU   04                                                       00443000
@5       EQU   05                                                       00444000
@6       EQU   06                                                       00445000
@7       EQU   07                                                       00446000
@8       EQU   08                                                       00447000
@9       EQU   09                                                       00448000
@A       EQU   10                                                       00449000
@B       EQU   11                                                       00450000
@C       EQU   12                                                       00451000
@D       EQU   13                                                       00452000
@E       EQU   14                                                       00453000
@F       EQU   15                                                       00454000
R0       EQU   @00                                                      00455000
R1       EQU   @01                                                      00456000
RDCB     EQU   @02                                                      00457000
RUKEY    EQU   @02                                                      00458000
RCORE    EQU   @03                                                      00459000
RTIOT    EQU   @04                                                      00460000
RMOD     EQU   @04                                                      00461000
RPAR     EQU   @05                                                      00462000
RWTG     EQU   @06                                                      00463000
RPARC    EQU   @07                                                      00464000
RWTGC    EQU   @08                                                      00465000
RCICB    EQU   @09                                                      00466000
XCTLREG  EQU   @09                                                      00467000
RDCBSAVE EQU   @09                                                      00468000
R15      EQU   @15                                                      00469000
CVTPTR   EQU   16                                                       00470000
WTG      EQU   0                                                        00471000
WTGMDNAM EQU   WTG                                                      00472000
WTGID    EQU   WTGMDNAM+6                                               00473000
WTGTTR   EQU   WTG+14                                                   00474000
WTGC     EQU   0                                                        00475000
WTGCID   EQU   WTGC                                                     00476000
WTGCTTR  EQU   WTGC+2                                                   00477000
WTGCWA   EQU   WTGC+5                                                   00478000
PARCNTRY EQU   0                                                        00479000
PARCOPT  EQU   PARCNTRY                                                 00480000
PARCOPOP EQU   PARCOPT                                                  00481000
PARCDCB  EQU   PARCNTRY+1                                               00482000
XCTLNTRY EQU   0                                                        00483000
XCTLID   EQU   XCTLNTRY                                                 00484000
XCTLTTR  EQU   XCTLNTRY+2                                               00485000
CVTTCBDW EQU   0                                                        00486000
CVTLINK  EQU   8                                                        00487000
TCBPTR   EQU   4                                                        00488000
FORCORE  EQU   0                                                        00489000
DXDSCB   EQU   FORCORE                                                  00490000
DXDAADDR EQU   FORCORE+312                                              00491000
DXDCB    EQU   FORCORE+320                                              00492000
DXCCW    EQU   FORCORE+368                                              00493000
DXCCW1   EQU   DXCCW                                                    00494000
DXVOLSR  EQU   FORCORE+500                                              00495000
DXVOLSR1 EQU   DXVOLSR                                                  00496000
DXVOLSR2 EQU   DXVOLSR+6                                                00497000
DXVOLSR3 EQU   DXVOLSR+12                                               00498000
DXUKEY   EQU   FORCORE+526                                              00499000
DXUCBSAV EQU   FORCORE+564                                              00500000
DXUDCBAD EQU   FORCORE+568                                              00501000
DXPDCBAD EQU   FORCORE+572                                              00502000
DXATCOM1 EQU   FORCORE+588                                              00503000
DXATGENS EQU   DXATCOM1                                                 00504000
DXATVGIV EQU   DXATGENS                                                 00505000
DXATOUTA EQU   DXATCOM1+2                                               00506000
DXATDACC EQU   DXATCOM1+3                                               00507000
DXATCOM2 EQU   FORCORE+592                                              00508000
DXATEOV  EQU   DXATCOM2                                                 00509000
DXATOPEN EQU   DXATCOM2+1                                               00510000
DXATALL  EQU   DXATCOM2+2                                               00511000
DXATEXC1 EQU   FORCORE+604                                              00512000
DXATEXB1 EQU   DXATEXC1                                                 00513000
DXATEXC2 EQU   FORCORE+608                                              00514000
IFGSDCB  EQU   0                                                        00515000
DCBBUFCB EQU   IFGSDCB+20                                               00516000
DCBIOBAD EQU   IFGSDCB+28                                               00517000
@NM00017 EQU   IFGSDCB+32                                               00518000
DCBHIARC EQU   @NM00017                                                 00519000
DCBBFTEK EQU   DCBHIARC                                                 00520000
DCBDDNAM EQU   IFGSDCB+40                                               00521000
DCBMACRF EQU   DCBDDNAM+2                                               00522000
DCBOFLGS EQU   IFGSDCB+48                                               00523000
DCBREAD  EQU   IFGSDCB+49                                               00524000
DCBWRITE EQU   DCBREAD                                                  00525000
DCBGET   EQU   DCBWRITE                                                 00526000
DCBPUT   EQU   DCBGET                                                   00527000
DCBCHECK EQU   IFGSDCB+53                                               00528000
DCBGERR  EQU   DCBCHECK                                                 00529000
DCBCIND1 EQU   IFGSDCB+60                                               00530000
DCBCIND2 EQU   IFGSDCB+61                                               00531000
DCBIOBA  EQU   IFGSDCB+68                                               00532000
DCBCICB  EQU   DCBIOBA                                                  00533000
DCBEOBAD EQU   IFGSDCB+72                                               00534000
DCBLCCW  EQU   DCBEOBAD                                                 00535000
DCBEOBR  EQU   DCBLCCW                                                  00536000
@NM00018 EQU   IFGSDCB+76                                               00537000
DCBEOBW  EQU   @NM00018                                                 00538000
DCBRECAD EQU   DCBEOBW                                                  00539000
DCBDIRCT EQU   IFGSDCB+80                                               00540000
@NM00019 EQU   IFGSDCB+84                                               00541000
DCBCNTRL EQU   @NM00019+1                                               00542000
DCBNOTE  EQU   DCBCNTRL                                                 00543000
IFGJCICB EQU   0                                                        00544000
CIDUMIOB EQU   IFGJCICB                                                 00545000
CIREGSAV EQU   IFGJCICB+116                                             00546000
CIFLAGS  EQU   IFGJCICB+188                                             00547000
CIFLAG2  EQU   CIFLAGS+1                                                00548000
CIFLAG3  EQU   CIFLAGS+2                                                00549000
CIIOCNT  EQU   IFGJCICB+308                                             00550000
CISVCLST EQU   IFGJCICB+336                                             00551000
CISYNADA EQU   CISVCLST                                                 00552000
CIBLDL   EQU   CISVCLST+4                                               00553000
CIBSP    EQU   CISVCLST+8                                               00554000
CIFEOV   EQU   CISVCLST+12                                              00555000
CISTOW   EQU   CISVCLST+16                                              00556000
BTABLE   EQU   0                                                        00557000
EPREAD   EQU   BTABLE                                                   00558000
EPWRITE  EQU   BTABLE+4                                                 00559000
EPCHECK  EQU   BTABLE+8                                                 00560000
EPCNTRL  EQU   BTABLE+12                                                00561000
QTABLE   EQU   0                                                        00562000
EPGET    EQU   QTABLE                                                   00563000
EPPUT    EQU   QTABLE+4                                                 00564000
EPQCNTRL EQU   QTABLE+8                                                 00565000
TIOEDDNM EQU   0                                                        00566000
TIOTPTR  EQU   12                                                       00567000
ATFLAGS  EQU   DXATEXC1                                                 00568000
ATFOPEN  EQU   ATFLAGS                                                  00569000
ATFQSAM  EQU   ATFOPEN                                                  00570000
ATFBSAM  EQU   ATFOPEN                                                  00571000
ATFSYNC  EQU   ATFOPEN                                                  00572000
ATFCHECK EQU   ATFOPEN                                                  00573000
ATFCLOSE EQU   ATFLAGS+1                                                00574000
DCBDEVTY EQU   IFGSDCB+17                                               00575000
*                                      START UNREFERENCED COMPONENTS    00576000
@NM00028 EQU   ATFCLOSE                                                 00577000
ATFCICBF EQU   ATFCLOSE                                                 00578000
ATFMDMSK EQU   ATFCLOSE                                                 00579000
@NM00027 EQU   ATFOPEN                                                  00580000
ATFABEND EQU   ATFOPEN                                                  00581000
ATFCICBG EQU   ATFOPEN                                                  00582000
EPPOINT  EQU   BTABLE+20                                                00583000
EPNOTE   EQU   BTABLE+16                                                00584000
CISTOWRC EQU   CISTOW                                                   00585000
CIFEOVRC EQU   CIFEOV                                                   00586000
CIBSPRC  EQU   CIBSP                                                    00587000
CIBLDLRC EQU   CIBLDL                                                   00588000
CISYNRC  EQU   CISYNADA                                                 00589000
CIWK2    EQU   IFGJCICB+332                                             00590000
CIWK1    EQU   IFGJCICB+328                                             00591000
CISAMWA  EQU   IFGJCICB+324                                             00592000
CIRECPTR EQU   IFGJCICB+320                                             00593000
CIRAREA  EQU   IFGJCICB+316                                             00594000
CIBLKPTR EQU   IFGJCICB+312                                             00595000
CISEGLEN EQU   CIIOCNT                                                  00596000
CILWAREA EQU   IFGJCICB+304                                             00597000
CIFDBCK  EQU   IFGJCICB+284                                             00598000
CIRPLEXT EQU   IFGJCICB+268                                             00599000
CIRPL    EQU   IFGJCICB+192                                             00600000
CIFLAG4  EQU   CIFLAGS+3                                                00601000
@NM00026 EQU   CIFLAG3                                                  00602000
CIFPOINT EQU   CIFLAG3                                                  00603000
CIFERROR EQU   CIFLAG3                                                  00604000
CIFVSEOB EQU   CIFLAG3                                                  00605000
CIFVSRI  EQU   CIFLAG3                                                  00606000
CIFRAGM  EQU   CIFLAG3                                                  00607000
CIFCLOSE EQU   CIFLAG3                                                  00608000
CIFFSTP  EQU   CIFLAG3                                                  00609000
@NM00025 EQU   CIFLAG2                                                  00610000
CIFMDEVT EQU   CIFLAG2                                                  00611000
CIFMDSOR EQU   CIFLAG2                                                  00612000
CIFLAG1  EQU   CIFLAGS                                                  00613000
CIREGS   EQU   CIREGSAV+12                                              00614000
CIREGFC  EQU   CIREGSAV+8                                               00615000
CIREGBC  EQU   CIREGSAV+4                                               00616000
@NM00024 EQU   CIREGSAV                                                 00617000
CISYNNAM EQU   IFGJCICB+108                                             00618000
CIACBED  EQU   IFGJCICB+88                                              00619000
CIACBD   EQU   IFGJCICB+32                                              00620000
CIDCBPTR EQU   CIDUMIOB+28                                              00621000
@NM00023 EQU   CIDUMIOB+24                                              00622000
CIRESID  EQU   CIDUMIOB+20                                              00623000
@NM00022 EQU   CIDUMIOB+16                                              00624000
CIECBPTR EQU   CIDUMIOB+12                                              00625000
CIIOB    EQU   CIDUMIOB+8                                               00626000
@NM00021 EQU   CIDUMIOB+5                                               00627000
CIECBCD  EQU   CIDUMIOB+4                                               00628000
CINXTIOB EQU   CIDUMIOB                                                 00629000
DCBEOB   EQU   IFGSDCB+92                                               00630000
DCBPRECL EQU   IFGSDCB+90                                               00631000
@NM00020 EQU   IFGSDCB+88                                               00632000
DCBPOINT EQU   DCBNOTE                                                  00633000
DCBEROPT EQU   @NM00019                                                 00634000
DCBLRECL EQU   IFGSDCB+82                                               00635000
DCBQSWS  EQU   DCBDIRCT                                                 00636000
DCBCCCW  EQU   DCBRECAD                                                 00637000
DCBNCP   EQU   DCBEOBR                                                  00638000
DCBOFFSW EQU   IFGSDCB+67                                               00639000
DCBOFFSR EQU   IFGSDCB+66                                               00640000
DCBWCPL  EQU   IFGSDCB+65                                               00641000
DCBWCPO  EQU   IFGSDCB+64                                               00642000
DCBBLKSI EQU   IFGSDCB+62                                               00643000
DCBSYNAD EQU   IFGSDCB+57                                               00644000
DCBIOBL  EQU   IFGSDCB+56                                               00645000
DCBPERR  EQU   DCBGERR                                                  00646000
DCBOPTCD EQU   IFGSDCB+52                                               00647000
DCBMACR  EQU   DCBPUT+1                                                 00648000
DCBIFLG  EQU   DCBPUT                                                   00649000
DCBDEBAD EQU   DCBDDNAM+5                                               00650000
DCBIFLGS EQU   DCBDDNAM+4                                               00651000
DCBTIOT  EQU   DCBDDNAM                                                 00652000
DCBEXLST EQU   IFGSDCB+37                                               00653000
DCBRECFM EQU   IFGSDCB+36                                               00654000
DCBEODAD EQU   IFGSDCB+33                                               00655000
DCBBFALN EQU   DCBBFTEK                                                 00656000
DCBSVCXL EQU   DCBIOBAD                                                 00657000
DCBDSORG EQU   IFGSDCB+26                                               00658000
DCBBUFL  EQU   IFGSDCB+24                                               00659000
DCBBUFNO EQU   DCBBUFCB                                                 00660000
@NM00016 EQU   IFGSDCB+16                                               00661000
@NM00015 EQU   IFGSDCB                                                  00662000
DSECTSIZ EQU   FORCORE+612                                              00663000
DXATEXB2 EQU   DXATEXC2                                                 00664000
DXEXHASP EQU   DXATEXB1                                                 00665000
DXATCOM4 EQU   FORCORE+600                                              00666000
DXATCOM3 EQU   FORCORE+596                                              00667000
@NM00014 EQU   DXATCOM2+3                                               00668000
@NM00013 EQU   DXATALL                                                  00669000
DXATSWAP EQU   DXATALL                                                  00670000
DXATFC   EQU   DXATALL                                                  00671000
@NM00012 EQU   DXATOPEN                                                 00672000
DXATDFIN EQU   DXATOPEN                                                 00673000
DXATDSIN EQU   DXATOPEN                                                 00674000
DXATMODM EQU   DXATOPEN                                                 00675000
DXATMODE EQU   DXATOPEN                                                 00676000
DXATMODS EQU   DXATOPEN                                                 00677000
DXATIGN  EQU   DXATOPEN                                                 00678000
DXATVCAT EQU   DXATEOV                                                  00679000
DXATDADM EQU   DXATEOV                                                  00680000
DXATREMT EQU   DXATEOV                                                  00681000
DXATDNEW EQU   DXATEOV                                                  00682000
DXATDFRE EQU   DXATEOV                                                  00683000
DXATDCHN EQU   DXATEOV                                                  00684000
DXATNVOL EQU   DXATEOV                                                  00685000
DXATCCAT EQU   DXATEOV                                                  00686000
DXATRDDB EQU   DXATDACC                                                 00687000
DXATEOF  EQU   DXATDACC                                                 00688000
@NM00011 EQU   DXATDACC                                                 00689000
DXATSMF  EQU   DXATDACC                                                 00690000
DXATUPDB EQU   DXATDACC                                                 00691000
DXATDRCT EQU   DXATDACC                                                 00692000
DXATTRAK EQU   DXATDACC                                                 00693000
DXATF1CE EQU   DXATDACC                                                 00694000
DXATNSL  EQU   DXATOUTA                                                 00695000
DXATTTM2 EQU   DXATOUTA                                                 00696000
DXATTTM1 EQU   DXATOUTA                                                 00697000
DXATTRL2 EQU   DXATOUTA                                                 00698000
DXATTRL1 EQU   DXATOUTA                                                 00699000
DXATDATM EQU   DXATOUTA                                                 00700000
DXATHDTM EQU   DXATOUTA                                                 00701000
DXATVLHD EQU   DXATOUTA                                                 00702000
DXATCLOS EQU   DXATCOM1+1                                               00703000
DXATSRET EQU   DXATGENS                                                 00704000
DXATVCIG EQU   DXATVGIV                                                 00705000
DXATVTMG EQU   DXATVGIV                                                 00706000
DXATVSMG EQU   DXATVGIV                                                 00707000
DXATJFCB EQU   DXATGENS                                                 00708000
DXATDISP EQU   DXATGENS                                                 00709000
DXATREFR EQU   DXATGENS                                                 00710000
DXATDMCT EQU   DXATGENS                                                 00711000
DXMSGADR EQU   FORCORE+584                                              00712000
DXPRPARC EQU   FORCORE+580                                              00713000
DXUDCBML EQU   FORCORE+578                                              00714000
DXUDCBPL EQU   FORCORE+576                                              00715000
DXPACBAD EQU   DXPDCBAD+1                                               00716000
@NM00010 EQU   DXPDCBAD                                                 00717000
DXUACBAD EQU   DXUDCBAD+1                                               00718000
@NM00009 EQU   DXUDCBAD                                                 00719000
DXUCBSVV EQU   DXUCBSAV+1                                               00720000
@NM00008 EQU   DXUCBSAV                                                 00721000
DXUCBADR EQU   FORCORE+560                                              00722000
DXTIOTAD EQU   FORCORE+556                                              00723000
DXDEBXAD EQU   FORCORE+552                                              00724000
DXDSAB   EQU   FORCORE+548                                              00725000
DXDSABAD EQU   FORCORE+544                                              00726000
DXDSABQD EQU   FORCORE+540                                              00727000
DXJSCBAD EQU   FORCORE+536                                              00728000
DXTCBADR EQU   FORCORE+532                                              00729000
DXASCBAD EQU   FORCORE+528                                              00730000
DXEXTSW  EQU   FORCORE+527                                              00731000
DXWKEYSV EQU   FORCORE+525                                              00732000
DXRESSW  EQU   FORCORE+524                                              00733000
DXUNITOF EQU   FORCORE+522                                              00734000
DXNOUNIT EQU   FORCORE+520                                              00735000
DXVOLSEQ EQU   FORCORE+518                                              00736000
DXVOLMT3 EQU   DXVOLSR3                                                 00737000
DXVOLMT2 EQU   DXVOLSR2                                                 00738000
DXVOLMT1 EQU   DXVOLSR1                                                 00739000
DXWORK4  EQU   FORCORE+496                                              00740000
DXWORK3  EQU   FORCORE+492                                              00741000
DXWORK2  EQU   FORCORE+488                                              00742000
DXWORK1  EQU   FORCORE+484                                              00743000
DXWORK   EQU   FORCORE+480                                              00744000
DXXCTL   EQU   FORCORE+472                                              00745000
@NM00007 EQU   FORCORE+464                                              00746000
DXCCW12  EQU   DXCCW+88                                                 00747000
DXCCW11  EQU   DXCCW+80                                                 00748000
DXCCW10  EQU   DXCCW+72                                                 00749000
DXCCW9   EQU   DXCCW+64                                                 00750000
DXCCW8   EQU   DXCCW+56                                                 00751000
DXCCW7   EQU   DXCCW+48                                                 00752000
DXCCW6   EQU   DXCCW+40                                                 00753000
DXCCW5   EQU   DXCCW+32                                                 00754000
DXCCW4   EQU   DXCCW+24                                                 00755000
DXCCW3   EQU   DXCCW+16                                                 00756000
DXCCW2   EQU   DXCCW+8                                                  00757000
DXDCBDEB EQU   DXDCB+44                                                 00758000
@NM00006 EQU   DXDCB+24                                                 00759000
DXDEBDCB EQU   DXDCB+20                                                 00760000
@NM00005 EQU   DXDCB                                                    00761000
DXDEB    EQU   DXDAADDR+4                                               00762000
@NM00004 EQU   DXDAADDR                                                 00763000
DXIOB    EQU   FORCORE+280                                              00764000
DXECB    EQU   FORCORE+276                                              00765000
DXJBF    EQU   FORCORE+100                                              00766000
DSCCORE  EQU   FORCORE+96                                               00767000
DXLBL    EQU   DXDSCB                                                   00768000
@NM00003 EQU   PARCOPT                                                  00769000
@NM00002 EQU   WTG+8                                                    00770000
@NM00001 EQU   WTGMDNAM                                                 00771000
*                                      END UNREFERENCED COMPONENTS      00772000
@RC00058 EQU   @RC00047                                                 00773000
@RT00117 EQU   PROCESS                                                  00774000
@RT00119 EQU   TRANSFER                                                 00775000
@RF00119 EQU   NEXTNTRY                                                 00776000
@EL01    EQU   @EL00001                                                 00777000
@ENDDATA EQU   *                                                        00778000
         END   IGG0198L,(C'PLS1819',0701,76329)                         00779000
./  ADD  SSI=80760136,NAME=IGG0199F
         TITLE 'IGG0199F --- SAM-SI OPEN EXECUTOR                      *00001000
                        '                                               00002000
         EJECT                                                          00003000
IGG0199F CSECT ,                                                   0002 00004000
@PROLOG  BALR  @11,0                                               0002 00005000
@PSTART  DS    0H                                                  0002 00006000
         USING @PSTART,@11                                         0002 00007000
         EJECT                                                          00008000
         EJECT                                                          00009000
         EJECT                                                          00010000
         EJECT                                                          00011000
         EJECT                                                          00012000
         EJECT                                                          00013000
         EJECT                                                          00014000
*                                                                  0048 00015000
         MODESET EXTKEY=DATAMGT                                         00016000
*        RPARC = RPAR;                  /* START AT TOP OF LIST     */  00017000
         LR    RPARC,RPAR                                          0049 00018000
*        WTGTBLEN = 0;                  /* INIT DCB COUNT    @YA02120*/ 00019000
*                                                                  0050 00020000
         MVI   WTGTBLEN(RWTG),X'00'                                0050 00021000
*        /* NOTE: FOR VS2-2, THE WTGTBLEN FIELD IS NO LONGER SET     */ 00022000
*        /* BY COMMON OPEN TO CONTAIN THE LENGTH (IN DOUBLEWORDS)    */ 00023000
*        /* OF THE WTG TABLE. THE SAM-SI EXECUTORS NOW USE THIS      */ 00024000
*        /* FIELD TO SAVE THE COUNT OF SPOOL DCBS IN THE CURRENT     */ 00025000
*        /* OPEN LIST.                                               */ 00026000
*                                                                  0051 00027000
*SCANLOOP:                                                         0051 00028000
*        DO RWTGC = ADDR(WTG1ENT) BY LENGTH(WTGC);                 0051 00029000
SCANLOOP LA    RWTGC,WTG1ENT(,RWTG)                                0051 00030000
@DL00051 DS    0H                                                  0052 00031000
*                                       /* IS THIS MODULE           */  00032000
*        IF WTGCID = '9F'               /*   NEEDED FOR DCB         */  00033000
*          THEN                         /* YES                      */  00034000
         CLC   WTGCID(2,RWTGC),@CC00379                            0052 00035000
         BNE   @RF00052                                            0052 00036000
*            DO;                                                   0053 00037000
*              WTGTBLEN = WTGTBLEN + 1; /* INCREMENT DCB CNT @YA02120*/ 00038000
         LA    @12,1                                               0054 00039000
         SLR   @10,@10                                             0054 00040000
         IC    @10,WTGTBLEN(,RWTG)                                 0054 00041000
         ALR   @12,@10                                             0054 00042000
         STC   @12,WTGTBLEN(,RWTG)                                 0054 00043000
*              R13 = ADDR(DXCCW(1));    /* USE CCW1-CCW9 AS SAVEAREA*/  00044000
         L     R13,WTGCWA-1(,RWTGC)                                0055 00045000
         LA    R13,0(,R13)                                         0055 00046000
         LA    R13,DXCCW(,R13)                                     0055 00047000
*              CALL PROCESS;            /* PROCESS THE CURRENT DCB  */  00048000
         BAL   @14,PROCESS                                         0056 00049000
*              WTGCID = XCTLID;         /* INDICATE NEXT LOAD FOR IT*/  00050000
         MVC   WTGCID(2,RWTGC),XCTLID                              0057 00051000
*              WTGCTTR = XCTLTTR;                                  0058 00052000
         MVC   WTGCTTR(3,RWTGC),XCTLTTR                            0058 00053000
*            END;                                                  0059 00054000
*                                                                  0059 00055000
*        IF WTGID = '9F'                /* NO NEXT MOD SELECTED YET */  00056000
*          & WTGCID(1) ¬= '00'X         /* CURRENT DCB NEEDS MORE   */  00057000
*          THEN                         /* YES                      */  00058000
@RF00052 CLC   WTGID(2,RWTG),@CC00379                              0060 00059000
         BNE   @RF00060                                            0060 00060000
         CLI   WTGCID(RWTGC),X'00'                                 0060 00061000
         BE    @RF00060                                            0060 00062000
*            DO;                        /* SO SELECT IT             */  00063000
*              WTGID = WTGCID;                                     0062 00064000
         MVC   WTGID(2,RWTG),WTGCID(RWTGC)                         0062 00065000
*              WTGTTR = RPARC - RPAR;   /* SAVE OFFSET TEMPORARILY  */  00066000
         LR    @12,RPARC                                           0063 00067000
         SLR   @12,RPAR                                            0063 00068000
         STCM  @12,7,WTGTTR(RWTG)                                  0063 00069000
*            END;                                                  0064 00070000
*                                                                  0064 00071000
*        IF WTGCID = '0S'               /* ALL DCBS SCANNED         */  00072000
*          THEN                         /* YES                      */  00073000
@RF00060 CLC   WTGCID(2,RWTGC),@CC00381                            0065 00074000
         BNE   @RF00065                                            0065 00075000
*            DO;                                                   0066 00076000
*              RPARC = RPAR + WTGTTR;   /* USE SAVED OFFSET TO RESET    00077000
*                                          RPARC FOR NEXT MODULE    */  00078000
         SLR   @12,@12                                             0067 00079000
         ICM   @12,7,WTGTTR(RWTG)                                  0067 00080000
         LR    RPARC,RPAR                                          0067 00081000
         ALR   RPARC,@12                                           0067 00082000
*              RWTGC = ADDR(WTG1ENT)    /* ALSO RESET RWTGC         */  00083000
*                      + 2*WTGTTR;      /*(EACH ENTRY TWICE AS LONG)*/  00084000
*                                                                  0068 00085000
         LA    RWTGC,WTG1ENT(,RWTG)                                0068 00086000
         ALR   @12,@12                                             0068 00087000
         ALR   RWTGC,@12                                           0068 00088000
*              WTGTTR = WTGCTTR;        /* NOW SAVE REAL TTR THERE  */  00089000
         MVC   WTGTTR(3,RWTG),WTGCTTR(RWTGC)                       0069 00090000
*              R15 = ADDR(DXCCW(1));    /* GO TO NEXT MODULE        */  00091000
         L     R15,WTGCWA-1(,RWTGC)                                0070 00092000
         LA    R15,0(,R15)                                         0070 00093000
         LA    R15,DXCCW(,R15)                                     0070 00094000
*              GEN (XCTL  EPLOC=(RWTG),SF=(E,(15)),DCB=0);/*@YA02082*/  00095000
         XCTL  EPLOC=(RWTG),SF=(E,(15)),DCB=0                           00096000
*            END;                       /* END OF ALL DCBS SCANNED  */  00097000
*                                                                  0072 00098000
*        RPARC = RPARC + LENGTH(PARCNTRY);                         0073 00099000
*                                                                  0073 00100000
@RF00065 LA    RPARC,4(,RPARC)                                     0073 00101000
*        END SCANLOOP;                  /* CONTINUE SCAN W/NEXT DCB */  00102000
         LA    RWTGC,8(,RWTGC)                                     0074 00103000
         B     @DL00051                                            0074 00104000
*/*******************************************************************/  00105000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00106000
         EJECT                                                          00107000
*/*******************************************************************/  00108000
*PROCESS:                                                          0076 00109000
*  PROCEDURE                                                       0076 00110000
*    OPTIONS(NOSAVEAREA);                                          0076 00111000
*                                                                  0076 00112000
*                                                                  0076 00113000
@EL00001 DS    0H                                                  0076 00114000
@EF00001 DS    0H                                                  0076 00115000
@ER00001 BR    @14                                                 0076 00116000
PROCESS  STM   @14,@12,12(@13)                                     0076 00117000
*        /* RESTRICT THE FOLLOWING REGS FROM USAGE BY THE COMPILER  */  00118000
*        RESTRICT(RDCB,RTEMPS,RPARC,R1,RWTGC,RACB,RCICB);/* @YA02120*/  00119000
*                                                                  0077 00120000
*       /* THE FOLLOWING INSTRUCTION SHOULD BE CHANGED TO           */  00121000
*       /*    RDCB = PARCDCB                                        */  00122000
*       /* WHEN CONCATENATION SUPPORT NO LONGER REQUIRES            */  00123000
*       /* THE FIRST WORD OF THE EXTENDED SAVE AREA AS A            */  00124000
*       /* PARAMETER LIST.  THE CODE HERE WORKS ONLY BECAUSE        */  00125000
*       /* THE DCB IS IN REG 2, THE PARM LIST FOR CONCATENATION     */  00126000
*       /* IS ONLY ONE WORD LONG, AND THE STORE MULTIPLE AT THE     */  00127000
*       /* USER EXIT BEGINS WITH REG 2.                             */  00128000
*                                                                  0078 00129000
*       GEN (L    RDCB,PARCNTRY(RPARC));/* MAKE DCB ADDRESSIBLE     */  00130000
         L    RDCB,PARCNTRY(RPARC)                                      00131000
*       RESPECIFY IFGSDCB BASED(RDCB);                             0079 00132000
*                                                                  0079 00133000
*       /***********************************************************/   00134000
*        /* ISSUE A GETMAIN TO OBTAIN CORE FOR THE CI CONTROL BLOCK */  00135000
*        /***********************************************************/  00136000
*                                                                  0080 00137000
*        RCICB = LENGTH(IFGJCICB);                                 0080 00138000
         LA    RCICB,356                                           0080 00139000
* /**********************************************************@ZA29473*/ 00140000
* /********** TEST FOR INPUT AND DCBRECFM EQUAL FIXED BLOCKED@ZA29473*/ 00141000
* /********** AND DCBNCP NOT EQUAL TO ONE.  IF THESE ARE MET @ZA29473*/ 00142000
* /********** GETMAIN FOR THE PSEUDO IOB.                    @ZA29473*/ 00143000
* /**********************************************************@ZA29473*/ 00144000
*                                                      /*    @ZA29473*/ 00145000
*        IF PARCOPT(5:8)='0000'B | PARCOPT(5:8)='0011'B THEN DO;/* 0081 00146000
*                                                            @ZA29473*/ 00147000
         TM    PARCOPT(RPARC),B'00001111'                          0081 00148000
         BZ    @RT00081                                            0081 00149000
         TM    PARCOPT(RPARC),B'00000011'                          0081 00150000
         BNO   @RF00081                                            0081 00151000
         TM    PARCOPT(RPARC),B'00001100'                          0081 00152000
         BNZ   @RF00081                                            0081 00153000
@RT00081 DS    0H                                                  0082 00154000
*           IF DCBRECFM(1) ¬= '1'B & DCBRECFM(4)¬='1'B /*    @ZA29473*/ 00155000
*           | DCBCIND2(8) ='1'B                        /*    @ZA29473*/ 00156000
*             | DCBNCP¬>1 THEN GO TO GETMAIN;          /*    @ZA29473*/ 00157000
         TM    DCBRECFM(RDCB),B'10010000'                          0083 00158000
         BZ    @RT00083                                            0083 00159000
         TM    DCBCIND2(RDCB),B'00000001'                          0083 00160000
         BO    @RT00083                                            0083 00161000
         CLI   DCBNCP(RDCB),1                                      0083 00162000
         BNH   @RT00083                                            0083 00163000
*                ELSE DO;                              /*    @ZA29473*/ 00164000
*                 RCICB = RCICB + (DCBNCP * 32);       /*    @ZA29473*/ 00165000
         SLR   @10,@10                                             0086 00166000
         IC    @10,DCBNCP(,RDCB)                                   0086 00167000
         SLA   @10,5                                               0086 00168000
         ALR   RCICB,@10                                           0086 00169000
*                         END;                         /*    @ZA29473*/ 00170000
*        END;                                          /*    @ZA29473*/ 00171000
*   GETMAIN:                                           /*    @ZA29473*/ 00172000
*        GEN (GETMAIN R,LV=(RCICB),SP=250);                        0089 00173000
*                                                                  0089 00174000
@RF00081 DS    0H                                                  0089 00175000
GETMAIN  GETMAIN R,LV=(RCICB),SP=250                                    00176000
*        RCICB = R1;                    /* SET BASE FOR CICB        */  00177000
         LR    RCICB,R1                                            0090 00178000
*        DCBCICB = RCICB;               /* CHAIN CICB TO DCB @ZA07733*/ 00179000
         ST    RCICB,DCBCICB(,RDCB)                                0091 00180000
*        RESPECIFY IFGJCICB BASED(RCICB);                          0092 00181000
*                                                                  0092 00182000
*        ATFCICBG = '1'B;               /* DENOTE CICB GOTTEN@YA02144*/ 00183000
*                                                                  0093 00184000
         L     @10,WTGCWA-1(,RWTGC)                                0093 00185000
         LA    @10,0(,@10)                                         0093 00186000
         OI    ATFCICBG(@10),B'10000000'                           0093 00187000
*        /************************************************************/ 00188000
*        /* ASSUME STORAGE KEY OF THE USER IN ORDER TO INITIALIZE    */ 00189000
*        /* ACB AND CICB FIELDS IN USER STORAGE.                     */ 00190000
*        /************************************************************/ 00191000
*                                                                  0094 00192000
*        RTEMPS = RDCB;                 /* SAVE DCB-COPY PTR @YA02082*/ 00193000
         LR    RTEMPS,RDCB                                         0094 00194000
*        RUKEY = DXUKEY;                /* OBTAIN USERS KEY  @YA02082*/ 00195000
         SLR   RUKEY,RUKEY                                         0095 00196000
         IC    RUKEY,DXUKEY(,@10)                                  0095 00197000
*        GEN (MODESET KEYADDR=(2));     /* CHANGE STORAGE KEY@YA02082*/ 00198000
         MODESET KEYADDR=(2)                                            00199000
*        RDCB = RTEMPS;                 /* RESTORE DCB PTR   @YA02082*/ 00200000
*                                                                  0097 00201000
         LR    RDCB,RTEMPS                                         0097 00202000
*        /* CLEAR CORE OBTAINED                                     */  00203000
*        IFGJCICB(1:256) = IFGJCICB(1:256) && IFGJCICB(1:256);/*   0098 00204000
*                                          CLEAR FIRST PART         */  00205000
         XC    IFGJCICB(256,RCICB),IFGJCICB(RCICB)                 0098 00206000
*        IFGJCICB(257:LENGTH(IFGJCICB)) =  IFGJCICB;               0099 00207000
         MVC   IFGJCICB+256(100,RCICB),IFGJCICB(RCICB)             0099 00208000
* /**********************************************************@ZA29473*/ 00209000
* /* TEST FOR INPUT AND DCBRECFM EQUAL FIX BLOCKED AND       @ZA29473*/ 00210000
* /* DCBNCP NOT EQUAL TO ONE - IF YES - BUILD PSEUDO IOBS    @ZA29473*/ 00211000
* /**********************************************************@ZA29473*/ 00212000
*                                                        /*  @ZA29473*/ 00213000
*        IF(PARCOPT(5:8)='0000'B | PARCOPT(5:8)='0011'B)  &/*      0100 00214000
*                                                            @ZA29473*/ 00215000
*           DCBRECFM(1) = '1'B & DCBRECFM(4) = '1'B      /*  @ZA29473*/ 00216000
*        & DCBNCP  > 1 & DCBCIND2(8) ¬= '1'B THEN DO;    /*  @ZA29473*/ 00217000
         TM    PARCOPT(RPARC),B'00001111'                          0100 00218000
         BZ    @GL00007                                            0100 00219000
         TM    PARCOPT(RPARC),B'00000011'                          0100 00220000
         BNO   @RF00100                                            0100 00221000
         TM    PARCOPT(RPARC),B'00001100'                          0100 00222000
         BNZ   @RF00100                                            0100 00223000
@GL00007 TM    DCBRECFM(RDCB),B'10010000'                          0100 00224000
         BNO   @RF00100                                            0100 00225000
         CLI   DCBNCP(RDCB),1                                      0100 00226000
         BNH   @RF00100                                            0100 00227000
         TM    DCBCIND2(RDCB),B'00000001'                          0100 00228000
         BO    @RF00100                                            0100 00229000
*             CIRESID = ADDR(IFGJCICB)+LENGTH(IFGJCICB); /*  @ZA29473*/ 00230000
         LA    @10,356                                             0102 00231000
         ALR   @10,RCICB                                           0102 00232000
         ST    @10,CIRESID(,RCICB)                                 0102 00233000
*        RACB = CIRESID;                                 /*  @ZA29473*/ 00234000
         LR    RACB,@10                                            0103 00235000
*        RFY DUMMYIO  BASED (RACB);                      /*  @ZA29473*/ 00236000
*        CIWK2 = 1;                                      /*  @ZA29473*/ 00237000
         MVC   CIWK2(4,RCICB),@CF00093                             0105 00238000
*        DO WHILE CIWK2  ¬= DCBNCP;                      /*  @ZA29473*/ 00239000
         B     @DE00106                                            0106 00240000
@DL00106 DS    0H                                                  0107 00241000
*        DUMMYIO  = DUMMYIO && DUMMYIO;                  /*  @ZA29473*/ 00242000
         XC    DUMMYIO(32,RACB),DUMMYIO(RACB)                      0107 00243000
*        CIWK2 = CIWK2 + 1;                              /*  @ZA29473*/ 00244000
         LA    @10,1                                               0108 00245000
         AL    @10,CIWK2(,RCICB)                                   0108 00246000
         ST    @10,CIWK2(,RCICB)                                   0108 00247000
*        DUMMYPTR = ADDR(DUMMYPTR) +32;                  /*  @ZA29473*/ 00248000
         LA    @10,32                                              0109 00249000
         LR    @06,RACB                                            0109 00250000
         ALR   @06,@10                                             0109 00251000
         ST    @06,DUMMYPTR(,RACB)                                 0109 00252000
*        DUMMYECB = '40'X;                               /*  @ZA29473*/ 00253000
         MVI   DUMMYECB(RACB),X'40'                                0110 00254000
*        DUMMYEPT = ADDR(DUMMYECB);                      /*  @ZA29473*/ 00255000
         LA    @06,DUMMYECB(,RACB)                                 0111 00256000
         ST    @06,DUMMYEPT(,RACB)                                 0111 00257000
*        DUMMYDCB = RDCB;                                /*  @ZA29473*/ 00258000
         ST    RDCB,DUMMYDCB(,RACB)                                0112 00259000
*        RACB = RACB + 32;                               /*  @ZA29473*/ 00260000
         ALR   RACB,@10                                            0113 00261000
*        END;                                            /*  @ZA29473*/ 00262000
@DE00106 L     @10,CIWK2(,RCICB)                                   0114 00263000
         SLR   @06,@06                                             0114 00264000
         IC    @06,DCBNCP(,RDCB)                                   0114 00265000
         CR    @10,@06                                             0114 00266000
         BNE   @DL00106                                            0114 00267000
*        DUMMYIO = DUMMYIO && DUMMYIO;                   /*  @ZA29473*/ 00268000
         XC    DUMMYIO(32,RACB),DUMMYIO(RACB)                      0115 00269000
*        DUMMYPTR = CIRESID;                             /*  @ZA29473*/ 00270000
         L     @10,CIRESID(,RCICB)                                 0116 00271000
         ST    @10,DUMMYPTR(,RACB)                                 0116 00272000
*        DUMMYECB = '40'X;                               /*  @ZA29473*/ 00273000
         MVI   DUMMYECB(RACB),X'40'                                0117 00274000
*        DUMMYEPT = ADDR(DUMMYECB);                      /*  @ZA29473*/ 00275000
         LA    @10,DUMMYECB(,RACB)                                 0118 00276000
         ST    @10,DUMMYEPT(,RACB)                                 0118 00277000
*        DUMMYDCB = RDCB;                                /*  @ZA29473*/ 00278000
         ST    RDCB,DUMMYDCB(,RACB)                                0119 00279000
*                  END;                                  /*  @ZA29473*/ 00280000
*        ELSE;                                           /*  @ZA29473*/ 00281000
@RF00100 DS    0H                                                  0122 00282000
*        RTEMPS = ADDR(CIWK1);          /* ADDRESSIBILITY FOR       */  00283000
         LA    RTEMPS,CIWK1(,RCICB)                                0122 00284000
*        GEN(USING @DATD,RTEMPS);       /* COMPILER GENERATED TEMPS */  00285000
         USING @DATD,RTEMPS                                             00286000
*        /***********************************************************/  00287000
*        /*                                                         */  00288000
*        /* INITIALIZE DATA ACB                                     */  00289000
*        /*                                                         */  00290000
*        /***********************************************************/  00291000
*                                                                  0124 00292000
*        RACB = ADDR(CIACBD);           /* GET ACB-D BASE POINTER   */  00293000
         LA    RACB,CIACBD(,RCICB)                                 0124 00294000
*        RESPECIFY IFGACB BASED(RACB);                             0125 00295000
*        CIWK2 = RACB;                  /* SAVE ACB BASE            */  00296000
*                                                                  0126 00297000
         ST    RACB,CIWK2(,RCICB)                                  0126 00298000
*        ACBLENG = LENGTH(IFGACB);      /* SET ACB LENGTH   @YA02082*/  00299000
*                                                                  0127 00300000
         MVC   ACBLENG(2,RACB),@CH00221                            0127 00301000
*        ACBEXFG = '1'B;                /* SET LOCK BIT 'OFF' - OPEN*/  00302000
*                                                                  0128 00303000
         OI    ACBEXFG(RACB),B'00000010'                           0128 00304000
*        /***********************************************************/  00305000
*        /* LOCATE DDNAME IN TIOT                                   */  00306000
*        /***********************************************************/  00307000
*                                                                  0129 00308000
*        IF DCBOFLGS(3) = '1'B          /* CONCAT IN PROCESS        */  00309000
*          THEN                         /* YES                      */  00310000
         TM    DCBOFLGS(RDCB),B'00100000'                          0129 00311000
         BNO   @RF00129                                            0129 00312000
*            DO;                                                   0130 00313000
*              ACBTIOT = DCBTIOT;       /* TIOT OFFSET              */  00314000
         LH    @10,DCBTIOT(,RDCB)                                  0131 00315000
         STH   @10,ACBTIOT(,RACB)                                  0131 00316000
*              ACBOFLGS(3) = '1'B;      /* SET CONCAT FLAG          */  00317000
         OI    ACBOFLGS(RACB),B'00100000'                          0132 00318000
*            END;                       /* END OF CONCATENATION     */  00319000
*          ELSE                         /* NO CONCATENATION         */  00320000
*            DO;                                                   0134 00321000
         B     @RC00129                                            0134 00322000
@RF00129 DS    0H                                                  0135 00323000
*              RTIOT = TIOTPTR + DCBTIOT + 4;                      0135 00324000
         L     @10,CVTPTR                                          0135 00325000
         L     @10,CVTTCBDW(,@10)                                  0135 00326000
         L     @10,TCBPTR(,@10)                                    0135 00327000
         LH    RTIOT,DCBTIOT(,RDCB)                                0135 00328000
         AL    RTIOT,TIOTPTR(,@10)                                 0135 00329000
         LA    RTIOT,4(,RTIOT)                                     0135 00330000
*              RESPECIFY TIOEDDNM BASED(RTIOT);                    0136 00331000
*              ACBDDNM = TIOEDDNM;      /* GET DDNAME FROM TIOT     */  00332000
         MVC   ACBDDNM(8,RACB),TIOEDDNM(RTIOT)                     0137 00333000
*              RESPECIFY TIOEDDNM BASED(NOBASE);                   0138 00334000
*            END;                       /* END OF NO CONCATENATION  */  00335000
*/*******************************************************************/  00336000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00337000
@RC00129 DS    0H                                                  0140 00338000
         EJECT                                                          00339000
*                                                                  0141 00340000
*        /***********************************************************/  00341000
*        /* ID FOR ACB                                              */  00342000
*        /***********************************************************/  00343000
*        ACBID = 'A0'X;                                            0141 00344000
*                                                                  0141 00345000
         MVI   ACBID(RACB),X'A0'                                   0141 00346000
*        /***********************************************************/  00347000
*        /* INDICATE  JES DATA SET ORGANIZATION                     */  00348000
*        /***********************************************************/  00349000
*        ACBDORGA = '1'B;                                          0142 00350000
*                                                                  0142 00351000
         OI    ACBDORGA(RACB),B'00001000'                          0142 00352000
*        /***********************************************************/  00353000
*        /* STORE NULL POINTER TO EXIT LIST INTO ACB                */  00354000
*        /***********************************************************/  00355000
*        ACBUEL = 0;                                               0143 00356000
*                                                                  0143 00357000
         SLR   @10,@10                                             0143 00358000
         ST    @10,ACBUEL(,RACB)                                   0143 00359000
*        /***********************************************************/  00360000
*        /* INDICATE PHYSICAL PROCESSING                            */  00361000
*        /***********************************************************/  00362000
*        ACBMACRF(2) = '1'B;                                       0144 00363000
*                                                                  0144 00364000
*        /***********************************************************/  00365000
*        /* INDICATE SEQUENTIAL PROCESSING                          */  00366000
*        /***********************************************************/  00367000
*        ACBMACRF(4) = '1'B;                                       0145 00368000
*                                                                  0145 00369000
         OI    ACBMACRF(RACB),B'01010000'                          0145 00370000
*        /***********************************************************/  00371000
*        /* DETERMINE IF OPENED FOR INPUT OR OUTPUT                 */  00372000
*        /***********************************************************/  00373000
*        IF PARCOPT(5:8)='0000'B | PARCOPT(5:8)='0011'B/*          0146 00374000
*                                          TEST IF INPUT            */  00375000
*          THEN                         /* YES                      */  00376000
         TM    PARCOPT(RPARC),B'00001111'                          0146 00377000
         BZ    @RT00146                                            0146 00378000
         TM    PARCOPT(RPARC),B'00000011'                          0146 00379000
         BNO   @RF00146                                            0146 00380000
         TM    PARCOPT(RPARC),B'00001100'                          0146 00381000
         BNZ   @RF00146                                            0146 00382000
@RT00146 DS    0H                                                  0147 00383000
*            ACBMACRF(6) = '1'B;        /* SET ACBMACRF FOR GET     */  00384000
         OI    ACBMACRF(RACB),B'00000100'                          0147 00385000
*          ELSE                         /* NO                       */  00386000
*            ACBMACRF(7) = '1'B;        /* SET ACBMACRF FOR PUT     */  00387000
         B     @RC00146                                            0148 00388000
@RF00146 OI    ACBMACRF(RACB),B'00000010'                          0148 00389000
*/*******************************************************************/  00390000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00391000
@RC00146 DS    0H                                                  0149 00392000
         EJECT                                                          00393000
*        /***********************************************************/  00394000
*        /*                                                         */  00395000
*        /*    INITIALIZE CICB FIELDS                               */  00396000
*        /*                                                         */  00397000
*        /***********************************************************/  00398000
*                                                                  0150 00399000
*        CISYNNAM = 'IGG019AH';         /* SYNAD EXEC NAME  @YA02082*/  00400000
         MVC   CISYNNAM(8,RCICB),@CC00400                          0150 00401000
*        CIDCBPTR = DXUDCBAD;           /* SET REAL DCB ADDR@YA02082*/  00402000
         L     @10,WTGCWA-1(,RWTGC)                                0151 00403000
         L     @10,DXUDCBAD(,@10)                                  0151 00404000
         ST    @10,CIDCBPTR(,RCICB)                                0151 00405000
*        /*                                IN CICB          @YA02082*/  00406000
*        /* THE FOLLOWING STATEMENTS INITIALIZE CICB FIELDS WHICH  0152 00407000
*          MAY BE ITERPRETED AS AN IOB BY USER PROGRAMS, SINCE THE 0152 00408000
*          CICB IS POINTED TO BY 'DCBIOBA'.  TO PROVIDE COMPATIBILITY   00409000
*          FOR PARALLEL GET AND CERTAIN RPG APPLICATIONS, A POSTED 0152 00410000
*          ECB AND ECB POINTER ARE PROVIDED AT THE APPROPRIATE IOB 0152 00411000
*          OFFSETS, AND THE DUMMY IOB IS CHAINED TO ITSELF (IE LAST).*/ 00412000
*                                                                  0152 00413000
*        CINXTIOB = ADDR(CIDUMIOB);     /* CHAIN PTR IN DUMMY@YA02123*/ 00414000
         ST    RCICB,CINXTIOB(,RCICB)                              0152 00415000
*        CIECBCD = '40'X;               /* MAKE ECB 'POSTED' @YA02123*/ 00416000
         MVI   CIECBCD(RCICB),X'40'                                0153 00417000
*        CIECBPTR = ADDR(CIECBCD);      /* SET ECB POINTER   @YA02123*/ 00418000
*                                                                  0154 00419000
         LA    @10,CIECBCD(,RCICB)                                 0154 00420000
         ST    @10,CIECBPTR(,RCICB)                                0154 00421000
*        /* SAVE THE ORIGINAL DCB DEVICE TYPE CODE IN CICB           */ 00422000
*        CIFLAG2 = CIFLAG2 | (DCBDEVT & '01100000'B);/*            0155 00423000
*                                                            @YA02082*/ 00424000
*                                                                  0155 00425000
         LA    @10,96                                              0155 00426000
         SLR   @06,@06                                             0155 00427000
         IC    @06,DCBDEVT(,RDCB)                                  0155 00428000
         NR    @10,@06                                             0155 00429000
         SLR   @06,@06                                             0155 00430000
         IC    @06,CIFLAG2(,RCICB)                                 0155 00431000
         OR    @10,@06                                             0155 00432000
         STC   @10,CIFLAG2(,RCICB)                                 0155 00433000
*        IF DCBDSORG = '0000'X THEN     /* DSORG NOT SUPPLIED@YA02082*/ 00434000
         CLC   DCBDSORG(2,RDCB),@CB00402                           0156 00435000
         BNE   @RF00156                                            0156 00436000
*          CIFMDSOR = '1'B;             /* THEN DEFAULT IS   @YA02082   00437000
*                                          TO BE PROVIDED    @YA02082*/ 00438000
*                                                                  0157 00439000
         OI    CIFMDSOR(RCICB),B'10000000'                         0157 00440000
*        /* SET RETURN CODES IN THE SVC EXIT LIST. THESE CODES ARE   */ 00441000
*        /* PASSED TO THE USER BY SAM SVCS WHEN THEY ARE ENTERED     */ 00442000
*        /* FOR PROCESSING A SYSIN/SYSOUT DCB.                       */ 00443000
*                                                                  0158 00444000
*        CIBSPRC  = '04'X;              /* BSP RETURN CODE   @YA02082*/ 00445000
@RF00156 MVI   CIBSPRC(RCICB),X'04'                                0158 00446000
*        CISYNRC  = '08'X;              /* SYNADAF RET CODE @YA02082*/  00447000
         MVI   CISYNRC(RCICB),X'08'                                0159 00448000
*        /***********************************************************/  00449000
*        /*                                                         */  00450000
*        /*    INITIALIZE DCB FIELDS                                */  00451000
*        /*                                                         */  00452000
*        /***********************************************************/  00453000
*                                                                  0160 00454000
*        /***********************************************************/  00455000
*        /* REESTABLISH DATA MANAGEMENT KEY FOR PROCESSING ON       */  00456000
*        /* THE COPIED DCB AND FOR RETURN TO MAIN ROUTINE.          */  00457000
*        /***********************************************************/  00458000
*                                                                  0160 00459000
*        GEN (MODESET EXTKEY=DATAMGT);  /* SET DATA MGT KEY @YA02082*/  00460000
*                                                                  0160 00461000
         MODESET EXTKEY=DATAMGT                                         00462000
*        DCBSVCXL = ADDR (CISVCLST);    /* SVC LIST PTR DCB @YA02082*/  00463000
*                                                                  0161 00464000
         LA    @10,CISVCLST(,RCICB)                                0161 00465000
         ST    @10,DCBSVCXL(,RDCB)                                 0161 00466000
*        IF DCBDSORG = '0000'X THEN     /* SET DATA SET ORGANIZATION*/  00467000
         CLC   DCBDSORG(2,RDCB),@CB00402                           0162 00468000
         BNE   @RF00162                                            0162 00469000
*              DCBDSORG = '40'X;        /*  AS PHYSICAL SEQUENTIAL  */  00470000
*                                                                  0163 00471000
         MVI   DCBDSORG+1(RDCB),X'00'                              0163 00472000
         MVI   DCBDSORG(RDCB),X'40'                                0163 00473000
*        DCBDEVT = '02'X;               /* SET DEVICE TYPE = JES    */  00474000
*                                                                  0164 00475000
@RF00162 MVI   DCBDEVT(RDCB),X'02'                                 0164 00476000
*        IF DCBMACRF(2)   = '1'B | DCBMACRF(10)  = '1'B THEN/*     0165 00477000
*                                          IF DCB FOR QSAM, @YA02082*/  00478000
         TM    DCBMACRF(RDCB),B'01000000'                          0165 00479000
         BO    @RT00165                                            0165 00480000
         TM    DCBMACRF+1(RDCB),B'01000000'                        0165 00481000
         BNO   @RF00165                                            0165 00482000
@RT00165 DS    0H                                                  0166 00483000
*          DO;                          /* YES              @YA02082*/  00484000
*            DCBCIND2(8) = '1'B;        /* TURN ON QSAM BIT @YA02082*/  00485000
         OI    DCBCIND2(RDCB),B'00000001'                          0167 00486000
*             IF DCBBUFNO = 0 THEN      /* ZERO BUFFERS?    @ZA08001*/  00487000
         CLI   DCBBUFNO(RDCB),0                                    0168 00488000
         BNE   @RF00168                                            0168 00489000
*             DCBBUFNO = 5;             /* DEFAULT BUFNO=5  @ZA08001*/  00490000
         MVI   DCBBUFNO(RDCB),X'05'                                0169 00491000
*             ELSE;                     /* BUFNO NOT ZERO   @ZA08001*/  00492000
@RF00168 DS    0H                                                  0171 00493000
*          END;                         /* END DO GROUP     @XA03128*/  00494000
*        ELSE;                          /* NOT QSAM         @XA03128*/  00495000
*                                                                  0172 00496000
@RF00165 DS    0H                                                  0173 00497000
*        /* SET DEFAULT VALUES IN DCB FOR SYSIN                     */  00498000
*                                                                  0173 00499000
*        IF PARCOPT(5:8)='0000'B | PARCOPT(5:8)='0011'B/*          0173 00500000
*                                          IS DCB FOR SYSIN         */  00501000
*           THEN DO;                    /* YES                      */  00502000
*                                                                  0173 00503000
         TM    PARCOPT(RPARC),B'00001111'                          0173 00504000
         BZ    @RT00173                                            0173 00505000
         TM    PARCOPT(RPARC),B'00000011'                          0173 00506000
         BNO   @RF00173                                            0173 00507000
         TM    PARCOPT(RPARC),B'00001100'                          0173 00508000
         BNZ   @RF00173                                            0173 00509000
@RT00173 DS    0H                                                  0174 00510000
*             IF DCBBLKSI = 0           /* BLOCKSIZE SPECIFIED ?    */  00511000
*               THEN                    /* NOT SPECIFIED            */  00512000
         LH    @10,DCBBLKSI(,RDCB)                                 0175 00513000
         N     @10,@CF00422                                        0175 00514000
         LTR   @10,@10                                             0175 00515000
         BNZ   @RF00175                                            0175 00516000
*                 DCBBLKSI = 80;        /* SYSIN DEFAULT            */  00517000
*                                                                  0176 00518000
         MVC   DCBBLKSI(2,RDCB),@CH00406                           0176 00519000
*             IF DCBLRECL = 0           /* LRECL SPECIFIED ?        */  00520000
*               THEN                    /* NOT SPECIFIED            */  00521000
@RF00175 LH    @10,DCBLRECL(,RDCB)                                 0177 00522000
         N     @10,@CF00422                                        0177 00523000
         LTR   @10,@10                                             0177 00524000
         BNZ   @RF00177                                            0177 00525000
*                 DCBLRECL = 80;        /* SYSIN DEFAULT            */  00526000
*                                                                  0178 00527000
         MVC   DCBLRECL(2,RDCB),@CH00406                           0178 00528000
*             IF DCBRECFM(1:3) = '000'B/*                          0179 00529000
*                                          RECFM SPECIFIED ?        */  00530000
*               THEN                    /* NOT SPECIFIED            */  00531000
@RF00177 TM    DCBRECFM(RDCB),B'11100000'                          0179 00532000
         BNZ   @RF00179                                            0179 00533000
*                 DCBRECFM(1:2) = '10'B;/* SYSIN DEFAULT            */  00534000
*                                                                  0180 00535000
         NI    DCBRECFM(RDCB),B'10111111'                          0180 00536000
         OI    DCBRECFM(RDCB),B'10000000'                          0180 00537000
*                END;                   /* END OF SYSIN DO GROUP    */  00538000
*        ELSE                           /* DCB IS FOR SYSOUT   Y02082*/ 00539000
*                                                                  0182 00540000
*        /* SET DEFAULT VALUES IN DCB FOR SYSOUT.                    */ 00541000
*          DO;                                                     0182 00542000
         B     @RC00173                                            0182 00543000
@RF00173 DS    0H                                                  0183 00544000
*            IF DCBRECFM(1:3) = '000'B THEN/*                      0183 00545000
*                                          IF RECFM NOT SUPPLD Y02082*/ 00546000
         TM    DCBRECFM(RDCB),B'11100000'                          0183 00547000
         BNZ   @RF00183                                            0183 00548000
*              DCBRECFM(1:2) = '11'B;   /* DEFAULT TO U        Y02082*/ 00549000
*                                                                  0184 00550000
         OI    DCBRECFM(RDCB),B'11000000'                          0184 00551000
*            IF DCBCIND2(8) = '0'B/*                               0185 00552000
*                                          IF BSAM             Y02082*/ 00553000
*               & DCBRECFM(1:2) = '10'B /*  FIXED              Y02082*/ 00554000
*               & DCBRECFM(4)   = '1'B  /*   BLOCKED           Y02082*/ 00555000
*               & DCBLRECL = 0 THEN     /* AND NO LRECL SUPPLD Y02082*/ 00556000
@RF00183 TM    DCBCIND2(RDCB),B'00000001'                          0185 00557000
         BNZ   @RF00185                                            0185 00558000
         TM    DCBRECFM(RDCB),B'10000000'                          0185 00559000
         BNO   @RF00185                                            0185 00560000
         TM    DCBRECFM(RDCB),B'01000000'                          0185 00561000
         BNZ   @RF00185                                            0185 00562000
         TM    DCBRECFM(RDCB),B'00010000'                          0185 00563000
         BNO   @RF00185                                            0185 00564000
         LH    @10,DCBLRECL(,RDCB)                                 0185 00565000
         N     @10,@CF00422                                        0185 00566000
         LTR   @10,@10                                             0185 00567000
         BNZ   @RF00185                                            0185 00568000
*              DCBLRECL = DCBBLKSI;     /* DEFAULT FROM BLKSIZ Y02082*/ 00569000
*                                                                  0186 00570000
         LH    @10,DCBBLKSI(,RDCB)                                 0186 00571000
         N     @10,@CF00422                                        0186 00572000
         STH   @10,DCBLRECL(,RDCB)                                 0186 00573000
*            IF DCBRECFM(1:2) = '01'B  |/* FOR VARIABLE LENGTH Y02082*/ 00574000
*               DCBRECFM(4)   = '1'B    /*  OR BLOCKED FORMAT  Y02082*/ 00575000
*                                THEN;  /* DO NOTHING          Y02082*/ 00576000
@RF00185 TM    DCBRECFM(RDCB),B'01000000'                          0187 00577000
         BNO   @GL00015                                            0187 00578000
         TM    DCBRECFM(RDCB),B'10000000'                          0187 00579000
         BZ    @RT00187                                            0187 00580000
@GL00015 TM    DCBRECFM(RDCB),B'00010000'                          0187 00581000
         BO    @RT00187                                            0187 00582000
*            ELSE                       /* FOR U OR F FORMATS  Y02082*/ 00583000
*              IF DCBLRECL = 0 THEN     /* AND LRECL=0         Y02082*/ 00584000
         LH    @10,DCBLRECL(,RDCB)                                 0189 00585000
         N     @10,@CF00422                                        0189 00586000
         LTR   @10,@10                                             0189 00587000
         BNZ   @RF00189                                            0189 00588000
*                DCBLRECL = DCBBLKSI;   /* DEFAULT FROM BLKSIZ Y02082*/ 00589000
         LH    @10,DCBBLKSI(,RDCB)                                 0190 00590000
         N     @10,@CF00422                                        0190 00591000
         STH   @10,DCBLRECL(,RDCB)                                 0190 00592000
*          END;                         /* END OF SYSOUT GROUP Y02082*/ 00593000
*        END PROCESS;                                              0192 00594000
@EL00002 DS    0H                                                  0192 00595000
@EF00002 DS    0H                                                  0192 00596000
@ER00002 LM    @14,@12,12(@13)                                     0192 00597000
         BR    @14                                                 0192 00598000
*/*******************************************************************/  00599000
*                                                                  0193 00600000
*        END IGG0199F                   /* END OF OPEN MODULE */   0193 00601000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 00602000
*/*%INCLUDE SYSLIB  (IFGSDCB )                                        * 00603000
*/*%INCLUDE SYSLIB  (IFGJCICB)                                        * 00604000
*/*%INCLUDE SYSLIB  (IFGACB  )                                        * 00605000
*;                                                                 0193 00606000
@DATA    DS    0H                                                       00607000
@CH00221 DC    H'76'                                                    00608000
@CH00406 DC    H'80'                                                    00609000
@DATD    DSECT                                                          00610000
         DS    0F                                                       00611000
@ZTEMPS  DS    C                                                        00612000
@ZTEMPND EQU   *                                                        00613000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         00614000
@TEMPS   EQU   @ZTEMPS                                                  00615000
@L       EQU   @ZLEN                                                    00616000
IGG0199F CSECT                                                          00617000
         DS    0F                                                       00618000
@CF00093 DC    F'1'                                                     00619000
@CF00422 DC    XL4'0000FFFF'                                            00620000
@DATD    DSECT                                                          00621000
         DS    0D                                                       00622000
IGG0199F CSECT                                                          00623000
         DS    0F                                                       00624000
@SIZDATD DC    AL1(0)                                                   00625000
         DC    AL3(@ENDDATD-@DATD)                                      00626000
@SIZ001  EQU   @SIZDATD                                                 00627000
         DS    0D                                                       00628000
@CC00400 DC    C'IGG019AH'                                              00629000
@CC00379 DC    C'9F'                                                    00630000
@CC00381 DC    C'0S'                                                    00631000
@CB00402 DC    X'0000'                                                  00632000
         DS    CL2                                                      00633000
LOADLIST DS    CL14                                                     00634000
         ORG   LOADLIST                                                 00635000
@NM00010 DS    CL6                                                      00636000
         ORG   @NM00010                                                 00637000
XCTLID   DC    CL2'9G'                                                  00638000
XCTLTTR  DC    AL3(0)                                                   00639000
XCTLLEN  DC    AL1(0)                                                   00640000
         ORG   LOADLIST+6                                               00641000
@NM00011 DS    CL6                                                      00642000
         ORG   @NM00011                                                 00643000
EXITID   DC    CL2'AH'                                                  00644000
EXITTTR  DC    AL3(0)                                                   00645000
EXITLEN  DC    AL1(0)                                                   00646000
         ORG   LOADLIST+12                                              00647000
@NM00012 DC    AL2(0)                                                   00648000
         ORG   LOADLIST+14                                              00649000
@DATD    DSECT                                                          00650000
IGG0199F CSECT                          CSECT NAME                      00651000
PATCH    EQU   *                                                        00652000
         DS    CL(IGG0199F+1020-PATCH)  AMOUNT OF UNUSED SPACE          00653000
PATCH#   EQU   *-PATCH                  LENGTH OF UNUSED SPACE          00654000
         ORG   PATCH                    ORGIN OF PATCH AREA             00655000
         DC    (PATCH#)C' '             BLANK OUT PATCH AREA            00656000
         DC    C'019'                   SVC CODE                        00657000
         DC    AL1((LOADLIST-IGG0199F)/8) DISPLACEMENT TO TABLE         00658000
@DATD    DSECT                                                          00659000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00660000
@ENDDATD EQU   *                                                        00661000
@DATEND  EQU   *                                                        00662000
IGG0199F CSECT                                                          00663000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00664000
@01      EQU   01                                                       00665000
@02      EQU   02                                                       00666000
@03      EQU   03                                                       00667000
@04      EQU   04                                                       00668000
@05      EQU   05                                                       00669000
@06      EQU   06                                                       00670000
@07      EQU   07                                                       00671000
@08      EQU   08                                                       00672000
@09      EQU   09                                                       00673000
@10      EQU   10                                                       00674000
@11      EQU   11                                                       00675000
@12      EQU   12                                                       00676000
@13      EQU   13                                                       00677000
@14      EQU   14                                                       00678000
@15      EQU   15                                                       00679000
@0       EQU   00                                                       00680000
@1       EQU   01                                                       00681000
@2       EQU   02                                                       00682000
@3       EQU   03                                                       00683000
@4       EQU   04                                                       00684000
@5       EQU   05                                                       00685000
@6       EQU   06                                                       00686000
@7       EQU   07                                                       00687000
@8       EQU   08                                                       00688000
@9       EQU   09                                                       00689000
@A       EQU   10                                                       00690000
@B       EQU   11                                                       00691000
@C       EQU   12                                                       00692000
@D       EQU   13                                                       00693000
@E       EQU   14                                                       00694000
@F       EQU   15                                                       00695000
R1       EQU   @01                                                      00696000
RTIOT    EQU   @01                                                      00697000
RDCB     EQU   @02                                                      00698000
RUKEY    EQU   @02                                                      00699000
RTEMPS   EQU   @03                                                      00700000
RPAR     EQU   @05                                                      00701000
RWTG     EQU   @06                                                      00702000
RPARC    EQU   @07                                                      00703000
RWTGC    EQU   @08                                                      00704000
RACB     EQU   @09                                                      00705000
RCICB    EQU   @12                                                      00706000
R13      EQU   @13                                                      00707000
R15      EQU   @15                                                      00708000
ROPEN    EQU   @04                                                      00709000
ROPENC   EQU   @09                                                      00710000
R0       EQU   @00                                                      00711000
CVTPTR   EQU   16                                                       00712000
WTG      EQU   0                                                        00713000
WTGMDNAM EQU   WTG                                                      00714000
WTGID    EQU   WTGMDNAM+6                                               00715000
WTGTTR   EQU   WTG+14                                                   00716000
WTGTBLEN EQU   WTG+29                                                   00717000
WTG1ENT  EQU   WTG+32                                                   00718000
WTGC     EQU   0                                                        00719000
WTGCID   EQU   WTGC                                                     00720000
WTGCTTR  EQU   WTGC+2                                                   00721000
WTGCWA   EQU   WTGC+5                                                   00722000
PARCNTRY EQU   0                                                        00723000
PARCOPT  EQU   PARCNTRY                                                 00724000
OPENNTRY EQU   0                                                        00725000
IECDSECT EQU   0                                                        00726000
DXCCW    EQU   IECDSECT+368                                             00727000
DXUKEY   EQU   IECDSECT+526                                             00728000
DXUDCBAD EQU   IECDSECT+568                                             00729000
DXATEXC1 EQU   IECDSECT+604                                             00730000
NOBASE   EQU   0                                                        00731000
IFGSDCB  EQU   0                                                        00732000
DCBBUFCB EQU   IFGSDCB+20                                               00733000
DCBBUFNO EQU   DCBBUFCB                                                 00734000
DCBDSORG EQU   IFGSDCB+26                                               00735000
DCBIOBAD EQU   IFGSDCB+28                                               00736000
DCBSVCXL EQU   DCBIOBAD                                                 00737000
@NM00015 EQU   IFGSDCB+32                                               00738000
DCBHIARC EQU   @NM00015                                                 00739000
DCBBFTEK EQU   DCBHIARC                                                 00740000
DCBRECFM EQU   IFGSDCB+36                                               00741000
DCBDDNAM EQU   IFGSDCB+40                                               00742000
DCBTIOT  EQU   DCBDDNAM                                                 00743000
DCBMACRF EQU   DCBDDNAM+2                                               00744000
DCBOFLGS EQU   IFGSDCB+48                                               00745000
DCBREAD  EQU   IFGSDCB+49                                               00746000
DCBWRITE EQU   DCBREAD                                                  00747000
DCBGET   EQU   DCBWRITE                                                 00748000
DCBPUT   EQU   DCBGET                                                   00749000
DCBCHECK EQU   IFGSDCB+53                                               00750000
DCBGERR  EQU   DCBCHECK                                                 00751000
DCBCIND2 EQU   IFGSDCB+61                                               00752000
DCBBLKSI EQU   IFGSDCB+62                                               00753000
DCBIOBA  EQU   IFGSDCB+68                                               00754000
DCBCICB  EQU   DCBIOBA                                                  00755000
DCBEOBAD EQU   IFGSDCB+72                                               00756000
DCBLCCW  EQU   DCBEOBAD                                                 00757000
DCBEOBR  EQU   DCBLCCW                                                  00758000
DCBNCP   EQU   DCBEOBR                                                  00759000
@NM00016 EQU   IFGSDCB+76                                               00760000
DCBEOBW  EQU   @NM00016                                                 00761000
DCBRECAD EQU   DCBEOBW                                                  00762000
DCBDIRCT EQU   IFGSDCB+80                                               00763000
DCBLRECL EQU   IFGSDCB+82                                               00764000
@NM00017 EQU   IFGSDCB+84                                               00765000
DCBCNTRL EQU   @NM00017+1                                               00766000
DCBNOTE  EQU   DCBCNTRL                                                 00767000
IFGJCICB EQU   0                                                        00768000
CIDUMIOB EQU   IFGJCICB                                                 00769000
CINXTIOB EQU   CIDUMIOB                                                 00770000
CIECBCD  EQU   CIDUMIOB+4                                               00771000
CIECBPTR EQU   CIDUMIOB+12                                              00772000
CIRESID  EQU   CIDUMIOB+20                                              00773000
CIDCBPTR EQU   CIDUMIOB+28                                              00774000
CIACBD   EQU   IFGJCICB+32                                              00775000
CISYNNAM EQU   IFGJCICB+108                                             00776000
CIREGSAV EQU   IFGJCICB+116                                             00777000
CIFLAGS  EQU   IFGJCICB+188                                             00778000
CIFLAG2  EQU   CIFLAGS+1                                                00779000
CIFMDSOR EQU   CIFLAG2                                                  00780000
CIFLAG3  EQU   CIFLAGS+2                                                00781000
CIIOCNT  EQU   IFGJCICB+308                                             00782000
CIWK1    EQU   IFGJCICB+328                                             00783000
CIWK2    EQU   IFGJCICB+332                                             00784000
CISVCLST EQU   IFGJCICB+336                                             00785000
CISYNADA EQU   CISVCLST                                                 00786000
CISYNRC  EQU   CISYNADA                                                 00787000
CIBLDL   EQU   CISVCLST+4                                               00788000
CIBSP    EQU   CISVCLST+8                                               00789000
CIBSPRC  EQU   CIBSP                                                    00790000
CIFEOV   EQU   CISVCLST+12                                              00791000
CISTOW   EQU   CISVCLST+16                                              00792000
IFGACB   EQU   0                                                        00793000
ACBCOMN  EQU   IFGACB                                                   00794000
ACBID    EQU   ACBCOMN                                                  00795000
ACBLENG  EQU   ACBCOMN+2                                                00796000
ACBLENG2 EQU   ACBLENG                                                  00797000
ACBAMBL  EQU   ACBCOMN+4                                                00798000
ACBJWA   EQU   ACBAMBL                                                  00799000
ACBMACRF EQU   ACBCOMN+12                                               00800000
ACBMACR1 EQU   ACBMACRF                                                 00801000
ACBADR   EQU   ACBMACR1                                                 00802000
ACBCNV   EQU   ACBMACR1                                                 00803000
ACBMACR2 EQU   ACBMACRF+1                                               00804000
ACBBUFPL EQU   ACBCOMN+20                                               00805000
ACBMACR3 EQU   ACBBUFPL                                                 00806000
ACBRECFM EQU   ACBCOMN+24                                               00807000
ACBCCTYP EQU   ACBCOMN+25                                               00808000
ACBOPT   EQU   ACBCOMN+26                                               00809000
ACBDSORG EQU   ACBOPT                                                   00810000
ACBCROPS EQU   ACBDSORG                                                 00811000
ACBDORGA EQU   ACBDSORG+1                                               00812000
ACBEXLST EQU   ACBCOMN+36                                               00813000
ACBUEL   EQU   ACBEXLST                                                 00814000
ACBDDNM  EQU   ACBCOMN+40                                               00815000
ACBTIOT  EQU   ACBDDNM                                                  00816000
ACBAMETH EQU   ACBDDNM+3                                                00817000
ACBOFLGS EQU   ACBCOMN+48                                               00818000
ACBEXFG  EQU   ACBOFLGS                                                 00819000
ACBIOSFG EQU   ACBOFLGS                                                 00820000
ACBINFLG EQU   ACBCOMN+50                                               00821000
ACBUJFCB EQU   ACBCOMN+52                                               00822000
ACBBLKSZ EQU   ACBCOMN+60                                               00823000
CVTTCBDW EQU   0                                                        00824000
TCBPTR   EQU   4                                                        00825000
TIOTPTR  EQU   12                                                       00826000
TIOEDDNM EQU   0                                                        00827000
DUMMYIO  EQU   0                                                        00828000
DUMMYPTR EQU   DUMMYIO                                                  00829000
DUMMYECB EQU   DUMMYIO+4                                                00830000
DUMMYEPT EQU   DUMMYIO+12                                               00831000
DUMMYDCB EQU   DUMMYIO+28                                               00832000
SVCDCBPT EQU   84                                                       00833000
DCBDEVT  EQU   IFGSDCB+17                                               00834000
ATFLAGS  EQU   DXATEXC1                                                 00835000
ATFOPEN  EQU   ATFLAGS                                                  00836000
ATFCICBG EQU   ATFOPEN                                                  00837000
ATFCLOSE EQU   ATFLAGS+1                                                00838000
*                                      START UNREFERENCED COMPONENTS    00839000
@NM00036 EQU   ATFCLOSE                                                 00840000
ATFCICBF EQU   ATFCLOSE                                                 00841000
ATFMDMSK EQU   ATFCLOSE                                                 00842000
ATFCHECK EQU   ATFOPEN                                                  00843000
ATFSYNC  EQU   ATFOPEN                                                  00844000
ATFBSAM  EQU   ATFOPEN                                                  00845000
ATFQSAM  EQU   ATFOPEN                                                  00846000
@NM00035 EQU   ATFOPEN                                                  00847000
ATFABEND EQU   ATFOPEN                                                  00848000
@NM00039 EQU   DUMMYIO+24                                               00849000
DUMMYCNT EQU   DUMMYIO+20                                               00850000
@NM00038 EQU   DUMMYIO+16                                               00851000
DUMMYIOB EQU   DUMMYIO+8                                                00852000
@NM00037 EQU   DUMMYIO+5                                                00853000
ACBAPID  EQU   ACBCOMN+72                                               00854000
ACBCBMWA EQU   ACBCOMN+68                                               00855000
ACBUAPTR EQU   ACBCOMN+64                                               00856000
ACBLRECL EQU   ACBCOMN+62                                               00857000
ACBMSGLN EQU   ACBBLKSZ                                                 00858000
ACBBUFSP EQU   ACBCOMN+56                                               00859000
@NM00034 EQU   ACBUJFCB+1                                               00860000
ACBOPTN  EQU   ACBUJFCB                                                 00861000
ACBVVIC  EQU   ACBINFLG                                                 00862000
ACBUCRA  EQU   ACBINFLG                                                 00863000
ACBSCRA  EQU   ACBINFLG                                                 00864000
ACBCAT   EQU   ACBINFLG                                                 00865000
ACBIJRQE EQU   ACBINFLG                                                 00866000
ACBJEPS  EQU   ACBINFLG                                                 00867000
@NM00033 EQU   ACBINFLG                                                 00868000
ACBERFLG EQU   ACBCOMN+49                                               00869000
ACBBUSY  EQU   ACBIOSFG                                                 00870000
ACBLOCK  EQU   ACBEXFG                                                  00871000
@NM00032 EQU   ACBOFLGS                                                 00872000
ACBDSERR EQU   ACBOFLGS                                                 00873000
ACBOPEN  EQU   ACBOFLGS                                                 00874000
ACBEOV   EQU   ACBOFLGS                                                 00875000
@NM00031 EQU   ACBOFLGS                                                 00876000
ACBDEB   EQU   ACBDDNM+5                                                00877000
ACBERFL  EQU   ACBDDNM+4                                                00878000
ACBAM    EQU   ACBAMETH                                                 00879000
ACBINFL  EQU   ACBDDNM+2                                                00880000
ACBPASSW EQU   ACBCOMN+32                                               00881000
ACBMSGAR EQU   ACBCOMN+28                                               00882000
@NM00030 EQU   ACBDSORG+1                                               00883000
@NM00029 EQU   ACBDSORG                                                 00884000
ACBCRNRE EQU   ACBCROPS                                                 00885000
ACBCRNCK EQU   ACBCROPS                                                 00886000
ACBASA   EQU   ACBCCTYP                                                 00887000
@NM00028 EQU   ACBCCTYP                                                 00888000
ACBRECAF EQU   ACBRECFM                                                 00889000
ACBJBUF  EQU   ACBBUFPL+2                                               00890000
ACBMACR4 EQU   ACBBUFPL+1                                               00891000
@NM00027 EQU   ACBMACR3                                                 00892000
ACBNCFX  EQU   ACBMACR3                                                 00893000
ACBSIS   EQU   ACBMACR3                                                 00894000
ACBDFR   EQU   ACBMACR3                                                 00895000
ACBICI   EQU   ACBMACR3                                                 00896000
ACBGSR   EQU   ACBMACR3                                                 00897000
ACBLSR   EQU   ACBMACR3                                                 00898000
@NM00026 EQU   ACBMACR3                                                 00899000
ACBBUFNI EQU   ACBCOMN+18                                               00900000
ACBBUFND EQU   ACBCOMN+16                                               00901000
ACBSTRNO EQU   ACBCOMN+15                                               00902000
ACBBSTNO EQU   ACBCOMN+14                                               00903000
ACBAIX   EQU   ACBMACR2                                                 00904000
ACBDSN   EQU   ACBMACR2                                                 00905000
ACBRST   EQU   ACBMACR2                                                 00906000
ACBLOGON EQU   ACBMACR2                                                 00907000
ACBSKP   EQU   ACBMACR2                                                 00908000
@NM00025 EQU   ACBMACR2                                                 00909000
ACBUBF   EQU   ACBMACR1                                                 00910000
ACBOUT   EQU   ACBMACR1                                                 00911000
ACBIN    EQU   ACBMACR1                                                 00912000
ACBDIR   EQU   ACBMACR1                                                 00913000
ACBSEQ   EQU   ACBMACR1                                                 00914000
ACBBLK   EQU   ACBCNV                                                   00915000
ACBADD   EQU   ACBADR                                                   00916000
ACBKEY   EQU   ACBMACR1                                                 00917000
ACBINRTN EQU   ACBCOMN+8                                                00918000
ACBIBCT  EQU   ACBJWA                                                   00919000
ACBLEN2  EQU   ACBLENG2                                                 00920000
ACBSTYP  EQU   ACBCOMN+1                                                00921000
CISTOWRC EQU   CISTOW                                                   00922000
CIFEOVRC EQU   CIFEOV                                                   00923000
CIBLDLRC EQU   CIBLDL                                                   00924000
CISAMWA  EQU   IFGJCICB+324                                             00925000
CIRECPTR EQU   IFGJCICB+320                                             00926000
CIRAREA  EQU   IFGJCICB+316                                             00927000
CIBLKPTR EQU   IFGJCICB+312                                             00928000
CISEGLEN EQU   CIIOCNT                                                  00929000
CILWAREA EQU   IFGJCICB+304                                             00930000
CIFDBCK  EQU   IFGJCICB+284                                             00931000
CIRPLEXT EQU   IFGJCICB+268                                             00932000
CIRPL    EQU   IFGJCICB+192                                             00933000
CIFLAG4  EQU   CIFLAGS+3                                                00934000
@NM00024 EQU   CIFLAG3                                                  00935000
CIFPOINT EQU   CIFLAG3                                                  00936000
CIFERROR EQU   CIFLAG3                                                  00937000
CIFVSEOB EQU   CIFLAG3                                                  00938000
CIFVSRI  EQU   CIFLAG3                                                  00939000
CIFRAGM  EQU   CIFLAG3                                                  00940000
CIFCLOSE EQU   CIFLAG3                                                  00941000
CIFFSTP  EQU   CIFLAG3                                                  00942000
@NM00023 EQU   CIFLAG2                                                  00943000
CIFMDEVT EQU   CIFLAG2                                                  00944000
CIFLAG1  EQU   CIFLAGS                                                  00945000
CIREGS   EQU   CIREGSAV+12                                              00946000
CIREGFC  EQU   CIREGSAV+8                                               00947000
CIREGBC  EQU   CIREGSAV+4                                               00948000
@NM00022 EQU   CIREGSAV                                                 00949000
CIACBED  EQU   IFGJCICB+88                                              00950000
@NM00021 EQU   CIDUMIOB+24                                              00951000
@NM00020 EQU   CIDUMIOB+16                                              00952000
CIIOB    EQU   CIDUMIOB+8                                               00953000
@NM00019 EQU   CIDUMIOB+5                                               00954000
DCBEOB   EQU   IFGSDCB+92                                               00955000
DCBPRECL EQU   IFGSDCB+90                                               00956000
@NM00018 EQU   IFGSDCB+88                                               00957000
DCBPOINT EQU   DCBNOTE                                                  00958000
DCBEROPT EQU   @NM00017                                                 00959000
DCBQSWS  EQU   DCBDIRCT                                                 00960000
DCBCCCW  EQU   DCBRECAD                                                 00961000
DCBOFFSW EQU   IFGSDCB+67                                               00962000
DCBOFFSR EQU   IFGSDCB+66                                               00963000
DCBWCPL  EQU   IFGSDCB+65                                               00964000
DCBWCPO  EQU   IFGSDCB+64                                               00965000
DCBCIND1 EQU   IFGSDCB+60                                               00966000
DCBSYNAD EQU   IFGSDCB+57                                               00967000
DCBIOBL  EQU   IFGSDCB+56                                               00968000
DCBPERR  EQU   DCBGERR                                                  00969000
DCBOPTCD EQU   IFGSDCB+52                                               00970000
DCBMACR  EQU   DCBPUT+1                                                 00971000
DCBIFLG  EQU   DCBPUT                                                   00972000
DCBDEBAD EQU   DCBDDNAM+5                                               00973000
DCBIFLGS EQU   DCBDDNAM+4                                               00974000
DCBEXLST EQU   IFGSDCB+37                                               00975000
DCBEODAD EQU   IFGSDCB+33                                               00976000
DCBBFALN EQU   DCBBFTEK                                                 00977000
DCBBUFL  EQU   IFGSDCB+24                                               00978000
@NM00014 EQU   IFGSDCB+16                                               00979000
@NM00013 EQU   IFGSDCB                                                  00980000
DXATEXC2 EQU   IECDSECT+608                                             00981000
@NM00009 EQU   IECDSECT+572                                             00982000
@NM00008 EQU   IECDSECT+527                                             00983000
@NM00007 EQU   IECDSECT+458                                             00984000
DXCALLID EQU   IECDSECT+456                                             00985000
@NM00006 EQU   IECDSECT+440                                             00986000
@NM00005 EQU   IECDSECT+276                                             00987000
IECJFCB  EQU   IECDSECT+100                                             00988000
@NM00004 EQU   IECDSECT                                                 00989000
OPENACB  EQU   OPENNTRY+1                                               00990000
OPENOPT  EQU   OPENNTRY                                                 00991000
PARCDCB  EQU   PARCNTRY+1                                               00992000
WTGPATH  EQU   WTG+30                                                   00993000
WTGFLEN  EQU   WTG+27                                                   00994000
WTGTLEN  EQU   WTG+24                                                   00995000
@NM00003 EQU   WTG+17                                                   00996000
@NM00002 EQU   WTG+8                                                    00997000
@NM00001 EQU   WTGMDNAM                                                 00998000
*                                      END UNREFERENCED COMPONENTS      00999000
@RT00083 EQU   GETMAIN                                                  01000000
@RC00173 EQU   @EL00002                                                 01001000
@RF00189 EQU   @EL00002                                                 01002000
@RT00187 EQU   @EL00002                                                 01003000
@PB00002 EQU   @EL00001                                                 01004000
@RF00179 EQU   @RC00173                                                 01005000
@EL01    EQU   @EL00001                                                 01006000
@ENDDATA EQU   *                                                        01007000
         END   IGG0199F,(C'PLS0931',0701,78076)                         01008000
./  ADD  SSI=81000047,NAME=IGG0199G
         TITLE 'IGG0199G  -  SAM-SI OPEN EXECUTOR                      *00001000
                        '                                               00002000
IGG0199G CSECT ,                                                   0001 00003000
@PROLOG  BALR  @11,0                                               0001 00004000
@PSTART  DS    0H                                                  0001 00005000
         USING @PSTART,@11                                         0001 00006000
         EJECT                                                          00007000
         EJECT                                                          00008000
         EJECT                                                          00009000
         EJECT                                                          00010000
         EJECT                                                          00011000
         EJECT                                                          00012000
         EJECT                                                          00013000
*                                                                  0057 00014000
         MODESET EXTKEY=DATAMGT                                         00015000
*        /************************************************************/ 00016000
*        /* CORE IS OBTAINED FOR AN ACB OPEN LIST PLUS SPACE FOR     */ 00017000
*        /* COPIES OF THE DCB JFCBS WHICH ARE ALSO USED FOR THE ACB  */ 00018000
*        /* OPEN.  THE NUMBER OF SPOOL DCBS CURRENTLY BEING OPENED   */ 00019000
*        /* WAS SAVED IN THE WTG TABLE BY THE PREVIOUS SAM-SI OPEN   */ 00020000
*        /* EXECUTOR (IGG0199F).  IF THIS ROUTINE IS REENTERED FROM  */ 00021000
*        /* RECOVERY (IE DELAY ABEND) AFTER ONE OF THE CURRENT DCBS  */ 00022000
*        /* FAILED, THEN SPOOL DCB COUNT WILL HAVE BEEN CLEARED      */ 00023000
*        /* FROM THE WTG TABLE, AND THE ACB OPEN IS NOT NEEDED.      */ 00024000
*        /************************************************************/ 00025000
*                                                                  0058 00026000
*        RSIZE = WTGTBLEN               /* SPOOL DCB COUNT     Y02120*/ 00027000
*                *(LENGTH(OPENNTRY)     /* TIMES ENTRY LEN     Y02120*/ 00028000
*                + LENGTH(IECJFCB));    /* PLUS JFCB SIZE      Y02120*/ 00029000
*                                                                  0058 00030000
         SLR   RSIZE,RSIZE                                         0058 00031000
         IC    RSIZE,WTGTBLEN(,RWTG)                               0058 00032000
         MH    RSIZE,@CH00699                                      0058 00033000
*        IF RSIZE = 0 THEN              /* WAS DCB COUNT =0 ?  YM3946*/ 00034000
         LTR   RSIZE,RSIZE                                         0059 00035000
         BZ    @RT00059                                            0059 00036000
*          GO TO RESCAN;                /* YES, SKIP ACB OPEN  YM3946*/ 00037000
*                                                                  0060 00038000
*        GEN (GETMAIN R,LV=(RSIZE),SP=250);/* GET CORE         Y02120*/ 00039000
*                                                                  0061 00040000
         GETMAIN R,LV=(RSIZE),SP=250                                    00041000
*        ROPEN = R1;                    /* SAVE ADDRESS OF LIST     */  00042000
         LR    ROPEN,R1                                            0062 00043000
*        RESTRICT (ROPENC,RJFCBC);             /* RESTRICT REGISTERS*/  00044000
*        ROPENC = ROPEN;                /* POINT TO CURRENT ENTRY   */  00045000
         LR    ROPENC,ROPEN                                        0064 00046000
*        RESPECIFY OPENNTRY BASED(ROPENC);/* BASE REGISTER          */  00047000
*        RPARC = RPAR;                   /* START AT TOP OF LIST    */  00048000
*                                                                  0066 00049000
         LR    RPARC,RPAR                                          0066 00050000
*        /* CALCULATE START OF JFCB COPY AREA                        */ 00051000
*        RJFCBC = ROPEN +               /* LOC OF OPEN LIST    Y02120*/ 00052000
*           WTGTBLEN * LENGTH(OPENNTRY);/* PLUS SIZE OF LIST   Y02120*/ 00053000
         SLR   RJFCBC,RJFCBC                                       0067 00054000
         IC    RJFCBC,WTGTBLEN(,RWTG)                              0067 00055000
         SLA   RJFCBC,2                                            0067 00056000
         ALR   RJFCBC,ROPEN                                        0067 00057000
*        WTGTBLEN = 0;                  /* CLEAR THE DCB COUNT Y02120*/ 00058000
*                                                                  0068 00059000
         MVI   WTGTBLEN(RWTG),X'00'                                0068 00060000
*        /************************************************************/ 00061000
*        /* ESTABLISH USER KEY WHILE BUILDING THE ACB OPEN LIST      */ 00062000
*        /* AND FOR ISSUING OPEN FOR THE ACBS.                       */ 00063000
*        /************************************************************/ 00064000
*                                                                  0069 00065000
*        R0 = RJFCBC;                   /* SAVE JFCB COPY PTR  Y02082*/ 00066000
         LR    R0,RJFCBC                                           0069 00067000
*        RUKEY = DXUKEY;                /* GET USER KEY IN REG Y02082*/ 00068000
         L     @12,WTGCWA-1(,RWTGC)                                0070 00069000
         SLR   RUKEY,RUKEY                                         0070 00070000
         IC    RUKEY,DXUKEY(,@12)                                  0070 00071000
*        GEN (MODESET KEYADDR=(2));     /* CHANGE TO USER KEY  Y02082*/ 00072000
         MODESET KEYADDR=(2)                                            00073000
*        RJFCBC = R0;                   /* RESTORE JFCB PTR    Y02082*/ 00074000
         LR    RJFCBC,R0                                           0072 00075000
*                                                                  0073 00076000
*SCANWTG:                               /* START OF SCAN LOOP       */  00077000
*        DO RWTGC = ADDR(WTG1ENT) BY LENGTH(WTGC);/* SCAN PARAMETERS*/  00078000
SCANWTG  LA    RWTGC,WTG1ENT(,RWTG)                                0073 00079000
@DL00073 DS    0H                                                  0074 00080000
*        /* TEST WTG TABLE ENTRIES TO SEE IF DCB(S) WERE            */  00081000
*        /* PROCESSED BY THE CI.                                    */  00082000
*                                                                  0074 00083000
*        /* IS THE ID AT WTGC THE ID OF THIS MODULE ?               */  00084000
*        IF WTGCID = '9G'                                          0074 00085000
*          THEN                         /* YES                      */  00086000
         CLC   WTGCID(2,RWTGC),@CC00641                            0074 00087000
         BNE   @RF00074                                            0074 00088000
*            DO;                                                   0075 00089000
*              /* SET OPEN OPTION IN ACB EQUAL TO DCB OPEN OPTION   */  00090000
*              OPENOPT = PARCOPT;                                  0076 00091000
         MVC   OPENOPT(1,ROPENC),PARCOPT(RPARC)                    0076 00092000
*              RESPECIFY IFGSDCB BASED(PARCDCB);/* BASE REGISTER    */  00093000
*              RESPECIFY IFGJCICB BASED(DCBCICB);/* BASE REGISTER   */  00094000
*              OPENACB = ADDR(CIACBD);  /* ADDR OF ACB TO OPEN      */  00095000
*                                                                  0079 00096000
         L     @12,PARCDCB-1(,RPARC)                               0079 00097000
         LA    @12,0(,@12)                                         0079 00098000
         L     @10,DCBCICB(,@12)                                   0079 00099000
         LA    @10,CIACBD(,@10)                                    0079 00100000
         STCM  @10,7,OPENACB(ROPENC)                               0079 00101000
*              RESPECIFY IFGACB BASED(OPENACB); /* BASE REG    Y02120*/ 00102000
*              NEWJFCB = IECJFCB;       /* COPY JFCB           Y02120*/ 00103000
         L     @15,WTGCWA-1(,RWTGC)                                0081 00104000
         MVC   NEWJFCB(176,RJFCBC),IECJFCB(@15)                    0081 00105000
*              JFCBMASK = JFCBMASK && JFCBMASK; /* ZERO MASK   Y02120   00106000
*                                       IN COPIED JFCB         Y02120*/ 00107000
         XC    JFCBMASK(8,RJFCBC),JFCBMASK(RJFCBC)                 0082 00108000
*              ACBUJFCB = ADDR(NEWJFCB);/* POINT TO JFCB COPY  Y02120*/ 00109000
         ST    RJFCBC,ACBUJFCB(,@10)                               0083 00110000
*              IF DCBOPTCD(8)='1'B THEN ACBOPT(3)='1'B;    /*@ZA24446*/ 00111000
         TM    DCBOPTCD(@12),B'00000001'                           0084 00112000
         BNO   @RF00084                                            0084 00113000
         OI    ACBOPT(@10),B'00100000'                             0085 00114000
*              /* IF USER HAS ASKED FOR OPTCD J IN HIS DCB   @ZA24446*/ 00115000
*              /* THEN SHOW ACB AS ALSO REQUESTING OPBCD J   @ZA24446*/ 00116000
*                                                                  0086 00117000
*              /* UPDATE PTR TO CURRENT ENTRY IN ACB PARAMETER LIST */  00118000
*              ROPENC = ROPENC + LENGTH(OPENNTRY);                 0086 00119000
*                                                                  0086 00120000
@RF00084 LA    ROPENC,4(,ROPENC)                                   0086 00121000
*              /* UPDATE PTR TO CURRENT JFCB COPY                    */ 00122000
*              RJFCBC = RJFCBC + LENGTH(IECJFCB);                  0087 00123000
         LA    RJFCBC,176(,RJFCBC)                                 0087 00124000
*            END;                       /* END OF THIS MODULE PROC  */  00125000
*          ELSE                         /* NO                       */  00126000
*                                                                  0089 00127000
*            /* IS THIS THE END OF THE WTG TABLE ?                  */  00128000
*            IF WTGCID = '0S'                                      0089 00129000
*              THEN                     /* YES                      */  00130000
         B     @RC00074                                            0089 00131000
@RF00074 CLC   WTGCID(2,RWTGC),@CC00646                            0089 00132000
         BE    @RT00089                                            0089 00133000
*                GO TO GIVEOPEN;        /* PREPARE TO ISSUE OPEN    */  00134000
*            RPARC = RPARC + LENGTH(PARCNTRY); /* INDEX ENTRY       */  00135000
@RC00074 LA    RPARC,4(,RPARC)                                     0091 00136000
*        END SCANWTG;                   /* LOOP THROUGH WTG ENTRIES */  00137000
         LA    RWTGC,8(,RWTGC)                                     0092 00138000
         B     @DL00073                                            0092 00139000
*        /***********************************************************/  00140000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00141000
         EJECT                                                          00142000
*        /***********************************************************/  00143000
*        /*                                                         */  00144000
*        /* ISSUE OPEN ON THE ACB(S)                                */  00145000
*        /*                                                         */  00146000
*        /***********************************************************/  00147000
*                                                                  0094 00148000
*GIVEOPEN:                                                         0094 00149000
*        /* ADJUST POINTER TO LAST ENTRY IN PARAMETER LIST          */  00150000
*        ROPENC = ROPENC - 4;                                      0094 00151000
*                                                                  0094 00152000
GIVEOPEN SL    ROPENC,@CF00074                                     0094 00153000
*        /* INDICATE END OF LIST                                    */  00154000
*        OPENOPT (1) = '1'B;                                       0095 00155000
*                                                                  0095 00156000
         OI    OPENOPT(ROPENC),B'10000000'                         0095 00157000
*        GEN (OPEN  MF=(E,(ROPEN)),TYPE=J);/* ISSUE OPEN ON ACB(S)  */  00158000
*                                                                  0096 00159000
         OPEN  MF=(E,(ROPEN)),TYPE=J                                    00160000
*        /* RELEASE CORE USED FOR OPEN PARAMETER LIST               */  00161000
*        GEN (FREEMAIN R,LV=(RSIZE),A=(ROPEN),SP=250);/* FREE CORE  */  00162000
*                                                                  0097 00163000
         FREEMAIN R,LV=(RSIZE),A=(ROPEN),SP=250                         00164000
*        RESPECIFY OPENNTRY BASED(NOBASE);/* DROP ADDRESSABILITY    */  00165000
*        RELEASE (ROPENC,ROPEN,RSIZE,RJFCBC);  /* RELEASE REGISTERS */  00166000
*                                                                  0099 00167000
*        /************************************************************/ 00168000
*        /* PREPARE TO SCAN THE WTG TABLE FOR REQUIRED FINAL         */ 00169000
*        /* PROCESSING BY THIS MODULE .                              */ 00170000
*        /************************************************************/ 00171000
*                                                                  0100 00172000
*RESCAN:                                /* BEGIN RESCAN OF WTG YM3946*/ 00173000
*        RPARC = RPAR;                  /* 1ST ENTRY IN PARM LIST   */  00174000
*                                                                  0100 00175000
RESCAN   LR    RPARC,RPAR                                          0100 00176000
*        /************************************************************/ 00177000
*        /* NOW RESET BACK TO DATA MANAGEMENT KEY FOR DCB (COPY)     */ 00178000
*        /* PROCESSING. THE SUBROUTINE "PROCESS" IS ENTERED AND      */ 00179000
*        /* RETURNS CONTROL IN THIS KEY.                             */ 00180000
*        /************************************************************/ 00181000
*                                                                  0101 00182000
*        GEN (MODESET EXTKEY=DATAMGT);  /* SET DATA MGT KEY    Y02082*/ 00183000
         MODESET EXTKEY=DATAMGT                                         00184000
*                                                                  0102 00185000
*SCANLOOP:                                                         0102 00186000
*        DO RWTGC = ADDR(WTG1ENT) BY LENGTH(WTGC);                 0102 00187000
SCANLOOP LA    RWTGC,WTG1ENT(,RWTG)                                0102 00188000
@DL00102 DS    0H                                                  0103 00189000
*        IF WTGCID = '9G'               /* THIS MOD NEEDED FOR DCB  */  00190000
*          THEN                         /* YES                      */  00191000
         CLC   WTGCID(2,RWTGC),@CC00641                            0103 00192000
         BNE   @RF00103                                            0103 00193000
*            DO;                        /* DO FOLLOWING             */  00194000
*              R13 = ADDR(DXCCW(1));    /* USE CCW1-CCW9 AS SAVEAREA*/  00195000
         L     R13,WTGCWA-1(,RWTGC)                                0105 00196000
         LA    R13,0(,R13)                                         0105 00197000
         LA    R13,DXCCW(,R13)                                     0105 00198000
*              CALL PROCESS;            /* PROCESS THE CURRENT DCB  */  00199000
*                                                                  0106 00200000
         BAL   @14,PROCESS                                         0106 00201000
*              IF R15 ¬= 0 THEN         /* IS DCB IN ERROR ?   XM5620*/ 00202000
         LTR   R15,R15                                             0107 00203000
         BZ    @RF00107                                            0107 00204000
*                DO;                    /* YES, PREPARE EXIT   XM5620   00205000
*                                          TO PROB DET RTN FOR ABEND */ 00206000
*                  WTGID = PDID;        /* ID INTO WTG TABLE   XM5620*/ 00207000
         MVC   WTGID(2,RWTG),PDID                                  0109 00208000
*                  WTGTTR = PDTTR;      /* TTR INTO WTG TABLE  XM5620*/ 00209000
         MVC   WTGTTR(3,RWTG),PDTTR                                0110 00210000
*                  DXCALLID = '9G';     /* DENOTE CALLER ID    XM5620*/ 00211000
         L     @12,WTGCWA-1(,RWTGC)                                0111 00212000
         LA    @12,0(,@12)                                         0111 00213000
         MVC   DXCALLID(2,@12),@CC00641                            0111 00214000
*                  RDCB = PARCDCB;      /* RELOAD DCB REG      XM5620*/ 00215000
         L     RDCB,PARCDCB-1(,RPARC)                              0112 00216000
         LA    RDCB,0(,RDCB)                                       0112 00217000
*                  ATFABEND = '1'B;     /* AUDIT TRAIL-ABEND   Y02144*/ 00218000
         OI    ATFABEND(@12),B'01000000'                           0113 00219000
*                  R0 = R15;            /* SET PARM REG WITH   XM5620   00220000
*                                          INTERNAL ABEND CODE       */ 00221000
         LR    R0,R15                                              0114 00222000
*                  ROPEN = WTGCWA;      /* SET WORKAREA PTR  @ZA15974*/ 00223000
         LR    ROPEN,@12                                           0115 00224000
*                  GO TO XFER;          /* BRANCH TO XCTL      XM5620*/ 00225000
         B     XFER                                                0116 00226000
*                END;                   /* END ERROR DCB LOGIC XM5620*/ 00227000
*                                                                  0117 00228000
*              WTGCID = XCTLID;         /* INDICATE NEXT LOAD FOR IT*/  00229000
@RF00107 MVC   WTGCID(2,RWTGC),XCTLID                              0118 00230000
*              WTGCTTR = XCTLTTR;                                  0119 00231000
         MVC   WTGCTTR(3,RWTGC),XCTLTTR                            0119 00232000
*            END;                       /* END OF PROCESSING        */  00233000
*                                                                  0120 00234000
*        IF WTGID = '9G'                /* NO NEXT MOD SELECTED YET */  00235000
*          & WTGCID(1) ¬= '00'X         /* CURRENT DCB NEEDS MORE   */  00236000
*            THEN                       /* SO SELECT NEXT MOD FOR IT*/  00237000
@RF00103 CLC   WTGID(2,RWTG),@CC00641                              0121 00238000
         BNE   @RF00121                                            0121 00239000
         CLI   WTGCID(RWTGC),X'00'                                 0121 00240000
         BE    @RF00121                                            0121 00241000
*              DO;                      /* DO FOLLOWING NEXT MOD    */  00242000
*                WTGID = WTGCID;                                   0123 00243000
         MVC   WTGID(2,RWTG),WTGCID(RWTGC)                         0123 00244000
*                WTGTTR = RPARC - RPAR; /* SAVE OFFSET TO ENTRY     */  00245000
         LR    @12,RPARC                                           0124 00246000
         SLR   @12,RPAR                                            0124 00247000
         STCM  @12,7,WTGTTR(RWTG)                                  0124 00248000
*              END;                     /* END OF NEXT MOD PROCESS  */  00249000
*                                                                  0125 00250000
*        IF WTGCID = '0S'               /* ALL DCBS SCANNED         */  00251000
*          THEN                         /* YES                      */  00252000
@RF00121 CLC   WTGCID(2,RWTGC),@CC00646                            0126 00253000
         BNE   @RF00126                                            0126 00254000
*            DO;                                                   0127 00255000
*              RPARC = RPAR + WTGTTR;   /* USE SAVED OFFSET TO RESET    00256000
*                                          RPARC FOR NEXT MODULE    */  00257000
         SLR   @12,@12                                             0128 00258000
         ICM   @12,7,WTGTTR(RWTG)                                  0128 00259000
         LR    RPARC,RPAR                                          0128 00260000
         ALR   RPARC,@12                                           0128 00261000
*              RWTGC = ADDR(WTG1ENT)    /* ALSO RESET RWTGC         */  00262000
*                      + 2 * WTGTTR;    /*(EACH ENTRY TWICE AS LONG)*/  00263000
*                                                                  0129 00264000
         LA    RWTGC,WTG1ENT(,RWTG)                                0129 00265000
         ALR   @12,@12                                             0129 00266000
         ALR   RWTGC,@12                                           0129 00267000
*              WTGTTR = WTGCTTR;        /* NOW STORE REAL TTR       */  00268000
         MVC   WTGTTR(3,RWTG),WTGCTTR(RWTGC)                       0130 00269000
*XFER:                                  /* PREPARE FOR XCTL    XM5620*/ 00270000
*              R15 = ADDR(DXCCW(1));    /* GET ADDRESS OF NEXT MOD  */  00271000
XFER     L     @12,WTGCWA-1(,RWTGC)                                0131 00272000
         LA    @12,0(,@12)                                         0131 00273000
         LA    R15,DXCCW(,@12)                                     0131 00274000
*              DXCCW(2) = 0;            /* CLR DCB PTR IN LIST Y02082*/ 00275000
         SLR   @10,@10                                             0132 00276000
         STCM  @10,15,DXCCW+4(@12)                                 0132 00277000
*              GEN (XCTL  EPLOC=(RWTG),SF=(E,(15))); /*        Y02082*/ 00278000
         XCTL  EPLOC=(RWTG),SF=(E,(15))                                 00279000
*            END;                                                  0134 00280000
*        RPARC = RPARC + LENGTH(PARCNTRY);                         0135 00281000
@RF00126 LA    RPARC,4(,RPARC)                                     0135 00282000
*        END SCANLOOP;                  /* CONTINUE SCAN W/NEXT DCB */  00283000
         LA    RWTGC,8(,RWTGC)                                     0136 00284000
         B     @DL00102                                            0136 00285000
*        /***********************************************************/  00286000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00287000
         EJECT                                                          00288000
*                                                                  0138 00289000
*                                                                  0138 00290000
*PROCESS:                                                          0138 00291000
*        PROCEDURE                                                 0138 00292000
*              OPTIONS(NOSAVEAREA);                                0138 00293000
*                                                                  0138 00294000
@EL00001 DS    0H                                                  0138 00295000
@EF00001 DS    0H                                                  0138 00296000
@ER00001 BR    @14                                                 0138 00297000
PROCESS  STM   @14,@12,12(@13)                                     0138 00298000
*        DCL   RDEB    REG(6) PTR (24); /* BASE FOR DEB             */  00299000
*        DCL   RACB    REG(9) PTR (24); /* BASE FOR ACB             */  00300000
*        DCL   RCICB   REG(12) PTR(24); /* BASE FOR CICB            */  00301000
*                                                                  0141 00302000
*        /* RESTRICT THE FOLLOWING REGISTERS FROM THE COMPILER      */  00303000
*        RESTRICT (RDCB,RPARC,RWTGC,RACB,RDEB,RSIZE,R1,RCICB);     0142 00304000
*                                                                  0142 00305000
*        RDCB = PARCDCB;                /* POINTER TO DCB           */  00306000
         L     RDCB,PARCDCB-1(,RPARC)                              0143 00307000
         LA    RDCB,0(,RDCB)                                       0143 00308000
*        RESPECIFY IFGSDCB BASED(RDCB); /* BASE REGISTER            */  00309000
*        RCICB = DCBCICB;               /* POINTER TO CICB          */  00310000
         L     RCICB,DCBCICB(,RDCB)                                0145 00311000
*        RESPECIFY IFGJCICB BASED(RCICB);/* BASE REGISTER           */  00312000
*        RACB = ADDR(CIACBD);           /* RESTORE ACB BASE         */  00313000
         LA    RACB,CIACBD(,RCICB)                                 0147 00314000
*        RESPECIFY IFGACB BASED (RACB); /* BASE REGISTER            */  00315000
*                                                                  0148 00316000
*        /************************************************************/ 00317000
*        /* VERIFY THE ACB HAS BEEN OPENED FOR THIS DCB.  IF THE     */ 00318000
*        /* SUBSYSTEM COULD NOT OPEN THE ACB, DISCONTINUE FURTHER    */ 00319000
*        /* PROCESSING FOR THE DCB.                                  */ 00320000
*        /************************************************************/ 00321000
*                                                                  0149 00322000
*        R0 = RDCB;                     /* SAVE DCB ADDRESS    Y02082*/ 00323000
         LR    R0,RDCB                                             0149 00324000
*        RUKEY = DXUKEY;                /* GET USERS KEY       Y02082*/ 00325000
         L     @10,WTGCWA-1(,RWTGC)                                0150 00326000
         SLR   RUKEY,RUKEY                                         0150 00327000
         IC    RUKEY,DXUKEY(,@10)                                  0150 00328000
*        GEN (MODESET KEYADDR=(2));     /* GO TO USER KEY FOR  Y02082   00329000
*                                       ACB TEST AND DEBCHK.   Y02082*/ 00330000
         MODESET KEYADDR=(2)                                            00331000
*        RDCB = R0;                     /* RESORE DCB BASE     Y02082*/ 00332000
         LR    RDCB,R0                                             0152 00333000
*        IF ACBOPEN = '0'B THEN         /* DID ACB OPEN OK?    Y02082*/ 00334000
         TM    ACBOPEN(RACB),B'00010000'                           0153 00335000
         BNZ   @RF00153                                            0153 00336000
*          DO;                          /* NO, GIVE UP ON DCB  Y02082*/ 00337000
*            GEN (MODESET EXTKEY=DATAMGT);/* RESTORE DM KEY    Y02082*/ 00338000
         MODESET EXTKEY=DATAMGT                                         00339000
*            R1 = 227;                  /* SET OPEN FAIL CODE  Y02082*/ 00340000
         LA    R1,227                                              0156 00341000
*            GO TO ABEND;               /* TO ERROR EXIT       Y02082*/ 00342000
         B     ABEND                                               0157 00343000
*          END;                         /* END BAD OPEN        Y02082*/ 00344000
*        ELSE;                          /* OPEN OK...CONTINUE  Y02082*/ 00345000
@RF00153 DS    0H                                                  0160 00346000
*        /************************************************************/ 00347000
*        /* OBTAIN VALID DEB ADDRESS FROM ACB BY ISSUING DEBCHK.     */ 00348000
*        /* DEBCHK WILL ABEND IF DEB NOT VALID.  IF DEB IS OK,       */ 00349000
*        /* ITS ADDRESS IS RETURNED IN REG 1.                        */ 00350000
*        /************************************************************/ 00351000
*                                                                  0160 00352000
*        GEN (DEBCHK (RACB),AM=SUBSYS); /* TEST ACB'S DEB      Y02082*/ 00353000
         DEBCHK (RACB),AM=SUBSYS                                        00354000
*        RDEB = R1;                     /* PTR TO VALID DEB    Y02082*/ 00355000
         LR    RDEB,R1                                             0161 00356000
*        RESPECIFY DEBBASIC BASED(RDEB);/* BASE REGISTER FOR DEB     */ 00357000
*                                                                  0162 00358000
*        GEN (MODESET EXTKEY=DATAMGT);  /* RETURN TO DM KEY    Y02082*/ 00359000
*                                                                  0163 00360000
         MODESET EXTKEY=DATAMGT                                         00361000
*        /***********************************************************/  00362000
*        /* OPEN FOR THE ACB HAS CREATED THE DEB AND POINTED IT TO  */  00363000
*        /* THE ACB. WE ALSO CHAIN THE DCB TO THIS DEB AND PLACE A  */  00364000
*        /* POINTER TO THE DCB IN DEBECBAD.                         */  00365000
*        /***********************************************************/  00366000
*                                                                  0164 00367000
*        DCBDEBAD = RDEB;               /* POINT DCB TO DEB          */ 00368000
         STCM  RDEB,7,DCBDEBAD(RDCB)                               0164 00369000
*        DEBECBB = DXUDCBAD;            /* DEB PTR TO REAL DCB Y02082*/ 00370000
         L     @10,WTGCWA-1(,RWTGC)                                0165 00371000
         MVC   DEBECBB(3,RDEB),DXUDCBAD+1(@10)                     0165 00372000
*        DEBCINDI = '1'B;               /* INDICATE CI PROCESS Y02120*/ 00373000
*                                                                  0166 00374000
         OI    DEBCINDI(RDEB),B'00001000'                          0166 00375000
*        /* WE MUST NOW CLEAR THE ACB MODIFICATION MASK SAVED IN     */ 00376000
*        /* THE DEB EXTENSION AS A RESULT OF THE ACB OPEN. THIS IS   */ 00377000
*        /* TO ALLOW COMMON OPEN TO SAVE THE DCB MODIFICATION MASK   */ 00378000
*        /* AT THIS LOCATION WHEN SAM-SI EXECUTORS RETURN.           */ 00379000
*                                                                  0167 00380000
*        DEBXTNPT -> DEBXDCBM = 0;      /* CLR ACB MOD MASK    Y02134*/ 00381000
*                                                                  0167 00382000
         L     @10,DCBDEBAD-1(,RDCB)                               0167 00383000
         LA    @10,0(,@10)                                         0167 00384000
         AL    @10,@CF00705                                        0167 00385000
         L     @10,DEBXTNPT+8(,@10)                                0167 00386000
         SLR   @00,@00                                             0167 00387000
         ST    @00,DEBXDCBM(,@10)                                  0167 00388000
*/*******************************************************************/  00389000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00390000
         EJECT                                                          00391000
*                                                                  0169 00392000
*                                                                  0169 00393000
*        /***********************************************************/  00394000
*        /* VERIFY DCB ATTRIBUTES -                                 */  00395000
*        /*   R1 IS  PRIMED WITH THE PROBLEM DETERMINATION INTERNAL */  00396000
*        /*   ABEND CODE FOR THE ATTRIBUTE CURRENTLY BEING CHECKED. */  00397000
*        /*   IN THE EVENT OF AN ERROR, THE CODE IS RETURNED TO THE */  00398000
*        /*   CALLING ROUTINE IN REG 15.  IF NO ERRORS ARE FOUND,   */  00399000
*        /*   REG 1 IS CLEARED TO ZERO.                             */  00400000
*        /***********************************************************/  00401000
*                                                                  0169 00402000
*        R1 = 57;                       /* TEST OPEN OPTIONS - INPUT */ 00403000
         LA    R1,57                                               0169 00404000
*        IF PARCOPOP = '0000'B          /* DCB OPENED FOR INPUT      */ 00405000
*           | PARCOPOP = '0011'B THEN   /*  OR INOUT,          Y02082*/ 00406000
         TM    PARCOPOP(RPARC),B'00001111'                         0170 00407000
         BZ    @RT00170                                            0170 00408000
         TM    PARCOPOP(RPARC),B'00000011'                         0170 00409000
         BNO   @RF00170                                            0170 00410000
         TM    PARCOPOP(RPARC),B'00001100'                         0170 00411000
         BNZ   @RF00170                                            0170 00412000
@RT00170 DS    0H                                                  0171 00413000
*          IF DCBMACRF(02:03) = '00'B THEN/*                       0171 00414000
*                                          MACRF MUST BE READ | GET  */ 00415000
         TM    DCBMACRF(RDCB),B'01100000'                          0171 00416000
         BZ    @RT00171                                            0171 00417000
*            GOTO ABEND;                /* TERMINATE OPEN IF NOT     */ 00418000
*          ELSE                         /* OPTIONS AGREE       Y02082*/ 00419000
*            IF DCBMACRF(6) = '1'B      /* WAS POINT REQUESTED Y02082*/ 00420000
*               & DCBCIND2(8) = '0'B THEN/*                        0173 00421000
*                                          FOR BSAM DCB ?      Y02082*/ 00422000
         TM    DCBMACRF(RDCB),B'00000100'                          0173 00423000
         BNO   @RF00173                                            0173 00424000
         TM    DCBCIND2(RDCB),B'00000001'                          0173 00425000
         BZ    @RT00173                                            0173 00426000
*              GO TO BADOPT;            /* MACRF=P, TERMINATE  Y02082*/ 00427000
*            ELSE                       /* MACRF IS OK,        Y02082*/ 00428000
*              GO TO CHKDSORG;          /* CONTINUE OPEN       Y02082*/ 00429000
         B     CHKDSORG                                            0175 00430000
*        ELSE;                          /* OPEN NOT FOR INPUT  Y02082*/ 00431000
*                                                                  0176 00432000
@RF00170 DS    0H                                                  0177 00433000
*        R1 = 58;                       /* TEST OPEN OPTIONS - OUTPUT*/ 00434000
         LA    R1,58                                               0177 00435000
*        IF PARCOPOP = '1111'B          /* DCB OPENED FOR OUTPUT     */ 00436000
*           | PARCOPOP = '1110'B        /*  OR EXTEND,       @ZA27040*/ 00437000
*           | PARCOPOP = '0111'B   THEN /*  OR OUTIN,          Y02082*/ 00438000
         TM    PARCOPOP(RPARC),B'00001111'                         0178 00439000
         BO    @RT00178                                            0178 00440000
         TM    PARCOPOP(RPARC),B'00001110'                         0178 00441000
         BNO   @GL00004                                            0178 00442000
         TM    PARCOPOP(RPARC),B'00000001'                         0178 00443000
         BZ    @RT00178                                            0178 00444000
@GL00004 TM    PARCOPOP(RPARC),B'00000111'                         0178 00445000
         BNO   @RF00178                                            0178 00446000
         TM    PARCOPOP(RPARC),B'00001000'                         0178 00447000
         BNZ   @RF00178                                            0178 00448000
@RT00178 DS    0H                                                  0179 00449000
*          IF DCBMACRF(10:11) = '00'B THEN/*                       0179 00450000
*                                          MACRF MUST BE WRITE | PUT */ 00451000
         TM    DCBMACRF+1(RDCB),B'01100000'                        0179 00452000
         BZ    @RT00179                                            0179 00453000
*            GOTO ABEND;                /* TERMINATE IF NOT          */ 00454000
*          ELSE                         /* OPTIONS AGREE       Y02082*/ 00455000
*            IF DCBMACRF(14) = '1'B     /* WAS POINT REQUESTED Y02082*/ 00456000
*               & DCBCIND2(8) = '0'B   THEN/*                      0181 00457000
*                                          FOR BSAM DCB ?      Y02082*/ 00458000
         TM    DCBMACRF+1(RDCB),B'00000100'                        0181 00459000
         BNO   @RF00181                                            0181 00460000
         TM    DCBCIND2(RDCB),B'00000001'                          0181 00461000
         BZ    @RT00181                                            0181 00462000
*              GO TO BADOPT;            /* MACRF=P, QUIT       Y02082*/ 00463000
*            ELSE                       /* MACRF IS OK,        Y02082*/ 00464000
*              GO TO CHKDSORG;          /* CONTINUE OPEN       Y02082*/ 00465000
         B     CHKDSORG                                            0183 00466000
*        ELSE;                          /* NOT OUTPUT EITHER   Y02082*/ 00467000
*                                                                  0184 00468000
@RF00178 DS    0H                                                  0185 00469000
*BADOPT: R1 = 226;                      /* INVALID OPTIONS     Y02082*/ 00470000
BADOPT   LA    R1,226                                              0185 00471000
*        GO TO ABEND;                   /* TERMINATE OPEN      Y02082*/ 00472000
*                                                                  0186 00473000
         B     ABEND                                               0186 00474000
*CHKDSORG:                                                         0187 00475000
*        R1 = 106;                      /* TEST DSORG         XM5620*/  00476000
CHKDSORG LA    R1,106                                              0187 00477000
*        IF DCBDSORG(2) ¬= '1'B THEN    /* IF NOT PHYS SEQUENTIAL   */  00478000
         TM    DCBDSORG(RDCB),B'01000000'                          0188 00479000
         BNO   @RT00188                                            0188 00480000
*          GOTO ABEND;                  /* TERMINATE OPEN           */  00481000
*                                                                  0189 00482000
*                                                                  0189 00483000
*        R1 = 107;                      /* TEST RECFM         XM5620*/  00484000
         LA    R1,107                                              0190 00485000
*        IF DCBRECFM(1:3) = '001'B THEN /* RECFM=D (ASCII VARIABLE)?*/  00486000
         TM    DCBRECFM(RDCB),B'00100000'                          0191 00487000
         BNO   @RF00191                                            0191 00488000
         TM    DCBRECFM(RDCB),B'11000000'                          0191 00489000
         BZ    @RT00191                                            0191 00490000
*          GOTO ABEND;                  /* IF SO, TERMINATE OPEN    */  00491000
*        ELSE;                          /* FORMAT F, V, OR U        */  00492000
*                                                                  0193 00493000
*                                                                  0193 00494000
@RF00191 DS    0H                                                  0194 00495000
*        IF PARCOPOP = '0000'B          /* OPENING FOR INPUT ?      */  00496000
*         | PARCOPOP = '0011'B THEN     /* THEN IF RECFM=           */  00497000
         TM    PARCOPOP(RPARC),B'00001111'                         0194 00498000
         BZ    @RT00194                                            0194 00499000
         TM    PARCOPOP(RPARC),B'00000011'                         0194 00500000
         BNO   @RF00194                                            0194 00501000
         TM    PARCOPOP(RPARC),B'00001100'                         0194 00502000
         BNZ   @RF00194                                            0194 00503000
@RT00194 DS    0H                                                  0195 00504000
*          IF DCBRECFM(1:2) = '01'B     /*  VARIABLE LENGTH,        */  00505000
*          & DCBRECFM(5)   = '1'B       /*  SPANNED RECORDS         */  00506000
*           THEN GOTO ABEND;            /* TERMINATE OPEN           */  00507000
*                                                                  0195 00508000
*                                                                  0195 00509000
         TM    DCBRECFM(RDCB),B'01000000'                          0195 00510000
         BNO   @RF00195                                            0195 00511000
         TM    DCBRECFM(RDCB),B'10000000'                          0195 00512000
         BNZ   @RF00195                                            0195 00513000
         TM    DCBRECFM(RDCB),B'00001000'                          0195 00514000
         BO    @RT00195                                            0195 00515000
*        R1 = 61;                       /* TEST LRECL          XM5620*/ 00516000
@RF00195 DS    0H                                                  0197 00517000
@RF00194 LA    R1,61                                               0197 00518000
*    /*****************************************************/       0198 00519000
*    /*IF BLKSIZE AND LRECL ARE BOTH PRESENT - AND LRECL IS  @ZA27045*/ 00520000
*    /*GREATER - THEN GO TO ABEND UNLESS VARIABLE SPANNED    @ZA27045*/ 00521000
*    /*OR UNDEFINED RECORDS ARE USED......................   @ZA30316*/ 00522000
*    /*****************************************************/       0198 00523000
*    GEN ( TM DCBRECFM(RDCB),X'48');                       /*@ZA27045*/ 00524000
          TM DCBRECFM(RDCB),X'48'                                       00525000
*    GEN ( BO SPANPASS);                                   /*@ZA27045*/ 00526000
          BO SPANPASS                                                   00527000
*    GEN ( TM DCBRECFM(RDCB),X'C0');                       /*@ZA30316*/ 00528000
          TM DCBRECFM(RDCB),X'C0'                                       00529000
*    GEN ( BO SPANPASS);                                   /*@ZA30316*/ 00530000
          BO SPANPASS                                                   00531000
*    IF DCBLRECL ¬= 0 & DCBBLKSI ¬= 0 &                    /*@ZA27045*/ 00532000
*                 DCBLRECL > DCBBLKSI                      /*@ZA27045*/ 00533000
*        THEN GOTO                          /*               @ZA27045*/ 00534000
         LH    @10,DCBLRECL(,RDCB)                                 0202 00535000
         N     @10,@CF00706                                        0202 00536000
         LTR   @10,@10                                             0202 00537000
         BZ    @RF00202                                            0202 00538000
         LH    @10,DCBBLKSI(,RDCB)                                 0202 00539000
         N     @10,@CF00706                                        0202 00540000
         LTR   @10,@10                                             0202 00541000
         BZ    @RF00202                                            0202 00542000
         CLC   DCBLRECL(2,RDCB),DCBBLKSI(RDCB)                     0202 00543000
         BH    @RT00202                                            0202 00544000
*        ABEND;                             /*               @ZA27045*/ 00545000
*SPANPASS:                                                 /*@ZA27045*/ 00546000
*        IF DCBLRECL = 0                /* NO RECORD LENGTH GIVEN   */  00547000
*         & DCBCIND2(8) = '1'B/*                                   0204 00548000
*                                          REQUIRED FOR QSAM        */  00549000
*           THEN IF DCBRECFM(1:2) = '01'B/*                        0204 00550000
*                                          SKIP V-TYPE RCDS   XM5989*/  00551000
@RF00202 DS    0H                                                  0204 00552000
SPANPASS LH    @10,DCBLRECL(,RDCB)                                 0204 00553000
         N     @10,@CF00706                                        0204 00554000
         LTR   @10,@10                                             0204 00555000
         BNZ   @RF00204                                            0204 00556000
         TM    DCBCIND2(RDCB),B'00000001'                          0204 00557000
         BNO   @RF00204                                            0204 00558000
*             THEN;                     /*                    XM5989*/  00559000
         TM    DCBRECFM(RDCB),B'01000000'                          0205 00560000
         BNO   @RF00205                                            0205 00561000
         TM    DCBRECFM(RDCB),B'10000000'                          0205 00562000
         BNZ   @RF00205                                            0205 00563000
*             ELSE GOTO ABEND;          /* TERMINATE OPEN     XM5989*/  00564000
*                                                                  0207 00565000
*        IF DCBRECFM(1:2) = '01'B & DCBRECFM(5) = '0'B/*           0208 00566000
*                                          V-TYPE RCDS        XM0455*/  00567000
*         & DCBLRECL > DCBBLKSI - 4     /* CHECK LRECL        XM5989*/  00568000
*           THEN                        /*                    XM5989*/  00569000
@RF00204 TM    DCBRECFM(RDCB),B'01000000'                          0208 00570000
         BNO   @RF00208                                            0208 00571000
         TM    DCBRECFM(RDCB),B'10000000'                          0208 00572000
         BNZ   @RF00208                                            0208 00573000
         TM    DCBRECFM(RDCB),B'00001000'                          0208 00574000
         BNZ   @RF00208                                            0208 00575000
         LH    @10,DCBBLKSI(,RDCB)                                 0208 00576000
         N     @10,@CF00706                                        0208 00577000
         SL    @10,@CF00074                                        0208 00578000
         LH    @00,DCBLRECL(,RDCB)                                 0208 00579000
         N     @00,@CF00706                                        0208 00580000
         CR    @10,@00                                             0208 00581000
         BL    @RT00208                                            0208 00582000
*             GOTO ABEND;               /* LRECL IS TOO BIG   XM5989*/  00583000
*                                                                  0209 00584000
*                                                                  0209 00585000
*        R1 = 61;                       /* TEST BLKSIZE        XM5620*/ 00586000
@RF00208 LA    R1,61                                               0210 00587000
*        IF DCBCIND2(8) = '0'B THEN     /* BLKSIZE REQUIRED FOR BSAM */ 00588000
         TM    DCBCIND2(RDCB),B'00000001'                          0211 00589000
         BNZ   @RF00211                                            0211 00590000
*          IF DCBBLKSI = 0 THEN         /* IS BLKSIZE PRESENT        */ 00591000
         LH    @10,DCBBLKSI(,RDCB)                                 0212 00592000
         N     @10,@CF00706                                        0212 00593000
         LTR   @10,@10                                             0212 00594000
         BZ    @RT00212                                            0212 00595000
*            GOTO ABEND;                /* NO - TERMINATE OPEN       */ 00596000
*          ELSE;                        /* YES - CONTINUE OPEN       */ 00597000
*                                                                  0214 00598000
*                                                                  0214 00599000
*        R1 = 72;                       /* TEST BUFL           XM5620*/ 00600000
@RF00211 LA    R1,72                                               0215 00601000
*        IF DCBBUFNO ¬= 0               /* WE NEED BUFFERS          */  00602000
*          THEN                         /* SEE IF SIZE IS AVAILABLE */  00603000
         CLI   DCBBUFNO(RDCB),0                                    0216 00604000
         BE    @RF00216                                            0216 00605000
*            IF DCBBUFL = 0             /* --NO IT ISNT             */  00606000
*              THEN DCBBUFL = DCBBLKSI; /* DEFAULT IT FROM BLKSI    */  00607000
         LH    @10,DCBBUFL(,RDCB)                                  0217 00608000
         N     @10,@CF00706                                        0217 00609000
         LTR   @10,@10                                             0217 00610000
         BNZ   @RF00217                                            0217 00611000
         LH    @10,DCBBLKSI(,RDCB)                                 0218 00612000
         N     @10,@CF00706                                        0218 00613000
         STH   @10,DCBBUFL(,RDCB)                                  0218 00614000
*              ELSE                     /* --YES IT IS              */  00615000
*                IF DCBBUFL < DCBBLKSI  /* IS IT BIG ENOUGH?        */  00616000
*                  & DCBCIND2(8) = '1'B /* FOR QSAM?        @ZA10277*/  00617000
*                  THEN GOTO ABEND;     /* IF NOT, ABEND            */  00618000
*                                                                  0219 00619000
         B     @RC00217                                            0219 00620000
@RF00217 CLC   DCBBUFL(2,RDCB),DCBBLKSI(RDCB)                      0219 00621000
         BNL   @RF00219                                            0219 00622000
         TM    DCBCIND2(RDCB),B'00000001'                          0219 00623000
         BO    @RT00219                                            0219 00624000
*        R1 = 61;                       /* TEST BUFL & BLKSI  XM3337*/  00625000
@RF00219 DS    0H                                                  0221 00626000
@RC00217 DS    0H                                                  0221 00627000
@RF00216 LA    R1,61                                               0221 00628000
*        IF DCBCIND2(8) = '0'B & DCBBUFNO = 0 THEN/*               0222 00629000
*                                                BSAM AND NO  XM3337*/  00630000
         TM    DCBCIND2(RDCB),B'00000001'                          0222 00631000
         BNZ   @RF00222                                            0222 00632000
         CLI   DCBBUFNO(RDCB),0                                    0222 00633000
         BE    @RT00222                                            0222 00634000
*                                       /* NEED TO BUILD BUF  XM3337*/  00635000
*          GOTO CHKBFTEK;               /* CONTINUE OPEN      XM3337*/  00636000
*  IF DCBBUFCC(32)¬= '1'B THEN          /* BUF ALREADY BUILT @ZA30207*/ 00637000
@RF00222 TM    DCBBUFCC+3(RDCB),B'00000001'                        0224 00638000
         BNO   @RT00224                                            0224 00639000
*  GO TO  CHKBFTEK ;                    /* CONTINUE OPEN     @ZA28861*/ 00640000
*             ELSE IF DCBBUFL = 0       /* BUFFER LENGTH =0   XM3337*/  00641000
*                    & DCBBLKSI = 0 THEN /* AND BLOCKSIZE =0  XM3337*/  00642000
         LH    @10,DCBBUFL(,RDCB)                                  0226 00643000
         N     @10,@CF00706                                        0226 00644000
         LTR   @10,@10                                             0226 00645000
         BNZ   @RF00226                                            0226 00646000
         LH    @10,DCBBLKSI(,RDCB)                                 0226 00647000
         N     @10,@CF00706                                        0226 00648000
         LTR   @10,@10                                             0226 00649000
         BNZ   @RF00226                                            0226 00650000
*             DCBBLKSI = DCBLRECL;      /* SET BLK=LRECL    @ZA18528*/  00651000
         LH    @10,DCBLRECL(,RDCB)                                 0227 00652000
         N     @10,@CF00706                                        0227 00653000
         STH   @10,DCBBLKSI(,RDCB)                                 0227 00654000
*                  ELSE IF DCBBLKSI = 0 /* BLOCKSIZE = 0      YM5890*/  00655000
*             & DCBLRECL = 0 THEN GOTO ABEND;/* DCBLRECL=0  @ZA27045*/  00656000
*                                                                  0228 00657000
*                                                                  0228 00658000
         B     @RC00226                                            0228 00659000
@RF00226 LH    @10,DCBBLKSI(,RDCB)                                 0228 00660000
         N     @10,@CF00706                                        0228 00661000
         LTR   @10,@10                                             0228 00662000
         BNZ   @RF00228                                            0228 00663000
         LH    @10,DCBLRECL(,RDCB)                                 0228 00664000
         N     @10,@CF00706                                        0228 00665000
         LTR   @10,@10                                             0228 00666000
         BZ    @RT00228                                            0228 00667000
*CHKBFTEK:                              /* TEST BFTEK         XM3337*/  00668000
*        IF DCBBFTEK = '00'X            /* BUFTEK/BUFALN NOT GIVEN  */  00669000
*          THEN                         /* NO                       */  00670000
@RF00228 DS    0H                                                  0230 00671000
@RC00226 DS    0H                                                  0230 00672000
CHKBFTEK CLI   DCBBFTEK(RDCB),X'00'                                0230 00673000
         BNE   @RF00230                                            0230 00674000
*            DCBBFTEK = '46'X;          /* DEFAULT TO BFTEK=S,ALN=D */  00675000
*                                                                  0231 00676000
*                                                                  0231 00677000
         MVI   DCBBFTEK(RDCB),X'46'                                0231 00678000
*        R1 = 47;                       /* TEST OPTCD          XM5620*/ 00679000
@RF00230 LA    R1,47                                               0232 00680000
*        IF DCBOPTCD(5) = '1'B          /* ASCII TRANSLATE          */  00681000
*         | DCBOPTCD(7) = '1'B          /* USER TOTALTING           */  00682000
*             THEN                      /* OPTION(S) INDICATED      */  00683000
         TM    DCBOPTCD(RDCB),B'00001010'                          0233 00684000
         BNZ   @RT00233                                            0233 00685000
*               GOTO ABEND;             /* --BOTH INVALID           */  00686000
*                                                                  0234 00687000
*NOABEND:                               /* NORMAL RETURN LOC   XM5620*/ 00688000
*        R1 = 0;                        /* CLEAR RETURN REG    XM5620*/ 00689000
NOABEND  SLR   R1,R1                                               0235 00690000
*ABEND:                                 /* ERROR RETURN LOC    XM5620*/ 00691000
*        RETURN CODE(R1);               /* RETURN TO CALLER    XM5620*/ 00692000
*                                                                  0236 00693000
ABEND    LR    @15,R1                                              0236 00694000
         L     @14,12(,@13)                                        0236 00695000
         LM    @00,@12,20(@13)                                     0236 00696000
         BR    @14                                                 0236 00697000
*        END PROCESS;                                              0237 00698000
*                                                                  0237 00699000
*        END IGG0199G                   /* END OF IGG0199G MODULE    */ 00700000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 00701000
*/*%INCLUDE SYSLIB  (IFGSDCB )                                        * 00702000
*/*%INCLUDE SYSLIB  (IEZDEB  )                                        * 00703000
*/*%INCLUDE SYSLIB  (IFGJCICB)                                        * 00704000
*/*%INCLUDE SYSLIB  (IFGACB  )                                        * 00705000
*;                                                                 0238 00706000
@DATA    DS    0H                                                       00707000
@CH00699 DC    H'180'                                                   00708000
@DATD    DSECT                                                          00709000
         DS    0F                                                       00710000
@ZTEMPS  DS    C                                                        00711000
@ZTEMPND EQU   *                                                        00712000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         00713000
@TEMPS   EQU   @ZTEMPS                                                  00714000
@L       EQU   @ZLEN                                                    00715000
IGG0199G CSECT                                                          00716000
         DS    0F                                                       00717000
@CF00074 DC    F'4'                                                     00718000
@CF00705 DC    F'-8'                                                    00719000
@CF00706 DC    XL4'0000FFFF'                                            00720000
@DATD    DSECT                                                          00721000
         DS    0D                                                       00722000
IGG0199G CSECT                                                          00723000
         DS    0F                                                       00724000
@SIZDATD DC    AL1(0)                                                   00725000
         DC    AL3(@ENDDATD-@DATD)                                      00726000
@SIZ001  EQU   @SIZDATD                                                 00727000
         DS    0D                                                       00728000
@CC00641 DC    C'9G'                                                    00729000
@CC00646 DC    C'0S'                                                    00730000
         DS    CL4                                                      00731000
LOADLIST DS    CL14                                                     00732000
         ORG   LOADLIST                                                 00733000
@NM00015 DS    CL6                                                      00734000
         ORG   @NM00015                                                 00735000
XCTLID   DC    CL2'9W'                                                  00736000
XCTLTTR  DC    AL3(0)                                                   00737000
XCTLLEN  DC    AL1(0)                                                   00738000
         ORG   LOADLIST+6                                               00739000
PDENTRY  DS    CL6                                                      00740000
         ORG   PDENTRY                                                  00741000
PDID     DC    CL2'6M'                                                  00742000
PDTTR    DC    AL3(0)                                                   00743000
PDLEN    DC    AL1(0)                                                   00744000
         ORG   LOADLIST+12                                              00745000
@NM00016 DC    AL2(0)                                                   00746000
         ORG   LOADLIST+14                                              00747000
@DATD    DSECT                                                          00748000
IGG0199G CSECT                                                          00749000
PATCH    EQU   *                                                        00750000
         DS    CL(IGG0199G+1280-PATCH)  AMOUNT OF UNUSED SPACE   XM3337 00751000
PATCH#   EQU   *-PATCH                  LENGTH OF UNUSED SPACE          00752000
         ORG   PATCH                    SET ORIGIN FOR PATCH AREA       00753000
         DC    (PATCH#)C' '             BLANK OUT PATCH AREA            00754000
         DC    C'019'                   SVC CODE                        00755000
         DC    AL1((LOADLIST-IGG0199G)/8) DISPLACEMENT TO TABLE         00756000
@DATD    DSECT                                                          00757000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00758000
@ENDDATD EQU   *                                                        00759000
@DATEND  EQU   *                                                        00760000
IGG0199G CSECT                                                          00761000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00762000
@01      EQU   01                                                       00763000
@02      EQU   02                                                       00764000
@03      EQU   03                                                       00765000
@04      EQU   04                                                       00766000
@05      EQU   05                                                       00767000
@06      EQU   06                                                       00768000
@07      EQU   07                                                       00769000
@08      EQU   08                                                       00770000
@09      EQU   09                                                       00771000
@10      EQU   10                                                       00772000
@11      EQU   11                                                       00773000
@12      EQU   12                                                       00774000
@13      EQU   13                                                       00775000
@14      EQU   14                                                       00776000
@15      EQU   15                                                       00777000
@0       EQU   00                                                       00778000
@1       EQU   01                                                       00779000
@2       EQU   02                                                       00780000
@3       EQU   03                                                       00781000
@4       EQU   04                                                       00782000
@5       EQU   05                                                       00783000
@6       EQU   06                                                       00784000
@7       EQU   07                                                       00785000
@8       EQU   08                                                       00786000
@9       EQU   09                                                       00787000
@A       EQU   10                                                       00788000
@B       EQU   11                                                       00789000
@C       EQU   12                                                       00790000
@D       EQU   13                                                       00791000
@E       EQU   14                                                       00792000
@F       EQU   15                                                       00793000
R0       EQU   @00                                                      00794000
R1       EQU   @01                                                      00795000
RDCB     EQU   @02                                                      00796000
RJFCBC   EQU   @02                                                      00797000
RUKEY    EQU   @02                                                      00798000
RSIZE    EQU   @03                                                      00799000
ROPEN    EQU   @04                                                      00800000
RPAR     EQU   @05                                                      00801000
RWTG     EQU   @06                                                      00802000
RPARC    EQU   @07                                                      00803000
RWTGC    EQU   @08                                                      00804000
ROPENC   EQU   @09                                                      00805000
R13      EQU   @13                                                      00806000
R15      EQU   @15                                                      00807000
RDEB     EQU   @06                                                      00808000
RACB     EQU   @09                                                      00809000
RCICB    EQU   @12                                                      00810000
WTG      EQU   0                                                        00811000
WTGMDNAM EQU   WTG                                                      00812000
WTGID    EQU   WTGMDNAM+6                                               00813000
WTGTTR   EQU   WTG+14                                                   00814000
WTGTBLEN EQU   WTG+29                                                   00815000
WTG1ENT  EQU   WTG+32                                                   00816000
WTGC     EQU   0                                                        00817000
WTGCID   EQU   WTGC                                                     00818000
WTGCTTR  EQU   WTGC+2                                                   00819000
WTGCWA   EQU   WTGC+5                                                   00820000
PARCNTRY EQU   0                                                        00821000
PARCOPT  EQU   PARCNTRY                                                 00822000
PARCOPOP EQU   PARCOPT                                                  00823000
PARCDCB  EQU   PARCNTRY+1                                               00824000
OPENNTRY EQU   0                                                        00825000
OPENOPT  EQU   OPENNTRY                                                 00826000
OPENACB  EQU   OPENNTRY+1                                               00827000
IECDSECT EQU   0                                                        00828000
IECJFCB  EQU   IECDSECT+100                                             00829000
DXCCW    EQU   IECDSECT+368                                             00830000
DXCALLID EQU   IECDSECT+456                                             00831000
DXUKEY   EQU   IECDSECT+526                                             00832000
DXUDCBAD EQU   IECDSECT+568                                             00833000
DXATEXC1 EQU   IECDSECT+604                                             00834000
NEWJFCB  EQU   0                                                        00835000
JFCBMASK EQU   NEWJFCB+72                                               00836000
IFGSDCB  EQU   0                                                        00837000
DCBBUFCB EQU   IFGSDCB+20                                               00838000
DCBBUFNO EQU   DCBBUFCB                                                 00839000
DCBBUFL  EQU   IFGSDCB+24                                               00840000
DCBDSORG EQU   IFGSDCB+26                                               00841000
DCBIOBAD EQU   IFGSDCB+28                                               00842000
@NM00019 EQU   IFGSDCB+32                                               00843000
DCBHIARC EQU   @NM00019                                                 00844000
DCBBFTEK EQU   DCBHIARC                                                 00845000
DCBRECFM EQU   IFGSDCB+36                                               00846000
DCBDDNAM EQU   IFGSDCB+40                                               00847000
DCBMACRF EQU   DCBDDNAM+2                                               00848000
DCBDEBAD EQU   DCBDDNAM+5                                               00849000
DCBREAD  EQU   IFGSDCB+49                                               00850000
DCBWRITE EQU   DCBREAD                                                  00851000
DCBGET   EQU   DCBWRITE                                                 00852000
DCBPUT   EQU   DCBGET                                                   00853000
DCBOPTCD EQU   IFGSDCB+52                                               00854000
DCBCHECK EQU   IFGSDCB+53                                               00855000
DCBGERR  EQU   DCBCHECK                                                 00856000
DCBCIND2 EQU   IFGSDCB+61                                               00857000
DCBBLKSI EQU   IFGSDCB+62                                               00858000
DCBIOBA  EQU   IFGSDCB+68                                               00859000
DCBCICB  EQU   DCBIOBA                                                  00860000
DCBEOBAD EQU   IFGSDCB+72                                               00861000
DCBLCCW  EQU   DCBEOBAD                                                 00862000
DCBEOBR  EQU   DCBLCCW                                                  00863000
@NM00020 EQU   IFGSDCB+76                                               00864000
DCBEOBW  EQU   @NM00020                                                 00865000
DCBRECAD EQU   DCBEOBW                                                  00866000
DCBDIRCT EQU   IFGSDCB+80                                               00867000
DCBLRECL EQU   IFGSDCB+82                                               00868000
@NM00021 EQU   IFGSDCB+84                                               00869000
DCBCNTRL EQU   @NM00021+1                                               00870000
DCBNOTE  EQU   DCBCNTRL                                                 00871000
NOBASE   EQU   0                                                        00872000
DEBBASIC EQU   0                                                        00873000
DEBTCBAD EQU   DEBBASIC                                                 00874000
DEBDEBAD EQU   DEBBASIC+4                                               00875000
DEBIRBAD EQU   DEBBASIC+8                                               00876000
DEBOFLGS EQU   DEBIRBAD                                                 00877000
DEBOPATB EQU   DEBBASIC+12                                              00878000
DEBFLGS1 EQU   DEBBASIC+14                                              00879000
DEBCINDI EQU   DEBFLGS1                                                 00880000
DEBUSRPG EQU   DEBBASIC+16                                              00881000
DEBRRQ   EQU   DEBBASIC+20                                              00882000
DEBECBAD EQU   DEBRRQ                                                   00883000
DEBECBB  EQU   DEBECBAD+1                                               00884000
DEBDCBAD EQU   DEBBASIC+24                                              00885000
DEBPROTG EQU   DEBDCBAD                                                 00886000
DEBAPPAD EQU   DEBBASIC+28                                              00887000
DEBBASND EQU   DEBBASIC+32                                              00888000
DEBDASD  EQU   0                                                        00889000
DEBUCBAD EQU   DEBDASD                                                  00890000
DEBACSMD EQU   0                                                        00891000
DEBVOLSQ EQU   DEBACSMD                                                 00892000
DEBVOLBT EQU   DEBVOLSQ                                                 00893000
DEBDSNM  EQU   DEBACSMD+4                                               00894000
DEBUTSAA EQU   DEBDSNM                                                  00895000
DEBACS01 EQU   0                                                        00896000
DEBDSNAM EQU   DEBACS01                                                 00897000
DEBACS02 EQU   0                                                        00898000
DEBDBLK  EQU   DEBACS02                                                 00899000
DEBACS03 EQU   0                                                        00900000
DEBACS04 EQU   0                                                        00901000
DEBTBFRA EQU   DEBACS04                                                 00902000
DEBTCCWA EQU   DEBACS04+4                                               00903000
DEBACS05 EQU   0                                                        00904000
DEBFUCBA EQU   DEBACS05                                                 00905000
DEBLUCBA EQU   DEBACS05+4                                               00906000
DEBACS06 EQU   0                                                        00907000
DEBACS07 EQU   0                                                        00908000
DEBACS08 EQU   0                                                        00909000
DEBSUBNM EQU   0                                                        00910000
DEB      EQU   0                                                        00911000
DEBAVT   EQU   DEB                                                      00912000
DEBEOEA  EQU   DEBAVT                                                   00913000
DEBEOEAB EQU   DEBEOEA                                                  00914000
DEBSIOA  EQU   DEBAVT+4                                                 00915000
DEBSIOAB EQU   DEBSIOA                                                  00916000
DEBPCIA  EQU   DEBAVT+8                                                 00917000
DEBPCIAB EQU   DEBPCIA                                                  00918000
DEBCEA   EQU   DEBAVT+12                                                00919000
DEBCEAB  EQU   DEBCEA                                                   00920000
DEBXCEA  EQU   DEBAVT+16                                                00921000
DEBXCEAB EQU   DEBXCEA                                                  00922000
DEBPREFX EQU   DEB+20                                                   00923000
DEBXTNP  EQU   DEBPREFX+8                                               00924000
DEBXTN   EQU   0                                                        00925000
DEBXFLG1 EQU   DEBXTN+2                                                 00926000
DEBXDCBM EQU   DEBXTN+8                                                 00927000
IFGJCICB EQU   0                                                        00928000
CIDUMIOB EQU   IFGJCICB                                                 00929000
CIACBD   EQU   IFGJCICB+32                                              00930000
CIREGSAV EQU   IFGJCICB+116                                             00931000
CIFLAGS  EQU   IFGJCICB+188                                             00932000
CIFLAG2  EQU   CIFLAGS+1                                                00933000
CIFLAG3  EQU   CIFLAGS+2                                                00934000
CIIOCNT  EQU   IFGJCICB+308                                             00935000
CISVCLST EQU   IFGJCICB+336                                             00936000
CISYNADA EQU   CISVCLST                                                 00937000
CIBLDL   EQU   CISVCLST+4                                               00938000
CIBSP    EQU   CISVCLST+8                                               00939000
CIFEOV   EQU   CISVCLST+12                                              00940000
CISTOW   EQU   CISVCLST+16                                              00941000
IFGACB   EQU   0                                                        00942000
ACBCOMN  EQU   IFGACB                                                   00943000
ACBLENG  EQU   ACBCOMN+2                                                00944000
ACBLENG2 EQU   ACBLENG                                                  00945000
ACBAMBL  EQU   ACBCOMN+4                                                00946000
ACBJWA   EQU   ACBAMBL                                                  00947000
ACBMACRF EQU   ACBCOMN+12                                               00948000
ACBMACR1 EQU   ACBMACRF                                                 00949000
ACBADR   EQU   ACBMACR1                                                 00950000
ACBCNV   EQU   ACBMACR1                                                 00951000
ACBMACR2 EQU   ACBMACRF+1                                               00952000
ACBBUFPL EQU   ACBCOMN+20                                               00953000
ACBMACR3 EQU   ACBBUFPL                                                 00954000
ACBRECFM EQU   ACBCOMN+24                                               00955000
ACBCCTYP EQU   ACBCOMN+25                                               00956000
ACBOPT   EQU   ACBCOMN+26                                               00957000
ACBDSORG EQU   ACBOPT                                                   00958000
ACBCROPS EQU   ACBDSORG                                                 00959000
ACBEXLST EQU   ACBCOMN+36                                               00960000
ACBDDNM  EQU   ACBCOMN+40                                               00961000
ACBAMETH EQU   ACBDDNM+3                                                00962000
ACBOFLGS EQU   ACBCOMN+48                                               00963000
ACBOPEN  EQU   ACBOFLGS                                                 00964000
ACBEXFG  EQU   ACBOFLGS                                                 00965000
ACBIOSFG EQU   ACBOFLGS                                                 00966000
ACBINFLG EQU   ACBCOMN+50                                               00967000
ACBUJFCB EQU   ACBCOMN+52                                               00968000
ACBBLKSZ EQU   ACBCOMN+60                                               00969000
DEBXTNPT EQU   -8                                                       00970000
DEBBAS02 EQU   DEBBASND                                                 00971000
DEBDDS1  EQU   DEBBAS02                                                 00972000
DEBSUCBA EQU   DEBDDS1                                                  00973000
DEBDEVED EQU   DEBDDS1+4                                                00974000
DEBRDCB  EQU   DEBDDS1+4                                                00975000
DEBPDCB  EQU   DEBDDS1+8                                                00976000
DEBWDCB  EQU   DEBDDS1+12                                               00977000
DEBACS09 EQU   DEBDEVED                                                 00978000
DEBASC09 EQU   DEBACS09                                                 00979000
DEBEAMFG EQU   DEBASC09+3                                               00980000
DEBDSID  EQU   DEBASC09+4                                               00981000
DEBEOD   EQU   DEBASC09+12                                              00982000
DEBBOE   EQU   DEBEOD                                                   00983000
DEBEODRV EQU   DEBBOE                                                   00984000
DEBEODTT EQU   DEBBOE+1                                                 00985000
DEBEOD0  EQU   DEBBOE+2                                                 00986000
DEBEODSS EQU   DEBBOE+3                                                 00987000
DEBBAS01 EQU   DEBBASND                                                 00988000
DEBISAM  EQU   DEBBAS01                                                 00989000
DEBFIEAD EQU   DEBISAM                                                  00990000
DEBFPEAD EQU   DEBISAM+4                                                00991000
DEBFOEAD EQU   DEBISAM+8                                                00992000
DEBEXPT  EQU   DEBISAM+12                                               00993000
DEBRPSID EQU   DEBEXPT                                                  00994000
ATFLAGS  EQU   DXATEXC1                                                 00995000
ATFOPEN  EQU   ATFLAGS                                                  00996000
ATFABEND EQU   ATFOPEN                                                  00997000
ATFCLOSE EQU   ATFLAGS+1                                                00998000
DCBBUFCC EQU   DCBBUFCB                                                 00999000
*                                      START UNREFERENCED COMPONENTS    01000000
@NM00044 EQU   ATFCLOSE                                                 01001000
ATFCICBF EQU   ATFCLOSE                                                 01002000
ATFMDMSK EQU   ATFCLOSE                                                 01003000
ATFCHECK EQU   ATFOPEN                                                  01004000
ATFSYNC  EQU   ATFOPEN                                                  01005000
ATFBSAM  EQU   ATFOPEN                                                  01006000
ATFQSAM  EQU   ATFOPEN                                                  01007000
@NM00043 EQU   ATFOPEN                                                  01008000
ATFCICBG EQU   ATFOPEN                                                  01009000
DEBEXPTA EQU   DEBEXPT+1                                                01010000
DEBRSV12 EQU   DEBRPSID                                                 01011000
DEBRSV11 EQU   DEBRPSID                                                 01012000
DEBRSV10 EQU   DEBRPSID                                                 01013000
DEBRSV09 EQU   DEBRPSID                                                 01014000
DEBRPSAP EQU   DEBRPSID                                                 01015000
DEBRPSO  EQU   DEBRPSID                                                 01016000
DEBRPSI  EQU   DEBRPSID                                                 01017000
DEBRPSP  EQU   DEBRPSID                                                 01018000
DEBFOEB  EQU   DEBFOEAD+1                                               01019000
DEBNOEE  EQU   DEBFOEAD                                                 01020000
DEBFPEB  EQU   DEBFPEAD+1                                               01021000
DEBNPEE  EQU   DEBFPEAD                                                 01022000
DEBFIEB  EQU   DEBFIEAD+1                                               01023000
DEBNIEE  EQU   DEBFIEAD                                                 01024000
DEBBOESS EQU   DEBEODSS                                                 01025000
DEBBOE0  EQU   DEBEOD0                                                  01026000
DEBBOETT EQU   DEBEODTT                                                 01027000
DEBBOERV EQU   DEBEODRV                                                 01028000
DEBRV008 EQU   DEBDSID+7                                                01029000
DEBWTPTI EQU   DEBDSID+6                                                01030000
DEBEXDTE EQU   DEBDSID                                                  01031000
DEBRV007 EQU   DEBEAMFG                                                 01032000
DEBRV006 EQU   DEBEAMFG                                                 01033000
DEBRV005 EQU   DEBEAMFG                                                 01034000
DEBRV004 EQU   DEBEAMFG                                                 01035000
DEBSECVL EQU   DEBEAMFG                                                 01036000
DEBVAMSG EQU   DEBEAMFG                                                 01037000
DEBDSOPN EQU   DEBEAMFG                                                 01038000
DEBMULTI EQU   DEBEAMFG                                                 01039000
DEBVSEQU EQU   DEBASC09+2                                               01040000
DEBDSSQL EQU   DEBASC09+1                                               01041000
DEBVOLAC EQU   DEBASC09                                                 01042000
DEBWDCBA EQU   DEBWDCB+1                                                01043000
DEBRSV08 EQU   DEBWDCB                                                  01044000
DEBPDCBA EQU   DEBPDCB+1                                                01045000
DEBRSV07 EQU   DEBPDCB                                                  01046000
DEBRDCBA EQU   DEBRDCB+1                                                01047000
DEBRSV06 EQU   DEBRDCB                                                  01048000
DEBSUCBB EQU   DEBSUCBA+1                                               01049000
DEBSDVM  EQU   DEBSUCBA                                                 01050000
ACBAPID  EQU   ACBCOMN+72                                               01051000
ACBCBMWA EQU   ACBCOMN+68                                               01052000
ACBUAPTR EQU   ACBCOMN+64                                               01053000
ACBLRECL EQU   ACBCOMN+62                                               01054000
ACBMSGLN EQU   ACBBLKSZ                                                 01055000
ACBBUFSP EQU   ACBCOMN+56                                               01056000
@NM00042 EQU   ACBUJFCB+1                                               01057000
ACBOPTN  EQU   ACBUJFCB                                                 01058000
ACBVVIC  EQU   ACBINFLG                                                 01059000
ACBUCRA  EQU   ACBINFLG                                                 01060000
ACBSCRA  EQU   ACBINFLG                                                 01061000
ACBCAT   EQU   ACBINFLG                                                 01062000
ACBIJRQE EQU   ACBINFLG                                                 01063000
ACBJEPS  EQU   ACBINFLG                                                 01064000
@NM00041 EQU   ACBINFLG                                                 01065000
ACBERFLG EQU   ACBCOMN+49                                               01066000
ACBBUSY  EQU   ACBIOSFG                                                 01067000
ACBLOCK  EQU   ACBEXFG                                                  01068000
@NM00040 EQU   ACBOFLGS                                                 01069000
ACBDSERR EQU   ACBOFLGS                                                 01070000
ACBEOV   EQU   ACBOFLGS                                                 01071000
@NM00039 EQU   ACBOFLGS                                                 01072000
ACBDEB   EQU   ACBDDNM+5                                                01073000
ACBERFL  EQU   ACBDDNM+4                                                01074000
ACBAM    EQU   ACBAMETH                                                 01075000
ACBINFL  EQU   ACBDDNM+2                                                01076000
ACBTIOT  EQU   ACBDDNM                                                  01077000
ACBUEL   EQU   ACBEXLST                                                 01078000
ACBPASSW EQU   ACBCOMN+32                                               01079000
ACBMSGAR EQU   ACBCOMN+28                                               01080000
@NM00038 EQU   ACBDSORG+1                                               01081000
ACBDORGA EQU   ACBDSORG+1                                               01082000
@NM00037 EQU   ACBDSORG                                                 01083000
ACBCRNRE EQU   ACBCROPS                                                 01084000
ACBCRNCK EQU   ACBCROPS                                                 01085000
ACBASA   EQU   ACBCCTYP                                                 01086000
@NM00036 EQU   ACBCCTYP                                                 01087000
ACBRECAF EQU   ACBRECFM                                                 01088000
ACBJBUF  EQU   ACBBUFPL+2                                               01089000
ACBMACR4 EQU   ACBBUFPL+1                                               01090000
@NM00035 EQU   ACBMACR3                                                 01091000
ACBNCFX  EQU   ACBMACR3                                                 01092000
ACBSIS   EQU   ACBMACR3                                                 01093000
ACBDFR   EQU   ACBMACR3                                                 01094000
ACBICI   EQU   ACBMACR3                                                 01095000
ACBGSR   EQU   ACBMACR3                                                 01096000
ACBLSR   EQU   ACBMACR3                                                 01097000
@NM00034 EQU   ACBMACR3                                                 01098000
ACBBUFNI EQU   ACBCOMN+18                                               01099000
ACBBUFND EQU   ACBCOMN+16                                               01100000
ACBSTRNO EQU   ACBCOMN+15                                               01101000
ACBBSTNO EQU   ACBCOMN+14                                               01102000
ACBAIX   EQU   ACBMACR2                                                 01103000
ACBDSN   EQU   ACBMACR2                                                 01104000
ACBRST   EQU   ACBMACR2                                                 01105000
ACBLOGON EQU   ACBMACR2                                                 01106000
ACBSKP   EQU   ACBMACR2                                                 01107000
@NM00033 EQU   ACBMACR2                                                 01108000
ACBUBF   EQU   ACBMACR1                                                 01109000
ACBOUT   EQU   ACBMACR1                                                 01110000
ACBIN    EQU   ACBMACR1                                                 01111000
ACBDIR   EQU   ACBMACR1                                                 01112000
ACBSEQ   EQU   ACBMACR1                                                 01113000
ACBBLK   EQU   ACBCNV                                                   01114000
ACBADD   EQU   ACBADR                                                   01115000
ACBKEY   EQU   ACBMACR1                                                 01116000
ACBINRTN EQU   ACBCOMN+8                                                01117000
ACBIBCT  EQU   ACBJWA                                                   01118000
ACBLEN2  EQU   ACBLENG2                                                 01119000
ACBSTYP  EQU   ACBCOMN+1                                                01120000
ACBID    EQU   ACBCOMN                                                  01121000
CISTOWRC EQU   CISTOW                                                   01122000
CIFEOVRC EQU   CIFEOV                                                   01123000
CIBSPRC  EQU   CIBSP                                                    01124000
CIBLDLRC EQU   CIBLDL                                                   01125000
CISYNRC  EQU   CISYNADA                                                 01126000
CIWK2    EQU   IFGJCICB+332                                             01127000
CIWK1    EQU   IFGJCICB+328                                             01128000
CISAMWA  EQU   IFGJCICB+324                                             01129000
CIRECPTR EQU   IFGJCICB+320                                             01130000
CIRAREA  EQU   IFGJCICB+316                                             01131000
CIBLKPTR EQU   IFGJCICB+312                                             01132000
CISEGLEN EQU   CIIOCNT                                                  01133000
CILWAREA EQU   IFGJCICB+304                                             01134000
CIFDBCK  EQU   IFGJCICB+284                                             01135000
CIRPLEXT EQU   IFGJCICB+268                                             01136000
CIRPL    EQU   IFGJCICB+192                                             01137000
CIFLAG4  EQU   CIFLAGS+3                                                01138000
@NM00032 EQU   CIFLAG3                                                  01139000
CIFPOINT EQU   CIFLAG3                                                  01140000
CIFERROR EQU   CIFLAG3                                                  01141000
CIFVSEOB EQU   CIFLAG3                                                  01142000
CIFVSRI  EQU   CIFLAG3                                                  01143000
CIFRAGM  EQU   CIFLAG3                                                  01144000
CIFCLOSE EQU   CIFLAG3                                                  01145000
CIFFSTP  EQU   CIFLAG3                                                  01146000
@NM00031 EQU   CIFLAG2                                                  01147000
CIFMDEVT EQU   CIFLAG2                                                  01148000
CIFMDSOR EQU   CIFLAG2                                                  01149000
CIFLAG1  EQU   CIFLAGS                                                  01150000
CIREGS   EQU   CIREGSAV+12                                              01151000
CIREGFC  EQU   CIREGSAV+8                                               01152000
CIREGBC  EQU   CIREGSAV+4                                               01153000
@NM00030 EQU   CIREGSAV                                                 01154000
CISYNNAM EQU   IFGJCICB+108                                             01155000
CIACBED  EQU   IFGJCICB+88                                              01156000
CIDCBPTR EQU   CIDUMIOB+28                                              01157000
@NM00029 EQU   CIDUMIOB+24                                              01158000
CIRESID  EQU   CIDUMIOB+20                                              01159000
@NM00028 EQU   CIDUMIOB+16                                              01160000
CIECBPTR EQU   CIDUMIOB+12                                              01161000
CIIOB    EQU   CIDUMIOB+8                                               01162000
@NM00027 EQU   CIDUMIOB+5                                               01163000
CIECBCD  EQU   CIDUMIOB+4                                               01164000
CINXTIOB EQU   CIDUMIOB                                                 01165000
DEBXSAMB EQU   DEBXTN+28                                                01166000
DEBXOPNJ EQU   DEBXTN+24                                                01167000
DEBXXARG EQU   DEBXTN+20                                                01168000
DEBXMCF2 EQU   DEBXTN+19                                                01169000
DEBXMCF1 EQU   DEBXTN+18                                                01170000
DEBXDSO2 EQU   DEBXTN+17                                                01171000
DEBXDSO1 EQU   DEBXTN+16                                                01172000
DEBXDBPR EQU   DEBXTN+12                                                01173000
DEBXDSAB EQU   DEBXTN+4                                                 01174000
DEBXRV48 EQU   DEBXTN+3                                                 01175000
DEBXRV47 EQU   DEBXFLG1                                                 01176000
DEBXRV46 EQU   DEBXFLG1                                                 01177000
DEBXRV45 EQU   DEBXFLG1                                                 01178000
DEBXRV44 EQU   DEBXFLG1                                                 01179000
DEBXRV43 EQU   DEBXFLG1                                                 01180000
DEBXDSSI EQU   DEBXFLG1                                                 01181000
DEBXTSKC EQU   DEBXFLG1                                                 01182000
DEBXCDCB EQU   DEBXFLG1                                                 01183000
DEBXLNGH EQU   DEBXTN                                                   01184000
DEBTBLOF EQU   DEBPREFX+14                                              01185000
DEBAMTYP EQU   DEBPREFX+13                                              01186000
DEBLNGTH EQU   DEBPREFX+12                                              01187000
DEBDCBMK EQU   DEBXTNP                                                  01188000
DEBDSCBA EQU   DEBPREFX+1                                               01189000
DEBWKARA EQU   DEBPREFX                                                 01190000
DEBXCEAD EQU   DEBXCEA+1                                                01191000
DEBXCENP EQU   DEBXCEAB                                                 01192000
DEBRSV35 EQU   DEBXCEAB                                                 01193000
DEBRSV34 EQU   DEBXCEAB                                                 01194000
DEBRSV33 EQU   DEBXCEAB                                                 01195000
DEBRSV32 EQU   DEBXCEAB                                                 01196000
DEBCEAD  EQU   DEBCEA+1                                                 01197000
DEBCENP  EQU   DEBCEAB                                                  01198000
DEBRSV31 EQU   DEBCEAB                                                  01199000
DEBRSV30 EQU   DEBCEAB                                                  01200000
DEBRSV29 EQU   DEBCEAB                                                  01201000
DEBRSV28 EQU   DEBCEAB                                                  01202000
DEBPCIAD EQU   DEBPCIA+1                                                01203000
DEBPCINP EQU   DEBPCIAB                                                 01204000
DEBRSV27 EQU   DEBPCIAB                                                 01205000
DEBRSV26 EQU   DEBPCIAB                                                 01206000
DEBRSV25 EQU   DEBPCIAB                                                 01207000
DEBRSV24 EQU   DEBPCIAB                                                 01208000
DEBSIOAD EQU   DEBSIOA+1                                                01209000
DEBSIONP EQU   DEBSIOAB                                                 01210000
DEBFIX   EQU   DEBSIOAB                                                 01211000
DEBIOVR  EQU   DEBSIOAB                                                 01212000
DEBSIOX  EQU   DEBSIOAB                                                 01213000
DEBPGFX  EQU   DEBSIOAB                                                 01214000
DEBEOEAD EQU   DEBEOEA+1                                                01215000
DEBEOENP EQU   DEBEOEAB                                                 01216000
DEBRSV22 EQU   DEBEOEAB                                                 01217000
DEBRSV21 EQU   DEBEOEAB                                                 01218000
DEBRSV20 EQU   DEBEOEAB                                                 01219000
DEBESMVR EQU   DEBEOEAB                                                 01220000
DEBSUBID EQU   DEBSUBNM                                                 01221000
DEBSIOA2 EQU   DEBACS08+24                                              01222000
DEBRPSIO EQU   DEBACS08+20                                              01223000
DEBFREED EQU   DEBACS08+16                                              01224000
@NM00026 EQU   DEBACS08+12                                              01225000
@NM00025 EQU   DEBACS08+8                                               01226000
DEBDISAD EQU   DEBACS08+4                                               01227000
@NM00024 EQU   DEBACS08                                                 01228000
DEBRPSST EQU   DEBACS07+64                                              01229000
DEBARECK EQU   DEBACS07+60                                              01230000
DEBAREWT EQU   DEBACS07+56                                              01231000
DEBACHK  EQU   DEBACS07+52                                              01232000
DEBAWRIT EQU   DEBACS07+48                                              01233000
DEBASETL EQU   DEBACS07+44                                              01234000
DEBAREAD EQU   DEBACS07+40                                              01235000
DEBCRECK EQU   DEBACS07+36                                              01236000
DEBCREWT EQU   DEBACS07+32                                              01237000
DEBCCHK  EQU   DEBACS07+28                                              01238000
DEBCWRIT EQU   DEBACS07+24                                              01239000
DEBCSETL EQU   DEBACS07+20                                              01240000
DEBCREAD EQU   DEBACS07+16                                              01241000
DEBWKPT5 EQU   DEBACS07+12                                              01242000
DEBWKPT4 EQU   DEBACS07+8                                               01243000
DEBGET   EQU   DEBACS07+4                                               01244000
@NM00023 EQU   DEBACS07                                                 01245000
DEBPUT   EQU   DEBACS06+4                                               01246000
DEBDCBFA EQU   DEBACS06                                                 01247000
DEBLUCBB EQU   DEBLUCBA+1                                               01248000
DEBRSV18 EQU   DEBLUCBA                                                 01249000
DEBFUCBB EQU   DEBFUCBA+1                                               01250000
DEBRSV17 EQU   DEBFUCBA                                                 01251000
DEBTCCWB EQU   DEBTCCWA+1                                               01252000
DEBRSV16 EQU   DEBTCCWA                                                 01253000
DEBTBFRB EQU   DEBTBFRA+1                                               01254000
DEBRSV15 EQU   DEBTBFRA                                                 01255000
DEBDBPEF EQU   DEBACS03+8                                               01256000
DEBDBPP  EQU   DEBACS03+4                                               01257000
DEBDTPP  EQU   DEBACS03                                                 01258000
DEBDBPE  EQU   DEBDBLK+1                                                01259000
DEBDBPT  EQU   DEBDBLK                                                  01260000
DEBEXTNM EQU   DEBDSNAM                                                 01261000
DEBLRECL EQU   DEBACSMD+14                                              01262000
DEBBLKSI EQU   DEBACSMD+12                                              01263000
DEBRSV14 EQU   DEBDSNM+4                                                01264000
DEBUTSAB EQU   DEBUTSAA+1                                               01265000
DEBRSV13 EQU   DEBUTSAA                                                 01266000
DEBVOLNM EQU   DEBACSMD+2                                               01267000
DEBVLSEQ EQU   DEBVOLSQ+1                                               01268000
DEBRSV42 EQU   DEBVOLBT                                                 01269000
DEBRSV41 EQU   DEBVOLBT                                                 01270000
DEBRSV40 EQU   DEBVOLBT                                                 01271000
DEBRSV39 EQU   DEBVOLBT                                                 01272000
DEBRSV38 EQU   DEBVOLBT                                                 01273000
DEBRSV37 EQU   DEBVOLBT                                                 01274000
DEBRSV36 EQU   DEBVOLBT                                                 01275000
DEBEXFUL EQU   DEBVOLBT                                                 01276000
DEBNMTRK EQU   DEBDASD+14                                               01277000
DEBENDHH EQU   DEBDASD+12                                               01278000
DEBENDCC EQU   DEBDASD+10                                               01279000
DEBSTRHH EQU   DEBDASD+8                                                01280000
DEBSTRCC EQU   DEBDASD+6                                                01281000
DEBBINUM EQU   DEBDASD+4                                                01282000
DEBUCBA  EQU   DEBUCBAD+1                                               01283000
DEBDVMOD EQU   DEBUCBAD                                                 01284000
DEBAPPB  EQU   DEBAPPAD+1                                               01285000
DEBEXSCL EQU   DEBAPPAD                                                 01286000
DEBDCBB  EQU   DEBDCBAD+1                                               01287000
DEBDEBID EQU   DEBPROTG                                                 01288000
DEBPRIOR EQU   DEBECBAD                                                 01289000
DEBUSRPB EQU   DEBUSRPG+1                                               01290000
DEBNMEXT EQU   DEBUSRPG                                                 01291000
DEBRSV05 EQU   DEBBASIC+15                                              01292000
DEBXTNIN EQU   DEBFLGS1                                                 01293000
DEBAPFIN EQU   DEBFLGS1                                                 01294000
DEBF1CEV EQU   DEBFLGS1                                                 01295000
DEBRSV02 EQU   DEBFLGS1                                                 01296000
DEBRSIOA EQU   DEBFLGS1                                                 01297000
DEBEOFDF EQU   DEBFLGS1                                                 01298000
DEBPWCKD EQU   DEBFLGS1                                                 01299000
DEBQSCNT EQU   DEBBASIC+13                                              01300000
DEBACCS  EQU   DEBOPATB                                                 01301000
DEBPOSIT EQU   DEBOPATB                                                 01302000
DEBZERO  EQU   DEBOPATB                                                 01303000
DEBABEND EQU   DEBOPATB                                                 01304000
DEBIRBB  EQU   DEBIRBAD+1                                               01305000
DEBRERR  EQU   DEBOFLGS                                                 01306000
DEBLABEL EQU   DEBOFLGS                                                 01307000
DEBSPLIT EQU   DEBOFLGS                                                 01308000
DEBDCB   EQU   DEBOFLGS                                                 01309000
DEBRLSE  EQU   DEBOFLGS                                                 01310000
DEBEOF   EQU   DEBOFLGS                                                 01311000
DEBDISP  EQU   DEBOFLGS                                                 01312000
DEBDEBB  EQU   DEBDEBAD+1                                               01313000
DEBAMLNG EQU   DEBDEBAD                                                 01314000
DEBTCBB  EQU   DEBTCBAD+1                                               01315000
DEBNMSUB EQU   DEBTCBAD                                                 01316000
DCBEOB   EQU   IFGSDCB+92                                               01317000
DCBPRECL EQU   IFGSDCB+90                                               01318000
@NM00022 EQU   IFGSDCB+88                                               01319000
DCBPOINT EQU   DCBNOTE                                                  01320000
DCBEROPT EQU   @NM00021                                                 01321000
DCBQSWS  EQU   DCBDIRCT                                                 01322000
DCBCCCW  EQU   DCBRECAD                                                 01323000
DCBNCP   EQU   DCBEOBR                                                  01324000
DCBOFFSW EQU   IFGSDCB+67                                               01325000
DCBOFFSR EQU   IFGSDCB+66                                               01326000
DCBWCPL  EQU   IFGSDCB+65                                               01327000
DCBWCPO  EQU   IFGSDCB+64                                               01328000
DCBCIND1 EQU   IFGSDCB+60                                               01329000
DCBSYNAD EQU   IFGSDCB+57                                               01330000
DCBIOBL  EQU   IFGSDCB+56                                               01331000
DCBPERR  EQU   DCBGERR                                                  01332000
DCBMACR  EQU   DCBPUT+1                                                 01333000
DCBIFLG  EQU   DCBPUT                                                   01334000
DCBOFLGS EQU   IFGSDCB+48                                               01335000
DCBIFLGS EQU   DCBDDNAM+4                                               01336000
DCBTIOT  EQU   DCBDDNAM                                                 01337000
DCBEXLST EQU   IFGSDCB+37                                               01338000
DCBEODAD EQU   IFGSDCB+33                                               01339000
DCBBFALN EQU   DCBBFTEK                                                 01340000
DCBSVCXL EQU   DCBIOBAD                                                 01341000
@NM00018 EQU   IFGSDCB+16                                               01342000
@NM00017 EQU   IFGSDCB                                                  01343000
@NM00014 EQU   NEWJFCB                                                  01344000
DXATEXC2 EQU   IECDSECT+608                                             01345000
@NM00013 EQU   IECDSECT+572                                             01346000
@NM00012 EQU   IECDSECT+527                                             01347000
@NM00011 EQU   IECDSECT+458                                             01348000
@NM00010 EQU   IECDSECT+440                                             01349000
@NM00009 EQU   IECDSECT+364                                             01350000
@NM00008 EQU   IECDSECT+320                                             01351000
@NM00007 EQU   IECDSECT+280                                             01352000
@NM00006 EQU   IECDSECT+276                                             01353000
@NM00005 EQU   IECDSECT                                                 01354000
@NM00004 EQU   PARCOPT                                                  01355000
WTGPATH  EQU   WTG+30                                                   01356000
WTGFLEN  EQU   WTG+27                                                   01357000
WTGTLEN  EQU   WTG+24                                                   01358000
@NM00003 EQU   WTG+17                                                   01359000
@NM00002 EQU   WTG+8                                                    01360000
@NM00001 EQU   WTGMDNAM                                                 01361000
*                                      END UNREFERENCED COMPONENTS      01362000
@RT00059 EQU   RESCAN                                                   01363000
@RT00089 EQU   GIVEOPEN                                                 01364000
@RT00171 EQU   ABEND                                                    01365000
@RT00173 EQU   BADOPT                                                   01366000
@RF00173 EQU   CHKDSORG                                                 01367000
@RT00179 EQU   ABEND                                                    01368000
@RT00181 EQU   BADOPT                                                   01369000
@RF00181 EQU   CHKDSORG                                                 01370000
@RT00188 EQU   ABEND                                                    01371000
@RT00191 EQU   ABEND                                                    01372000
@RT00195 EQU   ABEND                                                    01373000
@RT00202 EQU   ABEND                                                    01374000
@RF00205 EQU   ABEND                                                    01375000
@RT00208 EQU   ABEND                                                    01376000
@RT00212 EQU   ABEND                                                    01377000
@RT00219 EQU   ABEND                                                    01378000
@RT00222 EQU   CHKBFTEK                                                 01379000
@RT00224 EQU   CHKBFTEK                                                 01380000
@RT00228 EQU   ABEND                                                    01381000
@RT00233 EQU   ABEND                                                    01382000
@PB00002 EQU   @EL00001                                                 01383000
@EL01    EQU   @EL00001                                                 01384000
@ENDDATA EQU   *                                                        01385000
         END   IGG0199G,(C'PLS0741',0701,78100)                         01386000
./  ADD  SSI=80250121,NAME=IGG0199W
         TITLE 'IGG0199W    SAM-SI OPEN EXECUTOR                       *00001000
                        '                                               00002000
IGG0199W CSECT ,                                                   0001 00003000
@PROLOG  BALR  @12,0                                               0001 00004000
@PSTART  DS    0H                                                  0001 00005000
         USING @PSTART,@12                                         0001 00006000
         EJECT                                                          00007000
         EJECT                                                          00008000
         EJECT                                                          00009000
*PROCESS:                                                          0058 00010000
*                                                                  0058 00011000
*        /***********************************************************/  00012000
*        /*          INITILIZE MODULE TO RUN IN USER KEY            */  00013000
*        /***********************************************************/  00014000
*                                                                  0058 00015000
*        RUKEY = DXUKEY;                /* SAVE USER KY IN R2 Y02082*/  00016000
PROCESS  L     @11,WTGCWA-1(,RWTGC)                                0058 00017000
         SLR   RUKEY,RUKEY                                         0058 00018000
         IC    RUKEY,DXUKEY(,@11)                                  0058 00019000
*        GEN (MODESET KEYADDR=(2));     /*                    Y02082*/  00020000
*                                                                  0059 00021000
         MODESET KEYADDR=(2)                                            00022000
*        RDCB = PARCDCB;                /* SET BASE FOR DCB   XM6042*/  00023000
         L     RDCB,PARCDCB(,RPARC)                                0060 00024000
*        RDCB = RDCB + 0;               /* ZERO HI-ORDER BYTE XM6042*/  00025000
*        RCICB = DCBCICB;               /* SET BASE FOR CICB  XM6042*/  00026000
         L     RCICB,DCBCICB(,RDCB)                                0062 00027000
*        RRPL = ADDR(CIRPL);            /* SET BASE FOR RPL   XM6042*/  00028000
*                                                                  0063 00029000
         LA    RRPL,CIRPL(,RCICB)                                  0063 00030000
*        /***********************************************************/  00031000
*        /*                                                         */  00032000
*        /* DETERMINE BUFFER REQUIREMENTS                           */  00033000
*        /*                                                         */  00034000
*        /***********************************************************/  00035000
*                                                                  0064 00036000
*                                                                  0064 00037000
*CHECBUFS:/* TEST FOR A VALID BUFFER CONTROL BLOCK ADDRESS. IF LOW   */ 00038000
*         /* ORDER BIT OF DCBBUFCB IS ZERO THEN ADDRESS IS VALID.    */ 00039000
*                                                                  0064 00040000
*         IF BUFADDR(32) = '0'B                                    0064 00041000
*            THEN DO;                       /* YES                   */ 00042000
CHECBUFS TM    BUFADDR+3(RDCB),B'00000001'                         0064 00043000
         BNZ   @RF00064                                            0064 00044000
*              IF BCBBLDR(1) = '0'B         /* WAS BIULDRCD ISSUED   */ 00045000
*                & DCBRECFM(1:2) = '01'B    /*  FOR A VARIABLE       */ 00046000
*                & DCBRECFM(5)   = '1'B     /*  SPANNED DCB?         */ 00047000
*                THEN DO;                   /* NOT ISSUED            */ 00048000
         L     @11,DCBBUFCB(,RDCB)                                 0066 00049000
         TM    BCBBLDR(@11),B'10000000'                            0066 00050000
         BNZ   @RF00066                                            0066 00051000
         TM    DCBRECFM(RDCB),B'01000000'                          0066 00052000
         BNO   @RF00066                                            0066 00053000
         TM    DCBRECFM(RDCB),B'10000000'                          0066 00054000
         BNZ   @RF00066                                            0066 00055000
         TM    DCBRECFM(RDCB),B'00001000'                          0066 00056000
         BNO   @RF00066                                            0066 00057000
*                  RSIZE = DCBLRECL;        /* LOGICAL RECORD LENGTH */ 00058000
         LH    RSIZE,DCBLRECL(,RDCB)                               0068 00059000
         N     RSIZE,@CF00434                                      0068 00060000
*                  GEN (GETMAIN R,LV=(RSIZE),SP=250);              0069 00061000
         GETMAIN R,LV=(RSIZE),SP=250                                    00062000
*                  BCBRECDA = R1;           /* INIT RECDAREA PTR     */ 00063000
         L     @11,DCBBUFCB(,RDCB)                                 0070 00064000
         ST    R1,BCBRECDA(,@11)                                   0070 00065000
*                     END;                  /* END OF NOT BUILDRCD   */ 00066000
*                                                                  0071 00067000
*              IF DCBRECFM(1:2) = '01'B /* THIS DATA SET FOR   XM6180*/ 00068000
*                & DCBRECFM(5)   = '1'B /* VS RECORDS ?        XM6180*/ 00069000
*                  THEN                 /* YES, SET UP TO USE  XM6180*/ 00070000
@RF00066 TM    DCBRECFM(RDCB),B'01000000'                          0072 00071000
         BNO   @RF00072                                            0072 00072000
         TM    DCBRECFM(RDCB),B'10000000'                          0072 00073000
         BNZ   @RF00072                                            0072 00074000
         TM    DCBRECFM(RDCB),B'00001000'                          0072 00075000
         BNO   @RF00072                                            0072 00076000
*                    DO;                /* THE RECORD AREA     XM6180*/ 00077000
*                      RPLAREA = BCBRECDA; /* PUT PTR IN RPL   XM6180*/ 00078000
         L     @11,DCBBUFCB(,RDCB)                                 0074 00079000
         L     @11,BCBRECDA(,@11)                                  0074 00080000
         ST    @11,RPLAREA(,RRPL)                                  0074 00081000
*                      CIRAREA = BCBRECDA; /* PUT PTR IN CICB  XM6180*/ 00082000
         ST    @11,CIRAREA(,RCICB)                                 0075 00083000
*                    END;               /* END OF VS SETUP     XM6180*/ 00084000
*                  ELSE                 /* NOT VS, SO USE THE  XM6180*/ 00085000
*                    RPLAREA = BCBFSBUF;/* 1ST BUFFER IN POOL  XM6180*/ 00086000
*                                                                  0077 00087000
         B     @RC00072                                            0077 00088000
@RF00072 L     @11,DCBBUFCB(,RDCB)                                 0077 00089000
         L     @11,BCBFSBUF(,@11)                                  0077 00090000
         ST    @11,RPLAREA(,RRPL)                                  0077 00091000
*              IF DCBBUFNO = 0          /* IF BUFFER COUNT NOT XM5700*/ 00092000
*                THEN                   /* REFLECTED  IN DCB   XM5700*/ 00093000
@RC00072 CLI   DCBBUFNO(RDCB),0                                    0078 00094000
         BNE   @RF00078                                            0078 00095000
*                  DO;                  /* MERGE IN VALUE FROM XM5700*/ 00096000
*                                                                  0079 00097000
*                    /* SUPERVISOR KEY REQ TO STORE IN DCB (DM KEY)     00098000
*                       AND REFERENCE BCB (UK)                 Y02082*/ 00099000
*                    GEN (MODESET EXTKEY=ZERO);                    0080 00100000
*                                                                  0080 00101000
         MODESET EXTKEY=ZERO                                            00102000
*                    DCBBUFNO = BCBBUFNO;   /* BUF POOL BLOCK  XM5700*/ 00103000
*                                                                  0081 00104000
         L     @11,DCBBUFCB(,RDCB)                                 0081 00105000
         LH    @11,BCBBUFNO(,@11)                                  0081 00106000
         STC   @11,DCBBUFNO(,RDCB)                                 0081 00107000
*                    /* REESTABLISH USER KEY FOR INITRPL ROUTINE     */ 00108000
*                    RDCBSAVE = RDCB;   /* SAVE PTR TO DCB     Y02082*/ 00109000
         LR    RDCBSAVE,RDCB                                       0082 00110000
*                    RUKEY = DXUKEY;    /* SAVE USER KY IN R2  Y02082*/ 00111000
         L     @11,WTGCWA-1(,RWTGC)                                0083 00112000
         SLR   RUKEY,RUKEY                                         0083 00113000
         IC    RUKEY,DXUKEY(,@11)                                  0083 00114000
*                    GEN (MODESET KEYADDR=(2));                    0084 00115000
         MODESET KEYADDR=(2)                                            00116000
*                    RDCB = RDCBSAVE;   /* RESTORE DCB PTR     Y02082*/ 00117000
*                                                                  0085 00118000
         LR    RDCB,RDCBSAVE                                       0085 00119000
*                  END;                 /*                     XM5700*/ 00120000
*              GO TO INITRPL;             /* INITIALIZE THE RPL    */   00121000
         B     INITRPL                                             0087 00122000
*               END;                      /* END OF VALIDBCB GROUP */   00123000
*                                                                  0088 00124000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00125000
@RF00064 DS    0H                                                  0089 00126000
         EJECT                                                          00127000
*         /* SET BUFFER LENGTH USING VALUE FROM DCB            XA3128*/ 00128000
*         RBUFL = DCBBUFL;                  /* BUFL            XA3128*/ 00129000
*                                                                  0090 00130000
         LH    RBUFL,DCBBUFL(,RDCB)                                0090 00131000
         N     RBUFL,@CF00434                                      0090 00132000
*         IF RBUFL = 0 THEN                 /* IF DCBBUFL IS @ZA12902*/ 00133000
         LTR   RBUFL,RBUFL                                         0091 00134000
         BNZ   @RF00091                                            0091 00135000
*            RBUFL = DCBBLKSI;              /* ZERO,USE BLKSI@ZA12902*/ 00136000
*                                                                  0092 00137000
         LH    RBUFL,DCBBLKSI(,RDCB)                               0092 00138000
         N     RBUFL,@CF00434                                      0092 00139000
*         /***********************************************************/ 00140000
*         /* IS THIS A BSAM DCB ?                                    */ 00141000
*         /***********************************************************/ 00142000
*                                                                  0093 00143000
*         IF DCBCIND2(8) = '0'B                                    0093 00144000
*            THEN                           /* YES                   */ 00145000
@RF00091 TM    DCBCIND2(RDCB),B'00000001'                          0093 00146000
         BNZ   @RF00093                                            0093 00147000
*              DO ;                                                0094 00148000
*                                                                  0094 00149000
*                /* HAS USER SUPPLIED BUFNO ?                        */ 00150000
*                IF DCBBUFNO = 0                                   0095 00151000
*                   THEN                    /* NO                    */ 00152000
*                                                                  0095 00153000
         CLI   DCBBUFNO(RDCB),0                                    0095 00154000
         BE    @RT00095                                            0095 00155000
*                     GO TO INITRPL;        /* NEXT ENTRY IN WTG     */ 00156000
*                                                                  0096 00157000
*                   ELSE                    /* USER SUPPLIED BUFNO   */ 00158000
*                     DO;                                          0097 00159000
*                                                                  0097 00160000
*                       RBUFNO = DCBBUFNO;  /* PICK UP BUFFER NUMBER */ 00161000
         SLR   RBUFNO,RBUFNO                                       0098 00162000
         IC    RBUFNO,DCBBUFNO(,RDCB)                              0098 00163000
*                       GO TO GETBUFRS;     /* GO GET BUFFERS        */ 00164000
*                                                                  0099 00165000
         B     GETBUFRS                                            0099 00166000
*                     END;                  /* END OF DO GROUP       */ 00167000
*              END;                                                0101 00168000
*                                                                  0101 00169000
*            ELSE                           /* NOT BSAM DCB          */ 00170000
*                                                                  0102 00171000
*            /********************************************************/ 00172000
*            /* ASSUME QSAM DCB                                      */ 00173000
*            /********************************************************/ 00174000
*                                                                  0102 00175000
*            /********************************************************/ 00176000
*            /* SET BUFFER LENGTH                                    */ 00177000
*            /********************************************************/ 00178000
*                                                                  0102 00179000
*            /* LOCATE MODE SPECIFIED ?                              */ 00180000
*              IF DCBMACRF(5)   = '1'B | DCBMACRF(13)  = '1'B THEN/*    00181000
*                                              LOCATE MODE ?   YM5890*/ 00182000
@RF00093 TM    DCBMACRF(RDCB),B'00001000'                          0102 00183000
         BO    @RT00102                                            0102 00184000
         TM    DCBMACRF+1(RDCB),B'00001000'                        0102 00185000
         BNO   @RF00102                                            0102 00186000
@RT00102 DS    0H                                                  0103 00187000
*                 IF DCBRECFM(1:2) = '01'B  /* VARIABLE        YM5890*/ 00188000
*                   & DCBRECFM(5)='1'B THEN /* SPANNED RECS    YM5890*/ 00189000
         TM    DCBRECFM(RDCB),B'01000000'                          0103 00190000
         BNO   @RF00103                                            0103 00191000
         TM    DCBRECFM(RDCB),B'10000000'                          0103 00192000
         BNZ   @RF00103                                            0103 00193000
         TM    DCBRECFM(RDCB),B'00001000'                          0103 00194000
         BNO   @RF00103                                            0103 00195000
*                   RBUFL=DCBLRECL;         /* YES, USE LRECL  YM5890*/ 00196000
         LH    RBUFL,DCBLRECL(,RDCB)                               0104 00197000
         N     RBUFL,@CF00434                                      0104 00198000
*                 ELSE;                     /* NOT VS          YM5890*/ 00199000
@RF00103 DS    0H                                                  0106 00200000
*              ELSE;                        /* NOT LOCATE      YM5890*/ 00201000
*                                                                  0106 00202000
@RF00102 DS    0H                                                  0107 00203000
*              /* GET BUFNO FROM DCBBUFNO                      XA3128*/ 00204000
*              RBUFNO = DCBBUFNO;           /* NO. OF BUFFERS  XA3128*/ 00205000
*                                                                  0107 00206000
         SLR   RBUFNO,RBUFNO                                       0107 00207000
         IC    RBUFNO,DCBBUFNO(,RDCB)                              0107 00208000
*GETBUFRS:/***********************************************************/ 00209000
*         /* ACQUIRE BUFFERS                                         */ 00210000
*         /***********************************************************/ 00211000
*                                                                  0108 00212000
*         /* BUFFER LENGTH MUST BE MULTIPLE OF 8 FOR MULTIPLE BUFFERS*/ 00213000
*         IF RBUFNO > 1                     /* MULTIPLE BUFFERS ?    */ 00214000
*           THEN                            /* YES                   */ 00215000
GETBUFRS LA    @11,1                                               0108 00216000
         CR    RBUFNO,@11                                          0108 00217000
         BNH   @RF00108                                            0108 00218000
*             DO;                                                  0109 00219000
*                                                                  0109 00220000
*               CIWK1 = RBUFL//8;           /* STORE IN WORK AREA    */ 00221000
*                                                                  0110 00222000
         LR    @14,RBUFL                                           0110 00223000
         SRDA  @14,32                                              0110 00224000
         D     @14,@CF00056                                        0110 00225000
         ST    @14,CIWK1(,RCICB)                                   0110 00226000
*               IF CIWK1 ¬= 0               /* IS IT MULTIPLE OF 8 ? */ 00227000
*                 THEN                      /* BUFL NOT MULTIPLE OF 8*/ 00228000
*                                                                  0111 00229000
         LTR   @14,@14                                             0111 00230000
         BZ    @RF00111                                            0111 00231000
*                   /* ROUND UP TO NEAREST MULTIPLE OF 8             */ 00232000
*                   RBUFL = (RBUFL/8 + 1) * 8;                     0112 00233000
         LR    @14,RBUFL                                           0112 00234000
         SRDA  @14,32                                              0112 00235000
         D     @14,@CF00056                                        0112 00236000
         ALR   @15,@11                                             0112 00237000
         SLA   @15,3                                               0112 00238000
         LR    RBUFL,@15                                           0112 00239000
*                 ELSE;                     /* BUFL IS MULTIPLE OF 8 */ 00240000
@RF00111 DS    0H                                                  0114 00241000
*             END;                                                 0114 00242000
*                                                                  0114 00243000
*         /* CALCULATE CORE REQUIREMENT FOR BUFFERS                  */ 00244000
*         RSIZE = (RBUFNO * RBUFL) + 8;                            0115 00245000
*                                                                  0115 00246000
@RF00108 LA    @11,8                                               0115 00247000
         LR    @15,RBUFL                                           0115 00248000
         MR    @14,RBUFNO                                          0115 00249000
         ALR   @15,@11                                             0115 00250000
         LR    RSIZE,@15                                           0115 00251000
*         /* IS FULLWORD ALIGNMENT SPECIFIED ?                       */ 00252000
*         IF DCBBFALN (8) = '1'B                                   0116 00253000
*            THEN                           /* YES                   */ 00254000
*                                                                  0116 00255000
         TM    DCBBFALN(RDCB),B'00000001'                          0116 00256000
         BNO   @RF00116                                            0116 00257000
*              /* ADD EIGHT BYTES FOR ALIGNMENT                      */ 00258000
*              RSIZE = RSIZE + 8;                                  0117 00259000
*                                                                  0117 00260000
         ALR   RSIZE,@11                                           0117 00261000
*GETCORE: /***********************************************************/ 00262000
*         /* GET CORE FOR BUFFERS, INCLUDING BUFCB, IN SUBPOOL 0.    */ 00263000
*         /* NOTE: IF USER KEY IS 0, THIS WILL RESULT IN SUBPOOL 252.*/ 00264000
*         /***********************************************************/ 00265000
*                                                                  0118 00266000
*         IF DCBRECFM(1:2) = '01'B & DCBRECFM(5) = '1'B /*   @ZA19137*/ 00267000
*         & DCBMACRF(13) = '1'B THEN    /* IF IN LOCATE MODE @ZA19137*/ 00268000
@RF00116 DS    0H                                                  0118 00269000
GETCORE  TM    DCBRECFM(RDCB),B'01000000'                          0118 00270000
         BNO   @RF00118                                            0118 00271000
         TM    DCBRECFM(RDCB),B'10000000'                          0118 00272000
         BNZ   @RF00118                                            0118 00273000
         TM    DCBRECFM(RDCB),B'00001000'                          0118 00274000
         BNO   @RF00118                                            0118 00275000
         TM    DCBMACRF+1(RDCB),B'00001000'                        0118 00276000
         BNO   @RF00118                                            0118 00277000
*              RSIZE = RSIZE + 8;  /* ADD 8 BYTES TO BCB FOR @ZA19137*/ 00278000
         AL    RSIZE,@CF00056                                      0119 00279000
*                                  /* SPANNED RECORDS        @ZA19137*/ 00280000
*                                                                  0120 00281000
*         GEN (GETMAIN R,LV=(RSIZE),SP=0);/* GET BUFFER CORE   YM4641*/ 00282000
*                                                                  0120 00283000
*                                                                  0120 00284000
@RF00118 DS    0H                                                  0120 00285000
         GETMAIN R,LV=(RSIZE),SP=0                                      00286000
*         IF CIFRAGM = '1'B                 /* SPANREC FLAG SET ?    */ 00287000
*           THEN DO;                        /* YES                   */ 00288000
         TM    CIFRAGM(RCICB),B'00100000'                          0121 00289000
         BNO   @RF00121                                            0121 00290000
*             CIRAREA = R1;                 /* FOR SPANNED RECORDS   */ 00291000
         ST    R1,CIRAREA(,RCICB)                                  0123 00292000
*             GO TO ZROCHAIN;               /* PREPARE FOR XCTL      */ 00293000
         B     ZROCHAIN                                            0124 00294000
*                END;                       /* END OF SPANREC DO GRP */ 00295000
*           ELSE;                           /* SPANREC FLAG NOT SET  */ 00296000
*                                                                  0126 00297000
@RF00121 DS    0H                                                  0127 00298000
*         /*  DATA MANAGEMENT KEY REQUIRED TO REFERENCE DCB FIELD    */ 00299000
*         GEN (MODESET EXTKEY=DATAMGT); /*                     Y02082*/ 00300000
*                                                                  0127 00301000
         MODESET EXTKEY=DATAMGT                                         00302000
*         DCBBUFCB = R1;                    /* SET BUFCB ADDR IN DCB */ 00303000
         ST    R1,DCBBUFCB(,RDCB)                                  0128 00304000
*         DCBCIND2(5) = '1'B;               /* DENOTE OPEN     XM6068*/ 00305000
         OI    DCBCIND2(RDCB),B'00001000'                          0129 00306000
*                                           /* GOT BFR POOL    XM6068*/ 00307000
*         DCBBUFNO = RBUFNO;                /* SET BUFNO IN DCB      */ 00308000
*                                                                  0130 00309000
         STC   RBUFNO,DCBBUFNO(,RDCB)                              0130 00310000
*         /*          REESTABLISH USER KEY                          */  00311000
*         RDCBSAVE = RDCB;              /* SAVE PTR TO DCB    Y02082*/  00312000
         LR    RDCBSAVE,RDCB                                       0131 00313000
*         RUKEY = DXUKEY;               /* SAVE USER KY IN R2 Y02082*/  00314000
         L     @11,WTGCWA-1(,RWTGC)                                0132 00315000
         SLR   RUKEY,RUKEY                                         0132 00316000
         IC    RUKEY,DXUKEY(,@11)                                  0132 00317000
*         GEN (MODESET KEYADDR=(2));    /*                    Y02082*/  00318000
         MODESET KEYADDR=(2)                                            00319000
*         RDCB = RDCBSAVE;              /* RESTORE DCB PTR    Y02082*/  00320000
         LR    RDCB,RDCBSAVE                                       0134 00321000
*         BCBBUFL = RBUFL;                  /* SET BUFL IN BCB       */ 00322000
         L     @11,DCBBUFCB(,RDCB)                                 0135 00323000
         STH   RBUFL,BCBBUFL(,@11)                                 0135 00324000
*         BCBBUFNO = RBUFNO;                /* SET BUFNO IN BCB      */ 00325000
         STH   RBUFNO,BCBBUFNO(,@11)                               0136 00326000
*         IF DCBRECFM(1:2) = '01'B & DCBRECFM(5) = '1'B /*   @ZA19137*/ 00327000
*         & DCBMACRF(13) = '1'B THEN /* IF VARIABLE SPANNED  @ZA19137*/ 00328000
         TM    DCBRECFM(RDCB),B'01000000'                          0137 00329000
         BNO   @RF00137                                            0137 00330000
         TM    DCBRECFM(RDCB),B'10000000'                          0137 00331000
         BNZ   @RF00137                                            0137 00332000
         TM    DCBRECFM(RDCB),B'00001000'                          0137 00333000
         BNO   @RF00137                                            0137 00334000
         TM    DCBMACRF+1(RDCB),B'00001000'                        0137 00335000
         BNO   @RF00137                                            0137 00336000
*         BCBBLDR(2) = '1'B;            /* TURN ON LRI FLG   @ZA19137*/ 00337000
         OI    BCBBLDR(@11),B'01000000'                            0138 00338000
*         GEN   (EJECT);                    /* SKIP TO A NEW PAGE    */ 00339000
@RF00137 DS    0H                                                  0139 00340000
         EJECT                                                          00341000
*                                                                  0140 00342000
*                                                                  0140 00343000
*         /***********************************************************/ 00344000
*         /*                                                         */ 00345000
*         /* STRUCTURE THE BUFFER CONTROL BLOCKS AND LINK BUFFERS    */ 00346000
*         /*                                                         */ 00347000
*         /***********************************************************/ 00348000
*                                                                  0140 00349000
*         /* SET POINTER PAST BUFFER CONTROL BLOCK                   */ 00350000
*         R1 = R1 + 8;                                             0140 00351000
*                                                                  0140 00352000
         LA    R1,8(,R1)                                           0140 00353000
*         /* IS FULL WORD ALIGNMENT SPECIFIED ?                      */ 00354000
*                                                                  0141 00355000
*         IF DCBBFALN (8) = '1'B                                   0141 00356000
*            THEN                           /* YES                   */ 00357000
*                                                                  0141 00358000
         TM    DCBBFALN(RDCB),B'00000001'                          0141 00359000
         BNO   @RF00141                                            0141 00360000
*              /* ADJUST POINTER TO FULL WORD                        */ 00361000
*              R1 = R1 + 4;                                        0142 00362000
*                                                                  0142 00363000
         LA    R1,4(,R1)                                           0142 00364000
*            ELSE;                          /* NO                    */ 00365000
*                                                                  0143 00366000
@RF00141 DS    0H                                                  0144 00367000
*         /* POINT TO FIRST BUFFER                                   */ 00368000
*         BCBFSBUF = R1;                                           0144 00369000
*                                                                  0144 00370000
         L     @11,DCBBUFCB(,RDCB)                                 0144 00371000
         ST    R1,BCBFSBUF(,@11)                                   0144 00372000
*         /* LINK ALL BUFFERS                                        */ 00373000
*         DO RBUFNO = RBUFNO TO 1 BY -1;                           0145 00374000
*                                                                  0145 00375000
         B     @DE00145                                            0145 00376000
@DL00145 DS    0H                                                  0146 00377000
*            /* IS THIS THE LAST BUFFER IN THE CHAIN ?               */ 00378000
*                                                                  0146 00379000
*            IF RBUFNO = 1                                         0146 00380000
*               THEN                                               0146 00381000
*                                                                  0146 00382000
         C     RBUFNO,@CF00082                                     0146 00383000
         BNE   @RF00146                                            0146 00384000
*                 /* ZERO LAST BUFFER LINK                           */ 00385000
*                 BUFLINK = 0;                                     0147 00386000
*                                                                  0147 00387000
         SLR   @11,@11                                             0147 00388000
         ST    @11,BUFLINK(,R1)                                    0147 00389000
*               ELSE                        /* NOT LAST BUFFER       */ 00390000
*                 BUFLINK = R1 + RBUFL;     /* ADDR OF NEXT BUFFER 0148 00391000
*                                              IN LINK FIELD         */ 00392000
         B     @RC00146                                            0148 00393000
@RF00146 LR    @11,R1                                              0148 00394000
         ALR   @11,RBUFL                                           0148 00395000
         ST    @11,BUFLINK(,R1)                                    0148 00396000
*            R1 = R1 + RBUFL;               /* POINT TO NEXT BUFFER  */ 00397000
*                                                                  0149 00398000
@RC00146 ALR   R1,RBUFL                                            0149 00399000
*         END;                              /* THIS LOOP IS EXECUTED    00400000
*                                              UNTIL COUNT OF BUFFERS   00401000
*                                              IS ZERO               */ 00402000
*                                                                  0150 00403000
         BCTR  RBUFNO,0                                            0150 00404000
@DE00145 LTR   RBUFNO,RBUFNO                                       0150 00405000
         BP    @DL00145                                            0150 00406000
*         /* PLACE POINTER TO BUFFER IN RPL                          */ 00407000
*         RPLAREA = BCBFSBUF;                                      0151 00408000
         L     @11,DCBBUFCB(,RDCB)                                 0151 00409000
         L     @11,BCBFSBUF(,@11)                                  0151 00410000
         ST    @11,RPLAREA(,RRPL)                                  0151 00411000
*         CIRAREA = BCBFSBUF;               /* FOR SPANNED RECORDS   */ 00412000
         ST    @11,CIRAREA(,RCICB)                                 0152 00413000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00414000
         EJECT                                                          00415000
*                                                                  0154 00416000
*         /***********************************************************/ 00417000
*         /*                                                         */ 00418000
*         /* INITIALIZE THE RPL                                      */ 00419000
*         /*                                                         */ 00420000
*         /***********************************************************/ 00421000
*                                                                  0154 00422000
*INITRPL:      ;                                                   0154 00423000
INITRPL  DS    0H                                                  0155 00424000
*         IF DCBCIND2(8) = '1'B THEN    /* TEST FOR QSAM       Y02123*/ 00425000
         TM    DCBCIND2(RDCB),B'00000001'                          0155 00426000
         BNO   @RF00155                                            0155 00427000
*           DO;                         /*                     Y02123*/ 00428000
*             /* SUPERVISOR KEY REQUIRED TO REFERENCE RPL (UK)     0157 00429000
*                AND STORE IN DCB FIELDS (DMK)                       */ 00430000
*             GEN (MODESET EXTKEY=ZERO);/* KEY ZERO            Y02123*/ 00431000
*                                                                  0157 00432000
         MODESET EXTKEY=ZERO                                            00433000
*             IF DCBMACRF(2)   = '1'B THEN/*                       0158 00434000
*                                          QSAM=GET            Y02123*/ 00435000
         TM    DCBMACRF(RDCB),B'01000000'                          0158 00436000
         BNO   @RF00158                                            0158 00437000
*               DO;                     /* SETUP DCB FOR PGET  Y02123*/ 00438000
*                 DCBRECAD = RPLAREA;   /* START OF BUF        Y02123*/ 00439000
         L     @11,RPLAREA(,RRPL)                                  0160 00440000
         ST    @11,DCBRECAD(,RDCB)                                 0160 00441000
*                 DCBEOBAD = DCBRECAD + DCBLRECL; /* ENDOFBUF  Y02123*/ 00442000
         LH    @15,DCBLRECL(,RDCB)                                 0161 00443000
         N     @15,@CF00434                                        0161 00444000
         ALR   @11,@15                                             0161 00445000
         ST    @11,DCBEOBAD(,RDCB)                                 0161 00446000
*               END;                    /*                     Y02123*/ 00447000
*             ELSE                      /* NOT GET ASSUME PUT  Y02123*/ 00448000
*               DO;                     /* SET DCB FOR COBOL   Y02123*/ 00449000
         B     @RC00158                                            0163 00450000
@RF00158 DS    0H                                                  0164 00451000
*                 DCBRECAD = RPLAREA + DCBLRECL; /* ENDOFBUF   Y02123*/ 00452000
         LH    @11,DCBLRECL(,RDCB)                                 0164 00453000
         N     @11,@CF00434                                        0164 00454000
         AL    @11,RPLAREA(,RRPL)                                  0164 00455000
         ST    @11,DCBRECAD(,RDCB)                                 0164 00456000
*                 DCBEOBAD = DCBRECAD;  /* SIMULATE EOB        Y02123*/ 00457000
         ST    @11,DCBEOBAD(,RDCB)                                 0165 00458000
*               END;                    /*                     Y02123*/ 00459000
*                                                                  0166 00460000
*             /*  REESTABLISH USER KEY FOR INITRPL ROUTINE           */ 00461000
*             RDCBSAVE = RDCB;          /* SAVE PTR TO DCB     Y02123*/ 00462000
@RC00158 LR    RDCBSAVE,RDCB                                       0167 00463000
*             RUKEY = DXUKEY;           /* SAVE USER KY IN R2  Y02123*/ 00464000
         L     @11,WTGCWA-1(,RWTGC)                                0168 00465000
         SLR   RUKEY,RUKEY                                         0168 00466000
         IC    RUKEY,DXUKEY(,@11)                                  0168 00467000
*             GEN (MODESET KEYADDR=(2));  /*                   Y02123*/ 00468000
         MODESET KEYADDR=(2)                                            00469000
*             RDCB = RDCBSAVE;          /* RESTORE DCB PTR     Y02123*/ 00470000
*                                                                  0170 00471000
         LR    RDCB,RDCBSAVE                                       0170 00472000
*             IF DCBMACRF(5)   = '1'B | DCBMACRF(13)  = '1'B THEN/*     00473000
*                                          LOCATE MODE         YM5890*/ 00474000
         TM    DCBMACRF(RDCB),B'00001000'                          0171 00475000
         BO    @RT00171                                            0171 00476000
         TM    DCBMACRF+1(RDCB),B'00001000'                        0171 00477000
         BNO   @RF00171                                            0171 00478000
@RT00171 DS    0H                                                  0172 00479000
*                IF DCBRECFM(1:2) = '01'B/*                        0172 00480000
*                                          VARIABLE LENGTH     YM5890*/ 00481000
*                  & DCBRECFM(5)   = '1'B THEN;/*                  0172 00482000
*                                          SPANNED RECORDS     YM5890*/ 00483000
         TM    DCBRECFM(RDCB),B'01000000'                          0172 00484000
         BNO   @RF00172                                            0172 00485000
         TM    DCBRECFM(RDCB),B'10000000'                          0172 00486000
         BNZ   @RF00172                                            0172 00487000
         TM    DCBRECFM(RDCB),B'00001000'                          0172 00488000
         BO    @RT00172                                            0172 00489000
*                ELSE DO;               /* NOT VS              YM5890*/ 00490000
@RF00172 DS    0H                                                  0175 00491000
*                      R1 = BCBFSBUF;   /* BASE FOR BUFLINK    YM5890*/ 00492000
         L     @11,DCBBUFCB(,RDCB)                                 0175 00493000
         L     R1,BCBFSBUF(,@11)                                   0175 00494000
*                     END;              /* END OF NOT VS LOOP  YM5890*/ 00495000
*             ELSE;                     /* NOT LOCATE          YM5890*/ 00496000
@RF00171 DS    0H                                                  0178 00497000
*           END;                        /*                     Y02123*/ 00498000
*         ELSE;                         /* NOT QSAM            Y02123*/ 00499000
*                                                                  0179 00500000
@RF00155 DS    0H                                                  0180 00501000
*         IF DCBRECFM(1:2) = '10'B      /* RECFM=FIXED         YM7855*/ 00502000
*            & DCBMACRF(10:11) ¬= '00'B THEN/*                     0180 00503000
*                                          OPENED FOR OUTPUT   YM7855*/ 00504000
@RC00155 TM    DCBRECFM(RDCB),B'10000000'                          0180 00505000
         BNO   @RF00180                                            0180 00506000
         TM    DCBRECFM(RDCB),B'01000000'                          0180 00507000
         BNZ   @RF00180                                            0180 00508000
         TM    DCBMACRF+1(RDCB),B'01100000'                        0180 00509000
         BZ    @RF00180                                            0180 00510000
*            RPLOPT3(3) = '1'B ;        /* YES,INDICATE IN RPL YM7855*/ 00511000
         OI    RPLOPT3(RRPL),B'00100000'                           0181 00512000
*         ELSE;                         /* NO                  YM7855*/ 00513000
@RF00180 DS    0H                                                  0183 00514000
*         RPLID = '00'X;                    /* SET RPL ID            */ 00515000
         MVI   RPLID(RRPL),X'00'                                   0183 00516000
*         RPLSTYP = '00'X;                  /* SET RPL SUBTYPE       */ 00517000
         MVI   RPLSTYP(RRPL),X'00'                                 0184 00518000
*         RPLLEN = LENGTH(IFGRPL);          /* SET LENGTH OF RPL     */ 00519000
*                                                                  0185 00520000
         MVI   RPLLEN(RRPL),X'4C'                                  0185 00521000
*         RPLERMSA = ADDR(CIFDBCK);         /* ADDR OF ERROR MESSAGE */ 00522000
         LA    @11,CIFDBCK(,RCICB)                                 0186 00523000
         ST    @11,RPLERMSA(,RRPL)                                 0186 00524000
*         RPLDACB  = ADDR (CIACBD);         /* ADDR OF DATA ACB      */ 00525000
*                                                                  0187 00526000
         LA    @11,CIACBD(,RCICB)                                  0187 00527000
         ST    @11,RPLDACB(,RRPL)                                  0187 00528000
*         /* INDICATE SYNCHRONOUS REQUEST                            */ 00529000
*         RPLOPTCD(5) = '0'B;                                      0188 00530000
*                                                                  0188 00531000
*         /* INDICATE SEQUENTIAL PROCESSING                          */ 00532000
*         RPLOPTCD(4) = '0'B;                                      0189 00533000
*                                                                  0189 00534000
*         /* INDICATE PHYSICAL PROCESSING                            */ 00535000
*         RPLOPTCD(3) = '1'B;                                      0190 00536000
         OI    RPLOPTCD(RRPL),B'00100000'                          0190 00537000
         NI    RPLOPTCD(RRPL),B'11100111'                          0190 00538000
*                                                                  0191 00539000
*         /***********************************************************/ 00540000
*         /* SET BUFFER LENGTH IN RPL                                */ 00541000
*         /***********************************************************/ 00542000
*                                                                  0191 00543000
*         IF DCBRECFM(1:2) = '01'B          /* V,VB RECORDS ?        */ 00544000
*           THEN                            /* YES                    * 00545000
         TM    DCBRECFM(RDCB),B'01000000'                          0191 00546000
         BNO   @RF00191                                            0191 00547000
         TM    DCBRECFM(RDCB),B'10000000'                          0191 00548000
         BNZ   @RF00191                                            0191 00549000
*             RPLBUFL = DCBBLKSI - 8;       /* SET BUFFER LENGTH      * 00550000
         LH    @11,DCBBLKSI(,RDCB)                                 0192 00551000
         N     @11,@CF00434                                        0192 00552000
         SL    @11,@CF00056                                        0192 00553000
         ST    @11,RPLBUFL(,RRPL)                                  0192 00554000
*           ELSE                            /* NOT V,VB RECORDS       * 00555000
*                                                                  0193 00556000
*         IF DCBRECFM(1:2) = '10'B          /* F OR FB RECORDS?      */ 00557000
*           THEN DO;                        /* YES                   */ 00558000
         B     @RC00191                                            0193 00559000
@RF00191 TM    DCBRECFM(RDCB),B'10000000'                          0193 00560000
         BNO   @RF00193                                            0193 00561000
         TM    DCBRECFM(RDCB),B'01000000'                          0193 00562000
         BNZ   @RF00193                                            0193 00563000
*             RPLBUFL = DCBLRECL;           /* SET BUFFER LENGTH     */ 00564000
         LH    @11,DCBLRECL(,RDCB)                                 0195 00565000
         N     @11,@CF00434                                        0195 00566000
         ST    @11,RPLBUFL(,RRPL)                                  0195 00567000
*             RPLRLEN = RPLBUFL;            /* AND RECORD LENGTH     */ 00568000
         ST    @11,RPLRLEN(,RRPL)                                  0196 00569000
*                END;                                              0197 00570000
*                                                                  0197 00571000
*         ELSE                                                     0198 00572000
*           RPLBUFL = DCBBLKSI;             /* ALL OTHER CASES       */ 00573000
*                                                                  0198 00574000
*                                                                  0198 00575000
         B     @RC00193                                            0198 00576000
@RF00193 LH    @11,DCBBLKSI(,RDCB)                                 0198 00577000
         N     @11,@CF00434                                        0198 00578000
         ST    @11,RPLBUFL(,RRPL)                                  0198 00579000
*         CIRPLCIC = RCICB;                 /* ADDR OF CICB IN RPL 0199 00580000
*                                              EXTENSION             */ 00581000
@RC00193 DS    0H                                                  0199 00582000
@RC00191 ST    RCICB,CIRPLCIC(,RCICB)                              0199 00583000
*         /***********************************************************/ 00584000
*SPANRECD:/* TEST FOR BSAM VARIABLE LENGTH SPANNED RECORDS           */ 00585000
*         /***********************************************************/ 00586000
*                                                                  0200 00587000
*         IF DCBCIND2(8) = '0'B             /* BSAM SPECIFIED ?      */ 00588000
*           THEN                            /* YES                   */ 00589000
SPANRECD TM    DCBCIND2(RDCB),B'00000001'                          0200 00590000
         BNZ   @RF00200                                            0200 00591000
*             /* SPANNED RECORDS ?                                   */ 00592000
*             IF DCBRECFM(1:2) = '01'B & DCBRECFM(5) = '1'B        0201 00593000
*               THEN                        /* YES, VS FORMAT        */ 00594000
         TM    DCBRECFM(RDCB),B'01000000'                          0201 00595000
         BNO   @RF00201                                            0201 00596000
         TM    DCBRECFM(RDCB),B'10000000'                          0201 00597000
         BNZ   @RF00201                                            0201 00598000
         TM    DCBRECFM(RDCB),B'00001000'                          0201 00599000
         BNO   @RF00201                                            0201 00600000
*                 DO;                       /* SET UP A RECORD AREA  */ 00601000
*                   IF DCBLRECL = 0         /* LOGICAL REC LEN AVAIL?*/ 00602000
*                     THEN RSIZE = 120;     /* NO, USE STD PRINT LINE*/ 00603000
         LH    @11,DCBLRECL(,RDCB)                                 0203 00604000
         N     @11,@CF00434                                        0203 00605000
         LTR   @11,@11                                             0203 00606000
         BNZ   @RF00203                                            0203 00607000
         LA    RSIZE,120                                           0204 00608000
*                     ELSE RSIZE = DCBLRECL;/* YES, USE IT           */ 00609000
         B     @RC00203                                            0205 00610000
@RF00203 LH    RSIZE,DCBLRECL(,RDCB)                               0205 00611000
         N     RSIZE,@CF00434                                      0205 00612000
*                   CILWAREA = RSIZE;       /* SIZE OF RECORD AREA   */ 00613000
@RC00203 ST    RSIZE,CILWAREA(,RCICB)                              0206 00614000
*                   CIFRAGM = '1'B;         /* SET SPANREC FLAG      */ 00615000
         OI    CIFRAGM(RCICB),B'00100000'                          0207 00616000
*                   GO TO GETCORE;          /* GET CORE FOR RECD AREA*/ 00617000
         B     GETCORE                                             0208 00618000
*                 END;                      /* END OF SPANREC DO GRP */ 00619000
*               ELSE;                       /* NOT SPANNED RECORDS   */ 00620000
@RF00201 DS    0H                                                  0211 00621000
*           ELSE;                       /* NOT BSAM                 */  00622000
@RF00200 DS    0H                                                  0212 00623000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00624000
         EJECT                                                          00625000
*        /***********************************************************/  00626000
*        /*                                                         */  00627000
*        /* SET UP TO XCTL TO NEXT CI OPEN EXECUTOR                 */  00628000
*        /*                                                         */  00629000
*        /***********************************************************/  00630000
*                                                                  0213 00631000
*ZROCHAIN:                                                         0213 00632000
*                                                                  0213 00633000
*        /***********************************************************/  00634000
*        /*   DATA MANAGEMENT KEY REQUIRED FOR ZROCHAIN ROUTINE     */  00635000
*        /***********************************************************/  00636000
*        GEN (MODESET EXTKEY=DATAMGT);     /*                 Y02082*/  00637000
*                                                                  0213 00638000
ZROCHAIN MODESET EXTKEY=DATAMGT                                         00639000
*        XCTLREG = ADDR (IBMCLOSE);        /* ENTRY IN XCTL TABLE   */  00640000
*                                                                  0214 00641000
         LA    XCTLREG,IBMCLOSE                                    0214 00642000
*         /* MOVE ID OF NEXT LOAD INTO WTG TABLE                     */ 00643000
*         WTGCID = XCTLID;                                         0215 00644000
*                                                                  0215 00645000
         MVC   WTGCID(2,RWTGC),XCTLID(XCTLREG)                     0215 00646000
*         /* MOVE TTR OF NEXT LOAD INTO WTG TABLE                    */ 00647000
*         WTGCTTR = XCTLTTR;                                       0216 00648000
*                                                                  0216 00649000
         MVC   WTGCTTR(3,RWTGC),XCTLTTR(XCTLREG)                   0216 00650000
*         /* RESET BASE FOR CICB                                     */ 00651000
*         RCICB = DCBCICB;                                         0217 00652000
*                                                                  0217 00653000
         L     RCICB,DCBCICB(,RDCB)                                0217 00654000
*NEXTNTRY:/* EXAMINE THE REMAINING ENTRIES IN THE WTG TABLE AND OPEN */ 00655000
*         /* PARAMETER LIST TO DETERMINE IF THIS MODULE IS NEEDED.   */ 00656000
*                                                                  0218 00657000
*         RWTGC = RWTGC + 8;                /* NEXT ENTRY IN WTG TABL*/ 00658000
NEXTNTRY LA    RWTGC,8(,RWTGC)                                     0218 00659000
*         RPARC = RPARC + 4;                /* NEXT ENTRY IN PARM LST*/ 00660000
*                                                                  0219 00661000
         LA    RPARC,4(,RPARC)                                     0219 00662000
*         /* IS THIS MODULE NEEDED                                   */ 00663000
*                                                                  0220 00664000
*         IF WTGCID = '9W'                                         0220 00665000
*            THEN                           /* YES                   */ 00666000
         CLC   WTGCID(2,RWTGC),@CC00426                            0220 00667000
         BE    @RT00220                                            0220 00668000
*              GO TO PROCESS;               /* GO PROCESS THE DCB    */ 00669000
*                                                                  0221 00670000
*            ELSE                                                  0222 00671000
*              /* IS THIS THE END OF THE WTG TABLE                   */ 00672000
*                                                                  0222 00673000
*              IF WTGCID = '0S'                                    0222 00674000
*                 THEN                      /* YES                   */ 00675000
         CLC   WTGCID(2,RWTGC),@CC00427                            0222 00676000
         BE    @RT00222                                            0222 00677000
*                   GO TO TRANSFER;         /* GO TO TRANSFER CONTROL*/ 00678000
*                                                                  0223 00679000
*                 ELSE                      /* NO                    */ 00680000
*                   GO TO NEXTNTRY;   /* GO CHECK ENTRY ID           */ 00681000
*                                                                  0224 00682000
         B     NEXTNTRY                                            0224 00683000
*TRANSFER:/* RESET POINTERS IN THE WTG TABLE AND PARM LIST TO THE    */ 00684000
*         /* FIRST ENTRIES, AND PREPARE TO TRANSFER CONTROL TO THE   */ 00685000
*         /* NEXT LOAD.                                              */ 00686000
*                                                                  0225 00687000
*         /* FIRST ENTRY IN THE WTG TABLE                            */ 00688000
*         RWTGC = RWTG + 32;                                       0225 00689000
*                                                                  0225 00690000
TRANSFER LA    RWTGC,32(,RWTG)                                     0225 00691000
*         /* FIRST ENTRY IN PARM LIST                                */ 00692000
*         RPARC = RPAR;                                            0226 00693000
*                                                                  0226 00694000
         LR    RPARC,RPAR                                          0226 00695000
*CHECKID: /* CHECK THE ENTRIES IN THE WTG TABLE FOR A NON-ZERO ID    */ 00696000
*                                                                  0227 00697000
*         /* IS ID OF CURRENT ENTRY IN WTG TABLE ZERO ?              */ 00698000
*                                                                  0227 00699000
*         IF WTGCID(1) = '00'X                                     0227 00700000
*           THEN                           /* YES                   */  00701000
CHECKID  CLI   WTGCID(RWTGC),X'00'                                 0227 00702000
         BNE   @RF00227                                            0227 00703000
*             DO;                          /* STEP TO NEXT ENTRY    */  00704000
*               RWTGC = RWTGC + 8;         /* NEXT WTG-TBL ENTRY    */  00705000
         LA    RWTGC,8(,RWTGC)                                     0229 00706000
*               RPARC = RPARC + 4;         /* NEXT PARM-LIST ENTRY  */  00707000
         LA    RPARC,4(,RPARC)                                     0230 00708000
*               GO TO CHECKID;             /* GO CHECK NEXT ENTRY   */  00709000
         B     CHECKID                                             0231 00710000
*             END;                                                 0232 00711000
*                                                                  0232 00712000
*           ELSE                           /* ID IS NOT ZERO        */  00713000
*             DO;                                                  0233 00714000
@RF00227 DS    0H                                                  0234 00715000
*                WTGID = WTGCID;            /* MOVE ID TO BASIC SECTN*/ 00716000
         MVC   WTGID(2,RWTG),WTGCID(RWTGC)                         0234 00717000
*                WTGTTR = WTGCTTR;          /* MOVE TTR              */ 00718000
         MVC   WTGTTR(3,RWTG),WTGCTTR(RWTGC)                       0235 00719000
*             END;                                                 0236 00720000
*                                                                  0236 00721000
*        R15 = ADDR (DXCCW(1));             /* PARM LIST ADDR  Y02082*/ 00722000
         L     R15,WTGCWA-1(,RWTGC)                                0237 00723000
         LA    R15,0(,R15)                                         0237 00724000
         LA    R15,DXCCW(,R15)                                     0237 00725000
*        GEN (XCTL  EPLOC=(RWTG),SF=(E,(15)),DCB=0);/*TRANSFER Y02082*/ 00726000
         XCTL  EPLOC=(RWTG),SF=(E,(15)),DCB=0                           00727000
*                                           /* TO THE NEXT LOAD      */ 00728000
*                                                                  0239 00729000
*        END   IGG0199W                 /* END OF IGG0199W MODULE   */  00730000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 00731000
*/*%INCLUDE SYSLIB  (IFGSDCB )                                        * 00732000
*/*%INCLUDE SYSLIB  (IFGJCICB)                                        * 00733000
*/*%INCLUDE SYSLIB  (IFGRPL  )                                        * 00734000
*;                                                                 0239 00735000
@EL00001 DS    0H                                                  0239 00736000
@EF00001 DS    0H                                                  0239 00737000
@ER00001 BR    @14                                                 0239 00738000
@DATA    DS    0H                                                       00739000
@DATD    DSECT                                                          00740000
         DS    0F                                                       00741000
@ZTEMPS  DS    C                                                        00742000
@ZTEMPND EQU   *                                                        00743000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         00744000
@TEMPS   EQU   @ZTEMPS                                                  00745000
@L       EQU   @ZLEN                                                    00746000
IGG0199W CSECT                                                          00747000
         DS    0F                                                       00748000
@CF00082 DC    F'1'                                                     00749000
@CF00056 DC    F'8'                                                     00750000
@CF00434 DC    XL4'0000FFFF'                                            00751000
@DATD    DSECT                                                          00752000
         DS    0D                                                       00753000
IGG0199W CSECT                                                          00754000
         DS    0F                                                       00755000
@SIZDATD DC    AL1(0)                                                   00756000
         DC    AL3(@ENDDATD-@DATD)                                      00757000
@SIZ001  EQU   @SIZDATD                                                 00758000
         DS    0D                                                       00759000
@CC00426 DC    C'9W'                                                    00760000
@CC00427 DC    C'0S'                                                    00761000
@DATD    DSECT                                                          00762000
IGG0199W CSECT                                                          00763000
         ORG   IGG0199W+1116                SET ORIGIN FOR XCTL TABLE   00764000
XCTLTABL EQU   *                                                        00765000
IBMCLOSE DC    C'8L'                        ID OF NEXT LOAD             00766000
         DC    X'00000000'                  TTR OF NEXT LOAD            00767000
         DC    X'0000'                      END OF TABLE                00768000
         DC    XL4'0'                       PAD TO LEAVE 4 BYTES        00769000
         DC    C'019'                       SVC CODE                    00770000
         DC    X'7E'                        DISPLACEMENT TO TABLE       00771000
@DATD    DSECT                                                          00772000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00773000
@ENDDATD EQU   *                                                        00774000
@DATEND  EQU   *                                                        00775000
IGG0199W CSECT                                                          00776000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00777000
@01      EQU   01                                                       00778000
@02      EQU   02                                                       00779000
@03      EQU   03                                                       00780000
@04      EQU   04                                                       00781000
@05      EQU   05                                                       00782000
@06      EQU   06                                                       00783000
@07      EQU   07                                                       00784000
@08      EQU   08                                                       00785000
@09      EQU   09                                                       00786000
@10      EQU   10                                                       00787000
@11      EQU   11                                                       00788000
@12      EQU   12                                                       00789000
@13      EQU   13                                                       00790000
@14      EQU   14                                                       00791000
@15      EQU   15                                                       00792000
@0       EQU   00                                                       00793000
@1       EQU   01                                                       00794000
@2       EQU   02                                                       00795000
@3       EQU   03                                                       00796000
@4       EQU   04                                                       00797000
@5       EQU   05                                                       00798000
@6       EQU   06                                                       00799000
@7       EQU   07                                                       00800000
@8       EQU   08                                                       00801000
@9       EQU   09                                                       00802000
@A       EQU   10                                                       00803000
@B       EQU   11                                                       00804000
@C       EQU   12                                                       00805000
@D       EQU   13                                                       00806000
@E       EQU   14                                                       00807000
@F       EQU   15                                                       00808000
RDCBSAVE EQU   @00                                                      00809000
R1       EQU   @01                                                      00810000
RSIZE    EQU   @01                                                      00811000
RDCB     EQU   @02                                                      00812000
RUKEY    EQU   @02                                                      00813000
RBUFNO   EQU   @03                                                      00814000
RBUFL    EQU   @04                                                      00815000
RPAR     EQU   @05                                                      00816000
RWTG     EQU   @06                                                      00817000
RPARC    EQU   @07                                                      00818000
RWTGC    EQU   @08                                                      00819000
RCICB    EQU   @09                                                      00820000
XCTLREG  EQU   @09                                                      00821000
RRPL     EQU   @10                                                      00822000
R15      EQU   @15                                                      00823000
RACB     EQU   @04                                                      00824000
RDATD    EQU   @12                                                      00825000
RMOD     EQU   @04                                                      00826000
R0       EQU   @00                                                      00827000
R13      EQU   @13                                                      00828000
WTG      EQU   0                                                        00829000
WTGMDNAM EQU   WTG                                                      00830000
WTGID    EQU   WTGMDNAM+6                                               00831000
WTGTTR   EQU   WTG+14                                                   00832000
WTGC     EQU   0                                                        00833000
WTGCID   EQU   WTGC                                                     00834000
WTGCTTR  EQU   WTGC+2                                                   00835000
WTGCWA   EQU   WTGC+5                                                   00836000
IECDSECT EQU   0                                                        00837000
DXCCW    EQU   IECDSECT+368                                             00838000
DXUKEY   EQU   IECDSECT+526                                             00839000
PARCNTRY EQU   0                                                        00840000
PARCDCB  EQU   PARCNTRY                                                 00841000
XCTLNTRY EQU   0                                                        00842000
XCTLID   EQU   XCTLNTRY                                                 00843000
XCTLTTR  EQU   XCTLNTRY+2                                               00844000
IFGSDCB  EQU   0                                                        00845000
DCBBUFCB EQU   IFGSDCB+20                                               00846000
DCBBUFNO EQU   DCBBUFCB                                                 00847000
DCBBUFL  EQU   IFGSDCB+24                                               00848000
DCBIOBAD EQU   IFGSDCB+28                                               00849000
@NM00011 EQU   IFGSDCB+32                                               00850000
DCBHIARC EQU   @NM00011                                                 00851000
DCBBFTEK EQU   DCBHIARC                                                 00852000
DCBBFALN EQU   DCBBFTEK                                                 00853000
DCBRECFM EQU   IFGSDCB+36                                               00854000
DCBDDNAM EQU   IFGSDCB+40                                               00855000
DCBMACRF EQU   DCBDDNAM+2                                               00856000
DCBREAD  EQU   IFGSDCB+49                                               00857000
DCBWRITE EQU   DCBREAD                                                  00858000
DCBGET   EQU   DCBWRITE                                                 00859000
DCBPUT   EQU   DCBGET                                                   00860000
DCBCHECK EQU   IFGSDCB+53                                               00861000
DCBGERR  EQU   DCBCHECK                                                 00862000
DCBCIND2 EQU   IFGSDCB+61                                               00863000
DCBBLKSI EQU   IFGSDCB+62                                               00864000
DCBIOBA  EQU   IFGSDCB+68                                               00865000
DCBCICB  EQU   DCBIOBA                                                  00866000
DCBEOBAD EQU   IFGSDCB+72                                               00867000
DCBLCCW  EQU   DCBEOBAD                                                 00868000
DCBEOBR  EQU   DCBLCCW                                                  00869000
@NM00012 EQU   IFGSDCB+76                                               00870000
DCBEOBW  EQU   @NM00012                                                 00871000
DCBRECAD EQU   DCBEOBW                                                  00872000
DCBDIRCT EQU   IFGSDCB+80                                               00873000
DCBLRECL EQU   IFGSDCB+82                                               00874000
@NM00013 EQU   IFGSDCB+84                                               00875000
DCBCNTRL EQU   @NM00013+1                                               00876000
DCBNOTE  EQU   DCBCNTRL                                                 00877000
IFGJCICB EQU   0                                                        00878000
CIDUMIOB EQU   IFGJCICB                                                 00879000
CIACBD   EQU   IFGJCICB+32                                              00880000
CIREGSAV EQU   IFGJCICB+116                                             00881000
CIFLAGS  EQU   IFGJCICB+188                                             00882000
CIFLAG2  EQU   CIFLAGS+1                                                00883000
CIFLAG3  EQU   CIFLAGS+2                                                00884000
CIFRAGM  EQU   CIFLAG3                                                  00885000
CIRPL    EQU   IFGJCICB+192                                             00886000
CIRPLEXT EQU   IFGJCICB+268                                             00887000
CIFDBCK  EQU   IFGJCICB+284                                             00888000
CILWAREA EQU   IFGJCICB+304                                             00889000
CIIOCNT  EQU   IFGJCICB+308                                             00890000
CIRAREA  EQU   IFGJCICB+316                                             00891000
CIWK1    EQU   IFGJCICB+328                                             00892000
CISVCLST EQU   IFGJCICB+336                                             00893000
CISYNADA EQU   CISVCLST                                                 00894000
CIBLDL   EQU   CISVCLST+4                                               00895000
CIBSP    EQU   CISVCLST+8                                               00896000
CIFEOV   EQU   CISVCLST+12                                              00897000
CISTOW   EQU   CISVCLST+16                                              00898000
IFGRPL   EQU   0                                                        00899000
RPLCOMN  EQU   IFGRPL                                                   00900000
RPLIDWD  EQU   RPLCOMN                                                  00901000
RPLID    EQU   RPLIDWD                                                  00902000
RPLSTYP  EQU   RPLIDWD+1                                                00903000
RPLLEN   EQU   RPLIDWD+3                                                00904000
RPLECB   EQU   RPLCOMN+8                                                00905000
RPLFDBWD EQU   RPLCOMN+12                                               00906000
RPLFDBK  EQU   RPLFDBWD+1                                               00907000
RPLRTNCD EQU   RPLFDBK                                                  00908000
RPLCNDCD EQU   RPLFDBK+1                                                00909000
RPLCMPON EQU   RPLCNDCD                                                 00910000
RPLFDB2  EQU   RPLCMPON                                                 00911000
RPLERRCD EQU   RPLCNDCD+1                                               00912000
RPLFDB3  EQU   RPLERRCD                                                 00913000
RPLKEYLE EQU   RPLCOMN+16                                               00914000
RPLDACB  EQU   RPLCOMN+24                                               00915000
RPLAREA  EQU   RPLCOMN+32                                               00916000
RPLARG   EQU   RPLCOMN+36                                               00917000
RPLOPTCD EQU   RPLCOMN+40                                               00918000
RPLOPT1  EQU   RPLOPTCD                                                 00919000
RPLECBSW EQU   RPLOPT1                                                  00920000
RPLOPT2  EQU   RPLOPTCD+1                                               00921000
RPLADR   EQU   RPLOPT2                                                  00922000
RPLOPT3  EQU   RPLOPTCD+2                                               00923000
RPLNXTRP EQU   RPLCOMN+44                                               00924000
RPLRLEN  EQU   RPLCOMN+48                                               00925000
RPLBUFL  EQU   RPLCOMN+52                                               00926000
RPLOPTC2 EQU   RPLCOMN+56                                               00927000
RPLOPT5  EQU   RPLOPTC2                                                 00928000
RPLWRTYP EQU   RPLOPT5                                                  00929000
RPLOPT6  EQU   RPLOPTC2+1                                               00930000
RPLUNTYP EQU   RPLOPT6                                                  00931000
RPLOPT7  EQU   RPLOPTC2+2                                               00932000
RPLCNOPT EQU   RPLOPT7                                                  00933000
RPLOPT8  EQU   RPLOPTC2+3                                               00934000
RPLRBAR  EQU   RPLCOMN+60                                               00935000
RPLAIXID EQU   RPLRBAR+2                                                00936000
RPLEXTDS EQU   RPLCOMN+68                                               00937000
RPLEXTD1 EQU   RPLEXTDS                                                 00938000
RPLERMSA EQU   RPLCOMN+72                                               00939000
BCB      EQU   0                                                        00940000
BCBFSBUF EQU   BCB                                                      00941000
BCBBUFNO EQU   BCB+4                                                    00942000
BCBBLDR  EQU   BCBBUFNO                                                 00943000
BCBBUFL  EQU   BCB+6                                                    00944000
BCBRECDA EQU   BCB+8                                                    00945000
BUFLINK  EQU   0                                                        00946000
BUFADDR  EQU   DCBBUFCB                                                 00947000
CIRPLCIC EQU   CIRPLEXT                                                 00948000
*                                      START UNREFERENCED COMPONENTS    00949000
RPLEMLEN EQU   RPLCOMN+70                                               00950000
RPLACTIV EQU   RPLCOMN+69                                               00951000
RPLBRANC EQU   RPLEXTD1                                                 00952000
RPLNIB   EQU   RPLEXTD1                                                 00953000
@NM00023 EQU   RPLEXTD1                                                 00954000
RPLEXIT  EQU   RPLEXTD1                                                 00955000
RPLNEXIT EQU   RPLEXTD1                                                 00956000
RPLEXSCH EQU   RPLEXTD1                                                 00957000
RPLDDDD  EQU   RPLRBAR+4                                                00958000
@NM00022 EQU   RPLRBAR+3                                                00959000
@NM00021 EQU   RPLAIXID                                                 00960000
RPLAXPKP EQU   RPLAIXID                                                 00961000
RPLAIXPC EQU   RPLRBAR                                                  00962000
RPLRSV88 EQU   RPLOPT8                                                  00963000
RPLUNCON EQU   RPLOPT8                                                  00964000
RPLACTV  EQU   RPLOPT8                                                  00965000
RPLSESS  EQU   RPLOPT8                                                  00966000
RPLPEND  EQU   RPLOPT8                                                  00967000
RPLODPRM EQU   RPLOPT8                                                  00968000
RPLODACP EQU   RPLOPT8                                                  00969000
RPLODACQ EQU   RPLOPT8                                                  00970000
RPLRSV78 EQU   RPLOPT7                                                  00971000
RPLRSV77 EQU   RPLOPT7                                                  00972000
RPLRLSOP EQU   RPLOPT7                                                  00973000
RPLTPOST EQU   RPLOPT7                                                  00974000
RPLQOPT  EQU   RPLOPT7                                                  00975000
RPLCNIMM EQU   RPLCNOPT                                                 00976000
RPLCNANY EQU   RPLCNOPT                                                 00977000
RPLCNALL EQU   RPLCNOPT                                                 00978000
RPLRSV68 EQU   RPLOPT6                                                  00979000
RPLRSV67 EQU   RPLOPT6                                                  00980000
RPLLOCK  EQU   RPLOPT6                                                  00981000
RPLNCOND EQU   RPLOPT6                                                  00982000
RPLCOND  EQU   RPLOPT6                                                  00983000
RPLEOT   EQU   RPLUNTYP                                                 00984000
RPLEOM   EQU   RPLUNTYP                                                 00985000
RPLEOB   EQU   RPLUNTYP                                                 00986000
RPLWROPT EQU   RPLOPT5                                                  00987000
RPLNODE  EQU   RPLOPT5                                                  00988000
RPLERACE EQU   RPLWRTYP                                                 00989000
RPLEAU   EQU   RPLWRTYP                                                 00990000
RPLNERAS EQU   RPLWRTYP                                                 00991000
RPLPSOPT EQU   RPLOPT5                                                  00992000
RPLSSNIN EQU   RPLOPT5                                                  00993000
RPLDLGIN EQU   RPLOPT5                                                  00994000
RPLCHAIN EQU   RPLNXTRP                                                 00995000
RPLOPT4  EQU   RPLOPTCD+3                                               00996000
RPLALIGN EQU   RPLOPT3                                                  00997000
RPLFMT   EQU   RPLOPT3                                                  00998000
RPLFLD   EQU   RPLOPT3                                                  00999000
RPLVFY   EQU   RPLOPT3                                                  01000000
RPLBLK   EQU   RPLOPT3                                                  01001000
RPLSFORM EQU   RPLOPT3                                                  01002000
RPLEODS  EQU   RPLOPT3                                                  01003000
RPLNSP   EQU   RPLOPT2                                                  01004000
RPLUPD   EQU   RPLOPT2                                                  01005000
RPLWAITX EQU   RPLOPT2                                                  01006000
RPLLRD   EQU   RPLOPT2                                                  01007000
RPLBWD   EQU   RPLOPT2                                                  01008000
RPLCNV   EQU   RPLOPT2                                                  01009000
RPLADD   EQU   RPLADR                                                   01010000
RPLKEY   EQU   RPLOPT2                                                  01011000
RPLECBIN EQU   RPLECBSW                                                 01012000
RPLGEN   EQU   RPLOPT1                                                  01013000
RPLKGE   EQU   RPLOPT1                                                  01014000
RPLASY   EQU   RPLOPT1                                                  01015000
RPLSKP   EQU   RPLOPT1                                                  01016000
RPLSEQ   EQU   RPLOPT1                                                  01017000
RPLDIR   EQU   RPLOPT1                                                  01018000
RPLLOC   EQU   RPLOPT1                                                  01019000
RPLDAF   EQU   RPLARG+2                                                 01020000
RPLSAF   EQU   RPLARG                                                   01021000
RPLTCBPT EQU   RPLCOMN+28                                               01022000
RPLCCHAR EQU   RPLCOMN+20                                               01023000
RPLSTRID EQU   RPLCOMN+18                                               01024000
RPLKEYL  EQU   RPLKEYLE                                                 01025000
RPLRDSOH EQU   RPLFDB3                                                  01026000
RPLRLG   EQU   RPLFDB3                                                  01027000
RPLLGFRC EQU   RPLFDB3                                                  01028000
RPLREOT  EQU   RPLFDB3                                                  01029000
RPLREOM  EQU   RPLFDB3                                                  01030000
RPLREOB  EQU   RPLFDB3                                                  01031000
RPLSV32  EQU   RPLFDB3                                                  01032000
RPLUINPT EQU   RPLFDB3                                                  01033000
RPLSTSAV EQU   RPLFDB2                                                  01034000
RPLCUERR EQU   RPLFDB2                                                  01035000
RPLDLGFL EQU   RPLFDB2                                                  01036000
RPLIOERR EQU   RPLFDB2                                                  01037000
RPLDVUNS EQU   RPLFDB2                                                  01038000
RPLATND  EQU   RPLFDB2                                                  01039000
RPLRVID  EQU   RPLFDB2                                                  01040000
RPLERLK  EQU   RPLFDB2                                                  01041000
RPLERREG EQU   RPLRTNCD                                                 01042000
RPLSTAT  EQU   RPLFDBWD                                                 01043000
RPLPOST  EQU   RPLECB                                                   01044000
RPLWAIT  EQU   RPLECB                                                   01045000
RPLPLHPT EQU   RPLCOMN+4                                                01046000
RPLLEN2  EQU   RPLLEN                                                   01047000
RPLREQ   EQU   RPLIDWD+2                                                01048000
CISTOWRC EQU   CISTOW                                                   01049000
CIFEOVRC EQU   CIFEOV                                                   01050000
CIBSPRC  EQU   CIBSP                                                    01051000
CIBLDLRC EQU   CIBLDL                                                   01052000
CISYNRC  EQU   CISYNADA                                                 01053000
CIWK2    EQU   IFGJCICB+332                                             01054000
CISAMWA  EQU   IFGJCICB+324                                             01055000
CIRECPTR EQU   IFGJCICB+320                                             01056000
CIBLKPTR EQU   IFGJCICB+312                                             01057000
CISEGLEN EQU   CIIOCNT                                                  01058000
CIFLAG4  EQU   CIFLAGS+3                                                01059000
@NM00020 EQU   CIFLAG3                                                  01060000
CIFPOINT EQU   CIFLAG3                                                  01061000
CIFERROR EQU   CIFLAG3                                                  01062000
CIFVSEOB EQU   CIFLAG3                                                  01063000
CIFVSRI  EQU   CIFLAG3                                                  01064000
CIFCLOSE EQU   CIFLAG3                                                  01065000
CIFFSTP  EQU   CIFLAG3                                                  01066000
@NM00019 EQU   CIFLAG2                                                  01067000
CIFMDEVT EQU   CIFLAG2                                                  01068000
CIFMDSOR EQU   CIFLAG2                                                  01069000
CIFLAG1  EQU   CIFLAGS                                                  01070000
CIREGS   EQU   CIREGSAV+12                                              01071000
CIREGFC  EQU   CIREGSAV+8                                               01072000
CIREGBC  EQU   CIREGSAV+4                                               01073000
@NM00018 EQU   CIREGSAV                                                 01074000
CISYNNAM EQU   IFGJCICB+108                                             01075000
CIACBED  EQU   IFGJCICB+88                                              01076000
CIDCBPTR EQU   CIDUMIOB+28                                              01077000
@NM00017 EQU   CIDUMIOB+24                                              01078000
CIRESID  EQU   CIDUMIOB+20                                              01079000
@NM00016 EQU   CIDUMIOB+16                                              01080000
CIECBPTR EQU   CIDUMIOB+12                                              01081000
CIIOB    EQU   CIDUMIOB+8                                               01082000
@NM00015 EQU   CIDUMIOB+5                                               01083000
CIECBCD  EQU   CIDUMIOB+4                                               01084000
CINXTIOB EQU   CIDUMIOB                                                 01085000
DCBEOB   EQU   IFGSDCB+92                                               01086000
DCBPRECL EQU   IFGSDCB+90                                               01087000
@NM00014 EQU   IFGSDCB+88                                               01088000
DCBPOINT EQU   DCBNOTE                                                  01089000
DCBEROPT EQU   @NM00013                                                 01090000
DCBQSWS  EQU   DCBDIRCT                                                 01091000
DCBCCCW  EQU   DCBRECAD                                                 01092000
DCBNCP   EQU   DCBEOBR                                                  01093000
DCBOFFSW EQU   IFGSDCB+67                                               01094000
DCBOFFSR EQU   IFGSDCB+66                                               01095000
DCBWCPL  EQU   IFGSDCB+65                                               01096000
DCBWCPO  EQU   IFGSDCB+64                                               01097000
DCBCIND1 EQU   IFGSDCB+60                                               01098000
DCBSYNAD EQU   IFGSDCB+57                                               01099000
DCBIOBL  EQU   IFGSDCB+56                                               01100000
DCBPERR  EQU   DCBGERR                                                  01101000
DCBOPTCD EQU   IFGSDCB+52                                               01102000
DCBMACR  EQU   DCBPUT+1                                                 01103000
DCBIFLG  EQU   DCBPUT                                                   01104000
DCBOFLGS EQU   IFGSDCB+48                                               01105000
DCBDEBAD EQU   DCBDDNAM+5                                               01106000
DCBIFLGS EQU   DCBDDNAM+4                                               01107000
DCBTIOT  EQU   DCBDDNAM                                                 01108000
DCBEXLST EQU   IFGSDCB+37                                               01109000
DCBEODAD EQU   IFGSDCB+33                                               01110000
DCBSVCXL EQU   DCBIOBAD                                                 01111000
DCBDSORG EQU   IFGSDCB+26                                               01112000
@NM00010 EQU   IFGSDCB+16                                               01113000
@NM00009 EQU   IFGSDCB                                                  01114000
PARCOPT  EQU   PARCDCB                                                  01115000
DXATEXC2 EQU   IECDSECT+608                                             01116000
DXATEXC1 EQU   IECDSECT+604                                             01117000
@NM00008 EQU   IECDSECT+572                                             01118000
DXUDCBAD EQU   IECDSECT+568                                             01119000
@NM00007 EQU   IECDSECT+527                                             01120000
@NM00006 EQU   IECDSECT+458                                             01121000
DXCALLID EQU   IECDSECT+456                                             01122000
@NM00005 EQU   IECDSECT+440                                             01123000
@NM00004 EQU   IECDSECT+276                                             01124000
IECJFCB  EQU   IECDSECT+100                                             01125000
@NM00003 EQU   IECDSECT                                                 01126000
@NM00002 EQU   WTG+8                                                    01127000
@NM00001 EQU   WTGMDNAM                                                 01128000
*                                      END UNREFERENCED COMPONENTS      01129000
@RF00078 EQU   INITRPL                                                  01130000
@RT00095 EQU   INITRPL                                                  01131000
@RC00171 EQU   @RC00155                                                 01132000
@RT00220 EQU   PROCESS                                                  01133000
@RT00222 EQU   TRANSFER                                                 01134000
@RF00222 EQU   NEXTNTRY                                                 01135000
@RT00172 EQU   @RC00171                                                 01136000
@EL01    EQU   @EL00001                                                 01137000
@ENDDATA EQU   *                                                        01138000
         END   IGG0199W,(C'PLS1154',0701,78025)                         01139000
./  ADD  SSI=63350002,NAME=IGG020FC
         TITLE 'IGG020FC  -  SAM-SI FORCE CLOSE EXECUTOR               *00001000
                        '                                               00002000
IGG020FC CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IGG020FC  73.233'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
*   RRXRETRY=ADDR(FAIL);            /* SET RESTART ADDRESS IN CASE OF   00014000
*                                      FAILURE PRIOR TO LOCATING THE    00015000
*                                      DCB MASK                      */ 00016000
         LA    @11,FAIL                                            0091 00017000
         ST    @11,RRXRETRY(,RRRPL)                                0091 00018000
*   RCICB=DCBCICB;                  /* GET ADDRESS OF CICB           */ 00019000
         L     RCICB,DCBCICB+52(,RDCB)                             0092 00020000
*   RESPECIFY                                                      0093 00021000
*     IFGJCICB BASED(RCICB);        /* CICB BASE                     */ 00022000
*   RACB=ADDR(CIACBD);              /* GET ADDRESS OF ACB            */ 00023000
         LA    RACB,CIACBD(,RCICB)                                 0094 00024000
*   RESPECIFY                                                      0095 00025000
*     IFGACB BASED(RACB);           /* ACB BASE                      */ 00026000
*                                                                  0095 00027000
*   /*****************************************************************/ 00028000
*   /*                                                               */ 00029000
*   /* DETERMINE WHAT FUNCTION WAS IN PROGRESS FOR THIS DCB.         */ 00030000
*   /*                                                               */ 00031000
*   /*****************************************************************/ 00032000
*                                                                  0096 00033000
*   IF RRFUNCTN¬=RRFOPEN&           /* IF FUNCTION IS NOT OPEN       */ 00034000
*       RRFUNCTN¬=RRFOPENJ THEN     /* AND NOT OPENJ         @ZA15085*/ 00035000
         CLI   RRFUNCTN(RRRPL),X'13'                               0096 00036000
         BE    @RF00096                                            0096 00037000
         CLI   RRFUNCTN(RRRPL),X'16'                               0096 00038000
         BNE   @RT00096                                            0096 00039000
*     GO TO CLOSEEOV;               /* GO TREAT IT AS CLOSE OR EOV   */ 00040000
*   GEN(EJECT);                                                    0098 00041000
@RF00096 DS    0H                                                  0098 00042000
         EJECT                                                          00043000
*                                                                  0099 00044000
*   /*****************************************************************/ 00045000
*   /*                                                               */ 00046000
*   /* THE DCB TO BE FORCE CLOSED WAS BEING PROCESSED BY OPEN WHEN A */ 00047000
*   /* FAILURE OCCURED. IN THIS CASE, THE DCB MODIFICATION MASK WILL */ 00048000
*   /* BE IN THE JFCB. THIS MASK MUST ALWAYS BE PLACED IN THE        */ 00049000
*   /* RECOVERY WORK AREA(FIRST WORD) FOR FORCE CLOSE SO THE DCB CAN */ 00050000
*   /* BE RESTORED.                                                  */ 00051000
*   /*                                                               */ 00052000
*   /*****************************************************************/ 00053000
*                                                                  0099 00054000
*   RCORE2->DXDSCB(1:4)=JFCBMASK;   /* SAVE THE DCB MOD MASK         */ 00055000
         MVC   DXDSCB(4,RCORE2),JFCBMASK+100(RCORE)                0099 00056000
*   RRXRETRY=NORETRY;               /* CLEAR THE RETRY, NOT NEEDED 0100 00057000
*                                      SINCE WE HAVE RECOVERED THE 0100 00058000
*                                      DCB MASK                      */ 00059000
*                                                                  0100 00060000
         SLR   @11,@11                                             0100 00061000
         ST    @11,RRXRETRY(,RRRPL)                                0100 00062000
*   /*****************************************************************/ 00063000
*   /*                                                               */ 00064000
*   /* TEST AUDIT TRAIL FLAGS TO SEE HOW FAR OPEN PROCEEDED WITH THIS*/ 00065000
*   /* DCB.                                                          */ 00066000
*   /*                                                               */ 00067000
*   /*****************************************************************/ 00068000
*                                                                  0101 00069000
*   IF ATFCICBG='0'B THEN           /* WAS CORE GOTTEN FOR A CICB?   */ 00070000
         TM    ATFCICBG+604(RCORE),B'10000000'                     0101 00071000
         BZ    @RT00101                                            0101 00072000
*     GO TO EXIT;                   /* NO, THEN NO CLEANUP IS NEEDED */ 00073000
*   ELSE                            /* YES, CONTINUE WITH CLEANUP    */ 00074000
*     ;                                                            0103 00075000
*   GEN(EJECT);                                                    0104 00076000
         EJECT                                                          00077000
*                                                                  0105 00078000
*   /*****************************************************************/ 00079000
*   /*                                                               */ 00080000
*   /* SWITCH NOW TO USER KEY TO REFERENCE ACB, CICB FIELDS.         */ 00081000
*   /*                                                               */ 00082000
*   /*****************************************************************/ 00083000
*                                                                  0105 00084000
*   RTEMP=RDCB;                     /* SAVE DCB POINTER              */ 00085000
         LR    RTEMP,RDCB                                          0105 00086000
*   RUKEY=DXUKEY;                   /* GET USER'S KEY                */ 00087000
         SLR   RUKEY,RUKEY                                         0106 00088000
         IC    RUKEY,DXUKEY(,RCORE)                                0106 00089000
*   GEN(MODESET KEYADDR=(2));       /* CHANGE KEY                    */ 00090000
         MODESET KEYADDR=(2)                                            00091000
*   RDCB=RTEMP;                     /* RESTORE DCB POINTER           */ 00092000
*                                                                  0108 00093000
         LR    RDCB,RTEMP                                          0108 00094000
*   /*****************************************************************/ 00095000
*   /*                                                               */ 00096000
*   /* CLOSE THE ASSOCIATED ACB                                      */ 00097000
*   /*                                                               */ 00098000
*   /*****************************************************************/ 00099000
*                                                                  0109 00100000
*   IF ACBOPEN='1'B THEN            /* IS THE ACB OPEN?              */ 00101000
         TM    ACBOPEN(RACB),B'00010000'                           0109 00102000
         BNO   @RF00109                                            0109 00103000
*     DO;                           /* ACB IS OPEN                   */ 00104000
*       CLOSEACB=RACB;              /* PLACE ACB ADDRESS IN CLOSE  0111 00105000
*                                      LIST                          */ 00106000
         LA    @11,328                                             0111 00107000
         ALR   @11,RCICB                                           0111 00108000
         STCM  RACB,7,CLOSEACB(@11)                                0111 00109000
*       CLOSEOPT(1)='1'B;           /* SET LAST ENTRY INDICATOR      */ 00110000
         OI    CLOSEOPT(@11),B'10000000'                           0112 00111000
*       R1=ADDR(CLOSNTRY);          /* ADDRESS OF CLOSE LIST         */ 00112000
         LR    R1,@11                                              0113 00113000
*       GEN(SVC 20);                /* ISSUE CLOSE SVC               */ 00114000
         SVC 20                                                         00115000
*     END;                                                         0115 00116000
*   ELSE                            /* THE ACB IS NOT OPEN           */ 00117000
*     DO;                           /* THEN ONLY RESOURCE TO FREE IS    00118000
*                                      CICB                          */ 00119000
         B     @RC00109                                            0116 00120000
@RF00109 DS    0H                                                  0117 00121000
*       GEN(MODESET EXTKEY=DATAMGT);/* RESTORE DM KEY                */ 00122000
         MODESET EXTKEY=DATAMGT                                         00123000
*       GO TO FREECICB;             /* GO FREE CICB AND EXIT         */ 00124000
         B     FREECICB                                            0118 00125000
*     END;                                                         0119 00126000
*                                                                  0119 00127000
*   /*****************************************************************/ 00128000
*   /*                                                               */ 00129000
*   /* FREE RECORD AREA FOR VARIABLE SPANNED RECORDS                 */ 00130000
*   /*                                                               */ 00131000
*   /*****************************************************************/ 00132000
*                                                                  0120 00133000
*   IF CIFRAGM='1'B THEN            /* WAS VS RECORD AREA OBTAINED?  */ 00134000
@RC00109 TM    CIFRAGM(RCICB),B'00100000'                          0120 00135000
         BNO   @RF00120                                            0120 00136000
*     DO;                           /* YES, FREE VS AREA             */ 00137000
*       RSIZE=CILWAREA;             /* LENGTH OF AREA                */ 00138000
         L     RSIZE,CILWAREA(,RCICB)                              0122 00139000
*       R1=CIRAREA;                 /* LOCATION OF AREA              */ 00140000
         L     R1,CIRAREA(,RCICB)                                  0123 00141000
*       GEN(FREEMAIN RC,LV=(RSIZE),A=(R1),SP=250);                 0124 00142000
         FREEMAIN RC,LV=(RSIZE),A=(R1),SP=250                           00143000
*     END;                                                         0125 00144000
*   ELSE                            /* NO VS AREA, CONTINUE          */ 00145000
*     ;                                                            0126 00146000
@RF00120 DS    0H                                                  0127 00147000
*   GEN(MODESET EXTKEY=DATAMGT);    /* RESTORE DM KEY                */ 00148000
         MODESET EXTKEY=DATAMGT                                         00149000
*   GEN(EJECT);                                                    0128 00150000
         EJECT                                                          00151000
*                                                                  0129 00152000
*   /*****************************************************************/ 00153000
*   /*                                                               */ 00154000
*   /* DELETE PROCESSING MODULES LOADED BY OPEN                      */ 00155000
*   /*                                                               */ 00156000
*   /*****************************************************************/ 00157000
*                                                                  0129 00158000
*   IF ATFQSAM='1'B THEN            /* WAS QSAM PROCESSOR LOADED ?   */ 00159000
         TM    ATFQSAM+604(RCORE),B'00001000'                      0129 00160000
         BNO   @RF00129                                            0129 00161000
*     DO;                           /* DELETE QSAM ROUTINES          */ 00162000
*       DXCCW10=QSAMMOD;            /* PUT QSAM MODULE NAME IN LIST  */ 00163000
         MVC   DXCCW10(8,RCORE),QSAMMOD                            0131 00164000
*       R0=ADDR(DXCCW10);           /* USE CCW AREA OF O/C/E WORK  0132 00165000
*                                      AREA AS THE PARM LIST         */ 00166000
         LA    R0,DXCCW10(,RCORE)                                  0132 00167000
*       GEN(DELETE EPLOC=(0));      /* DELETE QSAM MODULE            */ 00168000
         DELETE EPLOC=(0)                                               00169000
*       IF ATFSYNC='1'B THEN        /* WAS QSAM SYNC RTN ALSO LOADED?*/ 00170000
         TM    ATFSYNC+604(RCORE),B'00000010'                      0134 00171000
         BNO   @RF00134                                            0134 00172000
*         DO;                       /* YES, FREE SYNC ROUTINE        */ 00173000
*           DXCCW10=SYNCMOD;        /* SYNC NAME INTO LIST           */ 00174000
         MVC   DXCCW10(8,RCORE),SYNCMOD                            0136 00175000
*           R0=ADDR(DXCCW10);       /* POINT TO LIST                 */ 00176000
         LA    R0,DXCCW10(,RCORE)                                  0137 00177000
*           GEN(DELETE EPLOC=(0));                                 0138 00178000
         DELETE EPLOC=(0)                                               00179000
*         END;                                                     0139 00180000
*       ELSE                        /* SYNC ROUTINE NOT LOADED       */ 00181000
*         ;                                                        0140 00182000
@RF00134 DS    0H                                                  0141 00183000
*     END;                          /* END OF QSAM DELETIONS         */ 00184000
*   ELSE                            /* QSAM ROUTINE NOT LOADED       */ 00185000
*     DO;                           /* CHECK FOR BSAM ROUTINES       */ 00186000
         B     @RC00129                                            0142 00187000
@RF00129 DS    0H                                                  0143 00188000
*       IF ATFBSAM='1'B THEN        /* WAS BSAM MODULE LOADED?       */ 00189000
         TM    ATFBSAM+604(RCORE),B'00000100'                      0143 00190000
         BNO   @RF00143                                            0143 00191000
*         DO;                       /* YES, DELETE BSAM              */ 00192000
*           DXCCW10=BSAMMOD;        /* BSAM NAME INTO LIST           */ 00193000
         MVC   DXCCW10(8,RCORE),BSAMMOD                            0145 00194000
*           R0=ADDR(DXCCW10);       /* POINT TO LIST                 */ 00195000
         LA    R0,DXCCW10(,RCORE)                                  0146 00196000
*           GEN(DELETE EPLOC=(0));                                 0147 00197000
         DELETE EPLOC=(0)                                               00198000
*           IF ATFCHECK='1'B THEN   /* WAS SAM CHECK RTN LOADED ALSO?*/ 00199000
         TM    ATFCHECK+604(RCORE),B'00000001'                     0148 00200000
         BNO   @RF00148                                            0148 00201000
*             DO;                   /* YES, DELETE CHECK MODULE      */ 00202000
*               DXCCW10=CHECKMOD;   /* NAME OF CHECK MODULE          */ 00203000
         MVC   DXCCW10(8,RCORE),CHECKMOD                           0150 00204000
*               R0=ADDR(DXCCW10);   /* ADDRESS OF DELETE LIST        */ 00205000
         LA    R0,DXCCW10(,RCORE)                                  0151 00206000
*               GEN(DELETE EPLOC=(0));/* DELETE MODULE               */ 00207000
         DELETE EPLOC=(0)                                               00208000
*             END;                  /* END OF CHECK DELETE           */ 00209000
*           ELSE                    /* CHECK RTN NOT LOADED          */ 00210000
*             ;                                                    0154 00211000
@RF00148 DS    0H                                                  0155 00212000
*         END;                      /* END OF BSAM DELETIONS         */ 00213000
*       ELSE                        /* BSAM MODULES NOT LOADED       */ 00214000
*         ;                                                        0156 00215000
@RF00143 DS    0H                                                  0157 00216000
*     END;                          /* END OF TEST FOR BSAM          */ 00217000
*   GEN(EJECT);                                                    0158 00218000
@RC00129 DS    0H                                                  0158 00219000
         EJECT                                                          00220000
*                                                                  0159 00221000
*   /*****************************************************************/ 00222000
*   /*                                                               */ 00223000
*   /* FREE THE CICB                                                 */ 00224000
*   /*                                                               */ 00225000
*   /*****************************************************************/ 00226000
*                                                                  0159 00227000
*FREECICB:                                                         0159 00228000
*   RSIZE=LENGTH(IFGJCICB);         /* CICB SIZE                     */ 00229000
FREECICB LA    RSIZE,356                                           0159 00230000
*   GEN(FREEMAIN RC,LV=(RSIZE),A=(RCICB),SP=250);                  0160 00231000
*                                                                  0160 00232000
         FREEMAIN RC,LV=(RSIZE),A=(RCICB),SP=250                        00233000
*   /*****************************************************************/ 00234000
*   /*                                                               */ 00235000
*   /* RESTORE DCB FIELDS THAT ARE NOT RESTORED BY COMMON FORCE CLOSE*/ 00236000
*   /* WHEN THEY USE THE DCB MODIFICATION MASK.                      */ 00237000
*   /*                                                               */ 00238000
*   /*****************************************************************/ 00239000
*                                                                  0161 00240000
*   DCBGET=NULLADDR;                /* CLEAR GET/PUT/READ/WRITE    0161 00241000
*                                      ADDRESS                       */ 00242000
         LA    @11,1                                               0161 00243000
         ST    @11,DCBGET+48(,RDCB)                                0161 00244000
*   DCBGERR=NULLADDR;               /* CLEAR CHECK/SYNCRONIZE ADDRESS*/ 00245000
         LA    @15,52                                              0162 00246000
         ALR   @15,RDCB                                            0162 00247000
         ST    @11,DCBGERR(,@15)                                   0162 00248000
*   DCBCICB=NULLADDR;               /* CLEAR CICB POINTER            */ 00249000
         ST    @11,DCBCICB(,@15)                                   0163 00250000
*   DCBSVCXL=NULLADDR;              /* CLEAR SVC EXIT LIST POINTER   */ 00251000
         ST    @11,DCBSVCXL+28(,RDCB)                              0164 00252000
*   DCBCNTRL=NULLADDR;              /* CLEAR CNTRL ADDRESS           */ 00253000
         ST    @11,DCBCNTRL+72(,RDCB)                              0165 00254000
*   DCBCIND1(5)='0'B;               /* TURN OFF SAM-SI BIT           */ 00255000
         MVI   DCBCIND1+4(@15),B'00000000'                         0166 00256000
*   DCBCIND2(8)='0'B;               /* TURN OFF QSAM BIT             */ 00257000
*                                                                  0167 00258000
         MVI   DCBCIND2+7(@15),B'00000000'                         0167 00259000
*   /*****************************************************************/ 00260000
*   /*                                                               */ 00261000
*   /* RETURN TO THE CALLING FUNCTION                                */ 00262000
*   /*                                                               */ 00263000
*   /*****************************************************************/ 00264000
*                                                                  0168 00265000
*EXIT:                                                             0168 00266000
*   IF ATFABEND='1'B THEN           /* WAS THIS DCB ABENDED BY SAM-SI   00267000
*                                      OPEN EXECUTORS ?              */ 00268000
EXIT     TM    ATFABEND+604(RCORE),B'01000000'                     0168 00269000
         BNO   @RF00168                                            0168 00270000
*     RETCODE=4;                    /* YES, ALLOW DCB RESTORE BUT DCB   00271000
*                                      MAY NOT BE REOPENED           */ 00272000
         LA    RETCODE,4                                           0169 00273000
*   ELSE                            /* SAM-SI DID NOT ABEND THIS DCB */ 00274000
*     RETCODE=0;                    /* THEN DCB RESTORE AND REOPEN 0170 00275000
*                                      PERMISSIBLE                   */ 00276000
         B     @RC00168                                            0170 00277000
@RF00168 SLR   RETCODE,RETCODE                                     0170 00278000
*   RETURN CODE(RETCODE);           /* RETURN TO CALLER              */ 00279000
@RC00168 LR    @15,RETCODE                                         0171 00280000
         L     @14,12(,@13)                                        0171 00281000
         LM    @00,@12,20(@13)                                     0171 00282000
         BR    @14                                                 0171 00283000
*   GEN(EJECT);                                                    0172 00284000
         EJECT                                                          00285000
*                                                                  0173 00286000
*   /*****************************************************************/ 00287000
*   /*                                                               */ 00288000
*   /* A FAILURE HAS OCCURED DURING CLOSE OR EOV PROCESSING FOR THE  */ 00289000
*   /* CURRENT DCB. THE DCB MODIFICATION MASK CREATED WHEN THE DCB   */ 00290000
*   /* WAS OPENED MAY BE IN THE ACB'S DEB EXTENSION, OR IN THE FIRST */ 00291000
*   /* WORD OF THE CLOSE WORK AREA IF THE SAM-SI CLOSE EXECUTOR      */ 00292000
*   /* REACHED THAT POINT IN CLOSE PROCESSING.                       */ 00293000
*   /*                                                               */ 00294000
*   /*****************************************************************/ 00295000
*                                                                  0173 00296000
*CLOSEEOV:                                                         0173 00297000
*   IF ATFMDMSK='1'B THEN           /* HAS THE DCB MOD MASK BEEN   0173 00298000
*                                      SAVED?                        */ 00299000
CLOSEEOV LA    @11,604                                             0173 00300000
         ALR   @11,RCORE                                           0173 00301000
         TM    ATFMDMSK(@11),B'10000000'                           0173 00302000
         BNO   @RF00173                                            0173 00303000
*     DO;                           /* YES, GET IT FOR COMMON FORCE     00304000
*                                      CLOSE                         */ 00305000
*       RCORE2->DXDSCB(1:4)=DXDSCB; /* MOVE IT INTO RECOVERY WORK  0175 00306000
*                                      AREA                          */ 00307000
*                                                                  0175 00308000
         MVC   DXDSCB(4,RCORE2),DXDSCB(RCORE)                      0175 00309000
*       /*************************************************************/ 00310000
*       /*                                                           */ 00311000
*       /* WE NOW KNOW THAT SAM-SI CLOSE HAS PROCESSED THIS DCB.     */ 00312000
*       /* CHECK THE AUDIT TRAIL FLAGS TO SEE IF CLOSE FINISHED.     */ 00313000
*       /*                                                           */ 00314000
*       /*************************************************************/ 00315000
*                                                                  0176 00316000
*       IF ATFCICBF='1'B THEN       /* IF THE CICB HAS BEEN FREED, 0176 00317000
*                                      SAM-SI HAS ALREADY CLOSED THIS   00318000
*                                      DCB                           */ 00319000
         TM    ATFCICBF(@11),B'01000000'                           0176 00320000
         BO    @RT00176                                            0176 00321000
*         GO TO EXIT;               /* NO FURTHER CLEANUP NEEDED     */ 00322000
*       ELSE                        /* CICB NOT FREED YET, CONTINUE  */ 00323000
*         ;                                                        0178 00324000
*     END;                                                         0179 00325000
*   ELSE                            /* DCB MOD MASK NOT SAVED YET    */ 00326000
*     DO;                           /* WE MUST RETRIEVE IT FROM THE     00327000
*                                      DEB EXTENSION                 */ 00328000
         B     @RC00173                                            0180 00329000
@RF00173 DS    0H                                                  0181 00330000
*       RTEMP=RDCB;                 /* SAVE DCB ADDRESS              */ 00331000
         LR    RTEMP,RDCB                                          0181 00332000
*       RUKEY=DXUKEY;               /* GET USER'S STORAGE KEY        */ 00333000
         SLR   RUKEY,RUKEY                                         0182 00334000
         IC    RUKEY,DXUKEY(,RCORE)                                0182 00335000
*       GEN(MODESET KEYADDR=(2));   /* USER KEY FOR ACB REFERENCE    */ 00336000
         MODESET KEYADDR=(2)                                            00337000
*       RDCB=RTEMP;                 /* RESTORE DCB POINTER           */ 00338000
*                                                                  0184 00339000
         LR    RDCB,RTEMP                                          0184 00340000
*       /*************************************************************/ 00341000
*       /*                                                           */ 00342000
*       /* ISSUE DEBCHECK FOR THE ACB TO OBTAIN THE DEB ADDRESS. IF  */ 00343000
*       /* THE DEBCHECK FAILS, THE IMPLICATION IS THAT THE DCBCICB   */ 00344000
*       /* FIELD HAS BEEN DESTROYED, THUS PREVENTING LOCATING THE    */ 00345000
*       /* CICB. WHEN THIS OCCURS, NO FURTHER PROCESSING WILL BE     */ 00346000
*       /* ATTEMPTED BY THIS ROUTINE. DEBCHECK WILL ABEND, CAUSING   */ 00347000
*       /* THE 'FAIL' RETRY TO BE ENTERED.                           */ 00348000
*       /*                                                           */ 00349000
*       /*************************************************************/ 00350000
*                                                                  0185 00351000
*       GEN(DEBCHK (RACB),AM=SUBSYS);                              0185 00352000
         DEBCHK (RACB),AM=SUBSYS                                        00353000
*       RDEB=R1;                    /* SAVE THE DEB ADDRESS FROM   0186 00354000
*                                      DEBCHK                        */ 00355000
         LR    RDEB,R1                                             0186 00356000
*       GEN(MODESET EXTKEY=DATAMGT);/* RESTORE DM KEY                */ 00357000
         MODESET EXTKEY=DATAMGT                                         00358000
*       RCORE2->DXDSCB(1:4)=DEBXTNPT->DEBXDCBM;/* GET MOD MASK FROM     00359000
*                                      DEB EXTENSION                 */ 00360000
         LR    @11,RDEB                                            0188 00361000
         AL    @11,@CF01482                                        0188 00362000
         L     @11,DEBXTNPT(,@11)                                  0188 00363000
         MVC   DXDSCB(4,RCORE2),DEBXDCBM(@11)                      0188 00364000
*     END;                          /* END OF DCB MASK NOT SAVED     */ 00365000
*                                                                  0189 00366000
*   /*****************************************************************/ 00367000
*   /*                                                               */ 00368000
*   /* DCB MODIFICATION MASK HAS BEEN RETRIEVED SO WE MAY CLEAR THE  */ 00369000
*   /* 'FAIL' RETRY ROUTINE.                                         */ 00370000
*   /*                                                               */ 00371000
*   /*****************************************************************/ 00372000
*                                                                  0190 00373000
*   RRXRETRY=NORETRY;               /* CLEAR RETRY                   */ 00374000
*                                                                  0190 00375000
@RC00173 SLR   @11,@11                                             0190 00376000
         ST    @11,RRXRETRY(,RRRPL)                                0190 00377000
*   /*****************************************************************/ 00378000
*   /*                                                               */ 00379000
*   /* CLOSE THE ACB                                                 */ 00380000
*   /*                                                               */ 00381000
*   /*****************************************************************/ 00382000
*                                                                  0191 00383000
*   RTEMP=RDCB;                     /* SAVE DCB POINTER              */ 00384000
         LR    RTEMP,RDCB                                          0191 00385000
*   RUKEY=DXUKEY;                   /* GET USER'S KEY                */ 00386000
         SLR   RUKEY,RUKEY                                         0192 00387000
         IC    RUKEY,DXUKEY(,RCORE)                                0192 00388000
*   GEN(MODESET KEYADDR=(2));       /* TO USER KEY FOR ACB REF       */ 00389000
         MODESET KEYADDR=(2)                                            00390000
*   RDCB=RTEMP;                     /* RESTORE DCB POINTER           */ 00391000
         LR    RDCB,RTEMP                                          0194 00392000
*   IF ACBOPEN='1'B THEN            /* IS THE ACB OPEN ?             */ 00393000
         TM    ACBOPEN(RACB),B'00010000'                           0195 00394000
         BNO   @RF00195                                            0195 00395000
*     DO;                           /* YES, PREPARE TO CLOSE         */ 00396000
*       CLOSEACB=RACB;              /* ACB ADDRESS INTO CLOSE LIST   */ 00397000
         LA    @11,328                                             0197 00398000
         ALR   @11,RCICB                                           0197 00399000
         STCM  RACB,7,CLOSEACB(@11)                                0197 00400000
*       CLOSEOPT(1)='1'B;           /* SET LAST ENTRY                */ 00401000
         OI    CLOSEOPT(@11),B'10000000'                           0198 00402000
*       R1=ADDR(CLOSNTRY);          /* POINTER TO CLOSE LIST         */ 00403000
         LR    R1,@11                                              0199 00404000
*       GEN(SVC 20);                /* ISSUE CLOSE SVC               */ 00405000
         SVC 20                                                         00406000
*     END;                          /* END OF ACB CLOSE              */ 00407000
*   ELSE                            /* ACB NOT OPEN                  */ 00408000
*     ;                                                            0202 00409000
@RF00195 DS    0H                                                  0203 00410000
*   GEN(MODESET EXTKEY=DATAMGT);    /* RESTORE DM KEY                */ 00411000
         MODESET EXTKEY=DATAMGT                                         00412000
*   GO TO FREECICB;                 /* GO FREE THE CICB AND EXIT     */ 00413000
         B     FREECICB                                            0204 00414000
*   GEN(EJECT);                                                    0205 00415000
         EJECT                                                          00416000
*                                                                  0206 00417000
*   /*****************************************************************/ 00418000
*   /*                                                               */ 00419000
*   /* RETRY ROUTINE FOR ERRORS THAT OCCUR IN THIS MODULE BEFORE THE */ 00420000
*   /* DCB MODIFICATION MASK HAS BEEN RETRIEVED.                     */ 00421000
*   /*                                                               */ 00422000
*   /*****************************************************************/ 00423000
*                                                                  0206 00424000
*FAIL:                                                             0206 00425000
*   RETCODE=8;                      /* DENOTE DCB CANNOT BE RESTORED    00426000
*                                      NOR CAN IT BE REOPENED        */ 00427000
FAIL     LA    RETCODE,8                                           0206 00428000
*   RETURN CODE(RETCODE);           /* RETURN TO FORCE CLOSE         */ 00429000
         LR    @15,RETCODE                                         0207 00430000
         L     @14,12(,@13)                                        0207 00431000
         LM    @00,@12,20(@13)                                     0207 00432000
         BR    @14                                                 0207 00433000
*   END IGG020FC                    /* END OF SAM-SI FORCE CLOSE EXEC*/ 00434000
*                                                                  0208 00435000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00436000
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */ 00437000
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */ 00438000
*/*%INCLUDE SYSLIB  (IEZDEB  )                                       */ 00439000
*/*%INCLUDE SYSLIB  (IFGJCICB)                                       */ 00440000
*/*%INCLUDE SYSLIB  (IFGACB  )                                       */ 00441000
*/*%INCLUDE SYSLIB  (IECDSECT)                                       */ 00442000
*/*%INCLUDE SYSLIB  (IEFJFCBN)                                       */ 00443000
*/*%INCLUDE SYSLIB  (IECDSECS)                                       */ 00444000
*                                                                  0208 00445000
*       ;                                                          0208 00446000
@DATA    DS    0H                                                       00447000
@DATD    DSECT                                                          00448000
         DS    0F                                                       00449000
IGG020FC CSECT                                                          00450000
         DS    0F                                                       00451000
@CF01482 DC    F'-8'                                                    00452000
@DATD    DSECT                                                          00453000
         DS    0D                                                       00454000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00455000
@ENDDATD EQU   *                                                        00456000
IGG020FC CSECT                                                          00457000
         DS    0F                                                       00458000
@SIZDATD DC    AL1(0)                                                   00459000
         DC    AL3(@ENDDATD-@DATD)                                      00460000
         DS    0D                                                       00461000
QSAMMOD  DC    CL8'IGG019DJ'                                            00462000
BSAMMOD  DC    CL8'IGG019DK'                                            00463000
SYNCMOD  DC    CL8'IGG019AQ'                                            00464000
CHECKMOD DC    CL8'IGG019BB'                                            00465000
PATCH    DC    CL100' '                                                 00466000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00467000
@01      EQU   01                                                       00468000
@02      EQU   02                                                       00469000
@03      EQU   03                                                       00470000
@04      EQU   04                                                       00471000
@05      EQU   05                                                       00472000
@06      EQU   06                                                       00473000
@07      EQU   07                                                       00474000
@08      EQU   08                                                       00475000
@09      EQU   09                                                       00476000
@10      EQU   10                                                       00477000
@11      EQU   11                                                       00478000
@12      EQU   12                                                       00479000
@13      EQU   13                                                       00480000
@14      EQU   14                                                       00481000
@15      EQU   15                                                       00482000
R0       EQU   @00                                                      00483000
R1       EQU   @01                                                      00484000
RDCB     EQU   @02                                                      00485000
RUKEY    EQU   @02                                                      00486000
RCICB    EQU   @03                                                      00487000
RCORE    EQU   @04                                                      00488000
RCORE2   EQU   @05                                                      00489000
RTEMP    EQU   @06                                                      00490000
RDEB     EQU   @06                                                      00491000
RWTG     EQU   @06                                                      00492000
RSIZE    EQU   @07                                                      00493000
RRRPL    EQU   @08                                                      00494000
RACB     EQU   @09                                                      00495000
RETCODE  EQU   @10                                                      00496000
NOBASE   EQU   0                                                        00497000
IHADCB   EQU   0                                                        00498000
IHADCS11 EQU   0                                                        00499000
DCBRELB  EQU   IHADCS11                                                 00500000
DCBREL   EQU   DCBRELB+1                                                00501000
DCBBUFCB EQU   IHADCS11+4                                               00502000
DCBDSORG EQU   IHADCS11+10                                              00503000
DCBDSRG1 EQU   DCBDSORG                                                 00504000
DCBDSRG2 EQU   DCBDSORG+1                                               00505000
DCBIOBAD EQU   IHADCS11+12                                              00506000
DCBODEB  EQU   DCBIOBAD                                                 00507000
DCBLNP   EQU   DCBODEB                                                  00508000
DCBQSLM  EQU   DCBLNP                                                   00509000
DCBIOBAA EQU   DCBODEB+1                                                00510000
IHADCS50 EQU   0                                                        00511000
DCBSVCXL EQU   IHADCS50                                                 00512000
DCBEODAD EQU   IHADCS50+4                                               00513000
DCBBFALN EQU   DCBEODAD                                                 00514000
DCBHIARC EQU   DCBBFALN                                                 00515000
DCBBFTEK EQU   DCBHIARC                                                 00516000
DCBBFT   EQU   DCBBFTEK                                                 00517000
DCBEXLST EQU   IHADCS50+8                                               00518000
DCBRECFM EQU   DCBEXLST                                                 00519000
DCBRECLA EQU   DCBRECFM                                                 00520000
IHADCS24 EQU   0                                                        00521000
DCBOFLGS EQU   IHADCS24+8                                               00522000
DCBOFLWR EQU   DCBOFLGS                                                 00523000
DCBIFLG  EQU   IHADCS24+9                                               00524000
DCBIBPCT EQU   DCBIFLG                                                  00525000
DCBMACR  EQU   IHADCS24+10                                              00526000
DCBMACR1 EQU   DCBMACR                                                  00527000
DCBMRFE  EQU   DCBMACR1                                                 00528000
DCBMRGET EQU   DCBMRFE                                                  00529000
DCBMRAPG EQU   DCBMACR1                                                 00530000
DCBMRRD  EQU   DCBMRAPG                                                 00531000
DCBMRCI  EQU   DCBMACR1                                                 00532000
DCBMRMVG EQU   DCBMRCI                                                  00533000
DCBMRLCG EQU   DCBMACR1                                                 00534000
DCBMRABC EQU   DCBMACR1                                                 00535000
DCBMRPT1 EQU   DCBMRABC                                                 00536000
DCBMRSBG EQU   DCBMRPT1                                                 00537000
DCBMRCRL EQU   DCBMACR1                                                 00538000
DCBMRCHK EQU   DCBMRCRL                                                 00539000
DCBMRRDX EQU   DCBMRCHK                                                 00540000
DCBMRDMG EQU   DCBMACR1                                                 00541000
DCBMACR2 EQU   DCBMACR+1                                                00542000
DCBMRPUT EQU   DCBMACR2                                                 00543000
DCBMRWRT EQU   DCBMACR2                                                 00544000
DCBMRMVP EQU   DCBMACR2                                                 00545000
DCBMR5WD EQU   DCBMACR2                                                 00546000
DCBMRLDM EQU   DCBMR5WD                                                 00547000
DCBMRLCP EQU   DCBMRLDM                                                 00548000
DCBMR4WD EQU   DCBMACR2                                                 00549000
DCBMRPT2 EQU   DCBMR4WD                                                 00550000
DCBMRTMD EQU   DCBMRPT2                                                 00551000
DCBMR3WD EQU   DCBMACR2                                                 00552000
DCBMRCTL EQU   DCBMR3WD                                                 00553000
DCBMRSTK EQU   DCBMRCTL                                                 00554000
DCBMR1WD EQU   DCBMACR2                                                 00555000
DCBMRSWA EQU   DCBMR1WD                                                 00556000
DCBMRDMD EQU   DCBMRSWA                                                 00557000
IHADCS25 EQU   0                                                        00558000
DCBMACRF EQU   IHADCS25+2                                               00559000
DCBMACF1 EQU   DCBMACRF                                                 00560000
DCBMFFE  EQU   DCBMACF1                                                 00561000
DCBMFGET EQU   DCBMFFE                                                  00562000
DCBMFAPG EQU   DCBMACF1                                                 00563000
DCBMFRD  EQU   DCBMFAPG                                                 00564000
DCBMFCI  EQU   DCBMACF1                                                 00565000
DCBMFMVG EQU   DCBMFCI                                                  00566000
DCBMFLCG EQU   DCBMACF1                                                 00567000
DCBMFABC EQU   DCBMACF1                                                 00568000
DCBMFPT1 EQU   DCBMFABC                                                 00569000
DCBMFSBG EQU   DCBMFPT1                                                 00570000
DCBMFCRL EQU   DCBMACF1                                                 00571000
DCBMFCHK EQU   DCBMFCRL                                                 00572000
DCBMFDMG EQU   DCBMACF1                                                 00573000
DCBMACF2 EQU   DCBMACRF+1                                               00574000
DCBMFPUT EQU   DCBMACF2                                                 00575000
DCBMFWRT EQU   DCBMACF2                                                 00576000
DCBMFMVP EQU   DCBMACF2                                                 00577000
DCBMF5WD EQU   DCBMACF2                                                 00578000
DCBMFLDM EQU   DCBMF5WD                                                 00579000
DCBMFLCP EQU   DCBMFLDM                                                 00580000
DCBMF4WD EQU   DCBMACF2                                                 00581000
DCBMFPT2 EQU   DCBMF4WD                                                 00582000
DCBMFTMD EQU   DCBMFPT2                                                 00583000
DCBMF3WD EQU   DCBMACF2                                                 00584000
DCBMFCTL EQU   DCBMF3WD                                                 00585000
DCBMFSTK EQU   DCBMFCTL                                                 00586000
DCBMF1WD EQU   DCBMACF2                                                 00587000
DCBMFSWA EQU   DCBMF1WD                                                 00588000
DCBMFDMD EQU   DCBMFSWA                                                 00589000
DCBDEBAD EQU   IHADCS25+4                                               00590000
DCBIFLGS EQU   DCBDEBAD                                                 00591000
DCBIFPCT EQU   DCBIFLGS                                                 00592000
IHADCS26 EQU   0                                                        00593000
DCBWRITE EQU   IHADCS26                                                 00594000
DCBREAD  EQU   DCBWRITE                                                 00595000
DCBWRITA EQU   DCBREAD+1                                                00596000
IHADCS27 EQU   0                                                        00597000
DCBGET   EQU   IHADCS27                                                 00598000
DCBPUT   EQU   DCBGET                                                   00599000
DCBGETA  EQU   DCBPUT+1                                                 00600000
IHADCS36 EQU   0                                                        00601000
DCBGERR  EQU   IHADCS36                                                 00602000
DCBPERR  EQU   DCBGERR                                                  00603000
DCBCHECK EQU   DCBPERR                                                  00604000
DCBOPTCD EQU   DCBCHECK                                                 00605000
DCBOPTH  EQU   DCBOPTCD                                                 00606000
DCBOPTO  EQU   DCBOPTH                                                  00607000
DCBOPTZ  EQU   DCBOPTCD                                                 00608000
DCBGERRA EQU   DCBCHECK+1                                               00609000
DCBPERRA EQU   DCBGERRA                                                 00610000
DCBSYNAD EQU   IHADCS36+4                                               00611000
DCBCIND1 EQU   IHADCS36+8                                               00612000
DCBCIND2 EQU   IHADCS36+9                                               00613000
DCBIOBA  EQU   IHADCS36+16                                              00614000
DCBCICB  EQU   DCBIOBA                                                  00615000
IHADCS52 EQU   0                                                        00616000
DCBDIRCT EQU   IHADCS52                                                 00617000
DCBQSWS  EQU   DCBDIRCT                                                 00618000
DCBUSASI EQU   DCBQSWS                                                  00619000
DCBQADFS EQU   DCBUSASI                                                 00620000
DCBBUFOF EQU   DCBDIRCT+1                                               00621000
IHADCS37 EQU   0                                                        00622000
DCBFLAG1 EQU   IHADCS37                                                 00623000
IHADCS38 EQU   0                                                        00624000
DCBEOBR  EQU   IHADCS38                                                 00625000
DCBPOINT EQU   IHADCS38+12                                              00626000
DCBCNTRL EQU   DCBPOINT                                                 00627000
IHADCS40 EQU   0                                                        00628000
DCBEOBAD EQU   IHADCS40                                                 00629000
DCBCCCW  EQU   IHADCS40+4                                               00630000
DCBRECAD EQU   DCBCCCW                                                  00631000
DCBRECBT EQU   DCBRECAD                                                 00632000
DCBRCREL EQU   DCBRECBT                                                 00633000
@NM00023 EQU   IHADCS40+12                                              00634000
DCBEROPT EQU   @NM00023                                                 00635000
DEBBASIC EQU   0                                                        00636000
DEBTCBAD EQU   DEBBASIC                                                 00637000
DEBDEBAD EQU   DEBBASIC+4                                               00638000
DEBIRBAD EQU   DEBBASIC+8                                               00639000
DEBOFLGS EQU   DEBIRBAD                                                 00640000
DEBOPATB EQU   DEBBASIC+12                                              00641000
DEBFLGS1 EQU   DEBBASIC+14                                              00642000
DEBUSRPG EQU   DEBBASIC+16                                              00643000
DEBRRQ   EQU   DEBBASIC+20                                              00644000
DEBECBAD EQU   DEBRRQ                                                   00645000
DEBDCBAD EQU   DEBBASIC+24                                              00646000
DEBPROTG EQU   DEBDCBAD                                                 00647000
DEBAPPAD EQU   DEBBASIC+28                                              00648000
DEBBASND EQU   DEBBASIC+32                                              00649000
DEBDASD  EQU   0                                                        00650000
DEBUCBAD EQU   DEBDASD                                                  00651000
DEBACSMD EQU   0                                                        00652000
DEBVOLSQ EQU   DEBACSMD                                                 00653000
DEBVOLBT EQU   DEBVOLSQ                                                 00654000
DEBDSNM  EQU   DEBACSMD+4                                               00655000
DEBUTSAA EQU   DEBDSNM                                                  00656000
DEBACS01 EQU   0                                                        00657000
DEBDSNAM EQU   DEBACS01                                                 00658000
DEBACS02 EQU   0                                                        00659000
DEBDBLK  EQU   DEBACS02                                                 00660000
DEBACS03 EQU   0                                                        00661000
DEBACS04 EQU   0                                                        00662000
DEBTBFRA EQU   DEBACS04                                                 00663000
DEBTCCWA EQU   DEBACS04+4                                               00664000
DEBACS05 EQU   0                                                        00665000
DEBFUCBA EQU   DEBACS05                                                 00666000
DEBLUCBA EQU   DEBACS05+4                                               00667000
DEBACS06 EQU   0                                                        00668000
DEBACS07 EQU   0                                                        00669000
DEBACS08 EQU   0                                                        00670000
DEBSUBNM EQU   0                                                        00671000
DEB      EQU   0                                                        00672000
DEBAVT   EQU   DEB                                                      00673000
DEBEOEA  EQU   DEBAVT                                                   00674000
DEBEOEAB EQU   DEBEOEA                                                  00675000
DEBSIOA  EQU   DEBAVT+4                                                 00676000
DEBSIOAB EQU   DEBSIOA                                                  00677000
DEBPCIA  EQU   DEBAVT+8                                                 00678000
DEBPCIAB EQU   DEBPCIA                                                  00679000
DEBCEA   EQU   DEBAVT+12                                                00680000
DEBCEAB  EQU   DEBCEA                                                   00681000
DEBXCEA  EQU   DEBAVT+16                                                00682000
DEBXCEAB EQU   DEBXCEA                                                  00683000
DEBPREFX EQU   DEB+20                                                   00684000
DEBXTNP  EQU   DEBPREFX+8                                               00685000
DEBXTN   EQU   0                                                        00686000
DEBXFLG1 EQU   DEBXTN+2                                                 00687000
DEBXDCBM EQU   DEBXTN+8                                                 00688000
IFGJCICB EQU   0                                                        00689000
CIDUMIOB EQU   IFGJCICB                                                 00690000
CIACBD   EQU   IFGJCICB+32                                              00691000
CIREGSAV EQU   IFGJCICB+116                                             00692000
CIFLAGS  EQU   IFGJCICB+188                                             00693000
CIFLAG2  EQU   CIFLAGS+1                                                00694000
CIFLAG3  EQU   CIFLAGS+2                                                00695000
CIFRAGM  EQU   CIFLAG3                                                  00696000
CILWAREA EQU   IFGJCICB+304                                             00697000
CIIOCNT  EQU   IFGJCICB+308                                             00698000
CIRAREA  EQU   IFGJCICB+316                                             00699000
CIWK1    EQU   IFGJCICB+328                                             00700000
CISVCLST EQU   IFGJCICB+336                                             00701000
CISYNADA EQU   CISVCLST                                                 00702000
CIBLDL   EQU   CISVCLST+4                                               00703000
CIBSP    EQU   CISVCLST+8                                               00704000
CIFEOV   EQU   CISVCLST+12                                              00705000
CISTOW   EQU   CISVCLST+16                                              00706000
IFGACB   EQU   0                                                        00707000
ACBCOMN  EQU   IFGACB                                                   00708000
ACBLENG  EQU   ACBCOMN+2                                                00709000
ACBLENG2 EQU   ACBLENG                                                  00710000
ACBAMBL  EQU   ACBCOMN+4                                                00711000
ACBJWA   EQU   ACBAMBL                                                  00712000
ACBMACRF EQU   ACBCOMN+12                                               00713000
ACBMACR1 EQU   ACBMACRF                                                 00714000
ACBADR   EQU   ACBMACR1                                                 00715000
ACBCNV   EQU   ACBMACR1                                                 00716000
ACBMACR2 EQU   ACBMACRF+1                                               00717000
ACBBUFPL EQU   ACBCOMN+20                                               00718000
ACBMACR3 EQU   ACBBUFPL                                                 00719000
ACBRECFM EQU   ACBCOMN+24                                               00720000
ACBCCTYP EQU   ACBCOMN+25                                               00721000
ACBOPT   EQU   ACBCOMN+26                                               00722000
ACBDSORG EQU   ACBOPT                                                   00723000
ACBCROPS EQU   ACBDSORG                                                 00724000
ACBDVIND EQU   ACBDSORG                                                 00725000
ACBEXLST EQU   ACBCOMN+36                                               00726000
ACBDDNM  EQU   ACBCOMN+40                                               00727000
ACBAMETH EQU   ACBDDNM+3                                                00728000
ACBOFLGS EQU   ACBCOMN+48                                               00729000
ACBOPEN  EQU   ACBOFLGS                                                 00730000
ACBEXFG  EQU   ACBOFLGS                                                 00731000
ACBIOSFG EQU   ACBOFLGS                                                 00732000
ACBINFLG EQU   ACBCOMN+50                                               00733000
ACBVVIC  EQU   ACBINFLG                                                 00734000
ACBUJFCB EQU   ACBCOMN+52                                               00735000
ACBBLKSZ EQU   ACBCOMN+60                                               00736000
FORCORE  EQU   0                                                        00737000
DXDSCB   EQU   FORCORE                                                  00738000
DXJBF    EQU   FORCORE+100                                              00739000
DXDAADDR EQU   FORCORE+312                                              00740000
DXDCB    EQU   FORCORE+320                                              00741000
DXCCW    EQU   FORCORE+368                                              00742000
DXCCW5   EQU   DXCCW+32                                                 00743000
DXCCW8   EQU   DXCCW+56                                                 00744000
DXCCW10  EQU   DXCCW+72                                                 00745000
DXCCW12  EQU   DXCCW+88                                                 00746000
DXXCTL   EQU   FORCORE+472                                              00747000
DXVOLSR  EQU   FORCORE+500                                              00748000
DXVOLSR1 EQU   DXVOLSR                                                  00749000
DXVOLSR2 EQU   DXVOLSR+6                                                00750000
DXVOLSR3 EQU   DXVOLSR+12                                               00751000
DXRESSW  EQU   FORCORE+524                                              00752000
DXUKEY   EQU   FORCORE+526                                              00753000
DXUCBSAV EQU   FORCORE+564                                              00754000
DXUDCBAD EQU   FORCORE+568                                              00755000
DXPDCBAD EQU   FORCORE+572                                              00756000
DXATCOM1 EQU   FORCORE+588                                              00757000
DXATGENS EQU   DXATCOM1                                                 00758000
DXATVGIV EQU   DXATGENS                                                 00759000
DXATOUTA EQU   DXATCOM1+2                                               00760000
DXATDACC EQU   DXATCOM1+3                                               00761000
DXATCOM2 EQU   FORCORE+592                                              00762000
DXATEOV  EQU   DXATCOM2                                                 00763000
DXATOPEN EQU   DXATCOM2+1                                               00764000
DXATALL  EQU   DXATCOM2+2                                               00765000
DXATEXC1 EQU   FORCORE+604                                              00766000
DXATEXB1 EQU   DXATEXC1                                                 00767000
DXATEXC2 EQU   FORCORE+608                                              00768000
DSECTSIZ EQU   FORCORE+612                                              00769000
INFMJFCB EQU   0                                                        00770000
JFCBDSNM EQU   INFMJFCB                                                 00771000
JFCBELNM EQU   INFMJFCB+44                                              00772000
JFCBTSDM EQU   INFMJFCB+52                                              00773000
JFCFCBID EQU   INFMJFCB+56                                              00774000
JFCBFRID EQU   JFCFCBID                                                 00775000
JFCBLTYP EQU   INFMJFCB+66                                              00776000
JFCBOTTR EQU   INFMJFCB+67                                              00777000
JFCBUFOF EQU   JFCBOTTR                                                 00778000
JFCBFLSQ EQU   JFCBOTTR+1                                               00779000
JFCFUNC  EQU   JFCBFLSQ                                                 00780000
JFCBMASK EQU   INFMJFCB+72                                              00781000
JFCBFLG1 EQU   JFCBMASK+5                                               00782000
JFCOPEN  EQU   JFCBFLG1                                                 00783000
JFCBFLG2 EQU   JFCBMASK+6                                               00784000
JFCDEFER EQU   JFCBFLG2                                                 00785000
JFCBIND1 EQU   INFMJFCB+86                                              00786000
JFCBIND2 EQU   INFMJFCB+87                                              00787000
JFCAMPTR EQU   INFMJFCB+88                                              00788000
JFCBUFRQ EQU   JFCAMPTR                                                 00789000
JFCBUFNO EQU   JFCBUFRQ                                                 00790000
JFCBGNCP EQU   JFCAMPTR+1                                               00791000
JFCBHIAR EQU   JFCBGNCP                                                 00792000
JFCBFALN EQU   JFCBHIAR                                                 00793000
JFCBFTEK EQU   JFCBFALN                                                 00794000
JFCBBFTA EQU   JFCBFTEK                                                 00795000
JFCEROPT EQU   INFMJFCB+92                                              00796000
JFCTRTCH EQU   INFMJFCB+93                                              00797000
IECPREFX EQU   0                                                        00798000
IECEXTPR EQU   IECPREFX+32                                              00799000
IECUPRML EQU   IECEXTPR+80                                              00800000
IECRESWA EQU   IECEXTPR+84                                              00801000
RWARESWA EQU   0                                                        00802000
RWAPREFX EQU   RWARESWA                                                 00803000
USERPRML EQU   0                                                        00804000
IECRRPL  EQU   0                                                        00805000
RRPLIST  EQU   IECRRPL                                                  00806000
RRFUNCTN EQU   RRPLIST                                                  00807000
RRFLAGS1 EQU   RRPLIST+1                                                00808000
RRFLAGS2 EQU   RRPLIST+2                                                00809000
RRFLAGS3 EQU   RRPLIST+3                                                00810000
RRXRETRY EQU   RRPLIST+12                                               00811000
DSMADTRL EQU   0                                                        00812000
DSMADTW1 EQU   DSMADTRL                                                 00813000
DSMADTB1 EQU   DSMADTW1                                                 00814000
DSMADTB2 EQU   DSMADTW1+1                                               00815000
WTGTABLE EQU   0                                                        00816000
WTGWTOPR EQU   WTGTABLE                                                 00817000
WTG      EQU   0                                                        00818000
WTGAREA  EQU   WTG                                                      00819000
WTGMODNM EQU   WTGAREA                                                  00820000
WTGPREFX EQU   WTGAREA+16                                               00821000
WTGPATHS EQU   WTG+30                                                   00822000
WTGENTRY EQU   0                                                        00823000
WTGIDTTR EQU   WTGENTRY                                                 00824000
APPNMTBL EQU   0                                                        00825000
APPENTRY EQU   APPNMTBL+4                                               00826000
ATFLAGS  EQU   0                                                        00827000
ATFOPEN  EQU   ATFLAGS                                                  00828000
ATFCICBG EQU   ATFOPEN                                                  00829000
ATFABEND EQU   ATFOPEN                                                  00830000
ATFQSAM  EQU   ATFOPEN                                                  00831000
ATFBSAM  EQU   ATFOPEN                                                  00832000
ATFSYNC  EQU   ATFOPEN                                                  00833000
ATFCHECK EQU   ATFOPEN                                                  00834000
ATFCLOSE EQU   ATFLAGS+1                                                00835000
ATFMDMSK EQU   ATFCLOSE                                                 00836000
ATFCICBF EQU   ATFCLOSE                                                 00837000
CLOSNTRY EQU   0                                                        00838000
CLOSEOPT EQU   CLOSNTRY                                                 00839000
CLOSEACB EQU   CLOSNTRY+1                                               00840000
DEBXTNPT EQU   0                                                        00841000
DEBBAS02 EQU   DEBBASND                                                 00842000
DEBDDS1  EQU   DEBBAS02                                                 00843000
DEBSUCBA EQU   DEBDDS1                                                  00844000
DEBDEVED EQU   DEBDDS1+4                                                00845000
DEBRDCB  EQU   DEBDDS1+4                                                00846000
DEBPDCB  EQU   DEBDDS1+8                                                00847000
DEBWDCB  EQU   DEBDDS1+12                                               00848000
DEBACS09 EQU   DEBDEVED                                                 00849000
DEBASC09 EQU   DEBACS09                                                 00850000
DEBEAMFG EQU   DEBASC09+3                                               00851000
DEBDSID  EQU   DEBASC09+4                                               00852000
DEBEOD   EQU   DEBASC09+12                                              00853000
DEBBOE   EQU   DEBEOD                                                   00854000
DEBEODRV EQU   DEBBOE                                                   00855000
DEBEODTT EQU   DEBBOE+1                                                 00856000
DEBEOD0  EQU   DEBBOE+2                                                 00857000
DEBEODSS EQU   DEBBOE+3                                                 00858000
DEBBAS01 EQU   DEBBASND                                                 00859000
DEBISAM  EQU   DEBBAS01                                                 00860000
DEBFIEAD EQU   DEBISAM                                                  00861000
DEBFPEAD EQU   DEBISAM+4                                                00862000
DEBFOEAD EQU   DEBISAM+8                                                00863000
DEBEXPT  EQU   DEBISAM+12                                               00864000
DEBRPSID EQU   DEBEXPT                                                  00865000
JFCKEYLE EQU   JFCTRTCH                                                 00866000
JFCCODE  EQU   JFCKEYLE                                                 00867000
JFCSTACK EQU   JFCTRTCH                                                 00868000
JFCMODE  EQU   JFCSTACK                                                 00869000
JFCSPPRT EQU   JFCTRTCH                                                 00870000
JFCBABFS EQU   JFCSPPRT+2                                               00871000
JFCLIMCT EQU   JFCBABFS                                                 00872000
JFCDSORG EQU   JFCSPPRT+5                                               00873000
JFCDSRG1 EQU   JFCDSORG                                                 00874000
JFCDSRG2 EQU   JFCDSORG+1                                               00875000
JFCRECFM EQU   JFCSPPRT+7                                               00876000
JFCRCFM  EQU   JFCRECFM                                                 00877000
JFCOPTCD EQU   JFCSPPRT+8                                               00878000
JFCWVCSP EQU   JFCOPTCD                                                 00879000
JFCWVCIS EQU   JFCWVCSP                                                 00880000
JFCWVCBD EQU   JFCWVCIS                                                 00881000
JFCALLOW EQU   JFCOPTCD                                                 00882000
JFCRSV17 EQU   JFCALLOW                                                 00883000
JFCOVER  EQU   JFCRSV17                                                 00884000
JFCPCIBT EQU   JFCOPTCD                                                 00885000
JFCMAST  EQU   JFCPCIBT                                                 00886000
JFCEXT   EQU   JFCMAST                                                  00887000
JFCBCKPT EQU   JFCOPTCD                                                 00888000
JFCIND   EQU   JFCBCKPT                                                 00889000
JFCRSV18 EQU   JFCOPTCD                                                 00890000
JFCCYL   EQU   JFCRSV18                                                 00891000
JFCACT   EQU   JFCCYL                                                   00892000
JFCREDUC EQU   JFCOPTCD                                                 00893000
JFCRSV19 EQU   JFCREDUC                                                 00894000
JFCRSV20 EQU   JFCRSV19                                                 00895000
JFCRSV21 EQU   JFCOPTCD                                                 00896000
JFCDEL   EQU   JFCRSV21                                                 00897000
JFCOPTJ  EQU   JFCOPTCD                                                 00898000
JFCREORG EQU   JFCOPTJ                                                  00899000
JFCBLKSI EQU   JFCSPPRT+9                                               00900000
JFCBUFSI EQU   JFCBLKSI                                                 00901000
JFCAMSYN EQU   JFCSPPRT+11                                              00902000
JFCNCP   EQU   JFCAMSYN+2                                               00903000
JFCNTM   EQU   JFCAMSYN+3                                               00904000
JFCBFSEQ EQU   JFCNTM                                                   00905000
JFCPCI   EQU   JFCBFSEQ                                                 00906000
JFCRESRV EQU   JFCAMSYN+4                                               00907000
JFCUCSEG EQU   JFCRESRV                                                 00908000
JFCUCSOP EQU   JFCUCSEG+4                                               00909000
JFCOUTLI EQU   JFCUCSEG+5                                               00910000
JFCTHRSH EQU   JFCOUTLI                                                 00911000
JFCCPRI  EQU   JFCTHRSH                                                 00912000
JFCBVOLS EQU   JFCUCSEG+10                                              00913000
JFCBS001 EQU   JFCBVOLS                                                 00914000
JFCBPQTY EQU   JFCBS001+34                                              00915000
JFCBCTRI EQU   JFCBS001+37                                              00916000
JFCBSQTY EQU   JFCBS001+38                                              00917000
JFCFLGS1 EQU   JFCBS001+41                                              00918000
DXXWTG   EQU   DSECTSIZ                                                 00919000
DXXAREA  EQU   DSECTSIZ+4                                               00920000
DXXMODNM EQU   DXXAREA                                                  00921000
DXXLNG   EQU   DXXAREA+29                                               00922000
DXXENTRY EQU   DXXAREA+32                                               00923000
DXXIDTTR EQU   DXXENTRY                                                 00924000
DXREGSAV EQU   DXCCW8                                                   00925000
DXREG1   EQU   DXREGSAV+28                                              00926000
DXIDENT  EQU   DXCCW12                                                  00927000
DXRETMOD EQU   DXIDENT+2                                                00928000
@NM00081 EQU   DXXCTL                                                   00929000
DXSAVMOD EQU   @NM00081+2                                               00930000
@NM00082 EQU   DXRESSW                                                  00931000
DXBTAMX  EQU   DXREG1                                                   00932000
DXDSNAME EQU   DXCCW5                                                   00933000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00934000
DXRESIND EQU   @NM00082                                                 00935000
DXSAVOFF EQU   @NM00081+7                                               00936000
DXSAVADR EQU   DXSAVMOD+2                                               00937000
DXSAVID  EQU   DXSAVMOD                                                 00938000
DXABCODE EQU   @NM00081                                                 00939000
DXRETCOD EQU   DXIDENT+7                                                00940000
DXRETTTR EQU   DXRETMOD+2                                               00941000
DXRETID  EQU   DXRETMOD                                                 00942000
DXCALLID EQU   DXIDENT                                                  00943000
DXREG0   EQU   DXREGSAV+24                                              00944000
DXREGE   EQU   DXREGSAV+20                                              00945000
DXREGD   EQU   DXREGSAV+16                                              00946000
DXREGC   EQU   DXREGSAV+12                                              00947000
DXREGB   EQU   DXREGSAV+8                                               00948000
DXREGA   EQU   DXREGSAV+4                                               00949000
DXREG9   EQU   DXREGSAV                                                 00950000
DXXEND   EQU   DXXAREA+48                                               00951000
DXXLAST  EQU   DXXAREA+40                                               00952000
DXXCORE  EQU   DXXENTRY+5                                               00953000
DXETTR   EQU   DXXIDTTR+2                                               00954000
DXEID    EQU   DXXIDTTR                                                 00955000
DXXPATHS EQU   DXXAREA+30                                               00956000
DXOPCLSW EQU   DXXLNG                                                   00957000
DXXTXTLN EQU   DXXAREA+27                                               00958000
DXXMODSZ EQU   DXXAREA+24                                               00959000
DXXATTRB EQU   DXXAREA+22                                               00960000
@NM00066 EQU   DXXAREA+20                                               00961000
DXXPREFX EQU   DXXAREA+16                                               00962000
@NM00065 EQU   DXXAREA+12                                               00963000
DXXMODEP EQU   DXXAREA+8                                                00964000
DXXMODID EQU   DXXMODNM+6                                               00965000
@NM00064 EQU   DXXMODNM                                                 00966000
DXXWTOPR EQU   DXXWTG                                                   00967000
JFCBEND  EQU   JFCBS001+58                                              00968000
JFCBSPTN EQU   JFCBS001+57                                              00969000
JFCBVLCT EQU   JFCBS001+56                                              00970000
JFCBDRLH EQU   JFCBS001+53                                              00971000
JFCBSBNM EQU   JFCBS001+50                                              00972000
JFCBABST EQU   JFCBS001+48                                              00973000
JFCBSPNM EQU   JFCBS001+45                                              00974000
JFCBDQTY EQU   JFCBS001+42                                              00975000
JFCBUAFF EQU   JFCFLGS1                                                 00976000
JFCRSV45 EQU   JFCFLGS1                                                 00977000
JFCVRDS  EQU   JFCFLGS1                                                 00978000
JFCBCEOV EQU   JFCFLGS1                                                 00979000
JFCRSV42 EQU   JFCFLGS1                                                 00980000
JFCBADSP EQU   JFCFLGS1                                                 00981000
JFCTOPEN EQU   JFCFLGS1                                                 00982000
JFCBDLET EQU   JFCFLGS1                                                 00983000
JFCRQID  EQU   JFCBSQTY                                                 00984000
JFCROUND EQU   JFCBCTRI                                                 00985000
JFCALX   EQU   JFCBCTRI                                                 00986000
JFCMIXG  EQU   JFCBCTRI                                                 00987000
JFCONTIG EQU   JFCBCTRI                                                 00988000
JFCRSV29 EQU   JFCBCTRI                                                 00989000
JFCBMSGP EQU   JFCBCTRI                                                 00990000
JFCBSPAC EQU   JFCBCTRI                                                 00991000
JFCRUNIT EQU   JFCBPQTY                                                 00992000
JFCBEXAD EQU   JFCBS001+31                                              00993000
JFCBEXTL EQU   JFCBS001+30                                              00994000
JFCMSVGP EQU   JFCBS001+22                                              00995000
@NM00063 EQU   JFCBS001                                                 00996000
JFCAVOLS EQU   JFCBVOLS                                                 00997000
JFCBNVOL EQU   JFCUCSEG+9                                               00998000
JFCBNTCS EQU   JFCUCSEG+8                                               00999000
JFCSOWA  EQU   JFCOUTLI+1                                               01000000
JFCSEND  EQU   JFCCPRI                                                  01001000
JFCEQUAL EQU   JFCCPRI                                                  01002000
JFCRECV  EQU   JFCCPRI                                                  01003000
JFCRSV34 EQU   JFCCPRI                                                  01004000
JFCRSV33 EQU   JFCCPRI                                                  01005000
JFCRSV55 EQU   JFCCPRI                                                  01006000
JFCRSV54 EQU   JFCCPRI                                                  01007000
JFCRSV53 EQU   JFCCPRI                                                  01008000
JFCRSV27 EQU   JFCUCSOP                                                 01009000
JFCRSV26 EQU   JFCUCSOP                                                 01010000
JFCFCBVR EQU   JFCUCSOP                                                 01011000
JFCFCBAL EQU   JFCUCSOP                                                 01012000
JFCVER   EQU   JFCUCSOP                                                 01013000
JFCRSV25 EQU   JFCUCSOP                                                 01014000
JFCFOLD  EQU   JFCUCSOP                                                 01015000
JFCBEXTP EQU   JFCUCSOP                                                 01016000
JFCUCSID EQU   JFCUCSEG                                                 01017000
JFCINTVL EQU   JFCSPPRT+19                                              01018000
JFCDBUFN EQU   JFCRESRV+3                                               01019000
JFCCYLOF EQU   JFCRESRV+2                                               01020000
JFCRKP   EQU   JFCRESRV                                                 01021000
JFCPCIR2 EQU   JFCPCI                                                   01022000
JFCPCIR1 EQU   JFCPCI                                                   01023000
JFCPCIN2 EQU   JFCPCI                                                   01024000
JFCPCIN1 EQU   JFCPCI                                                   01025000
JFCPCIA2 EQU   JFCPCI                                                   01026000
JFCPCIA1 EQU   JFCPCI                                                   01027000
JFCPCIX2 EQU   JFCPCI                                                   01028000
JFCPCIX1 EQU   JFCPCI                                                   01029000
JFCBUFMX EQU   JFCNCP                                                   01030000
JFCLRECL EQU   JFCAMSYN                                                 01031000
JFCBAXBF EQU   JFCBUFSI                                                 01032000
JFCREL   EQU   JFCREORG                                                 01033000
JFCRSV22 EQU   JFCDEL                                                   01034000
JFCSRCHD EQU   JFCRSV20                                                 01035000
JFCOPTQ  EQU   JFCACT                                                   01036000
JFCFEED  EQU   JFCIND                                                   01037000
JFCCBWU  EQU   JFCEXT                                                   01038000
JFCWUMSG EQU   JFCOVER                                                  01039000
JFCSDNAM EQU   JFCWVCBD                                                 01040000
@NM00062 EQU   JFCRECFM                                                 01041000
JFCCHAR  EQU   JFCRECFM                                                 01042000
JFCRFS   EQU   JFCRECFM                                                 01043000
JFCRFB   EQU   JFCRECFM                                                 01044000
JFCRFO   EQU   JFCRCFM                                                  01045000
JFCFMREC EQU   JFCRCFM                                                  01046000
JFCRSV16 EQU   JFCDSRG2                                                 01047000
JFCRSV15 EQU   JFCDSRG2                                                 01048000
JFCORGTR EQU   JFCDSRG2                                                 01049000
JFCORGAM EQU   JFCDSRG2                                                 01050000
JFCRSV13 EQU   JFCDSRG2                                                 01051000
JFCORGTQ EQU   JFCDSRG2                                                 01052000
JFCORGTX EQU   JFCDSRG2                                                 01053000
JFCORGGS EQU   JFCDSRG2                                                 01054000
JFCORGU  EQU   JFCDSRG1                                                 01055000
JFCORGPO EQU   JFCDSRG1                                                 01056000
JFCORGMQ EQU   JFCDSRG1                                                 01057000
JFCORGCQ EQU   JFCDSRG1                                                 01058000
JFCORGCX EQU   JFCDSRG1                                                 01059000
JFCORGDA EQU   JFCDSRG1                                                 01060000
JFCORGPS EQU   JFCDSRG1                                                 01061000
JFCORGIS EQU   JFCDSRG1                                                 01062000
JFCTRKBL EQU   JFCLIMCT+1                                               01063000
@NM00061 EQU   JFCLIMCT                                                 01064000
JFCDEN   EQU   JFCSPPRT+1                                               01065000
JFCPRTSP EQU   JFCSPPRT                                                 01066000
JFCONE   EQU   JFCMODE                                                  01067000
JFCTWO   EQU   JFCMODE                                                  01068000
JFCRSV07 EQU   JFCMODE                                                  01069000
JFCRSV06 EQU   JFCMODE                                                  01070000
JFCMODER EQU   JFCMODE                                                  01071000
JFCMODEO EQU   JFCMODE                                                  01072000
JFCEBCD  EQU   JFCMODE                                                  01073000
JFCBIN   EQU   JFCMODE                                                  01074000
JFCRSV32 EQU   JFCCODE                                                  01075000
JFCTTY   EQU   JFCCODE                                                  01076000
JFCASCII EQU   JFCCODE                                                  01077000
JFCNCR   EQU   JFCCODE                                                  01078000
JFCBUR   EQU   JFCCODE                                                  01079000
JFCFRI   EQU   JFCCODE                                                  01080000
JFCBCD   EQU   JFCCODE                                                  01081000
JFCNOCON EQU   JFCCODE                                                  01082000
DEBEXPTA EQU   DEBEXPT+1                                                01083000
DEBRSV12 EQU   DEBRPSID                                                 01084000
DEBRSV11 EQU   DEBRPSID                                                 01085000
DEBRSV10 EQU   DEBRPSID                                                 01086000
DEBRSV09 EQU   DEBRPSID                                                 01087000
DEBRPSAP EQU   DEBRPSID                                                 01088000
DEBRPSO  EQU   DEBRPSID                                                 01089000
DEBRPSI  EQU   DEBRPSID                                                 01090000
DEBRPSP  EQU   DEBRPSID                                                 01091000
DEBFOEB  EQU   DEBFOEAD+1                                               01092000
DEBNOEE  EQU   DEBFOEAD                                                 01093000
DEBFPEB  EQU   DEBFPEAD+1                                               01094000
DEBNPEE  EQU   DEBFPEAD                                                 01095000
DEBFIEB  EQU   DEBFIEAD+1                                               01096000
DEBNIEE  EQU   DEBFIEAD                                                 01097000
DEBBOESS EQU   DEBEODSS                                                 01098000
DEBBOE0  EQU   DEBEOD0                                                  01099000
DEBBOETT EQU   DEBEODTT                                                 01100000
DEBBOERV EQU   DEBEODRV                                                 01101000
DEBRV008 EQU   DEBDSID+7                                                01102000
DEBWTPTI EQU   DEBDSID+6                                                01103000
DEBEXDTE EQU   DEBDSID                                                  01104000
DEBRV007 EQU   DEBEAMFG                                                 01105000
DEBRV006 EQU   DEBEAMFG                                                 01106000
DEBRV005 EQU   DEBEAMFG                                                 01107000
DEBRV004 EQU   DEBEAMFG                                                 01108000
DEBSECVL EQU   DEBEAMFG                                                 01109000
DEBVAMSG EQU   DEBEAMFG                                                 01110000
DEBDSOPN EQU   DEBEAMFG                                                 01111000
DEBMULTI EQU   DEBEAMFG                                                 01112000
DEBVSEQU EQU   DEBASC09+2                                               01113000
DEBDSSQL EQU   DEBASC09+1                                               01114000
DEBVOLAC EQU   DEBASC09                                                 01115000
DEBWDCBA EQU   DEBWDCB+1                                                01116000
DEBRSV08 EQU   DEBWDCB                                                  01117000
DEBPDCBA EQU   DEBPDCB+1                                                01118000
DEBRSV07 EQU   DEBPDCB                                                  01119000
DEBRDCBA EQU   DEBRDCB+1                                                01120000
DEBRSV06 EQU   DEBRDCB                                                  01121000
DEBSUCBB EQU   DEBSUCBA+1                                               01122000
DEBSDVM  EQU   DEBSUCBA                                                 01123000
@NM00084 EQU   ATFCLOSE                                                 01124000
@NM00083 EQU   ATFOPEN                                                  01125000
APPNAMID EQU   APPNMTBL+24                                              01126000
APPOFFST EQU   APPENTRY+2                                               01127000
APPCOUNT EQU   APPENTRY                                                 01128000
APPSIZE  EQU   APPNMTBL+2                                               01129000
APPBAL   EQU   APPNMTBL                                                 01130000
WTGCORE  EQU   WTGENTRY+5                                               01131000
WTGETTR  EQU   WTGIDTTR+2                                               01132000
WTGEID   EQU   WTGIDTTR                                                 01133000
WTGOPD   EQU   WTGPATHS+1                                               01134000
WTGRECHK EQU   WTGPATHS+1                                               01135000
WTGTSENQ EQU   WTGPATHS+1                                               01136000
@NM00080 EQU   WTGPATHS+1                                               01137000
WTGTRACE EQU   WTGPATHS+1                                               01138000
@NM00079 EQU   WTGPATHS                                                 01139000
WTGJFCBW EQU   WTGPATHS                                                 01140000
WTGSMF   EQU   WTGPATHS                                                 01141000
WTGTCOS  EQU   WTGPATHS                                                 01142000
WTGNSL   EQU   WTGPATHS                                                 01143000
WTGPRLSE EQU   WTGPATHS                                                 01144000
WTGLNG   EQU   WTG+29                                                   01145000
WTGTXTLN EQU   WTGAREA+27                                               01146000
WTGMODSZ EQU   WTGAREA+24                                               01147000
WTGATTRB EQU   WTGAREA+22                                               01148000
@NM00078 EQU   WTGAREA+20                                               01149000
@NM00077 EQU   WTGAREA+12                                               01150000
WTGMODEP EQU   WTGAREA+8                                                01151000
WTGMODID EQU   WTGMODNM+6                                               01152000
@NM00076 EQU   WTGMODNM                                                 01153000
DSMADTW6 EQU   DSMADTRL+20                                              01154000
DSMADTW5 EQU   DSMADTRL+16                                              01155000
DSMADTW4 EQU   DSMADTRL+12                                              01156000
DSMADTW3 EQU   DSMADTRL+8                                               01157000
DSMADTW2 EQU   DSMADTRL+4                                               01158000
DSMADTB4 EQU   DSMADTW1+3                                               01159000
DSMADTB3 EQU   DSMADTW1+2                                               01160000
@NM00075 EQU   DSMADTB2                                                 01161000
DSMDSNE  EQU   DSMADTB2                                                 01162000
DSMTIOTE EQU   DSMADTB2                                                 01163000
DSMSMCE  EQU   DSMADTB2                                                 01164000
DSMVTOCR EQU   DSMADTB2                                                 01165000
DSMASWAP EQU   DSMADTB1                                                 01166000
DSMUCBAL EQU   DSMADTB1                                                 01167000
DSMRPSAP EQU   DSMADTB1                                                 01168000
DSMLOCK  EQU   DSMADTB1                                                 01169000
@NM00074 EQU   DSMADTB1                                                 01170000
DSMVIO   EQU   DSMADTB1                                                 01171000
DSMISAM  EQU   DSMADTB1                                                 01172000
RRFWORK  EQU   RRPLIST+20                                               01173000
RRMLRTRY EQU   RRPLIST+16                                               01174000
RRUCBPTR EQU   RRXRETRY                                                 01175000
RR1RETRY EQU   RRPLIST+8                                                01176000
RR1WRKAR EQU   RRPLIST+4                                                01177000
@NM00073 EQU   RRFLAGS3                                                 01178000
RRFTERM  EQU   RRFLAGS3                                                 01179000
RRFFCEXC EQU   RRFLAGS3                                                 01180000
RRFFINFC EQU   RRFLAGS3                                                 01181000
RRFNRTCA EQU   RRFLAGS3                                                 01182000
@NM00072 EQU   RRFLAGS3                                                 01183000
RRFENQUL EQU   RRFLAGS2                                                 01184000
RRFPRDET EQU   RRFLAGS2                                                 01185000
@NM00071 EQU   RRFLAGS2                                                 01186000
RRFQMNGR EQU   RRFLAGS2                                                 01187000
RRFENQPW EQU   RRFLAGS2                                                 01188000
@NM00070 EQU   RRFLAGS2                                                 01189000
RRFFIN1  EQU   RRFLAGS2                                                 01190000
RRFTRACE EQU   RRFLAGS1                                                 01191000
RRFSMF   EQU   RRFLAGS1                                                 01192000
RRFNSL   EQU   RRFLAGS1                                                 01193000
RRFAMSTR EQU   RRFLAGS1                                                 01194000
RRFAMEXR EQU   RRFLAGS1                                                 01195000
RRFAMEXG EQU   RRFLAGS1                                                 01196000
RRFUSREX EQU   RRFLAGS1                                                 01197000
@NM00069 EQU   RRFLAGS1                                                 01198000
RRFRJFCB EQU   RRFUNCTN                                                 01199000
RRFDADSM EQU   RRFUNCTN                                                 01200000
DXDCBLST EQU   USERPRML                                                 01201000
RWALIST  EQU   RWARESWA+12                                              01202000
RWAPARM  EQU   RWAPREFX+8                                               01203000
RWATRBUF EQU   RWAPREFX+4                                               01204000
RWATRACE EQU   RWAPREFX                                                 01205000
IECQMNGR EQU   IECEXTPR+92                                              01206000
IECMSGQA EQU   IECEXTPR+88                                              01207000
IECDCBNO EQU   IECUPRML                                                 01208000
IECRRPRM EQU   IECEXTPR+76                                              01209000
IECWTGTB EQU   IECEXTPR+72                                              01210000
IECREGSV EQU   IECEXTPR                                                 01211000
IECCORP2 EQU   IECPREFX+28                                              01212000
IECCORP1 EQU   IECPREFX+24                                              01213000
IECCORPS EQU   IECPREFX+20                                              01214000
IECCORSP EQU   IECPREFX+19                                              01215000
@NM00068 EQU   IECPREFX+17                                              01216000
IECCORKY EQU   IECPREFX+16                                              01217000
IECCORAD EQU   IECPREFX+12                                              01218000
IECCORLN EQU   IECPREFX+8                                               01219000
@NM00067 EQU   IECPREFX+4                                               01220000
IECCORID EQU   IECPREFX                                                 01221000
JFCRSV05 EQU   JFCEROPT                                                 01222000
JFCRSV04 EQU   JFCEROPT                                                 01223000
JFCRSV03 EQU   JFCEROPT                                                 01224000
JFCRSV02 EQU   JFCEROPT                                                 01225000
JFCTOPT  EQU   JFCEROPT                                                 01226000
JFCABN   EQU   JFCEROPT                                                 01227000
JFCSKP   EQU   JFCEROPT                                                 01228000
JFCACC   EQU   JFCEROPT                                                 01229000
JFCBUFL  EQU   JFCAMPTR+2                                               01230000
JFCFWORD EQU   JFCBFTEK                                                 01231000
JFCDWORD EQU   JFCBFTEK                                                 01232000
JFCHIER1 EQU   JFCBFTEK                                                 01233000
JFCDYN   EQU   JFCBFTEK                                                 01234000
JFCEXC   EQU   JFCBFTEK                                                 01235000
JFCBBFTR EQU   JFCBBFTA                                                 01236000
JFCSIM   EQU   JFCBBFTA                                                 01237000
JFCHIER  EQU   JFCBFTEK                                                 01238000
JFCBFOUT EQU   JFCBUFNO                                                 01239000
JFCBUFIN EQU   JFCBUFNO                                                 01240000
JFCTEMP  EQU   JFCBIND2                                                 01241000
JFCREQ   EQU   JFCBIND2                                                 01242000
JFCENT   EQU   JFCBIND2                                                 01243000
JFCSHARE EQU   JFCBIND2                                                 01244000
JFCSECUR EQU   JFCBIND2                                                 01245000
JFCDISP  EQU   JFCBIND2                                                 01246000
JFCPDS   EQU   JFCBIND1                                                 01247000
JFCGDG   EQU   JFCBIND1                                                 01248000
JFCADDED EQU   JFCBIND1                                                 01249000
JFCLOC   EQU   JFCBIND1                                                 01250000
JFCRLSE  EQU   JFCBIND1                                                 01251000
JFCBXPDT EQU   INFMJFCB+83                                              01252000
JFCBCRDT EQU   INFMJFCB+80                                              01253000
JFCBOPS2 EQU   JFCBMASK+7                                               01254000
JFCRCTLG EQU   JFCBFLG2                                                 01255000
JFCBBUFF EQU   JFCBFLG2                                                 01256000
JFCTRACE EQU   JFCBFLG2                                                 01257000
JFCSDRPS EQU   JFCBFLG2                                                 01258000
JFCMODNW EQU   JFCBFLG2                                                 01259000
JFCNRPS  EQU   JFCDEFER                                                 01260000
JFCOUTOP EQU   JFCBFLG2                                                 01261000
JFCINOP  EQU   JFCBFLG2                                                 01262000
JFCBPWBP EQU   JFCOPEN                                                  01263000
@NM00060 EQU   JFCOPEN                                                  01264000
JFCDUAL  EQU   JFCBFLG1                                                 01265000
JFCSLDES EQU   JFCBFLG1                                                 01266000
JFCSLCRE EQU   JFCBFLG1                                                 01267000
JFCSTAND EQU   JFCBFLG1                                                 01268000
JFCBOPS1 EQU   JFCBMASK                                                 01269000
JFCBVLSQ EQU   INFMJFCB+70                                              01270000
JFCRSV31 EQU   JFCFUNC                                                  01271000
JFCFNCBT EQU   JFCFUNC                                                  01272000
JFCFNCBX EQU   JFCFUNC                                                  01273000
JFCFNCBD EQU   JFCFUNC                                                  01274000
JFCFNCBW EQU   JFCFUNC                                                  01275000
JFCFNCBP EQU   JFCFUNC                                                  01276000
JFCFNCBR EQU   JFCFUNC                                                  01277000
JFCFNCBI EQU   JFCFUNC                                                  01278000
JFCBFOFL EQU   JFCBUFOF                                                 01279000
JFCNL    EQU   JFCBLTYP                                                 01280000
JFCSL    EQU   JFCBLTYP                                                 01281000
JFCNSL   EQU   JFCBLTYP                                                 01282000
JFCSUL   EQU   JFCBLTYP                                                 01283000
JFCBLP   EQU   JFCBLTYP                                                 01284000
JFCBLTM  EQU   JFCBLTYP                                                 01285000
JFCBAL   EQU   JFCBLTYP                                                 01286000
JFCRSV38 EQU   JFCBLTYP                                                 01287000
JFCVINDX EQU   INFMJFCB+64                                              01288000
JFCNLREC EQU   INFMJFCB+62                                              01289000
JFCBADBF EQU   INFMJFCB+60                                              01290000
JFCAMSTR EQU   JFCBFRID+2                                               01291000
JFCAMCRO EQU   JFCBFRID                                                 01292000
JFCBDSCB EQU   INFMJFCB+53                                              01293000
JFCPAT   EQU   JFCBTSDM                                                 01294000
JFCNDCB  EQU   JFCBTSDM                                                 01295000
JFCNDSCB EQU   JFCBTSDM                                                 01296000
JFCNWRIT EQU   JFCBTSDM                                                 01297000
JFCTTR   EQU   JFCBTSDM                                                 01298000
JFCSDS   EQU   JFCBTSDM                                                 01299000
JFCVSL   EQU   JFCBTSDM                                                 01300000
JFCCAT   EQU   JFCBTSDM                                                 01301000
JFCIPLTX EQU   JFCBELNM                                                 01302000
JFCBQNAM EQU   JFCBDSNM                                                 01303000
DXATEXB2 EQU   DXATEXC2                                                 01304000
DXEXHASP EQU   DXATEXB1                                                 01305000
DXATCOM4 EQU   FORCORE+600                                              01306000
DXATCOM3 EQU   FORCORE+596                                              01307000
@NM00059 EQU   DXATCOM2+3                                               01308000
@NM00058 EQU   DXATALL                                                  01309000
DXATSWAP EQU   DXATALL                                                  01310000
DXATFC   EQU   DXATALL                                                  01311000
@NM00057 EQU   DXATOPEN                                                 01312000
DXATDFIN EQU   DXATOPEN                                                 01313000
DXATDSIN EQU   DXATOPEN                                                 01314000
DXATMODM EQU   DXATOPEN                                                 01315000
DXATMODE EQU   DXATOPEN                                                 01316000
DXATMODS EQU   DXATOPEN                                                 01317000
DXATIGN  EQU   DXATOPEN                                                 01318000
DXATVCAT EQU   DXATEOV                                                  01319000
DXATDADM EQU   DXATEOV                                                  01320000
DXATREMT EQU   DXATEOV                                                  01321000
DXATDNEW EQU   DXATEOV                                                  01322000
DXATDFRE EQU   DXATEOV                                                  01323000
DXATDCHN EQU   DXATEOV                                                  01324000
DXATNVOL EQU   DXATEOV                                                  01325000
DXATCCAT EQU   DXATEOV                                                  01326000
DXATRDDB EQU   DXATDACC                                                 01327000
DXATEOF  EQU   DXATDACC                                                 01328000
@NM00056 EQU   DXATDACC                                                 01329000
DXATSMF  EQU   DXATDACC                                                 01330000
DXATUPDB EQU   DXATDACC                                                 01331000
DXATDRCT EQU   DXATDACC                                                 01332000
DXATTRAK EQU   DXATDACC                                                 01333000
DXATF1CE EQU   DXATDACC                                                 01334000
DXATNSL  EQU   DXATOUTA                                                 01335000
DXATTTM2 EQU   DXATOUTA                                                 01336000
DXATTTM1 EQU   DXATOUTA                                                 01337000
DXATTRL2 EQU   DXATOUTA                                                 01338000
DXATTRL1 EQU   DXATOUTA                                                 01339000
DXATDATM EQU   DXATOUTA                                                 01340000
DXATHDTM EQU   DXATOUTA                                                 01341000
DXATVLHD EQU   DXATOUTA                                                 01342000
DXATCLOS EQU   DXATCOM1+1                                               01343000
DXATSRET EQU   DXATGENS                                                 01344000
DXATVCIG EQU   DXATVGIV                                                 01345000
DXATVTMG EQU   DXATVGIV                                                 01346000
DXATVSMG EQU   DXATVGIV                                                 01347000
DXATJFCB EQU   DXATGENS                                                 01348000
DXATDISP EQU   DXATGENS                                                 01349000
DXATREFR EQU   DXATGENS                                                 01350000
DXATDMCT EQU   DXATGENS                                                 01351000
DXMSGADR EQU   FORCORE+584                                              01352000
DXPRPARC EQU   FORCORE+580                                              01353000
DXUDCBML EQU   FORCORE+578                                              01354000
DXUDCBPL EQU   FORCORE+576                                              01355000
DXPACBAD EQU   DXPDCBAD+1                                               01356000
@NM00055 EQU   DXPDCBAD                                                 01357000
DXUACBAD EQU   DXUDCBAD+1                                               01358000
@NM00054 EQU   DXUDCBAD                                                 01359000
DXUCBSVV EQU   DXUCBSAV+1                                               01360000
@NM00053 EQU   DXUCBSAV                                                 01361000
DXUCBADR EQU   FORCORE+560                                              01362000
DXTIOTAD EQU   FORCORE+556                                              01363000
DXDEBXAD EQU   FORCORE+552                                              01364000
DXDSAB   EQU   FORCORE+548                                              01365000
DXDSABAD EQU   FORCORE+544                                              01366000
DXDSABQD EQU   FORCORE+540                                              01367000
DXJSCBAD EQU   FORCORE+536                                              01368000
DXTCBADR EQU   FORCORE+532                                              01369000
DXASCBAD EQU   FORCORE+528                                              01370000
DXEXTSW  EQU   FORCORE+527                                              01371000
DXWKEYSV EQU   FORCORE+525                                              01372000
DXUNITOF EQU   FORCORE+522                                              01373000
DXNOUNIT EQU   FORCORE+520                                              01374000
DXVOLSEQ EQU   FORCORE+518                                              01375000
DXVOLMT3 EQU   DXVOLSR3                                                 01376000
DXVOLMT2 EQU   DXVOLSR2                                                 01377000
DXVOLMT1 EQU   DXVOLSR1                                                 01378000
DXWORK4  EQU   FORCORE+496                                              01379000
DXWORK3  EQU   FORCORE+492                                              01380000
DXWORK2  EQU   FORCORE+488                                              01381000
DXWORK1  EQU   FORCORE+484                                              01382000
DXWORK   EQU   FORCORE+480                                              01383000
@NM00052 EQU   FORCORE+464                                              01384000
DXCCW11  EQU   DXCCW+80                                                 01385000
DXCCW9   EQU   DXCCW+64                                                 01386000
DXCCW7   EQU   DXCCW+48                                                 01387000
DXCCW6   EQU   DXCCW+40                                                 01388000
DXCCW4   EQU   DXCCW+24                                                 01389000
DXCCW3   EQU   DXCCW+16                                                 01390000
DXCCW2   EQU   DXCCW+8                                                  01391000
DXCCW1   EQU   DXCCW                                                    01392000
DXDCBDEB EQU   DXDCB+44                                                 01393000
@NM00051 EQU   DXDCB+24                                                 01394000
DXDEBDCB EQU   DXDCB+20                                                 01395000
@NM00050 EQU   DXDCB                                                    01396000
DXDEB    EQU   DXDAADDR+4                                               01397000
@NM00049 EQU   DXDAADDR                                                 01398000
DXIOB    EQU   FORCORE+280                                              01399000
DXECB    EQU   FORCORE+276                                              01400000
DSCCORE  EQU   FORCORE+96                                               01401000
DXLBL    EQU   DXDSCB                                                   01402000
ACBAPID  EQU   ACBCOMN+72                                               01403000
ACBCBMWA EQU   ACBCOMN+68                                               01404000
ACBUAPTR EQU   ACBCOMN+64                                               01405000
ACBLRECL EQU   ACBCOMN+62                                               01406000
ACBMSGLN EQU   ACBBLKSZ                                                 01407000
ACBBUFSP EQU   ACBCOMN+56                                               01408000
@NM00048 EQU   ACBUJFCB+1                                               01409000
ACBOPTN  EQU   ACBUJFCB                                                 01410000
@NM00047 EQU   ACBINFLG+1                                               01411000
ACBBYPSS EQU   ACBINFLG                                                 01412000
ACBSDS   EQU   ACBVVIC                                                  01413000
ACBUCRA  EQU   ACBINFLG                                                 01414000
ACBSCRA  EQU   ACBINFLG                                                 01415000
ACBCAT   EQU   ACBINFLG                                                 01416000
ACBIJRQE EQU   ACBINFLG                                                 01417000
ACBJEPS  EQU   ACBINFLG                                                 01418000
@NM00046 EQU   ACBINFLG                                                 01419000
ACBERFLG EQU   ACBCOMN+49                                               01420000
ACBBUSY  EQU   ACBIOSFG                                                 01421000
ACBLOCK  EQU   ACBEXFG                                                  01422000
@NM00045 EQU   ACBOFLGS                                                 01423000
ACBDSERR EQU   ACBOFLGS                                                 01424000
ACBEOV   EQU   ACBOFLGS                                                 01425000
@NM00044 EQU   ACBOFLGS                                                 01426000
ACBDEB   EQU   ACBDDNM+5                                                01427000
ACBERFL  EQU   ACBDDNM+4                                                01428000
ACBAM    EQU   ACBAMETH                                                 01429000
ACBINFL  EQU   ACBDDNM+2                                                01430000
ACBTIOT  EQU   ACBDDNM                                                  01431000
ACBUEL   EQU   ACBEXLST                                                 01432000
ACBPASSW EQU   ACBCOMN+32                                               01433000
ACBMSGAR EQU   ACBCOMN+28                                               01434000
@NM00043 EQU   ACBDSORG+1                                               01435000
ACBDORGA EQU   ACBDSORG+1                                               01436000
@NM00042 EQU   ACBDSORG                                                 01437000
ACBOPTJ  EQU   ACBDVIND                                                 01438000
ACBCRNRE EQU   ACBCROPS                                                 01439000
ACBCRNCK EQU   ACBCROPS                                                 01440000
ACBASA   EQU   ACBCCTYP                                                 01441000
@NM00041 EQU   ACBCCTYP                                                 01442000
ACBTRCID EQU   ACBCCTYP                                                 01443000
@NM00040 EQU   ACBRECFM                                                 01444000
ACBRECAF EQU   ACBRECFM                                                 01445000
ACBJBUF  EQU   ACBBUFPL+2                                               01446000
ACBMACR4 EQU   ACBBUFPL+1                                               01447000
@NM00039 EQU   ACBMACR3                                                 01448000
ACBNCFX  EQU   ACBMACR3                                                 01449000
ACBSIS   EQU   ACBMACR3                                                 01450000
ACBDFR   EQU   ACBMACR3                                                 01451000
ACBICI   EQU   ACBMACR3                                                 01452000
ACBGSR   EQU   ACBMACR3                                                 01453000
ACBLSR   EQU   ACBMACR3                                                 01454000
@NM00038 EQU   ACBMACR3                                                 01455000
ACBBUFNI EQU   ACBCOMN+18                                               01456000
ACBBUFND EQU   ACBCOMN+16                                               01457000
ACBSTRNO EQU   ACBCOMN+15                                               01458000
ACBBSTNO EQU   ACBCOMN+14                                               01459000
ACBAIX   EQU   ACBMACR2                                                 01460000
ACBDSN   EQU   ACBMACR2                                                 01461000
ACBRST   EQU   ACBMACR2                                                 01462000
ACBLOGON EQU   ACBMACR2                                                 01463000
ACBSKP   EQU   ACBMACR2                                                 01464000
@NM00037 EQU   ACBMACR2                                                 01465000
ACBUBF   EQU   ACBMACR1                                                 01466000
ACBOUT   EQU   ACBMACR1                                                 01467000
ACBIN    EQU   ACBMACR1                                                 01468000
ACBDIR   EQU   ACBMACR1                                                 01469000
ACBSEQ   EQU   ACBMACR1                                                 01470000
ACBBLK   EQU   ACBCNV                                                   01471000
ACBADD   EQU   ACBADR                                                   01472000
ACBKEY   EQU   ACBMACR1                                                 01473000
ACBINRTN EQU   ACBCOMN+8                                                01474000
ACBIBCT  EQU   ACBJWA                                                   01475000
ACBLEN2  EQU   ACBLENG2                                                 01476000
ACBSTYP  EQU   ACBCOMN+1                                                01477000
ACBID    EQU   ACBCOMN                                                  01478000
CISTOWRC EQU   CISTOW                                                   01479000
CIFEOVRC EQU   CIFEOV                                                   01480000
CIBSPRC  EQU   CIBSP                                                    01481000
CIBLDLRC EQU   CIBLDL                                                   01482000
CISYNRC  EQU   CISYNADA                                                 01483000
CIWK2    EQU   IFGJCICB+332                                             01484000
CISAMWA  EQU   IFGJCICB+324                                             01485000
CIRECPTR EQU   IFGJCICB+320                                             01486000
CIBLKPTR EQU   IFGJCICB+312                                             01487000
CISEGLEN EQU   CIIOCNT                                                  01488000
CIFDBCK  EQU   IFGJCICB+284                                             01489000
CIRPLEXT EQU   IFGJCICB+268                                             01490000
CIRPL    EQU   IFGJCICB+192                                             01491000
CIFLAG4  EQU   CIFLAGS+3                                                01492000
@NM00036 EQU   CIFLAG3                                                  01493000
CIFPOINT EQU   CIFLAG3                                                  01494000
CIFERROR EQU   CIFLAG3                                                  01495000
CIFVSEOB EQU   CIFLAG3                                                  01496000
CIFVSRI  EQU   CIFLAG3                                                  01497000
CIFCLOSE EQU   CIFLAG3                                                  01498000
CIFFSTP  EQU   CIFLAG3                                                  01499000
@NM00035 EQU   CIFLAG2                                                  01500000
CIFMDEVT EQU   CIFLAG2                                                  01501000
CIFMDSOR EQU   CIFLAG2                                                  01502000
CIFLAG1  EQU   CIFLAGS                                                  01503000
CIREGS   EQU   CIREGSAV+12                                              01504000
CIREGFC  EQU   CIREGSAV+8                                               01505000
CIREGBC  EQU   CIREGSAV+4                                               01506000
@NM00034 EQU   CIREGSAV                                                 01507000
CISYNNAM EQU   IFGJCICB+108                                             01508000
CIACBED  EQU   IFGJCICB+88                                              01509000
CIDCBPTR EQU   CIDUMIOB+28                                              01510000
@NM00033 EQU   CIDUMIOB+24                                              01511000
CIRESID  EQU   CIDUMIOB+20                                              01512000
@NM00032 EQU   CIDUMIOB+16                                              01513000
CIECBPTR EQU   CIDUMIOB+12                                              01514000
CIIOB    EQU   CIDUMIOB+8                                               01515000
@NM00031 EQU   CIDUMIOB+5                                               01516000
CIECBCD  EQU   CIDUMIOB+4                                               01517000
CINXTIOB EQU   CIDUMIOB                                                 01518000
DEBXRV40 EQU   DEBXTN+28                                                01519000
DEBXOPNJ EQU   DEBXTN+24                                                01520000
DEBXXARG EQU   DEBXTN+20                                                01521000
DEBXMCF2 EQU   DEBXTN+19                                                01522000
DEBXMCF1 EQU   DEBXTN+18                                                01523000
DEBXDSO2 EQU   DEBXTN+17                                                01524000
DEBXDSO1 EQU   DEBXTN+16                                                01525000
DEBXDBPR EQU   DEBXTN+12                                                01526000
DEBXDSAB EQU   DEBXTN+4                                                 01527000
DEBXRV48 EQU   DEBXTN+3                                                 01528000
DEBXRV47 EQU   DEBXFLG1                                                 01529000
DEBXRV46 EQU   DEBXFLG1                                                 01530000
DEBXRV45 EQU   DEBXFLG1                                                 01531000
DEBXRV44 EQU   DEBXFLG1                                                 01532000
DEBXRV43 EQU   DEBXFLG1                                                 01533000
DEBXDSSI EQU   DEBXFLG1                                                 01534000
DEBXTSKC EQU   DEBXFLG1                                                 01535000
DEBXCDCB EQU   DEBXFLG1                                                 01536000
DEBXLNGH EQU   DEBXTN                                                   01537000
DEBTBLOF EQU   DEBPREFX+14                                              01538000
DEBAMTYP EQU   DEBPREFX+13                                              01539000
DEBLNGTH EQU   DEBPREFX+12                                              01540000
DEBDCBMK EQU   DEBXTNP                                                  01541000
DEBDSCBA EQU   DEBPREFX+1                                               01542000
DEBWKARA EQU   DEBPREFX                                                 01543000
DEBXCEAD EQU   DEBXCEA+1                                                01544000
DEBXCENP EQU   DEBXCEAB                                                 01545000
DEBRSV35 EQU   DEBXCEAB                                                 01546000
DEBRSV34 EQU   DEBXCEAB                                                 01547000
DEBRSV33 EQU   DEBXCEAB                                                 01548000
DEBRSV32 EQU   DEBXCEAB                                                 01549000
DEBCEAD  EQU   DEBCEA+1                                                 01550000
DEBCENP  EQU   DEBCEAB                                                  01551000
DEBRSV31 EQU   DEBCEAB                                                  01552000
DEBRSV30 EQU   DEBCEAB                                                  01553000
DEBRSV29 EQU   DEBCEAB                                                  01554000
DEBRSV28 EQU   DEBCEAB                                                  01555000
DEBPCIAD EQU   DEBPCIA+1                                                01556000
DEBPCINP EQU   DEBPCIAB                                                 01557000
DEBRSV27 EQU   DEBPCIAB                                                 01558000
DEBRSV26 EQU   DEBPCIAB                                                 01559000
DEBRSV25 EQU   DEBPCIAB                                                 01560000
DEBRSV24 EQU   DEBPCIAB                                                 01561000
DEBSIOAD EQU   DEBSIOA+1                                                01562000
DEBSIONP EQU   DEBSIOAB                                                 01563000
DEBFIX   EQU   DEBSIOAB                                                 01564000
DEBIOVR  EQU   DEBSIOAB                                                 01565000
DEBSIOX  EQU   DEBSIOAB                                                 01566000
DEBPGFX  EQU   DEBSIOAB                                                 01567000
DEBEOEAD EQU   DEBEOEA+1                                                01568000
DEBEOENP EQU   DEBEOEAB                                                 01569000
DEBRSV22 EQU   DEBEOEAB                                                 01570000
DEBRSV21 EQU   DEBEOEAB                                                 01571000
DEBRSV20 EQU   DEBEOEAB                                                 01572000
DEBRSV19 EQU   DEBEOEAB                                                 01573000
DEBSUBID EQU   DEBSUBNM                                                 01574000
DEBSIOA2 EQU   DEBACS08+24                                              01575000
DEBRPSIO EQU   DEBACS08+20                                              01576000
DEBFREED EQU   DEBACS08+16                                              01577000
@NM00030 EQU   DEBACS08+12                                              01578000
@NM00029 EQU   DEBACS08+8                                               01579000
DEBDISAD EQU   DEBACS08+4                                               01580000
@NM00028 EQU   DEBACS08                                                 01581000
DEBRPSST EQU   DEBACS07+64                                              01582000
DEBARECK EQU   DEBACS07+60                                              01583000
DEBAREWT EQU   DEBACS07+56                                              01584000
DEBACHK  EQU   DEBACS07+52                                              01585000
DEBAWRIT EQU   DEBACS07+48                                              01586000
DEBASETL EQU   DEBACS07+44                                              01587000
DEBAREAD EQU   DEBACS07+40                                              01588000
DEBCRECK EQU   DEBACS07+36                                              01589000
DEBCREWT EQU   DEBACS07+32                                              01590000
DEBCCHK  EQU   DEBACS07+28                                              01591000
DEBCWRIT EQU   DEBACS07+24                                              01592000
DEBCSETL EQU   DEBACS07+20                                              01593000
DEBCREAD EQU   DEBACS07+16                                              01594000
DEBWKPT5 EQU   DEBACS07+12                                              01595000
DEBWKPT4 EQU   DEBACS07+8                                               01596000
DEBGET   EQU   DEBACS07+4                                               01597000
@NM00027 EQU   DEBACS07                                                 01598000
DEBPUT   EQU   DEBACS06+4                                               01599000
DEBDCBFA EQU   DEBACS06                                                 01600000
DEBLUCBB EQU   DEBLUCBA+1                                               01601000
DEBRSV18 EQU   DEBLUCBA                                                 01602000
DEBFUCBB EQU   DEBFUCBA+1                                               01603000
DEBRSV17 EQU   DEBFUCBA                                                 01604000
DEBTCCWB EQU   DEBTCCWA+1                                               01605000
DEBRSV16 EQU   DEBTCCWA                                                 01606000
DEBTBFRB EQU   DEBTBFRA+1                                               01607000
DEBRSV15 EQU   DEBTBFRA                                                 01608000
DEBDBPEF EQU   DEBACS03+8                                               01609000
DEBDBPP  EQU   DEBACS03+4                                               01610000
DEBDTPP  EQU   DEBACS03                                                 01611000
DEBDBPE  EQU   DEBDBLK+1                                                01612000
DEBDBPT  EQU   DEBDBLK                                                  01613000
DEBEXTNM EQU   DEBDSNAM                                                 01614000
DEBLRECL EQU   DEBACSMD+14                                              01615000
DEBBLKSI EQU   DEBACSMD+12                                              01616000
DEBRSV14 EQU   DEBDSNM+4                                                01617000
DEBUTSAB EQU   DEBUTSAA+1                                               01618000
DEBRSV13 EQU   DEBUTSAA                                                 01619000
DEBVOLNM EQU   DEBACSMD+2                                               01620000
DEBVLSEQ EQU   DEBVOLSQ+1                                               01621000
DEBRSV42 EQU   DEBVOLBT                                                 01622000
DEBRSV41 EQU   DEBVOLBT                                                 01623000
DEBRSV40 EQU   DEBVOLBT                                                 01624000
DEBRSV39 EQU   DEBVOLBT                                                 01625000
DEBRSV38 EQU   DEBVOLBT                                                 01626000
DEBRSV37 EQU   DEBVOLBT                                                 01627000
DEBRSV36 EQU   DEBVOLBT                                                 01628000
DEBEXFUL EQU   DEBVOLBT                                                 01629000
DEBNMTRK EQU   DEBDASD+14                                               01630000
DEBENDHH EQU   DEBDASD+12                                               01631000
DEBENDCC EQU   DEBDASD+10                                               01632000
DEBSTRHH EQU   DEBDASD+8                                                01633000
DEBSTRCC EQU   DEBDASD+6                                                01634000
DEBBINUM EQU   DEBDASD+4                                                01635000
DEBUCBA  EQU   DEBUCBAD+1                                               01636000
DEBDVMOD EQU   DEBUCBAD                                                 01637000
DEBAPPB  EQU   DEBAPPAD+1                                               01638000
DEBEXSCL EQU   DEBAPPAD                                                 01639000
DEBDCBB  EQU   DEBDCBAD+1                                               01640000
DEBDEBID EQU   DEBPROTG                                                 01641000
DEBECBB  EQU   DEBECBAD+1                                               01642000
DEBPRIOR EQU   DEBECBAD                                                 01643000
DEBUSRPB EQU   DEBUSRPG+1                                               01644000
DEBNMEXT EQU   DEBUSRPG                                                 01645000
DEBRSV05 EQU   DEBBASIC+15                                              01646000
DEBXTNIN EQU   DEBFLGS1                                                 01647000
DEBAPFIN EQU   DEBFLGS1                                                 01648000
DEBF1CEV EQU   DEBFLGS1                                                 01649000
DEBCINDI EQU   DEBFLGS1                                                 01650000
DEBRSV02 EQU   DEBFLGS1                                                 01651000
DEBRSIOA EQU   DEBFLGS1                                                 01652000
DEBEOFDF EQU   DEBFLGS1                                                 01653000
DEBPWCKD EQU   DEBFLGS1                                                 01654000
DEBQSCNT EQU   DEBBASIC+13                                              01655000
DEBACCS  EQU   DEBOPATB                                                 01656000
DEBPOSIT EQU   DEBOPATB                                                 01657000
DEBZERO  EQU   DEBOPATB                                                 01658000
DEBABEND EQU   DEBOPATB                                                 01659000
DEBIRBB  EQU   DEBIRBAD+1                                               01660000
DEBRERR  EQU   DEBOFLGS                                                 01661000
DEBLABEL EQU   DEBOFLGS                                                 01662000
DEBSPLIT EQU   DEBOFLGS                                                 01663000
DEBDCB   EQU   DEBOFLGS                                                 01664000
DEBRLSE  EQU   DEBOFLGS                                                 01665000
DEBEOF   EQU   DEBOFLGS                                                 01666000
DEBDISP  EQU   DEBOFLGS                                                 01667000
DEBDEBB  EQU   DEBDEBAD+1                                               01668000
DEBAMLNG EQU   DEBDEBAD                                                 01669000
DEBTCBB  EQU   DEBTCBAD+1                                               01670000
DEBNMSUB EQU   DEBTCBAD                                                 01671000
DCBEOB   EQU   IHADCS40+20                                              01672000
DCBPRECL EQU   IHADCS40+18                                              01673000
@NM00026 EQU   IHADCS40+16                                              01674000
@NM00025 EQU   @NM00023+1                                               01675000
@NM00024 EQU   DCBEROPT                                                 01676000
DCBERABE EQU   DCBEROPT                                                 01677000
DCBERSKP EQU   DCBEROPT                                                 01678000
DCBERACC EQU   DCBEROPT                                                 01679000
@NM00022 EQU   IHADCS40+10                                              01680000
@NM00021 EQU   IHADCS40+9                                               01681000
@NM00020 EQU   IHADCS40+8                                               01682000
DCBRECA  EQU   DCBRECAD+1                                               01683000
@NM00019 EQU   DCBRECBT                                                 01684000
DCBRCFGT EQU   DCBRCREL                                                 01685000
DCBRCTRU EQU   DCBRCREL                                                 01686000
DCBLCCW  EQU   DCBEOBAD                                                 01687000
DCBNOTE  EQU   DCBCNTRL                                                 01688000
DCBLRECL EQU   IHADCS38+10                                              01689000
@NM00018 EQU   IHADCS38+8                                               01690000
DCBEOBW  EQU   IHADCS38+4                                               01691000
DCBEOBRA EQU   DCBEOBR+1                                                01692000
DCBNCP   EQU   DCBEOBR                                                  01693000
@NM00017 EQU   DCBFLAG1                                                 01694000
DCBSTFLS EQU   DCBFLAG1                                                 01695000
DCBSTQCK EQU   DCBFLAG1                                                 01696000
DCBDIRCQ EQU   DCBBUFOF                                                 01697000
DCBQSTRU EQU   DCBUSASI                                                 01698000
@NM00016 EQU   DCBUSASI                                                 01699000
DCBQADF3 EQU   DCBQADFS                                                 01700000
DCBQADF2 EQU   DCBQADFS                                                 01701000
DCBQADF1 EQU   DCBQADFS                                                 01702000
DCBBLBP  EQU   DCBUSASI                                                 01703000
@NM00015 EQU   DCBUSASI                                                 01704000
DCBCICBA EQU   DCBCICB+1                                                01705000
@NM00014 EQU   DCBCICB                                                  01706000
DCBOFFSW EQU   IHADCS36+15                                              01707000
DCBOFFSR EQU   IHADCS36+14                                              01708000
DCBWCPL  EQU   IHADCS36+13                                              01709000
DCBWCPO  EQU   IHADCS36+12                                              01710000
DCBBLKSI EQU   IHADCS36+10                                              01711000
DCBCNQSM EQU   DCBCIND2                                                 01712000
DCBCNFEO EQU   DCBCIND2                                                 01713000
DCBCNCHS EQU   DCBCIND2                                                 01714000
DCBCNBFP EQU   DCBCIND2                                                 01715000
DCBCNIOE EQU   DCBCIND2                                                 01716000
DCBCNCLO EQU   DCBCIND2                                                 01717000
DCBCNWRO EQU   DCBCIND2                                                 01718000
DCBCNSTO EQU   DCBCIND2                                                 01719000
DCBCNEXB EQU   DCBCIND1                                                 01720000
@NM00013 EQU   DCBCIND1                                                 01721000
DCBCNBRM EQU   DCBCIND1                                                 01722000
@NM00012 EQU   DCBCIND1                                                 01723000
DCBCNEVA EQU   DCBCIND1                                                 01724000
DCBCNEVB EQU   DCBCIND1                                                 01725000
DCBCNSRD EQU   DCBCIND1                                                 01726000
DCBCNTOV EQU   DCBCIND1                                                 01727000
DCBSYNA  EQU   DCBSYNAD+1                                               01728000
DCBIOBL  EQU   DCBSYNAD                                                 01729000
DCBCHCKA EQU   DCBPERRA                                                 01730000
DCBOPTJ  EQU   DCBOPTCD                                                 01731000
DCBOPTT  EQU   DCBOPTCD                                                 01732000
DCBSRCHD EQU   DCBOPTZ                                                  01733000
DCBOPTQ  EQU   DCBOPTCD                                                 01734000
DCBBCKPT EQU   DCBOPTO                                                  01735000
DCBOPTC  EQU   DCBOPTCD                                                 01736000
DCBOPTU  EQU   DCBOPTCD                                                 01737000
DCBOPTW  EQU   DCBOPTCD                                                 01738000
DCBPUTA  EQU   DCBGETA                                                  01739000
@NM00011 EQU   DCBPUT                                                   01740000
DCBREADA EQU   DCBWRITA                                                 01741000
@NM00010 EQU   DCBREAD                                                  01742000
DCBDEBA  EQU   DCBDEBAD+1                                               01743000
@NM00009 EQU   DCBIFLGS                                                 01744000
DCBIFIOE EQU   DCBIFLGS                                                 01745000
DCBCH12  EQU   DCBIFPCT                                                 01746000
DCBCH9   EQU   DCBIFPCT                                                 01747000
DCBIFEC  EQU   DCBIFLGS                                                 01748000
DCBMFSTI EQU   DCBMFDMD                                                 01749000
DCBMFAWR EQU   DCBMFSTK                                                 01750000
DCBMFUIP EQU   DCBMFTMD                                                 01751000
DCBMFIDW EQU   DCBMFLCP                                                 01752000
DCBMFWRK EQU   DCBMFMVP                                                 01753000
DCBMFRDQ EQU   DCBMFWRT                                                 01754000
DCBMFGTQ EQU   DCBMFPUT                                                 01755000
DCBMFSTL EQU   DCBMACF2                                                 01756000
DCBMFCK  EQU   DCBMFDMG                                                 01757000
DCBMFRDX EQU   DCBMFCHK                                                 01758000
DCBMFDBF EQU   DCBMFSBG                                                 01759000
DCBMFRDI EQU   DCBMFLCG                                                 01760000
DCBMFRDK EQU   DCBMFMVG                                                 01761000
DCBMFWRQ EQU   DCBMFRD                                                  01762000
DCBMFPTQ EQU   DCBMFGET                                                 01763000
DCBMFECP EQU   DCBMACF1                                                 01764000
DCBTIOT  EQU   IHADCS25                                                 01765000
DCBMRSTI EQU   DCBMRDMD                                                 01766000
DCBMRAWR EQU   DCBMRSTK                                                 01767000
DCBMRUIP EQU   DCBMRTMD                                                 01768000
DCBMRIDW EQU   DCBMRLCP                                                 01769000
DCBMRWRK EQU   DCBMRMVP                                                 01770000
DCBMRRDQ EQU   DCBMRWRT                                                 01771000
DCBMRGTQ EQU   DCBMRPUT                                                 01772000
DCBMRSTL EQU   DCBMACR2                                                 01773000
DCBMRCK  EQU   DCBMRDMG                                                 01774000
DCBPGFXA EQU   DCBMRRDX                                                 01775000
DCBMRDBF EQU   DCBMRSBG                                                 01776000
DCBMRRDI EQU   DCBMRLCG                                                 01777000
DCBMRRDK EQU   DCBMRMVG                                                 01778000
DCBMRWRQ EQU   DCBMRRD                                                  01779000
DCBMRPTQ EQU   DCBMRGET                                                 01780000
DCBMRECP EQU   DCBMACR1                                                 01781000
@NM00008 EQU   DCBIFLG                                                  01782000
DCBIBIOE EQU   DCBIFLG                                                  01783000
DCBICH12 EQU   DCBIBPCT                                                 01784000
DCBICH9  EQU   DCBIBPCT                                                 01785000
DCBIBEC  EQU   DCBIFLG                                                  01786000
DCBOFIOF EQU   DCBOFLGS                                                 01787000
DCBOFUEX EQU   DCBOFLGS                                                 01788000
DCBOFTM  EQU   DCBOFLGS                                                 01789000
DCBOFPPC EQU   DCBOFLGS                                                 01790000
DCBOFOPN EQU   DCBOFLGS                                                 01791000
DCBOFEOV EQU   DCBOFLGS                                                 01792000
DCBOFLRB EQU   DCBOFLGS                                                 01793000
DCBOFIOD EQU   DCBOFLWR                                                 01794000
DCBDDNAM EQU   IHADCS24                                                 01795000
DCBEXLSA EQU   DCBEXLST+1                                               01796000
DCBRECKL EQU   DCBRECFM                                                 01797000
DCBRECCC EQU   DCBRECFM                                                 01798000
DCBRECSB EQU   DCBRECFM                                                 01799000
DCBRECBR EQU   DCBRECFM                                                 01800000
DCBRECTO EQU   DCBRECLA                                                 01801000
DCBRECL  EQU   DCBRECLA                                                 01802000
DCBEODA  EQU   DCBEODAD+1                                               01803000
DCBBFA   EQU   DCBBFTEK                                                 01804000
DCBH0    EQU   DCBBFTEK                                                 01805000
DCBBFTKD EQU   DCBBFTEK                                                 01806000
DCBBFTE  EQU   DCBBFT                                                   01807000
DCBBFTKR EQU   DCBBFT                                                   01808000
DCBBFTS  EQU   DCBBFT                                                   01809000
DCBH1    EQU   DCBBFTEK                                                 01810000
DCBSVCXA EQU   DCBSVCXL+1                                               01811000
@NM00007 EQU   DCBSVCXL                                                 01812000
DCBODEBA EQU   DCBIOBAA                                                 01813000
@NM00006 EQU   DCBQSLM                                                  01814000
DCBUPDBT EQU   DCBQSLM                                                  01815000
DCBUPDCM EQU   DCBQSLM                                                  01816000
DCB1DVDS EQU   DCBQSLM                                                  01817000
@NM00005 EQU   DCBDSRG2                                                 01818000
DCBDSGTR EQU   DCBDSRG2                                                 01819000
DCBACBM  EQU   DCBDSRG2                                                 01820000
@NM00004 EQU   DCBDSRG2                                                 01821000
DCBDSGTQ EQU   DCBDSRG2                                                 01822000
DCBDSGTX EQU   DCBDSRG2                                                 01823000
DCBDSGGS EQU   DCBDSRG2                                                 01824000
DCBDSGU  EQU   DCBDSRG1                                                 01825000
DCBDSGPO EQU   DCBDSRG1                                                 01826000
@NM00003 EQU   DCBDSRG1                                                 01827000
@NM00002 EQU   DCBDSRG1                                                 01828000
DCBDSGCX EQU   DCBDSRG1                                                 01829000
DCBDSGDA EQU   DCBDSRG1                                                 01830000
DCBDSGPS EQU   DCBDSRG1                                                 01831000
DCBDSGIS EQU   DCBDSRG1                                                 01832000
DCBBUFL  EQU   IHADCS11+8                                               01833000
DCBBUFCA EQU   DCBBUFCB+1                                               01834000
DCBBUFNO EQU   DCBBUFCB                                                 01835000
DCBDEVT  EQU   DCBREL                                                   01836000
DCBKEYLE EQU   DCBRELB                                                  01837000
@NM00001 EQU   IHADCB                                                   01838000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01839000
@RT00096 EQU   CLOSEEOV                                                 01840000
@RT00101 EQU   EXIT                                                     01841000
@RT00176 EQU   EXIT                                                     01842000
@ENDDATA EQU   *                                                        01843000
         END   IGG020FC,(C'PLS0537',0701,76335)                         01844000
./  ADD  SSI=80760140,NAME=IGG0201W
         TITLE 'IGG0201W  -   SAM-SI CLOSE EXECUTOR                    *00001000
                        '                                               00002000
         EJECT                                                          00003000
IGG0201W CSECT ,                                                   0002 00004000
@PROLOG  BALR  @12,0                                               0002 00005000
@PSTART  DS    0H                                                  0002 00006000
         USING @PSTART,@12                                         0002 00007000
HEX01    EQU   01                       ASSEMBLER CONSTANT              00008000
HEX10    EQU   16                       ASSEMBLER CONSTANT              00009000
         EJECT                                                          00010000
         EJECT                                                          00011000
         EJECT                                                          00012000
         EJECT                                                          00013000
         EJECT                                                          00014000
         EJECT                                                          00015000
*                                                                  0087 00016000
         MODESET EXTKEY=DATAMGT                                         00017000
*        /* SET COUNT OF ACB(S) PROCESSED TO ZERO                   */  00018000
*        RACBCNT = 0;                                              0088 00019000
*                                                                  0088 00020000
         SLR   RACBCNT,RACBCNT                                     0088 00021000
*        /***********************************************************/  00022000
*COUNT:  /* CHECK TO DETERMINE WHETHER AN ACB NEEDS TO BE CLOSED    */  00023000
*        /***********************************************************/  00024000
*                                                                  0089 00025000
*        /* DOES WTG TABLE ENTRY INDICATE THIS LOAD ?               */  00026000
*                                                                  0089 00027000
*        IF WTGCID = '1W'                                          0089 00028000
*          THEN                         /* YES                      */  00029000
COUNT    CLC   WTGCID(2,RWTGC),@CC00814                            0089 00030000
         BNE   @RF00089                                            0089 00031000
*            DO;                                                   0090 00032000
*                                                                  0090 00033000
*              /* INCREMENT ACB COUNTER BY 1                        */  00034000
*              RACBCNT = RACBCNT + 1;                              0091 00035000
*                                                                  0091 00036000
         AH    RACBCNT,@CH00127                                    0091 00037000
*NXTENTRY:     /* ADJUST POINTERS TO NEXT ENTRIES IN THE WTG TABLE  */  00038000
*              /* AND THE CLOSE PARAMETER LIST                      */  00039000
*                                                                  0092 00040000
*              RWTGC = RWTGC + 8;       /* NEXT ENTRY IN WTG TABLE  */  00041000
NXTENTRY LA    RWTGC,8(,RWTGC)                                     0092 00042000
*              RPARC = RPARC + 4;       /* NEXT ENTRY IN PARM LIST  */  00043000
         LA    RPARC,4(,RPARC)                                     0093 00044000
*              GO TO COUNT;             /* CHECK NEXT ENTRY         */  00045000
         B     COUNT                                               0094 00046000
*            END;                       /* END OF THIS LOAD PROCESS */  00047000
*          ELSE                         /* ID NOT THIS LOAD         */  00048000
*                                                                  0096 00049000
*            /* IS THIS THE END OF THE WTG TABLE ?                  */  00050000
*            IF WTGCID > '0A' & WTGCID < '0H'                      0096 00051000
*              THEN                     /* YES                      */  00052000
@RF00089 CLC   WTGCID(2,RWTGC),@CC00818                            0096 00053000
         BNH   @RF00096                                            0096 00054000
         CLC   WTGCID(2,RWTGC),@CC00819                            0096 00055000
         BL    @RT00096                                            0096 00056000
*                GO TO MAKELIST;        /* BUILD CLOSE PARM LIST    */  00057000
*                                                                  0097 00058000
*              ELSE                     /* NO - CONTINUE            */  00059000
*                GO TO NXTENTRY;        /* UPDATE POINTERS          */  00060000
         B     NXTENTRY                                            0098 00061000
*        /***********************************************************/  00062000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00063000
         EJECT                                                          00064000
*        /************************************************************/ 00065000
*        /*                                                          */ 00066000
*        /* OBTAIN CORE FOR AN ACB CLOSE PARAMETER LIST USING        */ 00067000
*        /* SUBPOOL 250 TO OBTAIN CORE IN USER KEY, SUBPOOL 0.       */ 00068000
*        /*                                                          */ 00069000
*        /************************************************************/ 00070000
*        RESPECIFY (RSIZE) RESTRICTED;                             0100 00071000
*MAKELIST:                                                         0101 00072000
*        /* CALCULATE THE SIZE NEEDED                               */  00073000
*        RSIZE = RACBCNT * 4;                                      0101 00074000
*                                                                  0101 00075000
MAKELIST LR    RSIZE,RACBCNT                                       0101 00076000
         SLA   RSIZE,2                                             0101 00077000
*        /* GET CORE FOR CLOSE LIST FROM USER AREA (VIA SUBPOOL 250) */ 00078000
*                                                                  0102 00079000
*        GEN (GETMAIN R,LV=(RSIZE),SP=250);/* ISSUE GETMAIN    Y02082*/ 00080000
         GETMAIN R,LV=(RSIZE),SP=250                                    00081000
*        RESPECIFY (RSIZE) UNRESTRICTED;                           0103 00082000
*                                                                  0103 00083000
*                                                                  0103 00084000
*        RCLOSE = R1;                   /* SAVE ADDRESS             */  00085000
         LR    RCLOSE,R1                                           0104 00086000
*        RCLOSEC = RCLOSE;              /* INIT'LIZE CURRENT ENTRY  */  00087000
*                                                                  0105 00088000
         LR    RCLOSEC,RCLOSE                                      0105 00089000
*        /* RESET POINTER TO FIRST ENTRY IN DCB CLOSE LIST          */  00090000
*        RPARC = RPAR;                                             0106 00091000
*                                                                  0106 00092000
         LR    RPARC,RPAR                                          0106 00093000
*        /* RESET POINTER TO FIRST ENTRY IN WTG TABLE               */  00094000
*        RWTGC = RWTG + 32;                                        0107 00095000
         LA    RWTGC,32(,RWTG)                                     0107 00096000
*                                                                  0108 00097000
*                                                                  0108 00098000
*        /***********************************************************/  00099000
*        /* DETERMINE WHETHER THIS MODULE IS TO PROCESS THE DCB     */  00100000
*        /* POINTED TO BY THE CURRENT ENTRY IN THE CLOSE PARAMETER  */  00101000
*        /* LIST.                                                   */  00102000
*        /***********************************************************/  00103000
*CHECKID:                                                          0108 00104000
*        /* DOES ID AT CURRENT ENTRY IN WTG TABLE INDICATE THIS     */  00105000
*        /* LOAD ?                                                  */  00106000
*                                                                  0108 00107000
*        IF WTGCID = '1W'                                          0108 00108000
*          THEN                         /* YES                      */  00109000
CHECKID  CLC   WTGCID(2,RWTGC),@CC00814                            0108 00110000
         BE    @RT00108                                            0108 00111000
*            GO TO QSAMDCB;             /* GO PROCESS DCB           */  00112000
*                                                                  0109 00113000
*          ELSE                         /* NO                       */  00114000
*            /* DOES ID INDICATE END OF WTG TABLE ?                 */  00115000
*            IF WTGCID > '0A' & WTGCID < '0H'                      0110 00116000
*              THEN                     /* YES                      */  00117000
         CLC   WTGCID(2,RWTGC),@CC00818                            0110 00118000
         BNH   @RF00110                                            0110 00119000
         CLC   WTGCID(2,RWTGC),@CC00819                            0110 00120000
         BL    @RT00110                                            0110 00121000
*                GO TO GIVCLOSE;        /* GO TO CLOSE ACB          */  00122000
*                                                                  0111 00123000
*                                                                  0111 00124000
*        /* ADJUST THE CURRENT POINTERS TO THE NEXT ENTRIES IN THE  */  00125000
*        /* WTG TABLE AND THE DCB CLOSE PARAMETER LIST.             */  00126000
*                                                                  0112 00127000
*NEXTDCB:                                                          0112 00128000
*        RWTGC = RWTGC + 8;             /* NEXT ENTRY IN WTG TABLE  */  00129000
@RF00110 DS    0H                                                  0112 00130000
NEXTDCB  LA    RWTGC,8(,RWTGC)                                     0112 00131000
*        RPARC = RPARC + 4;             /* NEXT ENTRY IN PARM LIST  */  00132000
*                                                                  0113 00133000
         LA    RPARC,4(,RPARC)                                     0113 00134000
*        GO TO CHECKID;                 /* GO CHECK ID              */  00135000
         B     CHECKID                                             0114 00136000
*        /***********************************************************/  00137000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00138000
         EJECT                                                          00139000
*        /************************************************************/ 00140000
*        /*                                                          */ 00141000
*        /* PERFORM CLOSE PROCESSING FOR CURRENT DCB-                */ 00142000
*        /*   1) ISSUE FINAL PUT FOR QSAM LOCATE MODE                */ 00143000
*        /*   2) DELETE PROCESSING MODULES                           */ 00144000
*        /*   3) RESTORE MISC. DCB FIELDS TO PREOPEN STATUS          */ 00145000
*        /*   4) PUT ADDRESS OF RELATED ACB INTO ACB CLOSE LIST      */ 00146000
*        /*   5) SAVE THE DCB MODIFICATION MASK FOR IOS CLOSE        */ 00147000
*        /*                                                          */ 00148000
*        /************************************************************/ 00149000
*                                                                  0116 00150000
*                                                                  0116 00151000
*                                                                  0116 00152000
*QSAMDCB:                               /* BEGIN DCB PROCESSING      */ 00153000
*                                                                  0116 00154000
*        RCORE = WTGCWA;                /* IOS WORK AREA BASE  Y02082*/ 00155000
*                                                                  0116 00156000
QSAMDCB  SLR   RCORE,RCORE                                         0116 00157000
         ICM   RCORE,7,WTGCWA(RWTGC)                               0116 00158000
*        /************************************************************/ 00159000
*        /* SET USER KEY TO REFERENCE FIELDS IN CICB                 */ 00160000
*        /************************************************************/ 00161000
*                                                                  0117 00162000
*        RUKEY = DXUKEY;                /* USER KEY            Y02082*/ 00163000
         SLR   RUKEY,RUKEY                                         0117 00164000
         IC    RUKEY,DXUKEY(,RCORE)                                0117 00165000
*        GEN (MODESET KEYADDR=(2));     /* CHANGE KEY          Y02082*/ 00166000
*                                                                  0118 00167000
         MODESET KEYADDR=(2)                                            00168000
*        RDCB = PARCDCB;                /* COPY DCB BASE      YM03006*/ 00169000
         L     RDCB,PARCDCB(,RPARC)                                0119 00170000
*        RCICB = DCBCICB;               /* CICB BASE          YM03006*/ 00171000
*                                                                  0120 00172000
         L     RCICB,DCBCICB(,RDCB)                                0120 00173000
*        /* INDICATE THAT CI CLOSE IS PROCESSING              XA00008*/ 00174000
*        CIFCLOSE = '1'B;               /* CLOSE BIT NOW ON   XA00008*/ 00175000
*                                                                  0121 00176000
         OI    CIFCLOSE(RCICB),B'01000000'                         0121 00177000
*        /************************************************************/ 00178000
*        /* ISSUE FINAL PUT FOR QSAM LOCATE MODE                     */ 00179000
*        /************************************************************/ 00180000
*                                                                  0122 00181000
*        /* IS QSAM PUT LOCATE SPECIFIED ?                          */  00182000
*        IF DCBMACRF(13)  = '1'B & DCBMACRF(10)  = '1'B            0122 00183000
*          THEN                         /* YES                      */  00184000
         TM    DCBMACRF+1(RDCB),B'01001000'                        0122 00185000
         BNO   @RF00122                                            0122 00186000
*            DO;                                                   0123 00187000
*                                                                  0123 00188000
*              /* IS THIS THE FIRST PUT ISSUED ?                    */  00189000
*              IF CIFFSTP = '0'B                                   0124 00190000
*                THEN                   /* YES - FIRST PASS         */  00191000
         TM    CIFFSTP(RCICB),B'10000000'                          0124 00192000
         BZ    @RT00124                                            0124 00193000
*                  GO TO DELETMOD;      /* GO DELETE MODULE         */  00194000
*                                                                  0125 00195000
*              /* CHECK ERROR INDICATORS FOR ANY ERRORS             */  00196000
*              GEN (TM    DCBCIND2(RDCB),HEX10);                   0126 00197000
         TM    DCBCIND2(RDCB),HEX10                                     00198000
*              GEN (BC    5,DELETMOD);                             0127 00199000
*                                                                  0127 00200000
         BC    5,DELETMOD                                               00201000
*              IF TCBFLAG1(1) = '1'B THEN/*                        0128 00202000
*                                          ABEND IN PROGRESS  XM0663*/  00203000
         L     @11,CVTPTR                                          0128 00204000
         L     @11,CVTTCBDW(,@11)                                  0128 00205000
         L     @11,TCBPTR(,@11)                                    0128 00206000
         TM    TCBFLAG1(@11),B'10000000'                           0128 00207000
         BO    @RT00128                                            0128 00208000
*                GOTO DELETMOD;         /* YES-SKIP LAST PUT  XM0663*/  00209000
*                                                                  0129 00210000
*              /* SAVE OWN REGS IN EXTENDED SAVE AREA OF SVRB       */  00211000
*              RESPECIFY (RSVRB) RESTRICTED;                       0130 00212000
*              RSVRB = THISSVRB;        /* ADDR OF SVRB CREATED     */  00213000
         L     RSVRB,THISSVRB(,@11)                                0131 00214000
*                                       /* WHEN CLOSE WAS ISSUED    */  00215000
*                                                                  0132 00216000
*              /******************************************************/ 00217000
*              /* SUPERVISOR KEY REQ TO REF SVRB SAVE AREA           */ 00218000
*              /******************************************************/ 00219000
*                                                                  0132 00220000
*              GEN (MODESET EXTKEY=ZERO);/* TO KEY ZERO        Y02082*/ 00221000
*                                                                  0132 00222000
         MODESET EXTKEY=ZERO                                            00223000
*              GEN (STM   @2,@D,96(RSVRB));                        0133 00224000
*                                                                  0133 00225000
         STM   @2,@D,96(RSVRB)                                          00226000
*              /* GET ADDR OF PUT ROUTINE ENTRY POINT FOR CLOSE     */  00227000
*              R15 = DCBPUT;                                       0134 00228000
*                                                                  0134 00229000
         SLR   R15,R15                                             0134 00230000
         ICM   R15,7,DCBPUT(RDCB)                                  0134 00231000
*              /* POINT REG 13 TO CI SAVE AREA               XA00008*/  00232000
*              GEN (LA    @D,CIREGSAV(,RCICB));            /*XA00008*/  00233000
*                                                                  0135 00234000
         LA    @D,CIREGSAV(,RCICB)                                      00235000
*              R1 = DXUDCBAD;           /* POINT TO REAL DCB   Y02082*/ 00236000
*                                                                  0136 00237000
         L     R1,DXUDCBAD(,RCORE)                                 0136 00238000
*              /*****************************************************/  00239000
*              /* EXIT TO PUT ROUTINE                               */  00240000
*              /*****************************************************/  00241000
*                                                                  0137 00242000
*              GEN (SYNCH (15));                                   0137 00243000
*                                                                  0137 00244000
         SYNCH (15)                                                     00245000
*              /* RESTORE REGS UPON RETURN FROM PUT ROUTINE         */  00246000
*              RSVRB = THISSVRB;        /* ADDR OF SVRB             */  00247000
         L     @11,CVTPTR                                          0138 00248000
         L     @11,CVTTCBDW(,@11)                                  0138 00249000
         L     @11,TCBPTR(,@11)                                    0138 00250000
         L     RSVRB,THISSVRB(,@11)                                0138 00251000
*              GEN (LM    @2,@D,96(RSVRB));                        0139 00252000
         LM    @2,@D,96(RSVRB)                                          00253000
*              RESPECIFY (RSVRB) UNRESTRICTED;                     0140 00254000
*            END;                       /* END OF QSAM PUT LOCATE   */  00255000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00256000
@RF00122 DS    0H                                                  0142 00257000
         EJECT                                                          00258000
*        /***********************************************************/  00259000
*        /*                                                         */  00260000
*        /* DELETE PROCESSING MODULES                               */  00261000
*        /*                                                         */  00262000
*        /***********************************************************/  00263000
*DELETMOD:                                                         0143 00264000
*                                                                  0143 00265000
*        /************************************************************/ 00266000
*        /* SET DATA MANAGEMENT KEY TO REFERENCE THE WTG TABLE       */ 00267000
*        /************************************************************/ 00268000
*                                                                  0143 00269000
*        GEN (MODESET EXTKEY=DATAMGT);  /* SET DM KEY          Y02082*/ 00270000
*                                                                  0143 00271000
DELETMOD MODESET EXTKEY=DATAMGT                                         00272000
*        /* IS QSAM SPECIFIED ?                                     */  00273000
*        IF DCBMACRF(2)   = '1'B | DCBMACRF(10)  = '1'B            0144 00274000
*          THEN                         /* YES                      */  00275000
         TM    DCBMACRF(RDCB),B'01000000'                          0144 00276000
         BO    @RT00144                                            0144 00277000
         TM    DCBMACRF+1(RDCB),B'01000000'                        0144 00278000
         BNO   @RF00144                                            0144 00279000
@RT00144 DS    0H                                                  0145 00280000
*            WTGMDNAM = 'IGG019DJ';     /* DELETE CI QSAM MODULE    */  00281000
*                                                                  0145 00282000
         MVC   WTGMDNAM(8,RWTG),@CC00833                           0145 00283000
*          ELSE                         /* NO                       */  00284000
*            WTGMDNAM = 'IGG019DK';     /* DELETE CI BSAM MODULE    */  00285000
*                                                                  0146 00286000
         B     @RC00144                                            0146 00287000
@RF00144 MVC   WTGMDNAM(8,RWTG),@CC00834                           0146 00288000
*        GEN (DELETE EPLOC=(RWTG));     /* DELETE MODULE            */  00289000
@RC00144 DS    0H                                                  0147 00290000
         DELETE EPLOC=(RWTG)                                            00291000
*        WTGMDNAM = 'IGG0201W';         /* RESTORE THIS MOD NAME    */  00292000
*                                                                  0148 00293000
*                                                                  0148 00294000
         MVC   WTGMDNAM(8,RWTG),@CC00835                           0148 00295000
*        IF DEBACCS = '0000'B   |       /* TEST OPEN OPTION   YM03006*/ 00296000
*           DEBACCS = '0011'B THEN      /* FOR INPUT DCB      YM03006*/ 00297000
         SLR   @11,@11                                             0149 00298000
         ICM   @11,7,DCBDEBAD(RDCB)                                0149 00299000
         TM    DEBACCS(@11),B'00001111'                            0149 00300000
         BZ    @RT00149                                            0149 00301000
         TM    DEBACCS(@11),B'00000011'                            0149 00302000
         BNO   @RF00149                                            0149 00303000
         TM    DEBACCS(@11),B'00001100'                            0149 00304000
         BNZ   @RF00149                                            0149 00305000
@RT00149 DS    0H                                                  0150 00306000
*          DO;                                                     0150 00307000
*                                                                  0150 00308000
*              /*****************************************************/  00309000
*              /* CHECK FOR CONCATENATION TO DETERMINE IF BSAM      */  00310000
*              /* CHECK OR QSAM GERR MODULE IS NOT TO BE DELETED    */  00311000
*              /*****************************************************/  00312000
*                                                                  0151 00313000
*              /* CONCATENATED DATA SETS ?                          */  00314000
*              IF DCBOFLGS(3) = '0'B                               0151 00315000
*                THEN                   /* NO CONCATENATION         */  00316000
         TM    DCBOFLGS(RDCB),B'00100000'                          0151 00317000
         BNZ   @RF00151                                            0151 00318000
*                  DO;                                             0152 00319000
*                                                                  0152 00320000
*                    /* IS QSAM SPECIFIED ?                         */  00321000
*                    IF DCBMACRF(2)   = '1'B                       0153 00322000
*                      THEN             /* YES                      */  00323000
*                                                                  0153 00324000
         TM    DCBMACRF(RDCB),B'01000000'                          0153 00325000
         BNO   @RF00153                                            0153 00326000
*                        /* QSAM GERR MODULE NAME TO DELETE         */  00327000
*                        WTGMDNAM = 'IGG019AQ';                    0154 00328000
*                                                                  0154 00329000
         MVC   WTGMDNAM(8,RWTG),@CC00838                           0154 00330000
*                      ELSE             /* NO                       */  00331000
*                                                                  0155 00332000
*                        /* BSAM CHECK MODULE NAME TO DELETE        */  00333000
*                        WTGMDNAM = 'IGG019BB';                    0155 00334000
*                                                                  0155 00335000
         B     @RC00153                                            0155 00336000
@RF00153 MVC   WTGMDNAM(8,RWTG),@CC00839                           0155 00337000
*                    /* DELETE MODULE                               */  00338000
*                    GEN (DELETE EPLOC=(RWTG));                    0156 00339000
*                                                                  0156 00340000
@RC00153 DS    0H                                                  0156 00341000
         DELETE EPLOC=(RWTG)                                            00342000
*                    /* RESTORE THIS MODULES NAME                   */  00343000
*                    WTGMDNAM = 'IGG0201W';                        0157 00344000
*                                                                  0157 00345000
         MVC   WTGMDNAM(8,RWTG),@CC00835                           0157 00346000
*                  END;                 /* END OF NO CONCAT         */  00347000
*          END;                         /* END OF OPENED FOR INPUT  */  00348000
@RF00151 DS    0H                                                  0160 00349000
*        /***********************************************************/  00350000
*                                                                  0160 00351000
*                                                                  0160 00352000
*                                                                  0160 00353000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00354000
@RF00149 DS    0H                                                  0160 00355000
         EJECT                                                          00356000
*        /***********************************************************/  00357000
*        /*                                                         */  00358000
*        /* PERFORM HOUSEKEEPING FUNCTIONS ON THE DCB               */  00359000
*        /*                                                         */  00360000
*        /***********************************************************/  00361000
*COMRESET:                                                         0161 00362000
*                                                                  0161 00363000
*        /************************************************************/ 00364000
*        /* ASSUME USER KEY TO RESTORE USERS DCB (REAL DCB)          */ 00365000
*        /************************************************************/ 00366000
*                                                                  0161 00367000
*        RUKEY = DXUKEY;                /* USER KEY IN REG 2   Y02082*/ 00368000
COMRESET SLR   RUKEY,RUKEY                                         0161 00369000
         IC    RUKEY,DXUKEY(,RCORE)                                0161 00370000
*        GEN (MODESET KEYADDR=(2));     /* SET USER KEY        Y02082*/ 00371000
*                                                                  0162 00372000
         MODESET KEYADDR=(2)                                            00373000
*        RDCB = DXUDCBAD;               /* CHANGE DCB BASE TO YM03006   00374000
*                                       ADDRESS REAL DCB FOR RESTORE */ 00375000
         L     RDCB,DXUDCBAD(,RCORE)                               0163 00376000
*        RCICB = DCBCICB;               /* CICB BASE          YM03006*/ 00377000
*                                                                  0164 00378000
         L     RCICB,DCBCICB(,RDCB)                                0164 00379000
*        /* DATA SET ORG MERGED                                     */  00380000
*        IF CIFMDSOR = '1'B THEN                                   0165 00381000
         TM    CIFMDSOR(RCICB),B'10000000'                         0165 00382000
         BNO   @RF00165                                            0165 00383000
*             DCBDSORG = '00'X;         /* CLEAR IT OUT             */  00384000
*                                                                  0166 00385000
         MVI   DCBDSORG+1(RDCB),X'00'                              0166 00386000
         MVI   DCBDSORG(RDCB),X'00'                                0166 00387000
*        /* RESET DEVICE TYPE TO WHATEVER IT WAS                    */  00388000
*        DCBDEVTY = CIFLAG2 & '01100000'B;                         0167 00389000
*                                                                  0167 00390000
@RF00165 LA    @11,96                                              0167 00391000
         SLR   @04,@04                                             0167 00392000
         IC    @04,CIFLAG2(,RCICB)                                 0167 00393000
         NR    @11,@04                                             0167 00394000
         STC   @11,DCBDEVTY(,RDCB)                                 0167 00395000
*        DCBGET = 1;                    /* CLEAR GET/PUT ADDR YM03006*/ 00396000
         LA    @11,1                                               0168 00397000
         STCM  @11,7,DCBGET(RDCB)                                  0168 00398000
*        DCBCNTRL = 1;                  /* CLEAR CNTRL ADDR   YM03006*/ 00399000
*                                                                  0169 00400000
         STCM  @11,7,DCBCNTRL(RDCB)                                0169 00401000
*        RESPECIFY (RRPL) RESTRICTED;   /* RESTRICT THE REG  ZA02194*/  00402000
*        RRPL = ADDR(CIRPL);            /* RPL BASE          ZA02194*/  00403000
         LA    RRPL,CIRPL(,RCICB)                                  0171 00404000
*        RESPECIFY IFGRPL BASED (RRPL); /*                   ZA02194*/  00405000
*        IF DCBCIND2(8) = '1'B THEN     /* IS IT A QSAM DCB  ZA02194*/  00406000
         TM    DCBCIND2(RDCB),B'00000001'                          0173 00407000
         BNO   @RF00173                                            0173 00408000
*          IF DCBMACRF(5)   = '1'B | DCBMACRF(13)  = '1'B THEN/*   0174 00409000
*                                          LOCATE MODE       ZA02194*/  00410000
         TM    DCBMACRF(RDCB),B'00001000'                          0174 00411000
         BO    @RT00174                                            0174 00412000
         TM    DCBMACRF+1(RDCB),B'00001000'                        0174 00413000
         BNO   @RF00174                                            0174 00414000
@RT00174 DS    0H                                                  0175 00415000
*             IF DCBRECFM(1:2) = '01'B  /* VARIABLE          ZA02194*/  00416000
*               & DCBRECFM(5)   = '1'B THEN;/*                     0175 00417000
*                                          SPANNED RECORDS   ZA02194*/  00418000
         TM    DCBRECFM(RDCB),B'01000000'                          0175 00419000
         BNO   @RF00175                                            0175 00420000
         TM    DCBRECFM(RDCB),B'10000000'                          0175 00421000
         BNZ   @RF00175                                            0175 00422000
         TM    DCBRECFM(RDCB),B'00001000'                          0175 00423000
         BO    @RT00175                                            0175 00424000
*             ELSE DO;                  /*  NO,             @ZA05592*/  00425000
@RF00175 DS    0H                                                  0178 00426000
*                                       /* BUFFER ADDR      @ZA05592*/  00427000
*           END;                        /*                  @ZA05592*/  00428000
*          ELSE;                        /* NOT LOCATE        ZA02194*/  00429000
@RF00174 DS    0H                                                  0180 00430000
*        ELSE;                          /* NOT A QSAM DCB    ZA02194*/  00431000
@RF00173 DS    0H                                                  0181 00432000
*        RESPECIFY (RRPL) UNRESTRICTED; /* UNRESTRICT THE REG ZA2194*/  00433000
*                                                                  0181 00434000
@RC00173 DS    0H                                                  0182 00435000
*        IF DCBOFLGS(3) = '0'B   THEN   /* TEST NO CONCATENATION     */ 00436000
         TM    DCBOFLGS(RDCB),B'00100000'                          0182 00437000
         BNZ   @RF00182                                            0182 00438000
*          DCBGERR = 1;                 /* NO, SO CLEAR THE   YM03006   00439000
*                                          CHECK/GERR ADDRESS        */ 00440000
         MVC   DCBGERR(3,RDCB),@CF00127+1                          0183 00441000
*        ELSE                           /* CONCATENATION      XM6068*/  00442000
*          DO;                          /*                    XM6068*/  00443000
         B     @RC00182                                            0184 00444000
@RF00182 DS    0H                                                  0185 00445000
*            IF DCBCIND2(8) = '1'B/*                               0185 00446000
*                                          DCB MUST BE        XM6068*/  00447000
*                                       /* FOR QSAM           XM6068*/  00448000
*            & DCBCIND2(5) = '1'B THEN  /* OPEN MUST HAVE     XM6068*/  00449000
         TM    DCBCIND2(RDCB),B'00001001'                          0185 00450000
         BNO   @RF00185                                            0185 00451000
*                                       /* GOTTEN BUFFERS     XM6068*/  00452000
*              DO;                      /*                    XM6068*/  00453000
*                R1 = RDCB;             /* GIVE DCB ADDR      XM6068*/  00454000
         LR    R1,RDCB                                             0187 00455000
*                GEN (FREEPOOL (1));    /* FREE THE BFR POOL  XM6068*/  00456000
         FREEPOOL (1)                                                   00457000
*                RCICB =DCBCICB;        /* RESTORE CICB BASE XA01536*/  00458000
         L     RCICB,DCBCICB(,RDCB)                                0189 00459000
*              END;                     /*                    XM6068*/  00460000
*            ELSE;                      /*                    XM6068*/  00461000
@RF00185 DS    0H                                                  0192 00462000
*          END;                         /*                    XM6068*/  00463000
*                                                                  0192 00464000
*        DCBCIND1(5)   = '0'B;          /* TURN OFF CI BIT           */ 00465000
@RC00182 NI    DCBCIND1(RDCB),B'11110111'                          0193 00466000
*        DCBCIND2(8) = '0'B;            /* TURN OFF QSAM BIT  XA01811*/ 00467000
*                                                                  0194 00468000
         NI    DCBCIND2(RDCB),B'11111110'                          0194 00469000
*        DCBSVCXL = 1;                  /* CLEAR SVC LIST PTR YM03006*/ 00470000
         LA    @11,1                                               0195 00471000
         ST    @11,DCBSVCXL(,RDCB)                                 0195 00472000
*        DCBCICB = 1;                   /* CLEAR CICB PTR     YM03006*/ 00473000
         ST    @11,DCBCICB(,RDCB)                                  0196 00474000
*                                       /* NOTE: WE CAN STILL GET CICB  00475000
*                                          PTR FROM THE DCB COPY     */ 00476000
*                                                                  0197 00477000
*        /************************************************************/ 00478000
*        /*                                                          */ 00479000
*        /* PUT ACB ADDRESS FOR THIS DCB INTO THE ACB CLOSE LIST,    */ 00480000
*        /* AND SAVE THE DCB MODIFICATION MASK FROM THE DEB          */ 00481000
*        /* EXTENSION IN THE IOS WORK AREA FOR IOS CLOSE.            */ 00482000
*        /*                                                          */ 00483000
*        /************************************************************/ 00484000
*                                                                  0197 00485000
*        CLOSEACB = ADDR (CIACBD);      /* STORE ADDR OF THE ACB   0197 00486000
*                                          IN THE NEW CLOSE        0197 00487000
*                                          PARAMETER LIST           */  00488000
         LA    @11,CIACBD(,RCICB)                                  0197 00489000
         ST    @11,CLOSEACB(,RCLOSEC)                              0197 00490000
*        /* SET THE CLOSE OPTION TO INDICATE NO OPTION              */  00491000
*        CLOSEOPT = '00'X;                                         0198 00492000
*                                                                  0198 00493000
         MVI   CLOSEOPT(RCLOSEC),X'00'                             0198 00494000
*        /************************************************************/ 00495000
*        /* RETURN TO DATA MANAGEMENT KEY                            */ 00496000
*        /************************************************************/ 00497000
*                                                                  0199 00498000
*        GEN (MODESET EXTKEY=DATAMGT);  /* SET DM KEY          Y02082*/ 00499000
*                                                                  0199 00500000
         MODESET EXTKEY=DATAMGT                                         00501000
*        /* REINSTATE DCB BASE TO ADDRESS THE COPY DCB SO WE PICK UP */ 00502000
*        /* PROTECTED DEB POINTER THAT HAS BEEN DEBCHECKED.          */ 00503000
*        RDCB = PARCDCB;                /* RESET DCB BASE     YM03006*/ 00504000
*                                                                  0200 00505000
         L     RDCB,PARCDCB(,RPARC)                                0200 00506000
*        /* SAVE DCB MODIF MASK IN 1ST WORD OF OPEN WORK AREA        */ 00507000
*        FWOPWA = DEBXTNPT -> DEBXDCBM; /* MASK FROM DEB EXTN  Y02134*/ 00508000
         ICM   @11,7,WTGCWA(RWTGC)                                 0201 00509000
         ICM   @04,7,DCBDEBAD(RDCB)                                0201 00510000
         AL    @04,@CF00862                                        0201 00511000
         L     @04,DEBXTNPT+8(,@04)                                0201 00512000
         MVC   FWOPWA(4,@11),DEBXDCBM(@04)                         0201 00513000
*        ATFMDMSK = '1'B;               /* DENOTE MASK SAVED   Y02144*/ 00514000
*                                                                  0202 00515000
         OI    ATFMDMSK(RCORE),B'10000000'                         0202 00516000
*        /* CLEAR MODIFICATION MASK TO PREVENT DEMERGE ON ACB        */ 00517000
*        DEBXTNPT -> DEBXDCBM = 0;      /* CLEAR DEB EXTN MASK Y02134*/ 00518000
*                                                                  0203 00519000
         SLR   @11,@11                                             0203 00520000
         ST    @11,DEBXDCBM(,@04)                                  0203 00521000
*        /* UPDATE PARAMETER LIST AND WTG TABLE POINTERS            */  00522000
*        RWTGC = RWTGC + 8;                                        0204 00523000
         LA    RWTGC,8(,RWTGC)                                     0204 00524000
*        RPARC = RPARC + 4;                                        0205 00525000
*                                                                  0205 00526000
         LA    @11,4                                               0205 00527000
         ALR   RPARC,@11                                           0205 00528000
*        /* UPDATE POINTER TO NEXT ENTRY IN ACB CLOSE LIST          */  00529000
*        RCLOSEC = RCLOSEC + 4;                                    0206 00530000
*                                                                  0206 00531000
*                                                                  0206 00532000
         ALR   RCLOSEC,@11                                         0206 00533000
*        GO TO CHECKID;                 /* GO PROCESS NEXT DCB      */  00534000
*                                                                  0207 00535000
         B     CHECKID                                             0207 00536000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00537000
         EJECT                                                          00538000
*        /***********************************************************/  00539000
*        /*                                                         */  00540000
*        /* ISSUE A CLOSE ON THE ACB LIST                           */  00541000
*        /*                                                         */  00542000
*        /***********************************************************/  00543000
*                                                                  0209 00544000
*        /* POINT TO LAST ENTRY IN ACB CLOSE LIST ONCE EACH DCB IN  */  00545000
*        /* IN CLOSE LIST HAS BEEN PROCESSED.                       */  00546000
*GIVCLOSE:                                                         0209 00547000
*        RCLOSEC = RCLOSEC - 4;                                    0209 00548000
*                                                                  0209 00549000
GIVCLOSE SH    RCLOSEC,@CH00147                                    0209 00550000
*        /************************************************************/ 00551000
*        /* USER KEY REQUIRED TO REFERENCE FIELDS IN ACB CLOSE LIST  */ 00552000
*        /************************************************************/ 00553000
*                                                                  0210 00554000
*        RUKEY = DXUKEY;                /* USER KEY IN REG 2   Y02082*/ 00555000
         SLR   RUKEY,RUKEY                                         0210 00556000
         IC    RUKEY,DXUKEY(,RCORE)                                0210 00557000
*        GEN (MODESET KEYADDR=(2));     /* TO USER KEY         Y02082*/ 00558000
*                                                                  0211 00559000
         MODESET KEYADDR=(2)                                            00560000
*        /* INDICATE THE LAST ENTRY IN LIST                         */  00561000
*        CLOSEOPT (1) = '1'B;                                      0212 00562000
         OI    CLOSEOPT(RCLOSEC),B'10000000'                       0212 00563000
*        R1 = RCLOSE;                   /* LOAD PARM REGISTER       */  00564000
*                                                                  0213 00565000
         LR    R1,RCLOSE                                           0213 00566000
*        /***********************************************************/  00567000
*        /* ISSUE A CLOSE ON THE ACB LIST                           */  00568000
*        /***********************************************************/  00569000
*                                                                  0214 00570000
*        GEN (SVC   20);                                           0214 00571000
*                                                                  0214 00572000
         SVC   20                                                       00573000
*        /* CALCULATE CORE USED FOR CLOSE LIST                      */  00574000
*        RESPECIFY (RSIZE) RESTRICTED;                             0215 00575000
*        RSIZE = ((RCLOSEC + 4) - RCLOSE);                         0216 00576000
*                                                                  0216 00577000
         LA    RSIZE,4                                             0216 00578000
         ALR   RSIZE,RCLOSEC                                       0216 00579000
         SLR   RSIZE,RCLOSE                                        0216 00580000
*        /* FREE CORE USED FOR CLOSE LIST                           */  00581000
*        GEN (FREEMAIN R,LV=(RSIZE),A=(RCLOSE),SP=250);            0217 00582000
         FREEMAIN R,LV=(RSIZE),A=(RCLOSE),SP=250                        00583000
*        RESPECIFY (RSIZE) UNRESTRICTED;                           0218 00584000
*        /***********************************************************/  00585000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00586000
         EJECT                                                          00587000
*        /***********************************************************/  00588000
*        /*                                                         */  00589000
*        /* UPDATE WTG TABLE FOR EACH ENTRY INDICATING THIS LOAD    */  00590000
*        /*                                                         */  00591000
*        /***********************************************************/  00592000
*                                                                  0220 00593000
*        /* RESET POINTER TO FIRST ENTRY IN WTG TABLE               */  00594000
*        RWTGC = RWTG + 32;                                        0220 00595000
*                                                                  0220 00596000
         LA    RWTGC,32(,RWTG)                                     0220 00597000
*        /* RESET POINTER TO FIRST DCB IN CLOSE LIST                */  00598000
*        RPARC = RPAR;                                             0221 00599000
*                                                                  0221 00600000
         LR    RPARC,RPAR                                          0221 00601000
*        /************************************************************/ 00602000
*        /* ESTABLISH DATA MANAGEMENT KEY FOR THIS ROUTINE           */ 00603000
*        /************************************************************/ 00604000
*                                                                  0222 00605000
*        GEN (MODESET EXTKEY=DATAMGT);  /* SET DM KEY         YM03006*/ 00606000
*                                                                  0222 00607000
         MODESET EXTKEY=DATAMGT                                         00608000
*ZROID:  /* CHECK WHETHER ID OF CURRENT ENTRY IN WTG TABLE IS ID FOR*/  00609000
*        /* THIS LOAD, AND IF SO, THEN ZERO OUT ID TO INDICATE END  */  00610000
*        /* OF PROCESSING FOR THIS ENTRY.                           */  00611000
*                                                                  0223 00612000
*        /* DOES ID INDICATE THIS LOAD ?                            */  00613000
*        IF WTGCID = '1W'                                          0223 00614000
*          THEN                         /* YES                      */  00615000
ZROID    CLC   WTGCID(2,RWTGC),@CC00814                            0223 00616000
         BNE   @RF00223                                            0223 00617000
*            DO;                                                   0224 00618000
*              RCORE = WTGCWA;          /* IOS WORK AREA BASE YM03006*/ 00619000
         SLR   RCORE,RCORE                                         0225 00620000
         ICM   RCORE,7,WTGCWA(RWTGC)                               0225 00621000
*              RUKEY = DXUKEY;          /* USERS PROTECT KEY  YM03006*/ 00622000
         SLR   RUKEY,RUKEY                                         0226 00623000
         IC    RUKEY,DXUKEY(,RCORE)                                0226 00624000
*              GEN (MODESET KEYADDR=(2));/* SET USER KEY      YM03006*/ 00625000
*                                                                  0227 00626000
         MODESET KEYADDR=(2)                                            00627000
*              RDCB = PARCDCB;          /* SET BASE FOR DCB(COPY)    */ 00628000
         L     RDCB,PARCDCB(,RPARC)                                0228 00629000
*              RCICB = DCBCICB;         /* SET BASE FOR CICB         */ 00630000
*                                                                  0229 00631000
         L     RCICB,DCBCICB(,RDCB)                                0229 00632000
*                                       /* NOTE: ALTHOUGH CICB PTR 0230 00633000
*                                       WAS CLEARED IN THE REAL DCB,    00634000
*                                       IT IS AVAIL HERE IN THE COPY.*/ 00635000
*                                                                  0230 00636000
*              IF CIFRAGM = '1'B        /* SPANNED RECORDS ?        */  00637000
*                THEN                   /* YES, REC AREA EXISTS     */  00638000
         TM    CIFRAGM(RCICB),B'00100000'                          0230 00639000
         BNO   @RF00230                                            0230 00640000
*                  DO;                  /* FREE THE RECORD AREA     */  00641000
*                    XCTLREG = CILWAREA;/* REC AREA SIZE            */  00642000
         L     XCTLREG,CILWAREA(,RCICB)                            0232 00643000
*                GEN (LA XCTLREG,0(XCTLREG)); /*CLR HI BYTE @ZA07625*/  00644000
         LA XCTLREG,0(XCTLREG)                                          00645000
*                    R1 = CIRAREA;      /* REC AREA ADDRESS         */  00646000
         L     R1,CIRAREA(,RCICB)                                  0234 00647000
*                                       /* NOTE, CICB BASE IS LOST  */  00648000
*                                       /* ACROSS FREEMAIN (R1)     */  00649000
*                    GEN (FREEMAIN R,LV=(XCTLREG),A=(R1),SP=0);/*  0235 00650000
*                                          FREE REC AREA       YM4641*/ 00651000
         FREEMAIN R,LV=(XCTLREG),A=(R1),SP=0                            00652000
*                    RCICB = DCBCICB;   /* RESTORE CICB BASE        */  00653000
         L     RCICB,DCBCICB(,RDCB)                                0236 00654000
*                  END;                 /* END SPANNED RECORDS      */  00655000
*                                                                  0237 00656000
*              /* FREE CORE USED FOR CICB                           */  00657000
*  /*********************************************************@ZA29473*/ 00658000
*  /* TEST FOR PSEUDO IOBS AND IF FOUND - FREE THEM          @ZA29473*/ 00659000
*  /*********************************************************@ZA29473*/ 00660000
*                                                  /*        @ZA29473*/ 00661000
*                                                  /*        @ZA29473*/ 00662000
*     IF CIRESID > CINXTIOB THEN DO;               /*        @ZA29473*/ 00663000
@RF00230 CLC   CIRESID(4,RCICB),CINXTIOB(RCICB)                    0238 00664000
         BNH   @RF00238                                            0238 00665000
*     XCTLREG = LENGTH(IFGJCICB) + (DCBNCP * 32);  /*        @ZA29473*/ 00666000
         SLR   XCTLREG,XCTLREG                                     0240 00667000
         IC    XCTLREG,DCBNCP(,RDCB)                               0240 00668000
         SLA   XCTLREG,5                                           0240 00669000
         LA    XCTLREG,356(,XCTLREG)                               0240 00670000
*     GO TO FREECICB;                              /*        @ZA29473*/ 00671000
         B     FREECICB                                            0241 00672000
*                   END;                           /*        @ZA29473*/ 00673000
*              XCTLREG = LENGTH(IFGJCICB);                         0243 00674000
@RF00238 LA    XCTLREG,356                                         0243 00675000
*  FREECICB:                                       /*        @ZA29473*/ 00676000
*              GEN (FREEMAIN R,LV=(XCTLREG),A=(RCICB),SP=250);     0244 00677000
*                                                                  0244 00678000
FREECICB FREEMAIN R,LV=(XCTLREG),A=(RCICB),SP=250                       00679000
*              GEN (MODESET EXTKEY=DATAMGT);/* RESTORE DM KEY  Y02082*/ 00680000
         MODESET EXTKEY=DATAMGT                                         00681000
*              ATFCICBF = '1'B;         /* DENOTE CICB FREED   Y02144*/ 00682000
*                                                                  0246 00683000
         OI    ATFCICBF(RCORE),B'01000000'                         0246 00684000
*              XCTLREG = ADDR(IBMCLOSE);/* ENTRY IN XCTL TABLE      */  00685000
*                                                                  0247 00686000
         LA    XCTLREG,IBMCLOSE                                    0247 00687000
*              /* ZERO OUT ID FOR THIS ENTRY IN WTG TABLE           */  00688000
*              WTGCID = XCTLID;                                    0248 00689000
*                                                                  0248 00690000
         MVC   WTGCID(2,RWTGC),XCTLID(XCTLREG)                     0248 00691000
*              /* ZERO OUT TTR FOR THIS ENTRY IN WTG TABLE          */  00692000
*              WTGCTTR = XCTLTTR;                                  0249 00693000
*                                                                  0249 00694000
*                                                                  0249 00695000
         MVC   WTGCTTR(3,RWTGC),XCTLTTR(XCTLREG)                   0249 00696000
*            END;                       /* END OF THISLOAD GROUP    */  00697000
*          ELSE;                        /* NOT THIS LOAD            */  00698000
*                                                                  0251 00699000
@RF00223 DS    0H                                                  0252 00700000
*        /* DOES ID INDICATE END OF WTG TABLE ?                     */  00701000
*        IF WTGCID > '0A' & WTGCID < '0H'                          0252 00702000
*          THEN                         /* YES                      */  00703000
         CLC   WTGCID(2,RWTGC),@CC00818                            0252 00704000
         BNH   @RF00252                                            0252 00705000
         CLC   WTGCID(2,RWTGC),@CC00819                            0252 00706000
         BL    @RT00252                                            0252 00707000
*            GO TO TRANSFER;            /* GO TRANSFER CONTROL      */  00708000
*                                                                  0253 00709000
*        /* POINT TO NEXT ENTRY IN WTG TABLE                        */  00710000
*        RWTGC = RWTGC + 8;                                        0254 00711000
*                                                                  0254 00712000
@RF00252 LA    RWTGC,8(,RWTGC)                                     0254 00713000
*        /* POINT TO NEXT ENTRY IN CLOSE PARAMETER LIST             */  00714000
*        RPARC = RPARC + 4;                                        0255 00715000
*                                                                  0255 00716000
         LA    RPARC,4(,RPARC)                                     0255 00717000
*        GO TO ZROID;                   /* CHECK NEXT ENTRY         */  00718000
         B     ZROID                                               0256 00719000
*        /***********************************************************/  00720000
*        GEN   (EJECT);                 /* SKIP TO A NEW PAGE       */  00721000
         EJECT                                                          00722000
*        /***********************************************************/  00723000
*        /*                                                         */  00724000
*        /* TRANSFER CONTROL TO THE NEXT LOAD INDICATED IN WTG TABLE*/  00725000
*        /*                                                         */  00726000
*        /***********************************************************/  00727000
*                                                                  0258 00728000
*                                                                  0258 00729000
*        /***********************************************************/  00730000
*        /* THIS MODULE HAS COMPLETED ITS PROCESSING OF DCB(S) IN   */  00731000
*        /* THE CLOSE PARAMETER LIST.                               */  00732000
*        /***********************************************************/  00733000
*TRANSFER:                                                         0258 00734000
*        /* RESET POINTER TO FIRST ENTRY IN WTG TABLE AND PARM LIST */  00735000
*        RWTGC = RWTG + 32;                                        0258 00736000
TRANSFER LA    RWTGC,32(,RWTG)                                     0258 00737000
*        RPARC = RPAR;                                             0259 00738000
*                                                                  0259 00739000
         LR    RPARC,RPAR                                          0259 00740000
*GETID:  /* SEARCH FOR NON-ZERO ID IN WTG TABLE                     */  00741000
*                                                                  0260 00742000
*        /* IS ID OF THIS ENTRY ZERO ?                              */  00743000
*                                                                  0260 00744000
*        IF WTGCID(1) = '00'X                                      0260 00745000
*          THEN                         /* YES                      */  00746000
GETID    CLI   WTGCID(RWTGC),X'00'                                 0260 00747000
         BNE   @RF00260                                            0260 00748000
*            DO;                                                   0261 00749000
*              /* POINT TO NEXT ENTRY IN WTG TABLE                  */  00750000
*              RWTGC = RWTGC + 8;                                  0262 00751000
*                                                                  0262 00752000
         LA    RWTGC,8(,RWTGC)                                     0262 00753000
*              /* POINT TO NEXT ENTRY IN CLOSE LIST                 */  00754000
*              RPARC = RPARC + 4;                                  0263 00755000
*                                                                  0263 00756000
         LA    RPARC,4(,RPARC)                                     0263 00757000
*              GO TO GETID;             /* CHECK NEXT ID            */  00758000
*                                                                  0264 00759000
         B     GETID                                               0264 00760000
*            END;                       /* END OF NO ID GROUP       */  00761000
*                                                                  0265 00762000
*        WTGID = WTGCID;                /* MOVE ID TO BASIC SECTION */  00763000
@RF00260 MVC   WTGID(2,RWTG),WTGCID(RWTGC)                         0266 00764000
*        WTGTTR = WTGCTTR;              /* MOVE TTR TO BASIC        */  00765000
         MVC   WTGTTR(3,RWTG),WTGCTTR(RWTGC)                       0267 00766000
*        R15 = ADDR (DXCCW1);           /* PARM LIST ADDRESS   Y02082*/ 00767000
*                                                                  0268 00768000
         LA    R15,DXCCW1(,RCORE)                                  0268 00769000
*        /***********************************************************/  00770000
*        /* XCTL TO NEXT LOAD OF CLOSE                              */  00771000
*        /***********************************************************/  00772000
*                                                                  0269 00773000
*        GEN (XCTL  EPLOC=(RWTG),DCB=0,SF=(E,(15)));               0269 00774000
*                                                                  0269 00775000
         XCTL  EPLOC=(RWTG),DCB=0,SF=(E,(15))                           00776000
*        END   IGG0201W                 /* END OF CLOSE MODULE      */  00777000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 00778000
*/*%INCLUDE SYSLIB  (IFGSDCB )                                        * 00779000
*/*%INCLUDE SYSLIB  (IEZDEB  )                                        * 00780000
*/*%INCLUDE SYSLIB  (IFGJCICB)                                        * 00781000
*/*%INCLUDE SYSLIB  (IECDSECT)                                        * 00782000
*/*%INCLUDE SYSLIB  (IFGRPL  )                                        * 00783000
*;                                                                 0270 00784000
@EL00001 DS    0H                                                  0270 00785000
@EF00001 DS    0H                                                  0270 00786000
@ER00001 BR    @14                                                 0270 00787000
@DATA    DS    0H                                                       00788000
@CH00147 DC    H'4'                                                     00789000
@DATD    DSECT                                                          00790000
         DS    0F                                                       00791000
@ZTEMPS  DS    C                                                        00792000
@ZTEMPND EQU   *                                                        00793000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         00794000
@TEMPS   EQU   @ZTEMPS                                                  00795000
@L       EQU   @ZLEN                                                    00796000
IGG0201W CSECT                                                          00797000
         DS    0F                                                       00798000
@CF00127 DC    F'1'                                                     00799000
@CH00127 EQU   @CF00127+2                                               00800000
@CF00862 DC    F'-8'                                                    00801000
@DATD    DSECT                                                          00802000
         DS    0D                                                       00803000
IGG0201W CSECT                                                          00804000
         DS    0F                                                       00805000
@SIZDATD DC    AL1(0)                                                   00806000
         DC    AL3(@ENDDATD-@DATD)                                      00807000
@SIZ001  EQU   @SIZDATD                                                 00808000
         DS    0D                                                       00809000
@CC00833 DC    C'IGG019DJ'                                              00810000
@CC00834 DC    C'IGG019DK'                                              00811000
@CC00835 DC    C'IGG0201W'                                              00812000
@CC00838 DC    C'IGG019AQ'                                              00813000
@CC00839 DC    C'IGG019BB'                                              00814000
@CC00814 DC    C'1W'                                                    00815000
@CC00818 DC    C'0A'                                                    00816000
@CC00819 DC    C'0H'                                                    00817000
@DATD    DSECT                                                          00818000
IGG0201W CSECT                                                          00819000
         ORG   IGG0201W+1264            SET TO END OF MODULE     XA3128 00820000
XCTLTABL EQU   *                                                        00821000
IBMCLOSE DC    X'00'                    INDICATE NO NEXT LOAD           00822000
         DC    X'00000000'              INDICATE NO NEXT LOAD           00823000
         DC    X'0000'                  END OF TABLE                    00824000
         ORG   IGG0201W+1276            ORG TO LAST WORD         XA3128 00825000
         DC    C'020'                   SVC CODE                        00826000
         DC    X'7E'                    DISPLACEMENT TO TBL             00827000
@DATD    DSECT                                                          00828000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00829000
@ENDDATD EQU   *                                                        00830000
@DATEND  EQU   *                                                        00831000
IGG0201W CSECT                                                          00832000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00833000
@01      EQU   01                                                       00834000
@02      EQU   02                                                       00835000
@03      EQU   03                                                       00836000
@04      EQU   04                                                       00837000
@05      EQU   05                                                       00838000
@06      EQU   06                                                       00839000
@07      EQU   07                                                       00840000
@08      EQU   08                                                       00841000
@09      EQU   09                                                       00842000
@10      EQU   10                                                       00843000
@11      EQU   11                                                       00844000
@12      EQU   12                                                       00845000
@13      EQU   13                                                       00846000
@14      EQU   14                                                       00847000
@15      EQU   15                                                       00848000
@0       EQU   00                                                       00849000
@1       EQU   01                                                       00850000
@2       EQU   02                                                       00851000
@3       EQU   03                                                       00852000
@4       EQU   04                                                       00853000
@5       EQU   05                                                       00854000
@6       EQU   06                                                       00855000
@7       EQU   07                                                       00856000
@8       EQU   08                                                       00857000
@9       EQU   09                                                       00858000
@A       EQU   10                                                       00859000
@B       EQU   11                                                       00860000
@C       EQU   12                                                       00861000
@D       EQU   13                                                       00862000
@E       EQU   14                                                       00863000
@F       EQU   15                                                       00864000
R1       EQU   @01                                                      00865000
RCICB    EQU   @01                                                      00866000
RDCB     EQU   @02                                                      00867000
RUKEY    EQU   @02                                                      00868000
RACBCNT  EQU   @03                                                      00869000
RCLOSE   EQU   @03                                                      00870000
RRPL     EQU   @04                                                      00871000
RSVRB    EQU   @04                                                      00872000
RSIZE    EQU   @04                                                      00873000
RPAR     EQU   @05                                                      00874000
RWTG     EQU   @06                                                      00875000
RPARC    EQU   @07                                                      00876000
RWTGC    EQU   @08                                                      00877000
RCLOSEC  EQU   @09                                                      00878000
XCTLREG  EQU   @09                                                      00879000
RCORE    EQU   @10                                                      00880000
R15      EQU   @15                                                      00881000
R0       EQU   @00                                                      00882000
CVTPTR   EQU   16                                                       00883000
IFGSDCB  EQU   0                                                        00884000
DCBBUFCB EQU   IFGSDCB+20                                               00885000
DCBDSORG EQU   IFGSDCB+26                                               00886000
DCBIOBAD EQU   IFGSDCB+28                                               00887000
DCBSVCXL EQU   DCBIOBAD                                                 00888000
@NM00003 EQU   IFGSDCB+32                                               00889000
DCBHIARC EQU   @NM00003                                                 00890000
DCBBFTEK EQU   DCBHIARC                                                 00891000
DCBRECFM EQU   IFGSDCB+36                                               00892000
DCBDDNAM EQU   IFGSDCB+40                                               00893000
DCBMACRF EQU   DCBDDNAM+2                                               00894000
DCBDEBAD EQU   DCBDDNAM+5                                               00895000
DCBOFLGS EQU   IFGSDCB+48                                               00896000
DCBREAD  EQU   IFGSDCB+49                                               00897000
DCBWRITE EQU   DCBREAD                                                  00898000
DCBGET   EQU   DCBWRITE                                                 00899000
DCBPUT   EQU   DCBGET                                                   00900000
DCBCHECK EQU   IFGSDCB+53                                               00901000
DCBGERR  EQU   DCBCHECK                                                 00902000
DCBCIND1 EQU   IFGSDCB+60                                               00903000
DCBCIND2 EQU   IFGSDCB+61                                               00904000
DCBIOBA  EQU   IFGSDCB+68                                               00905000
DCBCICB  EQU   DCBIOBA                                                  00906000
DCBEOBAD EQU   IFGSDCB+72                                               00907000
DCBLCCW  EQU   DCBEOBAD                                                 00908000
DCBEOBR  EQU   DCBLCCW                                                  00909000
DCBNCP   EQU   DCBEOBR                                                  00910000
@NM00004 EQU   IFGSDCB+76                                               00911000
DCBEOBW  EQU   @NM00004                                                 00912000
DCBRECAD EQU   DCBEOBW                                                  00913000
DCBDIRCT EQU   IFGSDCB+80                                               00914000
@NM00005 EQU   IFGSDCB+84                                               00915000
DCBCNTRL EQU   @NM00005+1                                               00916000
DCBNOTE  EQU   DCBCNTRL                                                 00917000
NOBASE   EQU   0                                                        00918000
DEBBASIC EQU   0                                                        00919000
DEBTCBAD EQU   DEBBASIC                                                 00920000
DEBDEBAD EQU   DEBBASIC+4                                               00921000
DEBIRBAD EQU   DEBBASIC+8                                               00922000
DEBOFLGS EQU   DEBIRBAD                                                 00923000
DEBOPATB EQU   DEBBASIC+12                                              00924000
DEBACCS  EQU   DEBOPATB                                                 00925000
DEBFLGS1 EQU   DEBBASIC+14                                              00926000
DEBUSRPG EQU   DEBBASIC+16                                              00927000
DEBRRQ   EQU   DEBBASIC+20                                              00928000
DEBECBAD EQU   DEBRRQ                                                   00929000
DEBDCBAD EQU   DEBBASIC+24                                              00930000
DEBPROTG EQU   DEBDCBAD                                                 00931000
DEBAPPAD EQU   DEBBASIC+28                                              00932000
DEBBASND EQU   DEBBASIC+32                                              00933000
DEBDASD  EQU   0                                                        00934000
DEBUCBAD EQU   DEBDASD                                                  00935000
DEBACSMD EQU   0                                                        00936000
DEBVOLSQ EQU   DEBACSMD                                                 00937000
DEBVOLBT EQU   DEBVOLSQ                                                 00938000
DEBDSNM  EQU   DEBACSMD+4                                               00939000
DEBUTSAA EQU   DEBDSNM                                                  00940000
DEBACS01 EQU   0                                                        00941000
DEBDSNAM EQU   DEBACS01                                                 00942000
DEBACS02 EQU   0                                                        00943000
DEBDBLK  EQU   DEBACS02                                                 00944000
DEBACS03 EQU   0                                                        00945000
DEBACS04 EQU   0                                                        00946000
DEBTBFRA EQU   DEBACS04                                                 00947000
DEBTCCWA EQU   DEBACS04+4                                               00948000
DEBACS05 EQU   0                                                        00949000
DEBFUCBA EQU   DEBACS05                                                 00950000
DEBLUCBA EQU   DEBACS05+4                                               00951000
DEBACS06 EQU   0                                                        00952000
DEBACS07 EQU   0                                                        00953000
DEBACS08 EQU   0                                                        00954000
DEBSUBNM EQU   0                                                        00955000
DEB      EQU   0                                                        00956000
DEBAVT   EQU   DEB                                                      00957000
DEBEOEA  EQU   DEBAVT                                                   00958000
DEBEOEAB EQU   DEBEOEA                                                  00959000
DEBSIOA  EQU   DEBAVT+4                                                 00960000
DEBSIOAB EQU   DEBSIOA                                                  00961000
DEBPCIA  EQU   DEBAVT+8                                                 00962000
DEBPCIAB EQU   DEBPCIA                                                  00963000
DEBCEA   EQU   DEBAVT+12                                                00964000
DEBCEAB  EQU   DEBCEA                                                   00965000
DEBXCEA  EQU   DEBAVT+16                                                00966000
DEBXCEAB EQU   DEBXCEA                                                  00967000
DEBPREFX EQU   DEB+20                                                   00968000
DEBXTNP  EQU   DEBPREFX+8                                               00969000
DEBXTN   EQU   0                                                        00970000
DEBXFLG1 EQU   DEBXTN+2                                                 00971000
DEBXDCBM EQU   DEBXTN+8                                                 00972000
IFGJCICB EQU   0                                                        00973000
CIDUMIOB EQU   IFGJCICB                                                 00974000
CINXTIOB EQU   CIDUMIOB                                                 00975000
CIRESID  EQU   CIDUMIOB+20                                              00976000
CIACBD   EQU   IFGJCICB+32                                              00977000
CIREGSAV EQU   IFGJCICB+116                                             00978000
CIFLAGS  EQU   IFGJCICB+188                                             00979000
CIFLAG2  EQU   CIFLAGS+1                                                00980000
CIFMDSOR EQU   CIFLAG2                                                  00981000
CIFLAG3  EQU   CIFLAGS+2                                                00982000
CIFFSTP  EQU   CIFLAG3                                                  00983000
CIFCLOSE EQU   CIFLAG3                                                  00984000
CIFRAGM  EQU   CIFLAG3                                                  00985000
CIRPL    EQU   IFGJCICB+192                                             00986000
CILWAREA EQU   IFGJCICB+304                                             00987000
CIIOCNT  EQU   IFGJCICB+308                                             00988000
CIRAREA  EQU   IFGJCICB+316                                             00989000
CISVCLST EQU   IFGJCICB+336                                             00990000
CISYNADA EQU   CISVCLST                                                 00991000
CIBLDL   EQU   CISVCLST+4                                               00992000
CIBSP    EQU   CISVCLST+8                                               00993000
CIFEOV   EQU   CISVCLST+12                                              00994000
CISTOW   EQU   CISVCLST+16                                              00995000
FORCORE  EQU   0                                                        00996000
DXDSCB   EQU   FORCORE                                                  00997000
DXDAADDR EQU   FORCORE+312                                              00998000
DXDCB    EQU   FORCORE+320                                              00999000
DXCCW    EQU   FORCORE+368                                              01000000
DXCCW1   EQU   DXCCW                                                    01001000
DXVOLSR  EQU   FORCORE+500                                              01002000
DXVOLSR1 EQU   DXVOLSR                                                  01003000
DXVOLSR2 EQU   DXVOLSR+6                                                01004000
DXVOLSR3 EQU   DXVOLSR+12                                               01005000
DXUKEY   EQU   FORCORE+526                                              01006000
DXUCBSAV EQU   FORCORE+564                                              01007000
DXUDCBAD EQU   FORCORE+568                                              01008000
DXPDCBAD EQU   FORCORE+572                                              01009000
DXATCOM1 EQU   FORCORE+588                                              01010000
DXATGENS EQU   DXATCOM1                                                 01011000
DXATVGIV EQU   DXATGENS                                                 01012000
DXATOUTA EQU   DXATCOM1+2                                               01013000
DXATDACC EQU   DXATCOM1+3                                               01014000
DXATCOM2 EQU   FORCORE+592                                              01015000
DXATEOV  EQU   DXATCOM2                                                 01016000
DXATOPEN EQU   DXATCOM2+1                                               01017000
DXATALL  EQU   DXATCOM2+2                                               01018000
DXATEXC1 EQU   FORCORE+604                                              01019000
DXATEXB1 EQU   DXATEXC1                                                 01020000
DXATEXC2 EQU   FORCORE+608                                              01021000
IFGRPL   EQU   0                                                        01022000
RPLCOMN  EQU   IFGRPL                                                   01023000
RPLIDWD  EQU   RPLCOMN                                                  01024000
RPLLEN   EQU   RPLIDWD+3                                                01025000
RPLECB   EQU   RPLCOMN+8                                                01026000
RPLFDBWD EQU   RPLCOMN+12                                               01027000
RPLFDBK  EQU   RPLFDBWD+1                                               01028000
RPLRTNCD EQU   RPLFDBK                                                  01029000
RPLCNDCD EQU   RPLFDBK+1                                                01030000
RPLCMPON EQU   RPLCNDCD                                                 01031000
RPLFDB2  EQU   RPLCMPON                                                 01032000
RPLERRCD EQU   RPLCNDCD+1                                               01033000
RPLFDB3  EQU   RPLERRCD                                                 01034000
RPLKEYLE EQU   RPLCOMN+16                                               01035000
RPLAREA  EQU   RPLCOMN+32                                               01036000
RPLARG   EQU   RPLCOMN+36                                               01037000
RPLOPTCD EQU   RPLCOMN+40                                               01038000
RPLOPT1  EQU   RPLOPTCD                                                 01039000
RPLECBSW EQU   RPLOPT1                                                  01040000
RPLOPT2  EQU   RPLOPTCD+1                                               01041000
RPLADR   EQU   RPLOPT2                                                  01042000
RPLOPT3  EQU   RPLOPTCD+2                                               01043000
RPLNXTRP EQU   RPLCOMN+44                                               01044000
RPLOPTC2 EQU   RPLCOMN+56                                               01045000
RPLOPT5  EQU   RPLOPTC2                                                 01046000
RPLWRTYP EQU   RPLOPT5                                                  01047000
RPLOPT6  EQU   RPLOPTC2+1                                               01048000
RPLUNTYP EQU   RPLOPT6                                                  01049000
RPLOPT7  EQU   RPLOPTC2+2                                               01050000
RPLCNOPT EQU   RPLOPT7                                                  01051000
RPLOPT8  EQU   RPLOPTC2+3                                               01052000
RPLRBAR  EQU   RPLCOMN+60                                               01053000
RPLAIXID EQU   RPLRBAR+2                                                01054000
RPLEXTDS EQU   RPLCOMN+68                                               01055000
RPLEXTD1 EQU   RPLEXTDS                                                 01056000
WTG      EQU   0                                                        01057000
WTGMDNAM EQU   WTG                                                      01058000
WTGID    EQU   WTGMDNAM+6                                               01059000
WTGTTR   EQU   WTG+14                                                   01060000
WTGC     EQU   0                                                        01061000
WTGCID   EQU   WTGC                                                     01062000
WTGCTTR  EQU   WTGC+2                                                   01063000
WTGCWA   EQU   WTGC+5                                                   01064000
PARCNTRY EQU   0                                                        01065000
PARCDCB  EQU   PARCNTRY                                                 01066000
CLOSNTRY EQU   0                                                        01067000
CLOSEACB EQU   CLOSNTRY                                                 01068000
CLOSEOPT EQU   CLOSEACB                                                 01069000
XCTLNTRY EQU   0                                                        01070000
XCTLID   EQU   XCTLNTRY                                                 01071000
XCTLTTR  EQU   XCTLNTRY+2                                               01072000
CVTTCBDW EQU   0                                                        01073000
TCBPTR   EQU   4                                                        01074000
TCBFLAG1 EQU   29                                                       01075000
FWOPWA   EQU   0                                                        01076000
DEBXTNPT EQU   -8                                                       01077000
THISSVRB EQU   0                                                        01078000
BCB      EQU   0                                                        01079000
BCBBUFNO EQU   BCB+4                                                    01080000
BUFLINK  EQU   0                                                        01081000
SVCDCBPT EQU   84                                                       01082000
DCBDEVTY EQU   IFGSDCB+17                                               01083000
DEBBAS02 EQU   DEBBASND                                                 01084000
DEBDDS1  EQU   DEBBAS02                                                 01085000
DEBSUCBA EQU   DEBDDS1                                                  01086000
DEBDEVED EQU   DEBDDS1+4                                                01087000
DEBRDCB  EQU   DEBDDS1+4                                                01088000
DEBPDCB  EQU   DEBDDS1+8                                                01089000
DEBWDCB  EQU   DEBDDS1+12                                               01090000
DEBACS09 EQU   DEBDEVED                                                 01091000
DEBASC09 EQU   DEBACS09                                                 01092000
DEBEAMFG EQU   DEBASC09+3                                               01093000
DEBDSID  EQU   DEBASC09+4                                               01094000
DEBEOD   EQU   DEBASC09+12                                              01095000
DEBBOE   EQU   DEBEOD                                                   01096000
DEBEODRV EQU   DEBBOE                                                   01097000
DEBEODTT EQU   DEBBOE+1                                                 01098000
DEBEOD0  EQU   DEBBOE+2                                                 01099000
DEBEODSS EQU   DEBBOE+3                                                 01100000
DEBBAS01 EQU   DEBBASND                                                 01101000
DEBISAM  EQU   DEBBAS01                                                 01102000
DEBFIEAD EQU   DEBISAM                                                  01103000
DEBFPEAD EQU   DEBISAM+4                                                01104000
DEBFOEAD EQU   DEBISAM+8                                                01105000
DEBEXPT  EQU   DEBISAM+12                                               01106000
DEBRPSID EQU   DEBEXPT                                                  01107000
ATFLAGS  EQU   DXATEXC1                                                 01108000
ATFOPEN  EQU   ATFLAGS                                                  01109000
ATFCLOSE EQU   ATFLAGS+1                                                01110000
ATFMDMSK EQU   ATFCLOSE                                                 01111000
ATFCICBF EQU   ATFCLOSE                                                 01112000
*                                      START UNREFERENCED COMPONENTS    01113000
@NM00034 EQU   ATFCLOSE                                                 01114000
ATFCHECK EQU   ATFOPEN                                                  01115000
ATFSYNC  EQU   ATFOPEN                                                  01116000
ATFBSAM  EQU   ATFOPEN                                                  01117000
ATFQSAM  EQU   ATFOPEN                                                  01118000
@NM00033 EQU   ATFOPEN                                                  01119000
ATFABEND EQU   ATFOPEN                                                  01120000
ATFCICBG EQU   ATFOPEN                                                  01121000
DEBEXPTA EQU   DEBEXPT+1                                                01122000
DEBRSV12 EQU   DEBRPSID                                                 01123000
DEBRSV11 EQU   DEBRPSID                                                 01124000
DEBRSV10 EQU   DEBRPSID                                                 01125000
DEBRSV09 EQU   DEBRPSID                                                 01126000
DEBRPSAP EQU   DEBRPSID                                                 01127000
DEBRPSO  EQU   DEBRPSID                                                 01128000
DEBRPSI  EQU   DEBRPSID                                                 01129000
DEBRPSP  EQU   DEBRPSID                                                 01130000
DEBFOEB  EQU   DEBFOEAD+1                                               01131000
DEBNOEE  EQU   DEBFOEAD                                                 01132000
DEBFPEB  EQU   DEBFPEAD+1                                               01133000
DEBNPEE  EQU   DEBFPEAD                                                 01134000
DEBFIEB  EQU   DEBFIEAD+1                                               01135000
DEBNIEE  EQU   DEBFIEAD                                                 01136000
DEBBOESS EQU   DEBEODSS                                                 01137000
DEBBOE0  EQU   DEBEOD0                                                  01138000
DEBBOETT EQU   DEBEODTT                                                 01139000
DEBBOERV EQU   DEBEODRV                                                 01140000
DEBRV008 EQU   DEBDSID+7                                                01141000
DEBWTPTI EQU   DEBDSID+6                                                01142000
DEBEXDTE EQU   DEBDSID                                                  01143000
DEBRV007 EQU   DEBEAMFG                                                 01144000
DEBRV006 EQU   DEBEAMFG                                                 01145000
DEBRV005 EQU   DEBEAMFG                                                 01146000
DEBRV004 EQU   DEBEAMFG                                                 01147000
DEBSECVL EQU   DEBEAMFG                                                 01148000
DEBVAMSG EQU   DEBEAMFG                                                 01149000
DEBDSOPN EQU   DEBEAMFG                                                 01150000
DEBMULTI EQU   DEBEAMFG                                                 01151000
DEBVSEQU EQU   DEBASC09+2                                               01152000
DEBDSSQL EQU   DEBASC09+1                                               01153000
DEBVOLAC EQU   DEBASC09                                                 01154000
DEBWDCBA EQU   DEBWDCB+1                                                01155000
DEBRSV08 EQU   DEBWDCB                                                  01156000
DEBPDCBA EQU   DEBPDCB+1                                                01157000
DEBRSV07 EQU   DEBPDCB                                                  01158000
DEBRDCBA EQU   DEBRDCB+1                                                01159000
DEBRSV06 EQU   DEBRDCB                                                  01160000
DEBSUCBB EQU   DEBSUCBA+1                                               01161000
DEBSDVM  EQU   DEBSUCBA                                                 01162000
BCBRECDA EQU   BCB+8                                                    01163000
BCBBUFL  EQU   BCB+6                                                    01164000
BCBBLDR  EQU   BCBBUFNO                                                 01165000
BCBFSBUF EQU   BCB                                                      01166000
PARCOPT  EQU   PARCDCB                                                  01167000
@NM00032 EQU   WTG+8                                                    01168000
@NM00031 EQU   WTGMDNAM                                                 01169000
RPLERMSA EQU   RPLCOMN+72                                               01170000
RPLEMLEN EQU   RPLCOMN+70                                               01171000
RPLACTIV EQU   RPLCOMN+69                                               01172000
RPLBRANC EQU   RPLEXTD1                                                 01173000
RPLNIB   EQU   RPLEXTD1                                                 01174000
@NM00030 EQU   RPLEXTD1                                                 01175000
RPLEXIT  EQU   RPLEXTD1                                                 01176000
RPLNEXIT EQU   RPLEXTD1                                                 01177000
RPLEXSCH EQU   RPLEXTD1                                                 01178000
RPLDDDD  EQU   RPLRBAR+4                                                01179000
@NM00029 EQU   RPLRBAR+3                                                01180000
@NM00028 EQU   RPLAIXID                                                 01181000
RPLAXPKP EQU   RPLAIXID                                                 01182000
RPLAIXPC EQU   RPLRBAR                                                  01183000
RPLRSV88 EQU   RPLOPT8                                                  01184000
RPLUNCON EQU   RPLOPT8                                                  01185000
RPLACTV  EQU   RPLOPT8                                                  01186000
RPLSESS  EQU   RPLOPT8                                                  01187000
RPLPEND  EQU   RPLOPT8                                                  01188000
RPLODPRM EQU   RPLOPT8                                                  01189000
RPLODACP EQU   RPLOPT8                                                  01190000
RPLODACQ EQU   RPLOPT8                                                  01191000
RPLRSV78 EQU   RPLOPT7                                                  01192000
RPLRSV77 EQU   RPLOPT7                                                  01193000
RPLRLSOP EQU   RPLOPT7                                                  01194000
RPLTPOST EQU   RPLOPT7                                                  01195000
RPLQOPT  EQU   RPLOPT7                                                  01196000
RPLCNIMM EQU   RPLCNOPT                                                 01197000
RPLCNANY EQU   RPLCNOPT                                                 01198000
RPLCNALL EQU   RPLCNOPT                                                 01199000
RPLRSV68 EQU   RPLOPT6                                                  01200000
RPLRSV67 EQU   RPLOPT6                                                  01201000
RPLLOCK  EQU   RPLOPT6                                                  01202000
RPLNCOND EQU   RPLOPT6                                                  01203000
RPLCOND  EQU   RPLOPT6                                                  01204000
RPLEOT   EQU   RPLUNTYP                                                 01205000
RPLEOM   EQU   RPLUNTYP                                                 01206000
RPLEOB   EQU   RPLUNTYP                                                 01207000
RPLWROPT EQU   RPLOPT5                                                  01208000
RPLNODE  EQU   RPLOPT5                                                  01209000
RPLERACE EQU   RPLWRTYP                                                 01210000
RPLEAU   EQU   RPLWRTYP                                                 01211000
RPLNERAS EQU   RPLWRTYP                                                 01212000
RPLPSOPT EQU   RPLOPT5                                                  01213000
RPLSSNIN EQU   RPLOPT5                                                  01214000
RPLDLGIN EQU   RPLOPT5                                                  01215000
RPLBUFL  EQU   RPLCOMN+52                                               01216000
RPLRLEN  EQU   RPLCOMN+48                                               01217000
RPLCHAIN EQU   RPLNXTRP                                                 01218000
RPLOPT4  EQU   RPLOPTCD+3                                               01219000
RPLALIGN EQU   RPLOPT3                                                  01220000
RPLFMT   EQU   RPLOPT3                                                  01221000
RPLFLD   EQU   RPLOPT3                                                  01222000
RPLVFY   EQU   RPLOPT3                                                  01223000
RPLBLK   EQU   RPLOPT3                                                  01224000
RPLSFORM EQU   RPLOPT3                                                  01225000
RPLEODS  EQU   RPLOPT3                                                  01226000
RPLNSP   EQU   RPLOPT2                                                  01227000
RPLUPD   EQU   RPLOPT2                                                  01228000
RPLWAITX EQU   RPLOPT2                                                  01229000
RPLLRD   EQU   RPLOPT2                                                  01230000
RPLBWD   EQU   RPLOPT2                                                  01231000
RPLCNV   EQU   RPLOPT2                                                  01232000
RPLADD   EQU   RPLADR                                                   01233000
RPLKEY   EQU   RPLOPT2                                                  01234000
RPLECBIN EQU   RPLECBSW                                                 01235000
RPLGEN   EQU   RPLOPT1                                                  01236000
RPLKGE   EQU   RPLOPT1                                                  01237000
RPLASY   EQU   RPLOPT1                                                  01238000
RPLSKP   EQU   RPLOPT1                                                  01239000
RPLSEQ   EQU   RPLOPT1                                                  01240000
RPLDIR   EQU   RPLOPT1                                                  01241000
RPLLOC   EQU   RPLOPT1                                                  01242000
RPLDAF   EQU   RPLARG+2                                                 01243000
RPLSAF   EQU   RPLARG                                                   01244000
RPLTCBPT EQU   RPLCOMN+28                                               01245000
RPLDACB  EQU   RPLCOMN+24                                               01246000
RPLCCHAR EQU   RPLCOMN+20                                               01247000
RPLSTRID EQU   RPLCOMN+18                                               01248000
RPLKEYL  EQU   RPLKEYLE                                                 01249000
RPLRDSOH EQU   RPLFDB3                                                  01250000
RPLRLG   EQU   RPLFDB3                                                  01251000
RPLLGFRC EQU   RPLFDB3                                                  01252000
RPLREOT  EQU   RPLFDB3                                                  01253000
RPLREOM  EQU   RPLFDB3                                                  01254000
RPLREOB  EQU   RPLFDB3                                                  01255000
RPLSV32  EQU   RPLFDB3                                                  01256000
RPLUINPT EQU   RPLFDB3                                                  01257000
RPLSTSAV EQU   RPLFDB2                                                  01258000
RPLCUERR EQU   RPLFDB2                                                  01259000
RPLDLGFL EQU   RPLFDB2                                                  01260000
RPLIOERR EQU   RPLFDB2                                                  01261000
RPLDVUNS EQU   RPLFDB2                                                  01262000
RPLATND  EQU   RPLFDB2                                                  01263000
RPLRVID  EQU   RPLFDB2                                                  01264000
RPLERLK  EQU   RPLFDB2                                                  01265000
RPLERREG EQU   RPLRTNCD                                                 01266000
RPLSTAT  EQU   RPLFDBWD                                                 01267000
RPLPOST  EQU   RPLECB                                                   01268000
RPLWAIT  EQU   RPLECB                                                   01269000
RPLPLHPT EQU   RPLCOMN+4                                                01270000
RPLLEN2  EQU   RPLLEN                                                   01271000
RPLREQ   EQU   RPLIDWD+2                                                01272000
RPLSTYP  EQU   RPLIDWD+1                                                01273000
RPLID    EQU   RPLIDWD                                                  01274000
DSECTSIZ EQU   FORCORE+612                                              01275000
DXATEXB2 EQU   DXATEXC2                                                 01276000
DXEXHASP EQU   DXATEXB1                                                 01277000
DXATCOM4 EQU   FORCORE+600                                              01278000
DXATCOM3 EQU   FORCORE+596                                              01279000
@NM00027 EQU   DXATCOM2+3                                               01280000
@NM00026 EQU   DXATALL                                                  01281000
DXATSWAP EQU   DXATALL                                                  01282000
DXATFC   EQU   DXATALL                                                  01283000
@NM00025 EQU   DXATOPEN                                                 01284000
DXATDFIN EQU   DXATOPEN                                                 01285000
DXATDSIN EQU   DXATOPEN                                                 01286000
DXATMODM EQU   DXATOPEN                                                 01287000
DXATMODE EQU   DXATOPEN                                                 01288000
DXATMODS EQU   DXATOPEN                                                 01289000
DXATIGN  EQU   DXATOPEN                                                 01290000
DXATVCAT EQU   DXATEOV                                                  01291000
DXATDADM EQU   DXATEOV                                                  01292000
DXATREMT EQU   DXATEOV                                                  01293000
DXATDNEW EQU   DXATEOV                                                  01294000
DXATDFRE EQU   DXATEOV                                                  01295000
DXATDCHN EQU   DXATEOV                                                  01296000
DXATNVOL EQU   DXATEOV                                                  01297000
DXATCCAT EQU   DXATEOV                                                  01298000
DXATRDDB EQU   DXATDACC                                                 01299000
DXATEOF  EQU   DXATDACC                                                 01300000
@NM00024 EQU   DXATDACC                                                 01301000
DXATSMF  EQU   DXATDACC                                                 01302000
DXATUPDB EQU   DXATDACC                                                 01303000
DXATDRCT EQU   DXATDACC                                                 01304000
DXATTRAK EQU   DXATDACC                                                 01305000
DXATF1CE EQU   DXATDACC                                                 01306000
DXATNSL  EQU   DXATOUTA                                                 01307000
DXATTTM2 EQU   DXATOUTA                                                 01308000
DXATTTM1 EQU   DXATOUTA                                                 01309000
DXATTRL2 EQU   DXATOUTA                                                 01310000
DXATTRL1 EQU   DXATOUTA                                                 01311000
DXATDATM EQU   DXATOUTA                                                 01312000
DXATHDTM EQU   DXATOUTA                                                 01313000
DXATVLHD EQU   DXATOUTA                                                 01314000
DXATCLOS EQU   DXATCOM1+1                                               01315000
DXATSRET EQU   DXATGENS                                                 01316000
DXATVCIG EQU   DXATVGIV                                                 01317000
DXATVTMG EQU   DXATVGIV                                                 01318000
DXATVSMG EQU   DXATVGIV                                                 01319000
DXATJFCB EQU   DXATGENS                                                 01320000
DXATDISP EQU   DXATGENS                                                 01321000
DXATREFR EQU   DXATGENS                                                 01322000
DXATDMCT EQU   DXATGENS                                                 01323000
DXMSGADR EQU   FORCORE+584                                              01324000
DXPRPARC EQU   FORCORE+580                                              01325000
DXUDCBML EQU   FORCORE+578                                              01326000
DXUDCBPL EQU   FORCORE+576                                              01327000
DXPACBAD EQU   DXPDCBAD+1                                               01328000
@NM00023 EQU   DXPDCBAD                                                 01329000
DXUACBAD EQU   DXUDCBAD+1                                               01330000
@NM00022 EQU   DXUDCBAD                                                 01331000
DXUCBSVV EQU   DXUCBSAV+1                                               01332000
@NM00021 EQU   DXUCBSAV                                                 01333000
DXUCBADR EQU   FORCORE+560                                              01334000
DXTIOTAD EQU   FORCORE+556                                              01335000
DXDEBXAD EQU   FORCORE+552                                              01336000
DXDSAB   EQU   FORCORE+548                                              01337000
DXDSABAD EQU   FORCORE+544                                              01338000
DXDSABQD EQU   FORCORE+540                                              01339000
DXJSCBAD EQU   FORCORE+536                                              01340000
DXTCBADR EQU   FORCORE+532                                              01341000
DXASCBAD EQU   FORCORE+528                                              01342000
DXEXTSW  EQU   FORCORE+527                                              01343000
DXWKEYSV EQU   FORCORE+525                                              01344000
DXRESSW  EQU   FORCORE+524                                              01345000
DXUNITOF EQU   FORCORE+522                                              01346000
DXNOUNIT EQU   FORCORE+520                                              01347000
DXVOLSEQ EQU   FORCORE+518                                              01348000
DXVOLMT3 EQU   DXVOLSR3                                                 01349000
DXVOLMT2 EQU   DXVOLSR2                                                 01350000
DXVOLMT1 EQU   DXVOLSR1                                                 01351000
DXWORK4  EQU   FORCORE+496                                              01352000
DXWORK3  EQU   FORCORE+492                                              01353000
DXWORK2  EQU   FORCORE+488                                              01354000
DXWORK1  EQU   FORCORE+484                                              01355000
DXWORK   EQU   FORCORE+480                                              01356000
DXXCTL   EQU   FORCORE+472                                              01357000
@NM00020 EQU   FORCORE+464                                              01358000
DXCCW12  EQU   DXCCW+88                                                 01359000
DXCCW11  EQU   DXCCW+80                                                 01360000
DXCCW10  EQU   DXCCW+72                                                 01361000
DXCCW9   EQU   DXCCW+64                                                 01362000
DXCCW8   EQU   DXCCW+56                                                 01363000
DXCCW7   EQU   DXCCW+48                                                 01364000
DXCCW6   EQU   DXCCW+40                                                 01365000
DXCCW5   EQU   DXCCW+32                                                 01366000
DXCCW4   EQU   DXCCW+24                                                 01367000
DXCCW3   EQU   DXCCW+16                                                 01368000
DXCCW2   EQU   DXCCW+8                                                  01369000
DXDCBDEB EQU   DXDCB+44                                                 01370000
@NM00019 EQU   DXDCB+24                                                 01371000
DXDEBDCB EQU   DXDCB+20                                                 01372000
@NM00018 EQU   DXDCB                                                    01373000
DXDEB    EQU   DXDAADDR+4                                               01374000
@NM00017 EQU   DXDAADDR                                                 01375000
DXIOB    EQU   FORCORE+280                                              01376000
DXECB    EQU   FORCORE+276                                              01377000
DXJBF    EQU   FORCORE+100                                              01378000
DSCCORE  EQU   FORCORE+96                                               01379000
DXLBL    EQU   DXDSCB                                                   01380000
CISTOWRC EQU   CISTOW                                                   01381000
CIFEOVRC EQU   CIFEOV                                                   01382000
CIBSPRC  EQU   CIBSP                                                    01383000
CIBLDLRC EQU   CIBLDL                                                   01384000
CISYNRC  EQU   CISYNADA                                                 01385000
CIWK2    EQU   IFGJCICB+332                                             01386000
CIWK1    EQU   IFGJCICB+328                                             01387000
CISAMWA  EQU   IFGJCICB+324                                             01388000
CIRECPTR EQU   IFGJCICB+320                                             01389000
CIBLKPTR EQU   IFGJCICB+312                                             01390000
CISEGLEN EQU   CIIOCNT                                                  01391000
CIFDBCK  EQU   IFGJCICB+284                                             01392000
CIRPLEXT EQU   IFGJCICB+268                                             01393000
CIFLAG4  EQU   CIFLAGS+3                                                01394000
@NM00016 EQU   CIFLAG3                                                  01395000
CIFPOINT EQU   CIFLAG3                                                  01396000
CIFERROR EQU   CIFLAG3                                                  01397000
CIFVSEOB EQU   CIFLAG3                                                  01398000
CIFVSRI  EQU   CIFLAG3                                                  01399000
@NM00015 EQU   CIFLAG2                                                  01400000
CIFMDEVT EQU   CIFLAG2                                                  01401000
CIFLAG1  EQU   CIFLAGS                                                  01402000
CIREGS   EQU   CIREGSAV+12                                              01403000
CIREGFC  EQU   CIREGSAV+8                                               01404000
CIREGBC  EQU   CIREGSAV+4                                               01405000
@NM00014 EQU   CIREGSAV                                                 01406000
CISYNNAM EQU   IFGJCICB+108                                             01407000
CIACBED  EQU   IFGJCICB+88                                              01408000
CIDCBPTR EQU   CIDUMIOB+28                                              01409000
@NM00013 EQU   CIDUMIOB+24                                              01410000
@NM00012 EQU   CIDUMIOB+16                                              01411000
CIECBPTR EQU   CIDUMIOB+12                                              01412000
CIIOB    EQU   CIDUMIOB+8                                               01413000
@NM00011 EQU   CIDUMIOB+5                                               01414000
CIECBCD  EQU   CIDUMIOB+4                                               01415000
DEBXSAMB EQU   DEBXTN+28                                                01416000
DEBXOPNJ EQU   DEBXTN+24                                                01417000
DEBXXARG EQU   DEBXTN+20                                                01418000
DEBXMCF2 EQU   DEBXTN+19                                                01419000
DEBXMCF1 EQU   DEBXTN+18                                                01420000
DEBXDSO2 EQU   DEBXTN+17                                                01421000
DEBXDSO1 EQU   DEBXTN+16                                                01422000
DEBXDBPR EQU   DEBXTN+12                                                01423000
DEBXDSAB EQU   DEBXTN+4                                                 01424000
DEBXRV48 EQU   DEBXTN+3                                                 01425000
DEBXRV47 EQU   DEBXFLG1                                                 01426000
DEBXRV46 EQU   DEBXFLG1                                                 01427000
DEBXRV45 EQU   DEBXFLG1                                                 01428000
DEBXRV44 EQU   DEBXFLG1                                                 01429000
DEBXRV43 EQU   DEBXFLG1                                                 01430000
DEBXDSSI EQU   DEBXFLG1                                                 01431000
DEBXTSKC EQU   DEBXFLG1                                                 01432000
DEBXCDCB EQU   DEBXFLG1                                                 01433000
DEBXLNGH EQU   DEBXTN                                                   01434000
DEBTBLOF EQU   DEBPREFX+14                                              01435000
DEBAMTYP EQU   DEBPREFX+13                                              01436000
DEBLNGTH EQU   DEBPREFX+12                                              01437000
DEBDCBMK EQU   DEBXTNP                                                  01438000
DEBDSCBA EQU   DEBPREFX+1                                               01439000
DEBWKARA EQU   DEBPREFX                                                 01440000
DEBXCEAD EQU   DEBXCEA+1                                                01441000
DEBXCENP EQU   DEBXCEAB                                                 01442000
DEBRSV35 EQU   DEBXCEAB                                                 01443000
DEBRSV34 EQU   DEBXCEAB                                                 01444000
DEBRSV33 EQU   DEBXCEAB                                                 01445000
DEBRSV32 EQU   DEBXCEAB                                                 01446000
DEBCEAD  EQU   DEBCEA+1                                                 01447000
DEBCENP  EQU   DEBCEAB                                                  01448000
DEBRSV31 EQU   DEBCEAB                                                  01449000
DEBRSV30 EQU   DEBCEAB                                                  01450000
DEBRSV29 EQU   DEBCEAB                                                  01451000
DEBRSV28 EQU   DEBCEAB                                                  01452000
DEBPCIAD EQU   DEBPCIA+1                                                01453000
DEBPCINP EQU   DEBPCIAB                                                 01454000
DEBRSV27 EQU   DEBPCIAB                                                 01455000
DEBRSV26 EQU   DEBPCIAB                                                 01456000
DEBRSV25 EQU   DEBPCIAB                                                 01457000
DEBRSV24 EQU   DEBPCIAB                                                 01458000
DEBSIOAD EQU   DEBSIOA+1                                                01459000
DEBSIONP EQU   DEBSIOAB                                                 01460000
DEBFIX   EQU   DEBSIOAB                                                 01461000
DEBIOVR  EQU   DEBSIOAB                                                 01462000
DEBSIOX  EQU   DEBSIOAB                                                 01463000
DEBPGFX  EQU   DEBSIOAB                                                 01464000
DEBEOEAD EQU   DEBEOEA+1                                                01465000
DEBEOENP EQU   DEBEOEAB                                                 01466000
DEBRSV22 EQU   DEBEOEAB                                                 01467000
DEBRSV21 EQU   DEBEOEAB                                                 01468000
DEBRSV20 EQU   DEBEOEAB                                                 01469000
DEBESMVR EQU   DEBEOEAB                                                 01470000
DEBSUBID EQU   DEBSUBNM                                                 01471000
DEBSIOA2 EQU   DEBACS08+24                                              01472000
DEBRPSIO EQU   DEBACS08+20                                              01473000
DEBFREED EQU   DEBACS08+16                                              01474000
@NM00010 EQU   DEBACS08+12                                              01475000
@NM00009 EQU   DEBACS08+8                                               01476000
DEBDISAD EQU   DEBACS08+4                                               01477000
@NM00008 EQU   DEBACS08                                                 01478000
DEBRPSST EQU   DEBACS07+64                                              01479000
DEBARECK EQU   DEBACS07+60                                              01480000
DEBAREWT EQU   DEBACS07+56                                              01481000
DEBACHK  EQU   DEBACS07+52                                              01482000
DEBAWRIT EQU   DEBACS07+48                                              01483000
DEBASETL EQU   DEBACS07+44                                              01484000
DEBAREAD EQU   DEBACS07+40                                              01485000
DEBCRECK EQU   DEBACS07+36                                              01486000
DEBCREWT EQU   DEBACS07+32                                              01487000
DEBCCHK  EQU   DEBACS07+28                                              01488000
DEBCWRIT EQU   DEBACS07+24                                              01489000
DEBCSETL EQU   DEBACS07+20                                              01490000
DEBCREAD EQU   DEBACS07+16                                              01491000
DEBWKPT5 EQU   DEBACS07+12                                              01492000
DEBWKPT4 EQU   DEBACS07+8                                               01493000
DEBGET   EQU   DEBACS07+4                                               01494000
@NM00007 EQU   DEBACS07                                                 01495000
DEBPUT   EQU   DEBACS06+4                                               01496000
DEBDCBFA EQU   DEBACS06                                                 01497000
DEBLUCBB EQU   DEBLUCBA+1                                               01498000
DEBRSV18 EQU   DEBLUCBA                                                 01499000
DEBFUCBB EQU   DEBFUCBA+1                                               01500000
DEBRSV17 EQU   DEBFUCBA                                                 01501000
DEBTCCWB EQU   DEBTCCWA+1                                               01502000
DEBRSV16 EQU   DEBTCCWA                                                 01503000
DEBTBFRB EQU   DEBTBFRA+1                                               01504000
DEBRSV15 EQU   DEBTBFRA                                                 01505000
DEBDBPEF EQU   DEBACS03+8                                               01506000
DEBDBPP  EQU   DEBACS03+4                                               01507000
DEBDTPP  EQU   DEBACS03                                                 01508000
DEBDBPE  EQU   DEBDBLK+1                                                01509000
DEBDBPT  EQU   DEBDBLK                                                  01510000
DEBEXTNM EQU   DEBDSNAM                                                 01511000
DEBLRECL EQU   DEBACSMD+14                                              01512000
DEBBLKSI EQU   DEBACSMD+12                                              01513000
DEBRSV14 EQU   DEBDSNM+4                                                01514000
DEBUTSAB EQU   DEBUTSAA+1                                               01515000
DEBRSV13 EQU   DEBUTSAA                                                 01516000
DEBVOLNM EQU   DEBACSMD+2                                               01517000
DEBVLSEQ EQU   DEBVOLSQ+1                                               01518000
DEBRSV42 EQU   DEBVOLBT                                                 01519000
DEBRSV41 EQU   DEBVOLBT                                                 01520000
DEBRSV40 EQU   DEBVOLBT                                                 01521000
DEBRSV39 EQU   DEBVOLBT                                                 01522000
DEBRSV38 EQU   DEBVOLBT                                                 01523000
DEBRSV37 EQU   DEBVOLBT                                                 01524000
DEBRSV36 EQU   DEBVOLBT                                                 01525000
DEBEXFUL EQU   DEBVOLBT                                                 01526000
DEBNMTRK EQU   DEBDASD+14                                               01527000
DEBENDHH EQU   DEBDASD+12                                               01528000
DEBENDCC EQU   DEBDASD+10                                               01529000
DEBSTRHH EQU   DEBDASD+8                                                01530000
DEBSTRCC EQU   DEBDASD+6                                                01531000
DEBBINUM EQU   DEBDASD+4                                                01532000
DEBUCBA  EQU   DEBUCBAD+1                                               01533000
DEBDVMOD EQU   DEBUCBAD                                                 01534000
DEBAPPB  EQU   DEBAPPAD+1                                               01535000
DEBEXSCL EQU   DEBAPPAD                                                 01536000
DEBDCBB  EQU   DEBDCBAD+1                                               01537000
DEBDEBID EQU   DEBPROTG                                                 01538000
DEBECBB  EQU   DEBECBAD+1                                               01539000
DEBPRIOR EQU   DEBECBAD                                                 01540000
DEBUSRPB EQU   DEBUSRPG+1                                               01541000
DEBNMEXT EQU   DEBUSRPG                                                 01542000
DEBRSV05 EQU   DEBBASIC+15                                              01543000
DEBXTNIN EQU   DEBFLGS1                                                 01544000
DEBAPFIN EQU   DEBFLGS1                                                 01545000
DEBF1CEV EQU   DEBFLGS1                                                 01546000
DEBCINDI EQU   DEBFLGS1                                                 01547000
DEBRSV02 EQU   DEBFLGS1                                                 01548000
DEBRSIOA EQU   DEBFLGS1                                                 01549000
DEBEOFDF EQU   DEBFLGS1                                                 01550000
DEBPWCKD EQU   DEBFLGS1                                                 01551000
DEBQSCNT EQU   DEBBASIC+13                                              01552000
DEBPOSIT EQU   DEBOPATB                                                 01553000
DEBZERO  EQU   DEBOPATB                                                 01554000
DEBABEND EQU   DEBOPATB                                                 01555000
DEBIRBB  EQU   DEBIRBAD+1                                               01556000
DEBRERR  EQU   DEBOFLGS                                                 01557000
DEBLABEL EQU   DEBOFLGS                                                 01558000
DEBSPLIT EQU   DEBOFLGS                                                 01559000
DEBDCB   EQU   DEBOFLGS                                                 01560000
DEBRLSE  EQU   DEBOFLGS                                                 01561000
DEBEOF   EQU   DEBOFLGS                                                 01562000
DEBDISP  EQU   DEBOFLGS                                                 01563000
DEBDEBB  EQU   DEBDEBAD+1                                               01564000
DEBAMLNG EQU   DEBDEBAD                                                 01565000
DEBTCBB  EQU   DEBTCBAD+1                                               01566000
DEBNMSUB EQU   DEBTCBAD                                                 01567000
DCBEOB   EQU   IFGSDCB+92                                               01568000
DCBPRECL EQU   IFGSDCB+90                                               01569000
@NM00006 EQU   IFGSDCB+88                                               01570000
DCBPOINT EQU   DCBNOTE                                                  01571000
DCBEROPT EQU   @NM00005                                                 01572000
DCBLRECL EQU   IFGSDCB+82                                               01573000
DCBQSWS  EQU   DCBDIRCT                                                 01574000
DCBCCCW  EQU   DCBRECAD                                                 01575000
DCBOFFSW EQU   IFGSDCB+67                                               01576000
DCBOFFSR EQU   IFGSDCB+66                                               01577000
DCBWCPL  EQU   IFGSDCB+65                                               01578000
DCBWCPO  EQU   IFGSDCB+64                                               01579000
DCBBLKSI EQU   IFGSDCB+62                                               01580000
DCBSYNAD EQU   IFGSDCB+57                                               01581000
DCBIOBL  EQU   IFGSDCB+56                                               01582000
DCBPERR  EQU   DCBGERR                                                  01583000
DCBOPTCD EQU   IFGSDCB+52                                               01584000
DCBMACR  EQU   DCBPUT+1                                                 01585000
DCBIFLG  EQU   DCBPUT                                                   01586000
DCBIFLGS EQU   DCBDDNAM+4                                               01587000
DCBTIOT  EQU   DCBDDNAM                                                 01588000
DCBEXLST EQU   IFGSDCB+37                                               01589000
DCBEODAD EQU   IFGSDCB+33                                               01590000
DCBBFALN EQU   DCBBFTEK                                                 01591000
DCBBUFL  EQU   IFGSDCB+24                                               01592000
DCBBUFNO EQU   DCBBUFCB                                                 01593000
@NM00002 EQU   IFGSDCB+16                                               01594000
@NM00001 EQU   IFGSDCB                                                  01595000
*                                      END UNREFERENCED COMPONENTS      01596000
@RT00096 EQU   MAKELIST                                                 01597000
@RF00096 EQU   NXTENTRY                                                 01598000
@RT00108 EQU   QSAMDCB                                                  01599000
@RT00110 EQU   GIVCLOSE                                                 01600000
@RT00124 EQU   DELETMOD                                                 01601000
@RT00128 EQU   DELETMOD                                                 01602000
@RC00174 EQU   @RC00173                                                 01603000
@RT00252 EQU   TRANSFER                                                 01604000
@RT00175 EQU   @RC00174                                                 01605000
@EL01    EQU   @EL00001                                                 01606000
@ENDDATA EQU   *                                                        01607000
         END   IGG0201W,(C'PLS1005',0701,78076)                         01608000
