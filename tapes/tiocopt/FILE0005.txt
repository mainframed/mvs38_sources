./  ADD  SSI=81650026,NAME=IEDQHK
HK01     TITLE '''IEDQHK'' - RESIDENT STOPLINE I/O HANDLER'             00200020
IEDQHK   CSECT                                                          00400020
*A-000000-999999                                               @X31X8R0 00400108
         SPACE 3                                                        00400222
*CHANGE-ACTIVITY = AS FOLLOWS:                                   S21903 00400422
******************** MICROFICHE FLAGS *********************** SUPT CODE 00400622
*C014000                                                       @Z30X8RB 00400808
*A246200,247300,569500-570300                                    S99228 00401022
*D569500-570505                                                  S99228 00401122
*A530000                                                         A47145 00401222
*C667000                                                         A47145 00401322
*A667000                                                         CLUP21 00401422
*C322000,326000,354200-357200,363000,374000-388000,398000-400000 CLUP21 00401522
*C430000-437000,456000,456800,462100,463200,480000,483998        CLUP21 00401622
*C502600-503200,527000-528000,536000-538000,542000-544000        CLUP21 00401722
*C550000-552000,568500-573000,578000-580000,584000-586000        CLUP21 00401822
*C592000-594000,598000-600000,604000,609000-612000,616000-618000 CLUP21 00401922
*C623000,634000-636000,642600,644000,653000,658000,660000        CLUP21 00402022
*D247300,416000,674000                                           CLUP21 00402122
*A480000                                                          M6561 00402222
*A021000,112400-113600,139000,172500-173500,293100-293400        S22025 00402322
*A326600-327200,641000,643600,658400-659600,671000               S22025 00402422
*A202000,212000,216000,292000,296000,570500,676000               S21101 00402522
*A266000,411000,570570                                           S22025 00402622
*C481960,667000                                                   M6561 00402722
*C020000,116000-118000,308000,310000-312000,396000,402200-404000 S22025 00402822
*C412200,456600,458600,459400,524000-546000,556000,558000-566000 S22025 00402922
*C570740-570755,570785,570800,658000,661000-662000               S22025 00403022
*C294000,308000,667000                                           S21101 00403122
*C308000,524000-546000,558000-566000,570740-570755,570785,5708000S22025 00403222
*D480500-481920                                                   M6561 00403322
*D204000-206000,571000-574000,672000-674000                      S21101 00403422
*D488000-512000,568500-569000                                    S22025 00403522
*A540000                                                          M6684 00403622
*A292800,642600,643200,659600,671000                            SA54930 00403722
*D412600-412800                                                 SA54929 00403822
*A004000                                                         S21903 00403922
*C010000,210000-212000,216000,224000,238000-244000,              S21903 00404022
*C247000-247200,247500-251500,256500-266000                      S21903 00404122
*A582100-583500                                                  Y05331 00404205
*A437000                                                        SA66918 00484254
*A656000                                                        SA67759 00484305
* A416000                                                      @SA70195 00504361
*A233000                                                       @SA70889 00524361
*C643300,643400                                                @SA70889 00544361
*A282000,482998,483986                                         @SA71514 00544461
*A372000,378000                                                @ZA02071 00544561
*C656900                                                       @ZA02055 00554361
*A295500                                                       @YA07691 00562361
*C376000                                                       @YA07691 00570361
*A474000                                                       @ZA05018 00571309
*A280000,643400,659900                                         @YA10232 00572309
*A474000                                                       @SA75467 00573309
*D480000                                                       @SA75467 00574309
*A563000,C564000                                               @OY11167 00574481
*A246000,404000,410000,689000                                  @OY13669 00574791
*C282000,348000,364000,410050                                  @OY14491 00574891
*C456000-470000                                                @OX14763 00574991
*A293400,671000,443000                                         @OX14763 00575091
*A328300                                                       @OY15473 00575191
*A215000,219000,220600-221200,295511-295518,312600-313200      @OY14092 00575291
*A323000,416030-416630,493998,671001-689060,410350             @OY14092 00575391
*C310000,370000-380200,474000-483598,659960-660950,410500      @OY14092 00575491
*D483986-483990                                                @OY14092 00575591
*A416540                                                       @OY16355 00575600
*C416030-416450                                                @OY16355 00575700
*D474300,474600                                                @OY16355 00575800
*A660270,660400,660420                                         @OY18823 00576000
*C660010-660020                                                @OY18823 00576100
*A283200,437000,671000                                         @OZ24311 00576300
*A479400,480000                                                @OY19040 00576482
*C660120,416540-416550                                         @OY19040 00576582
*D365000                                                       @OY19040 00576682
* DUMMY APAR                                                   @OZ27328 00576782
*A399000                                                       @OZ28736 00577782
*C416150                                                       @OZ28940 00578782
*C411000,437000                                                @OZ29091 00578882
*A479400                                                       @OZ30095 00578982
*A410350,416000,410680                                         @OY20036 00579082
         SPACE 3                                                        00580022
*********************************************************************** 00600020
*                                                                     * 00800020
*MODULE-NAME = IEDQHK                                            S21903 01000022
*                                                                S21903 01040022
*DESCRIPTIVE-NAME = RESIDENT STOPLINE I/O HANDLER                S21903 01080022
*                                                                S21903 01120022
*COPYRIGHTS = 'NONE'                                             S21903 01160022
*                                                                       01200020
*STATUS -- CHANGE LEVEL 8                                      @Z30X8RB 01400008
*                                                                     * 01600020
*FUNCTION -- THIS MODULE PROVIDES THE I/O HANDLING REQUIRED TO        * 01800020
*   EFFECT A STOPLINE FUNCTION AND TO DETERMINE IF A TRUE ATTEN- S22025 02000022
*   TION SIGNAL HAS BEEN RECEIVED FROM A 2741 OR 1050 TERMINAL.  S22025 02100022
*                                                                     * 02200020
*   WHEN A VARY OFFTP (C OR I), HALT, OR ICHANGE COMMAND IS           * 02400020
*   RECEIVED BY OPERATOR CONTROL, A REQUEST FOR STOPLINE IS POSTED    * 02600020
*   TO THIS MODULE.  IF THE REQUEST IS FOR AN I-TYPE VARY, THE LINE   * 02800020
*   IS TESTED TO SEE IF IT IS ALREADY FREE.  IF SO, LCBSTAT1 IS SET   * 03000020
*   TO ZERO TO INDICATE LINE STOPPED AND THE LCB IS POSTED TO THE     * 03200020
*   OPERATOR CONTROL QUEUE.  IF IT IS NOT ALREADY FREE, AN IOHALT     * 03400020
*   (SVC 33) IS ISSUED, LCBOCNI IS SET ON IN LCBSTAT1, THE ADDRESS    * 03600020
*   OF THE STOPLINE REQUEST ELEMENT IS SAVED IN LCBEOLTD, AND THE     * 03800020
*   ROUTINE EXITS TO THE DISPATCHER.                                  * 04000020
*                                                                     * 04200020
*   IF THE REQUEST IS FOR A C-TYPE VARY (ICHANGE IS ALWAYS A C-TYPE   * 04400020
*   VARY) THE LCB IS REMOVED FROM THE TIME DELAY QUEUE IF IT IS ON.   * 04600020
*   IF THE LINE IS DIAL AND LCBTSTSW IS NOT ON, A TEST-AND-SET IS     * 04800020
*   DONE AND THE ZERO BRANCH TAKEN TO HALT I/O CODE AS ABOVE.  THE    * 05000020
*   NON-ZERO BRANCH SKIPS THE IOHALT BUT SETS THE LCB FIELDS AND      * 05200020
*   TAKES THE EXIT AS ABOVE.  IF THE TEST-AND-SET SWITCH IS NOT ON,   * 05400020
*   OR IF THIS IS NOT A DIAL LINE, THE LINE IS TESTED TO SEE IF IT    * 05600020
*   IS ALREADY FREE.  IF SO, THE EXIT IS THE SAME AS THE I-TYPE       * 05800020
*   EXIT WHEN ALREADY FREE.                                           * 06000020
*                                                                     * 06200020
*   IF THE LINE IS AUTOPOLL, THE CHANNEL PROGRAM IS SET TO A NOP      * 06400020
*   AND THE BIT-SETTING CODE IS EXECUTED (AS ABOVE, AFTER IOHALT).    * 06600020
*   IF THE LINE IS BI-SYNC AND THERE IS NO PREPARE ON THE LINE,       * 06800020
*   LCB FIELDS ARE SET AS ABOVE AND THE ROUTINE EXITS TO THE          * 07000020
*   DISPATCHER.  IF A PREPARE IS UP, THE TEST-AND-SET IS DONE AS      * 07200020
*   FOR DIAL LINES WHEN THE TEST-AND-SET BIT IS NOT ON.  IF THE       * 07400020
*   LINE IS NOT BUSY, LCB FIELDS ARE SET AND EXIT TAKEN AS ABOVE.     * 07600020
*   IF THE LINE IS RECEIVING, THE ACTION IS THE SAME AS FOR NOT       * 07800020
*   BUSY.  OTHERWISE AN IOHALT IS ISSUED AND THE SAME EXIT CODE IS    * 08000020
*   EXECUTED.  THIS LOGIC IS REPEATED FOR EACH LCB TO BE STOPPED.     * 08200020
*                                                                     * 08400020
*   THE LCBS WILL BE RETURNED TO THIS SUBTASK WHEN THE SCHEDULERS     * 08600020
*   RECOGNIZE THE NON-IMMEDIATE BIT (LCBOCNI).  FOR NON-DIAL LINES,   * 08800020
*   LCBSTAT1 IS SET TO ZERO TO INDICATE LINE STOPPED AND CONTROL      * 09000020
*   EXITS TO THE DISPATCHER WITH A REQUEST TO POST THE LCB TO THE     * 09200020
*   OPERATOR CONTROL QUEUE.  IF THE LCB IS A DIAL LCB AND EXCP HAS    * 09400020
*   ALREADY BEEN DONE, THE EXCP FLAG IS TURNED OFF AND EXIT IS AS     * 09600020
*   FOR NON-DIAL LINES.                                               * 09800020
*                                                                     * 10000020
*   FOR A DIAL LINE ON WHICH EXCPVR HAS NOT BEEN DONE, THE EXCPVR     * 10200005
*   FLAG IS TURNED ON, A DISABLE IS SET IN THE CHANNEL PROGRAM AREA,  * 10400005
*   LCBTTCIN IS CLEARED, THE TEST-AND-SET SWITCH IS TURNED ON,        * 10600020
*   NEGATIVE RESPONSE TO POLLING IS SET, AND EXCPVR (SVC 114) IS      * 10800005
*   ISSUED.  THE ROUTINE GIVES UP CONTROL TO THE DISPATCHER.          * 11000020
*                                                                     * 11200020
*   WHEN AN LCB IS TPOSTED BY LINE END APPENDAGE, A PREPARE/HALT S22025 11240022
*   IO COMMAND SEQUENCE IS EXECUTED AND EXIT IS MADE TO THE      S22025 11280022
*   DISPATCHER.                                                  S22025 11320022
*                                                                     * 11360022
*ENTRY POINTS --                                                      * 11400020
*   IEDQHK01 - ENTERED THROUGH THE TCAM DISPATCHER.              S22025 11600022
*                                                                     * 12000020
*INPUT -- REGISTER 1 - FROM OPERATOR CONTROL, A STOPLINE REQUEST      * 12200020
*   ELEMENT FIVE WORDS LONG.  FIRST WORD IS ADDRESS OF IEDQHK,        * 12400020
*   SECOND HAS X'DC' PRIORITY IN FIRST BYTE, HIGH BYTE OF THIRD       * 12600020
*   WORD IS X'00' IF STOP SINGLE LINE, X'80' IF I-TYPE VARY, X'49'    * 12800020
*   IF ICHANGE, X'01' IF STOP A LINE GROUP, AND X'10' IF STOP ALL     * 13000020
*   LINES FOR CLOSEDOWN (HALT COMMAND).  IF NOT CLOSEDOWN, FOURTH     * 13200020
*   WORD IS DEB ADDRESS.  IF NOT CLOSEDOWN, THE FIFTH WORD IS DCB     * 13400020
*   ADDRESS FOR STOP LINE GROUP, LCB ADDRESS OTHERWISE.  FROM THE     * 13600020
*   SCHEDULERS, THE ADDRESS OF THE LCB.                               * 13800020
*   FROM LINE END, REGISTER 1 CONTAINS THE LCB ADDRESS.          S22025 13900022
*                                                                     * 14000020
*   REGISTER 13 - SAVE AREA ADDRESS.                                  * 14200020
*                                                                     * 14400020
*   REGISTER 15 - ENTRY POINT ADDRESS.                                * 14600020
*                                                                     * 14800020
*OUTPUT -- REGISTER 1 - ADDRESS OF ELEMENT TO BE RETURNED TO          * 15000020
*   OPERATOR CONTROL.                                                 * 15200020
*                                                                     * 15400020
*EXTERNAL ROUTINES -- IEDQHG02                                   S22025 15600022
*                     IEDQTNT                                    S22025 15700022
*                    AOS EXCPVR ROUTINE (SVC 114) - TO START A        * 15730005
*   CHANNEL PROGRAM.                                                  * 15760005
*                                                                     * 15800020
*EXITS-NORMAL -- STOPPED LCB IS POSTED TO OPERATOR CONTROL QCB.       * 16000020
*   EXIT IS TO THE TCAM DISPATCHER TO DO THE POST.                    * 16200020
*                                                                     * 16400020
*   THE LCB IS NOT FREE.  BITS ARE SET TO INDICATE IT IS TO BE        * 16600020
*   RETURNED BY THE SCHEDULERS WHEN I/O IS COMPLETE.  EXIT IS TO      * 16800020
*   THE DISPATCHER.                                                   * 17000020
*                                                                     * 17200020
*   FOR ATTENTION SIGNAL CHECKING EXIT IS TO LINE END APPENDAGE  S22025 17250022
*   VIA THE TCAM DISPATCHER.                                     S22025 17300022
*                                                                     * 17350022
*EXITS-ERROR -- N/A.                                                  * 17400020
*                                                                     * 17600020
*TABLES/WORK AREAS -- DSECTS OF THE TCAM DISPATCHER, THE AVT, LCB,    * 17800020
*   CCW, DCB, DEB, AND PRIORITY LEVELS.                               * 18000020
*                                                                     * 18200020
*ATTRIBUTES -- SERIALLY REUSABLE, REFRESHABLE, ENABLED, RESIDENT,     * 18400020
*   PROBLEM PROGRAM MODE.                                             * 18600020
*                                                                     * 18800020
*NOTES -- THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL       * 19000020
*   REPRESENTATION OF THE EXTERNAL CHARACTER SET.  THE CODING HAS     * 19200020
*   BEEN ARRANGED SO THAT REDEFINITION OF 'CHARACTER' CONSTANTS, BY   * 19400020
*   REASSEMBLY, WILL RESULT IN A CORRECT MODULE FOR THE NEW           * 19600020
*   DEFINITIONS.                                                      * 19800020
*                                                                     * 20000020
*********************************************************************** 20200020
         EJECT                                                          20250020
*        REGISTER EQUATES                                               20800020
R0       EQU   0                        REGISTER EQUATE          S21903 21000022
R1       EQU   1                        REGISTER EQUATE          S21903 21100022
RQCB     EQU   1                        QCB BASE REGISTER        S21101 21250020
RELE     EQU   2                                                        21400020
R2       EQU   2                        REGISTER               @OY14092 21500091
R3       EQU   3                        REGISTER EQUATE          S21903 21600022
RINVLIST EQU   3                        INVITATION LIST REGISTER S21101 21650020
RLCB     EQU   4                                                        21800020
R4       EQU   4                        REGISTER               @OY14092 21900091
RWORK    EQU   5                                                        22000020
R5       EQU   5                        REGISTER               @OY14092 22060091
RWORK1   EQU   6                        REGISTER               @OY14092 22120091
RDEB     EQU   6                                                        22200020
R7       EQU   7                        REGISTER EQUATE          S21903 22400022
RDCB     EQU   8                                                        22600020
ROFF     EQU   9                                                        23000020
R9       EQU   9                        REGISTER               @OY14092 23100091
RLINK    EQU   9                        REGISTER               @OY14092 23200091
RSCB     EQU   ROFF                                                     23300020
LOCKI    EQU   X'10'                    LOCK INQUIRY           @SA70889 23320061
RINV     EQU   10                       INVITATION LIST ADDR            23350020
RDISP    EQU   11                                                       23600020
RBASE    EQU   12                       BASE REGISTER            S21903 23800022
R13      EQU   13                       REGISTER EQUATE          S21903 24000022
R14      EQU   14                       REGISTER EQUATE          S21903 24200022
R15      EQU   15                       REGISTER EQUATE          S21903 24400022
*        OTHER EQUATES                                                  24600020
X1E      EQU   X'1E'                    DEVICE CHECK BYTE      @OY13669 24610091
X08      EQU   X'08'                    HEX EIGHT                S99228 24620022
X1A      EQU   X'1A'                                                    24650020
ZERO     EQU   0                        LENGTH CONSTANT          S21903 24700022
ONE      EQU   1                        LENGTH CONSTANT          S21903 24710022
TWO      EQU   2                        LENGTH CONSTANT          S21903 24720022
THREE    EQU   3                        THREE                    S99228 24730022
FOUR     EQU   4                        LENGTH CONSTANT          S21903 24750022
FIVE     EQU   5                        LENGTH CONSTANT          S21903 25150022
PRI      EQU   4                                                        25600020
SEVEN    EQU   7                        LENGTH CONSTANT          S21903 25650022
EIGHT    EQU   8                        LENGTH CONSTANT          S21903 25950022
TWELVE   EQU   12                       LENGTH CONSTANT          S21903 26250022
SIXTEEN  EQU   16                       LENGTH CONSTANT          S21903 26550022
CNDZERO  EQU   8                                                 S22025 27000022
UCB      EQU   X'20'                                                    27400020
HI       EQU   X'80'                                                    28000020
BDFLAG   EQU   X'80'                    INMSG COMPLETE FLAG    @YA10232 28100009
DIS      EQU   X'01'                    DISABLE MASK           @OY14491 28200091
OFFHI    EQU   X'FF'-DIS                                       @OY14491 28230091
X40      EQU   X'40'               INTERNAL STOPLN INDICATOR   @SA71514 28260061
XBF      EQU   X'BF'               RESET INT. STOPLN MASK      @SA71514 28320061
XDF      EQU   X'DF'                    TURN OFF HK PROC BIT   @OZ24311 28360000
PRISTOP  EQU   X'E8'                    USED TO RETURN A STOPPED        28400020
*                                         LINE TO OP CTL                28800020
*                                         USED BY IEDQHK                29000020
*                                         TESTED BY OPERATOR CONTROL    29200020
ENDILIST EQU   X'FE'                    END OF INVITATION LIST   S21101 29250020
REG2     EQU   2                                                        29280022
LOCKR    EQU   X'20'                   LOCK RESPONSE FROM PUT S SA54930 29290000
XTEN     EQU   X'10'                                             S22025 29310022
OPNCHK   EQU   X'AC'                   FLAG THAT A PREPARE IS UP S22025 29340022
UNITOFF  EQU   24                       OFFSET TO EXTRA UNIT   @OX14763 29346091
STCBOFF  EQU   20                       OFFSET TO STCB IN UNIT @OX14763 29352091
OPCDE    EQU   12                       OFFSET TO OCOPTCDE     @OX14763 29358091
TERMOFF  EQU   16                       OFFSET TO TERM ENTRY   @OX14763 29364091
*                                        ADDRESS               @OX14763 29370091
AD       EQU   7                        MASK                   @OX14763 29376091
OCICHNGE EQU   X'49'                    ICHNGE COMMAND         @OX14763 29382091
SWITCH   EQU   13                       OFFSET TO OCSWITCH     @OX14763 29388091
STOPMM   EQU   X'20'                    STOP TERM MID-MSG FLAG @OX14763 29394091
         EJECT                                                          29400020
OPTCAMLN EQU   X'2F'                    TO TEST FOR OPEN TCAM LINE      29450020
RLNDISP  EQU   X'66'                    DISP FROM OPCSAVE2 TO HEX       29500020
*                                       RLN IN OPCBITSW+1 FROM CV       29550020
CNTOFF   EQU   6                        OFFSET TO COUNT IN CCW @YA07691 29551061
ALL      EQU   15                       MASK                   @OY14092 29551191
AL3      EQU   3                        LENGTH OF 3            @OY14092 29551291
CBREAK   EQU   X'40'                    BREAK FEATURE          @OY14092 29551391
T4       EQU   24                       LENGTH OF 24           @OY14092 29551491
SCTEOT   EQU   0                        INDEX TO EOT OFFSET    @OY14092 29551591
DISCON   EQU   X'01'                    DISCONNECT NEEDED      @OY14092 29551691
SCTDLEOT EQU   X'10'                    INDEX TO DLEEOT OFFSET @OY14092 29551791
OFF11    EQU   11                       OFFSET 11              @OY14092 29551891
         EJECT                                                          29552061
HIOCC    EQU   X'48'                    HALT I/O COMPLETION CODE Y02027 29555006
         SPACE                                                          29560020
         USING IEDQDISP,RDISP                                           29600020
         USING IEDQQCB,RQCB             QCB DSECT BASE           S21101 29650020
         USING IEDQLCB,RLCB                                             29800020
         USING IEDQAVTD,R13                                             30000020
         USING IHADCB,RDCB                                              30200020
         USING IEDQSCB,RSCB                                             30300020
         USING DEBNMSUB,RDEB                                            30400020
*                                                                       30600020
IEDQHK   IEDHJN ,                                                S22025 30800022
         DC    AL1(DSPMCPL8)            STCB VTO               @OY14092 31000091
         DC    AL3(*-1)                 STCB ADDRESS             S22025 31200022
         DC    A(0)                     REQUEST QUEUE          @OY14092 31260091
         USING REQELE,RELE              REQUEST ADDRESS        @OY14092 31320091
IEDQHK01 EQU   *                                                        31400020
         USING IEDQHK01,RBASE                                           31600020
         LR    RBASE,R15                BASE                            31800020
         LR    RELE,R1                  COPY PARAMETER ADDRESS   CLUP21 32200022
         LR    RLCB,RELE                SET LCB ADDRESS        @OY14092 32300091
         CLI   PRI(RELE),PRIOPCTL       ELEMENT OR LCB                  32400020
         BE    SRCHLCBS                 BRANCH IF ELEMENT        CLUP21 32600022
         CLI   PRI(RELE),PRILCBAT       REQUEST TO TEST FOR ATTN S22025 32660022
         BE    CHKTNT                   YES, BRANCH              S22025 32720022
*                                                                       32800020
         LR    RLCB,RELE                LCB - SET IN LCB REG            32830091
         ST    RLCB,LCBQCBA-1           SET TO POST LCB TO SELF@OY15473 32836091
         CLI   LCBPRI,X'DD'             REQUEST FROM STARTLINE @OY15473 32842091
         BE    EXCP1                    YES, ISSUE EXCP        @OY15473 32848091
         ST    R7,LCBQCBA-1             SET TO REPOST LCB TO HK@OY15473 32854091
         TM    LCBSTAT2,LCBDIAL         DIAL LINE              @OY13669 32860091
         BZ    ICHNG                    GO SET LCB STOPPED     @OY13669 32920091
         TM    LCBRSPRI,DIS             IS EXCPVR ALREADY DONE @OY14491 34800091
         BNO   EXCP                     NO                              35000020
*                                                                       35200020
         L     R7,LCBSTCBA-1            GET FIRST STCB ADDRESS   CLUP21 35420022
         CLI   ZERO(R7),DSPSNDSC        IS IT SEND SCHEDULER     CLUP21 35440022
         BNE   ICHNG                    BRANCH IF NOT            CLUP21 35460022
         MVC   LCBSTCBA(3),FIVE(R7)     REMOVE SEND SCHED STCB   CLUP21 35480022
         MVC   FIVE(3,R7),ONE(R7)       SAVE IN DESTINATION QCB  CLUP21 35500022
         ST    R7,ZERO(R7)              CHAIN STCB TO ITSELF     CLUP21 35520022
         MVI   ZERO(R7),DSPSNDSC        SET TO SEND SCHEDULER    CLUP21 35540022
         SH    R7,HALF8                 BACK UP TO QCB           CLUP21 35560022
         SR    RWORK,RWORK              ZERO 'CURRENTLY CONNECTEDCLUP21 35580022
         STH   RWORK,LCBTTCIN           TERMINAL' INDICATOR      CLUP21 35600022
         LR    RWORK,RLCB               SAVE LCB ADDRESS         CLUP21 35620022
         L     R15,AVTDISP+4            GET SEND SCHEDULER ADDR  CLUP21 35640022
         SH    R15,AVTHA2               BACK UP TO OFFSET        CLUP21 35660022
         AH    R15,ZERO(R15)            COMPUTE ENTRY POINT      CLUP21 35680022
         BALR  R14,R15                  LINK TO SELECT NEW LINE  CLUP21 35700022
         LR    RLCB,RWORK               RESTORE LCB ADDRESS      CLUP21 35720022
         B     ICHNG                    CHECK FOR RETURN                35800020
*                                                                       36000020
EXCP     EQU   *                                                        36200020
         MVI   LCBTPCD+10,ZERO          ZERO TP CODE FOR TSO     CLUP21 36300022
         OI    LCBRSPRI,DIS             TURN ON EXCP INDICATOR @OY14491 36400091
         MVC   LCBTTBIN,LCBTTCIN        SAVE CURRENTLY CONNECT @OY14092 36406091
         SR    RWORK,RWORK              CLEAR                           36600020
         STH   RWORK,LCBTTCIN           CLEAR TTCIN                     36800020
         XC    LCBCPA(T4),LCBCPA        CLEAR CCW AREA         @OY14092 37000091
         LA    R1,LCBCPA                POINT TO START         @OY14092 37030091
         L     RDCB,LCBDCBPT            GET DCB ADDR           @OY14092 37060091
         L     RDCB,DCBSCTAD-1          GET SCT ADDR           @OY14092 37090091
         TM    LCBSTAT2,LCBSYNC         BI-SYNC                @OY14092 37120091
         BZ    NOEOT                    NO, CONTINUE           @OY14092 37150091
         TM    LCBTPCD+OFF11,DISCON     DISCONNECT NEEDED      @OY14092 37180091
         BZ    NOEOT                    NO, CONTINUE           @OY14092 37210091
         NI    LCBTPCD+OFF11,AVTEFF-DISCON  RESET DISCONNECT   @OY14092 37240091
         LA    RWORK,SCTDLEOT           GET DLEEOT INDEX       @OY14092 37270091
         IC    RWORK,ZERO(RWORK,RDCB)   GET OFFSET TO COUNT    @OY14092 37300091
         LTR   RWORK,RWORK              CHARS SPECIFIED        @OY14092 37330091
         BZ    NOEOT                    NO, BRANCH             @OY14092 37360091
         LA    RWORK,ZERO(RWORK,RDCB)   GET ADDR OF COUNT      @OY14092 37390091
         USING IEDQCCW,R1               ADDRESSABILITY         @OY14092 37420091
         MVC   CCWCOUNT+1(ONE),ZERO(RWORK) SET COUNT           @OY14092 37450091
         LA    RWORK,ONE(,RWORK)        BUMP TO CHARS          @OY14092 37480091
         ST    RWORK,CCWADDR-1          SET DATA ADDR          @OY14092 37510091
         MVI   CCWOPCDE,CCWWRITE        SET WRITE COMMAND      @OY14092 37540091
         MVI   CCWFLAGS,CCWCC+CCWSLI    SET CHAINING           @OY14092 37570091
         LA    R1,EIGHT(,R1)            BUMP CCW POINTER       @OY14092 37600091
NOEOT    EQU   *                                               @OY14092 37630091
         ST    RLCB,CCWADDR-1           SET ADDR               @OY14092 37660091
         MVI   CCWOPCDE,CCWDISAB        DISABLE COMMAND        @OY14092 37690091
         MVI   CCWFLAGS,CCWCC+CCWSLI    SET CHAINING           @OY14092 37720091
         MVI   CCWCOUNT+1,ONE           SET DISABLE COUNT      @OY14092 37750091
         LA    R1,EIGHT(,R1)            BUMP TO NEXT CCW       @OY14092 37780091
         ST    RLCB,CCWADDR-1           SET ADDR               @OY14092 37810091
         MVI   CCWOPCDE,CCWNOP          SET NOOP COMMAND       @OY14092 37840091
         MVI   CCWCOUNT+1,ONE           SET NOOP COUNT         @OY14092 37870091
         MVI   LCBTPCD,TWO              SET FIRST TPCODE       @OY14092 37900091
         MVC   LCBTPCD+ONE(TWO),LCBTPCD SET OTHER TPCODES      @OY14092 37930091
         DROP  R1                                              @OY14092 37960091
         USING IEDQQCB,RQCB                                    @OY14092 37990091
         SPACE                                                          38020091
         L     RWORK,AVTHK              STOPLINE QCB ADDRESS     CLUP21 38200022
         ST    RWORK,AVTEZERO(RLCB)     PUT IN QCB FLD OF LCB           39000020
         MVI   LCBTSTSW,AVTEFF          TURN ON TEST/SET SWITCH         39200020
         OI    LCBSTAT2,LCBNEGRP        SET NEG RESPONSE                39400020
EXCP1    LA    RWORK,LCBCPA             GET CHANNEL PROGRAM ADDR S22025 39600022
         ST    RWORK,LCBSTART-1         SET CHANNEL PROGRAM      CLUP21 39800022
*                                         START ADDRESS          CLUP21 39900022
         MVI   LCBINCAM,AVTEZERO        RESET RETRY COUNT      @OZ28736 39950082
         LA    R1,LCBFLAG1              IOB FOR IOS              CLUP21 40000022
         EXCPVR (1),SUBSYS                                       X01004 40200005
         TM    LCBTPCD+11,OPNCHK        RETURN FROM PREPARE ?    S22025 40220022
         BNO   DSPDISP                  NO EXIT                  S22025 40240022
         LA    R3,DSPDISP               GET RETURN ADDRESS       S22025 40260022
         L     RDCB,LCBDCBPT            GET DCB BASE             S22025 40280022
         L     RDEB,DCBDEBAD            GET DEB ADDRESS          S22025 40300022
         B     HIO1                     GO DO HALT I/O           S22025 40320022
*                                                                       40400020
LOOPUNIT EQU   *                                               @OY13669 40500091
         L     RWORK,AVTEZERO(RWORK)    NEXT ELEMENT           @OY13669 40600091
         B     CHKLCB                   COMPARE LCB            @OY13669 40700091
*                                                              @OY13669 40800091
ICHNG    EQU   *                                                        41000020
         TM    LCBRSPRI,DIS             DISABLE DONE           @OY14491 41005091
         BO    EXCPDONE                 YES                    @OY13669 41010091
         L     RWORK,AVTOCGET           OPERATOR CONTROL AVT   @OY13669 41015091
         USING IEDQOPCD,RWORK                                  @OY13669 41020091
         L     RWORK,OPCWAITL           OP CTL STOPLINE LIST   @OY13669 41025091
         USING IEDQOPCE,RWORK                                  @OY13669 41030091
CHKLCB   EQU   *                                               @OY13669 41035091
         LTR   RWORK,RWORK              OPCE ADDRESS ZERO?     @OY20036 41035282
         BZ    FOUND                    YES                    @OY20036 41035482
         CLI   OCOPTCDE,OCVARY          VARY REQUEST           @OY14092 41035891
         BNE   GETREQ                   SKIP GROUP CHECK       @OY14092 41036691
         CLC   LCBDCBPT+1(THREE),OCMODNME+FIVE  SAME LINE GRP? @OY14092 41037491
         BNE   LOOPUNIT                 NO,LOOK AT NEXT        @OY14092 41038291
GETREQ   EQU   *                                               @OY14092 41039091
         L     R1,OCUNIT                PICK UP STOPLINE UNIT  @OY13669 41040091
         CLM   RLCB,SEVEN,SIXTEEN+ONE(R1) THIS LCB             @OY13669 41045091
         BE    FOUND                    YES,GO CHECK IT        @OY14092 41050091
         TM    OCFLAG,OCATTACH          ATTACHED REQUEST       @OY14092 41050891
         BZ    EXCPDONE                 NO, DON'T DISABLE      @OY14092 41051691
         L     RWORK,OCELEM             GET NEXT               @OY14092 41052491
         B     GETREQ                                          @OY14092 41053291
FOUND    EQU   *                                               @OY14092 41054091
         SPACE                                                          41055091
         MVI   LCBSTAT1,LCBOCNI+LCBRECVN SET STATUS            @OY13669 41060091
         LTR   RWORK,RWORK              OPCE ADDRESS ZERO?     @OY20036 41061082
         BZ    CKLOCAL                  YES,CHECK FOR LOCAL    @OY20036 41062082
         TM    OCSWITCH,X40             LINE TO BE RESTARTED   @OY13669 41065091
         BO    EXCPDONE                 YES, DO NOT DISABLE    @OY13669 41068091
CKLOCAL  EQU   *                                               @OY20036 41069082
         CLI   LCBRSKEY,X1E             LOCAL DEVICE ?         @OY13669 41071091
         BNE   EXCP                     GO SET LCB STOPPED     @OY13669 41072091
EXCPDONE EQU   *                                               @OY13669 41075091
         NI    LCBRSPRI,OFFHI           RESET DISABLE          @OY13669 41080091
         SPACE                                                          41085091
         MVI   LCBPRI,PRISTOP           SET LINE STOPPED PRTY  @OZ29091 41100082
         TM    LCBINSRC+2,TWO           LCB IN TIME DELAY        S22025 41120022
         BNO   FFREE                    NO-BR                    S22025 41140022
*                                                                S22025 41160022
         LR    R1,RLCB                  SET TO REMAVE LCB FROM   S22025 41180022
         L     R15,AVTHG02              TIME DELAY QUEUE         S22025 41200022
         BALR  R14,R15                  REMOVE LCB FROM QUEUE    S22025 41220022
*                                                                S22025 41240022
         TM    LCBSTAT2,LCBDIAL         IS THIS A DIAL LINE      S22025 41260022
         BO    FFREE                    YES-BYPASS               S22025 41280022
*                                                                S22025 41300022
         CLI   LCBRSKEY,X1A             BUFFERED TERMINAL        S22025 41320022
         BE    FFREE                    YES-BR                   S22025 41340022
*                                                                S22025 41360022
         LA    R7,LCBRSKEY              PUTIN THE RECIEVE        S22025 41380022
         LR    R1,R7                    SCHEDULER                S22025 41400022
         BAL   R14,DSPPRIOR             BACK ON QUEUE            S22025 41420022
*                                                                S22025 41440022
FFREE    EQU   *                                                        41600020
         TM    AVTBIT1,AVTCLOSN         CLOSEDOWN              @OY16355 41603000
         BO    GETOFF                   YES, LOG USERS OFF     @OY16355 41604000
         L     RWORK,AVTOCGET           GET WORKAREA ADDRESS   @OY16355 41606000
         ICM   RWORK,AD,OPCWAITL+1-IEDQOPCD(RWORK) GET FIRST RE@OY16355 41609000
GRPCHK   EQU   *                                               @OY16355 41610000
         BZ    POSTLCB                  NONE THERE             @OY16355 41612000
         CLC   LCBDCBPT+1(THREE),OCMODNME+FIVE   SAME GROUP    @OZ28940 41615082
         BE    FOUNDGRP                 YES, BRANCH            @OY16355 41616000
         ICM   RWORK,AD,ONE(RWORK)      NO, GET NEXT           @OY16355 41618000
         B     GRPCHK                   GO CHECK NEXT          @OY16355 41621000
FOUNDGRP EQU   *                                               @OY16355 41622000
         L     RELE,OCUNIT              GET ADDR OF QHK REQ    @OY16355 41624000
         CLM   RLCB,AD,REQLCBA          CORRECT REQUEST        @OY16355 41627000
         BE    OFFQUE                   YES, GO CHECK OPTION   @OY16355 41628000
         TM    OCFLAG,OCATTACH          ANY MORE REQUESTS      @OY16355 41630000
         BZ    POSTLCB                  NO, BRANCH             @OY16355 41633000
         ICM   RWORK,AD,OCELEM+ONE      GET RELATED ONE        @OY16355 41634000
         B     FOUNDGRP                 GO CHECK               @OY16355 41636000
OFFQUE   EQU   *                                               @OY14092 41648091
         TM    REQOPT,LOGOFF            FORCE LOGOFF REQUESTED @OY14092 41651091
         BZ    POSTLCB                  NO, BRANCH TO OPCTL    @OY14092 41654082
GETOFF   EQU   *                                                        41654182
         TM    AVTBIT1,AVTCLOSN         CLOSEDOWN              @OY19040 41654282
         BZ    ALRDYSET                 NO,ALREADY SET         @OY19040 41654382
         L     RWORK,AVTOCGET                                  @OY19040 41654482
         ICM   RWORK,AD,OPCWAITL+1-IEDQOPCD(RWORK)             @OY19040 41654582
*                                       TOP REQUEST            @OY19040 41654682
         L     RELE,OCUNIT              STOPLINE UNIT          @OY19040 41654782
ALRDYSET EQU   *                                                        41654882
         LR    R1,RELE                  SET REGISTER FOR       @OY19040 41654982
*                                       INVSCAN                @OY19040 41655082
         CLI   REQPRI,AVTEZERO          HAS PRTY BEEN ZEROED   @OY19040 41655182
         BE    GOSCAN                   YES                    @OY19040 41655282
         SR    R1,R1                    SET REG FOR INVSCAN    @OY19040 41655382
GETNEXT  EQU   *                                               @OY19040 41655482
         TM    OCFLAG,OCATTACH          ANY MORE REQUESTS      @OY19040 41655582
         BZ    GOSCAN                   NO                     @OY19040 41655682
         ICM   RWORK,AD,OCELEM+ONE      GET RELATED ONE        @OY19040 41655782
         L     RWORK1,OCUNIT            GET ADDR OF HK REQ     @OY19040 41655882
         CLI   REQPRI-REQELE(RWORK1),AVTEZERO                  @OY19040 41655982
*                                     HAS PRIORITY BEEN ZEROED @OY19040 41656082
         BNE   GETNEXT                  GET NEXT ELEMENTS      @OY19040 41656182
         LR    R1,RWORK1                SET REG FOR INVSCAN    @OY19040 41656282
GOSCAN   EQU   *                                               @OY19040 41656382
         BAL   RLINK,INVSCAN            SCAN FOR SESSIONS      @OY14092 41657091
*        B     POSTLCB                  POST LCB               @OY14092 41660091
POSTLCB  EQU   *                                               @OY14092 41663091
         L     RDCB,LCBDCBPT            GET DCB ADDRESS        @SA70195 41670061
         SR    RWORK,RWORK              CLEAR FOR IC           @SA70195 41740061
         IC    RWORK,LCBUCBX            GET RLN - 1            @SA70195 41810061
         SLL   RWORK,2                  SHIFT RLN              @SA70195 41840061
         L     RWORK,DCBINVLI(RWORK)    GET INVLIST ADDRESS    @SA70195 41880061
         LA    RWORK,AVTECD8(RWORK)     POINT TO FIRST ENTRY   @SA70195 41950061
         ST    RWORK,AVTDOUBL           SAVE IN WORK AREA      @SA70195 42020061
         MVC   LCBINVPT,AVTDOUBL+1      SET CURRENT I LIST PTR @SA70195 42090061
         LA    RWORK,AVTOPCOB           GET OP CTL QCB ADDR             42200020
         LR    R1,RLCB                                                  42300020
         ST    RWORK,LCBQCBA-1          SET QCB ADDRESS          CLUP21 43000022
         MVI   LCBSTAT1,AVTEZERO        SET LINE STOPPED       @OZ29091 43700082
         TM    AVTBIT1,AVTCLOSN         CLOSEDOWN              @OZ24311 43710000
         BNO   NOCLS                    NORMAL PROCESSING      @OZ24311 43720000
         L     RWORK,AVTOCGET           OPERATOR CTL AVT       @OZ24311 43730000
         USING IEDQOPCD,RWORK                                  @OZ24311 43740000
         L     RWORK,OPCWAITL           GET WAITL CHAIN        @OZ24311 43750000
         USING IEDQOPCE,RWORK                                  @OZ24311 43760000
         CLC   OCBACKUP(TWO),MODZ1      CLOSEDOWN OPCE         @OZ24311 43770000
         BNE   NOCLS                    STILL IN IGCZ110D      @OZ24311 43780000
         NI    OCSWITCH,XDF             TURN HK PROC SWTCH OFF @OZ24311 43790000
NOCLS    EQU   *                        NOT CLOSEDOWN          @OZ24311 43800000
         XC    LCBINSRC,LCBINSRC        CLEAR LCB OF LOCK       SA66918 43900054
         L     RSCB,LCBSCBA-1           SCB ADDRESS             SA66918 44100054
         NI    SCBSTATE,AVTEFF-(SCBLCK1N+SCBMSGLN) CLEAR LOCK   SA66918 44300054
         L     RWORK,LCBSTCBA-1         GET FIRST STCB         @OX14763 44360091
         CLC   AVTEZERO(FOUR,RWORK),STOPSTCB THIS MODULE       @OX14763 44420091
         BNE   DSPPOST                  NO, GO POST            @OX14763 44480091
         MVC   LCBSTCBA(THREE),FIVE(RWORK) DELINK STCB         @OX14763 44540091
         B     DSPPOST                  RETURN                          44600020
*                                                                       44800020
SETBIT   EQU   *                                                        45000020
         OI    LCBSTAT1,LCBOCNI         REQUEST LCB FROM SCHED   CLUP21 45600022
         L     R1,UNITOFF(RELE)         GET EXTRA UNIT FOR     @OX14763 45620091
*                                       BFRD STOP TERMINAL     @OX14763 45720091
         LTR   R1,R1                    IS ONE THERE           @OX14763 45820091
         BZ    DSPDISP                  NO, EXIT               @OX14763 45920091
         MVC   STCBOFF(ENDSTOP-STOPSTCB,R1),STOPSTCB INSERT    @OX14763 46020091
*                                       STOPLN STCB IN UNIT    @OX14763 46120091
         LA    R1,STCBOFF(R1)           GET STCB ADDR          @OX14763 46220091
         LA    R7,LCBSTCBA-1            SET TO INSERT STCB     @OX14763 46320091
         B     DSPPRIO                  GO INSERT IT           @OX14763 46420091
*                                                                       47200020
SRCHLCBS EQU   *                                               @OY14092 47400091
         L     RLCB,REQLCBA-ONE         SET LCB ADDRESS        @OY14092 47940091
         CLI   LCBSTAT1,AVTEZERO        IS LCB STOPPED         @OZ30095 47943082
         BE    DSPDISP                  YES, EXIT              @OZ30095 47946082
         LH    R9,LCBTTCIN              PICK UP TTCIN          @OY19040 47950082
         ST    R9,REQPRI                STORE IN STOPLINE ELE  @OY19040 47960082
         TM    REQOPT,CKTSO             TSO CHECK REQUESTED    @OY14092 47970091
         BZ    CONTINHK                 NO,CONTINUE            @OY14092 48000091
         LR    R1,RELE                  SET REG FOR INVSCAN    @OY19040 48010082
         BAL   RLINK,INVSCAN            SCAN INVLIST           @OY14092 48030091
         B     CONTINHK                 NO TSO FOUND           @OY14092 48060091
TSOERR   EQU   *                                               @OY14092 48090091
         SPACE                                                          48369820
         LR    R1,RELE                  YES, PASS ELEM BACK TO CV       48379820
         LA    RWORK,AVTOPCOB           GET OP CTL QCB ADDR             48389820
         ST    RWORK,ZERO(RELE)         PUT OP CTL QCB ADDR IN ELEM     48391820
         MVI   FOUR(RELE),PRISTOP       SET E8 PRI FOR USE IN CV        48393820
         B     DSPPOST                  RETURN TO TELL CV THAT THIS     48395820
*                                       LINE NOT STOPPED DUE TO TSO     48397820
         SPACE                                                          48398220
         SPACE                                                          48399420
CONTINHK EQU   *                                                        48399520
         L     RLCB,SIXTEEN(RELE)       PICK UP LCB ADDRESS      CLUP21 48399822
         L     RDEB,REQDEBA             GET DEB ADDR           @OY14092 49399891
TESTACT  EQU   *                                                        51700020
         TM    LCBSTAT1,LCBFREEN        LINE ALREADY FREE               52200020
         BO    DIALCHK                  YES-BR                   S22025 52400022
         SPACE 2                                                        52600022
         TM    EIGHT(RELE),HI           HALT LINE IMMEDIATE      S22025 52620022
         BO    HIO                      YES, BRANCH              S22025 52640022
         SPACE 2                                                        52660022
         TM    LCBSTAT1,LCBSENDN+LCBRECVN  LCB MARKED AS SENDING S22025 52680022
*                                          AND RECEIVING         S22025 52700022
         BO    ICHNG                    YES, BRANCH              S22025 52720022
         SPACE 2                                                        52740022
         TM    LCBSTAT2,LCBDIAL         IS THIS A DIAL LINE      S22025 52800022
         BNO   ACT                      NO-BR                    S22025 53000022
*                                                                S22025 53200022
         TM    AVTBIT1,AVTCLOSN         CLOSE DOWN IN PROGRESS   S22025 53400022
         BO    HIO                      YES-BR                   S22025 53600022
         TM    LCBTSTSW,HI                                       S22025 53800022
         BO    ACT                      YES-BR                   S22025 54000022
*                                                                S22025 54200022
TST      EQU   *                                                        54800020
         TS    LCBTSTSW                 BEEN SET BEFORE          CLUP21 55000022
         BZ    HIO                      BRANCH IF NOT TO HALTIO  CLUP21 55200022
*                                                                       55400020
         B     SETBIT                   GO REQUEST LCB           S22025 55600022
DIALCHK  EQU   *                                                 S22025 55800022
         TM    LCBSTAT2,LCBDIAL         IS THIS A DIAL LINE      S22025 55900022
         BNO   SETFREE                  NO-BR                    S22025 56000022
         L     R14,LCBSCBA-1            GET DIAL SCB ADDR        S22025 56100022
         TM    SCBQTYPE-IEDQSCB(R14),SCBBFMM MIDDLE OF MSG       S22025 56200022
         BO    SETBIT                   YES-BR                   S22025 56300022
         MVI   LCBSTAT1,LCBOCNI+LCBRECVN TURN ON STOPLINE BIT  @OY11167 56350081
         B     EXCP                     SET LINE STOPPED       @OY11167 56400081
SETFREE  EQU   *                                                        56800020
         SR    R15,R15                  CLEAR REGISTER           S99228 56950022
         IC    R15,LCBUCBX              PICK UP RLN              S99228 56955022
         SLL   R15,TWO                  MULTIPLY BY FOUR         S99228 56960022
         L     RDCB,LCBDCBPT            PICK UP DCB ADDR         S99228 56965022
         L     RINVLIST,DCBINVLI(R15)   PICK UP INVLIST ADDR     S99228 56970022
         CLI   LCBRSKEY,X1A             BUFFERED TERMINALS       S99228 56975022
         BE    QHK010                   YES, GO CHECK LINE STATUSS99228 56980022
         SR    R1,R1                    CLEAR REGISTER           S99228 56985022
         IC    R1,DCBEIOBX              INSERT LENGTH OF IOB     S99228 56990022
         SH    R1,AVTHA4                REDUCE LCB LENGTH BY 8   S99228 56995022
         SH    R1,AVTHA4                BYTES TO POINT TO EXTEN. S99228 57000022
         LA    R15,ZERO(R1,RLCB)        PICK LCB EXTEN. ADDR.    S99228 57005022
         USING IEDQLCBX,R15             SET ADDRESSABILITY       S99228 57010022
         TM    LCBXFLAG,LCBGPCTV+LCBERPND G.P. OR ERP ACTIVE     S99228 57015022
         BZ    ICHNG                    NO, SET LCB STOPPED      S99228 57020022
         TM    AVTBIT1,AVTCLOSN         IS CLOSEDOWN IN PROGRESS        57021022
         BO    ICHNG                    YES, SET LCB STOPPED            57022022
         B     SETBIT                   YES, GO REQUEST LCB      S99228 57025022
QHK010   EQU   *                                                 S99228 57030022
         L     RINVLIST,DCBINVLI(R15)   GET THE INVITATION LIST  S21101 57051020
*                                         ADDRESS FOR THIS LINE  S21101 57051520
         CLI   FOUR(RINVLIST),ZERO      ARE WE CURRENTLY SENDING S21101 57052020
*                                         TO ANY STATIONS ON     S21101 57052520
*                                         THIS LINE              S21101 57053020
         BNE   SETBIT                   YES, SET THE STOP LINE   S21101 57053520
*                                         REQUEST BIT AND WAIT   S21101 57054020
*                                         FOR A SCHEDULER TO     S21101 57054520
*                                         POST THE LCB TO IEDQHK S21101 57055020
         CLI   ONE(RINVLIST),ZERO       ARE WE CURRENTLY         S21101 57055520
*                                         RECEIVING FROM ANY     S21101 57056020
*                                         STATIONS ON THIS LINE  S21101 57056520
         BE    ICHNG                    NO, LINE CAN BE TAKEN    S21101 57057020
         LA    RDEB,ICHNG               SET RETURN ADDR          S22025 57057222
         EJECT                                                          57057520
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *  S21101 57058020
*                                                             *  S21101 57058520
*        THIS SUBROUTINE WILL COMPUTE THE ADDRESS OF A        *  S21101 57059020
*        DESTINATION QCB BASED ON THE INVITATION LIST         *  S21101 57059520
*                        POINTER                              *  S21101 57060020
*                                                             *  S21101 57060520
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *  S21101 57061020
GETQCBAD EQU   *                                                 S21101 57061520
         LA    RWORK,EIGHT(RINVLIST)    GET THE ADDRESS OF THE   S21101 57062020
*                                         FIRST INVITATION LIST  S21101 57062520
*                                         ENTRY                  S21101 57063020
         SR    RDCB,RDCB                CLEAR A WORK REGISTER    S21101 57063520
         IC    RDCB,TWO(RINVLIST)       GET THE SIZE OF EACH     S21101 57064020
*                                         ILIST ENTRY            S21101 57064520
DECISIZE EQU   *                                                 S21101 57065020
         LR    R14,RDCB                 COPY THE SIZE                   57065520
         BCTR  R14,0                    REDUCE THE SIZE BY 1     S21101 57066020
         IC    R14,ZERO(R14,RWORK)      PICK UP THE INDEX TO THE S21101 57066520
*                                         TNT OFFSET             S21101 57067020
         AR    R14,R14                  DOUBLE TO COMPUT THE     S21101 57067520
*                                         ILIST OFFSET           S21101 57068020
         LR    R15,RINVLIST             COPY THE ADDRESS OF THE  S21101 57068520
*                                         INVITATION LIST        S21101 57069020
         SR    R15,R14                  SUBTRACT THE INDEX FROM  S21101 57069520
*                                         THE BEGINNING ADDRESS  S21101 57070020
         LH    R1,ZERO(R15)             GET THE TNT OFFSET       S21101 57070520
         L     R15,AVTRNMPT             GET THE ADDRESS OF THE   S21101 57071020
*                                         TNT CONVERSION ROUTINE S21101 57071520
         BALR  R14,R15                  BRANCH AND LINK TO IT    S21101 57072020
         SPACE 3                                                        57072520
         L     RQCB,ZERO(R1)            LOAD THE DESTINATION     S21101 57073020
*                                         QCB ADDRESS                   57073520
         SR    R0,R0                    CLEAR                    S22025 57074022
         SR    R14,R14                  REGS FOR                 S22025 57074222
         SR    R15,R15                  INDEXING                 S22025 57074422
         IC    R14,QCBSCBOF             GET SCB OFFSET           S22025 57074622
         IC    R15,AVTSCBSZ             GET SCB SIZE             S22025 57074822
         MR    R14,R14                 SIZE  X OFFSST EQ INDEX   S22025 57075022
         L     R14,LCBSCBDA-1           SCB DIRECTORY POINTER    S22025 57075222
         LA    R15,ZERO(R14,R15)        GET SCB ADDR             S22025 57075422
         TM    SCBQTYPE-IEDQSCB(R15),SCBBFMM MIDDLE OF MSG       S22025 57075622
         BO    SETBIT                   YES RETURN               S22025 57075822
         SPACE 3                                                        57076020
         AR    RWORK,RDCB               INCREMENT THE CURRENT    S21101 57076520
*                                         ILIST POINTER          S21101 57077020
         CLI   ZERO(RWORK),ENDILIST     IS THIS THE END OF THE   S21101 57077520
*                                         INVITATION LIST        S21101 57078020
         BCR   CNDZERO,RDEB             YES-BR                   S22025 57078522
         CLI   ONE(RWORK),ENDILIST      IS THIS THE END OF THE   S21101 57079020
*                                         INVITATION LIST        S21101 57079520
         BCR   CNDZERO,RDEB             YES-BR                   S22025 57080022
         B     DECISIZE                 COMPUTE NEXT QCB ADDRESS S21101 57080520
         EJECT                                                          57081020
ACT      EQU   *                                                        57600020
         CLI   LCBCPA+24,CCWPOLL        AUTOPOLL LINE            CLUP21 57800022
         BNE   BSC                      BRANCH IF NOT            CLUP21 58000022
*                                                                       58200020
         ST    RLCB,AVTSAVE2            LCB POINTER              Y05331 58210005
         L     R1,AVTSAVTP              SECONDARY AVT POINTER    Y05331 58220005
         USING IEDNSVTD,R1                                       Y05331 58230005
         TM    SAVTDIAF,SAVTVIRT        RUNNING UNDER VM  ?      Y05331 58240005
         BZ    NOVIRT                  * NO,BRANCH               Y05331 58250005
         L     R15,SAVTDIAG             VIRTUAL DIAGNOSE ROUTINE Y05331 58260005
         DROP  R1                                                Y05331 58270005
         LA    R0,LCBCPA+56             TIC ADDRESS              Y05331 58280005
         ST    R14,AVTSAVE2+24          R14 POSSIBLY NEDDS SAVINGY05331 58290005
         MVI    LCBCPA+56,CCWNOP        NOP VIRTUAL TIC          Y05331 58300005
         BAL   R14,4(,R15)              NOP CORRESPONDING REALTICY05331 58310005
         L     R14,AVTSAVE2+24     RESTORE R14                   Y05331 58320005
         B     SETBIT                   GO REQUEST LCB           Y05331 58330005
         SPACE                                                          58340005
NOVIRT   EQU   *                                                 Y05331 58350005
         MVI   LCBCPA+56,CCWNOP         SET NOP IN CCW           CLUP21 58400022
         B     SETBIT                   GO REQUEST LCB           CLUP21 58600022
*                                                                       58800020
BSC      EQU   *                                                        59000020
         TM    LCBSTAT2,LCBSYNC         BI-SYNCH LINE            CLUP21 59200022
         BNO   SENSE                    BRANCH IF NOT            CLUP21 59400022
*                                                                       59600020
         CLI   LCBCPA+16,CCWPREP        PREPARE ON THE LINE      CLUP21 59800022
         BNE   SETBIT                   BRANCH IF NOT            CLUP21 60000022
*                                                                       60200020
         B     TST                      RETURN TO TEST-AND-SET   CLUP21 60400022
*                                                                       60600020
SENSE    EQU   *                                                        60800020
         L     RWORK,LCBCPA+24          ADDRESS THE SENSE BYTE   CLUP21 60900022
         CLI   LCBCPA+24,CCWSENSE       SENSE COMMAND            CLUP21 61000022
         BE    CLI                      BRANCH IF YES            CLUP21 61100022
*                                                                       61400020
         CLI   LCBCPA+32,CCWSENSE       WORLD TRADE              CLUP21 61600022
         BNE   SETBIT                   BRANCH IF NOT            CLUP21 61800022
*                                                                       62000020
         L     RWORK,LCBCPA+32          ADDRESS THE SENSE BYTE   CLUP21 62300022
*                                                                       62600020
CLI      EQU   *                                                        63200020
         CLI   LCBCSWSV,AVTEFF          HAS DATA ALREADY BEEN    X01004 63400005
*                                       ENTERED                  X01004 63500005
         BNE   SETBIT                   NO, GO REQUEST LCB       CLUP21 63600022
*                                                                       63800020
HIO      EQU   *                                                        64000020
         LA    R3,SETBIT                SET UP BRANCH AFTER EXCP S22025 64100022
         OI    LCBSTAT1,LCBOCNI         REQUEST LCB                     64200020
         L     RSCB,LCBSCBA-1           POINT TO THE SCB         CLUP21 64260022
         TM    SCBSTATE,SCBLCK1N+SCBMSGLN LCB IN LOCK MODE      SA54930 64280000
         BZ    HIO1                    NO, PROCEED              SA54930 64300000
         NI    SCBSTATE,X'FF'-(SCBLCK1N+SCBMSGLN) TURN OFF LOCK         64320020
         TM    LCBINSRC+2,LOCKR+LOCKI   AFTER LOCK & BEFORE PUT@SA70889 64330061
         BNZ   LOCKCLR                  YES, BRANCH            @SA70889 64340061
CLRINSRC EQU   *                                               @YA10232 64345009
         XC    LCBINSRC(3),LCBINSRC    CLEAR LCB LOCK FLAGS     SA54930 64350000
HIO1     EQU   *                                                 S22025 64360022
         SR    RWORK,RWORK              CLEAR                           64600020
         IC    RWORK,LCBUCBX            GET UCB INDEX                   64800020
         SLL   RWORK,TWO                MULTIPLY BY FOUR                65000020
         L     R1,UCB(RDEB,RWORK)       GET UCB ADDR                    65200020
         LA    R1,ZERO(R1)              CLEAR HIGH ORDER BYTE    CLUP21 65300022
         MVI   LCBECBCC,HIOCC           SET HALT I/O COMPLETION  Y02027 65350006
         IOHALT (1)                     HALT I/O ON LINE                65400020
*                                                                       65600020
         LTR   R15,R15                  RETURN CODE ZERO        SA67759 65630005
         BZR   R3                       YES, HIO COMPLETE       SA67759 65660005
         SR    R15,R15                  CLEAR FOR COMPARE      @ZA02055 65690061
         CLM   R15,15,LCBCSW+THREE      DID CHANNEL PROGRAM    @ZA02055 65700061
*                                        COMPLETE               SA67759 65720005
         BZ    HIO1                     NO, REISSUE HIO         SA67759 65750005
         BR    R3                       IF PROCESSING OP CONTROL S22025 65800022
*                                       BRANCH TO SET STOPLINE   S22025 65804022
*                                       BIT.  IF CHECKING FOR AN S22025 65808022
*                                       ATTENTION SIGNAL EXIT TO S22025 65812022
*                                       DSPDISP                  S22025 65816022
         SPACE 5                                                        65820022
CHKTNT   EQU   *                                                        65840022
         LR    RLCB,RELE                GET LCB BASE             S22025 65860022
ISSPRP   MVC   LCBCSWSV(7),LCBCSW       SAVE CSW                 S22025 65880022
         MVC   LCBCPA(8),PREPCCW        SET UP PREPARE CCW       S22025 65900022
         STCM  RLCB,7,LCBCPA+1          VALID FIXED CORE ADDR    Y01004 65910005
         MVI   LCBTPCD,XTEN             SET UP TP OP CODE        S22025 65920022
         MVI   LCBTPCD+11,OPNCHK        SET OPEN LINE CHECK      S22025 65940022
         B     EXCP1                    GO ISSUE PREPARE         S22025 65960022
LOCKCLR  EQU   *                                                        65963000
         LH    R1,LCBTTCIN             TERMINAL INDEX           SA54930 65966000
         L     R15,AVTRNMPT            ADDRESS OF ENABLED SRCH  SA54930 65969000
         USING IEDQTNTD,R15            ADDRESSABILITY           SA54930 65972000
         BAL   R14,TNTCODE             GET TERMINAL ENTRY       SA54930 65975000
         DROP  R15                                              SA54930 65978000
         USING IEDQTRM,R1                                       SA54930 65981000
         L     R1,TRMDESTQ-1           GET QCB ADDRESS          SA54930 65984000
         USING IEDQQCB,R1                                       SA54930 65987000
         MVI   QCBLKRLN,ZERO           CLEAR LOCK REL LINE      SA54930 65990000
         TM    LCBINSRC+2,BDFLAG        HAS INMSG COMPLETED    @YA10232 65991009
         BO    CLRINSRC                 NO, ISSUE THE HIO      @YA10232 65992009
         XC    LCBINSRC(3),LCBINSRC    CLEAR LCB LOCK FLAGS     SA54930 65993000
         B     ICHNG                                                    65996091
INVSCAN  EQU   *                                                        65997091
         SR    R3,R3                    CLEAR FOR INDEX        @OY14092 65998091
         IC    R3,LCBUCBX               GET RLN                @OY14092 65999091
         SLL   R3,TWO                   MULTIPLY BY FOUR                66000091
         L     RDCB,LCBDCBPT            GET DCB ADDRESS        @OY18823 66001000
         L     RINV,DCBINVLI(R3)        GET CORRECT INVLIST    @OY14092 66003091
         LA    RWORK,SEVEN(,RINV)       POINT TO LIST -7       @OY14092 66004091
         SR    R3,R3                    CLEAR FOR COUNTER      @OY14092 66005091
         IC    R3,ONE(,RINV)            GET ACTIVE ENTRIES     @OY14092 66006091
         LTR   R3,R3                    ANY ACTIVE             @OY14092 66007091
         BZR   RLINK                    NO, RETURN TO CALLER   @OY14092 66008091
         L     R15,AVTRNMPT             GET LOOKUP RTN ADDR    @OY14092 66009091
         TM    LCBSTAT2,LCBDIAL         DIAL LINE              @OY14092 66010091
         BZ    NOTDIAL                  NO, CONTINUE           @OY14092 66011091
         LTR   R1,R1                    VALID STOPLINE ELEMENT @OY19040 66012082
*                                       FOUND                  @OY19040 66012282
         BZ    NOTDIAL                  NO USE INVLIST         @OY19040 66012482
         LH    R1,REQLINK+ONE-REQELE(R1) PICK UP TTCIN TO USE  @OY19040 66012682
         LTR   R1,R1                    ONE THERE              @OY14092 66013091
         LA    R3,ONE                   SET COUNT TO 1         @OY14092 66014091
         BH    GETENTRY                 BRANCH IF ONE THERE    @OY14092 66015091
         IC    R3,ONE(,RINV)            RESTORE TO ACT ENTRIES @OY14092 66016091
NOTDIAL  EQU   *                                               @OY14092 66017091
         SR    R7,R7                    CLEAR LENGTH           @OY14092 66018091
         IC    R7,TWO(,RINV)            GET ENTRY WIDTH        @OY14092 66019091
TSOLOOP  EQU   *                                               @OY14092 66020091
         AR    RWORK,R7                 BUMP TO NEXT           @OY14092 66021091
         SR    R0,R0                    CLEAR FOR INDEX        @OY14092 66022091
         IC    R0,ZERO(,RWORK)          GET INDEX              @OY14092 66023091
         SLL   R0,ONE                   DOUBLE INDEX           @OY14092 66024091
         LR    R1,RINV                  POINT TO LIST          @OY14092 66025091
         SR    R1,R0                    BACK UP TO OFFSET      @OY14092 66026091
         LH    R1,ZERO(,R1)             GET TNT OFFSET         @OY14092 66027091
         TM    AVTBIT1,AVTCLOSN         CLOSING DOWN           @OY18823 66027300
         BO    GETENTRY                 BRANCH IF YES          @OY18823 66027600
         LH    R0,REQTTCIN              GET SPECIFIED TERM     @OY14092 66028091
         LTR   R0,R0                    ONE SPECIFIED?         @OY14092 66029091
         BZ    GETENTRY                 NO, CONTINUE           @OY14092 66030091
         CR    R1,R0                    CORRECT ONE            @OY14092 66031091
         BNE   CONTLOOP                 NO, GET NEXT           @OY14092 66032091
         LA    R3,ONE                   SET LOOP COUNT         @OY14092 66033091
GETENTRY EQU   *                                               @OY14092 66034091
         BALR  R14,R15                  LOCATE TERMINAL ENTRY  @OY14092 66035091
         USING IEDQQCB,R1                                      @OY14092 66036091
         LR    RDEB,R1                  SAVE TERM ENTRY        @OY14092 66037091
         L     R1,TRMDESTQ-1-IEDQTRM(,R1) GET QCB ADDR         @OY14092 66038091
         TM    QCBFLAG,QCBTSSES         IN SESSION?            @OY14092 66039091
         BZ    CONTLOOP                 NO,CONTINUE            @OY14092 66040091
         TM    AVTBIT1,AVTCLOSN         CLOSING DOWN           @OY18823 66040300
         BO    FORCE                    BRANCH IF YES          @OY18823 66040600
         TM    REQOPT,LOGOFF            FORCE LOGOFF           @OY14092 66041091
         BZ    CKTTCIN                  NO,CONTINUE CHECKS     @OY14092 66042091
FORCE    EQU   *                                               @OY18823 66042500
         STM   R0,R15,REGSAVE           SAVE REGISTERS         @OY14092 66043091
         TM    QCBTSOF1,QCBDELAY        QCB IN TIME DELAY QUE  @OY14092 66044091
         BZ    CKTJID                   NO, CONTINUE           @OY14092 66045091
         L     R15,AVTHG02              ADDR OF DELAY REMOVER  @OY14092 66046091
         BALR  R14,R15                  REMOVE FROM TIME DELAY @OY14092 66047091
CKTJID   EQU   *                                               @OY14092 66048091
         NC    QCBTJID(TWO),QCBTJID     TJID ZERO              @OY14092 66049091
         BZ    NONTSO                   YES,ALREADY LOGGED OFF @OY14092 66050091
         L     RWORK,CVTPTR             GET CVT ADDR           @OY14092 66051091
         L     R2,CVTASVT-CVTMAP(,RWORK)  ASVT ADDRESS         @OY14092 66052091
         TM    AVTBIT3,AVTTSAB          HAS TSO ABENDED        @OY14092 66053091
         BO    NONTSO                   BRANCH YES             @OY14092 66054091
         SR    R5,R5                    CLEAR FOR ID           @OY14092 66055091
         ICM   R5,THREE,QCBTJID         GET TSO JOB ID         @OY14092 66056091
         BZ    NONTSO                   BRANCH NON THERE       @OY14092 66057091
         BCTR  R5,ZERO                  SUBTRACT ONE           @OY14092 66058091
         SLL   R5,TWO                   MULTIPLY BY FOUR       @OY14092 66059091
         L     R2,ASVTENTY-ASVT(R5,R2)  ASCB ADDR              @OY14092 66060091
         L     R9,ASCBTSB-ASCB(,R2)     TSB ADDR               @OY14092 66061091
         LR    R7,R1                    QCB ADDR               @OY14092 66062091
         LR    R1,R13                   SAVE AREA ADDR         @OY14092 66063091
         TM    AVTBIT3,AVTTSAB          TSO ABENDED            @OY14092 66064091
         BO    NONTSO                   YES, BRANCH            @OY14092 66065091
         QTIP  4,(1)                    CALL HANGUP            @OY14092 66066091
NONTSO   EQU   *                                               @OY14092 66067091
         LM    R0,R15,REGSAVE           RESTORE ALL REGS       @OY14092 66068091
         NI    QCBFLAG,AVTEFF-QCBTSSES-QCBREAD-QCBNOBRK        @OY14092 66069091
*                                       RESET STATUS           @OY14092 66070091
         NI    QCBDSFLG,AVTEFF-QCBALTMH RESET ALTERNATE MH     @OY14092 66071091
         MVI   QCBRETCT,AVTEZERO        CLEAR RETRY COUNT      @OY14092 66072091
         XC    QCBCARCT(THREE),QCBCARCT CLEAR CARR.CT & TJID   @OY14092 66073091
         XC    QCBSATCT(THREE),QCBSATCT CLEAR SIMATTN COUNT    @OY14092 66074091
         SR    R14,R14                  CLEAR REGISTER         @OY14092 66075091
         IC    R14,TRMCHCIN-IEDQTRM(,RDEB) GET INDEX           @OY14092 66076091
         BCTR  R14,ZERO                 SUBTRACT ONE           @OY14092 66077091
         SLL   R14,TWO                  MULTIPLY BY FOUR       @OY14092 66078091
         A     R14,AVTCSTCS             ADD TABLE POINTER      @OY14092 66079091
         TM    ONE(R14),CBREAK          BREAK SPECIFIED        @OY14092 66080091
         BO    SETBRK                   YES,BRANCH             @OY14092 66081091
         OI    QCBFLAG,QCBNOBRK         SET NO BREAK           @OY14092 66082091
SETBRK   EQU   *                                               @OY14092 66083091
         B     CONTLOOP                 CONTINUE               @OY14092 66084091
CKTTCIN  EQU   *                                               @OY14092 66085091
         NC    REQTTCIN(TWO),REQTTCIN   TERMINAL SPECIFIED     @OY14092 66086091
         BNZ   FOUR(RLINK)              YES, RETURN ERROR      @OY14092 66087091
         OI    LCBSTAT1,LCBOCWTN        INDICATE REQUEST WAIT'G@OY14092 66088091
         B     DSPDISP                  RETURN ERROR TO CALLER @OY14092 66089091
CONTLOOP EQU   *                                               @OY14092 66090091
         BCT   R3,TSOLOOP               CHECK NEST ENTRY       @OY14092 66091091
         BR    RLINK                    RETURN TO CALLER       @OY14092 66092091
         EJECT                                                 @OY14092 66093091
MINUS8   DC    H'-8'                    NEGATIVE EIGHT         @OY14092 66094091
REGSAVE  DC    16F'0'                   REGISTER SAVEAREA      @OY14092 66095091
HALF8    DC    H'8'                     TO BACK UP PTR TO QCB    S22025 66100022
PREPCCW  DC    X'06',AL3(*),X'200000BC' PREPARE CCW              S22025 67100022
MODZ1    DC    C'Z1'                    MOD ID TO MATCH        @OZ24311 67101000
STOPSTCB DS    0F                       FULL WORD ALIGNMENT    @OX14763 67102091
         DC    AL1(DSPMCPL8)            8-BYTE STCB            @OX14763 67104091
         DC    AL3(BFRDSTOP)            ROUTING ADDRESS        @OX14763 67106091
         DC    X'B0',AL3(0)             LINK FIELD AND PRI     @OX14763 67108091
         L     R15,AVTEZERO(R3)         GET ROUTINE ADDRESS    @OX14763 67110091
         BR    R15                      BRANCH TO IT           @OX14763 67112091
ENDSTOP  EQU   *                                               @OX14763 67114091
         USING *,R15                                           @OX14763 67116091
BFRDSTOP EQU   *                        SUBROUTINE FOR BFRD    @OX14763 67118091
*                                        STOP TERMINAL         @OX14763 67120091
         LR    RLCB,R1                  LCB ADDRESSABILITY     @OX14763 67122091
         LR    RELE,R3                  STCB ADDRESS           @OX14763 67124091
         SH    RELE,BACKUP              BACK UP TO UNIT        @OX14763 67126091
         ICM   R3,AD,FIVE(R3)           GET ADDR OF NEXT STCB  @OX14763 67128091
         LA    R1,ZERO(,R1)             CLEAR FOR COMPARE      @OX14763 67130091
         LA    R7,ZERO(,R7)             CLEAR FOR COMPARE      @OX14763 67132091
         CR    R1,R7                    LCB POSTED             @OX14763 67134091
         BNE   DSPBYPAS                 NO, BYPASS TO SCHEDULER@OX14763 67136091
         TM    LCBSTAT1,LCBSENDN        LCB MARKED AS SENDING  @OX14763 67138091
         BO    DSPBYPAS                 YES,EXIT               @OX14763 67140091
         CLI   OPCDE(RELE),OCICHNGE     ICHNGE COMMAND         @OX14763 67142091
         BE    POSTHK                   YES, POST LCB TO HK    @OX14763 67144091
*                                        FOR STOPLINE          @OX14763 67146091
         L     RWORK,TERMOFF(RELE)      TERM ENTRY ADDRESS     @OX14763 67148091
         USING IEDQTRM,RWORK            TERM ENTRY ADDR'BILITY @OX14763 67150091
         L     RWORK,TRMDESTQ-1         GET QCB ADDR           @OX14763 67152091
         USING IEDQQCB,RWORK            QCB ADDRESSABILITY     @OX14763 67154091
         TM    SWITCH(RELE),STOPMM      STOP TERM MID-MSG      @OX14763 67156091
         BZ    CHECKMM                  NO, CHECK MID-MSG      @OX14763 67158091
         TM    QCBSTAT,QCBSEND          TERMINAL SENDING       @OX14763 67160091
         BO    DSPBYPAS                 YES, EXIT              @OX14763 67162091
POSTHK   EQU   *                                               @OX14763 67164091
         MVC   LCBQCBA,AVTHK+1          SET TO POST TO HK      @OX14763 67166091
         MVI   LCBPRI,PRILNFRE          SET POST PRIORITY      @OX14763 67168091
         STCM  R3,AD,LCBSTCBA           REMOVE SPECIAL STCB    @OX14763 67170091
         B     DSPPOST                  POST LCB TO HK         @OX14763 67172091
CHECKMM  EQU   *                                               @OX14763 67174091
         SR    RDCB,RDCB                CLEAR FOR INDEX        @OX14763 67176091
         LR    RSCB,RDCB                CLEAR FOR INDEX        @OX14763 67178091
         IC    RDCB,QCBSCBOF            GET SCB INDEX          @OX14763 67180091
         IC    RSCB,AVTSCBSZ            GET SCB SIZE           @OX14763 67182091
         MR    RDCB,RDCB                OFFSET TO SCB          @OX14763 67184091
         AL    RSCB,LCBSCBDA-1          GET SCB ADDRESS        @OX14763 67186091
         TM    SCBQTYPE,SCBBFMM         MIDDLE OF MSG          @OX14763 67188091
         BO    DSPBYPAS                 YES, EXIT              @OX14763 67190091
         B     POSTHK                   POST LCB TO STOPLN     @OX14763 67192091
BACKUP   DC    AL2(STCBOFF)             OFFSET OF STCB IN UNIT @OX14763 67194091
         TTNTD                                                          67200000
REQELE   DSECT                          REQUEST ELEMENT        @OY14092 67206091
REQQCB   DS    F .                      QCB ADDR               @OY14092 67212091
REQPRI   DS    XL1 .                    PRIORITY               @OY14092 67218091
REQLINK  DS    AL3 .                    LINK FIELD             @OY14092 67224091
REQOPT   DS    XL1 .                    OPTION BYTE            @OY14092 67230091
IMMED    EQU   X'80' .                  IMMEDIATE REQUEST      @OY14092 67236091
INTREQ   EQU   X'40' .                  INTERNAL REQUEST       @OY14092 67242091
CKTSO    EQU   X'20' .                  TSO CHECK REQUIRED     @OY14092 67248091
LOGOFF   EQU   X'10' .                  FORCE LOGOFF           @OY14092 67254091
REQCHAIN DS    AL3 .                    CHAIN OF RELATED REQ'S @OY14092 67260091
REQDEBA  DS    F .                      ADDRESS OF DEB         @OY14092 67266091
         DS    X .                                             @OY14092 67272091
REQLCBA  DS    AL3                      ADDRESS OF LCB         @OY14092 67278091
REQTTCIN DS    H .                      TERMINAL ENTRY INDEX   @OY14092 67284091
REQRLN   DS    XL1 .                    RELATIVE LINE NO       @OY14092 67290091
         SPACE 3                                                        67300022
         TDISPD                                                         67600020
         EJECT                                                          67650020
         TSCBD                                                          67700020
         TAVTD 2                                                        67800020
         TLCBD                                                          68000020
         TCCWD                                                          68200020
         TPRIOR                                                         68400020
         DCBD  DSORG=TX                                                 68600020
         TDEBD                                                          68800020
         TTRMD                                                          68850020
         TQCBD                                                          68900020
         CVT                                                   @OY14092 68902091
         IHAASCB                                               @OY14092 68904091
         IHAASVT                                               @OY14092 68906091
         TOPCED                                                @OY13669 68910091
         TOPCAVTD                                              @OY13669 68920091
         IEFUCBOB                                                       68950020
         END                                                            69000020
./  ADD  SSI=80470106,NAME=IEDQHM
         TITLE 'IEDQHM'                                                 30000022
*A300000                                                         S21903 33000022
         MIEDQHM                                                        36000022
         END                                                            60000020
./  ADD  SSI=80470107,NAME=IEDQHM1
         TITLE 'IEDQHM1'                                                30000022
*A300000                                                         S21903 33000022
         MIEDQHM CORE                                                   36000022
         END                                                            60000020
./  ADD  SSI=80470108,NAME=IEDQHM2
         TITLE 'IEDQHM2'                                                30000022
*A300000                                                         S21903 33000022
         MIEDQHM DISK                                                   36000022
         END                                                            60000020
./  ADD  SSI=63630023,NAME=IEDQIN
         TITLE 'IEDQIN, QUEUEING INBOUND                               *00001000
                        '                                               00002000
IEDQIN   CSECT ,                                                   0001 00003000
@PROLOG  DS    0H                                                  0002 00004000
         DC    A(0)                START OF QCB                         00005000
         DC    A(0)                                                     00006000
         DC    X'06'               START OF STCB                        00007000
         DC    AL3(*-1)                                                 00008000
         USING *,RBASE                                                  00009000
         LR    RBASE,R15           ESTABLISH ADDRESSABILTY              00010000
IEDQIN   IEDHJN START,HJN                                               00011000
*                                                                  0258 00012000
*/********************************************************************/ 00013000
*/*                                                                  */ 00014000
*/*     M A I N     R O U T I N E                                    */ 00015000
*/*                                                                  */ 00016000
*/********************************************************************/ 00017000
*                                                                  0258 00018000
*   RPRF=RPARM;                     /* PIU BUFFER ADDRESS            */ 00019000
         LR    RPRF,RPARM                                          0258 00020000
*   PIUSTART=ADDR(PRFPIUO)+PRFPIUO; /* ADDRESS OF PIU DATA(TH-RH-RU) */ 00021000
         LA    PIUSTART,PRFPIUO(,IEDQPPTR)                         0259 00022000
         SLR   @09,@09                                             0259 00023000
         IC    @09,PRFPIUO(,IEDQPPTR)                              0259 00024000
         ALR   PIUSTART,@09                                        0259 00025000
*/*                                                                  */ 00026000
*                                                                  0260 00027000
*   IF TTHDAF=SAVTSCPT THEN         /* SSCP FLOW                     */ 00028000
         L     @09,AVTSAVTP(,IEDQAPTR)                             0260 00029000
         CLC   TTHDAF(2,PIUSTART),SAVTSCPT(@09)                    0260 00030000
         BNE   @RF00260                                            0260 00031000
*     DO;                           /* YES                           */ 00032000
*       IF TRHTYPE=OFF THEN         /* REQUEST                       */ 00033000
         TM    TRHTYPE+10(PIUSTART),B'10000000'                    0262 00034000
         BNZ   @RF00262                                            0262 00035000
*         PRFQCBA=SAVTSSRQ;         /* YES- GET SSCP REQ. HANDLER QCB*/ 00036000
         MVC   PRFQCBA(3,IEDQPPTR),SAVTSSRQ+1(@09)                 0263 00037000
*       ELSE                        /* RESPONSE                      */ 00038000
*         PRFQCBA=SAVTSSRP;         /* GET SSCP RESPONSE HANDLER QCB */ 00039000
         B     @RC00262                                            0264 00040000
@RF00262 L     @10,AVTSAVTP(,IEDQAPTR)                             0264 00041000
         MVC   PRFQCBA(3,IEDQPPTR),SAVTSSRP+1(@10)                 0264 00042000
*/*                                                                  */ 00043000
*                                                                  0265 00044000
*       PRFPRI=PRISCPIN;            /* POST PRIORITY                 */ 00045000
@RC00262 MVI   PRFPRI(IEDQPPTR),X'E5'                              0265 00046000
*       RPARM=RPRF;                 /* PIU BUFFER ADDRESS            */ 00047000
         LR    RPARM,RPRF                                          0266 00048000
*       R15=ADDR(DSPPOST);          /* DSPPOST EXIT ADDRESS          */ 00049000
         LA    R15,DSPPOST(,RDISP)                                 0267 00050000
*     END;                                                         0268 00051000
*   ELSE                            /* NOT SSCP FLOW                 */ 00052000
*     DO;                                                          0269 00053000
         B     @RC00260                                            0269 00054000
@RF00260 DS    0H                                                  0270 00055000
*       IF TRHTYPE=OFF THEN         /* REQUEST                       */ 00056000
         TM    TRHTYPE+10(PIUSTART),B'10000000'                    0270 00057000
         BNZ   @RF00270                                            0270 00058000
*         DO;                       /* YES                           */ 00059000
*           IF TTHEFI=ON THEN       /* EXPEDITED FLOW                */ 00060000
         TM    TTHEFI(PIUSTART),B'00000001'                        0272 00061000
         BNO   @RF00272                                            0272 00062000
*             PRFPRI=PRIEXP;        /* EXPEDITED PRIORITY (FOR WAIT     00063000
*                                      CHAIN)                        */ 00064000
         MVI   PRFPRI(IEDQPPTR),X'08'                              0273 00065000
*           ELSE                    /* NORMAL FLOW                   */ 00066000
*             PRFPRI=PRINORM;       /* NORMAL PRIORITY (FOR WAIT   0274 00067000
*                                      CHAIN)                        */ 00068000
         B     @RC00272                                            0274 00069000
@RF00272 MVI   PRFPRI(IEDQPPTR),X'04'                              0274 00070000
*/*                                                                  */ 00071000
*                                                                  0275 00072000
*           RPARM=TTHOAF;           /* OAF TNT OFFSET                */ 00073000
@RC00272 SLR   RPARM,RPARM                                         0275 00074000
         ICM   RPARM,3,TTHOAF(PIUSTART)                            0275 00075000
*           CALL IEDQTNT;           /* GET OAF TERMINAL ENTRY        */ 00076000
         L     @15,AVTRNMPT(,IEDQAPTR)                             0276 00077000
         BALR  @14,@15                                             0276 00078000
*           RTRM=RPARM;             /* SET TRM ADDRESSABILITY        */ 00079000
         LR    RTRM,RPARM                                          0277 00080000
*           RQCB=TRMDESTQ;          /* QCB ADDRESSABILITY            */ 00081000
         L     RQCB,TRMDESTQ-1(,IEDQTPTR)                          0278 00082000
         LA    RQCB,0(,RQCB)                                       0278 00083000
*/*                                                                  */ 00084000
*                                                                  0279 00085000
*           IF QCBPLCBN=ON THEN     /* PLCB ASSIGNED                 */ 00086000
         LR    @10,IEDQQPTR                                        0279 00087000
         SL    @10,@CF00044                                        0279 00088000
         TM    QCBPLCBN(@10),B'10000000'                           0279 00089000
         BNO   @RF00279                                            0279 00090000
*             DO;                   /* YES                           */ 00091000
*               RLCB=QCBPLCBA;      /* LCB ADDRESSABILITY            */ 00092000
         L     RLCB,QCBPLCBA-1(,@10)                               0281 00093000
         LA    RLCB,0(,RLCB)                                       0281 00094000
*               CALL HAVEPLCB;      /* 'HAVE PLCB' PROCESSING        */ 00095000
         BAL   @14,HAVEPLCB                                        0282 00096000
*             END;                                                 0283 00097000
*           ELSE                    /* NO PLCB ASSIGNED              */ 00098000
*             CALL NOPLCB;          /* 'NO PLCB' PROCESSING          */ 00099000
         B     @RC00279                                            0284 00100000
@RF00279 BAL   @14,NOPLCB                                          0284 00101000
*         END;                                                     0285 00102000
*       ELSE                        /* RESPONSE                      */ 00103000
*         DO;                                                      0286 00104000
         B     @RC00270                                            0286 00105000
@RF00270 DS    0H                                                  0287 00106000
*           RPARM=RPRF;             /* PIU BUFFER ADDRESS            */ 00107000
         LR    RPARM,RPRF                                          0287 00108000
*           RQCB=ADDR(IEDRSPIN);    /* IEDRSPIN'S QCB                */ 00109000
         L     RQCB,@CV01578                                       0288 00110000
*           RSTCB=QCBSTCHN;         /* IEDRSPIN'S STCB               */ 00111000
         L     RSTCB,QCBSTCHN-1(,IEDQQPTR)                         0289 00112000
         LA    RSTCB,0(,RSTCB)                                     0289 00113000
*           R15=ADDR(DSPBYPAS);     /* EXIT TO DSPBYPAS              */ 00114000
         LA    R15,DSPBYPAS(,RDISP)                                0290 00115000
*         END;                                                     0291 00116000
*     END;                                                         0292 00117000
*                                                                  0292 00118000
@RC00270 DS    0H                                                  0293 00119000
*/*                                                                  */ 00120000
*                                                                  0293 00121000
*   GEN(BALR R14,R15);              /* EXIT TO DISPATCHER(NO RETURN) */ 00122000
@RC00260 DS    0H                                                  0293 00123000
         BALR R14,R15                                                   00124000
*                                                                  0294 00125000
*/********************************************************************/ 00126000
*/*                                                                  */ 00127000
*/* THIS ROUTINE ENQUEUES THE PIU BUFFER ON THE PROPER WAIT CHAIN.   */ 00128000
*/* THE INPUT PIU BUFFER (POINTED TO BY RPRF) WILL BE ENQUEUED BY    */ 00129000
*/* PRIORITY ON THE WAIT CHAIN(WHOSE ANCHOR IS POINTED TO BY RPARM). */ 00130000
*/* THERE ARE 2 TYPES OF ELEMENTS COMPRISING THE WAIT CHAIN:         */ 00131000
*/*      -EXPEDITED(HIGH PRIORITY) AND                               */ 00132000
*/*      -NORMAL(LOW PRIORITY)                                       */ 00133000
*/*                                                                  */ 00134000
*/*     INPUTS: RPARM(REG 1) CONTAINS THE ADDRESS OF THE WAIT CHAIN  */ 00135000
*/*             ANCHOR(ADDR OF LCBWAITC OR ADDR OF QCBPLCBA)         */ 00136000
*/*                                                                  */ 00137000
*/*             RPRF CONTAINS THE ADDRESS OF THE PIU BUFFER TO BE    */ 00138000
*/*             PUT ON THE WAIT CHAIN.                               */ 00139000
*/*                                                                  */ 00140000
*/********************************************************************/ 00141000
*                                                                  0294 00142000
*ENQUEUE:                                                          0294 00143000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0294 00144000
@EL00001 DS    0H                                                  0294 00145000
@EF00001 DS    0H                                                  0294 00146000
@ER00001 BR    @14                                                 0294 00147000
ENQUEUE  DS    0H                                                  0295 00148000
*   PREVELEM=RPARM-4;               /* SET UP 'PREVIOUS' ELEMENT ADDR*/ 00149000
         LR    @09,RPARM                                           0295 00150000
         SL    @09,@CF00326                                        0295 00151000
         ST    @09,PREVELEM                                        0295 00152000
*   CURELEM=RPARM->PTR24;           /* SET UP 'CURRENT' ELEMENT TO 0296 00153000
*                                      1ST ELEMENT ON WAIT CHAIN     */ 00154000
         L     CURELEM,PTR24-1(,RPARM)                             0296 00155000
         LA    CURELEM,0(,CURELEM)                                 0296 00156000
*   DO WHILE(CURELEM=0&PRFPRI<=CURELEM->PRFPRI);                  0297 00157000
         B     @DE00297                                            0297 00158000
@DL00297 DS    0H                                                  0298 00159000
*     PREVELEM=CURELEM;             /* UPDATE 'PREVIOUS' ELEMENT ADDE*/ 00160000
         ST    CURELEM,PREVELEM                                    0298 00161000
*     CURELEM=CURELEM->PRFLINK;     /* GET NEXT ELEMENT ON WAIT CHAIN*/ 00162000
         L     @09,PRFLINK-1(,CURELEM)                             0299 00163000
         LA    @09,0(,@09)                                         0299 00164000
         LR    CURELEM,@09                                         0299 00165000
*   END;                            /* END OF LOOP                   */ 00166000
@DE00297 LTR   CURELEM,CURELEM                                     0300 00167000
         BZ    @DC00297                                            0300 00168000
         CLC   PRFPRI(1,IEDQPPTR),PRFPRI(CURELEM)                  0300 00169000
         BNH   @DL00297                                            0300 00170000
@DC00297 DS    0H                                                  0301 00171000
*/*                                                                  */ 00172000
*                                                                  0301 00173000
*   PREVELEM->PRFLINK=RPRF;         /* LINK THE INPUT PIU INTO...    */ 00174000
         L     @09,PREVELEM                                        0301 00175000
         STCM  RPRF,7,PRFLINK(@09)                                 0301 00176000
*   PRFLINK=CURELEM;                /* THE WAIT CHAIN                */ 00177000
         STCM  CURELEM,7,PRFLINK(IEDQPPTR)                         0302 00178000
*   RETURN;                         /* RETURN TO CALLER              */ 00179000
@EL00002 DS    0H                                                  0303 00180000
@EF00002 DS    0H                                                  0303 00181000
@ER00002 BR    @14                                                 0303 00182000
*   END ENQUEUE;                                                   0304 00183000
*                                                                  0305 00184000
*/********************************************************************/ 00185000
*/*                                                                  */ 00186000
*/* THIS ROUTINE DOES PROCESSING WHEN A PLCB IS ALREADY ASSIGNED.    */ 00187000
*/*                                                                  */ 00188000
*/********************************************************************/ 00189000
*                                                                  0305 00190000
*HAVEPLCB:                                                         0305 00191000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0305 00192000
HAVEPLCB DS    0H                                                  0306 00193000
*   R14SV01=R14;                    /* SAVE RETURN ADDRESS           */ 00194000
         ST    R14,R14SV01                                         0306 00195000
*/*                                                                  */ 00196000
*                                                                  0307 00197000
*   IF LCBWAITC=0 THEN             /* SOMETHING ON THE WAIT CHAIN   */ 00198000
         L     @10,LCBWAITC-1(,IEDQLPTR)                           0307 00199000
         LA    @10,0(,@10)                                         0307 00200000
         LTR   @10,@10                                             0307 00201000
         BZ    @RF00307                                            0307 00202000
*     DO;                           /* YES                           */ 00203000
*       RPARM=ADDR(LCBWAITC)-1;     /* ADDR OF WAIT CHAIN ANCHOR     */ 00204000
         LA    RPARM,LCBWAITC(,IEDQLPTR)                           0309 00205000
         BCTR  RPARM,0                                             0309 00206000
*       CALL ENQUEUE;               /* PUT PIU BUFFER ON WAIT CHAIN  */ 00207000
         BAL   @14,ENQUEUE                                         0310 00208000
*     END;                                                         0311 00209000
*   ELSE                            /* NOTHING ON WAIT CHAIN         */ 00210000
*     DO;                                                          0312 00211000
         B     @RC00307                                            0312 00212000
@RF00307 DS    0H                                                  0313 00213000
*       LCBWAITC=RPRF;              /* PUT PIU BUFFER ON WAIT CHAIN  */ 00214000
         STCM  RPRF,7,LCBWAITC(IEDQLPTR)                           0313 00215000
*       PRFLINK=0;                  /* MARK AS LAST PIU IN CHAIN     */ 00216000
         SLR   @10,@10                                             0314 00217000
         STCM  @10,7,PRFLINK(IEDQPPTR)                             0314 00218000
*     END;                                                         0315 00219000
*                                                                  0315 00220000
*/*                                                                  */ 00221000
*                                                                  0316 00222000
*   IF LCBRECVN=ON&                 /* ARE WE RECEIVING AND...       */ 00223000
*       (LCBCHN=LCBINC|             /* 'IN CHAIN' STATE OR...        */ 00224000
*       LCBCHN=LCBPURG|             /* 'PURGING CHAIN' STATE OR...   */ 00225000
*       (LCBCHN=LCBBETC&            /* 'BETWEEN CHAIN' STATE AND...  */ 00226000
*       TRMINPTP=ON)) THEN          /* INPUT PENDING                 */ 00227000
@RC00307 TM    LCBRECVN(IEDQLPTR),B'00000010'                      0316 00228000
         BNO   @RF00316                                            0316 00229000
         TM    LCBCHN(IEDQLPTR),B'00010000'                        0316 00230000
         BNO   @GL00004                                            0316 00231000
         TM    LCBCHN(IEDQLPTR),B'11100000'                        0316 00232000
         BZ    @RT00316                                            0316 00233000
@GL00004 TM    LCBCHN(IEDQLPTR),B'00100000'                        0316 00234000
         BNO   @GL00003                                            0316 00235000
         TM    LCBCHN(IEDQLPTR),B'11010000'                        0316 00236000
         BZ    @RT00316                                            0316 00237000
@GL00003 TM    LCBCHN(IEDQLPTR),B'11110000'                        0316 00238000
         BNZ   @RF00316                                            0316 00239000
         LR    @10,IEDQTPTR                                        0316 00240000
         AL    @10,@CF01601                                        0316 00241000
         TM    TRMINPTP-3(@10),B'01000000'                         0316 00242000
         BNO   @RF00316                                            0316 00243000
@RT00316 DS    0H                                                  0317 00244000
*     DO;                           /* YES                           */ 00245000
*       TRMINPTP=OFF;               /* RESET INPUT PENDING           */ 00246000
         LR    @10,IEDQTPTR                                        0318 00247000
         AL    @10,@CF01601                                        0318 00248000
         NI    TRMINPTP-3(@10),B'10111111'                         0318 00249000
*       RPARM=RLCB;                 /* SET LCB AS ELEMENT            */ 00250000
         LR    RPARM,RLCB                                          0319 00251000
*       RQCB=SAVTRQIN;              /* ADDR OF REQUEST INBOUND'S QCB    00252000
*                                      (IEDRQIN'S QCB)               */ 00253000
         L     @10,AVTSAVTP(,IEDQAPTR)                             0320 00254000
         L     RQCB,SAVTRQIN(,@10)                                 0320 00255000
*       RSTCB=QCBSTCHN;             /* STCB ADDRESS                  */ 00256000
         L     RSTCB,QCBSTCHN-1(,IEDQQPTR)                         0321 00257000
         LA    RSTCB,0(,RSTCB)                                     0321 00258000
*       R15=ADDR(DSPBYPAS);         /* DSPBYPAS ADDRESS              */ 00259000
         LA    R15,DSPBYPAS(,RDISP)                                0322 00260000
*     END;                                                         0323 00261000
*   ELSE                                                           0324 00262000
*     R15=ADDR(DSPDISP);            /* DSPDISP EXIT                  */ 00263000
         B     @RC00316                                            0324 00264000
@RF00316 LA    R15,DSPDISP(,RDISP)                                 0324 00265000
*/*                                                                  */ 00266000
*                                                                  0325 00267000
*   R14=R14SV01;                    /* RESTORE RETURN ADDRESS        */ 00268000
@RC00316 L     R14,R14SV01                                         0325 00269000
*   RETURN;                         /* RETURN TO CALLER              */ 00270000
@EL00003 DS    0H                                                  0326 00271000
@EF00003 DS    0H                                                  0326 00272000
@ER00003 BR    @14                                                 0326 00273000
*   END HAVEPLCB;                                                  0327 00274000
*                                                                  0328 00275000
*/********************************************************************/ 00276000
*/*                                                                  */ 00277000
*/* THIS ROUTINE DOES PROCESSING WHEN NO PLCB IS ASSIGNED.           */ 00278000
*/*                                                                  */ 00279000
*/********************************************************************/ 00280000
*                                                                  0328 00281000
*NOPLCB:                                                           0328 00282000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0328 00283000
NOPLCB   DS    0H                                                  0329 00284000
*   R14SV02=R14;                    /* SAVE RETURN ADDRESS           */ 00285000
         ST    R14,R14SV02                                         0329 00286000
*/*                                                                  */ 00287000
*                                                                  0330 00288000
*   TRMINPTP=OFF;                   /* RESET INPUT PENDING           */ 00289000
         LR    @10,IEDQTPTR                                        0330 00290000
         AL    @10,@CF01601                                        0330 00291000
         NI    TRMINPTP-3(@10),B'10111111'                         0330 00292000
*   IF QCBWAITC=ON THEN             /* DOES QCB HAVE A WAIT CHAIN    */ 00293000
         LR    @10,IEDQQPTR                                        0331 00294000
         SL    @10,@CF00044                                        0331 00295000
         TM    QCBWAITC(@10),B'01000000'                           0331 00296000
         BNO   @RF00331                                            0331 00297000
*     DO;                           /* YES                           */ 00298000
*       RPARM=ADDR(QCBPLCBA)-1;     /* SET UP WAIT CHAIN ANCHOR    0333 00299000
*                                      ADDRESS                       */ 00300000
         LA    RPARM,QCBPLCBA(,@10)                                0333 00301000
         BCTR  RPARM,0                                             0333 00302000
*       CALL ENQUEUE;               /* PUT PIU BUFFER ON WAIT CHAIN  */ 00303000
         BAL   @14,ENQUEUE                                         0334 00304000
*     END;                                                         0335 00305000
*   ELSE                            /* NO WAIT CHAIN                 */ 00306000
*     DO;                                                          0336 00307000
         B     @RC00331                                            0336 00308000
@RF00331 DS    0H                                                  0337 00309000
*       QCBWAITC=ON;                /* INDICATE WAIT CHAIN PRESENT   */ 00310000
         LR    @10,IEDQQPTR                                        0337 00311000
         SL    @10,@CF00044                                        0337 00312000
         OI    QCBWAITC(@10),B'01000000'                           0337 00313000
*       QCBPLCBA=RPRF;              /* PUT PIU ON WAIT CHAIN         */ 00314000
         STCM  RPRF,7,QCBPLCBA(@10)                                0338 00315000
*       PRFLINK=0;                  /* MARK AS LAST ELEMENT ON CHAIN */ 00316000
         SLR   @10,@10                                             0339 00317000
         STCM  @10,7,PRFLINK(IEDQPPTR)                             0339 00318000
*     END;                                                         0340 00319000
*                                                                  0340 00320000
*/*                                                                  */ 00321000
*                                                                  0341 00322000
*   IF QCBRCVRQ=ON THEN             /* PLCB IN PROCESS OF BEING    0341 00323000
*                                      ASSIGNED                      */ 00324000
@RC00331 LR    @10,IEDQQPTR                                        0341 00325000
         AL    @10,@CF01604                                        0341 00326000
         TM    QCBRCVRQ-4(@10),B'00010000'                         0341 00327000
         BNO   @RF00341                                            0341 00328000
*     R15=ADDR(DSPDISP);            /* YES-SET EXIT ADDRESS DSPDISP  */ 00329000
         LA    R15,DSPDISP(,RDISP)                                 0342 00330000
*   ELSE                                                           0343 00331000
*     DO;                                                          0343 00332000
         B     @RC00341                                            0343 00333000
@RF00341 DS    0H                                                  0344 00334000
*       QCBRCVRQ=ON;                /* INDICATE PLCB IN PROCESS OF 0344 00335000
*                                      BEING ASSIGNED                */ 00336000
         LR    @10,IEDQQPTR                                        0344 00337000
         AL    @10,@CF01604                                        0344 00338000
         OI    QCBRCVRQ-4(@10),B'00010000'                         0344 00339000
*       RPARM=RQCB;                 /* QCB ADDRESS                   */ 00340000
         LR    RPARM,RQCB                                          0345 00341000
*       CALL IEDIAP01;              /* GO ASSIGN PLCB                */ 00342000
         L     @10,AVTSAVTP(,IEDQAPTR)                             0346 00343000
         L     @15,SAVTPREQ(,@10)                                  0346 00344000
         BALR  @14,@15                                             0346 00345000
*       IF R15=0 THEN              /* PLCB SUCCESSFULLY ASSIGNED    */ 00346000
         LTR   R15,R15                                             0347 00347000
         BZ    @RF00347                                            0347 00348000
*         DO;                       /* YES                           */ 00349000
*           RLCB=R15;               /* LCB ADDRESSABILITY            */ 00350000
         LR    RLCB,R15                                            0349 00351000
*           LCBRECVN=ON;            /* MARK RECEIVING                */ 00352000
*           LCBSENDN=OFF;           /* MARK NOT SENDING              */ 00353000
         OI    LCBRECVN(IEDQLPTR),B'00000010'                      0351 00354000
         NI    LCBSENDN(IEDQLPTR),B'11111110'                      0351 00355000
*           RPARM=RLCB;             /* SET ELEMENT TO BE PASSED      */ 00356000
         LR    RPARM,RLCB                                          0352 00357000
*           RQCB=SAVTRQIN;          /* REQUEST INBOUND'S QCB ADDRESS    00358000
*                                      (IEDRQIN'QCB)                 */ 00359000
         L     @10,AVTSAVTP(,IEDQAPTR)                             0353 00360000
         L     RQCB,SAVTRQIN(,@10)                                 0353 00361000
*           RSTCB=QCBSTCHN;         /* STCB ADDRESS                  */ 00362000
         L     RSTCB,QCBSTCHN-1(,IEDQQPTR)                         0354 00363000
         LA    RSTCB,0(,RSTCB)                                     0354 00364000
*           R15=ADDR(DSPBYPAS);     /* EXIT ADDRESS-DSPBYPAS         */ 00365000
         LA    R15,DSPBYPAS(,RDISP)                                0355 00366000
*         END;                                                     0356 00367000
*       ELSE                        /* PLCB NOT SUCCESSFULLY ASSIGNED*/ 00368000
*         R15=ADDR(DSPDISP);        /* EXIT ADDRESS- DSPDISP         */ 00369000
         B     @RC00347                                            0357 00370000
@RF00347 LA    R15,DSPDISP(,RDISP)                                 0357 00371000
*     END;                                                         0358 00372000
*                                                                  0358 00373000
@RC00347 DS    0H                                                  0359 00374000
*/*                                                                  */ 00375000
*                                                                  0359 00376000
*   R14=R14SV02;                    /* RESTORE RETURN ADDRESS        */ 00377000
@RC00341 L     R14,R14SV02                                         0359 00378000
*   RETURN;                         /* RETURN TO CALLER              */ 00379000
@EL00004 DS    0H                                                  0360 00380000
@EF00004 DS    0H                                                  0360 00381000
@ER00004 BR    @14                                                 0360 00382000
*   END NOPLCB;                                                    0361 00383000
*   END IEDQIN                                                     0362 00384000
*                                                                  0362 00385000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00386000
*/*%INCLUDE SYSLIB  (TAVTD   )                                       */ 00387000
*/*%INCLUDE SYSLIB  (TDISPD  )                                       */ 00388000
*/*%INCLUDE SYSLIB  (TLCBD   )                                       */ 00389000
*/*%INCLUDE SYSLIB  (TPIUD   )                                       */ 00390000
*/*%INCLUDE SYSLIB  (TPRFD   )                                       */ 00391000
*/*%INCLUDE SYSLIB  (TPRIOR  )                                       */ 00392000
*/*%INCLUDE SYSLIB  (TQCBD   )                                       */ 00393000
*/*%INCLUDE SYSLIB  (TRHD    )                                       */ 00394000
*/*%INCLUDE SYSLIB  (TTHD    )                                       */ 00395000
*/*%INCLUDE SYSLIB  (TTRMD   )                                       */ 00396000
*                                                                  0362 00397000
*       ;                                                          0362 00398000
@DATA    DS    0H                                                       00399000
         DS    0F                                                       00400000
         DS    0F                                                       00401000
@CF00326 DC    F'4'                                                     00402000
@CF00044 DC    F'8'                                                     00403000
@CF01601 DC    F'-11'                                                   00404000
@CF01604 DC    F'-4'                                                    00405000
@CV01578 DC    V(IEDRSPIN)                                              00406000
         DS    0D                                                       00407000
PREVELEM DS    A                                                        00408000
R14SV    DS    CL8                                                      00409000
         ORG   R14SV                                                    00410000
R14SV01  DS    AL4                                                      00411000
R14SV02  DS    AL4                                                      00412000
         ORG   R14SV+8                                                  00413000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00414000
@01      EQU   01                                                       00415000
@02      EQU   02                                                       00416000
@03      EQU   03                                                       00417000
@04      EQU   04                                                       00418000
@05      EQU   05                                                       00419000
@06      EQU   06                                                       00420000
@07      EQU   07                                                       00421000
@08      EQU   08                                                       00422000
@09      EQU   09                                                       00423000
@10      EQU   10                                                       00424000
@11      EQU   11                                                       00425000
@12      EQU   12                                                       00426000
@13      EQU   13                                                       00427000
@14      EQU   14                                                       00428000
@15      EQU   15                                                       00429000
CURELEM  EQU   @10                                                      00430000
PIUSTART EQU   @10                                                      00431000
IEDQAPTR EQU   @13                                                      00432000
RDISP    EQU   @11                                                      00433000
IEDQLPTR EQU   @04                                                      00434000
LCBXPTR  EQU   @05                                                      00435000
IEDQPPTR EQU   @06                                                      00436000
IEDQQPTR EQU   @07                                                      00437000
IEDQTPTR EQU   @08                                                      00438000
REG0     EQU   @00                                                      00439000
RPARM    EQU   @01                                                      00440000
RSTCB    EQU   @03                                                      00441000
RLCB     EQU   @04                                                      00442000
RPRF     EQU   @06                                                      00443000
RQCB     EQU   @07                                                      00444000
RTRM     EQU   @08                                                      00445000
RBASE    EQU   @12                                                      00446000
RAVT     EQU   @13                                                      00447000
R14      EQU   @14                                                      00448000
R15      EQU   @15                                                      00449000
IEDQAVTD EQU   0                                                        00450000
AVTSAVEX EQU   IEDQAVTD+216                                             00451000
@NM00003 EQU   IEDQAVTD+316                                             00452000
AVTCKFLG EQU   @NM00003                                                 00453000
AVTBASE  EQU   IEDQAVTD+340                                             00454000
AVTPKF   EQU   AVTBASE                                                  00455000
AVTRNMPT EQU   IEDQAVTD+352                                             00456000
AVTHG02  EQU   IEDQAVTD+456                                             00457000
AVTDISP  EQU   IEDQAVTD+480                                             00458000
AVTHD    EQU   IEDQAVTD+484                                             00459000
AVTSCOPT EQU   AVTHD                                                    00460000
AVTSAVTP EQU   IEDQAVTD+540                                             00461000
AVTSAVTF EQU   AVTSAVTP                                                 00462000
AVTCKPEL EQU   IEDQAVTD+580                                             00463000
AVTCKRMV EQU   AVTCKPEL                                                 00464000
AVTCKELF EQU   IEDQAVTD+608                                             00465000
AVTCKBYT EQU   IEDQAVTD+619                                             00466000
AVTHG01  EQU   IEDQAVTD+620                                             00467000
AVTCKLNK EQU   IEDQAVTD+624                                             00468000
AVTCRELE EQU   IEDQAVTD+636                                             00469000
AVTCCELE EQU   AVTCRELE                                                 00470000
AVTCLRHI EQU   IEDQAVTD+644                                             00471000
AVTADBUF EQU   IEDQAVTD+648                                             00472000
AVTSYSER EQU   IEDQAVTD+656                                             00473000
AVTCKPQB EQU   IEDQAVTD+732                                             00474000
AVTCKPTB EQU   AVTCKPQB                                                 00475000
AVTCKPEC EQU   AVTCKPQB+4                                               00476000
AVTCKPCC EQU   AVTCKPEC                                                 00477000
AVTOPCQB EQU   IEDQAVTD+744                                             00478000
AVTOPCOB EQU   AVTOPCQB                                                 00479000
AVTOPCEC EQU   AVTOPCQB+4                                               00480000
AVTOPCCC EQU   AVTOPCEC                                                 00481000
AVTOLTQB EQU   IEDQAVTD+756                                             00482000
AVTCWFL1 EQU   IEDQAVTD+852                                             00483000
AVTCWFL2 EQU   IEDQAVTD+853                                             00484000
AVTSUBT  EQU   IEDQAVTD+876                                             00485000
AVTIOTR  EQU   IEDQAVTD+877                                             00486000
AVTBIT1  EQU   IEDQAVTD+978                                             00487000
AVTBIT2  EQU   IEDQAVTD+979                                             00488000
AVTBIT3  EQU   IEDQAVTD+980                                             00489000
AVTBIT4  EQU   IEDQAVTD+1064                                            00490000
@NM00083 EQU   IEDQAVTD+1160                                            00491000
IEDNSVTD EQU   0                                                        00492000
SAVTDIAG EQU   IEDNSVTD                                                 00493000
SAVTDIAF EQU   SAVTDIAG                                                 00494000
SAVTPREQ EQU   IEDNSVTD+16                                              00495000
SAVTLUSQ EQU   IEDNSVTD+88                                              00496000
SAVTSSRQ EQU   IEDNSVTD+172                                             00497000
SAVTSSRP EQU   IEDNSVTD+176                                             00498000
SAVTRQIN EQU   IEDNSVTD+204                                             00499000
SAVTTCPU EQU   IEDNSVTD+238                                             00500000
SAVTSCPT EQU   SAVTTCPU                                                 00501000
SAVTZELM EQU   IEDNSVTD+270                                             00502000
SAVTRDRV EQU   IEDNSVTD+284                                             00503000
SAVTCKQB EQU   IEDNSVTD+300                                             00504000
SAVTCKTB EQU   SAVTCKQB                                                 00505000
SAVTCKEC EQU   SAVTCKQB+4                                               00506000
SAVTCKCC EQU   SAVTCKEC                                                 00507000
IEDQDISP EQU   0                                                        00508000
DSPDISP  EQU   4                                                        00509000
DSPBYPAS EQU   20                                                       00510000
DSPPOST  EQU   24                                                       00511000
IEDQLCB  EQU   0                                                        00512000
LCBRCB   EQU   IEDQLCB                                                  00513000
LCBTSOB  EQU   IEDQLCB+19                                               00514000
LCBCHAIN EQU   IEDQLCB+20                                               00515000
LCBSCRNN EQU   LCBCHAIN                                                 00516000
LCBINSRC EQU   IEDQLCB+21                                               00517000
LCBLKMDE EQU   LCBINSRC+2                                               00518000
LCBNTXT  EQU   IEDQLCB+24                                               00519000
LCBSTAT4 EQU   LCBNTXT                                                  00520000
LCBPHASE EQU   LCBSTAT4                                                 00521000
LCBSCBDA EQU   IEDQLCB+25                                               00522000
LCBMHA   EQU   IEDQLCB+29                                               00523000
LCBFLAG1 EQU   IEDQLCB+32                                               00524000
LCBIOBSN EQU   IEDQLCB+33                                               00525000
LCBSENS0 EQU   LCBIOBSN+1                                               00526000
LCBLOSDT EQU   LCBSENS0                                                 00527000
LCBTMOUT EQU   LCBSENS0                                                 00528000
LCBFLAG3 EQU   LCBIOBSN+7                                               00529000
LCBCSW   EQU   LCBIOBSN+8                                               00530000
LCBCSWST EQU   LCBCSW+3                                                 00531000
LCBCSWUS EQU   LCBCSWST                                                 00532000
LCBCSWCS EQU   LCBCSWST+1                                               00533000
LCBSIOCC EQU   LCBIOBSN+15                                              00534000
LCBDCBPT EQU   IEDQLCB+52                                               00535000
LCBRCQCB EQU   IEDQLCB+56                                               00536000
LCBTHSQ  EQU   IEDQLCB+60                                               00537000
LCBINCAM EQU   LCBTHSQ                                                  00538000
LCBERRCT EQU   IEDQLCB+62                                               00539000
LCBLSPCI EQU   IEDQLCB+65                                               00540000
LCBRCBFR EQU   LCBLSPCI                                                 00541000
LCBSTATE EQU   IEDQLCB+70                                               00542000
LCBSTAT1 EQU   LCBSTATE                                                 00543000
LCBCTLMD EQU   LCBSTAT1                                                 00544000
LCBRECVN EQU   LCBSTAT1                                                 00545000
LCBSENDN EQU   LCBSTAT1                                                 00546000
LCBSTAT2 EQU   LCBSTATE+1                                               00547000
LCBSYNC  EQU   LCBSTAT2                                                 00548000
LCBDIAL  EQU   LCBSTAT2                                                 00549000
LCBTSTSW EQU   IEDQLCB+72                                               00550000
LCBERB   EQU   IEDQLCB+76                                               00551000
LCBERBST EQU   IEDQLCB+84                                               00552000
LCBDLNKN EQU   LCBERBST                                                 00553000
LCBERBCT EQU   IEDQLCB+88                                               00554000
LCBRBCT2 EQU   LCBERBCT+1                                               00555000
LCBMSGFM EQU   IEDQLCB+92                                               00556000
LCBOBRCH EQU   IEDQLCB+96                                               00557000
LCBINVPT EQU   LCBOBRCH+1                                               00558000
LCBBFRW  EQU   LCBINVPT                                                 00559000
LCBTPCD  EQU   IEDQLCB+100                                              00560000
LCBSTAT5 EQU   LCBTPCD                                                  00561000
LCBSTAT6 EQU   LCBTPCD+4                                                00562000
LCBCHN   EQU   LCBSTAT6                                                 00563000
LCBWAITC EQU   LCBTPCD+5                                                00564000
LCBRSPSV EQU   LCBTPCD+8                                                00565000
LCBSAVSN EQU   IEDQLCB+112                                              00566000
LCBERCCW EQU   IEDQLCB+120                                              00567000
LCBCPA   EQU   IEDQLCB+144                                              00568000
IEDQLCBX EQU   0                                                        00569000
LCBXCON  EQU   IEDQLCBX                                                 00570000
LCBXFLAG EQU   LCBXCON                                                  00571000
LCBXDCT  EQU   LCBXCON+1                                                00572000
LCBXRADR EQU   LCBXCON+4                                                00573000
IEDPIU   EQU   0                                                        00574000
PIUTH    EQU   IEDPIU                                                   00575000
PIURH    EQU   IEDPIU+10                                                00576000
IEDQPRF  EQU   0                                                        00577000
PRFRCB   EQU   IEDQPRF                                                  00578000
PRFKEY   EQU   PRFRCB                                                   00579000
PRFQCBA  EQU   PRFRCB+1                                                 00580000
PRFPRI   EQU   PRFRCB+4                                                 00581000
PRFLINK  EQU   PRFRCB+5                                                 00582000
PRFTIC   EQU   IEDQPRF+8                                                00583000
PRFTICC  EQU   PRFTIC                                                   00584000
PRFNBUNT EQU   IEDQPRF+12                                               00585000
PRFSUNIT EQU   PRFNBUNT                                                 00586000
PRFPLQCB EQU   PRFSUNIT                                                 00587000
PRFPIUO  EQU   PRFPLQCB                                                 00588000
@NM00148 EQU   IEDQPRF+16                                               00589000
PRFSVFFO EQU   @NM00148                                                 00590000
PRFSTAT1 EQU   IEDQPRF+20                                               00591000
PRFEOFN  EQU   PRFSTAT1                                                 00592000
PRFCORE  EQU   IEDQPRF+21                                               00593000
PRFXTRA  EQU   PRFCORE                                                  00594000
PRFSCAN  EQU   IEDQPRF+24                                               00595000
PRFTQBCK EQU   IEDQPRF+26                                               00596000
PRFNTXT  EQU   PRFTQBCK                                                 00597000
PRFEOBOF EQU   PRFNTXT                                                  00598000
PRFCHDR  EQU   IEDQPRF+32                                               00599000
PRFHQBCK EQU   IEDQPRF+35                                               00600000
IEDPF1   EQU   0                                                        00601000
PRF1FLG1 EQU   IEDPF1+3                                                 00602000
PRF1WD2  EQU   IEDPF1+4                                                 00603000
PRF1SEQP EQU   PRF1WD2                                                  00604000
PRF1SQID EQU   PRF1SEQP                                                 00605000
PRF1TAG1 EQU   PRF1SQID                                                 00606000
IEDPF2   EQU   0                                                        00607000
PRF2FLG2 EQU   IEDPF2                                                   00608000
PRF2WD2  EQU   IEDPF2+4                                                 00609000
IEDQQCB  EQU   0                                                        00610000
QCBDSFLG EQU   IEDQQCB                                                  00611000
QCBDISK  EQU   QCBDSFLG                                                 00612000
QCBSTCHN EQU   IEDQQCB+9                                                00613000
QCBEOLDT EQU   IEDQQCB+16                                               00614000
QCBBYTE1 EQU   QCBEOLDT+1                                               00615000
QCBLKRLN EQU   IEDQQCB+18                                               00616000
QCBRETCT EQU   QCBLKRLN                                                 00617000
QCBSTAT  EQU   IEDQQCB+19                                               00618000
QCBINSRC EQU   IEDQQCB+21                                               00619000
@NM00156 EQU   QCBINSRC                                                 00620000
QCBTSOF2 EQU   @NM00156+1                                               00621000
QCBTSOF1 EQU   @NM00156+2                                               00622000
QCBINTVL EQU   IEDQQCB+24                                               00623000
QCBPREN  EQU   IEDQQCB+28                                               00624000
QCBLKRRN EQU   QCBPREN+1                                                00625000
QCBDCBAD EQU   IEDQQCB+33                                               00626000
QCBFLAG  EQU   IEDQQCB+36                                               00627000
IEDQPQCB EQU   0                                                        00628000
QCBFHDLZ EQU   IEDQPQCB+3                                               00629000
QCBPFEFO EQU   QCBFHDLZ+1                                               00630000
QCBFHDTZ EQU   IEDQPQCB+6                                               00631000
QCBINTLF EQU   IEDQPQCB+12                                              00632000
IEDNQCB  EQU   0                                                        00633000
QCBSTAT1 EQU   IEDNQCB+4                                                00634000
QCBPLCBN EQU   QCBSTAT1                                                 00635000
QCBWAITC EQU   QCBSTAT1                                                 00636000
QCBRCVRQ EQU   QCBSTAT1                                                 00637000
QCBPLCBA EQU   IEDNQCB+5                                                00638000
IEDRH    EQU   0                                                        00639000
TRHBYTE0 EQU   IEDRH                                                    00640000
TRHTYPE  EQU   TRHBYTE0                                                 00641000
TRHBYTE1 EQU   IEDRH+1                                                  00642000
TRHBYTE2 EQU   IEDRH+2                                                  00643000
IEDTH    EQU   0                                                        00644000
TTHBYTE0 EQU   IEDTH                                                    00645000
TTHEFI   EQU   TTHBYTE0                                                 00646000
TTHDAF   EQU   IEDTH+2                                                  00647000
TTHOAF   EQU   IEDTH+4                                                  00648000
TTHSNF   EQU   IEDTH+6                                                  00649000
TTHTAG   EQU   TTHSNF                                                   00650000
TTHTAG1  EQU   TTHTAG                                                   00651000
IEDQTRM  EQU   0                                                        00652000
TRMSTATE EQU   IEDQTRM                                                  00653000
TRMLOG   EQU   TRMSTATE                                                 00654000
TRMDESTQ EQU   IEDQTRM+1                                                00655000
TRMINSEQ EQU   IEDQTRM+4                                                00656000
TLISTCNT EQU   TRMINSEQ                                                 00657000
TRMOUTSQ EQU   IEDQTRM+6                                                00658000
TLISTEN  EQU   TRMOUTSQ                                                 00659000
TRMDSORG EQU   TLISTEN                                                  00660000
TRMALTD  EQU   IEDQTRM+8                                                00661000
TRMDEVFL EQU   IEDQTRM+10                                               00662000
TRMSTAT  EQU   IEDQTRM+12                                               00663000
IEDNTRM  EQU   0                                                        00664000
TRMBYTE4 EQU   IEDNTRM                                                  00665000
TRMBYTE3 EQU   IEDNTRM+1                                                00666000
TRMBYTE2 EQU   IEDNTRM+2                                                00667000
TRMINPG  EQU   TRMBYTE2                                                 00668000
TRMBYTE1 EQU   IEDNTRM+3                                                00669000
TRMSCPRQ EQU   TRMBYTE1                                                 00670000
TRMINPTP EQU   TRMBYTE1                                                 00671000
TRMBYTE0 EQU   IEDNTRM+6                                                00672000
TRMSIBPT EQU   IEDNTRM+7                                                00673000
IEDQTNT  EQU   0                                                        00674000
IEDIAP01 EQU   0                                                        00675000
WCANCHOR EQU   0                                                        00676000
PTR24    EQU   WCANCHOR+1                                               00677000
DSPCHAIN EQU   12                                                       00678000
DSPLIFO  EQU   56                                                       00679000
DSPLIFOR EQU   60                                                       00680000
DSPLIST  EQU   8                                                        00681000
DSPPOSTR EQU   28                                                       00682000
DSPPRIO  EQU   48                                                       00683000
DSPPRIOR EQU   52                                                       00684000
DSPTRACE EQU   64                                                       00685000
DSPTSTQ  EQU   32                                                       00686000
DSPTSTQR EQU   36                                                       00687000
DSPUNAV  EQU   40                                                       00688000
DSPUNAVR EQU   44                                                       00689000
DSPWAIT  EQU   16                                                       00690000
LCBRSPIN EQU   LCBIOBSN                                                 00691000
LCBLUSNS EQU   LCBRSPIN+5                                               00692000
LCBSCPRS EQU   LCBRSPIN+9                                               00693000
LCBCSWU1 EQU   LCBSCPRS+2                                               00694000
LCBRSPFG EQU   LCBRSPIN+15                                              00695000
LCBCOREQ EQU   LCBTPCD                                                  00696000
@NM00128 EQU   LCBCPA+40                                                00697000
LCBQNXMN EQU   @NM00128                                                 00698000
@NM00131 EQU   LCBERCCW                                                 00699000
LCBCANCL EQU   LCBSAVSN                                                 00700000
LCBCANFG EQU   LCBCANCL                                                 00701000
TRMPRE1  EQU   TRMBYTE4                                                 00702000
TRMPRE   EQU   TRMBYTE3                                                 00703000
TRMNCP   EQU   TRMBYTE3                                                 00704000
TRMPU    EQU   TRMBYTE3                                                 00705000
TRMLU    EQU   TRMBYTE3                                                 00706000
TRMLINK  EQU   TRMBYTE3                                                 00707000
PRFSHDR  EQU   IEDQPRF+42                                               00708000
TRMOPT   EQU   IEDQTRM+20                                               00709000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00710000
@NM00176 EQU   TRMLINK                                                  00711000
TRMLSTAT EQU   TRMLINK                                                  00712000
TRMLINT  EQU   TRMLINK                                                  00713000
TRMEPMOD EQU   TRMLINK                                                  00714000
TRMLULOG EQU   TRMLU                                                    00715000
TRMINERR EQU   TRMLU                                                    00716000
TRMLUREQ EQU   TRMLU                                                    00717000
TRMSESRQ EQU   TRMLU                                                    00718000
TRMTDIFF EQU   TRMLU                                                    00719000
TRMLUTM  EQU   TRMLU                                                    00720000
TRMLUIT  EQU   TRMLU                                                    00721000
TRMAUTO  EQU   TRMLU                                                    00722000
TRMPCONT EQU   TRMPU                                                    00723000
@NM00175 EQU   TRMPU                                                    00724000
TRMNCONT EQU   TRMNCP                                                   00725000
TRMQUCKN EQU   TRMNCP                                                   00726000
TRMSLOWN EQU   TRMNCP                                                   00727000
TRMSYGEN EQU   TRMNCP                                                   00728000
TRMNCPCL EQU   TRMNCP                                                   00729000
TRMIPLDM EQU   TRMNCP                                                   00730000
TRMINOUT EQU   TRMPRE                                                   00731000
TRMRDOUT EQU   TRMPRE                                                   00732000
TRMNLOUT EQU   TRMPRE                                                   00733000
TRMWROUT EQU   TRMPRE                                                   00734000
TRMASNXI EQU   TRMPRE                                                   00735000
TRMSTMM  EQU   TRMPRE                                                   00736000
TRMCMODE EQU   TRMPRE                                                   00737000
TRMSTPND EQU   TRMPRE                                                   00738000
TRMLYNCH EQU   TRMPRE1                                                  00739000
TRMSPOUT EQU   TRMPRE1                                                  00740000
TRMERLCK EQU   TRMPRE1                                                  00741000
TRMQNPL  EQU   TRMPRE1                                                  00742000
TRMSPACT EQU   TRMPRE1                                                  00743000
TRMOCNI  EQU   TRMPRE1                                                  00744000
TRMSESSN EQU   TRMPRE1                                                  00745000
TRMCONT  EQU   TRMPRE1                                                  00746000
@NM00136 EQU   LCBCANCL+3                                               00747000
LCBCANTH EQU   LCBCANCL+1                                               00748000
@NM00135 EQU   LCBCANFG                                                 00749000
LCBCANCD EQU   LCBCANFG                                                 00750000
@NM00134 EQU   LCBCANFG                                                 00751000
LCBCANEB EQU   LCBCANFG                                                 00752000
LCBCANXT EQU   LCBCANFG                                                 00753000
LCBUNADD EQU   @NM00131+21                                              00754000
LCBUASZE EQU   @NM00131+20                                              00755000
LCBDSTEA EQU   @NM00131+16                                              00756000
@NM00133 EQU   @NM00131+4                                               00757000
LCBSTSAV EQU   @NM00131+1                                               00758000
@NM00132 EQU   @NM00131                                                 00759000
@NM00130 EQU   @NM00128+4                                               00760000
LCBNCPPT EQU   @NM00128+1                                               00761000
@NM00129 EQU   LCBQNXMN                                                 00762000
LCBNX509 EQU   LCBQNXMN                                                 00763000
LCBNX162 EQU   LCBQNXMN                                                 00764000
LCBNX142 EQU   LCBQNXMN                                                 00765000
LCBNX064 EQU   LCBQNXMN                                                 00766000
LCBWRSCH EQU   LCBCOREQ+8                                               00767000
LCBCQLNK EQU   LCBCOREQ+4                                               00768000
LCBCQELE EQU   LCBCOREQ                                                 00769000
LCBPAKCH EQU   LCBRSPIN+16                                              00770000
@NM00127 EQU   LCBRSPFG                                                 00771000
LCBRSRH  EQU   LCBRSPFG                                                 00772000
LCBEXPI  EQU   LCBRSPFG                                                 00773000
@NM00126 EQU   LCBRSPIN+12                                              00774000
LCBUSUE1 EQU   LCBCSWU1                                                 00775000
@NM00125 EQU   LCBCSWU1                                                 00776000
@NM00124 EQU   LCBSCPRS+1                                               00777000
LCBDFCMD EQU   LCBSCPRS                                                 00778000
LCBUSER  EQU   LCBLUSNS+2                                               00779000
LCBSMIN  EQU   LCBLUSNS+1                                               00780000
LCBSMAJ  EQU   LCBLUSNS                                                 00781000
LCBRHSV  EQU   LCBRSPIN+2                                               00782000
LCBSNS0  EQU   LCBRSPIN+1                                               00783000
@NM00123 EQU   LCBRSPIN                                                 00784000
@NM00177 EQU   WCANCHOR                                                 00785000
TRMSUBST EQU   IEDNTRM+12                                               00786000
TRMTYPE  EQU   IEDNTRM+11                                               00787000
TRMRLMCT EQU   IEDNTRM+10                                               00788000
TRMCOHTG EQU   TRMSIBPT+1                                               00789000
TRMGPCNT EQU   TRMSIBPT                                                 00790000
TRMBUFRD EQU   TRMBYTE0                                                 00791000
TRMSNA   EQU   TRMBYTE0                                                 00792000
TRMGP    EQU   TRMBYTE0                                                 00793000
TRMDIAL  EQU   TRMBYTE0                                                 00794000
@NM00174 EQU   TRMBYTE0                                                 00795000
TRMOUTPT EQU   TRMBYTE0                                                 00796000
TRMINPUT EQU   TRMBYTE0                                                 00797000
TRMUDEF  EQU   TRMBYTE0                                                 00798000
TRMCOHRT EQU   IEDNTRM+4                                                00799000
TRMSTOTE EQU   TRMBYTE1                                                 00800000
TRMCKPRN EQU   TRMBYTE1                                                 00801000
TRMTSATN EQU   TRMBYTE1                                                 00802000
TRMTRACE EQU   TRMBYTE1                                                 00803000
TRMSWBCK EQU   TRMBYTE1                                                 00804000
TRMAUTOC EQU   TRMBYTE1                                                 00805000
TRMWTNEG EQU   TRMSCPRQ                                                 00806000
TRMWRBRK EQU   TRMBYTE2                                                 00807000
TRMNOSND EQU   TRMBYTE2                                                 00808000
TRMPREP  EQU   TRMBYTE2                                                 00809000
TRMGPACT EQU   TRMBYTE2                                                 00810000
TRMANDL  EQU   TRMBYTE2                                                 00811000
TRMCLOSN EQU   TRMINPG                                                  00812000
TRMREMB  EQU   TRMBYTE2                                                 00813000
TRMRSACT EQU   TRMBYTE2                                                 00814000
TRMOPTBL EQU   IEDQTRM+18                                               00815000
TRMOPNO  EQU   IEDQTRM+17                                               00816000
TRMCHCIN EQU   IEDQTRM+16                                               00817000
TRMSENSE EQU   TRMSTAT+3                                                00818000
TRMTEMPR EQU   TRMSTAT+2                                                00819000
TRMSIO   EQU   TRMSTAT                                                  00820000
@NM00173 EQU   TRMDEVFL+1                                               00821000
TRMTPIN  EQU   TRMDEVFL+1                                               00822000
TRMNCPI  EQU   TRMDEVFL+1                                               00823000
TRMRNTRM EQU   TRMDEVFL+1                                               00824000
@NM00172 EQU   TRMDEVFL+1                                               00825000
TRMLMD   EQU   TRMDEVFL+1                                               00826000
TRMCONC  EQU   TRMDEVFL+1                                               00827000
TRMTSOB  EQU   TRMDEVFL                                                 00828000
TRMBFDY  EQU   TRMDEVFL                                                 00829000
TRMTBLK  EQU   TRMDEVFL                                                 00830000
TRMSBLK  EQU   TRMDEVFL                                                 00831000
TRMBLKS  EQU   TRMDEVFL                                                 00832000
TRMADDC  EQU   TRMDEVFL                                                 00833000
TRMDDIG  EQU   TRMDEVFL                                                 00834000
TRMBUFS  EQU   TRMDEVFL                                                 00835000
TRMPRILK EQU   TRMALTD                                                  00836000
TRMLGB   EQU   TRMDSORG                                                 00837000
TRMUTERM EQU   TLISTCNT                                                 00838000
TRMSCNYN EQU   TRMSTATE                                                 00839000
TRMOPTFN EQU   TRMSTATE                                                 00840000
TRMHELDN EQU   TRMSTATE                                                 00841000
TRMACPTN EQU   TRMSTATE                                                 00842000
TRMPREF  EQU   TRMSTATE                                                 00843000
TRMPROC  EQU   TRMLOG                                                   00844000
TRMLIST  EQU   TRMLOG                                                   00845000
TRMLINE  EQU   TRMSTATE                                                 00846000
TTHDCF   EQU   IEDTH+8                                                  00847000
TTHTAG2  EQU   TTHTAG+1                                                 00848000
@NM00171 EQU   TTHTAG1                                                  00849000
TTHTAGS  EQU   TTHTAG1                                                  00850000
TTHBYTE1 EQU   IEDTH+1                                                  00851000
@NM00170 EQU   TTHBYTE0                                                 00852000
TTHEBIU  EQU   TTHBYTE0                                                 00853000
TTHBBIU  EQU   TTHBYTE0                                                 00854000
TTHFTYPE EQU   TTHBYTE0                                                 00855000
@NM00169 EQU   TRHBYTE2                                                 00856000
@NM00168 EQU   TRHBYTE2                                                 00857000
@NM00167 EQU   TRHBYTE2                                                 00858000
TRHCSI   EQU   TRHBYTE2                                                 00859000
@NM00166 EQU   TRHBYTE2                                                 00860000
TRHCDI   EQU   TRHBYTE2                                                 00861000
TRHEB    EQU   TRHBYTE2                                                 00862000
TRHBB    EQU   TRHBYTE2                                                 00863000
TRHPI    EQU   TRHBYTE1                                                 00864000
@NM00165 EQU   TRHBYTE1                                                 00865000
@NM00164 EQU   TRHBYTE1                                                 00866000
@NM00163 EQU   TRHBYTE1                                                 00867000
TRHER    EQU   TRHBYTE1                                                 00868000
TRHDR2   EQU   TRHBYTE1                                                 00869000
@NM00162 EQU   TRHBYTE1                                                 00870000
TRHDR1   EQU   TRHBYTE1                                                 00871000
TRHEC    EQU   TRHBYTE0                                                 00872000
TRHBC    EQU   TRHBYTE0                                                 00873000
TRHSDI   EQU   TRHBYTE0                                                 00874000
TRHFI    EQU   TRHBYTE0                                                 00875000
@NM00161 EQU   TRHBYTE0                                                 00876000
TRHRUCAT EQU   TRHBYTE0                                                 00877000
QCBTTCIN EQU   QCBPLCBA+1                                               00878000
@NM00160 EQU   QCBPLCBA                                                 00879000
@NM00159 EQU   QCBSTAT1                                                 00880000
QCBFLUSH EQU   QCBSTAT1                                                 00881000
QCBNDXRQ EQU   QCBSTAT1                                                 00882000
QCBESIG  EQU   QCBSTAT1                                                 00883000
QCBSNDRQ EQU   QCBSTAT1                                                 00884000
QCBCHAIN EQU   IEDNQCB                                                  00885000
QCBPQBCK EQU   IEDQPQCB+25                                              00886000
QCBPRIPQ EQU   IEDQPQCB+24                                              00887000
QCBCFHDR EQU   IEDQPQCB+21                                              00888000
QCBLFEFO EQU   IEDQPQCB+18                                              00889000
QCBFFEFO EQU   IEDQPQCB+15                                              00890000
QCBPREVF EQU   QCBINTLF                                                 00891000
QCBINTFF EQU   IEDQPQCB+9                                               00892000
QCBDATSQ EQU   QCBFHDTZ+1                                               00893000
@NM00158 EQU   QCBFHDTZ                                                 00894000
@NM00157 EQU   QCBPFEFO                                                 00895000
QCBDATFL EQU   QCBFHDLZ                                                 00896000
QCBDNHDR EQU   IEDQPQCB                                                 00897000
QCBQBACK EQU   IEDQQCB+37                                               00898000
QCBCKPT  EQU   QCBFLAG                                                  00899000
QCBPROC  EQU   QCBFLAG                                                  00900000
QCBSDFFO EQU   QCBFLAG                                                  00901000
QCBTERMQ EQU   QCBFLAG                                                  00902000
QCBRSRV  EQU   QCBFLAG                                                  00903000
QCBREAD  EQU   QCBFLAG                                                  00904000
QCBNOBRK EQU   QCBFLAG                                                  00905000
QCBTSSES EQU   QCBFLAG                                                  00906000
QCBLGBAD EQU   QCBDCBAD                                                 00907000
QCBRELLN EQU   IEDQQCB+32                                               00908000
QCBTJID  EQU   QCBLKRRN+1                                               00909000
QCBCARCT EQU   QCBLKRRN                                                 00910000
QCBPRLVL EQU   QCBPREN                                                  00911000
QCBMSGCT EQU   IEDQQCB+26                                               00912000
QCBEXTO  EQU   QCBINTVL                                                 00913000
QCBDISC  EQU   QCBTSOF1                                                 00914000
QCBDELAY EQU   QCBTSOF1                                                 00915000
QCBPARTO EQU   QCBTSOF1                                                 00916000
QCBSATRD EQU   QCBTSOF1                                                 00917000
QCBNOBUF EQU   QCBTSOF1                                                 00918000
QCBTPUT  EQU   QCBTSOF1                                                 00919000
QCBTGET  EQU   QCBTSOF1                                                 00920000
QCBWRBRK EQU   QCBTSOF1                                                 00921000
QCBSATLC EQU   QCBTSOF2                                                 00922000
QCBSATTI EQU   QCBTSOF2                                                 00923000
QCBSATCH EQU   QCBTSOF2                                                 00924000
QCBSIMRD EQU   QCBTSOF2                                                 00925000
QCBDSSMI EQU   QCBTSOF2                                                 00926000
QCBPOSTO EQU   QCBTSOF2                                                 00927000
QCBBUFQ  EQU   QCBTSOF2                                                 00928000
QCBINHBN EQU   QCBTSOF2                                                 00929000
QCBSATCT EQU   @NM00156                                                 00930000
QCBSCBOF EQU   IEDQQCB+20                                               00931000
QCBTIME  EQU   QCBSTAT                                                  00932000
QCBCLOCK EQU   QCBSTAT                                                  00933000
QCBSCHDL EQU   QCBSTAT                                                  00934000
QCBSMODE EQU   QCBSTAT                                                  00935000
QCBSEND  EQU   QCBSTAT                                                  00936000
QCBBUFRD EQU   QCBSTAT                                                  00937000
QCBTRMHO EQU   QCBSTAT                                                  00938000
QCBEOM   EQU   QCBSTAT                                                  00939000
QCBHUCT  EQU   QCBRETCT                                                 00940000
QCBIEND  EQU   QCBRETCT                                                 00941000
QCBEND   EQU   QCBRETCT                                                 00942000
QCBNL    EQU   QCBRETCT                                                 00943000
QCBLOGCT EQU   QCBRETCT                                                 00944000
@NM00155 EQU   QCBBYTE1                                                 00945000
QCBRITRM EQU   QCBBYTE1                                                 00946000
@NM00154 EQU   QCBEOLDT                                                 00947000
QCBSLINK EQU   IEDQQCB+13                                               00948000
QCBSTPRI EQU   IEDQQCB+12                                               00949000
QCBSTVTO EQU   IEDQQCB+8                                                00950000
QCBLINK  EQU   IEDQQCB+5                                                00951000
QCBPRI   EQU   IEDQQCB+4                                                00952000
QCBELCHN EQU   IEDQQCB+1                                                00953000
QCBHELD  EQU   QCBDSFLG                                                 00954000
QCBFQCB  EQU   QCBDSFLG                                                 00955000
QCBDRQQ  EQU   QCBDSFLG                                                 00956000
QCBALTMH EQU   QCBDSFLG                                                 00957000
QCBREUS  EQU   QCBDISK                                                  00958000
QCBNREUS EQU   QCBDISK                                                  00959000
QCBCORE  EQU   QCBDSFLG                                                 00960000
QCBTSQ   EQU   QCBDSFLG                                                 00961000
PRF2SEQP EQU   PRF2WD2                                                  00962000
@NM00153 EQU   IEDPF2+1                                                 00963000
@NM00152 EQU   PRF2FLG2                                                 00964000
PRF2SMI  EQU   PRF2FLG2                                                 00965000
PRF2FORM EQU   PRF2FLG2                                                 00966000
PRF2TNTI EQU   PRF2FLG2                                                 00967000
PRF1RULN EQU   PRF1SEQP+2                                               00968000
PRF1TAG2 EQU   PRF1SQID+1                                               00969000
@NM00151 EQU   PRF1TAG1                                                 00970000
PRF1TAGS EQU   PRF1TAG1                                                 00971000
@NM00150 EQU   PRF1FLG1                                                 00972000
PRF1LOGD EQU   PRF1FLG1                                                 00973000
PRF1USS  EQU   PRF1FLG1                                                 00974000
PRF1FORM EQU   PRF1FLG1                                                 00975000
PRF1EXPI EQU   PRF1FLG1                                                 00976000
PRF1FIDI EQU   PRF1FLG1                                                 00977000
PRF1RH   EQU   IEDPF1                                                   00978000
PRFDEST  EQU   IEDQPRF+40                                               00979000
PRFISEQ  EQU   IEDQPRF+38                                               00980000
PRFSTXT  EQU   PRFHQBCK                                                 00981000
PRFNHDR  EQU   PRFCHDR                                                  00982000
PRFCRCD  EQU   IEDQPRF+29                                               00983000
PRFSVSEQ EQU   PRFNTXT+1                                                00984000
PRFSVPRI EQU   PRFEOBOF                                                 00985000
PRFISIZE EQU   PRFSCAN+1                                                00986000
@NM00149 EQU   PRFSCAN                                                  00987000
PRFEOB   EQU   PRFXTRA+1                                                00988000
PRFSTSO  EQU   PRFXTRA                                                  00989000
PRFNHDRN EQU   PRFSTAT1                                                 00990000
PRFNLSTN EQU   PRFSTAT1                                                 00991000
PRFLOCK  EQU   PRFEOFN                                                  00992000
PRFDUPLN EQU   PRFSTAT1                                                 00993000
PRFTSMSG EQU   PRFSTAT1                                                 00994000
PRFITCPN EQU   PRFSTAT1                                                 00995000
PRFERMGN EQU   PRFSTAT1                                                 00996000
PRFCNCLN EQU   PRFSTAT1                                                 00997000
PRFSVFLG EQU   @NM00148+3                                               00998000
PRFSIZE  EQU   PRFSVFFO+2                                               00999000
PRFSRCE  EQU   PRFSVFFO                                                 01000000
PRFLCB   EQU   IEDQPRF+13                                               01001000
PRFTI0   EQU   PRFTIC+1                                                 01002000
@NM00147 EQU   PRFTICC                                                  01003000
@NM00146 EQU   PRFTICC                                                  01004000
@NM00145 EQU   PRFTICC                                                  01005000
PRFTICON EQU   PRFTICC                                                  01006000
@NM00144 EQU   PRFTICC                                                  01007000
@NM00143 EQU   PRFTICC                                                  01008000
PRFBFMM  EQU   PRFTICC                                                  01009000
PRFEOMSG EQU   PRFTICC                                                  01010000
PRFCOUNT EQU   PRFLINK+1                                                01011000
@NM00142 EQU   PRFLINK                                                  01012000
PRFFLAGS EQU   PRFPRI                                                   01013000
PRFIOADR EQU   PRFQCBA                                                  01014000
PRFOPCDE EQU   PRFKEY                                                   01015000
PIURU    EQU   IEDPIU+13                                                01016000
LCBERADR EQU   LCBXRADR+1                                               01017000
LCBPCIRC EQU   LCBXRADR                                                 01018000
LCBDCT3  EQU   LCBXDCT+2                                                01019000
LCBDCT2  EQU   LCBXDCT+1                                                01020000
LCBDCT1  EQU   LCBXDCT                                                  01021000
@NM00141 EQU   LCBXFLAG                                                 01022000
LCBERPND EQU   LCBXFLAG                                                 01023000
LCBSRCPF EQU   LCBXFLAG                                                 01024000
LCBGPCTV EQU   LCBXFLAG                                                 01025000
@NM00140 EQU   LCBXFLAG                                                 01026000
@NM00139 EQU   LCBXFLAG                                                 01027000
@NM00138 EQU   LCBXFLAG                                                 01028000
@NM00137 EQU   LCBXFLAG                                                 01029000
LCBCCW10 EQU   LCBCPA+72                                                01030000
LCBCCW9  EQU   LCBCPA+64                                                01031000
LCBCCW8  EQU   LCBCPA+56                                                01032000
LCBCCW7  EQU   LCBCPA+48                                                01033000
LCBCCW6  EQU   LCBCPA+40                                                01034000
LCBCCW5  EQU   LCBCPA+32                                                01035000
LCBCCW4  EQU   LCBCPA+24                                                01036000
LCBCCW3  EQU   LCBCPA+16                                                01037000
LCBCCW2  EQU   LCBCPA+8                                                 01038000
LCBCCW1  EQU   LCBCPA                                                   01039000
@NM00122 EQU   LCBERCCW                                                 01040000
LCBCSWSV EQU   LCBSAVSN+1                                               01041000
LCBSNSV  EQU   LCBSAVSN                                                 01042000
LCBBFSNS EQU   LCBRSPSV                                                 01043000
LCBINPAK EQU   LCBSTAT6                                                 01044000
LCBMHBID EQU   LCBSTAT6                                                 01045000
LCBRTRRO EQU   LCBSTAT6                                                 01046000
LCBHDRPD EQU   LCBSTAT6                                                 01047000
LCBBFRSV EQU   LCBTPCD+1                                                01048000
@NM00121 EQU   LCBSTAT5                                                 01049000
LCBLUS   EQU   LCBSTAT5                                                 01050000
LCBLUNIT EQU   LCBSTAT5                                                 01051000
LCBPERM  EQU   LCBSTAT5                                                 01052000
LCBNXCMD EQU   LCBBFRW                                                  01053000
LCBERMSK EQU   LCBOBRCH                                                 01054000
LCBSCBA  EQU   IEDQLCB+93                                               01055000
LCBOLT   EQU   LCBMSGFM                                                 01056000
LCBEOT   EQU   LCBMSGFM                                                 01057000
LCBENQ   EQU   LCBMSGFM                                                 01058000
LCBTTD   EQU   LCBMSGFM                                                 01059000
LCBRSTRT EQU   LCBMSGFM                                                 01060000
LCBVSTRT EQU   LCBMSGFM                                                 01061000
LCBACKI  EQU   LCBMSGFM                                                 01062000
LCBNAK   EQU   LCBMSGFM                                                 01063000
LCBTTCIN EQU   IEDQLCB+90                                               01064000
@NM00120 EQU   LCBRBCT2                                                 01065000
LCBDCNT  EQU   LCBRBCT2                                                 01066000
LCBRBCT1 EQU   LCBERBCT                                                 01067000
LCBERBCH EQU   IEDQLCB+85                                               01068000
LCBCOMPL EQU   LCBDLNKN                                                 01069000
LCBPRCPG EQU   LCBERBST                                                 01070000
LCBERROR EQU   LCBERBST                                                 01071000
@NM00119 EQU   LCBERBST                                                 01072000
LCBINQ   EQU   LCBERBST                                                 01073000
LCBRDERR EQU   LCBERBST                                                 01074000
LCBEOMSG EQU   LCBERBST                                                 01075000
LCBMSG   EQU   LCBERBST                                                 01076000
LCBERBLK EQU   IEDQLCB+81                                               01077000
LCBERBPY EQU   IEDQLCB+80                                               01078000
LCBERBQB EQU   LCBERB+1                                                 01079000
LCBERBKY EQU   LCBERB                                                   01080000
LCBRECAD EQU   IEDQLCB+73                                               01081000
@NM00118 EQU   LCBTSTSW                                                 01082000
@NM00117 EQU   LCBTSTSW                                                 01083000
@NM00116 EQU   LCBTSTSW                                                 01084000
@NM00115 EQU   LCBTSTSW                                                 01085000
@NM00114 EQU   LCBTSTSW                                                 01086000
@NM00113 EQU   LCBTSTSW                                                 01087000
@NM00112 EQU   LCBTSTSW                                                 01088000
LCBCONCT EQU   LCBTSTSW                                                 01089000
LCBRESP  EQU   LCBSTAT2                                                 01090000
LCBBFRAV EQU   LCBDIAL                                                  01091000
LCBATTN  EQU   LCBSYNC                                                  01092000
LCBNEGRP EQU   LCBSTAT2                                                 01093000
LCBSNDPR EQU   LCBSTAT2                                                 01094000
LCBBEOTN EQU   LCBSTAT2                                                 01095000
LCBMSGNN EQU   LCBSTAT2                                                 01096000
LCBTRACE EQU   LCBSTAT2                                                 01097000
LCBFREEN EQU   LCBSTAT1                                                 01098000
LCBCONT  EQU   LCBSTAT1                                                 01099000
LCBINITN EQU   LCBSTAT1                                                 01100000
LCBOCNI  EQU   LCBSTAT1                                                 01101000
LCBCVRSP EQU   LCBCTLMD                                                 01102000
LCBRCLLN EQU   LCBSTAT1                                                 01103000
LCBRECOF EQU   IEDQLCB+68                                               01104000
LCBRDBFR EQU   LCBRCBFR                                                 01105000
LCBUCBX  EQU   IEDQLCB+64                                               01106000
LCBTTBIN EQU   LCBERRCT                                                 01107000
@NM00111 EQU   LCBINCAM                                                 01108000
LCBGETMN EQU   LCBINCAM                                                 01109000
LCBRESTR EQU   LCBRCQCB                                                 01110000
LCBPCILK EQU   LCBDCBPT                                                 01111000
LCBSTART EQU   LCBIOBSN+16                                              01112000
LCBAP4OL EQU   LCBSIOCC                                                 01113000
LCBAP3OL EQU   LCBSIOCC                                                 01114000
LCBAP2OL EQU   LCBSIOCC                                                 01115000
LCBAP1OL EQU   LCBSIOCC                                                 01116000
LCBSIOC2 EQU   LCBSIOCC                                                 01117000
LCBSIOC1 EQU   LCBSIOCC                                                 01118000
@NM00110 EQU   LCBSIOCC                                                 01119000
LCBCSWRC EQU   LCBCSW+5                                                 01120000
LCBCSCHC EQU   LCBCSWCS                                                 01121000
LCBCSICC EQU   LCBCSWCS                                                 01122000
LCBCSCCC EQU   LCBCSWCS                                                 01123000
LCBCSCDC EQU   LCBCSWCS                                                 01124000
LCBCSPTC EQU   LCBCSWCS                                                 01125000
LCBCSPGC EQU   LCBCSWCS                                                 01126000
LCBCSIL  EQU   LCBCSWCS                                                 01127000
LCBCSPCI EQU   LCBCSWCS                                                 01128000
LCBUSUE  EQU   LCBCSWUS                                                 01129000
LCBUSUC  EQU   LCBCSWUS                                                 01130000
LCBUSDE  EQU   LCBCSWUS                                                 01131000
LCBUSCE  EQU   LCBCSWUS                                                 01132000
LCBUSBSY EQU   LCBCSWUS                                                 01133000
LCBUSCUE EQU   LCBCSWUS                                                 01134000
LCBUSSM  EQU   LCBCSWUS                                                 01135000
LCBUSAT  EQU   LCBCSWUS                                                 01136000
LCBCSWCA EQU   LCBCSW                                                   01137000
LCBOBR   EQU   LCBFLAG3                                                 01138000
LCBOBRRD EQU   LCBFLAG3                                                 01139000
LCBIOMSG EQU   LCBFLAG3                                                 01140000
LCBSOHC  EQU   LCBFLAG3                                                 01141000
LCBRLAD  EQU   LCBFLAG3                                                 01142000
LCBSOHR  EQU   LCBFLAG3                                                 01143000
@NM00109 EQU   LCBFLAG3                                                 01144000
LCBECBPT EQU   LCBIOBSN+4                                               01145000
LCBECBCC EQU   LCBIOBSN+3                                               01146000
LCBSENS1 EQU   LCBIOBSN+2                                               01147000
LCBABORT EQU   LCBTMOUT                                                 01148000
LCBNOTIN EQU   LCBLOSDT                                                 01149000
LCBOVRUN EQU   LCBSENS0                                                 01150000
LCBDATCK EQU   LCBSENS0                                                 01151000
LCBEQUCK EQU   LCBSENS0                                                 01152000
LCBBUSCK EQU   LCBSENS0                                                 01153000
LCBINTRQ EQU   LCBSENS0                                                 01154000
LCBCMDRJ EQU   LCBSENS0                                                 01155000
LCBFLAG2 EQU   LCBIOBSN                                                 01156000
@NM00108 EQU   LCBFLAG1                                                 01157000
LCBUNREL EQU   LCBFLAG1                                                 01158000
LCBEXCPN EQU   LCBFLAG1                                                 01159000
@NM00107 EQU   LCBFLAG1                                                 01160000
LCBERPIN EQU   LCBFLAG1                                                 01161000
@NM00106 EQU   LCBFLAG1                                                 01162000
LCBFSBFR EQU   LCBMHA                                                   01163000
LCBISZE  EQU   IEDQLCB+28                                               01164000
LCBLNENT EQU   LCBSCBDA+1                                               01165000
@NM00105 EQU   LCBSCBDA                                                 01166000
LCBCPGMH EQU   LCBSTAT4                                                 01167000
LCBREAL  EQU   LCBPHASE                                                 01168000
LCBINOP  EQU   LCBSTAT4                                                 01169000
LCBACTRQ EQU   LCBSTAT4                                                 01170000
LCBIPLRQ EQU   LCBSTAT4                                                 01171000
LCBDACRQ EQU   LCBSTAT4                                                 01172000
LCBDMPRQ EQU   LCBSTAT4                                                 01173000
@NM00104 EQU   LCBLKMDE                                                 01174000
LCBLOCKI EQU   LCBLKMDE                                                 01175000
LCBLOCKR EQU   LCBLKMDE                                                 01176000
LCBHMFLG EQU   LCBLKMDE                                                 01177000
LCBBDFLG EQU   LCBLKMDE                                                 01178000
@NM00103 EQU   LCBINSRC                                                 01179000
LCBABRTN EQU   LCBCHAIN                                                 01180000
LCBTETEN EQU   LCBCHAIN                                                 01181000
LCBBFRSZ EQU   LCBCHAIN                                                 01182000
LCBUREQN EQU   LCBCHAIN                                                 01183000
LCBNORTY EQU   LCBCHAIN                                                 01184000
LCBERMSG EQU   LCBCHAIN                                                 01185000
LCBEXCP  EQU   LCBCHAIN                                                 01186000
LCBINVRQ EQU   LCBSCRNN                                                 01187000
LCB2741N EQU   LCBTSOB                                                  01188000
LCBINHBN EQU   LCBTSOB                                                  01189000
LCBCIRCD EQU   LCBTSOB                                                  01190000
LCBPREP  EQU   LCBTSOB                                                  01191000
LCBSOPL  EQU   LCBTSOB                                                  01192000
LCBSATRD EQU   LCBTSOB                                                  01193000
LCBTSBUF EQU   LCBTSOB                                                  01194000
LCBWRBRK EQU   LCBTSOB                                                  01195000
LCBTDL   EQU   IEDQLCB+18                                               01196000
LCBEOLTD EQU   IEDQLCB+16                                               01197000
LCBRSLNK EQU   IEDQLCB+13                                               01198000
LCBRSPRI EQU   IEDQLCB+12                                               01199000
LCBSTCBA EQU   IEDQLCB+9                                                01200000
LCBRSKEY EQU   IEDQLCB+8                                                01201000
LCBLINK  EQU   LCBRCB+5                                                 01202000
LCBPRI   EQU   LCBRCB+4                                                 01203000
LCBQCBA  EQU   LCBRCB+1                                                 01204000
LCBKEY   EQU   LCBRCB                                                   01205000
SAVTBITN EQU   IEDNSVTD+312                                             01206000
@NM00102 EQU   SAVTCKQB+8                                               01207000
@NM00101 EQU   SAVTCKEC+1                                               01208000
@NM00100 EQU   SAVTCKCC                                                 01209000
SAVTCKPO EQU   SAVTCKCC                                                 01210000
SAVTCKWA EQU   SAVTCKCC                                                 01211000
SAVTCKCH EQU   SAVTCKTB+1                                               01212000
SAVTCKVT EQU   SAVTCKTB                                                 01213000
@NM00099 EQU   IEDNSVTD+297                                             01214000
SAVTRDFG EQU   SAVTRDRV+12                                              01215000
@NM00098 EQU   SAVTRDRV+5                                               01216000
SAVTRDPY EQU   SAVTRDRV+4                                               01217000
SAVTRDQB EQU   SAVTRDRV+1                                               01218000
SAVTRDKY EQU   SAVTRDRV                                                 01219000
SAVTNID  EQU   IEDNSVTD+280                                             01220000
SAVTDVAS EQU   IEDNSVTD+276                                             01221000
SAVTPLSZ EQU   IEDNSVTD+274                                             01222000
@NM00097 EQU   IEDNSVTD+273                                             01223000
SAVTSUBL EQU   IEDNSVTD+272                                             01224000
@NM00096 EQU   SAVTZELM+1                                               01225000
SAVTSUBM EQU   SAVTZELM                                                 01226000
SAVTMHDX EQU   IEDNSVTD+268                                             01227000
SAVTNAT1 EQU   IEDNSVTD+266                                             01228000
SAVTSH20 EQU   IEDNSVTD+264                                             01229000
SAVTLCBS EQU   IEDNSVTD+260                                             01230000
SAVTRNMP EQU   IEDNSVTD+256                                             01231000
SAVTTNTX EQU   IEDNSVTD+252                                             01232000
SAVTNAX  EQU   IEDNSVTD+248                                             01233000
SAVTSUBV EQU   IEDNSVTD+247                                             01234000
SAVTSUBA EQU   IEDNSVTD+246                                             01235000
SAVTSIBC EQU   IEDNSVTD+244                                             01236000
SAVTBSM  EQU   IEDNSVTD+240                                             01237000
SAVTRQTG EQU   IEDNSVTD+236                                             01238000
SAVTRQCH EQU   IEDNSVTD+232                                             01239000
SAVTMAND EQU   IEDNSVTD+228                                             01240000
SAVTSPLN EQU   IEDNSVTD+224                                             01241000
SAVTNADL EQU   IEDNSVTD+222                                             01242000
SAVTNATL EQU   IEDNSVTD+220                                             01243000
SAVTMHTB EQU   IEDNSVTD+216                                             01244000
SAVTSSMH EQU   IEDNSVTD+212                                             01245000
SAVTQRS  EQU   IEDNSVTD+208                                             01246000
SAVTDFCO EQU   IEDNSVTD+200                                             01247000
SAVTSAO  EQU   IEDNSVTD+196                                             01248000
SAVTSARI EQU   IEDNSVTD+192                                             01249000
SAVTSAC  EQU   IEDNSVTD+188                                             01250000
SAVTSAI  EQU   IEDNSVTD+184                                             01251000
SAVTCSCI EQU   IEDNSVTD+180                                             01252000
SAVTSCLU EQU   IEDNSVTD+168                                             01253000
SAVTXTRQ EQU   IEDNSVTD+164                                             01254000
SAVTMVBF EQU   IEDNSVTD+160                                             01255000
@NM00095 EQU   IEDNSVTD+148                                             01256000
SAVTIPCQ EQU   IEDNSVTD+144                                             01257000
@NM00094 EQU   IEDNSVTD+136                                             01258000
SAVTXFMI EQU   IEDNSVTD+132                                             01259000
@NM00093 EQU   IEDNSVTD+124                                             01260000
SAVTXFMO EQU   IEDNSVTD+120                                             01261000
@NM00092 EQU   IEDNSVTD+116                                             01262000
SAVTSSSR EQU   IEDNSVTD+112                                             01263000
SAVTSCPQ EQU   IEDNSVTD+108                                             01264000
SAVTSLCB EQU   IEDNSVTD+104                                             01265000
SAVTLUSR EQU   IEDNSVTD+100                                             01266000
@NM00091 EQU   SAVTLUSQ+8                                               01267000
SAVTLUSP EQU   SAVTLUSQ+4                                               01268000
SAVTLUSB EQU   SAVTLUSQ                                                 01269000
@NM00090 EQU   IEDNSVTD+84                                              01270000
SAVTSAT  EQU   IEDNSVTD+80                                              01271000
SAVTNAT  EQU   IEDNSVTD+76                                              01272000
SAVTCLUP EQU   IEDNSVTD+72                                              01273000
SAVTPIUT EQU   IEDNSVTD+68                                              01274000
SAVTRNTA EQU   IEDNSVTD+64                                              01275000
SAVTDNIR EQU   IEDNSVTD+60                                              01276000
SAVTCNIR EQU   IEDNSVTD+56                                              01277000
SAVTFLDH EQU   IEDNSVTD+52                                              01278000
SAVTSRTN EQU   IEDNSVTD+48                                              01279000
SAVTSREQ EQU   IEDNSVTD+44                                              01280000
SAVTFAIL EQU   IEDNSVTD+42                                              01281000
SAVTSUSE EQU   IEDNSVTD+40                                              01282000
SAVTSIB  EQU   IEDNSVTD+36                                              01283000
SAVTPRTN EQU   IEDNSVTD+32                                              01284000
@NM00089 EQU   IEDNSVTD+28                                              01285000
SAVTWH20 EQU   IEDNSVTD+26                                              01286000
SAVTPWT  EQU   IEDNSVTD+24                                              01287000
SAVTPRTQ EQU   IEDNSVTD+20                                              01288000
SAVTPH20 EQU   IEDNSVTD+14                                              01289000
SAVTPUSE EQU   IEDNSVTD+12                                              01290000
SAVTPLCB EQU   IEDNSVTD+8                                               01291000
SAVTPOOL EQU   IEDNSVTD+4                                               01292000
SAVTPRMT EQU   SAVTDIAF                                                 01293000
SAVTVIRT EQU   SAVTDIAF                                                 01294000
AVTCPBNO EQU   IEDQAVTD+1172                                            01295000
AVTHRESS EQU   IEDQAVTD+1171                                            01296000
@NM00088 EQU   IEDQAVTD+1170                                            01297000
@NM00087 EQU   IEDQAVTD+1169                                            01298000
@NM00086 EQU   IEDQAVTD+1168                                            01299000
@NM00085 EQU   IEDQAVTD+1165                                            01300000
@NM00084 EQU   IEDQAVTD+1164                                            01301000
AVTHRESE EQU   @NM00083                                                 01302000
AVTRADDR EQU   IEDQAVTD+1156                                            01303000
AVTNADDR EQU   IEDQAVTD+1152                                            01304000
AVTHRESN EQU   IEDQAVTD+1148                                            01305000
AVTVOLRN EQU   IEDQAVTD+1144                                            01306000
AVTTOTNN EQU   IEDQAVTD+1140                                            01307000
AVTTRCYN EQU   IEDQAVTD+1136                                            01308000
AVTRCTRN EQU   IEDQAVTD+1132                                            01309000
AVTNOVON EQU   IEDQAVTD+1128                                            01310000
AVTADEBN EQU   IEDQAVTD+1124                                            01311000
AVTVOLRR EQU   IEDQAVTD+1120                                            01312000
AVTTOTNR EQU   IEDQAVTD+1116                                            01313000
AVTTRCYR EQU   IEDQAVTD+1112                                            01314000
AVTRCTRR EQU   IEDQAVTD+1108                                            01315000
AVTNOVOR EQU   IEDQAVTD+1104                                            01316000
AVTADEBR EQU   IEDQAVTD+1100                                            01317000
AVTLODPT EQU   IEDQAVTD+1096                                            01318000
AVTIOBN  EQU   IEDQAVTD+1092                                            01319000
AVTIOBR  EQU   IEDQAVTD+1088                                            01320000
AVTCPBPT EQU   IEDQAVTD+1084                                            01321000
AVTFCPB  EQU   IEDQAVTD+1080                                            01322000
@NM00082 EQU   IEDQAVTD+1076                                            01323000
AVTINCPQ EQU   IEDQAVTD+1072                                            01324000
@NM00081 EQU   IEDQAVTD+1068                                            01325000
@NM00080 EQU   IEDQAVTD+1065                                            01326000
@NM00079 EQU   AVTBIT4                                                  01327000
@NM00078 EQU   AVTBIT4                                                  01328000
@NM00077 EQU   AVTBIT4                                                  01329000
@NM00076 EQU   AVTBIT4                                                  01330000
@NM00075 EQU   AVTBIT4                                                  01331000
@NM00074 EQU   AVTBIT4                                                  01332000
@NM00073 EQU   AVTBIT4                                                  01333000
AVTRUFTN EQU   AVTBIT4                                                  01334000
@NM00072 EQU   IEDQAVTD+1060                                            01335000
AVTNOBFQ EQU   IEDQAVTD+1056                                            01336000
@NM00071 EQU   IEDQAVTD+1052                                            01337000
AVTDKENQ EQU   IEDQAVTD+1048                                            01338000
@NM00070 EQU   IEDQAVTD+1044                                            01339000
AVTDKAPQ EQU   IEDQAVTD+1040                                            01340000
AVTCOPY  EQU   IEDQAVTD+1036                                            01341000
AVTIA    EQU   IEDQAVTD+1032                                            01342000
AVTFL    EQU   IEDQAVTD+1028                                            01343000
@NM00069 EQU   IEDQAVTD+1024                                            01344000
AVTNCPBQ EQU   IEDQAVTD+1020                                            01345000
AVTTOTNC EQU   IEDQAVTD+1016                                            01346000
AVTCMAX  EQU   IEDQAVTD+1012                                            01347000
AVTCMIN  EQU   IEDQAVTD+1008                                            01348000
AVTHM02  EQU   IEDQAVTD+1004                                            01349000
AVTOPCIN EQU   IEDQAVTD+1002                                            01350000
AVTDCTLN EQU   IEDQAVTD+1000                                            01351000
AVTOPMSK EQU   IEDQAVTD+996                                             01352000
AVTDDFT  EQU   IEDQAVTD+992                                             01353000
AVTSTEAL EQU   IEDQAVTD+988                                             01354000
AVTOPTN  EQU   IEDQAVTD+984                                             01355000
AVTDSKCT EQU   IEDQAVTD+982                                             01356000
AVTCKRST EQU   IEDQAVTD+981                                             01357000
AVTSTAN  EQU   AVTBIT3                                                  01358000
AVTSTACN EQU   AVTBIT3                                                  01359000
AVTSTAIN EQU   AVTBIT3                                                  01360000
AVTSTAYN EQU   AVTBIT3                                                  01361000
AVTOLTBN EQU   AVTBIT3                                                  01362000
AVTTSAB  EQU   AVTBIT3                                                  01363000
AVTRFULN EQU   AVTBIT3                                                  01364000
AVTRECVN EQU   AVTBIT3                                                  01365000
@NM00068 EQU   AVTBIT2                                                  01366000
@NM00067 EQU   AVTBIT2                                                  01367000
AVTOPEIN EQU   AVTBIT2                                                  01368000
AVTSTRTN EQU   AVTBIT2                                                  01369000
AVTTOPOL EQU   AVTBIT2                                                  01370000
AVTCOPYN EQU   AVTBIT2                                                  01371000
AVTREUSN EQU   AVTBIT2                                                  01372000
AVTEXTSC EQU   AVTBIT2                                                  01373000
AVTDISKN EQU   AVTBIT1                                                  01374000
AVTQUCKN EQU   AVTBIT1                                                  01375000
AVTCLOSN EQU   AVTBIT1                                                  01376000
AVTREADN EQU   AVTBIT1                                                  01377000
AVTDLAYN EQU   AVTBIT1                                                  01378000
AVTAQTAN EQU   AVTBIT1                                                  01379000
AVTTSON  EQU   AVTBIT1                                                  01380000
AVTAPLKN EQU   AVTBIT1                                                  01381000
AVTDUMBR EQU   IEDQAVTD+976                                             01382000
AVTDLQX  EQU   IEDQAVTD+974                                             01383000
AVTINTLV EQU   IEDQAVTD+972                                             01384000
AVTSMCNT EQU   IEDQAVTD+970                                             01385000
AVTAVFCT EQU   IEDQAVTD+968                                             01386000
AVTOPCON EQU   IEDQAVTD+966                                             01387000
AVTOPCNT EQU   IEDQAVTD+964                                             01388000
AVTLNCNT EQU   IEDQAVTD+962                                             01389000
AVTKEYLE EQU   IEDQAVTD+960                                             01390000
AVTHA16  EQU   IEDQAVTD+958                                             01391000
AVTHA7   EQU   IEDQAVTD+956                                             01392000
AVTHA4   EQU   IEDQAVTD+954                                             01393000
AVTHA3   EQU   IEDQAVTD+952                                             01394000
AVTHA2   EQU   IEDQAVTD+950                                             01395000
AVTGETMS EQU   IEDQAVTD+949                                             01396000
@NM00066 EQU   IEDQAVTD+948                                             01397000
AVTGETMD EQU   IEDQAVTD+944                                             01398000
AVTGETMN EQU   IEDQAVTD+940                                             01399000
AVTCWTOT EQU   IEDQAVTD+936                                             01400000
AVTCWINT EQU   IEDQAVTD+884                                             01401000
AVTDTRAP EQU   IEDQAVTD+880                                             01402000
@NM00065 EQU   IEDQAVTD+878                                             01403000
@NM00064 EQU   AVTIOTR                                                  01404000
AVTIOTRH EQU   AVTIOTR                                                  01405000
AVTIOTRE EQU   AVTIOTR                                                  01406000
@NM00063 EQU   AVTSUBT                                                  01407000
AVTSUBPT EQU   AVTSUBT                                                  01408000
AVTSUBON EQU   AVTSUBT                                                  01409000
AVTAFE30 EQU   IEDQAVTD+872                                             01410000
AVTAFE20 EQU   IEDQAVTD+868                                             01411000
AVTAFE10 EQU   IEDQAVTD+864                                             01412000
AVTCWEC2 EQU   IEDQAVTD+860                                             01413000
AVTCWPM2 EQU   IEDQAVTD+856                                             01414000
AVTCWTS2 EQU   IEDQAVTD+855                                             01415000
AVTCWTS1 EQU   IEDQAVTD+854                                             01416000
AVTCWCLD EQU   AVTCWFL2                                                 01417000
AVTCWRAP EQU   AVTCWFL2                                                 01418000
@NM00062 EQU   AVTCWFL2                                                 01419000
@NM00061 EQU   AVTCWFL2                                                 01420000
@NM00060 EQU   AVTCWFL2                                                 01421000
@NM00059 EQU   AVTCWFL2                                                 01422000
@NM00058 EQU   AVTCWFL2                                                 01423000
AVTCWACT EQU   AVTCWFL2                                                 01424000
@NM00057 EQU   AVTCWFL1                                                 01425000
@NM00056 EQU   AVTCWFL1                                                 01426000
@NM00055 EQU   AVTCWFL1                                                 01427000
@NM00054 EQU   AVTCWFL1                                                 01428000
@NM00053 EQU   AVTCWFL1                                                 01429000
@NM00052 EQU   AVTCWFL1                                                 01430000
@NM00051 EQU   AVTCWFL1                                                 01431000
AVTCOMWN EQU   AVTCWFL1                                                 01432000
AVTCWEC1 EQU   IEDQAVTD+848                                             01433000
AVTCWPM1 EQU   IEDQAVTD+844                                             01434000
AVTCAREA EQU   IEDQAVTD+840                                             01435000
AVTFZERO EQU   IEDQAVTD+836                                             01436000
AVTCADDR EQU   IEDQAVTD+832                                             01437000
AVTCOREC EQU   IEDQAVTD+828                                             01438000
@NM00050 EQU   IEDQAVTD+820                                             01439000
AVTCPBCB EQU   IEDQAVTD+816                                             01440000
@NM00049 EQU   IEDQAVTD+808                                             01441000
AVTDSIOB EQU   IEDQAVTD+804                                             01442000
@NM00048 EQU   IEDQAVTD+796                                             01443000
AVTCPRMB EQU   IEDQAVTD+792                                             01444000
@NM00047 EQU   IEDQAVTD+784                                             01445000
AVTCLOSB EQU   IEDQAVTD+780                                             01446000
@NM00046 EQU   IEDQAVTD+772                                             01447000
AVTACTIB EQU   IEDQAVTD+768                                             01448000
@NM00045 EQU   IEDQAVTD+764                                             01449000
AVTOLTEB EQU   IEDQAVTD+760                                             01450000
AVTOLTCH EQU   AVTOLTQB+1                                               01451000
AVTOLTVT EQU   AVTOLTQB                                                 01452000
@NM00044 EQU   AVTOPCQB+8                                               01453000
@NM00043 EQU   AVTOPCEC+1                                               01454000
@NM00042 EQU   AVTOPCCC                                                 01455000
AVTOPCPO EQU   AVTOPCCC                                                 01456000
AVTOPCWA EQU   AVTOPCCC                                                 01457000
AVTOPCCH EQU   AVTOPCOB+1                                               01458000
AVTOPCVT EQU   AVTOPCOB                                                 01459000
@NM00041 EQU   AVTCKPQB+9                                               01460000
AVTCKPTS EQU   AVTCKPQB+8                                               01461000
@NM00040 EQU   AVTCKPEC+1                                               01462000
@NM00039 EQU   AVTCKPCC                                                 01463000
AVTCKPPO EQU   AVTCKPCC                                                 01464000
AVTCKPWA EQU   AVTCKPCC                                                 01465000
AVTCKPCH EQU   AVTCKPTB+1                                               01466000
AVTCKPVT EQU   AVTCKPTB                                                 01467000
@NM00038 EQU   IEDQAVTD+724                                             01468000
AVTBFRTB EQU   IEDQAVTD+720                                             01469000
@NM00037 EQU   IEDQAVTD+712                                             01470000
AVTBFREB EQU   IEDQAVTD+708                                             01471000
AVTTIMQ  EQU   IEDQAVTD+704                                             01472000
@NM00036 EQU   IEDQAVTD+700                                             01473000
AVTIMQPS EQU   IEDQAVTD+696                                             01474000
AVTINOUT EQU   IEDQAVTD+694                                             01475000
AVTREFTM EQU   IEDQAVTD+692                                             01476000
@NM00035 EQU   IEDQAVTD+680                                             01477000
AVTDELYB EQU   IEDQAVTD+676                                             01478000
AVTOCQPT EQU   IEDQAVTD+672                                             01479000
AVTTSOPT EQU   IEDQAVTD+668                                             01480000
AVTSUPPT EQU   IEDQAVTD+664                                             01481000
AVTCBQCB EQU   IEDQAVTD+660                                             01482000
AVTMSGS  EQU   IEDQAVTD+657                                             01483000
@NM00034 EQU   AVTSYSER                                                 01484000
@NM00033 EQU   AVTSYSER                                                 01485000
@NM00032 EQU   AVTSYSER                                                 01486000
@NM00031 EQU   AVTSYSER                                                 01487000
@NM00030 EQU   AVTSYSER                                                 01488000
@NM00029 EQU   AVTSYSER                                                 01489000
AVTCMAXN EQU   AVTSYSER                                                 01490000
AVTCMINN EQU   AVTSYSER                                                 01491000
AVT2260L EQU   IEDQAVTD+652                                             01492000
AVTABEPL EQU   AVTADBUF                                                 01493000
AVTHFF   EQU   AVTCLRHI+2                                               01494000
@NM00028 EQU   AVTCLRHI                                                 01495000
AVTCCLNK EQU   AVTCRELE+5                                               01496000
AVTCCPRI EQU   AVTCRELE+4                                               01497000
AVTCCQCB EQU   AVTCCELE+1                                               01498000
AVTCCKEY EQU   AVTCCELE                                                 01499000
AVTDELAD EQU   IEDQAVTD+632                                             01500000
AVTDELEM EQU   IEDQAVTD+628                                             01501000
AVTBSX   EQU   AVTCKLNK                                                 01502000
AVTOPETR EQU   AVTHG01                                                  01503000
@NM00027 EQU   AVTCKBYT                                                 01504000
AVTCKONQ EQU   AVTCKBYT                                                 01505000
@NM00026 EQU   AVTCKBYT                                                 01506000
@NM00025 EQU   AVTCKBYT                                                 01507000
@NM00024 EQU   AVTCKBYT                                                 01508000
@NM00023 EQU   AVTCKBYT                                                 01509000
@NM00022 EQU   AVTCKBYT                                                 01510000
@NM00021 EQU   AVTCKBYT                                                 01511000
AVTOPERT EQU   IEDQAVTD+618                                             01512000
AVTOPXCL EQU   IEDQAVTD+616                                             01513000
AVTOPERL EQU   IEDQAVTD+615                                             01514000
@NM00020 EQU   IEDQAVTD+614                                             01515000
AVTCKTIM EQU   IEDQAVTD+612                                             01516000
AVTCKELV EQU   IEDQAVTD+610                                             01517000
AVTCPRCD EQU   IEDQAVTD+609                                             01518000
AVTWARMN EQU   AVTCKELF                                                 01519000
AVTCRTLN EQU   AVTCKELF                                                 01520000
AVTCPIPN EQU   AVTCKELF                                                 01521000
AVTCCLCN EQU   AVTCKELF                                                 01522000
AVTCINCN EQU   AVTCKELF                                                 01523000
@NM00019 EQU   AVTCKELF                                                 01524000
AVTCMCPN EQU   AVTCKELF                                                 01525000
AVTCRDYN EQU   AVTCKELF                                                 01526000
AVTCKQAD EQU   IEDQAVTD+605                                             01527000
AVTSCBSZ EQU   IEDQAVTD+604                                             01528000
@NM00018 EQU   IEDQAVTD+600                                             01529000
AVTCKELE EQU   IEDQAVTD+596                                             01530000
@NM00017 EQU   AVTCKPEL+8                                               01531000
AVTCKRLK EQU   AVTCKPEL+5                                               01532000
AVTCKRPR EQU   AVTCKPEL+4                                               01533000
AVTCKRMQ EQU   AVTCKRMV+1                                               01534000
AVTCKRKY EQU   AVTCKRMV                                                 01535000
AVTHK    EQU   IEDQAVTD+576                                             01536000
AVTHI    EQU   IEDQAVTD+572                                             01537000
AVTIOT   EQU   IEDQAVTD+568                                             01538000
AVTNX    EQU   IEDQAVTD+564                                             01539000
AVTTONE  EQU   IEDQAVTD+560                                             01540000
AVTA3TL  EQU   IEDQAVTD+556                                             01541000
AVTDMECB EQU   IEDQAVTD+552                                             01542000
AVTABEND EQU   IEDQAVTD+546                                             01543000
AVTPLCBN EQU   IEDQAVTD+544                                             01544000
@NM00016 EQU   AVTSAVTP+1                                               01545000
@NM00015 EQU   AVTSAVTF                                                 01546000
AVTSNA   EQU   AVTSAVTF                                                 01547000
AVTONSNA EQU   AVTSAVTF                                                 01548000
AVTVTMCP EQU   AVTSAVTF                                                 01549000
@NM00014 EQU   IEDQAVTD+536                                             01550000
AVTCMBSS EQU   IEDQAVTD+532                                             01551000
AVTRCV   EQU   IEDQAVTD+528                                             01552000
AVTSEND  EQU   IEDQAVTD+524                                             01553000
AVTCSCH  EQU   IEDQAVTD+520                                             01554000
AVTQ1    EQU   IEDQAVTD+516                                             01555000
AVTE7    EQU   IEDQAVTD+512                                             01556000
AVTHB    EQU   IEDQAVTD+508                                             01557000
AVTR1    EQU   IEDQAVTD+504                                             01558000
AVTBZ    EQU   IEDQAVTD+500                                             01559000
AVTEZ    EQU   IEDQAVTD+496                                             01560000
AVTEC    EQU   IEDQAVTD+492                                             01561000
AVTEW    EQU   IEDQAVTD+488                                             01562000
AVTNDIAL EQU   AVTSCOPT                                                 01563000
AVTN2741 EQU   AVTSCOPT                                                 01564000
AVTCONCO EQU   AVTSCOPT                                                 01565000
AVTCONC  EQU   AVTSCOPT                                                 01566000
AVTCMBUF EQU   AVTSCOPT                                                 01567000
AVTAPDMP EQU   AVTSCOPT                                                 01568000
@NM00013 EQU   AVTSCOPT                                                 01569000
AVTHA    EQU   AVTDISP                                                  01570000
AVTEA    EQU   IEDQAVTD+476                                             01571000
AVTAX    EQU   IEDQAVTD+472                                             01572000
AVTA3    EQU   IEDQAVTD+468                                             01573000
AVTGD    EQU   IEDQAVTD+464                                             01574000
AVTAL    EQU   IEDQAVTD+460                                             01575000
AVTOLTST EQU   AVTHG02                                                  01576000
AVTE8    EQU   IEDQAVTD+452                                             01577000
AVTUI    EQU   IEDQAVTD+448                                             01578000
AVTCOMPT EQU   IEDQAVTD+444                                             01579000
AVTCRSRF EQU   IEDQAVTD+440                                             01580000
@NM00012 EQU   IEDQAVTD+436                                             01581000
AVTKA02  EQU   IEDQAVTD+432                                             01582000
AVTOPTPT EQU   IEDQAVTD+428                                             01583000
AVTPCBPT EQU   IEDQAVTD+424                                             01584000
AVTOSECB EQU   IEDQAVTD+420                                             01585000
AVTOPECA EQU   IEDQAVTD+416                                             01586000
AVTOLECA EQU   IEDQAVTD+412                                             01587000
AVTCKECA EQU   IEDQAVTD+408                                             01588000
AVTCWECA EQU   IEDQAVTD+404                                             01589000
AVTCWTCB EQU   IEDQAVTD+400                                             01590000
AVTOLTCB EQU   IEDQAVTD+396                                             01591000
AVTOCTCB EQU   IEDQAVTD+392                                             01592000
AVTCKTCB EQU   IEDQAVTD+388                                             01593000
AVTAS    EQU   IEDQAVTD+384                                             01594000
AVTNOLBF EQU   IEDQAVTD+382                                             01595000
AVTNCKPR EQU   IEDQAVTD+381                                             01596000
AVTCIB   EQU   IEDQAVTD+380                                             01597000
AVTSPLPT EQU   IEDQAVTD+376                                             01598000
AVTMVBFR EQU   IEDQAVTD+372                                             01599000
AVTSBTA  EQU   IEDQAVTD+368                                             01600000
AVTRARTN EQU   IEDQAVTD+364                                             01601000
AVTBSCAN EQU   IEDQAVTD+360                                             01602000
AVTRDYA  EQU   IEDQAVTD+356                                             01603000
AVTDISTR EQU   IEDQAVTD+348                                             01604000
AVTPARM3 EQU   IEDQAVTD+344                                             01605000
@NM00011 EQU   AVTPKF                                                   01606000
@NM00010 EQU   AVTPKF                                                   01607000
@NM00009 EQU   AVTPKF                                                   01608000
AVTFTCHF EQU   AVTPKF                                                   01609000
@NM00008 EQU   AVTPKF                                                   01610000
@NM00007 EQU   AVTPKF                                                   01611000
@NM00006 EQU   AVTPKF                                                   01612000
@NM00005 EQU   AVTPKF                                                   01613000
AVTPARM  EQU   IEDQAVTD+336                                             01614000
AVTEXS2A EQU   IEDQAVTD+330                                             01615000
AVTEXA2S EQU   IEDQAVTD+324                                             01616000
AVTOCGET EQU   IEDQAVTD+320                                             01617000
AVTCKAVT EQU   @NM00003+1                                               01618000
@NM00004 EQU   AVTCKFLG                                                 01619000
AVTCKHLT EQU   AVTCKFLG                                                 01620000
AVTCKREQ EQU   AVTCKFLG                                                 01621000
AVTCKENV EQU   AVTCKFLG                                                 01622000
AVTCKNAC EQU   AVTCKFLG                                                 01623000
AVTCKTAC EQU   AVTCKFLG                                                 01624000
@NM00002 EQU   IEDQAVTD+312                                             01625000
AVTREADD EQU   IEDQAVTD+308                                             01626000
AVTREADY EQU   IEDQAVTD+304                                             01627000
AVTRACE  EQU   IEDQAVTD+300                                             01628000
AVTTCB   EQU   IEDQAVTD+296                                             01629000
AVTPASWD EQU   IEDQAVTD+288                                             01630000
AVTCTLCH EQU   IEDQAVTD+280                                             01631000
AVTDOUBL EQU   IEDQAVTD+272                                             01632000
AVTDOUBX EQU   IEDQAVTD+264                                             01633000
AVTDPARM EQU   IEDQAVTD+260                                             01634000
AVTCSTCS EQU   IEDQAVTD+256                                             01635000
AVTDLQ   EQU   AVTSAVEX+32                                              01636000
@NM00001 EQU   AVTSAVEX                                                 01637000
AVTSAVE4 EQU   IEDQAVTD+144                                             01638000
AVTSAVE3 EQU   IEDQAVTD+72                                              01639000
AVTSAVE2 EQU   IEDQAVTD                                                 01640000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01641000
@RC00279 EQU   @RC00270                                                 01642000
@PB00004 EQU   @EL00001                                                 01643000
@PB00003 EQU   @PB00004                                                 01644000
@PB00002 EQU   @PB00003                                                 01645000
@ENDDATA EQU   *                                                        01646000
         END   IEDQIN,(C'PLS0158',0701,76363)                           01647000
./  ADD  SSI=81080476,NAME=IEDQKA
         TITLE 'IEDQKA'                                                 30000022
*A300000                                                         S21903 33000022
IEDQKA   IOGENER                                                        36000022
         END                                                            60000020
./  ADD  SSI=81080477,NAME=IEDQKB
         TITLE 'IEDQKB'                                                 30000022
*A300000                                                         S21903 33000022
IEDQKB   IOGENER GEN=BISC                                               36000022
         END                                                            60000020
./  ADD  SSI=81080478,NAME=IEDQKC
         TITLE 'IEDQKC'                                                 30000022
*A300000                                                         S21903 33000022
IEDQKC   IOGENER GEN=STSP                                               36000022
         END                                                            60000020
./  ADD  SSI=81080480,NAME=IEDQKD
         TITLE 'IEDQKD'                                                 30000022
*A300000                                                         S21903 33000022
IEDQKD   IOGENER GEN=MINI                                               36000022
         END                                                            60000020
./  ADD  SSI=81080481,NAME=IEDQKE
         TITLE 'IEDQKE'                                                 30000022
*A300000                                                         S21903 33000022
IEDQKE   IOGENER GEN=QTAM                                               36000022
         END                                                            60000020
./  ADD  SSI=63630029,NAME=IEDQNA
         TITLE 'IEDQNA-RESIDENT CLOSEDOWN COMPLETION'                   00600020
IEDQNA   CSECT                                                          01200020
         SPACE 3                                                        01800020
*********************************************************************** 02400020
*                                                                     * 03000020
*TITLE:'IEDQNA'-RESIDENT CLOSEDOWN COMPLETION                         * 03600020
*                                                                     * 04200020
*STATUS:CHANGE LEVEL 0                                                * 04800020
*                                                                     * 05400020
*FUNCTION:THIS MODULE LINKS TO THE NONRESIDENT CLOSEDOWN COMPLETION   * 06000020
*   MODULE TO PROCESS A MCPCLOSE FUNCTION.WHEN CONTROL IS RETURNED,   * 06600020
*   THIS MODULE CHECKS THE RETURN CODE. IF 0,IT BRANCHES TO THE TCAM  * 07200020
*   DISPATCHER TO ALLOW DISK ACTIVITY TO CEASE.  IF 4,IT RESTORES     * 07800020
*   REGISTERS FROM REGISTER 13 AND RETURNS TO TO OS (THE ADDRESS IN   * 08400020
*   REGISTER 14).  IF 8,IT RESTORES THE  USERS REGISTERS FROM         * 09000020
*   AVTSAVE1 AND RETURNS TO THE USER CODE FOLLOWING THE READY MACRO.  * 09600020
*                                                                     * 10200020
*   THIS MODULE  ALSO GETS CONTROL EACH TIME A TCAM ATTACHED TASK     * 10800020
*   TERMINATES.  IT CHECKS THE TCB FOR THE ATTACHED TASK TO DETERMINE * 11400020
*   THE TYPE OF TERMINATION.  IF NORMAL, IT RETURNS TO THE ADDRESS    * 12000020
*   IN REGISTER 14. IF ABNORMAL,IT NEGATES REGISTER 1 AND LINKS TO    * 12600020
*   THE NON-RESIDENT CLOSEDOWN COMPLETION ROUTINE.                      13200020
*                                                                     * 13800020
*ENTRY POINT:                                                         * 14400020
*                                                                     * 15000020
*        IEDQNA-CLOSEDOWN OF THE MCP                                  * 15600020
*        IEDQNA3-TERMINATION OF A TCAM ATTACHED TASK                  * 16200020
*                                                                     * 16800020
*INPUT-                                                               * 17400020
*   WHEN ENTERED AT IEDQNA                                            * 18000020
*   REGISTER 13 HAS THE ADDRESS OF AVTSAVE2                           * 18600020
*   REGISTER 15 HAS THE ADDRESS OFIEDQNA+2                            * 19200020
*   WHEN ENTERED AT IEDQNA3                                           * 19800020
*   REGISTER 1 HAS THE ADDRESS OF THE TCB OF THE TERMINATED TASK      * 20400020
*   REGISTER 13 HAS THE ADDRESS OF A SAVE AREA                        * 21000020
*   REGISTER 15 HAS THE ADDRESS OF IEDQNA3                              21600020
*                                                                     * 22200020
*OUTPUT:NONE                                                          * 22800020
*                                                                     * 23400020
*EXTERNAL ROUTINES:                                                   * 24000020
*                                                                     * 24600020
*        'IEDQNA2'-CLOSES DOWN MCP AND ATTACHED TASKS                 * 25200020
*                  NOTIFIES THE USER OF ANY ABNORMAL TASK TERMINATION * 25800020
*                                                                     * 26400020
*EXITS-NORMAL:THIS MODULE CAN EXIT TO THREE LOCATIONS DEPENDING ON    * 27000020
*   THE RETURN CODE FROM IEDQNA2(DISCUSSED IN 'FUNCTIONS').           * 27600020
*   1.THE USER'S INSTRUCTION WHICH FOLLOWS READY                      * 28200020
*   2.THE ADDRESS IN REGISTER 14(OS ABEND ROUTINE)                    * 28800020
*   3.THE TCAM DISPATCHER AT DSPDISP                                  * 29400020
*                                                                     * 30000020
*EXITS-ERROR:NONE                                                     * 30600020
*                                                                     * 31200020
*TABLES/WORK AREAS                                                    * 31800020
*                                                                     * 32400020
*   AVT (AVTSAVE1,AVTSAVE2)                                           * 33000020
*   TCB                                                               * 33600020
*                                                                     * 34200020
*ATTRIBUTES:REENTERABLE                                               * 34800020
*                                                                     * 35400020
*NOTES:THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL REPRE-   * 36000020
*   SENTATION OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT TO    * 36600020
*   THE ONE USED AT ASSEMBLY TIME. THE CODING HAS BEEN ARRANGED SO    * 37200020
*   THAT REDEFINITION OF 'CHARACTER' CONSTANTS,BY REASSEMBLY, WILL    * 37800020
*   RESULT IN A CORRECT MODULE FOR THE NEW DEFINITIONS.               * 38400020
*                                                                     * 39000020
*********************************************************************** 39600020
         SPACE 3                                                        40200020
*REGISTER ASSIGNMENTS                                                   40800020
         SPACE                                                          41400020
R0       EQU   0                                                        42000020
R1       EQU   1                        PARM REG FOR SUBROUTINE         42600020
R2       EQU   2                                                        43200020
R3       EQU   3                                                        43800020
R4       EQU   4                                                        44400020
R5       EQU   5                                                        45000020
R6       EQU   6                                                        45600020
R7       EQU   7                                                        46200020
R8       EQU   8                                                        46800020
R9       EQU   9                                                        47400020
R10      EQU   10                                                       48000020
R11      EQU   11                                                       48600020
R12      EQU   12                                                       49200020
R13      EQU   13                       ADDR AVTSAVE2                   49800020
R14      EQU   14                                                       50400020
R15      EQU   15                       BASE                            51000020
         SPACE 3                                                        51600020
*STCB                                                                   52200020
         SPACE                                                          52800020
         DS    0F                                                       53400020
         DC    X'4'                                                     54000020
         DC    X'0'                                                     54600020
         SPACE 3                                                        55200020
*ENTRY FROM TCAM DISPATCHER                                             55800020
         SPACE                                                          56400020
         USING *,R15                                                    57000020
         B     QNA00                                                    57600020
         SPACE 3                                                        58200020
*ENTRY FROM OS TERMINATION ROUTINE                                      58800020
         SPACE                                                          59400020
IEDQNA3  EQU   *                                                        60000020
         USING *,R15                                                    60600020
         USING IEDQTCB,R1               BASE FOR TCB                    61200020
         TM    TCBFLGS,X'80'            CHECK TERMINATION               61800020
         BCR   8,R14                    RETURN TO OS IF NORMAL TERM     62400020
         STM   R14,R12,12(R13)          SAVE REGS IN OS SAVE AREA       63000020
         LNR   R1,R1                    NEGATE PARM REGISTER            63600020
         B     QNA10                    LINK TO IEDQNA2                 64200020
         SPACE 3                                                        64800020
         DC    CL8'IEDQNA'                                              65400020
         DC    CL8'5/6/70'                                              66000020
QNA00    EQU   *                                                        66600020
         USING AVTSAVE2,R13                                             67200020
         LR    R1,R13                   PARM FOR RTN                    67800020
QNA10    EQU   *                                                        68400020
         BALR  R12,0                    SET NEW BASE REG                69000020
         USING *,R12                                                    69600020
         DROP  R15                                                      70200020
         LINK  EP=IEDQNA2                                               70800020
         SPACE 3                                                        71400020
*USE RETURN CODE TO INDEX BRANCH TABLE                                  72000020
         SPACE                                                          72600020
         USING IEDQDISP,R11             BASE FOR TCAM DISPATCHER        73200020
         B     QNA20(R15)               CHECK RETURN CODE               73800020
         SPACE                                                          74400020
QNA20    EQU   *                                                        75000020
         B     DSPDISP                  RETURN TO DISPATACHER           75600020
         B     QNA40                    RETURN TO OS TERMINATION        76200020
*        B     QNA30                    RETURN TO USER FOLLOWING READY  76800020
         SPACE                                                          77400020
QNA30    EQU   *                                                        78000020
         SPACE                                                          78600020
         LA    R1,AVTSVSIZ              LENGTH OF SAVE AREA             79200020
         SR    R13,R1                   ADDRESS OF AVTSAVE1             79800020
         SPACE                                                          80400020
QNA40    EQU   *                                                        81000020
         RETURN (14,12),T                                               81600020
         SPACE 3                                                        82200020
         PRINT NOGEN                                                    82800020
         TAVTD                                                          83400020
         TDISPD                                                         84000020
IEDQTCB  DSECT                                                          84600020
         ORG   IEDQTCB+29                                               85200020
TCBFLGS  DS    X                        TERMINATION FLAG                85800020
         END                                                            86400020
./  ADD  SSI=81640233,NAME=IEDQNA2
         TITLE 'IEDQNA2-NONRESIDENT CLOSEDOWN COMPLETION'               00300020
IEDQNA2  CSECT                                                          00600020
*A255000,666000                                                @ZA02080 00700061
*A696000                                                       @ZA03128 00800009
*A696000                                                       @XA09997 00850009
*   PACKAGING PROBLEM                                          @OZ09954 00850191
*A860800                                                       @OZ26164 00850282
*C858070-859540                                                @OZ26164 00850382
* DUMMY APAR                                                   @OZ27328 00850482
         SPACE 3                                                        00900020
*********************************************************************** 01200020
*                                                                     * 01500020
*TITLE:'IEDQNA2'-NONRESIDENT CLOSEDOWN COMPLETION                     * 01800020
*                                                                     * 02100020
*STATUS:CHANGE LEVEL 9                                                * 02400000
*D478200,479000                                                  A44022 02450030
*                                                                     * 02700020
*FUNCTION:THIS MODULE WAITS FOR THE COMPLETION OF ALL DISK ACTIVITY   * 03000020
*   IN THE MCP;IT SETS A CLOSEDOWN COMPLETION BIT IN THE ENVIRON-     * 03300020
*   MENT CHECKPOINT REQUEST ELEMENT;IT POSTS ECBS FOR ATTACHED        * 03600020
*   TASKS;IT WAITS FOR TERMINATION OF THE ATTACHED TASKS;IT           * 03900020
*   DETACHES THE TASKS.                                               * 04200020
*                                                                     * 04500020
*   IF REGISTER 1 IS NEGATIVE,THIS ROUTINE IS GETTING CONTROLAFTER    * 04800020
*   THE ABNORMAL TERMINATION OF A TCAM ATTACHED TASK.  THIS MODULE    * 05100020
*   DETERMINES WHICH TASK HAS ABENDED AND NOTIFIES THE USER VIA A     * 05400020
*   WTO TO THE SYSTEM CONSOLE.                                        * 05700020
*                                                                     * 06000020
*ENTRY POINT:                                                         * 06300020
*                                                                     * 06600020
*        IEDQNQ2                                                      * 06900020
*INPUT:                                                               * 07200020
*   IF REGISTER 1 IS POSITIVE,IT HAS THE ADDRESS OF AVTSAVE2.         * 07500020
*                                                                     * 07800020
*   IF REGISTER 1 IS NEGATIVE, IT HAS THE ADDRESS OF THE TCB FOR      * 08100020
*        THE ABENDED TASK.                                            * 08400020
*                                                                     * 08700020
*OUTPUT:NONE                                                          * 09000020
*                                                                     * 09300020
*EXTERNAL ROUTINES:DSPPOSTR                                           * 09600020
*                                                                     * 09900020
*EXITS-NORMAL:                                                        * 10200020
*                                                                     * 10500020
*   1.IF THERE IS ANY DISK ACTIVITY IN THE MCP,THIS MODULE EXITS      * 10800020
*   TO IEDQNA WITH 0 IN REGISTER 15.  IF TCAM IS CLOSED DOWN,IT EXITS * 11100020
*   TO IEDQNA WITH 8 IN REGISTER 15.  IF AN ATTACHED HAS ABENDED, IT  * 11400020
*   EXITS TO IEDQNA, WITH 4 IN REGISTER 15.                           * 11700020
*                                                                     * 12000020
*EXITS-ERROR:NONE                                                     * 12300020
*                                                                     * 12600020
*TABLES/WORK AREAS:                                                   * 12900020
*                                                                     * 13200020
*   AVT(AVTIOBR,AVTIOBN,AVTOSECB,AVTCKELF,AVTCKECA,AVTOPECA,          * 13500020
*       AVTINECA,AVTOLECA,AVTCKPTB,AVTOPCOB,AVTINSQB,AVTOLTQB,        * 13800020
*       AVTOCGET)                                                     * 14100020
*   IOSBE - DISK QUEUES                                        @VS41905 14400000
*   DCB                                                               * 14700020
*   DEB                                                               * 15000020
*                                                                     * 15300020
*ATTRIBUTES:SERIALLY REUSABLE                                         * 15600020
*                                                                     * 15900020
*NOTES:THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL REPRE-   * 16200020
*   SENTATION OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT TO    * 16500020
*   THE ONE USED AT ASSEMBLY TIME. THE CODING HAS BEEN ARRANGED SO    * 16800020
*   THAT REDEFINITION OF 'CHARACTER' CONSTANTS,BY REASSEMBLY, WILL    * 17100020
*   RESULT IN A CORRECT MODULE FOR THE NEW DEFINITIONS.               * 17400020
*                                                                     * 17700020
*********************************************************************** 18000020
         SPACE 3                                                        18300020
*REGISTER ASSIGNMENTS                                                   18600020
         SPACE                                                          18900020
R0       EQU   0                        TEMPORARY REG                   19200020
R1       EQU   1                        PARAMETER REG                   19500020
R2       EQU   2                                                        19800020
R3       EQU   3                                                        20100020
R4       EQU   4                        BASE FOR TCB                    20400020
R5       EQU   5                        BASE FOR DEB                    20700020
R6       EQU   6                        BASE FOR DCB                    21000020
R7       EQU   7                        BASE FOR LCB                    21300020
R8       EQU   8                        INDEX REG-NUMBER OF IOB'S       21600020
R9       EQU   9                        INDEX FOR LCB LIST-LCB LENGTH   21900020
R10      EQU   10                       BASE FOR IOB                    22200020
R11      EQU   11                       INCREMENT REG-LENGTH OF IOB     22500020
R12      EQU   12                       BASE REG                        22800020
R13      EQU   13                       SAVE REG-POINTS TO AVTSAVE2     23100020
R14      EQU   14                       RETURN REG                      23400020
R15      EQU   15                       BRANCH REG                      23700020
         SPACE                                                          24000020
         SPACE 3                                                        24600020
*STANDARD LINKAGE                                                       24900020
         SPACE                                                          25200020
         USING *,R15                                                    25500020
IEDQNA2  IEDHJN ID                                             @ZA02080 25600061
         LTR   R1,R1                    CHECK TYPE OF PARAMETER         27000020
         BM    QNA70                    BRANCH IF A TCB ADDRESS         27300020
         LR    R13,R1                   ADDRESS OF AVTSAVE2             27600020
         USING AVTSAVE2,R13                                             27900020
         STM   R14,R12,AVTSAVE2+12      SAVE REGS                       28200020
         LR    R12,R15                  SET UP BASE                     28500020
         DROP  R15                                                      28800020
         USING IEDQNA2,R12                                              29100020
         SPACE 3                                                        29400020
*ALL LINE ACTIVITY IS NOW STOPPED. NOW CHECK FOR ANY DISK ACTIVITY IN   29700020
*THE MCP. GET IOSBE'S FROM AVT AND CHECK FOR BUSY. IF THERE             30000000
*ARE ANY INCOMPLETE, THIS ROUTINE ISSUES OS WAIT ON THE I/O,THEN EXITS  30300020
*TO DISPATCHER QPOSTING ITS OWN QCB TO ITSELF WITH LOWEST PRIORITY.     30600020
         SPACE                                                          30900020
         TM    AVTBIT1,AVTDISKN         CHECK FOR DISK=YES         1119 31000020
         BZ    QNA52                    BRANCH IF DISK=NO          1119 31100020
         L     R10,AVTIOBR              ADDR OF REUS IOSBE'S   @VS41905 31200000
         L     R5,AVTADEBR              GET ADDR OF DEB        @VS41905 31300000
QNA40    EQU   *                                                        31500020
         LR    R3,R10                   SAVE ADDRESS FOR LATER COMPARE  31800020
         USING IOSBE,R10                BASE FOR IOSBE         @VS41905 32100000
         SPACE 3                                                        32400020
*INITIALIZE FOR IOSBE LOOP                                     @VS41905 32700000
         SPACE                                                          33000020
         LTR   R10,R10                  CHECK FOR NO IOSBE'S   @VS41905 33300000
         BZ    QNA50                    BRANCH IF THERE ARE NONE        33900020
         USING IEDQDEB,R5                                               35100020
         XR    R8,R8                    CLEAR INDEX REG                 35400020
         IC    R8,DEBNMEXT              GET NUMBER OF IOSBE'S  @VS41905 35700000
         LA    R11,IOSBELEN             GET LENGTH OF IOSBE    @VS41905 36100000
         SPACE 3                                                        36600020
*BEGINNING OF LOOP THROUGH IOSBE'S                             @VS41905 36900000
         SPACE                                                          37200020
QNA44    EQU   *                                                        37500020
         TM    IOSBEFLG,IOSBERDY        IS IOSBE IN READY STATE@VS41905 37800000
*                                       (I.E., NOT BUSY)       @VS41905 38000000
         BO    QNA48                    YES, BRANCH            @VS41905 38200000
         SPACE 3                                                        38400020
*IOSBE BUSY - WAIT FOR I/O TO COMPLETE                         @VS41905 38700000
         SPACE                                                          39000020
         WAIT  ECB=AVTOSECB             WAIT FOR I/O                    39300020
         SPACE                                                          39600020
         LA    R1,AVTCLOSB              ADDRESS OF CLOSEDOWN COMP'S QCB 39900020
         L     R11,AVTEA                ADDRESS OF DISPATCHER           40500020
         USING IEDQDISP,R11             BASE FOR DISPATCHER             40800020
         LA    R15,DSPPOSTR             ADDRESS OF POST ENTRY           41100020
         BALR  R14,R15                  EXIT TO DISPATCHER,POST QCB     41400020
         LA    R15,0                   SET RETURN CODE FOR DSPDISP      41700020
         B     QNA60                    RETURN TO RESIDENT RTN          42000020
QNA48    EQU   *                                                        42300020
         AR    R10,R11                  MOVE TO NEXT IOSBE     @VS41905 42600000
         BCT   R8,QNA44                 SUBTRACT FROM COUNT AND BRANCH T42900020
                                        BEGINNING OF LOOP               43200020
         SPACE                                                          43500020
*END OF LOOP THROUGH IOSBE'S                                   @VS41905 43800000
         SPACE 3                                                        44100020
QNA50    EQU   *                                                        44400020
         L     R10,AVTIOBN              GET ADDR OF NON-REUS   @VS41905 44700000
*                                       DISK IOSBE'S           @VS41905 44900000
         L     R5,AVTADEBN              GET ADDR OF DEB        @VS41905 45100000
         CR    R3,R10                   WHICH IOSBE'S WERE     @VS41905 45300000
*                                       PROCESSED              @VS41905 45600000
         BNE   QNA40                    BRANCH IF 1ST LIST(REUSABLE) WAS45900020
                                        JUST PROCESSED                  46200020
         SPACE 3                                                        46500020
*ALL DISK ACTIVITY HAS STOPPED. NOW MAKE SURE ALL ATTACHED TASKS HAVE   46800020
*TERMINATED BY POSTING THEIR TCAM ECB'S AND ISSUING OS WAIT ON THEIR    47100020
*OS ECB'S.                                                              47400020
         SPACE                                                          47700020
QNA52    EQU   *                                                   1119 47800020
QNA53    EQU   *                                                   0106 47920020
         OI    AVTCKELF,AVTCCLCN        TURN ON BIT FOR CKPT            48000020
         POST  AVTOPCOB+4               OPERATOR  CONTROL               48300020
         POST  AVTCKPTB+4               CHECKPOINT                      48600020
         POST  AVTOLTQB+4               ON LINE TEST                    48900020
         POST  AVTCWEC1                 POST ECB FOR COMMON WRITE       49200020
         LA    R1,AVTOPECA              ADDRESS OF OP. CONTROL ECB      49500020
         LA    R2,AVTCKECA              ADDRESS OF CHECKPOINT ECB       49800020
         LA    R3,AVTOLECA              ADDRESS OF ON-LINE-TEST         50100020
         LA    R4,AVTCWECA              ADDRESS OF COMMON WRITE RTN     50400020
         STM   R1,R4,QNAECBLS           PUT ADDRESS IN ECB LIST         50700020
         OI    QNAEND,X'80'             INDICATE END OF LIST            51000020
         SPACE 3                                                        51300020
         WAIT  4,ECBLIST=QNAECBLS                                       51600020
         SPACE 3                                                        51900020
*DETACH THE ATTACHED TASKS: CHECKPOINT, OPERATOR CONTROL, ON-LINE-      52200020
*TEST,COMMON WRITE ROUTINE. THE ADDRESS OF THE TCBS ARE IN THE AVT.     52500020
         SPACE                                                          52800020
         NC    AVTCKTCB(4),AVTCKTCB     CHECK FOR CHECKPOINT       0317 53100020
         BZ    QNA55                    BRANCH IF NOT ATTACHED     0317 53400020
         DETACH AVTCKTCB                                                53700020
QNA55    EQU   *                                                        54000020
         DETACH AVTOCTCB                                                54300020
         NC    AVTOLTCB(4),AVTOLTCB     CHECK FOR TOTE SPECIFIED   0317 54600020
         BZ    QNA56                    BRANCH IF NOT ATTACHED     0317 54900020
         DETACH AVTOLTCB                                                55200020
QNA56    EQU   *                                                        55500020
         NC    AVTCWTCB(4),AVTCWTCB      CHECK FOR COMWRITE        0317 55800020
         BZ    QNA57                    BRANCH IF NOT ATTACHED     0317 56100020
         DETACH AVTCWTCB                DETACH COMMON WRITE             56400020
QNA57    EQU   *                                                        56700020
         SR    R0,R0                    CLEAR                      1203 56760020
         CLI   AVTCLOSB+8,X'FF'         CHECK FOR CONSOLE ID       1203 56820020
         BE    QNA58                    BRANCH IF NOT FROM CONSOLE 1203 56880020
         IC    R0,AVTCLOSB+8            GET CONSOLE ID             1203 56940020
         OI    QNAMSG+2,X'40'           MCSFLAG=REG0 BIT IS ON     1203 57000020
QNA58    EQU   *                                                   1203 57060020
         WTO   MF=(E,QNAMSG)            CLOSEDOWN REQUEST DID NOT  1203X57120020
                                        COME FROM CONSOLE          1203 57180020
QNA59    EQU   *                                                   1203 57240020
         LA    R15,8                    SET RETURN CODE FOR USER        57300020
         SPACE 3                                                        57600020
*RETURN TO THE RESIDENT PORTION OF CLOSEDOWN COMPLETION                 57900020
         SPACE                                                          58200020
QNA60    EQU   *                                                        58500020
         RETURN (14,12),T,RC=(15)                                       58800020
         SPACE 3                                                        59100020
*DETERMINE THE ATTACHED TASK THAT HAS ABENDED                           59400020
         SPACE                                                          59700020
QNA70    EQU   *                                                        60000020
         LR    R11,R15                  SET NEW BASE REG                60300020
         USING IEDQNA2,R11                                              60600020
         DROP  R12                                                      60900020
         LPR   R1,R1                    REG IS NEGATIVE                 61200020
         LA    R1,0(,R1)                CLEAR HIGH ORDER BYTE           61500020
        LA    R10,10                   COUNT FOR TIMER LOOP       1209  61540020
         SPACE 3                                                        61580020
*BEGINNING OF STIMER LOOP WAITING FOR OPEN TO INITIALIZE TCAM WORD 1209 61620020
*IN CVT                                                                 61660020
         SPACE                                                          61700020
QNA71    EQU   *                                                   1209 61740020
         L     R9,16                    GET CVT ADDRESS                 61800020
         L     R9,AVTCVTPT(,R9)                                         62100020
         LA    R9,0(,R9)                CLEAR HIGH ORDER BYTE      1111 62170020
         LTR   R9,R9                    CHECK FOR LOADED DISPATCHER1111 62240020
         BNZ   QNA73                    BRANCH IF OPEN HAS BEEN IN 1209 62250020
         STIMER WAIT,BINTVL=QNAINTVL    WAIT FOR 10 SECONDS        1209 62260020
         BCT   R10,QNA71                SUB FROM INDEX,CHECK AGAIN 1209 62270020
         B     QNA78                    GIVE UP ON OPEN -DEFAULT   1209 62280020
         SPACE                                                          62290020
*END OF STIMER LOOP                                                     62300020
         SPACE 3                                                        62310020
QNA73    EQU   *                                                   1209 62320020
         L     R9,0(,R9)                GET AVT ADDRESS                 62400020
         DROP  R13                                                      62700020
         USING IEDQAVTD,R9              BASE FOR AVT                    63000020
         C     R1,AVTCKTCB              COMPARE CKPT TCB ADDRESS        63300020
         BNE   QNA75                    BRANCH IF NOT CHECKPOINT        63600020
         NI    AVTCKFLG,X'FF'-AVTCKTAC-AVTCKNAC IND CHECKPOINT @ZM47551 63900020
*                                       NO LONGER ACTIVE       @ZM47551 64500020
         LA    R1,QNAMSG1               ADDRESS OF ERROR MSG            64800020
         B     QNA90                    ISSUE ERROR MSG                 65100020
QNA75    EQU   *                                                        65400020
         C     R1,AVTOCTCB              COMPARE WITH TCB FOR           X65700020
                                        OPERATOR CONTROL                66000020
         BNE   QNA80                    BRANCH IF NOT OPERATOR CNTL     66300020
QNA78    EQU   *                                                   1111 66400020
         LA    R1,QNAMSG2               ADDRESS OF ERROR MSG            66600020
         XC    AVTAFE10(AVTCWINT-AVTAFE10),AVTAFE10 CLEAR THE  @ZA02080 66700061
*                                         COMWRITE POINTERS    @ZA02080 66800061
         B     QNA90                    ISSUE MSG                       66900020
QNA80    EQU   *                                                        67200020
         C     R1,AVTOLTCB              COMPARE TCB ADDRESS FOR TOTE    67500020
         BNE   QNA85                    BRANCH IF NOT TOTE              67800020
         LA    R1,QNAMSG3               ADDRESS OF TOTE MSG        0225 68100020
         MVI   AVTOLTST,AVTEZERO        CLEAR TOTE PARM TO ZERO    0225 68400020
         B     QNA90                    ISSUE ERROR MSG                 68700020
QNA85    EQU   *                                                        69000020
         LA    R1,QNAMSG4               ADDRESS OF MSG FOR COMWRITE     69300020
         NI    AVTCWFL1,X'FF'-AVTCOMWN  INDICATE COMWRT NOT ACTIVE      69600020
         MVI   AVTCWTS1,AVTEFF          MAKE COMWRITE'S...     @ZA03128 69700009
         MVI   AVTCWTS2,AVTEFF          ... ECB'S UNAVAILABLE  @ZA03128 69800009
         SPACE 3                                                        69900020
*ISSUE WTO TO NOTIFY USER OF ABEND                                      70200020
         SPACE                                                          70500020
QNA90    EQU   *                                                        70800020
         WTO   MF=(E,(1))                                               71100020
         LA    R15,4                    RETURN CODE -TO OS              71400020
         BR    R14                      RETURN TO RESIDENT MODULE      X71700020
                                        WITHOUT RESTORING REGS          72000020
         SPACE 3                                                        72300020
*ECB LIST USED TO WAIT ON TERMINATION OF ATTACHED TASKS                 72600020
         SPACE                                                          72900020
QNAECBLS DS    0F                                                       73200020
         DC    F'0'                                                     73500020
         DC    F'0'                                                     73800020
         DC    F'0'                                                     74100020
QNAEND   DS    0F                                                       74400020
         DC    F'0'                                                     74700020
         SPACE 3                                                        74800020
QNACODE  DC    X'80042000'              ABEND COMPLETION FOR TOTE  0916 74900020
QNAINTVL DC    XL4'3E8'                 BINARY INTERVAL OF 10.00SEC1209 74950020
         SPACE 3                                                        75000020
QNAMSG1  WTO   'IED096I CHECKPOINT NO LONGER ACTIVE',MF=L,             X75300020
               ROUTCDE=(2,11),DESC=4                                    75600020
QNAMSG2  WTO   'IED096I OPERATOR CONTROL NO LONGER ACTIVE',MF=L,       X75900020
               ROUTCDE=(2,11),DESC=4                                    76200020
QNAMSG3  WTO   'IED096I TOTE NO LONGER ACTIVE',MF=L,               0225X76500020
               ROUTCDE=(2,11),DESC=4                                    76800020
QNAMSG4  WTO   'IED096I COMWRITE NO LONGER ACTIVE',MF=L,               X77100020
               ROUTCDE=(2,11),DESC=4                                    77400020
QNAMSG   WTO   'IED097I TCAM IS CLOSED DOWN',ROUTCDE=(2,11),DESC=5,    X77500020
               MF=L                                                1203 77600020
         SPACE 3                                                        77700020
         TTSID                                                          77800020
         EJECT                                                 @VS41905 78000000
         TAVTD                                                          78300020
         TDISPD                                                         78600020
         TTCBD                                                          78900020
         SPACE 3                                                        79200020
*DSECT FOR DEB                                                          79500020
         SPACE                                                          79800020
         TDEBD                                                 @VS41905 80100000
         DCBD  DSORG=TQ                                                 85200020
         TLCBD                                                          85500020
         EJECT                                                 @VS41905 85800000
         TIOSBED                                               @OZ26164 85807082
         SPACE 4                                               @VS41905 85961000
*********************************************************************** 85968000
*                *                                                    * 85975000
*    IOSBEENT    *                      IOSBEIOS                      * 85982000
*                *                                                    * 85989000
*********************************************************************** 85996000
*                *                                                    * 86003000
*    IOSBEFLG    *                      IOSBECPB                      * 86010000
*                *                                                    * 86017000
*********************************************************************** 86024000
*                                  *                                  * 86031000
*            IOSBEXCC              *             IOSBERET             * 86038000
*                                  *                                  * 86045000
*********************************************************************** 86052000
*                *                                                    * 86059000
*    IOSBERET    *                      IOSBENEW                      * 86066000
*     (CONT)     *                                                    * 86073000
*********************************************************************** 86080000
*                *                                                    * 86082082
*    IOSBELCK    *                                                    * 86084082
*                *                                                    * 86086082
*********************************************************************** 86088082
*                                                                     * 86090082
*                                                                     * 86092082
*                                                                     * 86094082
*********************************************************************** 86096082
         END                                                            86100020
./  ADD  SSI=71940025,NAME=IEDQNB
QNB      TITLE 'IEDQNB-APPLICATION PROGRAM CHECKPOINT INTERFACE'        00300020
         SPACE 3                                                        00600020
*A000000-999999                                                @Y16X5C0 00620000
*C390000-408000                                                  Y01004 00700002
*A349500-350500                                                  Y01004 00800002
*D687000                                                       @Y17XAC2 00801000
*C688400                                                       @Y17XAC2 00802000
*D825000-828000                                                @Y17XAC2 00803000
*D834000                                                       @Y17XAC2 00804000
*A689100                                                       @Y17XAC2 00805000
*A837000                                                       @Y17XAC2 00806000
*A392000                                                       @Y17XAC2 00807000
*********************************************************************** 00900020
*                                                                     * 01200020
*MODULE-NAME = IEDQNB (TCAM,CHECKPOINT/RESTART)                       * 01250000
*                                                                     * 01800020
*DESCRIPTIVE-NAME = APPLICATION PROGRAM CHECKPOINT INTERFACE          * 01810000
*                                                                     * 01820000
*COPYRIGHT = 'NONE'                                                   * 01830000
*                                                                     * 01840000
*STATUS: VERSION 10.0                                                 * 01860000
*                                                                     * 02400020
*FUNCTION:WHEN AN APPLICATION PROGRAM ISSUES A TCAM MACRO WHICH       * 02700020
*   CHANGES THE MCP ENVIRONMENT,THIS MODULE BUILDS A CHECKPOINT       * 03000020
*   REQUEST ELEMENT ,   TPOSTS IT TO THE READY QUEUE, AND WAITS       * 03300020
*   UNTIL THE CHECKPOINT HAS BEEN TAKEN. WHEN AN OPEN OR CLOSE IS     * 03600020
*   ISSUED IN AN APPLICATION PROGRAM,THIS MODULE DETERMINES IF AN     * 03900020
*   ENTRY IN THE CKREQ-TTR TABLE IS INVOLVED,AND IF SO,IT INVERTS     * 04200020
*   THE STATUS OF THE CKREQ-TTR ENTRY. (IE. IF A DESTINATION QUEUE    * 04500020
*   WHICH CAN BE CHECKPOINTED AS A RESULT OF A CKREQ MACRO IS         * 04800020
*   OPENED, ITS ENTRY IN THE CKREQ-TTR TABLE IS MADE ACTIVE; IF       * 05100020
*   CLOSED,ITS ENTRY IN THE CKREQ-TTR TABLE IS MADE INACTIVE.         * 05400020
*   INACTIVE ENTRIES CAN BE USED FOR OTHER DESTINATION QUEUES WHICH   * 05700020
*   ARE OPENED LATER.) IF SYNC=YES IS SPECIFIED ON THE DESTINATION    @ 06000020
*   THEN THE QUEUE CAN BE CHECKPOINTED WITH CKREQ MACRO,SO IT IS      * 06300020
*   GIVEN AN ENTRY IN THE CKREQ-TTR TABLE                             * 06600020
*                                                                     * 06900020
*ENTRY POINTS:                                                        * 07200020
*                                                                     * 07500020
*        IEDQNB-FROM CKREQ MACRO                                      * 07800020
*        IEDQNB02-FROM TCHING MACRO                                   * 08100020
*        IEDQNB05-FROM OPEN OR CLOSE                                  * 08400020
*                                                                     * 08700020
*INPUT:THIS MODULE RECEIVES THE FOLLOWING INPUT AT THE INDICATED      * 09000020
*   ENTRY POINT:                                                      * 09300020
*                                                                     * 09600020
*   IEDQNB:NONE                                                       * 09900020
*   IEDQNB02:REGISTER 1 CONTAINS THE TERMNAME OFFSET OF THE TERMI-    * 10200020
*            NAL SPECIFIED IN THE TCHNG MACRO.                        * 10500020
*   IEDQNB05:REGISTER 1 CONTAINS THE ADDRESS OF THE DCB SPECIFIED     * 10800020
*            IN THE OPEN OR CLOSE MACRO.                              * 11100020
*                                                                     * 11400020
*OUTPUT:THIS MODULE BUILDS,IN THE PCB, THE FOLLOWING REQUEST ELE-     * 11700020
*   MENTS FOR THE INDICATED ENTRY POINTS:                             * 12000020
*                                                                     * 12300020
*   IEDQNB:OFFSER 0-KEY:X'60'                                         * 12600020
*                 1-ADDRESS OF CHECKPOINT QCB                         * 12900020
*                 4-PRIORITY                                          * 13200020
*                 5-LINK FIELD                                        * 13500020
*                 8-ADDRESS OF DEB CHAIN FOR APPLICATION PROGRAM      * 13800020
*                12-ADDRESS OF ECB FOR APPLICATION PROGRAM            * 14100020
*                                                                     * 14400020
*   IEDQNB02:     0-KEY:X'10'                                         * 14700020
*                 1-ADDRESS OF CHECKPOINT QCB                         * 15000020
*                 4-PRIORITY                                          * 15300020
*                 5-LINK FIELD                                        * 15600020
*                 8-OFFSET TO TERMNAME TABLE ENTRY                    * 15900020
*                10-UNUSED                                            * 16200020
*                12-ADDRESS OF ECB FOR APPLICATION PROGRAM            * 16500020
*                                                                     * 16800020
*                                                                     * 17100020
*   IEDQNB05:THIS ENTRY POINT INVERTS THE FIRST BIT OF THE CKREQ-     * 17400020
*            TTR TABLE ENTRY:                                         * 17700020
*                                                                     * 18000020
*            OFFSET 0-BIT0-ON,ENTRY IS ACTIVE                           18300020
*                        1-ON,ENTRY HAS A DISK ERROR                  * 18600020
*                        2-7-UNUSED                                   * 18900020
*                   1-TTR OF DISK RECORD                              * 19200020
*                   4-OFFSET TO TERMNAME TABLE ENTRY                  * 19500020
*                                                                     * 19800020
*EXTERNAL ROUTINES:                                                   * 20100020
*                                                                     * 20400020
*        IEDQTNT-DETERMINES TERMNAME OFFSET                           * 20700020
*                                                                     * 21000020
*EXITS-NORMAL:THIS MODULE BRANCHES TO THE ADDRESS IN REGISTER 14.     * 21300020
*                                                                     * 21600020
*EXITS-ERROR:NONE                                                     * 21900020
*                                                                     * 22200020
*TABLES/WORK AREAS:                                                   * 22500020
*                                                                     * 22800020
*   AVT (AVTCKGET,AVTCKPTB,AVTCLRHI,AVTCVPT,AVTCKPR,AVTRNMPT          * 23100020
*   CHECKPOINT WORK AREA                                              * 23400020
*   DCB                                                               * 23700020
*   PCB                                                               * 24000020
*   DEB(APPLICATION PROGRAM)                                          * 24300020
*   LCB                                                               * 24600020
*   ACCESS METHOD WORK AREA                                           * 24900020
*   TERMNAME TABLE                                                    * 25200020
*   TERMINAL TABLE                                                    * 25500020
*                                                                     * 25800020
*ATTRIBUTES:REENTERABLE                                               * 26100020
*                                                                     * 26400020
*NOTES:THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL REPRE-   * 26700020
*   SENTATION OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT TO    * 27000020
*   THE ONE USED AT ASSEMBLY TIME. THE CODING HAS BEEN ARRANGED SO    * 27300020
*   THAT REDEFINITION OF 'CHARACTER' CONSTANTS,BY REASSEMBLY, WILL    * 27600020
*   RESULT IN A CORRECT MODULE FOR THE NEW DEFINITIONS.               * 27900020
*                                                                     * 28200020
*********************************************************************** 28500020
         SPACE 3                                                        28800020
IEDQNB   CSECT                                                          29100020
         SPACE 3                                                        29400020
*REGISTER ASSIGNMENTS                                                   29700020
         SPACE                                                          30000020
R0       EQU   0                                                        30300020
R1       EQU   1                        INPUT PARM;TERMNAME OFFSET      30600020
R2       EQU   2                        ADDRESS OF CKPT WORK AREA       30900020
R3       EQU   3                        ADDRESS OF CKPT REQUEST ELM     31200020
R4       EQU   4                        ADDRESS OF PCB WORK AREA        31500020
R5       EQU   5                        ADDRESS OF DEB CHAIN            31800020
R6       EQU   6                        ADDRESS OF PCB                  32100020
R7       EQU   7                        ADDRESS OF CKPT QCB             32400020
R8       EQU   8                        ADDRESS OF CVT; LCB             32700020
RAVT     EQU   9                        ADDRESS OF AVT                  33000020
R10      EQU   10                       ADDRESS OF TCB                  33300020
R11      EQU   11                       ADDRESS OF ACCESS WORKAREA      33600020
RPEWA    EQU   11                       ADDRESS OF PEWA        @ZM46809 33650010
R12      EQU   12                       ADDRESS OF CKREQ-TTR ENTRY      33900020
R13      EQU   13                       ADDRESS OF SAVE AREA            34200020
R14      EQU   14                       BRANCH REG,INDEX                34500020
R15      EQU  15                                                        34800020
QNBNOCKR EQU   4                        RETURN CODE FOR NO CKPT    1019 34900020
CODE     EQU   8                        TOPCTL CODE              Y01004 34950002
ADDRESS  EQU   7                        MASK FOR ADDRESS         Y01004 35000002
SIXTEEN  EQU   16                       ECB DISP                 Y01004 35050002
         SPACE 3                                                        35100020
         USING IHADCB,R1                BASE FOR DCB                    35400020
         USING IEDQCKPD,R2              BASE FOR CKPT WORK AREA         35700020
         USING IEDQCRED,R3              BASE FOR CKPT REQUEST ELEMT     36000020
         USING IEDQDEB,R5               BASE FOR TCAM DEB               36300020
         USING IEDQAVTD,RAVT            BASE FOR AVT                    37500020
         USING IEDQWRKA,R11             BASE FOR ACCESS METHOD WORK     37800020
         SPACE 3                                                        38100020
*ENTRY POINT FOR CKREQ MACRO                                            38400020
         SPACE                                                          38700020
         SAVE  (14,12)                  SAVE USERS REGS          Y01004 39000002
         BALR  R12,R0                   ESTABLISH                Y01004 39100002
         USING *,R12                    ADDRESSABILITY           Y01004 39200002
IEDQNB   IEDHJN AFTERHJN                                       @Y17XAC2 39220000
         SPACE 1                                                 Y01004 39300002
         L     R10,CVTPTR               ADDRESS OF CVT         @ZM46809 39303010
         L     R10,ZERO(R10)            ADDRESS OF OLD-NEW PTRS@ZM46809 39306010
         L     R10,CURRENT(R10)         ADDRESS OF CURRENT TCB @ZM46809 39309010
         L     R5,TCBDEB-IEDQTCB(R10)   ADDRESS OF DEB CHAIN   @ZM46809 39312010
         LA    R15,RC4                  SET RETURN CODE        @ZM46809 39315010
*BEGINNING OF LOOP THROUGH DEB CHAIN                           @ZM46809 39318010
         SPACE                                                          39321010
QNB15    EQU   *                                               @ZM46809 39324010
         LA    R5,0(,R5)                CLEAR HIGH ORDER BYTE  @ZM46809 39327010
         LTR   R5,R5                    CHECK FOR END OF CHAIN @ZM46809 39330010
         BZ    QNB25                    BRANCH IF END          @ZM46809 39333010
         SPACE                                                          39336010
         CLI   DEBTAMID,X'C0'           CHECK DEB TYPE         @ZM46809 39339010
         BE    QNB20                    BR IF TCAM INPUT DEB   @ZM46809 39342010
         L     R5,4(0,R5)               GET NEXT DEB IN CHAIN  @ZM46809 39345010
         B     QNB15                    LOOP                   @ZM46809 39348010
         SPACE                                                          39351010
*END OF LOOP THROUGH DEB CHAIN                                 @ZM46809 39354010
         SPACE 3                                                        39357010
QNB20    EQU   *                                               @ZM46809 39360010
         L     RPEWA,DEBPEWA-ONE        ADDRESS OF PEWA        @ZM46809 39363010
         XC    CKECB(4),CKECB           CLEAR ECB              @ZM46809 39366010
         LA    R1,CKPARM                PARAMETER LIST ADDRESS @ZM46809 39369010
         AQCTL                                                 @ZM46809 39372010
QNB25    EQU   *                                               @ZM46809 39375010
         RETURN (14,12),T,RC=(15)       RETURN TO USER         @ZM46809 39378010
         EJECT                                                          39381010
*ENTRY POINT FROM TCHNG MACRO                                           41400020
         SPACE                                                          41700020
         ENTRY IEDQNB02                                                 42000020
IEDQNB02 EQU   *                                                        42300020
         SPACE                                                          42600020
         USING *,R15                                                    42900020
         BAL   R0,QNB60                 BEGIN REQUEST ELEMENT           43200010
*                                       PROCESSING             @ZM46809 43250010
         MVI   CREKEY,CRECHNGT          KEY FOR TCHNG                   43500020
         STH   R1,CREOFFS               OFFSET FOR TERMNAME IN MACR     43800020
         SPACE 3                                                        44400020
*COMMON CODE FOR CKREQ,TCHNG                                            44700020
         SPACE                                                          45000020
QNB30    EQU   *                                                        45300020
         LA    R7,AVTCKPTB              ADDRESS OF CKPT QCB             45600020
         ST    R7,CREECB                                                45900020
         MVC   CREQCBAD(3),CREECB+1     MOVE QCB ADDR TO ELEMENT        46200020
         MVI   CRELINK,PRIAPCKP         SET PRIORITY                    46500020
         LA    R1,CHKECB1               ADDRESS OF ECB         @ZM46809 46550010
         ST    R1,CREECB                PUT INTO REQ ELEMENT            47100020
         SPACE 3                                                        47700020
*QPOST REQUEST ELEMENT TO READY QUEUE VIA SVC. POST MCP TCB             48000020
         SPACE                                                          48300020
         STM   R3,R4,CHKLIST            ADDRESS OF PARMLIST    @ZM46809 48350010
         MVI   CHKLIST,X'0C'            KEY TO INDIC FUNCTION  @ZM46809 48400010
         LA    R1,CHKLIST               ADDRESS OF PARMLIST             48450010
         AQCTL                          QPOST SVC                       49800020
         SPACE                                                          50100020
         WAIT  ECB=CHKECB1              WAIT FOR CKPT          @ZM46809 50150010
         SR    R0,R0                    SET NORMAL RETURN CODE     1019 50500020
         SPACE                                                          50700020
QNB35    EQU   *                                                   0616 51000020
         LR    R15,R0                   PICK UP RETURN CODE        1019 51100020
         RETURN (14,12),T,RC=(15)       RETURN TO APP PROG         1019 51300020
         SPACE 3                                                        51600020
*ENTRY POINT FOR OPEN OR CLOSE FROM APPLICATION PROGRAM                 51900020
         SPACE                                                          52200020
         ENTRY IEDQNB05                                                 52500020
IEDQNB05 EQU   *                                                        52800020
         USING *,R15                                                    53100020
         BAL   R0,QNB60                 GET PCB ADDRESS                 53400020
         L     R5,DCBDEBAD              ADDRESS OF DEB                  53700020
         LH    R1,DEBTAMOS              TERMNAME OFFSET                 54000020
         N     R1,AVTCLRHI              CLEAR HIGH ORDER HALF WORD      54300020
         L     R15,AVTRNMPT             ADDRESS OF TERMNAME TABLE       54600020
         BALR  R14,R15                  GET TERMINAL OFFSET             54900020
         SPACE                                                          55200020
         L     R15,16(0,R13)            RESTORE FROM SAVE AREA          55500020
         USING IEDQTRM,R1               BASE FOR TERM ENTRY             55800020
         TM    TRMSTATE,TRMHELDN        CHECK FOR SYNC=YES              56100020
         BZ    QNB90                    BRANCH IF SYNC=NO               56400020
         SR    R14,R14                  CLEAR                           56700020
         IC    R14,CKPCKRQS             VALUE OF CKREQS ON INTRO   0616 57000020
         LTR   R14,R14                  CHECK FOR NO CKREQ              57300020
         BZ    QNB90                                                    57600020
         LA    R14,CKPCKRNO(0,R14)      NUMBER OF CKREQ DISK RECRDS     57900020
         L     R12,CKPCTTRB             GET CKREQ-TTR TABLE             58200020
         SPACE 3                                                        58500020
*BEGINNING OF LOOP THROUGH CKREQ-TTR TABLE-LOOKING FOR PROCESS          58800020
*ENTRY BEING OPENED OR CLOSED.                                          59100020
         SPACE                                                          59400020
QNB40    EQU   *                                                        59700020
         TM    CKPCTFLG(R12),CKPCTDER   CHECK FOR DISK ERROR            60000020
         BO    QNB42                    BRANCH IF DISK ERROR            60300020
         CLC   CKPCTTTR(2,R12),DEBTAMOS COMPARE OFFSETS                 60600020
         BE    QNB89                    BRANCH IF EQUAL                 60900020
         SPACE                                                          61200020
QNB42    EQU   *                                                        61500020
         LA    R12,CKPCTTRL(0,R12)       MOVE TO NEXT ENTRY             61800020
         BCT   R14,QNB40                SUBRRACT FROM ENTRY COUNT       62100020
         SPACE                                                          62400020
*END OF LOOP THROUGH CKREQ-TTR TABLE                                    62700020
         SPACE 3                                                        63000020
         B     QNB90                                                    63300020
         SPACE 3                                                        63600020
*SUBROUTINE USED TO LOCATE CURRENT TCB,AVT,DEB CHAIN, PCB, ACCESS       63900020
*WORK AREA,AND CKPT WORK AREA.  R14 IS BRANCH REG.                      64200020
         SPACE                                                          64500020
QNB60    EQU   *                                                        64800020
         STM   R14,R12,12(R13)          SAVE REGS                       65100020
         DROP  R15                                                      65400020
         BALR  R12,0                                                    65700020
         USING *,R12                    SET UP BASE                     66000020
         SPACE                                                          66300020
         LR    R14,R0                   MOVE BRANCH REG                 66600020
         L     R8,16                    ADDRESS OF CVT                  66900020
         L     R10,0(0,R8)                                              67200020
         L     R10,4(0,R10)             ADDRESS OF CURRENT TCB          67500020
         L     RAVT,AVTCVTPT(0,R8)      ADDRESS OF TCAM DISPATCHER      67800020
         L     RAVT,0(0,RAVT)           ADDRESS OF AVT                  68100020
         L     R5,8(0,R10)              ADDRESS OF DEB CHAIN            68400020
         LA    R0,QNBNOCKR              SET RETURN CODE FOR NO CKPT101  68770020
         TM    AVTCKFLG,AVTCKTAC        TCAM CHCKPT ACTIVE     @Y17XAC2 68840000
         BZ    QNB90                    BRANCH IF NOT ACTIVE       1020 68910020
         L     R2,AVTCKAVT-1            GET CKPT AVT ADDRESS   @Y17XAC2 68915000
         L     R2,CAVTTCWA-IEDQCKAD(,R2)  GET TCAM CHECKPOINT  @Y17XAC2 68920000
*                                       WORK AREA ADDRESS      @Y17XAC2 68925000
         SPACE 3                                                        69000020
*BEGINNING OF LOOP THROUGH DEB CHAIN                                    69300020
         SPACE                                                          69600020
QNB65    EQU   *                                                        69900020
         LA    R5,0(,R5)                CLEAR HIGH ORDER BYTE           70200020
         LTR   R5,R5                    CHECK FOR END OF CHAIN          70500020
         BZ    QNB90                    BRANCH IF END                   70800020
         SPACE                                                          71100020
         CLI   DEBTAMID,X'C0'           CHECK DEB TYPE             1014 71400020
         BE    QNB70                    BRANCH IF TCAM INPUT DEB   1014 71700020
         L     R5,4(0,R5)               GET NEXT DEB IN CHAIN           72000020
         B     QNB65                    LOOP                            72300020
         SPACE                                                          72600020
*END OF LOOP THROUGH DEB CHAIN                                          72900020
         SPACE 3                                                        73200020
QNB70    EQU   *                                                        73500020
         L     R4,DEBPEWA-ONE           PEWA ADDRESS           @ZM46809 73550010
         L     R4,PEWAWA-IEDQPEWA(,R4)  AIB WORKAREA ADDRESS   @ZM46809 73600010
         LA    R4,220(R4)               SPECIAL WORK AREA      @ZM46809 73650010
         LA    R3,CHKPARM1              ADDR OF REQUEST ELEMENT@ZM46809 73700010
         LA    R0,QNBMOVEL              ADDR OF LENGTH OF LIST          74700020
         ST    R0,CHKLEN                PUT IN PARM LIST       @ZM46809 74750010
         XC    CHKPARM1(20),CHKPARM1    CLEAR ECB AND REQ ELEM @ZM46809 74800010
         BR    R14                      RETURN                          75600020
         SPACE                                                          75900020
*END OF SUBROUTINE                                                      76200020
         SPACE 3                                                        76500020
*RETURN TO OPEN OR CLOSE EXECUTOR                                       76800020
         SPACE                                                          77100020
QNB89    EQU   *                                                        77400020
         DROP  R12                                                      77700020
         USING IEDQNB05,R15                                             78000020
         LA    R0,QNBLEN                ADDRESS OF LN AND ZERO BYTE     78300020
         ST    R0,CHKLIST               ADDR OF ZERO BYTE      @ZM46809 78350010
         ST    R0,CHKLEN                ADDR OF HALF WORD LEN  @ZM46809 78400010
         ST    R12,CHKTARG              ADDR OF TARGET         @ZM46809 78450010
         MVI   CHKLIST,X'08'            FLAG                   @ZM46809 78500010
         LA    R1,CHKLIST               ADDR OF PARM           @ZM46809 78550010
         AQCTL                          MOVE ZERO TO FLAG BYTE IN      X80100020
                                        CKREQ-TTR ENTRY-MARK INACTV     80400020
         SR    R0,R0                    SET NORMAL RETURN CODE     1019 80500020
         SPACE                                                          80700020
QNB90    EQU   *                                                        81000020
         LR    R15,R0                   PICK UP RETURN CODE        1019 81100020
         RETURN (14,12),T,RC=(15)       RETURN CODE FOR APP PROG   1019 81300020
         SPACE 3                                                        81600020
         EJECT                                                          81610010
*              CONSTANTS                                       @ZM46809 81620010
         DS    0F                       PARAMETER LIST         @ZM46809 81630010
CKPARM   DC    X'9C'                    CKREQ CODE FOR SVC 102 @ZM46809 81640010
         DC    AL3(CKECB)               ECB ADDRESS            @ZM46809 81650010
CKECB    DC    F'0'                     ECB FOR SVC 102        @ZM46809 81660010
         SPACE 2                                                        81670010
CHKPARM1 DS    0F                       PARAMETER LIST         @ZM46809 81680010
         DS    4F                       SPECIAL AQCTL ELEM     @ZM46809 81690010
CHKECB1  DS    F                        ECB                    @ZM46809 81700010
CHKLIST  DS    0F                       AQCTL PARAMETER LIST   @ZM46809 81710010
CHKFROM  DS    F                        FROM ADDRESS           @ZM46809 81720010
CHKTARG  DS    F                        TARGET OF DATA         @ZM46809 81730010
CHKLEN   DS    F                        ADDRESS OF LENGTH      @ZM46809 81740010
         SPACE 2                                                        81750010
*              EQUATES                                         @ZM46809 81760010
ZERO     EQU   0                        DISPLACEMENT           @ZM46809 81770010
ONE      EQU   1                        DISPLACEMENT           @ZM46809 81780010
CURRENT  EQU   4                        NEW TCB                @ZM46809 81790010
RC4      EQU   4                        NO DCBS OPEN RET CODE  @ZM46809 81800010
CVTPTR   EQU   16                       PTR TO CVT             @ZM46809 81810010
QNBLEN   DC    H'1'                     LENGTH FOR MOVE                 81900020
QNBMOVEL DC    H'16'                    LENGTH TO BE MOVED BY SVC       82200020
         SPACE 3                                                        83100020
         TAVTD                                                          83700020
         TCAVTD                                                @Y17XAC2 83750000
         TCKPD 3330                     MERLIN VERSION             0421 84000000
         TPCBD                                                          84300020
         TDEBAPD                                                        84600020
         TACSMD                                                         84900020
         DCBD  DSORG=TX                                                 85200020
         TTRMD                                                          85500020
         TPEWAD                                                         86100020
         TPRIOR                                                         86400020
         EJECT                                                          86450010
         TTCBD                                                 @ZM46809 86500010
         END                                                            86700020
./  ADD  SSI=81450258,NAME=IEDQND
          TITLE 'IEDQND-READY ROUTINE'                                  00200020
IEDQND   CSECT                                                          00400020
*A-000000-999999                                               @X31X8N0 00400208
         SPACE 3                                                 S21903 00400505
*CHANGE ACTIVITY= AS FOLLOWS:                                           00410022
******************** MICROFICHE FLAGS *********************** SUPT CODE 00417005
*C676000-678000                                                  S22026 00425022
*A849000                                                         S22026 00425122
*A444000                                                         A42401 00425222
*C138000                                                         A42401 00425322
*C134000,166000,224000,576000,836000,839200                      S22025 00425422
*C074000                                                        SA53627 00425522
*C012000                                                         S21903 00425622
*D114000,212000                                                  S21903 00425722
*C712000,842000                                                 SA59006 00425822
*A618290,844500                                                 SA58457 00425922
*C004250-005950,016000                                          SA58457 00426022
*A674200-675800                                                  S22024 00426122
*C094000-126000,618140-618160,618260,851000                      S22024 00426222
*    CLEAN-UP                                                    S21903 00426305
*A692000,842000                                                 SA63007 00426405
*C 618390                                                       SA63993 00426551
*C128700,618140,618160,618260                                    S05331 00506552
*A250000,276000,298000,528000                                  @SA67132 00536561
*C302000,534000,541000                                         @SA67132 00566561
*A240500                                                       @OS76514 00566691
*A250600,556600                                                @ZA06155 00576509
*C676500                                                       @OY12667 00576691
*A680000                                                       @OY14058 00576791
*D240450-240500                                                @OS77945 00576891
*    TCAM LEVEL 10.0 MVS CHANGES                               @G36XRNP 00579800
*A035100,051200,055300,128630,129890,208000,242000,670000      @G36XRNP 00582800
*A812000,839200,816200                                         @G36XRNP 00585800
*C016000,020000,022000,618140,666000                           @G36XRNP 00588800
*A128840,508000,828000                                         @OZ26495 00588982
*C445200                                                       @OZ26495 00589082
*D055200-055300,214000,670200-670800,857000                    @G36XRNP 00591800
*                                                              @G36XRNP 00594800
*D246000-250000,534000,556920                                  @OY19771 00594982
*A251801-251803,534000,556961                                  @OY19771 00595082
*A444000,508120                                                @OY20722 00595182
         SPACE 3                                                        00600020
*********************************************************************** 00800020
*                                                                     * 01000020
*MODULE-NAME= IEDQND  (TCAM,INITIALIZATION)                    @G36XRNP 01200000
*                                                                S21903 01240022
*DESCRIPTIVE-NAME= READY ROUTINE                                 S21903 01280022
*                                                                S21903 01320022
*COPYRIGHT= 'NONE'                                               S21903 01360022
*                                                                     * 01400020
*STATUS: CHANGE LEVEL 10.0                                     @G36XRNP 01600000
*                                                                     * 01800020
*FUNCTION:THIS MODULE CHECKS FOR CHECKPOINT OR ON-LINE-TEST OPTIONS   * 02000020
*   SPECIFIED AND PERFORMS ASSOCIATED FUNCTIONS.  IF EITHER    @G36XRNP 02200000
*   THE TCAM CHECKPOINT DCB OR A 3705 CHECKPOINT               @G36XRNP 02300000
*   DCB HAS BEEN OPENED, THIS MODULE ATTACHES THE CHECKPOINT          * 02400020
*   EXECUTOR AND SETS UP REGISTERS IN AVTSAVE2 SO THAT THE TCAM       * 02600020
*   DISPATCHER WILL PUT THE ENVIRONMENT CHECKPOINT REQUEST ELEMENT    * 02800020
*   ON THE READY QUEUE.  IF ON-LINE-TEST HAS BEEN SPECIFIED ON INTRO  * 03000020
*   THIS MODULE CHECKS FOR SUFFICIENT CORE FOR IT TO PERFORM ITS      * 03200020
*   FUNCTIONS.                                                        * 03400020
*                                                                     * 03410022
*        IF A RESTART IS BEING PERFORMED, THE OPERATOR CONTROL        * 03420022
*   INCIDENT RECORDS RECORDED AFTER THE LAST ENVIRONMENT              * 03430022
*   CHECKPOINT ARE SENT TO OPERATOR CONTROL TO BE PROCESSED           * 03440022
*   AGAIN.  START LINE AND STOP LINE COMMANDS ARE IGNORED AT          * 03450022
*   THIS POINT SINCE THOSE FUNCTIONS WERE PERFORMED DURING OPEN       * 03460022
*   PROCESSING.  IF AN I/O ERROR OCCURS WHILE READING THE             * 03470022
*   INCIDENT RECORDS OR IF THERE IS NOT ENOUGH CORE AVAILABLE         * 03480022
*   TO READ THE RECORDS, THE TELEPROCESSING CONSOLE OPERATOR IS       * 03490022
*   NOTIFIED VIA A WRITE-TO-OPERATOR AND THE INCIDENT RECORD IS       * 03500022
*   IGNORED.                                                          * 03510022
*                                                                     * 03600020
*        IEDQND LINKS TO IEDIAB TO PERFORM INITIATION OF NAT,  @G36XRNP 03620000
*   PLCB AND SIB POOLS, SAT, AND THE HOST SUBAREA RVT.  IT     @G36XRNP 03640000
*   ALSO LINKS TO IGCFD10D TO DEACTIVATE THE TERMINAL          @G36XRNP 03660000
*   HIERARCHIES.                                               @G36XRNP 03680000
*                                                              @G36XRNP 03700000
*        270X TERMINAL DESTINATION QCBS SPECIFYING CLOCK/CINTVL@G36XRNP 03720000
*   ARE PLACED ON THE TIME DELAY QUEUE.                        @G36XRNP 03740000
*                                                              @G36XRNP 03760000
*ENTRY POINT:                                                         * 03800020
*                                                                     * 04000020
*        IEDQND                                                       * 04200020
*                                                                     * 04400020
*INPUT:REGISTER 13 HAS THE ADDRESS OF THE AVT.                        * 04600020
*                                                                     * 04800020
*OUTPUT:THE ADDRESS OF THE OPERATOR CONTROL INCIDENT RECORD TO        * 05000022
*   BE PROCESSED IS PLACED IN THE FIELD NAMED OPCCOPCE IN THE         * 05060022
*   OPERATOR CONTROL AVT.                                             * 05120022
*                                                                     * 05200020
*EXTERNAL REFERENCES:                                                 * 05220000
*        ROUTINES -                                            @G36XRNP 05240000
*               IEDQTNT (TTCIN TO TTE CONVERSION ROUTINE)      @G36XRNP 05260000
*               IEDQTL (DEV DEPENDENT FIELDS LOOKUP ROUTINE)   @G36XRNP 05280000
*               IEDQCA(RESIDENT OP CTL ROUTINE)ACTIVATED VIA A @G36XRNP 05300000
*               POST SVC.                                      @G36XRNP 05320000
*               IEDIAB(PLCB,NAT,SAT,RVT INITIATION)            @G36XRNP 05340000
*               IGCFD10D(DEACTIVATE HIERARCHY)                 @G36XRNP 05360000
*        MACROS -                                                     * 05400000
*              (IEDHJN)                                                 05405000
*        SVC 0 (EXCP)                                                 * 05410022
*        SVC 1 (WAIT)                                                 * 05420022
*        SVC 2 (POST)                                                 * 05430022
*        SVC 4 (GETMAIN)                                              * 05440022
*        SVC 5 (FREEMAIN)                                             * 05450022
*        SVC 8 (LOAD)                                                 * 05460022
*        SVC 10 (GETMAIN)                                             * 05470022
*        SVC 10 (FREEMAIN)                                            * 05480022
*        SVC 11 (TIME)                                                * 05490022
*        SVC 35 (WTO)                                                 * 05500022
*        SVC 42 (ATTACH)                                              * 05510022
*        SVC  6 (LINK)                                                  05515000
*                                                                     * 05600020
*MODULE TYPE = PROCEDURE                                       @G36XRNP 05610000
*                                                              @G36XRNP 05620000
*PROCESSOR = ASSEMBLER XF                                      @G36XRNP 05630000
*                                                              @G36XRNP 05640000
*MODULE SIZE = THERE IS NO SIZE RESTRICTIONS.                  @G36XRNP 05650000
*                                                              @G36XRNP 05660000
*PURPOSE = SEE FUNCTION                                        @G36XRNP 05670000
*                                                              @G36XRNP 05680000
*LINKAGE = THIS ROUTINE IS LINKED (SVC 6) TO FROM              @G36XRNP 05690000
*          THE READY MACRO GENERATION IN THE MCP.              @G36XRNP 05700000
*                                                              @G36XRNP 05710000
*EXITS-NORMAL:THIS MODULE RETURNS TO THE ADDRESS IN R14               * 05800020
*                                                                     * 06000020
*EXITS-ERROR:NONE                                                     * 06200020
*                                                                     * 06400020
*TABLES/WORKAREAS:                                                    * 06600020
*        AVT                                                          * 06800022
*        CVT                                                   @Z30X8NJ 06810008
*        DEB                                                   @Z30X8NJ 06820008
*        DCB                                                          * 06840022
*        QCB                                                          * 06880022
*        TSO QCB                                                      * 06920022
*        TERMINAL ENTRY                                        @Z30X8NJ 06960008
*        TERMNAME TABLE                                        @Z30X8NJ 06970008
*        PRIORITY DSECT                                        @Z30X8NJ 06980008
*        TCX                                                   @Z30X8NJ 06990008
*        CHECKPOINT WORKAREA                                          * 07000022
*        CHECKPOINT INCIDENT RECORD DSECT                             * 07040022
*        OPERATOR CONTROL AVT                                         * 07080022
*        OPERATOR CONTROL ELEMENT DSECT                               * 07120022
*                                                                     * 07200020
*ATTRIBUTES: REUSABLE                                           SA53627 07400022
*                                                                     * 07600020
*NOTES = SEE BELOW                                             @G36XRNP 07660000
* DEPENDENCIES =                                               @G36XRNP 07720000
*      THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL REPRE-   * 07800000
*   SENTATION OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT TO    * 08000020
*   THE ONE USED AT ASSEMBLY TIME. THE CODING HAS BEEN ARRANGED SO    * 08200020
*   THAT REDIFINITION OF 'CHARACTER' CONSTANTS,BY REASSEMBLY, WILL    * 08400020
*   RESULT IN A CORRECT MODULE FOR THE NEW DIEFINITIONS.              * 08600020
*                                                                     * 08800020
* RESTRICTIONS = NONE                                          @G36XRNP 08820000
*                                                              @G36XRNP 08840000
* REGISTER CONVENTIONS = SEE REGISTER ASSIGNMENT               @G36XRNP 08860000
*                                                              @G36XRNP 08880000
* PATCH = THE SYMBOLIC NAME IS PATCH.                          @G36XRNP 08900000
*                                                              @G36XRNP 08920000
*********************************************************************** 09000020
         EJECT                                                   S21903 09200005
R0       EQU   0                        REG 0                    S22024 09400022
R1       EQU   1                        REG 1                    S22024 09600022
R2       EQU   2                        REG 2                    S22024 09800022
R3       EQU   3                        REG 3                    S22024 10000022
R4       EQU   4                        REG 4                    S22024 10200022
R5       EQU   5                        REG 5                    S22024 10400022
R6       EQU   6                        REG 6                    S22024 10600022
R7       EQU   7                        REG 7                    S22024 10800022
R8       EQU   8                        REG 8                    S22024 11000022
RTERM    EQU   8                        ADDRESS OF TERM ENTRY    S22024 11200022
R9       EQU   9                        REG 9                    S22024 11400022
R10      EQU   10                       REG 10                   S22024 11600022
R11      EQU   11                       REG 11                   S22024 11800022
R12      EQU   12                       REG 12                   S22024 12000022
R13      EQU   13                       REG 13                   S22024 12200022
R14      EQU   14                       REG 14                   S22024 12400022
R15      EQU   15                       REG 15                   S22024 12600022
         SPACE 3                                                        12800020
HALF     EQU   32                       THIRTY TWO               S22024 12807005
LOWEQ    EQU   X'0A'                    CC OF LOW OR EQUAL      SA59006 12814005
ONE      EQU   1                        ONE                      S22024 12821005
ZERO     EQU   0                        CONSTANT VALUE           S99528 12828005
EIGHT    EQU   8                        REG 8 EQU                       12835005
ECMODE   EQU   X'20'                    EXTENDED CONTROL MODE   SA58457 12842005
TEN      EQU   10                       CONSTANT VALUE           S99528 12849005
TWO      EQU   2                        COUNT OF TWO             S21903 12856005
THREE    EQU   3                        LENGTH VALUE            SA63007 12863005
DREG2    EQU   16                       DISPLACEMENT TO REG 2  @G36XRNP 12866000
QNDOLTST EQU   18                       MIN VALUE FOR OLTEST     S05331 12870052
X10      EQU   X'10'                    HEX 10                   S21903 12877005
X40      EQU   X'40'                    HEX 40                   S21903 12884005
X60      EQU   X'60'                    HEX 60                 @OZ26495 12885082
X20      EQU   X'20'                    HEX 20                 @OZ26495 12886082
SIXTEN   EQU   16                       CONSTANT               @OZ26495 12887082
X41      EQU   X'41'                    HEX 41                   S21903 12891005
X70      EQU   X'70'                    HEX 70                   S21903 12898005
X7F      EQU   X'7F'                    HEX 7F                   S21903 12905005
X80      EQU   X'80'                    HEX 80                   S21903 12912005
XD0      EQU   X'D0'                    HEX D0                   S21903 12919005
XE0      EQU   X'E0'                    HEX E0                   S21903 12926005
XFC      EQU   X'FC'                    HEX FC                   S21903 12933005
XFE      EQU   X'FE'                    HEX FE                   S21903 12940005
XFF      EQU   X'FF'                    HEX FF                   S21903 12947005
L1       EQU   1                        LENGTH OF 1              S21903 12954005
L2       EQU   2                        LENGTH OF 2              S21903 12961005
L3       EQU   3                        LENGTH OF 3              S21903 12968005
L4       EQU   4                        LENGTH OF 4              S21903 12975005
L6       EQU   6                        LENGTH OF 6              S21903 12982005
L8       EQU   8                        LENGTH OF 8              S21903 12989005
CHECKPT  EQU   X'20'                    TCAM CKPT DCB FLAG     @G36XRNP 12992000
ADDRMSK  EQU   7                        ADDRESS MASK           @G36XRNP 12995000
*STANDARD LINKAGE                                                       13000020
         USING *,R15                    BASE REG                        13200020
IEDQND  IEDHJN QND00                                             S22025 13400022
         USING IEDQAVTD,R13             BASE FOR AVT                    14200020
         STM   R14,R12,12(R13)          SAVE REGS                       14400020
         LR    R12,R15                  BASE REG                        14600020
         DROP  R15                                                      14800020
         USING IEDQND,R12                                               15000020
         SPACE 3                                                        15200020
         SPACE 3                                                        20600020
*CHECK TO DETERMINE IF THE CHECKPOINT DCB WAS OPENED                    20800020
         SPACE                                                          21000020
         TM    AVTCKFLG,AVTCKTAC        TCAM CKPT ACTIVE       @G36XRNP 21400000
         BO    QND20                    BRANCH IF OPENED       @G36XRNP 21600000
         MVI   AVTCKECA,X40             POST COMPLETION ECB SINCES21903*22000005
                                        CKPT WILL NEVER TERMINATE       22200020
         B     QND79                    CHECK FOR 3705 CKPT    @G36XRNP 22400000
         SPACE                                                          22407000
QND20    EQU   *                                               @G36XRNP 22414000
*                                                              @G36XRNP 22421000
*        FIND TCAM CHECKPOINT DCB ADDRESS                      @G36XRNP 22428000
*                                                              @G36XRNP 22435000
         L     R1,AVTTCB                GET TCAM TCB ADDRESS   @G36XRNP 22442000
         USING IEDQTCB,R1               SET ADDRESSABILITY     @G36XRNP 22449000
         L     R1,TCBDEB                GET FIRST DEB ADDRESS  @G36XRNP 22456000
         DROP  R1                                              @G36XRNP 22463000
         USING DEBNMSUB,R1              SET ADDRESSABILITY     @G36XRNP 22470000
         USING IHADCB,R2                SET ADDRESSABILITY     @G36XRNP 22477000
QND35    EQU   *                                               @G36XRNP 22484000
         L     R2,DEBDCBAD              GET DCB ADDRESS        @G36XRNP 22491000
         TM    DCBDSRG2,DCBDSGTQ        IS THIS A TCAM QUEUE   @G36XRNP 22498000
*                                       DATA SET               @G36XRNP 22505000
         BZ    QND37                    NO, BRANCH             @G36XRNP 22512000
         TM    DCBOPTCD,CHECKPT         TCAM CKPT DCB          @G36XRNP 22519000
         BO    QND40                    YES                    @G36XRNP 22526000
QND37    EQU   *                                               @G36XRNP 22533000
         L     R1,DEBDEBAD              GET NEXT DEB ADDRESS   @G36XRNP 22540000
         B     QND35                    CONTINUE SEARCH FOR    @G36XRNP 22547000
*                                       TCAM CKPT DCB          @G36XRNP 22554000
QND40    EQU   *                                               @G36XRNP 22561000
         L     R2,DCBIOBAD              GET CKPT WORK AREA     @G36XRNP 22568000
*                                       ADDRESS                @G36XRNP 22575000
         DROP  R1                                              @G36XRNP 22582000
         DROP  R2                                              @G36XRNP 22589000
         SPACE 3                                                        22600020
*THE LATEST TOTAL ENVIRONMENT RECORD HAS BEEN USED TO UPDATE THE        22800020
*TAM TABLES. USE THE INCIDENT RECORDS TAKEN AFTER THE TOTAL TO          23000020
*UPDATE THE TABLES FURTHER.                                             23200020
         SPACE                                                          23400020
QND56    EQU   *                                                   0803 23600020
         USING IEDQCKPD,R2              BASE FOR CKPT WORK AREA         23800020
         USING IEDQCDRD,R11             BASE FOR DISK RECORD            24000020
         MVI   CKPSWCH2,0               INITIALIZE INVITATN LST SW 0911 24005020
         SPACE 3                                                        24010020
*PUT ENVIRONMENT REQUEST ELEMENT IN DISPATCHERS REG 1 SO IT WILL BE1002 24015020
*PUT ON READY QUEUE WHEN DISPATCHER GETS CONTROL                        24020020
         SPACE                                                          24025020
         LA    R15,AVTCKELE             ADDRESS OF CKPT ELEMENT         24030020
         ST    R15,AVTSAVE2+24          STORE INTO REG1 POSITION       X24035020
                                        FOR DISPATCHER                  24040020
         OI    AVTCKELF,AVTCRTLN        TURN ON CHECKPOINT     @OS76514 24051091
*                                        REQUEST BIT           @OS76514 24052091
         MVI   AVTCKELE,X70             SET KEY FIELD            S21903 24055005
         MVI   AVTCKELE+4,PRICKPT       PRIORITY OF CHECKPOINT ELEM     24060020
         SPACE 3                                                        24065020
*CHECK FOR SYSTEM DELAY SPECIFIED AND LOAD IEDQHI IF NECESSARY          24070020
*IF SYSTEM DELAY  WAS IN EFFECT AT TIME OF LAST CHECKPOINT,TURN OFF1002 24075020
*THE BIT AND PUT A REQUEST ELEMENT ON THE READY QUEUE  FOR THE          24080020
*SYSTEM DELAY ROUTINE.                                                  24085020
         SPACE                                                          24090020
         LH    R1,AVTINTLV              GET SYSTEM INTERVAL        0826 24095020
         LTR   R1,R1                    CHECK FOR ZERO             0826 24100020
         BZ    QND57                    BRANCH IF STILL ZERO       0115 24105020
         L     R1,AVTHI                 ADDR OF SYSTEM DELAY RTN   0826 24110020
         LTR   R1,R1                    CHECK FOR RTN LOADED       0826 24115020
         BNZ   QND57                    BRANCH ID ALREADY LOADED   0115 24120020
         LOAD  EP=IEDQHI                LOAD SYSTEM DELAY RTN      0826 24125020
         ST    R0,AVTHI                 SAVE ADDR OF RTN           0826 24130020
         SPACE 3                                                        24180020
*SEE  IF IT IS NECESSARY TO READ INCIDENT RECORDS FOR OPERATOR CONTL    24185020
         SPACE                                                          24190020
QND57    EQU   *                                                   1002 24195020
         TM    AVTBIT2,AVTSTRTN         CHECK FOR RESTART          0804 24200020
         BZ    QND79                    BRANCH IF NOT RESTARTING   0804 24400020
         L     R15,AVTTCB               GET TCAM TCB ADDRESS   @G36XRNP 24403000
         LA    R15,FOUR(R15)            POINT TO FIRST DEB-4   @G36XRNP 24406000
FOUR     EQU   4                        CONSTANT OF FOUR       @G36XRNP 24409000
         USING DEBNMSUB,R15                                    @G36XRNP 24412000
DEBLOOP  EQU   *                                               @G36XRNP 24415000
         L     R15,DEBDEBAD             GET NEXT DEB ADDRESS   @G36XRNP 24418000
         LA    R15,AVTEZERO(R15)        CLEAR HIGH ORDER BYTE  @G36XRNP 24421000
         LTR   R15,R15                  CHECK FOR END OF CHAIN @G36XRNP 24424000
         BZ    QND5750                  YES, EXIT              @G36XRNP 24427000
         L     R14,DEBDCBAD             GET DCB ADDRESS        @G36XRNP 24430000
         USING IHADCB,R14                                      @G36XRNP 24433000
         TM    DCBDSRG2,DCBDSGTR        IS THIS A 3705 DCB     @G36XRNP 24436000
         BZ    DEBLOOP                  NO, RELOOP             @G36XRNP 24439000
         LR    R1,R14                   GET 3705 DCB ADDRESS   @G36XRNP 24442000
         BAL   R7,QND90                 GET 3705 NCP TTE ADDR  @G36XRNP 24445000
*        REG 1 HAS 3705 NCP TTE ADDRESS                        @G36XRNP 24448000
         LA    R0,TRMNCPI               SET MASK TO GET ADDR   @G36XRNP 24451000
*                                       OF NCP DEVICE DEP FLD  @G36XRNP 24454000
         BAL   R7,QND95                 GET 3705 NCP DEVICE    @G36XRNP 24457000
*                                       DEP FIELDS ADDRESS     @G36XRNP 24460000
         LR    R11,R1                   SAVE NCP DEVICE DEP    @G36XRNP 24463000
*                                       FIELDS ADDRESS         @G36XRNP 24466000
         USING IEDNCP,R1                SET ADDRESSABILITY     @G36XRNP 24469000
         ICM   R1,ADDRMSK,NCPCKPT+1     GET 3705 CKPT DCB ADDR @G36XRNP 24472000
         BZ    DEBLOOP                  NO CKP DCB, BRANCH     @G36XRNP 24475000
         TM    DCBOFLGS-IHADCB(R1),DCBOFOPN DCB OPENED         @G36XRNP 24478000
         BZ    DEBLOOP                  NO, RETURN             @G36XRNP 24481000
         ICM   R8,7,DCBIOBAD+1-IHADCB(R1) GET CKP WORKAREA ADR @G36XRNP 24484000
         BZ    DEBLOOP                  NOT OPEN, RETURN       @G36XRNP 24487000
         CLI   CKPBCKUP-IEDQCKPD(R8),AVTEZERO WAS BACKUP       @G36XRNP 24490000
*                                       CHANGED                @G36XRNP 24493000
         BE    DEBLOOP                  NO, RETURN             @G36XRNP 24496000
         STM   R2,R15,CKPSAVE2          SAVE REGISTERS         @G36XRNP 24499000
         LR    R7,R2                    SAVE CKP WORKAREA BASE @G36XRNP 24502000
         LR    R4,R13                   AVT ADDR FOR DCB LOOKUP@G36XRNP 24505000
         LA    R3,AVTSAVE3+12           DUMMY OPCE ADDRESS     @G36XRNP 24508000
         L     R2,AVTOCGET              OP CTL AVT ADDRESS     @G36XRNP 24511000
         MVC   OPCDOUBL-IEDQOPCD(L8,R2),CKPBCKUP-IEDQCKPD(R8)  @G36XRNP 24514000
*                                       SET DDNAME FOR LOOKUP  @G36XRNP 24517000
         LA    R13,AVTSAVE4+12          SAVE AREA FOR LOOKUP   @G36XRNP 24520000
         L     R15,OPCTOFLK-IEDQOPCD(R2) GET DCB LOOKUP ADDR   @G36XRNP 24523000
         BALR  R14,R15                  LINK TO GET DCB ADDR   @G36XRNP 24526000
         B     PROCESS                  GOOD RETURN            @G36XRNP 24529000
         SR    R1,R1                    BAD RETURN             @G36XRNP 24532000
PROCESS  EQU   *                                               @G36XRNP 24535000
         LR    R2,R7                    RESTORE WORK AREA BASE @G36XRNP 24538000
         LM    R2,R15,CKPSAVE2          RESTORE REGISTERS      @G36XRNP 24541000
         LTR   R1,R1                    WAS DCB OPEN           @G36XRNP 24544000
         BZ    DEBLOOP                  NO, RETURN             @G36XRNP 24547000
         L     R1,TRMDESTQ-1-IEDQTRM(R1) GET QCB ADDRESS       @G36XRNP 24550000
         L     R1,QCBDCBAD-1-IEDQQCB(R1) GET DCB ADDRESS       @G36XRNP 24553000
         TM    DCBOFLGS-IHADCB(R1),DCBOFOPN IS DCB OPEN        @G36XRNP 24556000
         BZ    DEBLOOP                  NO, GET NEXT DEB       @G36XRNP 24559000
         LR    R1,R11                   RESTORE 3705 NCP DEV   @G36XRNP 24562000
*                                       DEP FIELDS ADDRESS     @G36XRNP 24565000
         MVC   NCPBKUPN(L8),CKPBCKUP-IEDQCKPD(R8) SET BACKUP   @G36XRNP 24568000
*                                       DDNAME                 @G36XRNP 24571000
         DROP  R1                                              @G36XRNP 24574000
         B     DEBLOOP                  AND RETURN             @G36XRNP 24577000
         DROP  R14                                             @G36XRNP 24580000
         DROP  R15                                             @G36XRNP 24583000
QND5750  EQU   *                                               @G36XRNP 24586000
         LA    R14,CKPINRNO             RECORDS ON FIRST TRACK @SA67132 25020061
         SR    R1,R1                    CLEAR FOR IC           @SA67132 25040061
         IC    R1,CKPINCNT              COUNT OF INCIDENTS     @SA67132 25060061
         BCTR  R1,R0                    DECREMENT INCIDENT     @ZA06155 25066009
*                                        COUNT BY ONE          @ZA06155 25072009
         L     R15,CKPTTRIN-1           FIRST RECORD ADDRESS   @SA67132 25080061
FINDLAST EQU   *                                               @SA67132 25100061
         BAL   R7,GETNEXT               GET NEXT RECORD ADDR   @SA67132 25120061
         LR    R15,R0                   SAVE RECORD ADDRESS    @SA67132 25140061
         BCT   R1,FINDLAST              RELOOP                 @SA67132 25160061
         ST    R0,AVTPARM               SAVE LAST RECORD ADDR+1@SA67132 25180061
         TM    CKPFLAGS,CKPOPCRD        CHECK FOR OP CONTROL   @OY19771 25180182
*                                       INCIDENT REC TO PROCESS@OY19771 25180282
         BZ    QND78                    BRANCH IF NO OPC       @OY19771 25180382
         NI    CKPFLAGS,X'FF'-CKPOPCRD  TURN OFF OPC BIT           0804 25200020
         MVC   CKPTRKLN,CKPSECLI        GET TRK DATA LENGTH 0416 S21101 25400000
         L     R0,CKPTTRLI-1            GET  TTR OF LAST INCIDENT  0814 25600020
         LA    R14,CKPIPERT             NO. OF INC RCDS ON FULL TRA0814 25800020
         CLC   CKPTTRIN(2),CKPTTRLI     CHECK FOR RCD ON 1ST TRACK 0814 26000020
         BNE   QND7605                  BRANCH IF NOT ON 1ST TRACK 0929 26200020
         LA    R14,CKPINRNO             NO. OF INC RCDS ON 1ST TRK 0814 26400020
         B     QND7605                  GET NEXT RCD               0925 26600020
         SPACE 3                                                        26800020
*CONVERT RELATIVE TTR TO ABSOLUTE DISK ADDRESS AND READ THE RECORD      27000020
*INCIDENT RECORD.                                                       27200020
         SPACE                                                          27400020
QND58    EQU   *                                                   0805 27600020
         C     R0,AVTPARM               CHECK FOR LAST RECORD  @SA67132 27650061
         BNL   LASTREC                  LAST RECORD ALREAD RD @SA67132  27700061
*                                        RESET TO FIRST RECORD @SA67132 27750061
         STM   R0,R14,CKPSAVE2          SAVE REGS                       27800020
         L     R15,16                   GET CVT                         28000020
         L     R15,28(0,R15)            GET CONVERSION ROUTINE          28200020
         LR    R3,R2                    SAVE WORK AREA BASE             28400020
         LM    R1,R2,CKPCPARM           GET DEB AND CONVERSN RESULT     28600020
         SLL   R0,8                     POSITION TTR                    28800020
         BALR  R14,R15                  BRANCH TO CONVERT ROUTINE       29000020
         LR    R2,R3                    RESTORE BASE               0716 29200020
         LM    R0,R14,CKPSAVE2          RESTORE REGS               0716 29400020
         LTR   R15,R15                  CHECK FOR END OF DATA SET       29600020
         BZ    QND59                    BRANCH IF NOT END OF DATAST0814 29800020
LASTREC  EQU   *                                               @SA67132 29830061
         NC    CKPTTRLI,CKPTTRLI        CHECK FOR LAST INC RCD-WRAP0925 29860020
         BZ    QND7603                  BRANCH IF WRAP REACHED   S99240 29920022
QND5805  EQU   *                                                   0814 30000020
         L     R15,CKPTTRIN-1           GET FIRST REC ADDR     @SA67132 30200061
         LA    R0,0(R15)                CLEAR HI ORDER BYTE    @SA67132 30300061
         LA    R14,CKPINRNO             NO. OF INC RCDS ON 1ST TRK 0814 30400020
         MVC   CKPTRKLN,CKPSECIN        TRK LN-1ST INC RCD  0416 S21101 30500000
         B     QND58                    READ RCD                   0814 30600020
         SPACE                                                          30800020
QND59    EQU   *                                                   0814 31000020
         CLI   CKPSETSC,CKPNOOP         CHECK FOR RPS FEATURE416 S21101 31010000
         BE    QND595                   BRANCH IF NOT PRESENT416 S21101 31020000
         LH    R0,CKPTRKLN              GET TRK DATA LENGTH 0416 S21101 31030000
         O     R0,QNDFLAG-2             SET FLAG FOR CNVRT  0507 S21101 31040000
         SLL   R0,CKP2BYTE              LOW ORDER HALF WORD 0416 S21101 31050000
         IC    R0,CKPIOR                GET RECORD NUMBER   0416 S21101 31060000
         L     R13,CKPCVTPT             GET CVT ADDRESS     0416 S21101 31070000
         L     R15,CKPCNSEC(,R13)       SECTOR CNVRT RTN AD 0416 S21101 31080000
         LR    R13,R2                   SAVE CKPT BASE      0416 S21101 31090000
         L     R2,CKPPARM2              UCB INDEX AND ADDR 0416 S21101  31100000
         BALR  R14,R15                  GET SECTOR ID       0416 S21101 31110000
         LR    R2,R13                   RESTORE CKPT BASE   0416 S21101 31120000
QND595   EQU   *                                            0416 S21101 31130000
         EXCP  CKPIOB                   START READ OPERATION            31200020
         SPACE                                                          31400020
         WAIT  ECB=CKPECB               WAIT FOR COMPLETION             31600020
         SPACE                                                          31800020
         LM    R0,R14,CKPSAVE2          RESTORE REGS                    32000020
         L     R11,CKPEXCP              GET ADDRESS OF RECORD           32200020
         TM    CKPECB,X7F               CHECK FOR DISK ERROR     S21903 32400005
         BO    QND60                    BRANCH IF NO ERROR         0804 32600020
         SPACE 3                                                        32800020
*DISK ERROR                                                             33000020
         SPACE                                                          33200020
         LR    R3,R0                    SAVE TTR                        33400020
         WTO   'IED085I CHECKPOINT DISK ERROR-INCIDENT RECORD IGNORED',X33600006
               ROUTCDE=11,DESC=4                                   0807 33800020
         LR    R0,R3                    RESTORE TTR                     34000020
         L     R3,AVTOCGET              GET OP CTL AVT ADDRESS   S99240 34200022
QND596   XC    CDRTTRLI,CDRTTRLI        ZERO LINK FIELD          S99240 34240022
         OI    CDRTTRLI+2,2             SET AS LAST SEGMENT      S99240 34280022
         B     QND66                    GO FREE PREVIOUS         S99240 34320022
*                                        CONTINUATION SEGMENTS   S99240 34360022
         SPACE 3                                                        34400020
*DETERMINE TYPE OF INCIDENT RECORD AND PROCESS                          34600020
         SPACE                                                          34800020
QND60    EQU   *                                                   0804 35000020
         USING IEDQCDRD,R11                                             35200020
         CLC   CDRDATE(8),CKPDATIM      COMPARE TIME OF INC., TOTAL     35400020
         BNH   QND77                    BRANCH IF INCIDENT NOT MORE0118X35700020
                                        RECENT THAN TOTAL               36000020
         TM    AVTBIT3,AVTSTAYN         CHECK FOR SCAN SPECIFIED   0118 36060020
         BO    QND76                    BRANCH IF SCAN NOT SPECIFIE0118 36120020
         CLI   CDRKEY,CDROPC            CHECK FOR OPERATOR CONTROL      36200020
         BNE   QND70                    BRANCH IF NOT OPERATOR CNTL0814 36400020
         SPACE 3                                                        36600020
*INCIDENT RECORD WAS A RESULT OF AN OPERATOR CONTROL COMMAND. SET       36800020
*UP THE INFO IN OP.CONTROL WORKAREA AND WAIT SO OP.CONTROL CAN          37000020
*REPROCESS THE COMMAND,UPDATING THE PROPER TABLES.  IF THE COMMAND      37200020
*IS START LINE OR STOP LINE THE PROCESSING HAS ALREADY BEEN DONE.       37400020
         SPACE                                                          37600020
         USING IEDQOPCD,R3              BASE FOR OP CTL AVT      S99240 37800022
         L     R3,AVTOCGET              ADDR OF OP CTL AVT       S99240 37830022
         SPACE 3                                                        37860022
*   ALL STOP OR START LINE OPERATOR CONTROL INCIDENT RECORDS WERE     * 37890022
*   PROCESSED DURING OPEN.  THE FOLLOWING CODE CHECKS FOR THESE       * 37920022
*   COMMANDS AND DOES NOT PASS THEM TO OPERATOR CONTROL, BUT          * 37950022
*   RETURNS TO READ THE NEXT INCIDENT RECORD.                         * 37980022
         SPACE 3                                                        38010022
         CLI   CDROPCB+CKPOCODE,OCSTOPL STOP LINE COMMAND        S99240 38040022
         BE    QND76                    YES, BRANCH              S99240 38070022
         CLI   CDROPCB+CKPOCODE,OCSTARTL START LINE COMMAND      S99240 38100022
         BE    QND76                    YES, BRANCH              S99240 38130022
         CLI   CDROPCB+CKPOCODE,OCVARY  VARY COMMAND             S99240 38160022
         BNE   QND6305                  NO, BRANCH               S99240 38190022
         CLI   CDROPCB+CKPOCSWC,OCX11   VARY OFFTP COMMAND       S99240 38220022
         BE    QND76                    YES, BRANCH              S99240 38250022
         CLI   CDROPCB+CKPOCSWC,OCX12   VARY OFFTP HALT COMMAND  S99240 38280022
         BE    QND76                    YES, BRANCH              S99240 38310022
         CLI   CDROPCB+CKPOCSWC,OCX18   VARY ONTP COMMAND        S99240 38340022
         BE    QND76                    YES, BRANCH              S99240 38370022
         SPACE 3                                                        38400022
QND6305  EQU   *                                                 S99240 38430022
         XC    CDRDATE(8),CDRDATE       ZERO LINK FIELD OF ELEM  S99240 38460022
         LR    R10,R0                   SAVE TTR                 S99240 38490022
         TM    CDRTTRLI+2,1             IS THIS A CONTINUATION   S99240 38520022
*                                        SEGMENT                 S99240 38550022
         BO    QND66                    YES, LINK INTO CHAIN     S99240 38580022
         ST    R11,OPCCOPCE             PUT ADDRESS OF ELEMENT INS99240 38610022
*                                        OPERATOR CONTROL AVT    S99240 38640022
QND64    TM    CDRTTRLI+2,2             IS THIS THE LAST SEGMENT S99240 38670022
*                                        OF THE COMMAND          S99240 38700022
         BZ    QND68                    NO, SET UP TO READ NEXT  S99240 38730022
*                                        CONTINUATION SEGMENT    S99240 38760022
         TM    CKPECB,X7F               CHECK FOR DISK ERROR     S21903 38790005
         BNO   QND65                    YES, FREE SEGMENTS       S99240 38820022
         OI    OPCSPEC,OPCRSTRT         SET RESTART BIT FOR OPC  S99240 38850022
         LA    R1,AVTOPCOB+4            ADDR OF  OPC CONTROL ECB        39200020
         POST  (1)                      POST OPC CONTROL COMPLETE       39600020
         SPACE                                                          39800020
         WAIT  ECB=AVTCKPTB+4           WAIT FOR UPDATE                 40000020
         MVI   AVTCKPTB+4,0             CLEAR ECB COMPLETION CODE  0827 40100020
         NI    OPCSPEC,OCFOXES-OPCRSTRT TURN OFF RESTART BIT     S99240 40200022
         SPACE 3                                                        40210022
QND65    MVC   CKPEXCP+1(3),OPCCOPCE+1  RESET I/O BUFFER ADDRESS S99240 40220022
         MVC   CKPRW+1(3),CKPEXCP+1     RESET READ COMMAND ADDR  S99240 40230022
         L     R11,OPCCOPCE             GET FIRST SEGMENT ADDRESSS99240 40240022
         MVC   OPCCOPCE+1(3),CDRTTRLI   REMOVE SEGMENT FROM CHAINS99240 40250022
QND6505  NI    OPCCOPCE+3,XFC           RESET LOW ORDER BITS     S21903 40260005
         LR    R0,R10                   RESTORE TTR              S99240 40270022
         OC    OPCCOPCE+1(3),OPCCOPCE+1 END OF CHAIN             S99240 40280022
         BZ    QND76                    YES, GO READ NEXT RECORD S99240 40290022
         LH    R1,CKPBPERR              LENGTH OF GETMAIN        S99240 40300022
         CH    R1,CKPINCLN              CHECK INCIDENT LENGTH    S99240 40310022
         BH    QND6506                  INCIDENT LENGTH LOW      S99240 40320022
         LH    R1,CKPINCLN              GET INCIDENT RECORD LEN  S99240 40330022
QND6506  EQU   *                                                 S99240 40340022
         CH    R1,CKPCKRLN              CHECK CKREQ LENGTH       S99240 40350022
         BH    QND6507                  CKREQ LENGTH LOW         S99240 40360022
         LH    R1,CKPCKRLN              USE CKREQ LENGTH         S99240 40370022
QND6507  EQU   *                                                 S99240 40380022
         ST    R1,CKPGETML              STORE IN FREEMAIN LIST   S99240 40390022
         LA    R1,OPCCOPCE              PUT ADDRESS OF AREA TO   S99240 40400022
         ST    R1,CKPGETML+4             FREE IN LIST            S99240 40410022
         L     R11,OPCCOPCE             RESET CURRENT OPCE PTR   S99240 40420022
         L     R11,CDRTTRLI-1           GET NEXT SEGMENT ADDRESS S99240 40430022
         LA    R11,0(R11)               CLEAR HIGH ORDER BYTE    S99240 40440022
         FREEMAIN E,MF=(E,CKPGETML),SP=0 FREE I/O BUFFER         S99240 40450022
         ST    R11,OPCCOPCE             UPDATE CURR SEGMENT PTR  S99240 40460022
         B     QND6505                  CHECK FOR MORE BUFFERS TOS99240 40470022
*                                        FREE                    S99240 40480022
         SPACE 2                                                        40490022
QND66    XC    CDRDATE(8),CDRDATE       CLEAR LINK FIELDS        S99240 40500022
         OC    OPCCOPCE+1(3),OPCCOPCE+1 HAS THIS FUNCTION BEEN   S99240 40510022
*                                        CANCELLED DUE TO A DISK S99240 40520022
*                                        I/O ERROR               S99240 40530022
         BZ    QND76                    YES, IGNORE CONTINUATION S99240 40540022
         LA    R1,OPCCOPCE-8            SET UP FOR FIRST TIME    S99240 40550022
         DROP  R11                      SET UP NEW               S99240 40560022
         USING IEDQCDRD,R1                USING STATEMENT        S99240 40570022
QND67    L     R1,CDRTTRLI-1            GET NEXT SEGMENT ADDRESS S99240 40580022
         OC    CDRTTRLI,CDRTTRLI        CHECK FOR LAST SEGMENT   S99240 40590022
         BNZ   QND67                    NOT LAST, RELOOP         S99240 40600022
         ST    R11,CDRTTRLI-1           LINK THIS SEGMENT AS LASTS99240 40610022
         DROP  R1                       REVERT TO                S99240 40620022
         USING IEDQCDRD,R11               OLD USING STATEMENT    S99240 40630022
         NI    CDRTTRLI+2,XFE           TURN-OFF CONTINUATION    S21903 40640005
*                                        SEGMENT IDENTIFIER      S99240 40650022
         B     QND64                    GO CHECK FOR LAST SEGMENTS99240 40660022
         SPACE 3                                                        40800020
QND68    EQU   *                                                 S99240 40808022
         LH    R1,CKPBPERR              LENGTH OF GETMAIN        S99240 40816022
         CH    R1,CKPINCLN              CHECK INCIDENT LENGTH    S99240 40824022
         BH    QND6803                  INCIDENT LENGTH LOW      S99240 40832022
         LH    R1,CKPINCLN              GET INCIDENT RECORD LEN  S99240 40840022
QND6803  EQU   *                                                 S99240 40848022
         CH    R1,CKPCKRLN              CHECK CKREQ LENGTH       S99240 40856022
         BH    QND6808                  CKREQ LENGTH LOW         S99240 40864022
         LH    R1,CKPCKRLN              USE CKREQ LENGTH         S99240 40872022
QND6808  EQU   *                                                 S99240 40880022
         ST    R1,CKPGETML              STORE IN GETMAIN PARM LSTS99240 40888022
         LA    R1,CKPEXCP               SET FOR GETMAIN TO PUT   S99240 40896022
*                                        ADDR OF AREA IN CKPEXCP S99240 40904022
         ST    R1,CKPGETML+4            STORE IN PARM LIST       S99240 40912022
         GETMAIN EC,MF=(E,CKPGETML),SP=0 GET CORE FOR CONTINUED  S99240 40920022
         LTR   R15,R15                  WAS CORE AVAILABLE       S99240 40928022
         BNZ   QND69                    NO, PRINT NO CORE MESSAGES99240 40936022
         MVC   CKPRW+1(3),CKPEXCP+1     SET ADDRESS IN READ CCW  S99240 40944022
         LR    R0,R10                   RESTORE TTR              S99240 40952022
         B     QND76                    AND READ NEXT RECORD     S99240 40960022
QND69    WTO   'IED010I CHECKPOINT-INSUFFICIENT CORE-INCIDENT RECORD IGX40968022
               NORED',ROUTCDE=11,DESC=4                          S99240 40976022
         B     QND65                    FREE PREVIOUS SEGMENTS   S99240 40984022
         SPACE 3                                                        40992022
*INCIDENT RECORD WAS THE RESULT OF A MH MACRO OR A TCHNG MACRO.         41000020
         SPACE                                                          41200020
QND70    EQU   *                                                   0814 41400020
         USING IEDQTRM,RTERM                                            41600020
         LH    R1,CDROFFS               GET TERMNAME OFFSET             41800020
         L     R15,AVTRNMPT                                             42000020
         STM   R14,R1,CKPSAVE2          SAVE REGS                       42200020
         N     R1,AVTCLRHI              CLEAR HIGH ORDER HALF WORD      42400020
         BALR  R14,R15                  GET TERM ENTRY                  42600020
         USING IEDQTRM,RTERM                                       0629 42800020
         LR    RTERM,R1                 BASE FOR TERM ENTRY             43000020
         LM    R14,R1,CKPSAVE2          RESTORE REGS                    43200020
         MVC   TRMSTATE,CDRSTAT         UPDATE TERM STATUS FIELD        43400020
         SPACE 3                                                        43600020
*UPDATE OPTION FIELDS FOR THIS TERMINAL ENTRY.(REGISTERS BEING USED     43800020
*AT THIS TIME ARE 0,2,8,9,11,12,14THIS OPTION TABLE SUBROUTINE USES     44000020
*1,3,4,5,6,7,10,13,15).                                                 44200020
         SPACE                                                          44400020
         LR    R10,R11                  SAVE REGISTER          @OY20722 44430082
         TM    TRMSTATE,TRMOPTFN        ARE THERE OPTIONS        A42401 44460021
         BNO   QND7502                  BRANCH IF NOT          @OZ26495 44520082
         SR    R6,R6                    INITIALIZE INDEX REG            44600020
         SR    R7,R7                                                    44800020
         IC    R7,TRMOPNO               COMPARAND-NO. OPTIONENTRIES     45000020
         L     R5,AVTOPTPT              ADDR OF OPTION TABLE            45200020
         L     R4,4(0,R5)               ADDR OF OPTION LENGTH TABLE     45400020
         LH    R1,TRMOPTBL              OFFST TO OPT FOR THIS ENTRY     45600020
         N     R1,AVTCLRHI              CLEAR HIGH ORDER HALF WORD      45800020
         AR    R5,R1                    ADD OFFST TO OPT TABLE ADDR     46000020
         SR    R1,R1                    CLEAR                           46200020
         SR    R3,R3                    CLEAR LENGTH FOR MOVE           46400020
         SPACE 3                                                        46600020
*BEGINNING OF LOOP THROUGH OPTION TABLE OFFSETS FOR THIS TERMINAL       46800020
         SPACE                                                          47000020
QND74    EQU   *                                                   0814 47200020
         LR    R15,R5                   INITIALIZE BEG OPTN ENTRIES     47400020
         IC    R1,TRMOPT(R6)            OPTION OFFSET                   47600020
         CH    R1,QMGNOPT               CHECK FOR UNUSED FIELD          47800020
         BE    QND75                    BRANCH IF UNUSED           0814 48000020
         AR    R15,R1                   ADDR OF OPTION ENTRY            48200020
         IC    R3,0(R4)                 GET LNGTH OF THIS OPT ENTRY    X48400020
                                        (1 HAS ALREADY BEEN SUB-       X48600020
                                        TRACTED FOR EXECUTE)            48800020
         CLI   L1(R4),XD0               CHECK OPTION TYPE        S21903 48830005
         BH    QND7405                  BRANCH IF NOT ADDRESS TYPE 0115 48860020
         CLI   L1(R4),X80               CHECK OPTION TYPE        S21903 48890005
         BH    QND75                    BRANCH IF ADDRESS TYPE     0115 48920020
QND7405  EQU   *                                                   0115 48950020
         EX    R3,QNDMOVE1              MOVE OPTIONS TO OPTION TABL0814 49000020
         LA    R11,1(R3,R11)            ADD LENGTH MOVED TO BASE OF    X49200020
                                        DISK RECORD                     49400020
QND75    EQU   *                                                   0814 49600020
         LA    R4,CKPOPLTL(0,R4)        MOVE TO NEXT OPTION LENGTH     X49800020
                                        TABLE ENTRY                     50000020
         LA    R6,1(,R6)                ADD 1 TO INDEX                  50200020
         BCT   R7,QND74                 SUB 1 FROM NO. OF ENTRIES  0814 50400020
         SPACE                                                          50600020
*END OF LOOP THROUGH OPTION TABLE OFFSETS                               50800020
         SPACE 3                                               @OZ26495 50806082
QND7502  EQU   *                                               @OZ26495 50812082
         CLI   CDRKEY-IEDQCDRD(R10),CDRLCB INCIDENT RECORD FOR @OY20722 50813082
*                                        MH MACRO              @OY20722 50814082
         BE    QND76                    YES, BRANCH            @OY20722 50815082
         TM    TRMDEVFL,X60             DIAL DIGITS/ADDR CHAR? @OZ26495 50818082
         BZ    QND76                    NO, BRANCH             @OZ26495 50824082
         SR    R3,R3                    CLEAR REG              @OZ26495 50830082
         LA    R11,SIXTEN(R11)          START OF DEVICE FIELDS @OZ26495 50836082
         TM    TRMSTATE,TRMOPTFN        OPTION FIELDS USED     @OZ26495 50842082
         BNO   NOOPTS                   NO, BRANCH             @OZ26495 50848082
         LA    R15,TRMOPT               START OF OPTIONS       @OZ26495 50854082
         IC    R3,TRMOPNO               NUMBER OF OPTIONS      @OZ26495 50860082
         LA    R15,0(R3,R15)            START OF DEVICE FIELDS @OZ26495 50866082
*                                        IN TERMINAL ENTRY     @OZ26495 50872082
         B     CKBUF                    CHECK DEVICE FIELDS    @OZ26495 50878082
NOOPTS   EQU   *                                               @OZ26495 50884082
         LA    R15,TRMOPNO              START OF DEVICE FIELDS @OZ26495 50890082
CKBUF    EQU   *                                               @OZ26495 50896082
         TM    TRMDEVFL,X80             BUFSIZE SPECIFIED      @OZ26495 50902082
         BNO   CKDIAL                   NO, BRANCH             @OZ26495 50908082
         A     R15,ADD3                 BUMP PAST BUFSIZE      @OZ26495 50914082
CKDIAL   EQU   *                                               @OZ26495 50920082
         TM    TRMDEVFL,X40             DIAL DIGITS SPECIFIED  @OZ26495 50926082
         BNO   CKADDR                   NO, BRANCH             @OZ26495 50932082
         IC    R3,0(R11)                LENGTH OF DIAL DIGITS  @OZ26495 50938082
         EX    R3,QNDMOVE2              UPDATE DIAL DIGITS     @OZ26495 50944082
         LA    R15,ONE(R3,R15)          BUMP PAST DIAL DIGITS  @OZ26495 50950082
         LA    R11,ONE(R3,R11)          BUMP PAST DIAL DIGITS  @OZ26495 50956082
CKADDR   EQU   *                                               @OZ26495 50962082
         TM    TRMDEVFL,X20             ADDR CHAR SPECIFIED    @OZ26495 50968082
         BNO   QND76                    NO, BRANCH             @OZ26495 50974082
         IC    R3,0(R11)                LENGTH OF ADDR CHAR    @OZ26495 50980082
         EX    R3,QNDMOVE2              UPDATE ADDR CHAR       @OZ26495 50986082
         SPACE 3                                                        51000020
*DETERMINE RELATIVE TTR OF NEXT CKREQ OR INCIDENT RECORD                51400020
         SPACE                                                          51600020
QND76    EQU   *                                                   0814 51800020
         IC    R15,CKPINCNO             GET COUNT OF AVAILABLE INC 0118 51810020
         BCTR  R15,0                    SUBTRACT 1 FROM COUNT      0118 51820020
         STC   R15,CKPINCNO             RESTORE COUNT IN CONTROL RD0118 51830020
         ST    R0,CKPTRMAD              STORE TTR                  0118 51860020
         CLC   CKPTRMAD+1(3),CKPTTRLI   CHECK FOR LAST INC RCD USED0118 51890020
         BNE   QND7605                  BRANCH NOT LAST          S99240 51920022
QND7603  EQU   *                                                 S99240 51923022
         L     R3,AVTOCGET              GET OP CTL AVT ADDRESS   S99240 51926022
         OC    OPCCOPCE+1(3),OPCCOPCE+1 ANY PARTIAL OP CONTROL   S99240 51929022
*                                        INCIDENT RECORDS        S99240 51932022
         BZ    QND78                    NO, BRANCH               S99240 51935022
         LR    R10,R0                   SAVE TTR                 S99240 51938022
         IC    R15,CKPINCNO             GET COUNT OF AVAILABLE   S99240 51941022
         LA    R15,1(R15)               ADD ONE - WILL BE        S99240 51944022
*                                        SUBTRACTED LATER        S99240 51947022
         STC   R15,CKPINCNO             RESTORE COUNT            S99240 51950022
         MVI   CKPECB,X41               SET-LOOK LIKE DISK ERROR S21903 51953005
         B     QND596                   GO FREE INCIDENT SEGMENTSS99240 51956022
QND7605  EQU   *                                                   0925 51960020
         LH    R15,CKPTRKLN             GET TRK DATA LENGTH 0416 S21101 51970000
         AH    R15,CKPINCLN             ADD LN OF RCD WRITTN0416 S21101 51980000
         STH   R15,CKPTRKLN             RESTORE DATA LENGTH 0416 S21101 51990000
         LR    R15,R0                                                   52000020
         LA    R15,0(,R15)              CLEAR HIGH ORDER BYTE      0817 52200020
         LTR   R15,R15                  CHECK FOR 1ST INC RCD      0826 52400020
         BZ    QND5805                  BRANCH IF 1ST RCDSHOULD BE 0826X52600020
                                        READ                            52800020
         LA    R7,QND58                 SET RETURN ADDRESS     @SA67132 52860061
GETNEXT  EQU   *                                               @SA67132 52920061
         LA    R0,1(0,R15)              GET NEXT RCD ON TRACK           53000020
         EX    R15,QNDCOMPR             CHECK FORLAST RCD ON TRACK 0814 53200020
         BHR   R7                       BR IF NOT END OF TRK   @OY19771 53400082
         LA    R0,CKP101(0,R15)         GET NEXT TRACK                  53600020
         IC    R0,QMGONE                INITIALIZE TO 1ST RECORD        53800020
         LA    R14,CKPIPERT             RCD NO-LAST RCD ON TRACK   0814 54000020
         XC    CKPTRKLN,CKPTRKLN        INITIALIZE DATA LN  0416 S21101 54050000
         BR    R7                       READ NEXT RECORD       @SA67132 54100061
QND77    EQU   *                                                   0118 54200020
         MVC   CKPTTRLI(3),CKPTRMAD+1   UPDATE LAST INC RCD USED   0118 54300020
         ST    R0,CKPTRMAD              STORE TTR                  0118 54400020
         CLC   CKPTRMAD+1(3),CKPTTRIN   CHECK FOR FIRST INC RCD  S99240 54500022
         BNE   QND7603                  BRANCH NOT FIRST         S99240 54600022
         XC    CKPTTRLI,CKPTTRLI        INDICATE 1ST RCD           0118 54700020
         SPACE 3                                                        55000020
*ATTACH CHECKPOINT EXECUTOR-IEDQNF                                      55200020
         SPACE                                                          55400020
QND78    EQU   *                                                   0803 55600020
         LA    R1,CKPEXCP               PTR TO ADDR OF AREA 0405 S21101 55660000
         SR    R3,R3                    CLEAR REGISTER         @ZA06155 55662009
         L     R15,CKPTTRLI-1           PICK UP LAST INCIDENT  @ZA06155 55664009
         LA    R15,ZERO(R15)            CLEAR HIGH BYTE        @ZA06155 55666009
         LTR   R15,R15                  END OF DATA SET        @ZA06155 55668009
         BZ    ENDDATA                  YES, BRANCH            @ZA06155 55670009
         LA    R14,CKPIPERT             NUMBER OF INCIDENTS    @ZA06155 55672009
*                                        PER TRACK             @ZA06155 55674009
         CLC   CKPTTRIN(2),CKPTTRLI     IS LAST INCIDENT ON    @ZA06155 55676009
*                                        FIRST TRACK           @ZA06155 55678009
         BNE   GETREC                   NO, BRANCH             @ZA06155 55680009
         LA    R14,CKPINRNO             NUMBER OF INCIDENTS ON @ZA06155 55682009
*                                       FIRST TRACK            @ZA06155 55684009
GETREC    EQU  *                                               @ZA06155 55686009
         BAL   R7,GETNEXT               GET NEXT RECORD        @ZA06155 55688009
         LR    R15,R0                   SET REGISTER 15        @ZA06155 55690009
         C     R0,AVTPARM               AT END OF INCIDENTS    @ZA06155 55694009
         BNL   SETCOUNT                 NO, BRANCH             @ZA06155 55696009
         LA    R3,ONE(R3)               INCREMENT COUNT        @OY19771 55696182
         B     GETREC                   GET RECORD             @ZA06155 55698009
SETCOUNT  EQU  *                                               @ZA06155 55700009
         STC   R3,CKPINCNO              STORE INCIDENT COUNT   @ZA06155 55702009
*                                        REMAINING             @ZA06155 55704009
         B     QND7801                  ATTACH CHECKPOINT      @ZA06155 55706009
ENDDATA   EQU  *                                               @ZA06155 55708009
         MVC   CKPINCNO,CKPINCNT        SET AVAILABLE EQUAL    @ZA06155 55710009
*                                        TOTAL                 @ZA06155 55712009
QND7801  EQU   *                                               @ZA06155 55714009
         ST    R1,CKPGETML+4            PUT PTR IN PARM LIST0405 S21101 55720000
         LH    R1,CKPBPERR              LENGTH OF GETMAIN               55800020
         CH    R1,CKPINCLN              CHECK LENGTH OF INC 0405 S21101 55820000
         BH    QND7803                  BRANCH IF INC IS LOW0405 S21101 55840000
         LH    R1,CKPINCLN              USE INCIDENT LENGTH 0405 S21101 55860000
QND7803  EQU   *                                            0405 S21101 55880000
         CH    R1,CKPCKRLN              CHECK LENGTH OF CKREQ405 S21101 55900000
         BH    QND7806                  BRANCH IF CKREQ LOW 0405 S21101 55920000
         LH    R1,CKPCKRLN              USE CKREQ LN FOR FREE405 S21101 55940000
QND7806  EQU   *                                            0405 S21101 55960000
         ST    R1,CKPGETML                                              56000020
         FREEMAIN E,MF=(E,CKPGETML),SP=0 FREE I/O BUFFER           0806 56200020
         XC    CKPECB(CKPCTTRB-CKPECB),CKPECB  CLEAR WORK AREA USED    X56400020
                                        BY OPEN MODULES                 56600020
QND79    EQU   *                                                   0804 56800020
         TM    AVTCKFLG,AVTCKTAC+AVTCKNAC EITHER CHECK ACTIVE @ZM46597  56860000
         BZ    QND80                    NO BYPASS SET UP      @ZM46597  56920000
         LA    R3,AVTCKECA              ADDRESS OF CHECKPT ECB          57000020
         L     R4,AVTCLOSB+8            ADDRESS OF IEDQNA               57200020
         LA    R4,6(,R4)                ADDRESS OF IEDQNA3              57400020
         LR    R1,R13                   PASS ADDR OF AVT TO IEDQNF 0115 57500020
*                                       ATTACH CHECK-POINT EXECUTOR     57520020
         TM    AVTBIT1,AVTTSON          IS TIME SHARING ACTIVE          57540020
         BO    QND7905                  BRANCH ON YES                   57560020
         ATTACH ECB=(3),ETXR=(4),SF=(E,CKPTLIST)                        57580020
         B     QND7910                  BRANCH AROUND TSO ATTACH S22025 57600022
QND7905  EQU   *                                                        57620020
         L     R6,AVTTSOPT              ADDRESS OF TIME SHARING QCB     57640020
         L     R6,TSISTAE-IEDQTSI(,R6)  ADDRESS OF STAE ROUTINE         57660020
         LA    R6,4(,R6)                ADDRESS OF STAI ENTRY POINT     57680020
         ATTACH ECB=(3),ETXR=(4),STAI=((6)),SF=(E,CKPTLIST)             57700020
QND7910  EQU   *                                                        57720020
         ST    R1,AVTCKTCB              ADDRESS OF CHECKPOINT TCB       57800020
         SPACE 3                                                        59400020
*CHECK FOR OPERATOR AWARENESS ROUTINE AND LOAD IF NECESSARY        1002 59600020
         SPACE                                                          60000020
QND80    EQU   *                                                        60200020
         LH    R1,AVTOPCON              PRIMARY OP CONSOLE         0815 60400020
         LTR   R1,R1                    CHECK FOR SYSCON           0815 60600020
         BZ    QND8005                  BRANCH IF SYSCON           0815 60800020
         L     R1,AVTNX                 GET ADDR OF OPAR RTN       0815 61000020
         LTR   R1,R1                    CHECK FOR RTN              0815 61200020
         BNZ   QND8005                  BRANCH IF ALREADY LOADED   0815 61400020
         LOAD  EP=IEDQNX                LOAD OPAR RTN              0815 61600020
         ST    R0,AVTNX                 SAVE ENTRY POINT ADDRESS   0815 61800020
         SPACE 2                                                        61801022
* CHECK FOR ON-LINE TEST SPECIFIED ON INTRO                      S99528 61802022
         SPACE 1                                                        61803022
QND8005  EQU   *                                                 S99528 61804022
         CLI   AVTOLTST,ZERO            CHECK OLTEST OPERAND     S99528 61805022
         BNE   QND30                    BRANCH IF SPECIFIED      S99528 61806022
         MVI   AVTOLECA,X40             POST COMPLETION ECB SINCES99528 61807022
*                                       OLT WILL NEVER TERMINATE S99528 61808022
         B     QND80055                 CHECK TIME DELAY QUEUE   S99528 61809022
         SPACE 2                                                        61810022
* CHECK FOR SUFFICIENT CORE                                      S99528 61811022
         SPACE 1                                                        61812022
QND30    EQU   *                                                 S99528 61813022
         GETMAIN R,LV=18432             UNCONDITIONAL GETMAIN    S05331*61814052
                                         FOR MINIMUM AMOUNT      S22024 61815022
         FREEMAIN R,LV=18432,A=(1)      FREE THE CORE            S05331 61816052
         SR    R2,R2                    CLEAR REG 2              S99528 61817022
         IC    R2,AVTOLTST              GET NO. BLOCKS OF CORE   S99528 61818022
         SLL   R2,TEN                   MULTIPLY BY 1024         S99528 61819022
         SPACE 1                                                        61820022
         GETMAIN EC,LV=(R2),A=AVTDOUBL,MF=(E,AVTGETMN),SP=0      S99528 61821022
         LTR   R15,R15                  CHECK RETURN CODE        S99528 61822022
         BZ    QND50                    BRANCH IF CORE AVAILABLE S99528 61823022
         WTO   'IED094I CORE REQUESTED FOR ON-LINE TEST NOT AVAILABLE',X61824022
               ROUTCDE=10,DESC=4                                 S99528 61825022
         MVI   AVTOLTST,QNDOLTST        CHANGE OLT PARM TO 18K   S05331 61826052
         B     QND80055                 SKIP FREEMAIN            S99528 61827022
QND50    EQU   *                                                 S99528 61828022
         FREEMAIN E,MF=(E,AVTGETMN)      FREE UP AREA            S99528 61829022
         MVI   AVTGETMN+8,ECMODE        RESET MODE FIELD        SA63993 61839051
         SPACE 3                                                        61850020
*PUT DESTINATION QCBS ON TIME DELAY QUEUE IF NECESSARY                  61900020
         SPACE                                                          61950020
QND80055 EQU   *                                                 S99528 62000022
         DROP  R8                       CHANGE BASE FOR TERM ENTRY 0819 64000020
         L     R11,AVTEA                ADDRESS OF DISPATCHER           64200020
         LA    R13,AVTSAVE3             USE SAVE 3                      64400020
         USING AVTSAVE3,R13                                             64600020
         SR    R2,R2                    CLEAR FOR TNT LOOP              64800020
         ST    R2,AVTDOUBL              SET END OF QCB CHAIN            65000020
         L     R15,AVTRNMPT             TERMINAL NAME TABLE             65200020
         USING IEDQTNTD,R15                                             65400020
         LH    R7,TNTLEN                NUMBER OF TTABLE ENTRIES        65600020
         N     R7,AVTCLRHI              CLEAR HIGH ORDER HALF           65800020
         BAL   R14,QND81                ENTER LOOP AND SET RETURN       66000020
*                                                                       66200020
         USING IEDQTRM,R1                                               66400020
         TM    TRMSTATE,TRMSNGLE        TPROCESS, LIST, LOG,   @G36XRNP 66600000
*                                       LINE OR GROUP ENTRY?   @G36XRNP 66700000
         BNZ   QND81                    BRANCH NO                       66800020
         TM    TRMSTATE,TRMPREF         NCP ATTACHED TERMINAL  @G36XRNP 67080000
         BO    QND81                    BR YES                   X03039 67100008
*                                                                X03039 67120008
         L     R4,TRMDESTQ-1            QCB ADDRESS                     67200020
         USING IEDQQCB,R4                                               67400020
         CLI   QCBSTPRI,X70             INTVL OPTION             S22026 67600022
         BNE   QND80058                 BRANCH IF NO           @OY12667 67650091
         CLC   QCBMSGCT(2),AVTFZERO     ANY MSGS QUEUED        @OY12667 67660091
         BNE   QND81                    YES, DONT CHAIN QCB    @OY12667 67670091
         B     QND8006                  NO, CONTINUE           @OY12667 67680091
QND80058 EQU   *                                               @OY12667 67690091
         CLI   QCBSTPRI,X80             CLOCK OPTION             S22026 67700022
         BNE   QND81                    BRANCH IF NO             S22026 67750022
* IF THIS IS NOT CLOCK OR CINTVL BYPASS PROCESSING             @G36XRNP 67760000
         CLI   QCBSTPRI,QCBCNTVL        CLOCK/CINTVL           @G36XRNP 67770000
         BL    QND81                    BRANCH NO              @G36XRNP 67780000
QND8006  EQU   *                                                 S22026 67800022
*                                                                       68000020
         NC    QCBINTVL,QCBINTVL        DIAL-UP READ ONLY      @OY14058 68060091
         BZ    QND81                    BYPASS DELAY Q         @OY14058 68120091
         TM    QCBINSRC+2,QCBDELAY      QCB SERVICED PREVIOUSLY         68200020
         BO    QND81                    BRANCH YES - TRY NEXT           68400020
         L     R3,QCBDCBAD-1            DCB ADDRESS                     68600020
         USING IHADCB,R3                                                68800020
         TM    DCBOFLGS,X10             IS DCB OPEN                     69000020
         BZ    QND81                    BRANCH NO                       69200020
         L     R1,DCBDEBAD              ADDRESS OF DEB          SA63007 69210005
         CLC   DEBNMEXT-DEBNMSUB(ONE,R1),QCBRELLN IS RLN VALID  SA63007 69220005
         BL    QND81                    BRANCH ON NO            SA63007 69230005
         SR    R1,R1                    CLEAR REGISTER          SA63007 69240005
         IC    R1,QCBRELLN              PICK UP RELATIVE LINE   SA63007 69250005
         BCTR  R1,ZERO                  DECREMENT BY ONE        SA63007 69260005
         SLL   R1,TWO                   MULTIPLY BY FOUR        SA63007 69270005
         A     R1,DCBDEBAD              ADD DEB ADDRESS         SA63007 69280005
*                                       IS ENTRY DD DUMMY       SA63007 69290005
         CLC   DEBUCBAD-DEBNMSUB+1(THREE,R1),AVTFZERO           SA63007 69300005
         BE    QND81                    BRANCH ON YES           SA63007 69310005
*                                                                       69400020
         OI    QCBINSRC+2,QCBDELAY      SET PREVIOUSLY SERVICED FLAG    69600020
         MVC   QCBELCHN,AVTDOUBL+1      SET LINK FIELD FOR NEXT LOOP    69800020
         MVC   QCBSTCHN(3),QCBSLINK     FIX SCHEDULER                   70000020
         ST    R4,AVTDOUBL              SET FOR NEXT LINK               70200020
QND81    EQU   *                                                        70400020
         LA    R2,ONE(,R2)              ADD ONE TO NEXT ENTRY           70600020
         LR    R1,R2                    TO INPUT REG FOR TNT            70800020
         CLR   R7,R2                    COMPARE TOTAL TO THIS ENTRY     71000020
         BCR   LOWEQ,R15                BR IF TOTAL IS HIGH     SA59006 71200022
*                                                                       71400020
         DROP  R15                                                      71600020
         BALR  R14,0                    SET RETURN AND BEGIN SEARCH     71800020
         L     R1,AVTDOUBL              FIRST QCB TO ENTER DELAY        72000020
         LA    R1,0(,R1)                CLEAR HIGH ORDER                72200020
         LTR   R1,R1                    ANY TO SERVICE                  72400020
         BZ    QND84                    BRANCH NO - EXIT           0803 72600020
*                                                                       72800020
         DROP  R4                                                       73000020
         USING IEDQQCB,R1                                               73200020
         L     R4,QCBELCHN-1            NEXT ELEMENT                    73400020
         MVC   QCBELCHN,AVTDOUBL+1      SET TO POINT TO ITSELF          73600020
         ST    R4,AVTDOUBL              NEXT ELEMENT                    73800020
         LH    R4,QCBINTVL              DELAY IN SECONDS                74000020
         N     R4,AVTCLRHI              CLEAR HIGH ORDER HALF           74200020
         CLI   QCBSTPRI,X70             DIAL UP OPTIONS=INTVL           74400020
         BE    QND82                    YES, INTVL OK                   74600091
*                                                                       74800020
         AR    R4,R4                    DOUBLE                          75000020
*              ORIGINAL DELAY FOR CLOCK WAS DIVIDED BY  2 AT            75200020
*              ASSEMBLY TIME.  MUST BE RESTORED FOR TIME DELAY          75400020
         LR    R3,R1                    SAVE QVB ADDRESS                75600020
*                                       GET TIME OF DAY                 75800020
         TIME  BIN                                                      76000020
         SRDL  R0,HALF                  SHIFT TIME TO R1                76200020
         D     R0,HUND                  CONVERT TO SECONDS              76400020
*              RESULT IS IN R0 + 1                                      76600020
         N     R1,CLRMASK               CLEAR UNNEEDED BITS             76800020
         CLR   R1,R4                    TIME OF DAY TO CLOCK REQUEST    77000020
         BL    SAMEDAY                  BRANCH IF INTERRUPT IS TODAY    77200020
*                                                                       77400020
         A     R4,TW24HRS               ADD 24 HOURS                    77600020
SAMEDAY  EQU   *                                                        77800020
         SR    R4,R1                    GET DIFFERENCE                  78000020
         LR    R1,R3                    RESTORE QCB ADDRESS             78200020
QND82    EQU   *                                                        78400020
         C     R4,TWLVE                 IS DELAY GREATER THAN 12 HOURS  78600020
         BL    QND83                    BRANCH NO                       78800020
*                                                                       79000020
         S     R4,TWLVE                 DECREMENT BY 12 HOURS           79200020
         OI    QCBSTAT,QCBTIME          SET FLAG FOR TIME DELAY         79400020
QND83    EQU   *                                                        79600020
         STH   R4,QCBEOLDT              SET DELAY REQUES                79800020
         MVI   QCBLKRLN,0               SET FLAG INDICATING ELEMENT     80000020
         MVI   QCBPRI,PRIEDISP          SET PRIORITY FOR POST BY HG     80200020
*                                       IS A QCB                        80400020
         L     R15,AVTHG01              TIME DELAY SUBROUTINE ADDRESS   80600020
         BR    R15                      INSERT ELEMENT ON TIME DELAY Q  80800020
*                                                                       81000020
QND84    EQU   *                                                   0803 81200020
         SPACE                                                          81200300
* IF NOT EP ONLY LINK TO IEDIAB TO BUILD SAT,NAT,RVT AND       @G36XRNP 81200600
* PLCB AND SIB POOLS.                                          @G36XRNP 81200900
         SPACE                                                          81201200
         L     R13,AVTBASE              BASE ON AVTSAVE1       @G36XRNP 81201500
         USING IEDQAVTD,R13                                    @G36XRNP 81201800
         TM    AVTSAVTF,AVTVTMCP        EP ONLY?               @G36XRNP 81202100
         BZ    QNDEXIT                  BRANCH YES             @G36XRNP 81202400
         LINK  EP=IEDIAB                IEDIAB                 @G36XRNP 81202700
         L     R3,AVTOCGET              OP CTL AVT BASE        @G36XRNP 81203000
         USING IEDQOPCD,R3              OP CTL AVT BASE        @G36XRNP 81203300
         SPACE                                                          81203600
* IF RESTART INDICATED LINK TO IGCFD10D TO DELINK RESOURCE     @G36XRNP 81203900
* HIERARCHIES IN TERMINAL TABLE.                               @G36XRNP 81204200
         SPACE                                                          81204500
         TM    AVTBIT2,AVTSTRTN         RESTART?               @G36XRNP 81204800
         BZ    QNDEXIT                  BRANCH IF NOT          @G36XRNP 81205100
         OI    OPCSPEC,OPCRSTRT         INDICATE RESTART FOR   @G36XRNP 81205400
*                                       FOR DEACTIVATE.        @G36XRNP 81205700
         LA    R13,AVTSAVE3             SET REG 13 TO SAVE AREA@G36XRNP 81206000
         USING AVTSAVE3,R13             ADDRESSIBLITY          @G36XRNP 81206300
         LINK  EP=IGCFD10D              IGCFD10D               @G36XRNP 81206600
         L     R13,AVTBASE              RESTORE AVT BASE       @G36XRNP 81206900
         USING IEDQAVTD,R13             ADDRESSIBLITY          @G36XRNP 81207200
         NI    OPCSPEC,255-OPCRSTRT     TURN OFF RESTART FLAG. @G36XRNP 81207500
         B     QNDEXIT                  EXIT                   @G36XRNP 81207800
         EJECT                                                          81208100
************************************************************** @G36XRNP 81208400
*        THE PURPOSE OF THIS ROUTINE IS TO FIND THE NCP TTE  * @G36XRNP 81208700
*        ADDRESS FOR A PARTICULAR 3705.                      * @G36XRNP 81209000
*                                                            * @G36XRNP 81209300
*        INPUT - REG 1 = 3705 DCB ADDRESS                    * @G36XRNP 81209600
*                REG 7 = RETURN ADDRESS                      * @G36XRNP 81209900
*                                                            * @G36XRNP 81210200
*        OUTPUT- REG 1 = 3705 NCP TTE ADDRESS                * @G36XRNP 81210500
*                                                            * @G36XRNP 81210800
************************************************************** @G36XRNP 81211100
QND90    EQU   *                                               @G36XRNP 81211400
         USING IHADCB,R1                SET ADDRESSABILITY     @G36XRNP 81211700
         USING IEDQLCB,R7               SET ADDRESSABILITY     @G36XRNP 81212000
         STM   R14,R12,CKPSAVE2         SAVE CALLER'S REG      @G36XRNP 81212300
         SLR   R7,R7                    CLEAR REG              @G36XRNP 81212600
         IC    R7,DCBEIOBX              GET LCB SIZE           @G36XRNP 81212900
         LA    R9,1                     SET RLN                @G36XRNP 81213200
         L     R11,DCBIOBAD             GET IOB ADDRESS        @G36XRNP 81213500
         MR    R6,R9                    GET LCB IOB OFFSET     @G36XRNP 81213800
         AR    R7,R11                   LCB IOB ADDRESS        @G36XRNP 81214100
         LA    R11,LCBPRFSZ             IOB OFFSET IN LCB      @G36XRNP 81214400
         SLR   R7,R11                   GET LCB ADDRESS        @G36XRNP 81214700
         LH    R1,LCBTTCIN              GET NCP TTCIN          @G36XRNP 81215000
         L     R15,AVTRNMPT             TTCIN TO TTE           @G36XRNP 81215300
*                                       CONVERSION ROUTINE     @G36XRNP 81215600
         BALR  R14,R15                  FIND 3705 NCP TTE ADDR @G36XRNP 81215900
*        REG 1 HAS 3705 NCP TTE ADDRESS                        @G36XRNP 81216200
         LM    R14,R0,CKPSAVE2          RESTORE REG 14-0       @G36XRNP 81216500
         LM    R2,R12,CKPSAVE2+DREG2    RESTORE REG 2-12       @G36XRNP 81216800
         BR    R7                       RETURN TO CALLER       @G36XRNP 81217100
         DROP  R1                                              @G36XRNP 81217400
         DROP  R7                                              @G36XRNP 81217700
         EJECT                                                          81218000
************************************************************** @G36XRNP 81218300
*                                                            * @G36XRNP 81218600
*        THE PURPOSE OF THIS ROUTINE IS TO FIND THE ADDRESS  * @G36XRNP 81218900
*        OF THE DEVICE DEPENDENT FIELDS OF A 3705 NCP        * @G36XRNP 81219200
*        TERMINAL ENTRY                                      * @G36XRNP 81219500
*                                                            * @G36XRNP 81219800
*        INPUT - REG 0 = MASK FOR DEVICE DEPENDENT FIELDS    * @G36XRNP 81220100
*                REG 1 = 3705 NCP TTE ADDRESS                * @G36XRNP 81220400
*                REG 7 = RETURN ADDRESS                      * @G36XRNP 81220700
*                                                            * @G36XRNP 81221000
*        OUTPUT- REG 1 = NCP DEVICE DEPENDENT FIELDS ADDRESS * @G36XRNP 81221300
*                                                            * @G36XRNP 81221600
************************************************************** @G36XRNP 81221900
QND95    EQU   *                                               @G36XRNP 81222200
         STM   R14,R12,CKPSAVE2         SAVE CALLER'S REG      @G36XRNP 81222500
         LR    R11,R13                  SAVE AVT ADDRESS       @G36XRNP 81222800
         L     R15,AVTDDFT              GET ADDRESS OF DEVICE  @G36XRNP 81223100
*                                       DEP LOOKUP ROUTINE     @G36XRNP 81223400
         LA    R13,CKPSAVE1             GET SAVE AREA ADDRESS  @G36XRNP 81223700
         BALR  R14,R15                  FIND ADDRESS OF NCP    @G36XRNP 81224000
*                                       DEVICE DEP FIELDS      @G36XRNP 81224300
         LR    R1,R15                   SAVE NCP DEVICE DEP    @G36XRNP 81224600
*                                       FIELDS ADDRESS         @G36XRNP 81224900
         LR    R13,R11                  RESTORE AVT ADDRESS    @G36XRNP 81225200
         LM    R14,R0,CKPSAVE2          RESTORE REG 14-0       @G36XRNP 81225500
         LM    R2,R12,CKPSAVE2+DREG2    RESTORE REG 2-12       @G36XRNP 81225800
         BR    R7                       RETURN TO CALLER       @G36XRNP 81226100
         EJECT                                                          81226400
QNDEXIT  EQU   *                                               @G36XRNP 81226700
         L     R1,CVTPTR                LOAD CVT ADDR            Y02027 81230006
         L     R1,CVTAQAVT-CVT(R1)      LOAD TCAM CVT EXTENSION  Y02027 81260006
         OI    TCXBIT1-IEDQTCX(R1),AVTREADN                      Y02027 81290006
*                                       MAP READY BIT FOR COMM   Y02027 81320006
*                                       TASK                     Y02027 81350006
         L     R13,AVTBASE              RESTORE AVT ADDRESS             81400020
         LM    R14,R12,12(R13)          RESTORE REGS                    81600020
         BR    R14                      RETURN TO READY                 81800020
         SPACE 3                                                        82000020
QMGONE   DC    X'1'                     USED TO INITIALIZE TO 1ST      X82200020
                                        RECORD ON TRACK                 82400020
         DS    0F                       FULLWORD            0507 S21101 82500000
QMGNOPT  DC    H'255'                   UNUSED OPTION FIELD INDICA      82600020
QNDFLAG  DC    X'8000'                  FLAG FOR SECTR CNVRT0507 S21101 82700000
QNDMOVE1 MVC   0(0,R15),CDROPTN         MOVE OPTION FIELD          0814 82800020
QNDMOVE2 MVC   0(0,R15),0(R11)          UPDATE DEVICE FIELDS   @OZ26495 82850082
ADD3     DC    F'3'                     CONSTANT               @OZ26495 82900082
QNDCOMPR CLI   0(R14),0                 CHECK FOR LAST RCD ON TRACK0814 83000020
         SPACE 3                                                        83200020
CKPTLIST ATTACH EP=IEDQNF,SF=L                                          83300020
TW24HRS  DC    F'86400'                 24 HOURS IN SECONDS             83400020
HUND     DC    F'100'                   CONVERT TIME TO SECONDS  S22025 83600022
TWLVE    DC    A(43200)                 TWELVE HOURS (IN SECONDS)       83800020
CLRMASK  DS    0F                                                       83860020
         DC    X'7FFFFFFF'              MASK TO CLEAR HIGH BIT   S22025 83920022
PATCH    DC    12F'0'                   PATCH AREA             @G36XRNP 84520000
         EJECT                                                          85200022
         TOPCAVTD                                                       85240022
         EJECT                                                          85280022
         TOPCED                                                         85320022
         EJECT                                                          85360022
         TCKPD 3330                     MERLIN VERSION      0510 S21101 85600000
         EJECT                                                          85750008
         TQCBD                                                          85800020
         EJECT                                                          86000022
         DCBD  DSORG=(TX,TR)                                     S22024 86040022
         EJECT                                                          86080022
         TDEBD                                                          86120022
         EJECT                                                          86130000
         TTCBD                                                 @G36XRNP 86140000
         EJECT                                                          86160022
         TLCBD                                                 @G36XRNP 86168000
         EJECT                                                          86176000
         TNCPID                                                @G36XRNP 86184000
         EJECT                                                          86192000
         TTNTD                                                          86200020
         EJECT                                                          86300008
         TTRMD                                                          86400020
         EJECT                                                          86500008
         TPRIOR                                                         86600020
         EJECT                                                          86700008
         TAVTD                                                          86800020
         EJECT                                                          86810008
         TTCXD                          DSECT                    Y02027 86830006
         EJECT                                                          86840008
         CVT   DSECT=YES                DSECT                    Y02027 86860006
         EJECT                                                          86880008
         TTSID                                                          86900020
         END                                                            87000020
./  ADD  SSI=81650027,NAME=IEDQNF
         TITLE 'IEDQNF-CHECKPOINT EXECUTOR'                             00100000
IEDQNF   CSECT                                                          00600020
         SPACE 3                                                        00900020
*********************************************************************** 01200020
*                                                                     * 02100020
*  MODULE NAME = IEDQNF (TCAM,CHECKPOINT/RESTART)                     * 02200000
*                                                                     * 02440005
*  DESCRIPTIVE NAME = CHECKPOINT EXECUTOR                             * 02480005
*                                                                     * 02520005
*  COPYRIGHT = 'NONE'                                                 * 02560005
*                                                                     * 02600005
*  STATUS:  VERSION 10.0                                              * 02620000
*                                                                     * 02700020
*FUNCTIONS:THIS MODULE DETERMINES IF THERE IS ANYTHING THAT NEEDS TO  * 03000020
*   BE DONE BY CHECKPOINT AND WHICH MODULE SHOULD              @OY15469 03100000
*   PERFORM THE NEXT FUNCTION.                                        * 03370000
*                                                                     * 03440000
*   FOR TCAM CHECKPOINT, IF THE DISK IOB IS MARKED COMPLETE,          * 03510000
*   THE CHECKPOINT NOTIFICATION-DISPOSITION ROUTINE IS         @OY15469 03610000
*   GIVEN CONTROL. IF NO I/O IS IN PROCESS AND THERE IS A RECORD ON   * 04200020
*   THE DISK I/O QUEUE,THE I/O ROUTINE IS LOADED.        IF THERE     * 04500020
*   IS A REQUEST ELEMENT ON THE CHECKPOINT QCB,THE PROPER ROUTINE     * 04800020
*   IS GIVEN CONTROL TO BUILD A CHECKPOINT RECORD.@OY15469              04810000
*                                                                     * 04820000
*   FOR 3705 CHECKPOINT, THE 3705 CHECKPOINT OR 3705 RESTART          * 04830000
*   MODULE IS CALLED IF AN ELEMENT IS ON THE 3705 CHECKPOINT          * 04840000
*   QUEUE. IF I/O FOR A 3705 CHECKPOINT OR RESTART HAS FINISHED,      * 04850000
*   THEN THE KEY FIELD SAVED IN CAVTWTG IS USED TO DETERMINE          * 04860000
*   WHICH MODULE IS CALLED NEXT.                                      * 04870000
*                                                                     * 04880000
*   THE CHECKPOINT MODULES DO NOT NEED TO SAVE REGISTERS SINCE THEY   * 04890000
*   USE 'BALR' TYPE LINKAGE. THE CONTENTS OF THE FOLLOWING REGIS-     * 04900000
*   TERS ARE MAINTAINED FROM ONE LOAD MODULE TO ANOTHER:              * 04910000
*                                                                     * 04920000
*   2-ADDRESS OF CHECKPOINT WORK AREA (TCAM CHECKPOINT ONLY)          * 04930000
*   9-ADDRESS OF AVT                                                  * 04940000
*   12-BASE REGISTER FOR IEDQNF                                       * 04950000
*   14-RETURN REGISTER-TO IEDQNF                                      * 04960000
*   15-ENTRY POINT-LOADED MODULE                                      * 04970000
*                                                                     * 04980000
*   REGISTER 14 POINTS TO A BRANCH TABLE IN IEDQNF.THE LOADED         * 04990000
*   MODULE RETURNS TO THAT ADDRESS PLUS A MULTIPLE OF FOUR,DEPEND-    * 05000000
*   ING ON THE FUNCTION TO BE PERFORMED.                              * 05010000
*                                                                     * 05020000
*   R14 PLUS 0-LOAD THE MODULE WHOSE NAME OFFSET IS IN REG 15. @OY15469 05030000
*   R14 PLUS 4-FUNCTION COMPLETE.                              @OY15469 05050000
*   R14 PLUS 8-WAIT FOR I/O TO COMPLETE.                       @OY15469 05060000
*                                                                     * 05070000
*   IF THERE IS NOTHING TO, THIS MODULE WAITS ON THE ECB LIST         * 05080000
*   UNLESS THE CLOSEDOWN BIT (IN CHECKPOINT REQUEST                   * 05700020
*   ELEMENT) IS ON; THEN THIS MODULE RETURNS TO THE OPERATING         * 05800000
*   SYSTEM THUS TERMINATING THE CHECKPOINT ATTACHED TASK.             * 05900000
*                                                                     * 06600020
*NOTES = SEE BELOW                                                    * 06610000
*                                                                     * 06620000
*   DEPENDENCIES = THE OPERATION OF THIS MODULE DEPENDS               * 06630000
*   UPON AN INTERNAL REPRESENTATION OF THE                            * 06640000
*   EXTERNAL CHARACTER SET WHICH IS EQUIVALENT TO                     * 06650000
*   THE ONE USED AT ASSEMBLY TIME. THE CODING HAS BEEN ARRANGED SO    * 06660000
*   THAT REDEFINITION OF 'CHARACTER' CONSTANTS,BY REASSEMBLY,WILL     * 06670000
*   RESULT IN A CORRECT MODULE FOR THE NEW DEFINITIONS.               * 06680000
*                                                                     * 06690000
*   RESTRICTIONS = NONE                                               * 06700000
*                                                                     * 06710000
*   REGISTER CONVENTIONS = SEE REGISTER ASSIGNMENTS                   * 06720000
*                                                                     * 06730000
*   PATCH LABEL = PATCH                                               * 06740000
*                                                                     * 06750000
*MODULE TYPE = PROCEDURE                                              * 06760000
*                                                                     * 06770000
*   PROCESSOR = ASSEMBLER XF                                          * 06780000
*                                                                     * 06790000
*   MODULE SIZE = 740 DECIMAL BYTES                                   * 06800000
*                                                                     * 06810000
*   ATTRIBUTES = REUSABLE                                             * 06820000
*                                                                     * 06830000
*ENTRY POINT = IEDQNF                                                 * 06840000
*                                                                     * 07200020
*     PURPOSE = SEE FUNCTION                                          * 07250000
*                                                                     * 07300000
*     LINKAGE = RECEIVES CONTOL FROM THE OPERATING SYSTEM AS A        * 07350000
*               RESULT OF AN ATTACH MACRO ISSUED BY IEDQND.           * 07400000
*               REGISTER 15 HAS THE ENTRY POINT ADDRESS.              * 07450000
*                                                                     * 07800020
*INPUT = REGISTER 1 CONTAINS THE ADDRESS OF THE AVT                   * 07870000
*        REGISTER 13 CONTAINS THE CALLER'S SAVEAREA ADDRESS           * 07940000
*        REGISTER 15 CONTAINS THE ENTRY POINT ADDRESS                 * 08010000
*                                                                     * 09300020
*OUTPUT:NONE                                                          * 09600020
*                                                                     * 13800020
*EXITS-NORMAL:THIS MODULE EXITS TO OS IN ONE OF TWO WAYS:             * 14100020
*                                                                     * 14400020
*   1.WAIT-THERE ARE NO OUTSTANDING REQUEST ON THE CHECKPOINT QCB.    * 14700020
*   2.RETURN-THERE ARE NO OUTSTANDING REQUEST ON THE CHECKPOINT       * 15000020
*     QCB AND THE CLOSEDOWN COMPLETION BIT IS ON IN THE ENVIRONMENT   * 15300020
*     CHECKPOINT REQUEST ELEMENT.                                     * 15600020
*                                                                     * 15900020
*EXITS-ERROR:NONE                                                     * 16200020
*                                                                     * 16500020
*EXTERNAL REFERENCES = SEE BELOW                                      * 16507000
*                                                                     * 16514000
*   ROUTINES = SEE BELOW                                              * 16521000
*        'IEDQNG'-BUILDS INCIDENT RECORD FOR MH MACRO                 * 16528000
*        'IEDQNH'-BUILDS INCIDENT RECORD FOR TCHNG MACRO              * 16535000
*        'IEDQNJ'-BUILDS INCIDENT RECORD FOR OP.CONTROL COMMAND       * 16542000
*        'IEDQNK'-BUILDS ENVIRONMENT RECORD                           * 16549000
*        'IEDQNM'-BUILDS CKREQ RECORD                                 * 16556000
*        'IEDQNO'-MANAGES CHECKPOINT I/O QUEUE                        * 16563000
*        'IEDQNP'-WRITES CHECKPOINT RECORDS ON DISK                   * 16570000
*        'IEDQNQ'-ISSUES FREEMAINS AND NOTIFIES COMPLETION OF A       * 16577000
*                 CHECKPOINT                                          * 16584000
*        'IEDQNR'-TAKES CARE OF INSUFFICIENT CORE SITUATION           * 16591000
*        'IEDQNS'-TAKES CARE OF INCIDENT OVERFLOW                     * 16598000
*        'IEDQNT'-TAKES 3705 CHECKPOINTS - LOAD 1                     * 16605000
*        'IEDQNU'-TAKES 3705 CHECKPOINTS - LOAD 2                     * 16608000
*        'IEDQNV'-READS 3705 RESTART RECORDS                          * 16612000
*                                                                     * 16619000
*   DATA AREAS = CHECKPOINT WORKAREA                                  * 16626000
*               REQUEST ELEMENTS                                      * 16633000
*                                                                     * 16640000
*   CONTROL BLOCKS = AVT                                              * 16647000
*                    CAVT                                             * 16654000
*                    DCB                                              * 16661000
*                    DEB                                              * 16668000
*                    TCB                                              * 16675000
*                                                                     * 16682000
*TABLES = NONE                                                        * 16689000
*                                                                     * 16696000
*MACROS = DELETE                                                      * 16703000
*         IEDHJN                                                      * 16710000
*         LOAD                                                        * 16717000
*         RETURN                                                      * 16724000
*         SAVE                                                        * 16731000
*         WAIT                                                        * 16738000
*                                                                     * 16745000
*CHANGE ACTIVITY = SEE BELOW                                          * 16752000
*A-000000-999999                                              @Y16X5C0* 16759000
*A324000,483000,783000                                          A42413* 16766000
*C345000,486000                                                 A42413* 16773000
*A435000                                                       SA60802* 16780000
*A267000,324000,336000,360000,390000,405000,423000,429000     @Y17XACL* 16780500
*A495000,528000,546000,558000,588000,609000,627000,639000     @Y17XACL* 16781000
*A645000,665000,687000,711000,720000,726000,744000,777000     @Y17XACL* 16781500
*A786000,789000                                               @Y17XACL* 16782000
*C279000,312000                                               @Y17XACL* 16782500
*D270000,273000,285000,303000,354000,366000-381000            @Y17XACL* 16783000
*D393000-402000,426000,480000-488400,493000,498000,501000     @Y17XACL* 16783500
*D531000-537000,549000,552000,561000-570000,591000,594000     @Y17XACL* 16784000
*D612000,615000,630000,633000,642000,648000,651000,672000     @Y17XACL* 16784500
*D675000,690000-705000,714000,723000,729000,732000,747000     @Y17XACL* 16785000
*D780000,783000                                               @Y17XACL* 16785500
*A325000,534000,537000,720000,735000,777000                    @OY15469 16785600
*D483600-488400,576000,606000,624000,633000,645000,783000      @OY15469 16785700
*C033000,039000,051000-054000,252000-261000                    @OY15469 16785800
*A478000,492000,790740                                         @G36XRCU 16785900
*                                                                     * 16786000
*A391170,529400                                                @OZ31115 16786182
*C390060-390090,391890,777100                                  @OZ31115 16786282
*A547800,558000                                                @OY20868 16786382
*********************************************************************** 26700020
         EJECT                                                 @Y17XACL 26740000
*********************************************************************** 26780000
*                                                                     * 26820000
*        REGISTER ASSIGNMENTS                                         * 26860000
*                                                                     * 26900000
*********************************************************************** 26940000
         SPACE                                                          27600020
R0       EQU   0                        WORK REGISTER          @Y17XACL 27900000
R1       EQU   1                        WORK REGISTER          @Y17XACL 28000000
RCKPT    EQU   2                        ADDRESS OF TCAM CKPT   @Y17XACL 28100000
*                                       WORKAREA               @Y17XACL 28200000
R3       EQU   3                        ADDRESS OF REQUEST ELEMENT      28800020
R4       EQU   4                        ADDR OF LAST DISK RCD BUILT     29100020
R5       EQU   5                        ADDRESS OF LOAD LIST            29400020
R6       EQU   6                        BAL REG                         29700020
R7       EQU   7                        INDEX INTO LOAD LIST            30000020
R8       EQU   8                        INDEX INTO LOAD LIST            30300000
RAVT     EQU   9                        ADDRESS OF AVT                  30600020
R11      EQU   11                       WORK REGISTER          @Y17XACL 31200000
RBASE    EQU   12                       BASE REG                        31500020
R13      EQU   13                       SAVE AREA                       31800020
R14      EQU   14                       RETURN ADDRESS                  32100020
R15      EQU   15                       ENTRY POINT OR RETURN CODE      32400020
ZERO     EQU   0                        DISPLACEMENT           @OY15469 32410000
TWO      EQU   2                        LENGTH OR DISPLACEMENT @OY15469 32420000
THREE    EQU   3                        LENGTH                 @OY15469 32500000
FOUR     EQU   4                        LENGTH OR DISPLACEMENT @OY15469 32580000
FIVE     EQU   5                        DISPLACEMENT           @OY15469 32660000
EIGHT    EQU   8                        DISPLACEMENT           @OY15469 32740000
         EJECT                                                 @Y17XACL 32820000
*********************************************************************** 32900000
*                                                                     * 32980000
*        STANDARD LINKAGE                                             * 33060000
*                                                                     * 33140000
*********************************************************************** 33220000
         SPACE                                                          33300020
         USING *,R15                    TEMPORARY BASE                  33600020
         USING IEDQCKPD,RCKPT           TCAM CKPT WORKAREA     @Y17XACL 33660000
*                                       ADDRESSABILITY         @Y17XACL 33720000
         USING IEDQCRED,R3              BASE FOR REQUEST ELEMENT        33780000
         USING IEDQAVTD,RAVT            AVT ADDRESSABILITY     @Y17XACL 33840000
IEDQNF   IEDHJN SKIPID                  MODIFICATION DATE        S21903 33900005
         SAVE  (14,12)                                                  35100020
         LR    RAVT,R1                  ADDRESS OF AVT PASSED AS PRM416 36000000
         ST    R13,SAVE13               SAVE REGISTER 13       @Y17XACL 36300000
         LR    RBASE,R15                SET BASE REG                    38400020
         DROP  R15                                                      38700020
         USING IEDQNF,RBASE                                             39000020
         SPACE 2                                               @Y17XACL 39003000
         XC    IEDQCKAD(CAVTSIZE-FOUR),IEDQCKAD  CLEAR CKPT AVT@OZ31115 39006082
         LA    RCKPT,IEDQCKAD           GET ADDR OF CKPT AVT   @Y17XACL 39012000
         STCM  RCKPT,B'0111',AVTCKAVT   SAVE ADDR OF CAVT      @Y17XACL 39015000
         SLR   RCKPT,RCKPT              CLEAR TCAM CKPT        @Y17XACL 39018000
*                                       WORKAREA POINTER       @Y17XACL 39021000
         TM    AVTCKFLG,AVTCKTAC        IS TCAM CKPT ACTIVE    @Y17XACL 39024000
         BZ    QNF06                    NO, BRANCH             @Y17XACL 39027000
         EJECT                                                 @Y17XACL 39030000
*********************************************************************** 39033000
*                                                                     * 39036000
*        TCAM CHECKPOINT IS ACTIVE. FIND THE CHECKPOINT DEB ON        * 39039000
*        THE TCAM DEB CHAIN AND GET THE TCAM CHECKPOINT WORKAREA      * 39042000
*        ADDRESS. SET UP THE ECB WAIT LIST FOR TCAM CHECKPOINT.       * 39045000
*                                                                     * 39048000
*********************************************************************** 39051000
         L     R1,AVTTCB                GET TCAM TCB ADDRESS   @Y17XACL 39054000
         USING IEDQTCB,R1               TCB ADDRESSABILITY     @Y17XACL 39057000
         LA    R1,TCBDEB-(DEBDEBAD-DEBNMSUB) GET ADDR OF       @Y17XACL 39060000
*                                       TCAM DEB CHAIN AS      @Y17XACL 39063000
*                                       AS DUMMY 1ST DEB       @Y17XACL 39066000
         USING DEBNMSUB,R1              DEB ADDRESSABILITY     @Y17XACL 39069000
         USING IHADCB,R5                DCB ADDRESSABILITY     @Y17XACL 39072000
QNF02    EQU   *                                               @Y17XACL 39075000
         L     R1,DEBDEBAD              GET ADDR OF NEXT DEB   @Y17XACL 39078000
         L     R5,DEBDCBAD              GET DCB ADDRESS        @Y17XACL 39081000
         TM    DCBDSRG2,DCBDSGTQ        IS THIS A TCAM QUEUE   @Y17XACL 39084000
*                                       DATA SET               @Y17XACL 39087000
         BZ    QNF02                    NO, BRANCH             @Y17XACL 39090000
         TM    DCBOPTCD,CHECKPT         IS THIS THE TCAM       @Y17XACL 39093000
*                                       CKPT DCB               @Y17XACL 39096000
         BZ    QNF02                    NO, BRANCH             @Y17XACL 39099000
         L     RCKPT,DCBIOBAD           GET THE TCAM CKPT      @Y17XACL 39102000
*                                       WORKAREA ADDRESS       @Y17XACL 39105000
         LA    RCKPT,0(,RCKPT)          CLEAR HI BYTE          @Y17XACL 39108000
         ST    RCKPT,CAVTTCWA           PUT WORKAREA ADDR IN   @Y17XACL 39111000
*                                       THE CAVT               @Y17XACL 39114000
         ST    R13,CKPSAVE1+4           SAVE CALLER'S R13      @Y17XACL 39117000
         SR    R7,R7                    CLEAR REGISTER         @OZ31115 39117182
         IC    R7,AVTNCKPR              GET NUMBER OF CKREQ Q'S@OZ31115 39117282
         LTR   R6,R7                    CHECK FOR CKREQ=0      @OZ31115 39117382
         BZ    QNF03                    BRANCH IF ZERO         @OZ31115 39117482
         LA    R7,CKPCKRNO(0,R7)        NUMBER OF EXTRA RECORDS@OZ31115 39117582
*                                        (TO USE IN CASE OF    @OZ31115 39117682
*                                        DISK ERROR)           @OZ31115 39117782
         LA    R6,CKPCTTRL              CKREQ TTR ENTRY LENGTH @OZ31115 39117882
         MR    R6,R6                    NUMBER OF BYTES FOR    @OZ31115 39117982
*                                        CKREQ TTR TABLE       @OZ31115 39118082
QNF03    EQU   *                                               @OZ31115 39118182
         LA    R5,CKPLNGTH(0,R7)        FIXED WORK AREA LENGTH @OZ31115 39118282
         IC    R6,AVTCPRCD              NUMBER OF ENV RCDS     @OZ31115 39118382
         LA    R7,CKPTTRLN              LENGTH FOR EACH TTR    @OZ31115 39118482
         MR    R6,R6                    LENGTH FOR ALL RCDS    @OZ31115 39118582
         AR    R5,R7                    ADD TO TOTAL LENGTH    @OZ31115 39118682
         STH   R5,CAVTCKTR              SAVE CKPT TRACE OFFSET @OZ31115 39118782
QNF05    EQU   *                                               @OZ31115 39118882
         LA    R5,CKPSAVE1              GET CKPT SAVEAREA ADDR @Y17XACL 39120000
         ST    R5,8(R13)                SAVE CKPT SAVE AREA    @Y17XACL 39123000
*                                       ADDR IN IT'S SAVEAREA  @Y17XACL 39126000
         LA    R5,AVTCKPEC              GET ADDR OF ECB FOR    @Y17XACL 39129000
*                                       TCAM CKPT QUEUE        @Y17XACL 39132000
         ST    R5,CAVTTQE               SAVE ECB ADDR IN THE   @Y17XACL 39135000
*                                       WAIT LIST              @Y17XACL 39138000
         LA    R5,CKPECB                GET ADDR OF ECB FOR    @Y17XACL 39141000
*                                       TCAM CKPT I/O          @Y17XACL 39144000
         STCM  R5,B'0111',CAVTTIOE      SAVE ECB ADDR IN THE   @Y17XACL 39147000
*                                       WAIT LIST              @Y17XACL 39150000
         MVI   CKPECB,0                 CLEAR ECB COMPLETION   @Y17XACL 39153000
         DROP  R1,R5                                           @Y17XACL 39156000
         EJECT                                                 @Y17XACL 39159000
*********************************************************************** 39162000
*                                                                     * 39165000
*        IF 3705 CHECKPOINT IS NOT ACTIVE, THEN SET END OF LIST       * 39168000
*        IN THE WAIT LIST. OTHERWISE, PUT THE 3705 CHECKPOINT         * 39171000
*        QUEUE ECB ADDRESS IN THE WAIT LIST AND SET END OF LIST.      * 39174000
*                                                                     * 39177000
*********************************************************************** 39180000
QNF06    EQU   *                                               @Y17XACL 39183000
         TM    AVTCKFLG,AVTCKNAC        IS 3705 CKPT ACTIVE    @Y17XACL 39186000
         BNO   QNF07                    NO, BRANCH             @OZ31115 39189082
         SR    R5,R5                    CLEAR REGISTER         @OZ31115 39189482
         LA    R5,CKPLNGTH+CKPTTRLN     MINIMUM AREA SIZE      @OZ31115 39189882
         STH   R5,CAVTCKTR              SAVE CKPT TRACE OFFSET @OZ31115 39190282
         B     QNF08                    BRANCH                 @OZ31115 39190682
QNF07    EQU   *                                               @OZ31115 39191082
         MVI   CAVTEOL1,EOL             SET END-OF-LIST IN     @Y17XACL 39192000
*                                       THE WAIT LIST          @Y17XACL 39195000
         B     QNF10                    SCAN FOR WORK TO DO    @Y17XACL 39198000
         SPACE 2                                               @Y17XACL 39201000
QNF08    EQU   *                                               @Y17XACL 39204000
         L     R5,AVTSAVTP              GET SECONDART AVT ADDR @Y17XACL 39207000
         LA    R5,SAVTCKEC-IEDNSVTD(,R5) GET ADDR OF ECB FOR   @Y17XACL 39210000
*                                       THE 3705 CKPT QUEUE    @Y17XACL 39213000
         STCM  R5,B'0111',CAVTNQE       SAVE ECB ADDR IN THE   @Y17XACL 39216000
*                                       WAIT LIST              @Y17XACL 39219000
         MVI   CAVTEOL2,EOL             SET END-OF-LIST IN THE @Y17XACL 39222000
*                                       WAIT LIST              @Y17XACL 39225000
         SPACE 1                                               @Y17XACL 39225600
*                                       LOAD THE 3705 CKPT/    @Y17XACL 39226200
         LOAD  EPLOC=IEDQNW             RESTART I/O ROUTINE    @Y17XACL 39226800
         ST    R0,CAVTCRIO              SAVE ADDR OF ROUTINE   @Y17XACL 39227400
         EJECT                                                 @Y17XACL 39228000
*********************************************************************** 39231000
*                                                                     * 39234000
*        CHECK FOR 3705 CHECKPOINT I/O COMPLETE.                      * 39237000
*                                                                     * 39240000
*********************************************************************** 39243000
QNF10    EQU   *                                                        40500020
         ICM   R5,B'0111',CAVTNIOE      IS 3705 CKPT I/O       @Y17XACL 40510000
*                                       STARTED                @Y17XACL 40520000
         BZ    QNF12                    NO, BRANCH             @Y17XACL 40530000
         TM    ECBCC(R5),CKPPOST        IS ECB POSTED COMPLETE @Y17XACL 40540000
         BZ    QNF12                    NO, BRANCH             @Y17XACL 40550000
         SLR   R7,R7                    CLEAR INDEX REGISTER   @Y17XACL 40560000
         IC    R7,CAVTWTG               SET KEY SAVED BY 3705  @Y17XACL 40570000
*                                       CKPT/RESTART I/O       @Y17XACL 40580000
*                                       ROUTINES               @Y17XACL 40590000
         B     QNF20                    GO LOAD ROUTINE        @Y17XACL 40600000
         SPACE 2                                               @Y17XACL 40610000
*********************************************************************** 40620000
*                                                                     * 40630000
*        CHECK FOR TCAM CKPT I/O.                                     * 40640000
*                                                                     * 40650000
*********************************************************************** 40660000
QNF12    EQU   *                                               @Y17XACL 40670000
         TM    AVTCKFLG,AVTCKTAC        IS TCAM CKPT ACTIVE    @Y17XACL 40680000
         BZ    QNF15                    NO, BRANCH             @Y17XACL 40690000
         TM    CKPECB,CKPPOST           CHECK FOR POSTED DISK IOB       40800020
         BO    QNF35                    BRANCH IF I/O COMPLETED         41100020
         SPACE                                                          41400020
         L     R3,CKPEXCP               CHECK FOR EXCP ISSUED           41700020
         LTR   R3,R3                                                    42000020
         BZ    QNF70                    BRANCH IF NO I/O BEING DONE     42300020
         EJECT                                                 @Y17XACL 42330000
*********************************************************************** 42360000
*                                                                     * 42390000
*        CHECK FOR REQUEST ELEMENT ON THE 3705 CHECKPOINT/RESTART     * 42420000
*        QUEUE.                                                       * 42450000
*                                                                     * 42480000
*********************************************************************** 42510000
         SPACE 1                                               @Y17XACL 42540000
         USING IEDNSVTD,R5              SAVT ADDRESSABILITY    @Y17XACL 42570000
QNF15    EQU   *                                                        42900020
         TM    AVTCKFLG,AVTCKNAC        IS 3705 CKPT ACTIVE    @Y17XACL 42910000
         BZ    QNF17                    NO, BRANCH             @Y17XACL 42920000
         L     R5,AVTSAVTP              GET SAVT ADDR          @Y17XACL 42930000
         ICM   R3,B'0111',SAVTCKCH      GET REQUEST ELEMENT    @Y17XACL 42940000
*                                       FROM THE CHAIN         @Y17XACL 42950000
         CLI   CREPRI,0                 IS CHAIN EMPTY - I.E.  @Y17XACL 42960000
*                                       ONLY DUMMY END WITH    @Y17XACL 42970000
*                                       PRIORITY OF 0 IS ON    @Y17XACL 42980000
*                                       THE CHAIN              @Y17XACL 42990000
         BE    QNF17                    YES, BRANCH            @Y17XACL 43000000
         MVC   SAVTCKCH,CRELINK+1       REMOVE REQUEST ELEMENT @Y17XACL 43010000
*                                       FROM THE CHAIN         @Y17XACL 43020000
         L     R5,AVTOCGET              GET OPERATOR CONTROL   @Y17XACL 43021000
*                                       AVT ADDRESS            @Y17XACL 43022000
         L     R5,OPCCKPTF-IEDQOPCD(,R5) GETS ADDR OF OPCE     @Y17XACL 43023000
*                                       THAT NEEDS CKPT        @Y17XACL 43024000
         L     R5,OCCKPTWA-IEDQOPCE(,R5) GET 3705 CKPT         @Y17XACL 43025000
*                                       WORKAREA ADDRESS       @Y17XACL 43026000
         ST    R5,CAVTNWA               SAVE WORKAREA ADDRESS  @Y17XACL 43027000
         B     QNF19                    GO LOAD ROUTINE        @Y17XACL 43030000
         DROP  R5                                              @Y17XACL 43040000
         EJECT                                                 @Y17XACL 43050000
*********************************************************************** 43060000
*                                                                     * 43070000
*        CHECK FOR REQUEST ELEMENT ON THE TCAM CKPT QUEUE             * 43080000
*                                                                     * 43090000
*********************************************************************** 43100000
QNF17    EQU   *                                               @Y17XACL 43110000
         TM    AVTCKFLG,AVTCKTAC        IS TCAM CKPT ACTIVE    @Y17XACL 43120000
         BZ    QNF80                    NO, BRANCH             @Y17XACL 43130000
         L     R3,CKPLREB               GET LAST REQUEST ELEMENT       *43200020
                                        FOR WHICH RECORD WAS BUILT      43500020
         LA    R3,0(,R3)                CLEAR HIGH-ORDER BYTE   SA60802 43600005
         LTR   R3,R3                    CHECK FOR PREVIOUS RCD BLT      43800020
         LR    R11,R3                   SAVE PREVIOUS ELEMENT           44100020
         L     R3,4(R3)                 GET REQUEST EL FOR THIS RD      44400020
         BNZ   QNF18                    BRANCH IF THIS EL ISNT 1ST     *44700020
                                        ON QCB CHAIN TO BE BUILT        45000020
         L     R3,AVTCKPTB              GET 1ST ELEMENT ON QCB CHN      45300020
         LA    R11,AVTCKPTB-4           DUMMY PREVIOUS ELEMENT          45600020
QNF18    EQU   *                                                        45900020
         SPACE                                                          46200020
         CLI   4(R3),0                  CHECK FOR DUMMY LAST ELEMEN     46500020
         BE    QNF80                    BRANCH IF LAST ELEMENT          46800020
         CLI   CREKEY,CREREMVE          CHECK FOR TIME DELAY           X47100020
                                        REMOVAL ELEMENT                 47400020
         BNE   QNF19                    BRANCH IF NOT REMOVAL ELEM      47700020
         SPACE 1                                               @Y17XACL 47800000
*                                                              @G36XRCU 47900000
*        REMOVE TIME DELAY ELEMENT FROM QCB ELEMENT            @G36XRCU 48000000
*        CHAIN AND IGNORE                                      @G36XRCU 48100000
*                                                              @G36XRCU 48200000
         MODESET MODE=SUP               SET TO SUPERVISOR MODE @G36XRCU 48300000
         MODESET EXTKEY=SUPR            SET TO KEY 0           @G36XRCU 48400000
SETATSK  EQU   *                                               @G36XRCU 48500000
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,REGS=USE,               *48600000
               RELATED=ATTACHED-TASKS-IGG019RO(SETATSK)        @G36XRCU 48700000
         MVC   CRELINK+1-IEDQCRED(3,R11),CRELINK+1 MOVE LINK FIELD      48900020
         L     R3,CRELINK               GET NEXT ELEMENT                49200020
         SETLOCK RELEASE,TYPE=LOCAL,REGS=USE,                          *49260000
               RELATED=ATTACHED-TASKS-IEDQNF(SETATSK)          @G36XRCU 49320000
         MODESET EXTKEY=TCAM            SET TO TCAM KEY        @G36XRCU 49380000
         MODESET MODE=PROB              SET TO PROBLEM STATE   @G36XRCU 49440000
         B     QNF18                    PROCESS NEXT REQUEST ELEMEN     49500020
         EJECT                                                 @Y17XACL 49540000
*********************************************************************** 49580000
*                                                                     * 49620000
*        DETERMINE NEXT MODULE TO LOAD                                * 49660000
*                                                                     * 49700000
*********************************************************************** 49740000
         SPACE                                                          50400020
QNF19    EQU   *                                                        50700020
         SR    R7,R7                    CLEAR INDEX REG                 51000020
         SPACE                                                          51300020
         IC    R7,0(R3)                 GET KEY FIELD OF ELEMENT        51600020
         SRL   R7,1                     GET MULTIPLE OF 8               51900020
QNF20    EQU   *                                                        52200020
         SRL   R7,1                     DIVIDE BY 2                0525 52500020
         LA    R5,QNFLIST(R7)           ADDRESS OF LOAD MODULE NAME     52800020
         MVC   MOD,0(R5)                MOVE LAST 4 CHARS OF   @Y17XACL 52870000
*                                       NAME                   @Y17XACL 52940000
         CLC   ZERO(TWO,R5),MODNT       3705 CKPT MODULE       @OZ31115 52943082
         BL    TCAMCKPT                 NO, BRANCH             @OZ31115 52946082
         L     R8,CAVTNWA               3705 CKPT WORKAREA ADDR@OZ31115 52949082
         AH    R8,CAVTNTR               ADDR 3705 CKPT TRACE   @OZ31115 52952082
         B     TRACE                    PUT IN TRACE ENTRY     @OZ31115 52955082
TCAMCKPT EQU   *                                               @OZ31115 52958082
         L     R8,CAVTTCWA              TCAM CKPT WORKAREA ADDR@OZ31115 52961082
         AH    R8,CAVTCKTR              ADDR TCAM CKPT TRACE   @OZ31115 52964082
TRACE    EQU   *                                               @OZ31115 52967082
         LR    R15,R8                   SAVE REG               @OZ31115 52970082
         AH    R8,TWO(0,R8)             ADDR OF NEXT SPACE     @OZ31115 52973082
         MVC   ZERO(TWO,R8),ZERO(R5)    SAVE MODULE NAME       @OZ31115 52976082
         LH    R8,TWO(,R15)             OFFSET TO THAT SPACE   @OZ31115 52979082
         LA    R8,TWO(R8)               BUMP TO NEXT SPACE     @OZ31115 52982082
         CH    R8,ZERO(0,R15)           END OF TABLE REACHED   @OZ31115 52985082
         BL    QNF21                    NO, SAVE OFFSET        @OZ31115 52988082
         LA    R8,FOUR                  RESET TO START OF TRACE@OZ31115 52991082
QNF21    EQU   *                                               @OZ31115 52994082
         STH   R8,TWO(,R15)             SAVE NEW OFFSET        @OZ31115 52997082
         LA    R8,BRNCHTAB              ADDR OF MODULE LIST    @OY15469 53010000
COMPNAME EQU   *                                               @OY15469 53080000
         CLC   ZERO(TWO,R8),ZERO(R5)    COMPARE FOR NAME IN LST@OY15469 53150000
         BE    CKLOAD                   CK FOR BRNCH OR LOAD   @OY15469 53220000
         LA    R8,EIGHT(R8)             BUMP TO NXT ENTRY      @OY15469 53290000
         B     COMPNAME                 CHECK NEXT MEMBER      @OY15469 53360000
CKLOAD   EQU   *                                               @OY15469 53430000
         L     R15,FOUR(R8)             PICK UP BRNCH ENTRY    @OY15469 53500000
         LA    R15,ZERO(R15)            CLEAR HI BYTE          @OY15469 53570000
         LTR   R15,R15                  HAS IT BEEN USED       @OY15469 53640000
         BNZ   LOADMOD                  USE ENTRY POINT        @OY15469 53710000
LOAD     EQU   *                                               @OY15469 53780000
         LOAD  EPLOC=ROUTINE            LOAD NEXT ROUTINE      @Y17XACL 53850000
         ST    R0,FOUR(R8)              STORE ENTRY POINT ADDR @OY15469 53920000
         LR    R15,R0                   SET ENTRY REG                   54000020
LOADMOD  EQU   *                                               @OY15469 54100000
         BALR  R14,R15                                                  54300020
         SPACE                                                          54600020
*********************************************************************** 54630000
*                                                                     * 54660000
*        BRANCH TABLE FOR RETURN FROM LOAD MODULE                     * 54690000
*               +0 => LOAD MODULE WHOSE KEY IS IN R15                 * 54720000
*               +4 => GET NEXT REQUEST ELEMENT                        * 54750000
*               +8 => WAIT FOR I/O TO COMPLETE TO TRY GETMAIN AGAIN   * 54780000
*              +12 => OVERFLOW REQUEST                        @OY20868* 54790082
*                                                                     * 54810000
*********************************************************************** 54840000
         B     QNF40                    OFFSET FOR NEXT LOAD IN R15     55500020
         B     QNF50                    GET NEXT REQUEST ELEMENT        55800020
         B     QNF30                    WAIT ON DISK I/O       @OY20868 55807082
         B     QNF80                    INCIDENT OVERFLOW -WAIT@OY20868 55814082
*                                        IF CKPT IN PROGRESS   @OY20868 55821082
         SPACE 1                                               @Y17XACL 55830000
*********************************************************************** 55860000
*                                                                     * 55890000
*        GETMAIN WAS NOT SATISFIED BUT THERE ARE SOMEMORE GETMAIN     * 55920000
*        RECORDS ON THE I/O QUEUE. WAIT UNTIL THEY ARE COMPLETE,      * 55950000
*        TRY AGAIN.                                                   * 55980000
*                                                                     * 56010000
*********************************************************************** 56040000
QNF30    EQU   *                                                        57300020
         WAIT  ECB=CKPECB               WAIT ON DISK I/O ECB            57900020
QNF35    EQU   *                                                        58200020
         LA    R7,CKPNOTIF              GET LOAD LIST OFFSET            58500020
         B     QNF20                    LOAD NOTIFICATION RTN           58800020
         EJECT                                                 @Y17XACL 58840000
*********************************************************************** 58880000
*                                                                     * 58920000
*        ANOTHER LOAD MODULE IS NEEDED FOR THIS FUNCTION              * 58960000
*                                                                     * 59000000
*********************************************************************** 59040000
         SPACE                                                          59700020
QNF40    EQU   *                                                        60000020
         LR    R7,R15                   OFFSET OF LOAD MODULE NAME      60300020
         B     QNF20                    LOAD THE MODULE                 60900020
         SPACE 2                                               @Y17XACL 60940000
*********************************************************************** 60980000
*                                                                     * 61020000
*        THIS FUNCTION IS COMPLETE. DETERMINE NEXT FUNCTION           * 61060000
*                                                                     * 61100000
*********************************************************************** 61140000
         SPACE                                                          61800020
QNF50    EQU   *                                                        62100020
         B     QNF10                    DETERMINE NEXT FUNCTION         62700020
         SPACE 2                                               @Y17XACL 64530000
*********************************************************************** 64560000
*                                                                     * 64590000
*        CHECK FOR A RECORD ON THE DISK I/O QUEUE,IF SO, LOAD I/O     * 64620000
*        ROUTINE.                                                     * 64650000
*                                                                     * 64680000
*********************************************************************** 64710000
         SPACE                                                          65400020
QNF70    EQU   *                                                        65700020
         NC    CKPIOQF+1(3),CKPIOQF+1   CHECK FOR EMPTY QUEUE           66000020
         BZ    QNF15                    BRANCH IF NO ELEMENT            66300020
         LA    R7,CKPDIOR               OFFSET                          66600020
         B     QNF20                    MOVE NAME AND LOAD              66900020
         EJECT                                                 @Y17XACL 66940000
*********************************************************************** 66980000
*                                                                     * 67020000
*        THERE IS NOTHING TO DO WAIT ON BOTH ECB'S OR TERMINATE       * 67060000
*                                                                     * 67100000
*********************************************************************** 67140000
         SPACE                                                          67800020
QNF80    EQU   *                                                        68100020
         TM    AVTCKELF,AVTCCLCN        CHECK CLOSEDOWN COMP. BIT       68400020
         BO    QNF90                    BRANCH IF ON-TERMINATE          68700020
         SPACE 1                                               @Y17XACL 68710000
         LA    R1,CAVTWL1               GET WAIT LIST ADDR     @Y17XACL 68720000
         TM    AVTCKFLG,AVTCKTAC        IS TCAM CKPT ACTIVE    @Y17XACL 68730000
         BO    QNF87                    YES, BRANCH            @Y17XACL 68740000
         LA    R1,CAVTWL2               GET WAIT LIST ADDR FOR @Y17XACL 68750000
*                                       ONLY 3705 CKPT ACTIVE  @Y17XACL 68760000
         SPACE 1                                               @Y17XACL 68770000
QNF87    EQU   *                                               @Y17XACL 68780000
         WAIT  ECBLIST=(1)              WAIT                   @Y17XACL 68790000
         MVI   AVTCKPCC,0               CLEAR ECB COMPLETION   @Y17XACL 68800000
*                                       FOR TCAM CKPT QUEUE    @Y17XACL 68810000
         TM    AVTCKFLG,AVTCKNAC        IS 3705 CKPT ACTIVE    @Y17XACL 68820000
         BZ    QNF10                    NO, BRANCH             @Y17XACL 68830000
         L     R5,AVTSAVTP              GET SAVT ADDR          @Y17XACL 68840000
         MVI   SAVTCKCC-IEDNSVTD(R5),0  CLEAR ECB COMPLETION   @Y17XACL 68850000
*                                       FOR 3705 CKPT QUEUE    @Y17XACL 68860000
         B     QNF10                    DETERMINE WHAT TO DO            70800020
         EJECT                                                 @Y17XACL 71100000
*********************************************************************** 71150000
*                                                                     * 71200000
*        MCP HAS CLOSED DOWN.TERMINATE THIS ATTACHED SUBTASK.         * 71250000
*                                                                     * 71300000
*********************************************************************** 71350000
         SPACE                                                          71700020
QNF90    EQU   *                                                        72000020
         LA    R8,BRNCHTAB-EIGHT        START OF TABLE         @OY15469 72010000
LOOPDELE EQU   *                                               @OY15469 72050000
         LA    R8,EIGHT(R8)             POINT TO NEXT MODULE   @OY15469 72070000
         CLI   ZERO(R8),AVTEFF          END OF TABLE           @OY15469 72100000
         BE    QNF95                    YES                    @OY15469 72140000
         CLC   FIVE(THREE,R8),AVTFZERO  NEED TO DELETE MODULE? @OY15469 72180000
         BNE   DELETE                   YES                    @OY15469 72220000
         B     LOOPDELE                 CHECK IF NEED TO DELETE@OY15469 72260000
DELETE   EQU   *                                               @OY15469 72300000
         MVC   MOD(FOUR),ZERO(R8)           MOD NAME TO DELETE @OY15469 72340000
         DELETE EPLOC=ROUTINE            DELETE THE MODULE     @OY15469 72380000
         B     LOOPDELE                 GET NEXT MODULE        @OY15469 72420000
QNF95    EQU   *                                               @OY15469 72460000
         L     R13,SAVE13               RESTORE CALLER'S R13   @Y17XACL 72500000
         RETURN (14,12),T                                               72600020
         EJECT                                                 @Y17XACL 72610000
*********************************************************************** 72620000
*                                                                     * 72630000
*        EQUATES AND DATA DEFINTIONS                                  * 72640000
*                                                                     * 72650000
*********************************************************************** 72660000
         SPACE 1                                               @Y17XACL 72670000
CHECKPT  EQU   X'20'                    TCAM CKPT DCB          @Y17XACL 72680000
EOL      EQU   X'80'                    END OF LIST INDICATOR  @Y17XACL 72690000
ECBCC    EQU   0                        OFFSET OF ECB          @Y17XACL 72700000
*                                       COMPLETION BYTE IN AN  @Y17XACL 72710000
*                                       ECB                    @Y17XACL 72720000
         SPACE 3                                               @Y17XACL 72730000
SAVE13   DS    A                        FULLWORD TO SAVE THE   @Y17XACL 72740000
*                                       CONTENTS OF REG 13     @Y17XACL 72750000
*                                       AT ENTRY TO THE MODULE @Y17XACL 72760000
*                                       AT ATTACH TIME         @Y17XACL 72770000
         SPACE 1                                               @Y17XACL 72780000
         DS    0D                                              @Y17XANL 72781000
IEDQNW   DC    CL8'IEDQNW'              LOAD NAME FOR 3705 I/O @Y17XACL 72782000
*                                       ROUTINE                @Y17XACL 72783000
         SPACE 1                                               @Y17XACL 72784000
ROUTINE  DS    0CL8                     NAME USED FOR LOADS    @Y17XACL 72785000
*                                       AND DELETES            @Y17XACL 72800000
         DC    CL4'IEDQ'                FIXED CHARACTERS       @Y17XACL 72810000
MOD      DC    CL4' '                   VARIABLE CHARACTERS    @Y17XACL 72820000
         EJECT                                                 @Y17XACL 72830000
*********************************************************************** 72840000
*                                                                     * 72850000
*        LIST OF ALL CHECKPOINT LOAD MODULE NAMES                     * 72860000
*                                                                     * 72870000
*********************************************************************** 72880000
         SPACE                                                          73500020
         CNOP  0,4                                             @OY15469 73600000
QNFLIST  EQU   *                                                        73800020
         DC    CL4'NG'                  LCB                        0525 74100020
         DC    CL4'NH'                  TCHNG                      0525 74400020
         DC    CL4' '                   UNUSED                 @Y17XACL 74500000
         DC    CL4' '                   UNUSED                     0525 75000020
         DC    CL4'NJ'                  OPERATOR CONTROL           0525 75300020
         DC    CL4'NK'                  MCPLOSE                    0525 75600020
         DC    CL4'NM'                  CKREQ                      0525 75900020
         DC    CL4'NK'                  ENVIORNMENT                0525 76200020
         DC    CL4'NO'                  I/O QUEUE MANAGER          0525 76500020
         DC    CL4'NP'                  I/O ROUTINE                0525 76800020
         DC    CL4'NQ'                  NOTIFICATION ROUTINE       0525 77100020
         DC    CL4'NR'                  NO CORE                    0525 77400020
         DC    CL4'NS'                  INCIDENT OVERFLOW          0525 77700020
MODNT    DC    CL4'NT'                  3705 CHECKPOINT-LOAD 1 @OZ31115 77710082
         DC    CL4'NV'                  3705 RESTART           @Y17XACL 77720000
         DC    CL4'NU'                  3705 CHECKPOINT-LOAD 2 @Y17XACL 77725000
BRNCHTAB EQU   *                                               @OY15469 77727000
         DC    CL4'NG',XL4'0'           LCB                    @OY15469 77730000
         DC    CL4'NH',XL4'0'           TCHNG                  @OY15469 77750000
         DC    CL4'NJ',XL4'0'           OPERATOR CONTROL       @OY15469 77770000
         DC    CL4'NK',XL4'0'           ENVIRONMENT            @OY15469 77790000
         DC    CL4'NM',XL4'0'           CKREQ                  @OY15469 77810000
         DC    CL4'NO',XL4'0'           I/O QUEUE MANAGER      @OY15469 77830000
         DC    CL4'NP',XL4'0'           I/O ROUTINE            @OY15469 77850000
         DC    CL4'NQ',XL4'0'           NOTIFICATION ROUTINE   @OY15469 77870000
         DC    CL4'NR',XL4'0'           NO CORE                @OY15469 77890000
         DC    CL4'NS',XL4'0'           INCIDENT OVERFLOW      @OY15469 77910000
         DC    CL4'NT',XL4'0'           3705 CHECKPOINT-LOAD 1 @OY15469 77920000
         DC    CL4'NU',XL4'0'           3705 RESTART           @OY15469 77940000
         DC    CL4'NV',XL4'0'           3705 CHECKPOINT-LOAD 2 @OY15469 77960000
         DC    X'FF'                                           @OY15469 77980000
         EJECT                                                 @Y17XACL 78000000
*********************************************************************** 78020000
*                                                                     * 78040000
*        THIS MODULE CREATES THE CHECKPOINT AVT BY ISSUING THE        * 78060000
*        TCAVTD MACRO WITH THE DSECT=NO OPERAND. THIS GENERATES       * 78080000
*        STORAGE FOR THE CAVT. THIS MODULE CLEARS THE CAVT AT         * 78100000
*        ATTACH TIME.                                                 * 78120000
*                                                                     * 78140000
*********************************************************************** 78160000
         SPACE 1                                               @Y17XACL 78180000
         TCAVTD DSECT=NO                                       @Y17XACL 78200000
         EJECT                                                 @Y17XACL 78220000
*********************************************************************** 78240000
*                                                                     * 78260000
*        THE FOLLOWING IS A PATCH AREA WHICH IS AVAILABLE TO ALL      * 78280000
*        THE MODULES IN THE CHECKPOINT SUBTASK.                       * 78300000
*                                                                     * 78320000
*********************************************************************** 78340000
PATCH    DC    50H'0'                    PATCH AREA            @Y17XACL 78360000
         EJECT                                                 @Y17XACL 78380000
         TAVTD                                                          78600020
         EJECT                                                 @Y17XACL 78700000
         TCKPD 3330                                                     78900000
         EJECT                                                 @Y17XACL 78930000
         DCBD  DSORG=(TX,TR)                                   @Y17XACL 78960000
         EJECT                                                 @Y17XACL 78990000
         TDEBD                                                 @Y17XACL 79020000
         EJECT                                                 @Y17XACL 79050000
         TOPCED                                                @Y17XACL 79056000
         EJECT                                                 @Y17XACL 79062000
         TOPCAVTD                                              @Y17XACL 79068000
         EJECT                                                 @Y17XACL 79074000
         IHAPSA                    DSECT FOR SETLOCK           @G36XRCU 79076000
         EJECT                                                          79078000
         TTCBD                                                 @Y17XACL 79080000
         SPACE 3                                               @Y17XACL 79110000
         END                                                            79200020
                                                                        82200000
                                                                        85200000
./  ADD  SSI=63630034,NAME=IEDQNG
QNG      TITLE 'IEDQNG  -BUILD INCIDENT RECORD FOR CHECKPT MACRO'       00400020
IEDQNG   CSECT                                                          00800020
         SPACE 3                                                        01200020
*********************************************************************** 01600020
*                                                                     * 02000020
*TITLE: 'IEDQNG'-INCIDENT CHECKPOINT FOR AN MH MACRO-CHECKPT          * 02400020
*                                                                     * 02800020
*STATUS:CHANGE LEVEL 0                                                * 03200020
*                                                                     * 03600020
*FUNCTION:THIS MODULE BUILDS AN INCIDENT DISK RECORD WHEN THE         * 04000020
*   REQUEST ELEMENT ON THE CHECKPOIN QCB IS AN LCB FROM A CHECKPT     * 04400020
*   MACRO. IT DETERMINES THE TERMINAL CURRENTLY ASSOCIATED WITH THE   * 04800020
*   LCB(IF THE CHECKPT MACRO IS IN THE IN MH,IT IS THE SOURCE TERMINAL* 05200020
*   IF IT IS IN THE OUT MH, IT IS THE DESTINATION TERMINAL.) IF       * 05600020
*   LCBTTCIN IS ZERO THE TERMINAL ENTRY CANNOT BE IDENTIFIED SO AN    * 06000020
*   INCIDENT CHECKPOINT                                               * 06400020
*  RECORD IS NOT BUILT. A BIT IS TURNED ON IN CKPLREB AND THE OFFSET *  06800020
*   OF THE NOTIFICATION ROUTINE IS RETURNED IN REGISTER 15.           * 07200020
*                                                                     * 07600020
*ENTRY POINT:                                                         * 08000020
*                                                                     * 08400020
*        IEDQNG                                                       * 08800020
*                                                                     * 09200020
*INPUT:REGISTERS 2,3,9,12,14,15 CONTAIN THE FOLLOWING:                * 09600020
*                                                                     * 10000020
*   2-ADDRESS OF THE CHECKPOINT WORK AREA                             * 10400020
*   3-ADDRESS OF REQUEST ELEMENT THIS MODULE IS TO PROCESS            * 10800020
*   9-ADDRESS OF AVT                                                  * 11200020
*   12-BASE REGISTER FOR CHECKPOINT EXECUTOR-IEDQNF                   * 11600020
*   14-RETURN ADDRESS-IN IEDQNF                                       * 12000020
*   15-ENTRY POINT FOR THIS MODULE                                    * 12400020
*                                                                     * 12800020
*   THE LCB(REQUEST ELEMENT) POINTED TO BY R3.                        * 13200020
*                                                                     * 13600020
*OUTPUT:THE ABOVE REGISTERS 2-14 REMAIN THE SAME(R15 MAY HAVE A       * 14000020
*   RETURN CODE).                                                     * 14400020
*                                                                     * 14800020
*   AN INCIDENT DISK RECORD IS BUILT IN A GETMAIN AREA.(ITS ADDRESS   * 15200020
*   IS IN CKPLDRB.)                                                   * 15600020
*                                                                     * 16000020
*EXTERNAL ROUTINES:                                                   * 16400020
*        IEDQTNT-DETERMINES TERMINAL TABLE ADDRESS                    * 16800020
*                                                                     * 17200020
*EXITS-NORMAL:THIS MODULE RETURNS TO THE ADDRESS IN R14. R15 HAS AN   * 17600020
*   OFFSET FOR THE CHECKPOINT QUENE MANAGER(72) OR THE INCIDENT       * 18000020
*   OVERFLOW ROUTINE(96) OR THE NOTIFICATION ROUTINE(80).             * 18400020
*                                                                     * 18800020
*EXITS ERROR:THIS MODULE RETURNS TO THE ADDRESS IN R14. R15 HAS AN    * 19200020
*   OFFSET FOR THE NO CORE ROUTINE(88).                               * 19600020
*                                                                     * 20000020
*TABLES/WORK AREAS:                                                   * 20400020
*                                                                     * 20800020
*   AVT(AVTCLRHI,AVTRNMPT,AVTOPTPT)                                   * 21200020
*   CHECKPOINT WORK AREA                                              * 21600020
*   TERMNAME TABLE                                                    * 22000020
*   TERMINAL TABLE                                                    * 22400020
*   OPTION TABLE                                                      * 22800020
*   OPTION LENGTH TABLE                                               * 23200020
*                                                                     * 23600020
*ATTRIBUTES:REENTERABLE                                               * 24000020
*                                                                     * 24400020
*NOTES:THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL REPRE-   * 24800020
*   SENTATION OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT TO    * 25200020
*   THE ONE USED AT ASSEMBLY TIME. THE CODING HAS BEEN ARRANGED SO    * 25600020
*   THAT REDEFINITION OF 'CHARACTER' CONSTANTS,BY REASSEMBLY,WILL     * 26000020
*   RESULT IN A CORRECT MODULE FOR THE NEW DEFINITIONS.               * 26400020
*                                                                     * 26800020
*********************************************************************** 27200020
         SPACE 3                                                        27600020
*REGISTER ASSIGNMENTS                                                   28000020
         SPACE                                                          28400020
R0       EQU   0                                                        28800020
R1       EQU   1                        PARM REGISTER-OR WORK REG       29200020
R2       EQU   2                        ADDRESS OF CKPT WORK AREA       29600020
R3       EQU   3                        ADDRESS OF REQUEST ELEMENT      30000020
R4       EQU   4                        ADDRESS OF DISK RECORD          30400020
R5       EQU   5                        ADDRESS OF OPTION ENTRY         30800020
R6       EQU   6                        INDEX REG                       31200020
R7       EQU   7                        OFFSET TO TERMNAME TABLE        31600020
RTERM    EQU   8                        ADDRESS OF TERM. TABLE ENTRY    32000020
RAVT     EQU   9                        ADDRESS OF AVT                  32400020
R10      EQU   10                       LENGTH FOR MOVE(OPTN ENTRY)     32800020
R11      EQU   11                       COUNT OF TERMNAME ENTRIES       33200020
RBASE    EQU   12                       BASE REG                        33600020
R13      EQU   13                       ADDRESS OF OPTION FIELDS        34000020
R14      EQU   14                       RETURN REG                      34400020
R15      EQU   15                       ENTRY POINT OR RETURN CODE      34800020
         SPACE 3                                                        35200020
*STANDARD LINKAGE                                                       35600020
         SPACE                                                          36000020
         USING *,R15                    TEMP BASE                       36400020
         B     QNG00                                                    36800020
         DC    CL8'IEDQNG'                                              37200020
         DC    CL6'041671'                                              37600010
QNG00    EQU   *                                                        38000020
         USING IEDQAVTD,RAVT            BASE FOR AVT                    38400020
         USING IEDQCKPD,R2              BASE FOR CKPT WORK AREA         38800020
         USING LCBERB,R3                BASE FOR ERB-REQUEST ELEMNT1016 39200020
         SPACE 3                                                        39600020
         LH    R7,LCBTTCIN              GET TERMNAME TABLE OFFSET       40000020
         N     R7,AVTCLRHI                                              40400020
         BZ    QNG50                    BRANCH IF NO TRM OFFSET    0720 40800020
         LR    R4,R14                   SAVE REG                        41200020
         LR    R5,R15                   SAVE REG                        41600020
         DROP  R15                                                      42000020
         USING IEDQNG,R5                TEMPORARY BASE                  42400020
         L     R15,AVTRNMPT             GET BEGINNING OF TERM TABL      42800020
         LR    R1,R7                    SET PARM FOR SUBRTN             43200020
         BALR  R14,R15                  GET ADDRESS OF TERM ENTRY       43600020
         LR    R14,R4                   RESTORE REG                     44000020
         SPACE 3                                                        44400020
         USING IEDQTRM,RTERM            BASE FOR TERM ENTRY             44800020
         LR    RTERM,R1                                                 45200020
         SR    R0,R0                    CLEAR                           45600020
         IC    R0,CKPINCNO              GET COUNT OF INCIDENTS LEFT     46000020
         LTR   R0,R0                    CHECK COUNT                     46400020
         BZ    QNG70                    BRANCH IF NONE                  46800020
         BCTR  R0,0                     SUBTRACH FROM COUNT             47200020
         STC   R0,CKPINCNO              RESTORE                         47600020
         SPACE 3                                                        48000020
         LH    R6,CKPINCLN              LENGTH OF INCIDENT RECORD       48400020
         GETMAIN EC,LV=(R6),A=CKPLDRB,MF=(E,CKPGETML)                   48800020
         SPACE 3                                                        49200020
         LTR   R15,R15                  CHECK RETURN CODE               49600020
         LR    R14,R4                   RESTORE REG                     50000020
         LR    R15,R5                   RESTORE REG                     50400020
         DROP  R5                                                       50800020
         USING IEDQNG,R15               RESTORE BASE                    51200020
         BNZ   QNG60                    BRANCH IF NO CORE ALLOCATED     51600020
         L     R4,CKPLDRB               GET ADDRESS OF DISK RECORD      52000020
         USING IEDQCDRD,R4              BASE FOR CKPT DISK RECORD       52400020
         SPACE 3                                                        52800020
*BUILD INCIDENT RECORD FOR LCB                                          53200020
         SPACE                                                          53600020
         MVI   CDRKEY,CDRLCB            SET KEY FIELD                   54000020
         STH   R7,CDROFFS               PUT IN OFFSET                   54400020
         MVC   CDRSTAT,TRMSTATE         MOVE TERM STATUS TO RCD    0720 54800020
         MVC   CDRSEQIN(4),TRMINSEQ     MOVE SEQ NUMBERS TO RCD    1008 55000020
         TM    TRMSTATE,TRMOPTFN        CHECK FOR OPTION FIELDS         55200020
         BZ    QNG48                    BRANCH IF NOT USED              55600020
         SPACE 3                                                        56000020
*MOVE OPTION FIELDS TO DISK RECORD (USES REGISTERS 1,4,5,6,7,8,10,      56400020
*11,13)                                                                 56800020
         SPACE                                                          57200020
*SET UP FOR LOOP                                                        57600020
         SPACE                                                          58000020
         SR    R11,R11                                                  58400020
         IC    R11,TRMOPNO              COMPARAND                       58800020
         L     R13,AVTOPTPT              ADDRESS OF OPTION TABLE        59200020
         L     R7,4(R13)                ADDRESS OF OPT LENGTH TABLE     59600020
         LH    R1,TRMOPTBL              OFFST TO OPT FOR THIS ENTRY     60000020
         N     R1,AVTCLRHI              CLEAR HIGH ORDER HALF WORD      60400020
         AR    R13,R1                   ADD OFFSET TO ADDRESS           60800020
         SR    R1,R1                    CLEAR                           61200020
         SR    R10,R10                  CLEAR-LENGTH FOR MOVE           61600020
         LA    R6,TRMOPT                GET BEGINNING OF OFFSETS        62000020
         SPACE 3                                                        62400020
*BEGINNING OF LOOP THROUGH OPTION TABLE OFFSETS FOR THIS TERM           62800020
         SPACE                                                          63200020
QNG40    EQU   *                                                        63600020
         LR    R5,R13                   INITIALIZE                      64000020
         IC    R1,0(R6)                 OPTION OFFSET                   64400020
         CLI   0(R6),X'FF'              CHECK FOR UNUSED ENTRY          64800020
         BE    QNG45                    BRANCH IF UNUSED                65200020
         AR    R5,R1                    ADDRESS OF OPTION ENTRY         65600020
         IC    R10,0(R7)                GET LENGTH OF THIS OP ENTRY     66000020
         CLI   1(R7),X'D0'              CHECK OPTION TYPE          1111 66060020
         BH    QNG43                    BRANCH IF NOT ADDRESS TYPE 1111 66120020
         CLI   1(R7),X'80'              CHECK OPTION TYPE          1111 66180020
         BH    QNG45                    BRANCH IF ADDRESS TYPE     1111 66240020
QNG43    EQU   *                                                   1111 66300020
         EX    R10,QNGMOVE              MOVE OPTIONS TO DISK RECORD     66400020
         LA    R4,1(R4,R10)             ADD LENGTH MOVED TO BASE OF    X66800020
                                        DISK RECORD                     67200020
QNG45    EQU   *                                                        67600020
         LA    R7,CKPOPLTL(0,R7)        GET OPT LNGTH TABLE ENTRY       68000020
         LA    R6,1(0,R6)                                               68400020
         BCT   R11,QNG40                SUB FROM COUNT OF ENTRIES       68800020
         SPACE                                                          69200020
*END OF LOOP THROUGH OPTION TABLE OFFSETS FOR THIS TERM ENTRY           69600020
         SPACE 3                                                        70000020
QNG48    EQU   *                                                   0720 70400020
         LA    R15,CKPIOQM              OFFSET FOR ENQUEUE RTN          70800020
         BR    R14                      RETURN TO EXECUTOR              71200020
         SPACE 3                                                        71600020
*THE TERMINAL ENTRY CANNOT BE IDENTIFIED.NO CKPT IS TAKEN.         0720 72000020
         SPACE                                                          72400020
QNG50    EQU   *                                                        72800020
         OI    CKPLREB,CKPNDRB          INDICATE NO DISK RCB BUILT      73200020
         LA    R15,CKPNOTIF             OFFSET FOR NOTIFICATION RTN     73600020
         BR    R14                      RETURN TO EXECUTOR              74000020
         SPACE 3                                                        74400020
*NO GETMAIN AREA ALLOCATED. SET UP FOR NO GETMAIN RTN                   74800020
         SPACE                                                          75200020
QNG60    EQU   *                                                        75600020
         LA    R15,CKPNOCOR             OFFSET FOR RTN                  76000020
         BR    R14                      RETURN TO EXECUTOR              76400020
         SPACE 3                                                        76800020
*THERE ARE NO MORE INCIDENT RECORDS AVAILABLE-GO TO INCIDENT            77200020
*OVERFLOW RTN TO SET UP FOR TOTAL.                                      77600020
         SPACE                                                          78000020
QNG70    EQU   *                                                        78400020
         LA    R15,CKPNOINC             OFFSET FOR RTN                  78800020
         BR    R14                      RETURN TO EXECUTOR              79200020
         SPACE                                                          79600020
QNGMOVE  MVC   CDROPTN(0),0(R5)         MOVE TO RECORD FROM OPT TBL     80000020
         PRINT NOGEN                                                    80400020
         TAVTD                                                          80800020
         TCKPD 3330                                                     81200010
         TLCBD                                                          81600020
         TTRMD                                                          82000020
         END                                                            82400020
./  ADD  SSI=72790060,NAME=IEDQNH
QNH      TITLE 'IEDQNH-BUILD INCIDENT CKPT DISK RECORD FOR CHNGT'       00400020
IEDQNH   CSECT                                                          00800020
         SPACE 3                                                        01200020
* CHANGE ACTIVITY  =  AS FOLLOWS :                             @OZ26495 01200182
*A752000,840000                                                @OZ26495 01200282
*C612000                                                       @OZ26495 01200382
*********************************************************************** 01600020
*                                                                     * 02000020
*TITLE:'IEDQNH'-INCIDENT CHECKPOINT FOR A TCHNG MACRO                 * 02400020
*                                                                     * 02800020
*STATUS:CHANGE LEVEL 0                                                * 03200020
*                                                                     * 03600020
*FUNCTION:THIS MODULE BUILDS AN INCIDENT DISK RECORD WHEN THE         * 04000020
*   REQUEST ELEMENT ON THE CHECKPOINT QCB IS FROM A TCHNG MACRO       * 04400020
*   IN AN APPLICATION PROGRAM.                                        * 04800020
*                                                                     * 05200020
*ENTRY POINT:                                                         * 05600020
*                                                                     * 06000020
*        IEDQNH                                                       * 06400020
*                                                                     * 06800020
*INPUT:REGISTERS 2,3,9,12,14,15 CONTAIN THE FOLLOWING:                * 07200020
*                                                                     * 07600020
*   2-ADDRESS OF THE CHECKPOINT WORK AREA                             * 08000020
*   3-ADDRESS OF THE REQUEST ELEMENT THIS MODULE IS TO PROCESS        * 08400020
*   9-ADDRESS OF AVT                                                  * 08800020
*   12-BASE REGISTER FOR CHECKPOINT EXECUTOR-IEDQNF                   * 09200020
*   14-RETURN ADDRESS-IN IEDQNF                                       * 09600020
*   15-ENTRY POINT FOR THIS MODULE                                    * 10000020
*                                                                     * 10400020
*   THE FOLLOWING 16-BYTE REQUEST ELEMENT POINTED TO BY R3.           * 10800020
*                                                                     * 11200020
*   OFFSET 0-KEY:X'10'                                                * 11600020
*          1-ADDRESS OF CHECKPOINT QCB                                * 12000020
*          4-LINK FIEDL                                               * 12400020
*          8-OFFSET TO TERMNAME TABLE FOR TERMINAL ON TCHNG MACRO     * 12800020
*          10-UNUSED                                                  * 13200020
*          12-ADDRESS OF ECB FOR APPLICATION PROGRAM                  * 13600020
*                                                                     * 14000020
*OUTPUT:THE ABOVE REGISTERS 2-14 REMAIN UNCHANGED. (R15 MAY           * 14400020
*   CONTAIN A RETURN CODE.)                                           * 14800020
*                                                                     * 15200020
*   AN INCIDENT DISK RECORD IS BUILT IN A GETMAIN AREA. (ITS          * 15600020
*   ADDRESS IS IN CKPLDRB.)                                           * 16000020
*                                                                     * 16400020
*EXTERNAL ROUTINES:                                                   * 16800020
*                                                                     * 17200020
*        IEDQTNT-DETERMINES TERMINAL TABLE ADDRESS                    * 17600020
*                                                                     * 18000020
*EXITS-NORMAL:THIS MODULE RETURNS TO THE ADDRESS IN R14. R15 HAS AN   * 18400020
*   OFFSET FOR THE CHECKPOINT QUEUE MANAGER(72) OR THE INCIDENT       * 18800020
*   OVERFLOW ROUTINE(96)                                              * 19200020
*                                                                     * 19600020
*EXITS-ERROR:THIS MODULE RETURNS TO THE ADDRESS IN R14. R15 HAS AN    * 20000020
*   OFFSET FOR THE NO CORE ROUTINE(96).                               * 20400020
*                                                                     * 20800020
*TABLES/WORK AREAS:                                                   * 21200020
*                                                                     * 21600020
*   AVT(AVTCLRHI,AVTRNMPT,AVTOPTPT)                                   * 22000020
*   CHECKPOINT WORK AREA                                              * 22400020
*   TERMNAME TABLE                                                    * 22800020
*   TERMINAL TABLE                                                    * 23200020
*   OPTION TABLE                                                      * 23600020
*   OPTION LENGTH TABLE                                               * 24000020
*                                                                     * 24400020
*                                                                     * 24800020
*ATTRIBUTES:REENTERABLE                                               * 25200020
*                                                                     * 25600020
*NOTES:THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL REPRE-   * 26000020
*   SENTATION OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT TO    * 26400020
*   THE ONE USED AT ASSEMBLY TIME. THE CODING HAS BEEN ARRANGED SO    * 26800020
*   THAT REDEFINITION OF 'CHARACTER' CONSTANTS,BY REASSEMBLY, WILL    * 27200020
*   RESULT IN A CORRECT MODULE FOR THE NEW DEFINITIONS.               * 27600020
*                                                                     * 28000020
*********************************************************************** 28400020
         SPACE 3                                                        28800020
*REGISTER ASSIGNMENTS                                                   29200020
         SPACE                                                          29600020
R0       EQU   0                                                        30000020
R1       EQU   1                        PARM REG OR WORK REG            30400020
R2       EQU   2                        ADDRESS OF CKPT WORK AREA       30800020
R3       EQU   3                        ADDRESS OF REQUEST ELEMENT      31200020
R4       EQU   4                        ADDRESS OF DISK RECORD          31600020
R5       EQU   5                        ADDRESS OF OPTION ENTRY         32000020
R6       EQU   6                        INDEX REG                       32400020
R7       EQU   7                        OFFSET TO TERMNAME ENTRY        32800020
RTERM    EQU   8                        ADDRESS OF TERM ENTRY           33200020
RAVT     EQU   9                        ADDRESS OF AVT                  33600020
R10      EQU   10                       LENGTH OF OPTION FIELD          34000020
R11      EQU   11                       COMPARAND                       34400020
R12      EQU   12                       BASE REG FOR IEDQNF             34800020
R13      EQU   13                       SAVE AREA                       35200020
R14      EQU   14                       RETURN REG                      35600020
R15      EQU   15                       ENTRY POINT OR RETURN CODE      36000020
         SPACE 3                                                        36400020
*STANDARD LINKAGE                                                       36800020
         SPACE                                                          37200020
         USING *,R15                    TEMP BASE                       37600020
         B     QNH00                                                    38000020
         DC    CL8'IEDQNH'                                              38400020
         DC    CL6'041671'                                              38800000
QNH00    EQU   *                                                        39200020
         USING IEDQAVTD,RAVT                                            39600020
         USING IEDQCKPD,R2              BASE FOR CKPT WORK AREA         40000020
         USING IEDQCRED,R3              BASE FOR REQUEST ELEMENT        40400020
         SPACE                                                          40800020
*CHECK FOR AN AVAILABLE INCIDENT DISK RECORD                            41200020
         SPACE 3                                                        41600020
         SR    R0,R0                    CLEAR                           42000020
         IC    R0,CKPINCNO              GET NO. OF AVAIL INCIDENTS      42400020
         LTR   R0,R0                    CHECK THE NO.                   42800020
         BZ    QNH70                    BRANCH IF NONE AVAILABLE        43200020
         SPACE                                                          43600020
         BCTR  R0,0                     SUBTRACT ONE FROM COUNT         44000020
         STC   R0,CKPINCNO              RESTORE COUNT                   44400020
         SPACE 3                                                        44800020
*GET TERMINAL ENTRY ADDRESS                                             45200020
         SPACE                                                          45600020
         LH    R7,CREOFFS               GET TERMNAME OFFSET             46000020
         N     R7,AVTCLRHI              CLEAR HIGH ORDER HALF WORD      46400020
         LR    R1,R7                    SET UP PARM FOR SUBRTN          46800020
         LR    R4,R14                                                   47200020
         LR    R5,R15                   SAVE REG                        47600020
         SPACE                                                          48000020
         DROP  R15                                                      48400020
         USING IEDQNH,R5                TEMPORARY BASE                  48800020
         SPACE                                                          49200020
         L     R15,AVTRNMPT             ADDRESS OF SUBROUTINE           49600020
         BALR  R14,R15                  GET ADDRESS OF TERM ENTRY       50000020
         SPACE 3                                                        50400020
         USING IEDQTRM,RTERM            BASE FOR TERM ENTRY             50800020
         LR    RTERM,R1                                                 51200020
         SPACE 3                                                        51600020
*ISSUE GETMAIN TO BUILD RECORD                                          52000020
         SPACE                                                          52400020
         LA    R14,CKPLDRB              ADDRESS OF ADDR LOCATION        52800020
         LH    R15,CKPINCLN             LENGTH OF INCIDENT RECORD       53200020
         GETMAIN EC,LV=(R15),A=(R14),MF=(E,CKPGETML)                    53600020
         SPACE 3                                                        54000020
         LTR   R15,R15                  CHECK RETURN CODE               54400020
         LR    R14,R4                   RESTORE REG                     54800020
         LR    R15,R5                   RESTORE REG                     55200020
         SPACE                                                          55600020
         DROP  R5                                                       56000020
         USING IEDQNH,R15                                               56400020
         SPACE                                                          56800020
         BNZ   QNH60                                                    57200020
         SPACE 3                                                        57600020
*BUILD RECORD                                                           58000020
         SPACE                                                          58400020
         L     R4,CKPLDRB               GET ADDRESS OF GETMAIN AREA     58800020
         USING IEDQCDRD,R4              BASE FOR DISK RECORD            59200020
         MVI   CDRKEY,CDRCHNGT          PUT IN KEY FOR CHNGT RECORD     59600020
         STH   R7,CDROFFS               PUT IN TERMNAME OFFSET          60000020
         MVC   CDRSTAT,TRMSTATE         PUT IN TERM STATUS              60400020
         MVC   CDRSEQIN(4),TRMINSEQ     MOVE SEQ NUMBERS TO RCD    1008 60600020
         TM    TRMSTATE,TRMOPTFN        CHECK FOR OPTIONS               60800020
         BZ    NOOPTS                   BRANCH IF OPTION FIELDS@OZ26495 61200082
*                                        NOT USED              @OZ26495 61250082
         SPACE 3                                                        61600020
*MOVE OPTION FIELD TO DISK RECORD (USES REGISTERS 1,4,5,6,7,8,10,       62000020
*11,13)                                                                 62400020
         SPACE                                                          62800020
*SET UP FOR LOOP                                                        63200020
         SPACE                                                          63600020
         SR    R11,R11                  CLEAR                           64000020
         IC    R11,TRMOPNO              COMPARAND                       64400020
         L     R13,AVTOPTPT             ADDRESS OF OPTION TABLE         64800020
         L     R7,4(,R13)               ADDRESS OF OPT LENGTH TABLE     65200020
         LH    R1,TRMOPTBL              OFFST TO OPT THIS ENTRY         65600020
         N     R1,AVTCLRHI              CLEAR HIGH ORDER HALF WORD      66000020
         AR    R13,R1                   ADD OFFSET TO ADDRESS           66400020
         SR    R1,R1                    CLEAR                           66800020
         SR    R10,R10                  CLEAR (LENGTH FOR MOVE)         67200020
         LA    R6,TRMOPT                ADDRESS OF FIRST OPTION OFF     67600020
         SPACE 3                                                        68000020
*BEGINNING OF LOOP THROUGH OPTION TABLE OFFSETS FOR THIS TERM           68400020
         SPACE                                                          68800020
QNH40    EQU   *                                                        69200020
         LR    R5,R13                   INITIALIZE                      69600020
         IC    R1,0(R6)                 OPTION FIELD OFFSET             70000020
         CLI   0(R6),X'FF'              CHECK FOR UNUSED ENTRY          70400020
         BE    QNH45                    BRANCH IF UNUSED                70800020
         AR    R5,R1                    ADDRESS OF OPTION FIED          71200020
         IC    R10,0(R7)                GET LENGTH OF THIS OP FIELD     71600020
         CLI   1(R7),X'D0'              CHECK OPTION TYPE          1111 71660020
         BH    QNH43                    BRANCH IF NOT ADDRESS TYPE 1111 71720020
         CLI   1(R7),X'80'              CHECK OPTION TYPE          1111 71780020
         BH    QNH45                    BRANCH IF ADDRESS TYPE     1111 71840020
QNH43    EQU   *                                                   1111 71900020
         EX    R10,QNHMOVE              MOVE OPT FIELD TO DISK RCD      72000020
         LA    R4,1(R4,R10)             ADD LENGTH MOVED TO BASE OF    X72400020
                                        DISK RECORD                     72800020
QNH45    EQU   *                                                        73200020
         LA    R7,10(0,R7)              GET OPT LNGTH TABLE ENTRY       73600020
         LA    R6,1(0,R6)               ADD 1 TO INDEX                  74000020
         BCT   R11,QNH40                SUBTRACT FROM NO. OF ENTRY      74400020
         SPACE                                                          74800020
*END OF LOOP THROUGH OPTION TABLE OFFSETS                               75200020
         SPACE 3                                               @OZ26495 75210082
         LA    R5,TRMOPT                START OF OPTION FIELDS @OZ26495 75220082
         SR    R10,R10                  CLEAR REG              @OZ26495 75230082
         IC    R10,TRMOPNO              NUMBER OF OPTIONS      @OZ26495 75240082
         AR    R5,R10                   START OF DEVICE FIELDS @OZ26495 75250082
         B     CKBUF                    CHECK BUFSIZE          @OZ26495 75260082
NOOPTS   EQU   *                                               @OZ26495 75270082
         SR    R10,R10                  CLEAR REG              @OZ26495 75280082
         LA    R5,TRMOPNO               START OF DEVICE FIELDS @OZ26495 75290082
CKBUF    EQU   *                                               @OZ26495 75300082
         TM    TRMDEVFL,X80             BUFSIZE SPECIFIED      @OZ26495 75310082
         BNO   CKDIAL                   NO, BRANCH             @OZ26495 75320082
         IC    R10,0(R5)                LENGTH OF BUFSIZE      @OZ26495 75330082
         LA    R5,ONE(R10,R5)           BUMP PAST BUFSIZE      @OZ26495 75340082
CKDIAL   EQU   *                                               @OZ26495 75350082
         TM    TRMDEVFL,X40             DIAL DIGITS SPECIFIED  @OZ26495 75360082
         BNO   CKADDR                   NO, BRANCH             @OZ26495 75370082
         IC    R10,0(R5)                LENGTH OF DIAL DIGITS  @OZ26495 75380082
         EX    R10,QNHMOVE              MOVE DIAL DIGITS TO RCD@OZ26495 75390082
         LA    R4,ONE(R10,R4)           BUMP PAST DIAL DIGITS  @OZ26495 75400082
         LA    R5,ONE(R10,R5)           BUMP PAST DIAL DIGITS  @OZ26495 75410082
CKADDR   EQU   *                                               @OZ26495 75420082
         TM    TRMDEVFL,X20             ADDR CHAR SPECIFIED    @OZ26495 75430082
         BNO   QNH50                    NO, BRANCH             @OZ26495 75440082
         IC    R10,0(R5)                LENGTH OF ADDR CHAR    @OZ26495 75450082
         EX    R10,QNHMOVE              MOVE ADDR CHAR TO RCD  @OZ26495 75460082
         LA    R4,ONE(R10,R4)           BUMP PAST ADDR CHAR    @OZ26495 75470082
         SPACE 3                                                        75600020
*SETS RETURN CODE TO LOAD I/O QUEUE MANAGER RTN                         76000020
         SPACE                                                          76400020
QNH50    EQU   *                                                        76800020
         LA    R15,CKPIOQM              OFFSET FOR RTN NAME             77200020
         BR    R14                      RETURN TO EXECUTOR              77600020
         SPACE 3                                                        78000020
*NO GETMAIN CORE ALLOCATED. SET RETURN CODE FOR NO CORE RTN.            78400020
         SPACE                                                          78800020
QNH60    EQU   *                                                        79200020
         LA    R15,CKPNOCOR             OFFSET FOR RTN NAME             79600020
         BR    R14                      RETURN TO EXECUTOR              80000020
         SPACE 3                                                        80400020
*THERE ARE NO MORE AVAILABLE INCIDENT DISK RECORDS SET RETURN CODE      80800020
*FOR NO INCIDENTS RTN. TO SET FOR TOTAL CKPT.                           81200020
         SPACE                                                          81600020
QNH70    EQU   *                                                        82000020
         LA    R15,CKPNOINC             OFFSET FOR RTN NAME             82400020
         BR    R14                      RETURN TO EXECUTOR              82800020
         SPACE 3                                                        83200020
QNHMOVE  MVC   CDROPTN(0),0(R5)         MOVE OPTIONS TO DISK RECORD     83600020
         SPACE 3                                                        84000020
ONE      EQU   1                        CONSTANT               @OZ26495 84050082
X80      EQU   X'80'                    FLAG FOR BUFSIZE       @OZ26495 84100082
X40      EQU   X'40'                    FLAG FOR DIAL DIGITS   @OZ26495 84150082
X20      EQU   X'20'                    FLAG FOR ADDR CHAR     @OZ26495 84200082
         PRINT NOGEN                                                    84400020
         TAVTD                                                          84800020
         TCKPD 3330                                                     85200000
         TTRMD                                                          85600020
         END                                                            86000020
./  ADD  SSI=73000405,NAME=IEDQNJ
         TITLE 'IEDQNJ  -BUILT INCIDENT CKPT RECORD FOR OP. CONTROL'    00400020
IEDQNJ   CSECT                                                          00800020
         SPACE 3                                                        01200020
*********************************************************************** 01600020
*                                                                     * 02000020
*                                                               SA65381 02400010
*MODULE-NAME: IEDQNJ (TCAM, CHECKPOINT/RESTART)                @Y17XACX 02450010
*                                                               SA65381 02500010
*DESCRIPTIVE-NAME: OPERATOR CONTROL INCIDENT CHECKPOINT RECORD  SA65381 02550010
*   BUILDER                                                     SA65381 02600010
*                                                               SA65381 02650010
*COPYRIGHT: 'NONE'                                              SA65381 02700010
*                                                                     * 02800020
*STATUS: VERSION 10.0                                          @Y17XACX 03200010
*                                                                     * 03600020
*FUNCTION:THIS MODULE BUILDS AN INCIDENT RECORD WHEN THE REQUEST      * 04000020
*   ELEMENT ON THE CHECKPOINT QCB IS FROM OPERATOR CONTROL. THE       * 04400020
*   INCIDENT RECORD IS A FORM OF THE OPERATOR CONTROL COMMAND         * 04800020
*   ITSELF RATHER THAN THE TABLES WHICH ARE CHANGED AS A RESULT OF    * 05200020
*   THE COMMAND.                                                      * 05600020
*        IF THE INCIDENT RECORD IS THE RESULT OF AN ICHNG MACRO,      * 05650022
*   OTHER THAN ACTIVATE OR DEACTIVATE ILIST, THE INVITATION LIST      * 05700022
*   IS MOVED INTO CONTINUATION SEGMENTS TO BE PLACED ON THE DISK      * 05750022
*   I/O QUEUE FOLLOWING THE RECORD CONTAINING THE ICHNG COMMAND.      * 05800022
*   THE OPTION FIELD TO BE CHANGED BY A MODIFY OPTIONS CONTROL        * 05850022
*   COMMAND IS CHECKPOINTED IN THE SAME MANNER.                       * 05900022
*                                                                     * 06000020
*ENTRY POINT:                                                         * 06400020
*                                                                     * 06800020
*        IEDQNJ                                                       * 07200020
*                                                                     * 07600020
*INPUT:REGISTERS 2,3,9,12,14,15 CONTAIN THE FOLLOWING:                * 08000020
*                                                                     * 08400020
*   2-ADDRESS OF THE CHECKPOINT WORK AREA                             * 08800020
*   3-ADDRESS OF REQUEST ELEMENT THIS MODULE IS TO PROCESS            * 09200020
*   9-ADDRESS OF AVT                                                  * 09600020
*   12-BASE REGISTER FOR IEDQNF-CHECKPOINT EXECUTOR                   * 10000020
*   14-RETURN ADDRESS-IN IEDQNF                                       * 10400020
*   15-ENTRY POINT FOR THIS MODULE                                    * 10800020
*                                                                     * 11200020
*   THE REQUEST ELEMENT POINTED TO BY R3                              * 11600020
*   THE OPERATOR CONTROL COMMAND ELEMENT POINTED TO BE THE            * 12000022
*     OPERATOR CONTROL AVT (OPCCOPCE).                                * 12400022
*                                                                     * 12800020
*OUTPUT:THE ABOVE REGISTERS 2-14 REMAIN UNCHANGED. R15 HAS A RETURN   * 13200020
*   CODE OFFSET.                                                      * 13600020
*                                                                     * 14000020
*   THIS MODULE BUILDS INCIDENT DISK RECORDS IN GETMAIN AREAS.        * 14400022
*   THE ADDRESS OF THE FIRST RECORD IS IN CKPLDRB.                    * 14800022
*                                                                     * 15200020
*EXTERNAL ROUTINES:                                                   * 15600022
*        SVC 4 (GETMAIN)                                              * 15700022
*        SVC 5 (FREEMAIN)                                             * 15800022
*                                                                     * 16000020
*EXITS-NORMAL:THIS MODULE BRANCHES TO THE ADDRESS IN R14. R15         * 16400020
*   CONTAINS THE OFFSET OF THE CHECKPOINT QUEUE MANAGER OR OF THE     * 16800020
*   INCIDENT OVERFLOW ROUTINE.                                        * 17200020
*                                                                     * 17600020
*EXITS-ERROR:THIS MODULE BRANCHES TO THE ADDRESS IN R14. R15          * 18000020
*   CONTAINS THE OFFSET OF THE NO CORE ROUTINE                        * 18400020
*                                                                     * 18800020
*TABLES/WORK AREAS:                                                   * 19200020
*                                                                     * 19600020
*        AVT                                                          * 20000022
*        CHECKPOINT WORK AREA                                         * 20100022
*        OPERATOR CONTROL AVT                                         * 20200022
*        OPERATOR CONTROL ELEMENT                                     * 20300022
*                                                                     * 20400020
*ATTRIBUTES:REENTERABLE                                               * 20800020
*                                                                     * 21200020
*NOTES:THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL REPRE-   * 21600020
*   SENTATION OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT TO    * 22000020
*   THE ONE USED AT ASSEMBLY TIME. THE CODING HAS BEEN ARRANGED SO    * 22400020
*   THAT REDEFINITION OF 'CHARACTER' CONSTANTS,BY REASSEMBLY, WILL    * 22800020
*   RESULT IN A CORRECT MODULE FOR THE NEW DEFINITIONS.               * 23200020
*                                                                     * 23600020
*CHANGE ACTIVITY                                               @Y17XACX 23640010
*A000000-999999                                                @Y16X5C0 23680010
*C024000,032000                                                 SA65381 23720010
*A318000                                                        SA65381 23760010
*C726000                                                        SA65381 23800010
*A008000,236000                                                @Y17XACX 23840010
*C024500,032000,472000,722790                                  @Y17XACX 23880010
*D008001-008003                                                @Y17XACX 23920010
*A370400,704000                                                @Y17XACL 23960010
*A319000,720720,721620                                         @Y17XACL 23965010
*A356000,704900                                                @YM06459 23970010
*C268000                                                       @YM06459 23980010
*********************************************************************** 24000020
         EJECT                                                          24200010
*REGISTER ASSIGNMENTS                                                   24800020
         SPACE                                                          25200020
R0       EQU   0                                                        25600020
R1       EQU   1                        PARM REG                        26000020
R2       EQU   2                        ADDRESS OF CKPT WORK AREA       26400020
R3       EQU   3                        REQUEST ELEMENT BASE   @YM06459 26600010
R4       EQU   4                        ADDRESS OF DISK RECORD          27200020
R5       EQU   5                                                        27600020
R6       EQU   6                                                        28000020
R7       EQU   7                                                        28400020
R8       EQU   8                                                        28800020
RAVT     EQU   9                        ADDRESS OF AVT                  29200020
R10      EQU   10                                                       29600020
R11      EQU   11                       ADDRESS OF OP CNTRL WRKAREA     30000020
RBASE    EQU   12                       BASE REG                        30400020
R13      EQU   13                       SAVE AREA                       30800020
R14      EQU   14                       RETURN REG                      31200020
R15      EQU   15                       ENTRY POINT OR RETURN CODE      31600020
TXDCB    EQU   X'40'                    TCAM DCB TEST                   31800020
DATAOFF  EQU   5                        OFFSET TO ILIST DATA    SA65381 31900010
         SPACE 3                                                        32000020
LEASW    EQU   X'01'                    LEASED OR SWITCHED     @Y17XACL 32040010
*                                       LINE INDICATOR         @Y17XACL 32080010
MULTI    EQU   X'02'                    MULTIPOINT LINE        @Y17XACL 32120010
*                                       INDICATOR              @Y17XACL 32160010
UCASIZE  EQU   12                       UNIT CONTROL SIZE      @Y17XACL 32200010
NUMOFF   EQU   12                       OFFSET TO NUMBER OF TNT@Y17XACL 32240010
*                                       IN THE UNIT            @Y17XACL 32280010
         EJECT                                                 @Y17XACL 32320010
*STANDARD LINKAGE                                                       32400020
         SPACE                                                          32800020
         USING *,R15                    TEMP BASE                       33200020
IEDQNJ   IEDHJN QNJ00                                            S99240 33600022
         USING IEDQAVTD,RAVT                                            35200020
         USING IEDQCKPD,R2                                              35600020
         USING IEDQCRED,R3              REQUEST ELEMENT BASE   @YM06459 35800010
         SPACE 3                                                        36000020
         L     R11,AVTOCGET             BASE FOR OP CNTRL WORK AREA     36400020
         USING IEDQOPCD,R11             BASE FOR OP CONTROL AVT  S99240 36800022
         XC    CKPLDRB(4),CKPLDRB       ZERO GETMAIN POINTER     S99240 36880022
         LA    R10,QNJ07                SET RETURN ADDRESS       S99240 36960022
         LA    R4,CKPLDRB               ADDR FOR GETMAIN POINTER S99240 37040022
         TM    AVTCKFLG,AVTCKENV        SHOULD AN ENVIRONMENT  @Y17XACL 37050010
*                                       CKPT BE FORCED VIA AN  @Y17XACL 37060010
*                                       INCIDENT OVERFLOW      @Y17XACL 37070010
         BO    QNJ38                    YES, BRANCH            @Y17XACL 37080010
QNJ03    EQU   *                                                 S99240 37120022
         SPACE 3                                                        37200020
*CHECK FOR AN AVAILABLE INCIDENT DISK RECORD                            37600020
         SPACE                                                          38000020
         SR    R0,R0                    CLEAR                           38400020
         IC    R0,CKPINCNO              GET NO OF AVAIL INCIDENTS       38800020
         LTR   R0,R0                    CHECK THE NO.                   39200020
         BZ    QNJ40                    BRANCH IF NONE AVAILABLE        39600020
         BCTR  R0,0                     SUBTRACT ONE FROM COUNT         40000020
         STC   R0,CKPINCNO              RESTORE COUNT                   40400020
         SPACE 3                                                        40800020
*ISSUE GETMAIN FOR OPERATOR CONTROL INCIDENT RECORD                     41200020
         SPACE                                                          41600020
         LR    R6,R15                   SAVE REG                        42000020
         LH    R5,CKPINCLN              LENGTH OF INCIDENT              42400020
         GETMAIN EC,LV=(R5),A=(R4),MF=(E,CKPGETML)                      43200020
         LTR   R15,R15                  CHECK RETURN CODE               43600020
         LR    R15,R6                   RESTORE REG                     44000020
         BNZ   QNJ30                    BRANCH IF CORE NOT AVAIL.       44400020
         SPACE 3                                                        44800020
*BUILD DISK RECORD                                                      45200020
         SPACE                                                          45600020
         L     R4,AVTEZERO(R4)          ADDRESS OF DISK RECORD   S99240 46000022
         USING IEDQCDRD,R4              BASE FOR DISK RECORD            46400020
         XC    CDRDATE(CDRDATA-IEDQCDRD),CDRDATE CLEAR PREFIX    S99240 46600022
         MVI   CDRKEY,CDROPC                                            46800020
         BR    R10                      RETURN TO CALLING ROUTINES99240 46900022
QNJ07    EQU   *                        RETURN IS HERE IF NOT    S99240 47000022
*                                        A CONTINUATION SEGMENT  S99240 47100022
         L     R6,OPCCKPTF              GET CURRENT ELEMENT    @Y17XACX 47200010
*                                       ADDR.                  @Y17XACX 47400010
         USING IEDQOPCE,R6              BASE FOR OP CTL ELEMENT  S99240 47600022
         MVC   CDROPCB(CDROPCBL),OCOPTCDE MOVE OPC ELEMENT TO    S99240 48000022
*                                        DISK RECORD             S99240 48400022
         SPACE 3                                                        48800020
*CHECK FOR UCB ADDRESS  IN START LINE OR STOP LINE COMMAND AND CONVERT  49200020
*TO DDNAME AND RELATIVE LINE NUMBER FOR RESTART.                        49600020
         SPACE                                                          50000020
OCTERM   EQU   X'40'                    COMMAND IS FOR TERMINAL  S99240 50300022
         NI    CDROPCB+CKPOCSWC,OCFOXES-OCTERM TURN OFF TERMINAL S99240 50700022
*                                        INDICATOR               S99240 51100022
         TM    CDROPCB+CKPOCFLG,OCLINE  DOES COMMAND CONTAIN LINES99240 51500022
*                                        NUMBER                  S99240 51900022
         BZ    QNJ23                    NO, DON'T CONVERT        S99240 52300022
         L     R5,AVTTCB                GET TCB ADDR               0629 53200020
         USING IEDQTCB,R5               BASE FOR TCB               0629 53600020
         L     R6,TCBDEB                GET DEB CHAIN              0629 54000020
         USING IEDQDEB,R6               BASE FOR DEB               0629 54400020
QNJ15    EQU   *                                                   0629 54800020
         L     R10,DEBDCBAD             GET DCB ADDRESS            0629 55200020
         USING IHADCB,R10                                               55600020
         TM    DCBDSORG+1,TXDCB         IS THIS A TCAM DCB              55700020
         BZ    QNJ21                    BRANCH, IF NOT                  55800020
         IC    R7,DEBNMEXT              NUMBER OF EXTENTS-LINES    0714 56000020
         LA    R8,1                     INITIALIZE RELATIVE LINE NO0629 56400020
QNJ20    EQU   *                                                   0629 56800020
         LR    R1,R8                    RELATIVE LINE NUMBER       0629 57200020
         SLL   R1,2                     MULTIPLY BY 4              0629 57600020
         L     R13,DEBUCBAD-5(R1)       GET UCB ADDRESS            0629 58000020
         USING IEDQUCB,R13              BASE FOR DEB               0629 58400020
         MVC   CDROPCB+CKPOCNAM(2),UCBCHA MOVE UNIT ADDRESS TO   S99240 58800022
*                                        WORK AREA               S99240 58900022
         NI    CDROPCB+CKPOCNAM,7       TURN OFF UCB STATUS BITS S99240 59000022
         CLC   CDROPCB+CKPOCLNO(2),CDROPCB+CKPOCNAM  COMPARE     S99240 59100022
*                                        UCB ADDRESSES           S99240 59200022
         BE    QNJ22                    BRANCH IF EQUAL            0629 59600020
         LA    R8,1(,R8)                ADD 1 TO RELATIVE LINE A   0629 60000020
         BCT   R7,QNJ20                 SUB FROM NO. LINES FOR DCB 0629 60400020
QNJ21    EQU   *                                                        60600020
         L     R6,DEBDEBAD-1            GET NEXT DEB IN TCB CHAIN  0629 60800020
         LA    R6,0(,R6)                CLEAR HIGH ORDER BYTE      0629 61200020
         LTR   R6,R6                    CHECK FOR END OF CHAIN     0629 61600020
         BNZ   QNJ15                    BRANCH IF NOT END OF CHAIN 0629 62000020
QNJ22    EQU   *                                                   0629 62400020
         LH    R7,DCBTIOT               GET TIOT ADDR              0629 62800020
         A     R7,TCBTIO                ADD OFFSET FOR EXTENT      0629 63200020
         MVC   CDROPCB+CKPOCNAM(8),4(R7)  MOVE DDNAME TO INCIDENT R0629 63600020
         NI    CDROPCB+CKPOCFLG,OCFOXES-OCLINE TURN OFF LINE NO. S99240 64000022
*                                        INDICATOR               S99240 64400022
         STC   R8,CDROPCB+CKPOCREL      SAVE RELATIVE LINE NO.     0629 64800020
QNJ23    CLI   CDROPCB+CKPOCODE,OCICHNG ICHNG COMMAND            S99240 64850022
         BE    QNJ50                    YES, CHECK TYPE          S99240 64900022
         CLC   CDROPCB+CKPOCODE(2),QNJMODOP MODIFY OPTIONS       S99240 64950022
         BE    QNJ80                    YES, CHECK FOR           S99240 65000022
*                                        CONTINUATION SEGMENTS   S99240 65050022
QNJ24    OI    CDRTTRLI+2,2             SET TO SHOW LAST SEGMENT S99240 65100022
         SPACE 3                                                        65200020
*RETURN TO CKPT EXECUTOR                                                65600020
         SPACE                                                          66000020
QNJ25    EQU   *                                                   0629 66400020
         LA    R15,CKPIOQM              ADDRESS OF I/O QUEUE MANAGR     66800020
         BR    R14                      RETURN TO EXECUTOR              67200020
         SPACE 3                                                        67600020
*SET RETURN CODE TO LOAD NO CORE ROUTINE                                68000020
         SPACE                                                          68400020
QNJ30    EQU   *                                                        68800020
         LA    R10,QNJ35                SET RETURN ADDRESS       S99240 68820022
QNJ33    L     R4,CKPLDRB               GET FIRST SEGMENT ADDR.  S99240 68840022
         LTR   R4,R4                    WAS GETMAIN PARTIALLY    S99240 68860022
*                                        SUCCESSFUL              S99240 68880022
         BCR   8,R10                    NO FREEMAIN NEEDED       S99240 68900022
         LA    R5,CKPLDRB               POINTER TO ADDR OF AREA  S99240 68920022
         ST    R5,CKPGETML+4            PUT POINTER IN PARM LIST S99240 68940022
         L     R4,CDRDATE               GET POINTER TO CONTINUED S99240 68960022
*                                        SEGMENT                 S99240 68980022
         LR    R6,R15                   SAVE BASE REGISTER       S99240 69000022
         FREEMAIN E,MF=(E,CKPGETML),SP=0 FREE I/O BUFFER         S99240 69020022
         LR    R15,R6                   RESTORE BASE             S99240 69040022
         ST    R4,CKPLDRB               SAVE ADDR OF NEXT SEGMENTS99240 69060022
         B     QNJ33                    CHECK FOR MORE TO FREE   S99240 69080022
QNJ35    EQU   *                                                 S99240 69100022
         LA    R15,CKPNOCOR             OFFSET FOR RTN NAME             69200020
         BR    R14                      RETURN TO EXECUTOR              69600020
         EJECT                                                 @Y17XACL 69800010
*SET RETURN CODE TO LOAD NO INCIDENTS ROUTINE                           70400020
         SPACE 2                                               @Y17XACL 70430010
QNJ38    EQU   *                                               @Y17XACL 70460010
         USING IEDQOPCE,R8                                     @Y17XACL 70490010
         NI    AVTCKFLG,AVTEFF-AVTCKENV  RESET ENVIRONMENT     @YM06459 70497010
*                                       CHECKPOINT REQUEST     @YM06459 70504010
         OI    CREKEY,CREINCOF          SET INCIDENT OVERFLOW  @YM06459 70511010
         L     R8,OPCCKPTF              GET OPCE ADDRESS       @Y17XACL 70520010
         CLI   OCOPTCDE,OCHALT          HALT COMMAND           @Y17XACL 70550010
         BNE   QNJ40                    NO, BRANCH             @Y17XACL 70580010
         OI    AVTCKELF,AVTCMCPN        INDICATE THAT MCPCLOSE @Y17XACL 70610010
*                                       REQUESTED CHECKPOINT   @Y17XACL 70640010
         OI    AVTCKFLG,AVTCKHLT        INDICATE THAT A HALT   @Y17XACL 70670010
*                                       CMD HAS CAUSED AN      @Y17XACL 70700010
*                                       ENVIRONMENT CKPT       @Y17XACL 70730010
         SPACE                                                          70800020
QNJ40    EQU   *                                                        71200020
         BAL   R10,QNJ33                GO CHECK FOR FREEMAIN    S99240 71400022
         LA    R15,CKPNOINC             OFFSET FOR RTN NAME             71600020
         BR    R14                      RETURN TO EXECUTOR              72000020
         EJECT                                                 @Y17XACL 72001010
************************************************************** @Y71XACL 72002010
*                                                            * @Y71XACL 72003010
*        DETERMINE TYPE OF ICHNG COMMAND. COMMAND IS ICHNG   * @Y71XACL 72004010
*        ACT OR ICHNG DEACT IF CNROPCB IS 0 OR 1,            * @Y71XACL 72005010
*        RESPECTIVELY.                                       * @Y71XACL 72006010
*                                                            * @Y71XACL 72007010
************************************************************** @Y71XACL 72008010
QNJ50    LM    R7,R8,CDROPCB+CKPOCLST   PICK UP ILIST ADDR AND   S99240 72009022
*                                        ILIST LENGTH            S99240 72018022
         LA    R7,0(R7)                 CLEAR HIGH ORDER BYTE    S99240 72027022
         CH    R7,AVTHA2                ILIST ADDR OF ZERO OR    S99240 72036022
         BL    QNJ24                     ONE INDICATES ACTIVATE  S99240 72045022
*                                        OR DEACT ILIST - DO NOT S99240 72054022
*                                        MOVE ILIST INTO RECORD  S99240 72063022
*                                        TO BE CHECKPOINTED      S99240 72072022
         EJECT                                                 @Y71XACL 72072210
************************************************************** @Y71XACL 72072410
*                                                            * @Y71XACL 72072610
*        DETERMINE TYPE IF ICHNG MOVE. CKPTRMAD WILL CONTAIN * @Y71XACL 72072810
*        THE DATA FROM OCICTYPE IN THE ICHNG OPCE. IF        * @Y71XACL 72073010
*        CKPTRMAD=0, THEN THIS IS AN ICHNG MOVE FOR A 270X   * @Y71XACL 72073210
*        LINE. IF CKPTRMAD=1, THEN THIS IS ICHNG MOVE FOR    * @Y71XACL 72073410
*        A 3705 LEASED LINE. IF CKPTRMAD=2, THEN THIS IS     * @Y71XACL 72073610
*        ICHNG MOVE FOR A 3705 MULTIPOINT LINE.              * @Y71XACL 72073810
*                                                            * @Y71XACL 72074010
************************************************************** @Y71XACL 72074210
         MVC   CKPTRMAD(1),CDROPCB+CKPOCLST SAVE ICHNG TYPE    @Y71XACL 72074410
         CLI   CKPTRMAD,LEASW           IS ICHNG FOR A LEASED  @Y71XACL 72074610
*                                       OR A SWITCHED LINE ON  @Y71XACL 72074810
*                                       A 3705                 @Y71XACL 72075010
         BE    QNJ24                    YES, BRANCH            @Y71XACL 72075210
         SPACE 1                                               @Y71XACL 72075410
         CLI   CKPTRMAD,MULTI           IS ICHNG FOR MULTIPOINT@Y71XACL 72075610
*                                       3705 LINE              @Y71XACL 72075810
         BNE   QNJ55                    NO, BRANCH             @Y71XACL 72076010
         LA    R7,CKPSAVE2+8            GET ADDRESS OF PARM    @Y71XACL 72076210
*                                       LIST FOR MOVE BUFFER   @Y71XACL 72076410
         USING IEDPLMV,R7               ADDRESSABILITY         @Y71XACL 72076610
         L     R8,OPCCKPTF              GET OPCE ADDRESS       @Y71XACL 72076810
         L     R6,OCUNIT                GET ADDR OF UNITS TO   @Y71XACL 72077010
*                                       CHECKPOINT             @Y71XACL 72077210
         ST    R6,PLMVSU                SAVE ADDR OF SOURCE    @Y71XACL 72077410
*                                       UNIT                   @Y71XACL 72077610
         LA    R8,UCASIZE(,R6)          GET ADDR OF START OF   @Y71XACL 72077810
*                                       DATA IN THE UNIT       @Y71XACL 72078010
         ST    R8,PLMVSD                SAVE ADDRESS           @Y71XACL 72078210
         LH    R8,NUMOFF(,R6)           GET NUMBER OF TNT      @Y71XACL 72078410
*                                       OFFSET ENTRIES         @Y71XACL 72078610
         LA    R8,1(,R8)                ADD 1 FOR THE CONTROL  @Y71XACL 72078810
*                                       ENTRY                  @Y71XACL 72079010
         MH    R8,ENTLEN                CALCULATE LENGTH OF    @Y71XACL 72079210
*                                       ALL TNT OFFSET ENTRIES @Y71XACL 72079410
         MVI   PLMVFLG1,PLMVTCTG        TARGET IS CONTIGUOUS   @Y71XACL 72079610
         MVI   PLMVFLG2,0               CLEAR UNUSED FLAGS     @Y71XACL 72079810
         SLR   R6,R6                    CLEAR FOR STORE        @Y71XACL 72080010
         ST    R6,PLMVUNCA              CLEAR CHAIN FIELD      @Y71XACL 72080210
         EJECT                                                 @Y71XACL 72080410
QNJ55    EQU   *                                               @Y71XACL 72080610
         SR    R11,R11                  INITIALIZE OFFSET TO ZEROS99240 72081022
QNJ60    LA    R4,CDRDATE               ADDR FOR GETMAIN POINTER S99240 72090022
         BAL   R10,QNJ03                ISSUE GETMAIN            S99240 72099022
         OI    CDRTTRLI+2,1             FLAG CONTINUATION SEGMENTS99240 72108022
         MVI   CDROPCB+CKPOCODE,OCICHNG SET ICHNG CODE           S99240 72117022
         LA    R5,CDROPCBL-5            SET UP LENGTH FOR MOVE   S99240 72126022
         SR    R8,R5                    GET REMAINING LENGTH     S99240 72135022
         BP    QNJ70                    POSITIVE REMAINDER       S99240 72144022
         AR    R5,R8                    ELSE PUT AMOUNT OF DATA  S99240 72153022
*                                        TO MOVE IN R5           S99240 72162022
QNJ70    EQU   *                                               @Y71XACL 72162310
         CLI   CKPTRMAD,MULTI           3705 MULTIPOINT LINE   @Y71XACL 72162610
         BNE   QNJ75                    NO, BRANCH             @Y71XACL 72162910
         SPACE 1                                               @Y71XACL 72163210
         LA    R1,CDROPCB+DATAOFF       GET TARGET ADDRESS FOR @Y71XACL 72163510
*                                       MOVE BUFFER            @Y71XACL 72163810
         ST    R1,PLMVSU                SET SOURCE ...         @Y71XACL 72164110
         ST    R1,PLMVSD                ... ADDRESSES          @Y71XACL 72164410
         STH   R5,PLMVLNTH              SET LENGTH TO MOVE     @Y71XACL 72164710
         STM   R14,R15,CKPSAVE2         SAVE RETURN ADDRESS    @Y71XACL 72165010
*                                       AND BASE REGISTER      @Y71XACL 72165310
         LR    R1,R7                    GET ADDR OF PARM LIST  @Y71XACL 72165610
         LA    R13,SAVEAREA             GET ADDR OF SAVE AREA  @Y71XACL 72165910
         L     R15,AVTSAVTP             GET ADDR OF SEC. AVT   @Y71XACL 72166210
         L     R15,SAVTMVBF-IEDNSVTD(,R15) GET ADDR OF MOVE    @Y71XACL 72166510
*                                       BUFFER ROUTINE         @Y71XACL 72166810
         BALR  R14,R15                  CALL MOVE BUFFER       @Y71XACL 72167110
         LM    R14,R15,CKPSAVE2         RESTORE RETURN ADDRESS @Y71XACL 72167410
*                                       AND BASE REGISTER      @Y71XACL 72167710
         B     QNJ77                    GO CHECK FOR MORE DATA @Y71XACL 72168010
         EJECT                                                 @Y71XACL 72168310
QNJ75    EQU   *                                               @Y71XACL 72168610
         BCTR  R5,0                     SUBTRACT ONE FOR EXECUTE S99240 72168910
         EX    R5,QNJMOVEI              MOVE ILIST TO RECORD     S99240 72180022
         LA    R7,CDROPCBL-5(,R7)       INCREMENT ILIST ADDRESS@Y71XACL 72182010
         SPACE 2                                               @Y71XACL 72184010
QNJ77    EQU   *                                               @Y71XACL 72186010
         STH   R11,CDROPCB+CKPOCFLG     PUT OFFSET INTO ILIST    S99240 72189022
         STC   R5,CDROPCB+CKPOCFLG+2    INSERT DATA LENGTH - 1   S99240 72198022
*                                       (DATA LENGTH FOR 3705) @Y71XACL 72202010
         LA    R11,CDROPCBL-5(R11)      BUMP OFFSET BY LENGTH    S99240 72207022
*                                        OF DATA IN SEGMENT      S99240 72216022
         LTR   R8,R8                    ANY DATA LEFT            S99240 72234022
         BP    QNJ60                    YES, RELOOP              S99240 72243022
         B     QNJ24                    ELSE EXIT TO I/O Q MGR   S99240 72252022
         EJECT                                                 @Y17XACL 72256010
         USING IEDQOPCE,R8              BASE FOR OPC ELEMENT     S99240 72270022
QNJ80    L     R8,OPCCKPTF              RELOAD FIRST ELEMENT   @Y17XACX 72279010
*                                       ADDR                   @Y17XACX 72283010
QNJ90    TM    OCUNIT+3,2               IS THERE ANOTHER RECORD  S99240 72288022
         BO    QNJ24                    NO, EXIT TO QUEUE MANAGERS99240 72297022
         LA    R4,CDRDATE               ADDR FOR GETMAIN POINTER S99240 72306022
         BAL   R10,QNJ03                ISSUE GETMAIN            S99240 72315022
         L     R8,OCUNIT                GET ADDR OF NEXT ELEMENT S99240 72324022
         OI    CDRTTRLI+2,1             FLAG AS CONTINUATION SEG S99240 72333022
         MVC   CDROPCB(CDROPCBL),OCOPTCDE MOVE SEGMENT TO OUTPUT S99240 72342022
*                                        BUFFER                  S99240 72351022
         B     QNJ90                    AND RELOOP               S99240 72360022
         EJECT                                                 @Y71XACL 72380010
QNJMODOP DC    X'4415'                  MODIFY OPTIONS           S99240 72500022
QNJMOVEI MVC   CDROPCB+DATAOFF(AVTEZERO),AVTEZERO(R7) MOVE ILISTSA65381 72600010
*                                        TO DISK RECORD         SA65381 72900010
         SPACE 3                                               @Y71XACL 72910010
SAVEAREA DC    18F'0'                   SAVEAREA               @Y71XACL 72920010
         SPACE 1                                               @Y71XACL 72930010
ENTLEN   DC    H'3'                     LENGTH OF TNT OFFSET   @Y71XACL 72940010
*                                       ENTRY                  @Y71XACL 72950010
         EJECT                                                 @Y17XACL 73000010
         TAVTD                                                          73200020
         EJECT                                                 @Y17XACL 73400010
         TCKPD 3330                                                     73600000
         EJECT                                                          74000022
         TOPCAVTD                                                       74080022
         EJECT                                                          74160022
         TOPCED                                                         74240022
         EJECT                                                          74320022
         TPLMVD                                                @Y71XACL 74340010
         EJECT                                                 @Y71XACL 74360010
         DCBD  DSORG=TX                                                 74400020
         EJECT                                                 @Y71XACL 74600010
IEDQTCB  DSECT                                             -       0629 75200020
         ORG   IEDQTCB+8                                   -       0629 75600020
TCBDEB   DS    F                        ADDRESS OF E DEB CHAIN     0629 76000020
TCBTIO   DS    F                        ADDRESS OF TIOT BEGINNING  0629 76400020
         EJECT                                                 @Y71XACL 76600010
IEDQDEB  DSECT                                                     0629 77200020
         ORG   IEDQDEB+5                OFFSET TO NEXT DEB ADDR. S99240 77600022
DEBDEBAD DS    XL3                      ADDRESS OF NEXT DEB      S99240 78000022
         ORG   IEDQDEB+16               OFFSET TO NO. OF EXTENTS S99240 78400022
DEBNMEXT DS    X                        DEB NUMBER OF EXTENTS    S99240 78800022
         ORG   IEDQDEB+24               OFFSET TO DCB ADDR.      S99240 79200022
DEBDCBAD DS    F                        ADDRESS OF DCB           S99240 79600022
         ORG   IEDQDEB+33               OFFSET TO FIRST UCB ADDR.S99240 80000022
DEBUCBAD DS    XL3                      ADDRESS OF UCB             0629 80400020
         EJECT                                                 @Y71XACL 80600010
IEDQUCB  DSECT                                                     0629 80800020
         ORG   IEDQUCB+4                OFFSET TO UNIT ADDR.     S99240 80900022
UCBCHA   DS    XL2                      BINARY CHANNEL/UNIT ADDR.S99240 81000022
         ORG   IEDQUCB+13               OFFSET TO EBCDIC LINE NO.S99240 81200022
UCBNAME  DS    XL8                      NAME OF LINE -ADDRESS      0629 81600020
         SPACE 3                                               @Y71XACL 81800010
         END                                                            82000020
./  ADD  SSI=81100243,NAME=IEDQNK
QNK      TITLE 'IEDQNK-BUILD ENVIRONMENT CHECKPOINT RECORD(S)'          00100005
IEDQNK   CSECT                                                          00200005
         SPACE 3                                                        00300005
*A000000-999999                                                @Y16X5C0 00350000
**************************** MICROFICHE FLAGS *************** SUPT CODE 00400005
*A576400-577600                                                 SA51078 00400205
*C226000,496000-498000                                          SA53610 00400305
*A697200,906000                                                  A47151 00400405
*C226000,700000-722000                                           A47151 00400505
*D210000                                                         A47151 00400605
*A736300-737500,906200-906400                                   SA57661 00400705
*A210000,612100-612300,905500                                   SA56611 00400805
*A789230-789350                                                 SA59171 00400905
*C016000,504000,529120,768000                                    S22024 00401005
*A616200-617400                                                  S22024 00401105
*A516001-516002,520001                                          SA59179 00401205
*A526000,592840,925500                                          SA58453 00401305
*C696330-696350                                                  Y06328 00401405
*A907600                                                         Y06328 00401505
*C526180                                                        SA66372 00501554
*C504000                                                        SA67099 00501654
*A509236                                                        SA67099 00501754
*A700000                                                       @XA05305 00501856
*C528720-528760                                                @YA05454 00501956
*A527350                                                       @SA75469 00502058
*C504000,596000,486000                                         @Y17XACT 00572000
*A529840,598000,692000,202000,517200,528160,896000,486000,     @Y17XACT 00612000
*A907600                                                       @Y17XACT 00652000
*D509536,616200-617400,696120-696390                           @Y17XACT 00712000
*A788400,788600                                                @Y17XACA 00732000
*C788600,788800,789000,789230,789320,789400,789600             @Y17XACA 00752000
*A320000,501000,504000,501700-503100,594000,782000,786500      @OX16402 00761000
*D468000-470000                                                @OX16402 00770000
*D529760-586000 COPIED TO STMT 501700                          @OX16402 00779000
*C502000,502300,502400-502450,528240                           @OX16402 00788000
*A906400                                                       @OZ26495 00788182
*C528240,529720                                                @OZ26495 00788282
*A539720,541720,545720,547720                                  @OZ30950 00788382
*C540720-541220,546720-547220                                  @OZ30950 00788482
*********************************************************************** 00800020
*                                                                     * 00820022
*MODULE-NAME=IEDQNK (TCAM,CHECKPOINT/RESTART)                  @Y17XACT 00840000
*                                                                     * 00860022
*DESCRIPTIVE-NAME=BUILD ENVIRONMENT CHECKPOINT RECORDS                * 00880022
*                                                                     * 00900022
*COPYRIGHT='NONE'                                                     * 00920022
*                                                                     * 01000020
*STATUS -- VERSION 10.0                                        @Y17XACT 01600000
*                                                                     * 01800020
*FUNCTION:THIS MODULE BUILDS AN ENVIRONMENT DISK RECORD SEGMENT(S). IT* 02000020
*   DETERMINES WHETHER IT IS TO BUILD THE FIRST SEGMENT OF AN ENVIRON-* 02200020
*   MENT CHECKPOINT OR A SUBSEQUENT SEGMENT BY CHECKING THE CURRENT   * 02400020
*   EXCP SLOT (CKPEXCP); IF IT CONTAINS A POINTER TO AN ENVIRONMENT   * 02600020
*   TYPE RECORD WHICH IS TO BE CONTINUED(THE KEY FIELD CONTAINS X'20')* 02800020
*   THIS MODULE PICKS UP ITS REGISTERS FROM CKPSAVE1 AND BUILDS THE   * 03000020
*   NEXT SEGMENT IN THE GETMAIN AREA POINTED TO BY CKPEXCP. OTHERWISE * 03200020
*   IT ISSUES A GETMAIN AND PUTS ITS ADDRESS IN CKPLDRB (LAST DISK    * 03400020
*   RECORD BUILT). BEFORE MOVING A GROUP OF INFORMATION FROM THE MCP  * 03600020
*   TABLES TO THE DISK RECORD,THIS MODULE CHECKS TO SEE IF THERE IS   * 03800020
*   ROOM FOR IT IN THIS RECORD SEGMENT. IF NOT,IT PUTS X'20' IN THE   * 04000020
*   KEY FIELD,SAVES ITS REGISTERS IN CKPSAVE1,AND RETURNS TO THE      * 04200020
*   CHEKCPOINT EXECUTOR. IF IT REACHES THE END OF THE MCP TABLES      * 04400020
*   BEFORE IT REACHES THE END OF THE RECORD SEGMENT,IT PUTS X'1C' IN  * 04600020
*   THE KEY FIELD AND RETURNS TO THE CHECKPOINT EXECUTOR WITHOUT      * 04800020
*   SAVING ITS REGISTERS. IF IT JUST BUILT THE FIRST (OR ONLY) SEG.   * 05000020
*   MENT,IT RETURNS TO THE EXECUTOR WITH THE OFFSET OF THE CHECKPOINT * 05200020
*   I/O QUEUE MANAGER;IF IT JUST BUILT ANY OTHER SEGMENT IT RETURNS   * 05400020
*   WITH THE OFFSET OF THE CHECKPOINT I/O ROUTINE.(ONLY THE FIRST     * 05600020
*   SEGMENT IS ENQUEUED ON THE DISK I/O SUEUE.)                       * 05800020
*   WHEN THIS MODULE BEGINS TO BUILD A FIRST SEGMENT,IT TURNS OFF ALL * 06000020
*   REQUEST BITS IN THE ENVIRONMENT REQUEST ELEMENT(AVTCKELE) AND     * 06200020
*   TURNS ON THE CHECKPOINT IN PROGRESS FLAG IN THE REQUEST ELEMENT.  * 06400020
*   ANY SUBSEQUEST SETTINGS OF REQUEST BITS WILL CAUSE ANOTHER        * 06600020
*   ENVIRONMENT CHECKPOINT TO BE TAKEN.                               * 06800020
*                                                              @Y17XACT 06810000
*NOTES: SEE BELOW                                              @Y17XACT 06820000
*                                                              @Y17XACT 06830000
*    DEPENDENCIES = EBCDIC CHARACTER CODE DEPENDENCY           @Y17XACT 06840000
*                   CORRECTABLE BY REASSEMBLY                  @Y17XACT 06850000
*                                                              @Y17XACT 06860000
*    RESTRICTIONS = NONE                                       @Y17XACT 06870000
*                                                              @Y17XACT 06880000
*    REGISTER CONVENTIONS = SEE REGISTER ASSIGNMENTS           @Y17XACT 06890000
*                                                              @Y17XACT 06900000
*    PATCH LABEL = NONE                                        @Y17XACT 06910000
*                                                              @Y17XACT 06920000
*MODULE TYPE = PROCEDURE                                       @Y17XACT 06930000
*                                                              @Y17XACT 06940000
*    PROCESSOR = ASSEMBLER XF                                  @Y17XACT 06950000
*                                                              @Y17XACT 06960000
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY              @Y17XACT 06970000
*                                                              @Y17XACT 06980000
*    ATTRIBUTES = REENTERABLE                                  @Y17XACT 06990000
*                                                                     * 07000020
*ENTRY POINT = IEDQNK                                          @Y17XACT 07200000
*                                                                     * 07400020
*    PURPOSE = SEE FUNCTION                                    @Y17XACT 07450000
*                                                              @Y17XACT 07500000
*    LINKAGE = AT ENTRY,REG 15 CONTAINS ENTRY POINT ADDRESS    @Y17XACT 07550000
*                                                                     * 07800020
*INPUT:REGISTERS 2,3,9,12,14,15 CONTAIN THE FOLLOWING VALUES:         * 08000020
*                                                                     * 08200020
*   2-ADDRESS OF CHECKPOINT WORKAREA                                  * 08400020
*   3-ADDRESS OF REQUEST ELEMENT                                      * 08600020
*   9-ADDRESS OF AVT                                                  * 08800020
*   12-BASE REGISTER FOR CHECKPOINT EXECUTOR-IEDQNF                   * 09000020
*   14-RETURN ADDRESS-IN IEDQNF                                       * 09200020
*   15-ENTRY POINT OF THIS MODULE                                     * 09400020
*                                                                     * 09600020
*OUTPUT:THE ABOVE REGISTERS 2-14 ARE UNCHANGED. THIS MODULE BUILDS AN * 09800020
*   ENVIRONMENT DISK RECORD SEGMENT IN A GETMAIN AREA POINTED TO BY   * 10000020
*   CKPEXCP OR CKPLDRB (SEE FUNCTIONS)                                * 10200020
*                                                                     * 10400020
*EXITS-NORMAL:THIS MODULE RETURNS TO THE ADDRESS IN REGISTER 14 WITH  * 11000020
*   THE OFFSET OF EITHER THE I/O QUEUE MANAGER OR THE I/O ROUTINE IN  * 11200020
*   REGISTER 15.(SEE FUNCTIONS)                                       * 11400020
*                                                                     * 11600020
*EXITS-ERROR:THIS MODULE RETURNS TO THE ADDRESS IN REGISTER 14 WITH   * 11800020
*   THE OFFSET OF THE NO CORE ROUTINE IN REGISTER 15.                 * 12000020
*                                                                     * 12200020
*EXTERNAL REFERENCES = SEE BELOW                               @Y17XACT 12210000
*                                                              @Y17XACT 12220000
*    ROUTINES = NONE                                           @Y17XACT 12230000
*                                                              @Y17XACT 12240000
*    DATA AREAS = INVITATION LIST,CHECKPOINT WORKAREA          @Y17XACT 12250000
*                 CHECKPOINT REQUEST ELEMENT, READ AHEAD       @Y17XACT 12260000
*                 QUEUE (FOR TPROCESS ENTRY ONLY)              @Y17XACT 12270000
*                                                              @Y17XACT 12280000
*    CONTROL BLOCKS = AVT,DCB,DEB,LCB,QCB,TERMINAL ENTRY       @Y17XACT 12290000
*                                                              @Y17XACT 12300000
*TABLES = OPTION TABLE, TERMNAME TABLE                         @Y17XACT 12310000
*                                                              @Y17XACT 12320000
*MACROS = GETMAIN, IEDHJN                                      @Y17XACT 12330000
*                                                              @Y17XACT 12340000
*********************************************************************** 16200020
         EJECT                                                          16300005
         SPACE 3                                                        16400020
*REGISTER ASSIGNMENTS                                                   16600020
         SPACE                                                          16800020
R0       EQU   0                        REG ZERO                 S22024 17000022
R1       EQU   1                        INDEX-TERMNAME TABLE            17200020
R2       EQU   2                        ADDRESS OF CKPT WORK AREA       17400020
R3       EQU   3                        ADDRESS OF REQUEST ELEMENT      17600020
R4       EQU   4                        ADDRESS OF DISK RECORD          17800020
R5       EQU   5                        LENGTH-TERMNAME                 18000020
R6       EQU   6                        ADDRESS OF TERMNAME ENTRY       18200020
R7       EQU   7                        ADDRESS OF QCB                  18400020
R8       EQU   8                        ADDRESS OF TERM ENTRY           18600020
RAVT     EQU   9                        ADDRESS OF AVT                  18800020
R10      EQU   10                       POSITION IN DISK RECORD         19000020
R11      EQU   11                       LENGTH FOR GETMAIN              19200020
R12      EQU   12                       BASE REG FOR IEDQNF             19400020
R13      EQU   13                       BRANCH REG                      19600020
R14      EQU   14                       RETURN REG-IN IEDQNF            19800020
R15      EQU   15                       ENTRY POINT FOR THIS MODULE     20000020
         SPACE                                                          20200020
ONE      EQU   1                        ONE                    @Y17XACT 20300000
QNKMOVEL EQU   X'100'                   MAX LENGTH FOR EXECUTE     0725 20400020
QNKSTOP  EQU   X'01'                    BIT INDICATES LINE STOPPED 0728X20600020
                                        PRIOR TO CLOSEDOWN         0728 20800020
         SPACE 3                                                        21200020
         USING *,R15                    BASE REG                        21400020
         USING IEDQAVTD,RAVT            BASE FOR AVT                    21600020
         USING IEDQCKPD,R2              BASE FOR CKPT WORK AREA         21800020
         SPACE                                                          22000020
IEDQNK   IEDHJN  QNK00                                          SA56611 22200022
         USING IEDQCRED,R3              BASE FOR REQUEST ELEMENT        23000020
         USING IEDQCDRD,R4              BASE FOR DISK RECORD            23200020
         SPACE                                                          23400020
         LH    R11,CKPBPERR             LENGTH OF ENVIRONMENT SEG       23600020
         LR    R10,R11                  SAVE TOTAL LENGTH FOR GETMN1130 23650020
         LA    R0,CDRTINFO              LENGTH OF CON TROL DATA    1201 23700020
         SR    R11,R0                   SUBTRACT LEN FROM RCD LEN  1201 23750020
         L     R4,CKPEXCP               CURRENT EXCP RCD                23800020
         LTR   R4,R4                    CHECK FOR NO RCD BEING         X24000020
                                        WRITTEN CURRENTLY               24200020
         BZ    QNK30                    BRANCH IF 1ST SEGMENT           24400020
         CLI   CDRKEY,CDRTOTLC          CHECK FOR ENV RCD WHICH IS     X24600020
                                        CONTINUED                       24800020
         BNE   QNK30                    BRANCH IF 1ST SEG OF ENV        25000020
         SPACE 3                                                        25200020
*THIS IS A CONTINUATION OF AN ENV CKPT                                  25400020
         SPACE                                                          25600020
         LM    R13,R14,CKPSAVE1+8       RESTORE REGS                    26200020
         LM    R0,R8,CKPSAVE1+20        RESTORE REGS               1109 26400020
         LA    R10,CDRDATA              ADDRESS OF DATA PORTION         26800020
         B     0(R13,R15)               LOOP POSITION AT END OF SEG     27000020
         SPACE 3                                                        27200020
*THIS IS THE FIRST SEGMENT OF AN ENVIRONMENT CKPT. ISSUE GETMAIN        27400020
         SPACE                                                          27600020
QNK30    EQU   *                                                        27800020
         LA    R6,CKPLDRB               ADDRESS OF ADDR LOCATION        28000020
         LR    R7,R15                   SAVE REG                        28200020
         GETMAIN EC,LV=(R10),A=(R6),MF=(E,CKPGETML) AREA FOR RCD   1130 28400020
         SPACE                                                          28600020
         LTR   R15,R15                  CHECK RETURN CODE               28800020
         LR    R15,R7                   RESTORE REG                     29000020
         BZ    QNK35                    BRANCH IF REQUEST SATISFIED     29200020
         SPACE 3                                                        29400020
*THERE IS INSUFFICIENT CORE FOR THIS RECORD. RETURN TO CKPT             29600020
*EXECUTOR WITH THE OFFSET OF THE NO CORE MODULE.                        29800020
         SPACE                                                          30000020
         LA    R15,CKPNOCOR             OFFSET                          30200020
         BR    R14                      RETURN TO EXECUTRO              30400020
         SPACE 3                                                        30600020
*BUILD FIRST SEGMENT OF ENVIRONMENT CHECKPOINT                          30800020
         SPACE                                                          31000020
QNK35    EQU   *                                                        31200020
         L     R4,CKPLDRB               ADDRESS OF GETMAIN RCD          31400020
         LA    R10,CDRDATA              POSITION IN RCD OF DATA         31600020
         OI    AVTCKELF,AVTCPIPN        TURN ON CKPT IN PROGRESS        31800020
         NI    AVTCKELF,X'FF'-AVTCRTLN  TURN OFF REQUEST BIT            32000020
         NI    CKPFLAGS,AVTEFF-CKPOPNEN   SET FOR QCB SCAN     @OX16402 32050000
         XI    CKPSWCH1,CKPSET1         INITIALIZE QCB SWITCH  @OX16402 32100000
         SPACE 3                                                        34200020
*INITIALIZE FOR LOOP THROUGH TERMNAME TABLE                             44800020
         SPACE                                                          45000020
QNK47     EQU  *                                                        45200020
         USING IEDQTNTD,R6                                              45400020
         L     R6,AVTRNMPT              ADDRESS OF TERMNAME TABLE       45600020
         SR    R5,R5                    CLEAR                           45800020
         IC    R5,TNTENLEN              LENGTH OF TERMNAME              46000020
         LH    R1,TNTLEN                COUNT OF ENTRIES                46200020
         N     R1,AVTCLRHI              CLEAR HIGH ORDER HALF WORD      46400020
         LA    R6,TNTFIRST              GET FIRST ENTRY                 46600020
         SPACE 3                                                        47200020
*BEGINNING OF LOOP THROUGH TERMNAME TABLE                               47400020
         SPACE                                                          47600020
QNK50    EQU   *                                                        47800020
         AR    R6,R5                    MOVE PAST NAME FIELD            48000020
         MVC   CKPTRMAD+1(3),0(R6)      MOVE ADDR TO WORD BOUNDARY      48200020
         L     R8,CKPTRMAD              LOAD RERMINAL TABLE ADDRESS     48400020
         USING IEDNTRM,R8               BASE FOR TERM ENTRY    @Y17XACT 48600000
         SH    R8,TRMBCKUP              PT TO NEG PRFIX        @Y17XACT 48700000
         SPACE 3                                                        48800020
*CHECK TYPE OF TERMINAL ENTRY-SKIP CASCADE OR DISTRIBUTION LISTS.       49000020
*MOVE TERMINAL AND QCB INFO TO DISK RECORD                              49200020
         SPACE                                                          49400020
         TM    TRMDSORG,TRMLGB          IS THIS LINE GROUP ENTRY S22024 49460022
         BO    QNK65                    YES, DO NOT CHECKPOINT   S22024 49520022
         TM    TRMSTATE,TRMLIST         IS THE LIST BIT ON      SA53610 49600022
         BNO   QNK5002                  IF NOT, CKPT THIS ENTRY SA53610 49700022
         TM    TRMSTATE,TRMLOG          IS THIS LOGTYPE         SA53610 49800022
         BNO   QNK65                    IF NOT, DO NOT CKPT     SA53610 49900022
         SPACE                                                          50000022
QNK5002  EQU   *                                                SA53610 50100022
         TM    CKPFLAGS,CKPOPNEN        TERMINAL SCAN          @OX16402 50106000
         BO    QNK60A                   YES, SKIP QCB SCAN     @OX16402 50112000
         SPACE 3                                               @OX16402 50118000
*CHECKPOINT MASTER QCB FIELDS                                           50124000
         SPACE                                                          50130000
QNK55    EQU   *                                                   1109 50136000
         TM    TRMSTATE,TRMLOG          PROCESS OR LOG TYPE    @Y17XACT 50142000
         BM    QNK5501                  YES, NOT 3705 ENTRY    @Y17XACT 50148000
         TM    TRMSTATE,TRMPREF         3705 TTE               @Y17XACT 50154000
         BNO   QNK5501                  NO,DONT DO SSCP CHECK  @Y17XACT 50160000
         CLI   TRMTYPE,TRMSSCP             SSCP ENTRY          @Y17XACT 50166000
         BE    QNK65                    YES,NO VALID QCB       @Y17XACT 50172000
QNK5501  EQU   *                                               @Y17XACT 50178000
         USING IEDQQCB,R7               MASTER QCB BASE         SA58453 50184000
         L     R7,TRMDESTQ-1            ADDRESS OF MASTER QCB      1106 50190000
         TM    QCBDSFLG,QCBDISK         CHECK QUEUE TYPE           1116 50196000
         BZ    QNK65                    BRANCH IF CORE ONLY    @OX16402 50202000
         MVC   CKPSAVE1(1),QCBFLAG                                      50208000
         NI    CKPSAVE1,QCBCKPT         CLEAR ALL BUT CKPT BIT          50214000
         CLC   CKPSAVE1(1),CKPSWCH1     COMPARE SWITCHES                50220000
         BE    QNK65                    BRANCH IF ALREADY CKPOINTED     50226000
         XI    QCBFLAG,QCBCKPT          INVERT QCB SWITCH               50232000
         LA    R0,CKPMQBLN              LENGTH OF MASTER QCB FIEDLS     50238000
         BAL   R13,QNK90                CHECK FOR END OF RECORD         50244000
         MVI   0(R10),CKPQDELM          MOVE IN QCB DELIMITER  @OX16402 50250000
         MVC   ONE(CKPMCTLN,R10),QCBMSGCT  MOVE MSG COUNT      @OX16402 50256000
         MVC   CKPMCTLN+ONE(CKPQBKLN,R10),QCBQBACK  MOVE QBACK @OX16402 50262000
*                                         TTR                  @OX16402 50268000
         AR    R10,R0                   MOVE TO NEXT DISK POSITION      50274000
         SPACE 3                                                        50280000
*BEGINNING OF LOOP THROUGH PRIORITY LEVEL QCBS                          50286000
         SPACE                                                          50292000
QNK60    EQU   *                                                        50298000
         LA    R0,CKPQCBLN              LENGTH OF DISK POINTERS         50304000
         BAL   R13,QNK90                CHECK FOR END OF RECORD         50310000
         MVC   0(CKPQCBLN,R10),QCBDNHDR MOVE DISK PTRS                  50316000
         AR    R10,R0                   MOVE TO NEXT DISK POSITION      50322000
         LA    R0,CKPQBKLN              LENGTH OF QBACK POINTER SA51078 50328000
         BAL   R13,QNK90                CHECK FOR END OF RECORD SA51078 50334000
         MVC   0(CKPQBKLN,R10),QCBPQBCK SET QBACK POINTER       SA51078 50340000
         AR    R10,R0                   SET NEXT POSITION       SA51078 50346000
         CLI   QCBPRIPQ,0               CHECK FOR 0 PRIORITY            50352000
         LA    R7,QCBPSIZE(0,R7)        MOVE TO NEXT PRIORITY QCB       50358000
         BNZ   QNK60                    BRANCH IF NOT LAST QCB          50364000
         SPACE                                                          50370000
*END OF LOOP THROUGH PRIORITY LEVEL QCBS                                50376000
         B     QNK65                    CHECK NEXT TNT ENTRY   @OX16402 50400000
         SPACE 3                                               @OX16402 50420000
* THE FOLLOWING INSTRUCTIONS HAVE BEEN MOVED TO UPDATE THE     @OX16402 50440000
* QCB FIELDS BEFORE THE TERMINAL ENTRY FIELDS. THIS IS FOR     @OX16402 50460000
* RESTART SO THAT IT CAN BE SURE THAT THE SEQUENCE NUMBER HAS  @OX16402 50480000
* BEEN UPDATED TO WHAT THE DISK POINTERS INDICATE.             @OX16402 50500000
QNK60A   EQU   *                                               @OX16402 50520000
         LA    R0,CKPTRMLN+CKPDELLN            LENGTH INCREMENT@ZM47916 50540000
         BAL   R13,QNK90                CHECK FOR END OF RECORD         50600020
         MVI   0(R10),CKPDELMT          TERMINAL ENTRY DELIMITER   0422 50800000
         MVC   CKPDELLN(CKPTRMLN,R10),TRMSTATE    MOVE STATUS BYTE 0218 50923600
         AR    R10,R0                   MOVE TO NEXT DISK POSITION      51000020
         USING IEDQQCB,R7               BASE FOR QCB                    51400020
         L     R7,TRMDESTQ-1            ADDRESS OF QCB                  51600020
         TM    TRMSTATE,TRMLOG          PROCESS ENTRY           SA59179 51660005
         BM    QNK5003                  YES,SAVE FIELDS         SA59179 51720005
         TM    TRMSTATE,TRMPREF         NEG PREFIX EXIST       @Y17XACT 51723000
         BO    QNK5002A                 YES,BRANCH             @Y17XACT 51726000
         TM    TRMSTATE,TRMSNGLE        SINGLE ENTRY           @Y17XACT 51729000
         BNZ   QNK5002B                 NO, BRANCH             @Y17XACT 51732000
         LA    R0,CKPSENSE              LENGTH OF TRMSENSE     @Y17XACT 51735000
         BAL   R13,QNK90                CHECK FOR END OF REC   @Y17XACT 51738000
         MVC   0(CKPSENSE,R10),TRMSENSE                        @Y17XACT 51741000
*                                       CHECKPOINT TRMSENSE    @Y17XACT 51744000
         AR    R10,R0                   BUMP RECORD POINTER    @Y17XACT 51747000
         B     QNK5002B                 NOT 3705               @Y17XACT 51750000
QNK5002A EQU   *                                               @Y17XACT 51753000
         CLI   TRMTYPE,TRMLUNT             LU TYPE             @Y17XACT 51762000
         BE    QNK5002B                                        @Y17XACT 51765000
         CLI   TRMTYPE,TRMPSNA              PRESNA TERM        @Y17XACT 51768000
         BE    QNK5002B                                        @Y17XACT 51771000
         CLI   TRMTYPE,TRMCTERM             CTERM TYPE         @Y17XACT 51774000
         BNE   QNK5005A                                        @Y17XACT 51777000
QNK5002B EQU   *                                               @Y17XACT 51780000
         TM    QCBDSFLG,QCBDISK         CHECK FOR DISK QUEUES           51800020
         BZ    QNK5005                  BRANCH IF CORE ONLY        1116 52000020
QNK5003  EQU   *                                                SA59179 52100005
         LA    R0,CKPSEQLN              LENGTH OF SEQUENCE NO           52200020
         BAL   R13,QNK90                CHECK FOR END OF RCD            52400020
         MVC   0(CKPSEQLN,R10),TRMINSEQ                                 52600020
         TM    TRMSTATE,TRMLOG          VERIFY PROCESS ENTRY    SA58453 52609005
         BNM   QNK5004                  BRANCH IF NOT PROCESS   SA66372 52618054
         CLI   QCBDSFLG,QCBFQCB         PUT PROCESS ENTRY       SA66372 52621054
         BE    QNK5004                  BRANCH IF YES           SA66372 52624054
         NC    TRMSTAT+1(2),TRMSTAT+1   PEWA ALLOCATED          SA58453 52627005
         BZ    QNK5004                  BRANCH IF NO            SA58453 52636005
         DROP  R7                                                       52645005
         USING IEDQPEWA,R7              BASE FOR PEWA           SA58453 52654005
         L     R7,TRMSTAT               PEWA ADDRESS            SA58453 52663005
         NC    EOMSAVE+1(2),EOMSAVE+1   EOM SAVED               SA58453 52672005
         BZ    QNK50021                 BRANCH IF NO            SA58453 52681005
         L     R13,EOMSAVE              BUFFER ADDRESS          SA58453 52690005
         B     QNK50022                 SET SEQUENCE OUT        SA58453 52699005
QNK50021 EQU   *                                                SA58453 52708005
         CLC   PERAQCB+1(3),AVTDELAD+1  READ AHEAD Q EMPTY      SA58453 52717005
         BE    QNK5004                  BRANCH IF YES           SA58453 52726005
         L     R13,PERAQCB             BUFFER ADDRESS           SA58453 52735005
         TM    PRFSTAT1-IEDQPRF(R13),PRFDUPLN RETRIEVED BUFFER @SA75469 52736058
         BNO   QNK50022                 BRANCH IF NO           @SA75469 52737058
         CLC   PERAQCB+5(3),AVTDELAD+1  REGULAR BUFFER SAVED AC@SA75469 52738058
*                                       ACROSS RETRIEVE        @SA75469 52739058
         BE    QNK5004                  BRANCH IF NO           @SA75469 52740058
         L     R13,PERAQCB+4            BUFFER ADDRESS         @SA75469 52741058
         DROP  R7                                                       52744005
QNK50022 EQU   *                                                SA58453 52753005
         MVC   2(CKPSEQLN-2,R10),PRFTQBCK+1-IEDQPRF(R13)        SA58453 52762005
*                                       SET CORRECT NUMBER      SA58453 52771005
         AR    R10,R0                   BUMP REC PTR           @Y17XACT 52774000
         B     QNK5005B                 GO PROC OPTIONS        @Y17XACT 52777000
QNK5004  EQU   *                                                SA58453 52780005
         AR    R10,R0                                                   52800020
         SPACE 3                                                        52804020
*SAVE NEW 3705 TTE FIELDS                                      @Y17XACT 52808000
         SPACE                                                          52812020
QNK5005  EQU   *                         *                         1116 52812200
         TM    TRMSTATE,TRMPREF         NEG PREFIX *           @Y17XACT 52812400
         BNO   QNK5005B                 BR IF NOT *            @Y17XACT 52812600
QNK5005A EQU   *                        *                      @Y17XACT 52812800
         LA    R0,CKPNRSZ               LENGTH OF DATA *       @Y17XACT 52813000
         BAL   R13,QNK90                CHECK FOR END OF REC*  @Y17XACT 52813200
         USING CKPNRES,R10              USE CHECKPOINT DSECT*  @Y17XACT 52813400
         MVC   CKPSUBST,TRMSUBST             SAVE TRMSUBST*    @Y17XACT 52813600
         MVC   CKPCOHRT,TRMCOHRT             SAVE TRMCOHORT *  @Y17XACT 52813800
         MVI   CKPNFLG,X'00'            CLEAR FLAG *           @Y17XACT 52814000
         TM    TRMBYTE2,TRMREMB             REMB BIT SET *     @Y17XACT 52814200
         BNO   AROUND                   NO ,DONT SAVE*         @Y17XACT 52814400
         OI    CKPNFLG,CKPREMB          SAVE REMB BIT *        @Y17XACT 52814600
AROUND   EQU   *                        *                      @Y17XACT 52814800
         TM    TRMBYTE2,TRMRSACT              ACTIVE BIT SET*  @Y17XACT 52815000
         BNO   AROUND1                  NOT SET, DONT SAVE *   @Y17XACT 52815200
         OI    CKPNFLG,CKPRSACT         SAVE ACTIVE FLAG*      @Y17XACT 52816200
AROUND1  EQU   *                         *                     @Y17XACT 52816400
         TM    TRMSTATE,TRMLINE         TTE FOR LINE *         @Y17XACT 52816600
         BNO   AROUND2                  NO,DONT CHECK EPMODE*  @Y17XACT 52816700
         TM    TRMLINK,TRMEPMOD             EP MOD SET*        @Y17XACT 52816900
         BNO   AROUND2                  NO, DONT SAVE *        @Y17XACT 52817200
         OI    CKPNFLG,CKPEPMOD         SAVE EPMOD FLAG*       @Y17XACT 52817400
AROUND2  EQU   *                        *                      @Y17XACT 52817600
         CLI   TRMTYPE,TRMLUNT          TTE FOR LU*            @Y17XACT 52817800
         BNE   AROUND3                  NO, DONT CHECK TRMLU*  @Y17XACT 52818000
         TM    TRMLU,TRMLULOG             LULOG SET            @Y17XACT 52818400
         BNO   AROUND3                  NO, DONT SAVE          @Y17XACT 52818500
         OI    CKPNFLG,CKPLULOG         SAVE LU LOG BIT        @Y17XACT 52818600
AROUND3  EQU   *                                               @Y17XACT 52818700
         MVC   CKPTYPE,TRMTYPE             SAVE TRMTYPE        @Y17XACT 52818800
         AR    R10,R0                   GET NEXT DISK POSTION  @Y17XACT 52818900
         DROP  R10                                             @Y17XACT 52819000
QNK5005B EQU   *                                               @Y17XACT 52819100
         SPACE                                                          52819300
* SAVE OPTIONS FIELDS EXCEPTS THOSE DEFINED AS ADDRESSES       @Y17XACT 52819500
         SPACE                                                          52819700
         TM    TRMSTATE,TRMOPTFN        CHECK FOR OPTIONS DEFINED  1109 52820020
         BZ    QNK61                    BRANCH IF NOT USED     @OZ26495 52824082
         XC    CKPSAVE1+68(4),CKPSAVE1+68  CLEAR OPTION COUNT      1109 52828020
         L     R7,AVTOPTPT              ADDRESS OF OPTION TABLE    1109 52832020
         L     R3,4(,R7)                ADDR OF OPTION CHARACT TBL 1109 52836020
         SPACE 3                                                        52840020
*BEGINNING OF LOOP THROUGH COUNT OF OPTION FIELDS FOR THIS TERMINAL1109 52844020
         SPACE                                                          52848020
QNK51    EQU   *                                                   1109 52852020
         L     R13,CKPSAVE1+68          INDEX TO OPTION FIELD      1109 52856020
         IC    R13,TRMOPT(R13)          OFFSET                     1106 52860020
         CH    R13,QNKNOPT              CHECK FOR UNUSED ENTRY     1109 52864020
         BE    QNK54                    BRANCH IF NOT USED         1109 52868020
         LH    R7,TRMOPTBL              GET ENTRY OFFSET       @YA05454 52872056
         N     R7,AVTCLRHI              CLEAR HI HALF          @YA05454 52874056
         A     R7,AVTOPTPT              ADD OPT TBL OFFSET     @YA05454 52876056
         AR    R7,R13                   ADDR OF OPTION FIELD       1109 52880020
         IC    R13,0(R3)                LENGTH OF FIELD            1116 52884020
         CLI   1(R3),X'D0'              CHECK OPTION TYPE          1116 52888020
         BH    QNK52                    BRANCH IF  NOT ADDRESS TYPE1109 52892020
         CLI   1(R3),X'80'              CHECK OPTION TYPE          1116 52896020
         BH    QNK54                    BRANCH IF ADDRESS          1109 52900020
QNK52    EQU   *                                                   1109 52904020
         LA    R0,1(,R13)               LENGTH OF OPTION FIELD     1109 52908020
         BC    0,*                      NO-OP FOR RETURN BRANCH    1109 52912020
         BAL   R13,QNK90                CHECK FOR END OF RECORD SEG1106 52916020
         LR    R13,R0                   GET LENGTH                 1109 52920020
         BCTR  R13,0                    SUBTRACT 1 FOR EXECUTE     1106 52924020
         EX    R13,QNKMOVE              MOVE OPTION FIELD TO RCD   1106 52928020
         AR    R10,R0                   ADD LENGTH TO RCD POSITION 1106 52932020
QNK54    EQU   *                                                   1106 52936020
         LA    R3,CKPOPLTL(,R3)         GET NEXT ENTRY IN OP T CHAR1109 52940020
         L     R13,CKPSAVE1+68          GET INDEX                  1109 52944020
         LA    R13,1(,R13)              ADD 1 TO INDEX             1109 52948020
         ST    R13,CKPSAVE1+68          RESTORE INDEX              1109 52952020
         CLC   CKPSAVE1+71(1),TRMOPNO   CHEKC FOR END OF OPTION S  1109 52956020
         BNE   QNK51                    BRANCH IF NOT END OF OPT FI1109 52960020
         SPACE                                                          52964020
*END OF LOOP THROUGH OPTION FIELDS FOR THIS TERMINAL ENTRY         1109 52968020
         SPACE 3                                               @OZ26495 52972082
QNK61    EQU   *                                               @OZ26495 53022082
         TM    TRMDEVFL,X60             DIAL DIGITS/ADDR CHAR? @OZ26495 53072082
         BZ    QNK62                    NO, BRANCH             @OZ26495 53122082
         SR    R13,R13                  CLEAR REG              @OZ26495 53172082
         TM    TRMSTATE,TRMOPTFN        OPTIONS SPECIFIED      @OZ26495 53222082
         BNO   NOOPTS                   NO, BRANCH             @OZ26495 53272082
         LA    R7,TRMOPT                START OF OPTIONS       @OZ26495 53322082
         IC    R13,TRMOPNO              NUMBER OF OPTIONS      @OZ26495 53372082
         AR    R7,R13                   START OF DEVICE FIELDS @OZ26495 53422082
         B     CKBUF                    CHECK BUFSIZE          @OZ26495 53472082
NOOPTS   EQU   *                                               @OZ26495 53522082
         LA    R7,TRMOPNO               START OF DEVICE FIELDS @OZ26495 53572082
CKBUF    EQU   *                                               @OZ26495 53622082
         TM    TRMDEVFL,X80             BUFSIZE SPECIFIED      @OZ26495 53672082
         BNO   CKDIAL                   NO, BRANCH             @OZ26495 53722082
         IC    R13,0(R7)                LENGTH OF BUFSIZE      @OZ26495 53772082
         LA    R7,ONE(R13,R7)           BUMP PAST BUFSIZE      @OZ26495 53822082
CKDIAL   EQU   *                                               @OZ26495 53872082
         TM    TRMDEVFL,X40             DIAL DIGITS SPECIFIED  @OZ26495 53922082
         BNO   CKADDR                   NO, BRANCH             @OZ26495 53972082
         LA    R0,ONE                   SIZE OF LENGTH BYTE    @OZ30950 53978082
         BC    0,*                      NO-OP FOR RETURN BRANCH@OZ30950 53984082
         BAL   R13,QNK90                CHECK END OF RCD SEG   @OZ30950 53990082
         LA    R13,ONE                  LENGTH BYTE            @OZ30950 53996082
         BCTR  R13,0                    SUBTRACT FOR EXECUTE   @OZ30950 54002082
         EX    R13,QNKMOVE              MOVE LENGTH BYTE       @OZ30950 54008082
         LA    R10,ONE(R10)             ADJUST RECORD POSITION @OZ30950 54014082
         IC    R13,0(R7)                LENGTH OF DIAL DIGITS  @OZ26495 54022082
         LR    R0,R13                   LENGTH TO BE MOVED     @OZ30950 54072082
         B     DIALSKIP                 SKIP NEXT INSTRUCTION  @OZ30950 54082082
         B     CKDIAL                   START OVER IF NOT      @OZ30950 54092082
*                                        ENOUGH SPACE          @OZ30950 54102082
DIALSKIP EQU   *                                               @OZ30950 54112082
         BAL   R13,QNK90                CHECK - END OF RCD SEG @OZ26495 54172082
         LA    R7,ONE(R7)               BUMP PAST LEN PTR      @OZ30950 54192082
         LR    R13,R0                   LENGTH TO BE MOVED     @OZ26495 54222082
         BCTR  R13,0                    SUBTRACT 1 FOR EXECUTE @OZ26495 54272082
         EX    R13,QNKMOVE              MOVE DIAL DIGITS       @OZ26495 54322082
         AR    R10,R0                   ADJUST RECORD POSITION @OZ26495 54372082
         LA    R7,ONE(R13,R7)           BUMP PAST DIAL DIGITS  @OZ26495 54422082
CKADDR   EQU   *                                               @OZ26495 54472082
         TM    TRMDEVFL,X20             ADDR CHAR SPECIFIED    @OZ26495 54522082
         BNO   QNK62                    NO, BRANCH             @OZ26495 54572082
         LA    R0,ONE                   SIZE OF LENGTH BYTE    @OZ30950 54578082
         BC    0,*                      NO-OP FOR RETURN BRANCH@OZ30950 54584082
         BAL   R13,QNK90                CHECK END OF RCD SEG   @OZ30950 54590082
         LA    R13,ONE                  LENGTH BYTE            @OZ30950 54596082
         BCTR  R13,0                    SUBTRACT FOR EXECUTE   @OZ30950 54602082
         EX    R13,QNKMOVE              MOVE LENGTH BYTE       @OZ30950 54608082
         LA    R10,ONE(R10)             ADJUST RECORD POSITION @OZ30950 54614082
         IC    R13,0(R7)                LENGTH OF ADDR CHAR    @OZ26495 54622082
         LR    R0,R13                   LENGTH TO BE MOVED     @OZ30950 54672082
         B     ADDRSKIP                 SKIP NEXT INSTRUCTION  @OZ30950 54682082
         B     CKADDR                   START OVER IF NOT      @OZ30950 54692082
*                                        ENOUGH SPACE          @OZ30950 54702082
ADDRSKIP EQU   *                                               @OZ30950 54712082
         BAL   R13,QNK90                CHECK - END OF RCD SEG @OZ26495 54772082
         LA    R7,ONE(R7)               BUMP PAST LENGTH BYTE  @OZ30950 54792082
         LR    R13,R0                   RESTORE LENGTH         @OZ26495 54822082
         BCTR  R13,0                    SUBTRACT 1 FOR EXECUTE @OZ26495 54872082
         EX    R13,QNKMOVE              MOVE ADDR CHAR         @OZ26495 54922082
         AR    R10,R0                   ADJUST RECORD POSITION @OZ26495 54972082
         SPACE 3                                                        58800020
*CHECKPOINT LINE STATUS                                                 59000020
         SPACE                                                          59200020
QNK62    EQU   *                                                        59400020
         USING IEDQQCB,R7                                      @OX16402 59450000
         TM    TRMSTATE,TRMPROC         PROCESS OR LOG ENTRY   @Y17XACT 59600000
         BO    QNK65                    BRANCH IF PROC OR LOG  @Y17XACT 59800000
         TM    TRMSTATE,TRMPREF         3705 RESOURCE          @Y17XACT 59860000
         BO    QNK3705                  YES DO 3705 PROCESSING @Y17XACT 59920000
         LA    R0,CKPLCBLN+CKPDCBLN     LENGTH OF LCB,DCB INFO     1012 60000020
         BAL   R13,QNK90                CHECK FOR END OF CKPT RCD  0620 60200020
         L     R7,TRMDESTQ-1            RESTORE ADDRESS OF QCB          60400020
         SR    R13,R13                  CLEAR                           60600020
         IC    R13,QCBRELLN             RELATIVE LINE NO                60800020
         L     R7,QCBDCBAD-1            DCB ADDRESS                     61000020
         USING IHADCB,R7                BASE FOR DCB                    61200020
         MVI   0(R10),X'FF'             MARK LINE AS UNOPENED      0620 61260020
         MVI   1(R10),0                 CLEAR LCBSTAT2 TO ZERO     1001 61320020
         TM    DCBOFLGS,X'10'           CHECK FOR OPENED DCB       0620 61400020
         BZ    QNK64                    BRANCH IF NOT OPENED       1120 61600020
QNK6205  EQU   *                                                 S22024 61740022
         L     R8,DCBDEBAD              GET DEB ADDR            SA56611 61800022
         EX    R13,CKRLN                CHECK FOR UNOPENED LINE SA56611 62000022
         BL    QNK64                    BRANCH IF LCB UNOPENED  SA56611 62200022
QNK63    EQU   *                                                   0620 62400020
         LR    R8,R1                    SAVE REG                   0620 62600020
         SR    R1,R1                    CLEAR REG                  0620 62800020
         IC    R1,DCBEIOBX              GET LENGTH OF LCB          0620 63000020
         MR    R0,R13                   MULTIPLY BY REL LINE NO.   0620 63200020
         L     R0,DCBIOBAD              IOB ADDR FOR REL LINE -1   0620 63400020
         AR    R1,R0                    ADD DISPLACEMENT FOR PROPER0620X63600020
                                        LINE                       0620 63800020
         LA    R0,LCBFLAG1-IEDQLCB      DISPLACEMENT FROM BEGINNING0729 64000020
         SR    R1,R0                    GET BEGINNING ADDR OF LCB  0729 64200020
         USING IEDQLCB,R1               BASE FOR LCB               0729 64400020
         MVC   0(CKPLCBLN,R10),LCBSTAT1 MOVE LINE STAT TO CKPT RCD 0620 64600020
         CLI   LCBPRI,PRILCBDL          CHECK FOR LCB ON SYS DELAY 1012 64660020
         BE    QNK6304                  BRANCH IF ON QUEUE-NOT STOP1012 64720020
         TM    AVTBIT1,AVTCLOSN         CHECK FOR CLOSEDOWN IN PROG0728 64800020
         BZ    QNK6305                  BRANCH IF NO CLOSEDOWN     0728 65000020
         TM    LCBSTCBA+2,QNKSTOP       CHECK FOR LINE STOPPED         X65200020
                                        PRIOR TO CLOSEDOWN         0728 65400020
         BO    QNK6305                  BRANCH IF STOPPED PRIOR    0728 65600020
QNK6304  EQU   *                                                   1012 65700020
         OI    0(R10),LCBRECVN          MARK LCB NOT STOPPED IN    0728X65800020
                                        CKPT RCD                   Z728 66000020
QNK6305  EQU   *                                                   0728 66200020
         LR    R1,R8                    RESTORE REG                0620 66400020
         SPACE 3                                                        67000020
*CHECKPOINT THE INTERVAL IN THE LINE DCB                                67200020
         SPACE                                                          67400020
QNK64    EQU   *                                                   1116 67800020
         MVC   CKPLCBLN(CKPDCBLN,R10),DCBINTVL MOVE DCB INTERVAL   1116 68100020
         LA    R10,CKPLCBLN+CKPDCBLN(,R10) ADD LENGTH OF 2 FIELDS  1116 68400020
         SPACE 3                                                        68800020
*CHECKPOINT THE INVITATION LIST,IF SPECIFIED                            69000020
         SPACE                                                          69200020
INVLIST  EQU   *                                               @Y17XACT 69300000
         TM    CKPFLAGS,CKPSTAIN        CHECK FOR INV LISTS CKPTED 0525 69400020
         BZ    QNK65                    BRANCH IF NOT TO BE CKPTED      69600020
         MVC   CKPTRMAD+1(THREE),AVTEZERO(R6) MOVE ADDR TO       S22024 69603022
*                                        WORD BOUNDARY           S22024 69606022
         L     R8,CKPTRMAD              RELOAD TERM ENTRY ADDR   S22024 69609022
         SH    R8,TRMBCKUP              BACK UP TO NEG PREF    @YM06009 69619000
         L     R7,TRMDESTQ-1            RESTORE QCB ADDRESS      S22024 69642022
         USING IEDQQCB,R7               BASE FOR QCB             S22024 69645022
         SR    R13,R13                  CLEAR FOR IC             S22024 69648022
         IC    R13,QCBRELLN             GET RELATIVE LINE NO.    S22024 69651022
         L     R7,QCBDCBAD-1            RESET DCB ADDRESS        S22024 69654022
         USING IHADCB,R7                BASE FOR DCB             S22024 69657022
         EX    R13,QNKCOMPR             CHECK FOR INVITATION LIST  1209 69660020
         BL    QNK65                    BRANCH IF NOT DEFINED INDCB1209 69720020
         BCTR  R13,0                    DECREMENT BY ONE         A47151 69760022
         SLL   R13,2                    MULTIPLY BY 4                   69800020
         L     R7,DCBINVLI(R13)         ADDRESS OF INVLIST       A47151 70000022
         LA    R7,AVTEZERO(,R7)         CLEAR HI ORDER BYTE    @XA05305 70020056
         LTR   R7,R7                    INVLIST OMITTED ON GRP @XA05305 70040056
         BZ    QNK65                    BR YES                 @XA05305 70060056
         CLI   INVENTS(R7),AVTEZERO     DOES LIST HAVE ENTRIES   A47151 70100022
         BE    QNK65                    IF NO, DO NOT CHECKPOINT A47151 70200022
         TM    CKPSWCH2,CKPSET2         SWITCH FLIP OR FLOP      A47151 70300022
         BNO   QNK6403                  IF FLIP, TEST ON COND    A47151 70400022
         TM    INVSTAT(R7),CKPSET2      CHECK SW IN INVLIST      A47151 70500022
         BNO   QNK65                    BRANCH IF LIST CKPTED    A47151 70600022
         B     QNK6406                  ELSE, CHECKPOINT IT      A47151 70700022
         SPACE                                                          70800022
QNK6403  EQU   *                                                 A47151 70900022
         TM    INVSTAT(R7),CKPSET2      CHECK SW IN INVLIST      A47151 71000022
         BO    QNK65                    BRANCH IF LIST CKPTED    A47151 71100022
         SPACE                                                          71200022
QNK6406  EQU   *                                                 A47151 71300022
         XI    INVSTAT(R7),CKPSET2      INVERT SW TO IND CKPT    A47151 71400022
         ST    R1,CKPSAVE1              SAVE REG                   1020 72400020
         SR    R0,R0                    CLEAR                      0709 72600020
         SR    R1,R1                    CLEAR                           72800020
         IC    R0,0(R7)                 GET NO. ENTRIES IN LIST         73000020
         IC    R1,2(R7)                 GET LENGTH OF ONE ENTRY         73200020
         MR    R0,R0                    GET LENGTH OF TOTAL LIST        73400020
         LA    R0,9(0,R1)               ADD LENGTH OF CONTROL AREA 0724 73600020
         TM    INVSTAT(R7),EOTBIT       IS IT EOT-FE (BSC)      SA57661 73630022
         BZ    QNK6406A                 NO, BRANCH              SA57661 73660022
         LA    R0,TEN(,R1)              ADD LENGTH OF CONTROL   SA57661 73690022
*                                       AREA FOR BSC            SA57661 73720022
QNK6406A EQU   *                                                SA57661 73750022
         LTR   R1,R11                   CHECK FOR END OF RCD SEG   0822 73800020
         BNZ   QNK6407                  BRANCH IF NOT END          0916 74000020
         BAL   R13,QNK91                WRITE OUT CURRENT SEG      0822 74200020
QNK6407  EQU   *                                                   0916 74400020
         BAL   R8,QNK95                 MOVE INV LIST TO RCD SEG   0822 74600020
         B     QNK6409                  CHECK FOR FILLED RCD SEG   0916 74800020
         SPACE 3                                                        75000020
QNK6408  EQU   *                                                   0916 75200020
         SR    R0,R1                    SUBTRACT LENGTH MOVED FROM 0822X75400020
                                        TOTAL LENGTH OF INV LIST   0822 75600020
         BP    QNK6407                  MOVE REST TO NEW RCD SEG   0916 75800020
         SPACE 3                                                        76000020
*CONTROL IS RETURNED HERE IF ANOTHER RECORD SEGMENT IS REQUIRED FOR0822 76200020
*THE REMAINDER OF THE INVITATION LIST                                   76400020
         SPACE                                                          76600020
         B     QNK6408                  CONTINUE MOVE            S22024 76800022
QNK6409  EQU   *                                                   0916 77000020
         BAL   R13,QNK90                CHECK FOR END OF REC SEG   0822 77200020
         SPACE 3                                                        77400020
         L     R1,CKPSAVE1              RESTORE REG                1020 77600020
QNK65    EQU   *                                                        77800020
         LA    R6,3(0,R6)               MOVE PAST ADDR FIELD IN TNT     78000020
         BCT   R1,QNK50                 SUBTRACT FROM NO.OF ENTRIES     78200020
         TM    CKPFLAGS,CKPOPNEN        TERMINAL SCAN DONE     @OX16402 78230000
         BO    ENDLOOP                  YES, MOVE AVT DATA     @OX16402 78260000
         OI    CKPFLAGS,CKPOPNEN        SET FOR TERM SCAN      @OX16402 78290000
         XI    CKPSWCH2,CKPSET2         INITIALIZE INV LIST SW @OX16402 78320000
         B     QNK47                    SCAN TERMINAL ENTRIES  @OX16402 78350000
         SPACE                                                          78400020
*END OF LOOP THROUGH TERMNAME TABLE                                     78600020
         SPACE                                                          78650020
ENDLOOP  EQU   *                                               @OX16402 78660000
         NI    CKPFLAGS,AVTEFF-CKPOPNEN   TURN OFF BIT         @OX16402 78670000
         LA    R0,CKPAVTLN              LENGTH OF AVT FIELDS       0208 78700020
         BAL   R13,QNK90                CHECK FOR END OF RECORD    0208 78750020
         SPACE 3                                                        78800020
*SIGNIFICANT AVT DATA                                                   78820020
         SPACE                                                          78840020
         USING CKPAVT,R10               AVT CHECK POINT FIELDS @Y17XACA 78850000
         MVC   CKPOPCON,AVTOPCON        PRI OP/CNTRL TERMINAL  @Y17XACA 78860000
         MVC   CKPOPCIN,AVTOPCIN        PRI OP/CNTRL TTCIN     @Y17XACA 78870000
         MVC   CKPINTLV,AVTINTLV          SYSTEM DELAY INTERVL @Y17XACA 78880000
         MVC   CKPBIT1(2),AVTBIT1       SYS DLY IN EFFECT(BIT3)@Y17XACAX78900000
                                        AND REUS ACTIVE-AVTBIT2    0525 78920020
         NI    CKPBIT1,AVTEFF-AVTRFULN  CLEAR BIT              @Y17XACA 78923000
         TM    AVTBIT3,AVTRFULN         IN SLOW DOWN            SA59171 78926022
         BZ    QNK80                    BRANCH IF NO            SA59171 78929022
         OI    CKPBIT1,AVTRFULN         SET SLOW DOWN IN CK REC@Y17XACA 78932000
QNK80    EQU   *                                                SA59171 78935022
         MVC   CKPNADDR(8),AVTNADDR     DISK QUEUES-REUSABLE,NO@Y17XACA 78940000
         MVC   CKPLODPT,AVTLODPT        REUS LODPT FIELD       @Y17XACA 78960000
         MVC   CKPSUBT(2),AVTSUBT       AVTSUBT & AVTIOTR      @Y17XACA 78980000
         MVI   CDRKEY,CDRTOTAL          INDICATE LAST SEGMENT           79000020
QNK81    EQU   *                                                        79200020
         LR    R1,R15                                                   79400020
         DROP  R15                                                      79600020
         USING IEDQNK,R1                CHANGE PROG BASE                79800020
         LA    R3,AVTCKELE              RESTORE ADDR OF REQ ELEMNT 1109 79900020
         C     R4,CKPEXCP                                               80000020
         LA    R15,CKPDIOR              OFFSET FOR DISK I/O ROUTINE     80200020
         BCR   8,R14                    BRANCH IF NOT 1ST SEGMENT       80400020
         LA    R15,CKPIOQM              OFFSET FOR I/O QUEUE MGR        80600020
         BR    R14                      RETURN TO CKPT EXECUTOR         80800020
         SPACE 3                                                        81000020
*SUBROUTINE TO CHECK FOR END OF DISK RECORD AND SAVE REGS IF END        81200020
         SPACE                                                          81400020
QNK90    EQU   *                                                        81600020
         DROP  R1                                                       81800020
         USING IEDQNK,R15                                               82000020
         SR    R11,R0                   SUB FIELD LNGTH FROM TOTAL      82200020
         BCR   10,R13                   RETURN IF NOT END OF RCD        82400020
         SH    R13,QNKEIGHT             ADJUST BRANCH RETURN ADDR       82600020
QNK91    EQU   *                                                        82800020
         SR    R13,R15                  GET RELATIVE ADDR-THIS         X83000020
                                        MODULE MIGHT BE RELOADED       X83200020
                                        INTO ANOTHER LOCATION           83400020
         MVI   CDRKEY,CDRTOTLC          SET KEY FOR CONTINUED SEG       83600020
         STM   R13,R11,CKPSAVE1+8       SAVE REGS UNTIL NEXT SEG IS    X83800020
                                        BUILT                           84000020
         B     QNK81                    RETURN TO EXECUTOR              84200020
         SPACE 3                                                        84400020
         SPACE 3                                                        84600020
*SUBROUTINE TO MOVE OPTION DATA OR INVITATION LISTS TO RECORD SEG  0822 84800020
         SPACE                                                          85000020
QNK95    EQU   *                                                   0822 85200020
         ST    R11,CKPSAVE2             SAVE REG                   1006 85400020
         CR    R11,R0                   COMPARE LENGTHS            1006 85600020
         BL    QNK9505                  BRANCH IF INV LIST IS TOO  1006X85800020
                                        LARGE TO FIT IN THIS SEG   1006 86000020
         LR    R11,R0                   USE LENGTH OF LIST FOR MOVE1006 86200020
QNK9505  EQU   *                                                   1006 86400020
         LR    R13,R11                  COPY REMAINING RCD LENGTH  0725 86600020
         SRL   R11,8                    GET NO. OF EXECUTES REQUIRD0725 86800020
         LA    R11,1(R11)               ADD 1 TO COUNT OF EXECUTES 0728 87000020
         N     R13,QNK000F              CLEAR ALL BUT LAST BYTE    0725 87200020
QNK96    EQU   *                                                   0822 87400020
         BCTR  R13,0                    SUBTRACT 1 FOR EXECUTE INST0725 87600020
         EX    R13,QNKMOVEO             MOVE OPTIONS TO DISK RCD   0725 87800020
         LA    R7,1(R7,R13)             ADD LENGTH TO ADDR OF OPTON0822 88000020
         LA    R10,1(R10,R13)           ADD LENGTH TO ADDR OF RCD  0725 88200020
         LA    R13,QNKMOVEL             GET MAX LENGTH FOR EXECUTE 0725 88400020
         BCT   R11,QNK96                CHECK FOR ANOTHER EX REQURD0822 88600020
         L     R11,CKPSAVE2             RESTORE REG                1006 88800020
         BR    R8                       RETURN                     0916 89000020
         SPACE                                                          89200020
*END OF SUBROUTINE                                                      89400020
         SPACE 3                                                        89600020
QNK3705  EQU   *                                               @Y17XACT 89610000
         CLI   TRMTYPE,TRMSSCP          SSCP                   @ZM47916 89613000
         BE    QNK65                    YES NO FURTHER PROCESS @ZM47916 89616000
         CLI   TRMTYPE,TRMLNCP             NCP TYPE            @Y17XACT 89640000
         BNE   INVLIST                  PROCESS INV LIST       @Y17XACT 89650000
         LA    R0,ONE                   DATA LENGTH            @Y17XACT 89660000
         BAL   R13,QNK90                END OF REC             @Y17XACT 89670000
         MVI   0(R10),X'00'             CLEAR NEXT BYTE        @Y17XACT 89680000
         USING IEDQQCB,R7                                      @Y17XACT 89690000
         L     R7,TRMDESTQ-1            GET QCB ADDR           @Y17XACT 89700000
         L     R7,QCBDCBAD-1            GET DCB ADDR           @Y17XACT 89710000
         USING IHADCB,R7                                       @Y17XACT 89720000
         TM    DCBOFLGS,DCBOFOPN        DCB OPEN               @Y17XACT 89730000
         BZ    NOTOPEN                  BR,IF NOT OPEN         @Y17XACT 89740000
         SR    R8,R8                    CLEAR REG 8            @Y17XACT 89741000
         IC    R8,DCBEIOBX              CALCULATE..            @Y17XACT 89742000
         A     R8,DCBIOBAD                      ADDR OF...     @Y17XACT 89743000
         SH    R8,LCBBCKUP                             LCB     @Y17XACT 89744000
         USING IEDQLCB,R8                                      @Y17XACT 89745000
         TM    LCBSTAT2,LCBTRACE        TRACE INDICATED        @Y17XACT 89746000
         BNO   NOTOPEN                  NO,BRNCH AROUND        @Y17XACT 89747000
         OI    0(R10),LCBTRACE          SET TRACE BIT          @Y17XACT 89750000
NOTOPEN  EQU   *                                               @Y17XACT 89760000
         AR    R10,R0                   BUMP DISK POSTION      @Y17XACT 89770000
         B     QNK65                    DONE FOR NCP           @YM06868 89775000
         DS    0F                       WORD BNDRY                 0725 89800020
QNK000F  DC    X'000000FF'              MASK TO CLEAR ALL BUT LAST 0725 90000020
QNKNOPT  EQU   QNK000F+2                INDICATES UNUSED OPTION FLD1109 90100020
QNKMOVEO EQU   *                        MOVE OPTION DATA           0822 90200020
QNKMOVE  MVC   0(0,R10),0(R7)           MOVE INVITATION LIST       0822 90400020
QNKCOMPR CLI   DCBILCT,0                CHECK FOR INV LIST FOR REL 1209 90500020
CKRLN    CLI   DEBNMEXT-DEBNMSUB(R8),0  CK EXTS AGAINST RLN     SA56611 90550004
QNKEIGHT DC    H'8'                     USED TO ADJUST BRANCH ADDR      90600020
THREE    EQU   3                        LENGTH OF MOVE           S22024 90606022
TRMBCKUP DC    AL2(IEDQTRM-IEDNTRM)     LENGTH OF 3705 PREFIX    S22024 90612022
TEN      EQU   10                       BSC CONTROL AREA LNGTH  SA57661 90620022
EOTBIT   EQU   X'80'                    EOT-FE (BSC) IN INVLIST SA57661 90640022
X80      EQU   X'80'                    FLAG FOR BUFSIZE       @OZ26495 90644082
X60      EQU   X'60'                    FLAG FOR DIAL/ADDR     @OZ26495 90648082
X40      EQU   X'40'                    FLAG FOR DIAL DIGITS   @OZ26495 90652082
X20      EQU   X'20'                    FLAG FOR ADDR CHAR     @OZ26495 90656082
INVENTS  EQU   0                        OFFSET TO NO. OF ENTRIES A47151 90660022
INVSTAT  EQU   3                        OFFSET TO LIST STATUS    A47151 90720022
LCBBCKUP DC    AL2(LCBFLAG1-IEDQLCB)    LCB BACK UP VALUE      @Y17XACT 90780000
         SPACE 3                                                        90800020
         TAVTD                                                          91200020
         TCKPD 3330                     MERLIN VERSION OF DSECT         91400000
         TTNTD                                                          91600020
         TTRMD                                                          91800020
         TQCBD                                                          92000020
         TLCBD                                                          92200020
         DCBD  DSORG=TX                                                 92400020
         TPRIOR                                                         92500020
         TDEBD                                                          92550022
         EJECT                                                          92560005
         TPEWAD                                                         92570005
         EJECT                                                          92580005
         TPRFD                                                          92590005
         END                                                            92600020
./  ADD  SSI=63630038,NAME=IEDQNM
QNM      TITLE 'IEDQNM-ROUTINE TO BUILD CKREQ RECORD'                   00100005
IEDQNM   CSECT                                                          00200005
         SPACE 3                                                        00300005
*  CHANGE ACTIVITY AS FOLLOWS                                           00400005
******************** MICROFICHE FLAGS *********************** SUPT CODE 00500005
*A538000-539000                                                 SA51078 00600222
*D762000                                                        SA51078 00600322
*A505001-505002,510301                                          SA59179 00600405
*A516000,759000,778000                                          SA61045 00600505
*A133000-134000,283000-284000,286000,387300-389700,483400-485400,Y01004 00600605
*A759500-760500                                                  Y01004 00600705
*C186000,282000,285000,309000,450000-456000                      Y01004 00600805
*D312000                                                         Y01004 00600905
*A327000                                                       @SA74882 00601010
*D330000-333000                                                @SA74882 00601110
*C506200                                                       @OX11946 00601210
*D510200-511300,535000                                         @OX11946 00601310
         SPACE 3                                                        00900020
*********************************************************************** 01200020
*                                                                     * 01240022
*TITLE:'IEDQNM'-CKREQ FROM APPLICATION PROGRAM                        * 01250005
*                                                                     * 01260005
*MODULE-NAME=IEDQNM                                                   * 01280022
*                                                                     * 01320022
*DESCRIPTIVE-NAME=ROUTINE TO BUILD CHECKREQ RECORDS                   * 01360022
*                                                                     * 01400022
*COPYRIGHT='NONE'                                                     * 01440022
*                                                                     * 01500020
*  STATUS:  CHANGE LEVEL 5                                            * 01800005
*                                                                     * 02700020
*FUNCTION:THIS MODULE BUILDS CKREQ DISK RECORD(S) FOR ALL DESTINA-    * 03000020
*   TION QUEUES ASSOCIATED WITH THE APPLICATION PROGRAM WHICH         * 03300020
*   ISSUED THE CKREQ MACRO.                                           * 03600020
*                                                                     * 03900020
*ENTRY POINT:                                                         * 04200020
*                                                                     * 04500020
*        IEDQNM                                                       * 04800020
*                                                                     * 05100020
*INPUT:REGISTERS 2,3,9,12,14,15 CONTAIN THE FOLLOWING VALUES          * 05400020
*                                                                     * 05700020
*   2-ADDRESS OF CHECKPOINT WORK AREA                                 * 06000020
*   3-ADDRESS OF THE REQUEST ELEMENT THIS MODULE IS TO PROCESS        * 06300020
*   4-ADDRESS OF DISK RECORD IF CONTINUED FROM PREVIOUS EXECUTION       06600020
*   9-ADDRESS OF AVT                                                  * 06900020
*   12-BASE FOR IEDQNF-CHECKPOINT EXECUTOR                            * 07200020
*   14-RETURN ADDRESS-IN IEDQNF                                       * 07500020
*   15-ENTRY POINT FOR THIS MODULE                                    * 07800020
*                                                                     * 08100020
*   THE FOLLOWING REQUEST ELEMENT POINTED TO BY R3                   * 08400020
*                                                                     * 08700020
*   OFFSET 0-KEY:X'60'                                                * 09000020
*        1-ADDRESS OF CHECKPOINT QCB                                  * 09300020
*        4-LINK FIELD                                                 * 09600020
*        8-ADDRESS OF ECB                                             * 09900020
*        12- ADDRESS OF DEB CHAIN IN APPLICATION PROGRAM              * 10200020
*                                                                     * 10500020
*OUTPUT:ACKREQ DISK RECORD IS BUILT.ITS ADDRESS IS IN CKPLDRB IF      * 10800020
*   THIS IS THE FIRST RECORD BUILT FOR THIS REQUEST;IT IS IN          * 11100020
*   CKPEXCP IF NOT THE FIRST RECORD. ONE REQUEST MAY RESULT IN MORE   * 11400020
*   THAN ONE RECORD,BUT EACH ENTRY INTO THIS MODULE RESULTS IN ONLY   * 11700020
*   ONE RECORD.                                                       * 12000020
*                                                                     * 12300020
*EXTERNAL ROUTINES:                                                   * 12600020
*                                                                     * 12900020
*        IEDQTRM-DETERMINES TERMINAL ADDRESS                          * 13200020
*        IEDQEB-AQCTL (SVC 102) - PUTS IEDQNM INTO KEY ZERO      Y01004 13300005
*        MODESET-SVC 107 - GETS IEDQNM OUT OF KEY ZERO           Y01004 13400005
*                                                                     * 13500020
*EXITS-NORMAL:THIS MODULE RETURNS TO THE ADDRESS IN R14. R15          * 13800020
*   CONTAINS THE OFFSET FOR THE I/O QUEUE MANAGER.                    * 14100020
*                                                                     * 14400020
*EXITS-ERROR:THIS MODULE RETURNS TO THE ADDRESS IN R14. R15           * 14700020
*   CONTAINS THE OFFSET FOR THE NO CORE ROUTINE.                      * 15000020
*                                                                     * 15300020
*TABLES/WORK AREAS:                                                   * 15600020
*                                                                     * 15900020
*   AVT(AVTRNMPT,AVTOPTPT,AVTCLRHI)                                   * 16200020
*   CHECKPOINT WORK AREA                                              * 16500020
*   DEB                                                               * 16800020
*   TERMNAME TABLE                                                    * 17100020
*   TERMINAL TABLE                                                    * 17400020
*   QCB                                                               * 17700020
*   OPTION TABLE                                                      * 18000020
*                                                                     * 18300020
*ATTRIBUTES:REENTERABLE, RESIDENT                                Y01004 18600005
*                                                                     * 18900020
*NOTES:THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL REPRE-   * 19200020
*   SENTATION OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT TO    * 19500020
*   THE ONE USED AT ASSEMBLY TIME. THE CODING HAS BEEN ARRANGED SO    * 19800020
*   THAT REDEFINITION OF 'CHARACTER' CONSTANTS,BY REASSEMBLY, WILL    * 20100020
*   RESULT IN A CORRECT MODULE FOR THE NEW DEFINITIONS.               * 20400020
*                                                                     * 20700020
*********************************************************************** 21000020
         EJECT                                                          21100005
         SPACE 3                                                        21300020
*REGISTER ASSIGNMENTS                                                   21600020
         SPACE                                                          21900020
R0       EQU   0                                                        22200020
R1       EQU   1                        ADDRESS OF TERMINAL ENTRY       22500020
R2       EQU   2                        ADDRESS OF CKPT WORK AREA       22800020
R3       EQU   3                        ADDR OF OPTION FIELD            23100020
R4       EQU   4                        ADDRESS OF DISK RECORD          23400020
R5       EQU   5                        ADDRESS OF REQUEST ELEMENT      23700020
R6       EQU   6                        LENGTH OF OPTION FIELD          24000020
R7       EQU   7                        ADDRESS OF QCB;OPT LNGTH TB     24300020
R8       EQU   8                        OFFSET TO OPTION FIELD          24600020
RAVT     EQU   9                        ADDR OF AVT                     24900020
R10      EQU   10                       INDEX-OPTION FIELDS LOOP        25200020
R11      EQU   11                       COMPARAND-NO.OPTION FIELDS      25500020
R12      EQU   12                       BASE FOR CKPT EXECUTOR          25800020
R13      EQU   13                       ADDR OPT FIELDS-THIS ENTRY      26100020
R14      EQU   14                       RETURN REG                      26400020
R15      EQU   15                       BASE FOR THIS MODULE,RETURN    X26700020
                                        CODE OFFSET                     27000020
         SPACE 3                                                        27300020
         USING *,R15                    BASE                            27600020
         B     QNM00                    BYPASS ID                       27660005
QNMCODE  EQU   *                        AQCTL PARAMETER LIST.    Y01004 27720005
         DC    X'12'                    KEY ZERO REQUEST CODE.   Y01004 27780005
         DC    X'08'                    IEDQNM'S ACTION CODE.    Y01004 27840005
         SPACE 1                                                        27900005
         DC    AL2(QNMKEY0-IEDQNM)      OFFSET TO KEY ZERO CODE. Y01004 28500005
IEDQNM   IEDHJN                                                         28700005
QNM00    DS    0H                                                       28900005
         SPACE                                                          29100020
         USING IEDQAVTD,RAVT                                            29400020
         USING IEDQCKPD,R2                                              29700020
         USING IEDQCRED,R3              BASE FOR REQUEST ELEMENT        30000020
         USING IEDQCDRD,R4                                              30300020
         SPACE                                                          30600020
         ICM   R4,ALL,CKPEXCP           GET CURRENT EXCP RECORD. Y01004 30900005
         BZ    QNM05                    BRANCH IF NONE BEING WRITTN     31500020
         TM    CDRCKFLG,CDRCKRNC        CHECK FOR INCOMPLETE CREQ       31800020
         BZ    QNM05                    BRANCH IF NOT INCOMPLETE        32100020
         CLI   CDRKEY,CDRCKREQ          CHECK FOR CKREQ RECORD          32400020
         BNE   QNM05                    BRANCH IF NOT CKREQ             32700020
         L     R5,AVTCKPTB              CKPT QCB ELEMENT       @SA74882 32750010
         CR    R3,R5                    IS CURRENT ELEMENT     @SA74882 32800010
*                                       EQUAL TO FIRST ELEMENT @SA74882 32850010
*                                       ON QUEUE               @SA74882 32900010
         BE    QNM07                    YES                    @SA74882 32950010
         SPACE 3                                                        33600020
*ISSUE GETMAIN IN ORDER TO BUILD DISK RECORD                            33900020
         SPACE                                                          34200020
QNM05    EQU   *                                                        34500020
         LH    R10,CKPCKRLN             LENGTH OF RECORD                34800020
         LA    R11,CKPLDRB              ADDRESS TO PUT GETMAIN          35100020
         LR    R8,R15                   SAVE BASE                       35400020
         GETMAIN EC,LV=(R10),A=(R11),MF=(E,CKPGETML)                    35700020
         SPACE 3                                                        36000020
         LTR   R15,R15                  CHECK FOR INSUFFICIENT CORE     36300020
         LR    R15,R8                   RESTORE BASE                    36600020
         BNZ   QNM65                    BRANCH IF NO CORE               36900020
         L     R4,CKPLDRB                                               37200020
         SPACE                                                          37500020
QNM07    EQU   *                                                        37800020
         OI    CDRCKFLG,CDRCKRNC        TURN ON INCOMPLETE FLAG         38100020
         L     R5,CREDEB                GET DEB CHAIN FROM REQ.ELMT     38400020
         USING IEDQDEB,R5               BASE FOR DEB                    38700020
         TM    AVTPKF,AVTFTCHF          IS FETCH/PROTECT ACTIVE  Y01004 38730005
         BZ    QNM10                    BRANCH IF NO.            Y01004 38760005
         LR    R8,R15                   SAVE BASE.               Y01004 38790005
         LA    R1,QNMCODE               AQCTL PARAMETER LIST.    Y01004 38820005
         AQCTL                          GET INTO KEY ZERO.       Y01004 38850005
         SPACE 2                                                        38880005
QNMKEY0  DS    0H                       KEY ZERO ENTRY POINT.    Y01004 38910005
         LR    R15,R8                   RESTORE BASE.            Y01004 38940005
         SPACE 3                                                        39000020
*BEGINNING OF LOOP THROUGH DEB CHAIN LOOKING FOR DESTINATION Q DEBS     39300020
         SPACE                                                          39600020
QNM10    EQU   *                                                        39900020
         CLI   DEBTAMID,X'C0'           CHECK FOR TCAM INPUT DEB   0827 40200020
         BE    QNM20                    BRANCH IF TCAM INPUT       0827 40500020
         L     R5,DEBDEBAD-1            GET NEXT DEB IN CHAIN           40800020
         B     QNM10                    BRANCH TO BEGINNING OF LOOP     41100020
         SPACE 3                                                        41400020
*BUILD DISK RECORD                                                      41700020
         SPACE                                                          42000020
QNM20    EQU   *                                                        42300020
         MVI   CDRKEY,CDRCKREQ          PUT IN CKREQ KEY                42600020
         LH    R1,DEBTAMOS              GET TERMNAME OFFSET             42900020
         N     R1,AVTCLRHI              CLEAR HIGH ORDER HALF WORD      43200020
         STH   R1,CDRCKOFF                                              43500020
         L     R6,DEBQCBAD-1            ADDR OF READ AHEAD QCB          43600020
         SPACE 3                                                        43800020
*DETERMINE IF THIS IS THE LAST TCAM DEB IN THE CHAIN.                   44100020
         SPACE                                                          44400020
QNM21    EQU   *                                                        44700020
         ICM   R5,ADDR,DEBDEBAD         ADDRESS OF NEXT DEB IN   Y01004 45000005
*                                       CHAIN.                   Y01004 45300005
         BZ    QNM22                    BRANCH IF END OF CHAIN.  Y01004 45600005
         CLI   DEBTAMID,X'C0'           CHECK FOR TCAM INPUT DEB   0827 45900020
         BE    QNM25                    BRANCH IF TCAM DEB              46200020
         B     QNM21                    BRANCH TO BEGINNING OF LOOP     46500020
QNM22    EQU   *                                                        46800020
         NI    CDRCKFLG,X'FF'-CDRCKRNC  TURN OFF INCOMPLETE FLAG        47100020
QNM25    EQU   *                                                        47400020
         ST    R5,CREDEB                UPDATE REQUEST ELEMENT TO      X47700020
                                        POINT TO NEXT DEB IN CHAIN      48000020
         STM   R14,R15,CKPSAVE2         SAVE REGS                       48300020
         TM    AVTPKF,AVTFTCHF          IS FETCH/PROTECT ACTIVE  Y01004 48340005
         BZ    QNMFETCH                 BRANCH IF NO.            Y01004 48380005
         LR    R7,R1                    SAVE TERMNAME OFFSET.    Y01004 48420005
         MODESET KEY=NZERO,MODE=PROB    GET OUT OF KEY ZERO.     Y01004 48460005
         LR    R1,R7                    RESTORE TERMNAME OFFSET. Y01004 48500005
QNMFETCH EQU   *                                                 Y01004 48540005
         L     R15,AVTRNMPT             ADDRESS OF TERMNAME TABLE       48600020
         BALR  R14,R15                  GET ADDR OF TERMINAL ENTRY      48900020
         LM    R14,R15,CKPSAVE2         RESTORE REGS                    49200020
         SPACE                                                          49500020
         USING IEDQTRM,R1               BASE FOR TERMINAL ENTRY         49800020
         TM    TRMSTATE,TRMHELDN        CHECK FOR SYNC             0917 49860020
         BO    QNM26                    BRANCH IF SYNC=YES         0917 49920020
         XC    CDRCKOFF,CDRCKOFF        SET OFFSET TO 0 -NOT USED  0917 49980020
QNM26    EQU   *                                                   0917 50040020
         L     R7,TRMDESTQ-1            ADDR OF QCB                     50100020
         USING IEDQQCB,R7               BASE                            50400020
         LR    R11,R4                   SAVE BEGINNING OF DISK RCD 0827 50500020
         TM    TRMSTATE,TRMLOG          PROCESS ENTRY           SA59179 50560005
         BM    QNM27               YES,SAVE FIELDS             @OX11946 50620010
         TM    QCBDSFLG,QCBDISK         CHECK FOR DISK QUEUES           50700020
         BZ    QNM29                    BRANCH IF CORE ONLY        0910 51000020
         SPACE 3                                                        51010020
         SPACE 3                                                        51140020
*CHECKPOINT MASTER QCB FIELDS                                           51150020
         SPACE                                                          51160020
QNM27    EQU   *                                                   1217 51230020
         MVC   CDRCKMSG(CKPMCTLN),QCBMSGCT MOVE MSG CT TO RECORD        51300020
         MVC   CDRCKIN(CKPSEQLN),TRMINSEQ MOVE SEQ NO.5 TO RECORD       51600020
         ICM   R8,ADDR,TRMSTAT+ONE      GET PEWA ADDRESS        SA61045 51610005
         BZ    QNM2703                  BR NOT OPEN             SA61045 51620005
         USING  IEDQPEWA,R8                                     SA61045 51630005
         NC    EOMSAVE+ONE(2),EOMSAVE+ONE  IS THERE AN EOM BUF  SA61045 51640005
         BZ    QNM2701                  BRANCH IF NO            SA61045 51650005
         L     R8,EOMSAVE               ADDRESS OF EOM BUFFER   SA61045 51660005
         B     QNM2702                  SET SEQ OUT             SA61045 51670005
QNM2701  EQU   *                                                SA61045 51680005
         CLC   PERAQCB+1(3),AVTDELAD+1   READ AHEAD Q EMTY      SA61045 51690005
         BE    QNM2703                  BR IF EMPTY             SA61045 51700005
         L     R8,PERAQCB               BFR ON READ AHAD Q      SA61045 51710005
QNM2702  EQU   *                                                SA61045 51720005
         DROP  R8                                               SA61045 51730005
         MVC   CDRCKIN+2(2),PRFTQBCK-1-IEDQPRF(R8) SET NEW SEQ NSA61045 51740005
QNM2703  EQU   *                                                SA61045 51750005
         MVC   CDRCKQBC(CKPQBKLN),QCBQBACK  MOVE QBACK POINTERS         51900020
         SPACE 3                                                        52500020
*BEGINNING OF LOOP THROUGH PRIORITY LEVEL QCBS                          52800020
         SPACE                                                          53100020
QNM28    EQU   *                                                        53400020
         MVC   CDRCKQCB(CKPQCBLN),QCBDNHDR  MOVE PRIOR QCB PTRS         53700020
         MVC   CDRCKPQB(CKPQBKLN),QCBPQBCK                      SA51078 53800022
*                                       PRILEVEL QBACK PTR      SA51078 53900022
         CLI   QCBPRIPQ,0               CHECK FOR LAST PRIOR QCB        54000020
         BE    QNM29                    BRANCH IF LAST                  54300020
         LA    R7,QCBPSIZE(,R7)         ADD LENGTH OF PRIOR QCB         54600020
         LA    R4,CKPQCBLN(,R4)         ADD LEN TO RECORD POSITION      54900020
         B     QNM28                    LOOP                            55200020
         SPACE                                                          55500020
*END OF LOOP THROUGH PRIORITY LEVEL QCBS                                55800020
         SPACE 3                                                        56100020
QNM29    EQU   *                                                        56400020
         LR    R0,R11                   SAVE RECORD ADDRESS             56700020
         TM    TRMSTATE,TRMOPTFN        CHECK FOR OPTION FIELDS         57300020
         BZ    QNM50                    BRANCH IF OPTION NOT USED       57600020
         SPACE 3                                                        57900020
*MOVE OPTION FIELDS TO DISK RECORD(USES REGISTERS 1.3.4.5.6.7.8.10.     58200020
*11,13)                                                                 58500020
         SPACE 3                                                        58800020
*SET UP FOR LOOP                                                        59100020
         SPACE                                                          59400020
         SR    R11,R11                  CLEAR                           59700020
         IC    R11,TRMOPNO              COMPARAND-NO.OF OPTN FIELDS     60000020
         L     R13,AVTOPTPT             ADDRESS OF OPTION TABLE         60300020
         L     R7,4(0,R13)              ADDR OF OPT LENGTH TABLE        60600020
         LH    R8,TRMOPTBL              OFFST TO OPT FOR THIS ENTRY     60900020
         N     R8,AVTCLRHI              CLEAR HIGH ORDER HALF WORD      61200020
         AR    R13,R8                   GET ADDR OF OPT-THIS ENTRY      61500020
         SR    R8,R8                    CLEAR-OFFSET TO EACH OPTFLD     61800020
         SR    R6,R6                    CLEAR-LENGTH FOR MOVE           62100020
         LA    R10,TRMOPT               BEGINNING OF OPTION OFFSETS     62400020
         SPACE 3                                                        62700020
*BEGINNING OF LOOP THROUGH OPTION TABLE OFFSETS FOR THIS TERM ENTRY     63000020
         SPACE                                                          63300020
QNM40    EQU   *                                                        63600020
         LR    R5,R13                   INITIALIZE-OPTNS-THIS ENTRY     63900020
         IC    R8,0(R10)                OPTION OFFSET                   64200020
         CLI   0(R10),X'FF'             CHECK FOR UNUSED FIELD          64500020
         BE    QNM48                    BRANCH IF NOT USED              64800020
         SPACE                                                          65100020
         AR    R5,R8                    ADDRESS OF OPTION FIELD         65700020
         IC    R6,0(R7)                 LENGTH OF OPTION FIELD          66000020
         CLI   1(R7),X'D0'              CHECK OPTION TYPE        11111  66050020
         BH    QNM45                    BRANCH IF NOT ADDRESS TYPE 1111 66100020
         CLI   1(R7),X'80'              CHECK OPTION TYPE        E 111  66150020
         BH    QNM48                    BRANCH IF ADDRESS TYPE   E 1111 66200020
QNM45    EQU   *                                                 E 111  66250020
         EX    R6,QNMMOVE               MOVE OPTION FIELD TO RECORD     66300020
         LA    R4,1(R4,R6)              ADD LENGTH MOVED TO BASE OF    X66600020
                                        DISK RECORD                     66900020
QNM48    EQU   *                                                        67200020
         LA    R7,10(0,R7)              MOVE TO NEXT EXTRY IN OPTN     X67500020
                                        LENGTH TABLE                    67800020
         LA    R10,1(0,R10)             BUMP INDEX                      68100020
         BCT   R11,QNM40                SUBTRACT FROM NO.OPTN FLDS      68400020
         SPACE                                                          68700020
*END OF LOOP OPTION FIELDS                                              69000020
         SPACE 3                                                        69300020
QNM50    EQU   *                                                        69600020
         LR    R4,R0                    RESTORE RECORD BEGINNING AD     69900020
         LA    R11,CKPIOQM              OFFSET FOR QUEUE MANAGER        70200020
         C     R0,CKPEXCP               COMPARE FOR CONTINUED CKREQ     70500020
         BNE   QNM60                    BRANCH IF THIS IS 1ST RCD       70800020
         LA    R11,CKPDIOR              OFFSET FOR DISK I/O RTN         71100020
         SPACE 3                                                        71400020
*RETURN TO CHECKPOINT EXECUTOR-OFFSET FOR NEXT MODULE TO BE LOADED      71700020
*IS IN REGISTER 15                                                      72000020
         SPACE                                                          72300020
QNM60    EQU   *                                                        72600020
         LR    R15,R11                  RETURN CODE                     72900020
         BR    R14                      RETURN                          73200020
         SPACE 3                                                        73500020
*SET OFFSET FOR NO CORE MODULE AND RETURN TO CHECKPOINT EXECUTOR        73800020
         SPACE                                                          74100020
QNM65    EQU   *                                                        74400020
         LA    R15,CKPNOCOR                                             74700020
         BR    R14                                                      75000020
         SPACE 3                                                        75300020
QNMMOVE MVC    CDRCKOPT(0),0(R5)        MOVE OPTION FIELD TO RECORD     75600020
         SPACE                                                          75900020
ADDR     EQU   7                        MASK TO ICM 3-BYTE ADDRS Y01004 76000005
ALL      EQU   15                       MASK TO ICM ALL 4 BYTES. Y01004 76100005
ONE      EQU   1                        OFFSET OF ONE           SA61045 76200005
         SPACE 2                                                        76300005
         TAVTD                                                          76500020
         TCKPD 3330                                                     76800000
         TTRMD                                                          77100020
         TQCBD                                                          77400020
         TDEBAPD                                                        77700020
         TPRFD                                                          77800020
         TPEWAD                                                 SA61045 77900005
         END                                                            78000020
./  ADD  SSI=63630039,NAME=IEDQNO
         TITLE 'IEDQNO-CHECKPOINT I/O QUEUE MANAGER'                    00500020
IEDQNO   CSECT                                                          01000020
         SPACE 3                                                        01010056
*CHANGE ACTIVITY AS FOLLOWS                                             01020056
******************** MICROFICHE FLAGS *********************** SUPT CODE 01030056
*A680000                                                         A44868 01500021
*A680000                                                         A44868 01500156
*C395000-400000                                                  A44868 01500256
*A445000,453200                                                @SA71964 01500356
*A755000                                                       @SA73560 01500410
*A755400                                                      @ZA03099  01500510
*A542000                                                       @Y17XACL 01560510
         EJECT                                                 @Y17XACL 01620510
*********************************************************************** 02000020
*                                                                     * 02500020
*TITLE:IEDQNO-CHECKPOINT QUEUE MANAGER                                * 03000020
*                                                                     * 03500020
*        MODULE NAME = IEDQNO                                         * 04000056
*                                                                     * 04070056
*        DESCRIPTIVE NAME = CHECKPOINT I/O QUEUE MANAGER              * 04140056
*                                                                     * 04210056
*        COPYRIGHT = 'NONE'                                           * 04280056
*                                                                     * 04350056
*        STATUS:  CHANGE LEVEL 5                                      * 04420056
*                                                                     * 04500020
*FUNCTION:THIS MODULE PUTS DISK RECORDS ON THE CHECKPOINT I/O         * 05000020
*   QUEUE.IT UPDATES THE LAST REQUEST ELEMENT FOR WHICH A DISK        * 05500020
*   RECORD WAS BUILT. WHEN IT ENQUEUES AN ENVIRONMENT RECORD          * 06000020
*   SEGMENT,IT DEQUEUES ALL INCIDENT RECORDS AND DOES A FREEMAIN      * 06500020
*   FOR EACH.THEY ARE NOT WRITTEN ON DISK. AN INCIDENT OVERFLOW BIT   * 07000020
*   IN THE INCIDENT REQUEST ELEMENT IS TURNED ON TO INDICATE THAT     * 07500020
*   THE REQUEST WILL BE SATISFIED WHEN THE ENVIRONMENT RECORD(S) IS   * 08000020
*   WRITTEN.                                                          * 08500020
*                                                                     * 09000020
*ENTRY POINT                                                          * 09500020
*        IEDQNO                                                       * 10000020
*                                                                     * 10500020
*INPUT:REGISTERS 2,3,4,9,12,14,15 CONTAIN THE FOLLOWING VALUES:       * 11000020
*                                                                     * 11500020
*   2-ADDRESS OF CHECKPOINT WORK AREA                                 * 12000020
*   3-ADDRESS OF LAST REQUEST ELEMENT FOR WHICH DISK RCD WAS BUILT    * 12500020
*   4-ADDRESS OF LAST DISK RECORD BUILT                               * 13000020
*   9-ADDRESS OF AVT                                                  * 13500020
*   12-BASE REG FOR IEDQNF-CHECKPOINT EXECUTOR                        * 14000020
*   14-RETURN POINT-IN IEDQNF                                         * 14500020
*   15-ENTRY POINT FOR THIS MODULE                                    * 15000020
*                                                                     * 15500020
*OUTPUT:THE CHECKPOINT I/O QUEUE IS UPDATED.THE ABOVE REGISTERS       * 16000020
*   REMAIN UNCHANGED.                                                 * 16500020
*                                                                     * 17000022
*EXTERNAL ROUTINES:                                                   * 17100022
*        SVC 5 (FREEMAIN)                                             * 17200022
*                                                                     * 17500020
*EXITS-NORMAL:THIS MODULE BRANCHES TO 4 PLUS THE ADDRESS IN R14.      * 18000020
*                                                                     * 18500020
*EXITS-ERROR:NONE                                                     * 19000020
*                                                                     * 19500020
*TABLES/WORK AREAS:                                                   * 20000020
*                                                                     * 20500020
*   AVT(AVTCKELF,AVTCKPTB)                                            * 21000020
*   CHECKPOINT WORK AREA                                              * 21500020
*                                                                     * 22000020
*                                                                     * 22500020
*ATTRIBUTES:REENTERABLE                                               * 23000020
*                                                                     * 23500020
*NOTES:THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL REPRE-   * 24000020
*   SENTATION OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT TO    * 24500020
*   THE ONE USED AT ASSEMBLY TIME. THE CODING HAS BEEN ARRANGED SO    * 25000020
*   THAT REDEFINITION OF 'CHARACTER' CONSTANTS,BY REASSEMBLY, WILL    * 25500020
*   RESULT IN A CORRECT MODULE FOR THE NEW DEFINITIONS.               * 26000020
*                                                                     * 26500020
*********************************************************************** 27000020
         EJECT                                                 @Y17XACL 27200010
*REGISTER ASSIGNMENTS                                                   28000020
         SPACE                                                          28500020
R0       EQU   0                                                        29000020
R1       EQU   1                                                        29500020
R2       EQU   2                        ADDR OF CKPT WORK AREA          30000020
R3       EQU   3                        ADDRESS REQUEST ELEMENT         30500020
R4       EQU   4                        ADDR OF DISK RECORD             31000020
R5       EQU   5                                                        31500020
R6       EQU   6                        ADDR OF PREVIOUS RCD-I/O Q      32000020
R7       EQU   7                                                        32500020
R8       EQU   8                                                        33000020
R9       EQU   9                        ADDRESS OF AVT                  33500020
R10      EQU   10                                                       34000020
R11      EQU   11                                                       34500020
R12      EQU   12                                                       35000020
R13      EQU   13                       ADDR OF SAVE AREA               35500020
R14      EQU   14                       RETURN REG                      36000020
R15      EQU   15                       ENTRY POINT                     36500020
         SPACE 3                                                        37000020
*STANDARD LINKAGE                                                       37500020
         SPACE                                                          38000020
         USING IEDQNO,R15                                               38500020
IEDQNO   IEDHJN QNO00                                            S99240 39000022
         USING IEDQAVTD,R9              BASE FOR AVT                    41000020
         USING IEDQCKPD,R2              BASE FOR CKPT WORK AREA         41500020
         EJECT                                                 @Y17XACL 42000010
*PUT DISK RECORD ON I/O QUENE                                           42500020
         SPACE                                                          43000020
         L     R4,CKPLDRB               ADDRESS OF LAST DISK RCD       X43500020
                                        WHICH WAS BUILT                 44000020
         L     R5,CKPIOQL               LAST RECORD ON IO QUENE         44500020
         LA    R4,0(R4)                 CLEAR HIGH ORDER BYTE  @SA71964 44700056
         LR    R6,R4                    SET THIS RECORD AS LAST  S99240 45000022
         USING IEDQCDRD,R4              BASE FOR DISK RECORD     S99240 45040022
         CLI   CDRKEY,CDROPC            IS THIS AN OP CTL RECORD S99240 45080022
         BNE   QNO05                    NO, ONLY ONE             S99240 45120022
         USING IEDQCDRD,R6                                       S99240 45160022
QNO03    OC    CDRDATE+1(3),CDRDATE+1   CHECK FOR LAST RECORD    S99240 45200022
         BZ    QNO05                    YES, INSERT ALL RECORDS  S99240 45240022
*                                        ON I/O QUEUE            S99240 45280022
         L     R6,CDRDATE               GET NEXT RECORD ADDR.    S99240 45320022
         LA    R6,0(R6)                 CLEAR HIGH ORDER BYTE  @SA71964 45340056
         B     QNO03                    AND RELOOP               S99240 45360022
         DROP  R6                                                S99240 45400022
QNO05    XC    1(3,R6),1(R6)            CLEAR LINK FIELD OF LAST S99240 45440022
         NC    CKPIOQF+1(3),CKPIOQF+1   CHECK FOR EMPTY QUEUE           45500020
         ST    R6,CKPIOQL               PUT ADDR ON I/O QUEUE    S99240 46000022
         BZ    QNO10                    BRANCH IF EMPTY QUENE           46500020
         SPACE                                                          47000020
         IC    R6,CDRDATE-IEDQCDRD(R5)  SAVE HIGH ORDER BYTE     S99240 47500022
         ST    R4,CDRDATE-IEDQCDRD(R5)  CHAIN NEW RECORDS TO LASTS99240 47600022
         STC   R6,CDRDATE-IEDQCDRD(R5)  RESTORE HIGH ORDER BYTE  S99240 47700022
         B     QNO20                    SKIP IOQF UPDATE         S99240 48000022
QNO10    EQU   *                                                        48500020
         ST    R4,CKPIOQF               PTR TO FIRST RECORD ON QUE      49000020
         EJECT                                                 @Y17XACL 49500010
*UPDATE LAST REQUEST ELEMENT FOR WHICH A RECORD HAS BEEN BUILT          50000020
         SPACE                                                          50500020
QNO20    EQU   *                                                        51000020
         ST    R3,CKPLREB               UPDATE FIELD FOR LAST REB       51500020
         MVI   CKPLREB,X'0'             CLEAR UNSATISFIED FIELD         52000020
         USING IEDQCRED,R3              BASE FOR REQUEST ELEMENT        52500020
         TM    CREKEY,X'50'             CHECK FOR TOTAL OR MCPLOSE      53000020
         BNO   4(R14)                   BRANCH IF NOT                   53500020
         SPACE                                                          54000020
         TM    AVTCKELF,AVTCINCN        CHECK FOR INCIDENT OVERFLOW0807 54100020
         BZ    QNO25                    BRANCH IF NOT REACHED YET  0807 54200020
         CLI   CKPINCNO,AVTEZERO        ARE THERE INCIDENT     @Y17XACL 54270010
*                                       RECORDS AVAILABLE      @Y17XACL 54340010
         BNE   QNO25                    YES, BRANCH            @Y17XACL 54410010
         MVC   CKPINCNO(1),CKPINCNT     INITIALIZE COUNT OF INCIDTS     54500020
         XC    CKPTTRLI(3),CKPTTRLI     INITIALIZE INCIDENT TTR         55000020
         MVC   CKPSECLI,CKPSECIN        DATA ON TRK BEFORE 1ST INCD0416 55200000
         EJECT                                                 @Y17XACL 55500010
*AN ENVIRONMENT RECORD HAS JUST BEEN PUT ON THE I/O QUENE. REMOVE       56000020
*ANY INCIDENT RECORDS ALREADY ON I/O QUENE.                             56500020
         SPACE                                                          57000020
QNO25    EQU   *                                                   0807 57200020
         LA    R6,CKPIOQF               INIT-ADDR I/O QUENE             57500020
         SPACE 3                                                        58000020
*BEGINNING OF LOOP THROUGH RECORDS ON DISK I/O  QUENE                   58500020
         SPACE                                                          59000020
QNO30    EQU   *                                                        59500020
         L     R4,0(0,R6)               GET NEXT RECORD ON I/O Q        60000020
         USING IEDQCDRD,R4              BASE FOR DISK RECORD            60500020
         NC    1(3,R6),1(R6)            CHECK FOR END OF CHAIN          61000020
         BZ    QNO50                    BRANCH IF END                   61500020
         SPACE                                                          62000020
         CLI   CDRKEY,CDROPC            CHECK FOR INCIDENT RECORD       62500020
         BH    QNO40                    BRANCH IF NOT INCIDENT          63000020
         SPACE                                                          63500020
         OI    AVTCKELF,AVTCINCN        TURN ON INCIDENT OVERFLOW       64000020
         MVC   1(3,R6),1(R4)            REMOVE RECORD FROM CHAIN        64500020
         ST    R4,CKPLDRB               ADDR OF RCD FOR FREEMAIN        65000020
         SPACE                                                          65500020
         LH    R7,CKPINCLN              LENGTH OF INCIDENT RCD          66000020
         LA    R8,CKPLDRB               RECORD ADDRESS LOCATION         66500020
         LR    R10,R15                  SAVE BASE REG                   67000020
         FREEMAIN E,LV=(R7),A=(R8),MF=(E,CKPGETML)                      67500020
         LR    R15,R10                  RESTORE BASE REG                68000020
         B     QNO30                    BEGINNING OF LOOP        A44868 68200021
         SPACE 3                                                        68500020
QNO40    EQU   *                                                        69000020
         LR    R6,R4                    SAVE ADDR OF REQUEST ELEMT      69500020
         B     QNO30                    BEGINNING OF LOOP               70000020
         SPACE                                                          70500020
*END OF LOOP THROUGH I/O QUENE                                          71000020
         SPACE 3                                                        71500020
QNO50    EQU   *                                                        72000020
         TM    AVTCKELF,AVTCINCN        CHECK INCIDENT OVERFLOW         72500020
         BZ    4(R14)                   RETURN IF NOT ON                73000020
         SPACE 3                                                        73500020
*LOOP THROUGH REQUEST ELEMENTS AND TURN ON INCIDENT OVERFLOW IN         74000020
*EACH REQUEST ELEMENT FOR AN INCIDENT CHECKPOINT.                       74500020
         SPACE                                                          75000020
         L     R5,AVTCKPTB              GET FIRST ELEMENT ON QCB        75500020
         USING IEDQCRED,R5              BASE FOR REQUEST ELEM  @ZA03099 75540010
         CLI   CREKEY,CREREMVE          THIS CHECKPOINT REMOVAL@SA73560 75580010
*                                       ELEMENT ?              @SA73560 75660010
         BNE   QNO55                    NO BRANCH              @SA73560 75740010
         L     R5,4(0,R5)               GET NEXT ELEMENT       @SA73560 75820010
QNO55    EQU   *                                               @SA73560 75900010
         NC    CKPEXCP,CKPEXCP          CHECK CURRENT EXCP SLOT         76000020
         BNZ   QNO70                    BRANCH IF A  RECORD IS         X76500020
                                        BEING WRITTEN                   77000020
         SPACE 3                                                        77500020
*BEGINNING OF LOOP THROUGH REQUEST ELEMENTS IN QCB CHAIN.               78000020
         SPACE                                                          78500020
QNO60    EQU   *                                                        79000020
         LA    R5,0(0,R5)               CLEAR HIGH ORDER BYTE           79500020
         C     R5,CKPLREB               CHECK LAST REQUEST ELEMENT     X80000020
                                        THAT HAS A RECORD BUILT FOR    X80500020
                                        IT                              81000020
         BE    4(R14)                   RETURN IF EQUAL                 81500020
         SPACE                                                          82000020
QNO70    EQU   *                                                        82500020
         USING IEDQCRED,R5              BASE FOR REQ ELEMENT       0416 82700000
         L     R5,4(0,R5)               GET NEXT ELEMENT IN CHAIN       83000020
         CLI   CREKEY,CREOPC            CHECK FOR INCIDENT REQUEST      83500020
         BH    QNO60                    BRANCH IF NOT INCIDENT          84000020
         SPACE                                                          84500020
         OI    CREKEY,CREINCOF          INDICATE INCIDENT OVERFLOW      85000020
         B     QNO60                    CHECK FOR END OF CHAIN          85500020
         SPACE                                                          86000020
*END OF LOOP THROUGH REQUEST ELEMENTS                                   86500020
         EJECT                                                 @Y17XACL 87000010
         TAVTD                                                          88000020
         EJECT                                                 @Y17XACL 88200010
         TCKPD 3330                     MERLIN VERSION OF DSECT    0419 88500000
         END                                                            89000020
./  ADD  SSI=63630040,NAME=IEDQNP
         TITLE 'IEDQNP-CHECKPOINT DISK I/O ROUTINE'                     00200020
IEDQNP   CSECT                                                          00400020
         SPACE 3                                                        00400110
*CHANGE ACTIVITY AS FOLLOWS                                             00400210
******************** MICROFICHE FLAGS *********************** SUPT CODE 00400310
*C232000-238000                                                @SA71964 00400410
         SPACE 3                                                        00600010
*********************************************************************** 00800020
*                                                                     * 01000020
*TITLE:'IEDQNP'-CHECKPOINT DISK I/O ROUTINE                           * 01200020
*                                                                     * 01400010
*        MODULE NAME = IEDQNP                                         * 01420010
*                                                                     * 01440010
*        DESCRIPTIVE NAME =  CHECKPOINT DISK I/O ROUTINE              * 01460010
*                                                                     * 01480010
*        COPYRIGHT = 'NONE'                                           * 01500010
*                                                                     * 01520010
*        STATUS: CHANGE LEVEL 5                                       * 01540010
*                                                                     * 01560010
*                                                                     * 01600020
*FUNCTION:THIS MODULE LOCATES THE NEXT DISK RECORD TO BE WRITTEN,     * 01800020
*   DETERMINES THE PROPER TTR FOR THE RECORD,AND ISSUES AN EXCP. IF   * 02000020
*   THERE IS A RECORD IN THE CURRENT EXCP SLOT(CKPEXCP),IT IS THE     * 02200020
*   RECORD WRITTEN.IT IS A CONTINUATION OF A CHECKPOINT WHICH         * 02400020
*   REQUIRED MORE THAN ONE SEGMENT. IF CKEXCP IS ZERO, THE FIRST      * 02600020
*   RECORD ON THE DISK I/O QUEUE(CKPIOQF) IS THE ONE WRITTEN. IT IS   * 02800020
*   REMOVED FROM THE QUEUE AND PUT INTO CKPEXCP. IF THE RECORD IS     * 03000020
*   AN ENVIRONMENT OR INCIDENT,THE TIME MACRO IS USED TO PUT THE      * 03200020
*   DATE AND TIME INTO THE RECORD. THE MOETHOD USED TO DETERMINE THE  * 03400020
*   TTR DEPENDS ON THE TYPE OF RECORD. FIRST SEGMENT OF AN ENVIRON-   * 03600020
*   MENT CHECKPOINT:THE CONTROL RECORD HAS THE TTR OF ALL FIRST       * 03800020
*   SEGMENTS AND AN INDEX TO THE LATEST ONE USED.THIS MODULE PICKS    * 04000020
*   UP THE TTR WHICH SEQUENTIALLY FOLLOWS THE LATEST ONE,AND          * 04200020
*   CHANGES THE INDEX TO POINT TO THE NEW FIRST SEGMENT. ANY          * 04400020
*   ENVIRONMENT SEGMENT OTHER THAN THE FIRST:THE CHECKPOINT WORK      * 04600020
*   AREA CONTAINS THE TTR OF THE LAST SEGMENT WRTI                    * 04800020
*   AREA CONTAINS THE TTR OF THE LAST SEGMENT WRITTEN.THIS MODULE     * 05000020
*   DETERMINES THE TTR OF THE NEXT SEQUENTIAL RECORD ON DISK.         * 05200020
*   INCIDENT RECORD:THE CHECKPOINT WORK AREA CONTAINS THE TTR OF      * 05400020
*   THE LAST INCIDENT WRITTEN.THIS MODULE DETERMINES THE TTR OF THE   * 05600020
*   NEXT SEQUENTIAL RECORD ON DISK. CKREQ RECORD:THE CHECKPOINT       * 05800020
*   WORK AREA CONTAINS A CKREQ-TTR TABLE WHICH ASSOCIATES A TERM-     * 06000020
*   NAME OFFSET WITH A PARTICULAR TTR. THIS MODULE USES THE TERM-     * 06200020
*   NAME OFFSET IN THE DISK RECORD TO LOCATE THE PROPER TTR IN THE    * 06400020
*   TABLE.                                                            * 06600020
*                                                                     * 06800020
*ENTRY POINT:                                                         * 07000020
*                                                                     * 07200020
*        IEDQNP                                                       * 07400020
*                                                                     * 07600020
*INPUT:REGISTERS 2,9,12,14,15 CONTAIN THE FOLLOWING VALUES            * 07800020
*                                                                     * 08000020
*   2-ADDRESS OF CKPT WORK AREA                                       * 08200020
*   9-ADDRESS OF AVT                                                  * 08400020
*   12-BASE REG FOR CHECKPOINT EXECUTOR-IEDQNF                        * 08600020
*   14-RETURN POINT-IN IEDQNF                                         * 08800020
*   15-ENTRY POINT OF THIS MODULE                                     * 09000020
*                                                                     * 09200020
*OUTPUT:THE ABOVE REGISTERS REMAIN UNCHANGED                          * 09400020
*                                                                     * 09600020
*   THE I/O IS STARTED TO WRITE ONE DISK RECORD.                      * 09800020
*                                                                     * 10000020
*EXTERNAL ROUTINES:                                                   * 10200020
*                                                                     * 10400020
*        IECPCNVT-CONVERTS RELATIVE TTR TO ABSOLUTE DISK ADDRESS      * 10600020
*                                                                     * 10800020
*EXITS-NORMAL:THIS MODULE BRANCHES TO 4 PLUS THE ADDRESS IN R14.      * 11000020
*                                                                     * 11200020
*EXITS-ERROR:THIS MODULE ISSUES AN ERROR MESSAGE VIA WTO AND          * 11400020
*   BRANCHES TO 4 PLUS THE ADDRESS IN R14. IT REGOGNIZES AN ERROR     * 11600020
*   IF THERE IS NO TTR AVAILABLE FOR ENVIRONMENT SEGMENTS OR CKREQ    * 11800020
*   RECORDS BECAUSE THEY ALL HAVE DISK ERRORS.                        * 12000020
*                                                                     * 12200020
*TABLES/WORK AREAS:                                                   * 12400020
*                                                                     * 12600020
*   AVT (AVTCLRHI,AVTCPRCD,AVTHA3,AVTNCKPR,AVTRNMPT)                  * 12800020
*   CHECKPOINT WORK AREA                                              * 13000020
*   TERMNAME TABLE                                                    * 13200020
*   DCB                                                               * 13400020
*   DEB                                                               * 13600020
*   CVT                                                               * 13800020
*                                                                     * 14000020
*ATTRIBUTES:REENTERABLE                                               * 14200020
*                                                                     * 14400020
*NOTES:THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL REPRE-   * 14600020
*   SENTATION OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT TO    * 14800020
*   THE ONE USED AT ASSEMBLY TIME. THE CODING HAS BEEN ARRANGED SO    * 15000020
*   THAT REDEFINITION OF 'CHARACTER' CONSTANTS,BY REASSEMBLY, WILL    * 15200020
*   RESULT IN A CORRECT MODULE FOR THE NEW DEFINITIONS.               * 15400020
*                                                                     * 15600020
*********************************************************************** 15800020
         SPACE 3                                                        16000020
*REGISTER ASSIGNMENTS                                                   16200020
         SPACE                                                          16400020
R0       EQU   0                        TIME                            16600020
R1       EQU   1                        DATE,INDEX-NO.OF TOTAL RCDS     16800020
R2       EQU   2                        ADDR OF CKPT WORK AREA          17000020
R3       EQU   3                                                        17200020
R4       EQU   4                        ADDR OF DISK RECORD             17400020
R5       EQU   5                        ADDR OF INACTIVE CKREQ-TTR      17600020
R6       EQU   6                        ADDR OF CKREQ-TTR TBL ENTRY     17800020
R7       EQU   7                        TTR OF LAST RECORD-THIS TRK     18000020
R8       EQU   8                        TTR OF LAST WRITTEN RECORD      18200020
RAVT     EQU   9                        ADDR OF AVT                     18400020
R10      EQU   10                       LENGTH OF RECORD                18600020
R11      EQU   11                       INDEX-COUNT OF CKREQ-TTR       X18800020
                                        TABLE ENTRIES                   19000020
R12      EQU   12                       BRANCH REG                      19200020
R13      EQU   13                                                       19400020
R14      EQU   14                                                       19600020
R15      EQU   15                                                       19800020
         SPACE 3                                                        20000020
*STANDARD LINKAGE                                                       20200020
         SPACE                                                          20400020
         USING *,R15                    BASE REG                        20600020
         B     QNP00                                                    20800020
         DC    CL8'IEDQNP'                                              21000020
         DC    CL6'050771'              MERLIN SUPPORT           S1101  21200000
QNP00    EQU   *                                                        21400020
         USING IEDQAVTD,RAVT            BASE FOR AVT                    21600020
         SPACE                                                          21800020
         USING IEDQCKPD,R2              BASE FOR CKPT WORK AREA         22000020
         SPACE                                                          22200020
         USING IEDQCDRD,R4                                              22400020
         L     R4,CKPEXCP               ADDR OF CURRENT EXCP RECRD      22600020
         LTR   R4,R4                    CHECK FOR CONTINUED RECORD      22800020
         BNZ   QNP15                    BRANCH IF CONTINUED             23000020
         MVC   CKPEXCP+1(3),CKPIOQF+1   FIRST READ TO EXCP SLOT@SA71964 23200010
         L     R4,CKPEXCP               GET FIRST RECORD ADDR  @SA71964 23400010
         MVC   CKPIOQF+1(3),1(R4)       DEQUEUE FIRST RECORD   @SA71964 23600010
         ST    R4,CKPRW                 PUT DATA ADDR IN WRITE CCW      24000020
         MVI   CKPRW,CKPWRITE           PUT WRITE COMMAND CODE IN       24200020
QNP15    EQU   *                                                        24400020
         LH    R10,CKPINCLN             LENGTH OF INCIDENT OR CKREQ     24600020
         LA    R13,CKPSECLI             TRK DATA COUNT FOR INCIDNT 0416 24700000
         CLI   CDRKEY,CDRCKREQ          CHRCK FOR CKREQ RECORD          24800020
         BE    QNP70                    BRANCH IF CKREQ                 25000020
         SPACE 3                                                        25200020
*THIS DISK RECORD IS EITHER A TOTAL OR AN INCIDENT RECORD               25400020
         SPACE                                                          25600020
         LR    R11,R15                  SAVE REG                        25800020
         TIME  BIN                      GET TIME                        26000020
         LR    R15,R11                  RESTORE REG                     26200020
         SPACE                                                          26400020
         ST    R0,CDRTIME               PUT TIME IN DISK RECORD         26600020
         ST    R1,CDRDATE               PUT DATE IN DISK RECORD         26800020
         CLI   CDRKEY,CDRTOTAL          CHECK FOR TOTAL RECORD          27000020
         BNL   QNP85                    BRANCH IF TOTAL                 27200020
         SPACE 3                                                        27400020
*THIS DISK RECORD IS AN INCIDENT                                        27600020
         SPACE                                                          27800020
         L     R8,CKPTTRLI-1            GET TTR OF LAST INCIDENT        28000020
         LA    R8,0(0,R8)               CLEAR HIGH ORDER BYTE           28200020
         LTR   R7,R8                    CJECK NO LAST INCIDENT-AT      X28400020
                                        END OF INCIDENTS,THIS TTR      X28600020
                                        IS INITIALIZED TO ZERO          28800020
         BNZ   QNP25                    BRANCH IF NOT ZERO              29000020
         L     R0,CKPTTRIN-1            GET TTR OF 1ST INCIDENT         29200020
         B     QNP50                    CONVERT TTR                     29400020
QNP25    EQU   *                                                        29600020
         CLC   CKPTTRLI(2),CKPTTRIN     IS RCD ON FIRST TRACK WHICH    X29800020
                                        CONTAINS INCIDENTS              30000020
         BNE   QNP30                    BRANCH IF NOT ON 1ST TRACK 0707 30200020
         L     R7,CKPTTRIN-1            GET 1ST INCIDENT ON 1ST TR50707 30400020
         LA    R7,0(,R7)                CLEAR HIGH ORDER BYTE      0908 30500020
         IC    R7,CKPINRNO              TTR OF LAST RCD ON 1ST TRK 0825 30700020
         B     QNP35                                               0707 31200020
QNP30    EQU   *                                                   0707 31400020
         SPACE 3                                                        31600020
*THIS DISK RECORD IS EITHER INCIDENT OR TOTAL                           31800020
         SPACE                                                          32000020
         IC    R7,CKPIPERT              TTR OF LAST RCD ON TRACK        32200020
         SPACE                                                          32400020
QNP35    EQU   *                                                        32600020
         CR    R7,R8                    CHECK FOR LAST RCD              32800020
         BE    QNP45                    BRANCH IF END OF TRACK          33000020
         LA    R0,1(0,R8)               SET TTR-NEXT RCD SAME TRACK     33200020
         B     QNP50                                                    33400020
QNP45    EQU   *                                                        33600020
         LA    R0,CKP101(0,R8)          GET NEXT TRACK                  33800020
         IC    R0,QNPONE                FIRST RECORD                    34000020
         XC    0(2,R13),0(R13)          INITIALIZE DATA ON TRK     0421 34100000
QNP50    EQU   *                                                        34200020
         ST    R0,CKPTRMAD                                              34400020
         CLI   CDRKEY,CDRTOTAL          CHECK FOR TOTAL                 34600020
         BNL   QNP53                    BRANCH IF ENV RECORD            34800020
         MVC   CKPTTRLI(3),CKPTRMAD+1   SAVE RELATIVE TTR FOR INCID     35000020
         B     QNP55                                                    35200020
QNP53    EQU   *                                                        35400020
         MVC   CKPTTRLT(3),CKPTRMAD+1   MOVE TTR                        35600020
         CLI   CDRKEY,CDRTOTLC          CHECK FOR CONTINUED SEG         35800020
         BE    QNP55                    BRANCH IF NOT LAST SEGMENT      36000020
         XC    CKPTTRLT(3),CKPTTRLT     CLEAR TTR OF LAST ENV RCD       36200020
         SPACE 3                                                        36400020
*CONVERT RELATIVE TTR TO ABSOLUTE DISK ADDRESS                          36600020
         SPACE                                                          36800020
QNP55    EQU   *                                                        37000020
         MVC   CKPTRMAD(2),0(R13)       PUT LENGTH ON WORD BNDRY   0430 37020000
         LH    R11,CKPTRMAD             GET DATA ON TRACK          0430 37040000
         LR    R1,R11                   SAVE DATA COUNT            0416 37060000
         AR    R1,R10                   ADD LENGTH OF RCD TO BE REA0430 37080000
         STH   R1,CKPTRMAD              STORE DATA LENGTH          0430 37100000
         MVC   0(2,R13),CKPTRMAD        RESTORE DATA LEN FOR TRACK 0430 37120000
QNP56    EQU   *                                                   0416 37140000
         LR    R6,R2                    CHANGE BASE OF WORK AREA        37200020
         DROP  R2                                                       37400020
         USING IEDQCKPD,R6              TEMPORARY BASE                  37600020
         L     R13,CKPCVTPT             ADDRESS OF CVT             0416 37700000
         STM   RAVT,R2,CKPSAVE2         SAVE REGS USED BY CONVERT       37800020
         L     R15,CKPCNTTR(,R13)       GET CONVERSION RTN ADDRESS 0416 38100000
         SLL   R0,8                     POSITION TTR                    38400020
         LM    R1,R2,CKPCPARM                                           38600020
         BALR  R14,R15                  BRANCH TO CONVERSION RTN        38800020
         SPACE                                                          39000020
         LM    RAVT,R2,CKPSAVE2         RESTORE REGS                    39200020
         DROP  R6                                                       39400020
         USING IEDQCKPD,R2              RESTORE BASE                    39600020
         LR    R2,R6                                                    39800020
         SPACE 3                                                        39810000
*CHECK FOR RPS FEATURE AND IF PRESENT,CONVERT TRACK DATA COUNT INTO     39820000
*A SECTOR ID FOR THE SET SECTOR COMMAND. (MERLIN DEVICE)                39830000
         SPACE                                                          39840000
         CLI   CKPSETSC,CKPNOOP         CHECK FOR RPS FEATURE      0416 39850000
         BE    QNP60                    BRANCH IF NOT PRESENT      0416 39860000
         LR    R0,R11                   GET TRACK DATA COUNT       0416 39870000
         O     R0,QNPFLAG-2             SET FLAG FOR CNVRT  0507 S21101 39880000
         SLL   R0,CKP2BYTE              MOVE TO LOW ORDER HALF WORD0416 39890000
         IC    R0,CKPIOR                GET RECORD NUMBER          0416 39900000
         L     R15,CKPCNSEC(,R13)       GET SECTOR CONVERSION RTN  0416 39910000
         L     R2,CKPPARM2              GET UCB INDEX AND ADDR     0416 39920000
         BALR  R14,R15                  CONVERT TO SECTOR ID       0416 39930000
         LR    R2,R6                    RESTORE CKPT BASE          0416 39940000
         LM    RAVT,R2,CKPSAVE2         RESTORE REGS                    39950000
         SPACE 3                                                        40000020
*WRITE DATA PORTION OF RECORD USING EXCP,THEN RETURN TO EXECUTOR        40200020
         SPACE                                                          40400020
QNP60    EQU   *                                                   0416 40500000
         STH   R10,CKPRW+6              PUT LENGTH INTO CCW             40600020
         EXCP  CKPIOB                                                   40800020
         SPACE 3                                                        41000020
         B     4(R14)                   RETURN TO EXECUTOR-NO OTHER    X41200020
                                        LOAD NEEDED FOR THIS FUNCTN     41400020
         SPACE 3                                                        41600020
*THIS DISK RECORD IS A CKREQ RECORD                                     41800020
         SPACE                                                          42000020
QNP70    EQU   *                                                        42200020
         LH    R10,CKPCKRLN             LENGTH OF CKREQ RECORD          42400020
         L     R6,CKPCTTRB              ADDR OF CKREQ-TTR TABLE         42600020
         SR    R11,R11                  CLEAR                           42800020
         IC    R11,CKPCKRQS             GET CKREQS VALUE ON INTRO      X43000020
                                        AT LAST COLD START              43200020
         LA    R11,CKPCKRNO(0,R11)      ADD EXTRAS FOR DISK ERROR       43400020
         SR    R5,R5                    CLEAR-ADDR OF INACTIVE ENTY     43600020
*BEGINNING OF LOOP THROUGH CKREQ-TTR TABLE                              43800020
QNP75    EQU   *                                                        44000020
         TM    CKPCTFLG(R6),CKPCTDER    CHECK FOR DISK ERROR            44200020
         BO    QNP77                    BRANCH IF TTR UNUSABLE          44400020
         CLC   CDRCKOFF,CKPCTOFF(R6)    COMPARE OFFSETS-RECORD,TABL     44600020
         BNE   QNP76                    BRANCH NOT EQUAL                44800020
         LR    R5,R6                    SAVE ENTRY ADDR                 45000020
         B     QNP80                                                    45200020
QNP76    EQU   *                                                        45400020
         TM    CKPCTFLG(R6),CKPCTACT    CHECK FOR INACTIVE ENTRY        45600020
         BO    QNP77                    BRANCH IF ACTIVE                45800020
         LR    R5,R6                    SAVE INACTIVE ENTRY             46000020
QNP77    EQU   *                                                        46200020
         LA    R6,CKPCTTRL(0,R6)        MOVE TO NEXT ENTRY              46400020
         BCT   R11,QNP75                SUBTRACT FROM COUNT OF ENTR     46600020
         SPACE                                                          46800020
*END OF LOOP                                                            47000020
         SPACE 3                                                        47200020
         LTR   R5,R5                    CHECK FOR INACTIVE ENTRY        47400020
         BZ    QNP96                    BRANCH IF NO INACTIVE ENTRY     47600020
         SPACE                                                          47800020
         MVC   CKPCTOFF(2,R5),CDRCKOFF  PUT OFFSETT IN INACTIVE ENTY    48000020
QNP80    EQU   *                                                        48200020
         OI    CKPCTFLG(R5),CKPCTACT    MARK ENTRY ACTIVE               48400020
         MVC   CKPTRMAD(2),CKPCTSEC(R15) GET TRK DATA LENGTH       0416 48460000
         LH    R11,CKPTRMAD             GET LENGTH IN REG          0416 48520000
         MVC   CKPTRMAD+1(3),CKPCTTTR(R5) PUT ON WORD BNDRY             48600020
         L     R0,CKPTRMAD              GET TTR                         48800020
         B     QNP56                    WRITE CKREQ RECORD         0416 49100000
         SPACE 3                                                        49400020
*THIS DISK RECORD IS A SEGMENT OF A TOTAL ENVIRONMENT CKPT RECORD       49600020
         SPACE                                                          49800020
QNP85    EQU   *                                                        50000020
         MVC   CDRTTRLI,CKPTTRLI        SAVE LAST INC AT TIME OF EN0922 50100020
         LH    R10,CKPBPERR             GET LENGTH OF TOTAL RCD SEG     50200020
         L     R8,CKPTTRLT-1            GET TTR OF LAST TOTL WRITTN     50400020
         LA    R8,0(0,R8)               CLEAR HIGH ORDER BYTE           50600020
         LTR   R7,R8                    CHECK FOR FIRST SEGMENT-       X50800020
                                        FIELD IS SET TO ZERO WHEN      X51000020
                                        LAST SEGMENT IS WRITTEN         51200020
         BZ    QNP87                    BRANCH IF 1ST SEGMENT           51400020
         SPACE 3                                                        51600020
*THIS IS NOT THE FIRST SEGMENT                                          51800020
         SPACE                                                          52000020
         IC    R7,CKPRPERT              RCDVNO. OF LAST RCD ON TRCK     52200020
         B     QNP35                                                    52400020
         SPACE 3                                                        52600020
*THIS IS THE FIRST SEGMENT-DETERMINE TTR FOR NEXT CURRENT ENV           52800020
         SPACE                                                          53000020
QNP87    EQU   *                                                        53200020
         SR    R3,R3                    INITIALIZE SWITCH               53400020
         SR    R11,R11                  CLEAR INDEX                     53600020
         IC    R11,CKPTTRCT             GET NO. OF CURRENT TOTAL        53800020
         SR    R1,R1                    CLEAR INDEX                     54000020
         IC    R1,CKPCPRCD              GET COUNT OF TOTALS (VALUE     X54200020
                                        CPRCDS ON INTRO AT LAST        X54400020
                                        COLD START                      54600020
QNP875   EQU   *                                                        54800020
         LR    R13,R11                                                  55000020
         MH    R13,QNPHA5               MULTIPLY BY 5(LENGTH OF TTR)429 55200000
         LA    R13,CKPTTRT1(R13)        ADDRESS OF THE 1ST TTR          55400020
         SR    R1,R11                   GET INDEX FOR LOOP              55600020
         BZ    QNP90                    BRANCH IF LAST RCD IS CURNT     55800020
QNP88    EQU   *                                                        56000020
         LA    R11,1(0,R11)             GET NEXT TOTAL RECORD           56200020
         CLI   2(R13),0                 CHECK FOR DISK ERROR. A        X56400020
                                        VALID RECORD NO. CANNOT BE     X56600020
                                        ZERO.                           56800020
         BE    QNP89                    BRANCH IF THIS RCD UNUSABLE     57000020
         STC   R11,CKPTTRCT             NEW CURRENT ENV RECORD          57200020
         MVC   CKPSECLT,3(R13)          GET TRK DATA LENGTH FOR 1ST0416 57300000
         MVC   CKPTRMAD+1(3),0(R13)     MOVE TTR                        57400020
         LA    R13,CKPSECLT             SET ADDRESS                0416 57500000
         L     R0,CKPTRMAD              GET TTR                         57600020
         B     QNP50                                                    57800020
         SPACE                                                          58000020
QNP89    EQU   *                                                        58200020
         LA    R13,CKPTTRLN(,R13)       GET ADDR OF NEXT TTR       0430 58400000
         BCT   R1,QNP88                                                 58600020
         LTR   R3,R3                    CHECK SWITCH                    59200020
         BNZ   QNP95                    BRANCH IF SECOND TIME THRU      59400020
         SPACE 3                                                        59600020
*SET UP FOR LOOP TO CHECK TTRS BEFORE THE CURRENT TTR                   59800020
         SPACE                                                          60000020
         LR    R3,R15                   SET SWITCH TO NON-ZERO          60200020
QNP90    EQU   *                                                   0928 60260020
         IC    R1,CKPTTRCT              GET CURRENT ENV POSITION   0928 60320020
         SR    R11,R11                  GET FIRST TTR                   60400020
         B     QNP875                   GO THROUGH LOOP AGAIN           60600020
         SPACE                                                          60800020
*END OF LOOP THROUGH TTRS                                               61000020
         SPACE 3                                                        61200020
*THERE IS NO AVAILABLE TTR-ALL HAVE DISK ERRORS                         61400020
         SPACE                                                          61600020
QNP95    EQU   *                                                        61800020
         LA    R1,QNPTEXT               WTO MSG ADDRESS            0928 61900020
         MVI   CDRKEY,CDRTOTAL          MARK LAST SEG              0928 62000020
         B     QNP97                                                    62200020
         SPACE 3                                                        62400020
*THERE IS NO AVAILABLE CKREQ RECORD                                     62600020
         SPACE                                                          62800020
QNP96    EQU   *                                                        63000020
         MVC   CKPMSGTP,QNPCKREQ        FILL IN TYPE OF MSG             63200020
         LH    R0,CDRCKOFF              GET OFFSET FROM RECORD          63400020
         N     R0,AVTCLRHI              CLEAR HIGH ORDER HALF WORD      63600020
         BCTR  R0,0                     SUBTRACT ONE                    63800020
         SR    R1,R1                                                    64000020
         L     R3,AVTRNMPT              ADDR OF TERM NAME TABLE         64200020
         USING IEDQTNTD,R3              BASE                            64400020
         IC    R1,TNTENLEN              LENGTH OF TERM NAME             64600020
         LR    R10,R1                   SAVE LENGTH                     64800020
         LA    R1,3(0,R1)               ADD LENGTH OF ADDR              65000020
         MR    R0,R0                                                    65200020
         LA    R1,TNTFIRST(R1)          ADDR OF ENTRY                   65400020
         BCTR  R10,0                    SUBTRACT ONE                    65600020
         EX    R10,QNPMOVE              MOVE TERM NAME TO MSG           65800020
         SPACE 3                                                        66000020
*SEND ERROR MESSAGE TO CONSOLE                                          66200020
         SPACE                                                          66400020
         MVC   CKPMSGTX-2(39),QNPTEXT+2 MOVE TEXT OF ERROR MSG     0706 66800020
         LA    R1,CKPMSG                ADDRESS OF MSG                  67000020
QNP97    EQU   *                                                   0928 67100020
         SVC   35                                                       67200020
         MVI   CKPECB,X'40'             POST ECB SO DISPOSITION        X67400020
                                        WILL GET CONTROL                67600020
         SPACE 3                                                        67800020
*RETURN TO CHECKPOINT EXECUTOR-NO MORE LOADS ARE NEEDED FOR THIS        68000020
*FUNCTION                                                               68200020
         SPACE                                                          68400020
         B     4(R14)                   RETURN                          68600020
         SPACE 3                                                        68800020
QNPONE   DC    X'1'                     1ST RECORD ON A TRACK           69000020
QNPTEXT  WTO   'IED086I CHECKPOINT DISK ERROR-       ENVIRONMENT',MF=L,X69200020
               ROUTCDE=11,DESC=4                                        69400020
QNPCKREQ DC    CL20'CKREQ,'                                             69800020
QNPMOVE  MVC   CKPMSGPN(0),0(R1)                                        70000020
         DS    0F                                           0507 S21101 70050000
QNPHA5   DC    H'5'                     LENGTH OF ENV TTR ENTRY    0429 70100000
QNPFLAG  DC    X'8000'                  FLAG FOR CONVRT RTN 0507 S21101 70150000
         SPACE 3                                                        70200020
         PRINT NOGEN                                                    70400020
         TAVTD                                                          70600020
         TCKPD 3330                                                     70800000
         TTNTD                                                          71000020
         DCBD  DSORG=DA                                                 71200020
         END                                                            71400020
./  ADD  SSI=71110342,NAME=IEDQNQ
QNQ      TITLE 'IEDQNQ-CHECKPOINT NOTIFICATION AND DISPOSITION MOD'     00200010
IEDQNQ   CSECT                                                          00400010
         SPACE 3                                                        00405010
*C240300,247000,481100,483100,508000,720000,722000,724000        Y02027 00405210
*C726000,738000,768000,770000,772000,774000,776000.778000        Y02027 00405410
*C780000,782000,784000,786000,788000-790000,795000               Y02027 00405610
*D199000,238400,238800,239200,239600,240600-241500,481200-482300 Y02027 00405810
*D524000,728000,730000,732000,734000,736000,740000,742000,774400 Y02027 00406010
*D774800,775200,775600,778300,778600,778900,779200,779500        Y02027 00406210
*D792000-794100                                                  Y02027 00406410
*A301000,303000                                                  Y02027 00406610
*A508200-509200,587500,720900-721800,723600,724500-725400,727200 Y02027 00406810
*A728100-729900,730800-731700,732600-733500,734400-735300        Y02027 00407010
*A736200-737100,738900-739800,740700-741600,769000,771000,773000 Y02027 00407210
*A775000,777000,779000,781000,783000,785000,787000,796420-794680 Y02027 00407410
*A822600-823200                                                  Y02027 00407610
*A198000,238000,774000,794000                                    A42413 00410010
*C208000,240300,778300                                           A42413 00411010
*A216000,304000,794000                                          SA52951 00412010
*C204000-210000,422000-440000,480000-484000,694000,697000-698000SA52951 00413010
*A506700                                                        SA58451 00413110
*D356000                                                       @SA70674 00443110
*A218000,774000                                                @XA05298 00473110
*D778000                                                       @XA05298 00503110
*D428000                                                       @SA71082 00533110
*A420000                                                       @SA74853 00563110
*D421000                                                       @OY13275 00573110
         SPACE 3                                                        00600010
*********************************************************************** 00800010
*                                                                     * 01000010
*TITLE:'IEDQNQ'-CHECKPOINT NOTIFICATION AND DISPOSITION ROUTINE       * 01200010
*                                                                     * 01400010
*  MODULE NAME = IEDQNQ                                               * 01600010
*                                                                     * 01620010
*  DESCRIPTIVE NAME = CHECKPOINT NOTIFICATION & DISPOSITION           * 01640010
*                                                                     * 01660010
*  COPYRIGHT = ' NONE '                                               * 01680010
*                                                                     * 01700010
*  STATUS:  CHANGE LEVEL 6                                            * 01720010
*                                                                     * 01800010
*FUNCTION:THIS MODULE GET CONTROL AFTER A DISK WRITE OPERATION        * 02000010
*   CONPLETES OR AFTER A CHECKPOINT COULD NOT BE SATISFIED.IT         * 02200010
*   REMOVES THE REQUEST ELEMNT(S) FROM THE QCB CHAIN AND QPOSTS       * 02400010
*   THE ELEMENT(IF FROM AN NH MACRO) OR POSTS AN ECB(IF FROM          * 02600010
*   OPERATOR CONTROL OR AN APPLICATION PROGRAM).THE REQUEST ELEMENT   * 02800010
*   IS NOT REMOVED IF THE REQUEST HAS NOT BEEN COMPLETELY SATISFIED   * 03000010
*   (CKREQ, OPERATOR CONTROL INCIDENT, AND ENVIRONMENT CHECKPOINTS    * 03200010
*   MAY REQUIRE MULTIPLE SEGMENTS), OR IF A DISK ERROR OCCURRED ON    * 03400010
*   WRITE. IF THE LAST SEGMENT OF AN ENVIRONMENT CHECKPOINT WAS       * 03600010
*   JUST WRITTEN WITH AN INCIDENT OVERFLOW CONDITION(INDICATED IN     * 03800010
*   THE ENVIRONMENT REQUEST ELEMENT),SEVERAL INCIDENT REQUEST         * 04000010
*   ELEMENTS MAY BE REMOVED FORM THE QCB CHAIN; THE INCIDENT OVER-    * 04200010
*   FLOW BIT IN EACH INCIDENT REQUEST ELEMENT(BIT 0 OF KEY) AND IN    * 04400010
*   THE ENVIRONMENT REQUEST ELEMENT IS TURNED OFF. IF THE LAST        * 04600010
*   SEGMENT OF A CHECKPOINT WAS JUST WRITTEN,A FREEMAIN IS ISSUED     * 04800010
*   FOR THE RECORD. IF THE LAST SEGMENT OF AN ENVIRONMENT CHECK-      * 05000010
*   POINT WAS JUST WRITTEN A BIT IS TURNED ON IN EACH PCB(BIT 2 OF    * 05200010
*   PCBOFLG) TO INDICATE TO THE APPLICATION PROGRAM(S) THAT THE       * 05400010
*   CHECKPOINT WAS TAKEN,AND AN ELEMENT IS QPOSTED TO THE READY       * 05600010
*   QUEUE. IF THE REQUEST WAS FROM MCPCLOSE,THE ELEMENT IS THE        * 05800010
*   CLOSEDOWN COMPLETION QCB;OTHERWISE,IT IS THE ENVIRONMENT          * 06000010
*   REQUEST ELEMENT(TO BE PUT ON THE TIME DELAY QCB).                 * 06200010
*                                                                     * 06400010
*ENTRY POINT:                                                         * 06600010
*                                                                     * 06800010
*        IEDQNQ                                                       * 07000010
*                                                                     * 07200010
*INPUT:REGISTERS 2,9,12,14,15 CONTAIN THE FOLLOWING VALUES:           * 07400010
*                                                                     * 07600010
*   2-ADDRESS OF CHECKPOINT WORK AREA                                 * 07800010
*   9-ADDRESS OF AVT                                                  * 08000010
*   12-BASE REG FOR CHECKPOINT EXECUTOR-IEDQNF                        * 08200010
*   14-RETURN ADDRESS-IN IEDQNF                                       * 08400010
*   15-ENTRY POINT OF THIS MODULE                                     * 08600010
*                                                                     * 08800010
*OUTPUT:AN ELEMENT MAY BE QPOSTED TO THE READY QUEUE. SEE FUNCTION    * 09000010
*   FOR THE SITUATIONS.                                               * 09200010
*                                                                     * 09400010
*   A BIT IS SET FOR EACH APPLICATION PROGRAM                         * 09600010
*                                                                     * 09800010
*EXTERNAL ROUTINES:                                                   * 10000010
*                                                                     * 10200010
*        AQCTL SVC ROUTINE-QPOSTS ELEMENTS TO READY QUEUE             * 10400010
*        OS POST - CROSS MEMORY POST OF APPLICATION PROGRAM ECB       * 10600010
*        SVC 5 (FREEMAIN)                                             * 10650010
*        SVC 35 (WTO)                                                 * 10700010
*                                                                     * 10750010
*EXITS-NORMAL:IF A REQUEST WAS NOT COMPLETLY SATISFIED THE OFFSET     * 10800010
*   OF THE MODULE TO BUILD A RECORD FOR CKREQ,ICHNG,OR ENVIRONMENT    * 11000010
*   REQUESTS IS RETURNED IN R15,AND THIS MODULE BRANCHES TO THE       * 11200010
*   ADDRESS IN R14. OTHERWISE, IT BRANCHES TO 4 PLUS THE ADDRESS IN   X 11400010
*   R14.                                                              * 11600010
*                                                                     * 11800010
*EXITS-ERROR:THIS MODULE ISSUES AN ERROR MESSAGE VIA WTO. IF THE      * 12000010
*   RECORD WITH THE DISK ERROR IS CKREQ OR ENVIRONMENT,THE RECORD     * 12200010
*   IS FLAGGED IN THE CHECKPOINT WORK AREA. IT THEN BRANCHES TO THE   * 12400010
*   ADDRESS IN R14 WITH THE OFFSET OF THE DISK I/O ROUTINE,SO THAT    * 12600010
*   THE SAME RECORD CAN BE WRITTEN AT ANOTHER LOCATION.               * 12800010
*                                                                     * 13000010
*TABLES/WORK AREAS:                                                   * 13200010
*                                                                     * 13400010
*   AVT(AVTCKLE,AVTCKPTB,AVTCLOSB,AVTDELYB,AVTHA3,AVTOPCOB,           * 13600010
*       AVTPROPT)                                                     * 13800010
*   CHECKPOINT WORK AREA                                              * 14000010
*                                                                     * 14200010
*ATTRIBUTES:REENTERABLE                                               * 14400010
*                                                                     * 14600010
*NOTES:THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL REPRE-   * 14800010
*   SENTATION OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT TO    * 15000010
*   THE ONE USED AT ASSEMBLY TIME. THE CODING HAS BEEN ARRANGED SO    * 15200010
*   THAT REDEFINITION OF 'CHARACTER' CONSTANTS,BY REASSEMBLY, WILL    * 15400010
*   RESULT IN A CORRECT MODULE FOR THE NEW DEFINITIONS.               * 15600010
*                                                                     * 15800010
*********************************************************************** 16000010
         EJECT                                                          16100010
         SPACE 3                                                        16200010
*REGISTER ASSIGNMENTS                                                   16400010
         SPACE                                                          16600010
R0       EQU   0                                                        16800010
R1       EQU   1                                                        17000010
R2       EQU   2                        ADDRESS OF CKPT WORK AREA       17200010
R3       EQU   3                        ADDRESS OF REQUEST ELEMENT      17400010
R4       EQU   4                        ADDRESS OF DISK RECORD          17600010
R5       EQU   5                                                        17800010
R6       EQU   6                        ADDRESS OF PREVIOUS REQ ELM     18000010
R7       EQU   7                                                        18200010
R8       EQU   8                                                        18400010
RAVT     EQU   9                        ADDRESS OF AVT                  18600010
R10      EQU   10                       LENGTH FOR FREEMAIN             18800010
R11      EQU   11                       BRANCH REG                      19000010
R12      EQU   12                       BASE FOR CKPT EXECUTOR          19200010
R13      EQU   13                       BRANCH REG                      19400010
R14      EQU   14                       RETURN ADDR-IN CKPT EXECUTR     19600010
R15      EQU   15                       ENTRY POINT FOR THIS MODULE     19800010
         SPACE 3                                                        20000010
         USING *,R15                    BASE REG                        20200010
IEDQNQ   IEDHJN QNQ00                                            S99240 20400010
         USING IEDQAVTD,RAVT            BASE FOR AVT                    21200010
         USING IEDQCKPD,R2              BASE FOR CKPT WORK AREA         21400010
         USING IEDQCRED,R3              BASE FOR REQUEST ELEMENT        21600010
         USING IEDQCDRD,R4              BASE FOR DISK RECORD    SA52951 21700010
         L     R3,AVTCKPTB              GET QCB ELEMENT CHAIN           21800010
         CLI   CREKEY,CREREMVE          THIS CHECKPOINT REMOVAL@XA05298 21820010
*                                         ELEMENT              @XA05298 21840010
         BNE   QNQ02                    NO, BRANCH             @XA05298 21860010
         BAL   R6,QNQ78                 REMOVE THIS ELEMENT    @XA05298 21880010
         L     R3,AVTCKPTB              GET NEXT ELEMENT       @XA05298 21900010
QNQ02    EQU   *                                               @XA05298 21920010
         TM    CKPLREB,CKPNDRB          CHECK FOR UNSATISFIED REQ       22000010
         BZ    QNQ60                    BRANCH IF NOT UNSATISFIED       22200010
         SPACE 3                                                        22400010
*A CHECKPOINT REQUEST COULD NOT BE SATISFIED.REMOVE REQUEST ELEMENT     22600010
*FROM CKPT QCB CHAIN AND NOTIFY REQUESTOR.                              22800010
         SPACE                                                          23000010
         L     R6,CKPLREB               LAST REQ EL.-DISK RCD BUILT     23200010
         NC    CKPLREB+1(3),CKPLREB+1   CHECK FOR PREVIOUS ELEMENT      23400010
         BNZ   QNQ05                    BRANCH NOT ZERO                 23600010
         LA    R6,AVTCKPTB-4            GET DUMMY PREVIOUS ELEMENT      23800010
QNQ05    EQU   *                                                        24000010
         BAL   R13,GETLOCK              SET MODE AND GET LOCK    Y02027 24030010
         L     R3,4(0,R6)               NEXT REQ EL.IN CHAIN-RCD       X24200010
                                        NOT BUILD FOR IT                24400010
         MVC   5(3,R6),5(R3)            REMOVE REQ EL.FROM CHAIN        24600010
         BAL   R13,RELLOCK              SET MODE AND RELEASE LOCK|02027 24700010
         TM    CREKEY,B'01010000'       CHECK FOR ENVIRONMENT REQ       24800010
         BNO   QNQ80                    BRANCH IF NOT FOR ENV           25000010
         SPACE 3                                                        25200010
*THIS IS AN ENVIRONMENT REQUEST TO DISPOSE OF.                          25400010
         SPACE                                                          25600010
QNQ07    EQU   *                                                        25800010
         TM    AVTCKELF,AVTCINCN        CHECK FOR INCIDENT OVERFLOW     26000010
         BZ    QNQ30                    BRANCH IF NO INC OVERFLOW       26200010
         L     R3,AVTCKPTB              GET ELEMENT CHAIN FROM QCB      26400010
         LA    R6,AVTCKPTB-4            DUMMY PREVIOUS ELEMENT          26600010
         NI    AVTCKELF,X'FF'-AVTCINCN  TURN OFF INCIDENT OVERFLOW      26800010
         SPACE 3                                                        27000010
*THIS ENVIRONMENT CKPT IS A RESULT OF AN INCIDENT OVERFLOW. ALL         27200010
*INCIDENT REQUEST ELEMENTS WHICH HAVE AN OVERFLOW INDICATOR ON(HIGH     27400010
*ORDER BIT OF KEY FIELD) MUST BE REMOVED AND THE REQUESTORS             27600010
*NOTIFIED.                                                              27800010
         SPACE 3                                                        28000010
*BEGINNING OF LOOP THROUGH QCB CHAIN                                    28200010
         SPACE                                                          28400010
QNQ10    EQU   *                                                        28600010
         CLC   5(3,R6),AVTDELAD+1       CHECK FOR END OF ELMNT CHAI     28800010
         BE    QNQ30                    BRANCH IF END                   29000010
         SPACE                                                          29200010
         TM    CREKEY,CREINCOF          CHECK INCIDENT OVERFLOW BIT     29400010
         BZ    QNQ20                    BRANCH IF NOT ON                29600010
         SPACE                                                          29800010
         NI    CREKEY,X'FF'-CREINCOF    TURN OFF INCIDENT OVERFLOW      30000010
         BAL   R13,GETLOCK              SET MODE AND GET LOCK    Y02027 30100010
         MVC   5(3,R6),5(R3)            MOVE LINK FIELD TO PREVIOUS     30200010
         BAL   R13,RELLOCK              SET MODE AND RELEASE LOCKY02027 30300010
         BAL   R13,QNQ90                DETERMINE REQUESTOR,POST        30400010
         L     R3,AVTECD4(,R6)          GET NEXT ELE IN CHAIN   SA52951 30460010
         B     QNQ10                    CHECK FOR END OF CHAIN  SA52951 30520010
         SPACE                                                          30600010
QNQ20    EQU   *                                                        30800010
         LR    R6,R3                    SAVE PREVIOUS REQUEST ELEMT     31000010
         L     R3,4(0,R3)               GET NEXT ELEMENT IN CHAIN       31200010
         B     QNQ10                    GO CHECK FOR END OF CHAINS99240 31400010
         SPACE                                                          31600010
*END OF LOOP THROUGH QCB CHAIN                                          31800010
         SPACE 3                                                        32000010
*THERE IS NO INCIDENT OVERFLOW                                          32200010
         SPACE                                                          32400010
QNQ30    EQU   *                                                        32600010
         TM    AVTCKELF,AVTCMCPN        CHECK FOR MCPCLOSE REQUEST      32800010
         BZ    QNQ35                    BRANCH IF NOT MCPCLOSE REQ      33000010
         SPACE                                                          33200010
         LA    R1,AVTCLOSB              ADDR OF CLOSEDOWN COMPL QCB     33400010
         MVI   4(R1),PRICLSDN           SET LOW PRIOITY                 33600010
         LR    R0,R1                    QCB IS POSTED TO ITSELF         33800010
         NI    AVTCKELF,X'FF'-AVTCMCPN  TURN OFF REQUEST BITS           34000010
         B     QNQ40                    QPOST QCB TO READY QUEUE        34200010
QNQ35    EQU   *                                                        34400010
         MVC   AVTCKTIM,AVTCKELV        RESET CKPT TIME INTERVAL        34600010
         LA    R1,AVTCKELE              ADDRESS OF CKPT REQ ELEMENT     34800010
         LA    R0,AVTDELYB              ADDRESS TIME DELAY QCB          35000010
QNQ40    EQU   *                                                        35200010
         BAL   R11,QNQ85                QPOST                           35400010
         SPACE 3                                                        35800010
*TURN ON CHECKPOINT BIT IN EACH PCB.                                    36000010
         SPACE                                                          36200010
QNQ45    EQU   *                                                        36400010
         USING IEDQPCB,R10              BASE FOR PCB                    36600010
         LA    R10,AVTPCBPT-X'18'       DUMMY LAST PCB IN CHAIN         36800010
         SPACE 3                                                        37000010
*BEGINNING OF LOOP THROUGH ALL PCBS                                     37200010
         SPACE                                                          37400010
QNQ46    EQU   *                                                        37600010
         NC    PCBLINK(3),PCBLINK       CHECK FOR END OF CHAIN          37800010
         BZ    QNQ47                    BRANCH IF END                   38000010
         L     R10,PCBLINK-1            GET NEXT IN CHAIN               38200010
         OI    PCBOFLG,PCBCKPTN         TURN ON CKPT BIT                38400010
         B     QNQ46                    BRANCH TO LOOP                  38600010
         SPACE                                                          38800010
*END OF LOOP THROUGH PCBS                                               39000010
         SPACE 3                                                        39200010
QNQ47    EQU   *                                                        39400010
         LH    R10,CKPBPERR             LENGTH FOR ENV.DISK RCD         39600010
         SPACE 3                                                        39800010
*ISSUE FREEMAIN FOR CURRENT EXCP RECORD                                 40000010
         SPACE                                                          40200010
QNQ50    EQU   *                                                        40400010
         TM    CKPLREB,CKPNDRB          IS THIS UNSATISFIED REQUEST     40600010
         BO    QNQ55                    BRANCH IF UNSATISFIED           40800010
         SPACE                                                          41000010
         LA    R11,CKPEXCP              ADDRESS OF RCD TO FREE          41200010
         FREEMAIN E,LV=(R10),A=(R11),MF=(E,CKPGETML)                    41400010
         SPACE                                                          41600010
         XC    CKPEXCP,CKPEXCP          CLEAR CURRENT EXCP SLOT         41800010
QNQ55    EQU   *                                                        42000010
         NI    CKPLREB,AVTEFF-CKPNDRB   TURN OFF UNSATISFIED BITSA52951 42200010
         B     AVTECD4(R14)             RETURN TO CKPT EXECUTOR SA52951 43400010
         SPACE 3                                                        44200010
*THE DISK RECORD IN THE CURRENT EXCP SLOT HAS BEEN WRITTEN. DISPOSE     44400010
*OF IT. DETERMINE IF REQUEST IS COMPLETED.                              44600010
         SPACE                                                          44800010
QNQ60    EQU   *                                                        45000010
         L     R4,CKPEXCP               ADDR OF DISK RCD JUST WRITN     45200010
         MVI   CKPECB,0                 CLEAR ECB COMPLETION CODE       45400010
         TM    CKPIOECB,X'7F'           CHECK FOR DISK ERROR            45600010
         BNO   QNQ82                    BRANCH IF DISK ERROR            45800010
         CLI   CDRKEY,CDRTOTLC          CHECK FOR TOTAL(NOT LASTSEG     46000010
         BNE   QNQ65                    BRANCH NOT TOTAL-LAST SEG       46200010
QNQ63    EQU   *                                                        46400010
         LA    R15,CKPENV               OFFSET FOR MODULE TO BUILD     X46600010
                                        NEXT SEGMENT OF ENV CKPT        46800010
         BR    R14                      RETURN TO EXECUTOR              47000010
         SPACE                                                          47200010
QNQ65    EQU   *                                                        47400010
         CLI   CDRKEY,CDRTOTAL          CHECK FOR ENV-LAST SEGMENT      47600010
         BNE   QNQ67                    BRANCH IF NOT ENV RCD           47800010
         LA    R6,AVTCKPTB-AVTECD4      DUMMY PREVIOUS ELEMENT  SA52951 48000010
         LA    R13,AVTCKELE             ADDR OF CKPT ELEMENT    SA52951 48010010
         ST    R13,CKPTRMAD             SAVE ADDR FOR COMPARE   SA52951 48020010
QNQ66    EQU   *                                                SA52951 48030010
         CLC   OFFST5(L3,R6),CKPTRMAD+ONE IS THIS THE CKPT ELE  SA52951 48040010
         BE    QNQ6605                  IF SO,REMOVE FROM CHAIN SA52951 48050010
         SPACE 1                                                        48060010
         L     R6,AVTECD4(,R6)          NEXT ELEMENT IN CHAIN   SA52951 48070010
         B     QNQ66                    TEST FOR CKPT ELEMENT   SA52951 48080010
         SPACE 1                                                        48090010
QNQ6605  EQU   *                                                SA52951 48100010
         BAL   R13,GETLOCK              SET MODE AND GET LOCK    Y02027 48110010
         MVC   OFFST5(L3,R6),AVTCKELE+OFFST5 REMOVE CKPT ELE    SA52951 48240010
         CLC   CKPLREB+ONE(L3),CKPTRMAD+ONE WAS LAST DISK RCD   SA52951 48250010
*                                       BUILT FOR CKPT ELEMENT  SA52951 48260010
         BNE   QNQ6609                  IF NOT, BYPASS CLEAR    SA52951 48270010
         XC    CKPLREB,CKPLREB          CLEAR ELEMENT POINTER   SA52951 48280010
         SPACE 1                                                        48290010
QNQ6609  EQU   *                                                SA52951 48300010
         BAL   R13,RELLOCK              SET MODE AND RELEASE LOCKY02027 48310010
         B     QNQ07                    DISPOSE OF ENVIRON. REQ. S99240 48600010
         SPACE                                                          48800010
QNQ67    EQU   *                                                        49000010
         TM    CDRCKFLG,CDRCKRNC        CHECK FOR REQ NOT COMPLETED     49200010
         BZ    QNQ75                    BRANCH NOT CKREQ CONTINUED      49400010
         CLI   CDRKEY,CDRCKREQ          CHECK FOR CKREQ RECORD          49600010
         BNE   QNQ75                    BRANCH IF NOT CKREQ             49800010
         LA    R15,CKPCKREQ             OFFSET FOR CKREQ RTN            50000010
         BR    R14                      RETURN TO EXECUTOR              50200010
         SPACE                                                          50400010
QNQ75    EQU   *                                                        50600010
         LA    R6,QNQ80                 LOAD BR REG            @XA05298 50610010
         CLI   CDRKEY,CDROPC            WAS OPERATOR CONTROL     S99240 50620010
*                                        INCIDENT RECORD WRITTEN S99240 50640010
         BNE   QNQ78                    NO, REMOVE REQ ELEMENT   S99240 50660010
         LH    R10,CKPINCLN             FREEMAIN LNGTH FOR INCIDSA58451 50670010
         TM    CDRTTRLI+2,2             IS THIS THE LAST SEGMENT S99240 50680010
         BZ    QNQ50                    NO, FREE THIS RECORD AND S99240 50700010
*                                        RETURN TO WRITE NEXT    S99240 50720010
QNQ78    EQU   *                                                 S99240 50740010
         BAL   R13,GETLOCK              SET MODE AND GET LOCK    Y02027 50800010
         CLC   AVTCKPTB+1(3),CKPLREB+1  CHK PREVIOUS ELEMENT     Y02027 50820010
         BNE   QNQ79                    BR IF NOT EQUAL TO FIRST Y02027 50840010
         XC    CKPLREB,CKPLREB          CLEAR ADDR OF ELEMENT    Y02027 50860010
QNQ79    EQU   *                                                 Y02027 50880010
         MVC   AVTCKPTB+1(3),5(R3)      DELINK ELEMENT           Y02027 50900010
         BAL   R13,RELLOCK              SET MODE AND RELEASE LOCKY02027 50920010
         BR    R6                       RETURN                 @XA05298 50960010
QNQ80    EQU   *                                                        51000010
         BAL   R13,QNQ90                DETERMINE REQUESTOR,POST        51200010
         B     QNQ50                    FREEMAIN                        51400010
         SPACE 3                                                        51600010
*THERE WAS A DISK ERROR IN THE LAST RECORD WRITTEN                      51800010
         SPACE                                                          52000010
QNQ82    EQU   *                                                        52200010
         CLI   CDRKEY,CDRCKREQ          CHECK RECORD TYPE               52600010
         BL    QNQ84                    INCIDENT                        52800010
         BH    QNQ83                    ENV                             53000010
         SPACE 3                                                        53200010
*CKREQ RECORD                                                           53400010
         SPACE                                                          53600010
         L     R8,CKPCTTRB              ADDRESS OF CKREQ TTR RABLE      53800010
         SPACE 3                                                        54000010
*BEGINNING OF LOOP THROUGH CKREQ-TTR TABLE                              54200010
         SPACE                                                          54400010
QNQ825   EQU   *                                                        54600010
         TM    CKPCTFLG(R8),CKPCTDER    CHECK FOR DISK ERROR            54800010
         BO    QNQ827                   BRANCH IF ERROR                 55000010
         CLC   CDRCKOFF,CKPCTOFF(R8)    COMPARE OFFSETS                 55200010
         BE    QNQ829                   BRANCH IF EQUAL                 55400010
QNQ827   EQU   *                                                        55600010
         LA    R8,CKPCTTRL(0,R8)        MOVE TO NEXT ENTRU              55800010
         B     QNQ825                   LOOP TO NEXT ENTRY              56000010
         SPACE                                                          56200010
*END OF LOOP THROUGH CKREQ-TTR TABLE                                    56400010
         SPACE 3                                                        56600010
QNQ829   EQU   *                                                        56800010
         OI    CKPCTFLG(R8),CKPCTDER    TURN ON DISK ERROR FLAG         57000010
         B     QNQ84                    WRITE ERROR MESSAGE             57200010
         SPACE 3                                                        57400010
*ENVIRONMENT SEGMENT                                                    57600010
         SPACE                                                          57800010
QNQ83    EQU   *                                                        58000010
         CLC   CKPRW+6(2),CKPCRLEN      CHECK FOR CONTROL RECORD        58200010
         BNE   QNQ835                   BRANCH IF NOT CONTROL RCD  0217 58300010
         WTO   'IED087I CHECKPOINT DISK ERROR-CONTROL RECORD',     0217X58400010
               ROUTCDE=11,DESC=4                                        58500010
         B     QNQ845                   BRANCH TO EXIT CODE        0217 58600010
QNQ835   EQU   *                                                   0217 58700010
         SR    R7,R7                    CLEAR FOR IC             Y02027 58750010
         IC    R7,CKPTTRCT              CORRENT ENV TTR                 58800010
         MH    R7,AVTHA3                MULTIPLY BY 3                   59000010
         LA    R7,CKPTTRT1-3(R7)        ADDRESS OF TTR             0217 59200010
         XC    0(3,R7),0(R7)            CLEAR TTR                       59400010
         SPACE 3                                                        59600010
*INCIDENT RECORD                                                        59800010
         SPACE                                                          60000010
QNQ84    EQU   *                                                        60200010
         WTO   'IED084I CHECKPOINT DISK ERROR-RECOVERED',          0217X60300010
               ROUTCDE=11,DESC=4                                        60400010
QNQ845   EQU   *                                                        60600010
         LA    R15,CKPDIOR              OFFSET FOR DISK I/O ROUTINE     61800010
         BR    R14                      RETURN TO EXICUTOR              62000010
         SPACE 3                                                        62200010
*SUBROUTINE TO SET UP REGISTERS FOR DISPATCHER TO QPOST ELEMENT TO      62400010
*THE READY QUENE. REGISTER 11 IS THE BRANCH REG.                        62600010
         SPACE                                                          62800010
QNQ85    EQU   *                                                        63000010
         ST    R0,CKPTRMAD              ADDR OF QCB                     63200010
         MVC   1(3,R1),CKPTRMAD+1       PUT QCB ADDR IN REQ ELEMENT     63400010
QNQ86    EQU   *                                                   1016 63500010
         XC    5(3,R1),5(R1)             CLEAR LINK FIELD               63600010
         LR    R0,R1                    DUPLICATE ADDRESS               63800010
         STM   R0,R1,CKPSAVE2           PUT INTO PARM LIST              64000010
         MVI   CKPSAVE2,X'0C'           PUT IN 1ST BYTE                 64200010
QNQ87    EQU   *                                                        64400010
         LA    R1,CKPSAVE2              ADDRESS OF PARM LIST            64600010
         LR    R5,R15                   SAVE REG                        64800010
         AQCTL                          POST ELEMENT TO READY Q         65000010
         LR    R15,R5                   RESTORE REG                     65200010
         SPACE                                                          65400010
         BR    R11                      RETURN                          65600010
         SPACE                                                          65800010
*END OF SUBROUTINE                                                      66000010
         SPACE 3                                                        66200010
*SUBROUTINE TO DETERMINE CKPT REQUESTOR AND POST IT COMPLETE            66400010
*REGISTER 13 IS BRANCH REG                                              66600010
QNQ90    EQU   *                                                        66800010
         SPACE                                                          67000010
         LH    R10,CKPINCLN             FREEMAIN LENGTH FOR INCIDNT     67200010
         LR    R1,R3                    ADDR OF ELEMENT FOR READY Q1016 67300010
         CLI   CREKEY,CREOPC            CHECK FOR OPERATOR CONTROL      67400010
         BNE   QNQ92                    BRANCH IF NOT OP CONTROL        67600010
         SPACE                                                          67800010
         LA    R0,AVTOPCOB              ADDR OPC QCB               1013 67900010
         BAL   R11,QNQ85                POST ELEMENT TO READY QUEUE1016 68000010
         BR    R13                      RETURN                     1016 68200010
         SPACE                                                          68400010
QNQ92    EQU   *                                                        68600010
         CLI   CREKEY,CRELCB            CHECK FOR LCB FROM MH           68800010
         BNE   QNQ94                    BRANCH IF NOT LCB               69000010
         SPACE                                                          69200010
         USING IEDQLCB,R3                                               69400010
         LA    R11,LCBERB-IEDQLCB       OFFSET FOR ERB INTO LCB    1016 69600010
         SR    R3,R11                   ADDR OF LCB BEGINNING      1016 69700010
         LR    R1,R3                    COPY LCB ADDR FOR POST     1021 69800010
         L     R11,LCBSCBA-1            ADDRESS OF SCB                  70000010
         USING IEDQSCB,R11                                              70200010
         NI    SCBSTATE,X'FF'-SCBCKPT   TURN OFF CHECKPT BIT            70400010
         BAL   R11,QNQ86                POST ELEMENT TO READY QUEUE1016 70900010
         BR    R13                      RETURN FROM SUBROUTINE          71400010
         SPACE                                                          71600010
QNQ94    EQU   *                                                        71800010
         LR    R11,R3                   ADDRESS OF CRE - IT IS   Y02027 72000010
*                                       LOCATED IN AIB           Y02027 72090010
         SH    R11,AVTHA16              BACK UP TO AIB           Y02027 72180010
         USING IEDQAIB,R11              ADDRESSABILITY OF AIB    Y02027 72270010
         MVC   AIBCMPTC(4),AIBCKECB     STORE ECB IN LIST        Y02027 72360010
         L     R1,AIBPCBAD              GET PCB ADDRESS          Y02027 72450010
         L     R1,PCBPEBAD-IEDQPCB(R1)  GET PEB ADDRESS          Y02027 72540010
         LTR   R1,R1                    TEST IF AP IS ACTIVE     Y02027 72630010
         BZ    BYPASS                   BRANCH IF NO TO AVOID    Y02027 72720010
*                                       XMPOST                   Y02027 72810010
         L     R1,PEBASCB-IEDQPEB(R1)   GET ASCB ADDRESS         Y02027 72900010
         LTR   R1,R1                    TEST IF FLAG HAS         Y02027 72990010
*                                       INVALIDATED ASCB ADDRESS Y02027 73080010
         BM    BYPASS                   BRANCH IF NEGATIVE - FLAGY02027 73170010
*                                       ON - AVOID XMPOST        Y02027 73260010
         ST    R1,AIBCMPTC+FOUR         STORE IN LIST            Y02027 73350010
         L     R1,CVTPTR                ADDRESS OF CVT           Y02027 73440010
         LA    R1,CVTBRET(R1)           GET ERROR ADDRESS -BR 14 Y02027 73530010
         ST    R1,AIBCMPTC+EIGHT        STORE IN LIST            Y02027 73620010
         LA    R1,AIBCMPTC              GET ADDR OF LIST         Y02027 73710010
         LR    R5,R15                   SAVE REG                 Y02027 73800010
         SR    R0,R0                    ZERO COMPLETION CODE     Y02027 73890010
         POST  ,(0),MF=(E,(1))                                   Y02027 73980010
         LR    R15,R5                   RESTORE REGISTER         Y02027 74070010
BYPASS   EQU   *                                                 Y02027 74160010
         CLI   CDRKEY,CDRCKREQ          CHECK FOR CKREQ                 74400010
         BCR   7,R13                    BRANCH IF NOT CKREQ             74600010
         LH    R10,CKPCKRLN             LENGTH OF CKREQ RCD             74800010
         BR    R13                      RETURN FROM SUBROUTINE          75000010
         SPACE 3                                                        75200010
GETLOCK  EQU   *                                                 Y02027 76800010
         LR    R5,R15                   SAVE REG                 Y02027 76900010
         LR    R7,R14                   SAVE REG                 Y02027 77000010
         MODESET MODE=SUP               SET TO SUPERVISOR STATE  Y02027 77100010
         MODESET EXTKEY=SUPR            SET TO KEY ZERO          Y02027 77200010
SETATSK  EQU   *                                                 Y02027 77300010
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,REGS=USE,               C77400010
               RELATED=ATTACHED-TASKS-IGG019RO/IGG019RB(SETATSK) Y02027 77500010
         LR    R15,R5                   RESTORE REG              Y02027 77600010
         LR    R14,R7                   RESTORE REG              Y02027 77700010
         BR    R13                      RETURN                   Y02027 77800010
         SPACE 3                                                 Y02027 77900010
RELLOCK  EQU   *                                                 Y02027 78000010
         LR    R7,R14                   SAVE REG                 Y02027 78100010
         LR    R5,R15                   SAVE REG                 Y02027 78200010
         SETLOCK RELEASE,TYPE=LOCAL,REGS=USE,                          C78300010
               RELATED=ATTACHED-TASKS-IEDQNQ(SETATSK)            Y02027 78400010
         MODESET EXTKEY=TCAM            SET TO TCAM KEY          Y02027 78500010
         LR    R15,R5                   RESTORE BASE REG         Y02027 78600010
         MODESET MODE=PROB              SET TO PROBLEM STATE     Y02027 78700010
         LR    R14,R7                   RESTORE REG              Y02027 78800010
         LR    R15,R5                   RESTORE REG              Y02027 78900010
         BR    R13                      RETURN                   Y02027 79000010
* EQUATED SYMBOLS                                               SA52951 79420010
         SPACE 1                                                        79430010
ONE      EQU   1                        CONSTANT ONE            SA52951 79440010
L3       EQU   3                        LENGTH OF THREE         SA52951 79450010
OFFST5   EQU   5                        OFFSET OF FIVE          SA52951 79460010
FOUR     EQU   4                        DISPLACEMENT             Y02027 79462010
EIGHT    EQU   8                        DISPLACEMENT             Y02027 79464010
CVTPTR   EQU   16                       PTR TO CVT               Y02027 79466010
CVTBRET  EQU   X'52'                    OFFSET IN CVT TO BR 14   Y02027 79468010
         EJECT                                                  SA52951 79470010
         IHAPSA                         DSECT FOR SETLOCK        Y02027 79500010
         SPACE 3                                                        79600010
         SPACE 3                                                        80600010
         TCKPD 3330                     MERLIN VERSION      0512 S21101 80800010
         TAVTD                                                          81200010
         TDISPD                                                         81400010
         TPCBD                                                          81600010
         TLCBD                                                          81800010
         TSCBD                                                          82000010
         TPRIOR                                                         82200010
         TAIBD EXT=(CKREQ)                                       Y02027 82260010
         TPEBD                                                   Y02027 82320010
         END                                                            82400010
./  ADD  SSI=63630042,NAME=IEDQNR
         TITLE 'IEDQNR-NO CORE ROUTINE'                                 00600020
IEDQNR   CSECT                                                          01200020
         SPACE 3                                                        01200110
* CHANGE ACTIVITY AS FOLLOWS;                                           01200210
******************** MICROFICHE FLAGS *********************** SUPT CODE 01200310
*C810000                                                        SA54155 01200410
         SPACE 3                                                        01800020
*********************************************************************** 02400020
*                                                                     * 03000020
*TITLE:'IEDQNR'-NO AVAILABLE CORE ROUTINE                             * 03600020
*                                                                       03680010
*  MODULE NAME = IEDQNR                                               * 03760010
*                                                                     * 03840010
*  DESCRIPTIVE NAME = NO CORE ROUTINE                                 * 03920010
*                                                                     * 04000010
*        COPYRIGHT='NONE'                                             * 04080010
*                                                                     * 04200020
*STATUS:CHANGE LEVEL 0                                                * 04800020
*                                                                     * 05400020
*FUNCTION:THIS MODULE GETS CONTROL WHEN A CONDITIONAL GETMAIN FOR     * 06000020
*   A CHECKPOINT RECORD CANNOT BE SATISFIED. IT CHECKS FOR OTHER      * 06600020
*   GETMAIN RECORDS ON THE CHECKPOINT DISK I/O QUEUE;IF THERE ARE     * 07200020
*   SOME,IT RETURNS TO THE EXECUTOR TO WAIT FOR THE RECORDS TO BE     * 07800020
*   FREED;IF THERE ARE NO RECORDS,IT CONVERTS THE LENGTH OF THE       * 08400020
*   GETMAIN REQUEST,BUILDS AN ERROR MESSAGE,AND INDICATES NO DISK     * 09000020
*   RECORD BUILT FOR THE REQUEST ELEMENT.                             * 09600020
*                                                                     * 10200020
*ENTRY POINT:                                                         * 10800020
*                                                                     * 11400020
*        IEDQNR                                                       * 12000020
*                                                                     * 12600020
*INPUT:REGISTERS 2,3,9,12,14,15 CONTAIN THE FOLLOWING VALUES:         * 13200020
*                                                                     * 13800020
*   2-ADDRESS OF CHECKPOINT WORK AREA                                 * 14400020
*   3-ADDRESS OF REQUEST ELEMENT                                      * 15000020
*   9-ADDRESS OF AVT                                                  * 15600020
*   12-BASE REGISTER FOR CHECKPOINT EXECUTOR-IEDQNF                   * 16200020
*   14-RETURN POINT IN IEDQNF                                         * 16800020
*   15-ENTRY POINT FOR THIS MODULE                                    * 17400020
*                                                                     * 18000020
*OUTPUT:NONE                                                          * 18600020
*                                                                     * 19200020
*EXTERNAL ROUTINES:NONE                                               * 19800020
*                                                                     * 20400020
*EXITS-NORMAL:THIS MODULE RETURNS TO 8 PLUS THE ADDRESS IN R14.       * 21000020
*                                                                     * 21600020
*EXITS-ERROR:THIS MODULE ISSUES AN ERROR MESSAGE VIA WTO AND          * 22200020
*   BRANCHES TO THE ADDRESS IN R14 WITH THE OFFSET FOR THE NOTIFI-    * 22800020
*   CATION-DISPOSITION ROUTINE IN R15.                                * 23400020
*                                                                     * 24000020
*TABLES/WORK AREAS:                                                   * 24600020
*                                                                     * 25200020
*   AVT(AVTCLRHI,AVTRNMPT)                                            * 25800020
*   CHECKPOINT WORK AREA                                              * 26400020
*   TERMNAME TABLE                                                    * 27000020
*                                                                     * 27600020
*ATTRIBUTES:REENTERABLE                                               * 28200020
*                                                                     * 28800020
*NOTES:THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL REPRE-   * 29400020
*   SENTATION OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT TO    * 30000020
*   THE ONE USED AT ASSEMBLY TIME. THE CODING HAS BEEN ARRANGED SO    * 30600020
*   THAT REDEFINITION OF 'CHARACTER' CONSTANTS,BY REASSEMBLY, WILL    * 31200020
*   RESULT IN A CORRECT MODULE FOR THE NEW DEFINITIONS.               * 31800020
*                                                                     * 32400020
*********************************************************************** 33000020
         SPACE 3                                                        33600020
*REGISTER ASSIGNMENTS                                                   34200020
         SPACE                                                          34800020
R0       EQU   0                                                        35400020
R1       EQU   1                                                        36000020
R2       EQU   2                                                        36600020
R3       EQU   3                        ADDRESS OF REQUEST ELEMENT      37200020
R4       EQU   4                                                        37800020
R5       EQU   5                                                        38400020
R6       EQU   6                                                        39000020
R7       EQU   7                                                        39600020
R8       EQU   8                        ADDRESS OF TERMNAME TABLE       40200020
RAVT     EQU   9                        ADDRESS OF AVT                  40800020
R10      EQU   10                       LENGTH OF TERM NAME             41400020
R11      EQU   11                                                       42000020
R12      EQU   12                       BASE FOR CHECKPOINT UXECUTR     42600020
R13      EQU   13                                                       43200020
R14      EQU   14                       RETURN ADDRESS-IN IEDQNF        43800020
R15      EQU   15                       ENTRY POINT-FOR THIS MODULE     44400020
         SPACE 3                                                        45000020
         USING *,R15                                                    45600020
         USING IEDQAVTD,RAVT            BASE FOR AVT                    46200020
         USING IEDQCKPD,R2              BASE FOR CHECKPT WORK AREA      46800020
         USING IEDQCRED,R3              BASE FOR REQUEST ELEMENT        47400020
         SPACE                                                          48000020
         B     QNR00                                                    48600020
         DC    CL8'IEDQNR'                                              49200020
         DC    CL6'042171'                                              49800000
QNR00    EQU   *                                                        50400020
         NC    CKPEXCP,CKPEXCP          CHECK FOR EXCP IN PROGRESS      51000020
         BNZ   8(R14)                   RETURN TO EXECUTOR IF EXCP     X51600020
                                        IS IN PROGRESS-WAIT FOR I/O     52200020
         SPACE                                                          52800020
         OI    CKPLREB,CKPNDRB          INDICATE NO DISK RECORD        X53400020
                                        BUILT FOR REQUEST ELEMENT       54000020
         SPACE                                                          54600020
*BUILD ERROR MESSAGE FOR WTO                                            55200020
         SPACE 3                                                        55800020
         L     R1,CKPGETML              GET LENGTH FROM GETMAIN        X56400020
                                        PARAMETER LIST                  57000020
         CVD   R1,CKPCNVRT              CONVERT LENGTH TO DECIMAL       57600020
         UNPK   CKPMSGGL(4),CKPCNVRT(8) UNPACK                          58200020
         OI    CKPMSGGL+3,X'F0'         SET UP LAST ZONE FIELD          58800020
         CLI   CREKEY,CRECKREQ          CHECK KEY OF REQUEST ELEMNT    X59400020
                                        FOR TYPE OF RECORD              60000020
         BL    QNR20                    BRANCH IF INCIDENT              60600020
         BE    QNR30                    BRANCH IF CKREQ                 61200020
         SPACE                                                          61800020
         MVC   CKPMSGTP,QNRENVRN        MOVE 'ENVIRONMENT' TO MSG       62400020
         B     QNR40                    WTO                             63000020
QNR20    EQU   *                                                        63600020
         MVC   CKPMSGTP,QNRINCDT        MOVE 'INCIDENT' TO MSG          64200020
         B     QNR40                    WTO                             64800020
         SPACE                                                          65400020
*A CKREQ RECORD IS INVOLVED,GET NAME OF PRECESS ENTRY                   66000020
         SPACE 3                                                        66600020
QNR30    EQU   *                                                        67200020
         MVC   CKPMSGTP,QNRCKREQ        MOVE 'CKREQ' TO MSG             67800020
         LH    R0,CREOFFS               GET TERMNAME OFFSET FROM       X68400020
                                        REQUEST ELEMENT                 69000020
         N     R0,AVTCLRHI              CLEAR HIGH ORDER BYTE           69600020
         BCTR  R0,0                     SUBTRACT ONE                    70200020
         SR    R1,R1                    CLEAR                           70800020
         L     R8,AVTRNMPT              ADDRESS OF TERMNAME TABLE       71400020
         USING IEDQTNTD,R8              BASE                            72000020
         IC    R1,TNTENLEN              LENGTH OF TERM NAME             72600020
         LR    R10,R1                   SAVE                            73200020
         LA    R1,3(0,R1)               GET LENGTH OF TERNAMEENTRY      73800020
         MR    R0,R1                                                    74400020
         LA    R1,TNTFIRST(R1)          GET ADDR OF ENTRY               75000020
         BCTR  R10,0                    SUBTRACT ONE FOR EXECUTE        75600020
         EX    R10,QNRMOVE              MOVE PROCESS NAME TO MSG        76200020
QNR40    EQU   *                                                        76800020
         MVC   CKPMSGTX,QNRTEXT         MOVE TEXT TO MESSAGE            77400020
         LA    R1,CKPMSG                ADDR OF MSG                     78000020
         WTO   MF=(E,(1))                                               78600020
         LA    R15,CKPNOTIF             OFFSET FOR NOTIFICATION RTN     79200020
         BR    R14                      RETURN TO EXECUTOR              79800020
         SPACE 3                                                        80400020
QNRTEXT  DC    CL37'IED010I CHECKPOINT-INSUFFICIENT CORE-'              81000010
QNRENVRN DC    CL20'ENVIRONMENT'                                        81600020
QNRINCDT DC    CL20'INCIDENT'                                           82200020
QNRCKREQ DC    CL20'CKREQ,'                                             82800020
QNRMOVE  MVC   CKPMSGPN(0),0(R1)                                        83400020
         SPACE 3                                                        84000020
         PRINT NOGEN                                                    84600020
         TAVTD                                                          85200020
         TCKPD 3330                     MERLIN VERSION             0421 85800000
         TTNTD                                                          86400020
         END                                                            87000020
./  ADD  SSI=81650028,NAME=IEDQNS
QNS      TITLE 'IEDQNS-INCIDENT OVERFLOW ROUTINE'                       00600020
IEDQNS   CSECT                                                          01200020
         SPACE 3                                                        01260061
* CHANGE ACTIVITY AS FOLLOWS                                            01320061
*A444000,684000,852000,894000,912000                             A42413 01400021
*C492000,691000,865000                                           A42413 01600021
*C048000,522000,570000,672000,822000                            OX02188 01600105
*A447000,594000,684000,852000,882000                            OX02188 01600205
* A711900                                                      @ZA02087 01690261
*A448000,558000,618000                                         @OZ17605 01710200
*C840000                                                       @OZ17605 01730200
*C886000                                                       @OY20868 01730382
*D840000                                                       @OZ32708 01730482
         SPACE 3                                                        01800020
*********************************************************************** 02400020
*                                                                     * 03000020
*TITLE:'IEDQNS'-CHECKPOINT INCIDENT OVERFLOW ROUTINE                  * 03600020
*                                                                     * 04200020
*MODULE NAME=IEDQNS                                                     04800005
*                                                                       04880005
*DESCRIPTIVE NAME=INCIDENT OVERFLOW ROUTINE                             04960005
*                                                                       05040005
*COPYRIGHT='NONE'                                                       05120005
*                                                                       05200005
*  STATUS:  CHANGE LEVEL 6                                            * 05280061
*                                                                     * 05400020
*FUNCTION:THIS MODULE GAINS CONTROL WHEN ALL THE INCIDENT DISK        * 06000020
*   RECORDS HAVE BEEN USED. IT REMOVES THE ENVIRONMENT CHECKPOINT     * 06600020
*   REQUEST ELEMENT FROM ITS QUEUE(IT IS IN EITHER THE TIME DELAY     * 07200020
*   QUEUE OR THE CHECKPOINT QCB CHAIN.). IT LOCATES THE LAST          * 07800020
*   REQUEST ELEMENT FOR WHICH A DISK RECORD WAS BUILT,AND INSERTS     * 08400020
*   THE ENVIRONMENT REQUEST ELEMENT INTO THE NEXT POSITION IN THE     * 09000020
*   QCB CHAIN. THE ENVIRONMENT CHECKPOINT WILL BE THE NEXT RECORD     * 09600020
*   BUILT AND THE INCIDENT DISK RECORDS CAN BE OVERLAID.              * 10200020
*                                                                     * 10800020
*ENTRY POINT:                                                         * 11400020
*                                                                     * 12000020
*        IEDQNS                                                       * 12600020
*                                                                     * 13200020
*INPUT:REGISTERS 2,9,12,14,15 CONTAIN THE FOLLOWING VALUES:           * 13800020
*                                                                     * 14400020
*   2-ADDRESS OF CHECKPOINT WORK AREA                                 * 15000020
*   9-ADDRESS OF AVT                                                  * 15600020
*   12-BASE REGISTER FOR CHECKPOINT EXECUTOR-IEDQNF                   * 16200020
*   14-RETURN POINT-IN IEDQNF                                         * 16800020
*   15-ENTRY POINT OF THIS MODULE                                     * 17400020
*                                                                     * 18000020
*OUTPUT:THE ABOVE REGISTERS REMAIN UNCHANGED.                         * 18600020
*                                                                     * 19200020
*   THE ENVIRONMENT REQUEST ELEMENT IS INSERTED IN THE QCB CHAIN.     * 19800020
*                                                                     * 20400020
*EXTERNAL ROUTINES:                                                   * 21000020
*                                                                     * 21600020
*        AQCTL SVC-TPOSTS ELEMENT TO READY QUEUE FOR IEDQHG           * 22200020
*EXITS-NORMAL:THIS MODULE BRANCHES TO 4 PLUS THE ADDRESS IN R14. NO   * 22800020
*   MORE LOAD MODULES ARE NEEDED FOR THIS MODULE.                     * 23400020
*                                                                     * 24000020
*EXITS-ERROR:NONE.                                                    * 24600020
*                                                                     * 25200020
*TABLES/WORK AREAS:                                                   * 25800020
*                                                                     * 26400020
*   AVT(AVTCKELE,AVTCPRMB,AVTCKPTB                                    * 27000020
*   CHECKPOINT WORK AREA                                              * 27600020
*                                                                     * 28200020
*ATTRIBUTES:REENTERABLE                                               * 28800020
*                                                                     * 29400020
*NOTES:THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL REPRE-   * 30000020
*   SENTATION OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT TO    * 30600020
*   THE ONE USED AT ASSEMBLY TIME. THE CODING HAS BEEN ARRANGED SO    * 31200020
*   THAT REDEFINITION OF 'CHARACTER' CONSTANTS,BY REASSEMBLY, WILL    * 31800020
*   RESULT IN A CORRECT MODULE FOR THE NEW DEFINITIONS.               * 32400020
*                                                                     * 33000020
         SPACE 3                                                        33600020
*REGISTER ASSIGNMENTS                                                   34200020
         SPACE                                                          34800020
R0       EQU   0                                                        35400020
R1       EQU   1                                                        36000020
R2       EQU   2                        ADDRESS OF CKPT WORK AREA       36600020
R3       EQU   3                                                        37200020
R4       EQU   4                                                        37800020
R5       EQU   5                                                        38400020
R6       EQU   6                                                        39000020
R7       EQU   7                                                        39600020
R8       EQU   8                                                        40200020
RAVT     EQU   9                        ADDRESS OF AVT                  40800020
R10      EQU   10                                                       41400020
R11      EQU   11                                                       42000020
R12      EQU   12                       BASE REG FOR CHECKPT EXECTR     42600020
R13      EQU   13                                                       43200020
R14      EQU   14                       RETURN REG                      43800020
R15      EQU   15                       BASE FOR THIS MODULE            44400020
ONE      EQU   1                        CONSTANT OF ONE         OX02188 44800005
ADDR     EQU   7                        CONSTANT               @OZ17605 44850000
         SPACE 3                                                        45000020
         USING *,R15                                                    45600020
         USING IEDQAVTD,RAVT            BASE FOR AVT                    46200020
         USING IEDQCKPD,R2              BASE FOR CKPT WORK AREA         46800020
         SPACE                                                          47400020
IEDQNS   IEDHJN  QNS00                  NAME AND HJN             Y02027 48000006
         LA    R1,AVTCKELE              ADDR OF ENV REQUEST ELEMENT     50400020
         ST    R1,CKPTRMAD                                              51000020
         TM    AVTCKELF,AVTCPIPN        CHECK FOR CKPT IN PROGRESS      51600020
         BO    QNS60                    RETURN IF IN PROGRESS   OX02188 52200005
         TM    AVTCKELF,AVTCRTLN        CHECK REQUEST BIT IN ENVRNM    X52800020
                                        CKPT REQUEST ELEMENT            53400020
         BNZ   QNS30                    BRANCH IF ALREADY REQUESTED     54000020
         SPACE 3                                                        54600020
*REMOVE ENVIRONMENT CKPT REQUEST ELEMENT FROM TIME DELAY QUEUE          55200020
         SPACE                                                          55800020
DELAY    EQU   *                                               @OZ17605 55850000
         LA    R6,AVTCPRMB              ADDR TIME DELAY REMOVAL QCB1020 55900020
         ST    R6,AVTCKRMV              PUT QCB ADDR INTO ELEMENT  1020 56000020
         MVI   AVTCKRMV,CREREMVE        SET UP KEY FIELD FOR IEDQNF1020 56100020
         LA    R6,AVTCKRMV              ADDRESS OF CKPT REMOVAL ELM     56400020
         MVI   AVTECD4(R6),PRITIME+ONE  SET HIGHER PRIORITY     OX02188 57000005
*                                        THAN TIME ELEMENT      OX02188 57300005
         XC    5(3,R6),5(R6)            CLEAR LINK FIELD                57600020
         LR    R7,R6                                                    58200020
         STM   R6,R7,CKPGETML           PARM LIST FOR SVC               58800020
         MVI   CKPGETML,X'0C'           SET FLAG                        59400020
         MVI   CKPGETML+AVTECD4,AVTE80  SET END OF LIST         OX02188 59700005
         LR    R5,R15                   SAVE BASE REG                   60000020
         LA    R1,CKPGETML              ADDRESS OF LIST                 60600020
         AQCTL                          POST ELEMENT TO READY QUEUE     61200020
         LR    R15,R5                   RESTORE BASE REG                61800020
         TM    AVTCKELF,AVTCRTLN        CHECK REQUEST BIT IN   @OZ17605 61850000
*                                        ENV CKPT REQ ELEMENT  @OZ17605 61900000
         BNZ   QNS30                    BR IF ALREADY REQUESTED@OZ17605 61950000
         SPACE 3                                                        62400020
*GET THE LAST REQUEST ELEMENT FOR WHICH A DISK RECORD WAS BUILT.        63000020
*PUT THE ENVIRONMENT REQUEST ELEMENT IN THE NEXT POSITION IN THE        63600020
*QCB CHAIN.                                                             64200020
         SPACE                                                          64800020
         BAL   R3,GETLOCK               SET MODE AND LOCK        Y02027 65100006
QNS10    EQU   *                                                        65400020
         L     R3,CKPLREB               GET LAST REQUEST ELEM BUILT     66000020
         LTR   R3,R3                    CHECK FOR NO DISK RCDS BLT      66600020
         BNZ   QNS15                    BRANCH IF RCDS BUILT    OX02188 67200005
         SPACE                                                          67800020
         LA    R3,AVTCKPTB-4            ADDRESS OF CKPT QCB             68400020
QNS15    EQU   *                                                OX02188 68450005
         MVC   AVTCKELE+5(3),5(R3)      MOVE LINK FIELD TO ENVIRON     X69600020
                                        REQUEST ELEMENT                 70200020
         MVC   5(3,R3),CKPTRMAD+1       PUT ENV REQ EL INTO QCB CHN     70800020
         LR    R6,R14                   SAVE REG                 Y02027 71100006
         LR    R5,R15                   SAVE REG                 Y02027 71130006
         SETLOCK RELEASE,TYPE=LOCAL,REGS=USE,                          C71160006
               RELATED=ATTACHED-TASKS-IEDQNS(SETATSK)            Y02027 71190006
         SPACE 2                                               @ZA02087 71197061
         LR    R15,R5                   RESTORE BASE REG       @ZA02087 71204061
         SPACE 2                                               @ZA02087 71211061
         MODESET EXTKEY=TCAM            SET TO TCAM KEY          Y02027 71220006
         MODESET MODE=PROB              SET TO PROBLEM STATE     Y02027 71250006
         LR    R14,R6                   RESTORE REG              Y02027 71280006
         LR    R15,R5                   RESTORE REG              Y02027 71310006
         SPACE 3                                                        71400020
*RETURN TO CHECKPOINT EXECUTOR. NO MORE LOAD MODULES NEEDED             72000020
         SPACE                                                          72600020
         OI    AVTCKELF,AVTCINCN+AVTCRTLN  TURN ON REQ BITS FOR OVRF    73800020
         B     4(R14)                   RETURN                          74400020
         SPACE 3                                                        75000020
*AN ENVIRONMENT CKPT IS ALREADY REQUESTED. REMOVE ELEMENT FROM QCB      75600020
*ELEMENT CHAIN.                                                         76200020
         SPACE                                                          76800020
QNS30    EQU   *                                                        77400020
         BAL   R3,GETLOCK               SET MODE AND LOCK        Y02027 77700006
         L     R3,AVTCKPTB              GET QCB ELEMENT CHAIN           78000020
         SPACE 3                                                        78600020
*BEGINNING OF LOOP THROUGH QCB ELEMENT CHAIN                            79200020
         SPACE                                                          79800020
QNS40    EQU   *                                                        80400020
         CLC   5(3,R3),CKPTRMAD+1       IS THIS ELEMENT CHAINED TO     X81000020
                                        ENV REQUEST ELEMENT             81600020
         BE    QNS45                    BRANCH IF CHAINED TO ENVOX02188 82200005
         SPACE                                                          82800020
         L     R3,4(0,R3)               GET NEXT ELEMENT IN CHAIN       83400020
         CLM   R3,ADDR,AVTDELAD+ONE     IS THIS DUMMY LAST     @OZ17605 84040000
         BNE   QNS40                    NO, CHECK NEXT ELEMENT @OZ17605 84080000
         LR    R6,R14                   SAVE REG               @OZ17605 84120000
         LR    R5,R15                   SAVE REG               @OZ17605 84160000
         SETLOCK  RELEASE,TYPE=LOCAL,REGS=USE,                         X84200000
               RELATED=ATTACHED-TASKS-IEDQNS(SETATSK)          @OZ17605 84240000
         LR    R15,R5                   RESTORE BASE REG       @OZ17605 84280000
         MODESET   EXTKEY=TCAM          SET TO TCAM KEY        @OZ17605 84320000
         MODESET   MODE=PROB            SET TO PROBLEM STATE   @OZ17605 84360000
         LR    R14,R6                   RESTORE REG            @OZ17605 84400000
         LR    R15,R5                   RESTORE REG            @OZ17605 84440000
         B     DELAY                    REMOVE CHPT REQUEST    @OZ17605 84480000
*                                        ELEM FROM TIME DELAY  @OZ17605 84520000
         SPACE                                                          84600020
*END OF LOOP THROUGH QCB ELEMENT CHAIN                                  85200020
QNS45    EQU   *                                                OX02188 85250005
         MVC   5(3,R3),AVTCKELE+5       MOVE LINK FIELD OF ENV REQ     X87000020
                                        ELEMENT TO PREVIOUS ELEMENT     87600020
         B     QNS10                    PUT ENV REQ EL BACK IN CHAN     88200020
         SPACE 3                                                        88300005
QNS60    EQU   *                                                OX02188 88400005
         OI    AVTCKELF,AVTCINCN        TURN ON OVERFLOW REQUESTOX02188 88500005
         B     AVTECD12(R14)             AND RETURN            @OY20868 88600082
GETLOCK  EQU   *                                               @OY20868 88603082
         LR    R6,R14                   SAVE REG                 Y02027 88609106
         LR    R5,R15                   SAVE REG                 Y02027 88618106
         MODESET MODE=SUP               SET TO SUPERVISOR STATE  Y02027 88627106
         MODESET EXTKEY=SUPR            SET TO KEY ZERO          Y02027 88636106
SETATSK  EQU   *                                                 Y02027 88645106
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,REGS=USE,               C88654106
               RELATED=ATTACHED-TASKS-IGG019RO/IGG019RB(SETATSK) Y02027 88663106
         LR    R14,R6                   RESTORE REG              Y02027 88672106
         LR    R15,R5                   RESTORE REG              Y02027 88681106
         BR    R3                       RETURN                   Y02027 88690106
         EJECT                                                          88700005
         SPACE 3                                                        88800020
         TAVTD                                                          90000020
         TCKPD 3330                     MERLIN VERSION             0421 90600000
         TPRIOR                                                         91200020
         IHAPSA                         DSECT FOR SETLOCK        Y02027 91500006
         END                                                            91800020
./  ADD  SSI=63630044,NAME=IEDQNT
         TITLE 'IEDQNT, 3705 CHECKPOINT - LOAD 1                       *00001000
                        '                                               00002000
IEDQNT   CSECT ,                                                01S0001 00003000
@PROLOG  DS    0H                                               01S0002 00004000
*   RBASE=REG15;                    /* SET BASE REGISTER             */ 00005000
         LR    RBASE,REG15                                      02S0303 00006000
*   GEN REFS(RBASE) NOSETS;                                     02S0304 00007000
*                                   /*                                  00008000
         USING IEDQNT,RBASE            ESTABLISH ADDRESSABILITY         00009000
IEDQNT   IEDHJN AFTERHJN,HJN           MODULE IDENTIFICATION MACRO      00010000
*   RCAVT=AVTCKAVT;                 /* GET ADDRESS OF THE CKPT AVT   */ 00011000
         L     RCAVT,AVTCKAVT-1(,RAVT)                          02S0305 00012000
         LA    RCAVT,0(,RCAVT)                                  02S0305 00013000
*   RCKPT=CAVTNWA;                  /* GET ADDR OF CKPT WORK AREA    */ 00014000
         L     RCKPT,CAVTNWA(,RCAVT)                            02S0306 00015000
*   CKPSAVE2(1)=REG12;              /* SAVE BASE ADDRESS OF IEDQNF   */ 00016000
         ST    REG12,CKPSAVE2(,RCKPT)                           02S0307 00017000
*   CKPSAVE2(2)=REG14;              /* SAVE RETURN ADDRESS           */ 00018000
         ST    REG14,CKPSAVE2+4(,RCKPT)                         02S0308 00019000
*   ROPCE=OPCCKPTF;                 /* GET OPCE ADDRESS - OPCE TO BE    00020000
*                                      CKPT'D IS THE FIRST ONE ON THE   00021000
*                                      OP CONTROL QUEUE FOR     02S0309 00022000
*                                      CHECKPOINT                    */ 00023000
         L     @10,AVTOCGET(,RAVT)                              02S0309 00024000
         L     ROPCE,OPCCKPTF(,@10)                             02S0309 00025000
*   RSAVE=ADDR(CKPSAVE1(1));        /* SET SAVE AREA ADDRESS         */ 00026000
         LR    RSAVE,RCKPT                                      02S0310 00027000
*   RFY                                                         02S0311 00028000
*    (REG12,                                                    02S0311 00029000
*     REG14) UNRSTD;                                            02S0311 00030000
*                                                               02S0312 00031000
*   /*****************************************************************/ 00032000
*   /*                                                               */ 00033000
*   /* PROCESS: THIS SEGMENT DOES THE PROCESSING THAT IS NECESSARY TO*/ 00034000
*   /* PERFORM THE FUNCTION OF THE MODULE. FIRST THE COMMAND IS      */ 00035000
*   /* IDENTIFIED AND THE 'SELECT' VALUES ARE SET UP. CONTROL        */ 00036000
*   /* COMMANDS (SUCH AS IPL) ARE THOSE WHICH ARE DIRECTED TO THE    */ 00037000
*   /* 3705 ITSELF. RESOURCE COMMANDS (SUCH AS MODIFY BHSET) ARE     */ 00038000
*   /* THOSE WHICH ARE DIRECTED TO A RESOURCE OF THE 3705. SPECIAL   */ 00039000
*   /* PROCESSING IS DONE FOR EACH OF THE TWO TYPES OF COMMANDS. IF  */ 00040000
*   /* I/O IS REQUESTED, THEN IEDQNW IS CALLED TO ISSUE THE EXCP TO  */ 00041000
*   /* GET THE I/O STARTED.                                          */ 00042000
*   /*                                                               */ 00043000
*   /*****************************************************************/ 00044000
*                                                               02S0312 00045000
*                                                               03S0312 00046000
*   /*****************************************************************/ 00047000
*   /*                                                               */ 00048000
*   /* PROCESS.COMMAND: THIS SEGMENT DETERMINES THE COMMAND THAT IS  */ 00049000
*   /* TO BE CHECKPOINTED BY LOOKING FOR ICHNG, TCHNG, OR A SPECIFIC */ 00050000
*   /* MODIFY COMMAND. WHEN THE COMMAND IS FOUND, THE 'SELECT' VALUES*/ 00051000
*   /* FOR THE COMMAND ARE INSERTED INTO CKPNSELT. THE FIRST BYTE OF */ 00052000
*   /* THIS FIELD (CKPCUSEL) IS USED IN SUBSEQUENT DECISIONS TO      */ 00053000
*   /* SELECT THE PATH THAT IS TO BE TAKEN FOR THE COMMAND. AFTER    */ 00054000
*   /* EACH 'SELECT' VALUE IS USED, THE SELECT FIELD IF SHIFTED SO   */ 00055000
*   /* THAT A NEW 'SELECT' VALUE APPEARS IN CKPCUSEL.                */ 00056000
*   /*                                                               */ 00057000
*   /*****************************************************************/ 00058000
*                                                               03S0312 00059000
*   DO;                                                         03S0312 00060000
*     RFY                                                       03S0313 00061000
*       RTAB RSTD;                                              03S0313 00062000
*     IF OCOPTCDE=OCICHNG           /* TEST FOR ICHNG COMMAND        */ 00063000
*       THEN                        /* THIS IS AN ICHNG COMMAND      */ 00064000
         CLI   OCOPTCDE(ROPCE),X'49'                            03S0314 00065000
         BNE   @RF00314                                         03S0314 00066000
*       CKPSLVAL=ICHNGSEL;          /* GET ICHNG SELECT VALUES       */ 00067000
         MVC   CKPSLVAL(3,RCKPT),ICHNGSEL                       03S0315 00068000
*     ELSE                          /* NOT AN ICHNG                  */ 00069000
*       IF OCOPTCDE=OCTCHNG         /* TEST FOR TCHNG COMMAND        */ 00070000
*         THEN                      /* THIS IS A TCHNG COMMSND       */ 00071000
         B     @RC00314                                         03S0316 00072000
@RF00314 CLI   OCOPTCDE(ROPCE),X'56'                            03S0316 00073000
         BNE   @RF00316                                         03S0316 00074000
*         CKPSLVAL=TCHNGSEL;        /* GET TCHNG SELECT VALUES       */ 00075000
         MVC   CKPSLVAL(3,RCKPT),TCHNGSEL                       03S0317 00076000
*       ELSE                        /* NOT A TCHNG COMMAND           */ 00077000
*         DO;                                                   03S0318 00078000
         B     @RC00316                                         03S0318 00079000
@RF00316 DS    0H                                               03S0319 00080000
*           RTAB=ADDR(CMDTABLE);    /* GET ADDRESS OF THE TABLE OF      00081000
*                                      VALID MODIFY COMMANDS         */ 00082000
         LA    RTAB,CMDTABLE                                    03S0319 00083000
*           DO WHILE OCSWITCH=CMDID;/* SEARCH COMMAND TABLE LOOKING    00084000
*                                      FOR THE CURRENT COMMAND       */ 00085000
         B     @DE00320                                         03S0320 00086000
@DL00320 DS    0H                                               03S0321 00087000
*             RTAB=RTAB+LENGTH(TABENTRY);/* POINT TO NEXT ENTRY      */ 00088000
         AL    RTAB,@CF00327                                    03S0321 00089000
*           END;                                                03S0322 00090000
@DE00320 CLC   OCSWITCH(1,ROPCE),CMDID(RTAB)                    03S0322 00091000
         BNE   @DL00320                                         03S0322 00092000
*           CKPSLVAL=TABSELCT;      /* GET THE SELECT VALUES FOR THIS   00093000
*                                      COMMAND                       */ 00094000
         MVC   CKPSLVAL(3,RCKPT),TABSELCT(RTAB)                 03S0323 00095000
*         END;                                                  03S0324 00096000
*     RFY                                                       03S0325 00097000
*       RTAB UNRSTD;                                            03S0325 00098000
@RC00316 DS    0H                                               03S0325 00099000
@RC00314 DS    0H                                               03S0326 00100000
*   END;                                                        03S0326 00101000
*   IF CKPCUSEL=CNT                 /* TEST COMMAND TYPE             */ 00102000
*     THEN                          /* COMMAND IS A CONTROL COMMAND  */ 00103000
         CLI   CKPCUSEL(RCKPT),1                                02S0327 00104000
         BNE   @RF00327                                         02S0327 00105000
*                                                               03S0328 00106000
*     /***************************************************************/ 00107000
*     /*                                                             */ 00108000
*     /* PROCESS.CONTROL: THIS SEGMENT PROCESSES THE CONTROL COMMANDS*/ 00109000
*     /* THAT ARE DIRECTED TO THE LOCAL 3705. THE CONTROL RECORD AREA*/ 00110000
*     /* IN THE CHECKPOINT WORKAREA IS INITIALIZED WITH ALL OF THE   */ 00111000
*     /* CHANGEABLE DATA (EXCEPT FOR NCPTRACE) IN THE 3705'S DEVICE  */ 00112000
*     /* DEPENDENT FIELDS. A WRITE IS REQUESTED FROM THE CONTROL     */ 00113000
*     /* PORTION OF THE WORKAREA.                                    */ 00114000
*     /*                                                             */ 00115000
*     /***************************************************************/ 00116000
*                                                               03S0328 00117000
*     DO;                                                       03S0328 00118000
*       MVC(CKPSLVAL,CKPSLNEW);     /* SHIFT 'SELECT' VALUES FOR NEXT   00119000
*                                      PATH SELECTION                */ 00120000
         MVC   CKPSLVAL(3,RCKPT),CKPSLNEW(RCKPT)                03S0329 00121000
*       IF OCSWITCH=OCACTVTE        /* TEST FOR ACTIVATE COMMAND     */ 00122000
*         THEN                      /* THIS IS AN ACTIVATE COMMAND   */ 00123000
         CLI   OCSWITCH(ROPCE),X'22'                            03S0330 00124000
         BNE   @RF00330                                         03S0330 00125000
*         IF NCPREST=OFF            /* TEST FOR 3705 RESTART         */ 00126000
*           THEN                    /* THIS IS NOT A 3705 RESTART    */ 00127000
         L     @14,CKPNDEVF(,RCKPT)                             03S0331 00128000
         TM    NCPREST(@14),B'00010000'                         03S0331 00129000
         BNZ   @RF00331                                         03S0331 00130000
*           DO;                                                 03S0332 00131000
*             NCPREST=ON;           /* INDICATE RESTART FOR NEXT        00132000
*                                      ENTRY                         */ 00133000
         OI    NCPREST(@14),B'00010000'                         03S0333 00134000
*             CKPCUSEL=TIMEDATE;    /* UPDATE SELECT VALUE TO   03S0334 00135000
*                                      INDICATE THAT TIME DATA IS       00136000
*                                      NEEDED                        */ 00137000
         MVI   CKPCUSEL(RCKPT),X'01'                            03S0334 00138000
*           END;                                                03S0335 00139000
*       IF CKPCUSEL=TIMEDATE        /* TEST FOR REQUEST FOR TIME        00140000
*                                      UPDATE                        */ 00141000
*         THEN                      /* TIME UPDATE IS REQUESTED      */ 00142000
@RF00331 DS    0H                                               03S0336 00143000
@RF00330 CLI   CKPCUSEL(RCKPT),1                                03S0336 00144000
         BNE   @RF00336                                         03S0336 00145000
*         DO;                                                   03S0337 00146000
*           GEN NOREFS SETS(REG00,RPARM);                       03S0338 00147000
*                                /*                                     00148000
            TIME  ,                 GET DATE AND TIME                   00149000
*           CKPDATE=RPARM;          /* SET DATE                      */ 00150000
         STCM  RPARM,15,CKPDATE(RCKPT)                          03S0339 00151000
*           CKPTIME=REG00;          /* SET TIME                      */ 00152000
         STCM  REG00,15,CKPTIME(RCKPT)                          03S0340 00153000
*         END;                                                  03S0341 00154000
*       CKPBCKUP=NCPBKUPN;          /* UPDATE BACKUP NAME            */ 00155000
@RF00336 L     @14,CKPNDEVF(,RCKPT)                             03S0342 00156000
         MVC   CKPBCKUP(8,RCKPT),NCPBKUPN(@14)                  03S0342 00157000
*       CKPIPLTX=NCPTXID;           /* UPDATE IPL TEXT NAME          */ 00158000
         MVC   CKPIPLTX(8,RCKPT),NCPTXID(@14)                   03S0343 00159000
*       CKPTRSTA=NCPFLAG1;          /* UPDATE STATUS FLAGS           */ 00160000
         MVC   CKPTRSTA(1,RCKPT),NCPFLAG1(@14)                  03S0344 00161000
*       RPARM=ADDR(CKPTRSTA)-(ADDR(NCPFLAG1)-ADDR(IEDNCP));/* SET REG   00162000
*                                      TO POINT TO CKPTRSTA AS IF IT    00163000
*                                      WERE THE NCPFLAG1 FIELD       */ 00164000
         LA    RPARM,CKPTRSTA(,RCKPT)                           03S0345 00165000
         BCTR  RPARM,0                                          03S0345 00166000
*       RPARM->NCPTRACE=OFF;        /* TURN OFF THE NCPTRACE FLAG IN    00167000
*                                      THE CKPT FIELD                */ 00168000
         NI    NCPTRACE(RPARM),B'11111101'                      03S0346 00169000
*       CKPRWCMD=CKPWRITE;          /* SET COMMAND TYPE TO WRITE     */ 00170000
         MVI   CKPRWCMD(RCKPT),X'05'                            03S0347 00171000
*       CKPRWBC=CKPCRLEN;           /* SET LENGTH TO LENGTH OF  03S0348 00172000
*                                      CONTROL RECORD                */ 00173000
         SLR   @14,@14                                          03S0348 00174000
         IC    @14,CKPCRLEN(,RCKPT)                             03S0348 00175000
         STH   @14,CKPRWBC(,RCKPT)                              03S0348 00176000
*       CKPRWADD=ADDR(CKPNCNTL);    /* SET DATA ADDR TO THE CONTROL     00177000
*                                      RECORD                        */ 00178000
         LA    @14,CKPNCNTL(,RCKPT)                             03S0349 00179000
         STCM  @14,7,CKPRWADD(RCKPT)                            03S0349 00180000
*       MVC(CKPSLVAL,CKPSLNEW);     /* SHIFT 'SELECT' VALUES FOR NEXT   00181000
*                                      PATH SELECTION                */ 00182000
         MVC   CKPSLVAL(3,RCKPT),CKPSLNEW(RCKPT)                03S0350 00183000
*       CKPENCDE=0;                 /* SET I/O REQUESTED             */ 00184000
         MVI   CKPENCDE(RCKPT),X'00'                            03S0351 00185000
*     END;                                                      03S0352 00186000
*   ELSE                            /* COMMAND IS A RESOURCE COMMAND */ 00187000
*                                                               03S0353 00188000
*     /***************************************************************/ 00189000
*     /*                                                             */ 00190000
*     /* PROCESS.RESOURCE: THIS SEGMENT PROCESSES THE COMMANDS THAT  */ 00191000
*     /* ARE DIRECTED TO A RESOURCE OF A 3705. EACH RESOURCE HAS TWO */ 00192000
*     /* NONCONTIGUOUS RECORDS ON THE CKPT DATA SET THAT ARE         */ 00193000
*     /* MAINTAINED IN A 'FLIP/FLOP' MANNER. IF THE FIRST RECORD WAS */ 00194000
*     /* UPDATED ON THE LAST CKPT, THEN THE SECOND RECORD WILL BE    */ 00195000
*     /* UPDATED ON THIS CKPT (AND VICE VERSA). THIS SEGMENT SETS UP */ 00196000
*     /* TO READ THE RECORD MOST RECENTLY WRITTEN TO GET THE MOST UP */ 00197000
*     /* TO DATE CKPT INFORMATION FOR THIS RESOURCE.                 */ 00198000
*     /*                                                             */ 00199000
*     /***************************************************************/ 00200000
*                                                               03S0353 00201000
*     DO;                                                       03S0353 00202000
         B     @RC00327                                         03S0353 00203000
@RF00327 DS    0H                                               03S0354 00204000
*       REG15=ADDR(CKPRW);          /* SET ADDR TO CONTAIN ADDR OF      00205000
*                                      GETMAIN'ED AREA               */ 00206000
         LA    REG15,CKPRW(,RCKPT)                              03S0354 00207000
*       REG00=CKPBLKSZ;             /* GET NUMBER OF BYTES TO GETMAIN*/ 00208000
         LH    REG00,CKPBLKSZ(,RCKPT)                           03S0355 00209000
*       GEN REFS(REG00,REG15,CKPGETML) SETS(RPARM);             03S0356 00210000
*                                 /*                           @YM07021 00211000
        GETMAIN EC,LV=(REG00),A=(REG15),SP=0,MF=(E,CKPGETML(RCKPT))     00212000
*       IF REG15=0                  /* TEST RETURN FROM GETMAIN      */ 00213000
*         THEN                      /* GETMAIN WAS GOOD              */ 00214000
         SLR   @14,@14                                          03S0357 00215000
         CR    REG15,@14                                        03S0357 00216000
         BNE   @RF00357                                         03S0357 00217000
*         DO;                                                   03S0358 00218000
*           CKPENCDE=0;             /* CLEAR ERROR INDICATOR         */ 00219000
         MVI   CKPENCDE(RCKPT),X'00'                            03S0359 00220000
*           IF OCOPTCDE=OCICHNG     /* TEST COMMAND TYPE             */ 00221000
*             THEN                  /* COMMAND IS AN ICHNG           */ 00222000
         CLI   OCOPTCDE(ROPCE),X'49'                            03S0360 00223000
         BNE   @RF00360                                         03S0360 00224000
*                                                               04S0361 00225000
*             /*******************************************************/ 00226000
*             /*                                                     */ 00227000
*             /* PROCESS.RESOURCE.ICINIT: THIS SEGMENT INITIALIZES   */ 00228000
*             /* FIELDS NEEDED BY IEDQNU TO COMPLETE THE CKPT OF AN  */ 00229000
*             /* ICHNG COMMAND. THE MOVE BUFFER PARAMETER LIST USED  */ 00230000
*             /* TO MOVE THE DEVICE RECORD TO THE CKPT RECORD IS     */ 00231000
*             /* INITIALIZED.                                        */ 00232000
*             /*                                                     */ 00233000
*             /*******************************************************/ 00234000
*                                                               04S0361 00235000
*             DO;                                               04S0361 00236000
*               RFY                                             04S0362 00237000
*                 RPLMV RSTD;                                   04S0362 00238000
*               RPLMV=ADDR(CKPSAVE2(10));/* GET ADDRESS OF MOVE 04S0363 00239000
*                                      BUFFER PARM LIST              */ 00240000
         LA    RPLMV,CKPSAVE2+36(,RCKPT)                        04S0363 00241000
*               PLMVFLG1=''B;       /* CLEAR FLAG BYTE 1             */ 00242000
         MVI   PLMVFLG1(RPLMV),X'00'                            04S0364 00243000
*               PLMVFLG2=''B;       /* CLEAR FLAG BYTE 2             */ 00244000
         MVI   PLMVFLG2(RPLMV),X'00'                            04S0365 00245000
*               PLMVUNCA=0;         /* CLEAR CHAIN ADDRESS           */ 00246000
         ST    @14,PLMVUNCA(,RPLMV)                             04S0366 00247000
*               IF OCICTYPE=OCICSID /* TEST ICHNG LINE TYPE          */ 00248000
*                 THEN              /* THIS IS A SWITCHED LINE WITH     00249000
*                                      ID VERIFICATION               */ 00250000
         CLI   OCICTYPE(ROPCE),0                                04S0367 00251000
         BNE   @RF00367                                         04S0367 00252000
*                                                               05S0368 00253000
*                 /***************************************************/ 00254000
*                 /*                                                 */ 00255000
*                 /* PROCESS.RESOURCE.ICINIT.SWITCHID: THIS SEGMENT  */ 00256000
*                 /* INITIALIZES FOR ICHNG TO A SWITCHED LINE WITH ID*/ 00257000
*                 /* VERIFICATION.                                   */ 00258000
*                 /*                                                 */ 00259000
*                 /***************************************************/ 00260000
*                                                               05S0368 00261000
*                 DO;                                           05S0368 00262000
*                   PLMVTU=ADDR(CNRDVBDU);/* SET TARGET TO RECEIVE      00263000
*                                      ...                           */ 00264000
         L     @12,RCKPREC+201(,RCKPT)                          05S0369 00265000
         LA    @12,CNRDVBDU(,@12)                               05S0369 00266000
         ST    @12,PLMVTU(,RPLMV)                               05S0369 00267000
*                   PLMVTD=ADDR(CNRDVBDU);/* ... LINE SESSION INFO   */ 00268000
         ST    @12,PLMVTD(,RPLMV)                               05S0370 00269000
*                   PLMVSU=OCUNIT;  /* SET UNIT ADDRESS OF UNIT WITH    00270000
*                                      LINE SESSION INFO             */ 00271000
         L     @12,OCUNIT(,ROPCE)                               05S0371 00272000
         ST    @12,PLMVSU(,RPLMV)                               05S0371 00273000
*                   CKPTTCIN=PRUTTCIN;/* SAVE TTCIN OF THE LINE      */ 00274000
         L     @12,IEDPRUQP(,RPLMV)                             05S0372 00275000
         LH    @10,PRUTTCIN(,@12)                               05S0372 00276000
         N     @10,@CF01747                                     05S0372 00277000
         STH   @10,CKPTTCIN(,RCKPT)                             05S0372 00278000
*                   CKPDATCT=PRUDATCT;/* SAVE DATA COUNT OF THE LINE    00279000
*                                      SESSION INFO                  */ 00280000
         LH    @10,PRUDATCT(,@12)                               05S0373 00281000
         STH   @10,CKPDATCT(,RCKPT)                             05S0373 00282000
*                   PLMVLNTH=PRUDATCT;/* SET MOVE LENGTH             */ 00283000
         STH   @10,PLMVLNTH(,RPLMV)                             05S0374 00284000
*                   PLMVSD=ADDR(IEDBDU);/* START MOVE WITH THE BDU   */ 00285000
         AL    @12,@CF00235                                     05S0375 00286000
         ST    @12,PLMVSD(,RPLMV)                               05S0375 00287000
*                   CKPTNTNB=0;     /* INDICATE THAT THERE ARE NO       00288000
*                                      MORE DEVICE RECORDS TO PROCESS*/ 00289000
         STH   @14,CKPTNTNB(,RCKPT)                             05S0376 00290000
*                 END;                                          05S0377 00291000
*               ELSE                /* NOT SWITCHED LINE WITH ID        00292000
*                                      VERIFICATION - EITHER LEASED,    00293000
*                                      SWITCHED, OR MULTIPOINT LINE  */ 00294000
*                                                               05S0378 00295000
*                 /***************************************************/ 00296000
*                 /*                                                 */ 00297000
*                 /* PROCESS.RESOURCE.ICINIT.MULTILEA: THIS SEGMENT  */ 00298000
*                 /* INITIALIZES FOR ICHNG FOR A LEASED OR SWITCHED  */ 00299000
*                 /* LINE WITH NO ID VERIFICATION AND FOR A          */ 00300000
*                 /* MULTIPOINT LINE. THE SINGLE DEVICE RECORD FOR A */ 00301000
*                 /* LEASED OR SWITCHED LINE IS LOCATED. FOR A       */ 00302000
*                 /* MULTIPOINT LINE THE FIRST VALID DEVICE RECORD   */ 00303000
*                 /* MUST BE FOUND.                                  */ 00304000
*                 /*                                                 */ 00305000
*                 /***************************************************/ 00306000
*                                                               05S0378 00307000
*                 DO;                                           05S0378 00308000
         B     @RC00367                                         05S0378 00309000
@RF00367 DS    0H                                               05S0379 00310000
*                   IF OCICTYPE=OCICLES/* TEST ICHNG LINE TYPE       */ 00311000
*                     THEN          /* THIS IS A LEASED LINE OR A       00312000
*                                      SWITCHED LINE WITH NO ID 05S0379 00313000
*                                      VERIFICATION                  */ 00314000
         CLI   OCICTYPE(ROPCE),1                                05S0379 00315000
         BNE   @RF00379                                         05S0379 00316000
*                     DO;                                       05S0380 00317000
*                       PLMVSU=OCUNIT;/* SET UNIT CONTAINING DEVICE     00318000
*                                      RECORD                        */ 00319000
         L     @14,OCUNIT(,ROPCE)                               05S0381 00320000
         ST    @14,PLMVSU(,RPLMV)                               05S0381 00321000
*                       PLMVSD=ADDR(LEARCD);/* POINT TO START OF        00322000
*                                      DEVICE RECORD                 */ 00323000
         L     @14,IEDPRUQP(,RPLMV)                             05S0382 00324000
         LA    @14,LEARCD+18(,@14)                              05S0382 00325000
         ST    @14,PLMVSD(,RPLMV)                               05S0382 00326000
*                       CKPTNTNB=0; /* INDICATE THAT THERE ARE NO       00327000
*                                      MORE DEVICE RECORDS TO PROCESS*/ 00328000
         SLR   @14,@14                                          05S0383 00329000
         STH   @14,CKPTNTNB(,RCKPT)                             05S0383 00330000
*                     END;                                      05S0384 00331000
*                   ELSE            /* NOT LEASED OR SWITCHED - MUST    00332000
*                                      BE MULTIPOINT LINE            */ 00333000
*                     DO;                                       05S0385 00334000
         B     @RC00379                                         05S0385 00335000
@RF00379 DS    0H                                               05S0386 00336000
*                                                               06S0386 00337000
*                       /*********************************************/ 00338000
*                       /*                                           */ 00339000
*                       /* PROCESS.RESOURCE.ICINIT.MULTILEA.TNTINIT: */ 00340000
*                       /* THIS SEGMENT FINDS THE FIRST TNT OFFSET IN*/ 00341000
*                       /* THE CKPT UNITS FOR A MULTIPOINT LINE AND  */ 00342000
*                       /* SAVES IT IN OFFSET. IT INITIALIZES        */ 00343000
*                       /* POINTERS AND COUNTS FOR THE TNT OFFSETS   */ 00344000
*                       /* AND EXITS POINTING TO THE SECOND TNT      */ 00345000
*                       /* OFFSET AND THE FIRST DEVICE RECORD.       */ 00346000
*                       /*                                           */ 00347000
*                       /*********************************************/ 00348000
*                                                               06S0386 00349000
*                       DO;                                     06S0386 00350000
*                         CKPTNTUN=OCUNIT;/* SET POINTER TO UNIT WITH   00351000
*                                      TNT OFFSETS                   */ 00352000
         L     @14,OCUNIT(,ROPCE)                               06S0387 00353000
         ST    @14,CKPTNTUN(,RCKPT)                             06S0387 00354000
*                         CKPTNTPT=ADDR(ICTNTOFF);/* POINT TO FIRST     00355000
*                                      TNT OFFSET                    */ 00356000
         LA    @12,ICTNTOFF(,@14)                               06S0388 00357000
         ST    @12,CKPTNTPT(,RCKPT)                             06S0388 00358000
*                         OFSENTRY=CKPTNTPT->MOVECHAR;/* PUT FIRST      00359000
*                                      TNT OFFSET IN WORKAREA        */ 00360000
         MVC   OFSENTRY(3),MOVECHAR(@12)                        06S0389 00361000
*                         CKPTNTPT=CKPTNTPT+LENGTH(ICTNTOFF);/* POINT   00362000
*                                      TO SECOND TNT OFFSET          */ 00363000
         AL    @12,@CF00066                                     06S0390 00364000
         ST    @12,CKPTNTPT(,RCKPT)                             06S0390 00365000
*                         CKPTNTNB=ICTNTNO-1;/* GET NUMBER OF TNT       00366000
*                                      OFFSETS LEFT TO SCAN          */ 00367000
         LH    @12,ICTNTNO(,@14)                                06S0391 00368000
         BCTR  @12,0                                            06S0391 00369000
         STH   @12,CKPTNTNB(,RCKPT)                             06S0391 00370000
*                         CKPTNTLN=AVTKEYLE-2*LENGTH(ICTNTOFF);/* SET   00371000
*                                      LENGTH OF TNT DATA REMAINING     00372000
*                                      IN THIS UNIT                  */ 00373000
         LH    @12,AVTKEYLE(,RAVT)                              06S0392 00374000
         SL    @12,@CF00071                                     06S0392 00375000
         STH   @12,CKPTNTLN(,RCKPT)                             06S0392 00376000
*                         REG00=ICTNTNU;/* GET NUMBER OF UNITS  06S0393 00377000
*                                      CONTAINING TNT OFFSETS        */ 00378000
         SLR   REG00,REG00                                      06S0393 00379000
         IC    REG00,ICTNTNU(,@14)                              06S0393 00380000
*                         RPARM=OCUNIT;/* GET POINTER TO FIRST UNIT     00381000
*                                      WITH TNT OFFSETS              */ 00382000
         LR    RPARM,@14                                        06S0394 00383000
*                         DO UNTIL REG00=0;/* FIND FIRST UNIT THAT      00384000
*                                      CONTAINS DEVICE RECORDS       */ 00385000
@DL00395 DS    0H                                               06S0396 00386000
*                           RPARM=RPARM->ICTNTTIC;/* GET POINTER TO     00387000
*                                      NEXT UNIT                     */ 00388000
         L     RPARM,ICTNTTIC(,RPARM)                           06S0396 00389000
*                           REG00=REG00-1;/* DECREMENT COUNT OF TNT     00390000
*                                      UNITS                         */ 00391000
         BCTR  REG00,0                                          06S0397 00392000
*                         END;                                  06S0398 00393000
@DE00395 LTR   REG00,REG00                                      06S0398 00394000
         BNZ   @DL00395                                         06S0398 00395000
*                         PLMVSU=RPARM;/* SET POINTER TO UNIT THAT      00396000
*                                      CONTAINS THE FIRST DEVICE        00397000
*                                      RECORD                        */ 00398000
         ST    RPARM,PLMVSU(,RPLMV)                             06S0399 00399000
*                         PLMVTU=RPARM;/* POINT TO SAME UNIT AS 06S0400 00400000
*                                      TARGET                        */ 00401000
         ST    RPARM,PLMVTU(,RPLMV)                             06S0400 00402000
*                         PLMVSD=ADDR(MULRCDS);/* POINT TO FIRST        00403000
*                                      DEVICE RECORD                 */ 00404000
         L     @14,IEDPRUQP(,RPLMV)                             06S0401 00405000
         LA    @14,MULRCDS+18(,@14)                             06S0401 00406000
         ST    @14,PLMVSD(,RPLMV)                               06S0401 00407000
*                         PLMVTD=ADDR(MULRCDS);/* POINT TO SAME 06S0402 00408000
*                                      RECORD AS TARGET              */ 00409000
         ST    @14,PLMVTD(,RPLMV)                               06S0402 00410000
*                       END;                                    06S0403 00411000
*                       DO WHILE OFFSET=0;/* SEARCH TNT OFFSETS FOR A   00412000
*                                      NON-ZERO TNT OFFSET           */ 00413000
         B     @DE00404                                         05S0404 00414000
@DL00404 DS    0H                                               05S0405 00415000
*                                                               06S0405 00416000
*                         /*******************************************/ 00417000
*                         /*                                         */ 00418000
*                         /* PROCESS.RESOURCE.ICINIT.MULTILEA.TNTMOVE*/ 00419000
*                         /* : THIS SEGMENT MOVES THE TNT OFFSET     */ 00420000
*                         /* ENTRY ADDRESSED BY CKPTNTPT INTO        */ 00421000
*                         /* OFSENTRY AND EXITS WITH CKPTNTPT        */ 00422000
*                         /* POINTING TO THE NEXT TNT OFFSET.        */ 00423000
*                         /*                                         */ 00424000
*                         /*******************************************/ 00425000
*                                                               06S0405 00426000
*                         DO;                                   06S0405 00427000
*                           CKPTNTNB=CKPTNTNB-1;/* DECREMENT NUMBER     00428000
*                                      OF OFFSETS LEFT TO PROCESS    */ 00429000
         LH    @14,CKPTNTNB(,RCKPT)                             06S0406 00430000
         BCTR  @14,0                                            06S0406 00431000
         STH   @14,CKPTNTNB(,RCKPT)                             06S0406 00432000
*                           RPARM=ADDR(OFSENTRY);/* SET POINTER TO      00433000
*                                      TARGET OF TNT MOVE            */ 00434000
         LA    RPARM,OFSENTRY                                   06S0407 00435000
*                           REG00=LENGTH(ICTNTOFF);/* SET LENGTH OF     00436000
*                                      TNT OFFSET ENTRY              */ 00437000
         LA    REG00,3                                          06S0408 00438000
*                           REG15=CKPTNTLN;/* SET LENGTH OF TNT DATA    00439000
*                                      IN THIS UNIT                  */ 00440000
         LH    REG15,CKPTNTLN(,RCKPT)                           06S0409 00441000
*                           IF REG15>REG00/* TEST FOR MORE DATA THAN    00442000
*                                      IS NEEDED                     */ 00443000
*                             THEN  /* THERE IS MORE DATA IN THIS       00444000
*                                      UNIT THAN IS NEEDED           */ 00445000
         CR    REG15,REG00                                      06S0410 00446000
         BNH   @RF00410                                         06S0410 00447000
*                             REG15=REG00;/* RESET LENGTH-TO-MOVE TO    00448000
*                                      ENTRY LENGTH                  */ 00449000
         LR    REG15,REG00                                      06S0411 00450000
*                           DO UNTIL REG15=0;/* MOVE THE TNT DATA    */ 00451000
@RF00410 DS    0H                                               06S0412 00452000
@DL00412 DS    0H                                               06S0413 00453000
*                             RPARM->MOVECHAR(1:REG15)=CKPTNTPT->       00454000
*                                 MOVECHAR(1:REG15);/* MOVE TNT DATA    00455000
*                                      FROM THE UNIT TO THE WORKAREA */ 00456000
         LR    @14,REG15                                        06S0413 00457000
         BCTR  @14,0                                            06S0413 00458000
         L     @12,CKPTNTPT(,RCKPT)                             06S0413 00459000
         EX    @14,@SM01748                                     06S0413 00460000
*                             CKPTNTPT=CKPTNTPT+REG15;/* POINT TO       00461000
*                                      NEXT AVIALABLE DATA           */ 00462000
         ALR   @12,REG15                                        06S0414 00463000
         ST    @12,CKPTNTPT(,RCKPT)                             06S0414 00464000
*                             RPARM=RPARM+REG15;/* BUMP TO NEXT 06S0415 00465000
*                                      TARGET BYTE IN WORKAREA       */ 00466000
         ALR   RPARM,REG15                                      06S0415 00467000
*                             CKPTNTLN=CKPTNTLN-REG15;/* DECREMENT      00468000
*                                      DATA LEFT IN THIS UNIT        */ 00469000
         LH    @14,CKPTNTLN(,RCKPT)                             06S0416 00470000
         SLR   @14,REG15                                        06S0416 00471000
         STH   @14,CKPTNTLN(,RCKPT)                             06S0416 00472000
*                             IF CKPTNTLN<=0/* TEST FOR MORE DATA IN    00473000
*                                      THIS UNIT                     */ 00474000
*                               THEN/* NO MORE DATA IN THIS UNIT     */ 00475000
         LTR   @14,@14                                          06S0417 00476000
         BP    @RF00417                                         06S0417 00477000
*                               DO;                             06S0418 00478000
*                                 CKPTNTUN=ICTNTTIC;/* POINT TO NEXT    00479000
*                                      UNIT                          */ 00480000
         L     @14,CKPTNTUN(,RCKPT)                             06S0419 00481000
         L     @14,ICTNTTIC(,@14)                               06S0419 00482000
         ST    @14,CKPTNTUN(,RCKPT)                             06S0419 00483000
*                                 CKPTNTPT=ADDR(ICTNTDAT);/* POINT TO   00484000
*                                      DATA IN NEXT UNIT             */ 00485000
         LA    @14,ICTNTDAT(,@14)                               06S0420 00486000
         ST    @14,CKPTNTPT(,RCKPT)                             06S0420 00487000
*                                 CKPTNTLN=AVTKEYLE;/* SET LENGTH OF    00488000
*                                      DATA IN NEXT UNIT             */ 00489000
         LH    @14,AVTKEYLE(,RAVT)                              06S0421 00490000
         STH   @14,CKPTNTLN(,RCKPT)                             06S0421 00491000
*                               END;                            06S0422 00492000
*                             REG00=REG00-REG15;/* SET DATA LEFT TO     00493000
*                                      BE MOVED                      */ 00494000
@RF00417 SLR   REG00,REG15                                      06S0423 00495000
*                             REG15=REG00;/* SET LENGTH FOR NEXT MOVE*/ 00496000
         LR    REG15,REG00                                      06S0424 00497000
*                           END;                                06S0425 00498000
@DE00412 LTR   REG15,REG15                                      06S0425 00499000
         BNZ   @DL00412                                         06S0425 00500000
*                         END;                                  06S0426 00501000
*                         PLMVLNTH=DEVLEN;/* SET LENGTH OF DEVICE       00502000
*                                      RECORD TO BE SKIPPED          */ 00503000
         L     @14,PLMVSD(,RPLMV)                               05S0427 00504000
         SLR   @12,@12                                          05S0427 00505000
         IC    @12,DEVLEN(,@14)                                 05S0427 00506000
         STH   @12,PLMVLNTH(,RPLMV)                             05S0427 00507000
*                         RPARM=RPLMV;/* SET ADDRESS OF PARAMETER       00508000
*                                      LIST                          */ 00509000
         LR    RPARM,RPLMV                                      05S0428 00510000
*                         CALL IEDMVBFR;/* CALL MOVE BUFFER ROUTINE     00511000
*                                      TO SKIP DEVICE RECORD         */ 00512000
         L     @12,AVTSAVTP(,RAVT)                              05S0429 00513000
         L     @15,SAVTMVBF(,@12)                               05S0429 00514000
         BALR  @14,@15                                          05S0429 00515000
*                       END;                                    05S0430 00516000
@DE00404 LH    @14,OFFSET                                       05S0430 00517000
         N     @14,@CF01747                                     05S0430 00518000
         LTR   @14,@14                                          05S0430 00519000
         BZ    @DL00404                                         05S0430 00520000
*                       OCTRMTBL=OFFSET;/* SAVE TNT OFFSET           */ 00521000
         LH    @14,OFFSET                                       05S0431 00522000
         N     @14,@CF01747                                     05S0431 00523000
         STH   @14,OCTRMTBL(,ROPCE)                             05S0431 00524000
*                                                               06S0432 00525000
*                       /*********************************************/ 00526000
*                       /*                                           */ 00527000
*                       /* PROCESS.RESOURCE.ICINIT.MULTILEA.SETRSID: */ 00528000
*                       /* THIS SEGMENT FINDS THE RSID IN THE DEVICE */ 00529000
*                       /* RECORD. PLMVSD POINTS TO THE DEVICE       */ 00530000
*                       /* RECORD. THE FIRST BYTE OF THE DEVICE      */ 00531000
*                       /* RECORD IS THE LENGTH OF THE DEVICE RECORD.*/ 00532000
*                       /* THE NEXT TWO BYTES ARE THE RSID. MOVE THE */ 00533000
*                       /* RSID TO A SAVEAREA, REMOVE THE SUBAREA    */ 00534000
*                       /* ADDRESS, AND SAVE RSID IN THE OPCE.       */ 00535000
*                       /*                                           */ 00536000
*                       /*********************************************/ 00537000
*                                                               06S0432 00538000
*                       DO;                                     06S0432 00539000
*                         RPARM=PLMVSU+12+AVTKEYLE;/* SET END OF THE    00540000
*                                      UNIT ADDRESS                  */ 00541000
         LA    RPARM,12                                         06S0433 00542000
         AL    RPARM,PLMVSU(,RPLMV)                             06S0433 00543000
         AH    RPARM,AVTKEYLE(,RAVT)                            06S0433 00544000
*                         IF PLMVSD+3<=RPARM/* TEST FOR RSID FULLY      00545000
*                                      CONTAINED IN THIS UNIT        */ 00546000
*                           THEN    /* RSID FULLY IN THIS UNIT       */ 00547000
         L     @14,PLMVSD(,RPLMV)                               06S0434 00548000
         LA    @12,3                                            06S0434 00549000
         ALR   @12,@14                                          06S0434 00550000
         CR    @12,RPARM                                        06S0434 00551000
         BH    @RF00434                                         06S0434 00552000
*                           RSID=DEVID;/* SAVE RSID                  */ 00553000
         MVC   RSID(2),DEVID(@14)                               06S0435 00554000
*                         ELSE      /* NOT FULLY IN THIS UNIT        */ 00555000
*                           IF PLMVSD+2=RPARM/* TEST FOR FIRST BYTE     00556000
*                                      OF RSID IN THIS UNIT          */ 00557000
*                             THEN  /* FIRST BYTE IS IN THIS UNIT    */ 00558000
         B     @RC00434                                         06S0436 00559000
@RF00434 L     @14,PLMVSD(,RPLMV)                               06S0436 00560000
         LA    @12,2                                            06S0436 00561000
         ALR   @12,@14                                          06S0436 00562000
         CR    @12,RPARM                                        06S0436 00563000
         BNE   @RF00436                                         06S0436 00564000
*                             DO;                               06S0437 00565000
*                               RSID1=PLMVSD->MOVECHAR(2:2);/* GET      00566000
*                                      FIRST BYTE OF RSID            */ 00567000
         MVC   RSID1(1),MOVECHAR+1(@14)                         06S0438 00568000
*                               RSID2=PLMVSU->ICTNTTIC->ICTNTDAT(1:1);  00569000
         L     @14,PLMVSU(,RPLMV)                               06S0439 00570000
         L     @14,ICTNTTIC(,@14)                               06S0439 00571000
         MVC   RSID2(1),ICTNTDAT(@14)                           06S0439 00572000
*                                   /* GET SECOND BYTE OF RSID FROM     00573000
*                                      THE NEXT UNIT                 */ 00574000
*                             END;                              06S0440 00575000
*                           ELSE    /* RSID IN THE NEXT UNIT         */ 00576000
*                             RSID=PLMVSU->ICTNTTIC->ICTNTDAT(1:2);/*   00577000
*                                      GET RSID FROM NEXT UNIT       */ 00578000
         B     @RC00436                                         06S0441 00579000
@RF00436 L     @14,PLMVSU(,RPLMV)                               06S0441 00580000
         L     @14,ICTNTTIC(,@14)                               06S0441 00581000
         MVC   RSID(2),ICTNTDAT(@14)                            06S0441 00582000
*                         OCRSID=(SAVTZELM&&'FFFF'X)&RSID;/* CLEAR      00583000
*                                      SUBAREA ADDR FROM THE RESOURCE   00584000
*                                      ID                            */ 00585000
@RC00436 DS    0H                                               06S0442 00586000
@RC00434 L     @14,AVTSAVTP(,RAVT)                              06S0442 00587000
         L     @12,@CF01742                                     06S0442 00588000
         LH    @14,SAVTZELM(,@14)                               06S0442 00589000
         N     @14,@CF01747                                     06S0442 00590000
         XR    @12,@14                                          06S0442 00591000
         SLR   @14,@14                                          06S0442 00592000
         ICM   @14,3,RSID                                       06S0442 00593000
         NR    @12,@14                                          06S0442 00594000
         STH   @12,OCRSID(,ROPCE)                               06S0442 00595000
*                       END;                                    06S0443 00596000
*                     END;                                      05S0444 00597000
*                   CKPTTCIN=OCTRMTBL;/* SET TNT OFFSET FOR THE 05S0445 00598000
*                                      DEVICE                        */ 00599000
@RC00379 LH    @14,OCTRMTBL(,ROPCE)                             05S0445 00600000
         N     @14,@CF01747                                     05S0445 00601000
         STH   @14,CKPTTCIN(,RCKPT)                             05S0445 00602000
*                   CKPDATCT=DEVLEN+LENGTH(IEDBDU);/* SET DATA IN       00603000
*                                      CKPT RECORD TO LENGTH OF 05S0446 00604000
*                                      DEVICE RECORD PLUS LENGTH OF A   00605000
*                                      BDU                           */ 00606000
         L     @14,PLMVSD(,RPLMV)                               05S0446 00607000
         LA    @12,6                                            05S0446 00608000
         SLR   @10,@10                                          05S0446 00609000
         IC    @10,DEVLEN(,@14)                                 05S0446 00610000
         ALR   @12,@10                                          05S0446 00611000
         STH   @12,CKPDATCT(,RCKPT)                             05S0446 00612000
*                 END;                                          05S0447 00613000
*               IF LENCNR+CKPDATCT>CKPBLKSZ/* TEST FOR CKPT DATA TOO    00614000
*                                      BIG FOR CKPT RECORD           */ 00615000
*                 THEN              /* DATA IS TOO BIG               */ 00616000
@RC00367 LH    @14,LENCNR                                       04S0448 00617000
         AH    @14,CKPDATCT(,RCKPT)                             04S0448 00618000
         CH    @14,CKPBLKSZ(,RCKPT)                             04S0448 00619000
         BNH   @RF00448                                         04S0448 00620000
*                 CKPENCDE=CKPTOOBG;/* SET 'DATA TOO BIG' MESSAGE       00621000
*                                      INDICATOR                     */ 00622000
         MVI   CKPENCDE(RCKPT),X'0C'                            04S0449 00623000
*               RFY                                             04S0450 00624000
*                 RPLMV UNRSTD;                                 04S0450 00625000
@RF00448 DS    0H                                               04S0451 00626000
*             END;                                              04S0451 00627000
*           IF CKPENCDE=0           /* TEST FOR ERRORS DETECTED IN      00628000
*                                      ICHNG INITIALIZATION          */ 00629000
*             THEN                  /* NO ERRORS FOUND               */ 00630000
@RF00360 CLI   CKPENCDE(RCKPT),0                                03S0452 00631000
         BNE   @RF00452                                         03S0452 00632000
*                                                               04S0453 00633000
*             /*******************************************************/ 00634000
*             /*                                                     */ 00635000
*             /* PROCESS.RESOURCE.READINIT: INITIALIZE THE CKPT      */ 00636000
*             /* WORKAREA FOR A READ OF THE CKPT RECORD.             */ 00637000
*             /*                                                     */ 00638000
*             /*******************************************************/ 00639000
*                                                               04S0453 00640000
*             DO;                                               04S0453 00641000
*               RPARM=OCTRMTBL;     /* GET RESOURCE'S TNT OFFSET     */ 00642000
         LH    RPARM,OCTRMTBL(,ROPCE)                           04S0454 00643000
         N     RPARM,@CF01747                                   04S0454 00644000
*               CKPNRSID=OCRSID;    /* GET RESOURCE TO BE CKPT'ED    */ 00645000
         LH    @14,OCRSID(,ROPCE)                               04S0455 00646000
         N     @14,@CF01747                                     04S0455 00647000
         STH   @14,CKPNRSID(,RCKPT)                             04S0455 00648000
*               CALL IEDQTNT;       /* GET THE TERMINAL ENTRY ADDRESS   00649000
*                                      FOR THE RESOURCE              */ 00650000
         L     @15,AVTRNMPT(,RAVT)                              04S0456 00651000
         BALR  @14,@15                                          04S0456 00652000
*               CKPTRMAD=RPARM-PREFIXSZ;/* SAVE TERM ENTRY PREFIX       00653000
*                                      ADDR                          */ 00654000
         LR    @14,RPARM                                        04S0457 00655000
         SH    @14,PREFIXSZ                                     04S0457 00656000
         ST    @14,CKPTRMAD(,RCKPT)                             04S0457 00657000
*               IF TRMCKPRN=ON      /* DETERMINE WHICH RECORD TO        00658000
*                                      UPDATE                        */ 00659000
*                 THEN              /* UPDATE THE SECOND RECORD      */ 00660000
         TM    TRMCKPRN(@14),B'00000010'                        04S0458 00661000
         BNO   @RF00458                                         04S0458 00662000
*                 CKPNTRK=0;        /* CLEAR ALTERNATE RECORD   04S0459 00663000
*                                      INDICATOR TO INDICATE THAT       00664000
*                                      FIRST RECORD IS TO BE READ FOR   00665000
*                                      INFO                          */ 00666000
         SLR   @14,@14                                          04S0459 00667000
         STH   @14,CKPNTRK(,RCKPT)                              04S0459 00668000
*               ELSE                /* UPDATE FIRST RECORD           */ 00669000
*                 CKPNTRK=CKPTRKCN; /* SET ALTERNATE RECORD INDICATOR   00670000
*                                      TO INDICATE THAT SECOND RECORD   00671000
*                                      IS TO BE READ FOR INFO        */ 00672000
         B     @RC00458                                         04S0460 00673000
@RF00458 LH    @14,CKPTRKCN(,RCKPT)                             04S0460 00674000
         STH   @14,CKPNTRK(,RCKPT)                              04S0460 00675000
*               MVC(CKPSLVAL,CKPSLNEW);/* SHIFT 'SELECT' VALUES FOR     00676000
*                                      NEXT PATH SELECTION           */ 00677000
@RC00458 MVC   CKPSLVAL(3,RCKPT),CKPSLNEW(RCKPT)                04S0461 00678000
*               CKPRWCMD=CKPREAD;   /* SET READ COMMAND              */ 00679000
         MVI   CKPRWCMD(RCKPT),X'06'                            04S0462 00680000
*               CKPRWBC=CKPBLKSZ;   /* SET LENGTH TO LENGTH OF A        00681000
*                                      BLOCK                         */ 00682000
         LH    @14,CKPBLKSZ(,RCKPT)                             04S0463 00683000
         STH   @14,CKPRWBC(,RCKPT)                              04S0463 00684000
*             END;                                              04S0464 00685000
*         END;                                                  03S0465 00686000
*       ELSE                        /* GETMAIN FAILED                */ 00687000
*         DO;                                                   03S0466 00688000
         B     @RC00357                                         03S0466 00689000
@RF00357 DS    0H                                               03S0467 00690000
*           CKPENCDE=CKPGETFL;      /* SET GETMAIN FAILED ERROR CODE */ 00691000
         MVI   CKPENCDE(RCKPT),X'04'                            03S0467 00692000
*           CKPRWADD=0;             /* CLEAR DATA ADDRESS TO SHOW       00693000
*                                      GETMAIN FAILED                */ 00694000
         SLR   @14,@14                                          03S0468 00695000
         STCM  @14,7,CKPRWADD(RCKPT)                            03S0468 00696000
*         END;                                                  03S0469 00697000
*     END;                                                      03S0470 00698000
@RC00357 DS    0H                                               03S0471 00699000
*   IF CKPENCDE=0                   /* TEST FOR I/O REQUESTED        */ 00700000
*     THEN                          /* I/O WAS REQUESTED             */ 00701000
@RC00327 CLI   CKPENCDE(RCKPT),0                                02S0471 00702000
         BNE   @RF00471                                         02S0471 00703000
*     DO;                                                       02S0472 00704000
*       CALL IEDQNW;                /* CALL ROUTINE TO START I/O     */ 00705000
         L     @15,CAVTCRIO(,RCAVT)                             02S0473 00706000
         BALR  @14,@15                                          02S0473 00707000
*       CKPENCDE=REG15;             /* SAVE RETURN CODE              */ 00708000
         STC   REG15,CKPENCDE(,RCKPT)                           02S0474 00709000
*     END;                                                      02S0475 00710000
*                                                               02S0476 00711000
*   /*****************************************************************/ 00712000
*   /*                                                               */ 00713000
*   /* EPILOGUE: THIS SEGMENT COMPLETES THE EPILOGUE CODE THAT WAS   */ 00714000
*   /* ALTERED BY THE MODULE PROCEDURE STATEMENT. REGISTER 2 AND     */ 00715000
*   /* REGISTER 12 ARE RESTORED TO THEIR REQUIRED VALUE FOR IEDQNF.  */ 00716000
*   /* IF I/O WAS STARTED, THEN RETURN TO IEDQNF TO WAIT FOR I/O     */ 00717000
*   /* COMPLETION. IF I/O WAS NOT STARTED, RETURN TO IEDQNF          */ 00718000
*   /* REQUESTING THAT IEDQNU BE LOADED TO WRITE AN ERROR MESSAGE AND*/ 00719000
*   /* TO NOTIFY OP CONTROL THAT THE CKPT IS COMPLETE.               */ 00720000
*   /*                                                               */ 00721000
*   /*****************************************************************/ 00722000
*                                                               02S0476 00723000
*   RFY                                                         02S0476 00724000
*    (REG2,                                                     02S0476 00725000
*     REG12,                                                    02S0476 00726000
*     REG14) RSTD;                                              02S0476 00727000
@RF00471 DS    0H                                               02S0477 00728000
*   REG2=CAVTTCWA;                  /* RESTORE ADDRESS OF TCAM  02S0477 00729000
*                                      CHECKPOINT WORKAREA           */ 00730000
         L     REG2,CAVTTCWA(,RCAVT)                            02S0477 00731000
*   REG12=CKPSAVE2(1);              /* RESTORE IEDQNF'S BASE REGISTER*/ 00732000
         L     REG12,CKPSAVE2(,RCKPT)                           02S0478 00733000
*   REG14=CKPSAVE2(2);              /* RESTORE RETURN ADDRESS        */ 00734000
         L     REG14,CKPSAVE2+4(,RCKPT)                         02S0479 00735000
*   IF CKPENCDE=0                   /* TEST FOR I/O STARTED          */ 00736000
*     THEN                          /* I/O WAS STARTED               */ 00737000
         CLI   CKPENCDE(RCKPT),0                                02S0480 00738000
         BNE   @RF00480                                         02S0480 00739000
*     DO;                                                       02S0481 00740000
*       CAVTWTG=CKPCNCPW;           /* SET WHERE-TO-GO TO MODULE ID     00741000
*                                      OF MODULE TO GET CONTROL WHEN    00742000
*                                      THE I/O COMPLETES             */ 00743000
         MVI   CAVTWTG(RCAVT),X'78'                             02S0482 00744000
*       REG14=REG14+CKPRETNL;       /* SET IEDQNF RETURN POINT THAT     00745000
*                                      REQUESTS NO ADDITIONAL MODULE    00746000
*                                      LOAD                          */ 00747000
         AL    REG14,@CF00327                                   02S0483 00748000
*     END;                                                      02S0484 00749000
*   ELSE                            /* I/O WAS NOT STARTED           */ 00750000
*     DO;                                                       02S0485 00751000
         B     @RC00480                                         02S0485 00752000
@RF00480 DS    0H                                               02S0486 00753000
*       REG15=CKPCNCPW;             /* SET MODULE ID FOR NEXT MODULE    00754000
*                                      TO BE LOADED                  */ 00755000
         LA    REG15,120                                        02S0486 00756000
*       CKPCUSEL=CKPNOTFY;          /* SET SELECT VALUE TO REQUEST      00757000
*                                      THAT OP CONTROL BE NOTIFIED      00758000
*                                      THAT CKPT HAS COMPLETED       */ 00759000
         MVI   CKPCUSEL(RCKPT),X'0A'                            02S0487 00760000
*     END;                                                      02S0488 00761000
*   RFY                                                         02S0489 00762000
*    (REG2,                                                     02S0489 00763000
*     REG12,                                                    02S0489 00764000
*     REG14) UNRSTD;                                            02S0489 00765000
*   END IEDQNT                                                  01S0490 00766000
*                                                               01S0490 00767000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00768000
*/*%INCLUDE SYSLIB  (TAVTD   )                                       */ 00769000
*/*%INCLUDE SYSLIB  (TBDUD   )                                       */ 00770000
*/*%INCLUDE SYSLIB  (TCAVTD  )                                       */ 00771000
*/*%INCLUDE SYSLIB  (TCKPD   )                                       */ 00772000
*/*%INCLUDE SYSLIB  (TCNRD   )                                       */ 00773000
*/*%INCLUDE SYSLIB  (TNCPID  )                                       */ 00774000
*/*%INCLUDE SYSLIB  (TOPCED  )                                       */ 00775000
*/*%INCLUDE SYSLIB  (TOPCAVTD)                                       */ 00776000
*/*%INCLUDE SYSLIB  (TPLMVD  )                                       */ 00777000
*/*%INCLUDE SYSLIB  (TPRUD   )                                       */ 00778000
*/*%INCLUDE SYSLIB  (TTRMD   )                                       */ 00779000
*/*%INCLUDE SYSUT5  (RFY     )                                       */ 00780000
*/*%INCLUDE SYSUT5  (DCL     )                                       */ 00781000
*/*%INCLUDE SYSUT5  (PROLOGUE)                                       */ 00782000
*/*%INCLUDE SYSUT5  (PROCESS )                                       */ 00783000
*/*%INCLUDE SYSUT5  (COMMAND )                                       */ 00784000
*/*%INCLUDE SYSUT5  (CONTROL )                                       */ 00785000
*/*%INCLUDE SYSUT5  (RESOURCE)                                       */ 00786000
*/*%INCLUDE SYSUT5  (ICINIT  )                                       */ 00787000
*/*%INCLUDE SYSUT5  (SWITCHID)                                       */ 00788000
*/*%INCLUDE SYSUT5  (MULTILEA)                                       */ 00789000
*/*%INCLUDE SYSUT5  (TNTINIT )                                       */ 00790000
*/*%INCLUDE SYSUT5  (TNTMOVE )                                       */ 00791000
*/*%INCLUDE SYSUT5  (SETRSID )                                       */ 00792000
*/*%INCLUDE SYSUT5  (READINIT)                                       */ 00793000
*/*%INCLUDE SYSUT5  (EPILOGUE)                                       */ 00794000
*                                                               01S0490 00795000
*       ;                                                       01S0490 00796000
@EL00001 DS    0H                                               01S0490 00797000
@EF00001 DS    0H                                               01S0490 00798000
@ER00001 BR    @14                                              01S0490 00799000
@DATA    DS    0H                                                       00800000
@SM01748 MVC   MOVECHAR(0,RPARM),MOVECHAR(@12)                          00801000
         DS    0F                                                       00802000
         DS    0F                                                       00803000
@CF00066 DC    F'3'                                                     00804000
@CF00327 DC    F'4'                                                     00805000
@CF00071 DC    F'6'                                                     00806000
@CF00235 DC    F'12'                                                    00807000
@CF01747 DC    XL4'0000FFFF'                                            00808000
@CF01742 DC    XL4'FFFF'                                                00809000
         DS    0D                                                       00810000
PREFIXSZ DC    AL2(14)                                                  00811000
LENCNR   DC    AL2(CNRDVBDU-IEDQCNRD)                                   00812000
OFSENTRY DS    CL3                                                      00813000
         ORG   OFSENTRY                                                 00814000
OFFSET   DS    FL2                                                      00815000
OFSTATUS DS    FL1                                                      00816000
         ORG   OFSENTRY+3                                               00817000
RSID     DS    CL2                                                      00818000
         ORG   RSID                                                     00819000
RSID1    DS    CL1                                                      00820000
RSID2    DS    CL1                                                      00821000
         ORG   RSID+2                                                   00822000
CMDTABLE DS    CL44                                                     00823000
         ORG   CMDTABLE                                                 00824000
CHNLD    DS    CL4                                                      00825000
         ORG   CHNLD                                                    00826000
@NM00172 DC    X'07'                                                    00827000
@NM00173 DC    X'01'                                                    00828000
@NM00174 DC    X'01'                                                    00829000
@NM00175 DC    X'0A'                                                    00830000
         ORG   CMDTABLE+4                                               00831000
BKUP     DS    CL4                                                      00832000
         ORG   BKUP                                                     00833000
@NM00176 DC    X'03'                                                    00834000
@NM00177 DC    X'01'                                                    00835000
@NM00178 DC    X'02'                                                    00836000
@NM00179 DC    X'0A'                                                    00837000
         ORG   CMDTABLE+8                                               00838000
IPLC     DS    CL4                                                      00839000
         ORG   IPLC                                                     00840000
@NM00180 DC    X'11'                                                    00841000
@NM00181 DC    X'01'                                                    00842000
@NM00182 DC    X'02'                                                    00843000
@NM00183 DC    X'0A'                                                    00844000
         ORG   CMDTABLE+12                                              00845000
SWBACK   DS    CL4                                                      00846000
         ORG   SWBACK                                                   00847000
@NM00184 DC    X'16'                                                    00848000
@NM00185 DC    X'01'                                                    00849000
@NM00186 DC    X'02'                                                    00850000
@NM00187 DC    X'0A'                                                    00851000
         ORG   CMDTABLE+16                                              00852000
ACTVTE   DS    CL4                                                      00853000
         ORG   ACTVTE                                                   00854000
@NM00188 DC    X'22'                                                    00855000
@NM00189 DC    X'01'                                                    00856000
@NM00190 DC    X'02'                                                    00857000
@NM00191 DC    X'0A'                                                    00858000
         ORG   CMDTABLE+20                                              00859000
BHSET    DS    CL4                                                      00860000
         ORG   BHSET                                                    00861000
@NM00192 DC    X'1D'                                                    00862000
@NM00193 DC    X'02'                                                    00863000
@NM00194 DC    X'01'                                                    00864000
@NM00195 DC    X'0A'                                                    00865000
         ORG   CMDTABLE+24                                              00866000
CHGSSP   DS    CL4                                                      00867000
         ORG   CHGSSP                                                   00868000
@NM00196 DC    X'A0'                                                    00869000
@NM00197 DC    X'02'                                                    00870000
@NM00198 DC    X'02'                                                    00871000
@NM00199 DC    X'0A'                                                    00872000
         ORG   CMDTABLE+28                                              00873000
CHGNP    DS    CL4                                                      00874000
         ORG   CHGNP                                                    00875000
@NM00200 DC    X'90'                                                    00876000
@NM00201 DC    X'02'                                                    00877000
@NM00202 DC    X'03'                                                    00878000
@NM00203 DC    X'0A'                                                    00879000
         ORG   CMDTABLE+32                                              00880000
SESSNL   DS    CL4                                                      00881000
         ORG   SESSNL                                                   00882000
@NM00204 DC    X'1E'                                                    00883000
@NM00205 DC    X'02'                                                    00884000
@NM00206 DC    X'04'                                                    00885000
@NM00207 DC    X'0A'                                                    00886000
         ORG   CMDTABLE+36                                              00887000
TRANL    DS    CL4                                                      00888000
         ORG   TRANL                                                    00889000
@NM00208 DC    X'1F'                                                    00890000
@NM00209 DC    X'02'                                                    00891000
@NM00210 DC    X'05'                                                    00892000
@NM00211 DC    X'0A'                                                    00893000
         ORG   CMDTABLE+40                                              00894000
SSELCT   DS    CL4                                                      00895000
         ORG   SSELCT                                                   00896000
@NM00212 DC    X'26'                                                    00897000
@NM00213 DC    X'02'                                                    00898000
@NM00214 DC    X'06'                                                    00899000
@NM00215 DC    X'0A'                                                    00900000
         ORG   CMDTABLE+44                                              00901000
ICHNG    DS    CL4                                                      00902000
         ORG   ICHNG                                                    00903000
@NM00216 DC    X'49'                                                    00904000
ICHNGSEL DS    CL3                                                      00905000
         ORG   ICHNGSEL                                                 00906000
@NM00217 DC    X'02'                                                    00907000
@NM00218 DC    X'07'                                                    00908000
@NM00219 DC    X'0A'                                                    00909000
         ORG   ICHNG+4                                                  00910000
TCHNG    DS    CL4                                                      00911000
         ORG   TCHNG                                                    00912000
@NM00220 DC    X'56'                                                    00913000
TCHNGSEL DS    CL3                                                      00914000
         ORG   TCHNGSEL                                                 00915000
@NM00221 DC    X'02'                                                    00916000
@NM00222 DC    X'08'                                                    00917000
@NM00223 DC    X'0A'                                                    00918000
         ORG   TCHNG+4                                                  00919000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00920000
@01      EQU   01                                                       00921000
@02      EQU   02                                                       00922000
@03      EQU   03                                                       00923000
@04      EQU   04                                                       00924000
@05      EQU   05                                                       00925000
@06      EQU   06                                                       00926000
@07      EQU   07                                                       00927000
@08      EQU   08                                                       00928000
@09      EQU   09                                                       00929000
@10      EQU   10                                                       00930000
@11      EQU   11                                                       00931000
@12      EQU   12                                                       00932000
@13      EQU   13                                                       00933000
@14      EQU   14                                                       00934000
@15      EQU   15                                                       00935000
RCAVT    EQU   @05                                                      00936000
RCKPT    EQU   @04                                                      00937000
ROPCE    EQU   @03                                                      00938000
RPLMV    EQU   @08                                                      00939000
RAVT     EQU   @09                                                      00940000
REG00    EQU   @00                                                      00941000
RPARM    EQU   @01                                                      00942000
REG2     EQU   @02                                                      00943000
RTAB     EQU   @06                                                      00944000
RBASE    EQU   @11                                                      00945000
REG12    EQU   @12                                                      00946000
RSAVE    EQU   @13                                                      00947000
REG14    EQU   @14                                                      00948000
REG15    EQU   @15                                                      00949000
CVTPTR   EQU   16                                                       00950000
IEDQAVTD EQU   0                                                        00951000
AVTSAVEX EQU   IEDQAVTD+288                                             00952000
@NM00003 EQU   IEDQAVTD+388                                             00953000
AVTCKFLG EQU   @NM00003                                                 00954000
AVTCKAVT EQU   @NM00003+1                                               00955000
AVTOCGET EQU   IEDQAVTD+392                                             00956000
AVTBASE  EQU   IEDQAVTD+412                                             00957000
AVTPKF   EQU   AVTBASE                                                  00958000
AVTRNMPT EQU   IEDQAVTD+424                                             00959000
AVTHG02  EQU   IEDQAVTD+528                                             00960000
AVTDISP  EQU   IEDQAVTD+552                                             00961000
AVTHD    EQU   IEDQAVTD+556                                             00962000
AVTSCOPT EQU   AVTHD                                                    00963000
AVTSAVTP EQU   IEDQAVTD+612                                             00964000
AVTSAVTF EQU   AVTSAVTP                                                 00965000
AVTCKPEL EQU   IEDQAVTD+652                                             00966000
AVTCKRMV EQU   AVTCKPEL                                                 00967000
AVTCKELF EQU   IEDQAVTD+680                                             00968000
AVTCKBYT EQU   IEDQAVTD+691                                             00969000
AVTHG01  EQU   IEDQAVTD+692                                             00970000
AVTCKLNK EQU   IEDQAVTD+696                                             00971000
AVTCRELE EQU   IEDQAVTD+708                                             00972000
AVTCCELE EQU   AVTCRELE                                                 00973000
AVTCLRHI EQU   IEDQAVTD+716                                             00974000
AVTADBUF EQU   IEDQAVTD+720                                             00975000
AVTSYSER EQU   IEDQAVTD+728                                             00976000
AVTCKPQB EQU   IEDQAVTD+804                                             00977000
AVTCKPTB EQU   AVTCKPQB                                                 00978000
AVTCKPEC EQU   AVTCKPQB+4                                               00979000
AVTCKPCC EQU   AVTCKPEC                                                 00980000
AVTOPCQB EQU   IEDQAVTD+816                                             00981000
AVTOPCOB EQU   AVTOPCQB                                                 00982000
AVTOPCEC EQU   AVTOPCQB+4                                               00983000
AVTOPCCC EQU   AVTOPCEC                                                 00984000
AVTOLTQB EQU   IEDQAVTD+828                                             00985000
AVTCWFL1 EQU   IEDQAVTD+924                                             00986000
AVTCWFL2 EQU   IEDQAVTD+925                                             00987000
AVTSUBT  EQU   IEDQAVTD+948                                             00988000
AVTIOTR  EQU   IEDQAVTD+949                                             00989000
AVTKEYLE EQU   IEDQAVTD+1032                                            00990000
AVTBIT1  EQU   IEDQAVTD+1050                                            00991000
AVTBIT2  EQU   IEDQAVTD+1051                                            00992000
AVTBIT3  EQU   IEDQAVTD+1052                                            00993000
AVTBIT4  EQU   IEDQAVTD+1136                                            00994000
@NM00083 EQU   IEDQAVTD+1232                                            00995000
IEDQAPTR EQU   0                                                        00996000
IEDNSVTD EQU   0                                                        00997000
SAVTDIAG EQU   IEDNSVTD                                                 00998000
SAVTDIAF EQU   SAVTDIAG                                                 00999000
SAVTLUSQ EQU   IEDNSVTD+88                                              01000000
SAVTMVBF EQU   IEDNSVTD+160                                             01001000
SAVTTCPU EQU   IEDNSVTD+238                                             01002000
SAVTZELM EQU   IEDNSVTD+270                                             01003000
SAVTRDRV EQU   IEDNSVTD+284                                             01004000
SAVTCKQB EQU   IEDNSVTD+300                                             01005000
SAVTCKTB EQU   SAVTCKQB                                                 01006000
SAVTCKEC EQU   SAVTCKQB+4                                               01007000
SAVTCKCC EQU   SAVTCKEC                                                 01008000
IEDBDU   EQU   0                                                        01009000
BDUFNFLG EQU   IEDBDU+2                                                 01010000
BDUBDUFG EQU   IEDBDU+3                                                 01011000
BDURSP   EQU   IEDBDU+4                                                 01012000
BDUSYRSP EQU   BDURSP                                                   01013000
BDUEXRSP EQU   BDURSP+1                                                 01014000
BDUEND   EQU   IEDBDU+6                                                 01015000
IEDQCKAD EQU   0                                                        01016000
CAVTTCWA EQU   IEDQCKAD                                                 01017000
CAVTNWA  EQU   IEDQCKAD+4                                               01018000
CAVTWTG  EQU   IEDQCKAD+8                                               01019000
CAVTWL1  EQU   IEDQCKAD+12                                              01020000
CAVTWL2  EQU   CAVTWL1+8                                                01021000
CAVTCRIO EQU   IEDQCKAD+28                                              01022000
IEDQCKPD EQU   0                                                        01023000
CKPSAVE1 EQU   IEDQCKPD                                                 01024000
CKPIOB   EQU   IEDQCKPD+72                                              01025000
CKPIOECB EQU   CKPIOB+4                                                 01026000
CKPIOSK  EQU   CKPIOB+32                                                01027000
CKPEXCP  EQU   IEDQCKPD+116                                             01028000
CKPECBL  EQU   IEDQCKPD+120                                             01029000
CKPCNVRT EQU   CKPECBL                                                  01030000
CKPIOQL  EQU   IEDQCKPD+132                                             01031000
@NM00107 EQU   CKPIOQL                                                  01032000
CKPCTTRB EQU   IEDQCKPD+144                                             01033000
CKPCRLEN EQU   IEDQCKPD+160                                             01034000
CKPCCWS  EQU   IEDQCKPD+168                                             01035000
CKPTIC   EQU   CKPCCWS+24                                               01036000
CKPRW    EQU   CKPCCWS+32                                               01037000
CKPRWCMD EQU   CKPRW                                                    01038000
CKPRWADD EQU   CKPRW+1                                                  01039000
CKPRWBC  EQU   CKPRW+6                                                  01040000
@NM00110 EQU   IEDQCKPD+208                                             01041000
CKPGETML EQU   @NM00110                                                 01042000
CKPMSG   EQU   IEDQCKPD+220                                             01043000
CKPMSGTX EQU   CKPMSG+4                                                 01044000
CKPMSGTP EQU   CKPMSG+41                                                01045000
CKPCNTLR EQU   IEDQCKPD+288                                             01046000
CKPFLAGS EQU   CKPCNTLR                                                 01047000
CKPPRQNO EQU   CKPCNTLR+17                                              01048000
IEDQCDRD EQU   0                                                        01049000
CDRTTRLI EQU   IEDQCDRD+9                                               01050000
CDRDATA  EQU   IEDQCDRD+12                                              01051000
IEDQCRED EQU   0                                                        01052000
CRELINK  EQU   IEDQCRED+4                                               01053000
CREOFFS  EQU   IEDQCRED+12                                              01054000
CKPREQTB EQU   0                                                        01055000
CKPCTFLG EQU   CKPREQTB                                                 01056000
CKPNRES  EQU   0                                                        01057000
CKPNFLG  EQU   CKPNRES+4                                                01058000
CKPAVT   EQU   0                                                        01059000
IEDQCNRD EQU   0                                                        01060000
CNRDATTM EQU   IEDQCNRD+2                                               01061000
CNRCNTL  EQU   IEDQCNRD+10                                              01062000
CNRBHSET EQU   IEDQCNRD+12                                              01063000
CNRBHFUN EQU   CNRBHSET                                                 01064000
CNRDEVRC EQU   IEDQCNRD+19                                              01065000
RCKPREC  EQU   0                                                        01066000
IEDNCP   EQU   0                                                        01067000
NCPFLAG1 EQU   IEDNCP+1                                                 01068000
NCPREST  EQU   NCPFLAG1                                                 01069000
NCPTRACE EQU   NCPFLAG1                                                 01070000
NCPBKUPN EQU   IEDNCP+2                                                 01071000
NCPTXID  EQU   IEDNCP+10                                                01072000
IEDQOPCE EQU   0                                                        01073000
OCELEM   EQU   IEDQOPCE+4                                               01074000
OCUNIT   EQU   IEDQOPCE+8                                               01075000
OCRUDEST EQU   OCUNIT                                                   01076000
OCCKPKEY EQU   OCRUDEST                                                 01077000
OCSCAN   EQU   OCCKPKEY                                                 01078000
OCOPTCDE EQU   IEDQOPCE+12                                              01079000
OCSWITCH EQU   IEDQOPCE+13                                              01080000
OCFLAG   EQU   IEDQOPCE+14                                              01081000
@NM00133 EQU   IEDQOPCE+16                                              01082000
OCDEST   EQU   @NM00133                                                 01083000
OCREQVAL EQU   OCDEST+1                                                 01084000
OCTRMTBL EQU   IEDQOPCE+20                                              01085000
OCLINENO EQU   IEDQOPCE+22                                              01086000
OCTIOT   EQU   OCLINENO                                                 01087000
OCTRUNIT EQU   IEDQOPCE+24                                              01088000
OCRSID   EQU   OCTRUNIT                                                 01089000
OCALSTAT EQU   OCRSID                                                   01090000
OCPARM   EQU   IEDQOPCE+28                                              01091000
OCBACKUP EQU   IEDQOPCE+32                                              01092000
OCMODNME EQU   IEDQOPCE+40                                              01093000
OCIPLWA  EQU   OCMODNME                                                 01094000
OCCKDATA EQU   IEDQOPCE+48                                              01095000
OCRSTGTM EQU   OCCKDATA                                                 01096000
IEDQOPCN EQU   0                                                        01097000
OCLDNME  EQU   IEDQOPCN                                                 01098000
OCLINTTE EQU   OCLDNME                                                  01099000
OCREQFLG EQU   OCLINTTE+2                                               01100000
OCPREFLG EQU   OCLINTTE+3                                               01101000
IEDQOPCD EQU   0                                                        01102000
OPCAQCTL EQU   IEDQOPCD+180                                             01103000
OPCLDNME EQU   IEDQOPCD+212                                             01104000
OPCCKPTF EQU   IEDQOPCD+248                                             01105000
OPCSPEC  EQU   IEDQOPCD+300                                             01106000
ROPCAVT  EQU   0                                                        01107000
IEDPLMV  EQU   0                                                        01108000
PLMVTU   EQU   IEDPLMV                                                  01109000
PLMVTD   EQU   IEDPLMV+4                                                01110000
PLMVSU   EQU   IEDPLMV+8                                                01111000
PLMVSD   EQU   IEDPLMV+12                                               01112000
PLMVLNTH EQU   IEDPLMV+16                                               01113000
PLMVFLG1 EQU   IEDPLMV+18                                               01114000
PLMVFLG2 EQU   IEDPLMV+19                                               01115000
PLMVUNCA EQU   IEDPLMV+20                                               01116000
IEDPLMVP EQU   0                                                        01117000
IEDPRUQD EQU   0                                                        01118000
PRUTTCIN EQU   IEDPRUQD                                                 01119000
PRUDATCT EQU   IEDPRUQD+2                                               01120000
PRUTIC   EQU   IEDPRUQD+8                                               01121000
PRUDATA  EQU   IEDPRUQD+12                                              01122000
IEDPRUND EQU   0                                                        01123000
PRURHTH  EQU   IEDPRUND                                                 01124000
PRURH    EQU   PRURHTH                                                  01125000
PRURHFG0 EQU   PRURH                                                    01126000
PRURHFG1 EQU   PRURH+1                                                  01127000
PRURHFG2 EQU   PRURH+2                                                  01128000
PRUTH    EQU   PRURHTH+3                                                01129000
PRUFIDN  EQU   PRUTH                                                    01130000
IEDTRM   EQU   0                                                        01131000
IEDNTRM  EQU   IEDTRM                                                   01132000
TRMBYTE4 EQU   IEDNTRM                                                  01133000
TRMBYTE3 EQU   IEDNTRM+1                                                01134000
TRMBYTE2 EQU   IEDNTRM+2                                                01135000
TRMINPG  EQU   TRMBYTE2                                                 01136000
TRMBYTE1 EQU   IEDNTRM+3                                                01137000
TRMSCPRQ EQU   TRMBYTE1                                                 01138000
TRMCKPRN EQU   TRMBYTE1                                                 01139000
TRMBYTE0 EQU   IEDNTRM+6                                                01140000
TRMSIBPT EQU   IEDNTRM+7                                                01141000
IEDQTRM  EQU   IEDTRM+14                                                01142000
TRMSTATE EQU   IEDQTRM                                                  01143000
TRMLOG   EQU   TRMSTATE                                                 01144000
TRMINSEQ EQU   IEDQTRM+4                                                01145000
TLISTCNT EQU   TRMINSEQ                                                 01146000
TRMOUTSQ EQU   IEDQTRM+6                                                01147000
TLISTEN  EQU   TRMOUTSQ                                                 01148000
TRMDSORG EQU   TLISTEN                                                  01149000
TRMALTD  EQU   IEDQTRM+8                                                01150000
TRMDEVFL EQU   IEDQTRM+10                                               01151000
TRMSTAT  EQU   IEDQTRM+12                                               01152000
RTRM     EQU   0                                                        01153000
MOVECHAR EQU   0                                                        01154000
IEDMVBFR EQU   0                                                        01155000
IEDQNW   EQU   0                                                        01156000
IEDQTNT  EQU   0                                                        01157000
ICTNT    EQU   0                                                        01158000
ICTNTTIC EQU   ICTNT+8                                                  01159000
ICTNTDAT EQU   ICTNT+12                                                 01160000
ICTNTCTL EQU   ICTNTDAT                                                 01161000
ICTNTNO  EQU   ICTNTCTL                                                 01162000
ICTNTNU  EQU   ICTNTCTL+2                                               01163000
ICTNTOFF EQU   ICTNTDAT+3                                               01164000
MULTIPNT EQU   0                                                        01165000
MULRCDS  EQU   MULTIPNT+4                                               01166000
LEASED   EQU   0                                                        01167000
LEARCD   EQU   LEASED+2                                                 01168000
DEVRCD   EQU   0                                                        01169000
DEVLEN   EQU   DEVRCD                                                   01170000
DEVID    EQU   DEVRCD+1                                                 01171000
TABENTRY EQU   0                                                        01172000
CMDID    EQU   TABENTRY                                                 01173000
TABSELCT EQU   TABENTRY+1                                               01174000
CNTTDU   EQU   TABSELCT+1                                               01175000
CKPINIT  EQU   CKPEXCP                                                  01176000
CKPTWA   EQU   CKPMSGTX                                                 01177000
CKPSAVE2 EQU   CKPTWA                                                   01178000
CKPTRMAD EQU   CKPTWA+60                                                01179000
CKPNCNTL EQU   CKPCNTLR                                                 01180000
CKPTRSTA EQU   CKPNCNTL+2                                               01181000
CKPIPLTX EQU   CKPNCNTL+4                                               01182000
CKPBLKSZ EQU   CKPNCNTL+12                                              01183000
CKPTRKCN EQU   CKPNCNTL+16                                              01184000
CKPDATTM EQU   CKPNCNTL+22                                              01185000
CKPDATE  EQU   CKPDATTM                                                 01186000
CKPTIME  EQU   CKPDATTM+4                                               01187000
CKPBCKUP EQU   CKPNCNTL+30                                              01188000
CKPNFLDS EQU   CKPEXCP                                                  01189000
CKPENCDE EQU   CKPNFLDS+7                                               01190000
CKPNDEVF EQU   CKPNFLDS+12                                              01191000
CKPNSELT EQU   CKPNFLDS+16                                              01192000
CKPCUSEL EQU   CKPNSELT                                                 01193000
CKPSLNEW EQU   CKPNSELT+1                                               01194000
CKPNTRK  EQU   CKPNFLDS+20                                              01195000
CKPNRSID EQU   CKPNFLDS+22                                              01196000
CKPSLVAL EQU   CKPNSELT                                                 01197000
CKPOVER  EQU   CKPMSGTP+1                                               01198000
CKPOPNFL EQU   CKPFLAGS                                                 01199000
CDRINCFM EQU   CDRTTRLI                                                 01200000
CDRCREQR EQU   IEDQCDRD                                                 01201000
CDRCKFLG EQU   CDRCREQR                                                 01202000
OCCKPKY1 EQU   OCCKPKEY                                                 01203000
OCCKPTYP EQU   OCCKPKY1                                                 01204000
OCICACTN EQU   OCMODNME                                                 01205000
OCICDADR EQU   OCICACTN                                                 01206000
OCICTYPE EQU   OCICDADR                                                 01207000
OCICSW   EQU   OCICDADR+3                                               01208000
OPCAQWD  EQU   OPCAQCTL                                                 01209000
OPCAQWD1 EQU   OPCAQWD                                                  01210000
OPCAQWD2 EQU   OPCAQWD+4                                                01211000
OPCAQWD3 EQU   OPCAQWD+8                                                01212000
IEDPRUQP EQU   PLMVSU                                                   01213000
TRMPRE1  EQU   TRMBYTE4                                                 01214000
TRMPRE   EQU   TRMBYTE3                                                 01215000
TRMNCP   EQU   TRMBYTE3                                                 01216000
TRMPU    EQU   TRMBYTE3                                                 01217000
TRMLU    EQU   TRMBYTE3                                                 01218000
TRMLINK  EQU   TRMBYTE3                                                 01219000
ICCKPT   EQU   CKPSAVE2+8                                               01220000
CKPTNTUN EQU   ICCKPT                                                   01221000
CKPTNTPT EQU   ICCKPT+4                                                 01222000
CKPTNTLN EQU   ICCKPT+8                                                 01223000
CKPTNTNB EQU   ICCKPT+10                                                01224000
CKPTC    EQU   ICCKPT+12                                                01225000
CKPTTCIN EQU   CKPTC                                                    01226000
CKPDATCT EQU   CKPTC+2                                                  01227000
CNRDVDAT EQU   CNRDEVRC                                                 01228000
CNRDVPRF EQU   CNRDVDAT                                                 01229000
CNRDVTC  EQU   CNRDVPRF                                                 01230000
CNRDVBDU EQU   CNRDVDAT+12                                              01231000
BDUTEXT  EQU   BDUEND                                                   01232000
CDROPCB  EQU   CDRDATA                                                  01233000
CKPMSGPN EQU   CKPMSGTP+6                                               01234000
CKPTTRLT EQU   CKPTIC+5                                                 01235000
OCCIB    EQU   OCREQVAL                                                 01236000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01237000
CNRDVRCD EQU   CNRDVDAT+18                                              01238000
@NM00170 EQU   CNRDVPRF+4                                               01239000
CNRDVC   EQU   CNRDVTC+2                                                01240000
CNRDVT   EQU   CNRDVTC                                                  01241000
@NM00169 EQU   TRMLINK                                                  01242000
TRMLSTAT EQU   TRMLINK                                                  01243000
TRMLINT  EQU   TRMLINK                                                  01244000
TRMEPMOD EQU   TRMLINK                                                  01245000
TRMLULOG EQU   TRMLU                                                    01246000
TRMINERR EQU   TRMLU                                                    01247000
TRMLUREQ EQU   TRMLU                                                    01248000
TRMSESRQ EQU   TRMLU                                                    01249000
TRMTDIFF EQU   TRMLU                                                    01250000
TRMLUTM  EQU   TRMLU                                                    01251000
TRMLUIT  EQU   TRMLU                                                    01252000
TRMAUTO  EQU   TRMLU                                                    01253000
TRMPCONT EQU   TRMPU                                                    01254000
@NM00168 EQU   TRMPU                                                    01255000
TRMNCONT EQU   TRMNCP                                                   01256000
TRMQUCKN EQU   TRMNCP                                                   01257000
TRMSLOWN EQU   TRMNCP                                                   01258000
TRMSYGEN EQU   TRMNCP                                                   01259000
TRMNCPCL EQU   TRMNCP                                                   01260000
TRMIPLDM EQU   TRMNCP                                                   01261000
TRMINOUT EQU   TRMPRE                                                   01262000
TRMRDOUT EQU   TRMPRE                                                   01263000
TRMNLOUT EQU   TRMPRE                                                   01264000
TRMWROUT EQU   TRMPRE                                                   01265000
TRMASNXI EQU   TRMPRE                                                   01266000
TRMSTMM  EQU   TRMPRE                                                   01267000
TRMCMODE EQU   TRMPRE                                                   01268000
TRMSTPND EQU   TRMPRE                                                   01269000
TRMLYNCH EQU   TRMPRE1                                                  01270000
TRMSPOUT EQU   TRMPRE1                                                  01271000
TRMERLCK EQU   TRMPRE1                                                  01272000
TRMQNPL  EQU   TRMPRE1                                                  01273000
TRMSPACT EQU   TRMPRE1                                                  01274000
TRMOCNI  EQU   TRMPRE1                                                  01275000
TRMSESSN EQU   TRMPRE1                                                  01276000
TRMCONT  EQU   TRMPRE1                                                  01277000
OPCAQLST EQU   OPCAQWD3+1                                               01278000
OPCAQRQ3 EQU   OPCAQWD3                                                 01279000
OPCAQSEC EQU   OPCAQWD2+1                                               01280000
OPCAQRQ2 EQU   OPCAQWD2                                                 01281000
OPCAQFST EQU   OPCAQWD1+1                                               01282000
OPCAQREQ EQU   OPCAQWD1                                                 01283000
OCICINAC EQU   OCICSW                                                   01284000
@NM00139 EQU   OCICSW                                                   01285000
OCICATST EQU   OCICDADR+1                                               01286000
@NM00138 EQU   OCCKPKY1                                                 01287000
OCCKPENV EQU   OCCKPKY1                                                 01288000
OCCKPRST EQU   OCCKPTYP                                                 01289000
OCCKPNCP EQU   OCCKPTYP                                                 01290000
OCCKPINC EQU   OCCKPTYP                                                 01291000
CDRCKOPT EQU   CDRCREQR+41                                              01292000
CDRCKPQB EQU   CDRCREQR+38                                              01293000
CDRCKQCB EQU   CDRCREQR+17                                              01294000
CDRCKQBC EQU   CDRCREQR+14                                              01295000
CDRCKMSG EQU   CDRCREQR+12                                              01296000
CDRCKOFF EQU   CDRCREQR+10                                              01297000
@NM00124 EQU   CDRCREQR+9                                               01298000
@NM00123 EQU   CDRCREQR+8                                               01299000
CDRCKOUT EQU   CDRCREQR+6                                               01300000
CDRCKIN  EQU   CDRCREQR+4                                               01301000
@NM00122 EQU   CDRCREQR+1                                               01302000
CDRCKRNC EQU   CDRCKFLG                                                 01303000
CDROPTN  EQU   CDRINCFM+7                                               01304000
CDRSEQOU EQU   CDRINCFM+5                                               01305000
CDRSEQIN EQU   CDRINCFM+3                                               01306000
CDROFFS  EQU   CDRINCFM+1                                               01307000
CDRSTAT  EQU   CDRINCFM                                                 01308000
@NM00121 EQU   CKPOPNFL                                                 01309000
CKPOPNCR EQU   CKPOPNFL                                                 01310000
CKPOPNIN EQU   CKPOPNFL                                                 01311000
CKPOPNEN EQU   CKPOPNFL                                                 01312000
@NM00120 EQU   CKPOPNFL                                                 01313000
CKPTRKSA EQU   CKPOVER+4                                                01314000
CKPTRKLN EQU   CKPOVER+2                                                01315000
CKPRCDSR EQU   CKPOVER                                                  01316000
CKPNTTE  EQU   CKPNFLDS+8                                               01317000
@NM00119 EQU   CKPNFLDS                                                 01318000
@NM00118 EQU   CKPNCNTL+21                                              01319000
CKPBLKPT EQU   CKPNCNTL+20                                              01320000
@NM00117 EQU   CKPNCNTL+18                                              01321000
@NM00116 EQU   CKPNCNTL+14                                              01322000
CKPSWTCH EQU   CKPNCNTL+3                                               01323000
@NM00115 EQU   CKPNCNTL                                                 01324000
CKPCTTRA EQU   CKPINIT+24                                               01325000
@NM00114 EQU   CKPINIT+22                                               01326000
CKPIPERE EQU   CKPINIT+20                                               01327000
CKPDATIM EQU   CKPINIT+12                                               01328000
CKPCTTRC EQU   CKPINIT+8                                                01329000
CKPDATLN EQU   CKPINIT+6                                                01330000
CKPKEYLN EQU   CKPINIT+5                                                01331000
CKPRCDNO EQU   CKPINIT+4                                                01332000
CKPHEDNO EQU   CKPINIT+2                                                01333000
CKPCYLNO EQU   CKPINIT                                                  01334000
NOTIFY   EQU   TABSELCT+2                                               01335000
RESPATH  EQU   CNTTDU                                                   01336000
TYPE     EQU   TABSELCT                                                 01337000
DEVDATA  EQU   DEVRCD+3                                                 01338000
LEADESC  EQU   LEASED+1                                                 01339000
LEANCPLV EQU   LEASED                                                   01340000
MULCURNB EQU   MULTIPNT+3                                               01341000
MULMAX   EQU   MULTIPNT+2                                               01342000
MULDESC  EQU   MULTIPNT+1                                               01343000
MULNCPLV EQU   MULTIPNT                                                 01344000
@NM00171 EQU   ICTNT                                                    01345000
TRMOPT   EQU   IEDTRM+34                                                01346000
TRMOPTBL EQU   IEDQTRM+18                                               01347000
TRMOPNO  EQU   IEDQTRM+17                                               01348000
TRMCHCIN EQU   IEDQTRM+16                                               01349000
TRMSENSE EQU   TRMSTAT+3                                                01350000
TRMTEMPR EQU   TRMSTAT+2                                                01351000
TRMSIO   EQU   TRMSTAT                                                  01352000
@NM00167 EQU   TRMDEVFL+1                                               01353000
TRMTPIN  EQU   TRMDEVFL+1                                               01354000
TRMNCPI  EQU   TRMDEVFL+1                                               01355000
TRMRNTRM EQU   TRMDEVFL+1                                               01356000
@NM00166 EQU   TRMDEVFL+1                                               01357000
TRMLMD   EQU   TRMDEVFL+1                                               01358000
TRMCONC  EQU   TRMDEVFL+1                                               01359000
TRMTSOB  EQU   TRMDEVFL                                                 01360000
TRMBFDY  EQU   TRMDEVFL                                                 01361000
TRMTBLK  EQU   TRMDEVFL                                                 01362000
TRMSBLK  EQU   TRMDEVFL                                                 01363000
TRMBLKS  EQU   TRMDEVFL                                                 01364000
TRMADDC  EQU   TRMDEVFL                                                 01365000
TRMDDIG  EQU   TRMDEVFL                                                 01366000
TRMBUFS  EQU   TRMDEVFL                                                 01367000
TRMPRILK EQU   TRMALTD                                                  01368000
TRMLGB   EQU   TRMDSORG                                                 01369000
TRMUTERM EQU   TLISTCNT                                                 01370000
TRMDESTQ EQU   IEDQTRM+1                                                01371000
TRMSCNYN EQU   TRMSTATE                                                 01372000
TRMOPTFN EQU   TRMSTATE                                                 01373000
TRMHELDN EQU   TRMSTATE                                                 01374000
TRMACPTN EQU   TRMSTATE                                                 01375000
TRMPREF  EQU   TRMSTATE                                                 01376000
TRMPROC  EQU   TRMLOG                                                   01377000
TRMLIST  EQU   TRMLOG                                                   01378000
TRMLINE  EQU   TRMSTATE                                                 01379000
TRMSUBST EQU   IEDNTRM+12                                               01380000
TRMTYPE  EQU   IEDNTRM+11                                               01381000
TRMRLMCT EQU   IEDNTRM+10                                               01382000
TRMCOHTG EQU   TRMSIBPT+1                                               01383000
TRMGPCNT EQU   TRMSIBPT                                                 01384000
TRMBUFRD EQU   TRMBYTE0                                                 01385000
TRMSNA   EQU   TRMBYTE0                                                 01386000
TRMGP    EQU   TRMBYTE0                                                 01387000
TRMDIAL  EQU   TRMBYTE0                                                 01388000
@NM00165 EQU   TRMBYTE0                                                 01389000
TRMOUTPT EQU   TRMBYTE0                                                 01390000
TRMINPUT EQU   TRMBYTE0                                                 01391000
TRMUDEF  EQU   TRMBYTE0                                                 01392000
TRMCOHRT EQU   IEDNTRM+4                                                01393000
TRMSTOTE EQU   TRMBYTE1                                                 01394000
TRMTSATN EQU   TRMBYTE1                                                 01395000
TRMTRACE EQU   TRMBYTE1                                                 01396000
TRMSWBCK EQU   TRMBYTE1                                                 01397000
TRMAUTOC EQU   TRMBYTE1                                                 01398000
TRMINPTP EQU   TRMBYTE1                                                 01399000
TRMWTNEG EQU   TRMSCPRQ                                                 01400000
TRMWRBRK EQU   TRMBYTE2                                                 01401000
TRMNOSND EQU   TRMBYTE2                                                 01402000
TRMPREP  EQU   TRMBYTE2                                                 01403000
TRMGPACT EQU   TRMBYTE2                                                 01404000
TRMANDL  EQU   TRMBYTE2                                                 01405000
TRMCLOSN EQU   TRMINPG                                                  01406000
TRMREMB  EQU   TRMBYTE2                                                 01407000
TRMRSACT EQU   TRMBYTE2                                                 01408000
@NM00164 EQU   IEDPRUND+4                                               01409000
PRUTHEFI EQU   PRUFIDN                                                  01410000
PRUTHUSS EQU   PRUFIDN                                                  01411000
PRUTHEIU EQU   PRUFIDN                                                  01412000
PRUTHBIU EQU   PRUFIDN                                                  01413000
PRUTHTYE EQU   PRUFIDN                                                  01414000
@NM00163 EQU   PRURHFG2                                                 01415000
PRURHCSI EQU   PRURHFG2                                                 01416000
@NM00162 EQU   PRURHFG2                                                 01417000
PRURHCDI EQU   PRURHFG2                                                 01418000
PRURHEB  EQU   PRURHFG2                                                 01419000
PRURHBB  EQU   PRURHFG2                                                 01420000
PRURHPI  EQU   PRURHFG1                                                 01421000
@NM00161 EQU   PRURHFG1                                                 01422000
PRURHER  EQU   PRURHFG1                                                 01423000
PRURHDR2 EQU   PRURHFG1                                                 01424000
@NM00160 EQU   PRURHFG1                                                 01425000
PRURHDR1 EQU   PRURHFG1                                                 01426000
PRURHEC  EQU   PRURHFG0                                                 01427000
PRURHBC  EQU   PRURHFG0                                                 01428000
PRURHSDI EQU   PRURHFG0                                                 01429000
PRURHFI  EQU   PRURHFG0                                                 01430000
@NM00159 EQU   PRURHFG0                                                 01431000
PRURUCAT EQU   PRURHFG0                                                 01432000
PRURHTYP EQU   PRURHFG0                                                 01433000
PRUNUNIT EQU   PRUTIC+1                                                 01434000
@NM00158 EQU   PRUTIC                                                   01435000
@NM00157 EQU   IEDPRUQD+4                                               01436000
@NM00156 EQU   PLMVFLG1                                                 01437000
PLMVTCTG EQU   PLMVFLG1                                                 01438000
PLMVSCTG EQU   PLMVFLG1                                                 01439000
PLMVUNCF EQU   PLMVFLG1                                                 01440000
OPCBOTTM EQU   IEDQOPCD+1172                                            01441000
@NM00155 EQU   IEDQOPCD+1088                                            01442000
@NM00154 EQU   IEDQOPCD+936                                             01443000
@NM00153 EQU   IEDQOPCD+928                                             01444000
@NM00152 EQU   IEDQOPCD+368                                             01445000
OPCWAITV EQU   IEDQOPCD+364                                             01446000
OPCTOTCK EQU   IEDQOPCD+360                                             01447000
OPCAPXTL EQU   IEDQOPCD+356                                             01448000
OPCDECR  EQU   IEDQOPCD+352                                             01449000
OPCBUFWT EQU   IEDQOPCD+348                                             01450000
OPCWRKSP EQU   IEDQOPCD+320                                             01451000
OPCADGOT EQU   IEDQOPCD+318                                             01452000
OPCRQCNT EQU   IEDQOPCD+316                                             01453000
OPPOLSTP EQU   IEDQOPCD+312                                             01454000
OPCCKCIB EQU   IEDQOPCD+308                                             01455000
OPCEND   EQU   IEDQOPCD+307                                             01456000
OPCSTCBS EQU   IEDQOPCD+306                                             01457000
OPCHNEND EQU   IEDQOPCD+302                                             01458000
OPCOQSW  EQU   IEDQOPCD+301                                             01459000
@NM00151 EQU   OPCSPEC                                                  01460000
@NM00150 EQU   OPCSPEC                                                  01461000
@NM00149 EQU   OPCSPEC                                                  01462000
@NM00148 EQU   OPCSPEC                                                  01463000
OPCFRMCA EQU   OPCSPEC                                                  01464000
OPCRSTRT EQU   OPCSPEC                                                  01465000
OPCPART  EQU   OPCSPEC                                                  01466000
OPCALTD  EQU   OPCSPEC                                                  01467000
OPCBFEND EQU   IEDQOPCD+296                                             01468000
OPCBFIRS EQU   IEDQOPCD+292                                             01469000
OPCAVBUF EQU   IEDQOPCD+290                                             01470000
@NM00147 EQU   IEDQOPCD+289                                             01471000
OPCCLNTS EQU   IEDQOPCD+288                                             01472000
OPCHA8   EQU   IEDQOPCD+286                                             01473000
OPCBFREQ EQU   IEDQOPCD+284                                             01474000
OPCFREBF EQU   IEDQOPCD+280                                             01475000
OPCGETBF EQU   IEDQOPCD+276                                             01476000
OPCNEXT  EQU   IEDQOPCD+272                                             01477000
OPCFMDFC EQU   IEDQOPCD+268                                             01478000
OPCSCNC  EQU   IEDQOPCD+264                                             01479000
OPCHORTG EQU   IEDQOPCD+260                                             01480000
OPCHORT  EQU   IEDQOPCD+256                                             01481000
OPCCKPTL EQU   IEDQOPCD+252                                             01482000
OPCWAITA EQU   IEDQOPCD+244                                             01483000
OPCWAITR EQU   IEDQOPCD+240                                             01484000
OPCWAITP EQU   IEDQOPCD+236                                             01485000
OPCWAITO EQU   IEDQOPCD+232                                             01486000
OPCWAITN EQU   IEDQOPCD+228                                             01487000
OPCWAITL EQU   IEDQOPCD+224                                             01488000
OPCWAITC EQU   IEDQOPCD+220                                             01489000
@NM00146 EQU   OPCLDNME+5                                               01490000
OPCMODID EQU   OPCLDNME+3                                               01491000
@NM00145 EQU   OPCLDNME                                                 01492000
OPCXCTL  EQU   IEDQOPCD+204                                             01493000
OPCWAIT  EQU   IEDQOPCD+192                                             01494000
OPCCKERB EQU   IEDQOPCD+164                                             01495000
OPCBFERB EQU   IEDQOPCD+148                                             01496000
OPCFLAG2 EQU   IEDQOPCD+147                                             01497000
OPCFLAG1 EQU   IEDQOPCD+146                                             01498000
OPCWRKSZ EQU   IEDQOPCD+144                                             01499000
OPCWORK  EQU   IEDQOPCD+140                                             01500000
OPCRSAVE EQU   IEDQOPCD+132                                             01501000
OPCQCBAD EQU   IEDQOPCD+128                                             01502000
OPCSAVE  EQU   IEDQOPCD+56                                              01503000
OPCTRMWA EQU   IEDQOPCD+52                                              01504000
OPCPSTWT EQU   IEDQOPCD+48                                              01505000
OPCTNTEA EQU   IEDQOPCD+44                                              01506000
OPCPGCK  EQU   IEDQOPCD+40                                              01507000
OPCLCB   EQU   IEDQOPCD+36                                              01508000
@NM00144 EQU   IEDQOPCD+32                                              01509000
OPCIPLAD EQU   IEDQOPCD+28                                              01510000
OPCTOFLK EQU   IEDQOPCD+24                                              01511000
OPCOPTLK EQU   IEDQOPCD+20                                              01512000
OPCDCBLK EQU   IEDQOPCD+16                                              01513000
OPCCOPCE EQU   IEDQOPCD+12                                              01514000
OPCAVTPT EQU   IEDQOPCD+8                                               01515000
OPCDOUBL EQU   IEDQOPCD                                                 01516000
@NM00143 EQU   OCLDNME+4                                                01517000
@NM00142 EQU   OCPREFLG                                                 01518000
OCTOTEP  EQU   OCPREFLG                                                 01519000
OCREPOST EQU   OCPREFLG                                                 01520000
OCRSPSNT EQU   OCPREFLG                                                 01521000
OCBFREQ  EQU   OCPREFLG                                                 01522000
OCIDLE   EQU   OCREQFLG                                                 01523000
OCFORCE  EQU   OCREQFLG                                                 01524000
OCDCARD  EQU   OCREQFLG                                                 01525000
OCPARTAL EQU   OCREQFLG                                                 01526000
OCADNCP  EQU   OCREQFLG                                                 01527000
@NM00141 EQU   OCREQFLG                                                 01528000
@NM00140 EQU   OCREQFLG                                                 01529000
OCFLUSHZ EQU   OCREQFLG                                                 01530000
OCRESPCT EQU   OCLINTTE                                                 01531000
OCCKPTWA EQU   OCCKDATA+4                                               01532000
@NM00137 EQU   OCRSTGTM+2                                               01533000
OCCKDAT2 EQU   OCRSTGTM+1                                               01534000
OCCKDAT1 EQU   OCRSTGTM                                                 01535000
OCPTRSAV EQU   OCMODNME+4                                               01536000
OCPUADR  EQU   OCIPLWA+2                                                01537000
OCWTGSAV EQU   OCIPLWA                                                  01538000
OCDVRDCT EQU   OCBACKUP+6                                               01539000
OCNCP    EQU   OCBACKUP+4                                               01540000
OCBUFGOT EQU   OCBACKUP+2                                               01541000
OCBUFNED EQU   OCBACKUP                                                 01542000
OCWTG    EQU   IEDQOPCE+30                                              01543000
OCRESNUM EQU   OCPARM                                                   01544000
OCSEQ    EQU   OCTRUNIT+2                                               01545000
@NM00136 EQU   OCRSID+1                                                 01546000
OCNONE   EQU   OCALSTAT                                                 01547000
OCSOME   EQU   OCALSTAT                                                 01548000
OCALLFLG EQU   OCALSTAT                                                 01549000
OCACTREQ EQU   OCALSTAT                                                 01550000
OCREDRVE EQU   OCALSTAT                                                 01551000
OCSEQIND EQU   OCALSTAT                                                 01552000
@NM00135 EQU   OCALSTAT                                                 01553000
OCRENTRD EQU   OCALSTAT                                                 01554000
OCWTGB   EQU   OCTIOT                                                   01555000
@NM00134 EQU   @NM00133+2                                               01556000
OCCONID  EQU   OCDEST                                                   01557000
OCRLN    EQU   IEDQOPCE+15                                              01558000
OCRESP   EQU   OCFLAG                                                   01559000
OCATTACH EQU   OCFLAG                                                   01560000
OCSSCP   EQU   OCFLAG                                                   01561000
OCOUTPUT EQU   OCFLAG                                                   01562000
OCLINE   EQU   OCFLAG                                                   01563000
OCMPP    EQU   OCFLAG                                                   01564000
OCTOTE   EQU   OCFLAG                                                   01565000
OCCONSOL EQU   OCFLAG                                                   01566000
@NM00132 EQU   OCSWITCH                                                 01567000
OCQUCKN  EQU   OCSWITCH                                                 01568000
OCPRIFLG EQU   OCOPTCDE                                                 01569000
@NM00131 EQU   OCRUDEST+1                                               01570000
@NM00130 EQU   OCSCAN                                                   01571000
OCNOTUCB EQU   OCSCAN                                                   01572000
OCNONAME EQU   OCSCAN                                                   01573000
OCALLRLN EQU   OCSCAN                                                   01574000
OCDDNAME EQU   OCSCAN                                                   01575000
OCDDNRLN EQU   OCSCAN                                                   01576000
OCADDR   EQU   OCSCAN                                                   01577000
OCELMPTR EQU   OCELEM+1                                                 01578000
OCELMPRI EQU   OCELEM                                                   01579000
OCLINK   EQU   IEDQOPCE                                                 01580000
NCPLTRAC EQU   IEDNCP+26                                                01581000
NCPCKPT  EQU   IEDNCP+22                                                01582000
NCPDPDCB EQU   IEDNCP+18                                                01583000
@NM00129 EQU   NCPFLAG1                                                 01584000
NCPBKUP  EQU   NCPFLAG1                                                 01585000
NCPIPLD  EQU   NCPFLAG1                                                 01586000
NCPBGUP  EQU   NCPFLAG1                                                 01587000
NCPDAUTO EQU   NCPFLAG1                                                 01588000
NCPIAUTO EQU   NCPFLAG1                                                 01589000
NCPLEN   EQU   IEDNCP                                                   01590000
CNRMSSEL EQU   IEDQCNRD+18                                              01591000
CNRCTLIM EQU   IEDQCNRD+17                                              01592000
CNRCSLIM EQU   IEDQCNRD+16                                              01593000
CNRNEGPL EQU   IEDQCNRD+15                                              01594000
CNRSSPAU EQU   IEDQCNRD+14                                              01595000
CNRBHPOS EQU   CNRBHSET+1                                               01596000
@NM00128 EQU   CNRBHFUN                                                 01597000
CNRBHFN0 EQU   CNRBHFUN                                                 01598000
@NM00127 EQU   CNRCNTL+1                                                01599000
CNRFRDR  EQU   CNRCNTL                                                  01600000
CNRFMSS  EQU   CNRCNTL                                                  01601000
CNRFCTL  EQU   CNRCNTL                                                  01602000
CNRFCSL  EQU   CNRCNTL                                                  01603000
CNRFNPL  EQU   CNRCNTL                                                  01604000
CNRFSSP  EQU   CNRCNTL                                                  01605000
CNRFBHSC EQU   CNRCNTL                                                  01606000
CNRFBHS  EQU   CNRCNTL                                                  01607000
CNRTIME  EQU   CNRDATTM+4                                               01608000
CNRDATE  EQU   CNRDATTM                                                 01609000
CNRTNTOF EQU   IEDQCNRD                                                 01610000
CKPIOTR  EQU   CKPAVT+21                                                01611000
CKPSUBT  EQU   CKPAVT+20                                                01612000
CKPLODPT EQU   CKPAVT+16                                                01613000
CKPRADDR EQU   CKPAVT+12                                                01614000
CKPNADDR EQU   CKPAVT+8                                                 01615000
CKPBIT2  EQU   CKPAVT+7                                                 01616000
CKPBIT1  EQU   CKPAVT+6                                                 01617000
CKPINTLV EQU   CKPAVT+4                                                 01618000
CKPOPCIN EQU   CKPAVT+2                                                 01619000
CKPOPCON EQU   CKPAVT                                                   01620000
CKPTYPE  EQU   CKPNRES+5                                                01621000
@NM00126 EQU   CKPNFLG                                                  01622000
CKPLULOG EQU   CKPNFLG                                                  01623000
CKPEPMOD EQU   CKPNFLG                                                  01624000
CKPRSACT EQU   CKPNFLG                                                  01625000
CKPREMB  EQU   CKPNFLG                                                  01626000
CKPCOHRT EQU   CKPNRES+2                                                01627000
CKPSUBST EQU   CKPNRES                                                  01628000
CKPCTSEC EQU   CKPREQTB+6                                               01629000
CKPCTOFF EQU   CKPREQTB+4                                               01630000
CKPCTTTR EQU   CKPREQTB+1                                               01631000
CKPCTDER EQU   CKPCTFLG                                                 01632000
CKPCTACT EQU   CKPCTFLG                                                 01633000
CREDEB   EQU   CREOFFS                                                  01634000
CREECB   EQU   IEDQCRED+8                                               01635000
@NM00125 EQU   CRELINK+1                                                01636000
CREPRI   EQU   CRELINK                                                  01637000
CREQCBAD EQU   IEDQCRED+1                                               01638000
CREKEY   EQU   IEDQCRED                                                 01639000
CDRKEY   EQU   IEDQCDRD+8                                               01640000
CDRTIME  EQU   IEDQCDRD+4                                               01641000
CDRDATE  EQU   IEDQCDRD                                                 01642000
CKPSECT1 EQU   CKPCNTLR+37                                              01643000
CKPTTRT1 EQU   CKPCNTLR+34                                              01644000
CKPSECIN EQU   CKPCNTLR+32                                              01645000
CKPSECCR EQU   CKPCNTLR+30                                              01646000
CKPSECLI EQU   CKPCNTLR+28                                              01647000
CKPSECLT EQU   CKPCNTLR+26                                              01648000
CKPINCLN EQU   CKPCNTLR+24                                              01649000
CKPTTRLI EQU   CKPCNTLR+21                                              01650000
CKPRPERT EQU   CKPCNTLR+20                                              01651000
CKPCKRLN EQU   CKPCNTLR+18                                              01652000
CKPCPERT EQU   CKPPRQNO                                                 01653000
CKPIPERT EQU   CKPCNTLR+16                                              01654000
CKPCPRCD EQU   CKPCNTLR+15                                              01655000
CKPCKRQS EQU   CKPCNTLR+14                                              01656000
CKPBPERR EQU   CKPCNTLR+12                                              01657000
CKPTTRIN EQU   CKPCNTLR+9                                               01658000
CKPINRNO EQU   CKPCNTLR+8                                               01659000
CKPTTRCR EQU   CKPCNTLR+5                                               01660000
CKPCRRNO EQU   CKPCNTLR+4                                               01661000
CKPINCNO EQU   CKPCNTLR+3                                               01662000
CKPINCNT EQU   CKPCNTLR+2                                               01663000
CKPTTRCT EQU   CKPCNTLR+1                                               01664000
CKPOPCRD EQU   CKPFLAGS                                                 01665000
CKPOPTFN EQU   CKPFLAGS                                                 01666000
CKPSTAIN EQU   CKPFLAGS                                                 01667000
CKPERR   EQU   CKPFLAGS                                                 01668000
@NM00113 EQU   CKPFLAGS                                                 01669000
CKPFSCN2 EQU   CKPFLAGS                                                 01670000
CKPFSCN1 EQU   CKPFLAGS                                                 01671000
CKPNORML EQU   CKPFLAGS                                                 01672000
@NM00112 EQU   CKPMSG+65                                                01673000
CKPMSGGL EQU   CKPMSG+61                                                01674000
@NM00111 EQU   CKPMSG+2                                                 01675000
CKPMSGLN EQU   CKPMSG                                                   01676000
CKPWKALN EQU   @NM00110+10                                              01677000
@NM00109 EQU   CKPRW+5                                                  01678000
CKPRWFLG EQU   CKPRW+4                                                  01679000
CKPSCHID EQU   CKPCCWS+16                                               01680000
CKPSETSC EQU   CKPCCWS+8                                                01681000
CKPSEEKC EQU   CKPCCWS                                                  01682000
@NM00108 EQU   IEDQCKPD+164                                             01683000
CKPERRCT EQU   IEDQCKPD+163                                             01684000
CKPSWCH2 EQU   IEDQCKPD+162                                             01685000
CKPSWCH1 EQU   IEDQCKPD+161                                             01686000
CKPPARM2 EQU   IEDQCKPD+156                                             01687000
CKPCPARM EQU   IEDQCKPD+148                                             01688000
CKPSECTR EQU   CKPCTTRB                                                 01689000
CKPLDRB  EQU   IEDQCKPD+140                                             01690000
CKPLREB  EQU   IEDQCKPD+136                                             01691000
CKPNDRB  EQU   @NM00107                                                 01692000
CKPIOQF  EQU   IEDQCKPD+128                                             01693000
CKPEPLOC EQU   CKPCNVRT                                                 01694000
CKPECB   EQU   IEDQCKPD+112                                             01695000
CKPIOR   EQU   CKPIOSK+7                                                01696000
CKPIOHH  EQU   CKPIOSK+5                                                01697000
CKPIOCC  EQU   CKPIOSK+3                                                01698000
CKPIOBB  EQU   CKPIOSK+1                                                01699000
CKPIOM   EQU   CKPIOSK                                                  01700000
CKPIORC  EQU   CKPIOB+30                                                01701000
CKPIOBCI EQU   CKPIOB+28                                                01702000
CKPIORST EQU   CKPIOB+25                                                01703000
@NM00106 EQU   CKPIOB+24                                                01704000
CKPIODCB EQU   CKPIOB+21                                                01705000
@NM00105 EQU   CKPIOB+20                                                01706000
CKPIOCPA EQU   CKPIOB+17                                                01707000
CKPIOSIO EQU   CKPIOB+16                                                01708000
CKPIOCSW EQU   CKPIOB+9                                                 01709000
CKPIOFL3 EQU   CKPIOB+8                                                 01710000
@NM00104 EQU   CKPIOECB+1                                               01711000
CKPIOECC EQU   CKPIOECB                                                 01712000
CKPIOSN1 EQU   CKPIOB+3                                                 01713000
CKPIOSN0 EQU   CKPIOB+2                                                 01714000
CKPIOFL2 EQU   CKPIOB+1                                                 01715000
CKPIOFL1 EQU   CKPIOB                                                   01716000
CAVTNIOE EQU   CAVTWL2+5                                                01717000
CAVTEOL3 EQU   CAVTWL2+4                                                01718000
CAVTNQE  EQU   CAVTWL2+1                                                01719000
CAVTEOL2 EQU   CAVTWL2                                                  01720000
CAVTTIOE EQU   CAVTWL1+5                                                01721000
CAVTEOL1 EQU   CAVTWL1+4                                                01722000
CAVTTQE  EQU   CAVTWL1                                                  01723000
@NM00103 EQU   IEDQCKAD+10                                              01724000
CAVTFLGS EQU   IEDQCKAD+9                                               01725000
BDUXGRPH EQU   BDUEXRSP                                                 01726000
BDUXFINL EQU   BDUEXRSP                                                 01727000
BDUXINIT EQU   BDUEXRSP                                                 01728000
BDURESP  EQU   BDUSYRSP                                                 01729000
BDUPHASE EQU   BDUSYRSP                                                 01730000
BDUERROR EQU   BDUSYRSP                                                 01731000
BDUXERLK EQU   BDUBDUFG                                                 01732000
BDUALTAK EQU   BDUFNFLG                                                 01733000
BDUNEGAK EQU   BDUFNFLG                                                 01734000
BDUPOSAK EQU   BDUFNFLG                                                 01735000
BDUTPTX  EQU   BDUFNFLG                                                 01736000
BDUFRSTB EQU   BDUFNFLG                                                 01737000
BDULEADG EQU   BDUFNFLG                                                 01738000
BDUHEADR EQU   BDUFNFLG                                                 01739000
BDUSTHDR EQU   BDUFNFLG                                                 01740000
BDUMODIF EQU   IEDBDU+1                                                 01741000
BDUCMND  EQU   IEDBDU                                                   01742000
SAVTBITN EQU   IEDNSVTD+312                                             01743000
@NM00102 EQU   SAVTCKQB+8                                               01744000
@NM00101 EQU   SAVTCKEC+1                                               01745000
@NM00100 EQU   SAVTCKCC                                                 01746000
SAVTCKPO EQU   SAVTCKCC                                                 01747000
SAVTCKWA EQU   SAVTCKCC                                                 01748000
SAVTCKCH EQU   SAVTCKTB+1                                               01749000
SAVTCKVT EQU   SAVTCKTB                                                 01750000
@NM00099 EQU   IEDNSVTD+297                                             01751000
SAVTRDFG EQU   SAVTRDRV+12                                              01752000
@NM00098 EQU   SAVTRDRV+5                                               01753000
SAVTRDPY EQU   SAVTRDRV+4                                               01754000
SAVTRDQB EQU   SAVTRDRV+1                                               01755000
SAVTRDKY EQU   SAVTRDRV                                                 01756000
SAVTNID  EQU   IEDNSVTD+280                                             01757000
SAVTDVAS EQU   IEDNSVTD+276                                             01758000
SAVTPLSZ EQU   IEDNSVTD+274                                             01759000
@NM00097 EQU   IEDNSVTD+273                                             01760000
SAVTSUBL EQU   IEDNSVTD+272                                             01761000
@NM00096 EQU   SAVTZELM+1                                               01762000
SAVTSUBM EQU   SAVTZELM                                                 01763000
SAVTMHDX EQU   IEDNSVTD+268                                             01764000
SAVTNAT1 EQU   IEDNSVTD+266                                             01765000
SAVTSH20 EQU   IEDNSVTD+264                                             01766000
SAVTLCBS EQU   IEDNSVTD+260                                             01767000
SAVTRNMP EQU   IEDNSVTD+256                                             01768000
SAVTTNTX EQU   IEDNSVTD+252                                             01769000
SAVTNAX  EQU   IEDNSVTD+248                                             01770000
SAVTSUBV EQU   IEDNSVTD+247                                             01771000
SAVTSUBA EQU   IEDNSVTD+246                                             01772000
SAVTSIBC EQU   IEDNSVTD+244                                             01773000
SAVTBSM  EQU   IEDNSVTD+240                                             01774000
SAVTSCPT EQU   SAVTTCPU                                                 01775000
SAVTRQTG EQU   IEDNSVTD+236                                             01776000
SAVTRQCH EQU   IEDNSVTD+232                                             01777000
SAVTMAND EQU   IEDNSVTD+228                                             01778000
SAVTSPLN EQU   IEDNSVTD+224                                             01779000
SAVTNADL EQU   IEDNSVTD+222                                             01780000
SAVTNATL EQU   IEDNSVTD+220                                             01781000
SAVTMHTB EQU   IEDNSVTD+216                                             01782000
SAVTSSMH EQU   IEDNSVTD+212                                             01783000
SAVTQRS  EQU   IEDNSVTD+208                                             01784000
SAVTRQIN EQU   IEDNSVTD+204                                             01785000
SAVTDFCO EQU   IEDNSVTD+200                                             01786000
SAVTSAO  EQU   IEDNSVTD+196                                             01787000
SAVTSARI EQU   IEDNSVTD+192                                             01788000
SAVTSAC  EQU   IEDNSVTD+188                                             01789000
SAVTSAI  EQU   IEDNSVTD+184                                             01790000
SAVTCSCI EQU   IEDNSVTD+180                                             01791000
SAVTSSRP EQU   IEDNSVTD+176                                             01792000
SAVTSSRQ EQU   IEDNSVTD+172                                             01793000
SAVTSCLU EQU   IEDNSVTD+168                                             01794000
SAVTXTRQ EQU   IEDNSVTD+164                                             01795000
@NM00095 EQU   IEDNSVTD+148                                             01796000
SAVTIPCQ EQU   IEDNSVTD+144                                             01797000
@NM00094 EQU   IEDNSVTD+136                                             01798000
SAVTXFMI EQU   IEDNSVTD+132                                             01799000
@NM00093 EQU   IEDNSVTD+124                                             01800000
SAVTXFMO EQU   IEDNSVTD+120                                             01801000
@NM00092 EQU   IEDNSVTD+116                                             01802000
SAVTSSSR EQU   IEDNSVTD+112                                             01803000
SAVTSCPQ EQU   IEDNSVTD+108                                             01804000
SAVTSLCB EQU   IEDNSVTD+104                                             01805000
SAVTLUSR EQU   IEDNSVTD+100                                             01806000
@NM00091 EQU   SAVTLUSQ+8                                               01807000
SAVTLUSP EQU   SAVTLUSQ+4                                               01808000
SAVTLUSB EQU   SAVTLUSQ                                                 01809000
@NM00090 EQU   IEDNSVTD+84                                              01810000
SAVTSAT  EQU   IEDNSVTD+80                                              01811000
SAVTNAT  EQU   IEDNSVTD+76                                              01812000
SAVTCLUP EQU   IEDNSVTD+72                                              01813000
SAVTPIUT EQU   IEDNSVTD+68                                              01814000
SAVTRNTA EQU   IEDNSVTD+64                                              01815000
SAVTDNIR EQU   IEDNSVTD+60                                              01816000
SAVTCNIR EQU   IEDNSVTD+56                                              01817000
SAVTFLDH EQU   IEDNSVTD+52                                              01818000
SAVTSRTN EQU   IEDNSVTD+48                                              01819000
SAVTSREQ EQU   IEDNSVTD+44                                              01820000
SAVTFAIL EQU   IEDNSVTD+42                                              01821000
SAVTSUSE EQU   IEDNSVTD+40                                              01822000
SAVTSIB  EQU   IEDNSVTD+36                                              01823000
SAVTPRTN EQU   IEDNSVTD+32                                              01824000
@NM00089 EQU   IEDNSVTD+28                                              01825000
SAVTWH20 EQU   IEDNSVTD+26                                              01826000
SAVTPWT  EQU   IEDNSVTD+24                                              01827000
SAVTPRTQ EQU   IEDNSVTD+20                                              01828000
SAVTPREQ EQU   IEDNSVTD+16                                              01829000
SAVTPH20 EQU   IEDNSVTD+14                                              01830000
SAVTPUSE EQU   IEDNSVTD+12                                              01831000
SAVTPLCB EQU   IEDNSVTD+8                                               01832000
SAVTPOOL EQU   IEDNSVTD+4                                               01833000
SAVTPRMT EQU   SAVTDIAF                                                 01834000
SAVTVIRT EQU   SAVTDIAF                                                 01835000
AVTCPBNO EQU   IEDQAVTD+1244                                            01836000
AVTHRESS EQU   IEDQAVTD+1243                                            01837000
@NM00088 EQU   IEDQAVTD+1242                                            01838000
@NM00087 EQU   IEDQAVTD+1241                                            01839000
@NM00086 EQU   IEDQAVTD+1240                                            01840000
@NM00085 EQU   IEDQAVTD+1237                                            01841000
@NM00084 EQU   IEDQAVTD+1236                                            01842000
AVTHRESE EQU   @NM00083                                                 01843000
AVTRADDR EQU   IEDQAVTD+1228                                            01844000
AVTNADDR EQU   IEDQAVTD+1224                                            01845000
AVTHRESN EQU   IEDQAVTD+1220                                            01846000
AVTVOLRN EQU   IEDQAVTD+1216                                            01847000
AVTTOTNN EQU   IEDQAVTD+1212                                            01848000
AVTTRCYN EQU   IEDQAVTD+1208                                            01849000
AVTRCTRN EQU   IEDQAVTD+1204                                            01850000
AVTNOVON EQU   IEDQAVTD+1200                                            01851000
AVTADEBN EQU   IEDQAVTD+1196                                            01852000
AVTVOLRR EQU   IEDQAVTD+1192                                            01853000
AVTTOTNR EQU   IEDQAVTD+1188                                            01854000
AVTTRCYR EQU   IEDQAVTD+1184                                            01855000
AVTRCTRR EQU   IEDQAVTD+1180                                            01856000
AVTNOVOR EQU   IEDQAVTD+1176                                            01857000
AVTADEBR EQU   IEDQAVTD+1172                                            01858000
AVTLODPT EQU   IEDQAVTD+1168                                            01859000
AVTIOBN  EQU   IEDQAVTD+1164                                            01860000
AVTIOBR  EQU   IEDQAVTD+1160                                            01861000
AVTCPBPT EQU   IEDQAVTD+1156                                            01862000
AVTFCPB  EQU   IEDQAVTD+1152                                            01863000
@NM00082 EQU   IEDQAVTD+1148                                            01864000
AVTINCPQ EQU   IEDQAVTD+1144                                            01865000
@NM00081 EQU   IEDQAVTD+1140                                            01866000
@NM00080 EQU   IEDQAVTD+1137                                            01867000
@NM00079 EQU   AVTBIT4                                                  01868000
@NM00078 EQU   AVTBIT4                                                  01869000
@NM00077 EQU   AVTBIT4                                                  01870000
@NM00076 EQU   AVTBIT4                                                  01871000
@NM00075 EQU   AVTBIT4                                                  01872000
@NM00074 EQU   AVTBIT4                                                  01873000
@NM00073 EQU   AVTBIT4                                                  01874000
AVTRUFTN EQU   AVTBIT4                                                  01875000
@NM00072 EQU   IEDQAVTD+1132                                            01876000
AVTNOBFQ EQU   IEDQAVTD+1128                                            01877000
@NM00071 EQU   IEDQAVTD+1124                                            01878000
AVTDKENQ EQU   IEDQAVTD+1120                                            01879000
@NM00070 EQU   IEDQAVTD+1116                                            01880000
AVTDKAPQ EQU   IEDQAVTD+1112                                            01881000
AVTCOPY  EQU   IEDQAVTD+1108                                            01882000
AVTIA    EQU   IEDQAVTD+1104                                            01883000
AVTFL    EQU   IEDQAVTD+1100                                            01884000
@NM00069 EQU   IEDQAVTD+1096                                            01885000
AVTNCPBQ EQU   IEDQAVTD+1092                                            01886000
AVTTOTNC EQU   IEDQAVTD+1088                                            01887000
AVTCMAX  EQU   IEDQAVTD+1084                                            01888000
AVTCMIN  EQU   IEDQAVTD+1080                                            01889000
AVTHM02  EQU   IEDQAVTD+1076                                            01890000
AVTOPCIN EQU   IEDQAVTD+1074                                            01891000
AVTDCTLN EQU   IEDQAVTD+1072                                            01892000
AVTOPMSK EQU   IEDQAVTD+1068                                            01893000
AVTDDFT  EQU   IEDQAVTD+1064                                            01894000
AVTSTEAL EQU   IEDQAVTD+1060                                            01895000
AVTOPTN  EQU   IEDQAVTD+1056                                            01896000
AVTDSKCT EQU   IEDQAVTD+1054                                            01897000
AVTCKRST EQU   IEDQAVTD+1053                                            01898000
AVTSTAN  EQU   AVTBIT3                                                  01899000
AVTSTACN EQU   AVTBIT3                                                  01900000
AVTSTAIN EQU   AVTBIT3                                                  01901000
AVTSTAYN EQU   AVTBIT3                                                  01902000
AVTOLTBN EQU   AVTBIT3                                                  01903000
AVTTSAB  EQU   AVTBIT3                                                  01904000
AVTRFULN EQU   AVTBIT3                                                  01905000
AVTRECVN EQU   AVTBIT3                                                  01906000
@NM00068 EQU   AVTBIT2                                                  01907000
@NM00067 EQU   AVTBIT2                                                  01908000
AVTOPEIN EQU   AVTBIT2                                                  01909000
AVTSTRTN EQU   AVTBIT2                                                  01910000
AVTTOPOL EQU   AVTBIT2                                                  01911000
AVTCOPYN EQU   AVTBIT2                                                  01912000
AVTREUSN EQU   AVTBIT2                                                  01913000
AVTEXTSC EQU   AVTBIT2                                                  01914000
AVTDISKN EQU   AVTBIT1                                                  01915000
AVTQUCKN EQU   AVTBIT1                                                  01916000
AVTCLOSN EQU   AVTBIT1                                                  01917000
AVTREADN EQU   AVTBIT1                                                  01918000
AVTDLAYN EQU   AVTBIT1                                                  01919000
AVTAQTAN EQU   AVTBIT1                                                  01920000
AVTTSON  EQU   AVTBIT1                                                  01921000
AVTAPLKN EQU   AVTBIT1                                                  01922000
AVTDUMBR EQU   IEDQAVTD+1048                                            01923000
AVTDLQX  EQU   IEDQAVTD+1046                                            01924000
AVTINTLV EQU   IEDQAVTD+1044                                            01925000
AVTSMCNT EQU   IEDQAVTD+1042                                            01926000
AVTAVFCT EQU   IEDQAVTD+1040                                            01927000
AVTOPCON EQU   IEDQAVTD+1038                                            01928000
AVTOPCNT EQU   IEDQAVTD+1036                                            01929000
AVTLNCNT EQU   IEDQAVTD+1034                                            01930000
AVTHA16  EQU   IEDQAVTD+1030                                            01931000
AVTHA7   EQU   IEDQAVTD+1028                                            01932000
AVTHA4   EQU   IEDQAVTD+1026                                            01933000
AVTHA3   EQU   IEDQAVTD+1024                                            01934000
AVTHA2   EQU   IEDQAVTD+1022                                            01935000
AVTGETMS EQU   IEDQAVTD+1021                                            01936000
@NM00066 EQU   IEDQAVTD+1020                                            01937000
AVTGETMD EQU   IEDQAVTD+1016                                            01938000
AVTGETMN EQU   IEDQAVTD+1012                                            01939000
AVTCWTOT EQU   IEDQAVTD+1008                                            01940000
AVTCWINT EQU   IEDQAVTD+956                                             01941000
AVTDTRAP EQU   IEDQAVTD+952                                             01942000
@NM00065 EQU   IEDQAVTD+950                                             01943000
@NM00064 EQU   AVTIOTR                                                  01944000
AVTIOTRH EQU   AVTIOTR                                                  01945000
AVTIOTRE EQU   AVTIOTR                                                  01946000
@NM00063 EQU   AVTSUBT                                                  01947000
AVTSUBPT EQU   AVTSUBT                                                  01948000
AVTSUBON EQU   AVTSUBT                                                  01949000
AVTAFE30 EQU   IEDQAVTD+944                                             01950000
AVTAFE20 EQU   IEDQAVTD+940                                             01951000
AVTAFE10 EQU   IEDQAVTD+936                                             01952000
AVTCWEC2 EQU   IEDQAVTD+932                                             01953000
AVTCWPM2 EQU   IEDQAVTD+928                                             01954000
AVTCWTS2 EQU   IEDQAVTD+927                                             01955000
AVTCWTS1 EQU   IEDQAVTD+926                                             01956000
AVTCWCLD EQU   AVTCWFL2                                                 01957000
AVTCWRAP EQU   AVTCWFL2                                                 01958000
@NM00062 EQU   AVTCWFL2                                                 01959000
@NM00061 EQU   AVTCWFL2                                                 01960000
@NM00060 EQU   AVTCWFL2                                                 01961000
@NM00059 EQU   AVTCWFL2                                                 01962000
@NM00058 EQU   AVTCWFL2                                                 01963000
AVTCWACT EQU   AVTCWFL2                                                 01964000
@NM00057 EQU   AVTCWFL1                                                 01965000
@NM00056 EQU   AVTCWFL1                                                 01966000
@NM00055 EQU   AVTCWFL1                                                 01967000
@NM00054 EQU   AVTCWFL1                                                 01968000
@NM00053 EQU   AVTCWFL1                                                 01969000
@NM00052 EQU   AVTCWFL1                                                 01970000
@NM00051 EQU   AVTCWFL1                                                 01971000
AVTCOMWN EQU   AVTCWFL1                                                 01972000
AVTCWEC1 EQU   IEDQAVTD+920                                             01973000
AVTCWPM1 EQU   IEDQAVTD+916                                             01974000
AVTCAREA EQU   IEDQAVTD+912                                             01975000
AVTFZERO EQU   IEDQAVTD+908                                             01976000
AVTCADDR EQU   IEDQAVTD+904                                             01977000
AVTCOREC EQU   IEDQAVTD+900                                             01978000
@NM00050 EQU   IEDQAVTD+892                                             01979000
AVTCPBCB EQU   IEDQAVTD+888                                             01980000
@NM00049 EQU   IEDQAVTD+880                                             01981000
AVTDSIOB EQU   IEDQAVTD+876                                             01982000
@NM00048 EQU   IEDQAVTD+868                                             01983000
AVTCPRMB EQU   IEDQAVTD+864                                             01984000
@NM00047 EQU   IEDQAVTD+856                                             01985000
AVTCLOSB EQU   IEDQAVTD+852                                             01986000
@NM00046 EQU   IEDQAVTD+844                                             01987000
AVTACTIB EQU   IEDQAVTD+840                                             01988000
@NM00045 EQU   IEDQAVTD+836                                             01989000
AVTOLTEB EQU   IEDQAVTD+832                                             01990000
AVTOLTCH EQU   AVTOLTQB+1                                               01991000
AVTOLTVT EQU   AVTOLTQB                                                 01992000
@NM00044 EQU   AVTOPCQB+8                                               01993000
@NM00043 EQU   AVTOPCEC+1                                               01994000
@NM00042 EQU   AVTOPCCC                                                 01995000
AVTOPCPO EQU   AVTOPCCC                                                 01996000
AVTOPCWA EQU   AVTOPCCC                                                 01997000
AVTOPCCH EQU   AVTOPCOB+1                                               01998000
AVTOPCVT EQU   AVTOPCOB                                                 01999000
@NM00041 EQU   AVTCKPQB+9                                               02000000
AVTCKPTS EQU   AVTCKPQB+8                                               02001000
@NM00040 EQU   AVTCKPEC+1                                               02002000
@NM00039 EQU   AVTCKPCC                                                 02003000
AVTCKPPO EQU   AVTCKPCC                                                 02004000
AVTCKPWA EQU   AVTCKPCC                                                 02005000
AVTCKPCH EQU   AVTCKPTB+1                                               02006000
AVTCKPVT EQU   AVTCKPTB                                                 02007000
@NM00038 EQU   IEDQAVTD+796                                             02008000
AVTBFRTB EQU   IEDQAVTD+792                                             02009000
@NM00037 EQU   IEDQAVTD+784                                             02010000
AVTBFREB EQU   IEDQAVTD+780                                             02011000
AVTTIMQ  EQU   IEDQAVTD+776                                             02012000
@NM00036 EQU   IEDQAVTD+772                                             02013000
AVTIMQPS EQU   IEDQAVTD+768                                             02014000
AVTINOUT EQU   IEDQAVTD+766                                             02015000
AVTREFTM EQU   IEDQAVTD+764                                             02016000
@NM00035 EQU   IEDQAVTD+752                                             02017000
AVTDELYB EQU   IEDQAVTD+748                                             02018000
AVTOCQPT EQU   IEDQAVTD+744                                             02019000
AVTTSOPT EQU   IEDQAVTD+740                                             02020000
AVTSUPPT EQU   IEDQAVTD+736                                             02021000
AVTCBQCB EQU   IEDQAVTD+732                                             02022000
AVTMSGS  EQU   IEDQAVTD+729                                             02023000
@NM00034 EQU   AVTSYSER                                                 02024000
@NM00033 EQU   AVTSYSER                                                 02025000
@NM00032 EQU   AVTSYSER                                                 02026000
@NM00031 EQU   AVTSYSER                                                 02027000
@NM00030 EQU   AVTSYSER                                                 02028000
@NM00029 EQU   AVTSYSER                                                 02029000
AVTCMAXN EQU   AVTSYSER                                                 02030000
AVTCMINN EQU   AVTSYSER                                                 02031000
AVT2260L EQU   IEDQAVTD+724                                             02032000
AVTABEPL EQU   AVTADBUF                                                 02033000
AVTHFF   EQU   AVTCLRHI+2                                               02034000
@NM00028 EQU   AVTCLRHI                                                 02035000
AVTCCLNK EQU   AVTCRELE+5                                               02036000
AVTCCPRI EQU   AVTCRELE+4                                               02037000
AVTCCQCB EQU   AVTCCELE+1                                               02038000
AVTCCKEY EQU   AVTCCELE                                                 02039000
AVTDELAD EQU   IEDQAVTD+704                                             02040000
AVTDELEM EQU   IEDQAVTD+700                                             02041000
AVTBSX   EQU   AVTCKLNK                                                 02042000
AVTOPETR EQU   AVTHG01                                                  02043000
@NM00027 EQU   AVTCKBYT                                                 02044000
AVTCKONQ EQU   AVTCKBYT                                                 02045000
@NM00026 EQU   AVTCKBYT                                                 02046000
@NM00025 EQU   AVTCKBYT                                                 02047000
@NM00024 EQU   AVTCKBYT                                                 02048000
@NM00023 EQU   AVTCKBYT                                                 02049000
@NM00022 EQU   AVTCKBYT                                                 02050000
@NM00021 EQU   AVTCKBYT                                                 02051000
AVTOPERT EQU   IEDQAVTD+690                                             02052000
AVTOPXCL EQU   IEDQAVTD+688                                             02053000
AVTOPERL EQU   IEDQAVTD+687                                             02054000
@NM00020 EQU   IEDQAVTD+686                                             02055000
AVTCKTIM EQU   IEDQAVTD+684                                             02056000
AVTCKELV EQU   IEDQAVTD+682                                             02057000
AVTCPRCD EQU   IEDQAVTD+681                                             02058000
AVTWARMN EQU   AVTCKELF                                                 02059000
AVTCRTLN EQU   AVTCKELF                                                 02060000
AVTCPIPN EQU   AVTCKELF                                                 02061000
AVTCCLCN EQU   AVTCKELF                                                 02062000
AVTCINCN EQU   AVTCKELF                                                 02063000
@NM00019 EQU   AVTCKELF                                                 02064000
AVTCMCPN EQU   AVTCKELF                                                 02065000
AVTCRDYN EQU   AVTCKELF                                                 02066000
AVTCKQAD EQU   IEDQAVTD+677                                             02067000
AVTSCBSZ EQU   IEDQAVTD+676                                             02068000
@NM00018 EQU   IEDQAVTD+672                                             02069000
AVTCKELE EQU   IEDQAVTD+668                                             02070000
@NM00017 EQU   AVTCKPEL+8                                               02071000
AVTCKRLK EQU   AVTCKPEL+5                                               02072000
AVTCKRPR EQU   AVTCKPEL+4                                               02073000
AVTCKRMQ EQU   AVTCKRMV+1                                               02074000
AVTCKRKY EQU   AVTCKRMV                                                 02075000
AVTHK    EQU   IEDQAVTD+648                                             02076000
AVTHI    EQU   IEDQAVTD+644                                             02077000
AVTIOT   EQU   IEDQAVTD+640                                             02078000
AVTNX    EQU   IEDQAVTD+636                                             02079000
AVTTONE  EQU   IEDQAVTD+632                                             02080000
AVTA3TL  EQU   IEDQAVTD+628                                             02081000
AVTDMECB EQU   IEDQAVTD+624                                             02082000
AVTABEND EQU   IEDQAVTD+618                                             02083000
AVTPLCBN EQU   IEDQAVTD+616                                             02084000
@NM00016 EQU   AVTSAVTP+1                                               02085000
@NM00015 EQU   AVTSAVTF                                                 02086000
AVTSNA   EQU   AVTSAVTF                                                 02087000
AVTONSNA EQU   AVTSAVTF                                                 02088000
AVTVTMCP EQU   AVTSAVTF                                                 02089000
@NM00014 EQU   IEDQAVTD+608                                             02090000
AVTCMBSS EQU   IEDQAVTD+604                                             02091000
AVTRCV   EQU   IEDQAVTD+600                                             02092000
AVTSEND  EQU   IEDQAVTD+596                                             02093000
AVTCSCH  EQU   IEDQAVTD+592                                             02094000
AVTQ1    EQU   IEDQAVTD+588                                             02095000
AVTE7    EQU   IEDQAVTD+584                                             02096000
AVTHB    EQU   IEDQAVTD+580                                             02097000
AVTR1    EQU   IEDQAVTD+576                                             02098000
AVTBZ    EQU   IEDQAVTD+572                                             02099000
AVTEZ    EQU   IEDQAVTD+568                                             02100000
AVTEC    EQU   IEDQAVTD+564                                             02101000
AVTEW    EQU   IEDQAVTD+560                                             02102000
AVTNDIAL EQU   AVTSCOPT                                                 02103000
AVTN2741 EQU   AVTSCOPT                                                 02104000
AVTCONCO EQU   AVTSCOPT                                                 02105000
AVTCONC  EQU   AVTSCOPT                                                 02106000
AVTCMBUF EQU   AVTSCOPT                                                 02107000
AVTAPDMP EQU   AVTSCOPT                                                 02108000
@NM00013 EQU   AVTSCOPT                                                 02109000
AVTHA    EQU   AVTDISP                                                  02110000
AVTEA    EQU   IEDQAVTD+548                                             02111000
AVTAX    EQU   IEDQAVTD+544                                             02112000
AVTA3    EQU   IEDQAVTD+540                                             02113000
AVTGD    EQU   IEDQAVTD+536                                             02114000
AVTAL    EQU   IEDQAVTD+532                                             02115000
AVTOLTST EQU   AVTHG02                                                  02116000
AVTE8    EQU   IEDQAVTD+524                                             02117000
AVTUI    EQU   IEDQAVTD+520                                             02118000
AVTCOMPT EQU   IEDQAVTD+516                                             02119000
AVTCRSRF EQU   IEDQAVTD+512                                             02120000
@NM00012 EQU   IEDQAVTD+508                                             02121000
AVTKA02  EQU   IEDQAVTD+504                                             02122000
AVTOPTPT EQU   IEDQAVTD+500                                             02123000
AVTPCBPT EQU   IEDQAVTD+496                                             02124000
AVTOSECB EQU   IEDQAVTD+492                                             02125000
AVTOPECA EQU   IEDQAVTD+488                                             02126000
AVTOLECA EQU   IEDQAVTD+484                                             02127000
AVTCKECA EQU   IEDQAVTD+480                                             02128000
AVTCWECA EQU   IEDQAVTD+476                                             02129000
AVTCWTCB EQU   IEDQAVTD+472                                             02130000
AVTOLTCB EQU   IEDQAVTD+468                                             02131000
AVTOCTCB EQU   IEDQAVTD+464                                             02132000
AVTCKTCB EQU   IEDQAVTD+460                                             02133000
AVTAS    EQU   IEDQAVTD+456                                             02134000
AVTNOLBF EQU   IEDQAVTD+454                                             02135000
AVTNCKPR EQU   IEDQAVTD+453                                             02136000
AVTCIB   EQU   IEDQAVTD+452                                             02137000
AVTSPLPT EQU   IEDQAVTD+448                                             02138000
AVTMVBFR EQU   IEDQAVTD+444                                             02139000
AVTSBTA  EQU   IEDQAVTD+440                                             02140000
AVTRARTN EQU   IEDQAVTD+436                                             02141000
AVTBSCAN EQU   IEDQAVTD+432                                             02142000
AVTRDYA  EQU   IEDQAVTD+428                                             02143000
AVTDISTR EQU   IEDQAVTD+420                                             02144000
AVTPARM3 EQU   IEDQAVTD+416                                             02145000
@NM00011 EQU   AVTPKF                                                   02146000
@NM00010 EQU   AVTPKF                                                   02147000
@NM00009 EQU   AVTPKF                                                   02148000
AVTFTCHF EQU   AVTPKF                                                   02149000
@NM00008 EQU   AVTPKF                                                   02150000
@NM00007 EQU   AVTPKF                                                   02151000
@NM00006 EQU   AVTPKF                                                   02152000
@NM00005 EQU   AVTPKF                                                   02153000
AVTPARM  EQU   IEDQAVTD+408                                             02154000
AVTEXS2A EQU   IEDQAVTD+402                                             02155000
AVTEXA2S EQU   IEDQAVTD+396                                             02156000
@NM00004 EQU   AVTCKFLG                                                 02157000
AVTCKHLT EQU   AVTCKFLG                                                 02158000
AVTCKREQ EQU   AVTCKFLG                                                 02159000
AVTCKENV EQU   AVTCKFLG                                                 02160000
AVTCKNAC EQU   AVTCKFLG                                                 02161000
AVTCKTAC EQU   AVTCKFLG                                                 02162000
@NM00002 EQU   IEDQAVTD+384                                             02163000
AVTREADD EQU   IEDQAVTD+380                                             02164000
AVTREADY EQU   IEDQAVTD+376                                             02165000
AVTRACE  EQU   IEDQAVTD+372                                             02166000
AVTTCB   EQU   IEDQAVTD+368                                             02167000
AVTPASWD EQU   IEDQAVTD+360                                             02168000
AVTCTLCH EQU   IEDQAVTD+352                                             02169000
AVTDOUBL EQU   IEDQAVTD+344                                             02170000
AVTDOUBX EQU   IEDQAVTD+336                                             02171000
AVTDPARM EQU   IEDQAVTD+332                                             02172000
AVTCSTCS EQU   IEDQAVTD+328                                             02173000
AVTDLQ   EQU   AVTSAVEX+32                                              02174000
@NM00001 EQU   AVTSAVEX                                                 02175000
AVTSAVE4 EQU   IEDQAVTD+216                                             02176000
AVTSAVE3 EQU   IEDQAVTD+144                                             02177000
AVTSAVE2 EQU   IEDQAVTD+72                                              02178000
AVTSAVE1 EQU   IEDQAVTD                                                 02179000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02180000
@RF00452 EQU   @RC00357                                                 02181000
@RC00480 EQU   @EL00001                                                 02182000
@ENDDATA EQU   *                                                        02183000
         END   IEDQNT,(C'PLS0353',0701,76363)                           02184000
./  ADD  SSI=71090774,NAME=IEDQNU
         TITLE 'IEDQNU, 3705 CHECKPOINT - LOAD 2                       *00001000
                        '                                               00002000
IEDQNU   CSECT ,                                                01S0001 00003000
@PROLOG  DS    0H                                               01S0002 00004000
*   RBASE=REG15;                    /* SET BASE REGISTER             */ 00005000
         LR    RBASE,REG15                                      02S0503 00006000
*   GEN REFS(RBASE) NOSETS;                                     02S0504 00007000
*                                   /*                                  00008000
         USING IEDQNU,RBASE            ESTABLISH ADDRESSABILITY         00009000
IEDQNU   IEDHJN AFTERHJN,HJN           MODULE IDENTIFICATION MACRO      00010000
*   RCAVT=AVTCKAVT;                 /* GET ADDRESS OF THE CKPT AVT   */ 00011000
         L     RCAVT,AVTCKAVT-1(,RAVT)                          02S0505 00012000
         LA    RCAVT,0(,RCAVT)                                  02S0505 00013000
*   RCKPT=CAVTNWA;                  /* GET ADDR OF CKPT WORK AREA    */ 00014000
         L     RCKPT,CAVTNWA(,RCAVT)                            02S0506 00015000
*   CKPSAVE2(1)=REG12;              /* SAVE BASE ADDRESS OF IEDQNF   */ 00016000
         ST    REG12,CKPSAVE2(,RCKPT)                           02S0507 00017000
*   CKPSAVE2(2)=REG14;              /* SAVE RETURN ADDRESS           */ 00018000
         ST    REG14,CKPSAVE2+4(,RCKPT)                         02S0508 00019000
*   ROPCE=OPCCKPTF;                 /* GET OPCE ADDRESS - OPCE TO BE    00020000
*                                      CKPT'D IS THE FIRST ONE ON THE   00021000
*                                      OP CONTROL QUEUE FOR     02S0509 00022000
*                                      CHECKPOINT                    */ 00023000
         L     @10,ROPCAVT(,RAVT)                               02S0509 00024000
         L     ROPCE,OPCCKPTF(,@10)                             02S0509 00025000
*   RSAVE=ADDR(CKPSAVE1(1));        /* GET ADDR OF SAVE AREA         */ 00026000
         LR    RSAVE,RCKPT                                      02S0510 00027000
*   RFY                                                         02S0511 00028000
*    (REG12,                                                    02S0511 00029000
*     REG14) UNRSTD;                                            02S0511 00030000
*                                                               02S0512 00031000
*   /*****************************************************************/ 00032000
*   /*                                                               */ 00033000
*   /* PROCESS: THIS SEGMENT DOES THE PROCESSING THAT IS NECESSARY TO*/ 00034000
*   /* PERFORM THE FUNCTION OF THE MODULE.                           */ 00035000
*   /*                                                               */ 00036000
*   /*****************************************************************/ 00037000
*                                                               02S0512 00038000
*   IF CKPENCDE=0                   /* TEST FOR I/O STARTED          */ 00039000
*     THEN                          /* I/O WAS STARTED               */ 00040000
         CLI   CKPENCDE(RCKPT),0                                02S0512 00041000
         BNE   @RF00512                                         02S0512 00042000
*     IF CKPIOECC=CKPIOCOM          /* TEST FOR I/O SUCCESSFUL       */ 00043000
*       THEN                        /* I/O WAS SUCCESSFUL            */ 00044000
         CLI   CKPIOECC(RCKPT),X'7F'                            02S0513 00045000
         BNE   @RF00513                                         02S0513 00046000
*       IF CKPCUSEL=CKPNOTFY        /* TEST FOR REQUEST FOR     02S0514 00047000
*                                      NOTIFICATION                  */ 00048000
*         THEN                                                  02S0514 00049000
         CLI   CKPCUSEL(RCKPT),10                               02S0514 00050000
         BE    @RT00514                                         02S0514 00051000
*         ;                         /* THIS IS A REQUEST FOR    02S0515 00052000
*                                      NOTIFICATION                  */ 00053000
*       ELSE                        /* THIS IS NOT A REQUEST FOR        00054000
*                                      NOTIFICATION                  */ 00055000
*                                                               03S0516 00056000
*         /***********************************************************/ 00057000
*         /*                                                         */ 00058000
*         /* PROCESS.READRETN: THIS SEGMENT PROCESSES THE RETURN FROM*/ 00059000
*         /* A SUCCESSFUL READ OF A RESOURCE'S CKPT RECORD. THE      */ 00060000
*         /* CURRENT 'SELECT' VALUE IS USED IN A CASE STATEMENT TO   */ 00061000
*         /* SELECT THE PROCESSING FOR A PARTICULAR OP CONTROL       */ 00062000
*         /* COMMAND. AFTER THE DATA UPDATE, INITIALIZATION IS DONE  */ 00063000
*         /* TO WRITE OUT THE UPDATED CHECKPOINT RECORD.             */ 00064000
*         /*                                                         */ 00065000
*         /***********************************************************/ 00066000
*                                                               03S0516 00067000
*         DO;                                                   03S0516 00068000
*           RFY                                                 03S0517 00069000
*             RCKPREC RSTD;                                     03S0517 00070000
*           RCKPREC=CKPRWADD;       /* GET BASE FOR RESOURCE RECORD  */ 00071000
         L     RCKPREC,CKPRWADD-1(,RCKPT)                       03S0518 00072000
         LA    RCKPREC,0(,RCKPREC)                              03S0518 00073000
*           DO;                     /* CASE(CKPCUSEL)NAMES(BHSET,SSPA   00074000
*                                      U,NEGPL,CSLIM,CTLIM,MSSEL,ICHN   00075000
*                                      GW,TCHNG,ICHNGR)              */ 00076000
*             DCL                                               03S0520 00077000
*               CL0001@ LABEL BASED(CP0001@(CKPCUSEL)) VALUERANGE(BHSET 00078000
*                   ,SSPAU,NEGPL,CSLIM,CTLIM,MSSEL,ICHNGW,TCHNG,ICHNGR) 00079000
*                 ;                 /* BRANCH TARGET                 */ 00080000
*             DCL                                               03S0521 00081000
*               CP0001@(9) PTR(31) INIT(ADDR(BHSET),ADDR(SSPAU),ADDR(   00082000
*                   NEGPL),ADDR(CSLIM),ADDR(CTLIM),ADDR(MSSEL),ADDR(    00083000
*                   ICHNGW),ADDR(TCHNG),ADDR(ICHNGR));          03S0521 00084000
*             GOTO CL0001@;         /* BRANCH TO SELECTED CASE       */ 00085000
         SLR   @14,@14                                          03S0522 00086000
         IC    @14,CKPCUSEL(,RCKPT)                             03S0522 00087000
         SLA   @14,2                                            03S0522 00088000
         L     @14,CP0001@-4(@14)                               03S0522 00089000
         BR    @14                                              03S0522 00090000
*                                                               04S0523 00091000
*             /*******************************************************/ 00092000
*             /*                                                     */ 00093000
*             /* PROCESS.READRETN.BHSET: CHECKPOINT A MODIFY BHSET   */ 00094000
*             /* COMMAND.                                            */ 00095000
*             /*                                                     */ 00096000
*             /*******************************************************/ 00097000
*                                                               04S0523 00098000
*BHSET:                                                         04S0523 00099000
*             DO;                   /* SUBCASE                       */ 00100000
BHSET    DS    0H                                               04S0524 00101000
*               IF OCCKDAT1='80'X THEN                          04S0524 00102000
         CLI   OCCKDAT1(ROPCE),X'80'                            04S0524 00103000
         BNE   @RF00524                                         04S0524 00104000
*                 DO;               /* IF CHANGE BHSET FUNCTION 04S0525 00105000
*                                                            @YM07411*/ 00106000
*                   CNRFBHSC=ON;    /* INDICATE THAT A CHANGE BHSET     00107000
*                                      HAS BEEN CHECKPOINTED @YM07411*/ 00108000
         OI    CNRFBHSC(RCKPREC),B'01000000'                    04S0526 00109000
*                   CNRBHFUN=OCCKDAT1;/* CKPT THE BHSET FUNCTION BYTE   00110000
*                                                            @YM07713*/ 00111000
         MVC   CNRBHFUN(1,RCKPREC),OCCKDAT1(ROPCE)              04S0527 00112000
*                   CNRBHPOS=OCCKDAT2;/* CKPT THE BHSET POSITION DATA*/ 00113000
         MVC   CNRBHPOS(1,RCKPREC),OCCKDAT2(ROPCE)              04S0528 00114000
*                 END;              /*                       @YM07411*/ 00115000
*               ELSE                                            04S0530 00116000
*                 DO;               /* NOT CHANGE, MUST BE ACT OR       00117000
*                                      DEACT                 @YM07411*/ 00118000
         B     @RC00524                                         04S0530 00119000
@RF00524 DS    0H                                               04S0531 00120000
*                   CNRFBHS=ON;     /* INDICATE THAT AN ACT OR DEACT    00121000
*                                      BHSET HAS BEEN CHECKPOINTED      00122000
*                                                            @YM07411*/ 00123000
         OI    CNRFBHS(RCKPREC),B'10000000'                     04S0531 00124000
*                   CNRBHFUN=OCCKDAT1;/* CKPT BHSET FUNCTION BYTE       00125000
*                                                            @YM07411*/ 00126000
         MVC   CNRBHFUN(1,RCKPREC),OCCKDAT1(ROPCE)              04S0532 00127000
*                 END;              /*                       @YM07411*/ 00128000
*               GOTO CE0001@;       /* BRANCH TO END OF CASE         */ 00129000
         B     CE0001@                                          04S0534 00130000
*             END BHSET;            /* END OF SUBCASE                */ 00131000
*                                                               04S0536 00132000
*             /*******************************************************/ 00133000
*             /*                                                     */ 00134000
*             /* PROCESS.READRETN.SSPAU: CHECKPOINT A CHANGE SERVICE */ 00135000
*             /* SEEKING PAUSE COMMAND.                              */ 00136000
*             /*                                                     */ 00137000
*             /*******************************************************/ 00138000
*                                                               04S0536 00139000
*SSPAU:                                                         04S0536 00140000
*             DO;                   /* SUBCASE                       */ 00141000
SSPAU    DS    0H                                               04S0537 00142000
*               CNRFSSP=ON;         /* INDICATE THAT A CHANGE SERVICE   00143000
*                                      SEEKING PAUSE COMMAND HAS BEEN   00144000
*                                      CHECKPOINTED                  */ 00145000
         OI    CNRFSSP(RCKPREC),B'00100000'                     04S0537 00146000
*               CNRSSPAU=OCCKDAT1;  /* CKPT SERVICE SEEKING PAUSE       00147000
*                                      DATA                          */ 00148000
         MVC   CNRSSPAU(1,RCKPREC),OCCKDAT1(ROPCE)              04S0538 00149000
*               GOTO CE0001@;       /* BRANCH TO END OF CASE         */ 00150000
         B     CE0001@                                          04S0539 00151000
*             END SSPAU;            /* END OF SUBCASE                */ 00152000
*                                                               04S0541 00153000
*             /*******************************************************/ 00154000
*             /*                                                     */ 00155000
*             /* PROCESS.READRETN.NEGPL: CHECKPOINT A CHANGE NEGATIVE*/ 00156000
*             /* POLL LIMIT COMMAND.                                 */ 00157000
*             /*                                                     */ 00158000
*             /*******************************************************/ 00159000
*                                                               04S0541 00160000
*NEGPL:                                                         04S0541 00161000
*             DO;                   /* SUBCASE                       */ 00162000
NEGPL    DS    0H                                               04S0542 00163000
*               CNRFNPL=ON;         /* INDICATE THAT NEGATIVE POLL      00164000
*                                      LIMIT COMMAND HAS BEEN   04S0542 00165000
*                                      CHECKPOINTED                  */ 00166000
         OI    CNRFNPL(RCKPREC),B'00010000'                     04S0542 00167000
*               CNRNEGPL=OCCKDAT1;  /* CKPT NEGATIVE POLL LIMIT DATA */ 00168000
         MVC   CNRNEGPL(1,RCKPREC),OCCKDAT1(ROPCE)              04S0543 00169000
*               GOTO CE0001@;       /* BRANCH TO END OF CASE         */ 00170000
         B     CE0001@                                          04S0544 00171000
*             END NEGPL;            /* END OF SUBCASE                */ 00172000
*                                                               04S0546 00173000
*             /*******************************************************/ 00174000
*             /*                                                     */ 00175000
*             /* PROCESS.READRETN.CSLIM: CHECKPOINT A CHANGE SESSION */ 00176000
*             /* LIMIT COMMAND.                                      */ 00177000
*             /*                                                     */ 00178000
*             /*******************************************************/ 00179000
*                                                               04S0546 00180000
*CSLIM:                                                         04S0546 00181000
*             DO;                   /* SUBCASE                       */ 00182000
CSLIM    DS    0H                                               04S0547 00183000
*               CNRFCSL=ON;         /* INDICATE THAT A CHANGE SESSION   00184000
*                                      LIMIT COMMAND HAS BEEN   04S0547 00185000
*                                      CHECKPOINTED                  */ 00186000
         OI    CNRFCSL(RCKPREC),B'00001000'                     04S0547 00187000
*               CNRCSLIM=OCCKDAT1;  /* CKPT CHANGE SESSION LIMIT DATA*/ 00188000
         MVC   CNRCSLIM(1,RCKPREC),OCCKDAT1(ROPCE)              04S0548 00189000
*               GOTO CE0001@;       /* BRANCH TO END OF CASE         */ 00190000
         B     CE0001@                                          04S0549 00191000
*             END CSLIM;            /* END OF SUBCASE                */ 00192000
*                                                               04S0551 00193000
*             /*******************************************************/ 00194000
*             /*                                                     */ 00195000
*             /* PROCESS.READRETN.CTLIM: CHECKPOINT A CHANGE         */ 00196000
*             /* TRANSMISSION LIMIT COMMAND.                         */ 00197000
*             /*                                                     */ 00198000
*             /*******************************************************/ 00199000
*                                                               04S0551 00200000
*CTLIM:                                                         04S0551 00201000
*             DO;                   /* SUBCASE                       */ 00202000
CTLIM    DS    0H                                               04S0552 00203000
*               CNRFCTL=ON;         /* INDICATE THAT A CHANGE   04S0552 00204000
*                                      TRANSMISSIN LIMIT COMMAND HAS    00205000
*                                      BEEN CHECKPOINTED             */ 00206000
         OI    CNRFCTL(RCKPREC),B'00000100'                     04S0552 00207000
*               CNRCTLIM=OCCKDAT1;  /* CKPT CHANGE TRANSMISSION LIMIT   00208000
*                                      DATA                          */ 00209000
         MVC   CNRCTLIM(1,RCKPREC),OCCKDAT1(ROPCE)              04S0553 00210000
*               GOTO CE0001@;       /* BRANCH TO END OF CASE         */ 00211000
         B     CE0001@                                          04S0554 00212000
*             END CTLIM;            /* END OF SUBCASE                */ 00213000
*                                                               04S0556 00214000
*             /*******************************************************/ 00215000
*             /*                                                     */ 00216000
*             /* PROCESS.READRETN.MSSEL: CHECKPOINT A CHANGE MODEM   */ 00217000
*             /* SPEED COMMAND.                                      */ 00218000
*             /*                                                     */ 00219000
*             /*******************************************************/ 00220000
*                                                               04S0556 00221000
*MSSEL:                                                         04S0556 00222000
*             DO;                   /* SUBCASE                       */ 00223000
MSSEL    DS    0H                                               04S0557 00224000
*               CNRFMSS=ON;         /* INDICATE THAT A MODEM SPEED      00225000
*                                      SELECT COMMAND HAS BEEN  04S0557 00226000
*                                      CHECKPOINTED                  */ 00227000
         OI    CNRFMSS(RCKPREC),B'00000010'                     04S0557 00228000
*               CNRMSSEL=OCCKDAT1;  /* CKPT MODEM SPEED SELECT DATA  */ 00229000
         MVC   CNRMSSEL(1,RCKPREC),OCCKDAT1(ROPCE)              04S0558 00230000
*               GOTO CE0001@;       /* BRANCH TO END OF CASE         */ 00231000
         B     CE0001@                                          04S0559 00232000
*             END MSSEL;            /* END OF SUBCASE                */ 00233000
*                                                               04S0561 00234000
*             /*******************************************************/ 00235000
*             /*                                                     */ 00236000
*             /* PROCESS.READRETN.ICHNGW: CHECKPOINT AN ICHNG COMMAND*/ 00237000
*             /* BY WRITING A DEVICE/LINE SESSION RECORD AS PREVIOSLY*/ 00238000
*             /* INITIALIZED BY IEDQNT OR BY SEGMENT ICHNGR OF THIS  */ 00239000
*             /* MODULE.IF MORE DEVICE RECORDS TO WRITE, REQUEST     */ 00240000
*             /* RETURN TO ICHNGR FOR FURTHER RECORD INITIALIZATION. */ 00241000
*             /*                                                     */ 00242000
*             /*******************************************************/ 00243000
*                                                               04S0561 00244000
*ICHNGW:                                                        04S0561 00245000
*             DO;                   /* SUBCASE                       */ 00246000
ICHNGW   DS    0H                                               04S0562 00247000
*               RFY                                             04S0562 00248000
*                 RPLMV RSTD;                                   04S0562 00249000
*               RPLMV=ADDR(CKPSAVE2(10));/* POINT TO MOVE BUFFER PARM   00250000
*                                      LIST                          */ 00251000
         LA    RPLMV,CKPSAVE2+36(,RCKPT)                        04S0563 00252000
*               CNRFRDR=ON;         /* INDICATE THAT DEVICE DATA HAS    00253000
*                                      BEEN CKPT'ED                  */ 00254000
         OI    CNRFRDR(RCKPREC),B'00000001'                     04S0564 00255000
*               IF OCICTYPE=OCICSID/* TEST ICHNG LINE TYPE          */ 00256000
*                 THEN              /* NOT SWITCHID - INSERT BDU FOR    00257000
*                                      A REPLACE DEVICE SESSION 04S0565 00258000
*                                      INITIATION INFO CMD           */ 00259000
         CLI   OCICTYPE(ROPCE),0                                04S0565 00260000
         BE    @RF00565                                         04S0565 00261000
*                                                               05S0566 00262000
*                 /***************************************************/ 00263000
*                 /*                                                 */ 00264000
*                 /* PROCESS.READRETN.ICHNGW.INITBDU: THIS SEGMENT   */ 00265000
*                 /* COMPLETES INITIALIZATION FOR THE WRITE OF A     */ 00266000
*                 /* DEVICE RECORD FOR A LEASED, SWITCHED, OR        */ 00267000
*                 /* MULTIPOINT LINE.                                */ 00268000
*                 /*                                                 */ 00269000
*                 /***************************************************/ 00270000
*                                                               05S0566 00271000
*                 DO;                                           05S0566 00272000
*                   RPARM=ADDR(CNRDVBDU);/* POINT TO BDU FIELD IN       00273000
*                                      CKPT RECORD                   */ 00274000
         LA    RPARM,CNRDVBDU(,RCKPREC)                         05S0567 00275000
*                   RPARM->IEDBDU=''B;/* CLEAR THE BDU               */ 00276000
         XC    IEDBDU(6,RPARM),IEDBDU(RPARM)                    05S0568 00277000
*                   RPARM->BDUCMND=CD0CTRL;/* CONTROL COMMAND        */ 00278000
         MVI   BDUCMND(RPARM),X'08'                             05S0569 00279000
*                   RPARM->BDUMODIF=CD0CRDSI;/* REP DEV SESS INFO    */ 00280000
         MVI   BDUMODIF(RPARM),X'22'                            05S0570 00281000
*                   RPARM->BDUHEADR=ON;/* HEADER PREFIX              */ 00282000
         OI    BDUHEADR(RPARM),B'01000000'                      05S0571 00283000
*                   PLMVTU=ADDR(CNRDVRCD);/* SET TARGET TO RECEIVE      00284000
*                                      ...                           */ 00285000
         LA    @14,CNRDVRCD(,RCKPREC)                           05S0572 00286000
         ST    @14,PLMVTU(,RPLMV)                               05S0572 00287000
*                   PLMVTD=ADDR(CNRDVRCD);/* ... DEVICE SESSION INFO */ 00288000
         ST    @14,PLMVTD(,RPLMV)                               05S0573 00289000
*                   PLMVLNTH=DEVLEN;/* LENGTH FOR DATA MOVE IS LENGTH   00290000
*                                      OF THE DEVICE RECORD          */ 00291000
         L     @14,PLMVSD(,RPLMV)                               05S0574 00292000
         SLR   @12,@12                                          05S0574 00293000
         IC    @12,DEVLEN(,@14)                                 05S0574 00294000
         STH   @12,PLMVLNTH(,RPLMV)                             05S0574 00295000
*                 END;                                          05S0575 00296000
*               CNRDVTC=CKPTC;      /* MOVE IN TTCIN AND DATA COUNT     00297000
*                                      FOR DEVICE/LINE RECORD        */ 00298000
@RF00565 MVC   CNRDVTC(4,RCKPREC),CKPTC(RCKPT)                  04S0576 00299000
*               PLMVTCTG=ON;        /* TARGET OF MOVE IS CONTIGUOUS     00300000
*                                      AREA                          */ 00301000
         OI    PLMVTCTG(RPLMV),B'00100000'                      04S0577 00302000
*               RPARM=RPLMV;        /* POINT TO MOVE BUFFER PARAMETER   00303000
*                                      LIST                          */ 00304000
         LR    RPARM,RPLMV                                      04S0578 00305000
*               CALL IEDMVBFR;      /* MOVE DEVICE RECORD FROM BUFFER   00306000
*                                      UNITS INTO CKPT RECORD        */ 00307000
         L     @12,AVTSAVTP(,RAVT)                              04S0579 00308000
         L     @15,SAVTMVBF(,@12)                               04S0579 00309000
         BALR  @14,@15                                          04S0579 00310000
*               IF CKPTNTNB=0      /* TEST FOR MORE DEVICE RECORDS     00311000
*                                      TO CKPT                       */ 00312000
*                 THEN              /* THERE ARE MORE DEVICE DEVICE     00313000
*                                      RECORDS                       */ 00314000
         LH    @14,CKPTNTNB(,RCKPT)                             04S0580 00315000
         LTR   @14,@14                                          04S0580 00316000
         BZ    @RF00580                                         04S0580 00317000
*                 CKPSLNEW=SELREAD; /* SET SELECT VALUES FOR READ       00318000
*                                      NEXT DEVICE RECORD            */ 00319000
         MVC   CKPSLNEW(3,RCKPT),SELREAD                        04S0581 00320000
*               ELSE                /* NO MORE DEVICE RECORDS        */ 00321000
*                 CKPSLNEW=SELNOTFY;/* SET SELECT VALUE FOR     04S0582 00322000
*                                      NOTIFICATION AFTER WRITE OF      00323000
*                                      DEVICE RECORD                 */ 00324000
         B     @RC00580                                         04S0582 00325000
@RF00580 MVC   CKPSLNEW(3,RCKPT),SELNOTFY                       04S0582 00326000
*               RFY                                             04S0583 00327000
*                 RPLMV UNRSTD;                                 04S0583 00328000
*               GOTO CE0001@;       /* BRANCH TO END OF CASE         */ 00329000
         B     CE0001@                                          04S0584 00330000
*             END ICHNGW;           /* END OF SUBCASE                */ 00331000
*                                                               04S0586 00332000
*             /*******************************************************/ 00333000
*             /*                                                     */ 00334000
*             /* PROCESS.READRETN.TCHNG: CHECKPOINT A TCHNG COMMAND. */ 00335000
*             /*                                                     */ 00336000
*             /*******************************************************/ 00337000
*                                                               04S0586 00338000
*TCHNG:                                                         04S0586 00339000
*             DO;                   /* SUBCASE                       */ 00340000
TCHNG    DS    0H                                               04S0587 00341000
*               RFY                                             04S0587 00342000
*                 RPLMV RSTD;                                   04S0587 00343000
*               IF LENCNR+PRUDATCT>CKPBLKSZ/* TEST FOR CKPT DATA TOO    00344000
*                                      BIG FOR CKPT RECORD           */ 00345000
*                 THEN              /* DATA IS TOO BIG               */ 00346000
         L     @14,IEDPRUQP(,ROPCE)                             04S0588 00347000
         LH    @14,PRUDATCT(,@14)                               04S0588 00348000
         LH    @12,LENCNR                                       04S0588 00349000
         ALR   @12,@14                                          04S0588 00350000
         CH    @12,CKPBLKSZ(,RCKPT)                             04S0588 00351000
         BNH   @RF00588                                         04S0588 00352000
*                 DO;                                           04S0589 00353000
*                   CKPENCDE=CKPTOOBG;/* SET 'DATA TOO BIG' MESSAGE     00354000
*                                      INDICATOR                     */ 00355000
         MVI   CKPENCDE(RCKPT),X'0C'                            04S0590 00356000
*                   CKPDATCT=PRUDATCT;/* SAVE VARIABLE LENGTH        */ 00357000
         STH   @14,CKPDATCT(,RCKPT)                             04S0591 00358000
*                   CKPCUSEL=CKPNOTFY;/* REQUEST NOTIFICATION        */ 00359000
         MVI   CKPCUSEL(RCKPT),X'0A'                            04S0592 00360000
*                 END;                                          04S0593 00361000
*               ELSE                /* DATA NOT TOO BIG              */ 00362000
*                 DO;                                           04S0594 00363000
         B     @RC00588                                         04S0594 00364000
@RF00588 DS    0H                                               04S0595 00365000
*                   CNRFRDR=ON;     /* INDICATE THAT DEVICE DATA HAS    00366000
*                                      BEEN CKPT'ED                  */ 00367000
         OI    CNRFRDR(RCKPREC),B'00000001'                     04S0595 00368000
*                   RPLMV=ADDR(CKPSAVE2(10));/* POINT TO MOVE BUFFER    00369000
*                                      PARM LIST                     */ 00370000
         LA    RPLMV,CKPSAVE2+36(,RCKPT)                        04S0596 00371000
*                   CNRDVT=PRUTTCIN;/* MOVE TNT OFFSET INTO CKPT        00372000
*                                      RECORD                        */ 00373000
         L     @14,IEDPRUQP(,ROPCE)                             04S0597 00374000
         MVC   CNRDVT(2,RCKPREC),PRUTTCIN(@14)                  04S0597 00375000
*                   CNRDVC=PRUDATCT;/* MOVE DATA COUNT INTO CKPT        00376000
*                                      RECORD                        */ 00377000
         LH    @12,PRUDATCT(,@14)                               04S0598 00378000
         STCM  @12,3,CNRDVC(RCKPREC)                            04S0598 00379000
*                   PLMVTU=ADDR(CNRDVBDU);/* SET TARGET ADDR TO ...  */ 00380000
         LA    @02,CNRDVBDU(,RCKPREC)                           04S0599 00381000
         ST    @02,PLMVTU(,RPLMV)                               04S0599 00382000
*                   PLMVTD=ADDR(CNRDVBDU);/* ... DEVICE RECORD       */ 00383000
         ST    @02,PLMVTD(,RPLMV)                               04S0600 00384000
*                   PLMVSU=OCUNIT;  /* SET ADDR OF UNIT CONTAINING      00385000
*                                      THE DATA                      */ 00386000
         L     @02,OCUNIT(,ROPCE)                               04S0601 00387000
         ST    @02,PLMVSU(,RPLMV)                               04S0601 00388000
*                   PLMVSD=ADDR(IEDBDU);/* POINT TO START OF DATA TO    00389000
*                                      MOVE                          */ 00390000
         AL    @14,@CF00239                                     04S0602 00391000
         ST    @14,PLMVSD(,RPLMV)                               04S0602 00392000
*                   PLMVLNTH=PRUDATCT;/* LENGTH IS ALL OF THE DATA   */ 00393000
         STH   @12,PLMVLNTH(,RPLMV)                             04S0603 00394000
*                   PLMVFLG1=''B;   /* CLEAR FLAG BYTE 1             */ 00395000
         MVI   PLMVFLG1(RPLMV),X'00'                            04S0604 00396000
*                   PLMVTCTG=ON;    /* TARGET OF THE MOVE IS    04S0605 00397000
*                                      CONTIGUOUS                    */ 00398000
         OI    PLMVTCTG(RPLMV),B'00100000'                      04S0605 00399000
*                   PLMVFLG2=''B;   /* CLEAR FLAG BYTE 2             */ 00400000
         MVI   PLMVFLG2(RPLMV),X'00'                            04S0606 00401000
*                   PLMVUNCA=0;     /* CLEAR CHAIN ADDRESS           */ 00402000
         SLR   @14,@14                                          04S0607 00403000
         ST    @14,PLMVUNCA(,RPLMV)                             04S0607 00404000
*                   RPARM=RPLMV;    /* SET ADDRESS OF PARM LIST      */ 00405000
         LR    RPARM,RPLMV                                      04S0608 00406000
*                   CALL IEDMVBFR;  /* CALL ROUTINE TO MOVE DEVICE      00407000
*                                      DATA TO THE CKPT RECORD       */ 00408000
         L     @12,AVTSAVTP(,RAVT)                              04S0609 00409000
         L     @15,SAVTMVBF(,@12)                               04S0609 00410000
         BALR  @14,@15                                          04S0609 00411000
*                 END;                                          04S0610 00412000
*               RFY                                             04S0611 00413000
*                 RPLMV UNRSTD;                                 04S0611 00414000
*               GOTO CE0001@;       /* BRANCH TO END OF CASE         */ 00415000
         B     CE0001@                                          04S0612 00416000
*             END TCHNG;            /* END OF SUBCASE                */ 00417000
*                                                               04S0614 00418000
*             /*******************************************************/ 00419000
*             /*                                                     */ 00420000
*             /* PROCESS.READRETN.ICHNGR: THIS SEGMENT PROCESSES     */ 00421000
*             /* RETURNS FROM A WRITE OF A DEVICE RECORD FOR ICHNG IF*/ 00422000
*             /* THERE ARE MORE DEVICE RECORDS TO PROCESS. IT SETS   */ 00423000
*             /* THE DEVICE RECORD CKPT'ED INDICATOR FOR THE RESOURCE*/ 00424000
*             /* JUST CKPT'ED. IT LOCATES THE NEXT DEVICE RECORD AND */ 00425000
*             /* REQUESTS A READ OF THE MOST RECENT CKPT DATA FOR THE*/ 00426000
*             /* RESOURCE.                                           */ 00427000
*             /*                                                     */ 00428000
*             /*******************************************************/ 00429000
*                                                               04S0614 00430000
*ICHNGR:                                                        04S0614 00431000
*             DO;                   /* SUBCASE                       */ 00432000
ICHNGR   DS    0H                                               04S0615 00433000
*               RFY                                             04S0615 00434000
*                 RPLMV RSTD;                                   04S0615 00435000
*               IF TRMCKPRN=OFF     /* TEST FOR WHICH RECORD WAS        00436000
*                                      UPDATED                       */ 00437000
*                 THEN              /* FIRST WAS UPDATED             */ 00438000
         L     @14,CKPTRMAD(,RCKPT)                             04S0616 00439000
         TM    TRMCKPRN(@14),B'00000010'                        04S0616 00440000
         BNZ   @RF00616                                         04S0616 00441000
*                 TRMCKPRN=ON;      /* INDICATE THAT SECOND RECORD IS   00442000
*                                      TO BE UPDATED NEXT            */ 00443000
         OI    TRMCKPRN(@14),B'00000010'                        04S0617 00444000
*               ELSE                /* SECOND WAS UPDATED            */ 00445000
*                 TRMCKPRN=OFF;     /* INDICATE THAT FIRST RECORD IS    00446000
*                                      TO BE UPDATED NEXT            */ 00447000
         B     @RC00616                                         04S0618 00448000
@RF00616 L     @14,CKPTRMAD(,RCKPT)                             04S0618 00449000
         NI    TRMCKPRN(@14),B'11111101'                        04S0618 00450000
*               RPLMV=ADDR(CKPSAVE2(10));/* POINT TO MOVE BUFFER PARM   00451000
*                                      LIST                          */ 00452000
@RC00616 LA    RPLMV,CKPSAVE2+36(,RCKPT)                        04S0619 00453000
*                                                               05S0620 00454000
*               /*****************************************************/ 00455000
*               /*                                                   */ 00456000
*               /* PROCESS.READRETN.ICHNGR.FINDNEXT: THIS SEGMENT    */ 00457000
*               /* SCANS THE REMAINING DEVICE RECORDS LOOKING FOR    */ 00458000
*               /* VALID RECORDS TO PROCESS. AT ENTRY CKPTNTPT POINTS*/ 00459000
*               /* TO THE TNT OFFSET AND PLMVSD POINTS TO THE DEVICE */ 00460000
*               /* RECORD TO PROCESS. A SCAN IS MADE LOOKING FOR A   */ 00461000
*               /* NON-ZERO TNT OFFSET (WHICH IMPLIES THAT A         */ 00462000
*               /* CORRESPONDING DEVICE RECORD IS TO BE PROCESSED).  */ 00463000
*               /* AT EXIT, 'OFFSET=0' IMPLIES THAT THERE IS NO      */ 00464000
*               /* DEVICE RECORD TO PROCESS. OTHERWISE, 'OFFSET'     */ 00465000
*               /* CONTAINS THE TNT OFFSET, CKPTNTPT POINTS TO THE   */ 00466000
*               /* NEXT TNT OFFSET, AND PLMVSD POINTS TO THE DEVICE  */ 00467000
*               /* RECORD TO PROCESS.                                */ 00468000
*               /*                                                   */ 00469000
*               /*****************************************************/ 00470000
*                                                               05S0620 00471000
*               DO;                                             05S0620 00472000
*                 IF CKPTNTNB<=0    /* TEST FOR MORE TNT OFFSETS TO     00473000
*                                      SCAN                          */ 00474000
*                   THEN            /* THERE ARE NO MORE TNT OFFSETS */ 00475000
         SLR   @14,@14                                          05S0621 00476000
         CH    @14,CKPTNTNB(,RCKPT)                             05S0621 00477000
         BL    @RF00621                                         05S0621 00478000
*                   OFFSET=0;       /* CLEAR OFFSET TO INDICATE NO      00479000
*                                      MORE TNT OFFSETS              */ 00480000
         STH   @14,OFFSET                                       05S0622 00481000
*                 ELSE              /* MORE TNT OFFSETS              */ 00482000
*                   DO;                                         05S0623 00483000
         B     @RC00621                                         05S0623 00484000
@RF00621 DS    0H                                               05S0624 00485000
*                     CALL TNTMOVE; /* CALL SUBROUTINE TO GET NEXT      00486000
*                                      TNT OFFSET                    */ 00487000
         BAL   @14,TNTMOVE                                      05S0624 00488000
*                     DO WHILE(CKPTNTNB>0&OFFSET=0);/* SEARCH FOR TNT   00489000
*                                      OFFSET AS LONG AS ANY REMAIN     00490000
*                                      AND A VALID ONE HAS NOT BEEN     00491000
*                                      FOUND                         */ 00492000
         B     @DE00625                                         05S0625 00493000
@DL00625 DS    0H                                               05S0626 00494000
*                       CALL TNTMOVE;/* CALL SUBROUTINE TO GET NEXT     00495000
*                                      TNT OFFSET                    */ 00496000
         BAL   @14,TNTMOVE                                      05S0626 00497000
*                       PLMVLNTH=DEVLEN;/* SET LENGTH OF DEVICE 05S0627 00498000
*                                      RECORD TO BE SKIPPED          */ 00499000
         L     @14,PLMVSD(,RPLMV)                               05S0627 00500000
         SLR   @12,@12                                          05S0627 00501000
         IC    @12,DEVLEN(,@14)                                 05S0627 00502000
         STH   @12,PLMVLNTH(,RPLMV)                             05S0627 00503000
*                       PLMVFLG1=''B;/* CLEAR FLAGS                  */ 00504000
         MVI   PLMVFLG1(RPLMV),X'00'                            05S0628 00505000
*                       RPARM=RPLMV;/* SET ADDRESS OF PARAMETER LIST */ 00506000
         LR    RPARM,RPLMV                                      05S0629 00507000
*                       CALL IEDMVBFR;/* CALL MOVE BUFFER ROUTINE TO    00508000
*                                      SKIP DEVICE RECORD            */ 00509000
         L     @12,AVTSAVTP(,RAVT)                              05S0630 00510000
         L     @15,SAVTMVBF(,@12)                               05S0630 00511000
         BALR  @14,@15                                          05S0630 00512000
*                     END;                                      05S0631 00513000
@DE00625 LH    @14,CKPTNTNB(,RCKPT)                             05S0631 00514000
         LTR   @14,@14                                          05S0631 00515000
         BNP   @DC00625                                         05S0631 00516000
         LH    @14,OFFSET                                       05S0631 00517000
         N     @14,@CF02829                                     05S0631 00518000
         LTR   @14,@14                                          05S0631 00519000
         BZ    @DL00625                                         05S0631 00520000
@DC00625 DS    0H                                               05S0632 00521000
*                   END;                                        05S0632 00522000
*               END;                                            05S0633 00523000
@RC00621 DS    0H                                               05S0634 00524000
*               IF OFFSET=0         /* TEST FOR VALID TNT OFFSET        00525000
*                                      FOUND                         */ 00526000
*                 THEN              /* NO MORE DEVICE RECORDS TO        00527000
*                                      PROCESS                       */ 00528000
         LH    @14,OFFSET                                       04S0634 00529000
         N     @14,@CF02829                                     04S0634 00530000
         LTR   @14,@14                                          04S0634 00531000
         BNZ   @RF00634                                         04S0634 00532000
*                 CKPCUSEL=CKPNOTFY;/* NOTIFY OP CONTROL THAT THE       00533000
*                                      ICHNG CKPT HAS COMPLETED      */ 00534000
         MVI   CKPCUSEL(RCKPT),X'0A'                            04S0635 00535000
*               ELSE                /* MORE DEVICE RECORDS           */ 00536000
*                                                               05S0636 00537000
*                 /***************************************************/ 00538000
*                 /*                                                 */ 00539000
*                 /* PROCESS.READRETN.ICHNGR.READINIT: THIS SEGMENT  */ 00540000
*                 /* INITIALIZES THE CKPT WORKAREA FIELDS NECESSARY  */ 00541000
*                 /* TO REQUEST A READ OF ANOTHER CKPT RECORD.       */ 00542000
*                 /*                                                 */ 00543000
*                 /***************************************************/ 00544000
*                                                               05S0636 00545000
*                 DO;                                           05S0636 00546000
         B     @RC00634                                         05S0636 00547000
@RF00634 DS    0H                                               05S0637 00548000
*                   CKPDATCT=DEVLEN+LENGTH(IEDBDU);/* SET VARIABLE      00549000
*                                      LENGTH OF CKPT DATA           */ 00550000
         L     @14,PLMVSD(,RPLMV)                               05S0637 00551000
         LA    @12,6                                            05S0637 00552000
         SLR   @02,@02                                          05S0637 00553000
         IC    @02,DEVLEN(,@14)                                 05S0637 00554000
         ALR   @12,@02                                          05S0637 00555000
         STH   @12,CKPDATCT(,RCKPT)                             05S0637 00556000
*                   IF LENCNR+CKPDATCT>CKPBLKSZ/* TEST FOR CKPT DATA    00557000
*                                      TOO BIG FOR CKPT RECORD       */ 00558000
*                     THEN          /* DATA IS TOO BIG               */ 00559000
         AH    @12,LENCNR                                       05S0638 00560000
         CH    @12,CKPBLKSZ(,RCKPT)                             05S0638 00561000
         BNH   @RF00638                                         05S0638 00562000
*                     DO;                                       05S0639 00563000
*                       CKPENCDE=CKPTOOBG;/* SET 'DATA TOO BIG' 05S0640 00564000
*                                      MESSAGE INDICATOR             */ 00565000
         MVI   CKPENCDE(RCKPT),X'0C'                            05S0640 00566000
*                       CKPCUSEL=CKPNOTFY;/* REQUEST NOTIFICATION    */ 00567000
         MVI   CKPCUSEL(RCKPT),X'0A'                            05S0641 00568000
*                     END;                                      05S0642 00569000
*                   ELSE            /* DATA NOT TOO BIG              */ 00570000
*                     DO;                                       05S0643 00571000
         B     @RC00638                                         05S0643 00572000
@RF00638 DS    0H                                               05S0644 00573000
*                                                               06S0644 00574000
*                       /*********************************************/ 00575000
*                       /*                                           */ 00576000
*                       /* PROCESS.READRETN.ICHNGR.READINIT.SETRSID: */ 00577000
*                       /* THIS SEGMENT FINDS THE RSID IN THE DEVICE */ 00578000
*                       /* RECORD. PLMVSD POINTS TO THE DEVICE       */ 00579000
*                       /* RECORD. THE FIRST BYTE OF THE DEVICE      */ 00580000
*                       /* RECORD IS THE LENGTH OF THE DEVICE RECORD.*/ 00581000
*                       /* THE NEXT TWO BYTES ARE THE RSID. MOVE THE */ 00582000
*                       /* RSID TO A SAVEAREA, REMOVE THE SUBAREA    */ 00583000
*                       /* ADDRESS, AND SAVE RSID IN THE CHECKPOINT  */ 00584000
*                       /* WORKAREA.                                 */ 00585000
*                       /*                                           */ 00586000
*                       /*********************************************/ 00587000
*                                                               06S0644 00588000
*                       DO;                                     06S0644 00589000
*                         RPARM=PLMVSU+12+AVTKEYLE;/* SET END OF THE    00590000
*                                      UNIT ADDRESS                  */ 00591000
         LA    RPARM,12                                         06S0645 00592000
         AL    RPARM,PLMVSU(,RPLMV)                             06S0645 00593000
         AH    RPARM,AVTKEYLE(,RAVT)                            06S0645 00594000
*                         IF PLMVSD+3<=RPARM/* TEST FOR RSID FULLY      00595000
*                                      CONTAINED IN THIS UNIT        */ 00596000
*                           THEN    /* RSID FULLY IN THIS UNIT       */ 00597000
         L     @14,PLMVSD(,RPLMV)                               06S0646 00598000
         LA    @12,3                                            06S0646 00599000
         ALR   @12,@14                                          06S0646 00600000
         CR    @12,RPARM                                        06S0646 00601000
         BH    @RF00646                                         06S0646 00602000
*                           RSID=DEVID;/* SAVE RSID                  */ 00603000
         MVC   RSID(2),DEVID(@14)                               06S0647 00604000
*                         ELSE      /* NOT FULLY IN THIS UNIT        */ 00605000
*                           IF PLMVSD+2=RPARM/* TEST FOR FIRST BYTE     00606000
*                                      OF RSID IN THIS UNIT          */ 00607000
*                             THEN  /* FIRST BYTE IS IN THIS UNIT    */ 00608000
         B     @RC00646                                         06S0648 00609000
@RF00646 L     @14,PLMVSD(,RPLMV)                               06S0648 00610000
         LA    @12,2                                            06S0648 00611000
         ALR   @12,@14                                          06S0648 00612000
         CR    @12,RPARM                                        06S0648 00613000
         BNE   @RF00648                                         06S0648 00614000
*                             DO;                               06S0649 00615000
*                               RSID1=PLMVSD->MOVECHAR(2:2);/* GET      00616000
*                                      FIRST BYTE OF RSID            */ 00617000
         MVC   RSID1(1),MOVECHAR+1(@14)                         06S0650 00618000
*                               RSID2=PLMVSU->ICTNTTIC->ICTNTDAT(1:1);  00619000
         L     @14,PLMVSU(,RPLMV)                               06S0651 00620000
         L     @14,ICTNTTIC(,@14)                               06S0651 00621000
         MVC   RSID2(1),ICTNTDAT(@14)                           06S0651 00622000
*                                   /* GET SECOND BYTE OF RSID FROM     00623000
*                                      THE NEXT UNIT                 */ 00624000
*                             END;                              06S0652 00625000
*                           ELSE    /* RSID IN THE NEXT UNIT         */ 00626000
*                             RSID=PLMVSU->ICTNTTIC->ICTNTDAT(1:2);/*   00627000
*                                      GET RSID FROM NEXT UNIT       */ 00628000
         B     @RC00648                                         06S0653 00629000
@RF00648 L     @14,PLMVSU(,RPLMV)                               06S0653 00630000
         L     @14,ICTNTTIC(,@14)                               06S0653 00631000
         MVC   RSID(2),ICTNTDAT(@14)                            06S0653 00632000
*                         CKPNRSID=(SAVTZELM&&'FFFF'X)&RSID;/* CLEAR    00633000
*                                      SUBAREA ADDR FROM THE RESOURCE   00634000
*                                      ID                            */ 00635000
@RC00648 DS    0H                                               06S0654 00636000
@RC00646 L     @14,AVTSAVTP(,RAVT)                              06S0654 00637000
         L     @12,@CF02807                                     06S0654 00638000
         LH    @14,SAVTZELM(,@14)                               06S0654 00639000
         N     @14,@CF02829                                     06S0654 00640000
         XR    @12,@14                                          06S0654 00641000
         SLR   @14,@14                                          06S0654 00642000
         ICM   @14,3,RSID                                       06S0654 00643000
         NR    @12,@14                                          06S0654 00644000
         STH   @12,CKPNRSID(,RCKPT)                             06S0654 00645000
*                       END;                                    06S0655 00646000
*                       RPARM=OFFSET;/* GET TNT OFFSET               */ 00647000
         LH    RPARM,OFFSET                                     05S0656 00648000
         N     RPARM,@CF02829                                   05S0656 00649000
*                       OCTRMTBL=RPARM;/* SAVE THE TNT OFFSET        */ 00650000
         STH   RPARM,OCTRMTBL(,ROPCE)                           05S0657 00651000
*                       CKPTTCIN=RPARM;/* SAVE THE TNT OFFSET        */ 00652000
         STH   RPARM,CKPTTCIN(,RCKPT)                           05S0658 00653000
*                       CALL IEDQTNT;/* GET TERMINAL ENTRY ADDR      */ 00654000
         L     @15,AVTRNMPT(,RAVT)                              05S0659 00655000
         BALR  @14,@15                                          05S0659 00656000
*                       CKPTRMAD=RPARM-PREFIXSZ;/* SAVE TERM ENTRY      00657000
*                                      PREFIX ADDR                   */ 00658000
         LR    @14,RPARM                                        05S0660 00659000
         SH    @14,PREFIXSZ                                     05S0660 00660000
         ST    @14,CKPTRMAD(,RCKPT)                             05S0660 00661000
*                       IF TRMCKPRN=ON/* DETERMINE WHICH RECORD TO      00662000
*                                      UPDATE                        */ 00663000
*                         THEN      /* UPDATE THE SECOND RECORD      */ 00664000
         TM    TRMCKPRN(@14),B'00000010'                        05S0661 00665000
         BNO   @RF00661                                         05S0661 00666000
*                         CKPNTRK=0;/* CLEAR ALTERNATE RECORD   05S0662 00667000
*                                      INDICATOR TO INDICATE THAT       00668000
*                                      FIRST RECORD IS TO BE READ FOR   00669000
*                                      INFO                          */ 00670000
         SLR   @14,@14                                          05S0662 00671000
         STH   @14,CKPNTRK(,RCKPT)                              05S0662 00672000
*                       ELSE        /* UPDATE FIRST RECORD           */ 00673000
*                         CKPNTRK=CKPTRKCN;/* SET ALTERNATE RECORD      00674000
*                                      INDICATOR TO INDICATE THAT       00675000
*                                      SECOND RECORD IS TO BE READ      00676000
*                                      FOR INFO                      */ 00677000
         B     @RC00661                                         05S0663 00678000
@RF00661 LH    @14,CKPTRKCN(,RCKPT)                             05S0663 00679000
         STH   @14,CKPNTRK(,RCKPT)                              05S0663 00680000
*                     END;                                      05S0664 00681000
*                 END;                                          05S0665 00682000
*               RFY                                             04S0666 00683000
*                 RPLMV UNRSTD;                                 04S0666 00684000
*               GOTO CE0001@;       /* BRANCH TO END OF CASE         */ 00685000
         B     CE0001@                                          04S0667 00686000
*             END ICHNGR;           /* END OF SUBCASE                */ 00687000
*CE0001@:                                                       03S0669 00688000
*           END;                    /* END OF CASE                   */ 00689000
CE0001@  DS    0H                                               03S0670 00690000
*                                                               04S0670 00691000
*           /*********************************************************/ 00692000
*           /*                                                       */ 00693000
*           /* PROCESS.READRETN.IO: THIS SEGMENT FINISHES THE        */ 00694000
*           /* INITIALIZATION TO UPDATE THE RESOURCE'S CHECKPOINT    */ 00695000
*           /* RECORD. IEDQNW IS CALLED TO ISSUE THE EXCP.           */ 00696000
*           /*                                                       */ 00697000
*           /*********************************************************/ 00698000
*                                                               04S0670 00699000
*           DO;                                                 04S0670 00700000
*             IF CKPCUSEL=CKPNOTFY /* TEST FOR FURTHER I/O REQUIRED */ 00701000
*               THEN                /* FURTHER I/O REQUIRED          */ 00702000
         CLI   CKPCUSEL(RCKPT),10                               04S0671 00703000
         BE    @RF00671                                         04S0671 00704000
*               DO;                                             04S0672 00705000
*                 IF CKPCUSEL=CKPICR/* TEST FOR TYPE OF COMMAND      */ 00706000
*                   THEN            /* REQUEST IS FOR A READ FOR        00707000
*                                      ICHNG                         */ 00708000
         CLI   CKPCUSEL(RCKPT),9                                04S0673 00709000
         BNE   @RF00673                                         04S0673 00710000
*                   CKPRWCMD=CKPREAD;/* SET COMMAND TO A READ        */ 00711000
         MVI   CKPRWCMD(RCKPT),X'06'                            04S0674 00712000
*                 ELSE              /* REQUEST FOR A WRITE           */ 00713000
*                   DO;                                         04S0675 00714000
         B     @RC00673                                         04S0675 00715000
@RF00673 DS    0H                                               04S0676 00716000
*                     CKPRWCMD=CKPWRITE;/* SET COMMAND CODE IN CCW TO   00717000
*                                      A WRITE                       */ 00718000
         MVI   CKPRWCMD(RCKPT),X'05'                            04S0676 00719000
*                     IF CKPNTRK=0  /* TEST FOR WHICH RECORD WAS READ   00720000
*                                      FOR THIS RESOURCE             */ 00721000
*                       THEN        /* FIRST RECORD WAS READ         */ 00722000
         LH    @14,CKPNTRK(,RCKPT)                              04S0677 00723000
         LTR   @14,@14                                          04S0677 00724000
         BNZ   @RF00677                                         04S0677 00725000
*                       CKPNTRK=CKPTRKCN;/* INDICATE THAT SECOND        00726000
*                                      RECORD IS TO BE UPDATED       */ 00727000
         LH    @14,CKPTRKCN(,RCKPT)                             04S0678 00728000
         STH   @14,CKPNTRK(,RCKPT)                              04S0678 00729000
*                     ELSE          /* SECOND RECORD WAS READ        */ 00730000
*                       CKPNTRK=0;  /* INDICATE THAT FIRST RECORD IS    00731000
*                                      TO BE UPDATED                 */ 00732000
         B     @RC00677                                         04S0679 00733000
@RF00677 SLR   @14,@14                                          04S0679 00734000
         STH   @14,CKPNTRK(,RCKPT)                              04S0679 00735000
*                     GEN NOREFS SETS(REG00,RPARM);             04S0680 00736000
@RC00677 DS    0H                                               04S0680 00737000
*                                   /*                                  00738000
                      TIME  ,          GET TIME AND DATE                00739000
*                     CNRDATE=RPARM;/* SET DATE IN RESOURCE RECORD   */ 00740000
         STCM  RPARM,15,CNRDATE(RCKPREC)                        04S0681 00741000
*                     CNRTIME=REG00;/* SET TIME IN RESOURCE RECORD   */ 00742000
         STCM  REG00,15,CNRTIME(RCKPREC)                        04S0682 00743000
*                     CNRTNTOF=OCTRMTBL;/* SET TNT OFFSET OF THE        00744000
*                                      RESOURCE                      */ 00745000
         LH    @14,OCTRMTBL(,ROPCE)                             04S0683 00746000
         N     @14,@CF02829                                     04S0683 00747000
         STH   @14,CNRTNTOF(,RCKPREC)                           04S0683 00748000
*                   END;                                        04S0684 00749000
*                 CALL IEDQNW;      /* CALL ROUTINE TO START I/O TO     00750000
*                                      THE CHECKPOINT DATA SET       */ 00751000
@RC00673 L     @15,CAVTCRIO(,RCAVT)                             04S0685 00752000
         BALR  @14,@15                                          04S0685 00753000
*                 IF REG15=0       /* TEST FOR I/O STARTED          */ 00754000
*                   THEN            /* I/O WAS NOT STARTED           */ 00755000
         LTR   REG15,REG15                                      04S0686 00756000
         BZ    @RF00686                                         04S0686 00757000
*                   DO;                                         04S0687 00758000
*                     CKPENCDE=REG15;/* SAVE ERROR RETURN CODE       */ 00759000
         STC   REG15,CKPENCDE(,RCKPT)                           04S0688 00760000
*                     CKPCUSEL=CKPNOTFY;/* SET SELECT VALUE TO  04S0689 00761000
*                                      INDICATE THAT NOTIFICATION IS    00762000
*                                      TO BE DONE                    */ 00763000
         MVI   CKPCUSEL(RCKPT),X'0A'                            04S0689 00764000
*                   END;                                        04S0690 00765000
*               END;                                            04S0691 00766000
@RF00686 DS    0H                                               04S0692 00767000
*           END;                                                04S0692 00768000
@RF00671 DS    0H                                               04S0693 00769000
*           RFY                                                 03S0693 00770000
*             RCKPREC UNRSTD;                                   03S0693 00771000
*         END;                                                  03S0694 00772000
*     ELSE                          /* I/O WAS UNSUCCESSFUL          */ 00773000
*       DO;                                                     02S0695 00774000
         B     @RC00513                                         02S0695 00775000
@RF00513 DS    0H                                               02S0696 00776000
*         CKPCUSEL=CKPNOTFY;        /* SET SELECT VALUE TO NOTIFY    */ 00777000
         MVI   CKPCUSEL(RCKPT),X'0A'                            02S0696 00778000
*         CKPENCDE=CKPIOERR;        /* SET I/O ERROR CODE            */ 00779000
         MVI   CKPENCDE(RCKPT),X'28'                            02S0697 00780000
*       END;                                                    02S0698 00781000
*   IF CKPCUSEL=CKPNOTFY            /* TEST FOR REQUEST FOR     02S0699 00782000
*                                      NOTIFICATION                  */ 00783000
*     THEN                          /* THIS IS A REQUEST FOR    02S0699 00784000
*                                      NOTIFICATION                  */ 00785000
@RC00513 DS    0H                                               02S0699 00786000
@RF00512 CLI   CKPCUSEL(RCKPT),10                               02S0699 00787000
         BNE   @RF00699                                         02S0699 00788000
*     DO;                                                       02S0700 00789000
*       IF CKPENCDE=0              /* TEST FOR ERROR DETECTED       */ 00790000
*         THEN                      /* ERROR WAS DETECTED            */ 00791000
         CLI   CKPENCDE(RCKPT),0                                02S0701 00792000
         BE    @RF00701                                         02S0701 00793000
*                                                               03S0702 00794000
*         /***********************************************************/ 00795000
*         /*                                                         */ 00796000
*         /* PROCESS.WRTMSG: THIS SEGMENT LOADS THE MESSAGE MODULE   */ 00797000
*         /* IEDNMG. THE ERROR CODE IN CKPENCDE IS USED AS AN OFFSET */ 00798000
*         /* INTO IEDNMG TO FIND THE POINTER TO THE DESIRED ERROR    */ 00799000
*         /* MESSAGE. THE DDNAME OF THE CHECKPOINT DATA SET IS       */ 00800000
*         /* OBTAINED FROM THE TIOT AND IS INSERTED INTO THE MESSAGE.*/ 00801000
*         /* A WTO IS ISSUED TO NOTIFY THE OPERATOR OF A CHECKPOINT  */ 00802000
*         /* ERROR.                                                  */ 00803000
*         /*                                                         */ 00804000
*         /***********************************************************/ 00805000
*                                                               03S0702 00806000
*         DO;                                                   03S0702 00807000
*           RFY                                                 03S0703 00808000
*             RTIOT RSTD;                                       03S0703 00809000
*           GEN REFS(IEDNMG) SETS(REG00,RPARM);                 03S0704 00810000
*                                   /*                                  00811000
            LOAD   EPLOC=IEDNMG        LOAD MESSAGE MODULE              00812000
*           RPARM=REG00+CKPENCDE;   /* GET ADDR OF THE POINTER TO THE   00813000
*                                      ERROR MESSAGE                 */ 00814000
         LR    RPARM,REG00                                      03S0705 00815000
         SLR   @14,@14                                          03S0705 00816000
         IC    @14,CKPENCDE(,RCKPT)                             03S0705 00817000
         ALR   RPARM,@14                                        03S0705 00818000
*           RPARM=MSGPTR;           /* GET ADDR OF THE MESSAGE       */ 00819000
         L     RPARM,MSGPTR(,RPARM)                             03S0706 00820000
*           RTIOT=TCBTIO+DCBTIOT;   /* GET ADDR OF THE TIOT ENTRY FOR   00821000
*                                      THE CKPT DATA SET             */ 00822000
         L     @14,AVTTCB(,RAVT)                                03S0707 00823000
         L     @12,DCBPTR-1(,RCKPT)                             03S0707 00824000
         LH    RTIOT,DCBTIOT+40(,@12)                           03S0707 00825000
         AL    RTIOT,TCBTIO(,@14)                               03S0707 00826000
*           MSGDDNAM=TIOEDDNM;      /* MOVE DDNAME FROM THE TIOT        00827000
*                                      ENTRY INTO THE MESSAGE        */ 00828000
         MVC   MSGDDNAM(8,RPARM),TIOEDDNM(RTIOT)                03S0708 00829000
*           IF CKPENCDE=CKPTOOBG    /* TEST MESSAGE REQUEST          */ 00830000
*             THEN                  /* REQUEST FOR 'DATA TOO BIG' MSG*/ 00831000
         CLI   CKPENCDE(RCKPT),12                               03S0709 00832000
         BNE   @RF00709                                         03S0709 00833000
*             DO;                                               03S0710 00834000
*               REG15=CKPDATCT+LENCNR;/* GET LENGTH OF CKPT DATA     */ 00835000
         LH    REG15,CKPDATCT(,RCKPT)                           03S0711 00836000
         AH    REG15,LENCNR                                     03S0711 00837000
*               CVD(REG15,CONVERT); /* CONVERT TO DECIMAL            */ 00838000
         CVD   REG15,CONVERT(,RCKPT)                            03S0712 00839000
*               UNPK(MSGNUMB,CONUNPK);/* UNPACK INTO THE MSG         */ 00840000
         UNPK  MSGNUMB(4,RPARM),CONUNPK(3,RCKPT)                03S0713 00841000
*               MSGZONE=MSGZONE|ZONE;/* PUT ZONE INTO THE LAST DIGIT */ 00842000
         OI    MSGZONE(RPARM),X'F0'                             03S0714 00843000
*             END;                                              03S0715 00844000
*           GEN REFS(RPARM) SETS(REG00);                        03S0716 00845000
@RF00709 DS    0H                                               03S0716 00846000
*                                   /*                                  00847000
            WTO    MF=(E,(1))          WRITE ERROR MESSAGE              00848000
            DELETE EPLOC=IEDNMG        DELETE MESSAGE MODULE            00849000
*           RFY                                                 03S0717 00850000
*             RTIOT UNRSTD;                                     03S0717 00851000
*         END;                                                  03S0718 00852000
*       ELSE                                                    02S0719 00853000
*         ;                         /* NO ERROR                      */ 00854000
@RF00701 DS    0H                                               02S0720 00855000
*                                                               03S0720 00856000
*       /*************************************************************/ 00857000
*       /*                                                           */ 00858000
*       /* PROCESS.NOTIF: THIS SEGMENT NOTIFIES OPERATOR CONTROL THAT*/ 00859000
*       /* THE CHECKPOINT REQUEST HAS COMPLETED.                     */ 00860000
*       /*                                                           */ 00861000
*       /*************************************************************/ 00862000
*                                                               03S0720 00863000
*       DO;                                                     03S0720 00864000
*                                                               04S0721 00865000
*         /***********************************************************/ 00866000
*         /*                                                         */ 00867000
*         /* PROCESS.NOTIF.FREEM: DETERMINE IF THERE IS AN AREA TO   */ 00868000
*         /* FREEMAIN BY CHECKING THE DATA ADDRESS OF THE CCW FOR A  */ 00869000
*         /* NON-ZERO ADDRESS OTHER THAT THE RESIDENT CONTROL RECORD */ 00870000
*         /* OF THE CHECKPOINT WORKAREA. FREE THE AREA IF FOUND. IF  */ 00871000
*         /* AN AREA WAS PRESENT TO FREE AND THE I/O FROM THE AREA   */ 00872000
*         /* WAS GOOD, THEN FLIP THE BIT THAT INDICATES WHICH RECORD */ 00873000
*         /* FOR THIS RESOURCE IS TO BE UPDATED NEXT.                */ 00874000
*         /*                                                         */ 00875000
*         /***********************************************************/ 00876000
*                                                               04S0721 00877000
*         DO;                                                   04S0721 00878000
*           IF CKPRWADD=ADDR(CKPNCNTL)&CKPRWADD=0/* TEST FOR AREA     00879000
*                                      TO FREEMAIN                   */ 00880000
*             THEN                  /* THERE IS AN AREA TO FREEMAIN  */ 00881000
         L     @14,CKPRWADD-1(,RCKPT)                           04S0722 00882000
         LA    @14,0(,@14)                                      04S0722 00883000
         LA    @12,CKPNCNTL(,RCKPT)                             04S0722 00884000
         CR    @14,@12                                          04S0722 00885000
         BE    @RF00722                                         04S0722 00886000
         LTR   @14,@14                                          04S0722 00887000
         BZ    @RF00722                                         04S0722 00888000
*             DO;                                               04S0723 00889000
*               GEN REFS(CKPGETML) SETS(RPARM);                 04S0724 00890000
*                                   /*                                  00891000
                FREEMAIN E,MF=(E,CKPGETML(,RCKPT))                      00892000
*               IF CKPENCDE=0       /* TEST FOR GOOD I/O PERFORMED   */ 00893000
*                 THEN              /* I/O WAS GOOD                  */ 00894000
         CLI   CKPENCDE(RCKPT),0                                04S0725 00895000
         BNE   @RF00725                                         04S0725 00896000
*                 IF TRMCKPRN=OFF   /* TEST FOR WHICH RECORD WAS        00897000
*                                      UPDATED                       */ 00898000
*                   THEN            /* FIRST WAS UPDATED             */ 00899000
         L     @14,CKPTRMAD(,RCKPT)                             04S0726 00900000
         TM    TRMCKPRN(@14),B'00000010'                        04S0726 00901000
         BNZ   @RF00726                                         04S0726 00902000
*                   TRMCKPRN=ON;    /* INDICATE THAT SECOND RECORD IS   00903000
*                                      TO BE UPDATED NEXT            */ 00904000
         OI    TRMCKPRN(@14),B'00000010'                        04S0727 00905000
*                 ELSE              /* SECOND WAS UPDATED            */ 00906000
*                   TRMCKPRN=OFF;   /* INDICATE THAT FIRST RECORD IS    00907000
*                                      TO BE UPDATED NEXT            */ 00908000
         B     @RC00726                                         04S0728 00909000
@RF00726 L     @14,CKPTRMAD(,RCKPT)                             04S0728 00910000
         NI    TRMCKPRN(@14),B'11111101'                        04S0728 00911000
*             END;                                              04S0729 00912000
@RC00726 DS    0H                                               04S0729 00913000
@RF00725 DS    0H                                               04S0730 00914000
*         END;                                                  04S0730 00915000
@RF00722 DS    0H                                               04S0731 00916000
*         CAVTEOL2=EOL;             /* RESET END OF WAIT LIST TO THE    00917000
*                                      3705 CKPT QUEUE               */ 00918000
         MVI   CAVTEOL2(RCAVT),X'80'                            03S0731 00919000
*         CAVTEOL3=0;               /* CLEAN UP WAIT LIST ENTRY ...  */ 00920000
         MVI   CAVTEOL3(RCAVT),X'00'                            03S0732 00921000
*         CAVTNIOE=0;               /* ... FOR 3705 CKPT IO ECB      */ 00922000
         SLR   @14,@14                                          03S0733 00923000
         STCM  @14,7,CAVTNIOE(RCAVT)                            03S0733 00924000
*         CAVTWTG=0;                /* CLEAR WHERE-TO-GO FIELD IN       00925000
*                                      CKPT AVT                      */ 00926000
         MVI   CAVTWTG(RCAVT),X'00'                             03S0734 00927000
*         CAVTNWA=0;                /* CLEAR POINTER TO THE CKPT        00928000
*                                      WORKAREA                      */ 00929000
         ST    @14,CAVTNWA(,RCAVT)                              03S0735 00930000
*         AVTCCPRI=PRICKPT;         /* SET PRIORITY                  */ 00931000
         MVI   AVTCCPRI(RAVT),X'EC'                             03S0736 00932000
*                                                               04S0737 00933000
*         /***********************************************************/ 00934000
*         /*                                                         */ 00935000
*         /* PROCESS.NOTIF.SETQUEUE: THIS SEGMENT QUEUES THE REQUEST */ 00936000
*         /* ELEMENT FOR RETURN TO OPERATOR CONTROL. IT TESTS FOR    */ 00937000
*         /* COMMANDS THAT NEED A TCAM CHECKPOINT AFTER THE 3705     */ 00938000
*         /* CHECKPOINT COMPLETES. IF THE COMMANDS NEEDS A TCAM      */ 00939000
*         /* CHECKPOINT, THEN THE REQUEST ELEMENT IS QUEUED TO TCAM  */ 00940000
*         /* CHECKPOINT.                                             */ 00941000
*         /*                                                         */ 00942000
*         /***********************************************************/ 00943000
*                                                               04S0737 00944000
*         DO;                                                   04S0737 00945000
*           AVTCCQCB=ADDR(AVTOPCQB);/* QUEUE REQUEST ELEMENT TO OP      00946000
*                                      CONTROL                       */ 00947000
         LA    @14,AVTOPCQB(,RAVT)                              04S0738 00948000
         STCM  @14,7,AVTCCQCB(RAVT)                             04S0738 00949000
*           IF AVTCKTAC=ON          /* TEST FOR PRESENCE OF TCAM CKPT*/ 00950000
*             THEN                  /* TCAM CKPT IS ACTIVE           */ 00951000
         TM    AVTCKTAC(RAVT),B'10000000'                       04S0739 00952000
         BNO   @RF00739                                         04S0739 00953000
*             IF(OCOPTCDE=OCMODIFY&OCSWITCH=OCACTVTE)|(OCOPTCDE=OCICHNG 00954000
*                 &OCICTYPE=OCICSID)/* TEST COMMAND TYPE            */ 00955000
*               THEN                /* THIS IS A ACTIVATE 3705 OR AN    00956000
*                                      ICHNG (NOT SWITCH ID LINE)    */ 00957000
         CLI   OCOPTCDE(ROPCE),X'44'                            04S0740 00958000
         BNE   @GL00003                                         04S0740 00959000
         CLI   OCSWITCH(ROPCE),X'22'                            04S0740 00960000
         BE    @RT00740                                         04S0740 00961000
@GL00003 CLI   OCOPTCDE(ROPCE),X'49'                            04S0740 00962000
         BNE   @RF00740                                         04S0740 00963000
         CLI   OCICTYPE(ROPCE),0                                04S0740 00964000
         BE    @RF00740                                         04S0740 00965000
@RT00740 DS    0H                                               04S0741 00966000
*               DO;                                             04S0741 00967000
*                 AVTCCQCB=ADDR(AVTCKPQB);/* QUEUE REQUEST ELEMENT TO   00968000
*                                      THE TCAM CKPT QUEUE TO REQUEST   00969000
*                                      FURTHER CKPT PROCESSING       */ 00970000
         LA    @14,AVTCKPQB(,RAVT)                              04S0742 00971000
         STCM  @14,7,AVTCCQCB(RAVT)                             04S0742 00972000
*                 AVTCCKEY=CREOPC;  /* SET KEY FOR INCIDENT CKPT     */ 00973000
         MVI   AVTCCKEY(RAVT),X'40'                             04S0743 00974000
*               END;                                            04S0744 00975000
*         END;                                                  04S0745 00976000
@RF00740 DS    0H                                               04S0745 00977000
@RF00739 DS    0H                                               04S0746 00978000
*         RPARM=ADDR(AVTCCELE);     /* GET ADDRESS OF THE REQUEST       00979000
*                                      ELEMENT                       */ 00980000
         LA    RPARM,AVTCCELE(,RAVT)                            03S0746 00981000
*         REG15=CVTAQAVT;           /* GET ADDRESS OF THE TCX        */ 00982000
         L     @12,CVTPTR                                       03S0747 00983000
         L     REG15,CVTAQAVT(,@12)                             03S0747 00984000
*         REG00=TCXREADY;           /* GET ADDR OF TOP ELEMENT ON       00985000
*                                      ASYNCHRONOUS READY QUEUE      */ 00986000
         L     REG00,TCXREADY(,REG15)                           03S0748 00987000
*AGAIN:                                                         03S0749 00988000
*         AVTCCLNK=REG00;           /* LINK REQUEST ELEMENT TO TOP ON   00989000
*                                      THE QUEUE                     */ 00990000
AGAIN    STCM  REG00,7,AVTCCLNK(RAVT)                           03S0749 00991000
*         CS(REG00,RPARM,TCXREADY); /* UPDATE ASYNCHRONOUS READY        00992000
*                                      QUEUE                         */ 00993000
         CS    REG00,@01,TCXREADY(REG15)                        03S0750 00994000
*         BC(7,AGAIN);              /* IF QUEUE WAS UPDATED     03S0751 00995000
*                                      ASYNCHRONOUSLY, TRY AGAIN     */ 00996000
         BC    7,AGAIN                                          03S0751 00997000
*         GEN REFS(AVTOSECB) SETS(REG00,RPARM);                 03S0752 00998000
*                                  /*                                   00999000
         POST  AVTOSECB(,RAVT)        POST TCAM'S MCP'S ECB COMPLETE    01000000
*       END;                                                    03S0753 01001000
*     END;                                                      02S0754 01002000
*   ELSE                            /* NOT REQUEST FOR NOTIFICATION  */ 01003000
*     MVC(CKPSLVAL,CKPSLNEW);       /* SHIFT 'SELECT' VALUES FOR NEXT   01004000
*                                      PATH SELECTION                */ 01005000
         B     @RC00699                                         02S0755 01006000
@RF00699 MVC   CKPSLVAL(3,RCKPT),CKPSLNEW(RCKPT)                02S0755 01007000
*                                                               02S0756 01008000
*   /*****************************************************************/ 01009000
*   /*                                                               */ 01010000
*   /* EPILOGUE: THIS SEGMENT COMPLETES THE EPILOGUE CODE THAT WAS   */ 01011000
*   /* ALTERED BY THE MODULE PROCEDURE STATEMENT.                    */ 01012000
*   /*                                                               */ 01013000
*   /*****************************************************************/ 01014000
*                                                               02S0756 01015000
*   RFY                                                         02S0756 01016000
*    (REG2,                                                     02S0756 01017000
*     REG12,                                                    02S0756 01018000
*     REG14) RSTD;                                              02S0756 01019000
@RC00699 DS    0H                                               02S0757 01020000
*   REG2=CAVTTCWA;                  /* RESTORE ADDRESS OF TCAM  02S0757 01021000
*                                      CHECKPOINT WORKAREA           */ 01022000
         L     REG2,CAVTTCWA(,RCAVT)                            02S0757 01023000
*   REG12=CKPSAVE2(1);              /* RESTORE IEDQNF'S BASE REGISTER*/ 01024000
         L     REG12,CKPSAVE2(,RCKPT)                           02S0758 01025000
*   REG14=CKPSAVE2(2)+CKPRETNL;     /* RESTORE RETURN ADDRESS + 4       01026000
*                                      (WHICH INDICATES THAT NO OTHER   01027000
*                                      MODULE IS TO BE LOADED        */ 01028000
         LA    REG14,4                                          02S0759 01029000
         AL    REG14,CKPSAVE2+4(,RCKPT)                         02S0759 01030000
*   RFY                                                         02S0760 01031000
*    (REG2,                                                     02S0760 01032000
*     REG12,                                                    02S0760 01033000
*     REG14) UNRSTD;                                            02S0760 01034000
*                                                               02S0761 01035000
*   /*****************************************************************/ 01036000
*   /*                                                               */ 01037000
*   /* TNTMOVE: THIS SUBROUTINE MOVES A TNT OFFSET AND STATUS BYTE   */ 01038000
*   /* POINTED TO BY CKPTNTPT INTO DATA AREA OFSENTRY AND EXITS WITH */ 01039000
*   /* CKPTNTPT POINTING TO THE NEXT TNT OFFSET. IT ALSO DECREMENTS  */ 01040000
*   /* CKPTNTNB (THE NUMBER OF TNT/DEVICE ENTRIES LEFT TO SCAN).     */ 01041000
*   /*                                                               */ 01042000
*   /*****************************************************************/ 01043000
*                                                               02S0761 01044000
*TNTMOVE:                                                       02S0761 01045000
*   PROC OPTIONS(RETREG,SAVE(14));                              02S0761 01046000
@EL00001 DS    0H                                               02S0761 01047000
@EF00001 DS    0H                                               02S0761 01048000
@ER00001 BR    @14                                              02S0761 01049000
TNTMOVE  ST    @14,12(,@13)                                     02S0761 01050000
*   RFY                                                         02S0762 01051000
*     RPLMV RSTD;                                               02S0762 01052000
*   CKPTNTNB=CKPTNTNB-1;            /* DECREMENT THE NUMBER OF DEVICE   01053000
*                                      RECORDS LEFT                  */ 01054000
         LH    @14,CKPTNTNB(,RCKPT)                             02S0763 01055000
         BCTR  @14,0                                            02S0763 01056000
         STH   @14,CKPTNTNB(,RCKPT)                             02S0763 01057000
*   RPARM=ADDR(OFSENTRY);           /* SET POINTER TO TARGET OF TNT     01058000
*                                      MOVE                          */ 01059000
         LA    RPARM,OFSENTRY                                   02S0764 01060000
*   REG00=LENGTH(ICTNTOFF);         /* SET LENGTH OF TNT OFFSET ENTRY*/ 01061000
         LA    REG00,3                                          02S0765 01062000
*   REG15=CKPTNTLN;                 /* SET LENGTH OF TNT DATA IN THIS   01063000
*                                      UNIT                          */ 01064000
         LH    REG15,CKPTNTLN(,RCKPT)                           02S0766 01065000
*   IF REG15>REG00                  /* TEST FOR MORE DATA THAN IS       01066000
*                                      NEEDED                        */ 01067000
*     THEN                          /* THERE IS MORE DATA IN THIS       01068000
*                                      UNIT THAN IS NEEDED           */ 01069000
         CR    REG15,REG00                                      02S0767 01070000
         BNH   @RF00767                                         02S0767 01071000
*     REG15=REG00;                  /* RESET LENGTH TO TO TOTAL 02S0768 01072000
*                                      LENGTH OF THE DATA            */ 01073000
         LR    REG15,REG00                                      02S0768 01074000
*   DO UNTIL REG15=0;               /* MOVE THE TNT DATA             */ 01075000
@RF00767 DS    0H                                               02S0769 01076000
@DL00769 DS    0H                                               02S0770 01077000
*     RPARM->MOVECHAR(1:REG15)=CKPTNTPT->MOVECHAR(1:REG15);/* MOVE      01078000
*                                      TNT DATA FROM THE UNIT TO THE    01079000
*                                      WORKAREA                      */ 01080000
         LR    @14,REG15                                        02S0770 01081000
         BCTR  @14,0                                            02S0770 01082000
         L     @12,CKPTNTPT(,RCKPT)                             02S0770 01083000
         EX    @14,@SM02830                                     02S0770 01084000
*     CKPTNTPT=CKPTNTPT+REG15;      /* POINT TO NEXT AVIALABLE DATA  */ 01085000
         ALR   @12,REG15                                        02S0771 01086000
         ST    @12,CKPTNTPT(,RCKPT)                             02S0771 01087000
*     RPARM=RPARM+REG15;            /* BUMP TO NEXT TARGET BYTE IN      01088000
*                                      WORKAREA                      */ 01089000
         ALR   RPARM,REG15                                      02S0772 01090000
*     CKPTNTLN=CKPTNTLN-REG15;      /* DECREMENT DATA LEFT IN THIS      01091000
*                                      UNIT                          */ 01092000
         LH    @14,CKPTNTLN(,RCKPT)                             02S0773 01093000
         SLR   @14,REG15                                        02S0773 01094000
         STH   @14,CKPTNTLN(,RCKPT)                             02S0773 01095000
*     IF CKPTNTLN<=0                /* TEST FOR MORE DATA IN THIS       01096000
*                                      UNIT                          */ 01097000
*       THEN                        /* NO MORE DATA IN THIS UNIT     */ 01098000
         LTR   @14,@14                                          02S0774 01099000
         BP    @RF00774                                         02S0774 01100000
*       DO;                                                     02S0775 01101000
*         CKPTNTUN=ICTNTTIC;        /* POINT TO NEXT UNIT            */ 01102000
         L     @14,CKPTNTUN(,RCKPT)                             02S0776 01103000
         L     @14,ICTNTTIC(,@14)                               02S0776 01104000
         ST    @14,CKPTNTUN(,RCKPT)                             02S0776 01105000
*         CKPTNTPT=ADDR(ICTNTDAT);  /* POINT TO DATA IN NEXT UNIT    */ 01106000
         LA    @14,ICTNTDAT(,@14)                               02S0777 01107000
         ST    @14,CKPTNTPT(,RCKPT)                             02S0777 01108000
*         CKPTNTLN=AVTKEYLE;        /* SET LENGTH OF DATA IN THIS       01109000
*                                      UNIT                          */ 01110000
         LH    @14,AVTKEYLE(,RAVT)                              02S0778 01111000
         STH   @14,CKPTNTLN(,RCKPT)                             02S0778 01112000
*       END;                                                    02S0779 01113000
*     REG00=REG00-REG15;            /* SET DATA LEFT TO BE MOVED     */ 01114000
@RF00774 SLR   REG00,REG15                                      02S0780 01115000
*     REG15=REG00;                  /* SET LENGTH FOR NEXT MOVE      */ 01116000
         LR    REG15,REG00                                      02S0781 01117000
*   END;                                                        02S0782 01118000
@DE00769 LTR   REG15,REG15                                      02S0782 01119000
         BNZ   @DL00769                                         02S0782 01120000
*   RFY                                                         02S0783 01121000
*     RPLMV UNRSTD;                                             02S0783 01122000
*   END TNTMOVE;                                                02S0784 01123000
@EL00002 DS    0H                                               02S0784 01124000
@EF00002 DS    0H                                               02S0784 01125000
@ER00002 L     @14,12(,@13)                                     02S0784 01126000
         BR    @14                                              02S0784 01127000
*   END IEDQNU                                                  01S0785 01128000
*                                                               01S0785 01129000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01130000
*/*%INCLUDE SYSLIB  (TAVTD   )                                       */ 01131000
*/*%INCLUDE SYSLIB  (TBDUD   )                                       */ 01132000
*/*%INCLUDE SYSLIB  (TCAVTD  )                                       */ 01133000
*/*%INCLUDE SYSLIB  (TCD0D   )                                       */ 01134000
*/*%INCLUDE SYSLIB  (TCKPD   )                                       */ 01135000
*/*%INCLUDE SYSLIB  (TCNRD   )                                       */ 01136000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 01137000
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */ 01138000
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */ 01139000
*/*%INCLUDE SYSLIB  (TOPCED  )                                       */ 01140000
*/*%INCLUDE SYSLIB  (TOPCAVTD)                                       */ 01141000
*/*%INCLUDE SYSLIB  (TPLMVD  )                                       */ 01142000
*/*%INCLUDE SYSLIB  (TPRIOR  )                                       */ 01143000
*/*%INCLUDE SYSLIB  (TPRUD   )                                       */ 01144000
*/*%INCLUDE SYSLIB  (TTCXD   )                                       */ 01145000
*/*%INCLUDE SYSLIB  (TTRMD   )                                       */ 01146000
*/*%INCLUDE SYSUT5  (RFY     )                                       */ 01147000
*/*%INCLUDE SYSUT5  (DCL     )                                       */ 01148000
*/*%INCLUDE SYSUT5  (PROLOGUE)                                       */ 01149000
*/*%INCLUDE SYSUT5  (PROCESS )                                       */ 01150000
*/*%INCLUDE SYSUT5  (READRETN)                                       */ 01151000
*/*%INCLUDE SYSUT5  (BHSET   )                                       */ 01152000
*/*%INCLUDE SYSUT5  (SSPAU   )                                       */ 01153000
*/*%INCLUDE SYSUT5  (NEGPL   )                                       */ 01154000
*/*%INCLUDE SYSUT5  (CSLIM   )                                       */ 01155000
*/*%INCLUDE SYSUT5  (CTLIM   )                                       */ 01156000
*/*%INCLUDE SYSUT5  (MSSEL   )                                       */ 01157000
*/*%INCLUDE SYSUT5  (ICHNGW  )                                       */ 01158000
*/*%INCLUDE SYSUT5  (INITBDU )                                       */ 01159000
*/*%INCLUDE SYSUT5  (TCHNG   )                                       */ 01160000
*/*%INCLUDE SYSUT5  (ICHNGR  )                                       */ 01161000
*/*%INCLUDE SYSUT5  (FINDNEXT)                                       */ 01162000
*/*%INCLUDE SYSUT5  (READINIT)                                       */ 01163000
*/*%INCLUDE SYSUT5  (SETRSID )                                       */ 01164000
*/*%INCLUDE SYSUT5  (IO      )                                       */ 01165000
*/*%INCLUDE SYSUT5  (WRTMSG  )                                       */ 01166000
*/*%INCLUDE SYSUT5  (NOTIF   )                                       */ 01167000
*/*%INCLUDE SYSUT5  (FREEM   )                                       */ 01168000
*/*%INCLUDE SYSUT5  (SETQUEUE)                                       */ 01169000
*/*%INCLUDE SYSUT5  (EPILOGUE)                                       */ 01170000
*/*%INCLUDE SYSUT5  (TNTMOVE )                                       */ 01171000
*                                                               01S0785 01172000
*       ;                                                       01S0785 01173000
@DATA    DS    0H                                                       01174000
@SM02830 MVC   MOVECHAR(0,RPARM),MOVECHAR(@12)                          01175000
         DS    0F                                                       01176000
         DS    0F                                                       01177000
@CF00239 DC    F'12'                                                    01178000
@CF02829 DC    XL4'0000FFFF'                                            01179000
@CF02807 DC    XL4'FFFF'                                                01180000
         DS    0D                                                       01181000
PREFIXSZ DC    AL2(14)                                                  01182000
LENCNR   DC    AL2(CNRDVBDU-IEDQCNRD)                                   01183000
         DS    CL4                                                      01184000
IEDNMG   DC    CL8'IEDNMG'                                              01185000
OFSENTRY DS    CL3                                                      01186000
         ORG   OFSENTRY                                                 01187000
OFFSET   DS    FL2                                                      01188000
OFSTATUS DS    FL1                                                      01189000
         ORG   OFSENTRY+3                                               01190000
SELNOTFY DS    CL3                                                      01191000
         ORG   SELNOTFY                                                 01192000
@NM00187 DC    X'07'                                                    01193000
@NM00188 DC    X'0A'                                                    01194000
@NM00189 DC    X'00'                                                    01195000
         ORG   SELNOTFY+3                                               01196000
SELREAD  DS    CL3                                                      01197000
         ORG   SELREAD                                                  01198000
@NM00190 DC    X'07'                                                    01199000
@NM00191 DC    X'09'                                                    01200000
@NM00192 DC    X'07'                                                    01201000
         ORG   SELREAD+3                                                01202000
RSID     DS    CL2                                                      01203000
         ORG   RSID                                                     01204000
RSID1    DS    CL1                                                      01205000
RSID2    DS    CL1                                                      01206000
         ORG   RSID+2                                                   01207000
         DS    CL1                                                      01208000
CP0001@  DC    AL4(BHSET)                                               01209000
         DC    AL4(SSPAU)                                               01210000
         DC    AL4(NEGPL)                                               01211000
         DC    AL4(CSLIM)                                               01212000
         DC    AL4(CTLIM)                                               01213000
         DC    AL4(MSSEL)                                               01214000
         DC    AL4(ICHNGW)                                              01215000
         DC    AL4(TCHNG)                                               01216000
         DC    AL4(ICHNGR)                                              01217000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01218000
@01      EQU   01                                                       01219000
@02      EQU   02                                                       01220000
@03      EQU   03                                                       01221000
@04      EQU   04                                                       01222000
@05      EQU   05                                                       01223000
@06      EQU   06                                                       01224000
@07      EQU   07                                                       01225000
@08      EQU   08                                                       01226000
@09      EQU   09                                                       01227000
@10      EQU   10                                                       01228000
@11      EQU   11                                                       01229000
@12      EQU   12                                                       01230000
@13      EQU   13                                                       01231000
@14      EQU   14                                                       01232000
@15      EQU   15                                                       01233000
RCAVT    EQU   @05                                                      01234000
RCKPT    EQU   @04                                                      01235000
RCKPREC  EQU   @10                                                      01236000
ROPCE    EQU   @03                                                      01237000
RPLMV    EQU   @08                                                      01238000
RAVT     EQU   @09                                                      01239000
REG15    EQU   @15                                                      01240000
REG00    EQU   @00                                                      01241000
RPARM    EQU   @01                                                      01242000
REG2     EQU   @02                                                      01243000
RTIOT    EQU   @07                                                      01244000
RBASE    EQU   @11                                                      01245000
REG12    EQU   @12                                                      01246000
RSAVE    EQU   @13                                                      01247000
REG14    EQU   @14                                                      01248000
CVTPTR   EQU   16                                                       01249000
IEDQAVTD EQU   0                                                        01250000
AVTSAVEX EQU   IEDQAVTD+288                                             01251000
AVTTCB   EQU   IEDQAVTD+368                                             01252000
@NM00003 EQU   IEDQAVTD+388                                             01253000
AVTCKFLG EQU   @NM00003                                                 01254000
AVTCKTAC EQU   AVTCKFLG                                                 01255000
AVTCKAVT EQU   @NM00003+1                                               01256000
AVTOCGET EQU   IEDQAVTD+392                                             01257000
AVTBASE  EQU   IEDQAVTD+412                                             01258000
AVTPKF   EQU   AVTBASE                                                  01259000
AVTRNMPT EQU   IEDQAVTD+424                                             01260000
AVTOSECB EQU   IEDQAVTD+492                                             01261000
AVTECB1  EQU   AVTOSECB                                                 01262000
AVTHG02  EQU   IEDQAVTD+528                                             01263000
AVTDISP  EQU   IEDQAVTD+552                                             01264000
AVTHD    EQU   IEDQAVTD+556                                             01265000
AVTSCOPT EQU   AVTHD                                                    01266000
AVTSAVTP EQU   IEDQAVTD+612                                             01267000
AVTSAVTF EQU   AVTSAVTP                                                 01268000
AVTCKPEL EQU   IEDQAVTD+652                                             01269000
AVTCKRMV EQU   AVTCKPEL                                                 01270000
AVTCKELF EQU   IEDQAVTD+680                                             01271000
AVTCKBYT EQU   IEDQAVTD+691                                             01272000
AVTHG01  EQU   IEDQAVTD+692                                             01273000
AVTCKLNK EQU   IEDQAVTD+696                                             01274000
AVTCRELE EQU   IEDQAVTD+708                                             01275000
AVTCCELE EQU   AVTCRELE                                                 01276000
AVTCCKEY EQU   AVTCCELE                                                 01277000
AVTCCQCB EQU   AVTCCELE+1                                               01278000
AVTCCPRI EQU   AVTCRELE+4                                               01279000
AVTCCLNK EQU   AVTCRELE+5                                               01280000
AVTCLRHI EQU   IEDQAVTD+716                                             01281000
AVTADBUF EQU   IEDQAVTD+720                                             01282000
AVTSYSER EQU   IEDQAVTD+728                                             01283000
AVTCKPQB EQU   IEDQAVTD+804                                             01284000
AVTCKPTB EQU   AVTCKPQB                                                 01285000
AVTCKPEC EQU   AVTCKPQB+4                                               01286000
AVTCKPCC EQU   AVTCKPEC                                                 01287000
AVTOPCQB EQU   IEDQAVTD+816                                             01288000
AVTOPCOB EQU   AVTOPCQB                                                 01289000
AVTOPCEC EQU   AVTOPCQB+4                                               01290000
AVTOPCCC EQU   AVTOPCEC                                                 01291000
AVTOLTQB EQU   IEDQAVTD+828                                             01292000
AVTCWFL1 EQU   IEDQAVTD+924                                             01293000
AVTCWFL2 EQU   IEDQAVTD+925                                             01294000
AVTSUBT  EQU   IEDQAVTD+948                                             01295000
AVTIOTR  EQU   IEDQAVTD+949                                             01296000
AVTKEYLE EQU   IEDQAVTD+1032                                            01297000
AVTBIT1  EQU   IEDQAVTD+1050                                            01298000
AVTBIT2  EQU   IEDQAVTD+1051                                            01299000
AVTBIT3  EQU   IEDQAVTD+1052                                            01300000
AVTBIT4  EQU   IEDQAVTD+1136                                            01301000
@NM00085 EQU   IEDQAVTD+1232                                            01302000
IEDQAPTR EQU   0                                                        01303000
IEDNSVTD EQU   0                                                        01304000
SAVTDIAG EQU   IEDNSVTD                                                 01305000
SAVTDIAF EQU   SAVTDIAG                                                 01306000
SAVTLUSQ EQU   IEDNSVTD+88                                              01307000
SAVTMVBF EQU   IEDNSVTD+160                                             01308000
SAVTTCPU EQU   IEDNSVTD+238                                             01309000
SAVTZELM EQU   IEDNSVTD+270                                             01310000
SAVTRDRV EQU   IEDNSVTD+284                                             01311000
SAVTCKQB EQU   IEDNSVTD+300                                             01312000
SAVTCKTB EQU   SAVTCKQB                                                 01313000
SAVTCKEC EQU   SAVTCKQB+4                                               01314000
SAVTCKCC EQU   SAVTCKEC                                                 01315000
IEDBDU   EQU   0                                                        01316000
BDUCMND  EQU   IEDBDU                                                   01317000
BDUMODIF EQU   IEDBDU+1                                                 01318000
BDUFNFLG EQU   IEDBDU+2                                                 01319000
BDUHEADR EQU   BDUFNFLG                                                 01320000
BDUBDUFG EQU   IEDBDU+3                                                 01321000
BDURSP   EQU   IEDBDU+4                                                 01322000
BDUSYRSP EQU   BDURSP                                                   01323000
BDUEXRSP EQU   BDURSP+1                                                 01324000
BDUEND   EQU   IEDBDU+6                                                 01325000
IEDQCKAD EQU   0                                                        01326000
CAVTTCWA EQU   IEDQCKAD                                                 01327000
CAVTNWA  EQU   IEDQCKAD+4                                               01328000
CAVTWTG  EQU   IEDQCKAD+8                                               01329000
CAVTWL1  EQU   IEDQCKAD+12                                              01330000
CAVTWL2  EQU   CAVTWL1+8                                                01331000
CAVTEOL2 EQU   CAVTWL2                                                  01332000
CAVTEOL3 EQU   CAVTWL2+4                                                01333000
CAVTNIOE EQU   CAVTWL2+5                                                01334000
CAVTCRIO EQU   IEDQCKAD+28                                              01335000
IEDQCKPD EQU   0                                                        01336000
CKPSAVE1 EQU   IEDQCKPD                                                 01337000
CKPIOB   EQU   IEDQCKPD+72                                              01338000
CKPIOECB EQU   CKPIOB+4                                                 01339000
CKPIOECC EQU   CKPIOECB                                                 01340000
CKPIODCB EQU   CKPIOB+21                                                01341000
CKPIOSK  EQU   CKPIOB+32                                                01342000
CKPEXCP  EQU   IEDQCKPD+116                                             01343000
CKPECBL  EQU   IEDQCKPD+120                                             01344000
CKPCNVRT EQU   CKPECBL                                                  01345000
CKPIOQL  EQU   IEDQCKPD+132                                             01346000
@NM00109 EQU   CKPIOQL                                                  01347000
CKPCTTRB EQU   IEDQCKPD+144                                             01348000
CKPCCWS  EQU   IEDQCKPD+168                                             01349000
CKPTIC   EQU   CKPCCWS+24                                               01350000
CKPRW    EQU   CKPCCWS+32                                               01351000
CKPRWCMD EQU   CKPRW                                                    01352000
CKPRWADD EQU   CKPRW+1                                                  01353000
@NM00112 EQU   IEDQCKPD+208                                             01354000
CKPGETML EQU   @NM00112                                                 01355000
CKPMSG   EQU   IEDQCKPD+220                                             01356000
CKPMSGTX EQU   CKPMSG+4                                                 01357000
CKPMSGTP EQU   CKPMSG+41                                                01358000
CKPCNTLR EQU   IEDQCKPD+288                                             01359000
CKPFLAGS EQU   CKPCNTLR                                                 01360000
CKPPRQNO EQU   CKPCNTLR+17                                              01361000
IEDQCDRD EQU   0                                                        01362000
CDRTTRLI EQU   IEDQCDRD+9                                               01363000
CDRDATA  EQU   IEDQCDRD+12                                              01364000
IEDQCRED EQU   0                                                        01365000
CRELINK  EQU   IEDQCRED+4                                               01366000
CREOFFS  EQU   IEDQCRED+12                                              01367000
CKPREQTB EQU   0                                                        01368000
CKPCTFLG EQU   CKPREQTB                                                 01369000
CKPNRES  EQU   0                                                        01370000
CKPNFLG  EQU   CKPNRES+4                                                01371000
CKPAVT   EQU   0                                                        01372000
IEDQCNRD EQU   0                                                        01373000
CNRTNTOF EQU   IEDQCNRD                                                 01374000
CNRDATTM EQU   IEDQCNRD+2                                               01375000
CNRDATE  EQU   CNRDATTM                                                 01376000
CNRTIME  EQU   CNRDATTM+4                                               01377000
CNRCNTL  EQU   IEDQCNRD+10                                              01378000
CNRFBHS  EQU   CNRCNTL                                                  01379000
CNRFBHSC EQU   CNRCNTL                                                  01380000
CNRFSSP  EQU   CNRCNTL                                                  01381000
CNRFNPL  EQU   CNRCNTL                                                  01382000
CNRFCSL  EQU   CNRCNTL                                                  01383000
CNRFCTL  EQU   CNRCNTL                                                  01384000
CNRFMSS  EQU   CNRCNTL                                                  01385000
CNRFRDR  EQU   CNRCNTL                                                  01386000
CNRBHSET EQU   IEDQCNRD+12                                              01387000
CNRBHFUN EQU   CNRBHSET                                                 01388000
CNRBHPOS EQU   CNRBHSET+1                                               01389000
CNRSSPAU EQU   IEDQCNRD+14                                              01390000
CNRNEGPL EQU   IEDQCNRD+15                                              01391000
CNRCSLIM EQU   IEDQCNRD+16                                              01392000
CNRCTLIM EQU   IEDQCNRD+17                                              01393000
CNRMSSEL EQU   IEDQCNRD+18                                              01394000
CNRDEVRC EQU   IEDQCNRD+19                                              01395000
CVTMAP   EQU   0                                                        01396000
CVTDAR   EQU   CVTMAP+72                                                01397000
CVTFLGS1 EQU   CVTDAR                                                   01398000
CVTDCB   EQU   CVTMAP+116                                               01399000
CVTIERLC EQU   CVTMAP+144                                               01400000
CVTOPTA  EQU   CVTMAP+182                                               01401000
CVTOPTB  EQU   CVTMAP+183                                               01402000
CVTGTF   EQU   CVTMAP+236                                               01403000
CVTGTFST EQU   CVTGTF                                                   01404000
CVTGTFS  EQU   CVTGTFST                                                 01405000
CVTSTATE EQU   CVTGTFST                                                 01406000
CVTTMODE EQU   CVTGTFST                                                 01407000
CVTFORM  EQU   CVTGTFST                                                 01408000
CVTAQAVT EQU   CVTMAP+240                                               01409000
CVTTCMFG EQU   CVTAQAVT                                                 01410000
CVTVOLM2 EQU   CVTMAP+244                                               01411000
CVTTATA  EQU   CVTVOLM2                                                 01412000
CVTTSKS  EQU   CVTTATA                                                  01413000
CVTVOLF2 EQU   CVTTSKS                                                  01414000
CVTTAT   EQU   CVTTATA+1                                                01415000
CVTATER  EQU   CVTMAP+248                                               01416000
CVTEXT1  EQU   CVTMAP+252                                               01417000
CVTPURG  EQU   CVTMAP+260                                               01418000
CVTQMSG  EQU   CVTMAP+268                                               01419000
CVTDMSR  EQU   CVTMAP+272                                               01420000
CVTRSV37 EQU   CVTDMSR                                                  01421000
CVTDMSRF EQU   CVTRSV37                                                 01422000
CVTERPV  EQU   CVTMAP+316                                               01423000
CVTINTLA EQU   CVTMAP+320                                               01424000
CVTAPF   EQU   CVTMAP+324                                               01425000
CVTEXT2  EQU   CVTMAP+328                                               01426000
CVTHJES  EQU   CVTMAP+332                                               01427000
CVTPGSIA EQU   CVTMAP+348                                               01428000
CVTA1F1  EQU   CVTMAP+356                                               01429000
CVTSYSK  EQU   CVTMAP+357                                               01430000
CVTVOLM1 EQU   CVTMAP+380                                               01431000
CVTVOLF1 EQU   CVTVOLM1                                                 01432000
CVTATMCT EQU   CVTMAP+388                                               01433000
CVTXTNT1 EQU   0                                                        01434000
CVTXTNT2 EQU   0                                                        01435000
CVTDSSV  EQU   CVTXTNT2                                                 01436000
CVTFLGBT EQU   CVTXTNT2+5                                               01437000
CVTQID   EQU   CVTXTNT2+24                                              01438000
CVTSHS   EQU   CVTXTNT2+40                                              01439000
CVTRV400 EQU   CVTXTNT2+52                                              01440000
CVTRV409 EQU   CVTXTNT2+53                                              01441000
CVTATCVT EQU   CVTXTNT2+64                                              01442000
CVTRV429 EQU   CVTXTNT2+84                                              01443000
CVTRV438 EQU   CVTXTNT2+85                                              01444000
CVTRV457 EQU   CVTXTNT2+112                                             01445000
CVTRV466 EQU   CVTXTNT2+113                                             01446000
CVTFIX   EQU   0                                                        01447000
CVTRELNO EQU   CVTFIX+252                                               01448000
IHADCB   EQU   0                                                        01449000
IHADCS1A EQU   0                                                        01450000
DCBBCKUP EQU   IHADCS1A+8                                               01451000
IHADCS2K EQU   0                                                        01452000
DCBDUMPD EQU   IHADCS2K                                                 01453000
DCBTRSTA EQU   IHADCS2K+5                                               01454000
DCBDSORG EQU   IHADCS2K+6                                               01455000
DCBDSRG2 EQU   DCBDSORG+1                                               01456000
DCBRNCKD EQU   IHADCS2K+12                                              01457000
DCBEXLST EQU   IHADCS2K+16                                              01458000
IHADCS24 EQU   0                                                        01459000
DCBOFLGS EQU   IHADCS24+8                                               01460000
DCBOFLWR EQU   DCBOFLGS                                                 01461000
DCBIFLG  EQU   IHADCS24+9                                               01462000
DCBIBPCT EQU   DCBIFLG                                                  01463000
DCBMACR  EQU   IHADCS24+10                                              01464000
DCBMACR1 EQU   DCBMACR                                                  01465000
DCBMRFE  EQU   DCBMACR1                                                 01466000
DCBMRGET EQU   DCBMRFE                                                  01467000
DCBMRAPG EQU   DCBMACR1                                                 01468000
DCBMRRD  EQU   DCBMRAPG                                                 01469000
DCBMRCI  EQU   DCBMACR1                                                 01470000
DCBMRMVG EQU   DCBMRCI                                                  01471000
DCBMRLCG EQU   DCBMACR1                                                 01472000
DCBMRABC EQU   DCBMACR1                                                 01473000
DCBMRPT1 EQU   DCBMRABC                                                 01474000
DCBMRSBG EQU   DCBMRPT1                                                 01475000
DCBMRCRL EQU   DCBMACR1                                                 01476000
DCBMRCHK EQU   DCBMRCRL                                                 01477000
DCBMRRDX EQU   DCBMRCHK                                                 01478000
DCBMRDMG EQU   DCBMACR1                                                 01479000
DCBMACR2 EQU   DCBMACR+1                                                01480000
DCBMRPUT EQU   DCBMACR2                                                 01481000
DCBMRWRT EQU   DCBMACR2                                                 01482000
DCBMRMVP EQU   DCBMACR2                                                 01483000
DCBMR5WD EQU   DCBMACR2                                                 01484000
DCBMRLDM EQU   DCBMR5WD                                                 01485000
DCBMRLCP EQU   DCBMRLDM                                                 01486000
DCBMR4WD EQU   DCBMACR2                                                 01487000
DCBMRPT2 EQU   DCBMR4WD                                                 01488000
DCBMRTMD EQU   DCBMRPT2                                                 01489000
DCBMR3WD EQU   DCBMACR2                                                 01490000
DCBMRCTL EQU   DCBMR3WD                                                 01491000
DCBMRSTK EQU   DCBMRCTL                                                 01492000
DCBMR1WD EQU   DCBMACR2                                                 01493000
DCBMRSWA EQU   DCBMR1WD                                                 01494000
DCBMRDMD EQU   DCBMRSWA                                                 01495000
IHADCS25 EQU   0                                                        01496000
DCBTIOT  EQU   IHADCS25                                                 01497000
DCBMACRF EQU   IHADCS25+2                                               01498000
DCBMACF1 EQU   DCBMACRF                                                 01499000
DCBMFFE  EQU   DCBMACF1                                                 01500000
DCBMFGET EQU   DCBMFFE                                                  01501000
DCBMFAPG EQU   DCBMACF1                                                 01502000
DCBMFRD  EQU   DCBMFAPG                                                 01503000
DCBMFCI  EQU   DCBMACF1                                                 01504000
DCBMFMVG EQU   DCBMFCI                                                  01505000
DCBMFLCG EQU   DCBMACF1                                                 01506000
DCBMFABC EQU   DCBMACF1                                                 01507000
DCBMFPT1 EQU   DCBMFABC                                                 01508000
DCBMFSBG EQU   DCBMFPT1                                                 01509000
DCBMFCRL EQU   DCBMACF1                                                 01510000
DCBMFCHK EQU   DCBMFCRL                                                 01511000
DCBMFDMG EQU   DCBMACF1                                                 01512000
DCBMACF2 EQU   DCBMACRF+1                                               01513000
DCBMFPUT EQU   DCBMACF2                                                 01514000
DCBMFWRT EQU   DCBMACF2                                                 01515000
DCBMFMVP EQU   DCBMACF2                                                 01516000
DCBMF5WD EQU   DCBMACF2                                                 01517000
DCBMFLDM EQU   DCBMF5WD                                                 01518000
DCBMFLCP EQU   DCBMFLDM                                                 01519000
DCBMF4WD EQU   DCBMACF2                                                 01520000
DCBMFPT2 EQU   DCBMF4WD                                                 01521000
DCBMFTMD EQU   DCBMFPT2                                                 01522000
DCBMF3WD EQU   DCBMACF2                                                 01523000
DCBMFCTL EQU   DCBMF3WD                                                 01524000
DCBMFSTK EQU   DCBMFCTL                                                 01525000
DCBMF1WD EQU   DCBMACF2                                                 01526000
DCBMFSWA EQU   DCBMF1WD                                                 01527000
DCBMFDMD EQU   DCBMFSWA                                                 01528000
DCBDEBAD EQU   IHADCS25+4                                               01529000
DCBIFLGS EQU   DCBDEBAD                                                 01530000
DCBIFPCT EQU   DCBIFLGS                                                 01531000
IHADCS27 EQU   0                                                        01532000
DCBGET   EQU   IHADCS27                                                 01533000
DCBPUT   EQU   DCBGET                                                   01534000
DCBGETA  EQU   DCBPUT+1                                                 01535000
IHADCS43 EQU   0                                                        01536000
DCBSCTAB EQU   IHADCS43                                                 01537000
IEDQOPCE EQU   0                                                        01538000
OCELEM   EQU   IEDQOPCE+4                                               01539000
OCUNIT   EQU   IEDQOPCE+8                                               01540000
OCRUDEST EQU   OCUNIT                                                   01541000
OCCKPKEY EQU   OCRUDEST                                                 01542000
OCSCAN   EQU   OCCKPKEY                                                 01543000
OCOPTCDE EQU   IEDQOPCE+12                                              01544000
OCSWITCH EQU   IEDQOPCE+13                                              01545000
OCFLAG   EQU   IEDQOPCE+14                                              01546000
@NM00145 EQU   IEDQOPCE+16                                              01547000
OCDEST   EQU   @NM00145                                                 01548000
OCREQVAL EQU   OCDEST+1                                                 01549000
OCTRMTBL EQU   IEDQOPCE+20                                              01550000
OCLINENO EQU   IEDQOPCE+22                                              01551000
OCTIOT   EQU   OCLINENO                                                 01552000
OCTRUNIT EQU   IEDQOPCE+24                                              01553000
OCRSID   EQU   OCTRUNIT                                                 01554000
OCALSTAT EQU   OCRSID                                                   01555000
OCPARM   EQU   IEDQOPCE+28                                              01556000
OCBACKUP EQU   IEDQOPCE+32                                              01557000
OCMODNME EQU   IEDQOPCE+40                                              01558000
OCIPLWA  EQU   OCMODNME                                                 01559000
OCCKDATA EQU   IEDQOPCE+48                                              01560000
OCRSTGTM EQU   OCCKDATA                                                 01561000
OCCKDAT1 EQU   OCRSTGTM                                                 01562000
OCCKDAT2 EQU   OCRSTGTM+1                                               01563000
IEDQOPCN EQU   0                                                        01564000
OCLDNME  EQU   IEDQOPCN                                                 01565000
OCLINTTE EQU   OCLDNME                                                  01566000
OCREQFLG EQU   OCLINTTE+2                                               01567000
OCPREFLG EQU   OCLINTTE+3                                               01568000
IEDQOPCD EQU   0                                                        01569000
OPCAQCTL EQU   IEDQOPCD+180                                             01570000
OPCLDNME EQU   IEDQOPCD+212                                             01571000
OPCCKPTF EQU   IEDQOPCD+248                                             01572000
OPCSPEC  EQU   IEDQOPCD+300                                             01573000
OPCPWCOB EQU   IEDQOPCD+368                                             01574000
OPCPWQCB EQU   OPCPWCOB                                                 01575000
OPCPWECB EQU   OPCPWCOB+4                                               01576000
IEDPLMV  EQU   0                                                        01577000
PLMVTU   EQU   IEDPLMV                                                  01578000
PLMVTD   EQU   IEDPLMV+4                                                01579000
PLMVSU   EQU   IEDPLMV+8                                                01580000
PLMVSD   EQU   IEDPLMV+12                                               01581000
PLMVLNTH EQU   IEDPLMV+16                                               01582000
PLMVFLG1 EQU   IEDPLMV+18                                               01583000
PLMVTCTG EQU   PLMVFLG1                                                 01584000
PLMVFLG2 EQU   IEDPLMV+19                                               01585000
PLMVUNCA EQU   IEDPLMV+20                                               01586000
IEDPLMVP EQU   0                                                        01587000
IEDPRUQD EQU   0                                                        01588000
PRUTTCIN EQU   IEDPRUQD                                                 01589000
PRUDATCT EQU   IEDPRUQD+2                                               01590000
PRUTIC   EQU   IEDPRUQD+8                                               01591000
PRUDATA  EQU   IEDPRUQD+12                                              01592000
IEDPRUND EQU   0                                                        01593000
PRURHTH  EQU   IEDPRUND                                                 01594000
PRURH    EQU   PRURHTH                                                  01595000
PRURHFG0 EQU   PRURH                                                    01596000
PRURHFG1 EQU   PRURH+1                                                  01597000
PRURHFG2 EQU   PRURH+2                                                  01598000
PRUTH    EQU   PRURHTH+3                                                01599000
PRUFIDN  EQU   PRUTH                                                    01600000
IEDQTCXD EQU   0                                                        01601000
TCXATTEN EQU   IEDQTCXD+4                                               01602000
TCXREADY EQU   IEDQTCXD+24                                              01603000
TCXFLAG1 EQU   IEDQTCXD+34                                              01604000
TCXBUFA  EQU   IEDQTCXD+80                                              01605000
TCXDSAVE EQU   IEDQTCXD+104                                             01606000
TCXQE8   EQU   IEDQTCXD+216                                             01607000
TCXPTR   EQU   0                                                        01608000
IEDTRM   EQU   0                                                        01609000
IEDNTRM  EQU   IEDTRM                                                   01610000
TRMBYTE4 EQU   IEDNTRM                                                  01611000
TRMBYTE3 EQU   IEDNTRM+1                                                01612000
TRMBYTE2 EQU   IEDNTRM+2                                                01613000
TRMINPG  EQU   TRMBYTE2                                                 01614000
TRMBYTE1 EQU   IEDNTRM+3                                                01615000
TRMSCPRQ EQU   TRMBYTE1                                                 01616000
TRMCKPRN EQU   TRMBYTE1                                                 01617000
TRMBYTE0 EQU   IEDNTRM+6                                                01618000
TRMSIBPT EQU   IEDNTRM+7                                                01619000
IEDQTRM  EQU   IEDTRM+14                                                01620000
TRMSTATE EQU   IEDQTRM                                                  01621000
TRMLOG   EQU   TRMSTATE                                                 01622000
TRMINSEQ EQU   IEDQTRM+4                                                01623000
TLISTCNT EQU   TRMINSEQ                                                 01624000
TRMOUTSQ EQU   IEDQTRM+6                                                01625000
TLISTEN  EQU   TRMOUTSQ                                                 01626000
TRMDSORG EQU   TLISTEN                                                  01627000
TRMALTD  EQU   IEDQTRM+8                                                01628000
TRMDEVFL EQU   IEDQTRM+10                                               01629000
TRMSTAT  EQU   IEDQTRM+12                                               01630000
RTRM     EQU   0                                                        01631000
MSGPTR   EQU   0                                                        01632000
MOVECHAR EQU   0                                                        01633000
IEDMVBFR EQU   0                                                        01634000
IEDQTNT  EQU   0                                                        01635000
IEDQNW   EQU   0                                                        01636000
TCB      EQU   0                                                        01637000
TCBTIO   EQU   TCB+12                                                   01638000
TIOENTRY EQU   0                                                        01639000
TIOEDDNM EQU   TIOENTRY+4                                               01640000
ICTNT    EQU   0                                                        01641000
ICTNTTIC EQU   ICTNT+8                                                  01642000
ICTNTDAT EQU   ICTNT+12                                                 01643000
ICTNTCTL EQU   ICTNTDAT                                                 01644000
ICTNTOFF EQU   ICTNTDAT+3                                               01645000
MULTIPNT EQU   0                                                        01646000
LEASED   EQU   0                                                        01647000
DEVRCD   EQU   0                                                        01648000
DEVLEN   EQU   DEVRCD                                                   01649000
DEVID    EQU   DEVRCD+1                                                 01650000
MESSAGE  EQU   0                                                        01651000
MSGTEXT  EQU   MESSAGE+4                                                01652000
MSGDDNAM EQU   MSGTEXT+8                                                01653000
MSGNUMB  EQU   MSGTEXT+61                                               01654000
MSGZONE  EQU   MSGNUMB+3                                                01655000
CL0001@  EQU   0                                                        01656000
CKPINIT  EQU   CKPEXCP                                                  01657000
CKPTWA   EQU   CKPMSGTX                                                 01658000
CKPSAVE2 EQU   CKPTWA                                                   01659000
CKPTRMAD EQU   CKPTWA+60                                                01660000
CKPNCNTL EQU   CKPCNTLR                                                 01661000
CKPBLKSZ EQU   CKPNCNTL+12                                              01662000
CKPTRKCN EQU   CKPNCNTL+16                                              01663000
CKPDATTM EQU   CKPNCNTL+22                                              01664000
CKPNFLDS EQU   CKPEXCP                                                  01665000
CKPENCDE EQU   CKPNFLDS+7                                               01666000
CKPNSELT EQU   CKPNFLDS+16                                              01667000
CKPCUSEL EQU   CKPNSELT                                                 01668000
CKPSLNEW EQU   CKPNSELT+1                                               01669000
CKPNTRK  EQU   CKPNFLDS+20                                              01670000
CKPNRSID EQU   CKPNFLDS+22                                              01671000
CKPSLVAL EQU   CKPNSELT                                                 01672000
CKPOVER  EQU   CKPMSGTP+1                                               01673000
CKPOPNFL EQU   CKPFLAGS                                                 01674000
CDRINCFM EQU   CDRTTRLI                                                 01675000
CDRCREQR EQU   IEDQCDRD                                                 01676000
CDRCKFLG EQU   CDRCREQR                                                 01677000
CVTS01   EQU   CVTPGSIA                                                 01678000
CVTLPDIA EQU   CVTS01+12                                                01679000
CVTDIRST EQU   CVTLPDIA                                                 01680000
CVTSLIDA EQU   CVTS01+24                                                01681000
CVTCTLFG EQU   CVTS01+50                                                01682000
CVTRV210 EQU   CVTS01+424                                               01683000
CVTRV219 EQU   CVTS01+425                                               01684000
CVTRV228 EQU   CVTS01+426                                               01685000
CVTRV237 EQU   CVTS01+427                                               01686000
CVTMFRTR EQU   CVTS01+452                                               01687000
CVTRV262 EQU   CVTS01+468                                               01688000
CVTRV271 EQU   CVTS01+469                                               01689000
CVTRV280 EQU   CVTS01+470                                               01690000
CVTRV289 EQU   CVTS01+471                                               01691000
CVTGSDA  EQU   CVTS01+600                                               01692000
DCBPTR   EQU   CKPIODCB                                                 01693000
OCCKPKY1 EQU   OCCKPKEY                                                 01694000
OCCKPTYP EQU   OCCKPKY1                                                 01695000
OCICACTN EQU   OCMODNME                                                 01696000
OCICDADR EQU   OCICACTN                                                 01697000
OCICTYPE EQU   OCICDADR                                                 01698000
OCICSW   EQU   OCICDADR+3                                               01699000
ROPCAVT  EQU   AVTOCGET                                                 01700000
OPCAQWD  EQU   OPCAQCTL                                                 01701000
OPCAQWD1 EQU   OPCAQWD                                                  01702000
OPCAQWD2 EQU   OPCAQWD+4                                                01703000
OPCAQWD3 EQU   OPCAQWD+8                                                01704000
IEDPRUQP EQU   OCUNIT                                                   01705000
TRMPRE1  EQU   TRMBYTE4                                                 01706000
TRMNCP1  EQU   TRMBYTE4                                                 01707000
TRMPRE   EQU   TRMBYTE3                                                 01708000
TRMNCP   EQU   TRMBYTE3                                                 01709000
TRMPU    EQU   TRMBYTE3                                                 01710000
TRMLU    EQU   TRMBYTE3                                                 01711000
TRMLINK  EQU   TRMBYTE3                                                 01712000
ICCKPT   EQU   CKPSAVE2+8                                               01713000
CKPTNTUN EQU   ICCKPT                                                   01714000
CKPTNTPT EQU   ICCKPT+4                                                 01715000
CKPTNTLN EQU   ICCKPT+8                                                 01716000
CKPTNTNB EQU   ICCKPT+10                                                01717000
CKPTC    EQU   ICCKPT+12                                                01718000
CKPTTCIN EQU   CKPTC                                                    01719000
CKPDATCT EQU   CKPTC+2                                                  01720000
CNRDVDAT EQU   CNRDEVRC                                                 01721000
CNRDVPRF EQU   CNRDVDAT                                                 01722000
CNRDVTC  EQU   CNRDVPRF                                                 01723000
CNRDVT   EQU   CNRDVTC                                                  01724000
CNRDVC   EQU   CNRDVTC+2                                                01725000
CNRDVBDU EQU   CNRDVDAT+12                                              01726000
CNRDVRCD EQU   CNRDVDAT+18                                              01727000
CONVERT  EQU   CKPSAVE1                                                 01728000
CONUNPK  EQU   CONVERT+5                                                01729000
BDUTEXT  EQU   BDUEND                                                   01730000
CDROPCB  EQU   CDRDATA                                                  01731000
CKPMSGPN EQU   CKPMSGTP+6                                               01732000
CKPTTRLT EQU   CKPTIC+5                                                 01733000
OCCIB    EQU   OCREQVAL                                                 01734000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01735000
@NM00200 EQU   CONVERT                                                  01736000
@NM00193 EQU   CNRDVPRF+4                                               01737000
@NM00186 EQU   TRMLINK                                                  01738000
TRMLSTAT EQU   TRMLINK                                                  01739000
TRMLINT  EQU   TRMLINK                                                  01740000
TRMEPMOD EQU   TRMLINK                                                  01741000
TRMLULOG EQU   TRMLU                                                    01742000
TRMINERR EQU   TRMLU                                                    01743000
TRMLUREQ EQU   TRMLU                                                    01744000
TRMSESRQ EQU   TRMLU                                                    01745000
TRMTDIFF EQU   TRMLU                                                    01746000
TRMLUTM  EQU   TRMLU                                                    01747000
TRMLUIT  EQU   TRMLU                                                    01748000
TRMAUTO  EQU   TRMLU                                                    01749000
TRMPCONT EQU   TRMPU                                                    01750000
@NM00185 EQU   TRMPU                                                    01751000
TRMNCONT EQU   TRMNCP                                                   01752000
TRMQUCKN EQU   TRMNCP                                                   01753000
TRMSLOWN EQU   TRMNCP                                                   01754000
TRMSYGEN EQU   TRMNCP                                                   01755000
TRMNCPCL EQU   TRMNCP                                                   01756000
TRMIPLDM EQU   TRMNCP                                                   01757000
TRMINOUT EQU   TRMPRE                                                   01758000
TRMRDOUT EQU   TRMPRE                                                   01759000
TRMNLOUT EQU   TRMPRE                                                   01760000
TRMWROUT EQU   TRMPRE                                                   01761000
TRMASNXI EQU   TRMPRE                                                   01762000
TRMSTMM  EQU   TRMPRE                                                   01763000
TRMCMODE EQU   TRMPRE                                                   01764000
TRMSTPND EQU   TRMPRE                                                   01765000
@NM00184 EQU   TRMNCP1                                                  01766000
TRMINOP  EQU   TRMNCP1                                                  01767000
TRMLYNCH EQU   TRMPRE1                                                  01768000
TRMSPOUT EQU   TRMPRE1                                                  01769000
TRMERLCK EQU   TRMPRE1                                                  01770000
TRMQNPL  EQU   TRMPRE1                                                  01771000
TRMSPACT EQU   TRMPRE1                                                  01772000
TRMOCNI  EQU   TRMPRE1                                                  01773000
TRMSESSN EQU   TRMPRE1                                                  01774000
TRMCONT  EQU   TRMPRE1                                                  01775000
OPCAQLST EQU   OPCAQWD3+1                                               01776000
OPCAQRQ3 EQU   OPCAQWD3                                                 01777000
OPCAQSEC EQU   OPCAQWD2+1                                               01778000
OPCAQRQ2 EQU   OPCAQWD2                                                 01779000
OPCAQFST EQU   OPCAQWD1+1                                               01780000
OPCAQREQ EQU   OPCAQWD1                                                 01781000
OCICINAC EQU   OCICSW                                                   01782000
@NM00151 EQU   OCICSW                                                   01783000
OCICATST EQU   OCICDADR+1                                               01784000
@NM00150 EQU   OCCKPKY1                                                 01785000
OCCKPENV EQU   OCCKPKY1                                                 01786000
OCCKPRST EQU   OCCKPTYP                                                 01787000
OCCKPNCP EQU   OCCKPTYP                                                 01788000
OCCKPINC EQU   OCCKPTYP                                                 01789000
CVTRV628 EQU   CVTS01+728                                               01790000
CVTRV627 EQU   CVTS01+724                                               01791000
CVTRV626 EQU   CVTS01+720                                               01792000
CVTRV625 EQU   CVTS01+716                                               01793000
CVTRV624 EQU   CVTS01+712                                               01794000
CVTRV623 EQU   CVTS01+708                                               01795000
CVTRV622 EQU   CVTS01+704                                               01796000
CVTRV621 EQU   CVTS01+700                                               01797000
CVTRV620 EQU   CVTS01+696                                               01798000
CVTRV619 EQU   CVTS01+692                                               01799000
CVTRV618 EQU   CVTS01+688                                               01800000
CVTRV617 EQU   CVTS01+684                                               01801000
CVTRV616 EQU   CVTS01+680                                               01802000
CVTRV615 EQU   CVTS01+676                                               01803000
CVTRV614 EQU   CVTS01+672                                               01804000
CVTRV613 EQU   CVTS01+668                                               01805000
CVTTCASP EQU   CVTS01+664                                               01806000
CVT0PT03 EQU   CVTS01+660                                               01807000
CVT0PT0E EQU   CVTS01+656                                               01808000
CVTIRM   EQU   CVTS01+652                                               01809000
CVTCGK   EQU   CVTS01+648                                               01810000
CVTRV607 EQU   CVTS01+644                                               01811000
CVTRV606 EQU   CVTS01+640                                               01812000
CVTRV605 EQU   CVTS01+636                                               01813000
CVTRV604 EQU   CVTS01+632                                               01814000
CVTEFF02 EQU   CVTS01+628                                               01815000
CVTCBBR  EQU   CVTS01+624                                               01816000
CVTSSCR  EQU   CVTS01+620                                               01817000
CVTEVENT EQU   CVTS01+616                                               01818000
CVTCRCA  EQU   CVTS01+612                                               01819000
CVTTPIO  EQU   CVTS01+608                                               01820000
CVTADV   EQU   CVTS01+604                                               01821000
CVTGSDAB EQU   CVTGSDA                                                  01822000
CVTQV3   EQU   CVTS01+596                                               01823000
CVTQV2   EQU   CVTS01+592                                               01824000
CVTQV1   EQU   CVTS01+588                                               01825000
CVTRPT   EQU   CVTS01+584                                               01826000
CVTSSRB  EQU   CVTS01+580                                               01827000
CVTCSDRL EQU   CVTS01+576                                               01828000
CVTEXP1  EQU   CVTS01+572                                               01829000
CVTRMPMT EQU   CVTS01+568                                               01830000
CVTRMPTT EQU   CVTS01+564                                               01831000
CVTVPSA  EQU   CVTS01+560                                               01832000
CVTVSTOP EQU   CVTS01+556                                               01833000
CVTGTFR8 EQU   CVTS01+552                                               01834000
CVTQUIT  EQU   CVTS01+548                                               01835000
CVTVACR  EQU   CVTS01+544                                               01836000
CVTWTCB  EQU   CVTS01+540                                               01837000
CVTSTPRS EQU   CVTS01+536                                               01838000
CVT0PT02 EQU   CVTS01+532                                               01839000
CVTDARCM EQU   CVTS01+528                                               01840000
CVTIRECM EQU   CVTS01+524                                               01841000
CVTJRECM EQU   CVTS01+520                                               01842000
CVTVEMS0 EQU   CVTS01+516                                               01843000
CVTSPFRR EQU   CVTS01+512                                               01844000
CVTRLSTG EQU   CVTS01+508                                               01845000
CVT0TC0A EQU   CVTS01+504                                               01846000
CVTGMBR  EQU   CVTS01+500                                               01847000
CVTLFRM  EQU   CVTS01+496                                               01848000
CVTRMBR  EQU   CVTS01+492                                               01849000
CVTVIOP  EQU   CVTS01+488                                               01850000
CVTRV307 EQU   CVTS01+486                                               01851000
CVTRV306 EQU   CVTS01+484                                               01852000
CVTRV305 EQU   CVTS01+482                                               01853000
CVTRV304 EQU   CVTS01+480                                               01854000
CVTRV303 EQU   CVTS01+478                                               01855000
CVTRV302 EQU   CVTS01+476                                               01856000
CVTTRCA  EQU   CVTS01+472                                               01857000
CVTRV297 EQU   CVTRV289                                                 01858000
CVTRV296 EQU   CVTRV289                                                 01859000
CVTRV295 EQU   CVTRV289                                                 01860000
CVTRV294 EQU   CVTRV289                                                 01861000
CVTRV293 EQU   CVTRV289                                                 01862000
CVTRV292 EQU   CVTRV289                                                 01863000
CVTRV291 EQU   CVTRV289                                                 01864000
CVTRV290 EQU   CVTRV289                                                 01865000
CVTRV288 EQU   CVTRV280                                                 01866000
CVTRV287 EQU   CVTRV280                                                 01867000
CVTRV286 EQU   CVTRV280                                                 01868000
CVTRV285 EQU   CVTRV280                                                 01869000
CVTRV284 EQU   CVTRV280                                                 01870000
CVTRV283 EQU   CVTRV280                                                 01871000
CVTRV282 EQU   CVTRV280                                                 01872000
CVTRV281 EQU   CVTRV280                                                 01873000
CVTRV279 EQU   CVTRV271                                                 01874000
CVTRV278 EQU   CVTRV271                                                 01875000
CVTRV277 EQU   CVTRV271                                                 01876000
CVTRV276 EQU   CVTRV271                                                 01877000
CVTRV275 EQU   CVTRV271                                                 01878000
CVTRV274 EQU   CVTRV271                                                 01879000
CVTRV273 EQU   CVTRV271                                                 01880000
CVTRV272 EQU   CVTRV271                                                 01881000
CVTRV270 EQU   CVTRV262                                                 01882000
CVTRV269 EQU   CVTRV262                                                 01883000
CVTRV268 EQU   CVTRV262                                                 01884000
CVTRV267 EQU   CVTRV262                                                 01885000
CVTRV266 EQU   CVTRV262                                                 01886000
CVTRV265 EQU   CVTRV262                                                 01887000
CVTRV264 EQU   CVTRV262                                                 01888000
CVTRV263 EQU   CVTRV262                                                 01889000
CVTVFP   EQU   CVTS01+464                                               01890000
CVTVSI   EQU   CVTS01+460                                               01891000
CVTVPSIB EQU   CVTS01+456                                               01892000
CVTMFACT EQU   CVTMFRTR                                                 01893000
CVTMFCTL EQU   CVTS01+448                                               01894000
CVTPVBP  EQU   CVTS01+444                                               01895000
CVTPWI   EQU   CVTS01+440                                               01896000
CVTRV254 EQU   CVTS01+438                                               01897000
CVTRV253 EQU   CVTS01+436                                               01898000
CVTRV252 EQU   CVTS01+434                                               01899000
CVTRV251 EQU   CVTS01+433                                               01900000
CVTRV250 EQU   CVTS01+432                                               01901000
CVTRV249 EQU   CVTS01+431                                               01902000
CVTRV248 EQU   CVTS01+430                                               01903000
CVTRV247 EQU   CVTS01+429                                               01904000
CVTRV246 EQU   CVTS01+428                                               01905000
CVTRV245 EQU   CVTRV237                                                 01906000
CVTRV244 EQU   CVTRV237                                                 01907000
CVTRV243 EQU   CVTRV237                                                 01908000
CVTRV242 EQU   CVTRV237                                                 01909000
CVTRV241 EQU   CVTRV237                                                 01910000
CVTRV240 EQU   CVTRV237                                                 01911000
CVTRV239 EQU   CVTRV237                                                 01912000
CVTRV238 EQU   CVTRV237                                                 01913000
CVTRV236 EQU   CVTRV228                                                 01914000
CVTRV235 EQU   CVTRV228                                                 01915000
CVTRV234 EQU   CVTRV228                                                 01916000
CVTRV233 EQU   CVTRV228                                                 01917000
CVTRV232 EQU   CVTRV228                                                 01918000
CVTRV231 EQU   CVTRV228                                                 01919000
CVTRV230 EQU   CVTRV228                                                 01920000
CVTRV229 EQU   CVTRV228                                                 01921000
CVTRV227 EQU   CVTRV219                                                 01922000
CVTRV226 EQU   CVTRV219                                                 01923000
CVTRV225 EQU   CVTRV219                                                 01924000
CVTRV224 EQU   CVTRV219                                                 01925000
CVTRV223 EQU   CVTRV219                                                 01926000
CVTRV222 EQU   CVTRV219                                                 01927000
CVTRV221 EQU   CVTRV219                                                 01928000
CVTRV220 EQU   CVTRV219                                                 01929000
CVTRV218 EQU   CVTRV210                                                 01930000
CVTRV217 EQU   CVTRV210                                                 01931000
CVTRV216 EQU   CVTRV210                                                 01932000
CVTRV215 EQU   CVTRV210                                                 01933000
CVTRV214 EQU   CVTRV210                                                 01934000
CVTRV213 EQU   CVTRV210                                                 01935000
CVTRV212 EQU   CVTRV210                                                 01936000
CVTRV211 EQU   CVTRV210                                                 01937000
CVTLCCAT EQU   CVTS01+420                                               01938000
CVTPCCAT EQU   CVTS01+416                                               01939000
CVTIPCRP EQU   CVTS01+412                                               01940000
CVTIPCRI EQU   CVTS01+408                                               01941000
CVTIPCDS EQU   CVTS01+404                                               01942000
CVTAIDVT EQU   CVTS01+400                                               01943000
CVTSSAP  EQU   CVTS01+396                                               01944000
CVTEHCIR EQU   CVTS01+392                                               01945000
CVTEHDEF EQU   CVTS01+388                                               01946000
CVTDAIR  EQU   CVTS01+384                                               01947000
CVTPERFM EQU   CVTS01+380                                               01948000
CVT044R2 EQU   CVTS01+376                                               01949000
CVTFETCH EQU   CVTS01+372                                               01950000
CVTRSTWD EQU   CVTS01+368                                               01951000
CVTSPOST EQU   CVTS01+364                                               01952000
CVTIOBP  EQU   CVTS01+360                                               01953000
CVTASMVT EQU   CVTS01+356                                               01954000
CVTRECRQ EQU   CVTS01+352                                               01955000
CVTWSAC  EQU   CVTS01+348                                               01956000
CVTRV149 EQU   CVTS01+344                                               01957000
CVTWSAL  EQU   CVTS01+340                                               01958000
CVTSPSA  EQU   CVTS01+336                                               01959000
CVTGLMN  EQU   CVTS01+332                                               01960000
CVTVEAC0 EQU   CVTS01+328                                               01961000
CVT062R1 EQU   CVTS01+324                                               01962000
CVTRPOST EQU   CVTS01+320                                               01963000
CVTDQIQE EQU   CVTS01+316                                               01964000
CVTCSD   EQU   CVTS01+312                                               01965000
CVTLKRMA EQU   CVTS01+308                                               01966000
CVTRSPIE EQU   CVTS01+304                                               01967000
CVTRENQ  EQU   CVTS01+300                                               01968000
CVTLQCB  EQU   CVTS01+296                                               01969000
CVTFQCB  EQU   CVTS01+292                                               01970000
CVTQCS01 EQU   CVTS01+288                                               01971000
CVTAPFT  EQU   CVTS01+284                                               01972000
CVTPARRL EQU   CVTS01+280                                               01973000
CVTVWAIT EQU   CVTS01+276                                               01974000
CVTGSPL  EQU   CVTS01+272                                               01975000
CVTLSMQ  EQU   CVTS01+268                                               01976000
CVTGSMQ  EQU   CVTS01+264                                               01977000
CVTEXPRO EQU   CVTS01+260                                               01978000
CVTOPCTP EQU   CVTS01+256                                               01979000
CVTSIC   EQU   CVTS01+252                                               01980000
CVTTPIOS EQU   CVTS01+248                                               01981000
CVTRTMS  EQU   CVTS01+244                                               01982000
CVTSDBF  EQU   CVTS01+240                                               01983000
CVTSCBP  EQU   CVTS01+236                                               01984000
CVTSDMP  EQU   CVTS01+232                                               01985000
CVTSV60  EQU   CVTS01+228                                               01986000
CVTRTMCT EQU   CVTS01+224                                               01987000
CVTASCBL EQU   CVTS01+220                                               01988000
CVTASCBH EQU   CVTS01+216                                               01989000
CVTGDA   EQU   CVTS01+212                                               01990000
CVTASVT  EQU   CVTS01+208                                               01991000
CVTVVMDI EQU   CVTS01+204                                               01992000
CVTAQTOP EQU   CVTS01+200                                               01993000
CVTIOSCS EQU   CVTS01+196                                               01994000
CVTSDRM  EQU   CVTS01+192                                               01995000
CVTOPTE  EQU   CVTS01+188                                               01996000
CVTSTXU  EQU   CVTS01+184                                               01997000
CVTQUIS  EQU   CVTS01+180                                               01998000
CVTPARS  EQU   CVTS01+176                                               01999000
CVTS1EE  EQU   CVTS01+172                                               02000000
CVTFRAS  EQU   CVTS01+168                                               02001000
CVTQSAS  EQU   CVTS01+164                                               02002000
CVTCRAS  EQU   CVTS01+160                                               02003000
CVTCRMN  EQU   CVTS01+156                                               02004000
CVTDELCP EQU   CVTS01+152                                               02005000
CVTFRECL EQU   CVTS01+148                                               02006000
CVTGETCL EQU   CVTS01+144                                               02007000
CVTBLDCP EQU   CVTS01+140                                               02008000
CVTAUTHL EQU   CVTS01+136                                               02009000
CVTSCAN  EQU   CVTS01+132                                               02010000
CVTRV144 EQU   CVTS01+130                                               02011000
CVTMAXMP EQU   CVTS01+128                                               02012000
CVTSTCK  EQU   CVTS01+124                                               02013000
CVTRV139 EQU   CVTS01+123                                               02014000
CVTDSSAC EQU   CVTS01+122                                               02015000
CVTRV513 EQU   CVTS01+121                                               02016000
CVTIOSPL EQU   CVTS01+120                                               02017000
CVTPTGT  EQU   CVTS01+116                                               02018000
CVTCSPIE EQU   CVTS01+112                                               02019000
CVTSMFEX EQU   CVTS01+108                                               02020000
CVTOLT0A EQU   CVTS01+104                                               02021000
CVTSRBRT EQU   CVTS01+100                                               02022000
CVTPUTL  EQU   CVTS01+96                                                02023000
CVTASCRL EQU   CVTS01+92                                                02024000
CVTASCRF EQU   CVTS01+88                                                02025000
CVTRV326 EQU   CVTS01+84                                                02026000
CVTRV325 EQU   CVTS01+80                                                02027000
CVTRV324 EQU   CVTS01+76                                                02028000
CVT0VL01 EQU   CVTS01+72                                                02029000
CVTSHRVM EQU   CVTS01+68                                                02030000
CVTRV332 EQU   CVTS01+64                                                02031000
CVTTAS   EQU   CVTS01+60                                                02032000
CVTRSCN  EQU   CVTS01+56                                                02033000
CVTTRAC2 EQU   CVTS01+54                                                02034000
CVTTRACE EQU   CVTS01+52                                                02035000
CVTAPG   EQU   CVTS01+51                                                02036000
CVTSDTRC EQU   CVTCTLFG                                                 02037000
CVTGTRCE EQU   CVTCTLFG                                                 02038000
CVTNOMP  EQU   CVTCTLFG                                                 02039000
CVTRSV79 EQU   CVTCTLFG                                                 02040000
CVTDSTAT EQU   CVTCTLFG                                                 02041000
CVTRSV78 EQU   CVTCTLFG                                                 02042000
CVTRV333 EQU   CVTCTLFG                                                 02043000
CVTRV323 EQU   CVTCTLFG                                                 02044000
CVTSPVLK EQU   CVTS01+49                                                02045000
CVTRSV77 EQU   CVTS01+48                                                02046000
CVTRV331 EQU   CVTS01+44                                                02047000
CVTRV330 EQU   CVTS01+40                                                02048000
CVTRV329 EQU   CVTS01+36                                                02049000
CVTRV328 EQU   CVTS01+32                                                02050000
CVTRV322 EQU   CVTS01+28                                                02051000
CVTSLID  EQU   CVTSLIDA+1                                               02052000
CVTSYLK  EQU   CVTSLIDA                                                 02053000
CVTRV321 EQU   CVTS01+20                                                02054000
CVTRV320 EQU   CVTS01+16                                                02055000
CVTLPDIR EQU   CVTLPDIA+1                                               02056000
CVTRSV69 EQU   CVTDIRST                                                 02057000
CVTRSV68 EQU   CVTDIRST                                                 02058000
CVTRSV67 EQU   CVTDIRST                                                 02059000
CVTRSV66 EQU   CVTDIRST                                                 02060000
CVTRSV65 EQU   CVTDIRST                                                 02061000
CVTRSV64 EQU   CVTDIRST                                                 02062000
CVTRSV63 EQU   CVTDIRST                                                 02063000
CVTDICOM EQU   CVTDIRST                                                 02064000
CVTPVTP  EQU   CVTS01+8                                                 02065000
CVTLPDSR EQU   CVTS01+4                                                 02066000
CVTGETL  EQU   CVTS01                                                   02067000
CDRCKOPT EQU   CDRCREQR+41                                              02068000
CDRCKPQB EQU   CDRCREQR+38                                              02069000
CDRCKQCB EQU   CDRCREQR+17                                              02070000
CDRCKQBC EQU   CDRCREQR+14                                              02071000
CDRCKMSG EQU   CDRCREQR+12                                              02072000
CDRCKOFF EQU   CDRCREQR+10                                              02073000
@NM00126 EQU   CDRCREQR+9                                               02074000
@NM00125 EQU   CDRCREQR+8                                               02075000
CDRCKOUT EQU   CDRCREQR+6                                               02076000
CDRCKIN  EQU   CDRCREQR+4                                               02077000
@NM00124 EQU   CDRCREQR+1                                               02078000
CDRCKRNC EQU   CDRCKFLG                                                 02079000
CDROPTN  EQU   CDRINCFM+7                                               02080000
CDRSEQOU EQU   CDRINCFM+5                                               02081000
CDRSEQIN EQU   CDRINCFM+3                                               02082000
CDROFFS  EQU   CDRINCFM+1                                               02083000
CDRSTAT  EQU   CDRINCFM                                                 02084000
@NM00123 EQU   CKPOPNFL                                                 02085000
CKPOPNCR EQU   CKPOPNFL                                                 02086000
CKPOPNIN EQU   CKPOPNFL                                                 02087000
CKPOPNEN EQU   CKPOPNFL                                                 02088000
@NM00122 EQU   CKPOPNFL                                                 02089000
CKPTRKSA EQU   CKPOVER+4                                                02090000
CKPTRKLN EQU   CKPOVER+2                                                02091000
CKPRCDSR EQU   CKPOVER                                                  02092000
CKPNDEVF EQU   CKPNFLDS+12                                              02093000
CKPNTTE  EQU   CKPNFLDS+8                                               02094000
@NM00121 EQU   CKPNFLDS                                                 02095000
CKPBCKUP EQU   CKPNCNTL+30                                              02096000
CKPTIME  EQU   CKPDATTM+4                                               02097000
CKPDATE  EQU   CKPDATTM                                                 02098000
@NM00120 EQU   CKPNCNTL+21                                              02099000
CKPBLKPT EQU   CKPNCNTL+20                                              02100000
@NM00119 EQU   CKPNCNTL+18                                              02101000
@NM00118 EQU   CKPNCNTL+14                                              02102000
CKPIPLTX EQU   CKPNCNTL+4                                               02103000
CKPSWTCH EQU   CKPNCNTL+3                                               02104000
CKPTRSTA EQU   CKPNCNTL+2                                               02105000
@NM00117 EQU   CKPNCNTL                                                 02106000
CKPCTTRA EQU   CKPINIT+24                                               02107000
@NM00116 EQU   CKPINIT+22                                               02108000
CKPIPERE EQU   CKPINIT+20                                               02109000
CKPDATIM EQU   CKPINIT+12                                               02110000
CKPCTTRC EQU   CKPINIT+8                                                02111000
CKPDATLN EQU   CKPINIT+6                                                02112000
CKPKEYLN EQU   CKPINIT+5                                                02113000
CKPRCDNO EQU   CKPINIT+4                                                02114000
CKPHEDNO EQU   CKPINIT+2                                                02115000
CKPCYLNO EQU   CKPINIT                                                  02116000
@NM00199 EQU   MSGNUMB                                                  02117000
@NM00198 EQU   MSGTEXT+16                                               02118000
@NM00197 EQU   MSGTEXT                                                  02119000
MSGMCS   EQU   MESSAGE+2                                                02120000
MSGLEN   EQU   MESSAGE                                                  02121000
DEVDATA  EQU   DEVRCD+3                                                 02122000
LEARCD   EQU   LEASED+2                                                 02123000
LEADESC  EQU   LEASED+1                                                 02124000
LEANCPLV EQU   LEASED                                                   02125000
MULRCDS  EQU   MULTIPNT+4                                               02126000
MULCURNB EQU   MULTIPNT+3                                               02127000
MULMAX   EQU   MULTIPNT+2                                               02128000
MULDESC  EQU   MULTIPNT+1                                               02129000
MULNCPLV EQU   MULTIPNT                                                 02130000
ICTNTNU  EQU   ICTNTCTL+2                                               02131000
ICTNTNO  EQU   ICTNTCTL                                                 02132000
@NM00196 EQU   ICTNT                                                    02133000
@NM00195 EQU   TIOENTRY                                                 02134000
@NM00194 EQU   TCB                                                      02135000
TRMOPT   EQU   IEDTRM+34                                                02136000
TRMOPTBL EQU   IEDQTRM+18                                               02137000
TRMOPNO  EQU   IEDQTRM+17                                               02138000
TRMCHCIN EQU   IEDQTRM+16                                               02139000
TRMSENSE EQU   TRMSTAT+3                                                02140000
TRMTEMPR EQU   TRMSTAT+2                                                02141000
TRMSIO   EQU   TRMSTAT                                                  02142000
@NM00183 EQU   TRMDEVFL+1                                               02143000
TRMTPIN  EQU   TRMDEVFL+1                                               02144000
TRMNCPI  EQU   TRMDEVFL+1                                               02145000
TRMRNTRM EQU   TRMDEVFL+1                                               02146000
@NM00182 EQU   TRMDEVFL+1                                               02147000
TRMLMD   EQU   TRMDEVFL+1                                               02148000
TRMCONC  EQU   TRMDEVFL+1                                               02149000
TRMTSOB  EQU   TRMDEVFL                                                 02150000
TRMBFDY  EQU   TRMDEVFL                                                 02151000
TRMTBLK  EQU   TRMDEVFL                                                 02152000
TRMSBLK  EQU   TRMDEVFL                                                 02153000
TRMBLKS  EQU   TRMDEVFL                                                 02154000
TRMADDC  EQU   TRMDEVFL                                                 02155000
TRMDDIG  EQU   TRMDEVFL                                                 02156000
TRMBUFS  EQU   TRMDEVFL                                                 02157000
TRMPRILK EQU   TRMALTD                                                  02158000
TRMLGB   EQU   TRMDSORG                                                 02159000
TRMUTERM EQU   TLISTCNT                                                 02160000
TRMDESTQ EQU   IEDQTRM+1                                                02161000
TRMSCNYN EQU   TRMSTATE                                                 02162000
TRMOPTFN EQU   TRMSTATE                                                 02163000
TRMHELDN EQU   TRMSTATE                                                 02164000
TRMACPTN EQU   TRMSTATE                                                 02165000
TRMPREF  EQU   TRMSTATE                                                 02166000
TRMPROC  EQU   TRMLOG                                                   02167000
TRMLIST  EQU   TRMLOG                                                   02168000
TRMLINE  EQU   TRMSTATE                                                 02169000
TRMSUBST EQU   IEDNTRM+12                                               02170000
TRMTYPE  EQU   IEDNTRM+11                                               02171000
TRMRLMCT EQU   IEDNTRM+10                                               02172000
TRMCOHTG EQU   TRMSIBPT+1                                               02173000
TRMGPCNT EQU   TRMSIBPT                                                 02174000
TRMBUFRD EQU   TRMBYTE0                                                 02175000
TRMSNA   EQU   TRMBYTE0                                                 02176000
TRMGP    EQU   TRMBYTE0                                                 02177000
TRMDIAL  EQU   TRMBYTE0                                                 02178000
@NM00181 EQU   TRMBYTE0                                                 02179000
TRMOUTPT EQU   TRMBYTE0                                                 02180000
TRMINPUT EQU   TRMBYTE0                                                 02181000
TRMUDEF  EQU   TRMBYTE0                                                 02182000
TRMCOHRT EQU   IEDNTRM+4                                                02183000
TRMSTOTE EQU   TRMBYTE1                                                 02184000
TRMTSATN EQU   TRMBYTE1                                                 02185000
TRMTRACE EQU   TRMBYTE1                                                 02186000
TRMSWBCK EQU   TRMBYTE1                                                 02187000
TRMAUTOC EQU   TRMBYTE1                                                 02188000
TRMINPTP EQU   TRMBYTE1                                                 02189000
TRMWTNEG EQU   TRMSCPRQ                                                 02190000
TRMWRBRK EQU   TRMBYTE2                                                 02191000
TRMNOSND EQU   TRMBYTE2                                                 02192000
TRMPREP  EQU   TRMBYTE2                                                 02193000
TRMGPACT EQU   TRMBYTE2                                                 02194000
TRMANDL  EQU   TRMBYTE2                                                 02195000
TRMCLOSN EQU   TRMINPG                                                  02196000
TRMREMB  EQU   TRMBYTE2                                                 02197000
TRMRSACT EQU   TRMBYTE2                                                 02198000
TCXEND   EQU   IEDQTCXD+224                                             02199000
TCXNCPIO EQU   IEDQTCXD+220                                             02200000
TCXACTE8 EQU   TCXQE8                                                   02201000
TCXABEPL EQU   IEDQTCXD+212                                             02202000
TCXSRBS  EQU   IEDQTCXD+208                                             02203000
TCXSIOSB EQU   IEDQTCXD+204                                             02204000
TCXESAVE EQU   IEDQTCXD+132                                             02205000
TCXERPPM EQU   IEDQTCXD+128                                             02206000
TCXERPSV EQU   IEDQTCXD+116                                             02207000
TCXSATTN EQU   IEDQTCXD+112                                             02208000
@NM00180 EQU   TCXDSAVE+4                                               02209000
@NM00179 EQU   TCXDSAVE                                                 02210000
TCXPLCB  EQU   IEDQTCXD+100                                             02211000
TCXBITS  EQU   IEDQTCXD+98                                              02212000
TCXSCBSZ EQU   IEDQTCXD+97                                              02213000
TCXBIT1  EQU   IEDQTCXD+96                                              02214000
TCXCOMPT EQU   IEDQTCXD+92                                              02215000
TCXAVAIL EQU   IEDQTCXD+88                                              02216000
TCXBUFL  EQU   IEDQTCXD+84                                              02217000
TCXTOTE  EQU   TCXBUFA                                                  02218000
TCXCKPM  EQU   IEDQTCXD+79                                              02219000
TCXNCKPR EQU   IEDQTCXD+78                                              02220000
TCXSZAIB EQU   IEDQTCXD+76                                              02221000
TCXAIBC  EQU   IEDQTCXD+72                                              02222000
TCXPEBC  EQU   IEDQTCXD+68                                              02223000
TCXPEWAC EQU   IEDQTCXD+64                                              02224000
TCXQRQ   EQU   IEDQTCXD+60                                              02225000
TCXOCQ   EQU   IEDQTCXD+56                                              02226000
TCXPNTQ  EQU   IEDQTCXD+52                                              02227000
TCXPUTQ  EQU   IEDQTCXD+48                                              02228000
TCXGETQ  EQU   IEDQTCXD+44                                              02229000
TCXTSI   EQU   IEDQTCXD+40                                              02230000
TCXRPT   EQU   IEDQTCXD+36                                              02231000
TCXCC3TS EQU   IEDQTCXD+35                                              02232000
TCXAPDMP EQU   TCXFLAG1                                                 02233000
TCXAPPL  EQU   TCXFLAG1                                                 02234000
TCXRTM   EQU   TCXFLAG1                                                 02235000
TCXMCPCD EQU   TCXFLAG1                                                 02236000
TCXAUTH  EQU   TCXFLAG1                                                 02237000
TCXASID  EQU   IEDQTCXD+32                                              02238000
TCXASCB  EQU   IEDQTCXD+28                                              02239000
TCXPASWD EQU   IEDQTCXD+16                                              02240000
TCXDISP  EQU   IEDQTCXD+12                                              02241000
TCXTCB   EQU   IEDQTCXD+8                                               02242000
TCXATTLN EQU   TCXATTEN                                                 02243000
TCXAVT   EQU   IEDQTCXD                                                 02244000
@NM00178 EQU   IEDPRUND+4                                               02245000
PRUTHEFI EQU   PRUFIDN                                                  02246000
PRUTHUSS EQU   PRUFIDN                                                  02247000
PRUTHEIU EQU   PRUFIDN                                                  02248000
PRUTHBIU EQU   PRUFIDN                                                  02249000
PRUTHTYE EQU   PRUFIDN                                                  02250000
@NM00177 EQU   PRURHFG2                                                 02251000
PRURHCSI EQU   PRURHFG2                                                 02252000
@NM00176 EQU   PRURHFG2                                                 02253000
PRURHCDI EQU   PRURHFG2                                                 02254000
PRURHEB  EQU   PRURHFG2                                                 02255000
PRURHBB  EQU   PRURHFG2                                                 02256000
PRURHPI  EQU   PRURHFG1                                                 02257000
@NM00175 EQU   PRURHFG1                                                 02258000
PRURHER  EQU   PRURHFG1                                                 02259000
PRURHDR2 EQU   PRURHFG1                                                 02260000
@NM00174 EQU   PRURHFG1                                                 02261000
PRURHDR1 EQU   PRURHFG1                                                 02262000
PRURHEC  EQU   PRURHFG0                                                 02263000
PRURHBC  EQU   PRURHFG0                                                 02264000
PRURHSDI EQU   PRURHFG0                                                 02265000
PRURHFI  EQU   PRURHFG0                                                 02266000
@NM00173 EQU   PRURHFG0                                                 02267000
PRURUCAT EQU   PRURHFG0                                                 02268000
PRURHTYP EQU   PRURHFG0                                                 02269000
PRUNUNIT EQU   PRUTIC+1                                                 02270000
@NM00172 EQU   PRUTIC                                                   02271000
@NM00171 EQU   IEDPRUQD+4                                               02272000
@NM00170 EQU   PLMVFLG1                                                 02273000
PLMVSCTG EQU   PLMVFLG1                                                 02274000
PLMVUNCF EQU   PLMVFLG1                                                 02275000
OPCBOTTM EQU   IEDQOPCD+1184                                            02276000
@NM00169 EQU   IEDQOPCD+1100                                            02277000
@NM00168 EQU   IEDQOPCD+948                                             02278000
@NM00167 EQU   IEDQOPCD+940                                             02279000
@NM00166 EQU   IEDQOPCD+380                                             02280000
@NM00165 EQU   OPCPWCOB+9                                               02281000
@NM00164 EQU   OPCPWCOB+8                                               02282000
@NM00163 EQU   OPCPWECB+1                                               02283000
OPCPWCCC EQU   OPCPWECB                                                 02284000
OPCPWCHN EQU   OPCPWQCB+1                                               02285000
OPCPWVTO EQU   OPCPWQCB                                                 02286000
OPCWAITV EQU   IEDQOPCD+364                                             02287000
OPCTOTCK EQU   IEDQOPCD+360                                             02288000
OPCAPXTL EQU   IEDQOPCD+356                                             02289000
OPCDECR  EQU   IEDQOPCD+352                                             02290000
OPCBUFWT EQU   IEDQOPCD+348                                             02291000
OPCWRKSP EQU   IEDQOPCD+320                                             02292000
OPCADGOT EQU   IEDQOPCD+318                                             02293000
OPCRQCNT EQU   IEDQOPCD+316                                             02294000
OPPOLSTP EQU   IEDQOPCD+312                                             02295000
OPCCKCIB EQU   IEDQOPCD+308                                             02296000
OPCEND   EQU   IEDQOPCD+307                                             02297000
OPCSTCBS EQU   IEDQOPCD+306                                             02298000
OPCHNEND EQU   IEDQOPCD+302                                             02299000
OPCOQSW  EQU   IEDQOPCD+301                                             02300000
@NM00162 EQU   OPCSPEC                                                  02301000
@NM00161 EQU   OPCSPEC                                                  02302000
@NM00160 EQU   OPCSPEC                                                  02303000
@NM00159 EQU   OPCSPEC                                                  02304000
OPCFRMCA EQU   OPCSPEC                                                  02305000
OPCRSTRT EQU   OPCSPEC                                                  02306000
OPCPART  EQU   OPCSPEC                                                  02307000
OPCALTD  EQU   OPCSPEC                                                  02308000
OPCBFEND EQU   IEDQOPCD+296                                             02309000
OPCBFIRS EQU   IEDQOPCD+292                                             02310000
OPCAVBUF EQU   IEDQOPCD+290                                             02311000
OPCIPLCT EQU   IEDQOPCD+289                                             02312000
OPCCLNTS EQU   IEDQOPCD+288                                             02313000
OPCHA8   EQU   IEDQOPCD+286                                             02314000
OPCBFREQ EQU   IEDQOPCD+284                                             02315000
OPCFREBF EQU   IEDQOPCD+280                                             02316000
OPCGETBF EQU   IEDQOPCD+276                                             02317000
OPCNEXT  EQU   IEDQOPCD+272                                             02318000
OPCFMDFC EQU   IEDQOPCD+268                                             02319000
OPCSCNC  EQU   IEDQOPCD+264                                             02320000
OPCHORTG EQU   IEDQOPCD+260                                             02321000
OPCHORT  EQU   IEDQOPCD+256                                             02322000
OPCCKPTL EQU   IEDQOPCD+252                                             02323000
OPCWAITA EQU   IEDQOPCD+244                                             02324000
OPCWAITR EQU   IEDQOPCD+240                                             02325000
OPCWAITP EQU   IEDQOPCD+236                                             02326000
OPCWAITO EQU   IEDQOPCD+232                                             02327000
OPCWAITN EQU   IEDQOPCD+228                                             02328000
OPCWAITL EQU   IEDQOPCD+224                                             02329000
OPCWAITC EQU   IEDQOPCD+220                                             02330000
@NM00158 EQU   OPCLDNME+5                                               02331000
OPCMODID EQU   OPCLDNME+3                                               02332000
@NM00157 EQU   OPCLDNME                                                 02333000
OPCXCTL  EQU   IEDQOPCD+204                                             02334000
OPCWAIT  EQU   IEDQOPCD+192                                             02335000
OPCCKERB EQU   IEDQOPCD+164                                             02336000
OPCBFERB EQU   IEDQOPCD+148                                             02337000
OPCFLAG2 EQU   IEDQOPCD+147                                             02338000
OPCFLAG1 EQU   IEDQOPCD+146                                             02339000
OPCWRKSZ EQU   IEDQOPCD+144                                             02340000
OPCWORK  EQU   IEDQOPCD+140                                             02341000
OPCRSAVE EQU   IEDQOPCD+132                                             02342000
OPCQCBAD EQU   IEDQOPCD+128                                             02343000
OPCSAVE  EQU   IEDQOPCD+56                                              02344000
OPCTRMWA EQU   IEDQOPCD+52                                              02345000
OPCPSTWT EQU   IEDQOPCD+48                                              02346000
OPCTNTEA EQU   IEDQOPCD+44                                              02347000
OPCPGCK  EQU   IEDQOPCD+40                                              02348000
OPCLCB   EQU   IEDQOPCD+36                                              02349000
@NM00156 EQU   IEDQOPCD+32                                              02350000
OPCIPLAD EQU   IEDQOPCD+28                                              02351000
OPCTOFLK EQU   IEDQOPCD+24                                              02352000
OPCOPTLK EQU   IEDQOPCD+20                                              02353000
OPCDCBLK EQU   IEDQOPCD+16                                              02354000
OPCCOPCE EQU   IEDQOPCD+12                                              02355000
OPCAVTPT EQU   IEDQOPCD+8                                               02356000
OPCDOUBL EQU   IEDQOPCD                                                 02357000
@NM00155 EQU   OCLDNME+4                                                02358000
@NM00154 EQU   OCPREFLG                                                 02359000
OCTOTEP  EQU   OCPREFLG                                                 02360000
OCREPOST EQU   OCPREFLG                                                 02361000
OCRSPSNT EQU   OCPREFLG                                                 02362000
OCBFREQ  EQU   OCPREFLG                                                 02363000
OCIDLE   EQU   OCREQFLG                                                 02364000
OCFORCE  EQU   OCREQFLG                                                 02365000
OCDCARD  EQU   OCREQFLG                                                 02366000
OCPARTAL EQU   OCREQFLG                                                 02367000
OCADNCP  EQU   OCREQFLG                                                 02368000
@NM00153 EQU   OCREQFLG                                                 02369000
@NM00152 EQU   OCREQFLG                                                 02370000
OCFLUSHZ EQU   OCREQFLG                                                 02371000
OCRESPCT EQU   OCLINTTE                                                 02372000
OCCKPTWA EQU   OCCKDATA+4                                               02373000
@NM00149 EQU   OCRSTGTM+2                                               02374000
OCPTRSAV EQU   OCMODNME+4                                               02375000
OCPUADR  EQU   OCIPLWA+2                                                02376000
OCWTGSAV EQU   OCIPLWA                                                  02377000
OCDVRDCT EQU   OCBACKUP+6                                               02378000
OCNCP    EQU   OCBACKUP+4                                               02379000
OCBUFGOT EQU   OCBACKUP+2                                               02380000
OCBUFNED EQU   OCBACKUP                                                 02381000
OCWTG    EQU   IEDQOPCE+30                                              02382000
OCRESNUM EQU   OCPARM                                                   02383000
OCSEQ    EQU   OCTRUNIT+2                                               02384000
@NM00148 EQU   OCRSID+1                                                 02385000
OCNONE   EQU   OCALSTAT                                                 02386000
OCSOME   EQU   OCALSTAT                                                 02387000
OCALLFLG EQU   OCALSTAT                                                 02388000
OCACTREQ EQU   OCALSTAT                                                 02389000
OCREDRVE EQU   OCALSTAT                                                 02390000
OCSEQIND EQU   OCALSTAT                                                 02391000
@NM00147 EQU   OCALSTAT                                                 02392000
OCRENTRD EQU   OCALSTAT                                                 02393000
OCWTGB   EQU   OCTIOT                                                   02394000
@NM00146 EQU   @NM00145+2                                               02395000
OCCONID  EQU   OCDEST                                                   02396000
OCRLN    EQU   IEDQOPCE+15                                              02397000
OCRESP   EQU   OCFLAG                                                   02398000
OCATTACH EQU   OCFLAG                                                   02399000
OCSSCP   EQU   OCFLAG                                                   02400000
OCOUTPUT EQU   OCFLAG                                                   02401000
OCLINE   EQU   OCFLAG                                                   02402000
OCMPP    EQU   OCFLAG                                                   02403000
OCTOTE   EQU   OCFLAG                                                   02404000
OCCONSOL EQU   OCFLAG                                                   02405000
@NM00144 EQU   OCSWITCH                                                 02406000
OCQUCKN  EQU   OCSWITCH                                                 02407000
OCPRIFLG EQU   OCOPTCDE                                                 02408000
@NM00143 EQU   OCRUDEST+1                                               02409000
@NM00142 EQU   OCSCAN                                                   02410000
OCNOTUCB EQU   OCSCAN                                                   02411000
OCNONAME EQU   OCSCAN                                                   02412000
OCALLRLN EQU   OCSCAN                                                   02413000
OCDDNAME EQU   OCSCAN                                                   02414000
OCDDNRLN EQU   OCSCAN                                                   02415000
OCADDR   EQU   OCSCAN                                                   02416000
OCELMPTR EQU   OCELEM+1                                                 02417000
OCELMPRI EQU   OCELEM                                                   02418000
OCLINK   EQU   IEDQOPCE                                                 02419000
DCBBUFSI EQU   IHADCS43+6                                               02420000
DCBUNTCT EQU   IHADCS43+5                                               02421000
DCBILCT  EQU   IHADCS43+4                                               02422000
DCBSCTAD EQU   DCBSCTAB+1                                               02423000
@NM00141 EQU   DCBSCTAB                                                 02424000
DCBPUTA  EQU   DCBGETA                                                  02425000
@NM00140 EQU   DCBPUT                                                   02426000
DCBDEBA  EQU   DCBDEBAD+1                                               02427000
@NM00139 EQU   DCBIFLGS                                                 02428000
DCBIFIOE EQU   DCBIFLGS                                                 02429000
DCBCH12  EQU   DCBIFPCT                                                 02430000
DCBCH9   EQU   DCBIFPCT                                                 02431000
DCBIFEC  EQU   DCBIFLGS                                                 02432000
DCBMFSTI EQU   DCBMFDMD                                                 02433000
DCBMFAWR EQU   DCBMFSTK                                                 02434000
DCBMFUIP EQU   DCBMFTMD                                                 02435000
DCBMFIDW EQU   DCBMFLCP                                                 02436000
DCBMFWRK EQU   DCBMFMVP                                                 02437000
DCBMFRDQ EQU   DCBMFWRT                                                 02438000
DCBMFGTQ EQU   DCBMFPUT                                                 02439000
DCBMFSTL EQU   DCBMACF2                                                 02440000
DCBMFCK  EQU   DCBMFDMG                                                 02441000
DCBMFRDX EQU   DCBMFCHK                                                 02442000
DCBMFDBF EQU   DCBMFSBG                                                 02443000
DCBMFRDI EQU   DCBMFLCG                                                 02444000
DCBMFRDK EQU   DCBMFMVG                                                 02445000
DCBMFWRQ EQU   DCBMFRD                                                  02446000
DCBMFPTQ EQU   DCBMFGET                                                 02447000
DCBMFECP EQU   DCBMACF1                                                 02448000
DCBMRSTI EQU   DCBMRDMD                                                 02449000
DCBMRAWR EQU   DCBMRSTK                                                 02450000
DCBMRUIP EQU   DCBMRTMD                                                 02451000
DCBMRIDW EQU   DCBMRLCP                                                 02452000
DCBMRWRK EQU   DCBMRMVP                                                 02453000
DCBMRRDQ EQU   DCBMRWRT                                                 02454000
DCBMRGTQ EQU   DCBMRPUT                                                 02455000
DCBMRSTL EQU   DCBMACR2                                                 02456000
DCBMRCK  EQU   DCBMRDMG                                                 02457000
DCBPGFXA EQU   DCBMRRDX                                                 02458000
DCBMRDBF EQU   DCBMRSBG                                                 02459000
DCBMRRDI EQU   DCBMRLCG                                                 02460000
DCBMRRDK EQU   DCBMRMVG                                                 02461000
DCBMRWRQ EQU   DCBMRRD                                                  02462000
DCBMRPTQ EQU   DCBMRGET                                                 02463000
DCBMRECP EQU   DCBMACR1                                                 02464000
@NM00138 EQU   DCBIFLG                                                  02465000
DCBIBIOE EQU   DCBIFLG                                                  02466000
DCBICH12 EQU   DCBIBPCT                                                 02467000
DCBICH9  EQU   DCBIBPCT                                                 02468000
DCBIBEC  EQU   DCBIFLG                                                  02469000
DCBOFIOF EQU   DCBOFLGS                                                 02470000
DCBOFUEX EQU   DCBOFLGS                                                 02471000
DCBOFTM  EQU   DCBOFLGS                                                 02472000
DCBOFPPC EQU   DCBOFLGS                                                 02473000
DCBOFOPN EQU   DCBOFLGS                                                 02474000
DCBOFEOV EQU   DCBOFLGS                                                 02475000
DCBOFLRB EQU   DCBOFLGS                                                 02476000
DCBOFIOD EQU   DCBOFLWR                                                 02477000
DCBDDNAM EQU   IHADCS24                                                 02478000
DCBEXLSA EQU   DCBEXLST+1                                               02479000
DCBEIOBX EQU   DCBEXLST                                                 02480000
DCBRNCKA EQU   DCBRNCKD+1                                               02481000
@NM00137 EQU   DCBRNCKD                                                 02482000
DCBIOBAD EQU   IHADCS2K+8                                               02483000
DCBDSGTR EQU   DCBDSRG2                                                 02484000
@NM00136 EQU   DCBDSRG2                                                 02485000
DCBDSRG1 EQU   DCBDSORG                                                 02486000
DCBCHNGL EQU   DCBTRSTA                                                 02487000
DCBNIDLE EQU   DCBTRSTA                                                 02488000
DCBBAKUP EQU   DCBTRSTA                                                 02489000
DCBIPLED EQU   DCBTRSTA                                                 02490000
DCBRSTRT EQU   DCBTRSTA                                                 02491000
DCBINITL EQU   DCBTRSTA                                                 02492000
DCBAUTOD EQU   DCBTRSTA                                                 02493000
DCBAUTOI EQU   DCBTRSTA                                                 02494000
@NM00135 EQU   IHADCS2K+4                                               02495000
DCBDUMPA EQU   DCBDUMPD+1                                               02496000
DCBUNITN EQU   DCBDUMPD                                                 02497000
DCBBCKUA EQU   DCBBCKUP+1                                               02498000
@NM00134 EQU   DCBBCKUP                                                 02499000
DCBIPLTX EQU   IHADCS1A                                                 02500000
@NM00133 EQU   IHADCB                                                   02501000
CVTLEVL  EQU   CVTRELNO+2                                               02502000
CVTNUMB  EQU   CVTRELNO                                                 02503000
CVTMDL   EQU   CVTFIX+250                                               02504000
@NM00132 EQU   CVTFIX+248                                               02505000
@NM00131 EQU   CVTFIX                                                   02506000
CVTRV482 EQU   CVTXTNT2+128                                             02507000
CVTRV481 EQU   CVTXTNT2+124                                             02508000
CVTRV480 EQU   CVTXTNT2+120                                             02509000
CVTRV479 EQU   CVTXTNT2+118                                             02510000
CVTRV478 EQU   CVTXTNT2+117                                             02511000
CVTRV477 EQU   CVTXTNT2+116                                             02512000
CVTRV476 EQU   CVTXTNT2+115                                             02513000
CVTRV475 EQU   CVTXTNT2+114                                             02514000
CVTRV474 EQU   CVTRV466                                                 02515000
CVTRV473 EQU   CVTRV466                                                 02516000
CVTRV472 EQU   CVTRV466                                                 02517000
CVTRV471 EQU   CVTRV466                                                 02518000
CVTRV470 EQU   CVTRV466                                                 02519000
CVTRV469 EQU   CVTRV466                                                 02520000
CVTRV468 EQU   CVTRV466                                                 02521000
CVTRV467 EQU   CVTRV466                                                 02522000
CVTRV465 EQU   CVTRV457                                                 02523000
CVTRV464 EQU   CVTRV457                                                 02524000
CVTRV463 EQU   CVTRV457                                                 02525000
CVTRV462 EQU   CVTRV457                                                 02526000
CVTRV461 EQU   CVTRV457                                                 02527000
CVTRV460 EQU   CVTRV457                                                 02528000
CVTRV459 EQU   CVTRV457                                                 02529000
CVTRV458 EQU   CVTRV457                                                 02530000
CVTRV456 EQU   CVTXTNT2+108                                             02531000
CVTRV455 EQU   CVTXTNT2+104                                             02532000
CVTRV454 EQU   CVTXTNT2+100                                             02533000
CVTRV453 EQU   CVTXTNT2+96                                              02534000
CVTRV452 EQU   CVTXTNT2+94                                              02535000
CVTRV451 EQU   CVTXTNT2+92                                              02536000
CVTRV450 EQU   CVTXTNT2+90                                              02537000
CVTRV449 EQU   CVTXTNT2+88                                              02538000
CVTRV448 EQU   CVTXTNT2+87                                              02539000
CVTRV447 EQU   CVTXTNT2+86                                              02540000
CVTRV446 EQU   CVTRV438                                                 02541000
CVTRV445 EQU   CVTRV438                                                 02542000
CVTRV444 EQU   CVTRV438                                                 02543000
CVTRV443 EQU   CVTRV438                                                 02544000
CVTRV442 EQU   CVTRV438                                                 02545000
CVTRV441 EQU   CVTRV438                                                 02546000
CVTRV440 EQU   CVTRV438                                                 02547000
CVTRV439 EQU   CVTRV438                                                 02548000
CVTRV437 EQU   CVTRV429                                                 02549000
CVTRV436 EQU   CVTRV429                                                 02550000
CVTRV435 EQU   CVTRV429                                                 02551000
CVTRV434 EQU   CVTRV429                                                 02552000
CVTRV433 EQU   CVTRV429                                                 02553000
CVTRV432 EQU   CVTRV429                                                 02554000
CVTRV431 EQU   CVTRV429                                                 02555000
CVTRV430 EQU   CVTRV429                                                 02556000
CVTRV428 EQU   CVTXTNT2+80                                              02557000
CVTRV427 EQU   CVTXTNT2+76                                              02558000
CVTRV426 EQU   CVTXTNT2+72                                              02559000
CVTRV425 EQU   CVTXTNT2+68                                              02560000
CVTATACT EQU   CVTATCVT                                                 02561000
CVTRV423 EQU   CVTXTNT2+62                                              02562000
CVTRV422 EQU   CVTXTNT2+60                                              02563000
CVTRV421 EQU   CVTXTNT2+58                                              02564000
CVTRV420 EQU   CVTXTNT2+56                                              02565000
CVTRV419 EQU   CVTXTNT2+55                                              02566000
CVTRV418 EQU   CVTXTNT2+54                                              02567000
CVTRV417 EQU   CVTRV409                                                 02568000
CVTRV416 EQU   CVTRV409                                                 02569000
CVTRV415 EQU   CVTRV409                                                 02570000
CVTRV414 EQU   CVTRV409                                                 02571000
CVTRV413 EQU   CVTRV409                                                 02572000
CVTRV412 EQU   CVTRV409                                                 02573000
CVTRV411 EQU   CVTRV409                                                 02574000
CVTRV410 EQU   CVTRV409                                                 02575000
CVTRV408 EQU   CVTRV400                                                 02576000
CVTRV407 EQU   CVTRV400                                                 02577000
CVTRV406 EQU   CVTRV400                                                 02578000
CVTRV405 EQU   CVTRV400                                                 02579000
CVTRV404 EQU   CVTRV400                                                 02580000
CVTRV403 EQU   CVTRV400                                                 02581000
CVTRV402 EQU   CVTRV400                                                 02582000
CVTRV401 EQU   CVTRV400                                                 02583000
CVTICB   EQU   CVTXTNT2+48                                              02584000
CVTSKTA  EQU   CVTXTNT2+44                                              02585000
CVTSHSB  EQU   CVTSHS                                                   02586000
CVTRSV98 EQU   CVTXTNT2+36                                              02587000
CVTRSV97 EQU   CVTXTNT2+34                                              02588000
CVTRSV96 EQU   CVTXTNT2+32                                              02589000
CVTOLTEP EQU   CVTXTNT2+28                                              02590000
CVTQIDA  EQU   CVTQID+1                                                 02591000
CVTRSV95 EQU   CVTQID                                                   02592000
CVTRSV94 EQU   CVTXTNT2+20                                              02593000
CVTRSV93 EQU   CVTXTNT2+16                                              02594000
CVTRSV92 EQU   CVTXTNT2+12                                              02595000
CVTDEBVR EQU   CVTXTNT2+8                                               02596000
CVTRSV91 EQU   CVTXTNT2+6                                               02597000
CVTRSV9H EQU   CVTFLGBT                                                 02598000
CVTRSV9G EQU   CVTFLGBT                                                 02599000
CVTRSV9F EQU   CVTFLGBT                                                 02600000
CVTRSV9E EQU   CVTFLGBT                                                 02601000
CVTRSV9D EQU   CVTFLGBT                                                 02602000
CVTRSV9C EQU   CVTFLGBT                                                 02603000
CVTVME   EQU   CVTFLGBT                                                 02604000
CVTNPE   EQU   CVTFLGBT                                                 02605000
CVTNUCLS EQU   CVTXTNT2+4                                               02606000
CVTDSSVA EQU   CVTDSSV+1                                                02607000
CVTRSV89 EQU   CVTDSSV                                                  02608000
CVTRSV88 EQU   CVTXTNT1+8                                               02609000
CVTRSV87 EQU   CVTXTNT1+4                                               02610000
CVTFACHN EQU   CVTXTNT1                                                 02611000
CVTRV488 EQU   CVTMAP+412                                               02612000
CVTRV487 EQU   CVTMAP+408                                               02613000
CVTRV486 EQU   CVTMAP+404                                               02614000
CVTRV485 EQU   CVTMAP+400                                               02615000
CVTACTAP EQU   CVTMAP+396                                               02616000
CVTAUTH  EQU   CVTMAP+392                                               02617000
CVTATMCA EQU   CVTATMCT+1                                               02618000
CVTATMST EQU   CVTATMCT                                                 02619000
CVTRSV61 EQU   CVTMAP+384                                               02620000
CVTVOLT1 EQU   CVTVOLM1+1                                               02621000
CVTVOLI1 EQU   CVTVOLF1                                                 02622000
CVTSTOA  EQU   CVTMAP+376                                               02623000
CVTRSV58 EQU   CVTMAP+374                                               02624000
CVTRSV57 EQU   CVTMAP+372                                               02625000
CVTDDCE  EQU   CVTMAP+368                                               02626000
CVTPNWFR EQU   CVTMAP+364                                               02627000
CVTSMF   EQU   CVTMAP+360                                               02628000
CVTSULK  EQU   CVTMAP+358                                               02629000
CVTSLKO  EQU   CVTSYSK                                                  02630000
CVTSLKP  EQU   CVTSYSK                                                  02631000
CVTSLKQ  EQU   CVTSYSK                                                  02632000
CVTSLKR  EQU   CVTSYSK                                                  02633000
CVTRSV56 EQU   CVTSYSK                                                  02634000
CVTRSV55 EQU   CVTSYSK                                                  02635000
CVTRSV54 EQU   CVTSYSK                                                  02636000
CVTRSV53 EQU   CVTSYSK                                                  02637000
CVTRSV52 EQU   CVTA1F1                                                  02638000
CVTRSV51 EQU   CVTA1F1                                                  02639000
CVTRSV50 EQU   CVTA1F1                                                  02640000
CVTRSV49 EQU   CVTA1F1                                                  02641000
CVTRSV48 EQU   CVTA1F1                                                  02642000
CVTRSV47 EQU   CVTA1F1                                                  02643000
CVTSRSW  EQU   CVTA1F1                                                  02644000
CVTPFSW  EQU   CVTA1F1                                                  02645000
CVTPCVT  EQU   CVTMAP+352                                               02646000
CVTRSV46 EQU   CVTMAP+344                                               02647000
CVTRSV45 EQU   CVTMAP+340                                               02648000
CVTRSV44 EQU   CVTMAP+338                                               02649000
CVTRSV43 EQU   CVTMAP+336                                               02650000
CVTHJESA EQU   CVTHJES+1                                                02651000
CVTRSV42 EQU   CVTHJES                                                  02652000
CVTEXT2A EQU   CVTEXT2+1                                                02653000
CVTRSV41 EQU   CVTEXT2                                                  02654000
CVTAPFA  EQU   CVTAPF+1                                                 02655000
CVTRSV40 EQU   CVTAPF                                                   02656000
CVTRV518 EQU   CVTINTLA                                                 02657000
CVTRV517 EQU   CVTERPV                                                  02658000
CVTEORM  EQU   CVTMAP+312                                               02659000
CVTMCHPR EQU   CVTMAP+308                                               02660000
CVTTZ    EQU   CVTMAP+304                                               02661000
CVTJEPS  EQU   CVTMAP+300                                               02662000
CVTJESCT EQU   CVTMAP+296                                               02663000
CVTMODE  EQU   CVTMAP+292                                               02664000
CVTPTRV  EQU   CVTMAP+288                                               02665000
CVTREAL  EQU   CVTMAP+284                                               02666000
CVTRSV39 EQU   CVTMAP+280                                               02667000
CVTRSV38 EQU   CVTMAP+276                                               02668000
CVTDMSRA EQU   CVTDMSR+1                                                02669000
CVTRV634 EQU   CVTDMSRF                                                 02670000
CVTRV633 EQU   CVTDMSRF                                                 02671000
CVTRV632 EQU   CVTDMSRF                                                 02672000
CVTRV631 EQU   CVTDMSRF                                                 02673000
CVTRV630 EQU   CVTDMSRF                                                 02674000
CVTRV629 EQU   CVTDMSRF                                                 02675000
CVTUDUMP EQU   CVTDMSRF                                                 02676000
CVTSDUMP EQU   CVTDMSRF                                                 02677000
CVTQMSGA EQU   CVTQMSG+1                                                02678000
CVTRSV36 EQU   CVTQMSG                                                  02679000
CVTAMFF  EQU   CVTMAP+264                                               02680000
CVTPURGA EQU   CVTPURG+1                                                02681000
CVTRSV35 EQU   CVTPURG                                                  02682000
CVTCBSP  EQU   CVTMAP+256                                               02683000
CVTATERA EQU   CVTATER+1                                                02684000
CVTSYST  EQU   CVTATER                                                  02685000
CVTVOLT2 EQU   CVTTAT                                                   02686000
CVTVOLI2 EQU   CVTVOLF2                                                 02687000
CVTAQAVB EQU   CVTAQAVT+1                                               02688000
CVTRSV34 EQU   CVTTCMFG                                                 02689000
CVTRSV33 EQU   CVTTCMFG                                                 02690000
CVTRSV32 EQU   CVTTCMFG                                                 02691000
CVTRSV31 EQU   CVTTCMFG                                                 02692000
CVTRSV30 EQU   CVTTCMFG                                                 02693000
CVTRSV29 EQU   CVTTCMFG                                                 02694000
CVTRSV28 EQU   CVTTCMFG                                                 02695000
CVTTCRDY EQU   CVTTCMFG                                                 02696000
CVTGTFA  EQU   CVTGTF+1                                                 02697000
CVTRSV27 EQU   CVTGTFST                                                 02698000
CVTRNIO  EQU   CVTGTFST                                                 02699000
CVTUSR   EQU   CVTGTFST                                                 02700000
CVTRV318 EQU   CVTFORM                                                  02701000
CVTRV317 EQU   CVTTMODE                                                 02702000
CVTRV316 EQU   CVTSTATE                                                 02703000
CVTRV315 EQU   CVTGTFS                                                  02704000
CVTGTFAV EQU   CVTGTFS                                                  02705000
CVT0SCR1 EQU   CVTMAP+232                                               02706000
CVTRV515 EQU   CVTMAP+228                                               02707000
CVTRMS   EQU   CVTMAP+224                                               02708000
CVTPATCH EQU   CVTMAP+220                                               02709000
CVTTSCE  EQU   CVTMAP+216                                               02710000
CVTLNKSC EQU   CVTMAP+214                                               02711000
CVTQABST EQU   CVTMAP+212                                               02712000
CVTMDLDS EQU   CVTMAP+208                                               02713000
CVTUSER  EQU   CVTMAP+204                                               02714000
CVTABEND EQU   CVTMAP+200                                               02715000
CVTSMCA  EQU   CVTMAP+196                                               02716000
CVTRSV18 EQU   CVTMAP+192                                               02717000
CVTQLPAQ EQU   CVTMAP+188                                               02718000
CVTQCDSR EQU   CVTMAP+184                                               02719000
CVTRSV17 EQU   CVTOPTB                                                  02720000
CVTRSV16 EQU   CVTOPTB                                                  02721000
CVTFP    EQU   CVTOPTB                                                  02722000
CVTAPTHR EQU   CVTOPTB                                                  02723000
CVTNLOG  EQU   CVTOPTB                                                  02724000
CVTTOD   EQU   CVTOPTB                                                  02725000
CVTCTIMS EQU   CVTOPTB                                                  02726000
CVTPROT  EQU   CVTOPTB                                                  02727000
CVTXPFP  EQU   CVTOPTA                                                  02728000
CVTASCII EQU   CVTOPTA                                                  02729000
CVTRSV13 EQU   CVTOPTA                                                  02730000
CVTRSV12 EQU   CVTOPTA                                                  02731000
CVTNIP   EQU   CVTOPTA                                                  02732000
CVTDDR   EQU   CVTOPTA                                                  02733000
CVTAPR   EQU   CVTOPTA                                                  02734000
CVTCCH   EQU   CVTOPTA                                                  02735000
CVTSNCTR EQU   CVTMAP+180                                               02736000
CVTQMWR  EQU   CVTMAP+176                                               02737000
CVTQOCR  EQU   CVTMAP+172                                               02738000
CVT1EF00 EQU   CVTMAP+168                                               02739000
CVTMZ00  EQU   CVTMAP+164                                               02740000
CVTHEAD  EQU   CVTMAP+160                                               02741000
CVTRSV11 EQU   CVTMAP+156                                               02742000
CVT0PT01 EQU   CVTMAP+152                                               02743000
CVTMSER  EQU   CVTMAP+148                                               02744000
CVTRV516 EQU   CVTIERLC                                                 02745000
CVTILCH  EQU   CVTMAP+140                                               02746000
CVT0DS   EQU   CVTMAP+136                                               02747000
CVTFBOSV EQU   CVTMAP+132                                               02748000
CVTNUCB  EQU   CVTMAP+128                                               02749000
CVTIXAVL EQU   CVTMAP+124                                               02750000
CVTIOQET EQU   CVTMAP+120                                               02751000
CVTDCBA  EQU   CVTMAP+117                                               02752000
CVTMVS2  EQU   CVTDCB                                                   02753000
CVT6DAT  EQU   CVTDCB                                                   02754000
CVT4MPS  EQU   CVTDCB                                                   02755000
CVTRSV09 EQU   CVTDCB                                                   02756000
CVT4MS1  EQU   CVTDCB                                                   02757000
CVT2SPS  EQU   CVTDCB                                                   02758000
CVT1SSS  EQU   CVTDCB                                                   02759000
CVTRSV08 EQU   CVTDCB                                                   02760000
CVTSTB   EQU   CVTMAP+112                                               02761000
CVTQTD00 EQU   CVTMAP+108                                               02762000
CVTQTE00 EQU   CVTMAP+104                                               02763000
CVTCUCB  EQU   CVTMAP+100                                               02764000
CVTSJQ   EQU   CVTMAP+96                                                02765000
CVTPBLDL EQU   CVTMAP+92                                                02766000
CVTTPC   EQU   CVTMAP+88                                                02767000
CVTSVDCB EQU   CVTMAP+84                                                02768000
CVTBRET  EQU   CVTMAP+82                                                02769000
CVTEXIT  EQU   CVTMAP+80                                                02770000
CVT0FN00 EQU   CVTMAP+76                                                02771000
CVTDARA  EQU   CVTDAR+1                                                 02772000
CVTRSV07 EQU   CVTFLGS1                                                 02773000
CVTRSV06 EQU   CVTFLGS1                                                 02774000
CVTRSV05 EQU   CVTFLGS1                                                 02775000
CVTRSV04 EQU   CVTFLGS1                                                 02776000
CVTRSV03 EQU   CVTFLGS1                                                 02777000
CVTRSV02 EQU   CVTFLGS1                                                 02778000
CVTRSV01 EQU   CVTFLGS1                                                 02779000
CVTDMPLK EQU   CVTFLGS1                                                 02780000
CVTXITP  EQU   CVTMAP+68                                                02781000
CVTZDTAB EQU   CVTMAP+64                                                02782000
CVTMSLT  EQU   CVTMAP+60                                                02783000
CVTDATE  EQU   CVTMAP+56                                                02784000
CVTBTERM EQU   CVTMAP+52                                                02785000
CVTSYSAD EQU   CVTMAP+48                                                02786000
CVTXTLER EQU   CVTMAP+44                                                02787000
CVTILK2  EQU   CVTMAP+40                                                02788000
CVTILK1  EQU   CVTMAP+36                                                02789000
CVTPRLTV EQU   CVTMAP+32                                                02790000
CVTPCNVT EQU   CVTMAP+28                                                02791000
CVT0VL00 EQU   CVTMAP+24                                                02792000
CVTXAPG  EQU   CVTMAP+20                                                02793000
CVTBUF   EQU   CVTMAP+16                                                02794000
CVTJOB   EQU   CVTMAP+12                                                02795000
CVTLINK  EQU   CVTMAP+8                                                 02796000
CVT0EF00 EQU   CVTMAP+4                                                 02797000
CVTTCBP  EQU   CVTMAP                                                   02798000
CVT      EQU   CVTMAP                                                   02799000
@NM00130 EQU   CNRBHFUN                                                 02800000
CNRBHFN0 EQU   CNRBHFUN                                                 02801000
@NM00129 EQU   CNRCNTL+1                                                02802000
CKPIOTR  EQU   CKPAVT+21                                                02803000
CKPSUBT  EQU   CKPAVT+20                                                02804000
CKPLODPT EQU   CKPAVT+16                                                02805000
CKPRADDR EQU   CKPAVT+12                                                02806000
CKPNADDR EQU   CKPAVT+8                                                 02807000
CKPBIT2  EQU   CKPAVT+7                                                 02808000
CKPBIT1  EQU   CKPAVT+6                                                 02809000
CKPINTLV EQU   CKPAVT+4                                                 02810000
CKPOPCIN EQU   CKPAVT+2                                                 02811000
CKPOPCON EQU   CKPAVT                                                   02812000
CKPTYPE  EQU   CKPNRES+5                                                02813000
@NM00128 EQU   CKPNFLG                                                  02814000
CKPLULOG EQU   CKPNFLG                                                  02815000
CKPEPMOD EQU   CKPNFLG                                                  02816000
CKPRSACT EQU   CKPNFLG                                                  02817000
CKPREMB  EQU   CKPNFLG                                                  02818000
CKPCOHRT EQU   CKPNRES+2                                                02819000
CKPSUBST EQU   CKPNRES                                                  02820000
CKPCTSEC EQU   CKPREQTB+6                                               02821000
CKPCTOFF EQU   CKPREQTB+4                                               02822000
CKPCTTTR EQU   CKPREQTB+1                                               02823000
CKPCTDER EQU   CKPCTFLG                                                 02824000
CKPCTACT EQU   CKPCTFLG                                                 02825000
CREDEB   EQU   CREOFFS                                                  02826000
CREECB   EQU   IEDQCRED+8                                               02827000
@NM00127 EQU   CRELINK+1                                                02828000
CREPRI   EQU   CRELINK                                                  02829000
CREQCBAD EQU   IEDQCRED+1                                               02830000
CREKEY   EQU   IEDQCRED                                                 02831000
CDRKEY   EQU   IEDQCDRD+8                                               02832000
CDRTIME  EQU   IEDQCDRD+4                                               02833000
CDRDATE  EQU   IEDQCDRD                                                 02834000
CKPSECT1 EQU   CKPCNTLR+37                                              02835000
CKPTTRT1 EQU   CKPCNTLR+34                                              02836000
CKPSECIN EQU   CKPCNTLR+32                                              02837000
CKPSECCR EQU   CKPCNTLR+30                                              02838000
CKPSECLI EQU   CKPCNTLR+28                                              02839000
CKPSECLT EQU   CKPCNTLR+26                                              02840000
CKPINCLN EQU   CKPCNTLR+24                                              02841000
CKPTTRLI EQU   CKPCNTLR+21                                              02842000
CKPRPERT EQU   CKPCNTLR+20                                              02843000
CKPCKRLN EQU   CKPCNTLR+18                                              02844000
CKPCPERT EQU   CKPPRQNO                                                 02845000
CKPIPERT EQU   CKPCNTLR+16                                              02846000
CKPCPRCD EQU   CKPCNTLR+15                                              02847000
CKPCKRQS EQU   CKPCNTLR+14                                              02848000
CKPBPERR EQU   CKPCNTLR+12                                              02849000
CKPTTRIN EQU   CKPCNTLR+9                                               02850000
CKPINRNO EQU   CKPCNTLR+8                                               02851000
CKPTTRCR EQU   CKPCNTLR+5                                               02852000
CKPCRRNO EQU   CKPCNTLR+4                                               02853000
CKPINCNO EQU   CKPCNTLR+3                                               02854000
CKPINCNT EQU   CKPCNTLR+2                                               02855000
CKPTTRCT EQU   CKPCNTLR+1                                               02856000
CKPOPCRD EQU   CKPFLAGS                                                 02857000
CKPOPTFN EQU   CKPFLAGS                                                 02858000
CKPSTAIN EQU   CKPFLAGS                                                 02859000
CKPERR   EQU   CKPFLAGS                                                 02860000
@NM00115 EQU   CKPFLAGS                                                 02861000
CKPFSCN2 EQU   CKPFLAGS                                                 02862000
CKPFSCN1 EQU   CKPFLAGS                                                 02863000
CKPNORML EQU   CKPFLAGS                                                 02864000
@NM00114 EQU   CKPMSG+65                                                02865000
CKPMSGGL EQU   CKPMSG+61                                                02866000
@NM00113 EQU   CKPMSG+2                                                 02867000
CKPMSGLN EQU   CKPMSG                                                   02868000
CKPWKALN EQU   @NM00112+10                                              02869000
CKPRWBC  EQU   CKPRW+6                                                  02870000
@NM00111 EQU   CKPRW+5                                                  02871000
CKPRWFLG EQU   CKPRW+4                                                  02872000
CKPSCHID EQU   CKPCCWS+16                                               02873000
CKPSETSC EQU   CKPCCWS+8                                                02874000
CKPSEEKC EQU   CKPCCWS                                                  02875000
@NM00110 EQU   IEDQCKPD+164                                             02876000
CKPERRCT EQU   IEDQCKPD+163                                             02877000
CKPSWCH2 EQU   IEDQCKPD+162                                             02878000
CKPSWCH1 EQU   IEDQCKPD+161                                             02879000
CKPCRLEN EQU   IEDQCKPD+160                                             02880000
CKPPARM2 EQU   IEDQCKPD+156                                             02881000
CKPCPARM EQU   IEDQCKPD+148                                             02882000
CKPSECTR EQU   CKPCTTRB                                                 02883000
CKPLDRB  EQU   IEDQCKPD+140                                             02884000
CKPLREB  EQU   IEDQCKPD+136                                             02885000
CKPNDRB  EQU   @NM00109                                                 02886000
CKPIOQF  EQU   IEDQCKPD+128                                             02887000
CKPEPLOC EQU   CKPCNVRT                                                 02888000
CKPECB   EQU   IEDQCKPD+112                                             02889000
CKPIOR   EQU   CKPIOSK+7                                                02890000
CKPIOHH  EQU   CKPIOSK+5                                                02891000
CKPIOCC  EQU   CKPIOSK+3                                                02892000
CKPIOBB  EQU   CKPIOSK+1                                                02893000
CKPIOM   EQU   CKPIOSK                                                  02894000
CKPIORC  EQU   CKPIOB+30                                                02895000
CKPIOBCI EQU   CKPIOB+28                                                02896000
CKPIORST EQU   CKPIOB+25                                                02897000
@NM00108 EQU   CKPIOB+24                                                02898000
@NM00107 EQU   CKPIOB+20                                                02899000
CKPIOCPA EQU   CKPIOB+17                                                02900000
CKPIOSIO EQU   CKPIOB+16                                                02901000
CKPIOCSW EQU   CKPIOB+9                                                 02902000
CKPIOFL3 EQU   CKPIOB+8                                                 02903000
@NM00106 EQU   CKPIOECB+1                                               02904000
CKPIOSN1 EQU   CKPIOB+3                                                 02905000
CKPIOSN0 EQU   CKPIOB+2                                                 02906000
CKPIOFL2 EQU   CKPIOB+1                                                 02907000
CKPIOFL1 EQU   CKPIOB                                                   02908000
CAVTNQE  EQU   CAVTWL2+1                                                02909000
CAVTTIOE EQU   CAVTWL1+5                                                02910000
CAVTEOL1 EQU   CAVTWL1+4                                                02911000
CAVTTQE  EQU   CAVTWL1                                                  02912000
@NM00105 EQU   IEDQCKAD+10                                              02913000
CAVTFLGS EQU   IEDQCKAD+9                                               02914000
BDUXGRPH EQU   BDUEXRSP                                                 02915000
BDUXFINL EQU   BDUEXRSP                                                 02916000
BDUXINIT EQU   BDUEXRSP                                                 02917000
BDURESP  EQU   BDUSYRSP                                                 02918000
BDUPHASE EQU   BDUSYRSP                                                 02919000
BDUERROR EQU   BDUSYRSP                                                 02920000
BDUXERLK EQU   BDUBDUFG                                                 02921000
BDUALTAK EQU   BDUFNFLG                                                 02922000
BDUNEGAK EQU   BDUFNFLG                                                 02923000
BDUPOSAK EQU   BDUFNFLG                                                 02924000
BDUTPTX  EQU   BDUFNFLG                                                 02925000
BDUFRSTB EQU   BDUFNFLG                                                 02926000
BDULEADG EQU   BDUFNFLG                                                 02927000
BDUSTHDR EQU   BDUFNFLG                                                 02928000
SAVTBITN EQU   IEDNSVTD+312                                             02929000
@NM00104 EQU   SAVTCKQB+8                                               02930000
@NM00103 EQU   SAVTCKEC+1                                               02931000
@NM00102 EQU   SAVTCKCC                                                 02932000
SAVTCKPO EQU   SAVTCKCC                                                 02933000
SAVTCKWA EQU   SAVTCKCC                                                 02934000
SAVTCKCH EQU   SAVTCKTB+1                                               02935000
SAVTCKVT EQU   SAVTCKTB                                                 02936000
@NM00101 EQU   IEDNSVTD+297                                             02937000
SAVTRDFG EQU   SAVTRDRV+12                                              02938000
@NM00100 EQU   SAVTRDRV+5                                               02939000
SAVTRDPY EQU   SAVTRDRV+4                                               02940000
SAVTRDQB EQU   SAVTRDRV+1                                               02941000
SAVTRDKY EQU   SAVTRDRV                                                 02942000
SAVTNID  EQU   IEDNSVTD+280                                             02943000
SAVTDVAS EQU   IEDNSVTD+276                                             02944000
SAVTPLSZ EQU   IEDNSVTD+274                                             02945000
@NM00099 EQU   IEDNSVTD+273                                             02946000
SAVTSUBL EQU   IEDNSVTD+272                                             02947000
@NM00098 EQU   SAVTZELM+1                                               02948000
SAVTSUBM EQU   SAVTZELM                                                 02949000
SAVTMHDX EQU   IEDNSVTD+268                                             02950000
SAVTNAT1 EQU   IEDNSVTD+266                                             02951000
SAVTSH20 EQU   IEDNSVTD+264                                             02952000
SAVTLCBS EQU   IEDNSVTD+260                                             02953000
SAVTRNMP EQU   IEDNSVTD+256                                             02954000
SAVTTNTX EQU   IEDNSVTD+252                                             02955000
SAVTNAX  EQU   IEDNSVTD+248                                             02956000
SAVTSUBV EQU   IEDNSVTD+247                                             02957000
SAVTSUBA EQU   IEDNSVTD+246                                             02958000
SAVTSIBC EQU   IEDNSVTD+244                                             02959000
SAVTBSM  EQU   IEDNSVTD+240                                             02960000
SAVTSCPT EQU   SAVTTCPU                                                 02961000
SAVTRQTG EQU   IEDNSVTD+236                                             02962000
SAVTRQCH EQU   IEDNSVTD+232                                             02963000
SAVTMAND EQU   IEDNSVTD+228                                             02964000
SAVTSPLN EQU   IEDNSVTD+224                                             02965000
SAVTNADL EQU   IEDNSVTD+222                                             02966000
SAVTNATL EQU   IEDNSVTD+220                                             02967000
SAVTMHTB EQU   IEDNSVTD+216                                             02968000
SAVTSSMH EQU   IEDNSVTD+212                                             02969000
SAVTQRS  EQU   IEDNSVTD+208                                             02970000
SAVTRQIN EQU   IEDNSVTD+204                                             02971000
SAVTDFCO EQU   IEDNSVTD+200                                             02972000
SAVTSAO  EQU   IEDNSVTD+196                                             02973000
SAVTSARI EQU   IEDNSVTD+192                                             02974000
SAVTSAC  EQU   IEDNSVTD+188                                             02975000
SAVTSAI  EQU   IEDNSVTD+184                                             02976000
SAVTCSCI EQU   IEDNSVTD+180                                             02977000
SAVTSSRP EQU   IEDNSVTD+176                                             02978000
SAVTSSRQ EQU   IEDNSVTD+172                                             02979000
SAVTSCLU EQU   IEDNSVTD+168                                             02980000
SAVTXTRQ EQU   IEDNSVTD+164                                             02981000
@NM00097 EQU   IEDNSVTD+148                                             02982000
SAVTIPCQ EQU   IEDNSVTD+144                                             02983000
@NM00096 EQU   IEDNSVTD+136                                             02984000
SAVTXFMI EQU   IEDNSVTD+132                                             02985000
@NM00095 EQU   IEDNSVTD+124                                             02986000
SAVTXFMO EQU   IEDNSVTD+120                                             02987000
@NM00094 EQU   IEDNSVTD+116                                             02988000
SAVTSSSR EQU   IEDNSVTD+112                                             02989000
SAVTSCPQ EQU   IEDNSVTD+108                                             02990000
SAVTSLCB EQU   IEDNSVTD+104                                             02991000
SAVTLUSR EQU   IEDNSVTD+100                                             02992000
@NM00093 EQU   SAVTLUSQ+8                                               02993000
SAVTLUSP EQU   SAVTLUSQ+4                                               02994000
SAVTLUSB EQU   SAVTLUSQ                                                 02995000
@NM00092 EQU   IEDNSVTD+84                                              02996000
SAVTSAT  EQU   IEDNSVTD+80                                              02997000
SAVTNAT  EQU   IEDNSVTD+76                                              02998000
SAVTCLUP EQU   IEDNSVTD+72                                              02999000
SAVTPIUT EQU   IEDNSVTD+68                                              03000000
SAVTRNTA EQU   IEDNSVTD+64                                              03001000
SAVTDNIR EQU   IEDNSVTD+60                                              03002000
SAVTCNIR EQU   IEDNSVTD+56                                              03003000
SAVTFLDH EQU   IEDNSVTD+52                                              03004000
SAVTSRTN EQU   IEDNSVTD+48                                              03005000
SAVTSREQ EQU   IEDNSVTD+44                                              03006000
SAVTFAIL EQU   IEDNSVTD+42                                              03007000
SAVTSUSE EQU   IEDNSVTD+40                                              03008000
SAVTSIB  EQU   IEDNSVTD+36                                              03009000
SAVTPRTN EQU   IEDNSVTD+32                                              03010000
@NM00091 EQU   IEDNSVTD+28                                              03011000
SAVTWH20 EQU   IEDNSVTD+26                                              03012000
SAVTPWT  EQU   IEDNSVTD+24                                              03013000
SAVTPRTQ EQU   IEDNSVTD+20                                              03014000
SAVTPREQ EQU   IEDNSVTD+16                                              03015000
SAVTPH20 EQU   IEDNSVTD+14                                              03016000
SAVTPUSE EQU   IEDNSVTD+12                                              03017000
SAVTPLCB EQU   IEDNSVTD+8                                               03018000
SAVTPOOL EQU   IEDNSVTD+4                                               03019000
SAVTPRMT EQU   SAVTDIAF                                                 03020000
SAVTVIRT EQU   SAVTDIAF                                                 03021000
AVTCPBNO EQU   IEDQAVTD+1244                                            03022000
AVTHRESS EQU   IEDQAVTD+1243                                            03023000
@NM00090 EQU   IEDQAVTD+1242                                            03024000
@NM00089 EQU   IEDQAVTD+1241                                            03025000
@NM00088 EQU   IEDQAVTD+1240                                            03026000
@NM00087 EQU   IEDQAVTD+1237                                            03027000
@NM00086 EQU   IEDQAVTD+1236                                            03028000
AVTHRESE EQU   @NM00085                                                 03029000
AVTRADDR EQU   IEDQAVTD+1228                                            03030000
AVTNADDR EQU   IEDQAVTD+1224                                            03031000
AVTHRESN EQU   IEDQAVTD+1220                                            03032000
AVTVOLRN EQU   IEDQAVTD+1216                                            03033000
AVTTOTNN EQU   IEDQAVTD+1212                                            03034000
AVTTRCYN EQU   IEDQAVTD+1208                                            03035000
AVTRCTRN EQU   IEDQAVTD+1204                                            03036000
AVTNOVON EQU   IEDQAVTD+1200                                            03037000
AVTADEBN EQU   IEDQAVTD+1196                                            03038000
AVTVOLRR EQU   IEDQAVTD+1192                                            03039000
AVTTOTNR EQU   IEDQAVTD+1188                                            03040000
AVTTRCYR EQU   IEDQAVTD+1184                                            03041000
AVTRCTRR EQU   IEDQAVTD+1180                                            03042000
AVTNOVOR EQU   IEDQAVTD+1176                                            03043000
AVTADEBR EQU   IEDQAVTD+1172                                            03044000
AVTLODPT EQU   IEDQAVTD+1168                                            03045000
AVTIOBN  EQU   IEDQAVTD+1164                                            03046000
AVTIOBR  EQU   IEDQAVTD+1160                                            03047000
AVTCPBPT EQU   IEDQAVTD+1156                                            03048000
AVTFCPB  EQU   IEDQAVTD+1152                                            03049000
@NM00084 EQU   IEDQAVTD+1148                                            03050000
AVTINCPQ EQU   IEDQAVTD+1144                                            03051000
@NM00083 EQU   IEDQAVTD+1140                                            03052000
@NM00082 EQU   IEDQAVTD+1137                                            03053000
@NM00081 EQU   AVTBIT4                                                  03054000
@NM00080 EQU   AVTBIT4                                                  03055000
@NM00079 EQU   AVTBIT4                                                  03056000
@NM00078 EQU   AVTBIT4                                                  03057000
@NM00077 EQU   AVTBIT4                                                  03058000
@NM00076 EQU   AVTBIT4                                                  03059000
@NM00075 EQU   AVTBIT4                                                  03060000
AVTRUFTN EQU   AVTBIT4                                                  03061000
@NM00074 EQU   IEDQAVTD+1132                                            03062000
AVTNOBFQ EQU   IEDQAVTD+1128                                            03063000
@NM00073 EQU   IEDQAVTD+1124                                            03064000
AVTDKENQ EQU   IEDQAVTD+1120                                            03065000
@NM00072 EQU   IEDQAVTD+1116                                            03066000
AVTDKAPQ EQU   IEDQAVTD+1112                                            03067000
AVTCOPY  EQU   IEDQAVTD+1108                                            03068000
AVTIA    EQU   IEDQAVTD+1104                                            03069000
AVTFL    EQU   IEDQAVTD+1100                                            03070000
@NM00071 EQU   IEDQAVTD+1096                                            03071000
AVTNCPBQ EQU   IEDQAVTD+1092                                            03072000
AVTTOTNC EQU   IEDQAVTD+1088                                            03073000
AVTCMAX  EQU   IEDQAVTD+1084                                            03074000
AVTCMIN  EQU   IEDQAVTD+1080                                            03075000
AVTHM02  EQU   IEDQAVTD+1076                                            03076000
AVTOPCIN EQU   IEDQAVTD+1074                                            03077000
AVTDCTLN EQU   IEDQAVTD+1072                                            03078000
AVTOPMSK EQU   IEDQAVTD+1068                                            03079000
AVTDDFT  EQU   IEDQAVTD+1064                                            03080000
AVTSTEAL EQU   IEDQAVTD+1060                                            03081000
AVTOPTN  EQU   IEDQAVTD+1056                                            03082000
AVTDSKCT EQU   IEDQAVTD+1054                                            03083000
AVTCKRST EQU   IEDQAVTD+1053                                            03084000
AVTSTAN  EQU   AVTBIT3                                                  03085000
AVTSTACN EQU   AVTBIT3                                                  03086000
AVTSTAIN EQU   AVTBIT3                                                  03087000
AVTSTAYN EQU   AVTBIT3                                                  03088000
AVTOLTBN EQU   AVTBIT3                                                  03089000
AVTTSAB  EQU   AVTBIT3                                                  03090000
AVTRFULN EQU   AVTBIT3                                                  03091000
AVTRECVN EQU   AVTBIT3                                                  03092000
@NM00070 EQU   AVTBIT2                                                  03093000
@NM00069 EQU   AVTBIT2                                                  03094000
AVTOPEIN EQU   AVTBIT2                                                  03095000
AVTSTRTN EQU   AVTBIT2                                                  03096000
AVTTOPOL EQU   AVTBIT2                                                  03097000
AVTCOPYN EQU   AVTBIT2                                                  03098000
AVTREUSN EQU   AVTBIT2                                                  03099000
AVTEXTSC EQU   AVTBIT2                                                  03100000
AVTDISKN EQU   AVTBIT1                                                  03101000
AVTQUCKN EQU   AVTBIT1                                                  03102000
AVTCLOSN EQU   AVTBIT1                                                  03103000
AVTREADN EQU   AVTBIT1                                                  03104000
AVTDLAYN EQU   AVTBIT1                                                  03105000
AVTAQTAN EQU   AVTBIT1                                                  03106000
AVTTSON  EQU   AVTBIT1                                                  03107000
AVTAPLKN EQU   AVTBIT1                                                  03108000
AVTDUMBR EQU   IEDQAVTD+1048                                            03109000
AVTDLQX  EQU   IEDQAVTD+1046                                            03110000
AVTINTLV EQU   IEDQAVTD+1044                                            03111000
AVTSMCNT EQU   IEDQAVTD+1042                                            03112000
AVTAVFCT EQU   IEDQAVTD+1040                                            03113000
AVTOPCON EQU   IEDQAVTD+1038                                            03114000
AVTOPCNT EQU   IEDQAVTD+1036                                            03115000
AVTLNCNT EQU   IEDQAVTD+1034                                            03116000
AVTHA16  EQU   IEDQAVTD+1030                                            03117000
AVTHA7   EQU   IEDQAVTD+1028                                            03118000
AVTHA4   EQU   IEDQAVTD+1026                                            03119000
AVTHA3   EQU   IEDQAVTD+1024                                            03120000
AVTHA2   EQU   IEDQAVTD+1022                                            03121000
AVTGETMS EQU   IEDQAVTD+1021                                            03122000
@NM00068 EQU   IEDQAVTD+1020                                            03123000
AVTGETMD EQU   IEDQAVTD+1016                                            03124000
AVTGETMN EQU   IEDQAVTD+1012                                            03125000
AVTCWTOT EQU   IEDQAVTD+1008                                            03126000
AVTCWINT EQU   IEDQAVTD+956                                             03127000
AVTDTRAP EQU   IEDQAVTD+952                                             03128000
@NM00067 EQU   IEDQAVTD+950                                             03129000
@NM00066 EQU   AVTIOTR                                                  03130000
AVTIOTRH EQU   AVTIOTR                                                  03131000
AVTIOTRE EQU   AVTIOTR                                                  03132000
@NM00065 EQU   AVTSUBT                                                  03133000
AVTSUBPT EQU   AVTSUBT                                                  03134000
AVTSUBON EQU   AVTSUBT                                                  03135000
AVTAFE30 EQU   IEDQAVTD+944                                             03136000
AVTAFE20 EQU   IEDQAVTD+940                                             03137000
AVTAFE10 EQU   IEDQAVTD+936                                             03138000
AVTCWEC2 EQU   IEDQAVTD+932                                             03139000
AVTCWPM2 EQU   IEDQAVTD+928                                             03140000
AVTCWTS2 EQU   IEDQAVTD+927                                             03141000
AVTCWTS1 EQU   IEDQAVTD+926                                             03142000
AVTCWCLD EQU   AVTCWFL2                                                 03143000
AVTCWRAP EQU   AVTCWFL2                                                 03144000
@NM00064 EQU   AVTCWFL2                                                 03145000
@NM00063 EQU   AVTCWFL2                                                 03146000
@NM00062 EQU   AVTCWFL2                                                 03147000
@NM00061 EQU   AVTCWFL2                                                 03148000
@NM00060 EQU   AVTCWFL2                                                 03149000
AVTCWACT EQU   AVTCWFL2                                                 03150000
@NM00059 EQU   AVTCWFL1                                                 03151000
@NM00058 EQU   AVTCWFL1                                                 03152000
@NM00057 EQU   AVTCWFL1                                                 03153000
@NM00056 EQU   AVTCWFL1                                                 03154000
@NM00055 EQU   AVTCWFL1                                                 03155000
@NM00054 EQU   AVTCWFL1                                                 03156000
@NM00053 EQU   AVTCWFL1                                                 03157000
AVTCOMWN EQU   AVTCWFL1                                                 03158000
AVTCWEC1 EQU   IEDQAVTD+920                                             03159000
AVTCWPM1 EQU   IEDQAVTD+916                                             03160000
AVTCAREA EQU   IEDQAVTD+912                                             03161000
AVTFZERO EQU   IEDQAVTD+908                                             03162000
AVTCADDR EQU   IEDQAVTD+904                                             03163000
AVTCOREC EQU   IEDQAVTD+900                                             03164000
@NM00052 EQU   IEDQAVTD+892                                             03165000
AVTCPBCB EQU   IEDQAVTD+888                                             03166000
@NM00051 EQU   IEDQAVTD+880                                             03167000
AVTDSIOB EQU   IEDQAVTD+876                                             03168000
@NM00050 EQU   IEDQAVTD+868                                             03169000
AVTCPRMB EQU   IEDQAVTD+864                                             03170000
@NM00049 EQU   IEDQAVTD+856                                             03171000
AVTCLOSB EQU   IEDQAVTD+852                                             03172000
@NM00048 EQU   IEDQAVTD+844                                             03173000
AVTACTIB EQU   IEDQAVTD+840                                             03174000
@NM00047 EQU   IEDQAVTD+836                                             03175000
AVTOLTEB EQU   IEDQAVTD+832                                             03176000
AVTOLTCH EQU   AVTOLTQB+1                                               03177000
AVTOLTVT EQU   AVTOLTQB                                                 03178000
@NM00046 EQU   AVTOPCQB+8                                               03179000
@NM00045 EQU   AVTOPCEC+1                                               03180000
@NM00044 EQU   AVTOPCCC                                                 03181000
AVTOPCPO EQU   AVTOPCCC                                                 03182000
AVTOPCWA EQU   AVTOPCCC                                                 03183000
AVTOPCCH EQU   AVTOPCOB+1                                               03184000
AVTOPCVT EQU   AVTOPCOB                                                 03185000
@NM00043 EQU   AVTCKPQB+9                                               03186000
AVTCKPTS EQU   AVTCKPQB+8                                               03187000
@NM00042 EQU   AVTCKPEC+1                                               03188000
@NM00041 EQU   AVTCKPCC                                                 03189000
AVTCKPPO EQU   AVTCKPCC                                                 03190000
AVTCKPWA EQU   AVTCKPCC                                                 03191000
AVTCKPCH EQU   AVTCKPTB+1                                               03192000
AVTCKPVT EQU   AVTCKPTB                                                 03193000
@NM00040 EQU   IEDQAVTD+796                                             03194000
AVTBFRTB EQU   IEDQAVTD+792                                             03195000
@NM00039 EQU   IEDQAVTD+784                                             03196000
AVTBFREB EQU   IEDQAVTD+780                                             03197000
AVTTIMQ  EQU   IEDQAVTD+776                                             03198000
@NM00038 EQU   IEDQAVTD+772                                             03199000
AVTIMQPS EQU   IEDQAVTD+768                                             03200000
AVTINOUT EQU   IEDQAVTD+766                                             03201000
AVTREFTM EQU   IEDQAVTD+764                                             03202000
@NM00037 EQU   IEDQAVTD+752                                             03203000
AVTDELYB EQU   IEDQAVTD+748                                             03204000
AVTOCQPT EQU   IEDQAVTD+744                                             03205000
AVTTSOPT EQU   IEDQAVTD+740                                             03206000
AVTSUPPT EQU   IEDQAVTD+736                                             03207000
AVTCBQCB EQU   IEDQAVTD+732                                             03208000
AVTMSGS  EQU   IEDQAVTD+729                                             03209000
@NM00036 EQU   AVTSYSER                                                 03210000
@NM00035 EQU   AVTSYSER                                                 03211000
@NM00034 EQU   AVTSYSER                                                 03212000
@NM00033 EQU   AVTSYSER                                                 03213000
@NM00032 EQU   AVTSYSER                                                 03214000
@NM00031 EQU   AVTSYSER                                                 03215000
AVTCMAXN EQU   AVTSYSER                                                 03216000
AVTCMINN EQU   AVTSYSER                                                 03217000
AVT2260L EQU   IEDQAVTD+724                                             03218000
AVTABEPL EQU   AVTADBUF                                                 03219000
AVTHFF   EQU   AVTCLRHI+2                                               03220000
@NM00030 EQU   AVTCLRHI                                                 03221000
AVTDELAD EQU   IEDQAVTD+704                                             03222000
AVTDELEM EQU   IEDQAVTD+700                                             03223000
AVTBSX   EQU   AVTCKLNK                                                 03224000
AVTOPETR EQU   AVTHG01                                                  03225000
@NM00029 EQU   AVTCKBYT                                                 03226000
AVTCKONQ EQU   AVTCKBYT                                                 03227000
@NM00028 EQU   AVTCKBYT                                                 03228000
@NM00027 EQU   AVTCKBYT                                                 03229000
@NM00026 EQU   AVTCKBYT                                                 03230000
@NM00025 EQU   AVTCKBYT                                                 03231000
@NM00024 EQU   AVTCKBYT                                                 03232000
@NM00023 EQU   AVTCKBYT                                                 03233000
AVTOPERT EQU   IEDQAVTD+690                                             03234000
AVTOPXCL EQU   IEDQAVTD+688                                             03235000
AVTOPERL EQU   IEDQAVTD+687                                             03236000
@NM00022 EQU   IEDQAVTD+686                                             03237000
AVTCKTIM EQU   IEDQAVTD+684                                             03238000
AVTCKELV EQU   IEDQAVTD+682                                             03239000
AVTCPRCD EQU   IEDQAVTD+681                                             03240000
AVTWARMN EQU   AVTCKELF                                                 03241000
AVTCRTLN EQU   AVTCKELF                                                 03242000
AVTCPIPN EQU   AVTCKELF                                                 03243000
AVTCCLCN EQU   AVTCKELF                                                 03244000
AVTCINCN EQU   AVTCKELF                                                 03245000
@NM00021 EQU   AVTCKELF                                                 03246000
AVTCMCPN EQU   AVTCKELF                                                 03247000
AVTCRDYN EQU   AVTCKELF                                                 03248000
AVTCKQAD EQU   IEDQAVTD+677                                             03249000
AVTSCBSZ EQU   IEDQAVTD+676                                             03250000
@NM00020 EQU   IEDQAVTD+672                                             03251000
AVTCKELE EQU   IEDQAVTD+668                                             03252000
@NM00019 EQU   AVTCKPEL+8                                               03253000
AVTCKRLK EQU   AVTCKPEL+5                                               03254000
AVTCKRPR EQU   AVTCKPEL+4                                               03255000
AVTCKRMQ EQU   AVTCKRMV+1                                               03256000
AVTCKRKY EQU   AVTCKRMV                                                 03257000
AVTHK    EQU   IEDQAVTD+648                                             03258000
AVTHI    EQU   IEDQAVTD+644                                             03259000
AVTIOT   EQU   IEDQAVTD+640                                             03260000
AVTNX    EQU   IEDQAVTD+636                                             03261000
AVTTONE  EQU   IEDQAVTD+632                                             03262000
AVTA3TL  EQU   IEDQAVTD+628                                             03263000
AVTDMECB EQU   IEDQAVTD+624                                             03264000
AVTABEND EQU   IEDQAVTD+618                                             03265000
AVTPLCBN EQU   IEDQAVTD+616                                             03266000
@NM00018 EQU   AVTSAVTP+1                                               03267000
@NM00017 EQU   AVTSAVTF                                                 03268000
AVTSNA   EQU   AVTSAVTF                                                 03269000
AVTONSNA EQU   AVTSAVTF                                                 03270000
AVTVTMCP EQU   AVTSAVTF                                                 03271000
@NM00016 EQU   IEDQAVTD+608                                             03272000
AVTCMBSS EQU   IEDQAVTD+604                                             03273000
AVTRCV   EQU   IEDQAVTD+600                                             03274000
AVTSEND  EQU   IEDQAVTD+596                                             03275000
AVTCSCH  EQU   IEDQAVTD+592                                             03276000
AVTQ1    EQU   IEDQAVTD+588                                             03277000
AVTE7    EQU   IEDQAVTD+584                                             03278000
AVTHB    EQU   IEDQAVTD+580                                             03279000
AVTR1    EQU   IEDQAVTD+576                                             03280000
AVTBZ    EQU   IEDQAVTD+572                                             03281000
AVTEZ    EQU   IEDQAVTD+568                                             03282000
AVTEC    EQU   IEDQAVTD+564                                             03283000
AVTEW    EQU   IEDQAVTD+560                                             03284000
AVTNDIAL EQU   AVTSCOPT                                                 03285000
AVTN2741 EQU   AVTSCOPT                                                 03286000
AVTCONCO EQU   AVTSCOPT                                                 03287000
AVTCONC  EQU   AVTSCOPT                                                 03288000
AVTCMBUF EQU   AVTSCOPT                                                 03289000
AVTAPDMP EQU   AVTSCOPT                                                 03290000
@NM00015 EQU   AVTSCOPT                                                 03291000
AVTHA    EQU   AVTDISP                                                  03292000
AVTEA    EQU   IEDQAVTD+548                                             03293000
AVTAX    EQU   IEDQAVTD+544                                             03294000
AVTA3    EQU   IEDQAVTD+540                                             03295000
AVTGD    EQU   IEDQAVTD+536                                             03296000
AVTAL    EQU   IEDQAVTD+532                                             03297000
AVTOLTST EQU   AVTHG02                                                  03298000
AVTE8    EQU   IEDQAVTD+524                                             03299000
AVTUI    EQU   IEDQAVTD+520                                             03300000
AVTCOMPT EQU   IEDQAVTD+516                                             03301000
AVTCRSRF EQU   IEDQAVTD+512                                             03302000
@NM00014 EQU   IEDQAVTD+508                                             03303000
AVTKA02  EQU   IEDQAVTD+504                                             03304000
AVTOPTPT EQU   IEDQAVTD+500                                             03305000
AVTPCBPT EQU   IEDQAVTD+496                                             03306000
@NM00013 EQU   AVTECB1                                                  03307000
AVTCOMP  EQU   AVTECB1                                                  03308000
@NM00012 EQU   AVTECB1                                                  03309000
AVTOPECA EQU   IEDQAVTD+488                                             03310000
AVTOLECA EQU   IEDQAVTD+484                                             03311000
AVTCKECA EQU   IEDQAVTD+480                                             03312000
AVTCWECA EQU   IEDQAVTD+476                                             03313000
AVTCWTCB EQU   IEDQAVTD+472                                             03314000
AVTOLTCB EQU   IEDQAVTD+468                                             03315000
AVTOCTCB EQU   IEDQAVTD+464                                             03316000
AVTCKTCB EQU   IEDQAVTD+460                                             03317000
AVTAS    EQU   IEDQAVTD+456                                             03318000
AVTNOLBF EQU   IEDQAVTD+454                                             03319000
AVTNCKPR EQU   IEDQAVTD+453                                             03320000
AVTCIB   EQU   IEDQAVTD+452                                             03321000
AVTSPLPT EQU   IEDQAVTD+448                                             03322000
AVTMVBFR EQU   IEDQAVTD+444                                             03323000
AVTSBTA  EQU   IEDQAVTD+440                                             03324000
AVTRARTN EQU   IEDQAVTD+436                                             03325000
AVTBSCAN EQU   IEDQAVTD+432                                             03326000
AVTRDYA  EQU   IEDQAVTD+428                                             03327000
AVTDISTR EQU   IEDQAVTD+420                                             03328000
AVTPARM3 EQU   IEDQAVTD+416                                             03329000
@NM00011 EQU   AVTPKF                                                   03330000
@NM00010 EQU   AVTPKF                                                   03331000
@NM00009 EQU   AVTPKF                                                   03332000
AVTFTCHF EQU   AVTPKF                                                   03333000
@NM00008 EQU   AVTPKF                                                   03334000
@NM00007 EQU   AVTPKF                                                   03335000
@NM00006 EQU   AVTPKF                                                   03336000
@NM00005 EQU   AVTPKF                                                   03337000
AVTPARM  EQU   IEDQAVTD+408                                             03338000
AVTEXS2A EQU   IEDQAVTD+402                                             03339000
AVTEXA2S EQU   IEDQAVTD+396                                             03340000
@NM00004 EQU   AVTCKFLG                                                 03341000
AVTCKHLT EQU   AVTCKFLG                                                 03342000
AVTCKREQ EQU   AVTCKFLG                                                 03343000
AVTCKENV EQU   AVTCKFLG                                                 03344000
AVTCKNAC EQU   AVTCKFLG                                                 03345000
@NM00002 EQU   IEDQAVTD+384                                             03346000
AVTREADD EQU   IEDQAVTD+380                                             03347000
AVTREADY EQU   IEDQAVTD+376                                             03348000
AVTRACE  EQU   IEDQAVTD+372                                             03349000
AVTPASWD EQU   IEDQAVTD+360                                             03350000
AVTCTLCH EQU   IEDQAVTD+352                                             03351000
AVTDOUBL EQU   IEDQAVTD+344                                             03352000
AVTDOUBX EQU   IEDQAVTD+336                                             03353000
AVTDPARM EQU   IEDQAVTD+332                                             03354000
AVTCSTCS EQU   IEDQAVTD+328                                             03355000
AVTDLQ   EQU   AVTSAVEX+32                                              03356000
@NM00001 EQU   AVTSAVEX                                                 03357000
AVTSAVE4 EQU   IEDQAVTD+216                                             03358000
AVTSAVE3 EQU   IEDQAVTD+144                                             03359000
AVTSAVE2 EQU   IEDQAVTD+72                                              03360000
AVTSAVE1 EQU   IEDQAVTD                                                 03361000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      03362000
@RC00524 EQU   CE0001@                                                  03363000
@RC00580 EQU   CE0001@                                                  03364000
@RC00588 EQU   CE0001@                                                  03365000
@RC00634 EQU   CE0001@                                                  03366000
@RC00638 EQU   CE0001@                                                  03367000
@RC00661 EQU   CE0001@                                                  03368000
@RT00514 EQU   @RC00513                                                 03369000
@PB00002 EQU   @EL00001                                                 03370000
@ENDDATA EQU   *                                                        03371000
         END   IEDQNU,(C'PLS2124',0701,77109)                           03372000
./  ADD  SSI=71090775,NAME=IEDQNV
         TITLE 'IEDQNV,3705 RESTART READ                               *00001000
                        '                                               00002000
IEDQNV   CSECT ,                                                01S0001 00003000
@PROLOG  DS    0H                                               01S0002 00004000
*   RBASE=REG15;                    /* SET BASE REGISTER             */ 00005000
         LR    RBASE,REG15                                      02S0357 00006000
*   GEN REFS(RBASE) NOSETS;                                     02S0358 00007000
*                                   /*                                  00008000
         USING IEDQNV,RBASE            ESTABLISH ADDRESSABILITY         00009000
IEDQNV   IEDHJN AFTERHJN,HJN           MODULE IDENTIFICATION MACRO      00010000
*   STM(REG02,REG15,QNVSAV);        /* SAVE QNF'S REGISTERS          */ 00011000
         STM   REG02,REG15,QNVSAV                               02S0359 00012000
*   RCAVT=AVTCKAVT;                 /* GET ADDRESS OF THE CKPT AVT   */ 00013000
         L     RCAVT,AVTCKAVT-1(,RAVT)                          02S0360 00014000
         LA    RCAVT,0(,RCAVT)                                  02S0360 00015000
*   RCKPT=CAVTNWA;                  /* GET ADDR OF CKPT WORK AREA    */ 00016000
         L     RCKPT,CAVTNWA(,RCAVT)                            02S0361 00017000
*   ROPCE=OPCCKPTF;                 /* GET OPCE ADDRESS - OPCE TO BE    00018000
*                                      CKPT'D IS THE FIRST ONE ON THE   00019000
*                                      OP CONTROL QUEUE FOR     02S0362 00020000
*                                      CHECKPOINT                    */ 00021000
         L     @10,ROPCAVT(,RAVT)                               02S0362 00022000
         L     ROPCE,OPCCKPTF(,@10)                             02S0362 00023000
*   RSAVE=ADDR(CKPSAVE2);           /* SET UP SAVE AREA PTR          */ 00024000
         LA    RSAVE,CKPSAVE2(,RCKPT)                           02S0363 00025000
*   RFY                                                         02S0364 00026000
*     REG12 UNRSTD;                                             02S0364 00027000
*                                                               02S0365 00028000
*   /*****************************************************************/ 00029000
*   /*                                                               */ 00030000
*   /* PROCESS: THIS SEGMENT DOES THE PROCESSING THAT IS NECESSARY TO*/ 00031000
*   /* PERFORM THE FUNCTION OF THE MODULE.                           */ 00032000
*   /*                                                               */ 00033000
*   /*****************************************************************/ 00034000
*                                                               02S0365 00035000
*   FLAGS=''B;                      /* INITIALIZE FLAGS AND SWITCHES */ 00036000
         XC    FLAGS(4),FLAGS                                   02S0365 00037000
*   DO UNTIL LOOPFLAG=OFF;          /* LOOP UNTIL GET SOMETHING TO      00038000
*                                      SEND TO FF                    */ 00039000
@DL00366 DS    0H                                               02S0367 00040000
*     LOOPFLAG=OFF;                 /* TURN OFF LOOP FLAG            */ 00041000
         NI    LOOPFLAG,B'11111101'                             02S0367 00042000
*     IF CAVTWTG=0 THEN            /* IF NOT REQUEST FROM FF THEN   */ 00043000
         CLI   CAVTWTG(RCAVT),0                                 02S0368 00044000
         BE    @RF00368                                         02S0368 00045000
*       DO;                                                     02S0369 00046000
*                                                               02S0369 00047000
*         /***********************************************************/ 00048000
*         /*                                                         */ 00049000
*         /* READ AND CHECK RESOURCE RECORDS                         */ 00050000
*         /*                                                         */ 00051000
*         /***********************************************************/ 00052000
*                                                               02S0370 00053000
*                                                               03S0370 00054000
*         /***********************************************************/ 00055000
*         /*                                                         */ 00056000
*         /* PROCESS.READER: THIS SEGMENTDETERMINES IF THE READ JUST */ 00057000
*         /* COMPLETED WAS FOR FLIP-FLOP 1 OR 2 FOR THE RESOURCE. IF */ 00058000
*         /* COMPLETION OF 1, THEN THE READ FOR 2 IS INITIATED. IF   */ 00059000
*         /* THE COMPLETION IS FOR 2, THEN THE RESOURCE RECORDS ARE  */ 00060000
*         /* CHECKED TO DETERMINE IF THEY SHOULD BE GIVEN TO FF FOR  */ 00061000
*         /* PROCESSING. IF AN I/O ERROR IS ENCOUNTERED, THEN THE    */ 00062000
*         /* READ AREA IS CLEARED, AND PROCESSING CONTINUES.         */ 00063000
*         /*                                                         */ 00064000
*         /***********************************************************/ 00065000
*                                                               03S0370 00066000
*         IF CKPNTRK=0 THEN         /* IF THIS IS READ 1 THEN DO READ   00067000
*                                      2                             */ 00068000
         LH    @12,CKPNTRK(,RCKPT)                              03S0370 00069000
         LTR   @12,@12                                          03S0370 00070000
         BNZ   @RF00370                                         03S0370 00071000
*           DO;                                                 03S0371 00072000
*             IF CKPIOECC=CKPIOCOM THEN/* IF I/O ERROR              */ 00073000
         CLI   CKPIOECC(RCKPT),X'7F'                            03S0372 00074000
         BE    @RF00372                                         03S0372 00075000
*               DO;                                             03S0373 00076000
*                 STORCTR=CKPBLKSZ; /* SET UP SIZE TO BE CLEARED     */ 00077000
         LH    STORCTR,CKPBLKSZ(,RCKPT)                         03S0374 00078000
*                 RFY                                           03S0375 00079000
*                   REG08 RSTD;     /* RESTRICT REG                  */ 00080000
*                 REG08=NRAR1PTR;   /* POINT TO AREA TO BE CLEARED   */ 00081000
         L     @12,OCRSTGTM(,ROPCE)                             03S0376 00082000
         L     REG08,NRAR1PTR(,@12)                             03S0376 00083000
*                 CALL CLEARIT;     /* AND CLEAR IT                  */ 00084000
         BAL   @14,CLEARIT                                      03S0377 00085000
*                 RFY                                           03S0378 00086000
*                   REG08 UNRSTD;                               03S0378 00087000
*               END;                                            03S0379 00088000
*             ELSE                                              03S0380 00089000
*               ;                                               03S0380 00090000
@RF00372 DS    0H                                               03S0381 00091000
*             CKPNRSID=OCRESNUM;    /* SET RESOURCE ID               */ 00092000
         LH    @12,OCRESNUM(,ROPCE)                             03S0381 00093000
         N     @12,@CF02214                                     03S0381 00094000
         STH   @12,CKPNRSID(,RCKPT)                             03S0381 00095000
*             CKPNTRK=CKPTRKCN;     /* SET FOR READ                  */ 00096000
         LH    @12,CKPTRKCN(,RCKPT)                             03S0382 00097000
         STH   @12,CKPNTRK(,RCKPT)                              03S0382 00098000
*             CKPRWCMD=CKPREAD;     /* SET TO READ                   */ 00099000
         MVI   CKPRWCMD(RCKPT),X'06'                            03S0383 00100000
*             CKPRWADD=NRAR2PTR;    /* READ INTO READ 2 AREA         */ 00101000
         L     @12,OCRSTGTM(,ROPCE)                             03S0384 00102000
         MVC   CKPRWADD(3,RCKPT),NRAR2PTR+1(@12)                03S0384 00103000
*             CKPRWBC=CKPBLKSZ;     /* SET AMOUNT TO READ            */ 00104000
         LH    @12,CKPBLKSZ(,RCKPT)                             03S0385 00105000
         STH   @12,CKPRWBC(,RCKPT)                              03S0385 00106000
*             CALL IEDQNW;          /* INITIATE READ-WAIT            */ 00107000
         L     @15,CAVTCRIO(,RCAVT)                             03S0386 00108000
         BALR  @14,@15                                          03S0386 00109000
*             CAVTWTG=CKPRNCP;      /* SET WAIT RETURN TO THIS MODULE*/ 00110000
         MVI   CAVTWTG(RCAVT),X'70'                             03S0387 00111000
*           END;                                                03S0388 00112000
*         ELSE                      /* ELSE IS COMPLETION OF READ 2     00113000
*                                      SO COMPARE THE TWO            */ 00114000
*           DO;                                                 03S0389 00115000
         B     @RC00370                                         03S0389 00116000
@RF00370 DS    0H                                               03S0390 00117000
*             IF CKPIOECC=CKPIOCOM THEN/* IF I/O ERROR              */ 00118000
         CLI   CKPIOECC(RCKPT),X'7F'                            03S0390 00119000
         BE    @RF00390                                         03S0390 00120000
*               DO;                                             03S0391 00121000
*                 STORCTR=CKPBLKSZ; /* SET UP SIZE TO BE CLEARED     */ 00122000
         LH    STORCTR,CKPBLKSZ(,RCKPT)                         03S0392 00123000
*                 RFY                                           03S0393 00124000
*                   REG08 RSTD;     /* RESTRICT REG                  */ 00125000
*                 REG08=NRAR2PTR;   /* POINT TO AREA TO BE CLEARED   */ 00126000
         L     @12,OCRSTGTM(,ROPCE)                             03S0394 00127000
         L     REG08,NRAR2PTR(,@12)                             03S0394 00128000
*                 CALL CLEARIT;     /* AND CLEAR IT                  */ 00129000
         BAL   @14,CLEARIT                                      03S0395 00130000
*                 RFY                                           03S0396 00131000
*                   REG08 UNRSTD;                               03S0396 00132000
*               END;                                            03S0397 00133000
*             ELSE                                              03S0398 00134000
*               ;                                               03S0398 00135000
@RF00390 DS    0H                                               03S0399 00136000
*                                                               04S0399 00137000
*             /*******************************************************/ 00138000
*             /*                                                     */ 00139000
*             /* PROCESS.READER.CHECK: THIS SEGMENT COMPARES THE     */ 00140000
*             /* FLIP-FLOP 1 AND 2 RESOURCE RECORDS TO DETERMINE IF  */ 00141000
*             /* ANY COMMANDS HAVE BEEN CHECKPOINTED, AND IF SO WHICH*/ 00142000
*             /* RECORD IS THE MOST RECENT. THE MOST RECENT IS       */ 00143000
*             /* CHECKED TO SEE IF IS MORE CURRENT THAN THE DATE-TIME*/ 00144000
*             /* IN THE 3705 CONTROL RECORD. IF SO, IT IS TURNED OVER*/ 00145000
*             /* TO FF TO PROCESS. ELSE, ANOTHER READ CYCLE IS       */ 00146000
*             /* INITIATED                                           */ 00147000
*             /*                                                     */ 00148000
*             /*******************************************************/ 00149000
*                                                               04S0399 00150000
*             IF NRAR1PTR->CNRCNTL=0 THEN/* IF CMNDS ON THIS READ   */ 00151000
         L     @12,OCRSTGTM(,ROPCE)                             04S0399 00152000
         L     @10,NRAR1PTR(,@12)                               04S0399 00153000
         LH    @08,CNRCNTL(,@10)                                04S0399 00154000
         N     @08,@CF02214                                     04S0399 00155000
         LTR   @08,@08                                          04S0399 00156000
         BZ    @RF00399                                         04S0399 00157000
*               IF NRAR2PTR->CNRCNTL=0 THEN/* AND READ 2            */ 00158000
         L     @08,NRAR2PTR(,@12)                               04S0400 00159000
         LH    @02,CNRCNTL(,@08)                                04S0400 00160000
         N     @02,@CF02214                                     04S0400 00161000
         LTR   @02,@02                                          04S0400 00162000
         BZ    @RF00400                                         04S0400 00163000
*                 IF NRAR1PTR->CNRDATTM>NRAR2PTR->CNRDATTM THEN/* SET   00164000
*                                      PTR TO THE                    */ 00165000
         CLC   CNRDATTM(8,@10),CNRDATTM(@08)                    04S0401 00166000
         BNH   @RF00401                                         04S0401 00167000
*                   NRACURR=NRAR1PTR;/* MOST RECENT ONE              */ 00168000
         ST    @10,NRACURR(,@12)                                04S0402 00169000
*                 ELSE                                          04S0403 00170000
*                   NRACURR=NRAR2PTR;                           04S0403 00171000
         B     @RC00401                                         04S0403 00172000
@RF00401 L     @12,OCRSTGTM(,ROPCE)                             04S0403 00173000
         L     @10,NRAR2PTR(,@12)                               04S0403 00174000
         ST    @10,NRACURR(,@12)                                04S0403 00175000
*               ELSE                                            04S0404 00176000
*                 NRACURR=NRAR1PTR; /* POINT TO READ 1 IF ONLY       */ 00177000
         B     @RC00400                                         04S0404 00178000
@RF00400 L     @12,OCRSTGTM(,ROPCE)                             04S0404 00179000
         L     @10,NRAR1PTR(,@12)                               04S0404 00180000
         ST    @10,NRACURR(,@12)                                04S0404 00181000
*             ELSE                                              04S0405 00182000
*               IF NRAR2PTR->CNRCNTL=0 THEN/* IF NO RD 1 BUT SOME RD   00183000
*                                      2 THEN                        */ 00184000
         B     @RC00399                                         04S0405 00185000
@RF00399 L     @12,OCRSTGTM(,ROPCE)                             04S0405 00186000
         L     @10,NRAR2PTR(,@12)                               04S0405 00187000
         LH    @08,CNRCNTL(,@10)                                04S0405 00188000
         N     @08,@CF02214                                     04S0405 00189000
         LTR   @08,@08                                          04S0405 00190000
         BZ    @RF00405                                         04S0405 00191000
*                 NRACURR=NRAR2PTR; /* POINT TO RD 2                 */ 00192000
         ST    @10,NRACURR(,@12)                                04S0406 00193000
*               ELSE                /* SET TO READ NEXT IF NONE TO BE   00194000
*                                      PROCESSED                     */ 00195000
*                 DO;                                           04S0407 00196000
         B     @RC00405                                         04S0407 00197000
@RF00405 DS    0H                                               04S0408 00198000
*                   CAVTWTG=0;      /* RESET WTG                     */ 00199000
         MVI   CAVTWTG(RCAVT),X'00'                             04S0408 00200000
*                   LOOPFLAG=ON;    /* AND SET TO LOOP               */ 00201000
         OI    LOOPFLAG,B'00000010'                             04S0409 00202000
*                 END;                                          04S0410 00203000
*             IF LOOPFLAG=OFF THEN  /* IF FOUND ONE                  */ 00204000
@RC00405 DS    0H                                               04S0411 00205000
@RC00399 TM    LOOPFLAG,B'00000010'                             04S0411 00206000
         BNZ   @RF00411                                         04S0411 00207000
*               IF CKPDATTM<NRACURR->CNRDATTM THEN/* AND MORE RECENT    00208000
*                                      THAN LAST                     */ 00209000
         L     @12,OCRSTGTM(,ROPCE)                             04S0412 00210000
         L     @12,NRACURR(,@12)                                04S0412 00211000
         CLC   CKPDATTM(8,RCKPT),CNRDATTM(@12)                  04S0412 00212000
         BNL   @RF00412                                         04S0412 00213000
*                 CALL GO06;        /* SET UP TO GIVE TO FF FOR 04S0413 00214000
*                                      PROCESSING                    */ 00215000
         BAL   @14,GO06                                         04S0413 00216000
*               ELSE                                            04S0414 00217000
*                 DO;                                           04S0414 00218000
         B     @RC00412                                         04S0414 00219000
@RF00412 DS    0H                                               04S0415 00220000
*                   CAVTWTG=0;                                  04S0415 00221000
         MVI   CAVTWTG(RCAVT),X'00'                             04S0415 00222000
*                   LOOPFLAG=ON;                                04S0416 00223000
         OI    LOOPFLAG,B'00000010'                             04S0416 00224000
*                 END;                                          04S0417 00225000
*           END;                                                03S0418 00226000
*       END;                                                    02S0419 00227000
*     ELSE                          /* ELSE IS REQUEST FROM IGCFF10D */ 00228000
*       DO;                                                     02S0420 00229000
*                                                               02S0420 00230000
         B     @RC00368                                         02S0420 00231000
@RF00368 DS    0H                                               02S0421 00232000
*         /***********************************************************/ 00233000
*         /*                                                         */ 00234000
*         /* START READ PROCESSING                                   */ 00235000
*         /*                                                         */ 00236000
*         /***********************************************************/ 00237000
*                                                               02S0421 00238000
*                                                               03S0421 00239000
*         /***********************************************************/ 00240000
*         /*                                                         */ 00241000
*         /* PROCESS.STARTER: THIS SEGMENT IS INVOKED IF THE OPCE IS */ 00242000
*         /* A REQUEST FROM IGCFF10D TO FIND ANY APPLICABLE RESOURCE */ 00243000
*         /* RECORDS TO BE SENT BACK TO THE 3705. IF THE RESOURCE    */ 00244000
*         /* NUMBER IN THE OPCE IS 0, THIS IS THE FIRST REQUEST AND  */ 00245000
*         /* AN AREA MUST BE GETMAINED FOR THE READ AREA. IF THE     */ 00246000
*         /* NUMBER IS NOT 0, THEN THE READ AREA IS CLEARED. ONE IS  */ 00247000
*         /* ADDED TO THE RESOURCE NO. AND IF THE RESULTANT NO. IS   */ 00248000
*         /* NOT GREATER THAN THE TOTAL NO. OF RESOURCES, THEN A READ*/ 00249000
*         /* IS INITIATED FOR THE FIRST FLIP- FLOP RESOURCE RECORD   */ 00250000
*         /* FOR THE RESOURCE. IF THE NO. IS GREATER THAN THE TOTAL  */ 00251000
*         /* NO. OF RESOURCES, THE READ AREA IS FREEMAINED, AND THE  */ 00252000
*         /* RESOURCE NUMBER IS SET TO 0 TO SIGNAL FF THAT NO MORE   */ 00253000
*         /* RESOURCE RECORDS ARE TO BE READ.                        */ 00254000
*         /*                                                         */ 00255000
*         /***********************************************************/ 00256000
*                                                               03S0421 00257000
*         IF OCRESNUM=0 THEN       /* IF THIS IS NOT THE FIRST 03S0421 00258000
*                                      REQUEST FROM FF               */ 00259000
         LH    @12,OCRESNUM(,ROPCE)                             03S0421 00260000
         N     @12,@CF02214                                     03S0421 00261000
         LTR   @12,@12                                          03S0421 00262000
         BZ    @RF00421                                         03S0421 00263000
*           DO;                     /* THEN CLEAR THE READ AREAS     */ 00264000
*             RFY                                               03S0423 00265000
*               REG08 RSTD;         /* RESTRICT REG                  */ 00266000
*             REG08=ADDR(NRAREAD);  /* POINT TO READ AREA            */ 00267000
         L     REG08,OCRSTGTM(,ROPCE)                           03S0424 00268000
         LA    REG08,NRAREAD(,REG08)                            03S0424 00269000
*             STORCTR=(2*CKPBLKSZ); /* CLEAR BOTH READ AREAS         */ 00270000
         LH    STORCTR,CKPBLKSZ(,RCKPT)                         03S0425 00271000
         ALR   STORCTR,STORCTR                                  03S0425 00272000
*             CALL CLEARIT;         /* CALL THE CLEAR ROUTINE        */ 00273000
         BAL   @14,CLEARIT                                      03S0426 00274000
*             RFY                                               03S0427 00275000
*               REG08 UNRSTD;       /* RELEASE REG                   */ 00276000
*           END;                                                03S0428 00277000
*         ELSE                      /* ELSE MUST GETMAIN READ AREA   */ 00278000
*           DO;                                                 03S0429 00279000
         B     @RC00421                                         03S0429 00280000
@RF00421 DS    0H                                               03S0430 00281000
*                                                               04S0430 00282000
*             /*******************************************************/ 00283000
*             /*                                                     */ 00284000
*             /* PROCESS.STARTER.SETUP: THIS SEGMENT PERFORMS THE    */ 00285000
*             /* GETMAIN FOR THE READ AREA AND INITIALIZES IT. IF THE*/ 00286000
*             /* GETMAIN FAILS, A WTO IS PERFORMED TO NOTIFY THE     */ 00287000
*             /* OPERATOR, AND NO RESTART IS PERFORMED FOR THIS NCP. */ 00288000
*             /*                                                     */ 00289000
*             /*******************************************************/ 00290000
*                                                               04S0430 00291000
*             RFY                                               04S0430 00292000
*               RSTGSZ RSTD;        /* RESTRICT THE GETMAIN SIZE REG */ 00293000
*             RSTGSZ=(2*CKPBLKSZ)+(ADDR(NRAREAD)-ADDR(IEDNRA));/* SET   00294000
*                                      SIZE                          */ 00295000
         LH    RSTGSZ,CKPBLKSZ(,RCKPT)                          04S0431 00296000
         ALR   RSTGSZ,RSTGSZ                                    04S0431 00297000
         AL    RSTGSZ,@CF00169                                  04S0431 00298000
*             RPARM=ADDR(GETMLIST); /* SET PTR TO GETMAIN LIST       */ 00299000
         LA    RPARM,GETMLIST                                   04S0432 00300000
*             GEN REFS(GETMLIST,RSTGSZ) SETS(OCRSTGTM,REG15);   04S0433 00301000
*                                                /*                     00302000
     GETMAIN EC,LV=(RSTGSZ),A=OCRSTGTM(ROPCE),MF=(E,(1))                00303000
*             IF REG15=0 THEN       /* IF GETMAIN OK THEN INIT AREA  */ 00304000
         LTR   REG15,REG15                                      04S0434 00305000
         BNZ   @RF00434                                         04S0434 00306000
*               DO;                                             04S0435 00307000
*                 RFY                                           04S0436 00308000
*                   REG08 RSTD;     /* RESTRICT REG                  */ 00309000
*                 STORCTR=RSTGSZ;   /* SET STORCTR=SIZE TO CLEAR     */ 00310000
         LR    STORCTR,RSTGSZ                                   04S0437 00311000
*                 REG08=OCRSTGTM;   /* POINT REG08 TO AREA           */ 00312000
         L     REG08,OCRSTGTM(,ROPCE)                           04S0438 00313000
*                 CALL CLEARIT;     /* AND CLEAR THE AREA            */ 00314000
         BAL   @14,CLEARIT                                      04S0439 00315000
*                 NRASIZE=RSTGSZ;   /* SAVE THE AREA SIZE            */ 00316000
         L     @12,OCRSTGTM(,ROPCE)                             04S0440 00317000
         ST    RSTGSZ,NRASIZE(,@12)                             04S0440 00318000
*                 NRAR1PTR=ADDR(NRAREAD);/* SET PTR TO READ 1 AREA   */ 00319000
         LA    @10,NRAREAD(,@12)                                04S0441 00320000
         ST    @10,NRAR1PTR(,@12)                               04S0441 00321000
*                 NRAR2PTR=ADDR(NRAREAD)+CKPBLKSZ;/* SET PTR TO READ    00322000
*                                      2 AREA                        */ 00323000
         AH    @10,CKPBLKSZ(,RCKPT)                             04S0442 00324000
         ST    @10,NRAR2PTR(,@12)                               04S0442 00325000
*                 RFY                                           04S0443 00326000
*                   REG08 UNRSTD;                               04S0443 00327000
*               END;                                            04S0444 00328000
*             ELSE                  /* ELSE IF FAILURE THEN DO WTO   */ 00329000
*               DO;                                             04S0445 00330000
         B     @RC00434                                         04S0445 00331000
@RF00434 DS    0H                                               04S0446 00332000
*                 NAME=OCPTRSAV->OCBACKUP;/* PUT NCPNAME IN WTO TEXT */ 00333000
         L     @12,OCPTRSAV(,ROPCE)                             04S0446 00334000
         MVC   NAME(8),OCBACKUP(@12)                            04S0446 00335000
*                 RPARM=ADDR(WTOLIST);/* POINT TO WTOLIST            */ 00336000
         LA    RPARM,WTOLIST                                    04S0447 00337000
*                 GEN REFS(WTOLIST,RPARM) SETS(REG00);          04S0448 00338000
*                                       */                              00339000
     WTO MF=(E,(1))                                                     00340000
*                 OCRESNUM=CKPTRKCN;/* SET RESOURCE TO MAX TO GET OUT*/ 00341000
         LH    @12,CKPTRKCN(,RCKPT)                             04S0449 00342000
         STH   @12,OCRESNUM(,ROPCE)                             04S0449 00343000
*                 SKIPSW=ON;        /* SET TO BYPASS THE FREEMAIN    */ 00344000
         OI    SKIPSW,B'00000001'                               04S0450 00345000
*               END;                                            04S0451 00346000
*             RFY                                               04S0452 00347000
*               RSTGSZ UNRSTD;                                  04S0452 00348000
@RC00434 DS    0H                                               04S0453 00349000
*           END;                                                03S0453 00350000
*         OCRESNUM=OCRESNUM+1;      /* INCREMENT THE RESOURCE NUMBER */ 00351000
@RC00421 LA    @12,1                                            03S0454 00352000
         LH    @10,OCRESNUM(,ROPCE)                             03S0454 00353000
         N     @10,@CF02214                                     03S0454 00354000
         ALR   @12,@10                                          03S0454 00355000
         STH   @12,OCRESNUM(,ROPCE)                             03S0454 00356000
*         IF OCRESNUM>=CKPTRKCN THEN/* IF THE RESOURCE NUMBER IS GT     00357000
*                                      THE TOTAL                     */ 00358000
         CH    @12,CKPTRKCN(,RCKPT)                             03S0455 00359000
         BL    @RF00455                                         03S0455 00360000
*           DO;                     /* NUMBER OF RESOURCES THEN THRU    00361000
*                                      WITH RESTART                  */ 00362000
*             OCRESNUM=0;           /* SET RESOURCE NO TO 0          */ 00363000
         SLR   @12,@12                                          03S0457 00364000
         STH   @12,OCRESNUM(,ROPCE)                             03S0457 00365000
*             IF SKIPSW=OFF THEN    /* FREEMAIN THE AREA UNLESS      */ 00366000
         TM    SKIPSW,B'00000001'                               03S0458 00367000
         BNZ   @RF00458                                         03S0458 00368000
*               DO;                 /* WAS GETMAIN FAILURE           */ 00369000
*                 RFY                                           03S0460 00370000
*                   RSTGSZ RSTD;    /* RESTRICT REG WITH STORAGE SIZE*/ 00371000
*                 RSTGSZ=NRASIZE;   /* SET AREA SIZE IN REG          */ 00372000
         L     @12,OCRSTGTM(,ROPCE)                             03S0461 00373000
         L     RSTGSZ,NRASIZE(,@12)                             03S0461 00374000
*                 RPARM=ADDR(FREELIST);/* POINT REG1 TO FREEMAIN LIST*/ 00375000
         LA    RPARM,FREELIST                                   03S0462 00376000
*                 GEN REFS(FREELIST) SETS(RPARM,REG14);         03S0463 00377000
*                                          /*                           00378000
    FREEMAIN  E,LV=(RSTGSZ),A=OCRSTGTM(ROPCE),MF=(E,(1))                00379000
*                 RFY                                           03S0464 00380000
*                   RSTGSZ UNRSTD;  /* RELEASE REG                   */ 00381000
*               END;                                            03S0465 00382000
*             ELSE                                              03S0466 00383000
*               ;                                               03S0466 00384000
@RF00458 DS    0H                                               03S0467 00385000
*             CALL GO06;            /* SET UP TO GO TO 06            */ 00386000
         BAL   @14,GO06                                         03S0467 00387000
*           END;                                                03S0468 00388000
*         ELSE                      /* ELSE SETUP TO INITIATE READ   */ 00389000
*           DO;                                                 03S0469 00390000
         B     @RC00455                                         03S0469 00391000
@RF00455 DS    0H                                               03S0470 00392000
*             CKPNRSID=OCRESNUM;    /* SET RESOURCE NUMBER           */ 00393000
         LH    @12,OCRESNUM(,ROPCE)                             03S0470 00394000
         N     @12,@CF02214                                     03S0470 00395000
         STH   @12,CKPNRSID(,RCKPT)                             03S0470 00396000
*             CKPNTRK=0;            /* SET TO READ FLIP-FLOP 1       */ 00397000
         SLR   @12,@12                                          03S0471 00398000
         STH   @12,CKPNTRK(,RCKPT)                              03S0471 00399000
*             CKPRWCMD=CKPREAD;     /* SET TO READ                   */ 00400000
         MVI   CKPRWCMD(RCKPT),X'06'                            03S0472 00401000
*             CKPRWADD=NRAR1PTR;    /* POINT TO READ 1 AREA          */ 00402000
         L     @12,OCRSTGTM(,ROPCE)                             03S0473 00403000
         MVC   CKPRWADD(3,RCKPT),NRAR1PTR+1(@12)                03S0473 00404000
*             CKPRWBC=CKPBLKSZ;     /* SET READ SIZE                 */ 00405000
         LH    @12,CKPBLKSZ(,RCKPT)                             03S0474 00406000
         STH   @12,CKPRWBC(,RCKPT)                              03S0474 00407000
*             CALL IEDQNW;          /* START I/O AND SET UP WAIT LIST*/ 00408000
         L     @15,CAVTCRIO(,RCAVT)                             03S0475 00409000
         BALR  @14,@15                                          03S0475 00410000
*             CAVTWTG=CKPRNCP;      /* SET WTG BACK TO THIS MODULE   */ 00411000
         MVI   CAVTWTG(RCAVT),X'70'                             03S0476 00412000
*           END;                                                03S0477 00413000
*       END;                                                    02S0478 00414000
@RC00455 DS    0H                                               02S0479 00415000
*   END;                                                        02S0479 00416000
@RC00368 DS    0H                                               02S0479 00417000
@DE00366 TM    LOOPFLAG,B'00000010'                             02S0479 00418000
         BNZ   @DL00366                                         02S0479 00419000
*                                                               02S0480 00420000
*   /*****************************************************************/ 00421000
*   /*                                                               */ 00422000
*   /* EPILOGUE: THIS SEGMENT COMPLETES THE EPILOGUE CODE THAT WAS   */ 00423000
*   /* ALTERED BY THE MODULE PROCEDURE STATEMENT.                    */ 00424000
*   /*                                                               */ 00425000
*   /*****************************************************************/ 00426000
*                                                               02S0480 00427000
*   LM(REG02,REG15,QNVSAV);         /* RESTORE QNF'S REGISTERS       */ 00428000
         LM    REG02,REG15,QNVSAV                               02S0480 00429000
*   REG14=REG14+CKPRETNL;           /* RESTORE RETURN ADDRESS + 4       00430000
*                                      (WHICH INDICATES THAT NO OTHER   00431000
*                                      MODULE IS TO BE LOADED        */ 00432000
         AL    REG14,@CF00331                                   02S0481 00433000
*                                                               02S0482 00434000
*   /*****************************************************************/ 00435000
*   /*                                                               */ 00436000
*   /* PROCESS.CLEARER: THIS SEGMENT CLEARS THE AREA POINTED TO BY   */ 00437000
*   /* REG08 FOR A LENGTH SPECIFIED BY STORCTR                       */ 00438000
*   /*                                                               */ 00439000
*   /*****************************************************************/ 00440000
*                                                               02S0482 00441000
*CLEARIT:                                                       02S0482 00442000
*   PROC OPTIONS(RETREG,SAVE(14));                              02S0482 00443000
@EL00001 DS    0H                                               02S0482 00444000
@EF00001 DS    0H                                               02S0482 00445000
@ER00001 BR    @14                                              02S0482 00446000
CLEARIT  ST    @14,12(,@13)                                     02S0482 00447000
*   RFY                                                         02S0483 00448000
*     REG08 RSTD;                                               02S0483 00449000
*   DO UNTIL STORCTR=0;             /* LOOP TILL ALL CLEARED         */ 00450000
@DL00484 DS    0H                                               02S0485 00451000
*     IF STORCTR>=255 THEN          /* IF GT 255                     */ 00452000
         LA    @12,255                                          02S0485 00453000
         CR    STORCTR,@12                                      02S0485 00454000
         BL    @RF00485                                         02S0485 00455000
*       DO;                         /* CLEAR 255 BYTES               */ 00456000
*         REG08->CLEAR(1:255)=''B;                              02S0487 00457000
         XC    CLEAR(255,REG08),CLEAR(REG08)                    02S0487 00458000
*         REG08=REG08+255;          /* BUMP CLEAR ADDR               */ 00459000
         ALR   REG08,@12                                        02S0488 00460000
*         STORCTR=STORCTR-255;      /* DECREMENT STORAGE CLEAR SIZE  */ 00461000
         SLR   STORCTR,@12                                      02S0489 00462000
*       END;                                                    02S0490 00463000
*     ELSE                          /* ELSE CLEAR LT 255 BYTES       */ 00464000
*       DO;                         /* CLEAR THE REMAINDER           */ 00465000
         B     @RC00485                                         02S0491 00466000
@RF00485 DS    0H                                               02S0492 00467000
*         REG08->CLEAR(1:STORCTR)=REG08->CLEAR(1:STORCTR)&&REG08->CLEAR 00468000
*             (1:STORCTR);                                      02S0492 00469000
         LR    @12,STORCTR                                      02S0492 00470000
         BCTR  @12,0                                            02S0492 00471000
         EX    @12,@SX02217                                     02S0492 00472000
*         STORCTR=0;                /* FINISHED WITH CLEAR           */ 00473000
         SLR   STORCTR,STORCTR                                  02S0493 00474000
*       END;                                                    02S0494 00475000
*   END;                                                        02S0495 00476000
@RC00485 DS    0H                                               02S0495 00477000
@DE00484 LTR   STORCTR,STORCTR                                  02S0495 00478000
         BNZ   @DL00484                                         02S0495 00479000
*   RFY                                                         02S0496 00480000
*     REG08 UNRSTD;                                             02S0496 00481000
*   END CLEARIT;                                                02S0497 00482000
@EL00002 DS    0H                                               02S0497 00483000
@EF00002 DS    0H                                               02S0497 00484000
@ER00002 L     @14,12(,@13)                                     02S0497 00485000
         BR    @14                                              02S0497 00486000
*                                                               02S0498 00487000
*   /*****************************************************************/ 00488000
*   /*                                                               */ 00489000
*   /* PROCESS.GOTO06: THIS SEGMENT SETS UP TO GO TO 06              */ 00490000
*   /*                                                               */ 00491000
*   /*****************************************************************/ 00492000
*                                                               02S0498 00493000
*GO06:                                                          02S0498 00494000
*   PROC OPTIONS(RETREG,SAVE(14));                              02S0498 00495000
GO06     ST    @14,@SA00003                                     02S0498 00496000
*   CAVTEOL2=EOL;                   /* RESET END OF WAIT LIST TO THE    00497000
*                                      3705 CKPT QUEUE               */ 00498000
         MVI   CAVTEOL2(RCAVT),X'80'                            02S0499 00499000
*   CAVTEOL3=0;                     /* CLEAN UP WAIT LIST ENTRY ...  */ 00500000
         MVI   CAVTEOL3(RCAVT),X'00'                            02S0500 00501000
*   CAVTNIOE=0;                     /* ... FOR 3705 CKPT IO ECB      */ 00502000
         SLR   @12,@12                                          02S0501 00503000
         STCM  @12,7,CAVTNIOE(RCAVT)                            02S0501 00504000
*   CAVTWTG=0;                      /* CLEAR WHERE-TO-GO FIELD IN       00505000
*                                      CKPT AVT                      */ 00506000
         MVI   CAVTWTG(RCAVT),X'00'                             02S0502 00507000
*   CAVTNWA=0;                      /* CLEAR POINTER TO THE CKPT        00508000
*                                      WORKAREA                      */ 00509000
         ST    @12,CAVTNWA(,RCAVT)                              02S0503 00510000
*   AVTCCPRI=PRICKPT;               /* SET PRIORITY                  */ 00511000
         MVI   AVTCCPRI(RAVT),X'EC'                             02S0504 00512000
*   AVTCCQCB=ADDR(AVTOPCQB);        /* QUEUE REQUEST ELEMENT TO OP      00513000
*                                      CONTROL                       */ 00514000
         LA    @12,AVTOPCQB(,RAVT)                              02S0505 00515000
         STCM  @12,7,AVTCCQCB(RAVT)                             02S0505 00516000
*   RPARM=ADDR(AVTCCELE);           /* GET ADDRESS OF THE REQUEST       00517000
*                                      ELEMENT                       */ 00518000
         LA    RPARM,AVTCCELE(,RAVT)                            02S0506 00519000
*   REG15=CVTAQAVT;                 /* GET ADDRESS OF THE TCX        */ 00520000
         L     @12,CVTPTR                                       02S0507 00521000
         L     REG15,CVTAQAVT(,@12)                             02S0507 00522000
*   REG00=TCXREADY;                 /* GET ADDR OF TOP ELEMENT ON       00523000
*                                      ASYNCHRONOUS READY QUEUE      */ 00524000
         L     REG00,TCXREADY(,REG15)                           02S0508 00525000
*AGAIN:                                                         02S0509 00526000
*   AVTCCLNK=REG00;                 /* LINK REQUEST ELEMENT TO TOP ON   00527000
*                                      THE QUEUE                     */ 00528000
AGAIN    STCM  REG00,7,AVTCCLNK(RAVT)                           02S0509 00529000
*   CS(REG00,RPARM,TCXREADY);       /* UPDATE ASYNCHRONOUS READY        00530000
*                                      QUEUE                         */ 00531000
         CS    REG00,@01,TCXREADY(REG15)                        02S0510 00532000
*   BC(7,AGAIN);                    /* IF QUEUE WAS UPDATED     02S0511 00533000
*                                      ASYNCHRONOUSLY, TRY AGAIN     */ 00534000
         BC    7,AGAIN                                          02S0511 00535000
*   GEN REFS(AVTOSECB) SETS(REG00,RPARM);                       02S0512 00536000
*                                  /*                                   00537000
         POST  AVTOSECB(,RAVT)        POST TCAM'S MCP'S ECB COMPLETE    00538000
*   END GO06;                                                   02S0513 00539000
@EL00003 DS    0H                                               02S0513 00540000
@EF00003 DS    0H                                               02S0513 00541000
@ER00003 L     @14,@SA00003                                     02S0513 00542000
         BR    @14                                              02S0513 00543000
*   END IEDQNV                                                  01S0514 00544000
*                                                               01S0514 00545000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00546000
*/*%INCLUDE SYSLIB  (TAVTD   )                                       */ 00547000
*/*%INCLUDE SYSLIB  (TCAVTD  )                                       */ 00548000
*/*%INCLUDE SYSLIB  (TCNRD   )                                       */ 00549000
*/*%INCLUDE SYSLIB  (TCKPD   )                                       */ 00550000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 00551000
*/*%INCLUDE SYSLIB  (TNRAD   )                                       */ 00552000
*/*%INCLUDE SYSLIB  (TOPCED  )                                       */ 00553000
*/*%INCLUDE SYSLIB  (TOPCAVTD)                                       */ 00554000
*/*%INCLUDE SYSLIB  (TPRIOR  )                                       */ 00555000
*/*%INCLUDE SYSLIB  (TTCXD   )                                       */ 00556000
*/*%INCLUDE SYSUT5  (RFY     )                                       */ 00557000
*/*%INCLUDE SYSUT5  (DCL     )                                       */ 00558000
*/*%INCLUDE SYSUT5  (PROLOGUE)                                       */ 00559000
*/*%INCLUDE SYSUT5  (PROCESS )                                       */ 00560000
*/*%INCLUDE SYSUT5  (READER  )                                       */ 00561000
*/*%INCLUDE SYSUT5  (CHECK   )                                       */ 00562000
*/*%INCLUDE SYSUT5  (STARTER )                                       */ 00563000
*/*%INCLUDE SYSUT5  (SETUP   )                                       */ 00564000
*/*%INCLUDE SYSUT5  (EPILOGUE)                                       */ 00565000
*/*%INCLUDE SYSUT5  (CLEARER )                                       */ 00566000
*/*%INCLUDE SYSUT5  (GOTO06  )                                       */ 00567000
*                                                               01S0514 00568000
*       ;                                                       01S0514 00569000
@DATA    DS    0H                                                       00570000
@SX02217 XC    CLEAR(0,REG08),CLEAR(REG08)                              00571000
         DS    0F                                                       00572000
@SA00003 DS    1F                                                       00573000
         DS    0F                                                       00574000
@CF00331 DC    F'4'                                                     00575000
@CF00169 DC    F'16'                                                    00576000
@CF02214 DC    XL4'0000FFFF'                                            00577000
         DS    0D                                                       00578000
QNVSAV   DC    XL72'0'                                                  00579000
PATCH    DC    XL100'0'                                                 00580000
WTOLIST  DS    CL70                                                     00581000
         ORG   WTOLIST                                                  00582000
MSGLEN   DC    X'0042'                                                  00583000
MSGFLAGS DC    X'8000'                                                  00584000
MSGTEXT  DS    CL62                                                     00585000
         ORG   MSGTEXT                                                  00586000
MSGFST   DC    CL35'IED567I INSUFFICIENT CORE FOR 3705 '                00587000
NAME     DS    CL8                                                      00588000
MSGLST   DC    CL19' RESTART PROCESSING'                                00589000
         ORG   WTOLIST+66                                               00590000
DESCODE  DC    X'0400'                                                  00591000
RTGCODE  DC    X'4000'                                                  00592000
         ORG   WTOLIST+70                                               00593000
         DS    CL2                                                      00594000
FLAGS    DS    BL4                                                      00595000
         ORG   FLAGS                                                    00596000
@NM00163 DS    BL4                                                      00597000
LOOPFLAG EQU   FLAGS+3                                                  00598000
SKIPSW   EQU   FLAGS+3                                                  00599000
         ORG   FLAGS+4                                                  00600000
GETMLIST DS    CL10                                                     00601000
         ORG   GETMLIST                                                 00602000
@NM00164 DC    XL8'0'                                                   00603000
ECMODE   DC    X'20'                                                    00604000
SUBPOL   DC    X'00'                                                    00605000
         ORG   GETMLIST+10                                              00606000
         DS    CL2                                                      00607000
FREELIST DS    CL10                                                     00608000
         ORG   FREELIST                                                 00609000
@NM00165 DC    XL9'0'                                                   00610000
SUBPL    DC    X'00'                                                    00611000
         ORG   FREELIST+10                                              00612000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00613000
@01      EQU   01                                                       00614000
@02      EQU   02                                                       00615000
@03      EQU   03                                                       00616000
@04      EQU   04                                                       00617000
@05      EQU   05                                                       00618000
@06      EQU   06                                                       00619000
@07      EQU   07                                                       00620000
@08      EQU   08                                                       00621000
@09      EQU   09                                                       00622000
@10      EQU   10                                                       00623000
@11      EQU   11                                                       00624000
@12      EQU   12                                                       00625000
@13      EQU   13                                                       00626000
@14      EQU   14                                                       00627000
@15      EQU   15                                                       00628000
STORCTR  EQU   @02                                                      00629000
RCAVT    EQU   @05                                                      00630000
RCKPREC  EQU   @10                                                      00631000
RCKPT    EQU   @04                                                      00632000
RNRA     EQU   @06                                                      00633000
ROPCE    EQU   @03                                                      00634000
RAVT     EQU   @09                                                      00635000
REG15    EQU   @15                                                      00636000
REG00    EQU   @00                                                      00637000
RPARM    EQU   @01                                                      00638000
REG02    EQU   @02                                                      00639000
RSTGSZ   EQU   @07                                                      00640000
REG08    EQU   @08                                                      00641000
RBASE    EQU   @11                                                      00642000
REG12    EQU   @12                                                      00643000
RSAVE    EQU   @13                                                      00644000
REG14    EQU   @14                                                      00645000
REG01    EQU   @01                                                      00646000
REG03    EQU   @03                                                      00647000
REG04    EQU   @04                                                      00648000
REG05    EQU   @05                                                      00649000
REG06    EQU   @06                                                      00650000
REG07    EQU   @07                                                      00651000
REG2     EQU   @02                                                      00652000
CVTPTR   EQU   16                                                       00653000
IEDQAVTD EQU   0                                                        00654000
AVTSAVEX EQU   IEDQAVTD+288                                             00655000
@NM00003 EQU   IEDQAVTD+388                                             00656000
AVTCKFLG EQU   @NM00003                                                 00657000
AVTCKAVT EQU   @NM00003+1                                               00658000
AVTOCGET EQU   IEDQAVTD+392                                             00659000
AVTBASE  EQU   IEDQAVTD+412                                             00660000
AVTPKF   EQU   AVTBASE                                                  00661000
AVTOSECB EQU   IEDQAVTD+492                                             00662000
AVTECB1  EQU   AVTOSECB                                                 00663000
AVTHG02  EQU   IEDQAVTD+528                                             00664000
AVTDISP  EQU   IEDQAVTD+552                                             00665000
AVTHD    EQU   IEDQAVTD+556                                             00666000
AVTSCOPT EQU   AVTHD                                                    00667000
AVTSAVTP EQU   IEDQAVTD+612                                             00668000
AVTSAVTF EQU   AVTSAVTP                                                 00669000
AVTCKPEL EQU   IEDQAVTD+652                                             00670000
AVTCKRMV EQU   AVTCKPEL                                                 00671000
AVTCKELF EQU   IEDQAVTD+680                                             00672000
AVTCKBYT EQU   IEDQAVTD+691                                             00673000
AVTHG01  EQU   IEDQAVTD+692                                             00674000
AVTCKLNK EQU   IEDQAVTD+696                                             00675000
AVTCRELE EQU   IEDQAVTD+708                                             00676000
AVTCCELE EQU   AVTCRELE                                                 00677000
AVTCCQCB EQU   AVTCCELE+1                                               00678000
AVTCCPRI EQU   AVTCRELE+4                                               00679000
AVTCCLNK EQU   AVTCRELE+5                                               00680000
AVTCLRHI EQU   IEDQAVTD+716                                             00681000
AVTADBUF EQU   IEDQAVTD+720                                             00682000
AVTSYSER EQU   IEDQAVTD+728                                             00683000
AVTCKPQB EQU   IEDQAVTD+804                                             00684000
AVTCKPTB EQU   AVTCKPQB                                                 00685000
AVTCKPEC EQU   AVTCKPQB+4                                               00686000
AVTCKPCC EQU   AVTCKPEC                                                 00687000
AVTOPCQB EQU   IEDQAVTD+816                                             00688000
AVTOPCOB EQU   AVTOPCQB                                                 00689000
AVTOPCEC EQU   AVTOPCQB+4                                               00690000
AVTOPCCC EQU   AVTOPCEC                                                 00691000
AVTOLTQB EQU   IEDQAVTD+828                                             00692000
AVTCWFL1 EQU   IEDQAVTD+924                                             00693000
AVTCWFL2 EQU   IEDQAVTD+925                                             00694000
AVTSUBT  EQU   IEDQAVTD+948                                             00695000
AVTIOTR  EQU   IEDQAVTD+949                                             00696000
AVTBIT1  EQU   IEDQAVTD+1050                                            00697000
AVTBIT2  EQU   IEDQAVTD+1051                                            00698000
AVTBIT3  EQU   IEDQAVTD+1052                                            00699000
AVTBIT4  EQU   IEDQAVTD+1136                                            00700000
@NM00085 EQU   IEDQAVTD+1232                                            00701000
IEDQAPTR EQU   0                                                        00702000
IEDNSVTD EQU   0                                                        00703000
SAVTDIAG EQU   IEDNSVTD                                                 00704000
SAVTDIAF EQU   SAVTDIAG                                                 00705000
SAVTLUSQ EQU   IEDNSVTD+88                                              00706000
SAVTTCPU EQU   IEDNSVTD+238                                             00707000
SAVTZELM EQU   IEDNSVTD+270                                             00708000
SAVTRDRV EQU   IEDNSVTD+284                                             00709000
SAVTCKQB EQU   IEDNSVTD+300                                             00710000
SAVTCKTB EQU   SAVTCKQB                                                 00711000
SAVTCKEC EQU   SAVTCKQB+4                                               00712000
SAVTCKCC EQU   SAVTCKEC                                                 00713000
IEDQCKAD EQU   0                                                        00714000
CAVTNWA  EQU   IEDQCKAD+4                                               00715000
CAVTWTG  EQU   IEDQCKAD+8                                               00716000
CAVTWL1  EQU   IEDQCKAD+12                                              00717000
CAVTWL2  EQU   CAVTWL1+8                                                00718000
CAVTEOL2 EQU   CAVTWL2                                                  00719000
CAVTEOL3 EQU   CAVTWL2+4                                                00720000
CAVTNIOE EQU   CAVTWL2+5                                                00721000
CAVTCRIO EQU   IEDQCKAD+28                                              00722000
IEDQCNRD EQU   0                                                        00723000
CNRDATTM EQU   IEDQCNRD+2                                               00724000
CNRCNTL  EQU   IEDQCNRD+10                                              00725000
CNRBHSET EQU   IEDQCNRD+12                                              00726000
CNRBHFUN EQU   CNRBHSET                                                 00727000
IEDQCKPD EQU   0                                                        00728000
CKPIOB   EQU   IEDQCKPD+72                                              00729000
CKPIOECB EQU   CKPIOB+4                                                 00730000
CKPIOECC EQU   CKPIOECB                                                 00731000
CKPIOSK  EQU   CKPIOB+32                                                00732000
CKPEXCP  EQU   IEDQCKPD+116                                             00733000
CKPECBL  EQU   IEDQCKPD+120                                             00734000
CKPCNVRT EQU   CKPECBL                                                  00735000
CKPIOQL  EQU   IEDQCKPD+132                                             00736000
@NM00111 EQU   CKPIOQL                                                  00737000
CKPCTTRB EQU   IEDQCKPD+144                                             00738000
CKPCCWS  EQU   IEDQCKPD+168                                             00739000
CKPTIC   EQU   CKPCCWS+24                                               00740000
CKPRW    EQU   CKPCCWS+32                                               00741000
CKPRWCMD EQU   CKPRW                                                    00742000
CKPRWADD EQU   CKPRW+1                                                  00743000
CKPRWBC  EQU   CKPRW+6                                                  00744000
@NM00114 EQU   IEDQCKPD+208                                             00745000
CKPMSG   EQU   IEDQCKPD+220                                             00746000
CKPMSGTX EQU   CKPMSG+4                                                 00747000
CKPMSGTP EQU   CKPMSG+41                                                00748000
CKPCNTLR EQU   IEDQCKPD+288                                             00749000
CKPFLAGS EQU   CKPCNTLR                                                 00750000
CKPPRQNO EQU   CKPCNTLR+17                                              00751000
IEDQCDRD EQU   0                                                        00752000
CDRTTRLI EQU   IEDQCDRD+9                                               00753000
CDRDATA  EQU   IEDQCDRD+12                                              00754000
IEDQCRED EQU   0                                                        00755000
CRELINK  EQU   IEDQCRED+4                                               00756000
CREOFFS  EQU   IEDQCRED+12                                              00757000
CKPREQTB EQU   0                                                        00758000
CKPCTFLG EQU   CKPREQTB                                                 00759000
CKPNRES  EQU   0                                                        00760000
CKPNFLG  EQU   CKPNRES+4                                                00761000
CKPAVT   EQU   0                                                        00762000
CVTMAP   EQU   0                                                        00763000
CVTDAR   EQU   CVTMAP+72                                                00764000
CVTFLGS1 EQU   CVTDAR                                                   00765000
CVTDCB   EQU   CVTMAP+116                                               00766000
CVTIERLC EQU   CVTMAP+144                                               00767000
CVTOPTA  EQU   CVTMAP+182                                               00768000
CVTOPTB  EQU   CVTMAP+183                                               00769000
CVTGTF   EQU   CVTMAP+236                                               00770000
CVTGTFST EQU   CVTGTF                                                   00771000
CVTGTFS  EQU   CVTGTFST                                                 00772000
CVTSTATE EQU   CVTGTFST                                                 00773000
CVTTMODE EQU   CVTGTFST                                                 00774000
CVTFORM  EQU   CVTGTFST                                                 00775000
CVTAQAVT EQU   CVTMAP+240                                               00776000
CVTTCMFG EQU   CVTAQAVT                                                 00777000
CVTVOLM2 EQU   CVTMAP+244                                               00778000
CVTTATA  EQU   CVTVOLM2                                                 00779000
CVTTSKS  EQU   CVTTATA                                                  00780000
CVTVOLF2 EQU   CVTTSKS                                                  00781000
CVTTAT   EQU   CVTTATA+1                                                00782000
CVTATER  EQU   CVTMAP+248                                               00783000
CVTEXT1  EQU   CVTMAP+252                                               00784000
CVTPURG  EQU   CVTMAP+260                                               00785000
CVTQMSG  EQU   CVTMAP+268                                               00786000
CVTDMSR  EQU   CVTMAP+272                                               00787000
CVTRSV37 EQU   CVTDMSR                                                  00788000
CVTDMSRF EQU   CVTRSV37                                                 00789000
CVTERPV  EQU   CVTMAP+316                                               00790000
CVTINTLA EQU   CVTMAP+320                                               00791000
CVTAPF   EQU   CVTMAP+324                                               00792000
CVTEXT2  EQU   CVTMAP+328                                               00793000
CVTHJES  EQU   CVTMAP+332                                               00794000
CVTPGSIA EQU   CVTMAP+348                                               00795000
CVTA1F1  EQU   CVTMAP+356                                               00796000
CVTSYSK  EQU   CVTMAP+357                                               00797000
CVTVOLM1 EQU   CVTMAP+380                                               00798000
CVTVOLF1 EQU   CVTVOLM1                                                 00799000
CVTATMCT EQU   CVTMAP+388                                               00800000
CVTXTNT1 EQU   0                                                        00801000
CVTXTNT2 EQU   0                                                        00802000
CVTDSSV  EQU   CVTXTNT2                                                 00803000
CVTFLGBT EQU   CVTXTNT2+5                                               00804000
CVTQID   EQU   CVTXTNT2+24                                              00805000
CVTSHS   EQU   CVTXTNT2+40                                              00806000
CVTRV400 EQU   CVTXTNT2+52                                              00807000
CVTRV409 EQU   CVTXTNT2+53                                              00808000
CVTATCVT EQU   CVTXTNT2+64                                              00809000
CVTRV429 EQU   CVTXTNT2+84                                              00810000
CVTRV438 EQU   CVTXTNT2+85                                              00811000
CVTRV457 EQU   CVTXTNT2+112                                             00812000
CVTRV466 EQU   CVTXTNT2+113                                             00813000
CVTFIX   EQU   0                                                        00814000
CVTRELNO EQU   CVTFIX+252                                               00815000
IEDNRA   EQU   0                                                        00816000
NRACURR  EQU   IEDNRA                                                   00817000
NRASIZE  EQU   IEDNRA+4                                                 00818000
NRAR1PTR EQU   IEDNRA+8                                                 00819000
NRAR2PTR EQU   IEDNRA+12                                                00820000
NRAREAD  EQU   IEDNRA+16                                                00821000
IEDQOPCE EQU   0                                                        00822000
OCELEM   EQU   IEDQOPCE+4                                               00823000
OCUNIT   EQU   IEDQOPCE+8                                               00824000
OCRUDEST EQU   OCUNIT                                                   00825000
OCCKPKEY EQU   OCRUDEST                                                 00826000
OCSCAN   EQU   OCCKPKEY                                                 00827000
OCOPTCDE EQU   IEDQOPCE+12                                              00828000
OCSWITCH EQU   IEDQOPCE+13                                              00829000
OCFLAG   EQU   IEDQOPCE+14                                              00830000
@NM00136 EQU   IEDQOPCE+16                                              00831000
OCDEST   EQU   @NM00136                                                 00832000
OCREQVAL EQU   OCDEST+1                                                 00833000
OCLINENO EQU   IEDQOPCE+22                                              00834000
OCTIOT   EQU   OCLINENO                                                 00835000
OCTRUNIT EQU   IEDQOPCE+24                                              00836000
OCRSID   EQU   OCTRUNIT                                                 00837000
OCALSTAT EQU   OCRSID                                                   00838000
OCPARM   EQU   IEDQOPCE+28                                              00839000
OCRESNUM EQU   OCPARM                                                   00840000
OCBACKUP EQU   IEDQOPCE+32                                              00841000
OCMODNME EQU   IEDQOPCE+40                                              00842000
OCIPLWA  EQU   OCMODNME                                                 00843000
OCPTRSAV EQU   OCMODNME+4                                               00844000
OCCKDATA EQU   IEDQOPCE+48                                              00845000
OCRSTGTM EQU   OCCKDATA                                                 00846000
IEDQOPCN EQU   0                                                        00847000
OCLDNME  EQU   IEDQOPCN                                                 00848000
OCLINTTE EQU   OCLDNME                                                  00849000
OCREQFLG EQU   OCLINTTE+2                                               00850000
OCPREFLG EQU   OCLINTTE+3                                               00851000
IEDQOPCD EQU   0                                                        00852000
OPCAQCTL EQU   IEDQOPCD+180                                             00853000
OPCLDNME EQU   IEDQOPCD+212                                             00854000
OPCCKPTF EQU   IEDQOPCD+248                                             00855000
OPCSPEC  EQU   IEDQOPCD+300                                             00856000
OPCPWCOB EQU   IEDQOPCD+368                                             00857000
OPCPWQCB EQU   OPCPWCOB                                                 00858000
OPCPWECB EQU   OPCPWCOB+4                                               00859000
IEDQTCXD EQU   0                                                        00860000
TCXATTEN EQU   IEDQTCXD+4                                               00861000
TCXREADY EQU   IEDQTCXD+24                                              00862000
TCXFLAG1 EQU   IEDQTCXD+34                                              00863000
TCXBUFA  EQU   IEDQTCXD+80                                              00864000
TCXDSAVE EQU   IEDQTCXD+104                                             00865000
TCXQE8   EQU   IEDQTCXD+216                                             00866000
TCXPTR   EQU   0                                                        00867000
CLEAR    EQU   0                                                        00868000
IEDQNW   EQU   0                                                        00869000
CKPINIT  EQU   CKPEXCP                                                  00870000
CKPTWA   EQU   CKPMSGTX                                                 00871000
CKPSAVE2 EQU   CKPTWA                                                   00872000
CKPNCNTL EQU   CKPCNTLR                                                 00873000
CKPBLKSZ EQU   CKPNCNTL+12                                              00874000
CKPTRKCN EQU   CKPNCNTL+16                                              00875000
CKPDATTM EQU   CKPNCNTL+22                                              00876000
CKPNFLDS EQU   CKPEXCP                                                  00877000
CKPNSELT EQU   CKPNFLDS+16                                              00878000
CKPNTRK  EQU   CKPNFLDS+20                                              00879000
CKPNRSID EQU   CKPNFLDS+22                                              00880000
CKPOVER  EQU   CKPMSGTP+1                                               00881000
CKPOPNFL EQU   CKPFLAGS                                                 00882000
CDRINCFM EQU   CDRTTRLI                                                 00883000
CDRCREQR EQU   IEDQCDRD                                                 00884000
CDRCKFLG EQU   CDRCREQR                                                 00885000
CVTS01   EQU   CVTPGSIA                                                 00886000
CVTLPDIA EQU   CVTS01+12                                                00887000
CVTDIRST EQU   CVTLPDIA                                                 00888000
CVTSLIDA EQU   CVTS01+24                                                00889000
CVTCTLFG EQU   CVTS01+50                                                00890000
CVTRV210 EQU   CVTS01+424                                               00891000
CVTRV219 EQU   CVTS01+425                                               00892000
CVTRV228 EQU   CVTS01+426                                               00893000
CVTRV237 EQU   CVTS01+427                                               00894000
CVTMFRTR EQU   CVTS01+452                                               00895000
CVTRV262 EQU   CVTS01+468                                               00896000
CVTRV271 EQU   CVTS01+469                                               00897000
CVTRV280 EQU   CVTS01+470                                               00898000
CVTRV289 EQU   CVTS01+471                                               00899000
CVTGSDA  EQU   CVTS01+600                                               00900000
OCCKPKY1 EQU   OCCKPKEY                                                 00901000
OCCKPTYP EQU   OCCKPKY1                                                 00902000
OCICACTN EQU   OCMODNME                                                 00903000
OCICDADR EQU   OCICACTN                                                 00904000
OCICSW   EQU   OCICDADR+3                                               00905000
ROPCAVT  EQU   AVTOCGET                                                 00906000
OPCAQWD  EQU   OPCAQCTL                                                 00907000
OPCAQWD1 EQU   OPCAQWD                                                  00908000
OPCAQWD2 EQU   OPCAQWD+4                                                00909000
OPCAQWD3 EQU   OPCAQWD+8                                                00910000
CDROPCB  EQU   CDRDATA                                                  00911000
CKPMSGPN EQU   CKPMSGTP+6                                               00912000
CKPSLVAL EQU   CKPNSELT                                                 00913000
CKPTTRLT EQU   CKPTIC+5                                                 00914000
OCCIB    EQU   OCREQVAL                                                 00915000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00916000
OPCAQLST EQU   OPCAQWD3+1                                               00917000
OPCAQRQ3 EQU   OPCAQWD3                                                 00918000
OPCAQSEC EQU   OPCAQWD2+1                                               00919000
OPCAQRQ2 EQU   OPCAQWD2                                                 00920000
OPCAQFST EQU   OPCAQWD1+1                                               00921000
OPCAQREQ EQU   OPCAQWD1                                                 00922000
OCICINAC EQU   OCICSW                                                   00923000
@NM00142 EQU   OCICSW                                                   00924000
OCICATST EQU   OCICDADR+1                                               00925000
OCICTYPE EQU   OCICDADR                                                 00926000
@NM00141 EQU   OCCKPKY1                                                 00927000
OCCKPENV EQU   OCCKPKY1                                                 00928000
OCCKPRST EQU   OCCKPTYP                                                 00929000
OCCKPNCP EQU   OCCKPTYP                                                 00930000
OCCKPINC EQU   OCCKPTYP                                                 00931000
CVTRV628 EQU   CVTS01+728                                               00932000
CVTRV627 EQU   CVTS01+724                                               00933000
CVTRV626 EQU   CVTS01+720                                               00934000
CVTRV625 EQU   CVTS01+716                                               00935000
CVTRV624 EQU   CVTS01+712                                               00936000
CVTRV623 EQU   CVTS01+708                                               00937000
CVTRV622 EQU   CVTS01+704                                               00938000
CVTRV621 EQU   CVTS01+700                                               00939000
CVTRV620 EQU   CVTS01+696                                               00940000
CVTRV619 EQU   CVTS01+692                                               00941000
CVTRV618 EQU   CVTS01+688                                               00942000
CVTRV617 EQU   CVTS01+684                                               00943000
CVTRV616 EQU   CVTS01+680                                               00944000
CVTRV615 EQU   CVTS01+676                                               00945000
CVTRV614 EQU   CVTS01+672                                               00946000
CVTRV613 EQU   CVTS01+668                                               00947000
CVTTCASP EQU   CVTS01+664                                               00948000
CVT0PT03 EQU   CVTS01+660                                               00949000
CVT0PT0E EQU   CVTS01+656                                               00950000
CVTIRM   EQU   CVTS01+652                                               00951000
CVTCGK   EQU   CVTS01+648                                               00952000
CVTRV607 EQU   CVTS01+644                                               00953000
CVTRV606 EQU   CVTS01+640                                               00954000
CVTRV605 EQU   CVTS01+636                                               00955000
CVTRV604 EQU   CVTS01+632                                               00956000
CVTEFF02 EQU   CVTS01+628                                               00957000
CVTCBBR  EQU   CVTS01+624                                               00958000
CVTSSCR  EQU   CVTS01+620                                               00959000
CVTEVENT EQU   CVTS01+616                                               00960000
CVTCRCA  EQU   CVTS01+612                                               00961000
CVTTPIO  EQU   CVTS01+608                                               00962000
CVTADV   EQU   CVTS01+604                                               00963000
CVTGSDAB EQU   CVTGSDA                                                  00964000
CVTQV3   EQU   CVTS01+596                                               00965000
CVTQV2   EQU   CVTS01+592                                               00966000
CVTQV1   EQU   CVTS01+588                                               00967000
CVTRPT   EQU   CVTS01+584                                               00968000
CVTSSRB  EQU   CVTS01+580                                               00969000
CVTCSDRL EQU   CVTS01+576                                               00970000
CVTEXP1  EQU   CVTS01+572                                               00971000
CVTRMPMT EQU   CVTS01+568                                               00972000
CVTRMPTT EQU   CVTS01+564                                               00973000
CVTVPSA  EQU   CVTS01+560                                               00974000
CVTVSTOP EQU   CVTS01+556                                               00975000
CVTGTFR8 EQU   CVTS01+552                                               00976000
CVTQUIT  EQU   CVTS01+548                                               00977000
CVTVACR  EQU   CVTS01+544                                               00978000
CVTWTCB  EQU   CVTS01+540                                               00979000
CVTSTPRS EQU   CVTS01+536                                               00980000
CVT0PT02 EQU   CVTS01+532                                               00981000
CVTDARCM EQU   CVTS01+528                                               00982000
CVTIRECM EQU   CVTS01+524                                               00983000
CVTJRECM EQU   CVTS01+520                                               00984000
CVTVEMS0 EQU   CVTS01+516                                               00985000
CVTSPFRR EQU   CVTS01+512                                               00986000
CVTRLSTG EQU   CVTS01+508                                               00987000
CVT0TC0A EQU   CVTS01+504                                               00988000
CVTGMBR  EQU   CVTS01+500                                               00989000
CVTLFRM  EQU   CVTS01+496                                               00990000
CVTRMBR  EQU   CVTS01+492                                               00991000
CVTVIOP  EQU   CVTS01+488                                               00992000
CVTRV307 EQU   CVTS01+486                                               00993000
CVTRV306 EQU   CVTS01+484                                               00994000
CVTRV305 EQU   CVTS01+482                                               00995000
CVTRV304 EQU   CVTS01+480                                               00996000
CVTRV303 EQU   CVTS01+478                                               00997000
CVTRV302 EQU   CVTS01+476                                               00998000
CVTTRCA  EQU   CVTS01+472                                               00999000
CVTRV297 EQU   CVTRV289                                                 01000000
CVTRV296 EQU   CVTRV289                                                 01001000
CVTRV295 EQU   CVTRV289                                                 01002000
CVTRV294 EQU   CVTRV289                                                 01003000
CVTRV293 EQU   CVTRV289                                                 01004000
CVTRV292 EQU   CVTRV289                                                 01005000
CVTRV291 EQU   CVTRV289                                                 01006000
CVTRV290 EQU   CVTRV289                                                 01007000
CVTRV288 EQU   CVTRV280                                                 01008000
CVTRV287 EQU   CVTRV280                                                 01009000
CVTRV286 EQU   CVTRV280                                                 01010000
CVTRV285 EQU   CVTRV280                                                 01011000
CVTRV284 EQU   CVTRV280                                                 01012000
CVTRV283 EQU   CVTRV280                                                 01013000
CVTRV282 EQU   CVTRV280                                                 01014000
CVTRV281 EQU   CVTRV280                                                 01015000
CVTRV279 EQU   CVTRV271                                                 01016000
CVTRV278 EQU   CVTRV271                                                 01017000
CVTRV277 EQU   CVTRV271                                                 01018000
CVTRV276 EQU   CVTRV271                                                 01019000
CVTRV275 EQU   CVTRV271                                                 01020000
CVTRV274 EQU   CVTRV271                                                 01021000
CVTRV273 EQU   CVTRV271                                                 01022000
CVTRV272 EQU   CVTRV271                                                 01023000
CVTRV270 EQU   CVTRV262                                                 01024000
CVTRV269 EQU   CVTRV262                                                 01025000
CVTRV268 EQU   CVTRV262                                                 01026000
CVTRV267 EQU   CVTRV262                                                 01027000
CVTRV266 EQU   CVTRV262                                                 01028000
CVTRV265 EQU   CVTRV262                                                 01029000
CVTRV264 EQU   CVTRV262                                                 01030000
CVTRV263 EQU   CVTRV262                                                 01031000
CVTVFP   EQU   CVTS01+464                                               01032000
CVTVSI   EQU   CVTS01+460                                               01033000
CVTVPSIB EQU   CVTS01+456                                               01034000
CVTMFACT EQU   CVTMFRTR                                                 01035000
CVTMFCTL EQU   CVTS01+448                                               01036000
CVTPVBP  EQU   CVTS01+444                                               01037000
CVTPWI   EQU   CVTS01+440                                               01038000
CVTRV254 EQU   CVTS01+438                                               01039000
CVTRV253 EQU   CVTS01+436                                               01040000
CVTRV252 EQU   CVTS01+434                                               01041000
CVTRV251 EQU   CVTS01+433                                               01042000
CVTRV250 EQU   CVTS01+432                                               01043000
CVTRV249 EQU   CVTS01+431                                               01044000
CVTRV248 EQU   CVTS01+430                                               01045000
CVTRV247 EQU   CVTS01+429                                               01046000
CVTRV246 EQU   CVTS01+428                                               01047000
CVTRV245 EQU   CVTRV237                                                 01048000
CVTRV244 EQU   CVTRV237                                                 01049000
CVTRV243 EQU   CVTRV237                                                 01050000
CVTRV242 EQU   CVTRV237                                                 01051000
CVTRV241 EQU   CVTRV237                                                 01052000
CVTRV240 EQU   CVTRV237                                                 01053000
CVTRV239 EQU   CVTRV237                                                 01054000
CVTRV238 EQU   CVTRV237                                                 01055000
CVTRV236 EQU   CVTRV228                                                 01056000
CVTRV235 EQU   CVTRV228                                                 01057000
CVTRV234 EQU   CVTRV228                                                 01058000
CVTRV233 EQU   CVTRV228                                                 01059000
CVTRV232 EQU   CVTRV228                                                 01060000
CVTRV231 EQU   CVTRV228                                                 01061000
CVTRV230 EQU   CVTRV228                                                 01062000
CVTRV229 EQU   CVTRV228                                                 01063000
CVTRV227 EQU   CVTRV219                                                 01064000
CVTRV226 EQU   CVTRV219                                                 01065000
CVTRV225 EQU   CVTRV219                                                 01066000
CVTRV224 EQU   CVTRV219                                                 01067000
CVTRV223 EQU   CVTRV219                                                 01068000
CVTRV222 EQU   CVTRV219                                                 01069000
CVTRV221 EQU   CVTRV219                                                 01070000
CVTRV220 EQU   CVTRV219                                                 01071000
CVTRV218 EQU   CVTRV210                                                 01072000
CVTRV217 EQU   CVTRV210                                                 01073000
CVTRV216 EQU   CVTRV210                                                 01074000
CVTRV215 EQU   CVTRV210                                                 01075000
CVTRV214 EQU   CVTRV210                                                 01076000
CVTRV213 EQU   CVTRV210                                                 01077000
CVTRV212 EQU   CVTRV210                                                 01078000
CVTRV211 EQU   CVTRV210                                                 01079000
CVTLCCAT EQU   CVTS01+420                                               01080000
CVTPCCAT EQU   CVTS01+416                                               01081000
CVTIPCRP EQU   CVTS01+412                                               01082000
CVTIPCRI EQU   CVTS01+408                                               01083000
CVTIPCDS EQU   CVTS01+404                                               01084000
CVTAIDVT EQU   CVTS01+400                                               01085000
CVTSSAP  EQU   CVTS01+396                                               01086000
CVTEHCIR EQU   CVTS01+392                                               01087000
CVTEHDEF EQU   CVTS01+388                                               01088000
CVTDAIR  EQU   CVTS01+384                                               01089000
CVTPERFM EQU   CVTS01+380                                               01090000
CVT044R2 EQU   CVTS01+376                                               01091000
CVTFETCH EQU   CVTS01+372                                               01092000
CVTRSTWD EQU   CVTS01+368                                               01093000
CVTSPOST EQU   CVTS01+364                                               01094000
CVTIOBP  EQU   CVTS01+360                                               01095000
CVTASMVT EQU   CVTS01+356                                               01096000
CVTRECRQ EQU   CVTS01+352                                               01097000
CVTWSAC  EQU   CVTS01+348                                               01098000
CVTRV149 EQU   CVTS01+344                                               01099000
CVTWSAL  EQU   CVTS01+340                                               01100000
CVTSPSA  EQU   CVTS01+336                                               01101000
CVTGLMN  EQU   CVTS01+332                                               01102000
CVTVEAC0 EQU   CVTS01+328                                               01103000
CVT062R1 EQU   CVTS01+324                                               01104000
CVTRPOST EQU   CVTS01+320                                               01105000
CVTDQIQE EQU   CVTS01+316                                               01106000
CVTCSD   EQU   CVTS01+312                                               01107000
CVTLKRMA EQU   CVTS01+308                                               01108000
CVTRSPIE EQU   CVTS01+304                                               01109000
CVTRENQ  EQU   CVTS01+300                                               01110000
CVTLQCB  EQU   CVTS01+296                                               01111000
CVTFQCB  EQU   CVTS01+292                                               01112000
CVTQCS01 EQU   CVTS01+288                                               01113000
CVTAPFT  EQU   CVTS01+284                                               01114000
CVTPARRL EQU   CVTS01+280                                               01115000
CVTVWAIT EQU   CVTS01+276                                               01116000
CVTGSPL  EQU   CVTS01+272                                               01117000
CVTLSMQ  EQU   CVTS01+268                                               01118000
CVTGSMQ  EQU   CVTS01+264                                               01119000
CVTEXPRO EQU   CVTS01+260                                               01120000
CVTOPCTP EQU   CVTS01+256                                               01121000
CVTSIC   EQU   CVTS01+252                                               01122000
CVTTPIOS EQU   CVTS01+248                                               01123000
CVTRTMS  EQU   CVTS01+244                                               01124000
CVTSDBF  EQU   CVTS01+240                                               01125000
CVTSCBP  EQU   CVTS01+236                                               01126000
CVTSDMP  EQU   CVTS01+232                                               01127000
CVTSV60  EQU   CVTS01+228                                               01128000
CVTRTMCT EQU   CVTS01+224                                               01129000
CVTASCBL EQU   CVTS01+220                                               01130000
CVTASCBH EQU   CVTS01+216                                               01131000
CVTGDA   EQU   CVTS01+212                                               01132000
CVTASVT  EQU   CVTS01+208                                               01133000
CVTVVMDI EQU   CVTS01+204                                               01134000
CVTAQTOP EQU   CVTS01+200                                               01135000
CVTIOSCS EQU   CVTS01+196                                               01136000
CVTSDRM  EQU   CVTS01+192                                               01137000
CVTOPTE  EQU   CVTS01+188                                               01138000
CVTSTXU  EQU   CVTS01+184                                               01139000
CVTQUIS  EQU   CVTS01+180                                               01140000
CVTPARS  EQU   CVTS01+176                                               01141000
CVTS1EE  EQU   CVTS01+172                                               01142000
CVTFRAS  EQU   CVTS01+168                                               01143000
CVTQSAS  EQU   CVTS01+164                                               01144000
CVTCRAS  EQU   CVTS01+160                                               01145000
CVTCRMN  EQU   CVTS01+156                                               01146000
CVTDELCP EQU   CVTS01+152                                               01147000
CVTFRECL EQU   CVTS01+148                                               01148000
CVTGETCL EQU   CVTS01+144                                               01149000
CVTBLDCP EQU   CVTS01+140                                               01150000
CVTAUTHL EQU   CVTS01+136                                               01151000
CVTSCAN  EQU   CVTS01+132                                               01152000
CVTRV144 EQU   CVTS01+130                                               01153000
CVTMAXMP EQU   CVTS01+128                                               01154000
CVTSTCK  EQU   CVTS01+124                                               01155000
CVTRV139 EQU   CVTS01+123                                               01156000
CVTDSSAC EQU   CVTS01+122                                               01157000
CVTRV513 EQU   CVTS01+121                                               01158000
CVTIOSPL EQU   CVTS01+120                                               01159000
CVTPTGT  EQU   CVTS01+116                                               01160000
CVTCSPIE EQU   CVTS01+112                                               01161000
CVTSMFEX EQU   CVTS01+108                                               01162000
CVTOLT0A EQU   CVTS01+104                                               01163000
CVTSRBRT EQU   CVTS01+100                                               01164000
CVTPUTL  EQU   CVTS01+96                                                01165000
CVTASCRL EQU   CVTS01+92                                                01166000
CVTASCRF EQU   CVTS01+88                                                01167000
CVTRV326 EQU   CVTS01+84                                                01168000
CVTRV325 EQU   CVTS01+80                                                01169000
CVTRV324 EQU   CVTS01+76                                                01170000
CVT0VL01 EQU   CVTS01+72                                                01171000
CVTSHRVM EQU   CVTS01+68                                                01172000
CVTRV332 EQU   CVTS01+64                                                01173000
CVTTAS   EQU   CVTS01+60                                                01174000
CVTRSCN  EQU   CVTS01+56                                                01175000
CVTTRAC2 EQU   CVTS01+54                                                01176000
CVTTRACE EQU   CVTS01+52                                                01177000
CVTAPG   EQU   CVTS01+51                                                01178000
CVTSDTRC EQU   CVTCTLFG                                                 01179000
CVTGTRCE EQU   CVTCTLFG                                                 01180000
CVTNOMP  EQU   CVTCTLFG                                                 01181000
CVTRSV79 EQU   CVTCTLFG                                                 01182000
CVTDSTAT EQU   CVTCTLFG                                                 01183000
CVTRSV78 EQU   CVTCTLFG                                                 01184000
CVTRV333 EQU   CVTCTLFG                                                 01185000
CVTRV323 EQU   CVTCTLFG                                                 01186000
CVTSPVLK EQU   CVTS01+49                                                01187000
CVTRSV77 EQU   CVTS01+48                                                01188000
CVTRV331 EQU   CVTS01+44                                                01189000
CVTRV330 EQU   CVTS01+40                                                01190000
CVTRV329 EQU   CVTS01+36                                                01191000
CVTRV328 EQU   CVTS01+32                                                01192000
CVTRV322 EQU   CVTS01+28                                                01193000
CVTSLID  EQU   CVTSLIDA+1                                               01194000
CVTSYLK  EQU   CVTSLIDA                                                 01195000
CVTRV321 EQU   CVTS01+20                                                01196000
CVTRV320 EQU   CVTS01+16                                                01197000
CVTLPDIR EQU   CVTLPDIA+1                                               01198000
CVTRSV69 EQU   CVTDIRST                                                 01199000
CVTRSV68 EQU   CVTDIRST                                                 01200000
CVTRSV67 EQU   CVTDIRST                                                 01201000
CVTRSV66 EQU   CVTDIRST                                                 01202000
CVTRSV65 EQU   CVTDIRST                                                 01203000
CVTRSV64 EQU   CVTDIRST                                                 01204000
CVTRSV63 EQU   CVTDIRST                                                 01205000
CVTDICOM EQU   CVTDIRST                                                 01206000
CVTPVTP  EQU   CVTS01+8                                                 01207000
CVTLPDSR EQU   CVTS01+4                                                 01208000
CVTGETL  EQU   CVTS01                                                   01209000
CDRCKOPT EQU   CDRCREQR+41                                              01210000
CDRCKPQB EQU   CDRCREQR+38                                              01211000
CDRCKQCB EQU   CDRCREQR+17                                              01212000
CDRCKQBC EQU   CDRCREQR+14                                              01213000
CDRCKMSG EQU   CDRCREQR+12                                              01214000
CDRCKOFF EQU   CDRCREQR+10                                              01215000
@NM00128 EQU   CDRCREQR+9                                               01216000
@NM00127 EQU   CDRCREQR+8                                               01217000
CDRCKOUT EQU   CDRCREQR+6                                               01218000
CDRCKIN  EQU   CDRCREQR+4                                               01219000
@NM00126 EQU   CDRCREQR+1                                               01220000
CDRCKRNC EQU   CDRCKFLG                                                 01221000
CDROPTN  EQU   CDRINCFM+7                                               01222000
CDRSEQOU EQU   CDRINCFM+5                                               01223000
CDRSEQIN EQU   CDRINCFM+3                                               01224000
CDROFFS  EQU   CDRINCFM+1                                               01225000
CDRSTAT  EQU   CDRINCFM                                                 01226000
@NM00125 EQU   CKPOPNFL                                                 01227000
CKPOPNCR EQU   CKPOPNFL                                                 01228000
CKPOPNIN EQU   CKPOPNFL                                                 01229000
CKPOPNEN EQU   CKPOPNFL                                                 01230000
@NM00124 EQU   CKPOPNFL                                                 01231000
CKPTRKSA EQU   CKPOVER+4                                                01232000
CKPTRKLN EQU   CKPOVER+2                                                01233000
CKPRCDSR EQU   CKPOVER                                                  01234000
CKPSLNEW EQU   CKPNSELT+1                                               01235000
CKPCUSEL EQU   CKPNSELT                                                 01236000
CKPNDEVF EQU   CKPNFLDS+12                                              01237000
CKPNTTE  EQU   CKPNFLDS+8                                               01238000
CKPENCDE EQU   CKPNFLDS+7                                               01239000
@NM00123 EQU   CKPNFLDS                                                 01240000
CKPBCKUP EQU   CKPNCNTL+30                                              01241000
CKPTIME  EQU   CKPDATTM+4                                               01242000
CKPDATE  EQU   CKPDATTM                                                 01243000
@NM00122 EQU   CKPNCNTL+21                                              01244000
CKPBLKPT EQU   CKPNCNTL+20                                              01245000
@NM00121 EQU   CKPNCNTL+18                                              01246000
@NM00120 EQU   CKPNCNTL+14                                              01247000
CKPIPLTX EQU   CKPNCNTL+4                                               01248000
CKPSWTCH EQU   CKPNCNTL+3                                               01249000
CKPTRSTA EQU   CKPNCNTL+2                                               01250000
@NM00119 EQU   CKPNCNTL                                                 01251000
CKPTRMAD EQU   CKPTWA+60                                                01252000
CKPCTTRA EQU   CKPINIT+24                                               01253000
@NM00118 EQU   CKPINIT+22                                               01254000
CKPIPERE EQU   CKPINIT+20                                               01255000
CKPDATIM EQU   CKPINIT+12                                               01256000
CKPCTTRC EQU   CKPINIT+8                                                01257000
CKPDATLN EQU   CKPINIT+6                                                01258000
CKPKEYLN EQU   CKPINIT+5                                                01259000
CKPRCDNO EQU   CKPINIT+4                                                01260000
CKPHEDNO EQU   CKPINIT+2                                                01261000
CKPCYLNO EQU   CKPINIT                                                  01262000
TCXEND   EQU   IEDQTCXD+224                                             01263000
TCXNCPIO EQU   IEDQTCXD+220                                             01264000
TCXACTE8 EQU   TCXQE8                                                   01265000
TCXABEPL EQU   IEDQTCXD+212                                             01266000
TCXSRBS  EQU   IEDQTCXD+208                                             01267000
TCXSIOSB EQU   IEDQTCXD+204                                             01268000
TCXESAVE EQU   IEDQTCXD+132                                             01269000
TCXERPPM EQU   IEDQTCXD+128                                             01270000
TCXERPSV EQU   IEDQTCXD+116                                             01271000
TCXSATTN EQU   IEDQTCXD+112                                             01272000
@NM00162 EQU   TCXDSAVE+4                                               01273000
@NM00161 EQU   TCXDSAVE                                                 01274000
TCXPLCB  EQU   IEDQTCXD+100                                             01275000
TCXBITS  EQU   IEDQTCXD+98                                              01276000
TCXSCBSZ EQU   IEDQTCXD+97                                              01277000
TCXBIT1  EQU   IEDQTCXD+96                                              01278000
TCXCOMPT EQU   IEDQTCXD+92                                              01279000
TCXAVAIL EQU   IEDQTCXD+88                                              01280000
TCXBUFL  EQU   IEDQTCXD+84                                              01281000
TCXTOTE  EQU   TCXBUFA                                                  01282000
TCXCKPM  EQU   IEDQTCXD+79                                              01283000
TCXNCKPR EQU   IEDQTCXD+78                                              01284000
TCXSZAIB EQU   IEDQTCXD+76                                              01285000
TCXAIBC  EQU   IEDQTCXD+72                                              01286000
TCXPEBC  EQU   IEDQTCXD+68                                              01287000
TCXPEWAC EQU   IEDQTCXD+64                                              01288000
TCXQRQ   EQU   IEDQTCXD+60                                              01289000
TCXOCQ   EQU   IEDQTCXD+56                                              01290000
TCXPNTQ  EQU   IEDQTCXD+52                                              01291000
TCXPUTQ  EQU   IEDQTCXD+48                                              01292000
TCXGETQ  EQU   IEDQTCXD+44                                              01293000
TCXTSI   EQU   IEDQTCXD+40                                              01294000
TCXRPT   EQU   IEDQTCXD+36                                              01295000
TCXCC3TS EQU   IEDQTCXD+35                                              01296000
TCXAPDMP EQU   TCXFLAG1                                                 01297000
TCXAPPL  EQU   TCXFLAG1                                                 01298000
TCXRTM   EQU   TCXFLAG1                                                 01299000
TCXMCPCD EQU   TCXFLAG1                                                 01300000
TCXAUTH  EQU   TCXFLAG1                                                 01301000
TCXASID  EQU   IEDQTCXD+32                                              01302000
TCXASCB  EQU   IEDQTCXD+28                                              01303000
TCXPASWD EQU   IEDQTCXD+16                                              01304000
TCXDISP  EQU   IEDQTCXD+12                                              01305000
TCXTCB   EQU   IEDQTCXD+8                                               01306000
TCXATTLN EQU   TCXATTEN                                                 01307000
TCXAVT   EQU   IEDQTCXD                                                 01308000
OPCBOTTM EQU   IEDQOPCD+1184                                            01309000
@NM00160 EQU   IEDQOPCD+1100                                            01310000
@NM00159 EQU   IEDQOPCD+948                                             01311000
@NM00158 EQU   IEDQOPCD+940                                             01312000
@NM00157 EQU   IEDQOPCD+380                                             01313000
@NM00156 EQU   OPCPWCOB+9                                               01314000
@NM00155 EQU   OPCPWCOB+8                                               01315000
@NM00154 EQU   OPCPWECB+1                                               01316000
OPCPWCCC EQU   OPCPWECB                                                 01317000
OPCPWCHN EQU   OPCPWQCB+1                                               01318000
OPCPWVTO EQU   OPCPWQCB                                                 01319000
OPCWAITV EQU   IEDQOPCD+364                                             01320000
OPCTOTCK EQU   IEDQOPCD+360                                             01321000
OPCAPXTL EQU   IEDQOPCD+356                                             01322000
OPCDECR  EQU   IEDQOPCD+352                                             01323000
OPCBUFWT EQU   IEDQOPCD+348                                             01324000
OPCWRKSP EQU   IEDQOPCD+320                                             01325000
OPCADGOT EQU   IEDQOPCD+318                                             01326000
OPCRQCNT EQU   IEDQOPCD+316                                             01327000
OPPOLSTP EQU   IEDQOPCD+312                                             01328000
OPCCKCIB EQU   IEDQOPCD+308                                             01329000
OPCEND   EQU   IEDQOPCD+307                                             01330000
OPCSTCBS EQU   IEDQOPCD+306                                             01331000
OPCHNEND EQU   IEDQOPCD+302                                             01332000
OPCOQSW  EQU   IEDQOPCD+301                                             01333000
@NM00153 EQU   OPCSPEC                                                  01334000
@NM00152 EQU   OPCSPEC                                                  01335000
@NM00151 EQU   OPCSPEC                                                  01336000
@NM00150 EQU   OPCSPEC                                                  01337000
OPCFRMCA EQU   OPCSPEC                                                  01338000
OPCRSTRT EQU   OPCSPEC                                                  01339000
OPCPART  EQU   OPCSPEC                                                  01340000
OPCALTD  EQU   OPCSPEC                                                  01341000
OPCBFEND EQU   IEDQOPCD+296                                             01342000
OPCBFIRS EQU   IEDQOPCD+292                                             01343000
OPCAVBUF EQU   IEDQOPCD+290                                             01344000
OPCIPLCT EQU   IEDQOPCD+289                                             01345000
OPCCLNTS EQU   IEDQOPCD+288                                             01346000
OPCHA8   EQU   IEDQOPCD+286                                             01347000
OPCBFREQ EQU   IEDQOPCD+284                                             01348000
OPCFREBF EQU   IEDQOPCD+280                                             01349000
OPCGETBF EQU   IEDQOPCD+276                                             01350000
OPCNEXT  EQU   IEDQOPCD+272                                             01351000
OPCFMDFC EQU   IEDQOPCD+268                                             01352000
OPCSCNC  EQU   IEDQOPCD+264                                             01353000
OPCHORTG EQU   IEDQOPCD+260                                             01354000
OPCHORT  EQU   IEDQOPCD+256                                             01355000
OPCCKPTL EQU   IEDQOPCD+252                                             01356000
OPCWAITA EQU   IEDQOPCD+244                                             01357000
OPCWAITR EQU   IEDQOPCD+240                                             01358000
OPCWAITP EQU   IEDQOPCD+236                                             01359000
OPCWAITO EQU   IEDQOPCD+232                                             01360000
OPCWAITN EQU   IEDQOPCD+228                                             01361000
OPCWAITL EQU   IEDQOPCD+224                                             01362000
OPCWAITC EQU   IEDQOPCD+220                                             01363000
@NM00149 EQU   OPCLDNME+5                                               01364000
OPCMODID EQU   OPCLDNME+3                                               01365000
@NM00148 EQU   OPCLDNME                                                 01366000
OPCXCTL  EQU   IEDQOPCD+204                                             01367000
OPCWAIT  EQU   IEDQOPCD+192                                             01368000
OPCCKERB EQU   IEDQOPCD+164                                             01369000
OPCBFERB EQU   IEDQOPCD+148                                             01370000
OPCFLAG2 EQU   IEDQOPCD+147                                             01371000
OPCFLAG1 EQU   IEDQOPCD+146                                             01372000
OPCWRKSZ EQU   IEDQOPCD+144                                             01373000
OPCWORK  EQU   IEDQOPCD+140                                             01374000
OPCRSAVE EQU   IEDQOPCD+132                                             01375000
OPCQCBAD EQU   IEDQOPCD+128                                             01376000
OPCSAVE  EQU   IEDQOPCD+56                                              01377000
OPCTRMWA EQU   IEDQOPCD+52                                              01378000
OPCPSTWT EQU   IEDQOPCD+48                                              01379000
OPCTNTEA EQU   IEDQOPCD+44                                              01380000
OPCPGCK  EQU   IEDQOPCD+40                                              01381000
OPCLCB   EQU   IEDQOPCD+36                                              01382000
@NM00147 EQU   IEDQOPCD+32                                              01383000
OPCIPLAD EQU   IEDQOPCD+28                                              01384000
OPCTOFLK EQU   IEDQOPCD+24                                              01385000
OPCOPTLK EQU   IEDQOPCD+20                                              01386000
OPCDCBLK EQU   IEDQOPCD+16                                              01387000
OPCCOPCE EQU   IEDQOPCD+12                                              01388000
OPCAVTPT EQU   IEDQOPCD+8                                               01389000
OPCDOUBL EQU   IEDQOPCD                                                 01390000
@NM00146 EQU   OCLDNME+4                                                01391000
@NM00145 EQU   OCPREFLG                                                 01392000
OCTOTEP  EQU   OCPREFLG                                                 01393000
OCREPOST EQU   OCPREFLG                                                 01394000
OCRSPSNT EQU   OCPREFLG                                                 01395000
OCBFREQ  EQU   OCPREFLG                                                 01396000
OCIDLE   EQU   OCREQFLG                                                 01397000
OCFORCE  EQU   OCREQFLG                                                 01398000
OCDCARD  EQU   OCREQFLG                                                 01399000
OCPARTAL EQU   OCREQFLG                                                 01400000
OCADNCP  EQU   OCREQFLG                                                 01401000
@NM00144 EQU   OCREQFLG                                                 01402000
@NM00143 EQU   OCREQFLG                                                 01403000
OCFLUSHZ EQU   OCREQFLG                                                 01404000
OCRESPCT EQU   OCLINTTE                                                 01405000
OCCKPTWA EQU   OCCKDATA+4                                               01406000
@NM00140 EQU   OCRSTGTM+2                                               01407000
OCCKDAT2 EQU   OCRSTGTM+1                                               01408000
OCCKDAT1 EQU   OCRSTGTM                                                 01409000
OCPUADR  EQU   OCIPLWA+2                                                01410000
OCWTGSAV EQU   OCIPLWA                                                  01411000
OCDVRDCT EQU   OCBACKUP+6                                               01412000
OCNCP    EQU   OCBACKUP+4                                               01413000
OCBUFGOT EQU   OCBACKUP+2                                               01414000
OCBUFNED EQU   OCBACKUP                                                 01415000
OCWTG    EQU   IEDQOPCE+30                                              01416000
OCSEQ    EQU   OCTRUNIT+2                                               01417000
@NM00139 EQU   OCRSID+1                                                 01418000
OCNONE   EQU   OCALSTAT                                                 01419000
OCSOME   EQU   OCALSTAT                                                 01420000
OCALLFLG EQU   OCALSTAT                                                 01421000
OCACTREQ EQU   OCALSTAT                                                 01422000
OCREDRVE EQU   OCALSTAT                                                 01423000
OCSEQIND EQU   OCALSTAT                                                 01424000
@NM00138 EQU   OCALSTAT                                                 01425000
OCRENTRD EQU   OCALSTAT                                                 01426000
OCWTGB   EQU   OCTIOT                                                   01427000
OCTRMTBL EQU   IEDQOPCE+20                                              01428000
@NM00137 EQU   @NM00136+2                                               01429000
OCCONID  EQU   OCDEST                                                   01430000
OCRLN    EQU   IEDQOPCE+15                                              01431000
OCRESP   EQU   OCFLAG                                                   01432000
OCATTACH EQU   OCFLAG                                                   01433000
OCSSCP   EQU   OCFLAG                                                   01434000
OCOUTPUT EQU   OCFLAG                                                   01435000
OCLINE   EQU   OCFLAG                                                   01436000
OCMPP    EQU   OCFLAG                                                   01437000
OCTOTE   EQU   OCFLAG                                                   01438000
OCCONSOL EQU   OCFLAG                                                   01439000
@NM00135 EQU   OCSWITCH                                                 01440000
OCQUCKN  EQU   OCSWITCH                                                 01441000
OCPRIFLG EQU   OCOPTCDE                                                 01442000
@NM00134 EQU   OCRUDEST+1                                               01443000
@NM00133 EQU   OCSCAN                                                   01444000
OCNOTUCB EQU   OCSCAN                                                   01445000
OCNONAME EQU   OCSCAN                                                   01446000
OCALLRLN EQU   OCSCAN                                                   01447000
OCDDNAME EQU   OCSCAN                                                   01448000
OCDDNRLN EQU   OCSCAN                                                   01449000
OCADDR   EQU   OCSCAN                                                   01450000
OCELMPTR EQU   OCELEM+1                                                 01451000
OCELMPRI EQU   OCELEM                                                   01452000
OCLINK   EQU   IEDQOPCE                                                 01453000
CVTLEVL  EQU   CVTRELNO+2                                               01454000
CVTNUMB  EQU   CVTRELNO                                                 01455000
CVTMDL   EQU   CVTFIX+250                                               01456000
@NM00132 EQU   CVTFIX+248                                               01457000
@NM00131 EQU   CVTFIX                                                   01458000
CVTRV482 EQU   CVTXTNT2+128                                             01459000
CVTRV481 EQU   CVTXTNT2+124                                             01460000
CVTRV480 EQU   CVTXTNT2+120                                             01461000
CVTRV479 EQU   CVTXTNT2+118                                             01462000
CVTRV478 EQU   CVTXTNT2+117                                             01463000
CVTRV477 EQU   CVTXTNT2+116                                             01464000
CVTRV476 EQU   CVTXTNT2+115                                             01465000
CVTRV475 EQU   CVTXTNT2+114                                             01466000
CVTRV474 EQU   CVTRV466                                                 01467000
CVTRV473 EQU   CVTRV466                                                 01468000
CVTRV472 EQU   CVTRV466                                                 01469000
CVTRV471 EQU   CVTRV466                                                 01470000
CVTRV470 EQU   CVTRV466                                                 01471000
CVTRV469 EQU   CVTRV466                                                 01472000
CVTRV468 EQU   CVTRV466                                                 01473000
CVTRV467 EQU   CVTRV466                                                 01474000
CVTRV465 EQU   CVTRV457                                                 01475000
CVTRV464 EQU   CVTRV457                                                 01476000
CVTRV463 EQU   CVTRV457                                                 01477000
CVTRV462 EQU   CVTRV457                                                 01478000
CVTRV461 EQU   CVTRV457                                                 01479000
CVTRV460 EQU   CVTRV457                                                 01480000
CVTRV459 EQU   CVTRV457                                                 01481000
CVTRV458 EQU   CVTRV457                                                 01482000
CVTRV456 EQU   CVTXTNT2+108                                             01483000
CVTRV455 EQU   CVTXTNT2+104                                             01484000
CVTRV454 EQU   CVTXTNT2+100                                             01485000
CVTRV453 EQU   CVTXTNT2+96                                              01486000
CVTRV452 EQU   CVTXTNT2+94                                              01487000
CVTRV451 EQU   CVTXTNT2+92                                              01488000
CVTRV450 EQU   CVTXTNT2+90                                              01489000
CVTRV449 EQU   CVTXTNT2+88                                              01490000
CVTRV448 EQU   CVTXTNT2+87                                              01491000
CVTRV447 EQU   CVTXTNT2+86                                              01492000
CVTRV446 EQU   CVTRV438                                                 01493000
CVTRV445 EQU   CVTRV438                                                 01494000
CVTRV444 EQU   CVTRV438                                                 01495000
CVTRV443 EQU   CVTRV438                                                 01496000
CVTRV442 EQU   CVTRV438                                                 01497000
CVTRV441 EQU   CVTRV438                                                 01498000
CVTRV440 EQU   CVTRV438                                                 01499000
CVTRV439 EQU   CVTRV438                                                 01500000
CVTRV437 EQU   CVTRV429                                                 01501000
CVTRV436 EQU   CVTRV429                                                 01502000
CVTRV435 EQU   CVTRV429                                                 01503000
CVTRV434 EQU   CVTRV429                                                 01504000
CVTRV433 EQU   CVTRV429                                                 01505000
CVTRV432 EQU   CVTRV429                                                 01506000
CVTRV431 EQU   CVTRV429                                                 01507000
CVTRV430 EQU   CVTRV429                                                 01508000
CVTRV428 EQU   CVTXTNT2+80                                              01509000
CVTRV427 EQU   CVTXTNT2+76                                              01510000
CVTRV426 EQU   CVTXTNT2+72                                              01511000
CVTRV425 EQU   CVTXTNT2+68                                              01512000
CVTATACT EQU   CVTATCVT                                                 01513000
CVTRV423 EQU   CVTXTNT2+62                                              01514000
CVTRV422 EQU   CVTXTNT2+60                                              01515000
CVTRV421 EQU   CVTXTNT2+58                                              01516000
CVTRV420 EQU   CVTXTNT2+56                                              01517000
CVTRV419 EQU   CVTXTNT2+55                                              01518000
CVTRV418 EQU   CVTXTNT2+54                                              01519000
CVTRV417 EQU   CVTRV409                                                 01520000
CVTRV416 EQU   CVTRV409                                                 01521000
CVTRV415 EQU   CVTRV409                                                 01522000
CVTRV414 EQU   CVTRV409                                                 01523000
CVTRV413 EQU   CVTRV409                                                 01524000
CVTRV412 EQU   CVTRV409                                                 01525000
CVTRV411 EQU   CVTRV409                                                 01526000
CVTRV410 EQU   CVTRV409                                                 01527000
CVTRV408 EQU   CVTRV400                                                 01528000
CVTRV407 EQU   CVTRV400                                                 01529000
CVTRV406 EQU   CVTRV400                                                 01530000
CVTRV405 EQU   CVTRV400                                                 01531000
CVTRV404 EQU   CVTRV400                                                 01532000
CVTRV403 EQU   CVTRV400                                                 01533000
CVTRV402 EQU   CVTRV400                                                 01534000
CVTRV401 EQU   CVTRV400                                                 01535000
CVTICB   EQU   CVTXTNT2+48                                              01536000
CVTSKTA  EQU   CVTXTNT2+44                                              01537000
CVTSHSB  EQU   CVTSHS                                                   01538000
CVTRSV98 EQU   CVTXTNT2+36                                              01539000
CVTRSV97 EQU   CVTXTNT2+34                                              01540000
CVTRSV96 EQU   CVTXTNT2+32                                              01541000
CVTOLTEP EQU   CVTXTNT2+28                                              01542000
CVTQIDA  EQU   CVTQID+1                                                 01543000
CVTRSV95 EQU   CVTQID                                                   01544000
CVTRSV94 EQU   CVTXTNT2+20                                              01545000
CVTRSV93 EQU   CVTXTNT2+16                                              01546000
CVTRSV92 EQU   CVTXTNT2+12                                              01547000
CVTDEBVR EQU   CVTXTNT2+8                                               01548000
CVTRSV91 EQU   CVTXTNT2+6                                               01549000
CVTRSV9H EQU   CVTFLGBT                                                 01550000
CVTRSV9G EQU   CVTFLGBT                                                 01551000
CVTRSV9F EQU   CVTFLGBT                                                 01552000
CVTRSV9E EQU   CVTFLGBT                                                 01553000
CVTRSV9D EQU   CVTFLGBT                                                 01554000
CVTRSV9C EQU   CVTFLGBT                                                 01555000
CVTVME   EQU   CVTFLGBT                                                 01556000
CVTNPE   EQU   CVTFLGBT                                                 01557000
CVTNUCLS EQU   CVTXTNT2+4                                               01558000
CVTDSSVA EQU   CVTDSSV+1                                                01559000
CVTRSV89 EQU   CVTDSSV                                                  01560000
CVTRSV88 EQU   CVTXTNT1+8                                               01561000
CVTRSV87 EQU   CVTXTNT1+4                                               01562000
CVTFACHN EQU   CVTXTNT1                                                 01563000
CVTRV488 EQU   CVTMAP+412                                               01564000
CVTRV487 EQU   CVTMAP+408                                               01565000
CVTRV486 EQU   CVTMAP+404                                               01566000
CVTRV485 EQU   CVTMAP+400                                               01567000
CVTACTAP EQU   CVTMAP+396                                               01568000
CVTAUTH  EQU   CVTMAP+392                                               01569000
CVTATMCA EQU   CVTATMCT+1                                               01570000
CVTATMST EQU   CVTATMCT                                                 01571000
CVTRSV61 EQU   CVTMAP+384                                               01572000
CVTVOLT1 EQU   CVTVOLM1+1                                               01573000
CVTVOLI1 EQU   CVTVOLF1                                                 01574000
CVTSTOA  EQU   CVTMAP+376                                               01575000
CVTRSV58 EQU   CVTMAP+374                                               01576000
CVTRSV57 EQU   CVTMAP+372                                               01577000
CVTDDCE  EQU   CVTMAP+368                                               01578000
CVTPNWFR EQU   CVTMAP+364                                               01579000
CVTSMF   EQU   CVTMAP+360                                               01580000
CVTSULK  EQU   CVTMAP+358                                               01581000
CVTSLKO  EQU   CVTSYSK                                                  01582000
CVTSLKP  EQU   CVTSYSK                                                  01583000
CVTSLKQ  EQU   CVTSYSK                                                  01584000
CVTSLKR  EQU   CVTSYSK                                                  01585000
CVTRSV56 EQU   CVTSYSK                                                  01586000
CVTRSV55 EQU   CVTSYSK                                                  01587000
CVTRSV54 EQU   CVTSYSK                                                  01588000
CVTRSV53 EQU   CVTSYSK                                                  01589000
CVTRSV52 EQU   CVTA1F1                                                  01590000
CVTRSV51 EQU   CVTA1F1                                                  01591000
CVTRSV50 EQU   CVTA1F1                                                  01592000
CVTRSV49 EQU   CVTA1F1                                                  01593000
CVTRSV48 EQU   CVTA1F1                                                  01594000
CVTRSV47 EQU   CVTA1F1                                                  01595000
CVTSRSW  EQU   CVTA1F1                                                  01596000
CVTPFSW  EQU   CVTA1F1                                                  01597000
CVTPCVT  EQU   CVTMAP+352                                               01598000
CVTRSV46 EQU   CVTMAP+344                                               01599000
CVTRSV45 EQU   CVTMAP+340                                               01600000
CVTRSV44 EQU   CVTMAP+338                                               01601000
CVTRSV43 EQU   CVTMAP+336                                               01602000
CVTHJESA EQU   CVTHJES+1                                                01603000
CVTRSV42 EQU   CVTHJES                                                  01604000
CVTEXT2A EQU   CVTEXT2+1                                                01605000
CVTRSV41 EQU   CVTEXT2                                                  01606000
CVTAPFA  EQU   CVTAPF+1                                                 01607000
CVTRSV40 EQU   CVTAPF                                                   01608000
CVTRV518 EQU   CVTINTLA                                                 01609000
CVTRV517 EQU   CVTERPV                                                  01610000
CVTEORM  EQU   CVTMAP+312                                               01611000
CVTMCHPR EQU   CVTMAP+308                                               01612000
CVTTZ    EQU   CVTMAP+304                                               01613000
CVTJEPS  EQU   CVTMAP+300                                               01614000
CVTJESCT EQU   CVTMAP+296                                               01615000
CVTMODE  EQU   CVTMAP+292                                               01616000
CVTPTRV  EQU   CVTMAP+288                                               01617000
CVTREAL  EQU   CVTMAP+284                                               01618000
CVTRSV39 EQU   CVTMAP+280                                               01619000
CVTRSV38 EQU   CVTMAP+276                                               01620000
CVTDMSRA EQU   CVTDMSR+1                                                01621000
CVTRV634 EQU   CVTDMSRF                                                 01622000
CVTRV633 EQU   CVTDMSRF                                                 01623000
CVTRV632 EQU   CVTDMSRF                                                 01624000
CVTRV631 EQU   CVTDMSRF                                                 01625000
CVTRV630 EQU   CVTDMSRF                                                 01626000
CVTRV629 EQU   CVTDMSRF                                                 01627000
CVTUDUMP EQU   CVTDMSRF                                                 01628000
CVTSDUMP EQU   CVTDMSRF                                                 01629000
CVTQMSGA EQU   CVTQMSG+1                                                01630000
CVTRSV36 EQU   CVTQMSG                                                  01631000
CVTAMFF  EQU   CVTMAP+264                                               01632000
CVTPURGA EQU   CVTPURG+1                                                01633000
CVTRSV35 EQU   CVTPURG                                                  01634000
CVTCBSP  EQU   CVTMAP+256                                               01635000
CVTATERA EQU   CVTATER+1                                                01636000
CVTSYST  EQU   CVTATER                                                  01637000
CVTVOLT2 EQU   CVTTAT                                                   01638000
CVTVOLI2 EQU   CVTVOLF2                                                 01639000
CVTAQAVB EQU   CVTAQAVT+1                                               01640000
CVTRSV34 EQU   CVTTCMFG                                                 01641000
CVTRSV33 EQU   CVTTCMFG                                                 01642000
CVTRSV32 EQU   CVTTCMFG                                                 01643000
CVTRSV31 EQU   CVTTCMFG                                                 01644000
CVTRSV30 EQU   CVTTCMFG                                                 01645000
CVTRSV29 EQU   CVTTCMFG                                                 01646000
CVTRSV28 EQU   CVTTCMFG                                                 01647000
CVTTCRDY EQU   CVTTCMFG                                                 01648000
CVTGTFA  EQU   CVTGTF+1                                                 01649000
CVTRSV27 EQU   CVTGTFST                                                 01650000
CVTRNIO  EQU   CVTGTFST                                                 01651000
CVTUSR   EQU   CVTGTFST                                                 01652000
CVTRV318 EQU   CVTFORM                                                  01653000
CVTRV317 EQU   CVTTMODE                                                 01654000
CVTRV316 EQU   CVTSTATE                                                 01655000
CVTRV315 EQU   CVTGTFS                                                  01656000
CVTGTFAV EQU   CVTGTFS                                                  01657000
CVT0SCR1 EQU   CVTMAP+232                                               01658000
CVTRV515 EQU   CVTMAP+228                                               01659000
CVTRMS   EQU   CVTMAP+224                                               01660000
CVTPATCH EQU   CVTMAP+220                                               01661000
CVTTSCE  EQU   CVTMAP+216                                               01662000
CVTLNKSC EQU   CVTMAP+214                                               01663000
CVTQABST EQU   CVTMAP+212                                               01664000
CVTMDLDS EQU   CVTMAP+208                                               01665000
CVTUSER  EQU   CVTMAP+204                                               01666000
CVTABEND EQU   CVTMAP+200                                               01667000
CVTSMCA  EQU   CVTMAP+196                                               01668000
CVTRSV18 EQU   CVTMAP+192                                               01669000
CVTQLPAQ EQU   CVTMAP+188                                               01670000
CVTQCDSR EQU   CVTMAP+184                                               01671000
CVTRSV17 EQU   CVTOPTB                                                  01672000
CVTRSV16 EQU   CVTOPTB                                                  01673000
CVTFP    EQU   CVTOPTB                                                  01674000
CVTAPTHR EQU   CVTOPTB                                                  01675000
CVTNLOG  EQU   CVTOPTB                                                  01676000
CVTTOD   EQU   CVTOPTB                                                  01677000
CVTCTIMS EQU   CVTOPTB                                                  01678000
CVTPROT  EQU   CVTOPTB                                                  01679000
CVTXPFP  EQU   CVTOPTA                                                  01680000
CVTASCII EQU   CVTOPTA                                                  01681000
CVTRSV13 EQU   CVTOPTA                                                  01682000
CVTRSV12 EQU   CVTOPTA                                                  01683000
CVTNIP   EQU   CVTOPTA                                                  01684000
CVTDDR   EQU   CVTOPTA                                                  01685000
CVTAPR   EQU   CVTOPTA                                                  01686000
CVTCCH   EQU   CVTOPTA                                                  01687000
CVTSNCTR EQU   CVTMAP+180                                               01688000
CVTQMWR  EQU   CVTMAP+176                                               01689000
CVTQOCR  EQU   CVTMAP+172                                               01690000
CVT1EF00 EQU   CVTMAP+168                                               01691000
CVTMZ00  EQU   CVTMAP+164                                               01692000
CVTHEAD  EQU   CVTMAP+160                                               01693000
CVTRSV11 EQU   CVTMAP+156                                               01694000
CVT0PT01 EQU   CVTMAP+152                                               01695000
CVTMSER  EQU   CVTMAP+148                                               01696000
CVTRV516 EQU   CVTIERLC                                                 01697000
CVTILCH  EQU   CVTMAP+140                                               01698000
CVT0DS   EQU   CVTMAP+136                                               01699000
CVTFBOSV EQU   CVTMAP+132                                               01700000
CVTNUCB  EQU   CVTMAP+128                                               01701000
CVTIXAVL EQU   CVTMAP+124                                               01702000
CVTIOQET EQU   CVTMAP+120                                               01703000
CVTDCBA  EQU   CVTMAP+117                                               01704000
CVTMVS2  EQU   CVTDCB                                                   01705000
CVT6DAT  EQU   CVTDCB                                                   01706000
CVT4MPS  EQU   CVTDCB                                                   01707000
CVTRSV09 EQU   CVTDCB                                                   01708000
CVT4MS1  EQU   CVTDCB                                                   01709000
CVT2SPS  EQU   CVTDCB                                                   01710000
CVT1SSS  EQU   CVTDCB                                                   01711000
CVTRSV08 EQU   CVTDCB                                                   01712000
CVTSTB   EQU   CVTMAP+112                                               01713000
CVTQTD00 EQU   CVTMAP+108                                               01714000
CVTQTE00 EQU   CVTMAP+104                                               01715000
CVTCUCB  EQU   CVTMAP+100                                               01716000
CVTSJQ   EQU   CVTMAP+96                                                01717000
CVTPBLDL EQU   CVTMAP+92                                                01718000
CVTTPC   EQU   CVTMAP+88                                                01719000
CVTSVDCB EQU   CVTMAP+84                                                01720000
CVTBRET  EQU   CVTMAP+82                                                01721000
CVTEXIT  EQU   CVTMAP+80                                                01722000
CVT0FN00 EQU   CVTMAP+76                                                01723000
CVTDARA  EQU   CVTDAR+1                                                 01724000
CVTRSV07 EQU   CVTFLGS1                                                 01725000
CVTRSV06 EQU   CVTFLGS1                                                 01726000
CVTRSV05 EQU   CVTFLGS1                                                 01727000
CVTRSV04 EQU   CVTFLGS1                                                 01728000
CVTRSV03 EQU   CVTFLGS1                                                 01729000
CVTRSV02 EQU   CVTFLGS1                                                 01730000
CVTRSV01 EQU   CVTFLGS1                                                 01731000
CVTDMPLK EQU   CVTFLGS1                                                 01732000
CVTXITP  EQU   CVTMAP+68                                                01733000
CVTZDTAB EQU   CVTMAP+64                                                01734000
CVTMSLT  EQU   CVTMAP+60                                                01735000
CVTDATE  EQU   CVTMAP+56                                                01736000
CVTBTERM EQU   CVTMAP+52                                                01737000
CVTSYSAD EQU   CVTMAP+48                                                01738000
CVTXTLER EQU   CVTMAP+44                                                01739000
CVTILK2  EQU   CVTMAP+40                                                01740000
CVTILK1  EQU   CVTMAP+36                                                01741000
CVTPRLTV EQU   CVTMAP+32                                                01742000
CVTPCNVT EQU   CVTMAP+28                                                01743000
CVT0VL00 EQU   CVTMAP+24                                                01744000
CVTXAPG  EQU   CVTMAP+20                                                01745000
CVTBUF   EQU   CVTMAP+16                                                01746000
CVTJOB   EQU   CVTMAP+12                                                01747000
CVTLINK  EQU   CVTMAP+8                                                 01748000
CVT0EF00 EQU   CVTMAP+4                                                 01749000
CVTTCBP  EQU   CVTMAP                                                   01750000
CVT      EQU   CVTMAP                                                   01751000
CKPIOTR  EQU   CKPAVT+21                                                01752000
CKPSUBT  EQU   CKPAVT+20                                                01753000
CKPLODPT EQU   CKPAVT+16                                                01754000
CKPRADDR EQU   CKPAVT+12                                                01755000
CKPNADDR EQU   CKPAVT+8                                                 01756000
CKPBIT2  EQU   CKPAVT+7                                                 01757000
CKPBIT1  EQU   CKPAVT+6                                                 01758000
CKPINTLV EQU   CKPAVT+4                                                 01759000
CKPOPCIN EQU   CKPAVT+2                                                 01760000
CKPOPCON EQU   CKPAVT                                                   01761000
CKPTYPE  EQU   CKPNRES+5                                                01762000
@NM00130 EQU   CKPNFLG                                                  01763000
CKPLULOG EQU   CKPNFLG                                                  01764000
CKPEPMOD EQU   CKPNFLG                                                  01765000
CKPRSACT EQU   CKPNFLG                                                  01766000
CKPREMB  EQU   CKPNFLG                                                  01767000
CKPCOHRT EQU   CKPNRES+2                                                01768000
CKPSUBST EQU   CKPNRES                                                  01769000
CKPCTSEC EQU   CKPREQTB+6                                               01770000
CKPCTOFF EQU   CKPREQTB+4                                               01771000
CKPCTTTR EQU   CKPREQTB+1                                               01772000
CKPCTDER EQU   CKPCTFLG                                                 01773000
CKPCTACT EQU   CKPCTFLG                                                 01774000
CREDEB   EQU   CREOFFS                                                  01775000
CREECB   EQU   IEDQCRED+8                                               01776000
@NM00129 EQU   CRELINK+1                                                01777000
CREPRI   EQU   CRELINK                                                  01778000
CREQCBAD EQU   IEDQCRED+1                                               01779000
CREKEY   EQU   IEDQCRED                                                 01780000
CDRKEY   EQU   IEDQCDRD+8                                               01781000
CDRTIME  EQU   IEDQCDRD+4                                               01782000
CDRDATE  EQU   IEDQCDRD                                                 01783000
CKPSECT1 EQU   CKPCNTLR+37                                              01784000
CKPTTRT1 EQU   CKPCNTLR+34                                              01785000
CKPSECIN EQU   CKPCNTLR+32                                              01786000
CKPSECCR EQU   CKPCNTLR+30                                              01787000
CKPSECLI EQU   CKPCNTLR+28                                              01788000
CKPSECLT EQU   CKPCNTLR+26                                              01789000
CKPINCLN EQU   CKPCNTLR+24                                              01790000
CKPTTRLI EQU   CKPCNTLR+21                                              01791000
CKPRPERT EQU   CKPCNTLR+20                                              01792000
CKPCKRLN EQU   CKPCNTLR+18                                              01793000
CKPCPERT EQU   CKPPRQNO                                                 01794000
CKPIPERT EQU   CKPCNTLR+16                                              01795000
CKPCPRCD EQU   CKPCNTLR+15                                              01796000
CKPCKRQS EQU   CKPCNTLR+14                                              01797000
CKPBPERR EQU   CKPCNTLR+12                                              01798000
CKPTTRIN EQU   CKPCNTLR+9                                               01799000
CKPINRNO EQU   CKPCNTLR+8                                               01800000
CKPTTRCR EQU   CKPCNTLR+5                                               01801000
CKPCRRNO EQU   CKPCNTLR+4                                               01802000
CKPINCNO EQU   CKPCNTLR+3                                               01803000
CKPINCNT EQU   CKPCNTLR+2                                               01804000
CKPTTRCT EQU   CKPCNTLR+1                                               01805000
CKPOPCRD EQU   CKPFLAGS                                                 01806000
CKPOPTFN EQU   CKPFLAGS                                                 01807000
CKPSTAIN EQU   CKPFLAGS                                                 01808000
CKPERR   EQU   CKPFLAGS                                                 01809000
@NM00117 EQU   CKPFLAGS                                                 01810000
CKPFSCN2 EQU   CKPFLAGS                                                 01811000
CKPFSCN1 EQU   CKPFLAGS                                                 01812000
CKPNORML EQU   CKPFLAGS                                                 01813000
@NM00116 EQU   CKPMSG+65                                                01814000
CKPMSGGL EQU   CKPMSG+61                                                01815000
@NM00115 EQU   CKPMSG+2                                                 01816000
CKPMSGLN EQU   CKPMSG                                                   01817000
CKPWKALN EQU   @NM00114+10                                              01818000
CKPGETML EQU   @NM00114                                                 01819000
@NM00113 EQU   CKPRW+5                                                  01820000
CKPRWFLG EQU   CKPRW+4                                                  01821000
CKPSCHID EQU   CKPCCWS+16                                               01822000
CKPSETSC EQU   CKPCCWS+8                                                01823000
CKPSEEKC EQU   CKPCCWS                                                  01824000
@NM00112 EQU   IEDQCKPD+164                                             01825000
CKPERRCT EQU   IEDQCKPD+163                                             01826000
CKPSWCH2 EQU   IEDQCKPD+162                                             01827000
CKPSWCH1 EQU   IEDQCKPD+161                                             01828000
CKPCRLEN EQU   IEDQCKPD+160                                             01829000
CKPPARM2 EQU   IEDQCKPD+156                                             01830000
CKPCPARM EQU   IEDQCKPD+148                                             01831000
CKPSECTR EQU   CKPCTTRB                                                 01832000
CKPLDRB  EQU   IEDQCKPD+140                                             01833000
CKPLREB  EQU   IEDQCKPD+136                                             01834000
CKPNDRB  EQU   @NM00111                                                 01835000
CKPIOQF  EQU   IEDQCKPD+128                                             01836000
CKPEPLOC EQU   CKPCNVRT                                                 01837000
CKPECB   EQU   IEDQCKPD+112                                             01838000
CKPIOR   EQU   CKPIOSK+7                                                01839000
CKPIOHH  EQU   CKPIOSK+5                                                01840000
CKPIOCC  EQU   CKPIOSK+3                                                01841000
CKPIOBB  EQU   CKPIOSK+1                                                01842000
CKPIOM   EQU   CKPIOSK                                                  01843000
CKPIORC  EQU   CKPIOB+30                                                01844000
CKPIOBCI EQU   CKPIOB+28                                                01845000
CKPIORST EQU   CKPIOB+25                                                01846000
@NM00110 EQU   CKPIOB+24                                                01847000
CKPIODCB EQU   CKPIOB+21                                                01848000
@NM00109 EQU   CKPIOB+20                                                01849000
CKPIOCPA EQU   CKPIOB+17                                                01850000
CKPIOSIO EQU   CKPIOB+16                                                01851000
CKPIOCSW EQU   CKPIOB+9                                                 01852000
CKPIOFL3 EQU   CKPIOB+8                                                 01853000
@NM00108 EQU   CKPIOECB+1                                               01854000
CKPIOSN1 EQU   CKPIOB+3                                                 01855000
CKPIOSN0 EQU   CKPIOB+2                                                 01856000
CKPIOFL2 EQU   CKPIOB+1                                                 01857000
CKPIOFL1 EQU   CKPIOB                                                   01858000
CKPSAVE1 EQU   IEDQCKPD                                                 01859000
CNRDEVRC EQU   IEDQCNRD+19                                              01860000
CNRMSSEL EQU   IEDQCNRD+18                                              01861000
CNRCTLIM EQU   IEDQCNRD+17                                              01862000
CNRCSLIM EQU   IEDQCNRD+16                                              01863000
CNRNEGPL EQU   IEDQCNRD+15                                              01864000
CNRSSPAU EQU   IEDQCNRD+14                                              01865000
CNRBHPOS EQU   CNRBHSET+1                                               01866000
@NM00107 EQU   CNRBHFUN                                                 01867000
CNRBHFN0 EQU   CNRBHFUN                                                 01868000
@NM00106 EQU   CNRCNTL+1                                                01869000
CNRFRDR  EQU   CNRCNTL                                                  01870000
CNRFMSS  EQU   CNRCNTL                                                  01871000
CNRFCTL  EQU   CNRCNTL                                                  01872000
CNRFCSL  EQU   CNRCNTL                                                  01873000
CNRFNPL  EQU   CNRCNTL                                                  01874000
CNRFSSP  EQU   CNRCNTL                                                  01875000
CNRFBHSC EQU   CNRCNTL                                                  01876000
CNRFBHS  EQU   CNRCNTL                                                  01877000
CNRTIME  EQU   CNRDATTM+4                                               01878000
CNRDATE  EQU   CNRDATTM                                                 01879000
CNRTNTOF EQU   IEDQCNRD                                                 01880000
CAVTNQE  EQU   CAVTWL2+1                                                01881000
CAVTTIOE EQU   CAVTWL1+5                                                01882000
CAVTEOL1 EQU   CAVTWL1+4                                                01883000
CAVTTQE  EQU   CAVTWL1                                                  01884000
@NM00105 EQU   IEDQCKAD+10                                              01885000
CAVTFLGS EQU   IEDQCKAD+9                                               01886000
CAVTTCWA EQU   IEDQCKAD                                                 01887000
SAVTBITN EQU   IEDNSVTD+312                                             01888000
@NM00104 EQU   SAVTCKQB+8                                               01889000
@NM00103 EQU   SAVTCKEC+1                                               01890000
@NM00102 EQU   SAVTCKCC                                                 01891000
SAVTCKPO EQU   SAVTCKCC                                                 01892000
SAVTCKWA EQU   SAVTCKCC                                                 01893000
SAVTCKCH EQU   SAVTCKTB+1                                               01894000
SAVTCKVT EQU   SAVTCKTB                                                 01895000
@NM00101 EQU   IEDNSVTD+297                                             01896000
SAVTRDFG EQU   SAVTRDRV+12                                              01897000
@NM00100 EQU   SAVTRDRV+5                                               01898000
SAVTRDPY EQU   SAVTRDRV+4                                               01899000
SAVTRDQB EQU   SAVTRDRV+1                                               01900000
SAVTRDKY EQU   SAVTRDRV                                                 01901000
SAVTNID  EQU   IEDNSVTD+280                                             01902000
SAVTDVAS EQU   IEDNSVTD+276                                             01903000
SAVTPLSZ EQU   IEDNSVTD+274                                             01904000
@NM00099 EQU   IEDNSVTD+273                                             01905000
SAVTSUBL EQU   IEDNSVTD+272                                             01906000
@NM00098 EQU   SAVTZELM+1                                               01907000
SAVTSUBM EQU   SAVTZELM                                                 01908000
SAVTMHDX EQU   IEDNSVTD+268                                             01909000
SAVTNAT1 EQU   IEDNSVTD+266                                             01910000
SAVTSH20 EQU   IEDNSVTD+264                                             01911000
SAVTLCBS EQU   IEDNSVTD+260                                             01912000
SAVTRNMP EQU   IEDNSVTD+256                                             01913000
SAVTTNTX EQU   IEDNSVTD+252                                             01914000
SAVTNAX  EQU   IEDNSVTD+248                                             01915000
SAVTSUBV EQU   IEDNSVTD+247                                             01916000
SAVTSUBA EQU   IEDNSVTD+246                                             01917000
SAVTSIBC EQU   IEDNSVTD+244                                             01918000
SAVTBSM  EQU   IEDNSVTD+240                                             01919000
SAVTSCPT EQU   SAVTTCPU                                                 01920000
SAVTRQTG EQU   IEDNSVTD+236                                             01921000
SAVTRQCH EQU   IEDNSVTD+232                                             01922000
SAVTMAND EQU   IEDNSVTD+228                                             01923000
SAVTSPLN EQU   IEDNSVTD+224                                             01924000
SAVTNADL EQU   IEDNSVTD+222                                             01925000
SAVTNATL EQU   IEDNSVTD+220                                             01926000
SAVTMHTB EQU   IEDNSVTD+216                                             01927000
SAVTSSMH EQU   IEDNSVTD+212                                             01928000
SAVTQRS  EQU   IEDNSVTD+208                                             01929000
SAVTRQIN EQU   IEDNSVTD+204                                             01930000
SAVTDFCO EQU   IEDNSVTD+200                                             01931000
SAVTSAO  EQU   IEDNSVTD+196                                             01932000
SAVTSARI EQU   IEDNSVTD+192                                             01933000
SAVTSAC  EQU   IEDNSVTD+188                                             01934000
SAVTSAI  EQU   IEDNSVTD+184                                             01935000
SAVTCSCI EQU   IEDNSVTD+180                                             01936000
SAVTSSRP EQU   IEDNSVTD+176                                             01937000
SAVTSSRQ EQU   IEDNSVTD+172                                             01938000
SAVTSCLU EQU   IEDNSVTD+168                                             01939000
SAVTXTRQ EQU   IEDNSVTD+164                                             01940000
SAVTMVBF EQU   IEDNSVTD+160                                             01941000
@NM00097 EQU   IEDNSVTD+148                                             01942000
SAVTIPCQ EQU   IEDNSVTD+144                                             01943000
@NM00096 EQU   IEDNSVTD+136                                             01944000
SAVTXFMI EQU   IEDNSVTD+132                                             01945000
@NM00095 EQU   IEDNSVTD+124                                             01946000
SAVTXFMO EQU   IEDNSVTD+120                                             01947000
@NM00094 EQU   IEDNSVTD+116                                             01948000
SAVTSSSR EQU   IEDNSVTD+112                                             01949000
SAVTSCPQ EQU   IEDNSVTD+108                                             01950000
SAVTSLCB EQU   IEDNSVTD+104                                             01951000
SAVTLUSR EQU   IEDNSVTD+100                                             01952000
@NM00093 EQU   SAVTLUSQ+8                                               01953000
SAVTLUSP EQU   SAVTLUSQ+4                                               01954000
SAVTLUSB EQU   SAVTLUSQ                                                 01955000
@NM00092 EQU   IEDNSVTD+84                                              01956000
SAVTSAT  EQU   IEDNSVTD+80                                              01957000
SAVTNAT  EQU   IEDNSVTD+76                                              01958000
SAVTCLUP EQU   IEDNSVTD+72                                              01959000
SAVTPIUT EQU   IEDNSVTD+68                                              01960000
SAVTRNTA EQU   IEDNSVTD+64                                              01961000
SAVTDNIR EQU   IEDNSVTD+60                                              01962000
SAVTCNIR EQU   IEDNSVTD+56                                              01963000
SAVTFLDH EQU   IEDNSVTD+52                                              01964000
SAVTSRTN EQU   IEDNSVTD+48                                              01965000
SAVTSREQ EQU   IEDNSVTD+44                                              01966000
SAVTFAIL EQU   IEDNSVTD+42                                              01967000
SAVTSUSE EQU   IEDNSVTD+40                                              01968000
SAVTSIB  EQU   IEDNSVTD+36                                              01969000
SAVTPRTN EQU   IEDNSVTD+32                                              01970000
@NM00091 EQU   IEDNSVTD+28                                              01971000
SAVTWH20 EQU   IEDNSVTD+26                                              01972000
SAVTPWT  EQU   IEDNSVTD+24                                              01973000
SAVTPRTQ EQU   IEDNSVTD+20                                              01974000
SAVTPREQ EQU   IEDNSVTD+16                                              01975000
SAVTPH20 EQU   IEDNSVTD+14                                              01976000
SAVTPUSE EQU   IEDNSVTD+12                                              01977000
SAVTPLCB EQU   IEDNSVTD+8                                               01978000
SAVTPOOL EQU   IEDNSVTD+4                                               01979000
SAVTPRMT EQU   SAVTDIAF                                                 01980000
SAVTVIRT EQU   SAVTDIAF                                                 01981000
AVTCPBNO EQU   IEDQAVTD+1244                                            01982000
AVTHRESS EQU   IEDQAVTD+1243                                            01983000
@NM00090 EQU   IEDQAVTD+1242                                            01984000
@NM00089 EQU   IEDQAVTD+1241                                            01985000
@NM00088 EQU   IEDQAVTD+1240                                            01986000
@NM00087 EQU   IEDQAVTD+1237                                            01987000
@NM00086 EQU   IEDQAVTD+1236                                            01988000
AVTHRESE EQU   @NM00085                                                 01989000
AVTRADDR EQU   IEDQAVTD+1228                                            01990000
AVTNADDR EQU   IEDQAVTD+1224                                            01991000
AVTHRESN EQU   IEDQAVTD+1220                                            01992000
AVTVOLRN EQU   IEDQAVTD+1216                                            01993000
AVTTOTNN EQU   IEDQAVTD+1212                                            01994000
AVTTRCYN EQU   IEDQAVTD+1208                                            01995000
AVTRCTRN EQU   IEDQAVTD+1204                                            01996000
AVTNOVON EQU   IEDQAVTD+1200                                            01997000
AVTADEBN EQU   IEDQAVTD+1196                                            01998000
AVTVOLRR EQU   IEDQAVTD+1192                                            01999000
AVTTOTNR EQU   IEDQAVTD+1188                                            02000000
AVTTRCYR EQU   IEDQAVTD+1184                                            02001000
AVTRCTRR EQU   IEDQAVTD+1180                                            02002000
AVTNOVOR EQU   IEDQAVTD+1176                                            02003000
AVTADEBR EQU   IEDQAVTD+1172                                            02004000
AVTLODPT EQU   IEDQAVTD+1168                                            02005000
AVTIOBN  EQU   IEDQAVTD+1164                                            02006000
AVTIOBR  EQU   IEDQAVTD+1160                                            02007000
AVTCPBPT EQU   IEDQAVTD+1156                                            02008000
AVTFCPB  EQU   IEDQAVTD+1152                                            02009000
@NM00084 EQU   IEDQAVTD+1148                                            02010000
AVTINCPQ EQU   IEDQAVTD+1144                                            02011000
@NM00083 EQU   IEDQAVTD+1140                                            02012000
@NM00082 EQU   IEDQAVTD+1137                                            02013000
@NM00081 EQU   AVTBIT4                                                  02014000
@NM00080 EQU   AVTBIT4                                                  02015000
@NM00079 EQU   AVTBIT4                                                  02016000
@NM00078 EQU   AVTBIT4                                                  02017000
@NM00077 EQU   AVTBIT4                                                  02018000
@NM00076 EQU   AVTBIT4                                                  02019000
@NM00075 EQU   AVTBIT4                                                  02020000
AVTRUFTN EQU   AVTBIT4                                                  02021000
@NM00074 EQU   IEDQAVTD+1132                                            02022000
AVTNOBFQ EQU   IEDQAVTD+1128                                            02023000
@NM00073 EQU   IEDQAVTD+1124                                            02024000
AVTDKENQ EQU   IEDQAVTD+1120                                            02025000
@NM00072 EQU   IEDQAVTD+1116                                            02026000
AVTDKAPQ EQU   IEDQAVTD+1112                                            02027000
AVTCOPY  EQU   IEDQAVTD+1108                                            02028000
AVTIA    EQU   IEDQAVTD+1104                                            02029000
AVTFL    EQU   IEDQAVTD+1100                                            02030000
@NM00071 EQU   IEDQAVTD+1096                                            02031000
AVTNCPBQ EQU   IEDQAVTD+1092                                            02032000
AVTTOTNC EQU   IEDQAVTD+1088                                            02033000
AVTCMAX  EQU   IEDQAVTD+1084                                            02034000
AVTCMIN  EQU   IEDQAVTD+1080                                            02035000
AVTHM02  EQU   IEDQAVTD+1076                                            02036000
AVTOPCIN EQU   IEDQAVTD+1074                                            02037000
AVTDCTLN EQU   IEDQAVTD+1072                                            02038000
AVTOPMSK EQU   IEDQAVTD+1068                                            02039000
AVTDDFT  EQU   IEDQAVTD+1064                                            02040000
AVTSTEAL EQU   IEDQAVTD+1060                                            02041000
AVTOPTN  EQU   IEDQAVTD+1056                                            02042000
AVTDSKCT EQU   IEDQAVTD+1054                                            02043000
AVTCKRST EQU   IEDQAVTD+1053                                            02044000
AVTSTAN  EQU   AVTBIT3                                                  02045000
AVTSTACN EQU   AVTBIT3                                                  02046000
AVTSTAIN EQU   AVTBIT3                                                  02047000
AVTSTAYN EQU   AVTBIT3                                                  02048000
AVTOLTBN EQU   AVTBIT3                                                  02049000
AVTTSAB  EQU   AVTBIT3                                                  02050000
AVTRFULN EQU   AVTBIT3                                                  02051000
AVTRECVN EQU   AVTBIT3                                                  02052000
@NM00070 EQU   AVTBIT2                                                  02053000
@NM00069 EQU   AVTBIT2                                                  02054000
AVTOPEIN EQU   AVTBIT2                                                  02055000
AVTSTRTN EQU   AVTBIT2                                                  02056000
AVTTOPOL EQU   AVTBIT2                                                  02057000
AVTCOPYN EQU   AVTBIT2                                                  02058000
AVTREUSN EQU   AVTBIT2                                                  02059000
AVTEXTSC EQU   AVTBIT2                                                  02060000
AVTDISKN EQU   AVTBIT1                                                  02061000
AVTQUCKN EQU   AVTBIT1                                                  02062000
AVTCLOSN EQU   AVTBIT1                                                  02063000
AVTREADN EQU   AVTBIT1                                                  02064000
AVTDLAYN EQU   AVTBIT1                                                  02065000
AVTAQTAN EQU   AVTBIT1                                                  02066000
AVTTSON  EQU   AVTBIT1                                                  02067000
AVTAPLKN EQU   AVTBIT1                                                  02068000
AVTDUMBR EQU   IEDQAVTD+1048                                            02069000
AVTDLQX  EQU   IEDQAVTD+1046                                            02070000
AVTINTLV EQU   IEDQAVTD+1044                                            02071000
AVTSMCNT EQU   IEDQAVTD+1042                                            02072000
AVTAVFCT EQU   IEDQAVTD+1040                                            02073000
AVTOPCON EQU   IEDQAVTD+1038                                            02074000
AVTOPCNT EQU   IEDQAVTD+1036                                            02075000
AVTLNCNT EQU   IEDQAVTD+1034                                            02076000
AVTKEYLE EQU   IEDQAVTD+1032                                            02077000
AVTHA16  EQU   IEDQAVTD+1030                                            02078000
AVTHA7   EQU   IEDQAVTD+1028                                            02079000
AVTHA4   EQU   IEDQAVTD+1026                                            02080000
AVTHA3   EQU   IEDQAVTD+1024                                            02081000
AVTHA2   EQU   IEDQAVTD+1022                                            02082000
AVTGETMS EQU   IEDQAVTD+1021                                            02083000
@NM00068 EQU   IEDQAVTD+1020                                            02084000
AVTGETMD EQU   IEDQAVTD+1016                                            02085000
AVTGETMN EQU   IEDQAVTD+1012                                            02086000
AVTCWTOT EQU   IEDQAVTD+1008                                            02087000
AVTCWINT EQU   IEDQAVTD+956                                             02088000
AVTDTRAP EQU   IEDQAVTD+952                                             02089000
@NM00067 EQU   IEDQAVTD+950                                             02090000
@NM00066 EQU   AVTIOTR                                                  02091000
AVTIOTRH EQU   AVTIOTR                                                  02092000
AVTIOTRE EQU   AVTIOTR                                                  02093000
@NM00065 EQU   AVTSUBT                                                  02094000
AVTSUBPT EQU   AVTSUBT                                                  02095000
AVTSUBON EQU   AVTSUBT                                                  02096000
AVTAFE30 EQU   IEDQAVTD+944                                             02097000
AVTAFE20 EQU   IEDQAVTD+940                                             02098000
AVTAFE10 EQU   IEDQAVTD+936                                             02099000
AVTCWEC2 EQU   IEDQAVTD+932                                             02100000
AVTCWPM2 EQU   IEDQAVTD+928                                             02101000
AVTCWTS2 EQU   IEDQAVTD+927                                             02102000
AVTCWTS1 EQU   IEDQAVTD+926                                             02103000
AVTCWCLD EQU   AVTCWFL2                                                 02104000
AVTCWRAP EQU   AVTCWFL2                                                 02105000
@NM00064 EQU   AVTCWFL2                                                 02106000
@NM00063 EQU   AVTCWFL2                                                 02107000
@NM00062 EQU   AVTCWFL2                                                 02108000
@NM00061 EQU   AVTCWFL2                                                 02109000
@NM00060 EQU   AVTCWFL2                                                 02110000
AVTCWACT EQU   AVTCWFL2                                                 02111000
@NM00059 EQU   AVTCWFL1                                                 02112000
@NM00058 EQU   AVTCWFL1                                                 02113000
@NM00057 EQU   AVTCWFL1                                                 02114000
@NM00056 EQU   AVTCWFL1                                                 02115000
@NM00055 EQU   AVTCWFL1                                                 02116000
@NM00054 EQU   AVTCWFL1                                                 02117000
@NM00053 EQU   AVTCWFL1                                                 02118000
AVTCOMWN EQU   AVTCWFL1                                                 02119000
AVTCWEC1 EQU   IEDQAVTD+920                                             02120000
AVTCWPM1 EQU   IEDQAVTD+916                                             02121000
AVTCAREA EQU   IEDQAVTD+912                                             02122000
AVTFZERO EQU   IEDQAVTD+908                                             02123000
AVTCADDR EQU   IEDQAVTD+904                                             02124000
AVTCOREC EQU   IEDQAVTD+900                                             02125000
@NM00052 EQU   IEDQAVTD+892                                             02126000
AVTCPBCB EQU   IEDQAVTD+888                                             02127000
@NM00051 EQU   IEDQAVTD+880                                             02128000
AVTDSIOB EQU   IEDQAVTD+876                                             02129000
@NM00050 EQU   IEDQAVTD+868                                             02130000
AVTCPRMB EQU   IEDQAVTD+864                                             02131000
@NM00049 EQU   IEDQAVTD+856                                             02132000
AVTCLOSB EQU   IEDQAVTD+852                                             02133000
@NM00048 EQU   IEDQAVTD+844                                             02134000
AVTACTIB EQU   IEDQAVTD+840                                             02135000
@NM00047 EQU   IEDQAVTD+836                                             02136000
AVTOLTEB EQU   IEDQAVTD+832                                             02137000
AVTOLTCH EQU   AVTOLTQB+1                                               02138000
AVTOLTVT EQU   AVTOLTQB                                                 02139000
@NM00046 EQU   AVTOPCQB+8                                               02140000
@NM00045 EQU   AVTOPCEC+1                                               02141000
@NM00044 EQU   AVTOPCCC                                                 02142000
AVTOPCPO EQU   AVTOPCCC                                                 02143000
AVTOPCWA EQU   AVTOPCCC                                                 02144000
AVTOPCCH EQU   AVTOPCOB+1                                               02145000
AVTOPCVT EQU   AVTOPCOB                                                 02146000
@NM00043 EQU   AVTCKPQB+9                                               02147000
AVTCKPTS EQU   AVTCKPQB+8                                               02148000
@NM00042 EQU   AVTCKPEC+1                                               02149000
@NM00041 EQU   AVTCKPCC                                                 02150000
AVTCKPPO EQU   AVTCKPCC                                                 02151000
AVTCKPWA EQU   AVTCKPCC                                                 02152000
AVTCKPCH EQU   AVTCKPTB+1                                               02153000
AVTCKPVT EQU   AVTCKPTB                                                 02154000
@NM00040 EQU   IEDQAVTD+796                                             02155000
AVTBFRTB EQU   IEDQAVTD+792                                             02156000
@NM00039 EQU   IEDQAVTD+784                                             02157000
AVTBFREB EQU   IEDQAVTD+780                                             02158000
AVTTIMQ  EQU   IEDQAVTD+776                                             02159000
@NM00038 EQU   IEDQAVTD+772                                             02160000
AVTIMQPS EQU   IEDQAVTD+768                                             02161000
AVTINOUT EQU   IEDQAVTD+766                                             02162000
AVTREFTM EQU   IEDQAVTD+764                                             02163000
@NM00037 EQU   IEDQAVTD+752                                             02164000
AVTDELYB EQU   IEDQAVTD+748                                             02165000
AVTOCQPT EQU   IEDQAVTD+744                                             02166000
AVTTSOPT EQU   IEDQAVTD+740                                             02167000
AVTSUPPT EQU   IEDQAVTD+736                                             02168000
AVTCBQCB EQU   IEDQAVTD+732                                             02169000
AVTMSGS  EQU   IEDQAVTD+729                                             02170000
@NM00036 EQU   AVTSYSER                                                 02171000
@NM00035 EQU   AVTSYSER                                                 02172000
@NM00034 EQU   AVTSYSER                                                 02173000
@NM00033 EQU   AVTSYSER                                                 02174000
@NM00032 EQU   AVTSYSER                                                 02175000
@NM00031 EQU   AVTSYSER                                                 02176000
AVTCMAXN EQU   AVTSYSER                                                 02177000
AVTCMINN EQU   AVTSYSER                                                 02178000
AVT2260L EQU   IEDQAVTD+724                                             02179000
AVTABEPL EQU   AVTADBUF                                                 02180000
AVTHFF   EQU   AVTCLRHI+2                                               02181000
@NM00030 EQU   AVTCLRHI                                                 02182000
AVTCCKEY EQU   AVTCCELE                                                 02183000
AVTDELAD EQU   IEDQAVTD+704                                             02184000
AVTDELEM EQU   IEDQAVTD+700                                             02185000
AVTBSX   EQU   AVTCKLNK                                                 02186000
AVTOPETR EQU   AVTHG01                                                  02187000
@NM00029 EQU   AVTCKBYT                                                 02188000
AVTCKONQ EQU   AVTCKBYT                                                 02189000
@NM00028 EQU   AVTCKBYT                                                 02190000
@NM00027 EQU   AVTCKBYT                                                 02191000
@NM00026 EQU   AVTCKBYT                                                 02192000
@NM00025 EQU   AVTCKBYT                                                 02193000
@NM00024 EQU   AVTCKBYT                                                 02194000
@NM00023 EQU   AVTCKBYT                                                 02195000
AVTOPERT EQU   IEDQAVTD+690                                             02196000
AVTOPXCL EQU   IEDQAVTD+688                                             02197000
AVTOPERL EQU   IEDQAVTD+687                                             02198000
@NM00022 EQU   IEDQAVTD+686                                             02199000
AVTCKTIM EQU   IEDQAVTD+684                                             02200000
AVTCKELV EQU   IEDQAVTD+682                                             02201000
AVTCPRCD EQU   IEDQAVTD+681                                             02202000
AVTWARMN EQU   AVTCKELF                                                 02203000
AVTCRTLN EQU   AVTCKELF                                                 02204000
AVTCPIPN EQU   AVTCKELF                                                 02205000
AVTCCLCN EQU   AVTCKELF                                                 02206000
AVTCINCN EQU   AVTCKELF                                                 02207000
@NM00021 EQU   AVTCKELF                                                 02208000
AVTCMCPN EQU   AVTCKELF                                                 02209000
AVTCRDYN EQU   AVTCKELF                                                 02210000
AVTCKQAD EQU   IEDQAVTD+677                                             02211000
AVTSCBSZ EQU   IEDQAVTD+676                                             02212000
@NM00020 EQU   IEDQAVTD+672                                             02213000
AVTCKELE EQU   IEDQAVTD+668                                             02214000
@NM00019 EQU   AVTCKPEL+8                                               02215000
AVTCKRLK EQU   AVTCKPEL+5                                               02216000
AVTCKRPR EQU   AVTCKPEL+4                                               02217000
AVTCKRMQ EQU   AVTCKRMV+1                                               02218000
AVTCKRKY EQU   AVTCKRMV                                                 02219000
AVTHK    EQU   IEDQAVTD+648                                             02220000
AVTHI    EQU   IEDQAVTD+644                                             02221000
AVTIOT   EQU   IEDQAVTD+640                                             02222000
AVTNX    EQU   IEDQAVTD+636                                             02223000
AVTTONE  EQU   IEDQAVTD+632                                             02224000
AVTA3TL  EQU   IEDQAVTD+628                                             02225000
AVTDMECB EQU   IEDQAVTD+624                                             02226000
AVTABEND EQU   IEDQAVTD+618                                             02227000
AVTPLCBN EQU   IEDQAVTD+616                                             02228000
@NM00018 EQU   AVTSAVTP+1                                               02229000
@NM00017 EQU   AVTSAVTF                                                 02230000
AVTSNA   EQU   AVTSAVTF                                                 02231000
AVTONSNA EQU   AVTSAVTF                                                 02232000
AVTVTMCP EQU   AVTSAVTF                                                 02233000
@NM00016 EQU   IEDQAVTD+608                                             02234000
AVTCMBSS EQU   IEDQAVTD+604                                             02235000
AVTRCV   EQU   IEDQAVTD+600                                             02236000
AVTSEND  EQU   IEDQAVTD+596                                             02237000
AVTCSCH  EQU   IEDQAVTD+592                                             02238000
AVTQ1    EQU   IEDQAVTD+588                                             02239000
AVTE7    EQU   IEDQAVTD+584                                             02240000
AVTHB    EQU   IEDQAVTD+580                                             02241000
AVTR1    EQU   IEDQAVTD+576                                             02242000
AVTBZ    EQU   IEDQAVTD+572                                             02243000
AVTEZ    EQU   IEDQAVTD+568                                             02244000
AVTEC    EQU   IEDQAVTD+564                                             02245000
AVTEW    EQU   IEDQAVTD+560                                             02246000
AVTNDIAL EQU   AVTSCOPT                                                 02247000
AVTN2741 EQU   AVTSCOPT                                                 02248000
AVTCONCO EQU   AVTSCOPT                                                 02249000
AVTCONC  EQU   AVTSCOPT                                                 02250000
AVTCMBUF EQU   AVTSCOPT                                                 02251000
AVTAPDMP EQU   AVTSCOPT                                                 02252000
@NM00015 EQU   AVTSCOPT                                                 02253000
AVTHA    EQU   AVTDISP                                                  02254000
AVTEA    EQU   IEDQAVTD+548                                             02255000
AVTAX    EQU   IEDQAVTD+544                                             02256000
AVTA3    EQU   IEDQAVTD+540                                             02257000
AVTGD    EQU   IEDQAVTD+536                                             02258000
AVTAL    EQU   IEDQAVTD+532                                             02259000
AVTOLTST EQU   AVTHG02                                                  02260000
AVTE8    EQU   IEDQAVTD+524                                             02261000
AVTUI    EQU   IEDQAVTD+520                                             02262000
AVTCOMPT EQU   IEDQAVTD+516                                             02263000
AVTCRSRF EQU   IEDQAVTD+512                                             02264000
@NM00014 EQU   IEDQAVTD+508                                             02265000
AVTKA02  EQU   IEDQAVTD+504                                             02266000
AVTOPTPT EQU   IEDQAVTD+500                                             02267000
AVTPCBPT EQU   IEDQAVTD+496                                             02268000
@NM00013 EQU   AVTECB1                                                  02269000
AVTCOMP  EQU   AVTECB1                                                  02270000
@NM00012 EQU   AVTECB1                                                  02271000
AVTOPECA EQU   IEDQAVTD+488                                             02272000
AVTOLECA EQU   IEDQAVTD+484                                             02273000
AVTCKECA EQU   IEDQAVTD+480                                             02274000
AVTCWECA EQU   IEDQAVTD+476                                             02275000
AVTCWTCB EQU   IEDQAVTD+472                                             02276000
AVTOLTCB EQU   IEDQAVTD+468                                             02277000
AVTOCTCB EQU   IEDQAVTD+464                                             02278000
AVTCKTCB EQU   IEDQAVTD+460                                             02279000
AVTAS    EQU   IEDQAVTD+456                                             02280000
AVTNOLBF EQU   IEDQAVTD+454                                             02281000
AVTNCKPR EQU   IEDQAVTD+453                                             02282000
AVTCIB   EQU   IEDQAVTD+452                                             02283000
AVTSPLPT EQU   IEDQAVTD+448                                             02284000
AVTMVBFR EQU   IEDQAVTD+444                                             02285000
AVTSBTA  EQU   IEDQAVTD+440                                             02286000
AVTRARTN EQU   IEDQAVTD+436                                             02287000
AVTBSCAN EQU   IEDQAVTD+432                                             02288000
AVTRDYA  EQU   IEDQAVTD+428                                             02289000
AVTRNMPT EQU   IEDQAVTD+424                                             02290000
AVTDISTR EQU   IEDQAVTD+420                                             02291000
AVTPARM3 EQU   IEDQAVTD+416                                             02292000
@NM00011 EQU   AVTPKF                                                   02293000
@NM00010 EQU   AVTPKF                                                   02294000
@NM00009 EQU   AVTPKF                                                   02295000
AVTFTCHF EQU   AVTPKF                                                   02296000
@NM00008 EQU   AVTPKF                                                   02297000
@NM00007 EQU   AVTPKF                                                   02298000
@NM00006 EQU   AVTPKF                                                   02299000
@NM00005 EQU   AVTPKF                                                   02300000
AVTPARM  EQU   IEDQAVTD+408                                             02301000
AVTEXS2A EQU   IEDQAVTD+402                                             02302000
AVTEXA2S EQU   IEDQAVTD+396                                             02303000
@NM00004 EQU   AVTCKFLG                                                 02304000
AVTCKHLT EQU   AVTCKFLG                                                 02305000
AVTCKREQ EQU   AVTCKFLG                                                 02306000
AVTCKENV EQU   AVTCKFLG                                                 02307000
AVTCKNAC EQU   AVTCKFLG                                                 02308000
AVTCKTAC EQU   AVTCKFLG                                                 02309000
@NM00002 EQU   IEDQAVTD+384                                             02310000
AVTREADD EQU   IEDQAVTD+380                                             02311000
AVTREADY EQU   IEDQAVTD+376                                             02312000
AVTRACE  EQU   IEDQAVTD+372                                             02313000
AVTTCB   EQU   IEDQAVTD+368                                             02314000
AVTPASWD EQU   IEDQAVTD+360                                             02315000
AVTCTLCH EQU   IEDQAVTD+352                                             02316000
AVTDOUBL EQU   IEDQAVTD+344                                             02317000
AVTDOUBX EQU   IEDQAVTD+336                                             02318000
AVTDPARM EQU   IEDQAVTD+332                                             02319000
AVTCSTCS EQU   IEDQAVTD+328                                             02320000
AVTDLQ   EQU   AVTSAVEX+32                                              02321000
@NM00001 EQU   AVTSAVEX                                                 02322000
AVTSAVE4 EQU   IEDQAVTD+216                                             02323000
AVTSAVE3 EQU   IEDQAVTD+144                                             02324000
AVTSAVE2 EQU   IEDQAVTD+72                                              02325000
AVTSAVE1 EQU   IEDQAVTD                                                 02326000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02327000
@RC00400 EQU   @RC00399                                                 02328000
@RC00370 EQU   @RC00368                                                 02329000
@RC00412 EQU   @RC00368                                                 02330000
@RF00411 EQU   @RC00368                                                 02331000
@PB00003 EQU   @EL00001                                                 02332000
@RC00401 EQU   @RC00400                                                 02333000
@PB00002 EQU   @PB00003                                                 02334000
@ENDDATA EQU   *                                                        02335000
         END   IEDQNV,(C'PLS2126',0701,77109)                           02336000
./  ADD  SSI=70330077,NAME=IEDQNW
         TITLE 'IEDQNW, 3705 CHECKPOINT/RESTART I/O                    *00001000
                        '                                               00002000
IEDQNW   CSECT ,                                                01S0001 00003000
@PROLOG  DS    0H                                               01S0002 00004000
*   STM(REG14,REG12,SAVEREGS);      /* SAVE REGISTERS IN CALLER SAVE    00005000
*                                      AREA                          */ 00006000
         STM   REG14,REG12,SAVEREGS(REG13)                      02S0120 00007000
*   RBASE=REG15;                    /* SET BASE ADDRESS FROM ENTRY      00008000
*                                      REGISTER                      */ 00009000
         LR    RBASE,REG15                                      02S0121 00010000
*   GEN NOREFS NOSETS;                                          02S0122 00011000
*                                   /*                                  00012000
         USING IEDQNW,RBASE            ESTABLISH ADDRESSABILITY         00013000
IEDQNW   IEDHJN AFTERHJN,HJN           MODULE IDENTIFICATION MACRO      00014000
*   RSAVE=REG13;                    /* SAVE ADDRESS OF CALLERS SAVE     00015000
*                                      AREA                          */ 00016000
         LR    RSAVE,REG13                                      02S0123 00017000
*   RFY                                                         02S0124 00018000
*     REG13 UNRSTD;                                             02S0124 00019000
*                                                               02S0125 00020000
*   /*****************************************************************/ 00021000
*   /*                                                               */ 00022000
*   /* PROCESS: THIS SEGMENT DOES THE PROCESSING THAT IS NECESSARY TO*/ 00023000
*   /* PERFORM THE FUNCTION OF THE MODULE. IF THE I/O IS TO THE 3705 */ 00024000
*   /* CONTROL RECORD, THEN USE THE FIRST RELATIVE RECORD IN THE DATA*/ 00025000
*   /* SET. OTHERWISE, FIND THE ADDRESS VIA A CONVERSION OF THE TTRN.*/ 00026000
*   /* ISSUE EXCP TO START THE I/O AND SET UP THE WAIT LIST TO WAIT  */ 00027000
*   /* FOR THE I/O TO COMPLETE.                                      */ 00028000
*   /*                                                               */ 00029000
*   /*****************************************************************/ 00030000
*                                                               02S0125 00031000
*   RSTATE=0;                       /* INITIALIZE TO INDICATE   02S0125 00032000
*                                      SUCCESSFUL OPERATION          */ 00033000
         SLR   RSTATE,RSTATE                                    02S0125 00034000
*   IF CKPRWADD=ADDR(CKPNCNTL)      /* TEST FOR REQUEST TYPE         */ 00035000
*     THEN                          /* REQUEST TO START I/O TO THE      00036000
*                                      CONTROL RECORD                */ 00037000
         LA    @14,CKPNCNTL(,RCKPT)                             02S0126 00038000
         L     @12,CKPRWADD-1(,RCKPT)                           02S0126 00039000
         LA    @12,0(,@12)                                      02S0126 00040000
         CR    @14,@12                                          02S0126 00041000
         BNE   @RF00126                                         02S0126 00042000
*     DO;                                                       02S0127 00043000
*       RDEB=IEDQDPTR-PREFDEB;      /* GET ADDRESS OF THE DEB PREFIX */ 00044000
         L     RDEB,IEDQDPTR(,RCKPT)                            02S0128 00045000
         SH    RDEB,PREFDEB                                     02S0128 00046000
*       CKPIOM=0;                   /* SET TO WRITE TO FIRST EXTENT  */ 00047000
         MVI   CKPIOM(RCKPT),X'00'                              02S0129 00048000
*       CKPIOSK(2:7)=EXSADDR;       /* GET BIN, CYLINDER, AND TRACK     00049000
*                                      NUMBERS FROM THE DEB EXTENT      00050000
*                                      DATA                          */ 00051000
         MVC   CKPIOSK+1(6,RCKPT),EXSADDR(RDEB)                 02S0130 00052000
*       CKPIOR=1;                   /* WRITE TO FIRST RECORD         */ 00053000
         MVI   CKPIOR(RCKPT),X'01'                              02S0131 00054000
*       CKPSECTR=0;                 /* CLEAR SECTOR ID               */ 00055000
         MVI   CKPSECTR(RCKPT),X'00'                            02S0132 00056000
*     END;                                                      02S0133 00057000
*   ELSE                            /* I/O NOT FOR CONTROL RECORD    */ 00058000
*                                                               03S0134 00059000
*     /***************************************************************/ 00060000
*     /*                                                             */ 00061000
*     /* PROCESS.FINDADDR: THIS SEGMENT DOES THE CALCULATIONS TO FIND*/ 00062000
*     /* THE TRACK ADDRESS FOR A GIVEN RESOURCE.                     */ 00063000
*     /*                                                             */ 00064000
*     /***************************************************************/ 00065000
*                                                               03S0134 00066000
*     DO;                                                       03S0134 00067000
         B     @RC00126                                         03S0134 00068000
@RF00126 DS    0H                                               03S0135 00069000
*       IF CKPNRSID<CKPTRKCN        /* TEST FOR VALID RESOURCE       */ 00070000
*         THEN                      /* RESOURCE IS VALID             */ 00071000
         LH    @14,CKPNRSID(,RCKPT)                             03S0135 00072000
         CH    @14,CKPTRKCN(,RCKPT)                             03S0135 00073000
         BNL   @RF00135                                         03S0135 00074000
*         DO;                                                   03S0136 00075000
*           RPARM=CKPNRSID+CKPNTRK; /* CALCULATE THE RELATIVE OFFSET    00076000
*                                      OF THE RECORD                 */ 00077000
         AH    @14,CKPNTRK(,RCKPT)                              03S0137 00078000
         LR    RPARM,@14                                        03S0137 00079000
*           REG00=0;                /* CLEAR FOR DIVIDE              */ 00080000
         SLR   REG00,REG00                                      03S0138 00081000
*           RDATA=CKPBLKPT;         /* GET BLOCKS PER TRACK COUNT    */ 00082000
         SLR   RDATA,RDATA                                      03S0139 00083000
         IC    RDATA,CKPBLKPT(,RCKPT)                           03S0139 00084000
*           GEN REFS(REG00,RPARM,RDATA) SETS(REG00,RPARM);      03S0140 00085000
*                                   /*                                  00086000
            DR    REG00,RDATA          DIVIDE TO GET TRACK NUMBER       00087000
*                                      AND RECORD NUMBER                00088000
*           SLL(RPARM,16);          /* SHIFT TRACK NUMBER SO THAT REG   00089000
*                                      CONTAINS NUMBER OF THE FORM      00090000
*                                      TT00                          */ 00091000
         SLL   RPARM,16                                         03S0141 00092000
*           REG00=REG00+RECNO;      /* INCREMENT RECORD NUMBER TO       00093000
*                                      SKIP PAST RELATIVE RECORD 0   */ 00094000
         AL    REG00,@CF00059                                   03S0142 00095000
*           SLL(REG00,8);           /* SHIFT RECORD NUMBER SO THAT      00096000
*                                      REG CONTAINS NUMBER OF THE       00097000
*                                      FORM 00RN, WHERE N IS    03S0143 00098000
*                                      CONCATENATION NUMBER OF 0     */ 00099000
         SLL   REG00,8                                          03S0143 00100000
*           REG00=REG00+RPARM;      /* CREATE TTRN VALUE             */ 00101000
         ALR   REG00,RPARM                                      03S0144 00102000
*           LM(RPARM,RDATA,CKPCPARM);/* SET DEB ADDRESS AND AREA        00103000
*                                      ADDRESS TO CONTAIN THE   03S0145 00104000
*                                      CONVERTED ADDRESS             */ 00105000
         LM    RPARM,RDATA,CKPCPARM(RCKPT)                      03S0145 00106000
*           CALL IECPCNVT;          /* CALL CONVERSION ROUTINE - SEE    00107000
*                                      INTRODUTORY COMMENTS FOR 03S0146 00108000
*                                      INPUT/OUTPUT FOR THIS ROUTINE */ 00109000
         L     @12,CVTPTR                                       03S0146 00110000
         L     @15,CVTPCNVT(,@12)                               03S0146 00111000
         BALR  @14,@15                                          03S0146 00112000
*           IF REG15=0             /* TEST RETURN CODE FROM    03S0147 00113000
*                                      CONVERSION                    */ 00114000
*             THEN                  /* CONVERSION UNSUCCESSFUL       */ 00115000
         LTR   REG15,REG15                                      03S0147 00116000
         BZ    @RF00147                                         03S0147 00117000
*             RSTATE=CKPEODAT;      /* SET ERROR CODE                */ 00118000
         LA    RSTATE,8                                         03S0148 00119000
*         END;                                                  03S0149 00120000
*       ELSE                        /* RESOURCE IS NOT VALID         */ 00121000
*         RSTATE=CKPEODAT;          /* SET ERROR CODE                */ 00122000
         B     @RC00135                                         03S0150 00123000
@RF00135 LA    RSTATE,8                                         03S0150 00124000
*     END;                                                      03S0151 00125000
@RC00135 DS    0H                                               03S0152 00126000
*   IF RSTATE=0                     /* TEST FOR STATE IN WHICH I/O      00127000
*                                      CAN BE REQUESTED              */ 00128000
*     THEN                          /* I/O CAN BE REQUESTED          */ 00129000
@RC00126 LTR   RSTATE,RSTATE                                    02S0152 00130000
         BNZ   @RF00152                                         02S0152 00131000
*     DO;                                                       02S0153 00132000
*       GEN REFS(CKPIOB) SETS(RPARM);                           02S0154 00133000
*                                   /*                                  00134000
         EXCP  CKPIOB(,RCKPT)          ISSUE I/O                        00135000
*       CAVTEOL2=0;                 /* MAKE THE 3705 CKPT DATA SET      00136000
*                                      I/O ECB ...                   */ 00137000
         MVI   CAVTEOL2(RCAVT),X'00'                            02S0155 00138000
*       CAVTEOL3=EOL;               /* ... THE LAST ECB IN THE WAIT     00139000
*                                      LIST                          */ 00140000
         MVI   CAVTEOL3(RCAVT),X'80'                            02S0156 00141000
*       CAVTNIOE=ADDR(CKPECB);      /* PUT THE 3705 I/O ECB ADDR INTO   00142000
*                                      THE WAIT LIST                 */ 00143000
         LA    @14,CKPECB(,RCKPT)                               02S0157 00144000
         STCM  @14,7,CAVTNIOE(RCAVT)                            02S0157 00145000
*       REG15=0;                    /* CLEAR TO INDICATE SUCCESSFUL     00146000
*                                      OPERATION                     */ 00147000
         SLR   REG15,REG15                                      02S0158 00148000
*     END;                                                      02S0159 00149000
*   ELSE                            /* I/O CANNOT BE REQUESTED       */ 00150000
*     REG15=RSTATE;                 /* SAVE ERROR CODE               */ 00151000
         B     @RC00152                                         02S0160 00152000
@RF00152 LR    REG15,RSTATE                                     02S0160 00153000
*                                                               02S0161 00154000
*   /*****************************************************************/ 00155000
*   /*                                                               */ 00156000
*   /* EPILOGUE: THIS SEGMENT COMPLETES THE EPILOGUE CODE THAT WAS   */ 00157000
*   /* ALTERED BY THE MODULE PROCEDURE STATEMENT.                    */ 00158000
*   /*                                                               */ 00159000
*   /*****************************************************************/ 00160000
*                                                               02S0161 00161000
*   RFY                                                         02S0161 00162000
*    (REG00,                                                    02S0161 00163000
*     REG12,                                                    02S0161 00164000
*     REG13,                                                    02S0161 00165000
*     REG14) RSTD;                                              02S0161 00166000
@RC00152 DS    0H                                               02S0162 00167000
*   REG13=RSAVE;                    /* RESTORE POINTER TO CALLER'S      00168000
*                                      SAVE AREA                     */ 00169000
         LR    REG13,RSAVE                                      02S0162 00170000
*   REG14=SAVER14;                  /* RESTORE CALLER'S REGISTER 14  */ 00171000
         L     REG14,SAVER14(,REG13)                            02S0163 00172000
*   LM(REG00,REG12,SAVEREM);        /* RESTORE REGISTERS 0 THRU 12   */ 00173000
         LM    REG00,REG12,SAVEREM(REG13)                       02S0164 00174000
*   RFY                                                         02S0165 00175000
*    (REG00,                                                    02S0165 00176000
*     REG12,                                                    02S0165 00177000
*     REG13,                                                    02S0165 00178000
*     REG14) UNRSTD;                                            02S0165 00179000
*   END IEDQNW                                                  01S0166 00180000
*                                                               01S0166 00181000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00182000
*/*%INCLUDE SYSLIB  (TCAVTD  )                                       */ 00183000
*/*%INCLUDE SYSLIB  (TCKPD   )                                       */ 00184000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 00185000
*/*%INCLUDE SYSLIB  (TDEBD   )                                       */ 00186000
*/*%INCLUDE SYSUT5  (RFY     )                                       */ 00187000
*/*%INCLUDE SYSUT5  (DCL     )                                       */ 00188000
*/*%INCLUDE SYSUT5  (PROLOGUE)                                       */ 00189000
*/*%INCLUDE SYSUT5  (PROCESS )                                       */ 00190000
*/*%INCLUDE SYSUT5  (FINDADDR)                                       */ 00191000
*/*%INCLUDE SYSUT5  (EPILOGUE)                                       */ 00192000
*                                                               01S0166 00193000
*       ;                                                       01S0166 00194000
@EL00001 DS    0H                                               01S0166 00195000
@EF00001 DS    0H                                               01S0166 00196000
@ER00001 BR    @14                                              01S0166 00197000
@DATA    DS    0H                                                       00198000
         DS    0F                                                       00199000
         DS    0F                                                       00200000
@CF00059 DC    F'1'                                                     00201000
         DS    0D                                                       00202000
PREFDEB  DC    AL2(DEBNMSUB-IEDQDEB)                                    00203000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00204000
@01      EQU   01                                                       00205000
@02      EQU   02                                                       00206000
@03      EQU   03                                                       00207000
@04      EQU   04                                                       00208000
@05      EQU   05                                                       00209000
@06      EQU   06                                                       00210000
@07      EQU   07                                                       00211000
@08      EQU   08                                                       00212000
@09      EQU   09                                                       00213000
@10      EQU   10                                                       00214000
@11      EQU   11                                                       00215000
@12      EQU   12                                                       00216000
@13      EQU   13                                                       00217000
@14      EQU   14                                                       00218000
@15      EQU   15                                                       00219000
RCAVT    EQU   @05                                                      00220000
RCKPT    EQU   @04                                                      00221000
RDEB     EQU   @08                                                      00222000
REG00    EQU   @00                                                      00223000
RPARM    EQU   @01                                                      00224000
RDATA    EQU   @02                                                      00225000
RBASE    EQU   @03                                                      00226000
RSTATE   EQU   @06                                                      00227000
RSAVE    EQU   @07                                                      00228000
REG12    EQU   @12                                                      00229000
REG13    EQU   @13                                                      00230000
REG14    EQU   @14                                                      00231000
REG15    EQU   @15                                                      00232000
CVTPTR   EQU   16                                                       00233000
IEDQCKAD EQU   0                                                        00234000
CAVTWL1  EQU   IEDQCKAD+12                                              00235000
CAVTWL2  EQU   CAVTWL1+8                                                00236000
CAVTEOL2 EQU   CAVTWL2                                                  00237000
CAVTEOL3 EQU   CAVTWL2+4                                                00238000
CAVTNIOE EQU   CAVTWL2+5                                                00239000
IEDQCKPD EQU   0                                                        00240000
CKPIOB   EQU   IEDQCKPD+72                                              00241000
CKPIOECB EQU   CKPIOB+4                                                 00242000
CKPIOSK  EQU   CKPIOB+32                                                00243000
CKPIOM   EQU   CKPIOSK                                                  00244000
CKPIOR   EQU   CKPIOSK+7                                                00245000
CKPECB   EQU   IEDQCKPD+112                                             00246000
CKPEXCP  EQU   IEDQCKPD+116                                             00247000
CKPECBL  EQU   IEDQCKPD+120                                             00248000
CKPCNVRT EQU   CKPECBL                                                  00249000
CKPIOQL  EQU   IEDQCKPD+132                                             00250000
@NM00005 EQU   CKPIOQL                                                  00251000
CKPCTTRB EQU   IEDQCKPD+144                                             00252000
CKPSECTR EQU   CKPCTTRB                                                 00253000
CKPCPARM EQU   IEDQCKPD+148                                             00254000
CKPCCWS  EQU   IEDQCKPD+168                                             00255000
CKPTIC   EQU   CKPCCWS+24                                               00256000
CKPRW    EQU   CKPCCWS+32                                               00257000
CKPRWADD EQU   CKPRW+1                                                  00258000
@NM00008 EQU   IEDQCKPD+208                                             00259000
CKPMSG   EQU   IEDQCKPD+220                                             00260000
CKPMSGTX EQU   CKPMSG+4                                                 00261000
CKPMSGTP EQU   CKPMSG+41                                                00262000
CKPCNTLR EQU   IEDQCKPD+288                                             00263000
CKPFLAGS EQU   CKPCNTLR                                                 00264000
CKPPRQNO EQU   CKPCNTLR+17                                              00265000
IEDQCDRD EQU   0                                                        00266000
CDRTTRLI EQU   IEDQCDRD+9                                               00267000
CDRDATA  EQU   IEDQCDRD+12                                              00268000
IEDQCRED EQU   0                                                        00269000
CRELINK  EQU   IEDQCRED+4                                               00270000
CREOFFS  EQU   IEDQCRED+12                                              00271000
CKPREQTB EQU   0                                                        00272000
CKPCTFLG EQU   CKPREQTB                                                 00273000
CKPNRES  EQU   0                                                        00274000
CKPNFLG  EQU   CKPNRES+4                                                00275000
CKPAVT   EQU   0                                                        00276000
CVTMAP   EQU   0                                                        00277000
CVTPCNVT EQU   CVTMAP+28                                                00278000
CVTDAR   EQU   CVTMAP+72                                                00279000
CVTFLGS1 EQU   CVTDAR                                                   00280000
CVTDCB   EQU   CVTMAP+116                                               00281000
CVTOPTA  EQU   CVTMAP+182                                               00282000
CVTOPTB  EQU   CVTMAP+183                                               00283000
CVTTSCVT EQU   CVTMAP+228                                               00284000
CVTTSFLG EQU   CVTTSCVT                                                 00285000
CVTGTF   EQU   CVTMAP+236                                               00286000
CVTGTFST EQU   CVTGTF                                                   00287000
CVTAQAVT EQU   CVTMAP+240                                               00288000
CVTTCMFG EQU   CVTAQAVT                                                 00289000
CVTVOLM2 EQU   CVTMAP+244                                               00290000
CVTTATA  EQU   CVTVOLM2                                                 00291000
CVTTSKS  EQU   CVTTATA                                                  00292000
CVTVOLF2 EQU   CVTTSKS                                                  00293000
CVTTAT   EQU   CVTTATA+1                                                00294000
CVTATER  EQU   CVTMAP+248                                               00295000
CVTEXT1  EQU   CVTMAP+252                                               00296000
CVTPURG  EQU   CVTMAP+260                                               00297000
CVTQMSG  EQU   CVTMAP+268                                               00298000
CVTDMSR  EQU   CVTMAP+272                                               00299000
CVTAPF   EQU   CVTMAP+324                                               00300000
CVTEXT2  EQU   CVTMAP+328                                               00301000
CVTHJES  EQU   CVTMAP+332                                               00302000
CVTPGSIA EQU   CVTMAP+348                                               00303000
CVTA1F1  EQU   CVTMAP+356                                               00304000
CVTSYSK  EQU   CVTMAP+357                                               00305000
CVTXTNT1 EQU   0                                                        00306000
CVTXTNT2 EQU   0                                                        00307000
CVTDSSV  EQU   CVTXTNT2                                                 00308000
CVTRSV90 EQU   CVTXTNT2+5                                               00309000
CVTQID   EQU   CVTXTNT2+24                                              00310000
CVTATCVT EQU   CVTXTNT2+32                                              00311000
CVTFIX   EQU   0                                                        00312000
CVTRELNO EQU   CVTFIX+252                                               00313000
IEDQDEB  EQU   0                                                        00314000
DEBPRF   EQU   IEDQDEB                                                  00315000
DEBAPVT  EQU   DEBPRF                                                   00316000
DEBNMSUB EQU   IEDQDEB+36                                               00317000
DEBNMEXT EQU   IEDQDEB+52                                               00318000
DEBUCBS  EQU   IEDQDEB+68                                               00319000
IECPCNVT EQU   0                                                        00320000
SAVEREGS EQU   0                                                        00321000
SAVER14  EQU   SAVEREGS                                                 00322000
SAVEREM  EQU   SAVEREGS+8                                               00323000
DEBSUBR  EQU   0                                                        00324000
IEDQAPTR EQU   0                                                        00325000
CKPINIT  EQU   CKPEXCP                                                  00326000
CKPTWA   EQU   CKPMSGTX                                                 00327000
CKPNCNTL EQU   CKPCNTLR                                                 00328000
CKPTRKCN EQU   CKPNCNTL+16                                              00329000
CKPBLKPT EQU   CKPNCNTL+20                                              00330000
CKPDATTM EQU   CKPNCNTL+22                                              00331000
CKPNFLDS EQU   CKPEXCP                                                  00332000
CKPNSELT EQU   CKPNFLDS+16                                              00333000
CKPNTRK  EQU   CKPNFLDS+20                                              00334000
CKPNRSID EQU   CKPNFLDS+22                                              00335000
CKPOVER  EQU   CKPMSGTP+1                                               00336000
CKPOPNFL EQU   CKPFLAGS                                                 00337000
CDRINCFM EQU   CDRTTRLI                                                 00338000
CDRCREQR EQU   IEDQCDRD                                                 00339000
CDRCKFLG EQU   CDRCREQR                                                 00340000
CVTS01   EQU   CVTPGSIA                                                 00341000
CVTLPDIA EQU   CVTS01+12                                                00342000
CVTDIRST EQU   CVTLPDIA                                                 00343000
CVTSLIDA EQU   CVTS01+24                                                00344000
CVTSER   EQU   CVTS01+28                                                00345000
CVTSEFLG EQU   CVTSER                                                   00346000
CVTSEG   EQU   CVTS01+32                                                00347000
CVTSEGC  EQU   CVTSEG+8                                                 00348000
CVTSEGD  EQU   CVTSEG+12                                                00349000
CVTCTLFG EQU   CVTS01+50                                                00350000
CVTATMCT EQU   CVTS01+96                                                00351000
IEDQDPTR EQU   CKPCPARM                                                 00352000
DEBUCB   EQU   DEBUCBS                                                  00353000
DEBDVMOD EQU   DEBUCB                                                   00354000
DEBUCBAD EQU   DEBUCB+1                                                 00355000
EXTENT   EQU   DEBUCB                                                   00356000
EXUCB    EQU   EXTENT                                                   00357000
EXSADDR  EQU   EXTENT+4                                                 00358000
CDROPCB  EQU   CDRDATA                                                  00359000
CKPMSGPN EQU   CKPMSGTP+6                                               00360000
CKPSLVAL EQU   CKPNSELT                                                 00361000
CKPTTRLT EQU   CKPTIC+5                                                 00362000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00363000
EXTRACKS EQU   EXTENT+14                                                00364000
EXETRK   EQU   EXTENT+12                                                00365000
EXECYL   EQU   EXTENT+10                                                00366000
EXSTRK   EQU   EXSADDR+4                                                00367000
EXSCYL   EQU   EXSADDR+2                                                00368000
EXBIN    EQU   EXSADDR                                                  00369000
EXUCBAD  EQU   EXUCB+1                                                  00370000
EXFLAGS  EQU   EXUCB                                                    00371000
CVTRSV86 EQU   CVTS01+112                                               00372000
CVTRSV85 EQU   CVTS01+108                                               00373000
CVTRSV84 EQU   CVTS01+104                                               00374000
CVTACTAP EQU   CVTS01+100                                               00375000
CVTATMCA EQU   CVTATMCT+1                                               00376000
CVTATMST EQU   CVTATMCT                                                 00377000
CVTSYSWT EQU   CVTS01+92                                                00378000
CVTPTCD  EQU   CVTS01+88                                                00379000
CVTPFIXP EQU   CVTS01+84                                                00380000
CVTPFIXR EQU   CVTS01+80                                                00381000
CVTPFIXQ EQU   CVTS01+76                                                00382000
CVT0VL01 EQU   CVTS01+72                                                00383000
CVTSHRVM EQU   CVTS01+68                                                00384000
CVTPVALD EQU   CVTS01+64                                                00385000
CVTTAS   EQU   CVTS01+60                                                00386000
CVTRSCN  EQU   CVTS01+56                                                00387000
CVTTRAC2 EQU   CVTS01+54                                                00388000
CVTTRACE EQU   CVTS01+52                                                00389000
CVTAPG   EQU   CVTS01+51                                                00390000
CVTSDTRC EQU   CVTCTLFG                                                 00391000
CVTGTRCE EQU   CVTCTLFG                                                 00392000
CVTRSV80 EQU   CVTCTLFG                                                 00393000
CVTRSV79 EQU   CVTCTLFG                                                 00394000
CVTDSTAT EQU   CVTCTLFG                                                 00395000
CVTT1DSP EQU   CVTCTLFG                                                 00396000
CVTAPGB  EQU   CVTCTLFG                                                 00397000
CVTPSIC  EQU   CVTCTLFG                                                 00398000
CVTSPVLK EQU   CVTS01+49                                                00399000
CVTRSV77 EQU   CVTS01+48                                                00400000
CVTSEGDA EQU   CVTSEGD+1                                                00401000
CVTSEGLD EQU   CVTSEGD                                                  00402000
CVTSEGCA EQU   CVTSEGC+1                                                00403000
CVTSEGLC EQU   CVTSEGC                                                  00404000
CVTSEGB  EQU   CVTSEG+4                                                 00405000
CVTSEGA  EQU   CVTSEG                                                   00406000
CVTSERA  EQU   CVTSER+1                                                 00407000
CVTRSV76 EQU   CVTSEFLG                                                 00408000
CVTRSV75 EQU   CVTSEFLG                                                 00409000
CVTRSV74 EQU   CVTSEFLG                                                 00410000
CVTRSV73 EQU   CVTSEFLG                                                 00411000
CVTRSV72 EQU   CVTSEFLG                                                 00412000
CVTRSV71 EQU   CVTSEFLG                                                 00413000
CVTRSV70 EQU   CVTSEFLG                                                 00414000
CVTSEIC  EQU   CVTSEFLG                                                 00415000
CVTSLID  EQU   CVTSLIDA+1                                               00416000
CVTSYLK  EQU   CVTSLIDA                                                 00417000
CVTPGSUP EQU   CVTS01+20                                                00418000
CVTPAGE1 EQU   CVTS01+16                                                00419000
CVTLPDIR EQU   CVTLPDIA+1                                               00420000
CVTRSV69 EQU   CVTDIRST                                                 00421000
CVTRSV68 EQU   CVTDIRST                                                 00422000
CVTRSV67 EQU   CVTDIRST                                                 00423000
CVTRSV66 EQU   CVTDIRST                                                 00424000
CVTRSV65 EQU   CVTDIRST                                                 00425000
CVTRSV64 EQU   CVTDIRST                                                 00426000
CVTRSV63 EQU   CVTDIRST                                                 00427000
CVTDICOM EQU   CVTDIRST                                                 00428000
CVTPVTP  EQU   CVTS01+8                                                 00429000
CVTLPDSR EQU   CVTS01+4                                                 00430000
CVTRSVA2 EQU   CVTS01                                                   00431000
CDRCKOPT EQU   CDRCREQR+41                                              00432000
CDRCKPQB EQU   CDRCREQR+38                                              00433000
CDRCKQCB EQU   CDRCREQR+17                                              00434000
CDRCKQBC EQU   CDRCREQR+14                                              00435000
CDRCKMSG EQU   CDRCREQR+12                                              00436000
CDRCKOFF EQU   CDRCREQR+10                                              00437000
@NM00022 EQU   CDRCREQR+9                                               00438000
@NM00021 EQU   CDRCREQR+8                                               00439000
CDRCKOUT EQU   CDRCREQR+6                                               00440000
CDRCKIN  EQU   CDRCREQR+4                                               00441000
@NM00020 EQU   CDRCREQR+1                                               00442000
CDRCKRNC EQU   CDRCKFLG                                                 00443000
CDROPTN  EQU   CDRINCFM+7                                               00444000
CDRSEQOU EQU   CDRINCFM+5                                               00445000
CDRSEQIN EQU   CDRINCFM+3                                               00446000
CDROFFS  EQU   CDRINCFM+1                                               00447000
CDRSTAT  EQU   CDRINCFM                                                 00448000
@NM00019 EQU   CKPOPNFL                                                 00449000
CKPOPNCR EQU   CKPOPNFL                                                 00450000
CKPOPNIN EQU   CKPOPNFL                                                 00451000
CKPOPNEN EQU   CKPOPNFL                                                 00452000
@NM00018 EQU   CKPOPNFL                                                 00453000
CKPTRKSA EQU   CKPOVER+4                                                00454000
CKPTRKLN EQU   CKPOVER+2                                                00455000
CKPRCDSR EQU   CKPOVER                                                  00456000
CKPSLNEW EQU   CKPNSELT+1                                               00457000
CKPCUSEL EQU   CKPNSELT                                                 00458000
CKPNDEVF EQU   CKPNFLDS+12                                              00459000
CKPNTTE  EQU   CKPNFLDS+8                                               00460000
CKPENCDE EQU   CKPNFLDS+7                                               00461000
@NM00017 EQU   CKPNFLDS                                                 00462000
CKPBCKUP EQU   CKPNCNTL+30                                              00463000
CKPTIME  EQU   CKPDATTM+4                                               00464000
CKPDATE  EQU   CKPDATTM                                                 00465000
@NM00016 EQU   CKPNCNTL+21                                              00466000
@NM00015 EQU   CKPNCNTL+18                                              00467000
@NM00014 EQU   CKPNCNTL+14                                              00468000
CKPBLKSZ EQU   CKPNCNTL+12                                              00469000
CKPIPLTX EQU   CKPNCNTL+4                                               00470000
CKPSWTCH EQU   CKPNCNTL+3                                               00471000
CKPTRSTA EQU   CKPNCNTL+2                                               00472000
@NM00013 EQU   CKPNCNTL                                                 00473000
CKPTRMAD EQU   CKPTWA+60                                                00474000
CKPSAVE2 EQU   CKPTWA                                                   00475000
CKPCTTRA EQU   CKPINIT+24                                               00476000
@NM00012 EQU   CKPINIT+22                                               00477000
CKPIPERE EQU   CKPINIT+20                                               00478000
CKPDATIM EQU   CKPINIT+12                                               00479000
CKPCTTRC EQU   CKPINIT+8                                                00480000
CKPDATLN EQU   CKPINIT+6                                                00481000
CKPKEYLN EQU   CKPINIT+5                                                00482000
CKPRCDNO EQU   CKPINIT+4                                                00483000
CKPHEDNO EQU   CKPINIT+2                                                00484000
CKPCYLNO EQU   CKPINIT                                                  00485000
SAVER15  EQU   SAVEREGS+4                                               00486000
DEBAPPAD EQU   IEDQDEB+65                                               00487000
DEBEXSCL EQU   IEDQDEB+64                                               00488000
DEBDCBAD EQU   IEDQDEB+61                                               00489000
DEBPROTG EQU   IEDQDEB+60                                               00490000
DEBECBAD EQU   IEDQDEB+57                                               00491000
DEBPRIOR EQU   IEDQDEB+56                                               00492000
DEBUSRPG EQU   IEDQDEB+53                                               00493000
DEBSYSPG EQU   IEDQDEB+49                                               00494000
DEBOPATB EQU   IEDQDEB+48                                               00495000
DEBIRBAD EQU   IEDQDEB+45                                               00496000
DEBOFLGS EQU   IEDQDEB+44                                               00497000
DEBDEBAD EQU   IEDQDEB+41                                               00498000
DEBAMLNG EQU   IEDQDEB+40                                               00499000
DEBTCBAD EQU   IEDQDEB+37                                               00500000
@NM00027 EQU   DEBPRF+33                                                00501000
DEBLNGTH EQU   DEBPRF+32                                                00502000
DEBDCBMK EQU   DEBPRF+28                                                00503000
DEBDSCBA EQU   DEBPRF+21                                                00504000
DEBWKARA EQU   DEBPRF+20                                                00505000
DEBXCEA  EQU   DEBAPVT+16                                               00506000
DEBCEA   EQU   DEBAPVT+12                                               00507000
DEBPCIA  EQU   DEBAPVT+8                                                00508000
DEBSIOA  EQU   DEBAPVT+4                                                00509000
DEBEOEA  EQU   DEBAPVT                                                  00510000
CVTLEVL  EQU   CVTRELNO+2                                               00511000
CVTNUMB  EQU   CVTRELNO                                                 00512000
CVTMDL   EQU   CVTFIX+250                                               00513000
@NM00026 EQU   CVTFIX+248                                               00514000
@NM00025 EQU   CVTFIX                                                   00515000
CVTRSVA1 EQU   CVTXTNT2+48                                              00516000
CVTRSVA0 EQU   CVTXTNT2+44                                              00517000
CVTRSV99 EQU   CVTXTNT2+40                                              00518000
CVTRSV98 EQU   CVTXTNT2+36                                              00519000
CVTATACT EQU   CVTATCVT                                                 00520000
CVTOLTEP EQU   CVTXTNT2+28                                              00521000
CVTQIDA  EQU   CVTQID+1                                                 00522000
CVTRSV95 EQU   CVTQID                                                   00523000
CVTRSV94 EQU   CVTXTNT2+20                                              00524000
CVTRSV93 EQU   CVTXTNT2+16                                              00525000
CVTRSV92 EQU   CVTXTNT2+12                                              00526000
CVTDEBVR EQU   CVTXTNT2+8                                               00527000
CVTRSV91 EQU   CVTXTNT2+6                                               00528000
CVTRSV9H EQU   CVTRSV90                                                 00529000
CVTRSV9G EQU   CVTRSV90                                                 00530000
CVTRSV9F EQU   CVTRSV90                                                 00531000
CVTRSV9E EQU   CVTRSV90                                                 00532000
CVTRSV9D EQU   CVTRSV90                                                 00533000
CVTRSV9C EQU   CVTRSV90                                                 00534000
CVTRSV9B EQU   CVTRSV90                                                 00535000
CVTRSV9A EQU   CVTRSV90                                                 00536000
CVTNUCLS EQU   CVTXTNT2+4                                               00537000
CVTDSSVA EQU   CVTDSSV+1                                                00538000
CVTRSV89 EQU   CVTDSSV                                                  00539000
CVTRSV88 EQU   CVTXTNT1+8                                               00540000
CVTRSV87 EQU   CVTXTNT1+4                                               00541000
CVTFACHN EQU   CVTXTNT1                                                 00542000
CVTRSV62 EQU   CVTMAP+388                                               00543000
CVTRSV61 EQU   CVTMAP+384                                               00544000
CVTRSV60 EQU   CVTMAP+380                                               00545000
CVTSTOA  EQU   CVTMAP+376                                               00546000
CVTRSV58 EQU   CVTMAP+374                                               00547000
CVTRSV57 EQU   CVTMAP+372                                               00548000
CVTDDCE  EQU   CVTMAP+368                                               00549000
CVTPNWFR EQU   CVTMAP+364                                               00550000
CVTSMF   EQU   CVTMAP+360                                               00551000
CVTSULK  EQU   CVTMAP+358                                               00552000
CVTSLKO  EQU   CVTSYSK                                                  00553000
CVTSLKP  EQU   CVTSYSK                                                  00554000
CVTSLKQ  EQU   CVTSYSK                                                  00555000
CVTSLKR  EQU   CVTSYSK                                                  00556000
CVTRSV56 EQU   CVTSYSK                                                  00557000
CVTRSV55 EQU   CVTSYSK                                                  00558000
CVTRSV54 EQU   CVTSYSK                                                  00559000
CVTRSV53 EQU   CVTSYSK                                                  00560000
CVTRSV52 EQU   CVTA1F1                                                  00561000
CVTRSV51 EQU   CVTA1F1                                                  00562000
CVTRSV50 EQU   CVTA1F1                                                  00563000
CVTRSV49 EQU   CVTA1F1                                                  00564000
CVTRSV48 EQU   CVTA1F1                                                  00565000
CVTRSV47 EQU   CVTA1F1                                                  00566000
CVTSRSW  EQU   CVTA1F1                                                  00567000
CVTPFSW  EQU   CVTA1F1                                                  00568000
CVTPCVT  EQU   CVTMAP+352                                               00569000
CVTRSV46 EQU   CVTMAP+344                                               00570000
CVTRSV45 EQU   CVTMAP+340                                               00571000
CVTRSV44 EQU   CVTMAP+338                                               00572000
CVTRSV43 EQU   CVTMAP+336                                               00573000
CVTHJESA EQU   CVTHJES+1                                                00574000
CVTRSV42 EQU   CVTHJES                                                  00575000
CVTEXT2A EQU   CVTEXT2+1                                                00576000
CVTRSV41 EQU   CVTEXT2                                                  00577000
CVTAPFA  EQU   CVTAPF+1                                                 00578000
CVTRSV40 EQU   CVTAPF                                                   00579000
CVTINTLA EQU   CVTMAP+320                                               00580000
CVTERPV  EQU   CVTMAP+316                                               00581000
CVTEORM  EQU   CVTMAP+312                                               00582000
CVTMCHPR EQU   CVTMAP+308                                               00583000
CVTTZ    EQU   CVTMAP+304                                               00584000
CVTJEPS  EQU   CVTMAP+300                                               00585000
CVTJESCT EQU   CVTMAP+296                                               00586000
CVTMODE  EQU   CVTMAP+292                                               00587000
CVTPTRV  EQU   CVTMAP+288                                               00588000
CVTREAL  EQU   CVTMAP+284                                               00589000
CVTRSV39 EQU   CVTMAP+280                                               00590000
CVTRSV38 EQU   CVTMAP+276                                               00591000
CVTDMSRA EQU   CVTDMSR+1                                                00592000
CVTRSV37 EQU   CVTDMSR                                                  00593000
CVTQMSGA EQU   CVTQMSG+1                                                00594000
CVTRSV36 EQU   CVTQMSG                                                  00595000
CVTAMFF  EQU   CVTMAP+264                                               00596000
CVTPURGA EQU   CVTPURG+1                                                00597000
CVTRSV35 EQU   CVTPURG                                                  00598000
CVTCBSP  EQU   CVTMAP+256                                               00599000
CVTATERA EQU   CVTATER+1                                                00600000
CVTSYST  EQU   CVTATER                                                  00601000
CVTVOLT2 EQU   CVTTAT                                                   00602000
CVTVOLI2 EQU   CVTVOLF2                                                 00603000
CVTAQAVB EQU   CVTAQAVT+1                                               00604000
CVTRSV34 EQU   CVTTCMFG                                                 00605000
CVTRSV33 EQU   CVTTCMFG                                                 00606000
CVTRSV32 EQU   CVTTCMFG                                                 00607000
CVTRSV31 EQU   CVTTCMFG                                                 00608000
CVTRSV30 EQU   CVTTCMFG                                                 00609000
CVTRSV29 EQU   CVTTCMFG                                                 00610000
CVTLDEV  EQU   CVTTCMFG                                                 00611000
CVTTCRDY EQU   CVTTCMFG                                                 00612000
CVTGTFA  EQU   CVTGTF+1                                                 00613000
CVTRSV27 EQU   CVTGTFST                                                 00614000
CVTRNIO  EQU   CVTGTFST                                                 00615000
CVTUSR   EQU   CVTGTFST                                                 00616000
CVTFORM  EQU   CVTGTFST                                                 00617000
CVTTMODE EQU   CVTGTFST                                                 00618000
CVTSTATE EQU   CVTGTFST                                                 00619000
CVTGTFS  EQU   CVTGTFST                                                 00620000
CVT0SCR1 EQU   CVTMAP+232                                               00621000
CVTTSCVB EQU   CVTTSCVT+1                                               00622000
CVTRSV25 EQU   CVTTSFLG                                                 00623000
CVTRSV24 EQU   CVTTSFLG                                                 00624000
CVTRSV23 EQU   CVTTSFLG                                                 00625000
CVTRSV22 EQU   CVTTSFLG                                                 00626000
CVTRSV21 EQU   CVTTSFLG                                                 00627000
CVTRSV20 EQU   CVTTSFLG                                                 00628000
CVTRSV19 EQU   CVTTSFLG                                                 00629000
CVTTSRDY EQU   CVTTSFLG                                                 00630000
CVTRMS   EQU   CVTMAP+224                                               00631000
CVTPATCH EQU   CVTMAP+220                                               00632000
CVTTSCE  EQU   CVTMAP+216                                               00633000
CVTLNKSC EQU   CVTMAP+214                                               00634000
CVTQABST EQU   CVTMAP+212                                               00635000
CVTMDLDS EQU   CVTMAP+208                                               00636000
CVTUSER  EQU   CVTMAP+204                                               00637000
CVTABEND EQU   CVTMAP+200                                               00638000
CVTSMCA  EQU   CVTMAP+196                                               00639000
CVTRSV18 EQU   CVTMAP+192                                               00640000
CVTQLPAQ EQU   CVTMAP+188                                               00641000
CVTQCDSR EQU   CVTMAP+184                                               00642000
CVTRSV17 EQU   CVTOPTB                                                  00643000
CVTRSV16 EQU   CVTOPTB                                                  00644000
CVTFP    EQU   CVTOPTB                                                  00645000
CVTAPTHR EQU   CVTOPTB                                                  00646000
CVTNLOG  EQU   CVTOPTB                                                  00647000
CVTTOD   EQU   CVTOPTB                                                  00648000
CVTRSV14 EQU   CVTOPTB                                                  00649000
CVTPROT  EQU   CVTOPTB                                                  00650000
CVTXPFP  EQU   CVTOPTA                                                  00651000
CVTASCII EQU   CVTOPTA                                                  00652000
CVTRSV13 EQU   CVTOPTA                                                  00653000
CVTRSV12 EQU   CVTOPTA                                                  00654000
CVTNIP   EQU   CVTOPTA                                                  00655000
CVTDDR   EQU   CVTOPTA                                                  00656000
CVTAPR   EQU   CVTOPTA                                                  00657000
CVTCCH   EQU   CVTOPTA                                                  00658000
CVTSNCTR EQU   CVTMAP+180                                               00659000
CVTQMWR  EQU   CVTMAP+176                                               00660000
CVTQOCR  EQU   CVTMAP+172                                               00661000
CVT1EF00 EQU   CVTMAP+168                                               00662000
CVTMZ00  EQU   CVTMAP+164                                               00663000
CVTHEAD  EQU   CVTMAP+160                                               00664000
CVTRSV11 EQU   CVTMAP+156                                               00665000
CVT0PT01 EQU   CVTMAP+152                                               00666000
CVTMSER  EQU   CVTMAP+148                                               00667000
CVTIERLC EQU   CVTMAP+144                                               00668000
CVTILCH  EQU   CVTMAP+140                                               00669000
CVT0DS   EQU   CVTMAP+136                                               00670000
CVTFBOSV EQU   CVTMAP+132                                               00671000
CVTNUCB  EQU   CVTMAP+128                                               00672000
CVTIXAVL EQU   CVTMAP+124                                               00673000
CVTIOQET EQU   CVTMAP+120                                               00674000
CVTDCBA  EQU   CVTMAP+117                                               00675000
CVTRSV10 EQU   CVTDCB                                                   00676000
CVT6DAT  EQU   CVTDCB                                                   00677000
CVT4MPS  EQU   CVTDCB                                                   00678000
CVTRSV09 EQU   CVTDCB                                                   00679000
CVT4MS1  EQU   CVTDCB                                                   00680000
CVT2SPS  EQU   CVTDCB                                                   00681000
CVT1SSS  EQU   CVTDCB                                                   00682000
CVTRSV08 EQU   CVTDCB                                                   00683000
CVTSTB   EQU   CVTMAP+112                                               00684000
CVTQTD00 EQU   CVTMAP+108                                               00685000
CVTQTE00 EQU   CVTMAP+104                                               00686000
CVTCUCB  EQU   CVTMAP+100                                               00687000
CVTSJQ   EQU   CVTMAP+96                                                00688000
CVTPBLDL EQU   CVTMAP+92                                                00689000
CVTTPC   EQU   CVTMAP+88                                                00690000
CVTSVDCB EQU   CVTMAP+84                                                00691000
CVTBRET  EQU   CVTMAP+82                                                00692000
CVTEXIT  EQU   CVTMAP+80                                                00693000
CVT0FN00 EQU   CVTMAP+76                                                00694000
CVTDARA  EQU   CVTDAR+1                                                 00695000
CVTRSV07 EQU   CVTFLGS1                                                 00696000
CVTRSV06 EQU   CVTFLGS1                                                 00697000
CVTRSV05 EQU   CVTFLGS1                                                 00698000
CVTRSV04 EQU   CVTFLGS1                                                 00699000
CVTRSV03 EQU   CVTFLGS1                                                 00700000
CVTRSV02 EQU   CVTFLGS1                                                 00701000
CVTRSV01 EQU   CVTFLGS1                                                 00702000
CVTDMPLK EQU   CVTFLGS1                                                 00703000
CVTXITP  EQU   CVTMAP+68                                                00704000
CVTZDTAB EQU   CVTMAP+64                                                00705000
CVTMSLT  EQU   CVTMAP+60                                                00706000
CVTDATE  EQU   CVTMAP+56                                                00707000
CVTBTERM EQU   CVTMAP+52                                                00708000
CVTSYSAD EQU   CVTMAP+48                                                00709000
CVTXTLER EQU   CVTMAP+44                                                00710000
CVTILK2  EQU   CVTMAP+40                                                00711000
CVTILK1  EQU   CVTMAP+36                                                00712000
CVTPRLTV EQU   CVTMAP+32                                                00713000
CVT0VL00 EQU   CVTMAP+24                                                00714000
CVTXAPG  EQU   CVTMAP+20                                                00715000
CVTBUF   EQU   CVTMAP+16                                                00716000
CVTJOB   EQU   CVTMAP+12                                                00717000
CVTLINK  EQU   CVTMAP+8                                                 00718000
CVT0EF00 EQU   CVTMAP+4                                                 00719000
CVTTCBP  EQU   CVTMAP                                                   00720000
CKPIOTR  EQU   CKPAVT+21                                                00721000
CKPSUBT  EQU   CKPAVT+20                                                00722000
CKPLODPT EQU   CKPAVT+16                                                00723000
CKPRADDR EQU   CKPAVT+12                                                00724000
CKPNADDR EQU   CKPAVT+8                                                 00725000
CKPBIT2  EQU   CKPAVT+7                                                 00726000
CKPBIT1  EQU   CKPAVT+6                                                 00727000
CKPINTLV EQU   CKPAVT+4                                                 00728000
CKPOPCIN EQU   CKPAVT+2                                                 00729000
CKPOPCON EQU   CKPAVT                                                   00730000
CKPTYPE  EQU   CKPNRES+5                                                00731000
@NM00024 EQU   CKPNFLG                                                  00732000
CKPLULOG EQU   CKPNFLG                                                  00733000
CKPEPMOD EQU   CKPNFLG                                                  00734000
CKPRSACT EQU   CKPNFLG                                                  00735000
CKPREMB  EQU   CKPNFLG                                                  00736000
CKPCOHRT EQU   CKPNRES+2                                                00737000
CKPSUBST EQU   CKPNRES                                                  00738000
CKPCTSEC EQU   CKPREQTB+6                                               00739000
CKPCTOFF EQU   CKPREQTB+4                                               00740000
CKPCTTTR EQU   CKPREQTB+1                                               00741000
CKPCTDER EQU   CKPCTFLG                                                 00742000
CKPCTACT EQU   CKPCTFLG                                                 00743000
CREDEB   EQU   CREOFFS                                                  00744000
CREECB   EQU   IEDQCRED+8                                               00745000
@NM00023 EQU   CRELINK+1                                                00746000
CREPRI   EQU   CRELINK                                                  00747000
CREQCBAD EQU   IEDQCRED+1                                               00748000
CREKEY   EQU   IEDQCRED                                                 00749000
CDRKEY   EQU   IEDQCDRD+8                                               00750000
CDRTIME  EQU   IEDQCDRD+4                                               00751000
CDRDATE  EQU   IEDQCDRD                                                 00752000
CKPSECT1 EQU   CKPCNTLR+37                                              00753000
CKPTTRT1 EQU   CKPCNTLR+34                                              00754000
CKPSECIN EQU   CKPCNTLR+32                                              00755000
CKPSECCR EQU   CKPCNTLR+30                                              00756000
CKPSECLI EQU   CKPCNTLR+28                                              00757000
CKPSECLT EQU   CKPCNTLR+26                                              00758000
CKPINCLN EQU   CKPCNTLR+24                                              00759000
CKPTTRLI EQU   CKPCNTLR+21                                              00760000
CKPRPERT EQU   CKPCNTLR+20                                              00761000
CKPCKRLN EQU   CKPCNTLR+18                                              00762000
CKPCPERT EQU   CKPPRQNO                                                 00763000
CKPIPERT EQU   CKPCNTLR+16                                              00764000
CKPCPRCD EQU   CKPCNTLR+15                                              00765000
CKPCKRQS EQU   CKPCNTLR+14                                              00766000
CKPBPERR EQU   CKPCNTLR+12                                              00767000
CKPTTRIN EQU   CKPCNTLR+9                                               00768000
CKPINRNO EQU   CKPCNTLR+8                                               00769000
CKPTTRCR EQU   CKPCNTLR+5                                               00770000
CKPCRRNO EQU   CKPCNTLR+4                                               00771000
CKPINCNO EQU   CKPCNTLR+3                                               00772000
CKPINCNT EQU   CKPCNTLR+2                                               00773000
CKPTTRCT EQU   CKPCNTLR+1                                               00774000
CKPOPCRD EQU   CKPFLAGS                                                 00775000
CKPOPTFN EQU   CKPFLAGS                                                 00776000
CKPSTAIN EQU   CKPFLAGS                                                 00777000
CKPERR   EQU   CKPFLAGS                                                 00778000
@NM00011 EQU   CKPFLAGS                                                 00779000
CKPFSCN2 EQU   CKPFLAGS                                                 00780000
CKPFSCN1 EQU   CKPFLAGS                                                 00781000
CKPNORML EQU   CKPFLAGS                                                 00782000
@NM00010 EQU   CKPMSG+65                                                00783000
CKPMSGGL EQU   CKPMSG+61                                                00784000
@NM00009 EQU   CKPMSG+2                                                 00785000
CKPMSGLN EQU   CKPMSG                                                   00786000
CKPWKALN EQU   @NM00008+10                                              00787000
CKPGETML EQU   @NM00008                                                 00788000
CKPRWBC  EQU   CKPRW+6                                                  00789000
@NM00007 EQU   CKPRW+5                                                  00790000
CKPRWFLG EQU   CKPRW+4                                                  00791000
CKPRWCMD EQU   CKPRW                                                    00792000
CKPSCHID EQU   CKPCCWS+16                                               00793000
CKPSETSC EQU   CKPCCWS+8                                                00794000
CKPSEEKC EQU   CKPCCWS                                                  00795000
@NM00006 EQU   IEDQCKPD+164                                             00796000
CKPERRCT EQU   IEDQCKPD+163                                             00797000
CKPSWCH2 EQU   IEDQCKPD+162                                             00798000
CKPSWCH1 EQU   IEDQCKPD+161                                             00799000
CKPCRLEN EQU   IEDQCKPD+160                                             00800000
CKPPARM2 EQU   IEDQCKPD+156                                             00801000
CKPLDRB  EQU   IEDQCKPD+140                                             00802000
CKPLREB  EQU   IEDQCKPD+136                                             00803000
CKPNDRB  EQU   @NM00005                                                 00804000
CKPIOQF  EQU   IEDQCKPD+128                                             00805000
CKPEPLOC EQU   CKPCNVRT                                                 00806000
CKPIOHH  EQU   CKPIOSK+5                                                00807000
CKPIOCC  EQU   CKPIOSK+3                                                00808000
CKPIOBB  EQU   CKPIOSK+1                                                00809000
CKPIORC  EQU   CKPIOB+30                                                00810000
CKPIOBCI EQU   CKPIOB+28                                                00811000
CKPIORST EQU   CKPIOB+25                                                00812000
@NM00004 EQU   CKPIOB+24                                                00813000
CKPIODCB EQU   CKPIOB+21                                                00814000
@NM00003 EQU   CKPIOB+20                                                00815000
CKPIOCPA EQU   CKPIOB+17                                                00816000
CKPIOSIO EQU   CKPIOB+16                                                00817000
CKPIOCSW EQU   CKPIOB+9                                                 00818000
CKPIOFL3 EQU   CKPIOB+8                                                 00819000
@NM00002 EQU   CKPIOECB+1                                               00820000
CKPIOECC EQU   CKPIOECB                                                 00821000
CKPIOSN1 EQU   CKPIOB+3                                                 00822000
CKPIOSN0 EQU   CKPIOB+2                                                 00823000
CKPIOFL2 EQU   CKPIOB+1                                                 00824000
CKPIOFL1 EQU   CKPIOB                                                   00825000
CKPSAVE1 EQU   IEDQCKPD                                                 00826000
CAVTCRIO EQU   IEDQCKAD+28                                              00827000
CAVTNQE  EQU   CAVTWL2+1                                                00828000
CAVTTIOE EQU   CAVTWL1+5                                                00829000
CAVTEOL1 EQU   CAVTWL1+4                                                00830000
CAVTTQE  EQU   CAVTWL1                                                  00831000
@NM00001 EQU   IEDQCKAD+10                                              00832000
CAVTFLGS EQU   IEDQCKAD+9                                               00833000
CAVTWTG  EQU   IEDQCKAD+8                                               00834000
CAVTNWA  EQU   IEDQCKAD+4                                               00835000
CAVTTCWA EQU   IEDQCKAD                                                 00836000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00837000
@RF00147 EQU   @RC00135                                                 00838000
@ENDDATA EQU   *                                                        00839000
         END   IEDQNW,(C'PLS0633',0701,77033)                           00840000
./  ADD  SSI=81350321,NAME=IEDQNX
         TITLE 'IEDQNX - OPERATOR AWARENESS MESSAGE ROUTER'             00050000
IEDQNX   CSECT                                                          00200020
         SPACE 3                                                        00220000
*********************************************************************** 00600020
*                                                                     * 00800020
* MODULE NAME = IEDQNX (TCAM, TERMINATION)                            * 01000000
*                                                                     * 01420022
* DESCRIPTIVE NAME = OPERATOR AWARENESS MESSAGE ROUTER                * 01430000
*                                                                     * 01460022
* COPYRIGHT = NONE                                                    * 01470000
*                                                                     * 01500022
* STATUS = VERSION 10.0                                               * 01510000
*                                                                     * 01600020
* FUNCTION = THIS MODULE BUILDS ERROR MESSAGES AND SENDS THEM TO      * 01700000
* THE PRIMARY OPERATOR CONTROL TERMINAL.                              * 01800000
*                                                                     * 01900000
* WHEN IEDQBD DETECTS AN ERROR SITUATION, CONTROL IS PASSED TO        * 02000000
* THIS ROUTINE WHERE ERROR ANALYSIS IS PERFORMED AND THE              * 02200000
* APPROPRIATE ERROR MESSAGE IS CONSTRUCTED IN AVTSAVE4. IF THE        * 02250000
* PRIMARY OPERATOR CONTROL TERMINAL IS THE SYSTEM CONSOLE THE         * 02300000
* MESSAGE IS DELIVERED VIA THE WTO SVC. OTHERWISE A BUFFER IS         * 02350000
* ACQUIRED FROM THE FREE POOL, ITS PREFIX AND THE SCB INITIALIZED     * 02400000
* FOR TPOST TO THE PRIMARY TERMINAL'S DESTINATION QUEUE, AND THE      * 02450000
* ERROR MESSAGE IS MOVED INTO THE BUFFER. THE ERROR INDICATOR IS      * 02500000
* RESET AND THE LCB IS INITIALIZED FOR TPOST TO IEDQBD TO CONTINUE    * 02550000
* LCB CLEANUP PROCESSING. THE BUFFER AND LCB ARE PASSED TO THE        * 02600000
* TCAM DISPATCHER AT DSPCHAIN.                                        * 02650000
*                                                                     * 02700000
* THIS MODULE'S ADDRESS IS CONTAINED IN THE TCAM AVT (AVTNX). IT IS   * 02750000
* LOADED AT TCAM INITIALIZATION IF THE 'PRIMARY' OPERAND ON THE       * 02800000
* INTRO MACRO IS NOT 'SYSCON'. IT IS ALSO LOADED EACH TIME A 3705     * 02850000
* DCB IS OPENED.                                                      * 02900000
*                                                                     * 02950000
* FOR 270X, WHEN I/O ERRORS OCCUR THE APPROPRIATE ERROR RECOVERY      * 03000000
* (ERP) ROUTINES GAIN CONTROL. AFTER THE ERROR IS DECLARED PERMANENT  * 03050000
* THE PRIMARY OPERATOR CONTROL STATION IS CHECKED FOR THE SYSTEM      * 03100000
* CONSOLE, AND IF NOT AN ERROR INDICATION IS SET IN THE LCB FOR THE   * 03150000
* LINE (LCBERMSG) AND INFORMATION PERTINENT TO THE ERROR IS           * 03200000
* INITIALIZED IN THE LCB AS FOLLOWS:                                  * 03260000
*                                                                     * 03320000
* LCBRESTR-THE COMMAND CODE OF THE FAILING CCW                        * 03400000
* LCBCSWST-THE TWO STATUS BYTES OF THE CSW                            * 03600000
* LCBSENS0-THE FIRST SENSE BYTE IN THE IOB                            * 03800000
* LCBFLAG2-THE TP OP CODE OF THE LAST RETRY CCW                       * 04000000
* LCBSENS1-THE TP OP CODE OF THE FIRST FAILING CCW                    * 04200000
* LCBERRCT-ADDRESSING CHARACTERS,LAST FOUR DIAL DIGITS,OR POLLING     * 04400000
*          CHARACTERS                                                 * 04600000
*                                                                     * 05000020
* WHEN IEDQBD DETECTS THE ERROR INDICATOR, CONTROL IS PASSED TO       * 05100000
* IEDQNX TO RECOVER INFORMATION FROM THE LCB AND CONSTRUCT THE        * 05200000
* IEA000I ERROR MESSAGE IN AVTSAVE4.                                  * 05300000
*                                                                     * 05400000
* FOR 370X, ERRORS MAY BE ASSOCIATED WITH THE 3705 ITSELF OR WITH     * 05600000
* RESOURCES ATTACHED TO THE 3705.                                     * 05800000
*                                                                     * 05900000
* FOR ERRORS ASSOCIATED WITH THE 3705 CHANNEL, 3705 ERP ROUTINES      * 06000000
* INITIALIZE CERTAIN INFORMATION IN THE 3705 LCB AS FOLLOWS:          * 06200000
*                                                                     * 06300000
* LCBUNADD-ADDRESS OF EBCDIC NAME OF THE 3705 CHANNEL UNIT ADDRESS    * 06400000
* LCBQNXMN-ERROR MESSAGE INDICATOR (IED064I,IED142I,IED162I)   @OX21816 06600082
* LCBRESTR-COMMAND CODE OF FAILING CCW                                * 06700000
*                                                                     * 06800000
* THE RESULTING INOPERATIVE PIU IS PASSED TO THE SSCP WHO SETS THE    * 07000000
* ERROR INDICATOR (LCBERMSG) BEFORE PASSING THE INOPERATIVE THROUGH   * 07200000
* THE SSCP MESSAGE HANDLER. IEDQNX GAINS CONTROL AND RECOVERS CERTAIN * 07300000
* INFORMATION FROM THE 3705 LCB TO BUILD THE APPROPRIATE ERROR        * 07400000
* MESSAGE.                                                            * 07500000
*                                                                     * 07600000
* FOR 3705 ERROR MESSAGES NOT ASSOCIATED WITH THE 3705 CHANNEL THE    * 07700000
* SSCP SAVES THE REQUEST UNIT COMMAND IN THE FIELD 'LCBNXCMD' AND     * 07800000
* THE TNT INDEX OF THE 3705 RESOURCE IN THE FIELD 'LCBLNENT'. THESE   * 07900000
* FIELDS ARE ANALYZED BY IEDQNX IN ORDER TO BUILD THE APPROPRIATE     * 08000000
* ERROR MESSAGE (IED403I OR IED509I).                                 * 08060000
*                                                                     * 08800020
* NOTES - SEE BELOW                                                   * 08809000
*                                                                     * 08818000
*    DEPENDENCIES = EBCDIC CHARACTER CODE DEPENDENCIES - CORRECTABLE  * 08827000
*    BY RECOMPILE                                                     * 08836000
*                                                                     * 08845000
*    RESTRICTIONS = NONE                                              * 08854000
*                                                                     * 08863000
*    REGISTER CONVENTIONS = ALL OF THE REGISTER SYMBOLS USED BY THIS  * 08872000
*    MODULE ARE DEFINED IN THE EQUATE STATEMENTS                      * 08881000
*                                                                     * 08890000
*    PATCH LABEL = NONE                                               * 08899000
*                                                                     * 08908000
* MODULE TYPE = PROCEDURE                                             * 08917000
*                                                                     * 08926000
*    PROCESSOR = ASSEMBLER F                                          * 08935000
*                                                                     * 08944000
*    MODULE SIZE = 1200 DECIMAL BYTES                                 * 08953000
*                                                                     * 08962000
*    ATTRIBUTES = SERIALLY REUSABLE, PROBLEM PROGRAM STATE            * 08971000
*                                                                     * 08980000
* ENTRY POINT = IEDQNX                                                * 08989000
*                                                                     * 09600020
*    PURPOSE = SEE FUNCTION                                           * 09620000
*                                                                     * 09640000
*    LINKAGE= AT ENTRY R12 CONTAINS THE ENTRY POINT ADDRESS OF THIS   * 09660000
*    MODULE.                                                          * 09680000
*                                                                     * 09700000
* INPUT = REGISTERS 3,4,11,12,13 CONTAIN THE FOLLOWING VALUES:   S22025 09720000
* 3-ADDRESS OF SCB                                                    * 09800000
* 4-ADDRESS OF LCB                                                    * 10800000
* 11-ADDRESS OF TCAM DISPATCHER                                       * 11000000
* 12-ADDRESS OF IEDQNX                                                * 11200000
* 13-ADDRESS OF AVTSAVE2                                              * 11400000
*                                                                     * 12200020
* OUTPUT = AN ERROR MESSAGE IS BUILT FOR THE PRIMARY CONTROL TERMINAL * 12300000
*                                                                     * 13000020
* EXITS-NORMAL = THIS MODULE BRANCHES TO DSPCHAIN WITH A CHAIN OF     * 13100000
* ELEMENTS IN REG1. THE BUFFER WITH THE ERROR MESSAGE IS THE FIRST    * 13200000
* IN THE CHAIN.                                                       * 13400000
*                                                                     * 13800020
* EXITS-ERROR = IF THERE ARE NO AVAILABLE BUFFERS,THIS MODULE BRANCHES* 13900000
* TO DSPCHAIN WITH THE LCB AS THE FIRST ELEMENT IN THE CHAIN          * 14000000
*                                                                     * 14400020
* EXTERNAL REFERENCES = SEE BELOW                                     * 14500000
*                                                                     * 14800020
*    ROUTINES = IEDQTNT  (TNT INDEX TO TRM CONVERSION)                * 14808000
*               IEDIAP04 (TNT INDEX TO NETWORK ADDRESS CONVERSION)    * 14816000
*               IEDIAP06 (NETWORK ADDRESS TO LCB ADDRESS CONVERSION)  * 14824000
*               IEDQTL   (DEVICE DEPENDENT SECTION ADDRESS LOOKUP)    * 14832000
*               IEDQGA02 (BUFFER STEAL ROUTINE)                       * 14840000
*                                                                     * 14848000
*    DATA AREAS = AVTSAVE4                                            * 14856000
*                                                                     * 14864000
*    CONTROL BLOCKS = AVT                                             * 14872000
*                     DCB                                             * 14880000
*                     DEB                                             * 14888000
*                     LCB                                             * 14896000
*                     PRF                                             * 14904000
*                     QCB                                             * 14912000
*                     SCB                                             * 14920000
*                     TNT                                             * 14928000
*                     TRM                                             * 14936000
*                     UCB                                             * 14944000
*                                                                     * 14952000
* TABLES = LINE TRACE TABLE CONTROL WORDS                             * 14960000
*                                                                     * 14968000
* MACROS = IEDHJN                                                     * 14976000
*          WTO                                                        * 14984000
*                                                                     * 14992000
* CHANGE ACTIVITY = SEE BELOW                                         * 15000000
*A389500,441000,667000,677000                                    S22026 18400000
*C098000,198000,628000,660000-666000,676000,692000,712000        S22025 18405000
*D714000                                                         S22025 18410000
*A233000,270200-271800,273000,294200-295200,332060-333620        S22024 18415000
*A333680-333740,333860-333920,373000,380200-381200               S22024 18420000
*A670400-671600,675000-676000,684600-685200,686400-687600        S22024 18425000
*C014000,333800,348000,676500,738000,746000                      S22024 18430000
*D552000                                                         S22024 18435000
*C675000                                                        SA61080 18440000
*C352000,360000                                                 SA66363 18445000
*A333560,677000,702000                                         @YA05956 18450000
*A319000,326000                                                @YA07494 18455000
*D330000                                                       @YA07494 18460000
*C352000,C360000,A364600                                       @OY11534 18465000
*A295200,A666000                                               @OX14080 18467000
*C677500,677506,677524                                         @OS77924 18468000
*A088000,096000,148000,184000,196000,204000,206000,208000      @Y17XATI 18470000
*A210000,214000,226000,236000,270000,272000,274000,294000      @Y17XATI 18475000
*A294800,312000,326500,333140,333170,333380,408000,612000      @Y17XATI 18480000
*A652000,656000,666000,677500,709000                           @Y17XATI 18485000
*C014000,014800,015200,018000-020000,080000-082000,090000      @Y17XATI 18490000
*C146000,150000-182000,200000-202000,228000-230000,270000      @Y17XATI 18495000
*C270400,270600-271600,271800,272000-273000,276000-294000      @Y17XATI 18500000
*C294200-294600,295000,304000,312000,318000,319600,326500      @Y17XATI 18505000
*C332300-333140,333440-333600,333860,376000-384000,388000      @Y17XATI 18510000
*C389500,402000,412000,418000-420000,430000,434000             @Y17XATI 18515000
*C440000-446000,456000-458000,490000,496000-500000,526000      @Y17XATI 18520000
*C542000,546000,564000,568000,586000-588000,592000-597000      @Y17XATI 18525000
*C598000-600000,618000,638000,642000-644000,656000             @Y17XATI 18530000
*C684600-709000                                                @Y17XATI 18535000
*D002400-003013,010000-012000,084000-086000,092000-094000      @Y17XATI 18540000
*D100000,126000-128000,198000,232000,302000,310000,316000      @Y17XATI 18545000
*D319000-319200,324000-326000,333320,333680,333920-365200      @Y17XATI 18550000
*D372000,390000,422000,426000-428000,436000-438000             @Y17XATI 18555000
*D462000-484000,488000,530000,677700                           @Y17XATI 18560000
*C295290-297660,C326760,C326800,A666600,A718000,D297720        @OX16393 18561000
*A272490,A272550,A333620                                       @OY16369 18562000
*A296190,C296390,C296590,C296690,A718120                       @OZ24288 18563000
*C270005,A270010,C270050,C333280                               @OX19662 18563182
*C272340                                                       @OY20726 18563282
*C066000,272440,272675-272680,272690-272695,677626,684160      @OX21816 18563382
*                                                                     * 18565000
*********************************************************************** 18600020
         EJECT                                                          18700000
*REGISTER ASSIGNMENTS                                                   19000020
         SPACE 1                                                        19200000
R0       EQU   0                        REG 0                    S22024 19400022
R1       EQU   1                        REG 1                    S22024 19600022
RMSG     EQU   2                        MESSAGE WORKAREA BASE  @Y17XATI 19700000
RSCB     EQU   3                        ADDRESS OF SCB         @Y17XATI 19800000
RLCB     EQU   4                        ADDRESS OF LCB         @Y17XATI 20000000
R5       EQU   5                        REG 5                    S22024 20400022
RPLCB    EQU   5                        PLCB BASE REGISTER     @Y17XATI 20500000
R6       EQU   6                        REG 6                    S22024 20600022
RPRF     EQU   6                        BASE FOR BUFFER        @Y17XATI 20700000
R7       EQU   7                        ADDRESS OF BUFFER               20800020
RQCB     EQU   7                        BASE FOR QCB           @Y17XATI 20860000
RUCB     EQU   7                        BASE FOR UCB           @Y17XATI 20920000
R8       EQU   8                        ADDRESS OF DATA IN BUFFER       21000020
RTRM     EQU   8                        BASE FOR TRM           @Y17XATI 21060000
RINDEX   EQU   9                        RESOURCE TNT INDEX     @Y17XATI 21120000
R9       EQU   9                        LENGTH OF UNIT                  21200020
R10      EQU   10                       LENGTH OF DATA IN UNIT          21400020
RDCB     EQU   10                       BASE FOR DCB           @Y17XATI 21460000
RDEB     EQU   10                       BASE FOR DEB           @Y17XATI 21520000
R11      EQU   11                       REG 11                   S22024 21600022
R12      EQU   12                       BASE REG                        21800020
R13      EQU   13                       ADDRESS OF AVTSAVE2             22000020
R14      EQU   14                       ADDRESS OF DATA WORK AREA       22200020
R15      EQU   15                       BRANCH REG                      22400020
         SPACE 3                                                        22500000
         USING IEDQMSGD,RMSG            BASE FOR MSG WORKAREA  @Y17XATI 22600000
         USING IEDQSCB,RSCB             BASE FOR SCB           @Y17XATI 22700000
         USING IEDQLCB,RLCB             BASE FOR LCB           @Y17XATI 22800000
         USING IEDQPRF,RPRF             BASE FOR BUFFER        @Y17XATI 22900000
         USING IEDQQCB,RQCB             BASE FOR QCB           @Y17XATI 23000000
         USING IEDNTRM,RTRM             BASE FOR TRM           @Y17XATI 23100000
         USING IHADCB,RDCB              BASE FOR DCB           @YM07042 23200000
         USING IEDQDISP,R11             DISPATCHER BASE          S22024 23300022
         USING *,R12                    BASE                            23400020
         USING AVTSAVE2,R13             BASE FOR AVT                    23600020
         USING IEDNSVTD,R14             BASE FOR SAVT          @Y17XATI 23700000
         EJECT                                                 @Y17XATI 23860000
IEDQNX   IEDHJN QNX00                                            S22026 24100022
         SPACE 1                                                        24300000
*        BUILD THE ERROR MESSAGE IN A WORK AREA.                        24700000
*        GET THE ERROR INFORMATION FROM THE LCB.                        25100000
         SPACE 1                                                        25600000
         LA    RLCB,0(RLCB)             CLEAR FOR COMPARE      @Y17XATI 26100000
         LA    RMSG,AVTSAVE4            MESSAGE WORKAREA       @Y17XATI 26500000
         SR    R1,R1                    CLEAR WORK REGISTER    @Y17XATI 27000000
         STH   R1,AVTDOUBL              CLEAR HALFWORD         @OX19662 27000582
         ICM   R1,HALF,AVTOPCIN         TNT INDEX OF PRIMARY   @OX19662 27000682
         BZ    SYSCON                   BR IF PRIMARY=SYSCON   @Y17XATI 27001082
         C     RLCB,SAVTSLCB            IS THIS SSCP'S PLCB?   @OX19662 27001182
         BNE   NOTSSCP                  BRANCH IF NO           @OX19662 27001282
         CLM   R1,HALF,LCBLNENT         WAS ERROR ON PRIMARY LU@OX19662 27001382
         BE    SYSCON                   BRIF YES MSG TO SYSCON @OX19662 27001482
NOTSSCP  EQU   *                                               @OX19662 27001582
         L     R15,AVTRNMPT             GET IEDQTNT BASE       @Y17XATI 27001682
         BALR  R14,R15                  GET TRM OF PRIMARY     @Y17XATI 27002082
         LR    RTRM,R1                  COPY TRM TO TRM BASE   @Y17XATI 27002182
         SH    RTRM,TRMBCKUP            ASSUME NEGATIVE PREFIX @Y17XATI 27002282
         TM    TRMSTATE,TRMPREF         PRIMARY A 3705 TERM    @Y17XATI 27002382
         BNO   NOT3705                  BR NO, ADD IDLES       @Y17XATI 27002482
         CLI   TRMTYPE,TRMLUNT          PRIMARY AN LU          @Y17XATI 27002582
         BNE   NOT3705                  BRIF NO, USE PREFIX    @OX19662 27002682
PRITRMPU EQU   *                                               @OX19662 27002782
         SR    R10,R10                  CLEAR REGISTER         @OX19662 27002882
         ICM   R10,3,TRMCOHRT           COHORT POINTER OF PRI  @OX19662 27002982
         BNZ   CHRTOK                   BRIF IF ONE THERE      @OX19662 27003082
         TM    TRMBYTE0,TRMDIAL         THIS SHOULD BE DIAL    @OX19662 27003182
         BZ    GETTRM                   BR ERROR NOT DIAL      @OX19662 27003282
         L     R8,TRMDESTQ-1            DEST QCB ADDRESS       @OX19662 27003382
         L     R15,AVTRNMPT             IEDQTNT BASE ADDRESS   @OX19662 27003482
         LH    R10,TNTLEN-IEDQTNTD(,R15) HIGHEST TTCIN         @OX19662 27003582
AGAIN    EQU   *                                               @OX19662 27003682
         LR    R1,R10                   COPY INTO PARM REG     @OX19662 27003782
         BALR  R14,R15                  CALC TERM ENTRY        @OX19662 27003882
         TM    TRMSTATE-IEDQTRM(R1),TRMLINE LINE?              @OX19662 27003982
         BNO   BCT                      BRANCH NO              @OX19662 27004082
         L     R1,TRMDESTQ-1-IEDQTRM(R1) GET QCB ADDRESS       @OX19662 27004182
         CLC   QCBRELLN-IEDQQCB(4,R1),QCBRELLN-IEDQQCB(R8)     @OX19662 27004282
*                                       DO LGB AND RLN MATCH?  @OX19662 27004382
         BNE   BCT                      BRANCH NO              @OX19662 27004482
         LR    R1,R0                    COPY TTE ADDRESS       @OX19662 27004582
         B     GOTIT                    WE HAVE RIGHT ENTRY    @OX19662 27004682
BCT      EQU   *                                               @OX19662 27004782
         BCT   R10,AGAIN                LOOP BACK              @OX19662 27004882
         B     GETTRM                   NEVER FOUND LINE       @OX19662 27004982
CHRTOK   EQU   *                                               @OX19662 27005082
         LR    R1,R10                   COPY COHORT POINTER    @OX19662 27005182
         L     R15,AVTRNMPT             GET TNT CODE ADDRESS   @OX19662 27005282
         BALR  R14,R15                  GET TERM ENTRY FOR CHRT@OX19662 27005382
GOTIT    EQU   *                                               @OX19662 27005482
         LR    R8,R1                    COPY TTE ADDRESS       @OX19662 27005582
         LA    R14,TRMPRFSZ             LENGTH OF NEG PREFIX   @OX19662 27005682
         SR    R8,R14                   AND BACK UP            @OX19662 27005782
         TM    TRMSTATE,TRMPREF         3705 TERM?             @OX19662 27005882
         BZ    GETTRM                   BRIF NO- PUNT NOT FOUND@OX19662 27005982
         CLI   TRMTYPE,TRMPUNT          IS THIS PUNT?          @OX19662 27006082
         BNE   PRITRMPU                 NO- LOOP BACK AGAIN    @OX19662 27006182
         STH   R10,AVTDOUBL             KEEP FOR FUTURE REF    @OX19662 27006282
         B     SYSCON                   PRIMARY'S PU HAD ERROR @OX19662 27006382
         SPACE                                                          27006482
NOT3705  EQU   *                                               @Y17XATI 27006582
         MVC   MSGPREF(L'IDLES),IDLES   SET CARRIAGE RETURN    @Y17XATI 27006682
*                                       AND FIFTEEN IDLES      @Y17XATI 27007000
         LA    RMSG,L'IDLES(RMSG)       ADJUST PAST PREFIX     @Y17XATI 27007500
         B     GETTRM                   BR TO GET TRM          @Y17XATI 27008000
         SPACE 1                                               @Y17XATI 27008500
SYSCON   EQU   *                                               @Y17XATI 27009000
         MVC   MSGWTOFL,WTOMCS          SET MCS FLAGS          @Y17XATI 27009500
         LA    RMSG,MSGWTO              ADJUST PAST WTO PREFIX @Y17XATI 27010000
         SPACE 1                                               @Y17XATI 27010500
GETTRM   EQU   *                                               @Y17XATI 27011000
         SR    R1,R1                    CLEAR FOR INSERT       @Y17XATI 27011500
         ICM   R1,HALF,LCBTTCIN         GET RESOURCE TNT INDEX @Y17XATI 27012000
         TM    AVTSAVTF,AVTVTMCP        NCP ENVIRONMENT        @YM07997 27012100
         BNO   GOTTCIN                  BR NO                  @YM07997 27012200
         L     R14,AVTSAVTP             GET SAVT BASE ADDRESS  @Y17XATI 27012500
         C     RLCB,SAVTSLCB            SSCP'S LCB             @Y17XATI 27013000
         BNE   GOTTCIN                  BR NO, INDEX CORRECT   @Y17XATI 27013500
         NC    LCBLNENT(2),LCBLNENT     3705 RESOURCE ERROR    @YM06008 27014000
         BZ    GOTTCIN                  BR NO, INDEX CORRECT   @Y17XATI 27014500
         ICM   R1,HALF,LCBLNENT         GET RESOURCE INDEX     @Y17XATI 27015000
GOTTCIN  EQU   *                                               @Y17XATI 27015500
         LR    RINDEX,R1                SAVE RESOURCE INDEX    @Y17XATI 27016000
         L     R15,AVTRNMPT             GET IEDQTNT BASE       @Y17XATI 27016500
         BALR  R14,R15                  GET RESOURCE TRM       @Y17XATI 27017000
         LR    RTRM,R1                  COPY TRM TO TRM BASE   @Y17XATI 27017500
         SH    RTRM,TRMBCKUP            ASSUME NEGATIVE PREFIX @Y17XATI 27018000
         CLI   LCBFLAG1,AVTEZERO        IS IT A 3705 PLCB        S22024 27020022
         BE    CHKPLCB                  YES, BRANCH            @Y17XATI 27030000
         SPACE 1                                               @Y17XATI 27040000
BLD000I  EQU   *                                               @Y17XATI 27100000
         SR    RPLCB,RPLCB              INDICATE NOT 3705 TERM @Y17XATI 27180000
         MVC   MSGPREF(L'IEA000I),IEA000I SET MESSAGE PREFIX   @Y17XATI 27181000
         LA    RMSG,L'IEA000I-1(RMSG)   ADJUST PAST PREFIX     @Y17XATI 27182000
         B     COMMAS                   BR TO FINISH MESSAGE   @Y17XATI 27183000
         SPACE 1                                               @Y17XATI 27184000
CHKPLCB  EQU   *                                               @Y17XATI 27185000
         MVC   LCBCSWST,LCBCSWRC        SET ERROR STATUS       @YM08042 27185500
         LR    R1,RINDEX                GET SOURCE TNT INDEX   @Y17XATI 27186000
         L     R14,AVTSAVTP             GET SAVT BASE ADDRESS  @Y17XATI 27187000
         L     R15,SAVTTNTX             IEDIAP04 BASE ADDRESS  @Y17XATI 27188000
         BALR  R14,R15                  GET NETWORK ADDRESS    @Y17XATI 27189000
         SPACE 1                                               @Y17XATI 27190000
         LR    R1,R15                   COPY NETWORK ADDRESS   @Y17XATI 27191000
*                                       AS PARM TO IEDIAP06    @Y17XATI 27192000
         L     R14,AVTSAVTP             GET SAVT BASE ADDRESS  @Y17XATI 27193000
         L     R15,SAVTLCBS             IEDIAP06 BASE REGISTER @Y17XATI 27194000
         BALR  R14,R15                  GET 3705 LCB ADDRESS   @Y17XATI 27195000
         SPACE 1                                               @Y17XATI 27196000
         LR    RPLCB,RLCB               COPY PLCB ADDRESS      @Y17XATI 27197000
         LA    RLCB,0(R15)              COPY TRUE LCB ADDRESS  @Y17XATI 27198000
         L     R14,AVTSAVTP             GET SAVT BASE ADDRESS  @Y17XATI 27199000
         C     RPLCB,SAVTSLCB           PLCB OF THE SSCP       @Y17XATI 27200000
         BNE   BLD162I                  BR NO, BUILD IED162I   @Y17XATI 27201000
         SPACE 1                                               @Y17XATI 27202000
         CLI   LCBQNXMN,AVTEZERO        INOP FROM TCAM PU      @Y17XATI 27203000
         BNE   CHKINOP                  BR YES, DETERMINE      @Y17XATI 27204000
*                                       WHICH MSG TO BUILD     @Y17XATI 27205000
         SPACE 1                                               @Y17XATI 27206000
         CLI   TRMTYPE,TRMLNCP          RESOURCE A 3705        @Y17XATI 27207000
         BE    TYPCMD                   BR YES, SEPARATE TYPE  @YM07042 27208000
         SPACE 1                                               @Y17XATI 27209000
         CLC   RLTD,LCBNXCMD-IEDQLCB(RPLCB) LINE TRACE ENDED   @Y17XATI 27210000
         BNE   BLD509I                  BR NO, BUILD IED509I   @Y17XATI 27211000
         SPACE 1                                               @Y17XATI 27212000
BLD403I  EQU   *                                               @YM06033 27213000
         ICM   R1,HALF,LCBTTCIN         GET 3705 TNT INDEX     @Y17XATI 27214000
         L     R15,AVTRNMPT             IEDQTNT BASE ADDRESS   @Y17XATI 27215000
         BALR  R14,R15                  GET 3705 TRM ADDRESS   @Y17XATI 27216000
         SPACE 1                                               @Y17XATI 27217000
         LA    R0,TRMNCPI               SELECT NCP DEVICE      @Y17XATI 27218000
*                                       DEPENDENT FIELD        @Y17XATI 27219000
         L     R15,AVTDDFT              IEDQTL BASE ADDRESS    @Y17XATI 27220000
         BALR  R14,R15                  GET NCPID              @Y17XATI 27221000
         SPACE 1                                               @Y17XATI 27222000
         USING IEDNCP,R15               ADDRESSIBILITY         @Y17XATI 27223000
         ICM   R15,ALL,NCPLTRAC         GET TRACE TABLE ADDR   @Y17XATI 27224000
         DROP  R15                                             @Y17XATI 27225000
         USING HEDCNTRL,R15             ADDRESSIBILITY         @Y17XATI 27226000
         ICM   R15,AD,HEDFSTHF          GET TABLE FIRST HALF   @Y17XATI 27227000
         DROP  R15                                             @Y17XATI 27228000
         USING TABHALF,R15              ADDRESSIBILITY         @Y17XATI 27229000
         MVC   MSGPREF(L'IED403I),IED403I SET MESSAGE PREFIX   @YM06033 27230000
         MVC   MSG403I(L'TABLINUM),TABLINUM INCLUDE GROUPNAME  @YM06033 27231000
*                                       AND RELATIVE LINE NO   @Y17XATI 27232000
         DROP  R15                                             @Y17XATI 27233000
         LA    RMSG,L'IED403I(RMSG)     POINT TO END OF        @OY20726 27234082
*                                       MESSAGE                @Y17XATI 27235000
         B     CHECKWTO                 BR SET TO OUTPUT MSG   @Y17XATI 27236000
         SPACE 1                                               @Y17XATI 27237000
CHKINOP  EQU   *                                               @Y17XATI 27238000
         TM    LCBQNXMN,LCBNX064        CONTROL UNIT NOT       @Y17XATI 27239000
*                                       OPERATIONAL            @Y17XATI 27240000
         BO    BLD064I                  BR YES, BUILD IED064I  @Y17XATI 27241000
         SPACE 1                                               @Y17XATI 27242000
         TM    LCBQNXMN,LCBNX142        IPL REQUIRED           @Y17XATI 27243000
         BO    BLD142I                  BR YES, BUILD IED142I  @OX21816 27244082
         SPACE 1                                               @Y17XATI 27245000
         B     BLD162I                  ELSE BUILD IED162I     @Y17XATI 27247000
         SPACE 1                                               @Y17XATI 27248000
BLD064I  EQU   *                                               @Y17XATI 27249000
         SR    R1,R1                   CLEAR FOR TEST          @XM05822 27251000
         CH    R1,AVTOPCON             IS PRIMARY SYSCON       @XM05822 27253000
         BE    DONTWTO                 DONT PRINT AGAIN        @XM05846 27255000
         MVC   MSGPREF(L'IED064I),IED064I SET MESSAGE PREFIX   @Y17XATI 27255100
         ICM   R1,AD,LCBUNADD           GET ADDRESS OF CUA     @Y17XATI 27255200
         MVC   MSG064I(L'UCBNAME),0(R1) INSERT CUA             @Y17XATI 27255300
         LA    RMSG,L'IED064I(RMSG)     POINT TO END OF MSG    @Y17XATI 27255400
         B     CHECKWTO                 BR SET TO OUTPUT MSG   @Y17XATI 27255500
DONTWTO  EQU   *                                               @XM05846 27256000
         LR    RLCB,RPLCB               RESTORE LCB ADDRESS    @XM05846 27266000
         B     BYWTO                    BYPASS WTO             @XM05846 27266500
         SPACE 1                                               @Y17XATI 27267000
BLD142I  EQU   *                                               @OX21816 27267582
         MVC   MSGPREF(L'IED142I),IED142I SET MESSAGE PREFIX   @OX21816 27267882
         ICM   R1,AD,LCBUNADD           GET ADDRESS OF CUA     @Y17XATI 27268500
         MVC   MSG142I(L'UCBNAME),0(R1) INSERT CUA             @OX21816 27269082
         LA    RMSG,L'IED142I(RMSG)     POINT TO END OF MSG    @OX21816 27269382
         B     CHECKWTO                 BR SET TO OUTPUT MSG   @Y17XATI 27270000
         SPACE 1                                               @Y17XATI 27270500
BLD162I  EQU   *                                               @Y17XATI 27271000
         MVC   MSGPREF(L'IED162I),IED162I SET MESSAGE PREFIX   @Y17XATI 27276000
         LA    RMSG,L'IED162I-1(RMSG)   ADJUST PAST PREFIX     @Y17XATI 27281000
         SPACE 1                                               @Y17XATI 27286000
COMMAS   EQU   *                                               @Y17XATI 27291000
         MVC   MSGCOMA1+1(19),MSGCOMA1  FILL IN COMMAS                  27400020
         LA    RMSG,1(RMSG)             POINT PAST COMMA       @Y17XATI 27460000
         BAL   R14,SETCUA               SET CUA IN MSG AND RTN @YM07042 27520000
         L     RDCB,LCBDCBPT            DCB BASE               @Y17XATI 28800000
         TM    DCBDSRG2,DCBDSGTR        IS THIS A 3705 DCB     @Y17XATI 29440000
         BNO   QNX02                    BRANCH NO                S22024 29480022
         SPACE 1                                               @Y17XATI 29482000
         LTR   RPLCB,RPLCB              3705 RESOURCE          @YM06937 29484000
         BZ    QNX02                    BR NO, HAVE LCB        @YM06937 29486000
         SPACE 1                                               @Y17XATI 29494000
         CLI   TRMTYPE,TRMLNCP          IS IT THE 3705         @YM06937 29494700
         BE    QNX02                    BR YES, HAVE LCB       @YM06937 29495400
         SPACE 1                                               @Y17XATI 29496100
         LR    RLCB,RPLCB               GET PLCB BASE          @Y17XATI 29497000
         SPACE 1                                               @Y17XATI 29500000
QNX02    EQU   *                                                 S22024 29520022
         LTR   RPLCB,RPLCB              ENTERED WITH PLCB      @OX14080 29523000
         BNZ   IS3705                   YES-CONTINUE           @OX14080 29526000
         SR    R8,R8                    CLEAR REGISTER         @OX16393 29529000
         SR    R14,R14                  CLEAR REGISTER         @OX16393 29532000
         L     R1,DCBDEBAD              DEB ADDRESS            @OX16393 29541000
         USING DEBTCBAD,R1              BASE FOR DEB           @OX16393 29550000
         IC    R8,DEBNMEXT              NUMBER OF EXTENTS      @OX16393 29562000
         SLL   R8,TWO                   SIZE OF UCB ADDRESSES  @OX16393 29571000
         L     R8,DEBUCBAD(R8)          THRESHOLD AREA         @OX16393 29580000
         IC    R14,LCBUCBX              RLN MINUS ONE          @OX16393 29592000
         SLL   R14,THREE                MULT BY NO OF BYTES    @OX16393 29601000
         AR    R8,R14                   BUMP TO SAVE OFFSET    @OX16393 29610000
         SRL   R14,1                    HALF AGAIN FOR ERRMSG  @OZ24288 29622000
         AR    R8,R14                   SAVED INFORMATION      @OZ24288 29625000
         USING LCBEXTX,R8               ADDRESSABILITY         @OX16393 29628000
         MVC   LCBSENS0,IEASENS0        RESTORE SENSE INFO     @OZ24288 29631000
         MVC   LCBRESTR+2(L2),IEADVCHS  RESTORE DEV CHARS      @OX16393 29640000
         MVC   LCBRESTR(L1),IEACMD      RESTORE COMMAND CODE   @OZ24288 29652000
         MVC   LCBCSW+3(2),IEACSW       RESTORE CSW            @OZ24288 29661000
         MVC   LCBFLAG2(1),IEALTPCD     RESTORE LAST TP OP CDE @OX16393 29670000
         MVC   LCBSENS1(1),IEAFTPCD     RESTORE FIRST TP CODE  @OX16393 29682000
IS3705   EQU   *                                               @OX14080 29769000
         USING IEDNTRM,RTRM                                    @OX14080 29775000
         SR    R8,R8                    CLEAR                      0802 29800020
         IC    R8,LCBRESTR              COMMAND CODE-FAILING CCW   0730 29900000
         BAL   R14,QNX80                CONVERT TO EBCDIC      @Y17XATI 30000000
         SPACE 1                                                        30400000
         IC    R8,LCBCSWUS              STAT BYTE OF CSW                30600000
         BAL   R14,QNX80                CONVERT TO EBCDIC      @Y17XATI 30800000
         SPACE 1                                               @Y17XATI 31200000
         BCTR  RMSG,0                   PREVENT SKIP OF COMMA  @Y17XATI 31280000
         IC    R8,LCBCSWCS              2ND STAT BYTE IN CSW            31360000
         BAL   R14,QNX80                CONVERT TO EBCDIC      @Y17XATI 31400000
         SPACE 1                                               @Y17XATI 31800000
         CLI   LCBFLAG1,AVTEZERO        IS IT 3705 PLCB?       @YA07494 31940057
         BE    NOSENSE                  BR YES, ZERO SENSE     @Y17XATI 31950000
         SPACE 1                                                        31960000
         IC    R8,LCBSENS0              SENSE BYTE IN IOB               32200020
         B     QNX025                   CONTINUE               @YA07494 32400000
         SPACE 1                                               @Y17XATI 32650000
NOSENSE  EQU   *                                               @Y17XATI 32651000
         SR    R8,R8                    USE SENSE OF ZERO      @Y17XATI 32652000
         SPACE 1                                               @Y17XATI 32653000
QNX025   EQU   *                                               @Y17XATI 32654000
         BAL   R14,QNX80                CONVERT TO EBCDIC      @Y17XATI 32655000
         SPACE 1                                               @Y17XATI 32656000
         BCTR  RMSG,0                   PREVENT SKIP OF COMMA  @Y17XATI 32657000
         SR    R8,R8                    SECOND SENSE BYTE OF 0 @Y17XATI 32658000
         BAL   R14,QNX80                CONVERT TO EBCDIC      @Y17XATI 32659000
         SPACE 1                                               @Y17XATI 32660000
         LTR   RPLCB,RPLCB              ENTRY WITH PLCB        @Y17XATI 32661000
         BZ    NOPLCB                   BR NO, CONTINUE        @Y17XATI 32662000
         SPACE 1                                               @Y17XATI 32663000
         LA    RMSG,NEXT(RMSG)          POINT TO NEXT POSITION @Y17XATI 32664000
         B     QNX002                   GO INSERT RESOURCENAME @Y17XATI 32665000
         SPACE 1                                                        32666000
NOPLCB   EQU   *                                               @Y17XATI 32667000
         IC    R8,LCBFLAG2              TP OP CODE OF LAST RETRY   0725 32668000
         BAL   R14,QNX80                CONVERT TO EBCDIC      @Y17XATI 32669000
         SPACE 1                                               @Y17XATI 32670000
         BCTR  RMSG,0                   PREVENT SKIP OF COMMA  @Y17XATI 32671000
         IC    R8,LCBSENS1              TP OP CODE OF FAILING CCW  0730 32672000
         BAL   R14,QNX80                CONVERT TO EBCDIC      @Y17XATI 32673000
         SPACE 1                                                        32674000
         BCTR  RMSG,0                   PREVENT SKIP OF COMMA  @Y17XATI 32675000
         IC    R8,LCBRESTR+2            ADDR CHAR,POLL CHAR OR @OX16393 32676000
         BAL   R14,QNX80                CONVERT TO EBCDIC      @Y17XATI 32677000
         SPACE 1                                               @Y17XATI 32678000
         BCTR  RMSG,0                   PREVENT SKIP OF COMMA  @Y17XATI 32679000
         IC    R8,LCBRESTR+3            SECOND CHARACTER       @OX16393 32680000
         BAL   R14,QNX80                CONVERT TO EBCDIC      @Y17XATI 32681000
         SPACE 1                                               @Y17XATI 32682000
         SR    R1,R1                    CLEAR REG              @OY11534 32683000
         STH   R1,LCBTTBIN              CLEAR TERM INDEX       @OY11534 32684000
         B     QNX04                    WRITE OUT ERROR MSG    @Y17XATI 32685000
TYPCMD   EQU   *                                               @YM07042 32685100
*                                       ENTERING SLOWDOWN      @YM07994 32685200
         CLC   LCBNXCMD-IEDQLCB(L'LCBNXCMD,RPLCB),ENTSLO       @YM07994 32685300
         BE    BLD412                   YES, BUILD IED411I     @YM07042 32685400
*                                       EXITING SLOWDOWN       @YM07994 32685500
         CLC   LCBNXCMD-IEDQLCB(L'LCBNXCMD,RPLCB),EXTSLO       @YM07994 32685600
         BE    BLD412                   YES, BUILD IED412      @YM07042 32685700
         SPACE 1                                               @Y17XATI 32686000
BLD509A  EQU   *                                               @Y17XATI 32687000
         MVC   MSGPREF(L'IED509I),IED509I SET MESSAGE PREFIX   @Y17XATI 32688000
         MVC   MSG509I(L'MSGANS),MSGANS INSERT ANS CHARS       @Y17XATI 32689000
         LA    RMSG,L'IED509I(RMSG)     POINT TO END OF MSG    @Y17XATI 32690000
         B     QNX002                   BR TO INSERT TERMNAME  @Y17XATI 32690200
         SPACE 1                                               @Y17XATI 32690400
BLD412   EQU   *                                               @YM07042 32690600
         MVC   MSGPREF(L'IED412I),IED412I ASSUME IED412I MSG   @YM07042 32690800
*                                       EXITING SLOWDOWN       @YM07994 32690900
         CLC   LCBNXCMD-IEDQLCB(L'LCBNXCMD,RPLCB),EXTSLO       @YM07994 32691000
         BE    BLD412A                  YES, NO MODIFY         @YM07042 32691200
         MVC   MSG41EXT(L'MSGENT),MSGENT  MODIFY FOR ENTERING  @YM07042 32691400
         MVI   MSG11,IED411I            MODIFY MSG ID          @YM07042 32691600
BLD412A  EQU   *                                               @YM07042 32691800
         LA    RMSG,MSG41               POINT TO CUA POSITION  @YM07042 32692000
         BAL   R14,SETCUA               GO INSERT CUA          @YM07042 32692200
         LA    RMSG,MSG41END-MSG41-L'UCBNAME(RMSG) ADJUST TO   @YM07042 32692400
*                                       LAST POSITION OF MSG   @YM07042 32692600
         B     CHECKWTO                                        @YM07042 32692800
BLD509I  EQU   *                                               @Y17XATI 32693000
         MVC   MSGPREF(L'IED509I),IED509I SET MESSAGE PREFIX   @Y17XATI 32694000
         MVC   MSG509I(L'MSGINOP),MSGINOP INSERT INOP CHARS    @Y17XATI 32695000
         LA    RMSG,L'IED509I(RMSG)     POINT TO END OF MSG    @Y17XATI 32696000
         SPACE 1                                                        32698000
QNX002   EQU   *                                               @YA07494 33000057
         L     R15,AVTRNMPT             ADDRESS OF TERMNAME TBL  S22024 33218022
         USING IEDQTNTD,R15             BASE                     S22024 33224022
         LR    R0,RINDEX                SAVE RESOURCE INDEX    @Y17XATI 33227000
         SR    R9,R9                    ZERO REGISTER          @Y17XATI 33230000
         IC    R9,TNTENLEN              GET LENGTH OF AN ENTRY   S22024 33242000
         LA    R7,3(R9)                 LENGTH OF FULL ENTRY   @Y17XATI 33248000
         BCTR  R0,R0                    SUBTRACT ONE             S22024 33266022
         MR    R6,R0                    OFFSET TO TERMNAME     @Y17XATI 33272000
         LA    R7,TNTFIRST(R7)          ADDRESS OF TERMNAME    @Y17XATI 33278000
         BCTR  R9,R0                    SUBTRACT ONE           @Y17XATI 33284000
         EX    R9,MVCNM                 MOVE NAME INTO MESSAGE @Y17XATI 33302000
         LA    RMSG,NEXT(R9,RMSG)       POINT TO END OF MSG    @Y17XATI 33314000
         SPACE 1                                               @Y17XATI 33315000
CHECKWTO EQU   *                                                        33317022
         LR    RLCB,RPLCB               ELSE RECOVER LCB BASE  @Y17XATI 33317700
         SPACE 1                                               @Y17XATI 33318400
SKIPSET  EQU   *                                               @Y17XATI 33319100
         SR    R1,R1                    ZERO FOR COMPARE         S22024 33320022
         CH    R1,AVTOPCON              IS PRIMARY=SYSCON        S22024 33326022
         BE    MSGTOCNS                 BRANCH YES TO WTO      @OX19662 33328082
         C     RLCB,SAVTSLCB            IS THIS SSCP'S PLCB?   @OX19662 33329082
         BNE   QNX04                    BRANCH NO              @OX19662 33330082
         CLC   AVTOPCIN,LCBLNENT        WAS ERR ON PRITRM LU?  @OX19662 33331082
         BE    MSGTOCNS                 YES MSG TO SYSCON      @OX19662 33332082
         CLC   AVTDOUBL(2),AVTFZERO     WAS ERROR ON PRITRM PU?@OX19662 33333082
         BE    QNX04                    BRANCH NO MSG TO PRITRM@OX19662 33334082
MSGTOCNS EQU   *                                               @OX19662 33335082
         SPACE 1                                               @Y17XATI 33339000
         MVC   MSGMCS(L'MCSWORD),MCSWORD MCS CONSTANT          @Y17XATI 33340000
         LR    R1,RMSG                  END OF MESSAGE         @Y17XATI 33341000
         LA    RMSG,AVTSAVE4            ADDR OF WTO MESSAGE    @Y17XATI 33342000
         SR    R1,RMSG                  COMPUTE MESSAGE LENGTH @Y17XATI 33344000
         STH   R1,MSGWTOLN              SET WTO MESSAGE LENGTH @Y17XATI 33356000
         SPACE 1                                               @Y17XATI 33357000
         WTO   MF=(E,(RMSG))            WRITE MESSAGE TO CONSOLE S22024 33358000
BYWTO    EQU   *                                               @XM05822 33362000
         SPACE 1                                               @Y17XATI 33368000
         SR    R5,R5                    FORCE ONLY PLCB TPOST    S22024 33374022
         B     QNX50                    POST BFR                 S22024 33380022
         SPACE 1                                               @Y17XATI 33383000
*        MOVE ERROR MESSAGE FROM WORK AREA TO BUFFER                    33386000
         SPACE 1                                                        36800000
QNX04    EQU   *                                                 S22024 37300022
         SR    R5,R5                    CLEAR ADDR OF 1ST UNIT     0606 37400020
         LA    R0,UNITCNT               COUNT OF UNITS/BUFFER  @Y17XATI 37420000
         LA    R1,BFRCNT                COUNT OF BUFFERS       @Y17XATI 37440000
         L     R15,AVTSTEAL             BUFFER STEAL ROUTINE   @Y17XATI 37460000
         BALR  R14,R15                  ATTEMPT BUFFER STEAL   @Y17XATI 37480000
         SPACE 1                                               @Y17XATI 37500000
         LTR   R15,R15                  BFR STEAL SUCCESSFUL   @Y17XATI 37520000
         BZ    QNX50                    BR NO, ERROR EXIT      @Y17XATI 37540000
         SPACE 1                                               @Y17XATI 37560000
         LR    RPRF,R15                 SET FIRST BUFFER ADDR  @Y17XATI 37580000
         LR    R5,RPRF                  SAVE 1ST UNIT IN BFR   @Y17XATI 37600000
         LR    R7,RMSG                  COPY END OF MSG ADDR   @Y17XATI 37800000
         LA    RMSG,AVTSAVE4            BEGINNING OF MESSAGE   @Y17XATI 37850000
         SR    R7,RMSG                  MESSAGE LENGTH         @Y17XATI 37900000
         LA    R7,AVTHDRSZ(R7)          ADD HEADER SIZE        @Y17XATI 37950000
         XC    PRFSUNIT(PRFSHDR-PRFSUNIT),PRFSUNIT CLEAR PREFIX@Y17XATI 38000000
         ST    RLCB,PRFLCB-1            PUT LCB ADDR IN PREFIX @Y17XATI 38200000
         MVI   PRFNBUNT,UNITCNT         COUNT OF UNITS                  38300000
         STH   R7,PRFSIZE               PUT LENGTH INTO PREFIX @Y17XATI 38400000
         MVI   PRFSTAT1,PRFERMGN        SET AS ERRORMSG TO PREVENT      38820020
*                                       MULTI-ROUTE ON THE ERP          38830000
*                                       MSG AND ALLOW IT ON ORIG        38840000
         MVI   PRFSCAN,AVTHDRSZ         SET SCAN PTR FOR ERROR MSG 0212 38900020
         MVC   PRFTIC,TIC               SET TIC FIELD          @Y17XATI 38920000
         LH    R9,AVTKEYLE              LENGTH OF UNIT                  39200020
         LA    R0,AVTHDRSZ              LENGTH OF PREFIX                39400020
         LR    R10,R9                                                   39600020
         SR    R10,R0                   LENGTH OF DATA IN UNIT          39800020
         SPACE 1                                               @Y17XATI 39920000
         BCTR  R10,0                    SUBTRACT ONE FOR EXEC  @Y17XATI 40000000
         EX    R10,QNXINST1             MOVE MSG                        40400020
         SPACE 1                                                        40500000
*        CHECK LENGTH OF MSG TO SEE IF MULTIPLE UNITS REQUIRED          40600000
         SPACE 1                                                        40700000
QNX10    EQU   *                                               @Y17XATI 40800000
         LA    RMSG,NEXT(R10,RMSG)      BUMP ADDRESS OF MSG    @Y17XATI 41000000
         SH    R7,AVTKEYLE              REMAINING LENGTH       @Y17XATI 41200000
         BNP   QNX20                    BRANCH IF END OF MSG       0603 41600020
         SPACE 1                                               @Y17XATI 41660000
         LR    R9,RPRF                  SAVE PREVIOUS UNIT     @Y17XATI 41720000
         LA    R0,UNITCNT               COUNT OF UNITS/BUFFER  @Y17XATI 41800000
         LA    R1,BFRCNT                COUNT OF BUFFERS       @Y17XATI 41820000
         L     R15,AVTSTEAL             BUFFER STEAL ROUTINE   @Y17XATI 41840000
         BALR  R14,R15                  ATTEMPT BUFFER STEAL   @Y17XATI 41860000
         SPACE 1                                               @Y17XATI 41880000
         LTR   R15,R15                  BFR STEAL SUCCESSFUL   @Y17XATI 41900000
         BZ    QNX50                    BR NO, ERROR EXIT      @Y17XATI 41920000
         SPACE 1                                               @Y17XATI 41940000
         LR    RPRF,R15                 SET FIRST BUFFER ADDR  @Y17XATI 41960000
         IC    R15,PRFNBUNT-IEDQPRF(R5) COUNT OF UNITS IN BFR  @Y17XATI 42000000
         LA    R15,1(,R15)              ADD 1 TO COUNT             0603 43200020
         STC   R15,PRFNBUNT-IEDQPRF(R5)                        @Y17XATI 43300000
         ST    RPRF,PRFTIC-IEDQPRF(R9)  LINK UNITS             @Y17XATI 43400000
         MVC   PRFTIC,TIC               SET TIC FIELD          @Y17XATI 44000000
         LH    R10,AVTKEYLE             DATA LENGTH IN UNIT    @Y17XATI 44050000
         BCTR  R10,0                    DECREMENT FOR EXEC     @Y17XATI 44100000
         EX    R10,QNXINST2             MOVE DATA TO THIS UNIT @Y17XATI 44150000
         B     QNX10                    BR TO CHECK FOR MORE   @Y17XATI 44200000
         SPACE 1                                                        44600000
*        FIND TERMINAL ENTRY ADDRESS AND QCB ADDRESS FOR PRIMARY TERM   44800000
         SPACE 1                                                        45000000
QNX20    EQU   *                                                   0603 45400020
         LR    RPRF,R5                  GET 1ST UNIT IN BUFFER @Y17XATI 45500000
         LH    R1,AVTOPCIN              TNT INDEX OF PRIMARY   @Y17XATI 45600000
         N     R1,AVTCLRHI              CLEAR HIGH ORDER HALF WORD      46000020
         SPACE 1                                               @Y17XATI 46120000
QNX23    EQU   *                                                   1009 48600020
         STH   R1,PRFDEST               PUT OFFSET INTO PREFIX @Y17XATI 48800000
         L     R15,AVTRNMPT                                             49200020
         BALR  R14,R15                  GET TERM ENTRY ADDRESS          49400020
         SPACE 1                                               @Y17XATI 49460000
         LR    RTRM,R1                  BASE FOR TERM ENTRY    @Y17XATI 49520000
         SH    RTRM,TRMBCKUP            GET NEGATIVE PREFIX    @Y17XATI 49600000
         L     RQCB,TRMDESTQ-1          ADDRESS OF QCB         @Y17XATI 49700000
         ST    RQCB,PRFQCBA-1           PUT QCB ADDR IN PRF    @Y17XATI 49800000
         CLI   QCBDSFLG,QCBFQCB         CHECK FOR PUT PROCESS ENTRY1009 50400020
         BNE   QNX25                    BRANCH IF NOT PUT PROCESS  1009 50600020
         SPACE 1                                               @Y17XATI 50660000
         LH    R1,TRMALTD               GET ALTERNATE DEST     @Y17XATI 50720000
         N     R1,AVTCLRHI              CLEAR HIGH ORDER HALF  @Y17XATI 50800000
         BZ    QNX50                    BRANCH IF NO ALT DESTINATN 1009 51200020
         SPACE 1                                               @Y17XATI 51300000
         B     QNX23                    GET TERM ENTRY FOR ALT DEST1009 51400020
         SPACE 1                                                        51500000
*        SET UP THE SCB-USUALLY DONE BY FORWARD MACRO                   51600000
         SPACE 1                                                        51800000
QNX25    EQU   *                                                   1009 52200020
         IC    R15,SCBSTATE             SAVE STATUS BYTE                52400020
         ST    RQCB,SCBDESTQ-1          PUT QCB ADDRESS IN SCB @Y17XATI 52500000
         STC   R15,SCBSTATE             RESTORE STATUS BYTE             52800020
         MVC   SCBPRI,QCBPRIPQ          MOVE HIGHEST PRIORITY TO SC0730 53200020
         SPACE 1                                                        53300000
*        POST CHAIN OF ELEMENTS TO THE READY QUEUE.                     53400000
         SPACE 1                                                        53600000
QNX30    EQU   *                                                   0606 54000020
         ST    RLCB,PRFLINK-1           LINK LCB TO THIS BFR   @Y17XATI 54100000
         MVI   PRFPRI,PRIDESTQ          SET PRIORITY                    54200000
         LR    R1,RPRF                  GET ADDRESS OF CHAIN   @Y17XATI 54300000
         SPACE 1                                               @Y17XATI 54400000
QNX40    EQU   *                                                        54800020
         XC    LCBLINK,LCBLINK          CLEAR LINK FIELD           0120 54900020
         NI    LCBCHAIN,X'FF'-LCBERMSG  CLEAR ERROR MSG REQUEST BIT     55000020
         BAL   R14,DSPCHAIN       EXIT AND POST CHAIN OF ELEM  @Y17XARX 55400000
         SPACE 1                                                        55500000
*        THERE ARE NO AVAILABLE BUFFERS-RETURN TO BUFFER DISPOSITION    55600000
         SPACE 1                                                        55800000
QNX50    EQU   *                                                        56200020
         LR    R1,RLCB                  ADDR OF LCB IS FIRST   @Y17XATIX56300000
                                        ELEMENT IN CHAIN                56600020
         LTR   RPRF,R5                  CHECK FOR PARTIAL BFR  @Y17XATI 56700000
         BZ    QNX40                    BRANCH IF NO UNITS OUT     0606 57000020
         SPACE 1                                               @Y17XATI 57100000
         LA    R1,AVTBFRTB              ADDR OF BFR RETURN QCB     0606 57200020
         ST    R1,PRFQCBA-1             STORE IN 1ST UNIT OF BFR   0606 57400020
         B     QNX30                    POST BFR BACK TO BFR DISPOS0606 57600020
         EJECT                                                 @Y17XATI 57700000
*        SUBROUTINE TO CONVERT HEX TO PRINTABLE HEX                     58000000
         SPACE 1                                                        60800000
QNX80    EQU   *                                                        61200020
         LA    RMSG,NEXT(RMSG)          SKIP ONE COMMA         @Y17XATI 61300000
         LR    R10,R8                   COPY THE 1 BYTE OF HEX          61400020
         SRL   R10,4                    SHIFT OUT RIGHT HAND HALF       61600020
         N     R8,QNXMASK3              MASK OUT FIRST BYTE    @Y17XATI 61700000
         CH    R10,QNXNINE              CHECK FOR ALPHABETIC            62200020
         BH    QNX85                    BRANCH IF ALPHABETIC            62400020
         SPACE 1                                               @Y17XATI 62460000
         O     R10,QNXMASK1             PRINTABLE NUMERIC               62600020
         B     QNX90                    GO STORE BYTE            S22025 62800022
         SPACE 1                                               @Y17XATI 62900000
QNX85    EQU   *                                                        63000020
         SH    R10,QNXNINE                                              63200020
         O     R10,QNXMASK2             PRINTABLE ALPHABETIC            63400020
         SPACE 1                                               @Y17XATI 63500000
QNX90    EQU   *                                                        63600020
         STC   R10,0(RMSG)              STORE CONVERTED BYTE   @Y17XATI 63700000
         LA    RMSG,NEXT(RMSG)          GET NEXT BYTE          @Y17XATI 63800000
         CH    R8,QNXNINE               CHECK FOR ALPHABETIC   @Y17XATI 64400000
         BH    QNX95                    BRANCH IF ALPHABETIC   @Y17XATI 64410000
         SPACE 1                                               @Y17XATI 64420000
         O     R8,QNXMASK1              PRINTABLE NUMERIC      @Y17XATI 64430000
         B     QNX100                   GO STORE BYTE          @Y17XATI 64440000
         SPACE 1                                               @Y17XATI 64450000
QNX95    EQU   *                                               @Y17XATI 64460000
         SH    R8,QNXNINE                                      @Y17XATI 64470000
         O     R8,QNXMASK2              PRINTABLE ALPHABETIC   @Y17XATI 64480000
         SPACE 1                                               @Y17XATI 64490000
QNX100   EQU   *                                               @Y17XATI 64500000
         STC   R8,0(RMSG)               STORE CONVERTED BYTE   @Y17XATI 64510000
         LA    RMSG,NEXT(RMSG)          POINT PAST INSERT      @Y17XATI 64520000
         BR    R14                      RETURN TO INLINE       @Y17XATI 64530000
         SPACE 1                                                        64530700
SETCUA   EQU   *                                               @YM07042 64531400
         SR    R7,R7                                           @Y17XATI 64532100
         IC    R7,LCBUCBX               GET UCB INDEX          @Y17XATI 64532800
         SLL   R7,2                     MULTIPLY BY 4          @Y17XATI 64533500
         L     RDCB,LCBDCBPT            ADDRESS OF LINE DCB    @Y17XATI 64534200
         L     RDEB,DCBDEBAD            ADDRESS OF DEB         @Y17XATI 64534900
         USING DEBTCBAD,RDEB            BASE FOR DEB           @YM06937 64535600
         L     RUCB,DEBUCBAD(R7)        ADDRESS OF UCB         @YM06937 64536300
         USING IEDQUCB,RUCB             BASE FOR UCB           @Y17XATI 64537000
         MVC   MSGLINE(L'UCBNAME),UCBNAME MOVE CUA TO MESSAGE  @Y17XATI 64537700
         LA    RMSG,L'UCBNAME(RMSG)     POINT TO NEXT POSITION @Y17XATI 64538400
         BR    R14                      RETURN                 @YM07042 64539100
         EJECT                                                 @Y17XATI 64540000
MVCNM    MVC   0(1,RMSG),0(R7)          OBJECT OF EXECUTE      @Y17XATI 64570000
QNXINST1 MVC   PRFSHDR(0),0(RMSG)       BUFFER WORK AREA       @Y17XATI 65070000
QNXINST2 MVC   PRFSUNIT(0),0(RMSG)      BUFFER WORK AREA       @Y17XATI 65600000
QNXNINE  DC    H'9'                     CONSTANT                        65800020
         DS    0F                       FORCE BOUNDARY ALIGNMENT S22025 65900022
QNXMASK1 DC    X'000000F0'              MASK FOR PRINTABLE       S22025 66000022
*                                       NUMERIC CHARACTER        S22025 66100022
QNXMASK2 DC    X'000000C0'              MASK FOR PRINTABLE       S22025 66200022
*                                       ALPHABETIC CHARACTER     S22025 66300022
QNXMASK3 DC    X'0000000F'              MASK TO CLEAR ALL BUT    S22025 66400022
*                                       RIGHT HALF OF LOW ORDER  S22025 66500022
*                                       BYTE                     S22025 66600022
L1       EQU   1                        LENGTH OF ONE          @OX14080 66600900
L2       EQU   2                        LENGTH OF TWO          @OX14080 66601800
L3       EQU   3                        LENGTH OF THREE        @OX14080 66602700
L4       EQU   4                        LENGTH OF FOUR         @OX14080 66603600
DIALDIG  EQU   17                       DIAL DIGIT SHIFT OFFSET@OX14080 66604500
LTPOP    EQU   8                        OFFSET TO LAST TP OP   @OX14080 66605400
FTPOP    EQU   9                        OFFSET TO FIRST TP OP  @OX14080 66606300
L7       EQU   7                        LENGTH OF SEVEN        @OX14080 66607200
FIVE     EQU   5                        LENGTH OF FIVE         @OX14080 66608100
SIX      EQU   6                        CONSTANT               @OX14080 66609000
UNITCNT  EQU   1                        UNITS/BUFFER REQUEST   @Y17XATI 66610000
BFRCNT   EQU   1                        BUFFER REQUEST COUNT   @Y17XATI 66620000
NEXT     EQU   1                        NEXT DATA POSITION     @Y17XATI 66630000
HALF     EQU   3                        MASK FOR ICM OF HLFWRD @Y17XATI 66640000
AD       EQU   7                        MASK FOR ICM OF ADDRESS@Y17XATI 66650000
ALL      EQU   15                       MASK FOR ICM OF WORD   @Y17XATI 66660000
TWO      EQU   2                                               @OX16393 66710000
THREE    EQU   3                                               @OX16393 66760000
TIC      DC    X'08000002'              TIC CCW                  S22026 67700022
MCSWORD  DC    X'10000100'              MCS DESCR & ROUTING    @OS77924 67750000
         DC    X'10'                    EVENTUAL ACTION REQ'ED @OS77924 67750600
         DC    X'00'                                           @Y17XATI 67751200
*                                       ROUTING CODES          @Y17XATI 67751800
         DC    X'01'                    MASTER CONSOLE INFO    @OS77924 67752400
         DC    X'00'                                           @Y17XATI 67753000
WTOMCS   DS    0XL2                     MCS FLAGS              @Y17XATI 67753600
         DC    X'80'                                           @Y17XATI 67754200
         DC    X'00'                                           @Y17XATI 67754800
RLTD     DS    0XL3                     RECORD LINE TRACE CMD  @Y17XATI 67755400
         DC    AL1(CD1NETS)             NETWORK SERVICES       @Y17XATI 67756000
         DC    AL1(CD1MAINT)            PHYSICAL MAINTENANCE   @Y17XATI 67756600
         DC    AL1(CD1RTRD)             RECORD TRACE DATA      @Y17XATI 67757200
ENTSLO   DS    0XL3                     ENTER SLOWDOWN COMMAND @YM07042 67757400
         DC    AL1(CD1NETS)             NETWORK SERVICES       @YM07042 67757600
         DC    AL1(CD1CONFS)            CONFIGURATION SERVICES @YM07042 67757800
         DC    AL1(CD1ESLOW)            ENTER SLOWDOWN         @YM07042 67758000
EXTSLO   DS    0XL3                     EXIT SLOWDOWN COMMAND  @YM07042 67758200
         DC    AL1(CD1NETS)             NETWORK SERVICES       @YM07042 67758400
         DC    AL1(CD1CONFS)            CONFIGURATION SERVICES @YM07042 67758600
         DC    AL1(CD1EXSLW)            EXIT SLOWDOWN          @YM07042 67758800
TRMBCKUP DS    0H                       TRM PREFIX SIZE        @Y17XATI 67759000
         DC    AL2(IEDQTRM-IEDNTRM)                            @Y17XATI 67759200
         EJECT                                                 @Y17XATI 67759400
IDLES    DS    0XL16                                           @Y17XATI 67759600
         DC    X'15'                    CARRIAGE RETURN AND    @Y17XATI 67760200
         DC    15X'32'                  FIFTEEN IDLES          @Y17XATI 67760800
IEA000I  DC    CL18'IEA000I I/O ERROR,' IEA000I PREFIX         @Y17XATI 67761400
IED064I  DC    CL45'IED064I LINE --- CONTROL UNIT NOT OPERATIONAL'      67762000
IED142I  DC    CL33'IED142I --- IPL REQUIRED FOR 3705'         @OX21816 67762682
IED162I  DC    CL23'IED162I 3705 I/O ERROR,' IED162I PREFIX    @Y17XATI 67763600
IED403I  DC    CL47'IED403I LINE TRACE FOR ------------ DEACTIVATED'    67764100
IED412I  DC    CL34'IED412I 3705 --- EXITING  SLOWDOWN'        @YM07042 67764200
*                                       IED411I/IED412I MSGS   @YM07042 67764300
IED509I  DC    CL26'IED509I ---- RECEIVED FOR ' IED509I PREFIX @Y17XATI 67764600
         SPACE 3                                               @Y17XATI 67765600
MSGANS   DC    CL4'ANS'                 INSERT TO IED509I      @Y17XATI 67766100
MSGINOP  DC    CL4'INOP'                INSERT TO IED509I      @Y17XATI 67766600
MSGENT   DC    CL8'ENTERING'            INSERT TO IED412I/411I @YM07042 67766800
IED411I  EQU   C'1'                     INSERT TO IED412I/411I @YM07042 67767000
         EJECT                                                 @Y17XATI 67767200
*DSECT FOR ERROR MESSAGE WORK AREA                                      68000020
         SPACE 1                                                        68200000
IEDQMSGD DSECT                                                          68400020
MSGWTOPF DS    0F                       WTO MESSAGE PREFIX     @Y17XATI 68402000
MSGWTOLN DS    H                        WTO MESSAGE LENGTH     @Y17XATI 68404000
MSGWTOFL DS    H                        WTO MESSAGE FLAGS      @Y17XATI 68406000
MSGWTO   DS    0C                       WTO MESSAGE START      @Y17XATI 68408000
         ORG   MSGWTOPF                 REDEFINE MESSAGE DSECT @Y17XATI 68410000
MSGPREF  DS    0C                       NON-WTO MESSAGE PREFIX @Y17XATI 68412000
MSG064I  EQU   MSGPREF+13               IED064I INSERT OFFSET  @Y17XATI 68414000
MSG142I  EQU   MSGPREF+8                IED142I INSERT OFFSET  @OX21816 68416082
MSG403I  EQU   MSGPREF+23               IED403I OFFSET INSERT  @YM06033 68418000
MSG41    EQU   MSGPREF+13               IED411/412 INSRT OFFSET@YM07042 68418400
MSG41EXT EQU   MSGPREF+17               IED411/412 INSRT OFFSET@YM07042 68418800
MSG11    EQU   MSGPREF+5                IED411/412 INSRT OFFSET@YM07042 68419200
MSG41END EQU   MSGPREF+L'IED412I        END OF IED412I MESSAGE @YM07042 68419600
MSG509I  EQU   MSGPREF+8                IED509I INSERT OFFSET  @Y17XATI 68420000
MSGCOMA1 DS    0C                       FIRST COMMA            @Y17XATI 68422000
MSGMCS   DS    0C                       MCS CONSTANT           @Y17XATI 68424000
MSGLINE  DS    0C                       CHANNEL UNIT ADDRESS   @Y17XATI 68426000
         EJECT                                                 @Y17XATI 68428000
HEDCNTRL DSECT                          3705 TRACE TABLE       @Y17XATI 68430000
*                                       CONTROL WORDS DSECT    @Y17XATI 68432000
         DS    F                                               @Y17XATI 68434000
         DS    F                                               @Y17XATI 68436000
         DS    CL1                                             @Y17XATI 68438000
HEDFSTHF DS    AL3                      ADDRESS OF FIRST HALF  @Y17XATI 68440000
*                                       OF TRACE TABLE         @Y17XATI 68442000
         SPACE 3                                               @Y17XATI 68444000
TABHALF  DSECT                          3705 TRACE TABLE DSECT @Y17XATI 68447000
         DS    CL16                                            @Y17XATI 68450000
TABLINUM DS    CL12                     GROUPNAME,RLN          @Y17XATI 68453000
         EJECT                                                 @Y17XATI 68456000
         TAVTD                                                          71600020
         EJECT                                                 @Y17XATI 71620000
         TCD1D                                                 @Y17XATI 71640000
         EJECT                                                 @Y17XATI 71660000
         DCBD  DSORG=TX                                        @Y17XATI 71680000
         EJECT                                                 @Y17XATI 71700000
         TDEBD                                                 @Y17XATI 71720000
         EJECT                                                 @Y17XATI 71740000
         TDISPD                                                @Y17XATI 71760000
         EJECT                                                 @Y17XATI 71780000
         TLCBD                                                          71800020
         EJECT                                                 @OX16393 71802000
LCBEXTX  DSECT                                                 @OX16393 71804000
THRWORD  DS    F                        FOUR BYTE THRESH INFO  @OX16393 71806000
IEALTPCD DS    CL1                      SAVED LAST TP OP CODE  @OX16393 71808000
IEAFTPCD DS    CL1                      SAVED FIRST TP OP CODE @OX16393 71810000
IEADVCHS DS    CL2                      SAVED DEVICE CHARACTERS@OX16393 71812000
IEASENS0 DS    CL1                      SENSE INFORMATION      @OZ24288 71814000
IEACMD   DS    CL1                      SAVED COMMAND CODE     @OZ24288 71816000
IEACSW   DS    CL2                      SAVED CSW              @OZ24288 71818000
         EJECT                                                 @Y17XATI 71820000
         TNCPID                                                @Y17XATI 71840000
         EJECT                                                 @Y17XATI 71860000
         TPRFD                                                 @Y17XATI 71910000
         EJECT                                                 @Y17XATI 71960000
         TPRIOR                                                         72000020
         EJECT                                                 @Y17XATI 72020000
         TQCBD                                                 @Y17XATI 72040000
         EJECT                                                 @Y17XATI 72060000
         TSCBD                                                 @Y17XATI 72080000
         EJECT                                                 @Y17XATI 72100000
         TTNTD                                                 @Y17XATI 72120000
         EJECT                                                 @Y17XATI 72140000
         TTRMD                                                          72200020
         EJECT                                                 @Y17XATI 72250000
IEDQUCB  DSECT                                                 @Y17XATI 72300000
         IEFUCBOB                                              @Y17XATI 72350000
         END                                                            75000020
./  ADD  SSI=80470577,NAME=IEDQOA
OA TITLE '''IEDQOA''-LINKOR FROM INTRO'                                 00030000
IEDQOA   CSECT                                                          00060000
*A-000000-999999                                               @G36XRNP 00090000
*CHANGE ACTIVITY= AS FOLLOWS:                                           00120000
*A021000,539000                                                  S21903 00150000
*C479000,508000,869200,869600-870800,871200,872600,873000,873400 S21903 00180000
*C873600,873550,874300-874400,875000-875200,876200-876400,877300 S21903 00210000
*C878000                                                         S21903 00240000
*D028000,485000,828600                                           S21903 00270000
*A808600                                                         A48270 00300000
*C508000                                                         A48270 00330000
*D810200-810400                                                  A48270 00360000
*A014000,077000,273000,351000,371000,385000,451000,497000,654000 CLUP21 00390000
*C806800,818000                                                  S22026 00420000
*A293100-293600,372000,391000-394000,415000-416000,431000-432000 S22026 00450000
*A444000-446000,453000-454000,471000-473000,824072-824359        S22026 00480000
*A775820-775940                                                  S22026 00510000
*C508000,777000                                                  S22026 00540000
*D761000-761400                                                  S22026 00570000
*A863209-863389,873500-873550,874300,877300,879660-879720        S22026 00600000
*A304000-309000,412000,498000,689600,710402-710570,866900,873700 S22027 00630000
*A875500,878100,879060                                           S22027 00660000
*C508000                                                         S22027 00690000
*C042000,175000-203000,301000-308000,343000-350000,399000        CLUP21 00720000
*C413000-441000,455000,469000,483000-490000,504000,602000-616000 CLUP21 00750000
*C630000-651000                                                  CLUP21 00780000
*D231000-252000,280000-287000,392000,588000,658000-952000        CLUP21 00810000
*C581000,770800,790400-790600,800400,830800,837400,866200,866000 S22025 00840000
*A812800,813400                                                 SA51787 00870000
*A394000,648800,860800,862400                                    X01004 00900000
*C663600-664200,664800,665400-667800,670200,678000-710400,              00930000
*C853200,866800                                                  X01004 00960000
*D650400-651000,661000-661800,864400                                    00990000
*A648870                                                         Y01004 01020000
*A648830,866880                                                  X02004 01050000
*C648860-648870,670200,678800,709000-710600                      X02004 01080000
*A824319                                                        SA54926 01110000
*C508000                                                         S22024 01140000
*D746800                                                         S22024 01170000
*A747000,783800,876600                                           S22024 01200000
*C678639,678645-678747                                           Y05330 01230000
*D866850                                                         Y05330 01260000
*A835800                                                        SA64692 01290000
*D839400-844000                                                 SA64692 01320000
*A581000,649400,664290,665600,666950,853200,866960,878400,879060,X03039 01350000
*A879400                                                         X03039 01380000
*C042000,670200,678800-679000,780600                             X03039 01410000
*D678606-678774,725804-725988,873800,876640-876710               X03039 01440000
*C679005,679015,879460                                         @XA07498 01470000
*C678832,678850,679080                                         @X50X9NI 01500000
*A683900                                                       @X50X9NI 01530000
*A663000                                                       @YA07705 01560000
*A664112,664120                                                @ZA02084 01590000
*A648940,878100                                                @ZA02084 01620000
*A826600,856000,878100,868800                                  @YA10680 01650000
*C868900                                                       @AS09138 01680000
*A775860,886900                                                @OY12967 01710000
*A360000,414000,422000,434000,442000,448000,452000             @Y17XANG 01740000
*A454000,473000,648940,678870,678965,679010,806800,879060,     @Y17XANG 01770000
*A8668815,880000,783000,808720,811800                          @Y17XANG 01800000
*C649440,649520,664292,664296,665610,665630,666960,666980      @Y17XANG 01830000
*C678810,678831,678845,678855,678905,678925,679000,770800      @Y17XANG 01860000
*C697400,866815,866980                                         @Y17XANG 01890000
*D582000-588000,648943,648947,666970                           @Y17XANG 01920000
*D678875-678895,678970-678975,679015-679065,866960             @Y17XANG 01950000
*D867200-869600                                                @Y17XANG 01980000
*C726600-726800                                                @OY14517 02010000
*       TCAM LEVEL 10.0 MVS CHANGES                            @G36XRNP 02040000
*A664260,745600,826678,866845,869522,663656,648814             @G36XRNP 02070000
*C683918,866820,648814                                         @G36XRNP 02100000
*D648828-648884,648898-648905,826684-826756,866994             @G36XRNP 02130000
*D863218-863389                                                @G36XRNP 02160000
*C477000                                                       @OY18827 02170000
*                                                              @G36XRNP 02190000
*A161100,166800                                                @OY19124 02190182
*C184200-196800,744600-748500                                  @OY19405 02190282
*A183300,198900,765300                                         @OY19405 02190382
*A418500                                                       @OZ29219 02190482
*D540600-541500                                                @OY20289 02190582
*C544800-545100                                                @OY20289 02190682
*****************************************************************S21903 02220000
*                                                                     * 02250000
*MODULE-NAME= IEDQOA   (TCAM,INITIALIZATION)                   @G36XRNP 02280000
*                                                                S21903 02310000
*DESCRIPTIVE-NAME= GETMAIN, SORT, AND ATTACH ROUTINE             S21903 02340000
*                                                                S21903 02370000
*COPYRIGHT= 'NONE'                                               S21903 02400000
*                                                                     * 02430000
*STATUS -- CHANGE LEVEL 10.0                                   @G36XRNP 02460000
*                                                                     * 02490000
*FUNCTION -- THIS MODULE IS TO HANDLE ALL NON-RESIDENT ROUTINES       * 02520000
*   WHICH DO THE INITIAL PROCESSING AT INTRO EXECUTION TIME.  A       * 02550000
*   MESSAGE IS TYPED WHICH CONTAINS AN ERROR CODE NUMBER WHICH IS     * 02580000
*   THE SAME AS THE RETURN CODE PASSED FROM INTRO TO USER'S           * 02610000
*   NEXT INSTRUCTION. THE FUNCTIONS OF THIS ROUTINE INCLUDE:     CLUP21 02640000
*                                                                CLUP21 02670000
*        1 - LINKING TO THE INTRO CONSOLE COMMUNICATIONS ROUTINE CLUP21 02700000
*            (IEDQOB) TO OBTAIN NEW VALUES FOR THOSE INTRO       CLUP21 02730000
*            VALUES SPECIFIED OR OMITTED AT ASSEMBLY TIME.       CLUP21 02760000
*                                                                CLUP21 02790000
*        2 - SCRAMBLING THE 8-CHARACTER PASSWORD IF ONE HAS BEEN CLUP21 02820000
*            SPECIFIED.                                          CLUP21 02850000
*                                                                CLUP21 02880000
*        3 - OBTAIN MAIN STORAGE FOR LINE BUFFERS, A CORE QUEUE  CLUP21 02910000
*            DATA SET IF NECESSARY, CHANNEL PROGRAM BLOCKS,      S22027 02940000
*            TRACE TABLES REQUESTED BY THE USER, AND COMMBUF     S22027 02970000
*            STCB'S, DATA AREAS,AND MASTER QCB, IF REQUESTED.    S22027 03000000
*                                                                CLUP21 03030000
*        4 - SORTING THE TERMNAME TABLE INTO ALPHABATICAL        CLUP21 03060000
*            SEQUENCE. THE TERMNAME TABLE OFFSETS FOR DISTRI-    CLUP21 03090000
*            BUTION LISTS, CASCADE LISTS, LINE ENTRIES, AND      CLUP21 03120000
*            INVITATION LISTS, AS WELL AS ALTERNATE DESTINATION  CLUP21 03150000
*            OFFSETS ARE RE-CALCULATED. ALL ALTERNATE DESTIN-    CLUP21 03180000
*            ATIONS ARE TESTED FOR ACCEPT CAPABILITIES. CERTAIN  CLUP21 03210000
*            FIELDS IN THE TERMNAME TABLE NECESSARY FOR THE      CLUP21 03240000
*            BINARY SEARCH ROUTINE ARE INITIALIZED, AND CHECKS   CLUP21 03270000
*            ARE MADE FOR THE PRESENCE OF A PRIMARY OPERATOR     CLUP21 03300000
*            CONTROL TERMINAL. IF A DEAD LETTER QUEUE IS DEFINED,CLUP21 03330000
*            THE NUMBER WITHIN THE TERMNAME TABLE OF THE DLQ     CLUP21 03360000
*            ENTRY IS DETERMINED AND SAVED IN THE AVT.           CLUP21 03390000
*                                                                CLUP21 03420000
*        5 - UNCONDITIONAL ATTACHMENT OF THE OPERATOR CONTROL    CLUP21 03450000
*            MODULE AND CONDITIONAL ATTACHMENT OF THE ON-LINE    CLUP21 03480000
*            TEST MODULE AND COMMON WRITE MODULE. EXTRACT AND    CLUP21 03510000
*            QEDIT MACRO EXPANSIONS SET UP THE COMMUNICATIONS    CLUP21 03540000
*            PARAMETER LIST INTERFACE BETWEEN TCAM AND THE       CLUP21 03570000
*            OPERATING SYSTEM. IF A SYSTEM DELAY INTERVAL IS     CLUP21 03600000
*            SPECIFIED THE SYSTEM DELAY ROUTINE IS LOADED. IF A  CLUP21 03630000
*            PRIMARY OPERATOR CONTROL TERMINAL IS DEFINED THE    CLUP21 03660000
*            OPERATOR AWARENESS MESSAGE ROUTER ROUTINE IS LOADED.CLUP21 03690000
*                                                              @Y17XANG 03720000
*        6 - ESTABLISHMENT OF GROUP-LINE TERMINAL TABLE        @Y17XANG 03750000
*            HIERARCHIES. THIS CONSISTS OF:                    @Y17XANG 03780000
*                                                              @Y17XANG 03810000
*                - CHAINING THE GROUP LGB TO ITS FIRST LINE    @Y17XANG 03840000
*                  VIA THE LGB SUBSTRUCT POINTER;              @Y17XANG 03870000
*                                                              @Y17XANG 03900000
*                - SUBSEQUENT LINE TO NEXT LINE VIA COHORT     @Y17XANG 03930000
*                  POINTER;                                    @Y17XANG 03960000
*                                                              @Y17XANG 03990000
*                - LAST LINE'S COHORT POINTER BACK TO THE LGB. @Y17XANG 04020000
*                                                              @Y17XANG 04050000
*            THIS IS DONE FOR EACH 3705 LINE GROUP.  3705 LINE @Y17XANG 04080000
*            GROUPS TRANSCEND 3705 SUBAREAS.                   @Y17XANG 04110000
*                                                                       04140000
*                                                                     * 04170000
*ENTRY POINT -- THERE IS ONE ENTRY POINT, LINKED TO BY INTRO          * 04200000
*        'IEDQOA' -- LINKOR                                           * 04230000
*   CALLING SEQUENCE -                                                * 04260000
*        LA    R1,AVT         PASS ADDR OF AVT IN R1                  * 04290000
*        LINK  EP=IEDQOA      IEDQOA RESIDES ON LINKLIB               * 04320000
*                                                                     * 04350000
*INPUT -- R1 HAS ADDR OF AVT.                                         * 04380000
*   R13 HAS ADDR OF 18 WORD SAVEAREA.                                 * 04410000
*   R15 HAS ADDR OF ENTRY POINT.                                      * 04440000
*   R14 HAS ADDR OF RETURN ADDRESS.                                   * 04470000
*                                                                     * 04500000
*OUTPUT -- SCRAMBLED PASSWORD, LINE BUFFERS, A CORE QUEUE DATA   CLUP21 04530000
*   SET, CHANNEL PROGRAM BLOCKS, NECESSARY TRACE TABLES, SORTED  CLUP21 04560000
*   TERMNAME TABLE WITH ADJUSTED OFFSETS, REQUESTED SUBTASKS     CLUP21 04590000
*   ATTACHED, AND REQUIRED ROUTINES LOADED.                      CLUP21 04620000
*                                                                     * 04650000
*EXTERNAL ROUTINES -- ALL ARE ACTIVATED WITH 'LINK'.                  * 04680000
*        'IEDQOB' -- WTOR INTERPRETER                                 * 04710000
*                                                                     * 04740000
*EXITS-NORMAL -- NO ERROR FOUND BY ANY SUBROUTINE.  R15 IS ZERO.      * 04770000
*                                                                     * 04800000
*EXITS-ERROR -- THE ERROR CODE IS RETURNED TO THE CALLER IN      CLUP21 04830000
*   REGISTER 15 AND THE MESSAGE 'IED065I INITIALIZATION ERROR    CLUP21 04860000
*   XXXX' IS DISPLAYED. ERROR CODES ARE:                         CLUP21 04890000
*                                                                CLUP21 04920000
*       04 - TCAM ALREADY ACTIVE.                                CLUP21 04950000
*                                                                CLUP21 04980000
*       08 - GETMAIN FAILURE.                                    CLUP21 05010000
*                                                                CLUP21 05040000
*       12 - GETMAIN FAILURE.                                    CLUP21 05070000
*                                                                CLUP21 05100000
*       16 - TERMINAL DEFINITION ERROR. THE DIAGNOSTIC 'IEDQ065I CLUP21 05130000
*            XXXXXXXX ILLEGAL DESTINATION' WILL BE DISPLAYED.    CLUP21 05160000
*            THE XXXXXXXX FIELD IS THE TERMINAL NAME.            CLUP21 05190000
*                                                                CLUP21 05220000
*       20 - ERROR IN DEFINITION OF THE PRIMARY OPERATOR CONTROL CLUP21 05250000
*            TERMINAL. E. G., THE DESIGNATED TERMINAL COULD NOT  CLUP21 05280000
*            BE FOUND IN THE TERMNAME TABLE, OR IT DID NOT HAVE  CLUP21 05310000
*            SEND AND ACCEPT CAPABILITIES, OR IT WAS NOT DEFINED CLUP21 05340000
*            AS BEING A POSSIBLE SECONDARY OPERATOR CONTROL      CLUP21 05370000
*            TERMINAL, ETC.                                      CLUP21 05400000
*                                                                S22026 05430000
*       24 - ERROR IN SORTING THE DEVICE ID TABLE.  THE TNT      S22026 05460000
*            OFFSET IN THE DEVICE ID TABLE NOT FOUND IN THE      S22026 05490000
*            OFFSET TABLE, OR THE DEVICE DEPENDENT FIELD         S22026 05520000
*            POINTING TO THE DEVICE ID TABLE FOR A CONCENTRATOR  S22026 05550000
*            TERMINAL ENTRY DID NOT INDICATE A CONCENTRATOR.     S22026 05580000
*                                                                     * 05610000
*       28 - AUTHORIZATION ERROR. SOMEONE HAS ATTEMPTED TO     @G36XRNP 05640000
*            START AND UNAUTHORIZED MCP. E.G. THE MCP WAS NOT  @G36XRNP 05670000
*            RUNNING UNDER PROTECT KEY 6                       @G36XRNP 05700000
*                                                              @G36XRNP 05730000
*TABLES/WORKAREA -- AVT                     TNT                @G36XRNP 05760000
*                   TERMINAL ENTRY          LCB                @G36XRNP 05790000
*                   QCB                     DEVICE ID TABLE    @G36XRNP 05820000
*                   CPB                     ACB                @G36XRNP 05850000
*                   DCB                     CVT                @G36XRNP 05880000
*                   COMMON BUFFER MASTER QCB                   @G36XRNP 05910000
*                                                                     * 05940000
*ATTRIBUTES -- SERIALLY REUSABLE, NON-RESIDENT, ENABLED,              * 05970000
*              PROBLEM PROGRAM MODE.                                  * 06000000
*                                                                     * 06030000
*NOTES -- THE OPERATION OF THIS MODULE DEPENDS UPON AN INTERNAL  CLUP21 06060000
*   REPRESENTATION OF THE EXTERNAL CHARACTER SET EQUIVALENT TO   CLUP21 06090000
*   THE ONE USED AT ASSEMBLY TIME. THE CODING HAS BEEN ARRANGED  CLUP21 06120000
*   SO THAT REDEFINITION OF 'CHARACTER' CONSTANTS AND REASSEMBLY CLUP21 06150000
*   WILL RESULT IN A CORRECT MODULE FOR THE NEW DEFINITIONS.     CLUP21 06180000
         EJECT                                                          06210000
* REGISTER EQUATES AND DEFINITIONS                               CLUP21 06240000
RTRM     EQU   15                       POINTER TO NEXT TNT ENTRY       06270000
RLGB     EQU   15                       RLGB OF CURRENT GROUP  @Y17XANG 06300000
R15      EQU   15                       ENTRY POINT ADDRESS             06330000
RDCB     EQU   14                       DCB DSECT BASE REGISTER         06360000
R14      EQU   14                       RETURN ADDRESS                  06390000
RTNTCTR  EQU   14                       TNT ENTRY COUNTER        S22026 06420000
RTNT     EQU   13                       TERMNAME TABLE DSECT BASE       06450000
R13      EQU   13                       SAVEAREA                        06480000
RBASE    EQU   12                       PROGRAM BASE                    06510000
RQCB     EQU   11                       QCB DSECT BASE REGISTER         06540000
RCTR1    EQU   11                       LOOP COUNTER             S22026 06570000
RLENDE   EQU   11                       LENGTH OF DVC TBL ENTRY  S22026 06600000
R11      EQU   11                                                X01004 06630000
R10      EQU   10                                                X01004 06660000
RCPB     EQU   10                       CPB DSECT BASE                  06690000
RAVT     EQU   9                        AVT DSECT BASE                  06720000
RFIRST   EQU   8                        ADDRESS OF FIRST TNT ENTRY      06750000
RCMB     EQU   8                        CMB DSECT BASE REGISTER  S22027 06780000
R8       EQU   8                        WORK REGISTER                   06810000
RGETM    EQU   8                        SORT WORK AREA BASE.   @Y17XANG 06840000
RTNTOFF  EQU   8                        ADDR OF TNT OFFSET       S22026 06870000
RLINK    EQU   7                        SUBRTN LINKAGE REGISTER  S22026 06900000
RGETAREA EQU   7                        OFFSET TABLE                    06930000
R7       EQU   7                        WORK REGISTER                   06960000
RNLINE   EQU   7                        ADDR OF CURRENT LINE   @Y17XANG 06990000
*                                       TTE TO GO INTO THE     @Y17XANG 07020000
*                                       HIERARCHY.             @Y17XANG 07050000
ROTNEXT  EQU   6                        POINTER TO NEXT OFFSET ENTRY    07080000
R6       EQU   6                        WORK REGISTER                   07110000
RWORK    EQU   6                        WORK REGISTER            S22026 07140000
RCTR2    EQU   6                        LOOP COUNTER             S22026 07170000
R5       EQU   5                        WORK REGISTER                   07200000
ROTNOW   EQU   5                        POINTER TO THIS OFFSET ENTRY    07230000
RTBL     EQU   5                        CURRENT SORT TABLE     @Y17XANG 07260000
*                                       ENTRY - FORWARD SORT.  @Y17XANG 07290000
RLEN     EQU   4                        LENGTH OF A TERMNAME ENTRY      07320000
R4       EQU   4                        WORK REGISTER                   07350000
RCURR    EQU   4                        CURRENT SORT TABLE     @Y17XANG 07380000
*                                       ADDRESS.               @Y17XANG 07410000
RLENTN   EQU   4                        LENGTH OF TERMINAL NAME  S22026 07440000
RIDCNT   EQU   3                        DVC ID TABLE COUNT       S22026 07470000
R3       EQU   3                        SAVES ERROR CODE                07500000
RTNT2    EQU   3                        ADDRESS CURRENT TNT    @Y17XANG 07530000
*                                       LINE SEARCH            @Y17XANG 07560000
REOT     EQU   3                        LAST SORT TABLE ENTRY  @Y17XANG 07590000
R2       EQU   2                        WORK REGISTER                   07620000
R1ST     EQU   2                        1ST LINE ENTRY IN SORT @Y17XANG 07650000
*                                       TABLE.                 @Y17XANG 07680000
RFLD     EQU   2                        ADDR OF DVC DEP FIELD    S22026 07710000
RIDPTR   EQU   2                        DVC ID TABLE POINTER     S22026 07740000
RTNT1    EQU   2                        ADDRESS CURRENT TNT    @Y17XANG 07770000
*                                       IN LGB SEARCH.         @Y17XANG 07800000
RPRESENT EQU   1                        POINTER TO PRESENT OFFSET NTRY  07830000
R1       EQU   1                        ADDR OF AVT,PASSED TO SUBROUT   07860000
R0       EQU   0                        WORK REGISTER                   07890000
RFLGS    EQU   0                        DVC DEPENDNT FIELD FLAGS S22026 07920000
RSVADR   EQU   0                        SAVE-ADDRESS REGISTER    S22026 07950000
*                                       TABLE                  @Y17XANG 07980000
ADDR     EQU   7                        MASK TO ICM ADDRESS L'3@Y17XANG 08010000
         USING *,R15                    TEMPORARY ADDRESSIBILITY S21903 08040000
         USING IEDQAVTD,RAVT            AVT DSECT                       08070000
         USING IEDQTNTD,RTNT            TERMNAME TABLE DSECT            08100000
         USING IHADCB,RDCB              DCB DSECT                       08130000
         USING IEDQCPB,RCPB             CPB DSECT                       08160000
         USING IEDCMB,RCMB              CMB DSECT BASE REGISTER  S22027 08190000
         EJECT                                                          08220000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       08250000
*                                                                       08280000
*        THIS SECTION OF CODE SAVE THE CALLER'S REGISTERS, CHAINS       08310000
*        SAVEAREAS, AND LINKS TO IEDQOB TO GET INTRO PARAMETERS         08340000
*                                                                       08370000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       08400000
*                                                                       08430000
IEDQOA   IEDHJN  START                                           S21903 08460000
         SAVE  (14,12)                  SAVE CALLER'S REGISTERS  S21903 08490000
         LA    R2,2*AVTSVSIZ(R1)        GET ADDR OF AVTSAVE3            08520000
         ST    R13,4(R2)                CHAIN                           08550000
         ST    R2,8(R13)                  SAVEAREAS                     08580000
         LR    R13,R2                   SET AVT BASE                    08610000
         LR    RBASE,R15                SET PROGRAM BASE                08640000
         DROP  R15                                                      08670000
         USING IEDQOA,RBASE             CSECT ADRRESSABILITY     S21903 08700000
         USING IEDQTRM,RTRM             TRM ADDRESSIBILITY       S21903 08730000
         LR    RAVT,R1                  SAVE AVT ADDR                   08760000
*                                                                       08790000
         LINK  MF=(E,(1)),SF=(E,LINKOB) CALL WTOR INTERPRETER           08820000
*                                                                       08850000
         LTR   R15,R15                  TEST RETURN CODE                08880000
         BNZ   ERROR                    BRANCH IF ERROR          S22025 08910000
         CLC   AVTPASWD,NOPASS          WAS PASSWRD SPECIFIED           08940000
         BE    SKIP                     NO, SKIP SCRAMBLING             08970000
         LA    R1,AVTPASWD              PASS ADDR OF 8 CHAR WORD        09000000
         LA    R2,WORK(R13)             WORDS 6 AND 7 OF SAVE AREA      09030000
*                                         ARE WORKAREA                  09060000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       09090000
*                                                                       09120000
*        THIS SECTION OF CODE SCRAMBLES THE SPECIFIED PASSWORD          09150000
*                                                                       09180000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       09210000
*                                                                       09240000
         MVC   2(1,R2),1(R1)                                            09270000
         MVC   5(1,R2),0(R1)            RANDOM                          09300000
         MVC   3(2,R2),6(R1)            CHARACTER                       09330000
         MVC   0(2,R2),2(R1)            ARRANGEMENT                     09360000
         MVC   6(2,R2),4(R1)                                            09390000
*                                                                       09420000
         LA    R3,NUM                   TRAILING DECISION COUNT FOR     09450000
*                                         EIGHT ITERATIONS              09480000
LOOPIT   EQU   *                                                        09510000
         NI    0(R2),NR                 TURN OFF BIT 1                  09540000
         XI    0(R2),XR                 FLIP BITS 4 THROUGH 7           09570000
         LA    R2,1(R2)                 GET NEXT CHARACTER              09600000
         BCT   R3,LOOPIT                REITERATE UNTIL DONE            09630000
         MVC   AVTPASWD(8),WORK(R13)    SAVE SCRAMBLED RESULTS          09660000
         EJECT                                                          09690000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       09720000
*                                                                       09750000
*        THIS SECTION OF CODE STORES THE TCB ADDRESS IN THE AVT         09780000
*                                                                       09810000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       09840000
*                                                                       09870000
SKIP     EQU   *                                                        09900000
         L     R1,CVTPTR                ADDRESS OF THE CVT       X02004 09930000
         L     R1,0(,R1)                ADDRESS OF THE TCB POINTER      09960000
         L     R1,4(,R1)                ADDRESS OF THE TCB              09990000
         ST    R1,AVTTCB                STORE TCB ADDRESS IN AVT        10020000
*                                                                       10050000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       10080000
*                                                                       10110000
*        THIS SECTION OF CODE BUILDS ALL LINE BUFFERS                   10140000
*                                                                       10170000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       10200000
*                                                                       10230000
         SR    R5,R5                    CLEAR LENGTH OF I/O TRACEX01004 10260000
         L     R3,PAGESIZE              SIZE OF MVS PAGE       @G36XRNP 10290000
         OI    AVTPKF,AVTFTCHF          SET FETCH PROTECT ACTIVE Y01004 10320000
         USING IEDQQCB,RQCB             QCB DSECT BASE REGISTER  X02004 10350000
         SR    R7,R7                    CLEAR I/O TRACE LENGTH   X01004 10380000
         CLC   AVTRACE,AVTFZERO         USER REQUESTED TRACE AREAX01004 10410000
         BE    BLDLBUF                  NO, BRANCH               X01004 10440000
         LA    R7,IOTRCSIZ              SIZE OF 1 TRACE ENTRY    X01004 10470000
         L     R5,AVTRACE               # TRACE ENTRIES        @Y17XANG 10500000
         LA    R5,THREE(R5)             MAKE MODULO 4          @Y17XANG 10530000
         SRL   R5,TWO                                          @Y17XANG 10560000
         SLL   R5,TWO                                          @Y17XANG 10590000
         ST    R5,AVTRACE               SAVE ENTRIES MOD 4     @Y17XANG 10620000
         M     R6,AVTRACE               MULTIPLY SIZE OF ENTRY @Y17XANG 10650000
*                                       NUMBER OF ENTRIES        X01004 10680000
         LA    R5,THRTTWO(R7)           ADD CONTROL INFORMATION  X01004 10710000
BLDLBUF  EQU   *                                                 X01004 10740000
         LR    R6,R3                    COPY PAGE SIZE           X01004 10770000
         SR    R3,R3                    CLEAR A COUNT REGISTER          10800000
         LH    R1,AVTKEYLE              SIZE OF 1 UNIT RECORD           10830000
         LA    R1,AVTUMALN(,R1)         ADD PREFIX SIZE                 10860000
         TM    AVTSAVTF,AVTVTMCP        3705 IN SYSTEM?        @Y17XANG 10890000
         BZ    NOLCCWS                  BR NO                    X03039 10920000
         LA    R1,LCCWSZ(,R1)           ADD SIZE OF NEG BUFFER @Y17XANG 10950000
*                                       PREFIX.                @Y17XANG 10980000
NOLCCWS  EQU   *                                                 X03039 11010000
         LA    R1,ROUND(,R1)            ROUND UP THE UNIT SIZE TO       11040000
         SRL   R1,THREE                 THE NEXT DOUBLE WORD            11070000
         SLL   R1,THREE                 BOUNDARY                        11100000
         LR    R8,R1                    SAVE BUFFER SIZE                11130000
*                                                                       11160000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       11190000
*                                                                       11220000
*        TEST FOR CORE QUEUE PARAMETERS                                 11250000
*                                                                       11280000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       11310000
*                                                                       11340000
         TM    AVTBIT1,AVTAQTAN         ARE CORE CONSTANTS IN AVT       11370000
         BZ    AVTGET                   NO, FORGET CORE CONSTANTS       11400000
         CLC   AVTTOTNC,AVTFZERO        HAS THE USER REQUESTED A        11430000
*                                         CORE DATA SET                 11460000
         BE    AVTGET                   NO, FORGET CORE QUEUE           11490000
         EJECT                                                          11520000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       11550000
*                                                                       11580000
*        CALCULATE THE MAXIMUM AND MINIMUM THRESHOLD VALUES             11610000
*                                                                       11640000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       11670000
*                                                                       11700000
         LA    R2,PERCENT               LOAD THE PERCENTAGE FACTOR      11730000
         SR    R0,R0                    CLEAR  MULTIPLICATION REG.      11760000
         L     R1,AVTCMIN               LOAD THE MINIMUM THRESHOLD      11790000
*                                         VALUE                         11820000
         M     R0,AVTTOTNC              MULTIPLY BY THE NUMBER OF       11850000
*                                         CORE RECORDS                  11880000
         DR    R0,R2                    DIVIDE THE MINIMUM NUMBER       11910000
*                                         OF CORE RECORDS BY 100        11940000
         LTR   R0,R0                    IS THERE A REMAINDER            11970000
         BE    SKIP1                    NO, SKIP THE NEXT               12000000
*                                         INSTRUCTION                   12030000
         LA    R1,ONE(R1)               INCREMENT THE MINIMUM COUNT     12060000
*                                                                       12090000
SKIP1    EQU   *                                                        12120000
         ST    R1,AVTCMIN               STORE THE MINIMUM VALUE         12150000
         SR    R0,R0                    CLEAR ANY REMAINDER             12180000
         L     R1,AVTCMAX               LOAD THE MAXIMUM THRESHOLD      12210000
*                                         VALUE                         12240000
         M     R0,AVTTOTNC              MULTIPLY BY THE NUMBER OF       12270000
*                                         CORE RECORDS                  12300000
         DR    R0,R2                    DIVIDE THE MAXIMUM NUMBER       12330000
*                                         OF CORE RECORDS BY 100        12360000
         LTR   R0,R0                    IS THERE A REMAINDER            12390000
         BZ    SKIP2                    NO, SKIP THE NEXT               12420000
*                                         INSTRUCTION                   12450000
         LA    R1,ONE(,R1)              INCREMENT THE MAXIMUM COUNT     12480000
*                                                                       12510000
SKIP2    EQU   *                                                        12540000
         ST    R1,AVTCMAX               STORE THE MAXIMUM THRESHOLD     12570000
*                                         VALUE                         12600000
         L     R3,AVTTOTNC              LOAD THE NUMBER OF CORE         12630000
*                                         BUFFERS REQUESTED             12660000
         EJECT                                                          12690000
AVTGET   EQU   *                                                        12720000
         AH    R3,AVTNOLBF              ADD TO THIS THE NUMBER OF       12750000
*                                         LINE BUFFER UNITS             12780000
         N     R3,AVTCLRHI              CLEAR HI ORDER 2 BYTES @YA07705 12810000
         STH   R3,AVTAVFCT              STORE IN THE AVAILABLE          12840000
*                                         BUFFER FIELD OF THE AVT       12870000
         SR    R1,R1                    CLEAR LENGTH ACCUMULATOR X01004 12900000
MOREPAGE AR    R1,R6                    BUMP CORE NEEDED BY PAGE X01004 12930000
         CR    R5,R1                    I/O TRACE FIT            X01004 12960000
         BH    MOREPAGE                 NO, BUMP CORE NEEDED     X01004 12990000
         LR    R10,R1                   COPY CORE REQUIRED       X01004 13020000
         SR    R10,R5                   FIND EXTRA CORE AVAILABLEX01004 13050000
         LR    R5,R10                   SAVE EXTRA CORE FOR      X01004 13080000
*                                         I/O TRACE              X01004 13110000
PADCHECK EQU   *                                               @G36XRNP 13140000
         CH    R10,H8                   ENOUGH CORE LEFT IN    @G36XRNP 13170000
*                                       PAGE FOR PADDING FOR   @G36XRNP 13200000
*                                       FOR ERRORMSG BFR ACTING@G36XRNP 13230000
*                                       AS QCB                 @G36XRNP 13260000
         BH    PADOK                    YES, BRANCH            @G36XRNP 13290000
         LR    R10,R6                   NEED NEW PAGE          @G36XRNP 13320000
         AR    R1,R6                    INCREMENT TOTAL PAGES  @G36XRNP 13350000
PADOK    EQU   *                                               @G36XRNP 13380000
         SH    R10,H8                   ALLOW FOR PADDING      @G36XRNP 13410000
MOREBUF  CR    R8,R10                   CORE LEFT IN PAGE FOR    X01004 13440000
*                                         THIS BUFFER            X01004 13470000
         BNH   BUFFIT                   YES, BRANCH              X01004 13500000
         LR    R10,R6                   NEED NEW PAGE            X01004 13530000
         AR    R1,R6                    BUMP TOTAL PAGES         X01004 13560000
         B     MOREBUF                  CHECK NEXT BUFFER        X01004 13590000
BUFFIT   EQU   *                                                 X01004 13620000
         SR    R10,R8                   DECREMENT AVAILABLE CORE X01004 13650000
         BCT   R3,MOREBUF               CHECK NEXT BUFFER        X01004 13680000
         SR    R4,R4                    CLEAR SIZE OF CPB        X01004 13710000
         TM    AVTBIT1,AVTDISKN         DISK QUEVEING SUPPORTED  X01004 13740000
         BZ    GETPBNDY                 NO, BRANCH               X01004 13770000
         LA    R4,CPBSIZE-IEDQCPB       SIZE OF REGULAR CPB      X01004 13800000
         AR    R4,R8                    CPB + SIZE OF BUFFER     X01004 13830000
         LH    R11,AVTCPBNO             GET NUMBER OF CPB'S      X01004 13860000
         N     R11,AVTCLRHI             FORCE POSITIVE           X01004 13890000
MORECPB  EQU   *                                                 X01004 13920000
         CR    R4,R10                   WILL CPB FIT IN THIS PAGEX01004 13950000
         BNH   CPBFIT                   YES, BRANCH              X01004 13980000
         LR    R10,R6                   NEED NEW PAGE            X01004 14010000
         AR    R1,R6                    BUMP TOTAL PAGES         X01004 14040000
         B     MORECPB                  CONTINUE LOOP            X01004 14070000
CPBFIT   EQU   *                                                 X01004 14100000
         SR    R10,R4                   DECREMENT AVAILABLE CORE X01004 14130000
         BCT   R11,MORECPB              CHECK NEXT BUFFER        X01004 14160000
GETPBNDY EQU   *                                                 X01004 14190000
         LA    R0,FREEPTR               AREA TO HOLD CORE        X01004 14220000
         BAL   R14,AVTPAR1              GETMAIN FOR PAGE         X01004 14250000
         L     R0,AVTGETMN              GET LENGTH OF GOTTEN COREX01004 14280000
         L     R1,FREEPTR               ADDRESS OF GOTTEN CORE   X01004 14310000
         LR    R15,R0                   COPY LENGTH              X01004 14340000
         LR    R14,R1                   COPY GOTTEN CORE ADDRESS X01004 14370000
         STM   R14,R15,FBUFSAV          SAVE ADDRESS OF CORE ON  X01004 14400000
*                                        PAGE BOUNDARY AND       X01004 14430000
*                                        ITS LENGTH              X01004 14460000
CLEARCOR MVI   0(R14),AVTEZERO          CLEAR CORE               X01004 14490000
         LA    R14,ONE(R14)             INCREMENT ADDRESS        X01004 14520000
         BCT   R15,CLEARCOR             DECREMENT COUNT & BRANCH X01004 14550000
         ST    R14,FREEPTR+FOUR         SAVE ENDING ADDRESS      X01004 14580000
         ST    R6,0(R1)                 SET LENGTH               X01004 14610000
         LTR   R7,R7                    I/O TRACE TO BE USED     X01004 14640000
         BZ    BLDLBUF1                 NO, BRANCH               X01004 14670000
         LA    R11,SIXTEEN              ADD 16 BYTES FOR CONTROL X01004 14700000
         AR    R1,R11                   BUMP PAST CONTROL INFO.  X01004 14730000
         ST    R1,AVTRACE               SAVE ADDRESS OF TRACE    X01004 14760000
         LA    R10,SIXTEEN(R7,R1)       ADDRESS OF END OF TRACE  X01004 14790000
         ST    R10,FREEPTR              UPDATE AVAILABLE CORE PTRX01004 14820000
         ST    R5,0(R10)                SET NEW LENGTH           X01004 14850000
         LA    R0,0(R11,R1)             ADDRESS OF FIRST ENTRY   X01004 14880000
         SR    R10,R11                  COMPUTE ADDRESS OF LAST  X01004 14910000
*                                         ENTRY IN TRACE TABLE   X01004 14940000
         ST    R10,EIGHT(R1)            SAVE ADDR. OF LAST ENTRY X01004 14970000
         AR    R0,R11                   ALLOW FOR PREFIX       @ZA02084 15000000
         ST    R0,0(R1)                 ADDRESS OF CURRENT ENTRY X01004 15030000
         SR    R0,R11                   ADJUST FOR PREFIX      @ZA02084 15060000
         ST    R0,FOUR(R1)              ADDRESS OF FIRST ENTRY   X01004 15090000
         SRL   R7,ONE                   OFFSET TO MIDDLE ENTRY   X01004 15120000
         AR    R0,R7                    ADDRESS OF MIDDLE ENTRY  X01004 15150000
         ST    R0,TWELVE(R1)            SAVE MIDDLE ENTRY ADDRESSX01004 15180000
         TM    FIFTEEN(R1),BOUND8       IS MIDDLE ON 8-BYTE      X01004 15210000
*                                         BOUNDARY               X01004 15240000
         BZ    TURNON                   NO, BRANCH               X01004 15270000
         SR    R10,R11                  GET NEW LAST ENTRY       X02004 15300000
         ST    R10,EIGHT(R1)            SET NEW LAST ENTRY       X02004 15330000
         LA    R11,EIGHT                ADJUST BY EIGHT BYTES    X01004 15360000
         SR    R0,R11                   GET NEW MIDDLE ENTRY     X01004 15390000
         ST    R0,TWELVE(R1)            STORE NEW MIDDLE ENTRY   X01004 15420000
TURNON   EQU   *                                                 X01004 15450000
         OI    TWELVE(R1),IOTRCFLG      SET HIGH ORDER BITS OF   X01004 15480000
*                                        I/O TRACE FLAGS         X01004 15510000
BLDLBUF1 EQU   *                                                 X01004 15540000
         LH    R1,H8                    SIZE OF PADDING FOR    @G36XRNP 15570000
*                                       ERRORMSG BUFFER ACTING @G36XRNP 15600000
*                                       AS QCB                 @G36XRNP 15630000
         BAL   R14,GETFIXD              GET PADDING            @G36XRNP 15660000
         LH    R10,AVTAVFCT             TOTAL NUMBER OF BUFFERS  X01004 15690000
         LR    R1,R8                    LENGTH TO ASSIGN         X01004 15720000
         BAL   R14,GETFIXD              GET FIRST BUFFER         X01004 15750000
         TM    AVTSAVTF,AVTVTMCP        3705 IN SYSTEM         @Y17XANG 15780000
         BZ    NOLCCW                   BR NO                    X03039 15810000
         LA    R1,LCCWSZ(,R1)           ADD SIZE OF NEG BUFFER @Y17XANG 15840000
*                                       PREFIX.                @Y17XANG 15870000
NOLCCW   EQU   *                                                 X03039 15900000
         ST    R1,AVTCOREC              SAVE ADDRESS OF BUFFER   X01004 15930000
         MVC   EIGHT(EIGHT,R1),FBUFSAV  COPY ADDRESS OF BUFFERS  X01004 15960000
*                                        AND LENGTH FOR OPEN     X01004 15990000
*                                        TO FIX                  X01004 16020000
         MVC   AVTBFREB+1(3),AVTCOREC+1 MOVE THE BUFFER ADDRESS TO      16050000
*                                         AVAILABLE BUFFER QCB          16080000
         BCT   R10,CORCOPY              REDUCE COUNT BY ONE      X01004 16110000
         STCM  R1,7,AVTSELCH            SAVE ADDRESS LAST UNIT @OY19124 16120082
         B     BLDCPB                   BRANCH IF ONLY ONE BUFFERX01004 16140000
*                                                                       16170000
CORCOPY  EQU   *                                                        16200000
         LR    R2,R1                    SAVE BUFFER ADDRESS FOR  X01004 16230000
*                                         CHAINING OF BUFFERS    X01004 16260000
         LR    R1,R8                    GET LENGTH OF BUFFER     X01004 16290000
*                                                                X01004 16320000
         BAL   R14,GETFIXD              GET NEXT BUFFER          X01004 16350000
         TM    AVTSAVTF,AVTVTMCP        3705 IN SYSTEM?        @Y17XANG 16380000
         BZ    NOBUMP                   BR NO                    X03039 16410000
         LA    R1,LCCWSZ(,R1)           BUMP PAST NEG BUF PREF @Y17XANG 16440000
NOBUMP   EQU   *                                                 X03039 16470000
         ST    R1,FOUR(R2)              CHAIN BUFFER TO          X01004 16500000
*                                         PREVIOUS BUFFER        X01004 16530000
         BCT   R10,CORCOPY              REDUCED COUNT AND        X01004 16560000
*                                         GET NEXT BUFFER.       X01004 16590000
*                                         ON LAST BUFFER         X01004 16620000
*                                         FALL THROUGH TO GET    X01004 16650000
*                                         CHANNEL PROGRAM BLOCKS X01004 16680000
         STCM  R1,7,AVTSELCH            SAVE ADDRESS LAST UNIT @OY19124 16690082
         EJECT                                                          16710000
*********************************************************************** 16740000
*                                                                     * 16770000
*        THIS SECTION OF CODE GETS CORE FOR AND                       * 16800000
*        INITIALIZES A CPB FREEPOOL.                                  * 16830000
*                                                                     * 16860000
*********************************************************************** 16890000
BLDCPB   EQU   *                                                 X01004 16920000
         TM    AVTBIT1,AVTDISKN         DISK QUEVEING SUPPORTED  X01004 16950000
         BZ    RTEND                    NO, BRANCH               X02004 16980000
         LH    R5,AVTCPBNO              GET NUMBER OF CPB'S      X01004 17010000
         N     R5,AVTCLRHI              FORCE POSITIVE           X01004 17040000
         LR    R1,R4                    SIZE OF CPB              X01004 17070000
         BAL   R14,GETFIXD              GET FIRST BUFFER         X01004 17100000
         ST    R1,AVTFCPB               SAVE FIRST CPB ADDRESS   X01004 17130000
         STCM  R1,AD,AVTCPBPT+ONE       SAVE IN SECOND ADDRESS   X01004 17160000
         DROP  RCPB                                              X01004 17190000
         USING IEDQCPB,R1                                        X01004 17220000
CPBLOAD  EQU   *                                                 X01004 17250000
         LA    R7,CPBSIZE               GET ADDR. OF UNIT        X01004 17280000
         TM    AVTSAVTF,AVTVTMCP        3705 IN SYSTEM?        @Y17XANG 17310000
         BZ    DONTBUMP                 BR NO                  @Y17XANG 17340000
         LA    R7,LCCWSZ(,R7)           ADD SIZE OF NEG BUFFER @Y17XANG 17370000
*                                       PREFIX.                @Y17XANG 17400000
DONTBUMP EQU   *                                                 X03039 17430000
         ST    R7,CPBXREAF               INTO CPB                X01004 17460000
         MVI   CPBXOUNT+ONE,AVTDATLN    SET DATA LENGTH          X01004 17490000
         LR    R2,R1                    SAVE ADDRESS OF PREVIOUS X01004 17520000
         LR    R1,R4                    LENGTH OF CPB            X01004 17550000
         BCT   R5,CHAIN                 DO NEXT CPB, IF ANY      X01004 17580000
         B     RTEND                    END OF CPB FREEPOOL      X02004 17610000
CHAIN    EQU   *                                                 X01004 17640000
         BAL   R14,GETFIXD              GET CPB BUFFER           X01004 17670000
         ST    R1,CPBNEXTF-IEDQCPB(R2)  CHAIN CPB'S TOGETHER     X01004 17700000
         B     CPBLOAD                  DO NEXT CPB              X01004 17730000
         DROP  R1                                                X01004 17760000
         USING IEDQCPB,RCPB                                      X01004 17790000
RTEND    EQU   *                                                 X02004 17820000
         L     R1,FREEPTR               ADDRESS OF UNUSED CORE   X02004 17850000
         LTR   R1,R1                    IS CORE GOTTEN           X02004 17880000
         BZ    TESTDISP                 NO, BRANCH               X02004 17910000
         L     R0,0(R1)                 LENGTH OF UNUSED CORE    X02004 17940000
         LTR   R0,R0                    ALL USED                 X02004 17970000
         BZ    TESTDISP                 YES, BRANCH              X02004 18000000
         FREEMAIN R,LV=(0),A=(1)                                 X02004 18030000
         EJECT                                                          18060000
         EJECT                                                          18090000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       18120000
*                                                                       18150000
*        THIS SECTION OF CODE GETMAINS MAIN STORAGE FOR                 18180000
*        A DISPATCHER TRACE AREA                                        18210000
*                                                                       18240000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       18270000
*                                                                       18300000
TESTDISP EQU   *                                                        18330000
         ST    R6,SAVER6                SAVE REG FOR USE LATER @OY19405 18340082
         NC    AVTDISTR(4),AVTDISTR     HAS A TRACE TABLE BEEN          18360000
*                                         REQUESTED                     18390000
         BZ    TESTBUFT                 BR NO                  @OY19405 18420082
         L     R6,DISPTR                GET RTN ADDRESS        @OY19405 18470082
         BR    R6                       GO TO RTN.             @OY19405 18520082
DISPTR   DC    A(DISPATR)                                      @OY19405 18570082
SAVER6   DC    F'0'                     REG 6 SAVE             @OY19405 18580082
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *@OY19405 18620082
*                                                              @OY19405 18670082
*        THIS SECTION OF CODE GETS CORE FOR A BUFFER TRACE     @OY19405 18720082
*                                                              @OY19405 18770082
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *@OY19405 18820082
*                                                              @OY19405 18870082
TESTBUFT EQU   *                                               @OY19405 18920082
         NC    AVTBUENT(2),AVTBUENT     TRACE REQUESTED?       @OY19405 18970082
         BZ    TPIOTRAC                 BR NO                  @OY19405 19020082
         L     R6,BUFRTN                GET RTN ADD.           @OY19405 19070082
         BR    R6                       GO TO RTN TO AVOID     @OY19405 19120082
*                                       ADDRESSABILTY PROB.    @OY19405 19170082
BUFRTN   DC    A(BUFFRTN)                                      @OY19405 19220082
         EJECT                                                          19270082
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *X03039 19710000
*                                                                X03039 19740000
*        THIS SECTION OF CODE GETS CORE FOR A PIU TRACE TABLE  @Y17XANG 19770000
*                                                                X03039 19800000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *X03039 19830000
*                                                                X03039 19860000
TPIOTRAC EQU   *                                                 X03039 19890000
         L     R6,SAVER6                RESTORE REG 6          @OY19405 19900082
         TM    AVTSAVTF,AVTVTMCP        IS THERE A 3705?       @Y17XANG 19920000
         BZ    BRACKET                  NO, NO TBL REQUIRED    @X50X9NI 19950000
         USING IEDNSVTD,R4                                       X03039 19980000
         L     R4,AVTSAVTP              ADDRESS OF SECONDARY AVT X03039 20010000
         NC    SAVTPIUT,SAVTPIUT        PIU TRACE REQUESTED?   @Y17XANG 20040000
         BZ    BRACKET                  BR NO                  @X50X9NI 20070000
         L     R1,SAVTPIUT              NUMBER OF TABLE ENTRIES@Y17XANG 20100000
         LA    R1,ONE(R1)               ROUND UP TO AN EVEN ...  X03039 20130000
         SRL   R1,ONE                   ... NUMBER IF ODD        X03039 20160000
         SLL   R1,ONE                                            X03039 20190000
         LR    R3,R1                    SAVE # ENTRIES         @Y17XANG 20220000
         LA    R5,ENTRYSZ               ENTRY SIZE             @Y17XANG 20250000
         MR    R0,R5                    LENGTH OF ENTRIES IN R1@Y17XANG 20280000
         LA    R1,2*HDRSZ+CNTRLSZ(R1)   TABLE SIZE = LENGTH OF @Y17XANG 20310000
*                                       ENTRIES + CONTROL AREA.@Y17XANG 20340000
*                                       + 2 HALF TABLE HEADERS.@Y17XANG 20370000
         LR    R5,R1                    SAVE TABLE SIZE        @Y17XANG 20400000
         LA    R0,SAVTPIUT              ADDR TO RECEIVE TABLE  @Y17XANG 20430000
*                                       ADDRESS FROM GETMAIN.  @Y17XANG 20460000
         BAL   R14,AVTPAR               LINK TO GETMAIN          X03039 20490000
         LR    R1,R5                    RESTORE TABLE SIZE       X03039 20520000
         USING TTRCCTLD,R2                                       X03039 20550000
         L     R2,SAVTPIUT              ADDRESS OF TRACE TABLE @Y17XANG 20580000
         LA    R5,CNTRLSZ(R2)           FIRST ENTRY ADDRESS      X03039 20610000
         ST    R5,TTRCFRST              STORE IN CONTROL AREA    X03039 20640000
         LA    R5,HDRSZ(R5)             CURRENT ENTRY ADDRESS    X03039 20670000
         ST    R5,TTRCCURR              STORE IN CONTROL AREA    X03039 20700000
         LA    R5,0(R1,R2)              ADDRESS ON END OF TABLE  X03039 20730000
         SH    R5,HEIGHT                ADDRESS OF LAST ENTRY    X03039 20760000
         ST    R5,TTRCLAST              STORE IN CONTROL AREA    X03039 20790000
         LR    R1,R3                    NUMBER OF ENTRIES        X03039 20820000
         MH    R1,HEIGHT                #ENTRIES * ENTRY SIZE  @Y17XANG 20850000
         SRL   R1,1                     DIVIDED BY 2           @Y17XANG 20880000
         LA    R1,HDRSZ(R1)             + HALF TBL HDR SIZE =  @Y17XANG 20910000
*                                       HALF TBL SIZE          @Y17XANG 20940000
         ST    R1,TTRCLNTH              STORE IN CONTROL AREA    X03039 20970000
         SR    R5,R1                    ADDRESS OF MIDDLE ENTRY  X03039 21000000
*                                       (LAST ENTRY IN 1ST HALF) X03039 21030000
         ST    R5,TTRCMIDL              STORE IN CONTROL AREA    X03039 21060000
         LOAD  EP=IEDNTR                LOAD PIU TRACE ROUTINE @Y17XANG 21090000
         ST    R0,TTRCRTNA-ONE          STORE TRACE ROUTINE    @XA07498 21120000
*                                       ... ADDR IN CONTROL AREA X03039 21150000
         L     R5,TTRCFRST              1ST ENTRY ADDRESS      @Y17XANG 21180000
         XC    0(HDRSZ,R5),0(R5)        CLEAR 1ST HALF HEADER  @Y17XANG 21210000
         MVC   0(L'TTRCID,R5),TTRCID    MOVE ID TO 1ST HALF HDR@Y17XANG 21240000
         L     R5,TTRCMIDL              2ND HALF TBL ADDR      @Y17XANG 21270000
         XC    ENTRYSZ(HDRSZ,R5),ENTRYSZ(R5) 2ND HALF HEADER   @Y17XANG 21300000
         MVC   ENTRYSZ(L'TTRCID,R5),TTRCID   MOVE ID TO 2ND    @Y17XANG 21330000
*                                            HALF HEADER.      @Y17XANG 21360000
         SPACE                                                          21390000
* CLEAR FIRST HALF TABLE.                                      @Y17XANG 21420000
         SPACE                                                          21450000
         SRL   R3,1                     #ENTRIES/2=HALF SIZE.  @Y17XANG 21480000
         LR    R1,R3                    LOOP COUNT             @Y17XANG 21510000
         L     R5,TTRCFRST              1ST HALF ADDRESS       @Y17XANG 21540000
         LA    R5,HDRSZ(R5)             BYPASS HEADER.         @Y17XANG 21570000
TBL1HLF  EQU   *                                               @Y17XANG 21600000
         XC    0(ENTRYSZ,R5),0(R5)      CLEAR ENTRY.           @Y17XANG 21630000
         LA    R5,ENTRYSZ(R5)           NEXT ENTRY             @Y17XANG 21660000
         BCT   R1,TBL1HLF               LOOP TILL CLEAR        @Y17XANG 21690000
         SPACE                                                          21720000
* CLEAR 2ND HALF TABLE.                                        @Y17XANG 21750000
         SPACE                                                          21780000
         LR    R1,R3                    LOOP COUNT             @Y17XANG 21810000
         L     R5,TTRCMIDL              2ND HALF ADDR-ENTRY    @Y17XANG 21840000
         LA    R5,ENTRYSZ+HDRSZ(R5)     1ST ENTRY ADDR         @Y17XANG 21870000
TBL2HLF  EQU   *                                               @Y17XANG 21900000
         XC    0(ENTRYSZ,R5),0(R5)      CLEAR ENTRY            @Y17XANG 21930000
         LA    R5,ENTRYSZ(R5)           NEXT ENTRY             @Y17XANG 21960000
         BCT   R1,TBL2HLF               LOOP TILL CLEAR        @PI02854 21990000
         SPACE                                                          22020000
* SET TRACE ACTIVE.                                            @Y17XANG 22050000
         SPACE                                                          22080000
         MVI   TTRCFLGS,TTRCTSYS        SET FLAG TO TRACE ALL  @Y17XANG 22110000
         DROP  R2                                                X03039 22140000
         SPACE 2                                                        22170000
         B     BRACKET                  CHECK FOR BRACKET      @X50X9NI 22200000
         EJECT                                                          22230000
*****************************************************************X01004 22260000
*        THIS ROUTINE ALLOCATES FOR PAGES TO BE USE FOR THE LINE*X01004 22290000
*        BUFFER POOL, MESSAGE QUEVE POOL, AND CPB POOL. THE CORE*X01004 22320000
*        GOTTEN WILL BE FIXED AT OPEN. THE CORE IS ALLOCATED AT *X01004 22350000
*        A BUFFER UNIT AT A TIME TO INSURE THAT NO BUFFERS WILL *X01004 22380000
*        CROSS PAGE BOUNDARIES.                                 *X01004 22410000
*****************************************************************X01004 22440000
*                                                               *X01004 22470000
*        INPUT:                                                 *X01004 22500000
*              REGISTER ONE CONTAINS THE NUMBER OF FIXED BYTES  *X01004 22530000
*                REQUESTED                                      *X01004 22560000
*              REGISTER 14 CONTAINS THE RETURN ADDRESS OF THE   *X01004 22590000
*                CALLER                                         *X01004 22620000
*                                                               *X01004 22650000
*        REGISTERS    0,11,3,& 15 ARE DESTROYED BEFORE RETURN   *X01004 22680000
*                                                               *X01004 22710000
GETFIXD  EQU   *                                                 X01004 22740000
         LR    R3,R1                    SAVE LENGTH REQUESTED    X01004 22770000
         L     R11,FREEPTR              GET ADDRESS OF CURRENT   X01004 22800000
*                                         UNUSED BLOCK           X01004 22830000
         LR    R1,R11                   ANY UNUSED CORE ALLOCATEDX01004 22860000
         L     R0,0(R1)                 GET LENGTH OF UNUSED     X01004 22890000
RECK     EQU   *                        UNUSED AREA LARGE ENOUGH X01004 22920000
         CR    R3,R0                      TO FILL REQUEST        X01004 22950000
         BH    FREEPAGE                 NO GET ANOTHER BLOCK     X01004 22980000
         AR    R11,R3                   BUMP TO FREE CORE        X01004 23010000
         SR    R0,R3                    GET NEW LENGTH           X01004 23040000
         LTR   R0,R0                    END OF PAGE              X01004 23070000
         BNZ   SETFRPTR                 NO, UPDATE STARTING PTR. X01004 23100000
         CLM   R11,AD,FREEPTR+FIVE      END OF GOTTEN CORE       X01004 23130000
         BE    RTRNCORE                 YES, SKIP UPDATE         X01004 23160000
SETFRPTR EQU   *                                                 X01004 23190000
         ST    R0,0(R11)                SET NEW LENGTH           X01004 23220000
         ST    R11,FREEPTR              UPDATE POINTER TO        X01004 23250000
*                                        AVAILABLE UNUSED CORE   X01004 23280000
RTRNCORE EQU   *                                                 X01004 23310000
         XC    0(FOUR,R1),0(R1)         RESET LENGTH BYTE IN AREAX01004 23340000
*                                         TO BE RETURNED         X01004 23370000
         BR    R14                      RETURN TO INVOKER        X01004 23400000
FREEPAGE EQU   *                                                 X01004 23430000
         LTR   R0,R0                    NEED TO FREEMAIN         X01004 23460000
         BZ    NOFREE                   N/, BRANCH               X01004 23490000
         AR    R11,R0                   BUMP TO FREE AREA        X01004 23520000
         FREEMAIN R,LV=(0),A=(1)        FREE UNUSABLE CORE       X01004 23550000
NOFREE   EQU   *                                                 X01004 23580000
         LR    R0,R6                    SET FREE LENGTH TO PAGE  X01004 23610000
*                                        SIZE                    X01004 23640000
         LR    R1,R11                   SET NEW START ADDRESS    X01004 23670000
         B     RECK                     ALLOCATE CORE            X01004 23700000
         EJECT                                                          23730000
BRACKET  EQU   *                        BRACKET PROCESSING     @X50X9NI 23760000
         TM    AVTSAVTF,AVTVTMCP        USING NCP SUPPORT      @G36XRNP 23790000
         BZ    COMMBUF                  NO,DONT LOAD BRACKT MGR@X50X9NI 23820000
         USING IEDNSVTD,R4                                     @X50X9NI 23850000
         L     R4,AVTSAVTP              ADDR SECONDARY AVT     @X50X9NI 23880000
         NC    SAVTBSM,SAVTBSM          WAS BRACKET=YES SPEC'D @X50X9NI 23910000
         BZ    COMMBUF                  NO,DONT LOAD BRKT MGR  @X50X9NI 23940000
         SPACE 1                                               @X50X9NI 23970000
         LOAD  EP=IEDBSM                LOAD BRACKET MANAGER   @YM06007 24000000
         SPACE 1                                               @X50X9NI 24030000
         ST    R0,SAVTBSM               STORE ADDR IN SEC. AVT @X50X9NI 24060000
         B     COMMBUF                  GO PROCESS COMMBUF     @X50X9NI 24090000
         SPACE 1                                               @X50X9NI 24120000
         DROP  R4                                              @X50X9NI 24150000
         EJECT                                                          24180000
* * * * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * X02004 24210000
*                                                                X02004 24240000
*        THIS SECTION OF CODE GETMAINS AN AREA OF MAIN STORAGE   X02004 24270000
*        FOR THE COMMON BUFFER MASTER QCB, STCBS, AND DATA AREAS.X02004 24300000
*        IT ALSO INITIALIZES FIELDS IN THE MASTER QCB            X02004 24330000
*                                                                X02004 24360000
* * * * * * * * * * * * * * * * * * * * * * * * *  * * * * * * * X02004 24390000
*                                                                X02004 24420000
COMMBUF  EQU   *                                                 X02004 24450000
         XC    FREEPTR,FREEPTR          CLEAR POINTER TO AVAIL.  X02004 24480000
*                                       CORE FOR COMMBUF GETMAINSX02004 24510000
         TM    AVTSCOPT,AVTCMBUF        IS COMMON BUFFER         X02004 24540000
*                                         TRANSMISSION TO BE USEDX02004 24570000
         BZ    CROSSREF                 BRANCH IF NOT            X02004 24600000
         SR    R10,R10                  CLEAR REGISTERS          X02004 24630000
         SR    R4,R4                      FOR                    X02004 24660000
         SR    R1,R1                      SAVING VALUES          X02004 24690000
         LH    R4,AVTCBQCB              GET NUMBER OF STCB'S     X02004 24720000
         LH    R10,AVTCBQCB+2           GET NUMBER OF DATA AREAS X02004 24750000
         LH    R1,AVTCMBSS+2            GET DATA AREA SIZE       X02004 24780000
         LR    R2,R1                    SAVE DATA AREA SIZE      X02004 24810000
         LA    R1,TWELVE(R0)            ADD 12 FOR PREFIX        X02004 24840000
         LR    R11,R4                   SAVE NUMBER OF STCB'S    X02004 24870000
         LR    R5,R10                   SAVE NO. DATA AREAS      X02004 24900000
         MR    R0,R10                   MULTIPLY DATA AREA SIZE  X02004 24930000
*                                         BY NO. DATA AREAS      X02004 24960000
         LA    R8,EIGHT                 GET SIZE OF AN STCB      X02004 24990000
         MR    R10,R8                   MULTIPLY BY NO. STCB'S   X02004 25020000
         AR    R1,R11                   ADD STCB'S TO DATA AREA  X02004 25050000
         LA    R1,MQCBSIZE(R1)          ADD SIZE OF MASTER QCB   X02004 25080000
         LR    R3,R1                    SAVE SIZE OF GETMAIN AREAX02004 25110000
         LA    R0,AVTCBQCB              LOAD THE ADDRESS OF THE  X02004 25140000
*                                         AREA TO HOLD THE ADDR  X02004 25170000
*                                         OF THE MASTER QCB      X02004 25200000
         BAL   R14,AVTPAR               BRANCH TO GETMAIN ROUTINEX02004 25230000
         L     R14,AVTCBQCB             GET ADDRESS OF MASTER QCBX02004 25260000
         LR    RCMB,R14                 GET ADDRESS OF MASTER QCBX02004 25290000
CMBCLEAR EQU   *                                                 X02004 25320000
         MVI   0(R14),AVTEZERO          CLEAR ONE BYTE           X02004 25350000
         LA    R14,ONE(R14)             INCREMENT THE COMMON     X02004 25380000
*                                         BUFFER AREA ADDRESS    X02004 25410000
         BCT   R3,CMBCLEAR              DECREMENT THE COUNT      X02004 25440000
         MVI   8(RCMB),VTO              MOVE IN OFFSET           X02004 25470000
         STH   R4,CMBASTCB              STORE AVAILABLE STCB'S   X02004 25500000
         STH   R5,CMBDAREA              STORE NO. OF DATA AREAS  X02004 25530000
         STH   R2,CMBSIZE               STORE DATA AREA SIZE     X02004 25560000
         LR    R7,R4                    GET NO. AVAIABLE STCB'S  X02004 25590000
         LA    R4,MQCBSIZE(RCMB)        POINT TO FIRST STCB      X02004 25620000
         BCTR  R7,R0                    SUBTRACT 1 FROM NO. STCB X02004 25650000
         ST    R4,CMBFLAG1              STORE ADDR OF FIRST STCB X02004 25680000
         LA    R3,8(R4)                 GET ADDR OF NEXT STCB    X02004 25710000
         ST    R3,CMBPRI                STORE ADDR OF NEXT STCB  X02004 25740000
         MVI   4(RCMB),PRIORITY         MOVE IN PRIORITY         X02004 25770000
STCBINIT EQU   *                                                 X02004 25800000
         LR    R3,R4                    GET ADDR OF FIRST STCB   X02004 25830000
         LA    R4,8(R4)                 POINT TO NEXT STCB       X02004 25860000
         ST    R4,4(R3)                 STORE ADDR IN LINK FIELD X02004 25890000
         BCT   R7,STCBINIT              SUBTRACT 1 FROM NO. STCB X02004 25920000
         LA    R4,8(R4)                 POINT TO FIRST DATA AREA X02004 25950000
*                                         PREFIX                 X02004 25980000
         ST    R4,CMBFIRST-1            STORE ADDRESS OF FIRST   X02004 26010000
*                                         DATA AREA PREFIX       X02004 26040000
         ST    R4,CMBNEXT-1             STORE ADDR OF NEXT       X02004 26070000
*                                         DATA AREA PREFIX       X02004 26100000
         SR    R3,R3                    CLEAR INDEX              X02004 26130000
         SR    R0,R0                    CLEAR FOR DIVIDE         X02004 26160000
         LA    R1,EIGHT(R2)             COPY DATA AREA SIZE PLUS X02004 26190000
*                                       CONTRL INFO              X02004 26220000
         DR    R0,R6                    DIVIDE BUFFER SIZE BY    X02004 26250000
*                                       PAGE SIZE.               X02004 26280000
         SLL   R1,THREE                 MULTIPLY BY EIGHT FOR    X02004 26310000
*                                       INDIRECT ADDRESS ENTRY   X02004 26340000
*                                       FOR EACH PAGE THE        X02004 26370000
*                                       COMMBUF SPANS            X02004 26400000
         LA    R1,EIGHT(R1,R2)          TOTAL LENGTH NEEDED FOR  X02004 26430000
*                                       EACH BUFFER              X02004 26460000
         LA    R1,ROUND(R1)             ROUND UP TO DOUBLE WORD  X02004 26490000
         SRL   R1,THREE                 BOUNDARY                 X02004 26520000
         SLL   R1,THREE                                          X02004 26550000
         LR    R7,R1                    SAVE BUFFER LENGTH       X02004 26580000
COM0     EQU   *                        LOOP TO GET BUFFERS      X02004 26610000
         LA    R11,FREEPTR              ADDR. OF AVAIL. CORE     X02004 26640000
         NC    0(FOUR,R11),0(R11)       CHAIN EMPTY              X02004 26670000
         BZ    COM2                     YES, ISSUE GETMAIN       X02004 26700000
COM1     EQU   *                        LOOP THRU GOTTEN CORE    X02004 26730000
         LR    R10,R11                  SAVE OLD CHAIN POINTER   X02004 26760000
         L     R11,0(R11)               GET NEW POINTER          X02004 26790000
         CLM   R7,AD,FIVE(R11)          REQUEST SATISFIED        X02004 26820000
         BNH   COM8                     YES, BRANCH              X02004 26850000
         CLC   0(FOUR,R11),AVTFZERO     END OF CHAIN             X02004 26880000
         BNE   COM1                     NO, BUMP TO NEXT AVAIL.  X02004 26910000
COM2     EQU   *                        GET MORE CORE            X02004 26940000
         LA    R0,0(R11)                ADDR. FOR GETMAIN        X02004 26970000
         SR    R1,R1                    CLEAR FOR LENGTH INSERT  X02004 27000000
COM3     EQU   *                                                 X02004 27030000
         AR    R1,R6                    ADD PAGE TO LENGTH       X02004 27060000
         CR    R1,R7                    LENGTH LARGER THAN REQ.  X02004 27090000
         BL    COM3                     NO, ADD ANOTHER PAGE     X02004 27120000
         BAL   R14,AVTPAR1              GETMAIN FOR BUFFER       X02004 27150000
         LM    R15,R0,AVTGETMN          LENGTH AND ADDRESS FROM  X02004 27180000
*                                       GETMAIN.                 X02004 27210000
         LR    R1,R15                   COPY LENGTH              X02004 27240000
         L     R14,0(R11)               ADDRESS OF GOTTEN CORE   X02004 27270000
         LR    R10,R11                  UPDATE OLD CHAIN POINTER X02004 27300000
         LR    R11,R14                  SET NEW CHAIN POINTER    X02004 27330000
COM4     EQU   *                        LOPP TO CLEAR BUFFER     X02004 27360000
         MVI   0(R14),AVTEZERO          CLEAR ONE BYTE           X02004 27390000
         LA    R14,ONE(R14)             BUMP TO NEXT BYTE        X02004 27420000
         BCT   R15,COM4                 CLEAR NEXT BYTE          X02004 27450000
COM5     EQU   *                        UPDATE FREE CORE IN THIS X02004 27480000
*                                       BLOCK OF UNUSED CORE     X02004 27510000
         SR    R1,R7                    FIND CORE TO REMAIN FREE X02004 27540000
         BZ    COM6                     REQUEST EQUAL AVAIL.     X02004 27570000
         LA    R15,0(R7,R11)            BUMP TO AVAIL. CORE      X02004 27600000
         ST    R1,FOUR(R15)             UPDATE AVAIL. IN BLOCK   X02004 27630000
COM6     EQU   *                                                 X02004 27660000
         ST    R15,0(R10)               REMOVE BLOCK FROM CHAIN  X02004 27690000
*                                       IF REQUEST EQUAL AVAIL.  X02004 27720000
*                                       OR UPDATE CHAIN IF NOT   X02004 27750000
         LR    R10,R7                   COPY LENGTH REQUESTED    X02004 27780000
         LR    R15,R2                   COPY BUFFER LENGTH       X02004 27810000
         LA    R15,ROUND(R15)           ROUND UP TO DOUBLE WORD  X02004 27840000
         SRL   R15,THREE                BOUNDARY                 X02004 27870000
         SLL   R15,THREE                                         X02004 27900000
         SR    R10,R15                  OFFSET TO BUFFER         X02004 27930000
         LA    R10,0(R10,R11)           ADDRESS OF BUFFER        X02004 27960000
         ST    R10,0(R4)                STORE BUFFER ADDRESS IN  X02004 27990000
*                                       PREFIX                   X02004 28020000
         STC   R3,0(R4)                 STORE INDEX IN PREFIX    X02004 28050000
         LR    R15,R2                   COPY BUFFER LENGTH       X02004 28080000
         SH    R15,HSIX                 SUBTRACT LENGTH OF HEADERX02004 28110000
         STH   R15,0(R10)               STORE LENGTH IN BUFFER   X02004 28140000
         LA    R0,SIX(R10)              GET START OF DATA AREA   X02004 28170000
         SH    R10,H8                   INDIRECT ADDR. POINTER @Y17XANG 28200000
         ST    R7,FOUR(R10)             SAVE TOTAL LENGTH FOR    X02004 28230000
*                                       PAGE FIX IN OPEN         X02004 28260000
         ST    R11,0(R10)               ASSUME INDIRECT ADDR.    X02004 28290000
         OI    0(R10),CCWIDA            SET INDIRECT ADDR. FLAG  X02004 28320000
COM7     EQU   *                                                 X02004 28350000
         LR    R14,R0                   COPY DATA AREA ADDRESS   X02004 28380000
         LR    R1,R6                    COPY PAGE SIZE           X02004 28410000
         BCTR  R1,R0                    SUBTRACT ONE FROM PAGE   X02004 28440000
         NR    R1,R14                   MASK TO GET DATA AREA    X02004 28470000
*                                       OFFSET IN PAGE           X02004 28500000
         XR    R0,R1                    GET START OF PAGE        X02004 28530000
         AR    R1,R15                   OFFSET INTO PAGE PLUS    X02004 28560000
*                                       LENGTH IN BUFFER         X02004 28590000
         SR    R1,R6                    SUBTRACT PAGE SIZE       X02004 28620000
         ST    R14,0(R11)               SET INDIRECT ADDRESS PTR X02004 28650000
*                                       IF NO IDA IS NEEDED R11  X02004 28680000
*                                       WILL EQUAL R10 AND THE   X02004 28710000
*                                       IDA FLAG WILL BE TURNED  X02004 28740000
*                                       OFF BY THIS STORE        X02004 28770000
         BNP   COM9                     NO IDA                   X02004 28800000
         LR    R15,R1                   SET NEW LENGTH           X02004 28830000
         AR    R0,R6                    BUMP DATA ADDRESS TO     X02004 28860000
*                                       NEXT PAGE.               X02004 28890000
         LA    R11,FOUR(R11)            BUMP IDA LIST POINTER    X02004 28920000
         B     COM7                     BUILD NEXT IDA           X02004 28950000
COM8     EQU   *                        NEW GETMAIN NOT NEEDED   X02004 28980000
         L     R1,FOUR(R11)             GET LENGTH AVAIL. IN PAGEX02004 29010000
         B     COM5                     REMOVE CORE FROM AVAIL.  X02004 29040000
COM9     EQU   *                        BUMP TO NEXT BUFFER      X02004 29070000
         LA    R3,ONE(R3)               BUMP INDEX               X02004 29100000
         LA    R4,TWELVE(R4)            BUMP TO NEXT PREFIX      X02004 29130000
         BCT   R5,COM0                  GET NEXT BUFFER          X02004 29160000
*              ALL BUFFERS GOTTEN                                X02004 29190000
         BCTR  R3,R0                    ADJUST INDEX BYTE        X02004 29220000
         SH    R4,HSIX                  ADJUST PREFIX POINTER    X02004 29250000
         SH    R4,HSIX                                           X02004 29280000
         ST    R4,CMBLAST-ONE           STORE ADDR. OF LAST      X02004 29310000
         STC   R3,CMBLINDX              STORE INDEX BYTE         X02004 29340000
         SPACE 5                                                        29370000
         LA    R2,FREEPTR               ADDR. UNUSED CORE        X02004 29400000
COMEND   EQU   *                                                 X02004 29430000
         ICM   R1,ALL,0(R2)             CORE TO FREE             X02004 29460000
         BZ    CROSSREF                 NO, BRANCH               X02004 29490000
         LR    R2,R1                    UPDATE UNUSED CORE PTR   X02004 29520000
         ICM   R0,ALL,FOUR(R1)          LENGTH TO FREE           X02004 29550000
         BZ    COMEND                   EMPTY, SKIP FREEMAIN     X02004 29580000
         FREEMAIN R,LV=(0),A=(1)        FREE UNUSED CORE         X02004 29610000
         B     COMEND                   FREE NEXT BLOCK          X02004 29640000
         EJECT                                                          29670000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       29700000
*                                                                       29730000
*        THIS SECTION OF CODE GETMAINS AN AREA OF MAIN STORAGE          29760000
*        FOR A USER REQUESTED CROSS REFERENCE TABLE                     29790000
*                                                                       29820000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       29850000
*                                                                       29880000
CROSSREF EQU   *                                                        29910000
         L     R1,AVTCRSRF              GET NO. CROSSRF ENTRIES         29940000
         LTR   R4,R1                    ANY ENTRIES REQUESTED           29970000
         BZ    NEXT                       NO, EXIT                      30000000
         SLL   R1,FOUR                  MULTIPLY THE NUMBER OF          30030000
*                                         ENTRIES BY 16                 30060000
         LA    R1,8(,R1)                ADD 8 ADDITIONAL BYTES TO       30090000
*                                         THE CROSS REFERENCE TABLE     30120000
         LA    R0,AVTCRSRF              LOAD THE ADDRESS OF THE         30150000
*                                         AREA TO HOLD THE ADDRESS      30180000
*                                         OF THE TABLE                  30210000
         BAL   R14,AVTPAR               BRANCH TO GETMAIN ROUTINE       30240000
*                                                                       30270000
         L     R3,AVTCRSRF              LOAD THE ADDRESS OF THE TABLE   30300000
         LA    R1,EIGHT(R3)             SET THE ADDRESS POINTER TO      30330000
*                                         THE FIRST ENTRY               30360000
         ST    R1,0(R3)                 SET THE FIRST AVAILABLE         30390000
*                                         ENTRY ADDRESS                 30420000
REFCLEAR EQU   *                                                        30450000
         LA    R7,ENTRYSIZ(R1)          LOAD THE ADDRESS OF THE         30480000
*                                         NEXT AVAILABLE ENTRY          30510000
         XC    0(ENTRYSIZ,R1),0(R1)     CLEAR AN ENTRY IN THE TABLE     30540000
         ST    R7,0(R1)                 STORE THE ENTRY CHAINING        30570000
*                                         ADDRESS                       30600000
         LA    R1,ENTRYSIZ(R1)          SET THE ADDRESS POINTER TO      30630000
*                                         THE NEXT ENTRY                30660000
         BCT   R4,REFCLEAR              DECREMENT THE COUNT AND         30690000
*                                         BRANCH                        30720000
         LA    R4,ENTRYSIZ              LOAD THE SIZE OF AN ENTRY       30750000
         SR    R1,R4                    SET THE ADDRESS OF THE LAST     30780000
*                                         ENTRY IN THE TABLE            30810000
         ST    R1,4(,R3)                STORE THE ADDRESS OF THE        30840000
*                                         LAST ENTRY                    30870000
NEXT     EQU   *                                                        30900000
         L     RTNT,AVTRNMPT            LOAD THE ADDRESS OF THE         30930000
*                                         TERMNAME TABLE                30960000
         SR    RLEN,RLEN                CLEAR THE LENGTH REGISTER       30990000
         IC    RLEN,TNTENLEN            INSERT THE LENGTH OF EACH       31020000
*                                         TERMNAME ENTRY                31050000
         BCTR  RLEN,0                   SUBTRACT ONE TO EXECUTE         31080000
*                                         THE COMPARISON                31110000
         L     R1,TNTENLEN              LOAD ADDRESS OF LAST ENTRY      31140000
*                                         IN TERMNAME TABLE             31170000
         LA    R1,ONE(R1)               CLEAR HIGH ORDER BYTE OF        31200000
*                                         ADDRESS OF LAST ENTRY         31230000
         LA    RFIRST,TNTFIRST          ADDRESS OF FIRST ENTRY IN       31260000
*                                         TERMNAME TABLE                31290000
         EJECT                                                          31320000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       31350000
*                                                                       31380000
*        THIS NEXT SECTION OF CODE WILL CALCULATE THE TOTAL             31410000
*        NUMBER OF ENTRIES IN THE TERMNAME TABLE                 S22024 31440000
*                                                                       31470000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       31500000
*                                                                       31530000
         SR    R1,RFIRST                SUBTRACT THE ADDRESS OF THE     31560000
*                                         FIRST ENTRY FROM THE          31590000
*                                         ADDRESS OF THE LAST ENTRY     31620000
         SR    R0,R0                    CLEAR DIVIDE REGISTER           31650000
         LA    R3,4(RLEN)               LENGTH OF ENTRY NAME AND ADDR   31680000
         DR    R0,R3                    DIVIDE THE LENGTH OF TABLE      31710000
*                                         BY THE LENGTH OF AN ENTRY     31740000
         LA    R1,ONE(R1)               ADD ONE TO THE RESULT TO        31770000
*                                         GET THE ACTUAL NUMBER         31800000
*                                         OF ENTRIES                    31830000
         STH   R1,TNTLEN                STORE THE TOTAL NUMBER OF       31860000
*                                         TERMNAME ENTRIES              31890000
*                                         IN THE TERMNAME TABLE         31920000
         LA    R3,ONE                   LOAD A COMPARISON VALUE         31950000
         CR    R3,R1                    TEST FOR JUST ONE ENTRY IN      31980000
*                                         THE TERMNAME TABLE            32010000
         BNE   NOTONE                   BRANCH IF MORE THAN    @YM08559 32040000
*                                       ONE ENTRY              @YM08559 32070000
         LA    R6,ONE(RLEN,RFIRST)      BUMP TO ADDRESS PORTION@OY14517 32100000
*                                       OF ENTRY               @OY14517 32130000
         NI    TWO(R6),RESTLOW          RESET LOW ORDER BIT    @OY14517 32160000
         B     PRIMOPT                  BRANCH TO SET UP       @OY14517 32190000
*                                       TERMNAME TABLE         @OY14517 32220000
NOTONE   EQU   *                                               @OY14517 32250000
         SLL   R1,ONE                   MULTIPLY ENTRIES BY 2 TO        32280000
*                                         GET SIZE OF OFFSET TABLE      32310000
         ST    R1,AVTSAVE4+12           SAVE LENGTH FOR FREEMAIN        32340000
         LA    R0,AVTSAVE4+16           LOAD RECEIVING ADDRESS          32370000
*                                         RECEIVE THE ADDRESS OF        32400000
*                                         THE GETMAINED AREA            32430000
         BAL   R14,AVTPAR               SET UP PARAMETER LIST           32460000
*                                                                       32490000
         L     RGETAREA,AVTSAVE4+16     LOAD THE ADDRESS OF THE         32520000
*                                         OFFSET TABLE                  32550000
         LA    R2,ONE                   FIRST OFFSET VALUE              32580000
         LH    R1,TNTLEN                NUMBER TERMNAME TABLE ENTRIES   32610000
*                                         TERMNAME ENTRIES              32640000
OFFSTORE EQU   *                                                        32670000
         STH   R2,0(RGETAREA)           STORE FIRST/NEXT VALUE IN       32700000
*                                         THE OFFSET TABLE              32730000
         BCT   R1,UPDATE                REDUCE NUMBER OF ENTRIES        32760000
*                                         BY ONE                        32790000
         EJECT                                                          32820000
FIRSTENT EQU   *                                                        32850000
         LR    RPRESENT,RFIRST          ADDRESS OF THE FIRST ENTRY      32880000
*                                         IN THE TERMNAME TABLE         32910000
         LA    RTRM,4(RLEN,RFIRST)      ADDRESS OF THE SECOND ENTRY     32940000
*                                         IN THE TERMNAME TABLE         32970000
         L     ROTNOW,AVTSAVE4+16       LOAD ADDRESS OF OFFSET TABLE    33000000
         LA    ROTNEXT,2(ROTNOW)        LOAD THE ADDRESS OF THE         33030000
*                                         SECOND ENTRY IN OFFSET TBL    33060000
         MVI   AVTGETMN,NOSWAP          CLEAR THE SWAP INDICATOR        33090000
         LA    R3,3(RLEN)               GET THE LENGTH OF THE           33120000
*                                         ENTRY NAME AND ADDRESS        33150000
*                                         MINUS 1                       33180000
EXECT    EX    RLEN,COMPENT             EXECUTE A COMPARISON OF THE     33210000
*                                         TWO TERMNAME ENTRIES          33240000
         BNH   COMTAB                   THE TWO ENTRIES ARE IN          33270000
*                                         ALPHABETICAL ORDER            33300000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       33330000
*                                                                       33360000
*        SWAPPING ROUTINE                                               33390000
*                                                                       33420000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       33450000
*                                                                       33480000
         EX    R3,EX1                   SWAP THE TWO                    33510000
         EX    R3,EX2                     ENTRIES IN THE                33540000
         EX    R3,EX1                     TERMNAME TABLE                33570000
*                                                                       33600000
         XC    0(TWO,ROTNOW),0(ROTNEXT) SWAP THE TWO                    33630000
         XC    0(TWO,ROTNEXT),0(ROTNOW)   ENTRIES IN THE                33660000
         XC    0(TWO,ROTNOW),0(ROTNEXT)   OFFSET TABLE                  33690000
*                                                                       33720000
         MVI   AVTGETMN,SWAP            SET SWAP INDICATOR              33750000
*                                                                       33780000
COMTAB   EQU   *                                                        33810000
         L     R1,TNTENLEN              LAST ENTRY IN TERMNAME TABLE    33840000
         LA    R1,0(R1)                 CLEAR HIGH ORDER BYTE           33870000
         CR    RTRM,R1                  CHECK FOR END OF THE            33900000
*                                         TERMNAME TABLE                33930000
         BNL   CHKSWAP                  IF END OF TABLE, GO TO          33960000
*                                         CHECK SWAP INDICATOR          33990000
         LR    RPRESENT,RTRM            UPDATE POINTER TO TERMNAME      34020000
*                                         ENTRY N                       34050000
         LA    RTRM,4(RLEN,RTRM)        UPDATE POINTER TO TERMNAME      34080000
*                                         ENTRY N+1                     34110000
         LR    ROTNOW,ROTNEXT           UPDATE PRESENT OFFSET POINTER   34140000
         LA    ROTNEXT,TWO(ROTNEXT)     UPDATE NEXT OFFSET POINTER      34170000
         B     EXECT                    COMPARE NEXT 2 ENTRIES          34200000
*                                                                       34230000
UPDATE   EQU   *                                                        34260000
         LA    RGETAREA,2(RGETAREA)     BUMP POINTER TO THE             34290000
*                                         OFFSET TABLE BY TWO           34320000
         LA    R2,ONE(R2)               BUMP INDEX BY ONE               34350000
         B     OFFSTORE                 STORE OFFSET IN OFFSET TABLE    34380000
*                                                                       34410000
CHKSWAP  TM    AVTGETMN,SWAP            TEST SWAP INDICATOR             34440000
         BO    FIRSTENT                 GO THRU TABLE ONCE MORE         34470000
         EJECT                                                          34500000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       34530000
*                                                                       34560000
*        THIS SECTION OF CODE STORES NEW VALUES INTO THE ALTERNATE      34590000
*        TERMINAL OFFSET FIELD IN THE TERMINAL TABLE AND TESTS THE      34620000
*        STATUS OF EACH TERMINAL LISTED AS AN ALTERNATE DESTINATION     34650000
*                                                                       34680000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       34710000
*                                                                       34740000
         LH    R6,TNTLEN                NUMBER TERMNAME TABLE ENTRIES   34770000
         MVI   AVTGETMN,NOSWAP          ZERO HIGH ORDER BYTE            34800000
*                                                                       34830000
ALTSET   EQU   *                                                        34860000
         LA    R1,MSGC                  ADDRESS OF THE ERROR MESSAGE    34890000
         EX    RLEN,ERRSET              USE AN EXECUTE TO MOVE THE      34920000
*                                         TERMINAL NAME TO THE          34950000
*                                         ERROR MESSAGE                 34980000
         LA    RFIRST,1(RLEN,RFIRST)    BUMP THE POINTER TO THE         35010000
*                                         ADDRESS PORTION OF THE        35040000
*                                         ENTRY                         35070000
         TM    TWO(RFIRST),LOWBIT       LOW ORDER BIT IN ADDR  @G36XRNP 35100000
         BZ    PROCNOR                  NO, PROCESS NORMALLY   @G36XRNP 35130000
         NI    TWO(RFIRST),RESTLOW      RESET LOW ORDER BIT    @G36XRNP 35160000
         B     FOUNDMAT                 BRANCH FOR NEXT ENTRY  @G36XRNP 35190000
PROCNOR  EQU   *                                               @G36XRNP 35220000
         MVC   AVTGETMN+1(3),0(RFIRST)  MOVE TERMINAL TABLE             35250000
*                                         ADDRESS OF ENTRY INTO         35280000
*                                         A SCRATCH WORD                35310000
         L     RTRM,AVTGETMN            LOAD ADDRESS OF TERM. ENTRY     35340000
         TM    TRMSTATE,SINGLINE        TEST ENTRY TYPE                 35370000
         BO    LOADAD                   LOG ENTRY                       35400000
         BNZ   CHKCORD                  BRANCH ON NO             S22024 35430000
         TM    TRMOUTSQ,LGB             IS THIS AN LGB           S22024 35460000
         BO    FOUNDMAT                 BRANCH ON YES - IGNORE   S22024 35490000
         B     TESTLIST                 SINGLE OR LINE ENTRY     S22024 35520000
CHKCORD  EQU   *                                                 S22024 35550000
         TM    TRMSTATE,CORDLIST        IS THIS ENTRY EITHER A          35580000
*                                         CASCADE OR A DISTRIBUTION     35610000
*                                         LIST ENTRY                    35640000
         BO    CASDISTL                 GO TO UPDATE ANY CASCADE OR     35670000
*                                       DISTRIBUTION LIST ENTRIES       35700000
ALTDTEST EQU   *                                                        35730000
         CLC   TRMALTD(2),AVTFZERO      HAS AN ALTERNATE DESTINATION    35760000
*                                         BEEN SPECIFIED                35790000
         BE    FOUNDMAT                 NO, BRANCH                      35820000
*                                                                       35850000
LOADAD   EQU   *                                                        35880000
         L     R1,AVTSAVE4+16           LOAD THE BEGINNING ADDRESS      35910000
*                                         OF THE OFFSET TABLE           35940000
         LR    R0,R1                    COPY THE BEGINNING ADDRESS      35970000
*                                                                       36000000
CLCOFF   EQU    *                                                       36030000
         CLC   TRMALTD(2),0(R1)         COMPARE THE ALTERNATE           36060000
*                                         DESTINATION OFFSET TO THE     36090000
*                                         FIRST/NEXT ENTRY IN THE       36120000
*                                         OFFSET TABLE                  36150000
         BNE   ENDTAB                   CHECK FOR END OF THE            36180000
*                                         OFFSET TABLE                  36210000
         SR    R1,R0                    PICK UP THE OFFSET FROM         36240000
*                                         START OF OFFSET TABLE         36270000
         LA    R1,TWO(R1)               ADD 2 TO THE DIFFERENCE         36300000
         SRL   R1,ONE                   DIVIDE BY TWO TO GET NEW        36330000
*                                         INDEX FOR ALTERNATE           36360000
         STH   R1,TRMALTD               STORE THE NEW ALTERNATE         36390000
*                                         DESTINATION OFFSET IN THE     36420000
*                                         TERMINAL ENTRY                36450000
         TM    AVTGETMN,ILISTNOW        ARE WE CURRENTLY SORTING AN     36480000
*                                         INVITATION LIST               36510000
         BO    ALCONT                   YES, BRANCH                     36540000
         TM    AVTGETMN,CDLSTNOW        ARE WE CURRENTLY SORTING A      36570000
*                                         CASCADE OR A DISTRIBUTION     36600000
*                                         LIST                          36630000
         BO    CASDIST2                 YES, BRANCH                     36660000
         TM    TRMSTATE,LOGTYPE         IS THIS A LOG ENTRY             36690000
         BO    SETLOG                   YES, BRANCH                     36720000
         LA    RTRM,TNTFIRST            SET THE ADDRESS OF THE FIRST    36750000
*                                         ENTRY IN THE TERMNAME         36780000
*                                         TABLE                         36810000
         BCTR  R1,0                     SUBTRACT 1 FROM OFFSET VALUE    36840000
         LTR   R1,R1                    IS ALTERNATE DESTINATION        36870000
*                                       THE FIRST ENTRY IN TABLE        36900000
         BZ    ENTRY1                   YES, BRANCH                     36930000
*                                                                       36960000
LOOP     EQU   *                                                        36990000
         LA    RTRM,4(RLEN,RTRM)        GO THROUGH TERMNAME TABLE       37020000
         BCT   R1,LOOP                  GO TO NEXT ENTRY                37050000
*                                                                       37080000
ENTRY1   EQU   *                                                        37110000
         LA    RTRM,1(RLEN,RTRM)        BUMP THE POINTER TO THE         37140000
*                                         ADDRESS PORTION OF THE        37170000
*                                         ENTRY                         37200000
         MVC   AVTGETMN+1(3),0(RTRM)    MOVE TERMINAL TABLE             37230000
*                                         ADDRESS OF ENTRY INTO A       37260000
*                                         SCRATCH WORD                  37290000
         L     RTRM,AVTGETMN            LOAD THE ADDRESS OF THE         37320000
*                                         TERMINAL ENTRY                37350000
         TM    TRMSTATE,TRMACPTN        IS THIS TERMINAL ABLE TO        37380000
*                                         ACCEPT                        37410000
         BNO   TERMERR                  UNABLE TO ACCEPT                37440000
*                                                                       37470000
FOUNDMAT EQU   *                                                        37500000
         LA    RFIRST,3(RFIRST)         BUMP TERMINAL I.D. POINTER      37530000
*                                         TO NEXT ENTRY                 37560000
         BCT   R6,ALTSET                REDUCE ENTRY COUNT AND GO       37590000
*                                         TO NEXT ID ENTRY              37620000
*                                                                       37650000
         TM    AVTGETMN,ALTDSTER        HAVE WE DETECTED ANY ERRORS     37680000
*                                         WHILE RESETTING THE           37710000
*                                         ALTERNATE DESTINATIONS        37740000
         BO    TERMERR1                 YES, BRANCH                     37770000
         EJECT                                                          37800000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       37830000
*                                                                       37860000
*        THIS ROUTINE SETS UP CERTAIN FIELDS IN THE FIRST OF THE        37890000
*        TERMNAME TABLE NECESSARY FOR THE BINARY SEARCH ROUTINE         37920000
*                                                                       37950000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       37980000
*                                                                       38010000
PRIMOPT  EQU   *                                                        38040000
         SR    R6,R6                    CLEAR POWER COUNTER             38070000
         LH    R1,TNTLEN                LOAD THE TOTAL NUMBER OF        38100000
*                                         ENTRIES IN THE TABLE          38130000
         LR    R2,R1                    COPY THE ENTRY COUNT            38160000
*                                                                       38190000
TNTLOOP  EQU   *                                                        38220000
         SRL   R1,ONE                   DIVIDE ENTRIES BY 2             38250000
         LA    R6,ONE(R6)               INCREMENT THE POWER OF 2        38280000
*                                         COUNTER BY 1                  38310000
         LTR   R1,R1                    TEST FOR ZERO                   38340000
         BNZ   TNTLOOP                  DIVIDE IS NOT FINISHED          38370000
         LA    R1,ONE                   PRIME OPTIMUM ENTRY COUNTER     38400000
*                                                                       38430000
TNTLOOP2 EQU   *                                                        38460000
         SLL   R1,ONE                   MULTIPLY ENTRIES BY 2           38490000
         BCT   R6,TNTLOOP2              REDUCE POWER COUNTER BY ONE     38520000
         LR    R6,R1                    COPY OPTIMUM+1 NUMBER           38550000
         SRL   R1,ONE                   DIVIDE OPTIMUM+1 NUMBER BY      38580000
*                                         TWO                           38610000
         BCTR  R1,0                     SUBTRACT 1 FROM THE RESULT      38640000
         SRL   R6,SHIFT2                DIVIDE OPTIMUM BY 4             38670000
         STH   R6,TNTSRCHX              STORE SEARCH EXTENT FACTOR      38700000
         SR    R15,R15                  CLEAR ENTRY LENGTH REGISTER     38730000
         IC    R15,TNTENLEN             SAVE ENTRY LENGTH               38760000
         LA    RFIRST,TNTFIRST          ADDRESS OF THE FIRST ENTRY      38790000
*                                         IN THE TERMNAME TABLE         38820000
         LTR   R6,R6                    TEST FOR 1 ENTRY                38850000
         BNZ   TERMAD                   THERE IS MORE THAN 1 ENTRY      38880000
*                                                                       38910000
TERMSTOR EQU   *                                                        38940000
         ST    RFIRST,TNTENLEN          STORE IN THE TERMNAME TABLE     38970000
         STC   R15,TNTENLEN             RESTORE ENTRY LENGTH            39000000
         B     SORTLINE                 GO ESTABLISH GROUP LINE@Y17XANG 39030000
*                                       HIERARCHY.             @Y17XANG 39060000
TERMAD   EQU   *                                                        39090000
         LA    RFIRST,4(RLEN,RFIRST)    BUMP THE ADDRESS                39120000
         BCT   R1,TERMAD                BUMP THE POINTER AGAIN          39150000
         B     TERMSTOR                 STORE THE ADDRESS OF THE        39180000
         EJECT                                                          39210000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       39240000
*                                                                       39270000
*        THIS SECTION OF CODE RESETS THE TERMNAME OFFSETS               39300000
*        FOR ALL ENTRIES IN EITHER A CASCADE OR A DISTRIBUTION          39330000
*        LIST                                                           39360000
*                                                                       39390000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       39420000
*                                                                       39450000
CASDISTL EQU   *                                                        39480000
         BCTR  RTRM,0                   DECREMENT BEGINNING ADDRESS OF  39510000
         BCTR  RTRM,0                     LIST BY TWO                   39540000
         LH    R3,SIX(RTRM)             LOAD THE NUMBER OF ENTRIES      39570000
         OI    AVTGETMN,CDLSTNOW        SET A FLAG TO INDICATE THAT     39600000
*                                         WE ARE CURRENTLY SORTING      39630000
*                                         A CASCADE OR DISTRIBUTION     39660000
*                                         LIST                          39690000
         B     LOADAD                   SET OFFSET TABLE ADDRESSES      39720000
*                                                                       39750000
CASDIST2 EQU   *                                                        39780000
         LR    R2,R15                   SAVE REG.                S22026 39810000
         L     R15,AVTRNMPT             ADDR OF TNT CODE         S22026 39840000
         BALR  R14,R15                  GET TRM ENTRY ADDRESS    S22026 39870000
         N     R1,LOWOFF                TURN OFF LOW ORDER BIT @OY12967 39900000
         L     R14,TRMDESTQ-IEDQTRM-1(R1) GET QCB ADDR           S22026 39930000
         LR    R15,R2                   RESTORE REG.             S22026 39960000
         TM    QCBDSFLG-IEDQQCB(R14),QCBDRQQ CONC                S22026 39990000
         BO    TERMERR                  YES,ERROR, BRANCH        S22026 40020000
         LA    RTRM,2(RTRM)             BUMP THE POINTER TO THE         40050000
*                                         NEXT LIST ENTRY               40080000
         BCT   R3,LOADAD                SET OFFSET TABLE ADDRESSES      40110000
         NI    AVTGETMN,CDLSTOFF        TURN OFF THE CASCADE SORT       40140000
*                                         IN PROGRESS FLAG              40170000
         B     FOUNDMAT                 GO TO NXT TABLE ENTRY    S22026 40200000
*                                                                       40230000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       40260000
*                                                                       40290000
*        THIS SECTION OF CODE STORES THE NEW TERMNAME OFFSET            40320000
*        FOR ALL LOG ENTRIES IN THE LCB OF THE ENTRIES                  40350000
*                                                                       40380000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       40410000
*                                                                       40440000
SETLOG   EQU   *                                                        40470000
         XC    TRMALTD(TWO),TRMALTD     CLEAR THE DUMMY ALTERNATE       40500000
*                                         DESTINATION FIELD IN THE      40530000
*                                         LOG TERMINAL ENTRY            40560000
         L     RQCB,TRMSTATE            LOAD THE ADDRESS OF THE         40590000
*                                         DESTINATION QCB FOR THIS      40620000
*                                         ENTRY                         40650000
         L     R3,QCBRELLN              LOAD THE ADDRESS OF THE LOG     40680000
*                                         LCB                           40710000
         STH   R1,LCBTTCIN-IEDQLCB(,R3) STORE THE NEW TERMNAME   X03039 40740000
*                                         OFFSET IN THE LOG LCB         40770000
         B     FOUNDMAT                 CHECK THE NEXT ENTRY IN THE     40800000
*                                         TERMNAME TABLE                40830000
         EJECT                                                          40860000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       40890000
*                                                                       40920000
*        THIS ROUTINE SETS UP CERTAIN FIELDS NECESSARY FOR              40950000
*        SORTING ALL INVITATION LISTS ASSOCIATED WITH A DCB             40980000
*                                                                       41010000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       41040000
*                                                                       41070000
TESTLIST EQU   *                                                        41100000
         TM    TRMSTATE,TRMPREF         EP RESOURCE?           @PI02861 41130000
         BZ    NOTSSCP                  BRANCH YES             @PI02861 41160000
         LA    R2,TRMPRFSZ              TRM PREFIX SIZE        @PI02861 41190000
         LR    R3,RTRM                  TRM ADDR               @PI02861 41220000
         SR    R3,R2                    TRM PREFIX ADDRESS     @PI02861 41250000
         USING IEDNTRM,R3                                      @PI02861 41280000
         CLI   TRMTYPE,TRMSSCP          SSCP'S TRM?            @PI02861 41310000
         BE    ALTDTEST                 BRANCH YES TO BYPASS   @PI02861 41340000
         CLI   TRMTYPE,TRMLNCP          NCP TRM?               @PI02861 41370000
         BE    ALTDTEST                 BRANCH YES TO BYPASS   @PI02861 41400000
         DROP  R3                                              @PI02861 41430000
NOTSSCP  EQU   *                                               @PI02861 41460000
         L     RQCB,TRMSTATE            LOAD THE ADDRESS OF THE         41490000
*                                         DESTINATION QCB FOR THIS      41520000
*                                         ENTRY                         41550000
         L     RDCB,QCBRELLN            POINT TO THE DCB                41580000
         TM    DCBDSORG,LGB             IS THIS AN LGB           S22024 41610000
         BNO   SORTED                   BRANCH ON NO             S22024 41640000
         TM    TRMSTATE,LINE            IS THIS A LINE ENTRY     S22024 41670000
         BNO   RNTERM                   NO, MUST BE A TERMINAL   X03039 41700000
         IC    RCPB,LGBLNCT(RDCB)       GET NUMBER OF LINES      S22024 41730000
         LA    RCPB,1(RCPB)             UPDATE COUNT             S22024 41760000
         STC   RCPB,LGBLNCT(RDCB)       STORE NEW COUNT          S22024 41790000
         B     ALTDTEST                 CHECK ALTERNATE DEST     S22024 41820000
RNTERM   EQU   *                                                 X03039 41850000
         NC    LGBBUFSI-IEDNLGB(2,RDCB),LGBBUFSI-IEDNLGB(RDCB) @OZ29219 41855082
*                                       IS BUFSIZE ZERO        @OZ29219 41860082
         BNZ   BUFOK                    IF ZERO LEAVE AS IS    @OZ29219 41865082
         MVC   LGBBUFSI-IEDNLGB(2,RDCB),AVTKEYLE  REP 0 BUFSIZE@OZ29219 41870082
BUFOK    EQU   *                                               @OZ29219 41875082
         CLI   DCBILCT,AVTEZERO         NO LISTS SPECIFIED       X03039 41880000
         BE    ALTDTEST                 NONE, BRANCH             X03039 41910000
SORTED   EQU   *                                                 S22024 41940000
         TM    DCBEIOBX,ILISORTD        HAVE WE SORTED ALL THE          41970000
*                                         INVITATION LISTS              42000000
*                                         ASSOCIATED WITH THIS DCB      42030000
         BO    ALTDTEST                 YES, BRANCH                     42060000
         SR    RCPB,RCPB                CLEAR A REGISTER FOR THE        42090000
*                                         COUNT OF INVITATION LISTS     42120000
         IC    RCPB,DCBILCT             GET THE NUMBER OF INVITATION    42150000
*                                         LIST ADDRESSES IN THIS DCB    42180000
         SR    R2,R2                    CLEAR AN INDEX REGISTER         42210000
*                                                                       42240000
ILSTLOAD EQU   *                                                        42270000
         L     RTRM,DCBINVLI(R2)        LOAD THE ADDRESS OF THE         42300000
*                                         FIRST/NEXT INVITATION         42330000
*                                         LIST                          42360000
         TM    THREE(RTRM),INVLSRTD     HAVE WE PREVIOUSLY SORTED       42390000
*                                         THIS INVITATION LIST          42420000
         BO    RESET                    YES, BRANCH                     42450000
         SR    R3,R3                    CLEAR AN ENTRY COUNTER          42480000
         IC    R3,0(RTRM)               LOAD THE NUMBER OF ENTRIES      42510000
*                                         IN THE INVITATION LIST        42540000
         LTR   R3,R3                    IS THIS A DUMMY INVITATION      42570000
*                                         LIST                          42600000
         BZ    RESET                    YES, BRANCH                     42630000
         LA    R1,TEN                   LOAD A DISPLACEMENT OF 10       42660000
         SR    RTRM,R1                  SET THE STARTING ADDRESS        42690000
*                                         OF THE LIST TO MINUS 8        42720000
         OI    AVTGETMN,ILISTNOW        SET A FLAG TO INDICATE AN       42750000
*                                         INVITATION LIST IS BEING      42780000
*                                         SORTED                        42810000
         B     LOADAD                   LOAD OFFSET ADDRESSES           42840000
*                                                                       42870000
ALCONT   EQU   *                                                        42900000
         BCTR  RTRM,0                   DECREMENT ADDRESS PTR    S22025 42930000
         BCTR  RTRM,0                   DECREMENT POINTER AGAIN  S22025 42960000
         BCT   R3,LOADAD                TEST THE NEXT INVITATION        42990000
*                                         LIST ENTRY                    43020000
         L     R3,DCBINVLI(R2)          LOAD THE ADDRESS OF THE         43050000
*                                         CURRENT INVITATION LIST       43080000
         OI    THREE(R3),INVLSRTD       INDICATE THAT THIS              43110000
*                                         INVITATION LIST HAS BEEN      43140000
*                                         SORTED                        43170000
RESET    EQU   *                                                        43200000
         LA    R2,FOUR(R2)              INCREMENT THE ADDRESS INDEX     43230000
*                                         BY 4                          43260000
         BCT   RCPB,ILSTLOAD            DECREMENT THE COUNT OF          43290000
*                                         INVITATION LISTS TO BE        43320000
*                                         SORTED                        43350000
         NI    AVTGETMN,ILISTOFF        TURN OFF THE LIST BEING         43380000
*                                         SORTED FLAG                   43410000
         OI    DCBEIOBX,ILISORTD        SET THE FLAG TO INDICATE        43440000
*                                         THAT ALL INVITATION LISTS     43470000
*                                         FOR THIS DCB HAVE BEEN SORTED 43500000
         MVC   AVTGETMN+1(3),0(RFIRST)  MOVE THE ADDRESS OF THE         43530000
*                                         TERMINAL ENTRY INTO A         43560000
*                                         SCRATCH WORD                  43590000
         L     RTRM,AVTGETMN            LOAD THE TERMINAL ADDRESS       43620000
         B     ALTDTEST                 TEST FOR AN ALTERNATE           43650000
*                                         DESTINATION                   43680000
ENDTAB   EQU   *                                                        43710000
         CR    R1,RGETAREA              TEST FOR END OF OFFSET TBL      43740000
         BNL   TERMERR                  TERMINAL ERROR DETECTED         43770000
*                                                                       43800000
         LA    R1,TWO(R1)               BUMP POINTER TO NEXT ENTRY      43830000
*                                         IN OFFSET TABLE               43860000
         B     CLCOFF                   TEST NEXT ENTRY IN OFFSET       43890000
*                                         TABLE                         43920000
         EJECT                                                          43950000
TERMERR  EQU   *                                                        43980000
         OI    AVTGETMN,ALTDSTER        SET THE ERROR INDICATOR IN      44010000
*                                         THE AVT                       44040000
MSG      WTO   'IED007I 0        ILLEGAL DESTINATION',                 C44070000
               ROUTCDE=11,DESC=4                                        44100000
*                                                                       44130000
         TM    AVTGETMN,ILISTNOW        ARE WE CURRENTLY SORTING        44160000
*                                         AN INVITATION LIST            44190000
         BO    RESET                    YES, BRANCH                     44220000
         TM    AVTGETMN,CDLSTNOW        ARE WE CURRENTLY SORTING A      44250000
*                                         CASCADE OR A DISTRIBUTION     44280000
*                                         LIST                          44310000
         BZ    FOUNDMAT                 NO, BRANCH                      44340000
         NI    AVTGETMN,CDLSTOFF        YES, TURN OFF THE SORT IN       44370000
*                                         PROGRESS FLAG                 44400000
         B     FOUNDMAT                 GO TO NEXT TABLE ENTRY   S22025 44430000
         EJECT                                                          44460000
COMPSUBR EQU   *                                                        44490000
         EX    RLEN,COMPENT             EXECUTE A COMPARISON TO         44520000
*                                         FIND A MATCH FOR THE          44550000
*                                         OPERATOR CONTROL TERMINAL     44580000
         BNE   NEXTERM                  UPDATE ENTRY POINTER            44610000
         LR    R0,RTRM                  COPY POINTER TO ENTRY IN        44640000
*                                         THE TERMNAME TABLE            44670000
         SR    R0,RTNT                  GET OFFSET FROM START OF        44700000
*                                         TERMNAME TABLE                44730000
         BR    R2                       RETURN                          44760000
*                                                                       44790000
NEXTERM  EQU   *                                                        44820000
         LA    RTRM,4(RLEN,RTRM)        UPDATE POINTER TO NEXT          44850000
*                                         ENTRY IN TERMNAME TABLE       44880000
         BCT   R3,COMPSUBR              TEST THE NEXT TERMINAL          44910000
         LA    R3,AVTDOUBX              LOAD THE ADDRESS OF THE         44940000
*                                         PRIMARY OPERATOR CONTROL      44970000
*                                         TERMINAL NAME                 45000000
         CR    R3,R1                    ARE WE TESTING FOR A POC        45030000
*                                         TERMINAL                      45060000
         BE    POCERR                   YES, BRANCH BECAUSE WE HAVE     45090000
*                                         NOT FOUND THAT TERMINAL       45120000
*                                         DEFINED AS THE PRIMARY        45150000
*                                         OPERATOR CONTROL TERMINAL     45180000
DLQMSG   EQU   *                                                        45210000
         SR    R3,R3                    CLEAR A REGISTER TO ZEROES      45240000
         STH   R3,AVTDLQX               SET THE DEAD LETTER QUEUE       45270000
*                                         OFFSET TO ZERO                45300000
         WTO   'IED078I DLQ TERM ERROR',MF=I,ROUTCDE=11,DESC=4          45330000
*                                                                       45360000
         B     IDSORT                   CHECK FOR CONCENTRATORS  S22026 45390000
         EJECT                                                 @Y17XANG 45420000
*********************************************************************** 45450000
*                                                              @Y17XANG 45480000
* BUILD THE GROUP-LINE TTE HIERARCHY.                          @Y17XANG 45510000
*                                                              @Y17XANG 45540000
***************************************************************@Y17XANG 45570000
SORTLINE EQU   *                                               @Y17XANG 45600000
         SPACE                                                          45630000
* IF THIS IS AN EP ONLY SYSTEM BYPASS ESTABLISHING THE LINE    @Y17XANG 45660000
* GROUP HIERARCHY AND INITIATING THE QCBTTCIN FIELDS.          @Y17XANG 45690000
         SPACE                                                          45720000
         TM    AVTSAVTF,AVTVTMCP        EP ONLY?               @Y17XANG 45750000
         BZ    AVTTEST                  BRANCH YES             @Y17XANG 45780000
         L     R15,SORTAD               ADDR BUILD ROUTINE.    @Y17XANG 45810000
         BALR  R14,R15                  GO BUILD HIERARCHY.    @Y17XANG 45840000
         EJECT                                                 @Y17XANG 45870000
***************************************************************@Y17XANG 45900000
*                                                              @Y17XANG 45930000
* INITIATE QCB TNT INDEX FIELD FOR 3705 CLUSTERS, TERMINALS,   @Y17XANG 45960000
* LU'S AND CTERM TTE'S.                                        @Y17XANG 45990000
*                                                              @Y17XANG 46020000
***************************************************************@Y17XANG 46050000
         SPACE                                                          46080000
         L     R15,TTCINAD              ADDR OF TTCIN ADJ ROUT @Y17XANG 46110000
         BALR  R14,R15                  INITIATE QCB TNT INDEXS@Y17XANG 46140000
         EJECT                                                          46170000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       46200000
*                                                                       46230000
*        THIS ROUTINE CHECKS FOR THE PRESENCE OF A PRIMARY OPERATOR     46260000
*        CONTROL TERMINAL BEING SPECIFIED IN THE AVT                    46290000
*                                                                       46320000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       46350000
*                                                                       46380000
AVTTEST  EQU   *                                                        46410000
         LH    R3,TNTLEN                NUMBER TERMNAME TABLE ENTRIES   46440000
*                                         IN THE TERMNAME TABLE         46470000
         SLR   RLEN,RLEN                                       @Y17XANG 46500000
         IC    RLEN,TNTENLEN            TNT NAME LENGTH        @Y17XANG 46530000
         BCTR  RLEN,0                   MINUS 1 FOR EXECUTE    @Y17XANG 46560000
         CLI   AVTDOUBX,AVTEZERO        TEST FOR A PRIMARY OPERATOR     46590000
*                                         CONTROL TERMINAL              46620000
         BE    BEGINDLQ                 NO POC TERMINAL, BRANCH         46650000
         CLC   AVTDOUBX(EIGHT),SYSCON   HAS SYSCON BEEN SPECIFIED       46680000
*                                         AS THE PRIMARY OPERATOR       46710000
*                                         CONTROL TERMINAL              46740000
         BE    BEGINDLQ                 YES, BRANCH                     46770000
         LA    R1,AVTDOUBX              LOAD THE ADDRESS OF PRIMARY     46800000
*                                       OPERATOR CONTROL TERMINAL       46830000
         LA    RTRM,TNTFIRST            LOAD ADDRESS OF FIRST ENTRY     46860000
*                                         IN TERMNAME TABLE             46890000
         BAL   R2,COMPSUBR              BRANCH TO THE COMPARISON        46920000
*                                         SUBROUTINE                    46950000
         STH   R0,AVTOPCON              STORE OFFSET IN AVT             46980000
         AR    R0,RTNT                  ADD TNT BASE TO OFFSET @Y17XANG 47010000
         LA    R1,TNTFIRST              GET ADDR OF 1ST ENTRY  @YM06156 47040000
*                                       IN THE TNT             @YM06156 47070000
         SR    R0,R1                    DISP TO PRIMARY OPCON  @YM06156 47100000
*                                       FROM FIRST TNT ENTRY.  @Y17XANG 47130000
         LR    R1,R0                    RIGHT MOST DIVIDEND    @Y17XANG 47160000
*                                       REGISTER.              @Y17XANG 47190000
         LA    R2,4(RLEN)               TNT ENTRY LENGTH       @Y17XANG 47220000
         SR    R0,R0                    CLEAR HI ORDER OF      @Y17XANG 47250000
*                                       DIVIDEND REGISTER.     @Y17XANG 47280000
         DR    R0,R2                    TNT INDEX OF PRIMARY   @Y17XANG 47310000
*                                       OP CONSOLE.            @Y17XANG 47340000
         LA    R1,1(,R1)                BUMP RELATIVE OFFSET   @YM06156 47370000
*                                       TO GET TNT OFFSET      @YM06156 47400000
         STH   R1,AVTOPCIN              SAVE IN AVT.           @Y17XANG 47430000
         LA    RTRM,ONE(RLEN,RTRM)      POINTER TO THE                  47460000
*                                         ADDRESS PORTION OF ENTRY      47490000
         MVC   AVTGETMN+1(3),0(RTRM)    MOVE TERMINAL TBL ADDRESS       47520000
*                                         ADDRESS TO SCRATCH AREA       47550000
         L     R2,AVTGETMN              LOAD TERMINAL ADDRESS           47580000
         L     R3,0(R2)                 LOAD QCB ADDRESS        SA51787 47610000
         CLI   0(R3),QCBFQCB            PUT PROCESS ENTRY       SA51787 47640000
         BE    PUTOK                    BRANCH IF YES           SA51787 47670000
         TM    TRMSTATE-IEDQTRM(R2),TRMACPTN  CAN TERM ACCEPT  @OY18827 47700000
*                                         AND ACCEPT CAPABILITIES       47730000
         BNO   POCERR                   GO TO ERROR CODE ROUTINE        47760000
PUTOK    EQU   *                                                SA51787 47790000
         TM    0(R2),SECOPCTL           HAS THIS TERMINAL BEEN          47820000
*                                         DEFINED AS A SECONDARY        47850000
*                                         OPERATOR CONTROL TERMINAL     47880000
         BZ    POCERR                   NO, THEN THERE IS AN ERROR      47910000
         TM    TRMDSORG-IEDQTRM(R2),TRMLGB IS ENTRY A 3705       S22024 47940000
*                                       LINE GROUP BLOCK         S22024 47970000
         BO    POCERR                   YES, ERROR               S22024 48000000
         LH    R3,TNTLEN                NUMBER TERMNAME TABLE ENTRIES   48030000
*                                         NUMBER OF TERMINAL ENTRIES    48060000
         EJECT                                                          48090000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       48120000
*                                                                       48150000
*        THIS SECTION OF CODE TESTS FOR THE PRESENCE OF AN              48180000
*        ENTRY IN THE TERMNAME TABLE WHICH HAS BEEN                     48210000
*        DEFINED AS THE DEAD LETTER QUEUE TERMINAL                      48240000
*                                                                       48270000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       48300000
*                                                                       48330000
BEGINDLQ EQU   *                                                        48360000
         LA    R1,AVTDLQ                LOAD THE ADDRESS OF THE         48390000
*                                         DEAD LETTER QUEUE             48420000
*                                         TERMINAL NAME                 48450000
         NC    0(8,R1),0(R1)            HAS THE USER DEFINED A          48480000
*                                         TERMINAL AS A DEAD LETTER     48510000
*                                         QUEUE                         48540000
         BZ    IDSORT                   NO, BRANCH               S22026 48570000
         LA    RTRM,TNTFIRST            LOAD THE ADDRESS OF THE         48600000
*                                         FIRST ENTRY IN THE TNT        48630000
         BAL   R2,COMPSUBR              BRANCH TO THE COMPARISON        48660000
*                                         SUBROUTINE                    48690000
         LA    R1,TNTOFF                LOAD THE ADDRESS OF THE         48720000
*                                         FIRST ENTRY IN THE TNT        48750000
         SR    R0,R1                    SUBTRACT THE ADDRESS OF         48780000
*                                         THE FIRST ENTRY FROM THE      48810000
*                                         DLQ OFFSET                    48840000
         LR    R1,R0                    COPY THE TERMINAL OFFSET        48870000
         SR    R0,R0                    CLEAR THIS REGISTER FOR         48900000
*                                         THE DIVISION                  48930000
         LA    R3,4(RLEN)               LENGTH OF ENTRY NAME AND ADDR   48960000
         DR    R0,R3                    DIVIDE THE TERMINAL OFFSET      48990000
*                                         BY THE LENGTH OF A            49020000
*                                         TERMNAME TABLE ENTRY          49050000
         LA    R1,ONE(R1)               INCREMENT THE TERMINAL OFFSET   49080000
         STH   R1,AVTDLQX               STORE THE TERMINAL NUMBER       49110000
*                                         OF THE DEAD LETTER QUEUE      49140000
*                                         IN THE AVT                    49170000
         AR    RTRM,RLEN                ACCESS THE ADDRESS OF THE       49200000
*                                         TERMINAL ENTRY                49230000
         MVC   AVTGETMN+1(3),1(RTRM)    MOVE THE TERMINAL ADDRESS       49260000
*                                         OF THE DEAD LETTER QUEUE      49290000
*                                         ENTRY TO A SCATCH WORD        49320000
         L     RTRM,AVTGETMN            LOAD THIS ADDRESS INTO          49350000
*                                         REGISTER                      49380000
         L     RQCB,0(RTRM)             LOAD THE ADDRESS OF THE QCB     49410000
*                                         FOR THIS TERMINAL             49440000
         TM    QCBDSFLG,TSOTERM         IS THIS A TSO TERMINAL          49470000
         BZ    DLQMSG                   YES, BRANCH                     49500000
         EJECT                                                          49530000
*********************************************************************** 49560000
*                                                                     * 49590000
*        THIS SECTION OF CODE SORTS THE DEVICE I.D. TABLE FOR EACH    * 49620000
*        CONCENTRATOR IN THE SYSTEM                                   * 49650000
*                                                                     * 49680000
*********************************************************************** 49710000
IDSORT   EQU   *                                                 S22026 49740000
         TM    AVTSCOPT,AVTCONC+AVTCONCO ANY CONCS IN SYSTEM     S22026 49770000
         BZ    ENDIDSRT                 NO, BRANCH               S22026 49800000
*                                                                S22026 49830000
         MVI   AVTGETMN,HEXZERO         ZERO ERROR SWITCH        S22026 49860000
         LH    RTNTCTR,TNTLEN           NO. OF ENTRIES IN TNT    S22026 49890000
         N     RTNTCTR,AVTCLRHI         CLEAR HIGH-ORDER BYTE    S22026 49920000
         LA    RPRESENT,TNTFIRST        ADDR OF TERMINAL NAME    S22026 49950000
         SR    RLENTN,RLENTN                                     S22026 49980000
         IC    RLENTN,TNTENLEN          LENGTH OF TERMINAL NAME  S22026 50010000
         BCTR  RLENTN,0                 DECREMENT LENGTH         S22026 50040000
NEXTTRMN EQU   *                                                 S22026 50070000
         LA    RTRM,ONE(RLENTN,RPRESENT)                         S22026 50100000
         MVC   AVTGETMN+1(3),0(RTRM)    ADDR OF TRM ENTRY        S22026 50130000
         L     RTRM,AVTGETMN            GET ADDR OF TRM ENTRY    S22026 50160000
         TM    TRMSTATE,ENTRYTYP        SINGLE ENTRY             S22026 50190000
         BNZ   NEXTTRM                  NO, BRANCH               S22026 50220000
         TM    TRMDSORG,TRMLGB          LGB                      S22024 50250000
         BO    NEXTTRM                  YES BRANCH               S22024 50280000
         TM    TRMDEVFL+1,CONC          CONC OR ATTACHED TRM     S22026 50310000
         BO    SORTIDT                  YES, BRANCH              S22026 50340000
*                                                                S22026 50370000
NEXTTRM  EQU   *                                                 S22026 50400000
         LA    RPRESENT,FOUR(RLENTN,RPRESENT) NXT TRM ENTRY ADDR S22026 50430000
         BCT   RTNTCTR,NEXTTRMN         GO THRU ENTIRE TNT       S22026 50460000
*                                                                S22026 50490000
         B     ENDIDSRT                 ALL ID TBLS SORTED       S22026 50520000
*                                                                S22026 50550000
SORTIDT  EQU   *                                                 S22026 50580000
         L     RQCB,TRMDESTQ-1          ADDR OF DEST QCB         S22026 50610000
         TM    QCBDSFLG,QCBDRQQ         DATA READY QUEUE         S22026 50640000
         BO    LOCIDTBL                 YES, BRANCH              S22026 50670000
*                                                                S22026 50700000
         AH    RQCB,QCBEXTO             CALC EXTENSION ADDR      S22026 50730000
         USING IEDQQCBE,RQCB                                     S22026 50760000
         L     RTRM,QCBECONC-1          ADDR OF CONC TRM ENTRY   S22026 50790000
         DROP  RQCB                                              S22026 50820000
         USING IEDQQCB,RQCB                                      S22026 50850000
LOCIDTBL EQU   *                                                 S22026 50880000
         SR    RWORK,RWORK                                       S22026 50910000
         LA    RFLD,TRMOPNO             DVC FLD IF NO OPT FLD    S22026 50940000
         TM    TRMSTATE,TRMOPTFN        OPTION FIELDS USED       S22026 50970000
         BZ    NOOPT                    NO, FIND DEV DEP FIELD   S22026 51000000
*                                                                S22026 51030000
         IC    RWORK,TRMOPNO            NO. OF OPTION ENTRIES    S22026 51060000
         LA    RFLD,THREE(RWORK,RFLD)   BYPASS OPTION FIELDS     S22026 51090000
NOOPT    EQU   *                                                 S22026 51120000
         LH    RFLGS,TRMDEVFL           DEVICE DEPENDENT FIELDS  S22026 51150000
         SLL   RFLGS,FIFTEEN            SHIFT FLAGS TO HI ORDER  S22026 51180000
         LA    RCTR1,EIGHT              DESIRED FIELD            S22026 51210000
LOOPFLD  EQU   *                                                 S22026 51240000
         SLL   RFLGS,ONE                SHIFT TO TEST PRESENCE   S22026 51270000
         LTR   RFLGS,RFLGS              THIS FIELD PRESENT       S22026 51300000
         BNM   BCTIT                    NO, DONT BUMP POINTER    S22026 51330000
*                                                                S22026 51360000
         IC    RWORK,0(RFLD)            GET LENGTH OF THIS FIELD S22026 51390000
         LA    RFLD,ONE(RWORK,RFLD)     BUMP PTR PAST FIELD      S22026 51420000
BCTIT    EQU   *                                                 S22026 51450000
         BCT   RCTR1,LOOPFLD            LOOP TIL FIELD LOCATED   S22026 51480000
*                                                                S22026 51510000
         MVC   AVTGETMN+4(4),ONE(RFLD)  PTR TO DEVICE ID TABLE   S22026 51540000
         L     RIDPTR,AVTGETMN+4        ADDRESS OF DVC ID TABLE  S22026 51570000
         USING IEDQDVCT,RIDPTR                                   S22026 51600000
         LTR   RIDPTR,RIDPTR            CONCENTRATOR             S22026 51630000
         BM    ACONC                    YES, BRANCH              S22026 51660000
*                                                                S22026 51690000
         L     R8,IDERRAD               GET ADDR ERR MSG RTN   @G36XRNP 51720000
         BALR  RLINK,R8                 WRITE ERR MSG          @G36XRNP 51750000
*                                                                S22026 51780000
         B     NEXTTRM                  CHK NEXT TRM             S22026 51810000
*                                                                S22026 51840000
ACONC    EQU   *                                                 S22026 51870000
         TM    DVCSTAT,DVCSORTD         IS TABLE ALREADY SORTED  S22026 51900000
         BO    NEXTTRM                  YES, BRANCH              S22026 51930000
*                                                                S22026 51960000
         LR    RSVADR,RIDPTR            SAVE DVC ID TABLE ADDR   S22026 51990000
         SR    RIDCNT,RIDCNT            ZERO ACCUMULATOR         S22026 52020000
         SR    RLENDE,RLENDE            ZERO ACCUMULATOR         S22026 52050000
         IC    RLENDE,DVCENLTH          LENGTH OF DVC ID ENTRY   S22026 52080000
         LA    RIDPTR,DVCECW-DVCNO(RIDPTR) POINT TO ENTRY        S22026 52110000
NEXTID   EQU   *                                                 S22026 52140000
         LA    RIDCNT,ONE(RIDCNT)       COUNT ENTRY              S22026 52170000
         L     ROTNOW,AVTSAVE4+16       ADDR OF OFFSET TABLE     S22026 52200000
         LH    RCTR2,TNTLEN             ENTRIES IN OFFSET TABLE  S22026 52230000
         N     RCTR2,AVTCLRHI           CLEAR HIGH-ORDER BYTE    S22026 52260000
         SR    RTNTOFF,RTNTOFF                                   S22026 52290000
         IC    RTNTOFF,DVCIDLTH         LENGTH OF THIS DVC ID    S22026 52320000
         LA    RTNTOFF,ONE(RTNTOFF,RIDPTR) ADDR OF TNT OFFSET    S22026 52350000
COMPOFF  EQU   *                                                 S22026 52380000
         CLC   0(2,ROTNOW),0(RTNTOFF)   COMPARE THE OFFSETS      S22026 52410000
         BNE   TRYNEXT                  NO, BRANCH               S22026 52440000
*                                                                S22026 52470000
         S     ROTNOW,AVTSAVE4+16       CALC NEW OFFSET          S22026 52500000
         LA    ROTNOW,TWO(ROTNOW)       ADD TWO TO THE DIFF      S22026 52530000
         SRL   ROTNOW,ONE               CALC NEW INDEX           S22026 52560000
         STH   ROTNOW,AVTGETMN+2        SAVE NEW OFFSET          S22026 52590000
         MVC   0(2,RTNTOFF),AVTGETMN+2  RESET DVC ID TBL OFFSET  S22026 52620000
ENDLIST  EQU   *                                                 S22026 52650000
         LA    RIDPTR,0(RLENDE,RIDPTR)  ADDR NEXT ENTRY IN TABLE S22026 52680000
         CLI   DVCIDLTH,DVCEND          END OF LIST              S22026 52710000
         BNE   NEXTID                   UPDATE NEXT ID OFFSET    S22026 52740000
*                                                                S22026 52770000
         LR    RIDPTR,RSVADR            DVC ID TABLE ADDR        S22026 52800000
         OI    DVCSTAT,DVCSORTD         INDICATE TBL SORTED      S22026 52830000
         STC   RIDCNT,DVCNO             SAVE COUNT OF ENTRIES    S22026 52860000
         B     NEXTTRM                  CHECK NEXT TERMINAL      S22026 52890000
*                                                                S22026 52920000
TRYNEXT  EQU   *                                                 S22026 52950000
         LA    ROTNOW,2(ROTNOW)         INDEX TO NEXT OFFSET     S22026 52980000
         BCT   RCTR2,COMPOFF            END OF OFFSET TABLE      S22026 53010000
*                                                                S22026 53040000
         L     R8,IDERRAD               GET ADDR ERR MSG RTN   @G36XRNP 53070000
         BALR  RLINK,R8                 WRITE ERR MSG          @G36XRNP 53100000
*                                                                S22026 53130000
         B     ENDLIST                  CHK FOR END OF LIST      S22026 53160000
*                                                                S22026 53190000
ENDIDSRT EQU   *                                                 S22026 53220000
         LM    R0,R1,AVTSAVE4+12        LENGTH/AREA TO FREE      S22026 53250000
         LTR   R1,R1                    WAS GETMAIN USED        SA54926 53280000
         BZ    CODEFIX                  IF NOT BRANCH           SA54926 53310000
         FREEMAIN  R,LV=(0),A=(1)       FREE THE OFFSET TABLE    S22026 53340000
         LA    R15,RETCDE               SET RETURN CODE          S22026 53370000
         TM    AVTGETMN,ALTDSTER        ANY ERRORS               S22026 53400000
         BO    ERROR                    YES, BRANCH              S22026 53430000
*                                                                       53460000
CODEFIX  EQU   *                                                        53490000
         LR    R1,RAVT                  AVT IS PARAMETER LIST           53520000
         L     R3,AVTCLOSB+8            LOAD THE ADDRESS OF THE         53550000
*                                         CLOSEDOWN/COMPLETION RTNE     53580000
         LA    R3,SIX(R3)               GET THE ADDRESS OF THE          53610000
*                                         FIRST INSTRUCTION             53640000
         EJECT                                                          53670000
         L     R6,AVTTSOPT              ADDRESS OF TIME SHARING QCB     53700000
         L     R6,TSISTAE-IEDQTSI(,R6)  ADDRESS OF TSO STAE ROUTINE     53730000
         LA    R6,4(,R6)                INCREMENT TO ENTRY POINT        53760000
*                                          FOR STAI EXITS               53790000
***************************************************************@YA10680 53820000
*                                                             *@YA10680 53850000
*   THIS SECTION OF CODE IS TO CHECK TO SEE IF THERE IS       *@YA10680 53880000
*   REALLY A VIRTUAL MACHINE WHEN THE USER SPECIFIED VM=YES   *@YA10680 53910000
*   ON THE INTRO MACRO                                        *@YA10680 53940000
*                                                             *@YA10680 53970000
***************************************************************@YA10680 54000000
         L     R4,AVTSAVTP              SECONDARY AVT          @YA10680 54030000
* CHECK CPU ID                                                 @YA10680 54180000
         MODESET MODE=SUP               SWITCH TO SUPERVISOR   @G36XRNP 54210000
*                                       MODE                   @G36XRNP 54240000
         MODESET EXTKEY=SUPR            SWITCH TO KEY ZERO     @G36XRNP 54270000
         STIDP AVTDOUBL                 STORE CPU ID           @G36XRNP 54300000
         MODESET EXTKEY=TCAM            SWITCH TO TCAM KEY (6) @G36XRNP 54330000
         MODESET MODE=PROB              SWITCH BACK TO PROBLEM @G36XRNP 54360000
*                                       PROGEAM MODE           @G36XRNP 54390000
         LR    R1,RAVT                  RESTORE AVT ADDRESS    @G36XRNP 54420000
         CLI   AVTDOUBL,VMFLG           THIS A VIRTUAL MACHINE @G36XRNP 54450000
         BE    VMYES                    YES, CHECK SAVT FLAG   @OY20289 54480082
         TM    SAVTDIAF-IEDNSVTD(R4),VIRTFLG  IS VIRT SPEC     @OY20289 54486082
         BNO   VMOK                     FLAG OK FOR NO VM      @OY20289 54492082
         B     VMERR                    FLAG INDICATES VM, BUT @OY20289 54498082
*                                       THERE IS NO VM -ERROR  @OY20289 54504082
VMYES    EQU   *                                               @OY20289 54510082
         TM    SAVTDIAF-IEDNSVTD(R4),VIRTFLG   IS VIRTIAL SPEC @OY20289 54516082
         BNO   VMERR                    FLAG INDICATES NO VM   @OY20289 54522082
*                                       BUT IT IS VM  -ERROR   @OY20289 54528082
VMOK     EQU   *                                               @YA10680 54540000
*                                                                       54570000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       54600000
*                                                                       54630000
*        THIS SECTION OF CODE ATTACHES THE COMMON WRITE                 54660000
*        ROUTINE, OPERATOR CONTROL, AND THE ON-LINE TEST                54690000
*        FUNCTION                                                       54720000
*                                                                       54750000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       54780000
*                                                                       54810000
         CLI   AVTOLTST,AVTEZERO        IS THE ON-LINE TEST MODULE      54840000
*                                         TO BE ATTACHED                54870000
         BE    CWRATTCH                 NO, BRANCH                      54900000
         LA    R2,AVTOLECA              LOAD THE ADDRESS OF THE         54930000
*                                         ON-LINE TEST ECB              54960000
         TM    AVTBIT1,AVTTSON          IS TIME SHARING ACTIVE          54990000
         BO    ATCHOLTS                 BRANCH ON YES                   55020000
*                                                                       55050000
         ATTACH ECB=(2),ETXR=(3),MF=(E,(1)),SF=(E,OLLIST)               55080000
*                                                                       55110000
         B     ENDOLATC                 GO GET ON-LINE TEST'S    S22025 55140000
*                                       TCB ADDRESS                     55170000
*                                                                       55200000
ATCHOLTS EQU   *                                                        55230000
*                                                                       55260000
         ATTACH ECB=(2),ETXR=(3),STAI=((6)),MF=(E,(1)),SF=(E,OLLIST)    55290000
*                                                                       55320000
ENDOLATC EQU   *                                                        55350000
         ST    R1,AVTOLTCB              TCB ADDRESS OF ATTACHED         55380000
*                                         TASK - ON-LINE TEST           55410000
         LR    R1,RAVT                  RESTORE THE AVT ADDRESS         55440000
*                                                                       55470000
CWRATTCH EQU   *                                                        55500000
         TM    AVTCWFL1,AVTCOMWN        IS THE COMMON WRITE ROUTINE     55530000
*                                         TO BE ATTACHED                55560000
         BNO   ATTACHOC                 NO, BRANCH                      55590000
         LA    R2,AVTCWECA              LOAD THE  ADDRESS OF THE        55620000
*                                         COMMON WRITE ECB              55650000
         NI    AVTCWECA,AVTEZERO        TURN OFF THE WAITING BIT IN     55680000
*                                         THE ECB                       55710000
         ATTACH EP=IEDQFW,ECB=(2),ETXR=(3),DPMOD=-1,MF=(E,(1))          55740000
*                                                                       55770000
         ST    R1,AVTCWTCB              STORE THE TCB ADDRESS OF THE    55800000
*                                         ATTACHED TASK                 55830000
*                                                                       55860000
ATTACHOC EQU   *                                                        55890000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       55920000
*                                                                       55950000
*        THIS SECTION OF CODE ISSUES THE EXTRACT AND QEDIT              55980000
*        MACROS TO SET UP THE COMMUNICATIONS PARAMETER LIST             56010000
*        INTERFACE BETWEEN TCAM AND THE OPERATING SYSTEM                56040000
*                                                                       56070000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       56100000
*                                                                       56130000
         LA    R4,AVTCOMPT              LOAD THE ADDRESS OF THE         56160000
*                                         AVT ADDRESS FIELD             56190000
         LA    R1,AVTSAVE4+12           ADDRESS OF PARM LIST            56220000
*                                                                       56250000
         EXTRACT (R4),'S',FIELDS=COMM,MF=(E,(1)) ESTABLISH PARM LIST    56280000
*                                                                       56310000
         L     R1,AVTCOMPT              LOAD THE ADDRESS OF THE         56340000
*                                         COMMUNICATIONS PARAMETER      56370000
*                                         LIST                          56400000
         LA    R0,FOUR(R1)              LOAD THE ADDRESS OF THE         56430000
*                                         WORD TO HOLD THE CIB          56460000
*                                         CHAIN ADDRESS                 56490000
         SR    R1,R1                    CLEAR A COUNT REGISTER          56520000
         IC    R1,AVTCIB                LOAD THE NUMBER OF BUFFERS      56550000
*                                         REQUESTED                     56580000
         QEDIT CIBCTR=(1),ORIGIN=(0)    GET THE BUFFERS                 56610000
         LA    R2,AVTOPECA              LOAD THE ADDRESS OF THE         56640000
*                                         OPERATOR CONTROL ECB          56670000
         LR    R1,RAVT                  RESTORE AVT ADDRESS     SA64692 56700000
         TM    AVTBIT1,AVTTSON          IS TIME SHARING ACTIVE          56730000
         BO    ATCHOCTS                 BRANCH ON YES                   56760000
*                                                                       56790000
         ATTACH ECB=(2),ETXR=(3),MF=(E,(1)),SF=(E,OCLIST)               56820000
*                                                                       56850000
         B     ENDOCATC                 GO GET OP CONTROL'S TCB  S22025 56880000
*                                       ADDRESS                         56910000
*                                                                       56940000
ATCHOCTS EQU   *                                                        56970000
*                                                                       57000000
         ATTACH ECB=(2),ETXR=(3),STAI=((6)),MF=(E,(1)),SF=(E,OCLIST)    57030000
*                                                                       57060000
ENDOCATC EQU   *                                                        57090000
         ST    R1,AVTOCTCB              TCB ADDRESS OF ATTACHED         57120000
*                                         TASK - OPERATOR CONTROL       57150000
         EJECT                                                          57180000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       57210000
*                                                                       57240000
*        THIS SECTION OF CODE LOADS THE SYSTEM DELAY ROUTINE            57270000
*                                                                       57300000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       57330000
*                                                                       57360000
         LH    R1,AVTINTLV              LOAD THE LENGTH OF THE          57390000
*                                         SYSTEM DELAY INTERVAL         57420000
         LTR   R1,R1                    IS THE DELAY ZERO               57450000
         BZ    TSTOPCON                 NO, BRANCH                      57480000
*                                                                       57510000
         LOAD  EPLOC=SYSDELAY                                           57540000
*                                                                       57570000
         ST    R0,AVTHI                 STORE THE ENTRY POINT           57600000
*                                         ADDRESS IN THE AVT            57630000
         LR    R1,R0                    COPY THE ENTRY POINT ADDRESS    57660000
         A     R0,EIGHT(,R1)            LOAD THE ADDRESS OF THE         57690000
*                                         STCB FIELD                    57720000
         ST    R0,EIGHT(,R1)            STORE THIS ADDRESS IN THE       57750000
*                                         STCB ADDRESS POINTER          57780000
         EJECT                                                          57810000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       57840000
*                                                                       57870000
*        THIS SECTION OF CODE LOADS THE OPERATOR AWARENESS              57900000
*        MESSAGE ROUTER ROUTINE                                         57930000
*                                                                       57960000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       57990000
*                                                                       58020000
TSTOPCON EQU   *                                                        58050000
         LH    R1,AVTOPCON              LOAD THE TERMNAME TABLE         58080000
*                                         OFFSET TO THE PRIMARY         58110000
*                                         OPERATOR CONTROL TERMINAL     58140000
         LTR   R1,R1                    IS THIS OFFSET ZERO             58170000
         BZ    RETURN                   YES, BRANCH                     58200000
*                                                                       58230000
         LOAD  EPLOC=OPAMSGRT           LOAD THE AWARENESS ROUTINE      58260000
*                                                                       58290000
         ST    R0,AVTNX                 STORE THE ENTRY POINT           58320000
*                                         ADDRESS IN THE AVT            58350000
RETURN   EQU   *                                                        58380000
         SR    R15,R15                  CLEAR RETURN CODE               58410000
*                                                                       58440000
EXIT     EQU   *                                                        58470000
         STC   R15,AVTOPETR             SAVE INTRO RETURN CODE          58500000
*                                         FOR OPEN TO CHECK             58530000
         LTR   R15,R15                  IS THE RETURN CODE ZERO? X03039 58560000
         BNZ   EXIT1                    ERROR BYPASS IECIAA      X03039 58590000
         LR    R1,RAVT                  SET PARMREG TO AVT       X03039 58620000
         LINK  EP=IEDIAA                LINK TO COMMON OPEN      X03039 58650000
EXIT1    EQU   *                                                 X03039 58680000
         SR    R15,R15                  CLEAR RETURN CODE REG    X03039 58710000
         IC    R15,AVTOPETR             RESTORE INTRO RETURN CODEX03039 58740000
         LA    R13,2*AVTSVSIZ(RAVT)     MY SAVEAREA ADDRESS             58770000
         L     R13,4(R13)               RESTORE CALLER'S REGISTERS      58800000
*                                                                       58830000
         RETURN  (14,12),T,RC=(15)      RETURNTO INTRO                  58860000
         EJECT                                                          58890000
GETERR   EQU   *                                                        58920000
         LA    R15,AVTECD8              SET THE RETURN CODE             58950000
         B     ERROR                    EXIT THIS ROUTINE               58980000
*                                                                       59010000
TERMERR1 EQU   *                                                        59040000
         LA    R15,SIXTEEN              AN ERROR IN DEFINING THE        59070000
*                                         TERMINAL                      59100000
         B     ERROR                    EXIT THIS ROUTINE               59130000
*                                                                       59160000
VMERR    EQU   *                                               @YA10680 59190000
         LA    R15,VMCODE               AN ERROR IN SPECIFYING @YA10680 59220000
*                                        MACHINE TYPE          @YA10680 59250000
         B     ERROR                    EXIT THIS ROUTINE      @YA10680 59280000
*                                                              @YA10680 59310000
POCERR   EQU   *                                                        59340000
         LA    R15,TWENTY               AN ERROR IN DEFINING THE        59370000
*                                         PRIMARY OPERATOR CONTROL      59400000
*                                         TERMINAL                      59430000
ERROR    EQU   *                                                        59460000
         LR    R3,R15                   SAVE ERROR CODE                 59490000
         CVD   R15,AVTDOUBL                                             59520000
         UNPK  MSGX(4),AVTDOUBL         PUT ERROR ID IN MESSAGE         59550000
         MVZ   MSGX+3(1),MSGX           GET PROPER ZONE                 59580000
*                                                                       59610000
MSG065   WTO   'IED065I INITIALIZATION ERROR     ',                    C59640000
               ROUTCDE=(2,11),DESC=4                                    59670000
*                                                                       59700000
         LR    R15,R3                   RESTORE ERROR CODE              59730000
         B     EXIT                     AND RETURN                      59760000
         EJECT                                                          59790000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       59820000
*                                                                       59850000
*        THIS ROUTINE SETS UP A PARAMETER LIST IN THE AVT.              59880000
*        THIS LIST WILL BE REFERENCED BY ALL GETMAIN                    59910000
*        MACROS ISSUED IN IEDQOA                                        59940000
*                                                                       59970000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       60000000
*                                                                       60030000
AVTPAR1  EQU   *                                                 X01004 60060000
         OI    AVTGETMN+EIGHT,PAGE      ENTRY FOR PAGE BOUNDARY  X01004 60090000
AVTPAR   EQU   *                                                        60120000
         ST    R1,AVTGETMN              LENGTH                          60150000
         ST    R0,AVTGETMN+4            RECEIVING ADDRESS               60180000
         MVI   AVTGETMN+9,AVTEZERO      SET THE SUBPOOL ID FOR          60210000
*                                         PROBLEM PROGRAM MODE          60240000
         LA    R1,AVTGETMN              SVC 4 PARAMETER LIST            60270000
*                                                                       60300000
         GETMAIN ,MF=(E,(1))                                            60330000
         NI    AVTGETMN+EIGHT,X'FF'-PAGE TURN OFF BOUNDARY FLAG  X01004 60360000
*                                                                       60390000
         LTR   R15,R15                  GETMAIN SUCCESSFUL              60420000
         BNE   GETERR                   NO, BRANCH                      60450000
         BR    R14                      RETURN IF GOOD                  60480000
         EJECT                                                          60510000
ERRSET   MVC   0(0,RPRESENT),0(RFIRST)  TERMNAME TO ERRORMSG            60540000
COMPENT  CLC   0(0,RPRESENT),0(RTRM)    COMPARE TERMNAME ENTRIES        60570000
EX1      XC    0(0,RPRESENT),0(RTRM)    SWAP THE TWO                    60600000
EX2      XC    0(0,RTRM),0(RPRESENT)    TERMNAME ENTRIES                60630000
*                                                                       60660000
OLLIST   ATTACH EP=IEDQWA,DPMOD=-1,SF=L                                 60690000
*                                                                       60720000
OCLIST   ATTACH EP=IEDQCA,DPMOD=-1,SF=L                                 60750000
*                                                                       60780000
LINKOB   LINK  EP=IEDQOB,SF=L                                           60810000
*                                                                       60840000
NOPASS   DC    CL8' '                   TO CHECK FOR NO PASSWORD        60870000
SYSDELAY DC    CL8'IEDQHI  '            SYSTEM DELAY ROUTINE     S22025 60900000
OPAMSGRT DC    CL8'IEDQNX  '            OPERATOR AWARENESS ROUTINE      60930000
SYSCON   DC    C'SYSCON  '              ENTRY SPECIFYING SYSTEM  S22025 60960000
*                                       CONSOLE AS PRIMARY OP    S22025 60990000
*                                       CONTROL TERMINAL         S22025 61020000
FREEPTR  DC    2F'0'                    ADDRESS OF FREE CORE     X01004 61050000
FBUFSAV  DC    2F'0'                    SAVE ADDRESS AND SIZE OF X01004 61080000
*                                         GETMAIN FOR I/O BUFFERSX01004 61110000
HEIGHT   DC    H'32'                    LENGTH OF A PIU TRACE  @Y17XANG 61140000
*                                       TABLE ENTRY            @Y17XANG 61170000
H8       DC    H'8'                     HALFWORD CONSTANT      @Y17XANG 61200000
PAGESIZE DC    F'4096'                  MVS PAGE SIZE          @G36XRNP 61230000
PAGE     EQU   X'10'                                             X01004 61260000
FIVE     EQU   5                                                 X01004 61290000
AD       EQU   7                                                 X01004 61320000
CCWIDA   EQU   4                        INDIRECT ADDRESSING FLAG X02004 61350000
ALL      EQU   15                       ICM MASK                 X02004 61380000
LOWBIT   EQU   X'01'                    MASK FOR LOW ORDER BIT @G36XRNP 61410000
RESTLOW  EQU   X'FE'                    MASK FOR LOW ORDER BIT @OY17ANZ 61440000
HSIX     DC    H'6'                     HALF WORD OF SIX         S22027 61470000
         DS    0F                       LOWOFF MASK MUST       @OY12967 61500000
*                                        FOLLOW THSI STMT      @OY12967 61530000
LOWOFF   DC    X'FFFFFFFE'              MASK FOR LOW ORDER BIT @OY12967 61560000
TERMTEMP DC    F'0'                     FULLWORD FOR TNT ADDRESSES22024 61590000
TTRCID   DC    C'PIUT'                  ID FOR PIU TRACE TABLE @Y17XANG 61620000
IDERRAD  DC    A(IDERRMSG)                                     @G36XRNP 61650000
SORTAD   DC    A(SORTHIER)                                     @Y17XANG 61680000
TTCINAD  DC    A(SETTTCIN)                                     @Y17XANG 61710000
         DROP  RQCB                                            @Y17XANG 61740000
         EJECT                                                 @Y17XANG 61770000
***************************************************************@Y17XANG 61800000
*                                                              @Y17XANG 61830000
* THIS SECTION CREATES THE GROUP-LINE TTE HIERARCHY            @Y17XANG 61860000
*                                                              @Y17XANG 61890000
***************************************************************@Y17XANG 61920000
SORTHIER DS    0H                                              @Y17XANG 61950000
         SPACE                                                          61980000
* SET UP TNT SCAN FOR LGB.                                     @Y17XANG 62010000
         SPACE                                                          62040000
         USING SORTHIER,R15                                    @Y17XANG 62070000
         ST    RBASE,SORTL12            SAVE MAINLINE BASE     @Y17XANG 62100000
         LR    RBASE,R15                SET SORT BASE          @Y17XANG 62130000
         DROP  R15                                             @Y17XANG 62160000
         USING SORTHIER,RBASE                                  @Y17XANG 62190000
         ST    R14,SORTL14              SAVE RETURN REG        @Y17XANG 62220000
         L     RTNT,AVTRNMPT            TNT BASE               @Y17XANG 62250000
         USING IEDQTNTD,RTNT                                   @Y17XANG 62280000
         SR    RLEN,RLEN                                       @Y17XANG 62310000
         IC    RLEN,TNTENLEN            LNTH TNT NAME          @Y17XANG 62340000
         LA    RLEN,L'TNTTRMAD(RLEN)    LNTH TNT ENTRY         @Y17XANG 62370000
         LA    RTNT1,TNTFIRST-L'TNTTRMAD 1ST TNT - ADDR LENTH  @Y17XANG 62400000
         LA    RCTR1,1                  START TNT INDEX = 1    @Y17XANG 62430000
         LA    R1,L'GETFIRST            SORT TABLE ENTRY LEN   @Y17XANG 62460000
         MH    R1,TNTLEN                TIMES # TNT ENTRIES    @Y17XANG 62490000
*                                       (MAX POSSIBLE LINES)   @Y17XANG 62520000
         LA    R1,GETFIRST-GETSAVE(R1)   ADD IN SAVE AREA.     @Y17XANG 62550000
         ST    R1,AVTSAVE4+20           SAVE SORT TABLE LEN    @Y17XANG 62580000
         LA    R0,AVTSAVE4+24           LOCATION TO RECV       @Y17XANG 62610000
*                                       GETMAIN ADDR           @Y17XANG 62640000
         L     R15,PARAD                GETMAIN ROUTINE ADDR   @Y17XANG 62670000
         LR    RCTR2,RBASE              SAVE BASE              @Y17XANG 62700000
         L     RBASE,SORTL12            MAINLINE BASE          @Y17XANG 62730000
         BALR  R14,R15                  GETMAIN SORT AREA      @Y17XANG 62760000
         LR    RBASE,RCTR2              RESET BASE             @Y17XANG 62790000
         L     RGETM,AVTSAVE4+24        SORT AREA BASE         @Y17XANG 62820000
         USING GETSAVE,RGETM                                   @Y17XANG 62850000
         SPACE                                                          62880000
* FETCH TTE OF NEXT TNT ENTRY.                                 @Y17XANG 62910000
         SPACE                                                          62940000
FETCHTTE EQU   *                                               @Y17XANG 62970000
         LA    RTNT1,0(RLEN,RTNT1)      NEXT TNT ENTRY         @Y17XANG 63000000
         USING TNTTRMAD,RTNT1                                  @Y17XANG 63030000
         SR    RLGB,RLGB                                                63060000
         ICM   RLGB,ADDR,TNTTRMAD       TTE ADDRESS            @Y17XANG 63090000
         SPACE                                                          63120000
* IF THIS IS AN LGB THEN DO                                    @Y17XANG 63150000
         SPACE                                                          63180000
         USING IEDQTRM,RLGB                                    @Y17XANG 63210000
         CLI   TRMDSORG,TRMLGB          LGB?                   @Y17XANG 63240000
         BNE   NXTLGB                   BRANCH NO              @Y17XANG 63270000
         SPACE                                                          63300000
* SET UP TNT LINE ENTRY SEARCH.                                @Y17XANG 63330000
         SPACE                                                          63360000
         LA    RLGB,IEDQTRM-TRMCOHTG-(LGBBUFOU-LGBSUBST)(RLGB) @Y17XANG 63390000
*                                       ADJUST LGB ADDR SO     @Y17XANG 63420000
*                                       THAT LGBSUBST WILL BE  @Y17XANG 63450000
*                                       SAME RELATIVE DISPLACE-@Y17XANG 63480000
*                                       MENT FROM TTE PREFIX   @Y17XANG 63510000
*                                       AS TRMCOHTG.           @Y17XANG 63540000
         ST    RLGB,GETLGB              SAVE ADJUSTED LGB ADDR @Y17XANG 63570000
         DROP  RLGB                                            @Y17XANG 63600000
         LA    RTNT2,TNTFIRST-L'TNTTRMAD 1ST TNT - ADDR LEN    @Y17XANG 63630000
         LA    RCTR2,1                  START TNT INDEX AT 1   @Y17XANG 63660000
         LA    RTBL,GETFIRST            1ST SORT TABLE ENTRY   @Y17XANG 63690000
         USING GETFIRST,RTBL                                   @Y17XANG 63720000
         SPACE                                                          63750000
* FETCH TTE OF NEXT TNT ENTRY(LINE SEARCH).                    @Y17XANG 63780000
         SPACE                                                          63810000
FETCHLN  EQU   *                                               @Y17XANG 63840000
         LA    RTNT2,0(RLEN,RTNT2)      NEXT TNT ENTRY         @Y17XANG 63870000
         ICM   RNLINE,ADDR,TNTTRMAD-IEDTNTA(RTNT2) TTE ADDR    @Y17XANG 63900000
         USING IEDQTRM,RNLINE                                  @Y17XANG 63930000
         SPACE                                                          63960000
* IF THIS IS A LINE ENTRY THEN DO                              @Y17XANG 63990000
         SPACE                                                          64020000
         TM    TRMSTATE,TRMLINE         LINE?                  @Y17XANG 64050000
         BZ    NXTLINE                  BRANCH NO TO FETCH NEXT@Y17XANG 64080000
*                                       LINE                   @Y17XANG 64110000
         SPACE                                                          64140000
* IF THIS IS THE SAME LINE GROUP AS LGB                        @Y17XANG 64170000
         SPACE                                                          64200000
         USING IEDQQCB,R15                                     @Y17XANG 64230000
         L     R15,TRMDESTQ-1           QCB ADDRESS            @Y17XANG 64260000
         L     R14,QCBLGBAD-1           QCB LGB PTR            @Y17XANG 64290000
         LA    R14,LGBPRFSZ+IEDQTRM-TRMCOHTG-(LGBBUFOU-LGBSUBST)(R14)   64320000
*                                       ADJUST LGB ADDRESS:    @Y17XANG 64350000
*                                       LGB ADDRESS FROM QCB   @Y17XANG 64380000
*                                       IS LGBBUFOU - DCB      @Y17XANG 64410000
*                                       PREFIX.  THEREFORE     @Y17XANG 64440000
*                                       MUST BE PLUS THIS DISP @Y17XANG 64470000
*                                       PLUS SAME ADJUSTMENT   @Y17XANG 64500000
*                                       AS WHEN LGB STORED.    @Y17XANG 64530000
         C     R14,GETLGB               SAME GROUP(LGB)?       @Y17XANG 64560000
         BNE   NXTLINE                  BRANCH NO              @Y17XANG 64590000
         SPACE                                                          64620000
* THEN MAKE LINE ENTRY IN SORT TABLE.                          @Y17XANG 64650000
         SPACE                                                          64680000
         ST    RNLINE,GETTTE            TTE PTR FOR LINE       @Y17XANG 64710000
         STH   RCTR2,GETTTCIN           TNT INDEX OF LINE      @Y17XANG 64740000
         MVI   GETRLN,0                 CLEAR HI BYTE TBL RLN  @Y17XANG 64770000
         MVC   GETRLN+1(L'QCBRELLN),QCBRELLN REL LINE          @Y17XANG 64800000
         LA    RTBL,L'GETFIRST(RTBL)    NEXT SORT TABLE ENTRY  @Y17XANG 64830000
         SPACE                                                          64860000
* STEP TNT INDEX BY 1.                                         @Y17XANG 64890000
         SPACE                                                          64920000
NXTLINE  EQU   *                                               @Y17XANG 64950000
         LA    RCTR2,1(RCTR2)           NEXT TNT INDEX         @Y17XANG 64980000
         DROP  R15                                             @Y17XANG 65010000
         SPACE                                                          65040000
* IF TNT NOT EXHAUSTED GO GET NEXT ENTRY.                      @Y17XANG 65070000
         SPACE                                                          65100000
         CH    RCTR2,TNTLEN             LAST TNT PROCESSED?    @Y17XANG 65130000
         BNH   FETCHLN                  BRANCH NO              @Y17XANG 65160000
         SPACE                                                          65190000
* IF GROUP HAS LINES THEN SORT LINES BY LINE NUMBER AND LINK   @Y17XANG 65220000
* INTO GROUP-LINE HIERARCHY.                                   @Y17XANG 65250000
         SPACE                                                          65280000
         DROP  RTBL                                            @Y17XANG 65310000
         LA    R14,GETFIRST             1ST SORT TABLE ENTRY   @Y17XANG 65340000
         CR    R14,RTBL                 ANY LINES(TBL ENTRIES)?@Y17XANG 65370000
         BE    ELSEWTO                  BRANCH NO TO ELSE      @PI02869 65400000
         BAL   R14,SORTL                SORT LINES             @Y17XANG 65430000
         B     NXTLGB                   BYPASS ELSE            @Y17XANG 65460000
         SPACE                                                          65490000
* ELSE SEND MESSAGE TO OPERATOR : IED526 - GROUP HAS NO LINES. @Y17XANG 65520000
         SPACE                                                          65550000
ELSEWTO  EQU   *                                               @Y17XANG 65580000
         MVI   GRPNAME,C' '                                             65610000
         MVC   GRPNAME+1(8),GRPNAME BLANK GROUP NAME           @Y17XANG 65640000
         SR    R14,R14                                         @Y17XANG 65670000
         IC    R14,TNTENLEN             TNT NAME LEN           @Y17XANG 65700000
         LR    R15,RTNT1                                       @Y17XANG 65730000
         SR    R15,R14                  GROUP NAME ADDR        @Y17XANG 65760000
         BCTR  R14,0                    GROUP NAME LEN FOR MVC @Y17XANG 65790000
         EX    R14,MOVNAME              PUT NAME INTO WTO      @Y17XANG 65820000
         WTO   MF=(E,IED526I)           SEND OP CONSOLE MSG    @Y17XANG 65850000
         SPACE                                                          65880000
* INCREMENT LGB SEARCH INDEX AND RESET SORT TABLE.             @Y17XANG 65910000
         SPACE                                                          65940000
NXTLGB   EQU   *                                               @Y17XANG 65970000
         LA    RCTR1,1(RCTR1)           TNT INDEX + 1          @Y17XANG 66000000
         LA    RTBL,GETFIRST            FIRST SORT ENTRY       @Y17XANG 66030000
         SPACE                                                          66060000
* IF TNT HAS NOT BEEN COMPLETELY PROCESSED FOR LGBS THEN       @Y17XANG 66090000
* GO GET ANOTHER LGB.                                          @Y17XANG 66120000
         SPACE                                                          66150000
         CH    RCTR1,TNTLEN             TNT COMPLETE           @Y17XANG 66180000
         BNH   FETCHTTE                 BRANCH NO FOR MORE LGBS@Y17XANG 66210000
         SPACE                                                          66240000
* FREE SORT TABLE.                                             @Y17XANG 66270000
         SPACE                                                          66300000
         LM    R0,R1,AVTSAVE4+20        TABLE LEN + ADDR       @Y17XANG 66330000
         FREEMAIN R,LV=(0),A=(1)                               @Y17XANG 66360000
         SPACE                                                          66390000
* RETURN TO MAINLINE.                                          @Y17XANG 66420000
         SPACE                                                          66450000
         L     R14,SORTL14              RESTORE RETURN REG     @Y17XANG 66480000
         L     RBASE,SORTL12            RESTORE BASE REG       @Y17XANG 66510000
         BR    R14                      RETURN                 @Y17XANG 66540000
MOVNAME  MVC   GRPNAME(0),0(R15)        MOVE GROUP NAME TO WTO.@Y17XANG 66570000
         EJECT                                                 @Y17XANG 66600000
***************************************************************@Y17XANG 66630000
*                                                              @Y17XANG 66660000
* RLN SORT AND HIERARCHY BUILD ROUTINE.                        @Y17XANG 66690000
*                                                              @Y17XANG 66720000
***************************************************************@Y17XANG 66750000
SORTL    DS    0H                                              @Y17XANG 66780000
         SPACE                                                          66810000
* SET UP SORT.                                                 @Y17XANG 66840000
         SPACE                                                          66870000
         STM   RTNT1,RLEN,GETSAVE       SAVE REGS.             @Y17XANG 66900000
         LR    R0,R14                   SAVE RETURN            @Y17XANG 66930000
         LR    REOT,RTBL                                       @Y17XANG 66960000
         S     REOT,GETLEN              ADDRESS LAST TABLE     @Y17XANG 66990000
*                                       ENTRY.                 @Y17XANG 67020000
         LA    R1ST,GETFIRST            1ST TABLE ENTRY        @Y17XANG 67050000
         LR    RCURR,R1ST               CURRENT TABLE ENTRY    @Y17XANG 67080000
         SPACE                                                          67110000
* IF SORT COMPLETE GO LINK HIERARCHY.                          @Y17XANG 67140000
         SPACE                                                          67170000
SORTLOOP EQU   *                                               @Y17XANG 67200000
         CR    RCURR,REOT               END OF TABLE?          @Y17XANG 67230000
         BNL   HIERLINK                 BRANCH YES WE'RE THRU  @Y17XANG 67260000
         SPACE                                                          67290000
* IF CURRENT TABLE ENTRY  LE NEXT.....                        @Y17XANG 67320000
         SPACE                                                          67350000
         USING GETTTE,RCURR                                    @Y17XANG 67380000
         CLC   GETRLN,GETRLN+L'GETFIRST CURRENT LE NEXT RLN?   @Y17XANG 67410000
         BNH   ADTBL                    BRANCH YES             @Y17XANG 67440000
         SPACE                                                          67470000
* THEN SORT TABLE IN OPPOSITE DIRECTION.                       @Y17XANG 67500000
         SPACE                                                          67530000
         BAL   R14,RSORT                REVERSE SORT           @Y17XANG 67560000
         SPACE                                                          67590000
* ADVANCE TO NEXT TABLE ENTRY.                                 @Y17XANG 67620000
         SPACE                                                          67650000
ADTBL    EQU   *                                               @Y17XANG 67680000
         LA    RCURR,L'GETFIRST(RCURR)       NEXT ENTRY        @Y17XANG 67710000
         B     SORTLOOP                                        @Y17XANG 67740000
         SPACE                                                          67770000
* SET UP TO LINK HIERARCHY.                                    @Y17XANG 67800000
         SPACE                                                          67830000
HIERLINK EQU   *                                               @Y17XANG 67860000
         LA    RCURR,GETLGB             LGB ENTRY ADDRESS      @Y17XANG 67890000
*                     * * NOTE * *                             @Y17XANG 67920000
* LGB ADDRESS WAS ADJUSTED EARLIER SO THAT DISPLACEMENT OF     @Y17XANG 67950000
* LGBSUBST FIELD IS SAME RELATIVE DISPLACEMENT AS TRMCOHTG     @Y17XANG 67980000
* FROM PREFIX.  THEREFORE, LGB LINKED TO FIRST LINE SINCE LGB  @Y17XANG 68010000
* ENTRY IN TABLE IMMEDIATELY PRECEEDS FIRST LINE ENTRY.        @Y17XANG 68040000
         SPACE                                                          68070000
* LINK CURRENT LINE TO NEXT.                                   @Y17XANG 68100000
         SPACE                                                          68130000
NXTLINK  EQU   *                                               @Y17XANG 68160000
         LA    R14,TRMPRFSZ             PREFIX SIZE            @Y17XANG 68190000
         L     RTRM,GETTTE              TTE ADDRESS CURRENT ENT@Y17XANG 68220000
         SR    RTRM,R14                 PREFIX ADDRESS         @Y17XANG 68250000
         USING IEDNTRM,RTRM             PREFIX BASE            @Y17XANG 68280000
         LH    R14,GETTTCIN+L'GETFIRST       TTCIN NEXT ENTRY  @Y17XANG 68310000
         STH   R14,TRMCOHTG             LINK CURRENT TO NEXT   @Y17XANG 68340000
         SPACE                                                          68370000
* ADVANCE IN TABLE.                                            @Y17XANG 68400000
         SPACE                                                          68430000
         LA    RCURR,L'GETFIRST(RCURR)       NEXT ENTRY        @Y17XANG 68460000
         SPACE                                                          68490000
* IF NOT END OF TABLE GO BACK AND LINK NEXT ENTRY.             @Y17XANG 68520000
         SPACE                                                          68550000
         CR    REOT,RCURR               END OF TABLE?          @Y17XANG 68580000
         BNE   NXTLINK                  BRANCH NO              @Y17XANG 68610000
         SPACE                                                          68640000
* LINK LAST LINE TO LGB.                                       @Y17XANG 68670000
         SPACE                                                          68700000
         LA    R14,TRMPRFSZ             PREFIX SIZE            @Y17XANG 68730000
         L     RTRM,GETTTE              LAST LINE TTE ADDR     @Y17XANG 68760000
         SR    RTRM,R14                 PREFIX ADDR            @Y17XANG 68790000
         STH   RCTR1,TRMCOHTG           LINK TO LGB            @Y17XANG 68820000
         SPACE                                                          68850000
* RESTORE REGS                                                 @Y17XANG 68880000
         SPACE                                                          68910000
         LM    RTNT1,RLEN,GETSAVE                              @Y17XANG 68940000
         SPACE                                                          68970000
* RETURN TO LOOK FOR NEXT LGB                                  @Y17XANG 69000000
         SPACE                                                          69030000
         LR    R14,R0                   RETURN ADDR            @Y17XANG 69060000
         BR    R14                      RETURN                 @Y17XANG 69090000
         DROP  RTRM                                            @Y17XANG 69120000
         DROP  RTNT                                            @Y17XANG 69150000
         EJECT                                                 @Y17XANG 69180000
***************************************************************@Y17XANG 69210000
*                                                              @Y17XANG 69240000
* REVERSE DIRECTION SORT ROUTINE.                              @Y17XANG 69270000
*                                                              @Y17XANG 69300000
***************************************************************@Y17XANG 69330000
         SPACE                                                          69360000
RSORT    EQU   *                                               @Y17XANG 69390000
* SWAP CURRENT ENTRY WITH NEXT.                                @Y17XANG 69420000
         SPACE                                                          69450000
         XC    GETFIRST,GETFIRST+L'GETFIRST                    @Y17XANG 69480000
         XC    GETFIRST+L'GETFIRST,GETFIRST                    @Y17XANG 69510000
         XC    GETFIRST,GETFIRST+L'GETFIRST                    @Y17XANG 69540000
         SPACE                                                          69570000
* SAVE NEXT ENTRY ADDRESS FOR FORWARD SORT RESUMPTION.         @Y17XANG 69600000
         SPACE                                                          69630000
         ST    RCURR,GETSVCUR           SAVE                   @YM04690 69660000
         SPACE                                                          69690000
* RETREAT TO PREVIOUS ENTRY.                                   @Y17XANG 69720000
         SPACE                                                          69750000
         S     RCURR,GETLEN             PREVIOUS+PRESENT - ENT-@Y17XANG 69780000
*                                       RY LENGTH.             @Y17XANG 69810000
         SPACE                                                          69840000
* IF FIRST OF TABLE GO TO SUBROUTINE EXIT.                     @Y17XANG 69870000
         SPACE                                                          69900000
FRSTCHK  EQU   *                                               @Y17XANG 69930000
         CR    RCURR,R1ST               PRESENT LE 1ST ENTRY   @Y17XANG 69960000
*                                       ADDRESS?               @Y17XANG 69990000
         BNH   RSORTX                   BRANCH YES TO EXIT     @Y17XANG 70020000
         SPACE                                                          70050000
* CURRENT ENTRY GT NEXT IN TABLE(FORWARD)?                     @Y17XANG 70080000
         SPACE                                                          70110000
         CLC   GETRLN,GETRLN+L'GETFIRST IS IT?                 @Y17XANG 70140000
         BNH   BRKLOOP                  BRANCH NO TO ELSE      @Y17XANG 70170000
         SPACE                                                          70200000
* THEN SWAP ENTRIES.                                           @Y17XANG 70230000
         SPACE                                                          70260000
         XC    GETFIRST,GETFIRST+L'GETFIRST                    @Y17XANG 70290000
         XC    GETFIRST+L'GETFIRST,GETFIRST                    @Y17XANG 70320000
         XC    GETFIRST,GETFIRST+L'GETFIRST                    @Y17XANG 70350000
         B     RETREAT                  BRANCH AROUND ELSE     @Y17XANG 70380000
         SPACE                                                          70410000
* ELSE SET CURRENT ENTRY POINTER TO 1ST OF TABLE TO BREAK LOOP.@Y17XANG 70440000
         SPACE                                                          70470000
BRKLOOP  EQU   *                                               @Y17XANG 70500000
         LR    RCURR,R1ST                                      @Y17XANG 70530000
         SPACE                                                          70560000
* RETREAT TO PREVIOUS ENTRY.                                   @Y17XANG 70590000
         SPACE                                                          70620000
RETREAT  EQU   *                                               @Y17XANG 70650000
         S     RCURR,GETLEN             PREVIOUS ENTRY ADDR    @Y17XANG 70680000
         B     FRSTCHK                  GO BACK TO LOOP TOP    @Y17XANG 70710000
         SPACE                                                          70740000
* RESET CURRENT LOCATION TO SAVED RESUME ADDRESS FOR FORWARD   @Y17XANG 70770000
* SORT.                                                        @Y17XANG 70800000
         SPACE                                                          70830000
RSORTX   EQU   *                                               @Y17XANG 70860000
         L     RCURR,GETSVCUR                                  @Y17XANG 70890000
         SPACE                                                          70920000
* RETURN TO FORWARD SORT.                                      @Y17XANG 70950000
         SPACE                                                          70980000
         BR    R14                                             @Y17XANG 71010000
GETLEN   DC    A(L'GETFIRST)            LENGTH OF SORT TABLE   @Y17XANG 71040000
IED526I  WTO   'IED526I LINE GROUP XXXXXXXX HAS NO LINES',     @Y17XANG*71070000
               ROUTCDE=(2,11),DESC=6,MF=L                      @Y17XANG 71100000
GRPNAME  EQU   IED526I+23                                      @Y17XANG 71130000
SORTL12  DS    F                        MAINLINE BASE SAVE     @Y17XANG 71160000
SORTL14  DS    F                        MAINLINE RETURN REG    @Y17XANG 71190000
PARAD    DC    A(AVTPAR1)               ADDR GETMAIN ROUTINE   @Y17XANG 71220000
         DROP  RGETM                                           @Y17XANG 71250000
         DROP  RCURR                                           @Y17XANG 71280000
         DROP  RBASE                                           @Y17XANG 71310000
         DROP  RTNT1                                           @Y17XANG 71340000
         DROP  RNLINE                                          @Y17XANG 71370000
         EJECT                                                 @Y17XANG 71400000
***************************************************************@Y17XANG 71430000
* THIS ROUTINE INITIATES THE QCB TNT INDEX FIELD FOR 3705      @Y17XANG 71460000
* CLUSTERS, TERMINALS, LU'S AND CTERM TTE'S.                   @Y17XANG 71490000
*                                                              @Y17XANG 71520000
***************************************************************@Y17XANG 71550000
         SPACE                                                          71580000
SETTTCIN DS    0H                                              @Y17XANG 71610000
         USING SETTTCIN,R15                                    @Y17XANG 71640000
         USING IEDQTNTD,RTNT                                   @Y17XANG 71670000
         ST    RBASE,TTCIN12            SAVE MAINLINE BASE     @Y17XANG 71700000
         LR    RBASE,R15                SET BASE               @Y17XANG 71730000
         DROP  R15                                             @Y17XANG 71760000
         USING SETTTCIN,RBASE                                  @Y17XANG 71790000
         SPACE                                                          71820000
* SET TNT ENTRY, TNT ENTRY LENGTH AND TNT INDEX REGS.          @Y17XANG 71850000
         SPACE                                                          71880000
         SR    RFIRST,RFIRST                                   @Y17XANG 71910000
         IC    RFIRST,TNTENLEN          TNT NAME LENGTH        @Y17XANG 71940000
         LR    RLEN,RFIRST              SAVE IT                @Y17XANG 71970000
         LA    RFIRST,TNTFIRST(RFIRST)  ADDRESS OF ADDRESS     @Y17XANG 72000000
*                                       PORTION OF FIRST TNT   @Y17XANG 72030000
*                                       ENTRY.                 @Y17XANG 72060000
         LA    RLEN,L'TNTTRMAD(RLEN)    LENGTH TNT ENTRY       @Y17XANG 72090000
         LA    RTNT1,1                  FIRST TNT INDEX        @Y17XANG 72120000
         SPACE                                                          72150000
* IF THIS IS NOT A 3705 RESOURCE.                              @Y17XANG 72180000
         SPACE                                                          72210000
CKTYPE   EQU   *                                               @Y17XANG 72240000
         USING TNTTRMAD,RFIRST                                 @Y17XANG 72270000
         ICM   RTRM,ADDR,TNTTRMAD       TTE ADDRESS            @Y17XANG 72300000
         USING IEDQTRM,RTRM                                    @Y17XANG 72330000
         TM    TRMSTATE,TRMPREF         3705 RESOURCE?         @Y17XANG 72360000
         BZ    NXTQCB                   BRANCH NO              @Y17XANG 72390000
         SPACE                                                          72420000
* THEN IF THIS IS A PRE-SNA TERMINAL, CLUSTER, LU, OR CTERM    @Y17XANG 72450000
         SPACE                                                          72480000
         LA    RWORK,TRMPRFSZ           PREFIX SIZE            @Y17XANG 72510000
         SR    RTRM,RWORK               PREFIX ADDRESS         @Y17XANG 72540000
         USING IEDNTRM,RTRM                                    @Y17XANG 72570000
         CLI   TRMTYPE,TRMPSNA          PRE-SNA TERMINAL?      @Y17XANG 72600000
         BE    FTCHQCB                  BRANCH YES             @Y17XANG 72630000
         CLI   TRMTYPE,TRMLUNT          LU?                    @Y17XANG 72660000
         BE    FTCHQCB                  BRANCH YES             @Y17XANG 72690000
         CLI   TRMTYPE,TRMCLUST         CLUSTER?               @Y17XANG 72720000
         BNE   NXTQCB                   BRANCH NO              @Y17XANG 72750000
         SPACE                                                          72780000
* FETCH QCB.                                                   @Y17XANG 72810000
         SPACE                                                          72840000
FTCHQCB  EQU   *                                               @Y17XANG 72870000
         ICM   RQCB,ADDR,TRMDESTQ       QCB ADDRESS            @Y17XANG 72900000
         SPACE                                                          72930000
* SET QCBTTCIN.                                                @Y17XANG 72960000
         SPACE                                                          72990000
         LA    RWORK,QCBPRFSZ           QCB PREFIX SIZE        @Y17XANG 73020000
         SR    RQCB,RWORK               QCB PREFIX ADDRESS     @Y17XANG 73050000
         USING IEDNQCB,RQCB                                    @Y17XANG 73080000
         STH   RTNT1,QCBTTCIN           SET TTCIN              @Y17XANG 73110000
         DROP  RQCB                                            @Y17XANG 73140000
         SPACE                                                          73170000
* ADVANCE IN TNT.                                              @Y17XANG 73200000
         SPACE                                                          73230000
NXTQCB   EQU   *                                               @Y17XANG 73260000
         LA    RFIRST,0(RLEN,RFIRST)    NEXT TNT ENTRY ADDR    @Y17XANG 73290000
         LA    RTNT1,1(RTNT1)           NEXT ENTRY INDEX       @Y17XANG 73320000
         SPACE                                                          73350000
* IF NOT END OF TNT PROCESS NEXT ENTRY.                        @Y17XANG 73380000
         SPACE                                                          73410000
         CH    RTNT1,TNTLEN             END OF TNT?            @Y17XANG 73440000
         BNH   CKTYPE                   BRANCH NO              @Y17XANG 73470000
         SPACE                                                          73500000
* RETURN TO MAINLINE ROUTINE.                                  @Y17XANG 73530000
         SPACE                                                          73560000
         L     RBASE,TTCIN12            MAINLINE BASE          @Y17XANG 73590000
         BR    R14                                             @Y17XANG 73620000
TTCIN12  DC    A(0)                     MAINLINE BASE SAVE     @Y17XANG 73650000
         DROP  RTNT                                            @Y17XANG 73680000
         DROP  RFIRST                                          @Y17XANG 73710000
         DROP  RTRM                                            @Y17XANG 73740000
*                                                                       73770000
         EJECT                                                          73800000
IDERRMSG EQU   *                                               @G36XRNP 73830000
         USING IDERRMSG,R8                                     @G36XRNP 73860000
         EX    RLENTN,MVCID             INIT ERROR MSG         @G36XRNP 73890000
         OI    AVTGETMN,ALTDSTER        INDICATE ERROR         @G36XRNP 73920000
         LR    RWORK,RPRESENT           SAVE TNT POINTER       @G36XRNP 73950000
         LA    RPRESENT,DIDMSG          MSG ADDR               @G36XRNP 73980000
         SVC   35                                              @G36XRNP 74010000
         LR    RPRESENT,RWORK           RESTORE TNT POINTER    @G36XRNP 74040000
         BR    RLINK                    RETURN                 @G36XRNP 74070000
MVCID    MVC   DIDMSGC(0),0(RPRESENT)   MVE TRM NAME TO ERR MSG@G36XRNP 74100000
         CNOP  0,4                                             @G36XRNP 74130000
DIDMSG   DC    AL2(IDMEND-*)            MSG LENGTH             @G36XRNP 74160000
         DC    X'1000'                  MSG FLAGS              @G36XRNP 74190000
         DC    C'IED138I '              MSG NUMBER             @G36XRNP 74220000
         DC    C'ERROR SORTING DEVICE ID TABLE ' MSG TEXT      @G36XRNP 74250000
DIDMSGC  DC    CL9' '                   TERMINAL NAME          @G36XRNP 74280000
IDMEND   EQU   *                        MSG END                @G36XRNP 74310000
         DC    X'1000'                  DECSRIPTOR CODES       @G36XRNP 74340000
         DC    X'0020'                  ROUTING CODES          @G36XRNP 74370000
         CNOP  0,4                                             @G36XRNP 74400000
         DROP  R8                                              @G36XRNP 74430000
         USING IEDQOA,RBASE                                    @OY19405 74460082
         USING DISPATR,R6                                      @OY19405 74463082
DISPATR  L     R1,AVTDISTR              LOAD THE NUMBER  TRACE @OY19405 74466082
*                                         ENTRIES REQUESTED    @OY19405 74469082
         LA    R1,ONE(,R1)              INCREMENT THE COUNT 1  @OY19405 74472082
         SLL   R1,FOUR                  MULTIPLY THE NUMBER    @OY19405 74475082
*                                       ENTRIES BY THE ENTRY SZ@OY19405 74478082
         LR    R3,R1                    COPY THE TRACE SIZE    @OY19405 74481082
         LA    R0,AVTDISTR              LOAD THE ADDRESS OF THE@OY19405 74484082
*                                         RECEIVING AREA       @OY19405 74487082
         BAL   R14,AVTPAR               LINK TO THE GETMAIN    @OY19405 74490082
*                                              ROUTINE         @OY19405 74493082
         L     R2,AVTDISTR              LOAD THE ADDRESS OF THE@OY19405 74496082
*                                         TRACE AREA           @OY19405 74499082
         LR    R1,R3                    COPY THE SIZE          @OY19405 74502082
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *@OY19405 74505082
*                                                              @OY19405 74508082
*        CLEAR THE TRACE AREA                                  @OY19405 74511082
*                                                              @OY19405 74514082
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *@OY19405 74517082
*                                                              @OY19405 74520082
TRACLEAR EQU   *                                               @OY19405 74523082
         MVI   0(R2),AVTEZERO           CLEAR ONE BYTE         @OY19405 74526082
         LA    R2,ONE(,R2)              INCREMENT TRACE AREA   @OY19405 74529082
*                                         ADDRESS              @OY19405 74532082
         BCT   R1,TRACLEAR              DECREMENT THE COUNT    @OY19405 74535082
*                                         AND BRANCH           @OY19405 74538082
         L     R1,AVTDISTR              LOAD THE BEGINNING ADDR@OY19405 74541082
*                                         OF THE TRACE AREA    @OY19405 74544082
         LR    R4,R1                    COPY THE CONTROL WORD  @OY19405 74547082
*                                         ADDRESS              @OY19405 74550082
         LA    R1,16(,R1)               GET THE ADDRESS OF THE @OY19405 74553082
*                                         TRACE AREA ITSELF    @OY19405 74556082
         ST    R1,0(,R4)                STORE THE BEGIN ADDR   @OY19405 74559082
         ST    R1,4(,R4)                STORE IT ONCE MORE     @OY19405 74562082
         LA    R0,ENTRYSIZ              GET THE SIZE OF A TRACE@OY19405 74565082
*                                         ENTRY                @OY19405 74568082
         SR    R2,R0                    CALCULATE THE ADDRESS  @OY19405 74571082
*                                         OF THE LAST ENTRY    @OY19405 74574082
         ST    R2,8(,R4)                STORE THE ADDRESS IN   @OY19405 74577082
*                                         THE CONTROL LIST     @OY19405 74580082
         ST    R3,12(,R4)               STORE THE SIZE OF AREA @OY19405 74583082
*                                         IN THE CONTROL LIST  @OY19405 74586082
         B     TESTBUFT                   DO NEXT TEST         @OY19405 74589082
         DROP  R6                                              @OY19405 74592082
         EJECT                                                 @OY19405 74595082
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *@OY19405 74598082
         EJECT                                                          74601082
***************************************************************@OY19405 74604082
*        GET STORAGE FOR BUFFER TRACE.  THIS RTN IS BRANCHED   @OY19405 74607082
*        TOO, INSTEAD OF BEING INLINE, TO AVOID SETTING UP A   @OY19405 74610082
*        SECOND BASE REGISTER FOR THE MODULE.                  @OY19405 74613082
***************************************************************@OY19405 74616082
*                                                              @OY19405 74619082
BUFFRTN  EQU   *                                               @OY19405 74622082
         USING BUFFRTN,R6                                      @OY19405 74625082
         LH    R1,AVTBUENT              NO. OF TABLE ENTRIES   @OY19405 74628082
         LA    R1,ONE(R1)               ROUND UP TO AN EVEN ...@OY19405 74631082
         SRL   R1,ONE                   ... NUMBER IF ODD      @OY19405 74634082
         SLL   R1,ONE                                          @OY19405 74637082
         LR    R3,R1                    SAVE # ENTRIES         @OY19405 74640082
         LA    R5,BUFFTRSZ              FIXED TRACE ENTRY SIZE @OY19405 74643082
         AH    R5,AVTKEYLE              ADD KEY LEN            @OY19405 74646082
         LA    R5,X'1F'(R5)             ALIGN EACH ENTRY       @OY19405 74649082
         SRL   R5,5                     TO NEXT SIZE DIV BY    @OY19405 74652082
         SLL   R5,5                     HEX 20                 @OY19405 74655082
         MR    R0,R5                    LENGTH OF ENTRIES IN R1@OY19405 74658082
         LA    R1,2*HDRSZ+BUFFCTBL(R1)  TABLE SIZE = LENGTH OF @OY19405 74661082
*                                       ENTRIES + CONTROL AREA.@OY19405 74664082
*                                       + 2 HALF TABLE HEADERS.@OY19405 74667082
         LR    R5,R1                    SAVE TABLE SIZE        @OY19405 74670082
         LA    R0,AVTBUFTR              ADDR TO RECEIVE TABLE  @OY19405 74673082
*                                       ADDRESS FROM GETMAIN.  @OY19405 74676082
         BAL   R14,AVTPAR               LINK TO GETMAIN        @OY19405 74679082
         LR    R1,R5                    RESTORE TABLE SIZE     @OY19405 74682082
         USING IEDTRBUF,R2                                     @OY19405 74685082
         L     R2,AVTBUFTR              ADDRESS OF TRACE TABLE @OY19405 74688082
         LA    R5,CUR1                  FIRST TABLE ADDRESS    @OY19405 74691082
         ST    R5,CUR                   STORE IN CONTROL AREA  @OY19405 74694082
         LA    R5,BUFFCTBL(R2)          ADD. OF 1ST TABLE      @OY19405 74697082
         ST    R5,TABLE1                STORE IN CONTROL AREA  @OY19405 74700082
         LA    R1,0(R1,R2)              ADDRESS END OF TABLE   @OY19405 74703082
         ST    R1,CUR2+EIGHT            STORE AS LAST OF 2ND   @OY19405 74706082
         LR    R1,R3                    NUMBER OF ENTRIES      @OY19405 74709082
         LA    R3,BUFFTRSZ              GET THE SIZE           @OY19405 74712082
         AH    R3,AVTKEYLE              OF EACH TRACE ENTRY    @OY19405 74715082
         LA    R3,X'1F'(R3)             ALIGN                  @OY19405 74718082
         SRL   R3,5                          ENTRY             @OY19405 74721082
         SLL   R3,5                                SIZE        @OY19405 74724082
         MR    R2,R1                    ENTRIES * ENTRY SIZE   @OY19405 74727082
         SRL   R3,1                     DIVIDED BY TWO         @OY19405 74730082
         LA    R3,HDRSZ(R3)             PLUS HEADER SIZE       @OY19405 74733082
         LA    R1,HDRSZ(R5)             ADD IN HEADER SIZE     @OY19405 74736082
         L     R2,AVTBUFTR              RESTORE TABLE ADDRESS  @OY19405 74739082
         ST    R1,CUR1                  ADD. OF TABLE1 1ST ENT.@OY19405 74742082
         ST    R1,CUR1+FOUR             ADD. OF CURRENT ENTRY  @OY19405 74745082
         AR    R5,R3                    TABLE SIZE + 1ST TBL   @OY19405 74748082
         ST    R5,TABLE2                STORE TABLE2 ADDRESS   @OY19405 74751082
         ST    R5,CUR1+EIGHT            AND LAST ENTRY TABLE1  @OY19405 74754082
         LA    R5,HDRSZ(R5)             ADD HEADER SIZE        @OY19405 74757082
         ST    R5,CUR2                  FIRST ENTRY TABLE2     @OY19405 74760082
         ST    R5,CUR2+FOUR             CURRENT ENTRY TABLE2   @OY19405 74763082
         MVC   COUNT(4),AVTFZERO        CLEAR COUNT FIELD      @OY19405 74766082
         L     R3,TABLE1                GET START OF TABLE1    @OY19405 74769082
         L     R5,CUR2+EIGHT            GET END OF TABLE2      @OY19405 74772082
         SPACE                                                          74775082
* CLEAR TRACE TABLE                                            @OY19405 74778082
         SPACE                                                          74781082
TBLCLR   XC    0(HDRSZ,R3),0(R3)        CLEAR 16 BYTES         @OY19405 74784082
         LA    R3,HDRSZ(R3)             BUMP ADDRESS           @OY19405 74787082
         CR    R3,R5                    END OF TRACE TABLE     @OY19405 74790082
         BL    TBLCLR                   NO, LOOP               @OY19405 74793082
         SPACE                                                          74796082
         L     R3,TABLE1                GET TABLE1 START       @OY19405 74799082
         LA    R3,12(R3)                GET ADD. OF BUFFER ID  @OY19405 74802082
         MVI   0(R3),C'1'               MOVE IN BUFFER ID      @OY19405 74805082
         L     R3,TABLE2                GET TABLE2 START       @OY19405 74808082
         LA    R3,12(R3)                GET ADD. OF BUFFER ID  @OY19405 74811082
         MVI   0(R3),C'2'               MOVE IN BUFFER ID      @OY19405 74814082
         B     TPIOTRAC                 RETURN TO MAIN LINE    @OY19405 74817082
         DROP  R6                                              @OY19405 74820082
         DROP  R2                                              @OY19405 74823082
         EJECT                                                          74826082
ONE      EQU   1                        ONE                    @OY19405 74829082
TWO      EQU   2                        TWO                      S21903 74880000
SHIFT2   EQU   2                        SHIFT 2                  S21903 74910000
THREE    EQU   3                        THREE                    S21903 74940000
FOUR     EQU   4                        FOUR                     S21903 74970000
SIX      EQU   6                        SIX                      S21903 75000000
ROUND    EQU   7                        SEVEN                    S21903 75030000
NUM      EQU   8                        CHARACTERS/PASSWORD             75060000
EIGHT    EQU   8                        EIGHT                    S21903 75090000
TEN      EQU   10                       TEN                      S21903 75120000
TWELVE   EQU   12                       TWELVE                   S21903 75150000
FIFTEEN  EQU   15                       FIFTEEN                  S21903 75180000
SIXTEEN  EQU   16                       SIXTEEN                  S21903 75210000
THRTTWO  EQU   32                       CONSTANT OF THIRTY TWO   X01004 75240000
ENTRYSIZ EQU   16                       SIZE OF TRACE ENTRY      S21903 75270000
WORK     EQU   20                       SAVEAREA OFFSET TO WORKAREA     75300000
TWENTY   EQU   20                       TWENTY                   S21903 75330000
SENDACPT EQU   24                       SEND AND ACCEPT BITS            75360000
RETCDE   EQU   24                       RET CDE FOR ID SORT      S22026 75390000
ENTRYTYP EQU   X'E0'                    SINGLE ENTRY             S21903 75420000
IOTRCSIZ EQU   16                       SIZE OF I/O TRACE ENTRY  S21903 75450000
MQCBSIZE EQU   32                       MASTER QCB SIZE          S22027 75480000
PERCENT  EQU   100                      PERCENTAGE FACTOR               75510000
NOSWAP   EQU   X'00'                    TO RESET SWAP INDICATOR         75540000
HEXZERO  EQU   X'00'                    HEXADECIMAL ZERO         S21903 75570000
SECOPCTL EQU   X'01'                    SECONDARY OP CNTRL       S21903 75600000
BOUND8   EQU   X'08'                    EIGHT BYTE BOUNDARY.            75630000
XR       EQU   X'0F'                    BIT FLIPPER (4-7)               75660000
BOUND32  EQU   X'1F'                    32 BYTE BOUNDARY         S21903 75690000
ALTDSTER EQU   X'20'                    HEX 20                   S22024 75720000
VTO      EQU   X'26'                    COMMON BUFFER VTO        S22027 75750000
INVLSRTD EQU   X'40'                    HEX 40                   S22024 75780000
CDLSTNOW EQU   X'40'                    HEX 40                   S22024 75810000
CORDLIST EQU   X'40'                    HEX 40                   S22024 75840000
SINGLINE EQU   X'60'                    SINGLE OR LINE ENTRY     S21903 75870000
LOGTYPE  EQU   X'60'                    LOG ENTRY                S21903 75900000
TSOTERM  EQU   X'70'                    TO TEST FOR TSO TERMINAL        75930000
LGB      EQU   X'80'                    HEX 80                   S22024 75960000
LINE     EQU   X'80'                    HEX 80                   S22024 75990000
LGBLNCT  EQU   24                       TWENTY4                  S22024 76020000
SWAP     EQU   X'80'                    TO INDICATE SORT IN PROGRESS    76050000
ILISTNOW EQU   X'80'                    HEX 80                   S22024 76080000
ILISORTD EQU   X'80'                    HEX 80                   S22024 76110000
CONC     EQU   X'80'                    CONC OR ATTACHED TERM    S21903 76140000
ILISTOFF EQU   X'7F'                    HEX 7F                   S22024 76170000
NR       EQU   X'BF'                    NON-BLANK MASK                  76200000
CDLSTOFF EQU   X'BF'                    HEX BF                   S22024 76230000
IOTRCFLG EQU   X'C0'                    I/O TRACE FLAG           S21903 76260000
PRIORITY EQU   X'90'                    COMMBUF PRIORITY         S22027 76290000
VIRTFLG  EQU   X'80'                    VIRTUAL MACHINE        @YA10680 76320000
LOGREC   EQU   X'74'                    OFFSET TO LOGREC DCB   @YA10680 76350000
CCHPTR   EQU   X'0C'                    OFFSET TO CCH CAT      @YA10680 76380000
VMFLG    EQU   X'FF'                    VIRTUAL CPU            @YA10680 76410000
VMCODE   EQU   X'20'                    VM ERROR RETURN CODE   @YA10680 76440000
MSGX     EQU   MSG065+37                *****                    S22024 76470000
MSGC     EQU   MSG+16                   *****                    S22024 76500000
LCCWSZ   EQU   8                        SIZE OF VTAM LCCW        X03039 76530000
IEDTRBUF DSECT                                                 @OY19405 76532082
CUR      DS    AL4                 TABLE BEING USED            @OY19405 76534082
TABLE1   DS    AL4                                             @OY19405 76536082
TABLE2   DS    AL4                                             @OY19405 76538082
CUR1     DS    AL4                 CURRENT ENTRY TABLE ONE     @OY19405 76540082
         DS    AL4                 FIRST ENTRY POINTER         @OY19405 76542082
         DS    AL4                 LAST ENTRY POINTER          @OY19405 76544082
CUR2     DS    AL4                 POINTERS FOR TABLE TWO      @OY19405 76546082
         DS    AL4                 FIRST                       @OY19405 76548082
         DS    AL4                 LAST                        @OY19405 76550082
COUNT    DS    AL4                 COUNT OF TABLES USED        @OY19405 76552082
IEDTREND DS    0H                                                       76554082
BUFFTRSZ EQU   X'18'               BUFFER TRACE ENTRY SIZE     @OY19405 76556082
BUFFCTBL EQU   IEDTREND-IEDTRBUF   SIZE OF CONTROL TABLE       @OY19405 76558082
         EJECT                                                          76560000
         TAVTD                                                          76590000
         TCPBD 3330                                                     76620000
         IEDCMB                                                  S22027 76650000
GETD     DSECT                                                 @Y17XANG 76680000
GETSAVE  DS    3A                       REGISTER SAVE          @Y17XANG 76710000
GETSVCUR DS    A                        CURRENT SORT POSITION  @Y17XANG 76740000
GETLGB   DS    2A                       LGB ADDRESS SAVE       @Y17XANG 76770000
*                                       MUST BE 2 WORDS AND    @Y17XANG 76800000
*                                       ALWAYS PRECEED 1ST     @Y17XANG 76830000
*                                       LINE ENTRY.            @Y17XANG 76860000
GETFIRST DS    0CL8                     SORT TABLE ENTRY       @Y17XANG 76890000
GETTTE   DS    A                                               @Y17XANG 76920000
GETTTCIN DS    H                                               @Y17XANG 76950000
GETRLN   DS    H                                               @Y17XANG 76980000
         EJECT                                                          77010000
         TLCBD                                                   X03039 77040000
         SPACE 2                                                        77070000
         TTRMD                                                          77100000
         TTNTD                          TERMNAME TABLE MACRO            77130000
         EJECT                                                          77160000
TTRCCTLD DSECT                          TPIO TRACE CONTROL AREA  X03039 77190000
TTRCCURR DS    F                        CURRENT ENTRY ADDRESS    X03039 77220000
TTRCFRST DS    F                        FIRST ENTRY ADDRESS      X03039 77250000
TTRCLAST DS    F                        LAST ENTRY ADDRESS       X03039 77280000
TTRCFLGS DS    XL1                      FLAGS                  @XA07498 77310000
TTRCTSYS EQU   X'10'                    TRACE TOTAL SYSTEM BIT @XA07498 77340000
TTRCRTNA DS    AL3                      TPIO TRACE RTN ADDRESS @XA07498 77370000
TTRCMIDL DS    F                        MIDDLE ENTRY ADDRESS     X03039 77400000
TTRCLNTH DS    F                        LENGTH OF EACH HALF-TABLEX03039 77430000
TTRCEND  DS    0H                       END OF CONTROL AREA      X03039 77460000
*                                                                X03039 77490000
CNTRLSZ  EQU   TTRCEND-TTRCCTLD         SIZE OF CONTROL AREA     X03039 77520000
HDRSZ    EQU   16                       SIZE OF HALF-TABLE HEADERX03039 77550000
ENTRYSZ  EQU   32                       SIZE OF PIU TRACE ENTRY@Y17XANG 77580000
         EJECT                                                          77610000
         TQCBD                          QCB DSECT                       77640000
         TQCBED                                                  S22026 77670000
         TDVCIDTD                                                S22026 77700000
         DCBD  DSORG=TX                                                 77730000
         TLGBD                                                 @Y17XANG 77760000
         TTSID                                                          77790000
         EJECT                                                          77820000
CVTDSECT CVT   DSECT=YES                                                77850000
         END                                                            77880000
./  ADD  SSI=80510339,NAME=IEDQOB
WTOR     TITLE '''IEDQOB''-WTOR INTERPRETER'                            00080020
IEDQOB   CSECT                                                          00160020
*A000000-999999                                                @G36XRNP 00160210
         SPACE 3                                                 S21903 00160405
*  CHANGE ACTIVITY AS FOLLOWS                                           00160805
******************** MICROFICHE FLAGS *********************** SUPT CODE 00161205
*A001620,002500-003000,135285,628400,638600-639000,640400       SA51078 00161605
*A654500-654900,657600-659400                                   SA51078 00161705
*D657600-659200                                                 SA51078 00161805
*A117600                                                         S21101 00161905
*C133600                                                         S21101 00162005
*A135200                                                         S21101 00162105
*C136000                                                         S21101 00162205
*D140000                                                         S21101 00162305
*C162800-165600                                                  S21101 00162405
*D167200                                                         S21101 00162505
*C172400-173200                                                  S21101 00162605
*A176000                                                         S21101 00162705
*C179200-182400,187200,279200-283200                             S21101 00162805
*D285600-326400                                                  S21101 00162905
*C394400,396800-400800,575200-578400,704800-708800               S21101 00163005
*A736000,948000,951200                                           S21101 00163105
*D955200                                                         S21101 00163205
*A959200                                                         S21101 00163305
*D960000-967840,969600                                           S21101 00163405
*A135583,432830-433490                                           S22024 00163505
*C194400,202400-338400,362400,369000-369400                      S22024 00163605
*C959220-959350,959490-959706                                    S22024 00163705
*C532000,535200-536000,9516000                                   S22024 00163805
*A 950400                                                       SA63008 00163905
*C 459200                                                       SA63008 00164005
*C959454,959535,919715                                           X03039 00174007
*D369000,432830,433070,959445,959530,959710                      X03039 00184007
*C532000,535200-536000,951600                                    S05331 00194052
*A361200,A403280-403840,A624020-624660,D959427-959454,           Y05331 00194105
*A959427-959459,A959526-959527,C959530-959531,C959700-959703     Y05331 00194205
*C612000                                                       @SA70222 00204256
*A185600,187600                                                @SA70307 00214256
*A369200,432800,959451,959530                                    X03039 00224207
*A135583,369300,433070,959535,959711                           @X50X9NI 00224309
*A135586,624520                                                @ZA07074 00224481
*C959526-959527                                                @ZA07074 00224581
*A403360                                                       @OZ06187 00224691
*A056000,064000,132800,366400,369350,385600,432830,432980      @Y17XANG 00227600
*A659400,959535,959537,959715,972000                           @Y17XANG 00230600
*C005000,059200,064000,365600-366400,948800                    @Y17XANG 00233600
*D433040-433071,959720                                         @Y17XANG 00236600
*D431500-431700,443400-443800                                  @Y17XANA 00237600
*C532000,535200-536000,951600                                  @Y17XANU 00238600
         SPACE 3                                                 S21903 00240005
*          TCAM LEVEL 10.0 MVS CHANGES                         @G36XRNP 00250010
*A036000,056720,119600,135290,135440,135588,160000,369390      @G36XRNP 00260010
*A638800,642400,645600,649600,652800,654700,654800,659596      @G36XRNP 00270010
*A736080,959466,959541,959727                                  @G36XRNP 00280010
*A628400,638800,642400,645600,649600,652800,654700654900       @OS77945 00285010
*A640400                                                       @OS77945 00290010
*A557660,557740,952000                                         @OZ17630 00295010
*********************************************************************** 00300005
*                                                                     * 00320005
*  TITLE: IEDQOB - WTOR INTERPETER                                    * 00340005
*                                                                     * 00360005
*  MODULE NAME = IEDQOB (TCAM,INITIALIZATION)                  @G36XRNP 00380010
*                                                                     * 00400005
*  DESCRIPTIVE NAME = WTOR INTERPETER                                 * 00420005
*                                                                     * 00440005
*  COPYRIGHT = 'NONE'                                                 * 00460005
*                                                                     * 00480005
*STATUS -- CHANGE LEVEL 10.0                                   @G36XRNP 00490010
*                                                                     * 00560020
*FUNCTION -- THIS ROUTINE ACCEPTS FROM THE OPERATOR NEW VALUES TO     * 00640020
*   REPLACE THOSE VALUES SPECIFIED AT ASSEMBLY TIME ON CERTAIN        * 00720020
*   KEYWORDS ON INTRO MACRO.  THIS PERMITS SYSTEM REDEFINITION        * 00800020
*   WITHOUT REASSEMBLY.                                               * 00880020
*                                                                     * 00960020
*ENTRY POINTS -- CALLED ONLY FROM 'IEDQOA'                            * 01040020
*        'IEDQOB' - INTERPRET OPERATOR RESPONSES                      * 01120020
*   CALLING SEQUENCE IS                                               * 01200020
*        LINK  EP=IEDQOB                                       @G36XRNP 01280010
*                                                                     * 01600020
*INPUT -- REGISTERS AT INPUT MUST BE SET AS FOLLOWS -                 * 01680020
*   REG 1 - ADDRESS OF AVT                                            * 01760020
*   REG 13- ADDRESS OF CALLER'S SAVEAREA                              * 01840020
*   REG 14- RETURN ADDRESS                                            * 01920020
*   REG 15- ENTRY POINT ADDRESS                                       * 02000020
*   ADDITIONAL DATA IS RECEIVED FROM THE OPERATOR AS RESPONSES        * 02080020
*   TO REQUESTS MADE BY WTOR.                                         * 02160020
*                                                                     * 02240020
*OUTPUT -- CERTAIN FIELDS OF THE AVT HAVE BEEN MODIFIED ACCORDING     * 02320020
*   TO OPERATOR'S REPLY.  ALL REGISTERS ARE RETURNED INTACT.          * 02400020
*                                                                     * 02480020
*EXTERNAL ROUTINES -- SUPERVISOR IS CALLED TO PROVIDE 'WTOR' AND      * 02560020
*   'WAIT' FUNCTIONS.                                                 * 02640020
*                                                                     * 02720020
*EXITS-NORMAL -- RETURN IS MADE TO IEDQOA.  USER HAS SPECIFIED        * 02800010
*   ONE OF THESE INTRO OPERANDS IN RESPONSE TO WTOR REQUESTS.  @G36XRNP 02810010
*                                                              @G36XRNP 02820010
*     CPB - NUMBER OF CHANNEL PROGRAM BLOCKS  - REQUIRED IF    @G36XRNP 02830010
*           DISK=YES IS SPECIFIED                              @G36XRNP 02840010
*     EITHER ON INTRO OPERANDS OF IN RESPONSES TO WTOR REQUESTS -     * 02880010
*     LNUNITS - NUMBER OF LINE BUFFERS                                * 02960010
*     KEYLEN - LENGTH OF KEY PORTION OF DATA RECORD                   * 03040010
*     START - WARM OR COLD                                            * 03120010
*     OTHER FIELDS OF AVT MAY HAVE BEEN ALTERED ALSO. (OPTIONAL)      * 03200010
*     RETURN CODE IN REGISTER 15 IS ZERO.                             * 03280010
*                                                                     * 03360020
*EXITS-ERROR -- RETURN CODE IN REGISTER 15 IS 4.  THE TCAM WORD IN    * 03440020
*   THE CVT IS NON-ZERO, INDICATING ANOTHER TCAM IS ACTIVE.           * 03520020
*               RETURN CODE IN REGISTER 15 IS 28.  THE TCB     @G36XRNP 03540010
*               INDICATES THAT THE TCAM MCP IS UNAUTHORIZED    @G36XRNP 03560010
*                                                                     * 03600020
*TABLES-WORK AREAS -- CERTAIN FIELDS IN AVT MAY HAVE BEEN MODIFIED.   * 03680020
*        INTRO KEYWORD    RESPONSES KEYWORD  AVT FIELD  FIELD LENGTH  * 03760020
*        STARTUP          S                 AVTBIT3    4 BITS         * 03840020
*        LNUNITS          B                 AVTNOLBF   2 BYTES        * 03920020
*        MSUNITS          M                 AVTTOTNC   4 BYTES        * 04000020
*        KEYLEN           K                 AVTKEYLE   2 BYTES        * 04080020
*        UNITSZ           K                 AVTKEYLE   2 BYTES        * 04130020
*        RESTART          N                 AVTCKRST   1 BYTE         * 04180020
*        CPINTVL          V                 AVTCKELV   2 BYTES        * 04250020
*        CONTROL          L                 AVTCTLCH   8 CHARS        * 04320020
*        PRIMARY          P                 AVTDOUBX   8 CHARS        * 04400020
*        INTVAL           I                 AVTINTLV   2 BYTES        * 04480020
*        PASSWRD          W                 AVTPASWD   8 CHAR         * 04560020
*        CKREQS           R                 AVTNCKPR   1 BYTE         * 04640020
*        CPB              D                 AVTCPBNO   2 BYTES        * 04720020
*        CPRCDS           E                 AVTCPRCD   1 BYTE         * 04800020
*        CROSSRF          F                 AVTCRSRF   4 BYTES        * 04880020
*        COMWRTE          G                 AVTCWFL1   1 BIT          * 04960020
*        TOPMSG           H                 AVTBIT2    1 BIT          * 05040020
*        TRACE            T                 AVTRACE    4 BYTES        * 05120020
*        DTRACE           A                 AVTDISTR   4 BYTES        * 05200020
*        CIB              C                 AVTCIB     2 BYTES        * 05280020
*        MSMIN            Y                 AVTCMIN    4 BYTES        * 05360020
*        MSMAX            X                 AVTCMAX    4 BYTES        * 05440020
*        DLQ              Q                 AVTDLQX    8 BYTES        * 05520020
*        OLTEST           O                 AVTOLTST   1 BYTE         * 05600020
*        BRACKET          BR                SAVTBSM    4 BYTES @Y17XANG 05608000
*        OPMASK           OP                AVTOPMSK   4 BYTES @Y17XANG 05616000
*        PLCBNO           PL                AVTPLCBN   2 BYTES @Y17XANG 05624000
*        SUBAREA          SA                SAVTSUBV   1 BYTE  @Y17XANG 05632000
*        MAXSUBA          MA                SAVTSUBA   1 BYTE  @Y17XANG 05640000
*        BTRACE           BT                SAVTPIUT   4 BYTES @Y17XANG 05648000
*        TTRACE           TT                SAVTPIUT   4 BYTES @Y17XANG 05656000
*        SIBCNT           SB                SAVTSIBC   2 BYTES @Y17XANG 05664000
*        VM               Z                 SAVTDIAF   1 BYTE  @Y17XANG 05672000
*        APWAS            WA                AVTEW      2 BYTES @G36XRNP 05674010
*        AUTHA            AU                AVTEW+2    1 BIT   @G36XRNP 05676010
*   OTHER INTRO KEYWORDS CANNOT BE MODIFIED BY OPERATOR.              * 05680020
*                                                                     * 05760020
*   IF INTRO IS ASSEMBLED WITH KEYLEN, CPB (OR DISK=NO), STARTUP,     * 05840020
*   LNUNITS AND SUBAREA(OR FEATURES=NO3705 OR NOVTAM)          @Y17XANG 05860000
*   SPECIFIED, THE OPERATOR IS NOT GIVEN                       @Y17XANG 05880000
*   THE OPPORTUNITY TO MODIFY ANY INTRO VALUES AT EXECUTION TIME      * 06000020
*   SINCE THIS ROUTINE WILL SKIP ISSUEING THE 'WTOR'.  TO BE ABLE     * 06080020
**  TO MAKE EXECUTION TIME MODIFICATIONS, AT LEAST ONE OF THESE       * 06160020
*   FOUR MUST BE OMITTED FROM THE INTRO ASSEMBLY.                     * 06240020
*                                                                     * 06320020
*   FOLLOWING MACROS ARE USED TO GENERATE DSECTS - TAVTD,CVT,  @Y17XANG 06340000
*   TMSKD,TTCBD. THE FOLLOWING SYSTEM MACROS ARE USED - WTO,   @Y17XANG 06360000
*   WTOR, WAIT, DOM, RETURN, SAVE.                             @Y17XANG 06380000
*                                                                     * 06480020
*ATTRIBUTES -- TRANSIENT, NON-REUSABLE, NON-REFRESHABLE, ENABLED,     * 06560020
*   PROBLEM PROGRAM MODE                                              * 06640020
*                                                                     * 06720020
*NOTES -- THE OPERATION OF THIS SUBROUTINE DEPENDS UPON AN INTERNAL   * 06800020
*   REPRESENTATION OF THE EXTERNAL CHARACTER SET WHICH IS EQUIVALENT  * 06880020
*   TO THE ONE USED AT ASSEMBLY TIME.  THE CODING HAS BEEN ARRANGED   * 06960020
*   SO THAT REDIFINITION OF 'CHARACTER' CONSTANTS, BY REASSEMBLY,     * 07040020
*   WILL RESULT IN A CORRECT MODULE FOR THE NEW DEFINITIONS.          * 07120020
*                                                                     * 07200020
*   MESSAGES TO OPERATOR -                                            * 07280020
*  'IED001I TCAM JOB JJJJJJJJSSSSSSSSPPPPPPPP ADDRESS OF AVT AAAAAAAA'* 07360010
*        'JJJJJJJJ' - JOB NAME                                        * 07440020
*        'SSSSSSSS' - STEP NAME                                       * 07520020
*        'PPPPPPPP' - PROC STEP NAME.                                 * 07600020
*        'AAAAAAAA' - ADDRESS OF AVT                           @G36XRNP 07640010
*   'IED002A SPECIFY TCAM PARAMETERS'                                 * 07680020
*        SYSTEM WAITS FOR USER RESPONSE.  REPLY MUST BE LIMITED       * 07760020
*        TO 41 CHARACTERS.  RESPONSE IS BY KEYWORDS,SEPARATED BY      * 07840020
*        COMMAS.  SEVERAL KEYWORDS MAY BE CODED IN ONE RESPONSE,      * 07920020
*        SUBJECT TO THE 55 CHARACTER LIMIT.  THE RESPONSE FIELD       * 08000000
*        IS INTERPRETED LEFT TO RIGHT.  AN ERROR IN ONE KEYWORD       * 08080020
*        PREVENTS INTERPRETATION OF OTHER KEYWORD FURTHER TO THE      * 08160020
*        RIGHT IN THAT SAME RESPONSE.  A KEYWORD MAY BE RECORDED      * 08240020
*        TO MODIFY A VALUE PREVIOUSLY CODED AS A RESPONSE.  THIS      * 08320020
*        ROUTINE WILL CONTINUE TO REPEAT THE ABOVE REQUEST FOR        * 08400020
*        INPUT UNTIL THE USER INDICATES THAT HE HAS NOTHING ELSE      * 08480020
*        TO SAY.  THIS IS INDICATED BY CODING 'U' AS LAST KEYWORD.    * 08560020
*        USER MAY CODE EITHER THE SINGLE LETTER KEYWORD OR THE FULL   * 08640020
*        KEYWORD AS IT APPEARS IN INTRO.                              * 08720020
*        KEYWORDS MAY BE EITHER UPPER OR LOWER CASE.                  * 08800020
*   'IED003A INVALID KEYWORD XXXXXX'                                  * 08880020
*        'XXXX' - FIRST 4 CHARACTERS OF UNDEFINED KEYWORD.  ALL       * 08960020
*        KEYWORDS TO THE RIGHT OF THIS ARE IGNORED.  KEYWORDS TO      * 09040020
*        THE LEFT OF ERROR HAVE BEEN INTERPRETED.                     * 09120020
*   'IED004A REQUIRED PARAMETER MISSING. SPECIFY XX'                  * 09200020
*        THE USER CODED 'U' INDICATING HE WAS THRU.  THIS STATEMENT   * 09280020
*        REMINDS HIM OF A REQUIRED PARAMETER HE HAS YET TO CODE.      * 09360020
*        'XX' IS THE KEYWORD NEEDED.  USER SHOULD REPLY WITH THE      * 09440020
*        INDICATED KEYWORD (OR ANY KEYWORDS) JUST AS IF HE HAD        * 09520020
*        NEVER SAID 'U' YET.  HE MUST AGAIN INDICATE HE IS THRU       * 09600020
*        RESPONDING BY CODING 'U'.  THE REQUIRED KEYWORDS WHICH       * 09680020
*        MAY BE CALLED FOR HERE ARE 'STARTUP ='(COLD OR        @Y17XANG 09760000
*        WARMSTART), 'LNUNITS='(NUMBER OF LINE BUFFERS),       @Y17XANG 09800000
*        'KEYLEN='(SIZE OF A BUFFER), 'CPB='(NUMBER OF CPBS,   @Y17XANG 09920000
*        REQUIRED ONLY IF DISK IS BEING USED BY SPECIFYING     @Y17XANG 09960000
*        DISK=YES ON INTRO), 'SUBAREA='(REQUIRED ONLY IF       @Y17XANG 10000000
*        FEATURES=MIXED3705 OR ONLY3705 IS SPECIFIED ON INTRO) @Y17XANG 10040000
*        OR 'VM='.                                             @Y17XANG 10080000
*   'IED005A MSUNITS(M) SPECIFICATION NOT PERMITTED.  CONTINUE        * 10160020
*        RESPONSE'                                                    * 10240020
*        USER HAS CODED THE 'M=' KEYWORD TO SET THE NUMBER OF CORE    * 10320020
*        QUEUE RECORDS, BUT CORE QUEUEING WAS NOT SPECIFIED AT INTRO  * 10400020
*        ASSEMBLY TIME.  THE 'M=' RESPONSE IS LEGAL ONLY IF CORE      * 10480020
*        QUEUEING (INTRO MSUNITS=YES OR INTEGER) WAS SPECIFIED AT     * 10560020
*        ASSEMBLY TIME.                                               * 10640020
*   'IED006A INVALID OPERAND ON KEYWORD.  RESPECIFY XX'               * 10720020
*        'XX -- KEYWORD CONTAINING ILLEGAL VALUE.  ALL KEYWORDS       * 10800020
*        IN THIS RESPONSE AFTER THE ILLEGAL ONE ARE IGNORED.  ALL     * 10880020
*        KEYWORDS UP TO THIS KEYWORD HAVE BEEN INTERPRETED.           * 10960020
*   'IED014I TCAM ALREADY IN SYSTEM'                                  * 11040020
*        THE TCAM WORD IN THE CVT WAS FOUND TO BE NON-ZERO, INDICAT-  * 11120020
*        ING THAT ANOTHER PARTITION(REGION) HAS AN ACTIVE TCAM.       * 11200020
*        SINCE TWO TCAMS CANNOT COEXIST, THIS ROUTINE RETURNS         * 11280020
*        IMMEDIATELY TO IEDQOA WITH AN ERROR CODE OF 4.               * 11360020
*   THIS ROUTINE IS ON SYS1.LINKLIB AND IS LINKED TO BY IEDQOA, THE   * 11440020
*   TCAM NON-RESIDENT START UP ROUTINE WHICH WAS ITSELF LINKED TO     * 11520020
*   BY 'INTRO'                                                        * 11600020
*                                                                     * 11680020
*                                                                     * 11760020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *S21101 11800021
         EJECT                                                 @Y17XANG 11820000
*                                                                       11840020
R15      EQU   15                       ENTRY ADDRESS, TEMP BASE        11870020
*                                       RETURN CODE -                   11900020
*                                         0 - NORMAL                    11930020
*                                         4 - TCAM ALREADY IN SYSTEM    11960020
*                                        28 - MCP UNAUTHORIZED @G36XRNP 11970010
R14      EQU   14                       RETURN ADDRESS TO IEDQOA        11990020
*                                       RETURN ADDRESS FROM INTERNAL    12020020
*                                         SUBROUTINES, 'HALFNO' AND     12050020
*                                         'CHAR8'                       12080020
R13      EQU   13                       CALLERS SAVEAREA ADDRESS        12110020
RAVT     EQU   13                       AVT DSECT BASE (AVTSAVE4)       12140020
RBASE    EQU   12                       PROGRAM BASE                    12170020
RESERVD  EQU   11                       KEYWORD TABLE SEARCH LOOP       12200020
*                                         STOPPING POINT                12230020
RBUMP    EQU   10                       INCREMENTOR (VALUE 2) IN        12260020
*                                         KEYWORD TABLE SEARCH LOOP     12290020
RINDEX   EQU   9                        INDEX TO LIST OF KEYWORDS       12320020
RTEMP    EQU   8                        TEMPORARY STORAGE, WORK REG     12350020
RCNT     EQU   7                        NUMBER OF BYTES IN OPERAND      12380020
RANS     EQU   6                        BINARY EQUIVALENT OF DECODED    12410020
*                                         INTEGER OPERANDS, SET BY      12440020
*                                         'NUMCONV' ROUTINE             12470020
REND     EQU   5                        ADDRESS OF FIRST CHARACTER      12500020
*                                         BEYOND OPERAND, SET BY        12530020
*                                         'SCAN' ROUTINE                12560020
RESUL    EQU   4                        ADDRESS OF AVT FIELD TO BE      12590020
*                                         MODIFIED                      12620020
RX       EQU   3                        RETURN ADDRESS FROM INTERNAL    12650020
*                                         SUBROUTINES, 'SCAN' AND       12680020
*                                         'NUMCONV'                     12710020
RSTART   EQU   2                        SCAN POINTER TO RESPONSE TEXT   12740020
*                                         ADDRESS OF START OF KEYWORD   12770020
*                                         OR START OF OPERAND           12800020
R1       EQU   1                        AS INPUT, AVT ADDRESS           12830020
*                                         TEMPORARY USE - HAS CVT       12860020
*                                         ADDRESS, TCAM WORD IN CVT,    12890020
*                                         PARAMETER PASSER TO 'WTO',    12920020
*                                         ADDR OF TAG 'BACK'            12950020
R0       EQU   0                        UNUSED                          12980020
*                                                                       13280020
REOT     EQU   R15                      END OF MASK TABLE REG  @Y17XANG 13300000
RDLIM    EQU   R14                      CURRENT SCAN DELIM FOR @Y17XANG 13320000
*                                       OPMASK ROUTINE         @Y17XANG 13340000
         USING *,R15                    TEMPORARY BASE           S21101 13360021
         USING IEDQAVTD,RAVT                                            13440020
*                                                                       13520020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *S21101 13521021
*                                                                S21101 13522021
*                       EQUATES                                  S21101 13523021
*                                                                S21101 13524021
Y        EQU   C'Y'                     STARTUP=Y                S21101 13525021
I        EQU   C'I'                     STARTUP=I                S21101 13526021
W        EQU   C'W'                     STARTUP=W                S21101 13527021
C        EQU   C'C'                     STARTUP=C                S21101 13528021
E        EQU   C'E'                     STARTUP=E               SA51078 13528110
N        EQU   C'N'                     N=NO                   @G36XRNP 13528210
AUTHBIT  EQU   X'80'                    AUTHORIZATION = YES    @G36XRNP 13528510
NOAUTRQD EQU   X'FF'-AUTHBIT            AUTHORIZATION = NO     @G36XRNP 13528610
AUTHKEY6 EQU   X'60'                    AUTHORIZED KEY 6       @G36XRNP 13528710
*                                                                S21101 13529021
COMMA    EQU   C','                     FIELD SEPARATOR IN REPLY S21101 13530021
XF0      EQU   X'F0'                    CLEARS LOW 4 BITS IN BYTES21101 13531021
*                                       TESTS FOR CHAR AS X'F-'  S21101 13532021
REPLYBIT EQU   X'01'                    BIT IN 'FLAG'            S21101 13533021
*                                         '1'-WTOR HAS BEEN ISSUES21101 13534021
*                                         '0'-NO WTOR YET        S21101 13535021
TABSIZ   EQU   2                        LENGTH OF EACH ENTRY IN  S21101 13536021
*                                         'OPTABLE'              S21101 13537021
EQUAL    EQU   8                        CONDITIONAL BRANCH MASK  S21101 13538021
D0       EQU   0                       CONSTANT EQUATE FOR ZERO  S21903 13538505
AL       EQU   8                        NO. CHARS IN AVT ADDRESS S21101 13539021
T2       EQU   2                        TIMES 2                  S21903 13539205
T3       EQU   3                        TIMES 3                  S21903 13539405
ZERO     EQU   0                        ZERO                     S21903 13539605
XFF      EQU   X'FF'                    HEX FF                   S21903 13539805
W2       EQU   4                        OFFSET TO SECOND WORD    S21101 13540021
W3       EQU   8                        OFFSET TO THIRD WORD     S21101 13541021
IDS      EQU   8                        LENGTH OF JOBNAME,       S21101 13542021
*                                         PROCNAME, AND          S21101 13543021
*                                         PROCSTEPNAME           S21101 13544021
TWO      EQU   2                        OFFSET                 @G36XRNP 13544310
AVTECD28 EQU   28                       ERROR CODE FOR IEDQOA  @G36XRNP 13544610
TIOTJOB  EQU   0                        OFFSET INTO TIOT OF      S21101 13545021
*                                         JOBNAME                S21101 13546021
TIOTPROC EQU   8                        OFFSET INTO TIOT OF      S21101 13547021
*                                         PROCNAME               S21101 13548021
TIOTSTEP EQU   16                       OFFSET INTO TIOT OF      S21101 13549021
*                                         STEPNAME               S21101 13550021
LREPLY   EQU   55                       REPLY LENGTH             S21101 13551000
KEY4     EQU   4                        KEYWORD LENGTH OF 4      S21101 13552021
KEY6     EQU   6                        KEYWORD LENGTH OF 6      S21101 13553021
KEY7     EQU   7                        KEYWORD LENGTH OF 7      S21101 13554021
KEY8     EQU   8                        KEYWORD LENGTH OF 8      S21101 13555021
LKEYWORD EQU   8                        LENGTH OF KEYWORD ID MAXIS21101 13556021
L8       EQU   8                        LENGTH OF DOUBLEWORD     S21101 13557021
INC      EQU   1                        INCREMENTOR TO NEXT BYTE S21101 13558021
E3       EQU   3                        TABLE ENTRY LENGTH       S22024 13558322
ONE      EQU   1                        CONSTANT               @X50X9NI 13558409
ENDTAB2  EQU   X'FF'                    END OF TABLE INDICATOR   S22024 13558622
X7F      EQU   X'7F'                    MASK TO CLEAR X'80' BIT@ZA07074 13558881
*                                                                S21101 13559021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *S21101 13560021
         EJECT                                                 @Y17XANG 13560500
*                                                                S21101 13561021
         SAVE  (14,12)                  SAVE REGS FOR IEDQOA     S21101 13571021
*                                                                S21101 13591021
         USING IEDQOB,RBASE             PROGRAM BASE             S21903 13601022
         LR    RBASE,R15                SET UP BASE REGISTER     S21903 13611022
         DROP  R15                      FORGET TEMPORARY BASE    S21903 13621022
IEDQOB   IEDHJN TAG,HJN                MODULE NAME AND HJN       S21903 13631022
         LA    RTEMP,T3*AVTSVSIZ(R1)    POINT TO AVTSAVE4        S21903 13680005
         ST    R13,W2(,RTEMP)           EXCHANGE SAVEAREA ADDRESSES     13760020
         ST    RTEMP,W3(,R13)                                           13840020
         LR    R13,RTEMP                                                13920020
*                                                                       14080020
         UNPK  ADAVT(AL+INC),AVTBASE(L'AVTBASE+INC) GET AVT ADDRESS     14160020
         TR    ADAVT(AL),TRTABLE          TO MESSAGE                    14240020
         TM    AVTBIT1,AVTDISKN         ARE DISK CONSTANTS IN AVT       14320020
         BO    DISK                       YES, ACCEPT DISK CHANGES      14400020
*                                         NO, DISK CONSTANTS BAD        14480020
         MVC   DISKC(TABSIZ),AVTHFF     FORBID DISK OPERANDS            14560020
         MVC   XCPB(TABSIZ),AVTHFF      FORBID DISK OPERANDS            14640020
DISK     EQU   *                                                        14720020
         TM    AVTBIT1,AVTAQTAN         ARE CORE CONSTANTS IN AVT       14800020
         BO    CORE                       YES, ACCEPT CORE CHANGES      14880020
*                                         NO, CORE CONSTANTS BAD        14960020
         MVC   COREM(TABSIZ),AVTHFF     FORBID CORE CONSTANTS           15040020
         MVC   XMSUNITS(TABSIZ),AVTHFF  FORBID CORE CONSTANTS           15120020
         MVC   COREY(TABSIZ),AVTHFF     FORBID CORE CONSTANTS           15200020
         MVC   XMSMIN(TABSIZ),AVTHFF    FORBID CORE CONSTANTS           15280020
         MVC   COREX(TABSIZ),AVTHFF     FORBID CORE CONSTANTS           15360020
         MVC   XMSMAX(TABSIZ),AVTHFF    FORBID CORE CONSTANTS           15440020
CORE     EQU   *                                                        15520020
         LA    RBUMP,TABSIZ             PRESET INCREMENTOR TO TABLE SIZ 15600020
         L     RTEMP,CVTPTR             GET ADDR OF CVT                 15680020
         USING CVTD,RTEMP                                               15760020
         L     RTEMP,CVTTCBP            GET ADDR OF TCB POINTERS        15840020
         L     RTEMP,W2(,RTEMP)         GET TCB ADDRESS                 15920020
         USING IEDQTCB,RTEMP                                            16000020
         CLI   TCBPKF,AUTHKEY6          IS MCP AUTHORIZED      @G36XRNP 16020010
         BNE   AUTHMSG                  NO, ISSUE ERROR MSG    @G36XRNP 16040010
         L     RTEMP,TCBTIO             GET ADDR OF TIOT                16080020
         MVC   JOBID(IDS),TIOTJOB(RTEMP) FROM TIOT GET JOBNAME,         16130020
         MVC   JOBID+(IDS+(T2*INC))(IDS),TIOTPROC(RTEMP)         S21903*16180005
                                        PROCNAME, AND            S21903 16280005
         MVC   JOBID+(T2*(IDS+(T2*INC)))(IDS),TIOTSTEP(RTEMP)    S21903*16380005
                                        STEPNAME                 S21903 16480005
         MVI   ADAVT+AL,AVTEPER                                         16640020
         L     R1,CVTPTR                GET ADDR OF CVT                 16800020
         L     R1,AVTCVTPT(,R1)         GET CONTENTS OF TCAM            16880020
*                                         WORD IN CVT                   16960020
         LTR   R1,R1                    IS TCAM ALREADY IN SYSTEM       17040020
         BZ    EOF                        NO, CONTINUE                  17120020
*                                         YES, FUSS AND QUIT            17200020
         WTO   MF=(E,IED014I)          TCAM IN SYSTEM MSG        S21101 17280021
*                                                                       17360020
         LA    R15,AVTECD4              SET BAD RETURN CODE             17440020
         B     EXIT                    BRANCH TO EXIT ROUTINE    S21903 17520022
*                                                                       17600020
MSG001   WTO   MF=(E,IED001I)           JOBNAME, AVT ADDR MSG    S21101 17620021
*                                                                S21101 17640021
REQUEST  EQU   *                                                        17680020
         OI    FLAG,REPLYBIT            INDICATE A REQUEST FOR          17760020
*                                         REPLIES HAS BEEN MADE         17840020
         LA    R1,IED002A               SPECIFY TCAM PARAMETERS MS21101 18040021
WTOR     EQU   *                                                        18320020
         XC    REPLY(LREPLY),REPLY      CLEAR RESPONSE AREA             18400020
         XC    ECB,ECB                  CLEAR ECB                       18480020
         WTOR  MF=(E,(1))                                               18560020
         LR    RINDEX,R1               @SAVE MSG ID NUMBER     @SA70307 18600056
*                                                                       18640020
         LA    RSTART,REPLY             PRESET SCAN POINTER      S21101 18680021
*                                                                S21101 18720021
         WAIT  ECB=ECB                  WAIT FOR OPERATOR        S21101 18760021
         DOM   MSG=(9)                  DELETE OPERATOR MSG    @SA70307 18780056
*                                                                       18800020
         TR    REPLY(LREPLY),CHTABLE    CHANGE LOWER TO UPPER CASE      18880020
*                                                                       18960020
* RSTART HAS ADDR OF KEYWORD                                            19040020
*                                                                       19120020
KEYWORD  EQU   *                                                        19200020
         SR    RINDEX,RINDEX            CLEAR INDEX TO OPTABLE          19280020
         LA    RBUMP+1,ENDTAB-OPTABLE-TABSIZ SET STOP VALUE             19360020
         LA    RBUMP,TABSIZ             SET TABLE SIZE           S22024 19440022
         STH   RBUMP,KEYL               SET KEYWORD LENGTH       S22024 19520022
*                                                                       19600020
OPLOOP   EQU   *                                                        19680020
         LA    RTEMP,OPTABLE(RINDEX)    GET ADDR OF OP CODE ENTRY       19760020
         CLC   0(TABSIZ,RTEMP),0(RSTART) CHECK RESPONSE FOR KEYWORD     19840020
         BE    BTABLE                   FOUND MATCHING KEYWORD          19920020
*                                                                       20000020
         BXLE  RINDEX,RBUMP,OPLOOP      GO CHECK NEXT KEYWORD,IF ANY    20080020
*                                       KEYWORD NOT IN TABLE            20160020
         SR    RBUMP,RBUMP              CLEAR REGISTER           S22024 20240022
         SR    RINDEX,RINDEX            CLEAR REGISTER           S22024 20840022
         LA    RTEMP,OPTABLE2           KEYWORD TABLE ADDRESS    S22024 21440022
OPLOOP2  EQU   *                                                 S22024 22040022
         IC    RBUMP,0(RTEMP)           LENGTH OF KEYWORD - 1    S22024 22640022
         EX    RBUMP,CLC                IS KEYWORD FOUND         S22024 23240022
         BE    FOUND                    BRANCH ON YES            S22024 23840022
         LA    RTEMP,E3(RBUMP,RTEMP)    BUMP TO NEXT IN TABLE    S22024 24440022
         CLI   0(RTEMP),ENDTAB2         IS THIS END OF TABLE     S22024 25040022
         BNE   OPLOOP2                  BRANCH ON NO             S22024 25640022
         MVC   MSGKEY(KEY4),0(RSTART)   GET UNIDENTIFIED KEYWORD S22024 26240022
         LA    R1,IED003A               INVALID KEYWORD MESSAGE  S22024 26840022
         B     WTOR                     GO WRITE MESSAGE         S22024 27440022
*                                                                S22024 28040022
CLC      CLC   0(0,RSTART),2(RTEMP)     COMPARE FOR KEYWORD      S22024 28640022
FOUND    EQU   *                                                 S22024 29240022
         LA    RBUMP,1(RBUMP)           ADJUST COUNT             S22024 29840022
         STH   RBUMP,KEYL               SET KEYWORD LENGTH       S22024 30440022
         IC    RINDEX,1(RTEMP)          PICK UP INDEX            S22024 31040022
*                                                                S22024 31640022
BTABLE   EQU   *                                                        33920020
         LA    R1,BACK                  SET RETURN ADDRESS              34000020
         AH    RSTART,KEYL              BUMP PAST KEYWORD TO OPERAND    34080020
         AR    RINDEX,RINDEX            DOUBLE INDEX                    34160020
*                                                                S21903 34170022
* THE FOLLOWING BRANCH TABLE IS USED TO PROCESS EACH OF THE      S21903 34180022
* 'INTRO' OPERANDS THAT CAN BE ENTERED FROM THE SYSTEM CONSOLE.  S21903 34190022
* THE LABEL TO WHICH THE BRANCH IS TAKEN SPECIFIES THE OPERAND   S21903 34200022
* WHICH IS TO BE EXAMINED.                                       S21903 34210022
*                                                                S21903 34220022
         B     *+W2(RINDEX)             ENTER BRANCH TABLE              34240020
         B     LINEBUF                  GO PROCESS LINEBUF       S21903 34320022
         B     CIB                      GO PROCESS CIB           S21903 34400022
         B     CPB                      GO PROCESS CPB           S21903 34480022
         B     INTVAL                   GO PROCESS INTVAL        S21903 34560022
         B     KEYLEN                   GO PROCESS KEYLEN        S21903 34640022
         B     CONTROL                  GO PROCESS CONTROL       S21903 34720022
         B     COREBUF                  GO PROCESS COREBUF       S21903 34800022
         B     RESTART                  GO PROCESS RESTART       S21903 34880022
         B     PRIMARY                  GO PROCESS PRIMARY       S21903 34960022
         B     CKREQS                   GO PROCESS CKREQS        S21903 35040022
         B     STARTUP                  GO PROCESS STARTUP       S21903 35120022
         B     TRACE                    GO PROCESS TRACE         S21903 35200022
         B     DTRACE                   GO PROCESS DTRACE        S21903 35280022
         B     CPINTVL                  GO PROCESS CPINTVL       S21903 35360022
         B     PASSWRD                  GO PROCESS PASSWRD       S21903 35440022
         B     DLQ                      GO PROCESS DLQ           S21903 35520022
         B     CPRCDS                   GO PROCESS CPRCDS        S21903 35600022
         B     CROSSRF                  GO PROCESS CROSSRF       S21903 35680022
         B     COMWRTE                  GO PROCESS COMWRTE       S21903 35760022
         B     TOPMSG                   GO PROCESS TOPMSG        S21903 35840022
         B     OLTEST                   GO PROCESS OLTEST        S21903 35920022
         B     COREMAX                  GO PROCESS COREMAX       S21903 36000022
         B     COREMIN                  GO PROCESS COREMIN       S21903 36080022
         B     VIRTUAL                  GO PROCESS VM            Y05331 36120005
         B     REQUEST                  GO PROCESS REQUEST       S21903 36160022
         B     EOF                      GO TO EOF                S22024 36240022
*                                                                       36320020
* WHEN THIS MODULE IS FIRST ENTERED, CONTROL IS PASSED TO 'EOF' TO      36400020
* SEE IF THE USER WISHES TO SUPPRESS THE 'WTOR' BY SPECIFYING AT        36480020
* INTRO ASSEMBLY TIME ALL FIVE REQUIRED OPERANDS -- KEYLEN,    @Y17XANG 36500000
* LNUNITS, STARTUP, CPB(OR DISK=NO), AND SUBAREA(OR FEATURE=   @Y17XANG 36520000
* NO3705) AND VM(OR VM=NOPROMPT).                              @Y17XANG 36540000
*                                                                       36720020
* WHEN THE USER REPLIES 'U', 'EOF' ALSO GETS CONTROL.                   36800020
*                                                                       36880020
         B     PLCBNO                   GO PROCESS PLCBNO        S22024 36920022
         B     TTRACE                   PROCESS TTRACE           X03039 36930007
*                                       BTRACE AND TTRACE ARE  @Y17XANG 36931000
*                                       SYNONYMOUS, ROUTINE    @Y17XANG 36932000
*                                       LABELED TTRACE SERVES  @Y17XANG 36933000
*                                       BOTH.                  @Y17XANG 36934000
         B     BRACKET                  PROCESS BRACKET        @X50X9NI 36935009
         B     MAXSUBA                  PROCESS MAX SUBAREA    @Y17XANG 36935800
         B     OPMASK                   PROCESS AN OPERATOR    @Y17XANG 36936600
*                                       MASK ENTRY             @Y17XANG 36937400
         B     SUBAREA                  PROCESS SUBAREA ENTRY  @Y17XANG 36938200
         B     SIBCOUNT                 PROCESS SIB COUNT      @Y17XANG 36939000
         B     APWAS                    PROCESS APPLICATION    @G36XRNP 36939210
*                                       WORK AREA SIZE         @G36XRNP 36939410
         B     AUTHA                    PROCESS AUTHORIZATION  @G36XRNP 36939610
*                                                                S22024 36940022
EOF      EQU   *                                                        36960020
         MVI   MISSKEY,AVTEBLNK         CLEAR MSG AREA                  37040020
         MVC   MISSKEY+INC(LKEYWORD-INC),MISSKEY TO SPACES              37120020
         TM    AVTBIT1,AVTDISKN         ARE DISK CONSTANTS IN AVT       37200020
         BZ    CONTINUE                   NO, FORGET CPBS               37280020
*                                         YES, CPBS MUST BE SPECIFIED   37360020
         MVC   MISSKEY(L'XCPB),XCPB     PUT 'CPB=' INTO MSG             37440020
         LH    RTEMP,AVTCPBNO           GET NUMBER OF CPBS              37520020
         LTR   RTEMP,RTEMP              WERE ANY CPBS SPECIFIED         37600020
         BZ    MISSING                    NO, CPBS ARE MISSING          37680020
*                                         YES, CPB= SPECIFIED           37760020
CONTINUE EQU   *                                                        37840020
         MVC   MISSKEY(L'XKEYLEN),XKEYLEN PUT 'KEYLEN=' INTO MSG        37920020
         LH    RTEMP,AVTKEYLE          GET UNIT SIZE FROM AVT    S21903 38000022
         LTR   RTEMP,RTEMP              WAS KEYLEN SPECIFIED            38080020
         BZ    MISSING                    NO, KEYLEN MISSING            38160020
*                                         YES, KEYLEN= SPECIFIED        38240020
         MVC   MISSKEY(L'XLNUNITS),XLNUNITS PUT 'LNUNITS=' INTO MSG     38320020
         LH    RTEMP,AVTNOLBF          GET NUMBER OF BUFFER      S21903 38400022
*                                        UNITS AVAILABLE FOR     S21903 38420022
*                                        BUILDING BUFFERS FROM   S21903 38440022
*                                        THE AVT                 S21903 38460022
         LTR   RTEMP,RTEMP              WAS LNUNITS SPECIFIED           38480020
         BZ    MISSING                    NO, LNUNITS MISSING           38560020
*                                         YES, LNUNITS SPECIFIED        38640020
         TM    AVTSAVTF,AVTVTMCP        IS THERE AN SAVT?      @Y17XANG 38645000
         BZ    TSTSTART                 BRANCH IF NOT          @Y17XANG 38650000
         L     R14,AVTSAVTP             SAVT BASE              @Y17XANG 38655000
         USING IEDNSVTD,R14                                    @Y17XANG 38660000
         MVC   MISSKEY(L'XSUBAREA),XSUBAREA PLACE SUBAREA=     @Y17XANG 38665000
*                                       INTO WTO MSG.          @Y17XANG 38670000
         CLI   SAVTSUBV,0               SUBAREA SPECIFIED?     @Y17XANG 38675000
         BE    MISSING                  BRANCH NO TO GET       @Y17XANG 38680000
*                                       SUBAREA.               @Y17XANG 38685000
         CLC   SAVTSUBV,SAVTSUBA        SUBAREA EXCEED MAX?    @Y17XANG 38690000
         BNH   TSTSTART                 BRANCH IF NOT.         @Y17XANG 38695000
         LA    R1,IED527A               MSG IED527A ADDRESS    @Y17XANG 38700000
         B     WTOR                     GO ISSUE DIAGNOSTIC    @Y17XANG 38705000
         DROP  R14                                             @Y17XANG 38710000
TSTSTART EQU   *                                               @Y17XANG 38715000
         MVC   MISSKEY(L'XSTARTUP),XSTARTUP PUT 'STARTUP=' INTO MSG     38720020
         TM    AVTBIT3,AVTSTAN          IS STARTUP SPECIFIED            38800020
         BNZ   GETMAIN                    YES, REQ'D PARMS ALL HERE     38880020
*                                         NO, STARTUP= MISSING          38960020
MISSING  EQU   *                                                        39040020
         TM    FLAG,REPLYBIT            WAS A MISSING KEYWORD FOUND     39120020
*                                         BECAUSE USER REPLIED 'U'      39200020
*                                         OR BECAUSE THIS IS THE        39280020
*                                         FIRST TIME IN FROM INTRO      39360020
         BZ    MSG001                     FIRST TIME,SHOW AVT ADDS21101 39440021
*                                       USER REPLIED 'U', SPECIFY       39520020
*                                         MISSING KEYWORD               39600020
         LA    R1,IED004A               REQUIRED PARM MISSING MSGS21101 39800021
         B     WTOR                    GO ISSUE MISSING KEYWORD  S21903 40160022
*                                        MESSAGE                 S21903 40200022
*                                                                       40240020
GETMAIN  EQU   *                                                        40320020
         L     R15,AVTSAVTP             SECONDARY AVT POINTER    Y05331 40328005
         USING IEDNSVTD,R15                                      Y05331 40336005
         MVI   MISSKEY,AVTEBLNK         CLEAR MESSAGE AREA     @OZ06187 40338091
         MVC   MISSKEY+INC(LKEYWORD-INC),MISSKEY  TO BLANKS    @OZ06187 40340091
         MVC   MISSKEY(L'XVM),XVM                                Y05331 40344005
         TM    SAVTDIAF,SAVTPRMT        PROMPT REQUIRED ?        Y05331 40352005
         BZ    GOODEXIT                 NO,BRANCH                Y05331 40360005
         B     MISSING                  YES,VM MISSING           Y05331 40368005
         DROP  R15                                               Y05331 40376005
GOODEXIT EQU   *                                                 Y05331 40384005
         SR    R15,R15                  SET GOOD RETURN CODE            40400020
EXIT     EQU   *                                                        40480020
         L     R13,W2(,R13)             GET CALLERS SAVEAREA ADDR       40560020
         RETURN (14,12),T,RC=(15)       EXIT                            40640020
*                                                                       40720020
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 40800020
*                                                                       40880020
CROSSRF  EQU   *                                                        40960020
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY          41040020
*                                                                       41120020
         ST    RANS,AVTCRSRF            STORE VALUE IN AVT              41200020
         BR    R1                       GO TO 'BACK'                    41280020
*                                                                       41360020
LINEBUF  EQU   *                                                        41440020
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY          41520020
*                                                                       41600020
         LTR   RANS,RANS                WAS ZERO SPECIFIED              41680020
         BZ    NOTNUM                     YES,ILLEGAL,MUST HAVE BUFFERS 41760020
*                                         NO, NOW GOT BUFFERS           41840020
         STH   RANS,AVTNOLBF            STORE VALUE IN AVT              41920020
         BR    R1                       GO TO 'BACK'                    42000020
*                                                                       42080020
CIB      EQU   *                                                        42160020
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY          42240020
*                                                                       42320020
         CH    RANS,L255                IS 255 LIMIT EXCEEDED           42400020
         BH    NOTNUM                     YES, TOO BIG                  42480020
*                                         NO, SMALL ENOUGH              42560020
         STC   RANS,AVTCIB              STORE VALUE IN AVT              42640020
         BR    R1                       GO TO 'BACK'                    42720020
*                                                                       42800020
TRACE    EQU   *                                                        42880020
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY          42960020
*                                                                       43040020
         ST    RANS,AVTRACE             STORE VALUE IN AVT              43120020
         LTR   RANS,RANS                NEW TRACE VALUE ZERO   @Y17XANA 43140000
         BNZR  R1                       NO , GO TO 'BACK'      @Y17XANA 43160000
         MVI   AVTIOTR,AVTEZERO         YES,RESET AVTIOTR TO 0 @Y17XANA 43170000
         BR    R1                       GO TO 'BACK'                    43200020
*                                                                       43280020
TTRACE   EQU   *                                                 X03039 43283007
         TM    AVTSAVTF,AVTVTMCP        IS THERE AN SAVT?      @Y17XANG 43283700
         BZ    NOT3705                  BRANCH IF NOT, TRACE   @Y17XANG 43284400
*                                       NOR BTRACE ACCEPTABLE. @Y17XANG 43285100
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY   X03039 43292007
*                                                                       43295007
         L     R14,AVTSAVTP             SECONDARY AVTPOINTER     X03039 43298007
         ST    RANS,SAVTPIUT-IEDNSVTD(R14)   SAVE # TBL ENTRIES@Y17XANG 43299000
*                                            IN SAVT           @Y17XANG 43300000
         BR    R1                                              @Y17XANG 43301000
*                                                              @Y17XANG 43302000
BRACKET  EQU   *                        PROCESS BRACKET        @Y17XANG 43303000
         TM    AVTSAVTF,AVTVTMCP        IS THERE AN SAVT?      @Y17XANG 43304000
         BZ    NOT3705                  BRANCH IF NOT          @Y17XANG 43305000
         L     R14,AVTSAVTP             SECONDARY AVT ADDR     @X50X9NI 43307209
         BAL   RX,SCAN                  BRANCH TO FIND LAST    @X50X9NI 43307309
*                                       CHAR OF OPERAND        @X50X9NI 43307409
         CLC   YESCOM,0(RSTART)         BRACKET=YES 'YES,'     @X50X9NI 43307509
         BE    BRKTYES                  YES-BRANCH             @X50X9NI 43307609
         CLC   YES0(L'YESCOM),0(RSTART) BRACKET=YES 'YES0'     @X50X9NI 43307709
         BE    BRKTYES                  YES-BRANCH             @X50X9NI 43307809
*                                                              @X50X9NI 43307909
         CLC   NOCOM,0(RSTART)          BRACKET=NO 'NO,'       @X50X9NI 43308009
         BE    BRKTNO                   YES-BRANCH             @X50X9NI 43308109
         CLC   NO0(L'NOCOM),0(RSTART)   BRACKET=NO 'NO0'       @X50X9NI 43308209
         BNE   NOTNUM                   BR NO-INVALID          @X50X9NI 43308309
*                                                              @X50X9NI 43308409
BRKTNO   EQU   *                                               @X50X9NI 43308509
         SR    R0,R0                    INIT TO ZERO           @X50X9NI 43308609
         ST    R0,SAVTBSM-IEDNSVTD(R14) INDICATE BRACKET MGR.  @X50X9NI 43308709
*                                       NOT TO BE LOADED       @X50X9NI 43308809
         BR    R1                       GO TO 'BACK'           @X50X9NI 43308909
BRKTYES  EQU   *                                               @X50X9NI 43309009
         LA    R0,ONE                   PUT A '1' IN REG       @X50X9NI 43309109
         ST    R0,SAVTBSM-IEDNSVTD(R14) INDICATE BRACKET MGR.  @X50X9NI 43309209
*                                       IS TO BE LOADED        @X50X9NI 43309309
         BR    R1                       GO TO  'BACK'          @X50X9NI 43309409
PLCBNO   EQU   *                                                 S22024 43310022
         TM    AVTSAVTF,AVTVTMCP        IS NCP DEFINED?        @G36XRNP 43313010
         BZ    NOT3705                  BRANCH ON NO             S22024 43316022
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY   S22024 43319022
*                                                                S22024 43322022
         STH   RANS,AVTPLCBN            STORE VALUE IN AVT       S22024 43325022
         BR    R1                       GO TO 'BACK'             S22024 43328022
*                                                                S22024 43331022
NOT3705  EQU   *                                                 S22024 43334022
         SH    RSTART,KEYL              BACK UP TO KEYWORD       S22024 43337022
         MVC   MSGKEY(KEY4),0(RSTART)   MOVE INVALID KEYWORD     S22024 43340022
         LA    R1,IED003A               INVALID KEYWORD MESSAGE  S22024 43343022
         B     WTOR                     GO WRITE MESSAGE         S22024 43346022
*                                                                S22024 43349022
RESTART  EQU   *                                                        43360020
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY          43440020
*                                                                       43520020
         CH    RANS,L255                IS VALUE LESS THAN 255          43600020
         BH    NOTNUM                     NO, TOO BIG                   43680020
*                                         YES, OK                       43760020
         STC   RANS,AVTCKRST            STORE VALUE IN AVT              43840020
         BR    R1                       GO TO 'BACK'                    43920020
*                                                                       44000020
DTRACE   EQU   *                                                        44080020
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY          44160020
*                                                                       44240020
         ST    RANS,AVTDISTR            STORE VALUE IN AVT              44320020
         LTR   RANS,RANS                NEW DTRACE VALUE ZERO  @Y17XANA 44340000
         BNZR  R1                       NO , GO TO 'BACK'      @Y17XANA 44360000
         MVI   AVTSUBT,AVTEZERO         YES,RESET AVTSUBT TO 0 @Y17XANA 44380000
         BR    R1                       GO TO 'BACK'                    44400020
*                                                                       44480020
CPB      EQU   *                                                        44560020
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY          44640020
*                                                                       44720020
         STH   RANS,AVTCPBNO            STORE VALUE IN AVT              44800020
         BR    R1                       GO TO 'BACK'                    44880020
*                                                                       44960020
INTVAL   EQU   *                                                        45040020
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY          45120020
*                                                                       45200020
         STH   RANS,AVTINTLV            STORE VALUE IN AVT              45280020
         BR    R1                       GO TO 'BACK'                    45360020
*                                                                       45440020
CPINTVL  EQU   *                                                        45520020
         BAL   R14,HALFNO              GO CONVERT TO BINARY AND  S21903 45600022
*                                        PUT VALUE INTO RANS     S21903 45640022
*                                                                       45680020
         CH    RANS,H30                 CPINTVL MUST BE AT LEAST 30     45760020
         BL    NOTNUM                     IF TOO LITTLE, ERROR          45840020
         C     RANS,MAXCPVL             CPINTVL CAN BE AT       SA63008 45920005
*                                       MOST 43199              SA63008 45940005
         BH    NOTNUM                     IF TOO BIG, ERROR     SA63008 45960005
         STH   RANS,AVTCKELV           STORE VALUE IN AVT        S21903 46000022
         BR    R1                       GO TO 'BACK',DO NEXT KEYWORD    46080020
*                                                                       46160020
*                                                                       46240020
KEYLEN   EQU   *                                                        46320020
         BAL   R14,HALFNO              GO CONVERT TO BINARY AND  S21903 46400022
*                                        PUT VALUE INTO RANS     S21903 46440022
*                                                                       46480020
         LA    RTEMP,AVTMINKY           GET MINIMUM KEYLEN              46560000
         TM    AVTSAVTP,AVTVTMCP        3705 ENVIRONMENT       @YM06968 46570000
         BNO   KEYLEN1                  BR NO, MIN IS 36       @YM06968 46580000
         LA    RTEMP,AVTMIN05           MIN FOR 3705 IS 44     @YM06968 46590000
KEYLEN1  EQU   *                                               @YM06968 46600000
         CR    RANS,RTEMP               IS KEYLEN BIG ENOUGH            46640020
         BL    NOTNUM                     NO, ERROR                     46720020
*                                         YES, OK                       46800020
         CH    RANS,L255                IS KEYLEN TOO BIG               46880020
         BH    NOTNUM                     YES, ERROR                    46960020
*                                         NO, OK                        47040020
         STH   RANS,AVTKEYLE                                            47120020
         BR    R1                       GO TO 'BACK',DO NEXT KEYWORD    47200020
*                                                                       47280020
*                                                                       47360020
CONTROL  EQU   *                                                        47440020
         LA    RESUL,AVTCTLCH           PASS AREA TO RECEIVE RESULT     47520020
         BAL   R14,CHAR8                GET OPERAND                     47600020
*                                       IF CONTROL IS RETURNED FROM     47680020
*                                         CHAR8, 'ERASE' WAS REQUESTED  47760020
         MVC   AVTCTLCH,CTLCHDEF        NO CONTROL SPECIFIED            47840020
         BR    R1                       GO TO 'BACK'                    47920020
*                                                                       48000020
PRIMARY  EQU   *                                                        48080020
         LA    RESUL,AVTDOUBX           PASS AREA TO RECEIVE RESULT     48160020
         BAL   R14,CHAR8                GET OPERAND                     48240020
*                                       IF CONTROL IS RETURNED FROM     48320020
*                                         CHAR8, 'ERASE' WAS REQUESTED  48400020
         MVC   AVTDOUBX,DOUBXDEF        SET PRIMARY TO 'SYSCON'         48480020
         BR    R1                       GO TO 'BACK'                    48560020
*                                                                       48640020
PASSWRD  EQU   *                                                        48720020
         LA    RESUL,AVTPASWD           PASS AREA TO RECEIVE RESULT     48800020
         BAL   R14,CHAR8                GET OPERAND                     48880020
*                                       IF CONTROL IS RETURNED FROM     48960020
*                                         CHAR8, 'ERASE' WAS REQUESTED  49040020
         MVC   AVTPASWD,PASWDDEF        NO PASSWORD NEEDED              49120020
         BR    R1                       GO TO 'BACK'                    49200020
*                                                                       49280020
DLQ      EQU   *                                                        49360020
         LA    RESUL,AVTDLQ             PASS AREA TO RECEIVE RESULT     49440020
         BAL   R14,CHAR8                GET OPERAND                     49520020
*                                       IF CONTROL IS RETURNED FROM     49600020
*                                         CHAR8, 'ERASE' WAS REQUESTED  49680020
         MVC   AVTDLQ,DLQDEF            NO DEAD LETTER QUEUE            49760020
         BR    R1                       GO TO 'BACK'                    49840020
*                                                                       49920020
*                                                                       50000020
* RESUL HAS ADDR OF 8 CHARACTER AREA TO RECEIVE RESULT.                 50080020
* RSTART POINT TO FIRST OF OPERAND.                                     50160020
*                                                                       50240020
CHAR8    EQU   *                                                        50320020
         BAL   RX,SCAN                 BRANCH TO FIND LAST       S21903 50400022
*                                        CHARACTER OF OPERAND    S21903 50440022
*                                                                       50480020
         BCTR  RTEMP,ZERO               ADJUST LENGTH FOR EX INSTS21903 50560005
         CH    RTEMP,AVTHA7             8 IS MAXIMUM LENGTH             50640020
         BH    NOTNUM                   ILLEGAL OPERAND                 50720020
*                                                                       50800020
         MVI   0(RESUL),AVTEBLNK        SET ENTIRE RESULT 8 CHAR        50880020
         MVC   INC(L8-INC,RESUL),0(RESUL) AREA TO BLANKS                50960020
         EX    RTEMP,MVC                PUT OPERAND TO ANSWER AREA      51040020
         CLC   0(L'ERASE,RESUL),ERASE   DOES OPERATOR WISH TO ERASE     51120020
*                                         THIS KEYWORD                  51200020
         BCR   EQUAL,R14                  YES, GO INSERT DEFAULT        51280020
         BR    R1                       GO TO 'BACK',DO NEXT KEYWORD    51360020
*                                                                       51440020
MVC      MVC   0(0,RESUL),0(RSTART)     EXECUTED INSTRUCTION, SETS      51520020
*                                         OPERAND INTO RESULT AREA      51600020
*                                                                       51680020
CPRCDS   EQU   *                                                        51760020
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY          51840020
*                                                                       51920020
         CH    RANS,L75                 IS VALUE OVER 75                52000020
         BH    NOTNUM                     YES, TOO BIG                  52080020
*                                         NO, SMALL ENOUGH              52160020
         CH    RANS,AVTHA2              2 IS MINIMUM VALUE              52240020
         BL    NOTNUM                     TOO SMALL                     52320020
*                                         LARGE ENOUGH                  52400020
         STC   RANS,AVTCPRCD            STORE VALUE IN AVT              52480020
         BR    R1                       GO TO 'BACK'                    52560020
*                                                                       52640020
OLTEST   EQU   *                                                        52720020
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY          52800020
*                                                                       52880020
         CH    RANS,L255                IS VALUE OVER 255               52960020
         BH    NOTNUM                     YES, TOO BIG                  53040020
*                                         NO, SMALL ENOUGH              53120020
         CH    RANS,L56                 IS VALUE LESS THAN 56? @Y17XAUU 53200000
         BNL   OLTGOOD                    NO, OK                        53280020
*                                         YES, QUESTIONABLE             53360020
         LTR   RANS,RANS                IS VALUE ZERO                   53440020
         BNZ   NOTNUM                   NO, RANGE 1-55 INVALID @Y17XANU 53520000
*                                       YES, ZERO OR 56-255 OK @Y17XANU 53600000
OLTGOOD EQU    *                                                        53680020
         STC   RANS,AVTOLTST            STORE VALUE IN AVT              53760020
         BR    R1                       GO TO 'BACK'                    53840020
*                                                                       53920020
COREMAX  EQU   *                                                        54000020
         BAL   R14,HALFNO               GET NUMBER INTO RANS            54080020
*                                                                       54160020
         CH    RANS,H100                NO. CANNOT BE OVER 100          54240020
         BH    NOTNUM                     ERROR, TOO BIG                54320020
*                                         OK SO FAR, CONTINUE           54400020
         C     RANS,AVTCMIN             NO.MUST BE GREATER THAN MIN     54480020
         BNH   NOTNUM                     ERROR, TOO SMALL              54560020
*                                         OK, CONTINUE                  54640020
         ST    RANS,AVTCMAX             STORE VALUE IN AVT              54720020
         BR    R1                       GO TO 'BACK'                    54800020
*                                                                       54880020
COREMIN  EQU   *                                                        54960020
         BAL   R14,HALFNO               GET NUMBER INTO RANS            55040020
*                                                                       55120020
         CH    RANS,H100                NO, MUST BE LESS THAN 100       55200020
         BNL   NOTNUM                     ERROR, TOO BIG                55280020
*                                         OK SO FAR, CONTINUE           55360020
         C     RANS,AVTCMAX             NO. MUST BE LESS THAN MAX       55440020
         BNL   NOTNUM                     ERROR, TOO BIG                55520020
*                                         OK, CONTINUE                  55600020
         ST    RANS,AVTCMIN             STORE VALUE IN AVT              55680020
         BR    R1                       GO TO 'BACK'                    55760020
*                                                                       55840020
CKREQS   EQU   *                                                        55920020
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY          56000020
*                                                                       56080020
         CH    RANS,L255                IS LIMIT EXCEEDED               56160020
         BH    NOTNUM                     YES, ILLEGAL OPERAND          56240020
*                                         NO, OK OPERAND                56320020
         STC   RANS,AVTNCKPR           STORE VALUE IN AVT        S21903 56400022
BACK     EQU   *                                                        56480020
         LA    RSTART,INC(,REND)        BUMP TO NEXT KEYWORD            56560020
         B     KEYWORD                 GO EXAMINE NEXT KEYWORD   S21903 56640022
*                                                                       56720020
COREBUF  EQU   *                                                        56800020
*                                                                       56880020
* MSUNITS(M) CAN BE SPECIFIED ONLY IF A NON-ZERO VALUE WAS SPECIFIED    56960020
* FOR MSUNITS ON INTRO MACRO ASSEMBLY.  MSUNITS=YES IS ASSEMBLED        57040020
* IDENTICALLY TO MSUNITS=1, THUS SETTING A NON-ZERO VALUE.              57120020
*                                                                       57200020
         NC    AVTTOTNC,AVTTOTNC        IS CORE BUFFERING REQUESTED     57280020
         BNZ   GOODCORE                   YES, GO SET NEW VALUE         57360020
*                                         NO, NOT PERMITTED             57440020
         LA    R1,IED005A               MSUNITS NOT PERMITTED MSGS21101 57640021
         B     WTOR                     GO FUSS AND WAIT FOR REPLY      57920020
*                                                                       58000020
GOODCORE EQU   *                                                        58080020
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY          58160020
*                                                                       58240020
         LTR   RANS,RANS                IS VALUE ZERO                   58320020
         BZ    NOTNUM                     YES, NOT PERMITTED            58400020
*                                         NO, NON-ZERO VALUE OK         58480020
         ST    RANS,AVTTOTNC           STORE VALUE IN AVT        S21903 58560022
         BR    R1                       GO TO 'BACK',DO NEXT KEYWORD    58640020
*                                                                       58720020
COMWRTE  EQU   *                                                        58800020
         BAL   RX,SCAN                 BRANCH TO FIND LAST       S21903 58880022
*                                        CHARACTER OF OPERAND    S21903 58920022
*                                                                       58960020
         CLC   YESCOM,0(RSTART)         IS OPERAND 'YES'                59040020
         BE    COMWRYES                GO SET BIT IN AVT TO      S21903 59120022
*                                        INDICATE COMWRTE        S21903 59140022
*                                        SPECIFIED               S21903 59160022
*                                                                       59200020
         CLC   YES0(L'YESCOM),D0(RSTART) IS OPERAND 'YES'?       S21903 59280022
         BE    COMWRYES                BRANCH IF YES             S21903 59360022
*                                                                       59440020
         CLC   NOCOM,0(RSTART)          IS OPERAND 'NO'                 59520020
         BE    COMWRNO                 YES, GO SET BIT INDICATINGS21903 59600022
*                                        NO COMWRTE SPECIFIED    S21903 59640022
*                                                                       59680020
         CLC   NO0(L'NOCOM),D0(RSTART) IS OPERAND 'NO'?          S21903 59760022
         BNE   NOTNUM                   INVALID OPERAND COMWRTE         59840020
*                                                                       59920020
COMWRNO  EQU   *                                                        60000020
         NI    AVTCWFL1,AVTEFF-AVTCOMWN COMWRTE=NO SPECIFIED            60080020
         BR    R1                       GO TO 'BACK'                    60160020
*                                                                       60240020
COMWRYES EQU   *                                                        60320020
         OI    AVTCWFL1,AVTCOMWN        COMWRTE=YES SPECIFIED           60400020
         BR    R1                       GO TO 'BACK'                    60480020
*                                                                       60560020
TOPMSG   EQU   *                                                        60640020
         BAL   RX,SCAN                 BRANCH TO FIND LAST       S21903 60720022
*                                        CHARACTER OF OPERAND    S21903 60760022
*                                                                       60800020
         CLC   YESCOM,0(RSTART)         IS OPERAND 'YES'                60880020
         BE    TOPYES                  GO SET BIT IN AVT         S21903 60960022
*                                        INDICATING TOPMSG       S21903 60980022
*                                        SPECIFIED               S21903 61000022
*                                                                       61040020
         CLC   YES0(L'YESCOM),D0(RSTART) IS OPERAND 'YES'?       S21903 61120022
         BE    TOPYES                   YES, GO SET BIT        @SA70222 61200056
*                                                                       61280020
         CLC   NOCOM,0(RSTART)          IS OPERAND 'NO'                 61360020
         BE    TOPNO                   YES, GO SET BIT IN AVT    S21903 61440022
*                                        INDICATING NO TOPMSG    S21903 61460022
*                                        SPECIFIED               S21903 61480022
*                                                                       61520020
         CLC   NO0(L'NOCOM),D0(RSTART) IS OPERAND 'NO'?          S21903 61600022
         BNE   NOTNUM                  NO, INVALID OPERAND TOPMSGS21903 61680022
*                                                                       61760020
TOPNO    EQU   *                                                        61840020
         OI    AVTBIT2,AVTTOPOL         TOPMSG=NO SPECIFIED             61920020
         BR    R1                       GO TO 'BACK'                    62000020
*                                                                       62080020
TOPYES   EQU   *                                                        62160020
         NI    AVTBIT2,XFF-AVTTOPOL     TOPMSG=YES, SPECIFIED    S21903 62240005
         BR    R1                       GO TO 'BACK'                    62320020
*                                                                       62400020
VIRTUAL  EQU   *                                                 Y05331 62402005
         BAL   RX,SCAN                  BRANCH TO FIND LAST CHAR Y05331 62404005
*                                       OF OPERAND.              Y05331 62406005
*                                                                Y05331 62408005
         CLC   YESCOM,0(RSTART)         IS OPERAND 'YES' ?       Y05331 62410005
         BE    VIRTYES                  YES, GO SET BIT IN       Y05331 62412005
*                                       SECONDARY AVT INDICATING Y05331 62414005
*                                       VIRTUAL SPECIFIED        Y05331 62416005
         CLC   YES0(L'YESCOM),D0(RSTART) IS OPERAND 'YES' ?      Y05331 62418005
         BE    VIRTYES                  YES,GO SET BIT           Y05331 62420005
*                                                                Y05331 62422005
         CLC   NOCOM,0(RSTART)          IS OPERAND 'NO' ?        Y05331 62424005
         BC    8,VIRTNO                 YES,BRANCH               Y05331 62426005
         SPACE                                                          62428005
         CLC   NO0(L'NOCOM),D0(RSTART)  IS OPERAND 'NO' ?        Y05331 62430005
         BC    8,VIRTNO                 YES,BRANCH               Y05331 62432005
         B     NOTNUM                   INVALID OPERAND,VIRTUAL  Y05331 62434005
         SPACE                                                          62436005
VIRTYES  EQU   *                                                 Y05331 62438005
         L     RSTART,AVTSAVTP          POINTER TO SECONDARY AVT Y05331 62440005
         USING IEDNSVTD,RSTART                                   Y05331 62442005
         OI    SAVTDIAF,SAVTVIRT        TURN ON VIRTUAL          Y05331 62444005
*                                       ENVIRONMENT INDICATOR    Y05331 62446005
         B     ENDVIRT                  BRANCH                   Y05331 62448005
VIRTNO   EQU   *                                                 Y05331 62450005
         L     RSTART,AVTSAVTP          SECONDARY AVT POINTER    Y05331 62452005
         NI    SAVTDIAF,X7F             TURN OFF VM=YES BIT    @ZA07074 62453081
ENDVIRT  EQU   *                                                 Y05331 62454005
         NI    SAVTDIAF,XBF             TURN OFF VM PROMPT       Y05331 62456005
*                                       INDICATOR IF ON          Y05331 62458005
         BR    R1                       RETURN                   Y05331 62460005
XBF      EQU   X'BF'                                             Y05331 62462005
         DROP  RSTART                                            Y05331 62464005
         SPACE                                                          62466005
STARTUP  EQU   *                                                        62480020
         BAL   RX,SCAN                 BRANCH TO FIND LAST       S21903 62560022
*                                        CHARACTER OF OPERAND    S21903 62600022
*                                                                       62640020
         LR    RTEMP,RSTART                                             62720020
         NI    AVTBIT3,XF0              FORGET PREVIOUS S=REPLIES       62800020
         NI    AVTBIT2,AVTEFF-AVTEXTSC  RESET PREV S= REPLIES   SA51078 62840022
         NI    AVTCKELF,AVTEFF-AVTNQBCK RESET PREVIOUS REPLY   @OS77945 62860010
STA      EQU   *                                                        62880020
         CLI   0(RSTART),C              IS COLDSTART REQUESTED          62960020
         BE    GOTC                       YES, COLDSTART                63040020
*                                         NO, GUESS AGAIN               63120020
         CLI   0(RSTART),W              IS WARMSTART REQUESTED          63200020
         BE    GOTW                       YES, WARMSTART                63280020
*                                         NO, GUESS AGAIN               63360020
         CLI   0(RSTART),I              IS INVITATION LIST REQUESTED    63440020
         BE    GOTI                       YES, INVITATION LIST REQ      63520020
*                                         NO, GUESS AGAIN               63600020
         CLI   0(RSTART),Y              IS NO CONTINUATION REQUESTED    63680020
         BE    GOTY                       YES, NO CONTINUATION          63760020
*                                         NO, OPERATOR BLEW IT          63840020
         CLI   0(RSTART),E              IS EXTENDED RESTART REQ SA51078 63860022
         BE    GOTE                     BRANCH IF YES           SA51078 63880022
         CLI   D0(RSTART),N             NO QBACK SCAN REQUESTED@G36XRNP 63886010
         BE    GOTN                     BRANCH IF YES          @G36XRNP 63892010
STRTERR  EQU   *                                                SA51078 63900022
         LR    RSTART,RTEMP             SET TO START OF OPERAND         63920020
         NI    AVTBIT3,XF0              ERROR,FORGET ALL S= REPLIES     64000020
         NI    AVTBIT2,AVTEFF-AVTEXTSC  RESET PREV S= REPLIES   SA51078 64040022
         NI    AVTCKELF,AVTEFF-AVTNQBCK RESET PREVIOUS REPLY   @OS77945 64060010
         B     NOTNUM                   FUSS AT INVALID OPERAND         64080020
*                                                                       64160020
GOTC     EQU   *                                                        64240020
         TM    AVTBIT3,AVTSTAN          ALREADY SPECIFIED      @G36XRNP 64260010
         BO    STRTERR                  YES, TRY AGAIN         @G36XRNP 64280010
         OI    AVTBIT3,AVTSTAN+AVTSTACN  COLDSTART                      64320020
         B     ENDSTA                  GO GET NEXT CHARACTER     S21903 64400022
*                                                                       64480020
GOTW     EQU   *                                                        64560020
         TM    AVTBIT3,AVTSTAN          ALREADY SPECIFIED      @G36XRNP 64580010
         BO    STRTERR                  YES, TRY AGAIN         @G36XRNP 64600010
         OI    AVTBIT3,AVTSTAN          STARTUP                         64640020
         NI    AVTBIT3,AVTSTAWN         WARMSTART                       64720020
         B     ENDSTA                  GO GET NEXT CHARACTER     S21903 64800022
*                                                                       64880020
GOTI     EQU   *                                                        64960020
         TM    AVTBIT3,AVTSTAIN         ALREADY SPECIFIED      @G36XRNP 64980010
         BO    STRTERR                  YES, TRY AGAIN         @G36XRNP 65000010
         OI    AVTBIT3,AVTSTAIN         INVITATION LIST                 65040020
         B     ENDSTA                  GO GET NEXT CHARACTER     S21903 65120022
*                                                                       65200020
GOTY     EQU   *                                                        65280020
         TM    AVTBIT3,AVTSTAYN         ALREADY SPECIFIED      @G36XRNP 65282010
         BO    STRTERR                  YES TRY AGAIN          @G36XRNP 65284010
         TM    AVTBIT2,AVTEXTSC         EXTENDED SCAN          @G36XRNP 65286010
         BO    STRTERR                  YES, PARMS CONFLICT    @G36XRNP 65288010
         TM    AVTCKELF,AVTNQBCK        NO QBACK SCAN          @G36XRNP 65290010
         BO    STRTERR                  YES, PARMS CONFLICT    @G36XRNP 65292010
         OI    AVTBIT3,AVTSTAYN         NO CONTINUATION                 65294010
*                                                                       65296010
         B     ENDSTA                   CHECK FOR KEYWORD END   SA51078 65298010
*                                                               SA51078 65300010
GOTE     EQU   *                                                SA51078 65302010
         TM    AVTBIT2,AVTEXTSC         ALREADY SPECIFIED      @G36XRNP 65304010
         BO    STRTERR                  YES TRY AGAIN          @G36XRNP 65306010
         TM    AVTBIT3,AVTSTAYN         NO SCAN                @G36XRNP 65308010
         BO    STRTERR                  YES, PARMS CONFLICT    @G36XRNP 65310010
         TM    AVTCKELF,AVTNQBCK        NO QBACK SCAN          @G36XRNP 65312010
         BO    STRTERR                  YES, PARMS CONFLICT    @G36XRNP 65314010
         OI    AVTBIT2,AVTEXTSC         SET EXTENDED RESTART    SA51078 65316010
*                                                               SA51078 65318010
         B     ENDSTA                   GO GET NEXT CHARACTER  @G36XRNP 65320010
GOTN     EQU   *                                               @G36XRNP 65322010
         TM    AVTCKELF,AVTNQBCK        ALREADY SPECIFIED      @G36XRNP 65324010
         BO    STRTERR                  YES,TRY AGAIN          @G36XRNP 65326010
         TM    AVTBIT2,AVTEXTSC         EXTENDED SCAN          @G36XRNP 65328010
         BO    STRTERR                  YES, PARMS CONFLICT    @G36XRNP 65330010
         TM    AVTBIT3,AVTSTAYN         NO SCAN                @G36XRNP 65332010
         BO    STRTERR                  YES, PARMS CONFLICT    @G36XRNP 65334010
         OI    AVTCKELF,AVTNQBCK        SET NO QBACK SCAN      @G36XRNP 65336010
ENDSTA   EQU   *                                                        65338010
         LA    RSTART,INC(,RSTART)      BUMP TO NEXT CHARACTER          65340010
         CR    RSTART,REND              WAS THAT THE LAST CHARACTER     65360010
         BNE   STA                      BRANCH IF NO            SA51078 65362010
         TM    AVTBIT3,AVTSTAN          WAS C OR W SPECIFIED    SA51078 65364010
         BZ    STRTERR                  BRANCH IF NO            SA51078 65366010
         BR    R1                       RETURN                  SA51078 65368010
         EJECT                                                          65370010
* IF THERE IS NO SAVT THEN SUBAREA IS INVALID. GO TO SEND      @Y17XANG 65372010
* ERROR MSG AND REISSUE WTOR.                                  @Y17XANG 65374010
         SPACE                                                          65376010
SUBAREA EQU    *                                               @Y17XANG 65378010
         TM    AVTSAVTF,AVTVTMCP        IS THERE AN SAVT?      @Y17XANG 65380010
         BZ    NOT3705                  BRANCH                 @Y17XANG 65382010
         SPACE                                                          65384010
* CONVERT KEYBOARD OPERAND TO BINARY                           @Y17XANG 65386010
         SPACE                                                          65388010
         BAL   R14,HALFNO               CONVERT CHAR TO BINARY.@Y17XANG 65390010
         SPACE                                                          65392010
* IF THE SUBAREA ADDRESS EXCEEDS A SINGLE BYTE THEN GO PRINT   @Y17XANG 65394010
* INVALID OPERAND MESSAGE.                                     @Y17XANG 65396010
         SPACE                                                          65398010
         LA    R14,255                  MAX ADDRESS IN BYTE    @Y17XANG 65400010
         CR    RANS,R14                 DOES IT EXCEED BYTE?   @Y17XANG 65402010
         BH    NOTNUM                   BRANCH IF SO.          @Y17XANG 65404010
         SPACE                                                          65406010
* PLACE HOST SUBAREA INTO SAVT. RETURN TO CHECK OPERANDS.      @Y17XANG 65408010
         SPACE                                                          65410010
         L     R14,AVTSAVTP             SAVT BASE              @Y17XANG 65412010
         USING IEDNSVTD,R14                                    @Y17XANG 65414010
         STC   RANS,SAVTSUBV            SAVE SUBAREA           @Y17XANG 65416010
         BR    R1                       GO TO'BACK'            @Y17XANG 65418010
MAXCLI   CLI   SAVTSUBA,0               COMPARE MAXSUB TO SUB  @Y17XANG 65420010
         DROP  R14                                                      65422010
         EJECT                                                          65424010
* IF THERE IS NO SAVT MAXSUBA IS INVALID - GO TO PRINT         @Y17XANG 65426010
* INVALID KEYWORD MESSAGE.                                     @Y17XANG 65428010
         SPACE                                                          65430010
MAXSUBA  EQU   *                                               @Y17XANG 65432010
         TM    AVTSAVTF,AVTVTMCP        IS SAVT PRESENT?       @Y17XANG 65434010
         BZ    NOT3705                  BRANCH NO              @Y17XANG 65436010
         SPACE                                                          65438010
* CONVERT MAX SUBAREA TO BINARY.                               @Y17XANG 65440010
         SPACE                                                          65442010
         BAL   R14,HALFNO               CONVERT MAX TO BINARY  @Y17XANG 65444010
         SPACE                                                          65446010
* IF MAX SUBAREA NOT GE 2 AND LE 255 GO PRINT INVALID OPERAND  @Y17XANG 65448010
* DIAGNOSTIC.                                                  @Y17XANG 65450010
         SPACE                                                          65452010
         LA    R15,MINMAXA              MINIMUM MAX SUBAREA    @Y17XANG 65454010
         CR    RANS,R15                 MAX LT 2?              @Y17XANG 65456010
         BL    NOTNUM                   BRANCH YES TO DIAG     @Y17XANG 65458010
         LA    R15,MAXMAXA              MAXIMUM MAX SUBAREA    @Y17XANG 65460010
         CR    RANS,R15                 MAX GT 255?            @Y17XANG 65462010
         BH    NOTNUM                   BRANCH YES TO DIAG.    @Y17XANG 65464010
         SPACE                                                          65466010
* SAVE MAX SUBAREA IN SAVT -SAVTSUBA- AND RETURN TO 'BACK'     @Y17XANG 65470010
         SPACE                                                          65472010
         USING IEDNSVTD,R14                                    @Y17XANG 65474010
         L     R14,AVTSAVTP             SAVT ADDRESS           @Y17XANG 65476010
         STC   RANS,SAVTSUBA            SAVE MAX               @Y17XANG 65478010
         DROP  R14                                             @Y17XANG 65480010
         SPACE                                                          65482010
         BR    R1                                              @Y17XANG 65484010
MINMAXA  EQU   2                        MIN MAX SUBAREA ADDR   @Y17XANG 65486010
MAXMAXA  EQU   255                      MAX MAX SUBAREA ADDR   @Y17XANG 65488010
         EJECT                                                 @Y17XANG 65490010
* IF NO SAVT SIBCOUNT IS INVALID KEY - GO PRINT INVALID KEY    @Y17XANG 65492010
* MESSAGE AND REISSUE WTOR.                                    @Y17XANG 65494010
         SPACE                                                          65496010
SIBCOUNT EQU   *                                               @Y17XANG 65498010
         TM    AVTSAVTF,AVTVTMCP        IS THERE AN SAVT?      @Y17XANG 65500010
         BZ    NOT3705                  BRANCH NO TO DIAG.     @Y17XANG 65502010
         SPACE                                                          65504010
* CONVERT SIBCOUNT TO BINARY.                                  @Y17XANG 65506010
         SPACE                                                          65508010
         BAL   R14,HALFNO               CONVERT                @Y17XANG 65510010
         SPACE                                                          65512010
* IF SIBCOUNT=0 GO PRINT INVALID OPERAND AND REISSUE WTOR.     @Y17XANG 65514010
         SPACE                                                          65516010
         LTR   RANS,RANS                SIBCOUNT=0?            @Y17XANG 65518010
         BZ    NOTNUM                   BRANCH YES             @Y17XANG 65520010
         SPACE                                                          65522010
* IF SNA AND SIBCOUNT < 4 ISSUE INVALID OPERAND AND REISSUE    @Y17XANG 65524010
* WTOR.                                                        @Y17XANG 65526010
         SPACE                                                          65528010
         TM    AVTSAVTF,AVTSNA          SNA?                   @Y17XANG 65530010
         BZ    NOSNA                    BRANCH NO              @Y17XANG 65532010
         LA    R15,MINSIB               MINIMUM #SIBS WITH SNA @Y17XANG 65534010
         CR    RANS,R15                 SIB COUNT LT MIN?      @Y17XANG 65536010
         BL    NOTNUM                   BRANCH YES.            @Y17XANG 65538010
NOSNA    EQU   *                                               @Y17XANG 65540010
         SPACE                                                          65542010
* SAVE SIB COUNT IN SAVT. RETURN TO 'BACK'.                    @Y17XANG 65544010
         SPACE                                                          65546010
         L     R14,AVTSAVTP             SAVT BASE              @Y17XANG 65548010
         USING IEDNSVTD,R14                                    @Y17XANG 65550010
         STH   RANS,SAVTSIBC            SAVE SIB COUNT.        @Y17XANG 65552010
         BR    R1                       GO TO'BACK'            @Y17XANG 65554010
         DROP  R14                                             @Y17XANG 65556010
MINSIB   EQU   4                        MIN SNA SIB COUNT -    @Y17XANG 65558010
*                                           .NCP                        65560010
*                                           .PU-SSCP                    65562010
*                                           .LU-SSCP                    65564010
*                                           .LU-LU                      65566010
         EJECT                                                          65568010
***************************************************************@G36XRNP 65570010
*                                                              @G36XRNP 65572010
*        APPLICATION PROGRAM WORKAREA SIZE PROCESSING          @G36XRNP 65574010
*                                                              @G36XRNP 65576010
***************************************************************@G36XRNP 65578010
APWAS    EQU   *                                               @G36XRNP 65580010
         BAL   R14,HALFNO               CONVERT APWAS OPERAND  @G36XRNP 65582010
         CH    RANS,H4024              IS THIS A 4024 BYTE AREA@G36XRNP 65584010
         BE    APWASOK                  YES, BRANCH            @G36XRNP 65586010
         BH    LARGEAIB                 BRANCH IF AIB OVER 4K  @G36XRNP 65588010
         CH    RANS,H1976              IS THIS A 1976 BYTE AREA@G36XRNP 65590010
         BE    APWASOK                  YES, BRANCH            @G36XRNP 65592010
         CH    RANS,H952               IS THIS A 952 BYTE AREA @G36XRNP 65594010
         BE    APWASOK                  YES, BRANCH            @G36XRNP 65596010
         CH    RANS,H440               IS THIS A 440 BYTE AREA @G36XRNP 65598010
         BE    APWASOK                  YES, BRANCH            @G36XRNP 65600010
         CH    RANS,H184               IS THIS A I84 BYTE QREA @G36XRNP 65602010
         BNE   NOTNUM                   NO, BRANCH             @G36XRNP 65604010
         B     APWASOK                  YES,BRANCH             @G36XRNP 65606010
LARGEAIB EQU   *                                               @G36XRNP 65608010
         CH    RANS,MAXAIB              AIB IN RANGE ALLOWED   @G36XRNP 65610010
         BH    NOTNUM                   NO, BRANCH             @G36XRNP 65612010
APWASOK  EQU   *                                               @G36XRNP 65614010
         STH   RANS,AVTEW               SAVE SIZE IN THE AVT   @G36XRNP 65616010
         BR    R1                       TEST NEXT KEYWORD      @G36XRNP 65618010
         EJECT                                                          65620010
***************************************************************@G36XRNP 65622010
*                                                              @G36XRNP 65624010
*         AUTHORIZATION OPERAND PROCESSING                     @G36XRNP 65626010
*                                                              @G36XRNP 65628010
***************************************************************@G36XRNP 65630010
AUTHA    EQU   *                                               @G36XRNP 65632010
         BAL   RX,SCAN                  SCAN FOR VALID OPTION  @G36XRNP 65634010
         CLC   YESCOM,D0(RSTART)        IS OPERAND='YES'       @G36XRNP 65636010
         BE    AUTHAYES                 YES, GO SET BIT IN AVT @G36XRNP 65638010
*                                      INDICATING AUTHORIZATION@G36XRNP 65640010
*                                       SPECIFIED              @G36XRNP 65642010
         CLC   YES0(L'YESCOM),D0(RSTART) IS OPERAND='YES'      @G36XRNP 65644010
         BE    AUTHAYES                 YES, GO SET BIT IN AVT @G36XRNP 65646010
*                                      INDICATING AUTHORIZATION@G36XRNP 65648010
*                                       SPECIFIED              @G36XRNP 65650010
         CLC   NOCOM,D0(RSTART)         IS OPERAND ='NO'       @G36XRNP 65652010
         BE    AUTHANO                  YES, GO TURN OFF BIT IN@G36XRNP 65654010
*                                       AVT INDICATING         @G36XRNP 65656010
*                                       AUTHORIZATION SPECIFIED@G36XRNP 65658010
         CLC   NO0(L'NOCOM),D0(RSTART)  IS OPERAND='NO'        @G36XRNP 65660010
         BNE   NOTNUM                   NO, INVALID OPERAND    @G36XRNP 65662010
AUTHANO  EQU   *                                               @G36XRNP 65664010
         NI    AVTEW+TWO,NOAUTRQD       TURN THE AUTHORIZATION @G36XRNP 65666010
*                                       REQUIRED BIT OFF       @G36XRNP 65668010
         BR    R1                       CHECK NEXT OPERAND     @G36XRNP 65670010
AUTHAYES EQU   *                                               @G36XRNP 65672010
         OI    AVTEW+TWO,AUTHBIT        TURN ON AUTHORIZATION  @G36XRNP 65674010
*                                       REQUIRED BIT           @G36XRNP 65676010
         BR    R1                       CHECK NEXT OPERAND     @G36XRNP 65678010
         EJECT                                                          65959800
* SET UP OPERAND CONVERSION.                                   @Y17XANG 65960000
         SPACE                                                          65960200
OPMASK   EQU   *                                               @Y17XANG 65960400
         LA    REND,1(RSTART)           ADDRESS 1ST CHAR AFTER @Y17XANG 65960600
*                                      '('.                    @Y17XANG 65960800
         L     RANS,AVTOPMSK            MASK TABLE BASE        @Y17XANG 65961000
         LA    REOT,L'MSKMASK           MASK LENGTH            @Y17XANG 65961200
         MH    REOT,MSKNUM-IEDMSK(RANS) * # MASKS = LENGTH OF  @Y17XANG 65961400
*                                       MASKS.                 @Y17XANG 65961600
         LA    REOT,MSKMASK-IEDMSK-L'MSKMASK(REOT,RANS)        @Y17XANG 65961800
*                                       ADDRESS OF LAST MASK   @Y17XANG 65962000
         LR    RDLIM,RSTART             ADDRESS OF '('         @Y17XANG 65962200
         LA    RANS,MSKMASK-IEDMSK(RANS)    ADDRESS 1ST MASK.  @Y17XANG 65962400
         USING MSKMASK,RANS                                    @Y17XANG 65962600
         SPACE                                                          65962800
* FIRST CHAR A '('? IF NOT GO PRINT INVALID OPERAND DIAG AND   @Y17XANG 65963000
* REISSUE WTOR.                                                @Y17XANG 65963200
         SPACE                                                          65963400
         CLI   0(RSTART),C'('           '(' ?                  @Y17XANG 65963600
         BNE   NOTNUM                   BRANCH NO TO DIAG      @Y17XANG 65963800
         MVI   0(RDLIM),C','            INSURE 1ST SYNTAX CHK  @Y17XANG 65964000
         SPACE                                                          65964200
* SET UP SCAN INCREMENT TO ADVANCE 1 CHAR IN CASE ',' INDICATES@Y17XANG 65964400
* MASK TO DEFAULT.                                             @Y17XANG 65964600
         SPACE                                                          65964800
MSKLOOP  EQU   *                                               @Y17XANG 65965000
         LA    RX,1                     SCAN POINTER INCREMENT @Y17XANG 65965200
         SPACE                                                          65965400
* IF NO MORE MASKS BRANCH TO ADVANCE TO NEXT SYNTAX DELIMITER  @Y17XANG 65965600
* AND EXIT.                                                    @Y17XANG 65965800
         SPACE                                                          65966000
         CLI   0(REND),C')'             ANY MORE MASKS?        @Y17XANG 65966200
         BE    NXTMSK                   BRANCH NO              @Y17XANG 65966400
         SPACE                                                          65966600
* IF LAST DELIMITER NOT A COMMA GO PRINT OPERAND ERROR MESSAGE @Y17XANG 65966800
* AND REQUEST ANOTHER OPERATOR INPUT.                          @Y17XANG 65967000
         SPACE                                                          65967200
         CLI   0(RDLIM),C','            COMMA?                 @Y17XANG 65967400
         BNE   NOTNUM                                          @Y17XANG 65967600
         SPACE                                                          65967800
* IF NEXT CHAR A ',' INDICATING DEFAULT GO ADVANCE TO NEXT     @Y17XANG 65968000
* MASK.                                                        @Y17XANG 65968200
         SPACE                                                          65968400
         CLI   0(REND),C','             ',' ?                  @Y17XANG 65968600
         BE    NXTMSK                   BRANCH YES TO ADVANCE. @Y17XANG 65968800
         SPACE                                                          65969000
* TRANSLATE NEXT 4 CHARS.  INVALID CHARS WILL TRANSLATE TO     @Y17XANG 65969200
* X'00'.  VALID HEX CHAR, N, WILL TRANSLATE TO X'FN'.          @Y17XANG 65969400
         SPACE                                                          65969600
         TR    0(4,REND),TRANMSK        TRANSLATE              @Y17XANG 65969800
         SPACE                                                          65970000
* IF ANY INVALID CHARS GO ISSUE INVALID OPERAND MSG AND WTOR.  @Y17XANG 65970200
         SPACE                                                          65970400
         MVC   AVTDOUBL(L'MSKMASK*2),0(REND) COPY TRANS CHARS  @Y17XANG 65970600
         NC    AVTDOUBL(L'MSKMASK*2),CLRNUM CLEAR NUMERICS     @Y17XANG 65970800
         XC    AVTDOUBL(L'MSKMASK*2),CLRNUM ANY INVALID CHARS? @Y17XANG 65971000
*                                      (RESULT OF XC WILL BE   @Y17XANG 65971200
*                                       ZERO IF NOT SINCE ALL  @Y17XANG 65971400
*                                       VALID HEX NO'S WERE    @Y17XANG 65971600
*                                       X'F0' AFTER THE NC)    @Y17XANG 65971800
         BNZ   NOTNUM                   BRANCH ANY INVALID     @Y17XANG 65972000
         SPACE                                                          65972200
* PLACE HEX CHARS INTO CURRENT MASK TABLE ENTRY.               @Y17XANG 65972400
         SPACE                                                          65972600
         PACK  AVTDOUBL(L'MSKMASK+1),0(L'MSKMASK*2,REND)       @Y17XANG 65972800
*                                       REMOVE ZONES FROM HEX  @Y17XANG 65973000
*                                       DIGITS.                @Y17XANG 65973200
         MVO   AVTDOUBL(L'MSKMASK+2),AVTDOUBL(L'MSKMASK+1)     @Y17XANG 65973400
*                                       SHIFT HEX DIGITS LEFT  @Y17XANG 65973600
*                                       4 BITS TO ALIGN IN     @Y17XANG 65973800
*                                       2 BYTES                @Y17XANG 65974000
         MVC   0(L'MSKMASK,RANS),AVTDOUBL+1 PLACE MASK IN TBL  @Y17XANG 65974200
         SPACE                                                          65974400
* SET SCAN INCREMENT TO ADVANCE TO NEXT MASK (5 CHARS FWD).    @Y17XANG 65974600
         SPACE                                                          65974800
         LA    RX,L'MSKMASK*2+1         INCREMENT TO NEXT MASK @Y17XANG 65975000
         SPACE                                                          65975200
* ADVANCE TO NEXT MASK GROUP IN TABLE AND KEYBOARD INPUT.      @Y17XANG 65975400
         SPACE                                                          65975600
NXTMSK   EQU   *                                               @Y17XANG 65975800
         LA    RDLIM,0(RX,RDLIM)        NEXT INPUT MASK ADDRESS@Y17XANG 65976000
*                                       MINUS ONE=DELIMITER    @Y17XANG 65976200
*                                       ADDRESS(RDLIM=REND-1)  @Y17XANG 65976400
         LA    REND,0(RX,REND)          INPUT MASK ADDRESS     @Y17XANG 65976600
         LA    RANS,MSKLEN(RANS)        NEXT MASK TABLE ENTRY  @Y17XANG 65976800
         SPACE                                                          65977000
* IF THERE ARE MORE INPUT MASKS AND MASK TABLE NOT EXCEEDED    @Y17XANG 65977200
* GO TRANSLATE THE NEXT INPUT AND PLACE INTO TABLE.            @Y17XANG 65977400
         SPACE                                                          65977600
         CLI   0(RDLIM),C')'            IF DELIMITER IS ')'    @Y17XANG 65977800
*                                       THERE ARE NO MORE      @Y17XANG 65978000
*                                       INPUT MASKS.           @Y17XANG 65978200
         BE    NOMOPARM                 BRANCH IF ')'          @Y17XANG 65978400
         CR    RANS,REOT                END OF MASK TABLE?     @Y17XANG 65978600
         BNH   MSKLOOP                  BRANCH NO TO PROCESS   @Y17XANG 65978800
*                                       NEXT INPUT MASK        @Y17XANG 65979000
         SPACE                                                          65979200
* MORE INPUT PARMS BUT END OF TABLE NOT REACHED GO PRINT       @Y17XANG 65979400
* OPERAND ERROR MESSAGE AND REISSUE DIAGNOSTIC.                @Y17XANG 65979600
         SPACE                                                          65979800
         B     NOTNUM                   BRANCH FOR DIAG        @Y17XANG 65980000
         SPACE                                                          65980200
* RETURN TO PROCESS NEXT KEYWORD.                              @Y17XANG 65980400
         SPACE                                                          65980600
NOMOPARM EQU   *                                               @Y17XANG 65980800
         BR    R1                       GO TO'BACK             @Y17XANG 65981000
         EJECT                                                 @Y17XANG 65981200
*                                                                       66000020
* RSTART POINTS TO FIRST OF OPERAND.                                    66080020
* RESULT IS IN RANS.                                                    66160020
*                                                                       66240020
HALFNO   EQU   *                                                        66320020
         BAL   RX,SCAN                 BRANCH TO FIND LAST       S21903 66400022
*                                        CHARACTER OF OPERAND    SI1903 66440022
*                                                                       66480020
         BAL   RX,NUMCONV              GO PERFORM VALIDITY CHECK S21903 66560022
*                                        FOR PROPER NUMERICAL    S21903 66580022
*                                        CHARACTERS              S21903 66600022
*                                                                       66640020
         C     RANS,K64                 IS RESULT GT 64 K               66720020
         BH    NOTNUM                     YES, ILLEGAL OPERAND          66800020
*                                         NO,RESULT IS OK               66880020
         BR    R14                      RETURN TO CALLER                66960020
*                                                                       67040020
* NUMERICAL CONVERT ROUTINE -                                           67120020
* GIVEN A NUMERICAL OPERAND FIELD, DO VALIDITY CHECKING FOR PROPER      67200020
* NUMERICAL CHARACTERS.  IF OK, CONVERT NUMBER TO BINARY.               67280020
*                                                                       67360020
*        INPUT - RSTART HAS ADDRESS OF FIRST CHARACTER OF OPERAND,      67440020
*              REND HAS ADDRESS OF NEXT CHARACTER BEYOND OPERAND.       67520020
*        OUTPUT - RANS HAS POSITIVE BINARY RESULT.  IF NOT PROPER       67600020
*              NUMERICAL CHARACTERS, CONTROL IS GIVEN TO INVALID        67680020
*              OPERAND ROUTINE AT 'NOTNUM'.                             67760020
*                                                                       67840020
NUMCONV  EQU   *                                                        67920020
         LR    RCNT,RTEMP               GET SIZE OF OPERAND             68000020
         CH    RCNT,AVTHA7              IS OPERAND OVER 7 CHARS         68080020
         BH    NOTNUM                     YES, TOO BIG                  68160020
*                                         NO, SO FAR SO GOOD            68240020
         LR    RINDEX,RSTART            GET ADDR OF FIRST CHARACTER     68320020
*                                                                       68400020
CONVLOOP EQU   *                                                        68480020
         TM    0(RINDEX),XF0            IS CHARACTER NUMERICAL          68560020
         BNO   NOTNUM                     NO, ILLEGAL OPERAND           68640020
*                                         YES, OK CHARACTER             68720020
         LA    RINDEX,INC(,RINDEX)      BUMP TO NEXT CHARACTER          68800020
         BCT   RCNT,CONVLOOP            CHECK NEXT CHAR, IF ANY         68880020
*                                                                       68960020
         LR    RCNT,REND                                                69040020
         SR    RCNT,RSTART              GET SIZE OF OPERAND AGAIN       69120020
         BCTR  RCNT,0                   ADJUST FOR EX INSTR.            69200020
         EX    RCNT,PACK               GO PACK THE NUMBER        S21903 69280022
         MVN   AVTDOUBL+L'AVTDOUBL-INC(INC),P GET PROPER PLUS SIGN      69360020
         CVB   RANS,AVTDOUBL            GET BINARY RESULT               69440020
         BR    RX                       RETURN TO MAIN ROUTINE          69520020
*                                                                       69600020
PACK     PACK  AVTDOUBL,0(0,RSTART)     EXECUTED INSTRUCTION            69680020
MVCKEY   MVC   MSGOP(0),0(RSTART)       MOVES KEYWORD TO MSG            69760020
*                                                                       69840020
NOTNUM   EQU   *                                                        69920020
         MVI   MSGOP,AVTEBLNK           CLEAR MESSAGE                   70000020
         MVC   MSGOP+INC(LKEYWORD-INC),MSGOP AREA TO BLANKS             70080020
         SH    RSTART,KEYL              BACK UP TO KEYWORD              70160020
         LH    RTEMP,KEYL                                               70240020
         BCTR  RTEMP,D0                DECREMENT COUNT BY 1      S21903 70320022
         EX    RTEMP,MVCKEY             GET KEYWORD TO MSG              70400020
         LA    R1,IED006A               INVALID OPERAND MSG      S21101 70600021
         B     WTOR                    GO ISSUE INVALID OPERAND  S21903 70960022
*                                        MESSAGE                 S21903 71000022
*                                                                       71040020
* SCAN ROUTINE -                                                        71120020
* GIVEN A STARTING ADDRESS OF AN OPERAND, LOOK FOR THE LAST CHARACTER   71200020
* OF THE OPERAND BY SCANNING FOR EITHER A COMMA OR FOR X'00' AS         71280020
* ENDING THE OPERAND.                                                   71360020
*                                                                       71440020
*        INPUT - RSTART HAS THE ADDRESS OF THE FIRST CHARACTER OF       71520020
*              THE OPERAND.                                             71600020
*        OUTPUT - REND HAS THE ADDRESS OF THE FIRST CHARACTER BEYOND    71680020
*              THE OPERAND.  RSTART IS UNCHANGED.                       71760020
*              RTEMP HAS SIZE OF OPERAND.                               71840020
*                                                                       71920020
SCAN     EQU   *                                                        72000020
         LR    REND,RSTART              INITIALIZE ENDING REG           72080020
SCANLOOP EQU   *                                                        72160020
         CLI   0(REND),COMMA            IS NEXT CHAR A COMMA            72240020
         BE    ENDSCAN                    YES, CHECK LENGTH             72320020
*                                         NO, KEEP LOOKING              72400020
         CLI   0(REND),AVTEZERO         IS THAT END OF REPLY            72480020
         BNE   BUMP                       NO, KEEP LOOKING              72560020
*                                         YES, RETURN TO CALLER         72640020
ENDSCAN  EQU   *                                                        72720020
         LR    RTEMP,REND                                               72800020
         SR    RTEMP,RSTART             GET SIZE OF OPERAND             72880020
*                                       SIZE MUST BE AT LEAST ONE       72960020
         BZ    NOTNUM                   IF NOT, ERROR                   73040020
*                                       IF SO, OK                       73120020
         BR    RX                       RETURN TO CALLER                73200020
*                                                                       73280020
BUMP     EQU   *                                                        73360020
         LA    REND,INC(,REND)          BUMP ENDING REG TO NEXT CHAR    73440020
         B     SCANLOOP                 TRY AGAIN                       73520020
         EJECT                                                          73600010
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *S21101 73602021
*                                                                S21101 73604021
*                       WRITE - TO - OPERATORS                   S21101 73606021
*                                                                S21101 73608021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *       73608210
AUTHMSG  EQU   *                                               @G36XRNP 73608410
         WTO   MF=(E,IED155I)           WRITE ERROR MSG        @G36XRNP 73608610
         LA    R15,AVTECD28             SET ERROR CODE         @G36XRNP 73608810
         B     EXIT                     RETURN TO IEDQOA       @G36XRNP 73609010
IED155I  WTO   'IED155I TCAM START REJECTED - TCAM MCP IS UNAUTHORIZED'*73609210
               ,ROUTCDE=(2,11),DESC=6,MF=L                     @G36XRNP 73609410
IED001I  WTO   'IED001I TCAM JOB JOBNAMEX, PROCNAME, STEPNAME ADDRESS OF73610021
               F AVT          ',ROUTCDE=(2,11),DESC=6,MF=L       S21101 73612021
JOBID    EQU   IED001I+21               JOBID                    S22024 73614022
ADAVT    EQU   IED001I+65               ADAVT                    S22024 73616022
         ENTRY IED001I                                           S21101 73618021
*                                                                S21101 73620021
IED014I  WTO   'IED014I TCAM ALREADY IN SYSTEM',                 S21101*73622021
               ROUTCDE=(2,11),DESC=6,MF=L                        S21101 73624021
         ENTRY IED014I                                           S21101 73626021
*                                                                S21101 73628021
IED002A  WTOR  'IED002A SPECIFY TCAM PARAMETERS',                S21101*73630021
               REPLY,L'REPLY,ECB,ROUTCDE=1,DESC=2,MF=L         @Y17XANG 73631000
         ENTRY IED002A                                           S21101 73634021
*                                                                S21101 73636021
IED003A  WTOR  'IED003A INVALID KEYWORD     ',                   S21101*73638021
               REPLY,L'REPLY,ECB,ROUTCDE=1,DESC=2,MF=L         @Y17XANG 73640000
MSGKEY   EQU   IED003A+36               MSGKEY                   S22024 73642022
         ENTRY IED003A                                           S21101 73644021
*                                                                S21101 73646021
IED004A  WTOR  'IED004A REQUIRED PARAMETER MISSING. SPECIFY         ', *73648021
               REPLY,L'REPLY,ECB,ROUTCDE=1,DESC=2,MF=L         @Y17XANG 73650000
MISSKEY  EQU   IED004A+56               MISSKEY                  S22024 73652022
         ENTRY IED004A                                           S21101 73654021
*                                                                S21101 73656021
IED005A  WTOR  'IED005A MSUNITS(M) SPECIFICATION NOT PERMITTED.  CONTIN*73658021
               UE RESPONSE',REPLY,L'REPLY,ECB,ROUTCDE=1,       @Y17XANG*73660000
               DESC=2,MF=L                                              73661000
         ENTRY IED005A                                           S21101 73662021
*                                                                S21101 73664021
IED006A  WTOR  'IED006A INVALID OPERAND ON KEYWORD.  RESPECIFY         *73666021
               ',REPLY,L'REPLY,ECB,ROUTCDE=1,DESC=2,MF=L       @Y17XANG 73668000
MSGOP    EQU   IED006A+59               MSSOP                    S22024 73670022
         ENTRY IED006A                                           S21101 73672021
IED527A  WTOR  'IED527A HOST SUBAREA EXCEEDS MAXIMUM. SPECIFY NEW SUBAR*73672400
               EA OR MAXSUBA',REPLY,L'REPLY,ECB,ROUTCDE=1,     @YM06974*73672800
               DESC=2,MF=L                                     @YM06974 73673200
         ENTRY IED527A                                         @Y17XANG 73673600
*                                                                S21101 73674021
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *S21101 73676021
*                                                                S21101 73678021
CHTABLE  DS    0F                                                       73680020
         DC    X'00'                    00                              73760020
         DC    C'.'                     01                              73840020
         DC    C'.'                     02                              73920020
         DC    C'.'                     03                              74000020
         DC    C'.'                     04                              74080020
         DC    C'.'                     05                              74160020
         DC    C'.'                     06                              74240020
         DC    C'.'                     07                              74320020
         DC    C'.'                     08                              74400020
         DC    C'.'                     09                              74480020
         DC    C'.'                     0A                              74560020
         DC    C'.'                     0B                              74640020
         DC    C'.'                     0C                              74720020
         DC    C'.'                     0D                              74800020
         DC    C'.'                     0E                              74880020
         DC    C'.'                     0F                              74960020
         DC    C'.'                     10                              75040020
         DC    C'.'                     11                              75120020
         DC    C'.'                     12                              75200020
         DC    C'.'                     13                              75280020
         DC    C'.'                     14                              75360020
         DC    C'.'                     15                              75440020
         DC    C'.'                     16                              75520020
         DC    C'.'                     17                              75600020
         DC    C'.'                     18                              75680020
         DC    C'.'                     19                              75760020
         DC    C'.'                     1A                              75840020
         DC    C'.'                     1B                              75920020
         DC    C'.'                     1C                              76000020
         DC    C'.'                     1D                              76080020
         DC    C'.'                     1E                              76160020
         DC    C'.'                     1F                              76240020
         DC    C'.'                     20                              76320020
         DC    C'.'                     21                              76400020
         DC    C'.'                     22                              76480020
         DC    C'.'                     23                              76560020
         DC    C'.'                     24                              76640020
         DC    C'.'                     25                              76720020
         DC    C'.'                     26                              76800020
         DC    C'.'                     27                              76880020
         DC    C'.'                     28                              76960020
         DC    C'.'                     29                              77040020
         DC    C'.'                     2A                              77120020
         DC    C'.'                     2B                              77200020
         DC    C'.'                     2C                              77280020
         DC    C'.'                     2D                              77360020
         DC    C'.'                     2E                              77440020
         DC    C'.'                     2F                              77520020
         DC    C'.'                     30                              77600020
         DC    C'.'                     31                              77680020
         DC    C'.'                     32                              77760020
         DC    C'.'                     33                              77840020
         DC    C'.'                     34                              77920020
         DC    C'.'                     35                              78000020
         DC    C'.'                     36                              78080020
         DC    C'.'                     37                              78160020
         DC    C'.'                     38                              78240020
         DC    C'.'                     39                              78320020
         DC    C'.'                     3A                              78400020
         DC    C'.'                     3B                              78480020
         DC    C'.'                     3C                              78560020
         DC    C'.'                     3D                              78640020
         DC    C'.'                     3E                              78720020
         DC    C'.'                     3F                              78800020
* START OF SECOND QUARTER OF TABLE                                      78840022
         DC    C' '                     40                              78880020
         DC    C'.'                     41                              78960020
         DC    C'.'                     42                              79040020
         DC    C'.'                     43                              79120020
         DC    C'.'                     44                              79200020
         DC    C'.'                     45                              79280020
         DC    C'.'                     46                              79360020
         DC    C'.'                     47                              79440020
         DC    C'.'                     48                              79520020
         DC    C'.'                     49                              79600020
         DC    C'.'                     4A                              79680020
         DC    X'4B'                    4B                              79760020
         DC    X'4C'                    4C                              79840020
         DC    X'4D'                    4D                              79920020
         DC    X'4E'                    4E                              80000020
         DC    C','                     4F CHANGE 'BAR' TO 'COMMA'      80080020
         DC    X'50'                    50                              80160020
         DC    C'.'                     51                              80240020
         DC    C'.'                     52                              80320020
         DC    C'.'                     53                              80400020
         DC    C'.'                     54                              80480020
         DC    C'.'                     55                              80560020
         DC    C'.'                     56                              80640020
         DC    C'.'                     57                              80720020
         DC    C'.'                     58                              80800020
         DC    C'.'                     59                              80880020
         DC    C'.'                     5A                              80960020
         DC    C'$'                     5B                              81040020
         DC    C'*'                     5C                              81120020
         DC    C')'                     5D                              81200020
         DC    C';'                     5E                              81280020
         DC    C''                     5F                              81360020
         DC    C'-'                     60                              81440020
         DC    C'/'                     61                              81520020
         DC    C'.'                     62                              81600020
         DC    C'.'                     63                              81680020
         DC    C'.'                     64                              81760020
         DC    C'.'                     65                              81840020
         DC    C'.'                     66                              81920020
         DC    C'.'                     67                              82000020
         DC    C'.'                     68                              82080020
         DC    C'.'                     69                              82160020
         DC    C'.'                     6A                              82240020
         DC    C','                     6B                              82320020
         DC    X'6C'                    6C                              82400020
         DC    X'6D'                    6D                              82480020
         DC    C'>'                     6E                              82560020
         DC    C'?'                     6F                              82640020
         DC    C'.'                     70                              82720020
         DC    C'.'                     71                              82800020
         DC    C'.'                     72                              82880020
         DC    C'.'                     73                              82960020
         DC    C'.'                     74                              83040020
         DC    C'.'                     75                              83120020
         DC    C'.'                     76                              83200020
         DC    C'.'                     77                              83280020
         DC    C'.'                     78                              83360020
         DC    C'.'                     79                              83440020
         DC    C':'                     7A                              83520020
         DC    C'#'                     7B                              83600020
         DC    X'7C'                    7C                              83680020
         DC    C''''                    7D                              83760020
         DC    C'='                     7E                              83840020
         DC    C'"'                     7F                              83920020
* START OF THIRD QUARTER OF TABLE                                       83960022
         DC    C'.'                     80                              84000020
         DC    C'A'                     81                              84080020
         DC    C'B'                     82                              84160020
         DC    C'C'                     83                              84240020
         DC    C'D'                     84                              84320020
         DC    C'E'                     85                              84400020
         DC    C'F'                     86                              84480020
         DC    C'G'                     87                              84560020
         DC    C'H'                     88                              84640020
         DC    C'I'                     89                              84720020
         DC    C'.'                     8A                              84800020
         DC    C'.'                     8B                              84880020
         DC    C'.'                     8C                              84960020
         DC    C'.'                     8D                              85040020
         DC    C'.'                     8E                              85120020
         DC    C'.'                     8F                              85200020
         DC    C'.'                     90                              85280020
         DC    C'J'                     91                              85360020
         DC    C'K'                     92                              85440020
         DC    C'L'                     93                              85520020
         DC    C'M'                     94                              85600020
         DC    C'N'                     95                              85680020
         DC    C'O'                     96                              85760020
         DC    C'P'                     97                              85840020
         DC    C'Q'                     98                              85920020
         DC    C'R'                     99                              86000020
         DC    C'.'                     9A                              86080020
         DC    C'.'                     9B                              86160020
         DC    C'.'                     9C                              86240020
         DC    C'.'                     9D                              86320020
         DC    C'.'                     9E                              86400020
         DC    C'.'                     9F                              86480020
         DC    C'.'                     A0                              86560020
         DC    C'.'                     A1                              86640020
         DC    C'S'                     A2                              86720020
         DC    C'T'                     A3                              86800020
         DC    C'U'                     A4                              86880020
         DC    C'V'                     A5                              86960020
         DC    C'W'                     A6                              87040020
         DC    C'X'                     A7                              87120020
         DC    C'Y'                     A8                              87200020
         DC    C'Z'                     A9                              87280020
         DC    C'.'                     AA                              87360020
         DC    C'.'                     AB                              87440020
         DC    C'.'                     AC                              87520020
         DC    C'.'                     AD                              87600020
         DC    C'.'                     AE                              87680020
         DC    C'.'                     AF                              87760020
         DC    C'.'                     B0                              87840020
         DC    C'.'                     B1                              87920020
         DC    C'.'                     B2                              88000020
         DC    C'.'                     B3                              88080020
         DC    C'.'                     B4                              88160020
         DC    C'.'                     B5                              88240020
         DC    C'.'                     B6                              88320020
         DC    C'.'                     B7                              88400020
         DC    C'.'                     B8                              88480020
         DC    C'.'                     B9                              88560020
         DC    C'.'                     BA                              88640020
         DC    C'.'                     BB                              88720020
         DC    C'.'                     BC                              88800020
         DC    C'.'                     BD                              88880020
         DC    C'.'                     BE                              88960020
         DC    C'.'                     BF                              89040020
* START OF LAST QUARTER OF TABLE                                        89080022
         DC    C'.'                     C0                              89120020
         DC    C'A'                     C1                              89200020
         DC    C'B'                     C2                              89280020
         DC    C'C'                     C3                              89360020
         DC    C'D'                     C4                              89440020
         DC    C'E'                     C5                              89520020
         DC    C'F'                     C6                              89600020
         DC    C'G'                     C7                              89680020
         DC    C'H'                     C8                              89760020
         DC    C'I'                     C9                              89840020
         DC    C'.'                     CA                              89920020
         DC    C'.'                     CB                              90000020
         DC    C'.'                     CC                              90080020
         DC    C'.'                     CD                              90160020
         DC    C'.'                     CE                              90240020
         DC    C'.'                     CF                              90320020
         DC    C'.'                     D0                              90400020
         DC    C'J'                     D1                              90480020
         DC    C'K'                     D2                              90560020
         DC    C'L'                     D3                              90640020
         DC    C'M'                     D4                              90720020
         DC    C'N'                     D5                              90800020
         DC    C'O'                     D6                              90880020
         DC    C'P'                     D7                              90960020
         DC    C'Q'                     D8                              91040020
         DC    C'R'                     D9                              91120020
         DC    C'.'                     DA                              91200020
         DC    C'.'                     DB                              91280020
         DC    C'.'                     DC                              91360020
         DC    C'.'                     DD                              91440020
         DC    C'.'                     DE                              91520020
         DC    C'.'                     DF                              91600020
         DC    C'.'                     E0                              91680020
         DC    C'.'                     E1                              91760020
         DC    C'S'                     E2                              91840020
         DC    C'T'                     E3                              91920020
         DC    C'U'                     E4                              92000020
         DC    C'V'                     E5                              92080020
         DC    C'W'                     E6                              92160020
         DC    C'X'                     E7                              92240020
         DC    C'Y'                     E8                              92320020
         DC    C'Z'                     E9                              92400020
         DC    C'.'                     EA                              92480020
         DC    C'.'                     EB                              92560020
         DC    C'.'                     EC                              92640020
         DC    C'.'                     ED                              92720020
         DC    C'.'                     EE                              92800020
         DC    C'.'                     EF                              92880020
         DC    C'0'                     F0                              92960020
         DC    C'1'                     F1                              93040020
         DC    C'2'                     F2                              93120020
         DC    C'3'                     F3                              93200020
         DC    C'4'                     F4                              93280020
         DC    C'5'                     F5                              93360020
         DC    C'6'                     F6                              93440020
         DC    C'7'                     F7                              93520020
         DC    C'8'                     F8                              93600020
         DC    C'9'                     F9                              93680020
         DC    C'.'                     FA                              93760020
         DC    C'.'                     FB                              93840020
         DC    C'.'                     FC                              93920020
         DC    C'.'                     FD                              94000020
         DC    C'.'                     FE                              94080020
         DC    C'.'                     FF                              94160020
         ORG   *-239                   RESET LOCATION COUNTER    S21903 94240022
TRTABLE  DS    239C                    TRANSLATE                 S21903 94300022
         DC    C' 0123456789ABCDEF'      TABLE                   S21903 94360022
         SPACE 1                                                        94370022
*        MISCELLANEOUS CONSTANTS.                                       94380022
         SPACE 1                                                        94390022
FLAG     DC    X'00'                   FLAG BYTE                 S21903 94420022
L255     DC    H'255'                  CONSTANT VALUE            S21903 94540022
KEYL     DC    H'0'                     LENGTH OF KEYWORD               94640020
L75      DC    H'75'                    MAX CPRCDS                      94720020
K64      DC    F'65535'                DECIMAL EQUIVALENT OF 64K S21903 94800022
ECB      DC    F'0'                     ECB FOR WTOR'S WAIT      S21101 94840021
REPLY    DC    XL55'00'                 RESPONSE AREA          @Y17XANG 94860000
H100     DC    H'100'                   MAX VALUE OF 'MSMAX'            94960020
H30      DC    H'30'                   CONSTANT VALUE            S21903 95040022
MAXCPVL  DC    F'43199'                 MAXIMUM CPINTVL         SA63008 95080005
ERASE    DC    C'0 '                    SPECIFIED TO ERASE 8 CHARS      95120020
L56      DC    H'56'                    DEFAULT FOR OLTEST     @Y17XANU 95160000
TRACEMIN DC    H'20'                    MIN TRACE VALUE        @G36XRNP 95165010
MAXAIB   DC    H'32695'                 MAX AIB SIZE           @G36XRNP 95170010
H4024    DC    H'4024'                  4024 BYTE AIB SIZE     @G36XRNP 95175010
H1976    DC    H'1976'                  1976 BYTE AIB SIZE     @G36XRNP 95180010
H952     DC    H'952'                   952 BYTE AIB SIZE      @G36XRNP 95185010
H440     DC    H'440'                   440 BYTE AIB SIZE      @G36XRNP 95190010
H184     DC    H'184'                   184 BYTE AIB SIZE      @G36XRNP 95195010
DLQDEF   DC    2F'0'                    DEAD LETTER Q DEFAULT VALUE     95200020
PASWDDEF DC    CL8' '                   PASSWORD DEFAULT                95280020
CTLCHDEF DC    8X'FF'                   CONTROL DEFAULT                 95360020
DOUBXDEF EQU   DLQDEF                   PRIMARY DEFAULT                 95440020
YESCOM   DC    C'YES,'                  COMWRTE OPERAND COMPARAND       95600020
YES0     DC    C'YES',X'00'             COMWRTE OPERAND COMPARAND       95680020
NOCOM    DC    C'NO,'                   COMWRTE OPERAND COMPARAND       95760020
NO0      DC    C'NO',X'00'              COMWRTE OPERAND COMPARAND       95840020
P        DC    PL1'0'                  PACKED DECIMAL VALUE FOR  S21903 95920022
*                                        ZERO                    S21903 95920522
OPTABLE  EQU   *                                                 S21101 95921021
         DC    C'B='                    LNUNITS   00             S22024 95922022
         DC    C'C='                    CIB       02             S22024 95922922
DISKC    DC    C'D='                    CPB       04             S22024 95923822
         DC    C'I='                    INTVAL    06             S22024 95924722
         DC    C'K='                    KEYLEN    08             S22024 95925622
         DC    C'L='                    CONTROL   10             S22024 95926522
COREM    DC    C'M='                    MSUNITS   12             S22024 95927422
         DC    C'N='                    RESTART   14             S22024 95928322
         DC    C'P='                    PRIMARY   16             S22024 95929222
         DC    C'R='                    CKREQS    18             S22024 95930122
         DC    C'S='                    STARTUP   20             S22024 95931022
         DC    C'T='                    TRACE     22             S22024 95931922
         DC    C'A='                    DTRACE    24             S22024 95932822
         DC    C'V='                    CPINTVL   26             S22024 95933722
         DC    C'W='                    PASSWRD   28             S22024 95934622
         DC    C'Q='                    DLQ       30             S22024 95935522
         DC    C'E='                    CPRCDS    32             S22024 95936422
         DC    C'F='                    CROSSRF   34             S22024 95937322
         DC    C'G='                    COMWRTE   36             S22024 95938222
         DC    C'H='                    TOPMSG    38             S22024 95939122
         DC    C'O='                    OLTEST    40             S22024 95940022
COREX    DC    C'X='                    MSMAX     42             S22024 95940922
COREY    DC    C'Y='                    MSMIN     44             S22024 95941822
         DC    C'Z='                    VIRTUAL   46             Y05331 95942705
         DC    X'0000'                  END OF TXT48                    95943505
         DC    C'U',X'00'               EOF       50                    95944305
*                                       PLCBNO    52             X03039 95945107
*                                       TTRACE    54                    95946007
*                                       BTRACE    54           @Y17XANG 95946100
*                                       BRACKET   56           @Y17XANG 95946200
*                                       MAXSUBA   58           @Y17XANG 95946300
*                                       OPMASK    60           @Y17XANG 95946400
*                                       SUBAREA   62           @Y17XANG 95946500
*                                       SIBCNT    64           @Y17XANG 95946600
*                                       APWAS     66           @G36XRNP 95946710
*                                       AUTHA     68           @G36XRNP 95946810
ENDTAB   EQU   *                                                 S21101 95947021
*                                                                S21101 95948021
OPTABLE2 EQU   *                                                 S22024 95949022
*                                                                S22024 95949522
*   TABLE ENTRY FORMAT -                                         S22024 95950022
*      BYTE 1:  KEYWORD LENGTH - 1                               S22024 95950522
*      BYTE 2:  (INDEX INTO BRANCH TABLE) / 2                    S22024 95951022
*      BYTE 3:  KEYWORD IN EBCDIC (VARIABLE LENGTH)              S22024 95951522
*                                                                S22024 95952022
*   TWO CHARACTER ABREVIATIONS                                   S22024 95952522
         DC    AL1(2),AL1(46)                                  @ZA07074 95952681
XVM      DC    CL3'VM='                                        @ZA07074 95952881
         DC    AL1(2),AL1(52),CL3'PL=' .PLCBNO                   X03039 95953007
         DC    AL1(2),AL1(54),CL3'TT='  TTRACE                   X03039 95953507
XBT      DC    AL1(2),AL1(54),CL3'BT='  BTRACE                 @Y17XANG 95953600
         DC    AL1(2),AL1(56),CL3'BR='  BRACKET                @Y17XANG 95953700
XMA      DC    AL1(2),AL1(58),CL3'MA='  MAXSUBA                @Y17XANG 95953800
XOP      DC    AL1(2),AL1(60),CL3'OP='  OPMASK                 @Y17XANG 95954000
XSA      DC    AL1(2),AL1(62),CL3'SA='  SUBAREA                @Y17XANG 95954100
XSB      DC    AL1(2),AL1(64),CL3'SB='  SIBCOUNT               @Y17XANG 95954200
XWA      DC    AL1(2),AL1(66),CL3'WA='  APWAS                  @G36XRNP 95954310
XAU      DC    AL1(2),AL1(68),CL3'AU='  AUTHA                  @G36XRNP 95954410
*   FULL LENGTH KEYWORDS                                       @Y17XANG 95954510
         DC    AL1(7),AL1(00)           LNUNITS                  S22024 95954610
XLNUNITS DC    CL8'LNUNITS='            LNUNITS                  S22024 95955022
         DC    AL1(3),AL1(02),CL4'CIB=' CIB                      S22024 95955522
         DC    AL1(3),AL1(04)           CPB                      S22024 95956022
XCPB     DC    CL4'CPB='                CPB                      S22024 95956522
         DC    AL1(6),AL1(06),CL7'INTVAL=' INTVAL                S22024 95957022
         DC    AL1(6),AL1(08),CL7'UNITSZ=' UNITSZ                S22024 95957522
         DC    AL1(6),AL1(08)           KEYLEN                   S22024 95958022
XKEYLEN  DC    CL7'KEYLEN='             KEYLEN                   S22024 95958522
         DC    AL1(7),AL1(10),CL8'CONTROL=' CONTROL              S22024 95959022
         DC    AL1(7),AL1(12)           MSUNITS                  S22024 95959522
XMSUNITS DC    CL8'MSUNITS='            MSUNITS                  S22024 95960022
         DC    AL1(7),AL1(14),CL8'RESTART=' RESTART              S22024 95960522
         DC    AL1(7),AL1(16),CL8'PRIMARY=' PRIMARY              S22024 95961022
         DC    AL1(6),AL1(18),CL7'CKREQS=' CKREQS                S22024 95961522
         DC    AL1(7),AL1(20)           STARTUP                  S22024 95962022
XSTARTUP DC    CL8'STARTUP='            STARTUP                  S22024 95962522
         DC    AL1(5),AL1(22),CL6'TRACE=' TRACE                  S22024 95963022
         DC    AL1(6),AL1(24),CL7'DTRACE=' DTRACE                S22024 95963522
         DC    AL1(7),AL1(26),CL8'CPINTVL=' CPINTVL              S22024 95964022
         DC    AL1(7),AL1(28),CL8'PASSWRD=' PASSWRD              S22024 95964522
         DC    AL1(3),AL1(30),CL4'DLQ=' DLQ                      S22024 95965022
         DC    AL1(6),AL1(32),CL7'CPRCDS=' CPRCDS                S22024 95965522
         DC    AL1(7),AL1(34),CL8'CROSSRF=' CROSSRF              S22024 95966022
         DC    AL1(7),AL1(36),CL8'COMWRTE=' COMWRTE              S22024 95966522
         DC    AL1(6),AL1(38),CL7'TOPMSG=' TOPMSG                S22024 95967022
         DC    AL1(6),AL1(40),CL7'OLTEST=' OLTEST                S22024 95967522
         DC    AL1(5),AL1(42)           MSMAX                    S22024 95968022
XMSMAX   DC    CL6'MSMAX='              MSMAX                    S22024 95968522
         DC    AL1(5),AL1(44)           MSMIN                    S22024 95969022
XMSMIN   DC    CL6'MSMIN='              MSMIN                    S22024 95969522
*                         46            VIRTUAL                @Y17XANG 95969700
*                         48            END OF TEXT                     95970005
*                         50            EOF                             95970105
         DC    AL1(6),AL1(52),CL7'PLCBNO=' PLCBNO                X03039 95970207
         DC    AL1(6),AL1(54),CL7'TTRACE='  TTRACE               X03039 95971107
XBTRACE  DC    AL1(6),AL1(54),CL7'BTRACE='  BTRACE             @Y17XANG 95971300
         DC    AL1(7),AL1(56),CL8'BRACKET='  BRACKET           @X50X9NI 95971509
XMAXSUBA DC    AL1(7),AL1(58),CL8'MAXSUBA='  MAXSUBA           @Y17XANG 95971700
XOPMASK  DC    AL1(6),AL1(60),CL7'OPMASK='   OPMASK            @Y17XANG 95971900
         DC    AL1(7),AL1(62)                                  @Y17XANG 95972100
XSUBAREA DC    CL8'SUBAREA='                 SUBAREA           @Y17XANG 95972300
XSIBCOUN DC    AL1(6),AL1(64),CL7'SIBCNT='   SIBCOUNT          @Y17XANG 95972500
XAPWAS   DC    AL1(5),AL1(66),CL6'APWAS='    APWAS             @G36XRNP 95972610
XAUTHA   DC    AL1(5),AL1(68),CL6'AUTHA='    AUTHA             @G36XRNP 95972710
         DC    XL1'FF'                  END OF TABLE INDICATOR @Y17XANG 95972810
*                                                                S21101 95973021
CLRNUM   DC    X'F0F0F0F0'              MASK TO TEST OPMASK    @Y17XANG 96073000
*                                       VALIDITY               @Y17XANG 96173000
TRANMSK  DC    XL193'00',X'FAFBFCFDFEFF',XL41'00' TRANS TABLE  @Y17XANG 96273000
         DC    X'F0F1F2F3F4F5F6F7F8F9',XL6'00'    TRANS TABLE  @Y17XANG 96373000
         EJECT                                                 @Y17XANG 96473000
         TAVTD 4                                                        96880020
CVTD     DSECT                                                          97040020
         CVT                                                            97120020
         TTCBD                                                          97200020
         TMSKD                                                 @Y17XANG 97240000
         END                                                            97280020
./  ADD  SSI=81500296,NAME=IEDQOT01
         TITLE ' IEDQOT01 - TCAM RESOURCE TERMINATION MANAGER '         00200000
IEDQOT01 CSECT                                                          00800021
*A-000000-999999                                               @Y02X6B0 00810000
         SPACE 3                                                        00850005
*  CHANGE ACTIVITY AS FOLLOWS                                           00900005
******************** MICROFICHE FLAGS *********************** SUPT CODE 00950005
*A596000,612000                                                 SA51771 01000005
*D548000-572000,576000-596000,597800,600000-612000               Y01004 01000105
*A572000,5984000                                                SA62368 01000205
*C304000                                                        SA62368 01000305
*D308000-316000,598400-599000,614000-668000,676000-692000       SA62368 01000405
*C292000-304000,597200                                           Y05330 01000505
*D060000-068000,232000-236000,244000,268000,7599600-672000,      Y05330 01000605
*D708000-712000,724000-732000                                    Y05330 01000705
*A778100                                                       @Z30AABG 01000800
*C418802                                                       @Z30AABG 01009800
*D761600                                                       @Z30AABG 01020700
*D345676                                                       @ZA02643 01030700
*C344160,344004-344616,345000-345336,345363-345372,345393      @ZA02601 01040700
*D287000,346395,346480-346780                                  @ZA02601 01050700
*A340000,344622,344760-344770,345480,547802,574000             @ZA02601 01100700
*C345417-345423,345503-345676,345710-345750,345860             @ZA02601 01150700
*C346170-346200,346340-346365,346450-346455                    @ZA02601 01200700
*C424802,587000,590000,602000,605000,607112-607126             @ZA02601 01250700
*C607450-607750,618000,626300-626600,628640-628992             @ZA02601 01300700
*A614000,758000,777000,788000,791200                           @ZA02601 01350700
*C637090-670000                                                @ZA02601 01400700
*C345315-345370                                                @ZA03055 01408700
*A346160                                                       @ZA04027 01416700
*C649090                                                       @ZA04027 01424700
*A547802,759500,778200,798000                                  @Z40X9BG 01432700
*C038000,346460,424802,593000                                  @Z40X9BG 01440700
*C346345-346390                                                @Z40X9BG 01450700
*D345427,345432                                                @ZA07067 01457700
*D345365-345367                                                @ZA07078 01464700
*A345370                                                       @ZA07078 01471700
*A345452,345480                                                @ZA07083 01480700
*C607550-607600                                                @OZ08086 01490700
*C670690                                                       @OZ07798 01500700
*A344180                                                       @OZ07816 01510700
*C344780-344820                                                @OZ07816 01517700
*D345048-345056,614300-614600                                  @OZ07816 01524700
*C758500                                                       @OZ09293 01531700
*C345437-345452                                                @OZ08374 01540700
*C346377                                                       @OZ08384 01551100
*A676290                                                       @OZ16542 01556100
*C656290                                                       @OZ17630 01561100
*A651490,652290,655490,656690,778100                           @OZ17630 01571100
*C346680                                                       @G36XRBB 01580100
*A541862                                                       @G36XRBB 01589100
*                                       PEWA DSECT CHG         @OZ27843 01589282
*A554102                                                       @OZ26963 01589382
*C554102-554312                                                @OZ29317 01589482
*A652690                                                       @OZ32424 01589582
         SPACE 3                                                        01600005
************************START OF SPECFICATIONS************************* 01800000
*                                                                     * 02000000
*                                                                     * 02200000
* MODULE NAME = IEDQOT01                                              * 02300000
*                                                                     * 02400000
* DESCRIPTIVE NAME = RESOURCE TERMINATION MANAGER (RTM)               * 02600000
*                                                                     * 02800000
* COPYRIGHT = NONE                                                    * 03000000
*                                                                     * 03200000
* STATUS = LEVEL 9                                             @Z40X9BG 03400000
*                                                                     * 03600000
* FUNCTION = CLEAN UP TCAM RESOURCES                                  * 03800000
*                                                                     * 04000000
* NOTES = SEE BELOW                                                   * 04200000
*                                                                     * 04400000
*    DEPENDENCIES = NONE                                              * 04600000
*                                                                     * 04800000
*    RESTRICTIONS = NONE                                              * 05000000
*                                                                     * 05200000
*    REGISTER CONVENTIONS = R2  BRANCH AND LINK REGISTER              * 05400000
*                           R3  POINTER TO CVT                        * 05600000
*                           R5  POINTER TO RTM WORK AREA              * 06000000
*                           R6  POINTER TO TCX                        * 06200000
*                           R7  ADDRESS SPACE ID REGISTER             * 06300000
*                           R8  POINTER TO RMPL                       * 06400000
*                           R9  BASE REGISTER                         * 06500000
*                           R10 POINTER TO PEB                        * 06600000
*                           R11 POINTER TO AIB                        * 06800000
*                           R12 POINTER TO PEWA                       * 07200000
*                           R13 SAVE AREA POINTER                     * 07400000
*                                                                     * 07600000
*    PATCH LABEL = PATCH                                              * 07800000
*                                                                     * 08000000
* MODULE TYPE = PROCEDURE                                             * 08200000
*                                                                     * 08400000
*    PROCESSOR = ASSEMBLER XF                                         * 08600000
*                                                                     * 08800000
*    ATTRIBUTES = REENTRANT, SUPERVISOR STATE, KEY 0                  * 09000000
*                                                                     * 09200000
* ENTRY POINT = IEDQOT01                                              * 09400000
*                                                                     * 09600000
*    PURPOSE = SEE FUNCTION                                           * 09800000
*                                                                     * 10000000
*    LINKAGE = CONTROL PASSED TO THIS MODULE FROM IGC0001C VIA        * 10200000
*              A CALL MACRO                                           * 10400000
*                                                                     * 10600000
* INPUT = R1  LOADED WITH THE PARAMETER LIST ADDRESS                  * 10800000
*         R13 POINTS TO STANDARD SAVE AREA                            * 11000000
*         R14 CONTAINS RETURN ADDRESS                                 * 11200000
*         R15 CONTAINS ENTRY POINT OF THIS MODULE                     * 11400000
*                                                                     * 11600000
* OUTPUT = NONE                                                       * 11800000
*                                                                     * 12000000
* EXIT-NORMAL = RETURN TO IGC0001C VIA RETURN MACRO WITH R15 = 0      * 12200000
*                                                                     * 12400000
* EXIT-ERROR = NONE                                                   * 12600000
*                                                                     * 12800000
* EXTERNAL REFERENCES = SEE BELOW                                     * 13000000
*                                                                     * 13200000
*    ROUTINES = NONE                                                  * 13400000
*                                                                     * 13600000
*    DATA AREAS = RESOURCE MANAGER WORK AREA ADDRESSED BY             * 13800000
*                 RMPLRMWA.                                           * 14000000
*                                                                     * 14200000
*    CONTROL BLOCKS = AIB (APPLICATION INTERFACE BLOCK)               * 14400000
*                     AVT (TCAM'S ADDRESS VECTOR TABLE)               * 15000000
*                     CVT                                             * 15200000
*                     PEB (PROCESS EXTENSION BLOCK)                   * 15400000
*                     PEWA (PROCESS ENTRY WORK AREA)                  * 15600000
*                     PSA (PREFIXED SAVE AREA)                        * 15800000
*                     RECB (RESOURCE ELEMENT CONTROL BLOCK)           * 16000000
*                     RMPL (RESOURCE MANGER PARAMETER LIST)           * 16200000
*                     TCX (TCAM CVT EXTENSION)                        * 16400000
*                                                                     * 16600000
* TABLES = NONE                                                       * 16800000
*                                                                     * 17200000
* MACROS = CALLRTM                                                    * 17400000
*          FREEMAIN                                                   * 17600000
*          GETMAIN                                                    * 17800000
*          IOSGEN                                                     * 18000000
*          MODESET                                                    * 18200000
*          SETLOCK                                                    * 18400000
*          TCABEND                                                    * 18600000
*                                                                     * 18800000
* CHANGE ACTIVITY = NONE                                              * 19000000
*                                                                     * 19200000
*************************END OF SPECIFICATIONS************************* 19400000
         EJECT                                                          22000021
*        REGISTER USAGE                                                 22400021
*                                                                       22800021
RZERO    EQU   0                        WORK REGISTER            Y02027 22900000
RONE     EQU   1                        WORK REGISTER            Y02027 23100000
RBRANCH  EQU   2                        BRANCH REGISTER          Y02027 23400000
RCVT     EQU   3                        CVT DSECT BASE REGISTER         24000021
RPEBF    EQU   4                        POINTER TO PEB PRECEDING Y02027 24200000
*                                       THE CURRENT PEB          Y02027 24400000
RRTMWA   EQU   5                        POINTER TO RTM WORK AREA Y02027 24860000
RTCX     EQU   6                        THE TCX BASE REGISTER    Y02027 24920000
RASID    EQU   7                        ADDRESS SPACE ID REG     Y02027 24980000
RUCB     EQU   7                        UCB REGISTER             Y02027 25040000
RRMPL    EQU   8                        ADDR OF RESOURCE MANAGER Y02027 25070000
*                                       PARAMETER LIST           Y02027 25100000
RBASE    EQU   9                        IEDQOT01 BASE REGISTER   Y02027 25150000
RPEB     EQU   10                       PROCESS ENTRY BLOCK ADDR Y02027 25170000
RAIB     EQU   11                       AIB BASE REGISTER        Y02027 25200000
RTCB     EQU   11                       TCB BASE REGISTER        Y02027 25600000
RLOOKUP  EQU   11                       UCB LOOKUP TABLE POINTER Y02027 26000000
RUCBEXT  EQU   12                       UCB EXTENSION            Y02027 26100000
RPEWA    EQU   12                       BASE REG FOR PEWA        Y02027 26220000
RSAVE    EQU   13                       SAVE AREA POINTER        Y02027 26300000
RRECB    EQU   14                       RECB BASE REGISTER       Y02027 26600000
R15      EQU   15                       REGISTER 15              Y02027 26800000
         SPACE 3                                                        27000000
*        REGISTER EQUATES USED ONLY FOR CROSS MEMORY POST        Y02027 27200000
         SPACE 1                                                        27230000
RPOST9   EQU   9                        REG SAVE AREA FOR POST   Y02027 27260000
RPOST10  EQU   10                       COMPLETION CODE          Y02027 27290000
RPOST11  EQU   11                       ECB ADDRESS              Y02027 27320000
RPOST12  EQU   12                       ERRET ENTRY POINT        Y02027 27350000
RPOST13  EQU   13                       ASCB ADDRESS             Y02027 27400000
RPOST14  EQU   14                       RETURN ADDRESS           Y02027 27450000
RPOST15  EQU   15                       POST ENTRY POINT         Y02027 27500000
         SPACE 2                                                        27550000
*                                                                       27600021
         USING CVT,RCVT                 CVT DSECT                       28000021
         USING RTMWA,RRTMWA             WORK AREA DSECT          Y02027 28080000
         USING IEDQPEB,RPEB             PROCESS ENTRY BLOCK ADDR Y02027 28160000
         USING RMPL,RRMPL               RECOVERY PARAMETER LIST  Y02027 28240000
         USING IEDQTCX,RTCX             TCX DSECT                Y02027 28320000
         USING IEDQPEWA,RPEWA           PROCESS ENTRY WORK AREA  Y02027 28400000
         USING IEDQAIB,RAIB             AIB DSECT                Y02027 28500000
         EJECT                                                          28600000
***************************************************************  Y02027 28700000
*                                                             *  Y02027 28800000
*        SET UP BASE REGISTER AND PARAMETER LIST              *  Y02027 28850000
*        ADDRESSABILITY                                       *  Y02027 28900000
*                                                             *  Y02027 28950000
***************************************************************  Y02027 29000000
         SAVE  (14,12)                  SAVE THE CALLER'S REGS   Y02027 29050000
         SPACE 2                                                        29100000
         LR    RBASE,R15                SET BASE REGISTER        Y02027 29150000
         USING IEDQOT01,RBASE           ADDRESSABILITY           Y02027 29200000
         SPACE 2                                                        30000000
IEDQOT01 IEDHJN START                   SET DATE                 Y02027 30800000
         SPACE 2                                                        31600000
         L     RRMPL,ZERO(RONE)         LOAD THE PARAMETER LIST  Y02027 32000000
*                                       ADDRESS                  Y02027 32400000
         L     RRTMWA,RMPLRMWA          GET ADDR OF RTM WORK AREAY02027 33200000
         ST    RSAVE,SAVE13             SAVE CALLER'S REG 13 IN  Y02027 33400000
*                                       WORK AREA                Y02027 33600000
         SR    RCVT,RCVT                CLEAR FOR STORE        @ZA02601 33800000
         ST    RCVT,PTRSA               CLEAR SAVE AREA POINTER@ZA02601 34000000
         L     RCVT,CVTPTR              LOAD THE CVT ADDRESS            34400021
         EJECT                                                          34401000
***************************************************************  Y02027 34402000
*                                                             *  Y02027 34404000
*        IF TCAM IS NOT IN THE SYSTEM, THEN SKIP IEDQOT01     *  Y02027 34406000
*                                                             *  Y02027 34408000
***************************************************************  Y02027 34410000
         ICM   RTCX,ADDR,CVTAQAVT+ONE   GET TCX ADDRESS          Y02027 34412000
         BZ    RETURN1                  IF TCX ADDR IS 0, THEN @ZA02601 34414000
*                                       BRANCH                   Y02027 34416000
         BAL   RBRANCH,GETSA            GET SAVE AREA          @OZ07816 34418000
         BAL   RBRANCH,LOCK             GET LOCAL & CMS LOCK   @OZ07816 34418400
         CLM   RTCX,ADDR,CVTAQAVT+ONE   TCX STILL VALID        @OZ07816 34418800
         BNE   RETURN                   NO, RETURN             @OZ07816 34419200
         SPACE 3                                                 Y02027 34419600
***************************************************************  Y02027 34420000
*                                                             *  Y02027 34422000
*        DETERMINE IF THE TERMINATING TASK OR MEMORY IS TCAM  *  Y02027 34424000
*                                                             *  Y02027 34426000
***************************************************************  Y02027 34430000
         TM    RMPLFLG1,RMPLTERM        IS THIS A MEMORY         Y02027 34432000
*                                         TERMINATION            Y02027 34438000
         BO    TASKTEST                 YES, BRANCH              Y02027 34440000
         CLC   RMPLTCBA+ONE(L3),TCXTCB+ONE DOES TCAM'S TCB ADDR  Y02027 34442000
*                                       MATCH THAT OF THE        Y02027 34444000
*                                       TERMINATING TASK         Y02027 34445000
         BNE   PROCTERM                 NO, BRANCH               Y02027 34446000
TASKTEST EQU   *                                                 Y02027 34448000
         CLC   RMPLASCB+ONE(L3),TCXASCB+ONE DOES TCAM'S ASCB ADDRY02027 34450000
*                                       MATCH THAT OF THE        Y02027 34452000
*                                       TERMINATING MEMORY OR    Y02027 34452800
*                                       THE MEMORY OF THE        Y02027 34453600
*                                       TERMINATING TASK         Y02027 34454400
         BNE   PROCTERM                 NO, BRANCH               Y02027 34455200
         SPACE 2                                                        34456000
***************************************************************  Y02027 34458000
*                                                             *  Y02027 34458300
*        CHECK TCXRTM. IF THE FLAG IS SET, THEN IEDQOT01 HAS  *  Y02027 34458400
*        ALREADY BEEN CALLED FOR TCAM MCP TERMINATION  --     *  Y02027 34458600
*        RETURN TO CALLER. IF TCXRTM IS NOT SET, CONTINUE.    *  Y02027 34458900
*                                                             *  Y02027 34459000
***************************************************************  Y02027 34459200
         OI    TCXFLAG1,TCXMCPCD        INDICATE THAT TCAM IS  @ZA02601 34460100
*                                       TERMINATING AND THAT     Y02027 34461000
*                                       RTM HAS BEEN CALLED      Y02027 34461900
         OI    TCXFLAG1,TCXMCPCD        AGAIN FOR MP           @ZA02601 34462200
         EJECT                                                          34462500
***************************************************************  Y02027 34462800
*                                                             *  Y02027 34463200
*        ISSUE TCABEND IF TSO IS ACTIVE                       *  Y02027 34463600
*                                                             *  Y02027 34464000
***************************************************************  Y02027 34468000
         ICM   RONE,ALL,TCXRPT          IS TSO ACTIVE            Y02027 34470000
         BZ    CHKPEB                   NO, BRANCH               Y02027 34472000
         TM    TCXFLAG1,TCXRTM          RECURRSION ON MCP ABEND@ZA02601 34475000
         BO    CHKPEB                   YES, BRANCH            @ZA02601 34476000
         BAL   RBRANCH,UNLOCK           RELEASE LOCKS          @OZ07816 34477000
         TCABEND ,                      ABEND TSO                Y02027 34478000
         BAL   RBRANCH,GETSA            GET SAVE AREA          @OZ07816 34481000
         BAL   RBRANCH,LOCK             GET LOCAL & CMS LOCK   @OZ07816 34484000
         CLM   RTCX,ADDR,CVTAQAVT+ONE   TCX STILL VALID        @OZ07816 34487000
         BNE   RETURN                   NO, RETURN             @OZ07816 34490000
         EJECT                                                          34493000
***************************************************************@ZA02601 34498000
*                                                              @ZA02601 34500000
*        CHECK FOR APPLICATION WAITING ON MCP                  @ZA02601 34500800
*                                                              @ZA02601 34501600
***************************************************************@ZA02601 34502400
CHKPEB   EQU   *                                               @ZA02601 34503200
         LA    RAIB,TCXAIBC             PTR TO AIBS            @ZA02601 34504000
LOOPAIB  EQU   *                                               @ZA02601 34506400
         ICM   RAIB,ADDR,AIBCHAIN       GET AIB                @ZA02601 34507200
         BZ    CHKPEB1                  END OF CHAIN           @ZA02601 34508000
         TM    AIBSTATE-IEDQAIB(RAIB),ABEND AIB IN USE         @ZA02601 34508800
         BNO   LOOPAIB                  NO, SKIP TO NEXT       @ZA02601 34509600
         L     RRECB,AIBECBA-IEDQAIB(RAIB) GET OPEN/CLOSE FLAG @ZA02601 34510400
         CLM   RRECB,ALL,OPEN           OPEN IN PROGRESS       @ZA02601 34511200
         BNE   CLOSEAIB                 NO, CHECK CLOSE        @ZA02601 34512000
         MVI   RCBERR-IEDQRECB+AIBKEY-IEDQAIB(RAIB),NOTCAM     @ZA02601 34512800
*                                       SET TCAM NOT IN SYSTEM @ZA02601 34513600
         B     APPLPOST                 POST APPL OPEN         @ZA02601 34514400
CLOSEAIB EQU   *                                               @ZA02601 34515200
         CLM   RRECB,ALL,CLOS           CLOSE IN PROGRESS      @ZA02601 34516000
         BE    APPLPOST                 YES, POST APPL COMPLETE@ZA02601 34516800
         B     LOOPAIB                  CHECK NEXT AIB         @ZA02601 34517600
CHKPEB1  EQU   *                                               @ZA02601 34518400
         LA    RPEB,TCXPEBC             DUMMY FIRST PEB        @ZA02601 34519200
LOOPPEB  EQU   *                                               @ZA02601 34520000
         LTR   RPEBF,RPEB               COPY PEB ADDRESS       @ZA02601 34520800
         BZ    FREESA                   END OF PEB CHAIN       @ZA02601 34521600
         ICM   RPEB,ALL,PEBLINK         GET NEXT PEB           @ZA02601 34522400
         BZ    FREESA                   END OF PEB CHAIN       @ZA02601 34523200
         CLC   PEBASCB,QOT1             RTM ALREADY TRIED PEB  @ZA02601 34524000
         BNE   CALLRTM                  PEB NOT PROCESSED BY   @ZA02601 34524800
*                                       RTM                    @ZA02601 34525600
RMVPEB   EQU   *                                               @ZA02601 34526400
         BAL   RRECB,DLKPEWA            DELINK PEWA AND PEB    @ZA02601 34527200
         B     LOOPPEB                  CHECK NEXT PEB         @ZA02601 34528000
APPLPOST EQU   *                                               @ZA02601 34528800
         XC    AIBECBA-IEDQAIB(FOUR,RAIB),AIBECBA-IEDQAIB(RAIB) ZA02601 34529600
*                                       CLEAR SPECIAL FLAG     @ZA02601 34530400
***************************************************************  Y02027 34531200
*                                                             *  Y02027 34533900
*        SAVE REGISTERS AND SET UP FOR BRANCH ENTRY INTO      *  Y02027 34534200
*        CROSS MEMORY POST TO POST APPLICATION PROGRAM CLOSE  *  Y02027 34534500
*                                                             *  Y02027 34534800
***************************************************************  Y02027 34535100
         L     RONE,PTRSA               GET POINTER TO SAVE AREA Y02027 34535400
         STM   RZERO,R15,ZERO(RONE)     SAVE ALL REGISTERS       Y02027 34535700
         L     RPOST13,RCBASCB-IEDQRECB+AIBKEY-IEDQAIB(RAIB)   @ZA02601 34536000
*                                       GET ASCB ADDRESS       @ZA02601 34536100
         SR    RPOST10,RPOST10          CLEAR FOR COMP CODE    @ZA02601 34536200
         IC    RPOST10,RCBERR-IEDQRECB+AIBKEY-IEDQAIB(RAIB) SET@ZA02601 34536300
*                                       COMPLETION CODE        @ZA02601 34536400
         L     RPOST11,RCBPECB-IEDQRECB+AIBKEY-IEDQAIB(RAIB)   @ZA07078 34536500
*                                        ECB ADDRESS           @ZA07078 34536600
         ICM   RPOST11,HIGHORDR,HIBIT   SET CROSS MEM POST     @ZA07078 34536700
         LA    RPOST12,CVTBRET          LOAD BR 14 AS ERRET ADDR Y02027 34536800
         L     RPOST15,CVT0PT01         POST ENTRY PT IEA0PT01   Y02027 34536900
         LR    RPOST9,RONE              SAVE AREA ADDR           Y02027 34537000
         BALR  RPOST14,RPOST15          POST ECB                 Y02027 34538100
         SPACE 1                                                        34538200
         LM    RZERO,R15,ZERO(RPOST9)   RESTORE REGISTERS        Y02027 34538400
         B     LOOPAIB                  CHECK NEXT AIB         @ZA02601 34538700
         EJECT                                                          34538800
***************************************************************  Y02027 34539000
*                                                             *  Y02027 34539300
*        ISSUE CALLRTM FOR APPLICATION PROGRAM                *  Y02027 34540200
*                                                             *  Y02027 34540500
***************************************************************  Y02027 34540800
CALLRTM  EQU   *                                                 Y02027 34541100
         ICM   RTCB,ALL,PEBTCB          TCB ADDRESS            @ZA02601 34541400
         BZ    RMVPEB                   BRANCH NO TCB          @ZA02601 34541700
         TM    PEBFLAG,PEBTERM          APPL ALREADY TERMINTED @OZ08374 34542200
         BO    RMVPEB                   YES, DELINK PEB & PEWAS@OZ08374 34542700
         L     RASID,PEBASID            ASID FOR APPL          @OZ08374 34543200
         L     RSAVE,PTRSA              GET SAVE AREA ADDRESS  @OZ08374 34543700
         CLC   PEBASCB+1(L3),PSAAOLD+1-PSA(RZERO) IS A.P. A    @OZ08374 34544000
*                                       SUBTASK OF THE MCP     @OZ08374 34544100
         BNE   DUMP                     BR, NO                 @OZ08374 34544200
         TM    TCBFLGS-IEDQTCB(RTCB),TERM  IS A.P. TERMINATING @OZ08374 34544300
         BNZ   DUMPED                   YES,SET TERMINATING BIT@OZ08374 34544400
DUMP     EQU   *                                               @OZ08374 34544500
         TM    TCXFLAG1,TCXAPDMP        IS APPL DUMP REQUESTED @OZ08374 34544600
         BZ    NODUMP                   NO, DON'T REQUEST DUMP @OZ08374 34544700
         CALLRTM TYPE=ABTERM,COMPCOD=X'046',TCB=(RTCB),ASID=(RASID),   *34544800
               DUMP=YES                                        @ZA07083 34544900
         B     DUMPED                   DUMP REQUESTED         @ZA07083 34545000
NODUMP   EQU   *                                               @ZA07083 34545100
         CALLRTM TYPE=ABTERM,COMPCOD=X'046',TCB=(RTCB),ASID=(RASID),   *34545300
               DUMP=NO                                           Y02027 34546000
DUMPED   EQU   *                                               @ZA07083 34548000
         OI    PEBFLAG,PEBTERM          MARK APPL TERMINATED   @ZA02601 34548600
         B     LOOPPEB                  PROCESS NEXT PEB       @ZA02601 34549200
         EJECT                                                   Y02027 34549600
FREESA   EQU   *                                               @ZA02601 34550000
         TM    TCXFLAG1,TCXRTM          RECURRSION             @ZA02601 34550500
         BO    PEBFREE                  YES, BRANCH            @ZA02601 34551000
         OI    TCXFLAG1,TCXRTM          SET RECURRSION FLAG    @ZA02601 34551700
         TM    RMPLFLG1,RMPLTERM        IS THIS MCP MEMORY     @ZA02601 34552400
*                                       TERMINATION            @ZA02601 34553100
         BO    PEBFREE                  YES, FREE CNTRL BLOCKS @ZA02601 34553800
         ICM   RPEB,ALL,TCXPEBC         FIRST PEB ON CHAIN     @ZA02601 34554500
         BNZ   RETURN                   CHAIN NOT EMPTY        @ZA02601 34554800
PEBFREE  EQU   *                                               @ZA02601 34555200
         L     RPEB,TCXPEBC             FIRST PEB ON CHAIN     @ZA02601 34556600
         SR    RONE,RONE                CLEAR FOR CS           @ZA02601 34557300
PEBFREE1 EQU   *                                               @ZA02601 34558000
         CS    RPEB,RONE,TCXPEBC        REMOVE PEBS FROM CHAIN @ZA02601 34558700
         BNE   PEBFREE1                 RETRY IF FAILED        @ZA02601 34559400
FRPEBS   EQU   *                                               @ZA02601 34560100
         LTR   RPEB,RPEB                END OF CHAIN           @ZA02601 34560800
         BZ    FREEPEWA                 YES, BRANCH            @ZA02601 34561500
         LR    RONE,RPEB                COPY PEB ADDRESS       @ZA02601 34562200
         L     RPEB,PEBLINK             NEXT PEB               @ZA02601 34562900
         LA    RZERO,PEBSIZE            LENGTH OF PEB          @ZA02601 34563600
         BAL   RBRANCH,FREE231          FREE PEB               @ZA02601 34564300
         B     FRPEBS                   FREE NEXT PEB          @ZA02601 34565000
         EJECT                                                          34565700
*********************************************************************** 34566200
*                                                                     * 34566700
*        FREE PROCESS ENTRY WORK AREAS (PEWA'S)                  Y02027 34567200
*                                                                     * 34568000
*********************************************************************** 34568600
FREEPEWA EQU   *                                                 Y02027 34569200
         SR    RONE,RONE                CLEAR FOR CS           @ZA02601 34570000
         L     RPEWA,TCXPEWAC           PEWA CHAIN             @ZA02601 34571000
FRPEWA1  EQU   *                                               @ZA02601 34572000
         CS    RPEWA,RONE,TCXPEWAC      REMOVE PEWAS FOR CHAIN @ZA02601 34573000
         BNE   FRPEWA1                  RETRY IF FAILED        @ZA02601 34574000
FRPEWA   EQU   *                                                 Y02027 34575000
         LTR   RPEWA,RPEWA              IS THERE A PEWA          Y02027 34578000
         BZ    FREEAIBS                 NO, BRANCH               Y02027 34580000
         LR    RONE,RPEWA               LOAD THE PEWA ADDRESS    Y02027 34582000
         ICM   RPEWA,ADDR,PEWALINK+ONE  GET ADDR OF NEXT PEWA    Y02027 34584000
         SR    RBRANCH,RBRANCH          CLEAR REG              @ZA02601 34585000
         IC    RBRANCH,TCXSCBSZ         SCB SIZE               @ZA02601 34586000
         LA    RBRANCH,PEWASIZE(RBRANCH) ADD PEWA SIZE         @ZA02601 34586200
         TM    PEWAOPT2-IEDQPEWA(RONE),PEWAIN  INPUT DCB       @ZA02601 34586400
         BNO   FRPEWAS                  NO, BRANCH             @ZA02601 34586600
         LA    RBRANCH,TRT(RBRANCH)     ADD TRT SIZE           @ZA02601 34586800
FRPEWAS  EQU   *                                               @ZA02601 34587000
         LA    RZERO,LCBCHAIN-IEDQLCB+FOUR ADJUST FOR LCB      @ZA02601 34587200
         SR    RONE,RZERO               SET ADDR FOR FREEMAIN  @ZA02601 34587400
         AR    RZERO,RBRANCH            SET LENGTH FOR FREEMAIN@ZA02601 34587600
         BAL   RBRANCH,FREE231          FREE PEWA IN SUBPOOL 231 Y02027 34587800
         SPACE 1                                                 Y02027 34588000
         B     FRPEWA                   TEST FOR ANOTHER PEWA    Y02027 34590000
         EJECT                                                          34592000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *  Y02027 34602000
*                                                             *  Y02027 34604000
*        THIS SECTION OF CODE WILL SEARCH THE TCX APPLICATION    Y02027 34606000
*        INTERFACE BLOCK (AIB) CHAIN AND FREE ANY AIB'S          Y02027 34608000
*        REMAINING ON THE CHAIN.                                 Y02027 34609000
*                                                             *  Y02027 34610000
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *  Y02027 34612000
FREEAIBS EQU   *                                                 Y02027 34614000
         TM    TCXFLAG1,TCXMCPCD        MCP TERMINATED         @ZA04027 34616000
         BNO   RETURN                   NO EXIT                @ZA04027 34616600
         SR    RONE,RONE                CLEAR FOR CS           @ZA02601 34617000
         L     RAIB,TCXAIBC             CHAIN OF AIBS          @ZA02601 34617500
FRAIBS1  EQU   *                                               @ZA02601 34618000
         CS    RAIB,RONE,TCXAIBC        REMOVE AIBS FROM CHAIN @ZA02601 34619000
         BNE   FRAIBS1                  RETRY IF FAILED        @ZA02601 34620000
FRAIBS   EQU   *                                                 Y02027 34621000
         LTR   RAIB,RAIB                IS THERE AN AIB          Y02027 34622000
         BZ    FREESRBS                 NO, BRANCH             @Z49X9BG 34624000
         LR    RONE,RAIB                COPY THE AIB ADDRESS     Y02027 34626000
         ICM   RAIB,ADDR,AIBCHAIN       GET ADDR OF NEXT AIB     Y02027 34628000
         LH    RZERO,TCXSZAIB           GET AIB SIZE             Y02027 34629000
         BAL   RBRANCH,FREE231          FREE AIB IN SUBPOOL 231  Y02027 34629100
         B     FRAIBS                   TEST FOR ANOTHER AIB   @ZA02601 34629200
         EJECT                                                 @Z40X9BG 34629300
************************************************************** @Z40X9BG 34629400
*                                                            * @Z40X9BG 34629500
*        FREE SRB'S USED FOR POST FUNCTION                   * @Z40X9BG 34629600
*                                                            * @Z40X9BG 34629700
************************************************************** @Z40X9BG 34629800
FREESRBS EQU   *                                               @Z40X9BG 34629900
         SLR   RZERO,RZERO              CLEAR FOR CS           @Z40X9BG 34630000
         L     RONE,TCXSRBS             GET PTR TO SRB'S       @Z40X9BG 34631000
FRSRB1   EQU   *                                               @Z40X9BG 34632000
         LTR   RONE,RONE                ANY SRB'S TO FREE      @Z40X9BG 34633000
         BZ    RESTAB                   NO, BRANCH             @Z40X9BG 34634000
         CS    RONE,RZERO,TCXSRBS       DECHAIN SRB'S          @Z40X9BG 34635000
         BNE   FRSRB1                   BRANCH IF DECHAIN      @Z40X9BG 34636000
*                                       UNSUCESSFUL            @Z40X9BG 34637000
         SPACE 2                                               @Z40X9BG 34638000
************************************************************** @Z40X9BG 34639000
*                                                            * @Z40X9BG 34640000
*        BRANCH ENTER FREEMAIN - ENTRY EXPECTS TCB ADDRESS   * @Z40X9BG 34641000
*        IN REG 4 AND ASCB ADDRESS IN REG 7. EXPANSION       * @Z40X9BG 34642000
*        DESTROYS REGS 3,14 AND 15 AND CODE USES REG 7.      * @Z40X9BG 34643000
*                                                            * @Z40X9BG 34644000
************************************************************** @Z40X9BG 34645000
FREES    EQU   *                                               @Z40X9BG 34646000
         LA    RPEB,SRBBLKSZ-SIZESRB(,RONE) POINT TO LAST      @Z40X9BG 34647000
*                                       SRB IN THE BLOCK       @Z40X9BG 34648000
         ICM   RPEB,ADDR,ONE(RPEB)      SAVE ADDR OF FIRST SRB @Z40X9BG 34649000
*                                       IN NEXT BLOCK          @Z40X9BG 34650000
         L     RSAVE,PTRSA              GET SAVE AREA POINTER  @Z40X9BG 34651000
         STM   RBRANCH,R15,ZERO(RSAVE)  SAVE REGISTERS         @Z40X9BG 34652000
         L     RPEBF,PSATOLD-PSA(,RZERO) SET TCB ADDRESS       @VS41904 34653000
         L     RASID,PSAAOLD-PSA(,RZERO) SET ASCB ADDRESS      @VS41904 34654000
         LA    RZERO,SRBBLKSZ           GET SRB BLOCK SIZE     @OZ08384 34655000
         FREEMAIN RU,LV=(0),A=(1),SP=SQA,KEY=KEY0,BRANCH=YES   @Z40X9BG 34656000
         LM    RBRANCH,R15,ZERO(RSAVE)  RESTORE REGISTERS      @Z40X9BG 34657000
         LTR   RONE,RPEB                POINT TO NEXT SRB BLK  @Z40X9BG 34658000
         BNZ   FREES                    FREE NEXT BLOCK OF SRBS@Z40X9BG 34660000
         EJECT                                                          34661000
RESTAB   EQU   *                                               @ZA02601 34662000
         TM    TCXFLAG1,TCXMCPCD+TCXRTM MCP TERMINATED         @ZA02601 34663000
         BNO   RETURN                   NO EXIT                @ZA02601 34664000
         SPACE 2                                               @Z49X9BG 34665000
***************************************************************  Y02027 34666000
*                                                             *  Y02027 34667000
*        RESTORE ATTENTION TABLE POINTER SAVED BY TCAM OPEN   *  Y02027 34668000
*                                                             *  Y02027 34669000
***************************************************************  Y02027 34670000
         L     RONE,CVTIXAVL            GET POINTER TO IOCOM   @Z49X9BG 34678000
         USING IOCOM,RONE               IOCOM ADDRESSABILITY   @Z49X9BG 34686000
         L     RONE,IOCATTBL            GET ATTN TABLE POINTER   Y02027 34694000
         USING ATB,RONE                 ATTN TABLE ADDRESSABILITYY02027 34702000
         LA    RONE,TCAM(RONE)          INCREMENT ATTN TABLE ADDRY02027 34710000
         MVC   ATBRTN,TCXSATTN          RESTORE INITIAL VALUE OF Y02027 34718000
*                                       ATTN ROUTINE POINTER     Y02027 34726000
*                                       FOR TCAM                 Y02027 34734000
         SR    RBRANCH,RBRANCH          CLEAR FOR STH          @ZA02601 34742000
         STH   RBRANCH,ATBASID          CLEAR ASID VALUE       @ZA02601 34750000
         DROP  RONE                                            @ZA02601 34758000
         SPACE 4                                               @Z40X9BG 34766000
************************************************************** @Z40X9BG 34774000
*                                                            * @Z40X9BG 34782000
*        RESET TCAM'S PURGE ENTRY IN THE VECTOR OF IOS       * @Z40X9BG 34790000
*        DRIVERS (VOID)                                      * @Z40X9BG 34798000
*                                                            * @Z40X9BG 34806000
************************************************************** @Z40X9BG 34814000
         L     RONE,CVTIXAVL            GET POINTER TO IOCM    @Z40X9BG 34822000
         USING IOCOM,RONE               IOCOM ADDRESSABILITY   @Z40X9BG 34830000
         L     RONE,IOCVOID             GET ADDR OF VOID       @Z40X9BG 34838000
         USING VOID,RONE                VOID ADDRESSABILITY    @Z40X9BG 34846000
         LA    RONE,VOIEL*IOSTCMID(,RONE) GET ADDR OF TCAM'S   @G36XRBB 34854000
*                                       SLOT IN THE VOID       @Z40X9BG 34862000
         MVC   VOIPRG,VOIRSTR           RESET PURGE ADDR TO    @Z40X9BG 34870000
*                                       SAME NO-OP ADDRESS     @Z40X9BG 34878000
*                                       USED FOR RESTORE ADDR  @Z40X9BG 34886000
         DROP  RONE                                            @Z40X9BG 34894000
         EJECT                                                   Y02027 34902000
***************************************************************  Y02027 34910000
*                                                             *  Y02027 34918000
*        RESET TABS IN TCAM UCB'S                             *  Y02027 34926000
*                                                             *  Y02027 34934000
***************************************************************  Y02027 34942000
         USING UCB,RUCB                 UCB ADDRESSABILITY       Y02027 34950000
         USING UCBCMEXT,RUCBEXT         UCB EXTENSION            Y02027 34958000
*                                       ADDRESSABILITY           Y02027 34966000
         L     RLOOKUP,CVTILK2          LOAD THE ADDRESS OF THE  Y02027 34980200
*                                       UCB HALFWORD ADDRESS LISTY02027 37080200
*                                       SECTION IN THE UCB       Y02027 37380200
*                                       LOOKUP TABLE             Y02027 37680200
         SR    RUCB,RUCB                CLEAR FOR INSERT         Y02027 37980200
         SPACE 3                                                        38280200
***************************************************************  Y02027 38580200
*                                                             *  Y02027 38880200
*        RESET THE ERROR TAB IN ANY NON-BISC UCB'S MODIFIED   *  Y02027 39180200
*        BY TCAM                                              *  Y02027 39480200
*                                                             *  Y02027 39780200
***************************************************************  Y02027 40080200
GETUCBAD EQU   *                                                 Y02027 40380200
         ICM   RUCB,HALF,ZERO(RLOOKUP)  GET THE ADDR OF THE      Y02027 40680200
*                                       FIRST/NEXT UCB           Y02027 40980200
         BZ    NEXTUCB                  IF ADDR IS 0, BRANCH     Y02027 41280200
         CLM   RUCB,HALF,ENDUCB         IS THIS THE END OF THE @Z30AABG 41580200
*                                       UCB LOOKUP TABLE         Y02027 41880200
         BE    FREEIOSB                 YES, BRANCH            @Z40X9BG 42180200
         L     RUCBEXT,UCBEXTPT         GET UCB EXTENSION ADDR   Y02027 42480200
         CLI   UCBETI,NONBISC           IS THIS A NON-BISC LINE  Y02027 42780200
         BNE   TESTBISC                 NO, BRANCH               Y02027 43080200
         LR    R15,RUCB                 SET UCB ADDR             Y02027 43380200
         IOSGEN TP,VAR=29,UCB=(R15)     RESET THE ERROR TAB      Y02027 43680200
         SPACE 3                                                        44280200
         B     TESTATTN                 GO CHECK ATTN TAB        Y02027 44480200
         EJECT                                                          44680200
***************************************************************  Y02027 44880200
*                                                             *  Y02027 46880200
*        RESET THE ERROR TAB IN ANY BISC UCB'S MODIFIED       *  Y02027 49680200
*        BY TCAM                                              *  Y02027 50280200
*                                                             *  Y02027 50580200
***************************************************************  Y02027 50880200
TESTBISC EQU   *                                                 Y02027 51180200
         CLI   UCBETI,BISC              IS THIS A BISC LINE      Y02027 51480200
         BNE   NEXTUCB                  NO, BRANCH               Y02027 51780200
         LR    R15,RUCB                 SET UCB ADDR             Y02027 52080200
         IOSGEN TP,VAR=2B,UCB=(R15)     RESET BISC ERROR TAB     Y02027 52380200
         EJECT                                                          52980200
***************************************************************  Y02027 53180200
*                                                             *  Y02027 53380200
./  ADD  SSI=81290005,NAME=IEDQRS
         TITLE 'IEDQRS - SNA RESPONSE GENERATION PROGRAM               *00001000
                        '                                               00002000
IEDQRS   CSECT ,                                                   0001 00003000
@PROLOG  DS    0H                                                  0002 00004000
         USING *,RBASE                                                  00005000
IEDQRS   IEDHJN AFTERHJN,HJN                                            00006000
         LA    RLCB,0(RLCB)                                             00007000
*                                                                  0448 00008000
*/********************************************************************/ 00009000
*/*                                                                  */ 00010000
*/*      M A I N   C O D E   S E G M E N T                           */ 00011000
*/*                                                                  */ 00012000
*/********************************************************************/ 00013000
*                                                                  0448 00014000
*   STM(R0,R15,SAVEREGS);           /* SAVE REGS                     */ 00015000
         STM   R0,R15,SAVEREGS                                     0448 00016000
*   IF R0=0 THEN                   /* IEDQUI (IEDRESP ISSUED IN   0449 00017000
*                                      INHDR OR INBUF) OR IEDQA4   0449 00018000
*                                      ENTRY                         */ 00019000
         SLR   @10,@10                                             0449 00020000
         CR    R0,@10                                              0449 00021000
         BE    @RF00449                                            0449 00022000
*     DO;                           /* YES                           */ 00023000
*       IF RPARM=0 THEN             /* ENTRY FROM IEDQA4             */ 00024000
         CR    RPARM,@10                                           0451 00025000
         BNE   @RF00451                                            0451 00026000
*         DO;                       /* YES                           */ 00027000
*           CALL QA4ENTRY;          /* IEDQA4 ENTRY PROCESSING       */ 00028000
         BAL   @14,QA4ENTRY                                        0453 00029000
*           LM(R0,R15,SAVEREGS);    /* RESTORE REGS                  */ 00030000
         LM    R0,R15,SAVEREGS                                     0454 00031000
*           RETURN;                 /* RETURN TO QA4                 */ 00032000
@EL00001 DS    0H                                                  0455 00033000
@EF00001 DS    0H                                                  0455 00034000
@ER00001 BR    @14                                                 0455 00035000
*         END;                                                     0456 00036000
*       ELSE                        /* IEDQUI ENTRY                  */ 00037000
*         DO;                                                      0457 00038000
@RF00451 DS    0H                                                  0458 00039000
*           PARM=RPARM;             /* SET UP IEDRESP MACRO PARAMTER    00040000
*                                      LIST POINTER                  */ 00041000
         ST    RPARM,PARM                                          0458 00042000
*           SAVE13=R13;             /* SAVE R13                      */ 00043000
         ST    R13,SAVE13                                          0459 00044000
*           R13=R9+LENGTH(SAVEREGS);/* ADDR OF AVTSAVE2              */ 00045000
         LA    R13,72                                              0460 00046000
         ALR   R13,R9                                              0460 00047000
*           CALL QUIENTRY;          /* IEDQUI ENTRY PROCESSING       */ 00048000
         BAL   @14,QUIENTRY                                        0461 00049000
*           R15=RC;                 /* SET UP RETURN CODE            */ 00050000
         L     R15,RC                                              0462 00051000
*           R14=AVTUI+4;            /* RETURN TO 2ND ENTRY IN IEDQUI */ 00052000
         LA    R14,4                                               0463 00053000
         AL    R14,AVTUI(,IEDQAPTR)                                0463 00054000
*           R13=SAVE13;             /* RESTORE R13                   */ 00055000
         L     R13,SAVE13                                          0464 00056000
*           RETURN;                 /* RETURN TO IEDQUI              */ 00057000
         B     @EL00001                                            0465 00058000
*         END;                                                     0466 00059000
*     END;                                                         0467 00060000
*   ELSE                            /* IEDQBD ENTRY                  */ 00061000
*     DO;                                                          0468 00062000
@RF00449 DS    0H                                                  0469 00063000
*       LCBERBLK=RPARM;             /* SET UP POST LIST              */ 00064000
         STCM  RPARM,7,LCBERBLK(IEDQLPTR)                          0469 00065000
*       IF R9=0 THEN                /* 'DEFAULT' ENTRY (FROM IEDQBD     00066000
*                                      AFTER ALL INMSG MACROS HAVE 0470 00067000
*                                      BEEN EXECUTED)                */ 00068000
         LTR   R9,R9                                               0470 00069000
         BNZ   @RF00470                                            0470 00070000
*         CALL DEFAULT;             /* 'DEFAULT' ENTRY PROCESSING    */ 00071000
         BAL   @14,DEFAULT                                         0471 00072000
*       ELSE                        /* ENTRY AS A RESULT OF IEDRESP     00073000
*                                      MACRO ISSUED IN INMSG SUBGROUP*/ 00074000
*         DO;                                                      0472 00075000
         B     @RC00470                                            0472 00076000
@RF00470 DS    0H                                                  0473 00077000
*           PARM=R8;                /* ADDR OF IEDRESP MACRO PARAMTER   00078000
*                                      LIST                          */ 00079000
         ST    R8,PARM                                             0473 00080000
*           CALL INMSG;             /* DO INMSG IEDRESP PROCESSING   */ 00081000
         BAL   @14,INMSG                                           0474 00082000
*         END;                                                     0475 00083000
*                                                                  0475 00084000
*/*                                                                  */ 00085000
*                                                                  0476 00086000
*       LCBERBQB=IEDQBD;            /* SET ERB UP IEDQBD TPOST     0476 00087000
*                                      ADDRESS                       */ 00088000
@RC00470 L     @10,AVTMSGS-1(,IEDQAPTR)                            0476 00089000
         MVC   LCBERBQB(3,IEDQLPTR),IEDQBD+1(@10)                  0476 00090000
*       LCBERBPY=PRIEDISP;          /* SET TPOST PRIORITY            */ 00091000
         MVI   LCBERBPY(IEDQLPTR),X'E0'                            0477 00092000
*       RPARM=ADDR(LCBERB);         /* ELEMENT ADDRESS = ERB         */ 00093000
         LA    RPARM,LCBERB(,IEDQLPTR)                             0478 00094000
*       RDISP=AVTEA;                /* DISPATCHER BASE               */ 00095000
         L     RDISP,AVTEA(,IEDQAPTR)                              0479 00096000
*       CALL DSPCHAIN;              /* TPOST ERB BACK TO IEDQBD      */ 00097000
         LA    @15,DSPCHAIN(,RDISP)                                0480 00098000
         BALR  @14,@15                                             0480 00099000
*     END;                                                         0481 00100000
*                                                                  0481 00101000
*/********************************************************************/ 00102000
*/*  END OF MAIN ROUTINE                                             */ 00103000
*/********************************************************************/ 00104000
*                                                                  0482 00105000
*                                                                  0482 00106000
*/********************************************************************/ 00107000
*/*                                                                  */ 00108000
*/* THIS ROUTINE GETS A BUFFER UNIT BY EITHER STEALING IT OR IF THAT */ 00109000
*/* FAILS  POSTING AN ERB.                                           */ 00110000
*/*                                                                  */ 00111000
*/********************************************************************/ 00112000
*                                                                  0482 00113000
*ALLOCBUF:                                                         0482 00114000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0482 00115000
         B     @EL00001                                            0482 00116000
ALLOCBUF DS    0H                                                  0483 00117000
*   DCL                                                            0483 00118000
*     BFRQCB LABEL GEND;            /* IEDQRS'S INTERNAL RETURN QCB  */ 00119000
*   LCBLINK=R14;                    /* SAVE RETURN REG               */ 00120000
         STCM  R14,7,LCBLINK(IEDQLPTR)                             0484 00121000
*   R0=1;                           /* ONE UNIT PER BUFFER           */ 00122000
         LA    @10,1                                               0485 00123000
         LR    R0,@10                                              0485 00124000
*   RPARM=1;                        /* ONE BUFFER                    */ 00125000
         LR    RPARM,@10                                           0486 00126000
*   CALL IEDQGA02;                  /* TRY TO STEAL A BUFFER         */ 00127000
         L     @15,AVTSTEAL(,IEDQAPTR)                             0487 00128000
         BALR  @14,@15                                             0487 00129000
*   IF R15=0 THEN                  /* GOT ONE                       */ 00130000
         LTR   R15,R15                                             0488 00131000
         BZ    @RF00488                                            0488 00132000
*     RPRF=R15;                     /* SET BUFFER ADDRESSABILITY     */ 00133000
         LR    RPRF,R15                                            0489 00134000
*   ELSE                            /* DID NOT GET ONE               */ 00135000
*     DO;                                                          0490 00136000
         B     @RC00488                                            0490 00137000
@RF00488 DS    0H                                                  0491 00138000
*       LCBDLNKN=OFF;               /* SHOW ERB IN USE               */ 00139000
         NI    LCBDLNKN(IEDQLPTR),B'11111110'                      0491 00140000
*       LCBRCQCB=ADDR(BFRQCB);      /* RETURN QCB ADDRESS            */ 00141000
         LA    @10,BFRQCB                                          0492 00142000
         ST    @10,LCBRCQCB(,IEDQLPTR)                             0492 00143000
*       LCBERBQB=ADDR(AVTBFREB);    /* ADDRESS OF BUFFER REQUEST QCB */ 00144000
         LA    @10,AVTBFREB(,IEDQAPTR)                             0493 00145000
         STCM  @10,7,LCBERBQB(IEDQLPTR)                            0493 00146000
*       LCBERBPY=PRIINTRQ;          /* TPOST PRIORITY                */ 00147000
         MVI   LCBERBPY(IEDQLPTR),X'E4'                            0494 00148000
*       LCBRBCT1=1;                 /* # BUFFERS                     */ 00149000
         MVI   LCBRBCT1(IEDQLPTR),X'01'                            0495 00150000
*       LCBRBCT2=1;                 /* # UNITS PER BUFFER            */ 00151000
         MVI   LCBRBCT2(IEDQLPTR),X'01'                            0496 00152000
*       LCBPRCPG=ON;                /* INDICATE APPLICATION TYPE   0497 00153000
*                                      BUFFER REQUEST                */ 00154000
         OI    LCBPRCPG(IEDQLPTR),B'00000010'                      0497 00155000
*       RPARM=ADDR(LCBERB);         /* ELEMENT ADDRESS FOR POST      */ 00156000
         LA    RPARM,LCBERB(,IEDQLPTR)                             0498 00157000
*       RDISP=AVTEA;                /* SET DISPATCHER BASE           */ 00158000
         L     RDISP,AVTEA(,IEDQAPTR)                              0499 00159000
*       CALL DSPCHAIN;              /* TPOST ERB                     */ 00160000
         LA    @15,DSPCHAIN(,RDISP)                                0500 00161000
         BALR  @14,@15                                             0500 00162000
*                                                                  0501 00163000
*       /*************************************************************/ 00164000
*       /*                                                           */ 00165000
*       /* THE FOLLOWING GEN BUILDS THE QCB TO WHICH THE ERB IS      */ 00166000
*       /* TPOSTED AFTER THE BUFFER IS ALLOCATED. THE STCB LINK      */ 00167000
*       /* POINTER IS THE LAST 3 BYTES OF THE 4 BYTE STCB. THE CODE  */ 00168000
*       /* IMMEDIATELY FOLLOWING THE STCB GETS CONTROL WHEN THE ERB  */ 00169000
*       /* IS RETURNED. ENTRY CONDITIONS ARE THEN RESET TO LOOK AS IF*/ 00170000
*       /* IEDQBD ENTRY AND NON-USER REQUEST. NOTE THAT ALL LOCAL    */ 00171000
*       /* STORAGE AS WELL AS ALL REGISTERS MUST BE RESTORED IF      */ 00172000
*       /* NEEDED. THIS IS BECAUSE WHILE THIS INMSG ENTRY IS OFF     */ 00173000
*       /* GETTING BUFFERS ANOTHER INMSG IN ANOTHER MH COULD BE      */ 00174000
*       /* CAUSING IEDQRS TO GET CONTROL WHICH WILL RESULT IN LOCAL  */ 00175000
*       /* STORAGE GETTING CHANGED.                                  */ 00176000
*       /*                                                           */ 00177000
*       /*************************************************************/ 00178000
*                                                                  0501 00179000
*       GEN CODE DEFS(BFRQCB) REFS(RBASE);                         0501 00180000
ADDRQRS  DC    A(IEDQRS)                IEDQRS BASE ADDRESS             00181000
         ORG *-8                                                        00182000
         USING *,7                                                      00183000
BFRQCB   EQU   *                        BUFFER RETURN QCB ADDRESS       00184000
         ORG                                                            00185000
         DC    AL1(06)                  STCB VTO                        00186000
         DC    AL3(*-1)                 STCB POINTER                    00187000
REENTRY  L     RBASE,ADDRQRS            RESET PROGRAM BASE              00188000
         DROP  7                                                        00189000
         USING IEDQRS,RBASE                                             00190000
*       RLCB=RPARM-(ADDR(LCBERB)-ADDR(IEDQLCB));/* PLCB ADDRESS      */ 00191000
         LR    @10,RPARM                                           0502 00192000
         SL    @10,@CF02040                                        0502 00193000
         LR    RLCB,@10                                            0502 00194000
*       LCBERBLK=0;                 /* ZERO POSTLIST POINTER, WE'VE     00195000
*                                      ALREADY SENT IT       @YM09027*/ 00196000
         SLR   @10,@10                                             0503 00197000
         STCM  @10,7,LCBERBLK(IEDQLPTR)                            0503 00198000
*       GEN(LA    RLCB,0(RLCB));    /* CLEAR HIGH ORDER BYTE         */ 00199000
         LA    RLCB,0(RLCB)                                             00200000
*       RPRF=LCBERBCH;              /* SA ADDRESS OF ALLOCATED UNIT  */ 00201000
         L     RPRF,LCBERBCH-1(,IEDQLPTR)                          0505 00202000
         LA    RPRF,0(,RPRF)                                       0505 00203000
*       LCBERBCH=0;                 /* RESET ERB BUFFER ADDRESS      */ 00204000
         SLR   @10,@10                                             0506 00205000
         STCM  @10,7,LCBERBCH(IEDQLPTR)                            0506 00206000
*       LCBDLNKN=ON;                /* MARK ERB AVAILABLE            */ 00207000
*       LCBPRCPG=OFF;               /* TURN OFF APPLICATION REQUEST     00208000
*                                      BIT                           */ 00209000
         OI    LCBDLNKN(IEDQLPTR),B'00000001'                      0508 00210000
         NI    LCBPRCPG(IEDQLPTR),B'11111101'                      0508 00211000
*       LCBRCQCB=0;                 /* RESET RETURN QCB ADDRESS      */ 00212000
         ST    @10,LCBRCQCB(,IEDQLPTR)                             0509 00213000
*     END;                                                         0510 00214000
*                                                                  0510 00215000
*/*                                                                  */ 00216000
*                                                                  0511 00217000
*   R14=LCBLINK;                    /* RESTORE RETURN REG            */ 00218000
@RC00488 L     R14,LCBLINK-1(,IEDQLPTR)                            0511 00219000
         LA    R14,0(,R14)                                         0511 00220000
*   RETURN;                                                        0512 00221000
@EL00002 DS    0H                                                  0512 00222000
@EF00002 DS    0H                                                  0512 00223000
@ER00002 BR    @14                                                 0512 00224000
*   END ALLOCBUF;                                                  0513 00225000
*                                                                  0514 00226000
*/********************************************************************/ 00227000
*/*                                                                  */ 00228000
*/*  THIS ROUTINE LOCATES THE SENSE BYTES AND VALIDATES THEM.        */ 00229000
*/*     INPUT:                                                       */ 00230000
*/*          CMDBYTE - CONTAINS THE DATA FLOW CONTROL COMMAND OR 0   */ 00231000
*/*                                                                  */ 00232000
*/********************************************************************/ 00233000
*                                                                  0514 00234000
*CKSNS:                                                            0514 00235000
*   PROC OPTIONS(SAVE(R14));                                       0514 00236000
CKSNS    ST    @14,@SA00003                                        0514 00237000
*   IF RLCB=SAVTSLCB THEN          /* SSCP FLOW                     */ 00238000
         L     @10,AVTSAVTP(,IEDQAPTR)                             0515 00239000
         C     RLCB,SAVTSLCB(,@10)                                 0515 00240000
         BE    @RF00515                                            0515 00241000
*     DO;                           /* NO- DO VALIDITY CHECKING      */ 00242000
*       RPARM=PARM;                 /* ADDR OF PARM LIST             */ 00243000
         L     RPARM,PARM                                          0517 00244000
*       IF PLMASKI=ON THEN          /* ON-NO MASK PRESENT            */ 00245000
         TM    PLMASKI(RPARM),B'00000001'                          0518 00246000
         BNO   @RF00518                                            0518 00247000
*         RPARM=RPARM-4;            /* ADJUST PARM LIST PTR          */ 00248000
         SL    RPARM,@CF00255                                      0519 00249000
*       IF PLQAENDX=0 THEN          /* SENSE IN OPTION FIELD         */ 00250000
@RF00518 CLI   PLQAENDX(RPARM),0                                   0520 00251000
         BNE   @RF00520                                            0520 00252000
*         DO;                       /* NO                            */ 00253000
*           IF PLCOUNT=OFF THEN     /* 'COUNT=' SPECIFIED            */ 00254000
         TM    PLCOUNT,B'10000000'                                 0522 00255000
         BNZ   @RF00522                                            0522 00256000
*             RPARM=RPARM-8;        /* NO, ADJUST PARM LIST PTR      */ 00257000
         SL    RPARM,@CF00044                                      0523 00258000
*           LCBLUSNS=PLSNS;         /* MOVE SENSE TO LCB             */ 00259000
@RF00522 MVC   LCBLUSNS(4,IEDQLPTR),PLSNS(RPARM)                   0524 00260000
*           CALL SNSER;             /* VALIDATE SENSE                */ 00261000
         BAL   @14,SNSER                                           0525 00262000
*         END;                                                     0526 00263000
*       ELSE                        /* SENSE BYTES ARE IN OPTION   0527 00264000
*                                      FIELD                         */ 00265000
*         DO;                                                      0527 00266000
         B     @RC00520                                            0527 00267000
@RF00520 DS    0H                                                  0528 00268000
*           QAEOPNO=PLOPNO;         /* SET OPTION NUMBER IN QAE PARM    00269000
*                                      LIST                          */ 00270000
         IC    @10,PLOPNO(,RPARM)                                  0528 00271000
         STC   @10,QAEOPNO                                         0528 00272000
*           R15=(AVTMSGS+PLQAENDX)->PTR31;/* IEDQAE(OPTION LOOK UP)     00273000
*                                      ADDRESS                       */ 00274000
         L     @10,AVTMSGS-1(,IEDQAPTR)                            0529 00275000
         LA    @10,0(,@10)                                         0529 00276000
         SLR   @07,@07                                             0529 00277000
         IC    @07,PLQAENDX(,RPARM)                                0529 00278000
         ALR   @10,@07                                             0529 00279000
         L     R15,PTR31(,@10)                                     0529 00280000
*           R2=R13;                 /* SAVE AVT ADDRESS      @YM09013*/ 00281000
         LR    R2,R13                                              0530 00282000
*           R13=ADDR(AVTSAVE4);     /* SAVE AREA FOR IEDQAE  @YM09013*/ 00283000
         LA    @10,AVTSAVE4(,IEDQAPTR)                             0531 00284000
         LR    R13,@10                                             0531 00285000
*           RPARM=ADDR(QAEPL);      /* PARM LIST ADDR IN REG1        */ 00286000
         LA    RPARM,QAEPL                                         0532 00287000
*           GEN(BAL  R14,4(R15));   /* GET OPTION FIELD CONTAINING 0533 00288000
*                                      SENSE                         */ 00289000
         BAL  R14,4(R15)                                                00290000
*           R13=R2;                 /* RESTORE AVT ADDRESS   @YM09013*/ 00291000
         LR    R13,R2                                              0534 00292000
*           IF R15=0 THEN           /* GOT OPTION FIELD O.K.         */ 00293000
         LTR   R15,R15                                             0535 00294000
         BNZ   @RF00535                                            0535 00295000
*             DO;                   /* YES                           */ 00296000
*               LCBLUSNS=RPARM->CHAR4;/* MOVE SENSE TO LCB           */ 00297000
         MVC   LCBLUSNS(4,IEDQLPTR),CHAR4(RPARM)                   0537 00298000
*               CALL SNSER;         /* VALIDATE SENSE                */ 00299000
         BAL   @14,SNSER                                           0538 00300000
*             END;                                                 0539 00301000
*           ELSE                    /* OPTION NOT FOUND              */ 00302000
*             RC=INVLOPTN;          /* SET INVALID OPTION RETURN CODE*/ 00303000
         B     @RC00535                                            0540 00304000
@RF00535 MVC   RC(4),@CF00044                                      0540 00305000
*         END;                                                     0541 00306000
*     END;                                                         0542 00307000
*   RETURN;                                                        0543 00308000
@EL00003 DS    0H                                                  0543 00309000
@EF00003 DS    0H                                                  0543 00310000
@ER00003 L     @14,@SA00003                                        0543 00311000
         BR    @14                                                 0543 00312000
*   END CKSNS;                                                     0544 00313000
         B     @EL00003                                            0544 00314000
*                                                                  0545 00315000
*/********************************************************************/ 00316000
*/*                                                                  */ 00317000
*/* THIS ROUTINE HANDLES DEFAULT RESPONSES.                          */ 00318000
*/*                                                                  */ 00319000
*/********************************************************************/ 00320000
*                                                                  0545 00321000
*DEFAULT:                                                          0545 00322000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0545 00323000
DEFAULT  DS    0H                                                  0546 00324000
*   LCBQCBA=R14;                    /* SAVE RETURN ADDRESS           */ 00325000
         STCM  R14,7,LCBQCBA(IEDQLPTR)                             0546 00326000
*   IF LCBRESP=ON THEN              /* RSP STILL NEEDED FOR THIS   0547 00327000
*                                      CHAIN                         */ 00328000
         TM    LCBRESP(IEDQLPTR),B'00000001'                       0547 00329000
         BNO   @RF00547                                            0547 00330000
*     DO;                           /* YES                           */ 00331000
*       LCBRESP=OFF;                /* INDICATE RSP NOT NEEDED     0549 00332000
*                                      ANYMORE                       */ 00333000
         NI    LCBRESP(IEDQLPTR),B'11111110'                       0549 00334000
*       RHLCB=ADDR(LCBRHSV);        /* ADDR OF RH OF REQUEST WE ARE     00335000
*                                      RESPONDING TO                 */ 00336000
         LA    RHLCB,LCBRHSV(,IEDQLPTR)                            0550 00337000
*       IF RHLCB->TRHDR1=ON|        /* A REQUEST ASKING FOR...       */ 00338000
*           RHLCB->TRHDR2=ON THEN   /* SOME KIND OF RESPONSE         */ 00339000
         TM    TRHDR1(RHLCB),B'10100000'                           0551 00340000
         BZ    @RF00551                                            0551 00341000
*         DO;                       /* YES                           */ 00342000
*           IF RHLCB->TRHRUCAT=TRHDFC THEN/* DATA FLOW CONTROL     0553 00343000
*                                      COMMAND                       */ 00344000
         TM    TRHRUCAT(RHLCB),B'01000000'                         0553 00345000
         BNO   @RF00553                                            0553 00346000
         TM    TRHRUCAT(RHLCB),B'00100000'                         0553 00347000
         BNZ   @RF00553                                            0553 00348000
*             CMDBYTE=LCBDFCMD;     /* SET UP COMMAND BYTE           */ 00349000
         MVC   CMDBYTE(1),LCBDFCMD(IEDQLPTR)                       0554 00350000
*           ELSE                    /* NOT DFC                       */ 00351000
*             CMDBYTE=0;            /* SET COMMAND BYTE TO ZERO      */ 00352000
         B     @RC00553                                            0555 00353000
@RF00553 MVI   CMDBYTE,X'00'                                       0555 00354000
*/*                                                                  */ 00355000
*                                                                  0556 00356000
*           IF LCBRSRH=ON THEN      /* HAS A RESPONSE BEEN PREVIOUSLY   00357000
*                                      GENERATED BUT NOT SENT        */ 00358000
@RC00553 TM    LCBRSRH(IEDQLPTR),B'01000000'                       0556 00359000
         BNO   @RF00556                                            0556 00360000
*             DO;                   /* YES                           */ 00361000
*               CALL ALLOCBUF;      /* ALLOCATE A BUFFER UNIT        */ 00362000
         BAL   @14,ALLOCBUF                                        0558 00363000
*               EXCPRSP=ON;         /* INDICATE AN EXCEPTION RESPONSE   00364000
*                                      IS TO BE SENT                 */ 00365000
         OI    EXCPRSP,B'10000000'                                 0559 00366000
*               CALL SENDRESP;      /* SEND THE GENERATED RESPONSE   */ 00367000
         BAL   @14,SENDRESP                                        0560 00368000
*             END;                                                 0561 00369000
*           ELSE                    /* RSP NOT PREVIOUSLY GENERATED  */ 00370000
*             DO;                                                  0562 00371000
         B     @RC00556                                            0562 00372000
@RF00556 DS    0H                                                  0563 00373000
*               IF CMDBYTE=CD1CANCL&/* NOT CANCEL COMMAND AND..     */ 00374000
*                   CMDBYTE=CD1RTR&/* NOT RTR COMMAND AND...        */ 00375000
*                   RHLCB->TRHER=OFF THEN/* REQUEST IS ASKING FOR  0563 00376000
*                                      DEFINITE RESPONSE             */ 00377000
         CLI   CMDBYTE,X'83'                                       0563 00378000
         BE    @RF00563                                            0563 00379000
         CLI   CMDBYTE,X'05'                                       0563 00380000
         BE    @RF00563                                            0563 00381000
         TM    TRHER(RHLCB),B'00010000'                            0563 00382000
         BNZ   @RF00563                                            0563 00383000
*                 DO;               /* YES                           */ 00384000
*                   CALL ALLOCBUF;  /* ALLOCATE A BUFFER UNIT        */ 00385000
         BAL   @14,ALLOCBUF                                        0565 00386000
*                   EXCPRSP=OFF;    /* INDICATE A POSITIVE RESPONSE     00387000
*                                      IS TO BE SENT                 */ 00388000
         NI    EXCPRSP,B'01111111'                                 0566 00389000
*                   CALL SENDRESP;  /* SEND A POSITIVE RESPONSE      */ 00390000
         BAL   @14,SENDRESP                                        0567 00391000
*                 END;                                             0568 00392000
*             END;                                                 0569 00393000
@RF00563 DS    0H                                                  0570 00394000
*         END;                                                     0570 00395000
@RC00556 DS    0H                                                  0571 00396000
*     END;                                                         0571 00397000
*                                                                  0571 00398000
@RF00551 DS    0H                                                  0572 00399000
*/*                                                                  */ 00400000
*                                                                  0572 00401000
*   IF LCBCANXT=ON THEN             /* RESPONSE OWED TO CANCEL       */ 00402000
@RF00547 TM    LCBCANXT(IEDQLPTR),B'10000000'                      0572 00403000
         BNO   @RF00572                                            0572 00404000
*     DO;                           /* YES                           */ 00405000
*       LCBCANXT=OFF;               /* INDICATE RSP SENT TO CANCEL   */ 00406000
         NI    LCBCANXT(IEDQLPTR),B'01111111'                      0574 00407000
*       LCBRSRH=OFF;                /* INDICATE +RSP (FOR ERRORMSG)     00408000
*                                                            @YM07705*/ 00409000
         NI    LCBRSRH(IEDQLPTR),B'10111111'                       0575 00410000
*       LCBTHSQ=LCBCANTH;           /* CANCEL SEQUENCE NUMBER        */ 00411000
         MVC   LCBTHSQ(2,IEDQLPTR),LCBCANTH(IEDQLPTR)              0576 00412000
*       LCBRHSV=CANCELRH;           /* CANCEL RH                     */ 00413000
         MVC   LCBRHSV(3,IEDQLPTR),@CB01934                        0577 00414000
*       LCBDFCMD=CD1CANCL;          /* CANCEL COMMAND BYTE           */ 00415000
         MVI   LCBDFCMD(IEDQLPTR),X'83'                            0578 00416000
*       LCBEXPI=OFF;                /* NORMAL FLOW                   */ 00417000
         NI    LCBEXPI(IEDQLPTR),B'01111111'                       0579 00418000
*/*                                                                  */ 00419000
*                                                                  0580 00420000
*       CALL ALLOCBUF;              /* GET BUF UNIT FOR RESPONSE     */ 00421000
         BAL   @14,ALLOCBUF                                        0580 00422000
*       EXCPRSP=OFF;                /* INDICATE POSITIVE RESPONSE IS    00423000
*                                      TO BE SENT                    */ 00424000
         NI    EXCPRSP,B'01111111'                                 0581 00425000
*       CALL SENDRESP;              /* SEND A POS. RESPONSE TO CANCEL*/ 00426000
         BAL   @14,SENDRESP                                        0582 00427000
*     END;                                                         0583 00428000
*                                                                  0583 00429000
*/*                                                                  */ 00430000
*                                                                  0584 00431000
*   R14=LCBQCBA;                    /* RESTORE RETURN ADDRESS        */ 00432000
@RF00572 L     R14,LCBQCBA-1(,IEDQLPTR)                            0584 00433000
         LA    R14,0(,R14)                                         0584 00434000
*   RETURN;                                                        0585 00435000
@EL00004 DS    0H                                                  0585 00436000
@EF00004 DS    0H                                                  0585 00437000
@ER00004 BR    @14                                                 0585 00438000
*   END DEFAULT;                                                   0586 00439000
*                                                                  0587 00440000
*/********************************************************************/ 00441000
*/*                                                                  */ 00442000
*/* THIS ROUTINE HANDLES PROCESSING FOR IEDRESP MACRO ISSUED IN      */ 00443000
*/* INMSG SUBGROUP.                                                  */ 00444000
*/*                                                                  */ 00445000
*/********************************************************************/ 00446000
*                                                                  0587 00447000
*INMSG:                                                            0587 00448000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0587 00449000
INMSG    DS    0H                                                  0588 00450000
*   LCBQCBA=R14;                    /* SAVE RETURN ADDRESS           */ 00451000
         STCM  R14,7,LCBQCBA(IEDQLPTR)                             0588 00452000
*/*                                                                  */ 00453000
*                                                                  0589 00454000
*   IF LCBFLAG1=0&                  /* PLCB AND...                   */ 00455000
*       LCBLUNIT=ON THEN            /* SNA LOGICAL UNIT      @YM08571*/ 00456000
         CLI   LCBFLAG1(IEDQLPTR),0                                0589 00457000
         BNE   @RF00589                                            0589 00458000
         TM    LCBLUNIT(IEDQLPTR),B'01000000'                      0589 00459000
         BNO   @RF00589                                            0589 00460000
*     DO;                           /*                       @YM08571*/ 00461000
*       IF LCBRESP=ON THEN          /* RESPONSE STILL NEEDED @YM08571*/ 00462000
         TM    LCBRESP(IEDQLPTR),B'00000001'                       0591 00463000
         BNO   @RF00591                                            0591 00464000
*         DO;                       /* YES                           */ 00465000
*           IF LCBRSRH=OFF THEN     /* RSP NOT PREVIOUSLY GENERATED  */ 00466000
         TM    LCBRSRH(IEDQLPTR),B'01000000'                       0593 00467000
         BNZ   @RF00593                                            0593 00468000
*             DO;                   /* YES                           */ 00469000
*               RC=0;               /* INIT RETURN CODE TO ZERO      */ 00470000
         SLR   @10,@10                                             0595 00471000
         ST    @10,RC                                              0595 00472000
*               CALL TESTCOND;      /* TEST TO SEE IF IEDRESP SHOULD    00473000
*                                      BE EXECUTED                   */ 00474000
         BAL   @14,TESTCOND                                        0596 00475000
*               IF RC=0 THEN        /* IEDRESP SHOULD BE EXECUTED    */ 00476000
         L     @10,RC                                              0597 00477000
         LTR   @10,@10                                             0597 00478000
         BNZ   @RF00597                                            0597 00479000
*                 DO;               /* YES                           */ 00480000
*                   RHLCB=ADDR(LCBRHSV);/* ADDR OF RH OF REQUEST WE     00481000
*                                      ARE RESPONDING TO             */ 00482000
         LA    RHLCB,LCBRHSV(,IEDQLPTR)                            0599 00483000
*/*                                                                  */ 00484000
*                                                                  0600 00485000
*                   IF RHLCB->TRHDR1=ON|RHLCB->TRHDR2=ON THEN/*    0600 00486000
*                                      REQUEST ASKING FOR SOME     0600 00487000
*                                      RESPONSE                      */ 00488000
         TM    TRHDR1(RHLCB),B'10100000'                           0600 00489000
         BZ    @RF00600                                            0600 00490000
*                     DO;           /* YES                           */ 00491000
*                       IF RHLCB->TRHRUCAT=TRHDFC THEN/* DATA FLOW 0602 00492000
*                                      CTRL.                         */ 00493000
         TM    TRHRUCAT(RHLCB),B'01000000'                         0602 00494000
         BNO   @RF00602                                            0602 00495000
         TM    TRHRUCAT(RHLCB),B'00100000'                         0602 00496000
         BNZ   @RF00602                                            0602 00497000
*                         CMDBYTE=LCBDFCMD;/* YES, SET DFC COMMAND   */ 00498000
         MVC   CMDBYTE(1),LCBDFCMD(IEDQLPTR)                       0603 00499000
*                       ELSE        /* NOT DFC                       */ 00500000
*                         CMDBYTE=0;/* SET COMMAND TO 0              */ 00501000
         B     @RC00602                                            0604 00502000
@RF00602 MVI   CMDBYTE,X'00'                                       0604 00503000
*/*                                                                  */ 00504000
*                                                                  0605 00505000
*                       IF PLSNSI=OFF THEN/* POSITIVE RESPONSE       */ 00506000
@RC00602 TM    PLSNSI,B'00100000'                                  0605 00507000
         BNZ   @RF00605                                            0605 00508000
*                         DO;       /* YES                           */ 00509000
*                           IF CMDBYTE=CD1RTR&/* NOT RTR (WHEN QRS     00510000
*                                      IS ENTERED BEFORE THE 1ST   0607 00511000
*                                      MSGGEN MACRO IN INMSG IT IS 0607 00512000
*                                      NOT KNOWN WHETHER THE MSGGEN     00513000
*                                      WILL BE SENT. THEREFORE A   0607 00514000
*                                      POSITIVE RESPONSE TO RTR MUST    00515000
*                                      NOT BE SENT)                  */ 00516000
*                               RHLCB->TRHER=OFF THEN/* REQUEST IS 0607 00517000
*                                      ASKING FOR POSITIVE RESPONSE  */ 00518000
         CLI   CMDBYTE,X'05'                                       0607 00519000
         BE    @RF00607                                            0607 00520000
         TM    TRHER(RHLCB),B'00010000'                            0607 00521000
         BNZ   @RF00607                                            0607 00522000
*                             DO;   /* YES                           */ 00523000
*                               IF CMDBYTE=CD1CANCL&/* CANCEL AND... */ 00524000
*                                   LCBCANXT=ON THEN/* RESPONSE    0609 00525000
*                                      INFORMATION SET UP FOR CANCEL */ 00526000
         CLI   CMDBYTE,X'83'                                       0609 00527000
         BNE   @RF00609                                            0609 00528000
         TM    LCBCANXT(IEDQLPTR),B'10000000'                      0609 00529000
         BNO   @RF00609                                            0609 00530000
*                                 DO;/* YES                          */ 00531000
*                                   LCBCANXT=OFF;/* RESET RSP NEEDED */ 00532000
         NI    LCBCANXT(IEDQLPTR),B'01111111'                      0611 00533000
*                                   LCBTHSQ=LCBCANTH;/* CANCEL SEQ # */ 00534000
         MVC   LCBTHSQ(2,IEDQLPTR),LCBCANTH(IEDQLPTR)              0612 00535000
*                                   LCBRHSV=CANCELRH;/* CANCEL RH    */ 00536000
         MVC   LCBRHSV(3,IEDQLPTR),@CB01934                        0613 00537000
*                                   LCBDFCMD=CD1CANCL;/* SET DFC   0614 00538000
*                                      COMMAND                       */ 00539000
         MVI   LCBDFCMD(IEDQLPTR),X'83'                            0614 00540000
*                                   LCBEXPI=OFF;/* NORMAL FLOW       */ 00541000
         NI    LCBEXPI(IEDQLPTR),B'01111111'                       0615 00542000
*                                 END;                             0616 00543000
*                                                                  0616 00544000
*/*                                                                  */ 00545000
*                                                                  0617 00546000
*                               CALL ALLOCBUF;/* GET BUFFER UNIT FOR    00547000
*                                      RSP                           */ 00548000
@RF00609 BAL   @14,ALLOCBUF                                        0617 00549000
*                               EXCPRSP=OFF;/* INDICATE POSITIVE RSP    00550000
*                                      IS TO BE SENT                 */ 00551000
         NI    EXCPRSP,B'01111111'                                 0618 00552000
*                               CALL SENDRESP;/* SEND POSITIVE     0619 00553000
*                                      RESPONSE                      */ 00554000
         BAL   @14,SENDRESP                                        0619 00555000
*                             END;                                 0620 00556000
*                         END;                                     0621 00557000
*                       ELSE        /* EXCEPTION RESPONSE            */ 00558000
*                         DO;                                      0622 00559000
         B     @RC00605                                            0622 00560000
@RF00605 DS    0H                                                  0623 00561000
*                           CALL CKSNS;/* CHECK FOR VALID SENSE      */ 00562000
         BAL   @14,CKSNS                                           0623 00563000
*                           IF RC=0 THEN/* SENSE VALID               */ 00564000
         L     @10,RC                                              0624 00565000
         LTR   @10,@10                                             0624 00566000
         BNZ   @RF00624                                            0624 00567000
*                             DO;   /* YES                           */ 00568000
*                               LCBRSRH=ON;/* INDICATE EXCEPTION   0626 00569000
*                                      RESPONSE (FOR ERRORMSG)     0626 00570000
*                                                            @YM07705*/ 00571000
         OI    LCBRSRH(IEDQLPTR),B'01000000'                       0626 00572000
*                               CALL ALLOCBUF;/* GET A BUFFER UNIT   */ 00573000
         BAL   @14,ALLOCBUF                                        0627 00574000
*                               EXCPRSP=ON;/* INDICATE AN EXCEPTION     00575000
*                                      RESPONSE IS TO BE SENT        */ 00576000
         OI    EXCPRSP,B'10000000'                                 0628 00577000
*                               CALL SENDRESP;/* SEND A -RSP         */ 00578000
         BAL   @14,SENDRESP                                        0629 00579000
*                             END;                                 0630 00580000
*                         END;                                     0631 00581000
*                     END;                                         0632 00582000
*                 END;                                             0633 00583000
*             END;                                                 0634 00584000
*           ELSE                    /* RESPONSE PREVIOUSLY GENERATED */ 00585000
*             DO;                                                  0635 00586000
         B     @RC00593                                            0635 00587000
@RF00593 DS    0H                                                  0636 00588000
*               LCBRESP=OFF;        /* INDICATE RESPONSE SENT        */ 00589000
         NI    LCBRESP(IEDQLPTR),B'11111110'                       0636 00590000
*               RHLCB=ADDR(LCBRHSV);/* ADDR OF RH OF REQUEST WE ARE     00591000
*                                      RESPONDING TO                 */ 00592000
         LA    RHLCB,LCBRHSV(,IEDQLPTR)                            0637 00593000
*               IF RHLCB->TRHDR1=ON|RHLCB->TRHDR2=ON THEN/* REQUEST     00594000
*                                      ASKING FOR SOME RESPONSE    0638 00595000
*                                                            @OY20636*/ 00596000
         TM    TRHDR1(RHLCB),B'10100000'                           0638 00597000
         BZ    @RF00638                                            0638 00598000
*                 DO;               /* YES                           */ 00599000
*                   CALL ALLOCBUF;  /* GET A BUFFER UNIT             */ 00600000
         BAL   @14,ALLOCBUF                                        0640 00601000
*                   EXCPRSP=ON;     /* INDICATE AN EXCEPTION RESPONSE   00602000
*                                      IS TO BE BUILT                */ 00603000
         OI    EXCPRSP,B'10000000'                                 0641 00604000
*                   CALL SENDRESP;  /* SEND EXCEPTION RESPONSE       */ 00605000
         BAL   @14,SENDRESP                                        0642 00606000
*                 END;                                             0643 00607000
*                                                                  0643 00608000
*/*                                                                  */ 00609000
*                                                                  0644 00610000
*               IF LCBCANXT=ON THEN /* IS RESPONSE OWED TO CANCEL    */ 00611000
@RF00638 TM    LCBCANXT(IEDQLPTR),B'10000000'                      0644 00612000
         BNO   @RF00644                                            0644 00613000
*                 DO;               /* YES                           */ 00614000
*                   LCBCANXT=OFF;   /* RESET RESPONSE OWED TO CANCEL */ 00615000
         NI    LCBCANXT(IEDQLPTR),B'01111111'                      0646 00616000
*                   LCBRSRH=OFF;    /* INDICATE +RSP(FOR ERRORMSG)   */ 00617000
         NI    LCBRSRH(IEDQLPTR),B'10111111'                       0647 00618000
*                   LCBTHSQ=LCBCANTH;/* CANCEL SEQUENCE NUMBER       */ 00619000
         MVC   LCBTHSQ(2,IEDQLPTR),LCBCANTH(IEDQLPTR)              0648 00620000
*                   LCBRHSV=CANCELRH;/* CANCEL REPSONSE RH           */ 00621000
         MVC   LCBRHSV(3,IEDQLPTR),@CB01934                        0649 00622000
*                   LCBDFCMD=CD1CANCL;/* CANCEL COMMAND CODE         */ 00623000
         MVI   LCBDFCMD(IEDQLPTR),X'83'                            0650 00624000
*                   LCBEXPI=OFF;    /* 'NORMAL' FLOW                 */ 00625000
         NI    LCBEXPI(IEDQLPTR),B'01111111'                       0651 00626000
*                   CALL ALLOCBUF;  /* GET A BUFFER UNIT             */ 00627000
         BAL   @14,ALLOCBUF                                        0652 00628000
*                   EXCPRSP=OFF;    /* INDICATE POSITIVE RESPONSE IS    00629000
*                                      TO BE BUILT                   */ 00630000
         NI    EXCPRSP,B'01111111'                                 0653 00631000
*                   CALL SENDRESP;  /* SEND +RSP TO CANCEL           */ 00632000
         BAL   @14,SENDRESP                                        0654 00633000
*                 END;                                             0655 00634000
*             END;                                                 0656 00635000
*         END;                                                     0657 00636000
*       ELSE                        /* RESPONSE TO FM DATA ALREADY 0658 00637000
*                                      SENT                  @YM08571*/ 00638000
*         DO;                       /*                       @YM08571*/ 00639000
         B     @RC00591                                            0658 00640000
@RF00591 DS    0H                                                  0659 00641000
*           IF LCBCANXT=ON THEN     /* IS RSP OWED TO CANCEL @YM08571*/ 00642000
         TM    LCBCANXT(IEDQLPTR),B'10000000'                      0659 00643000
         BNO   @RF00659                                            0659 00644000
*             DO;                   /* YES                   @YM08571*/ 00645000
*               LCBCANXT=OFF;       /* RESET RSP OWED TO CANCEL    0661 00646000
*                                                            @YM08571*/ 00647000
         NI    LCBCANXT(IEDQLPTR),B'01111111'                      0661 00648000
*               LCBRSRH=OFF;        /* INDICATE +RSP(FOR ERRORMSG) 0662 00649000
*                                                            @YM08571*/ 00650000
         NI    LCBRSRH(IEDQLPTR),B'10111111'                       0662 00651000
*               LCBTHSQ=LCBCANTH;   /* CANCEL SEQUENCE NUMBER      0663 00652000
*                                                            @YM08571*/ 00653000
         MVC   LCBTHSQ(2,IEDQLPTR),LCBCANTH(IEDQLPTR)              0663 00654000
*               LCBRHSV=CANCELRH;   /* CANCEL REPSONSE RH    @YM08571*/ 00655000
         MVC   LCBRHSV(3,IEDQLPTR),@CB01934                        0664 00656000
*               LCBDFCMD=CD1CANCL;  /* CANCEL COMMAND CODE   @YM08571*/ 00657000
         MVI   LCBDFCMD(IEDQLPTR),X'83'                            0665 00658000
*               LCBEXPI=OFF;        /* 'NORMAL' FLOW         @YM08571*/ 00659000
         NI    LCBEXPI(IEDQLPTR),B'01111111'                       0666 00660000
*               CALL ALLOCBUF;      /* GET A BUFFER UNIT     @YM08571*/ 00661000
         BAL   @14,ALLOCBUF                                        0667 00662000
*               EXCPRSP=OFF;        /* INDICATE POSITIVE RESPONSE IS    00663000
*                                      TO BE BUILT           @YM08571*/ 00664000
         NI    EXCPRSP,B'01111111'                                 0668 00665000
*               CALL SENDRESP;      /* SEND +RSP TO CANCEL   @YM08571*/ 00666000
         BAL   @14,SENDRESP                                        0669 00667000
*             END;                  /*                       @YM08571*/ 00668000
*         END;                      /*                       @YM08571*/ 00669000
@RF00659 DS    0H                                                  0672 00670000
*     END;                          /*                       @YM08571*/ 00671000
@RC00591 DS    0H                                                  0673 00672000
*/*                                                                  */ 00673000
*                                                                  0673 00674000
*   R14=LCBQCBA;                    /* RESTORE RETURN ADDRESS        */ 00675000
@RF00589 L     R14,LCBQCBA-1(,IEDQLPTR)                            0673 00676000
         LA    R14,0(,R14)                                         0673 00677000
*   RETURN;                                                        0674 00678000
@EL00005 DS    0H                                                  0674 00679000
@EF00005 DS    0H                                                  0674 00680000
@ER00005 BR    @14                                                 0674 00681000
*   END INMSG;                                                     0675 00682000
*                                                                  0676 00683000
*/********************************************************************/ 00684000
*/*                                                                  */ 00685000
*/* THIS ROUTINE GETS CONTROL ON ENTRY FOR IEDQA4 TO SEND PREVIOUSLY */ 00686000
*/* GENERATED RESPONSES.                                             */ 00687000
*/*                                                                  */ 00688000
*/********************************************************************/ 00689000
*                                                                  0676 00690000
*QA4ENTRY:                                                         0676 00691000
*   PROC OPTIONS(SAVE(R14));                                       0676 00692000
QA4ENTRY ST    @14,@SA00006                                        0676 00693000
*   RHLCB=ADDR(LCBRHSV);            /* ADDR OF RH OF REQUEST WE ARE     00694000
*                                      RESPONDING TO                 */ 00695000
         LA    RHLCB,LCBRHSV(,IEDQLPTR)                            0677 00696000
*   IF RHLCB->TRHDR1=OFF&RHLCB->TRHDR2=OFF THEN/* REQUEST ASKING FOR    00697000
*                                      NO RESPONSE                   */ 00698000
         TM    TRHDR1(RHLCB),B'10100000'                           0678 00699000
         BNZ   @RF00678                                            0678 00700000
*     LCBRESP=OFF;                  /* YES, INDICATE RSP NO LONGER 0679 00701000
*                                      NEEDED FOR THIS CHAIN         */ 00702000
         NI    LCBRESP(IEDQLPTR),B'11111110'                       0679 00703000
*   ELSE                            /* RESPONSE IS REQUESTED         */ 00704000
*     DO;                                                          0680 00705000
         B     @RC00678                                            0680 00706000
@RF00678 DS    0H                                                  0681 00707000
*       R0=1;                       /* ONE UNIT PER BUFFER           */ 00708000
         LA    @10,1                                               0681 00709000
         LR    R0,@10                                              0681 00710000
*       RPARM=1;                    /* ONE BUFFER                    */ 00711000
         LR    RPARM,@10                                           0682 00712000
*       CALL IEDQGA02;              /* TRY TO STEAL A BUFFER         */ 00713000
         L     @15,AVTSTEAL(,IEDQAPTR)                             0683 00714000
         BALR  @14,@15                                             0683 00715000
*       IF R15=0 THEN              /* SUCCESSFUL                    */ 00716000
         LTR   R15,R15                                             0684 00717000
         BZ    @RF00684                                            0684 00718000
*         DO;                       /* YES                           */ 00719000
*           RPRF=R15;               /* SET BUFFER ADDRESS            */ 00720000
         LR    RPRF,R15                                            0686 00721000
*           EXCPRSP=ON;             /* INDICATE AN EXCEPTION RESPONSE   00722000
*                                      IS TO BE SENT                 */ 00723000
         OI    EXCPRSP,B'10000000'                                 0687 00724000
*           CALL SENDRESP;          /* SEND A -RSP                   */ 00725000
         BAL   @14,SENDRESP                                        0688 00726000
*         END;                                                     0689 00727000
*     END;                                                         0690 00728000
*   RETURN;                                                        0691 00729000
@EL00006 DS    0H                                                  0691 00730000
@EF00006 DS    0H                                                  0691 00731000
@ER00006 L     @14,@SA00006                                        0691 00732000
         BR    @14                                                 0691 00733000
*   END QA4ENTRY;                                                  0692 00734000
         B     @EL00006                                            0692 00735000
*                                                                  0693 00736000
*/********************************************************************/ 00737000
*/*                                                                  */ 00738000
*/* THIS ROUTINE DOES PROCESSING FOR IEDRESP MACRO ISSUED IN INHDR OR*/ 00739000
*/* IN BUF SUBGOUPS.                                                 */ 00740000
*/*                                                                  */ 00741000
*/********************************************************************/ 00742000
*                                                                  0693 00743000
*QUIENTRY:                                                         0693 00744000
*   PROC OPTIONS(SAVE(R14));                                       0693 00745000
QUIENTRY ST    @14,@SA00007                                        0693 00746000
*   IF LCBFLAG1=0&                  /* PLCB AND...                   */ 00747000
*       LCBLUNIT=ON THEN            /* SNA LOGOCAL UNIT              */ 00748000
         CLI   LCBFLAG1(IEDQLPTR),0                                0694 00749000
         BNE   @RF00694                                            0694 00750000
         TM    LCBLUNIT(IEDQLPTR),B'01000000'                      0694 00751000
         BNO   @RF00694                                            0694 00752000
*     DO;                           /* YES                           */ 00753000
*       IF LCBRESP=ON&              /* RSP STILL NEEDED AND ...      */ 00754000
*           LCBRSRH=OFF THEN        /* RSP NOT PREVIOUSLY GENERATED  */ 00755000
         TM    LCBRESP(IEDQLPTR),B'00000001'                       0696 00756000
         BNO   @RF00696                                            0696 00757000
         TM    LCBRSRH(IEDQLPTR),B'01000000'                       0696 00758000
         BNZ   @RF00696                                            0696 00759000
*         DO;                       /* YES                           */ 00760000
*           RC=0;                   /* INIT RETURN CODE TO ZERO      */ 00761000
         SLR   @10,@10                                             0698 00762000
         ST    @10,RC                                              0698 00763000
*           CALL TESTCOND;          /* TEST CONDITIONAL EXECUTION    */ 00764000
         BAL   @14,TESTCOND                                        0699 00765000
*           IF RC=0 THEN            /* SHOULD WE EXECUTE             */ 00766000
         L     @10,RC                                              0700 00767000
         LTR   @10,@10                                             0700 00768000
         BNZ   @RF00700                                            0700 00769000
*             DO;                   /* YES                           */ 00770000
*               RPRF=AVTADBUF;      /* BUFFER ADDRESS                */ 00771000
         L     RPRF,AVTADBUF(,IEDQAPTR)                            0702 00772000
*               RHPRF1=ADDR(PRF1RH);/* RH ADDRESS                    */ 00773000
         LR    RHPRF1,IEDQPPTR                                     0703 00774000
         SL    RHPRF1,@CF00044                                     0703 00775000
*               IF RHPRF1->TRHDR1=OFF&RHPRF1->TRHDR2=OFF THEN/*    0704 00776000
*                                      REQUEST ASKING FOR NO RESPONSE*/ 00777000
         TM    TRHDR1(RHPRF1),B'10100000'                          0704 00778000
         BNZ   @RF00704                                            0704 00779000
*                 RC=CANTRESP;      /* YES, SET CAN'T RESPOND RET  0705 00780000
*                                      CODE                          */ 00781000
         MVC   RC(4),@CF01939                                      0705 00782000
*               ELSE                /* REQUEST ASKING FOR A RESPONSE */ 00783000
*                 DO;                                              0706 00784000
         B     @RC00704                                            0706 00785000
@RF00704 DS    0H                                                  0707 00786000
*                   IF RHPRF1->TRHRUCAT=TRHDFC THEN/* DATA FLOW    0707 00787000
*                                      CONTROL                       */ 00788000
         TM    TRHRUCAT(RHPRF1),B'01000000'                        0707 00789000
         BNO   @RF00707                                            0707 00790000
         TM    TRHRUCAT(RHPRF1),B'00100000'                        0707 00791000
         BNZ   @RF00707                                            0707 00792000
*                     CMDBYTE=LCBDFCMD;/* YES, SET UP DFC COMMAND  0708 00793000
*                                      BYTE                          */ 00794000
         MVC   CMDBYTE(1),LCBDFCMD(IEDQLPTR)                       0708 00795000
*                   ELSE            /* NOT DFC                       */ 00796000
*                     CMDBYTE=0;    /* SET COMMAND BYTE TO ZERO      */ 00797000
         B     @RC00707                                            0709 00798000
@RF00707 MVI   CMDBYTE,X'00'                                       0709 00799000
*/*                                                                  */ 00800000
*                                                                  0710 00801000
*                   CALL CKSNS;     /* VALIDATE SENSE                */ 00802000
@RC00707 BAL   @14,CKSNS                                           0710 00803000
*                   IF RC=0 THEN    /* SENSE O.K.                    */ 00804000
         L     @10,RC                                              0711 00805000
         LTR   @10,@10                                             0711 00806000
         BNZ   @RF00711                                            0711 00807000
*                     CALL SETRINFO;/* GENERATE RESPONSE INFORMATION */ 00808000
         BAL   @14,SETRINFO                                        0712 00809000
*                 END;                                             0713 00810000
*             END;                                                 0714 00811000
*         END;                                                     0715 00812000
*       ELSE                        /* RESPONSE ALREADY SENT OR    0716 00813000
*                                      GENERATED                     */ 00814000
*         RC=RESPSENT;              /* SET RETURN CODE FOR RESPONSE     00815000
*                                      ALREADY SENT                  */ 00816000
         B     @RC00696                                            0716 00817000
@RF00696 MVC   RC(4),@CF00174                                      0716 00818000
*     END;                                                         0717 00819000
*   ELSE                            /* NOT PLCB OR NOT SNA LU        */ 00820000
*     RC=NOTSNALU;                  /* SET RETURN CODE               */ 00821000
         B     @RC00694                                            0718 00822000
@RF00694 MVC   RC(4),@CF00075                                      0718 00823000
*/*                                                                  */ 00824000
*                                                                  0719 00825000
*   RETURN;                                                        0719 00826000
@EL00007 DS    0H                                                  0719 00827000
@EF00007 DS    0H                                                  0719 00828000
@ER00007 L     @14,@SA00007                                        0719 00829000
         BR    @14                                                 0719 00830000
*   END QUIENTRY;                                                  0720 00831000
         B     @EL00007                                            0720 00832000
*                                                                  0721 00833000
*/********************************************************************/ 00834000
*/*                                                                  */ 00835000
*/* THIS ROUTINE BUILDS A RSP PIU AND POSTS IT TO IEDDFOUT(DATA FLOW */ 00836000
*/* CONTROL OUTBOUND).                                               */ 00837000
*/*     INPUT-                                                       */ 00838000
*/*          EXCPRSP -  ON MEANS AN EXCEPTION RESPONSE IS TO BE BUILT*/ 00839000
*/*                     OFF MEANS A POSITIVE RESPONSE IS TO BE BUILT */ 00840000
*/*          LCB     -  ALL NECESSARY RESPONSE INFORMATION MUST BE   */ 00841000
*/*                     SET UP IN LCB                                */ 00842000
*/*          RPRF    -  MUST CONTAIN ADDRESS OF BUFFER UNIT INTO     */ 00843000
*/*                     WHICH RESPONSE WILL BE BUILT                 */ 00844000
*/*                                                                  */ 00845000
*/********************************************************************/ 00846000
*                                                                  0721 00847000
*SENDRESP:                                                         0721 00848000
*   PROC OPTIONS(SAVE(R14));                                       0721 00849000
SENDRESP ST    @14,@SA00008                                        0721 00850000
*   IEDPF2=''B;                     /* INIT PREFIX TO ZERO           */ 00851000
         LR    @10,IEDQPPTR                                        0722 00852000
         SL    @10,@CF00044                                        0722 00853000
         XC    IEDPF2(8,@10),IEDPF2(@10)                           0722 00854000
*   PRF2TNTI=ON;                    /* INDICATE OAF AND DAF ARE TNT     00855000
*                                      OFFSETS                       */ 00856000
         OI    PRF2TNTI(@10),B'10000000'                           0723 00857000
*   PRFPIUO=1;                      /* SET PIU OFFSET VALUE TO 1     */ 00858000
         LA    @10,1                                               0724 00859000
         STC   @10,PRFPIUO(,IEDQPPTR)                              0724 00860000
*   PIUPTR=ADDR(PRFPIUO)+PRFPIUO;   /* PIU ADDRESSABILITY            */ 00861000
         LA    PIUPTR,PRFPIUO(,IEDQPPTR)                           0725 00862000
         ALR   PIUPTR,@10                                          0725 00863000
*   IEDPIU=''B;                     /* INIT PIU TO ZERO              */ 00864000
         XC    IEDPIU(13,PIUPTR),IEDPIU(PIUPTR)                    0726 00865000
*   TTHFTYPE=TTHFID1;               /* FID1 TH TYPE                  */ 00866000
         NI    TTHFTYPE(PIUPTR),B'00011111'                        0727 00867000
         OI    TTHFTYPE(PIUPTR),B'00010000'                        0727 00868000
*   TTHBBIU=ON;                     /* BEGINNING OF BIU AND ...      */ 00869000
*   TTHEBIU=ON;                     /* END OF BIU                    */ 00870000
         OI    TTHBBIU(PIUPTR),B'00001100'                         0729 00871000
*   IF LCBEXPI=ON THEN              /* EXPIDITED FLOW                */ 00872000
         TM    LCBEXPI(IEDQLPTR),B'10000000'                       0730 00873000
         BNO   @RF00730                                            0730 00874000
*     TTHEFI=ON;                    /* YES, MARK TH EXPIDITED        */ 00875000
         OI    TTHEFI(PIUPTR),B'00000001'                          0731 00876000
*   TTHDAF=LCBTTCIN;                /* SET DESTINATION TNT OFFSET    */ 00877000
@RF00730 LH    @10,LCBTTCIN(,IEDQLPTR)                             0732 00878000
         N     @10,@CF02057                                        0732 00879000
         STCM  @10,3,TTHDAF(PIUPTR)                                0732 00880000
*/*                                                                  */ 00881000
*                                                                  0733 00882000
*   RPARM=LCBTTCIN;                 /* TNT OFFSET                    */ 00883000
         LR    RPARM,@10                                           0733 00884000
*   CALL IEDQTNT;                   /* GET DESTINATION'S TERMINAL  0734 00885000
*                                      ENTRY                         */ 00886000
         L     @15,AVTRNMPT(,IEDQAPTR)                             0734 00887000
         BALR  @14,@15                                             0734 00888000
*   RTRM=RPARM;                     /* TRM ADDRESSABILITY            */ 00889000
         LR    RTRM,RPARM                                          0735 00890000
*   IF RLCB=SAVTSLCB THEN           /* SSCP FLOW             @YM08151*/ 00891000
         L     @10,AVTSAVTP(,IEDQAPTR)                             0736 00892000
         C     RLCB,SAVTSLCB(,@10)                                 0736 00893000
         BNE   @RF00736                                            0736 00894000
*     TTHOAF=SAVTSCPT;              /* YES - SET OAF=SSCP    @YM08151*/ 00895000
         MVC   TTHOAF(2,PIUPTR),SAVTSCPT(@10)                      0737 00896000
*   ELSE                            /* NOT SSCP FLOW         @YM08151*/ 00897000
*     TTHOAF=SIBINDEX;              /* SET OAF TNT OFFSET FROM LU-LU    00898000
*                                      SIB                   @YM08151*/ 00899000
         B     @RC00736                                            0738 00900000
@RF00736 LR    @10,IEDQTPTR                                        0738 00901000
         AL    @10,@CF02058                                        0738 00902000
         SLR   @07,@07                                             0738 00903000
         ICM   @07,7,TRMSIBPT-7(@10)                               0738 00904000
         MVC   TTHOAF(2,PIUPTR),SIBINDEX(@07)                      0738 00905000
*/*                                                                  */ 00906000
*                                                                  0739 00907000
*   TTHSNF=LCBTHSQ;                 /* SET SEQUENCE NUMBER(OR EXP ID)*/ 00908000
@RC00736 MVC   TTHSNF(2,PIUPTR),LCBTHSQ(IEDQLPTR)                  0739 00909000
*   IEDRH=LCBRHSV;                  /* THE REQUEST RH WHICH WE ARE 0740 00910000
*                                      RESPONDING TO                 */ 00911000
         LA    @10,10                                              0740 00912000
         ALR   @10,PIUPTR                                          0740 00913000
         MVC   IEDRH(3,@10),LCBRHSV(IEDQLPTR)                      0740 00914000
*   TRHTYPE=ON;                     /* SET RESPONSE INDICATOR        */ 00915000
*   TRHBC=ON;                       /* BEGIN CHAIN AND ...           */ 00916000
*   TRHEC=ON;                       /* END CHAIN                     */ 00917000
         OI    TRHTYPE(@10),B'10000011'                            0743 00918000
*/*                                                                  */ 00919000
*                                                                  0744 00920000
*   CALL SETRUDCF;                  /* SET UP THE RU AND DATA COUNT     00921000
*                                      FIELD FOR BOTH POSITIVE AND 0744 00922000
*                                      EXCEPTION RESPONSES           */ 00923000
         BAL   @14,SETRUDCF                                        0744 00924000
*   IF TRHRUCAT=TRHDFC&             /* DATA FLOW CONTROL AND...      */ 00925000
*       LCBDFCMD=CD1RTR THEN        /* RTR COMMAND                   */ 00926000
         TM    TRHRUCAT+10(PIUPTR),B'01000000'                     0745 00927000
         BNO   @RF00745                                            0745 00928000
         TM    TRHRUCAT+10(PIUPTR),B'00100000'                     0745 00929000
         BNZ   @RF00745                                            0745 00930000
         CLI   LCBDFCMD(IEDQLPTR),X'05'                            0745 00931000
         BNE   @RF00745                                            0745 00932000
*     LCBRTRRO=OFF;                 /* RESET RESPONSE OWED TO RTR SO    00933000
*                                      SCHEDULERS WON'T TRY TO SEND     00934000
*                                      ONE                           */ 00935000
         NI    LCBRTRRO(IEDQLPTR),B'11111011'                      0746 00936000
*/*                                                                  */ 00937000
*                                                                  0747 00938000
*   PRFPRI=PRIOUTBD;                /* POST PRIORITY                 */ 00939000
@RF00745 MVI   PRFPRI(IEDQPPTR),X'E4'                              0747 00940000
*   PRFQCBA=SAVTDFCO;               /* IEDDFOUT'S QCB                */ 00941000
         L     @10,AVTSAVTP(,IEDQAPTR)                             0748 00942000
         MVC   PRFQCBA(3,IEDQPPTR),SAVTDFCO+1(@10)                 0748 00943000
*   RDISP=AVTEA;                    /* DISPATCHER ADDRESS            */ 00944000
         L     RDISP,AVTEA(,IEDQAPTR)                              0749 00945000
*   RPARM=RPRF;                     /* ADDR OF RESPONSE PIU BUFFER   */ 00946000
         LR    RPARM,RPRF                                          0750 00947000
*   CALL DSPPOSTR;                  /* POST RSP TO IEDDFOUT QCB      */ 00948000
         LA    @15,DSPPOSTR(,RDISP)                                0751 00949000
         BALR  @14,@15                                             0751 00950000
*   LCBRESP=OFF;                    /* INDICATE RESPONSE IS NO LONGER   00951000
*                                      NEEDED FOR THIS CHAIN         */ 00952000
         NI    LCBRESP(IEDQLPTR),B'11111110'                       0752 00953000
*   RETURN;                                                        0753 00954000
@EL00008 DS    0H                                                  0753 00955000
@EF00008 DS    0H                                                  0753 00956000
@ER00008 L     @14,@SA00008                                        0753 00957000
         BR    @14                                                 0753 00958000
*   END SENDRESP;                                                  0754 00959000
*                                                                  0755 00960000
*/********************************************************************/ 00961000
*/*                                                                  */ 00962000
*/* THIS ROUTINE SETS UP THE RU AND THE DATA COUNT FIELD FOR         */ 00963000
*/* RESPONSES.                                                       */ 00964000
*/*                                                                  */ 00965000
*/********************************************************************/ 00966000
*                                                                  0755 00967000
*SETRUDCF:                                                         0755 00968000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0755 00969000
SETRUDCF DS    0H                                                  0756 00970000
*   IF EXCPRSP=ON THEN              /* SHOULD EXCEPTION RESPONSE BE     00971000
*                                      BUILT                         */ 00972000
         TM    EXCPRSP,B'10000000'                                 0756 00973000
         BNO   @RF00756                                            0756 00974000
*     DO;                           /* YES                           */ 00975000
*       TRHSDI=ON;                  /* SET SENSE DATA INCLUDED       */ 00976000
         LA    @10,10                                              0758 00977000
         LR    @07,PIUPTR                                          0758 00978000
         ALR   @07,@10                                             0758 00979000
         OI    TRHSDI(@07),B'00000100'                             0758 00980000
*       TRHER=ON;                   /* SET ERROR INDICATOR           */ 00981000
         OI    TRHER(@07),B'00010000'                              0759 00982000
*       RU(1:4)=LCBLUSNS;           /* MOVE IN SENSE BYTES           */ 00983000
         LA    @05,13                                              0760 00984000
         ALR   @05,PIUPTR                                          0760 00985000
         MVC   RU(4,@05),LCBLUSNS(IEDQLPTR)                        0760 00986000
*       IF RLCB=SAVTSLCB THEN       /* SSCP FLOW                     */ 00987000
         L     @10,AVTSAVTP(,IEDQAPTR)                             0761 00988000
         C     RLCB,SAVTSLCB(,@10)                                 0761 00989000
         BNE   @RF00761                                            0761 00990000
*         DO;                       /* YES                           */ 00991000
*           IF TRHRUCAT=TRHFMD THEN /* FM DATA                       */ 00992000
         TM    TRHRUCAT(@07),B'01100000'                           0763 00993000
         BNZ   @RF00763                                            0763 00994000
*             DO;                   /* YES                           */ 00995000
*               IF TRHFI=ON THEN    /* FORMATTED                     */ 00996000
         TM    TRHFI(@07),B'00001000'                              0765 00997000
         BNO   @RF00765                                            0765 00998000
*                 DO;               /* YES                           */ 00999000
*                   RU(5:7)=LCBSCPRS;/* MOVE 3 BYTE COMMAND INTO RU  */ 01000000
         MVC   RU+4(3,@05),LCBSCPRS(IEDQLPTR)                      0767 01001000
*                   TTHDCF=10;      /* SET DATA COUNT                */ 01002000
         LA    @10,10                                              0768 01003000
         STCM  @10,3,TTHDCF(PIUPTR)                                0768 01004000
*                 END;                                             0769 01005000
*               ELSE                /* NOT FORMATTED                 */ 01006000
*                 TTHDCF=7;         /* SET DATA COUNT                */ 01007000
         B     @RC00765                                            0770 01008000
@RF00765 MVC   TTHDCF(2,PIUPTR),@CH00581                           0770 01009000
*             END;                                                 0771 01010000
*           ELSE                    /* NOT FM DATA                   */ 01011000
*             DO;                                                  0772 01012000
         B     @RC00763                                            0772 01013000
@RF00763 DS    0H                                                  0773 01014000
*               RU(5)=LCBDFCMD;     /* MOVE 1 BYTE COMMAND INTO RU   */ 01015000
         MVC   RU+17(1,PIUPTR),LCBDFCMD(IEDQLPTR)                  0773 01016000
*               TTHDCF=8;           /* SET DATA COUNT                */ 01017000
         MVC   TTHDCF(2,PIUPTR),@CH00044                           0774 01018000
*             END;                                                 0775 01019000
*         END;                                                     0776 01020000
*       ELSE                        /* NOT SSCP FLOW                 */ 01021000
*         DO;                                                      0777 01022000
         B     @RC00761                                            0777 01023000
@RF00761 DS    0H                                                  0778 01024000
*           IF TRHRUCAT=TRHFMD THEN /* FM DATA                       */ 01025000
         TM    TRHRUCAT+10(PIUPTR),B'01100000'                     0778 01026000
         BNZ   @RF00778                                            0778 01027000
*             TTHDCF=7;             /* SET DATA COUNT                */ 01028000
         MVC   TTHDCF(2,PIUPTR),@CH00581                           0779 01029000
*           ELSE                    /* NOT FM DATA                   */ 01030000
*             DO;                                                  0780 01031000
         B     @RC00778                                            0780 01032000
@RF00778 DS    0H                                                  0781 01033000
*               RU(5)=LCBDFCMD;     /* MOVE 1 BYTE COMMAND INTO RU   */ 01034000
         MVC   RU+17(1,PIUPTR),LCBDFCMD(IEDQLPTR)                  0781 01035000
*               TTHDCF=8;           /* SET DATA COUNT FIELD          */ 01036000
         MVC   TTHDCF(2,PIUPTR),@CH00044                           0782 01037000
*             END;                                                 0783 01038000
*         END;                                                     0784 01039000
*     END;                                                         0785 01040000
*   ELSE                            /* POSITIVE RESPONSE             */ 01041000
*     DO;                                                          0786 01042000
         B     @RC00756                                            0786 01043000
@RF00756 DS    0H                                                  0787 01044000
*       TRHSDI=OFF;                 /* SENSE INCLUDED OFF            */ 01045000
         LA    @10,10                                              0787 01046000
         ALR   @10,PIUPTR                                          0787 01047000
         NI    TRHSDI(@10),B'11111011'                             0787 01048000
*       TRHER=OFF;                  /* ERROR OFF                     */ 01049000
         NI    TRHER(@10),B'11101111'                              0788 01050000
*       IF RLCB=SAVTSLCB THEN       /* SSCP FLOW                     */ 01051000
         L     @07,AVTSAVTP(,IEDQAPTR)                             0789 01052000
         C     RLCB,SAVTSLCB(,@07)                                 0789 01053000
         BNE   @RF00789                                            0789 01054000
*         DO;                       /* YES                           */ 01055000
*           IF TRHRUCAT=TRHFMD THEN /* FM DATA                       */ 01056000
         TM    TRHRUCAT(@10),B'01100000'                           0791 01057000
         BNZ   @RF00791                                            0791 01058000
*             DO;                   /* YES                           */ 01059000
*               IF TRHFI=ON THEN    /* FORMATTED                     */ 01060000
         TM    TRHFI(@10),B'00001000'                              0793 01061000
         BNO   @RF00793                                            0793 01062000
*                 DO;               /* YES                           */ 01063000
*                   RU(1:3)=LCBSCPRS;/* MOVE 3 BYTE COMMAND INTO RU  */ 01064000
         MVC   RU+13(3,PIUPTR),LCBSCPRS(IEDQLPTR)                  0795 01065000
*                   TTHDCF=6;       /* SET DATA COUNT                */ 01066000
         MVC   TTHDCF(2,PIUPTR),@CH00058                           0796 01067000
*                 END;                                             0797 01068000
*               ELSE                /* NOT FORMATTED                 */ 01069000
*                 TTHDCF=3;         /* SET DATA COUNT                */ 01070000
         B     @RC00793                                            0798 01071000
@RF00793 MVC   TTHDCF(2,PIUPTR),@CH00073                           0798 01072000
*             END;                                                 0799 01073000
*           ELSE                    /* NOT FM DATA                   */ 01074000
*             DO;                                                  0800 01075000
         B     @RC00791                                            0800 01076000
@RF00791 DS    0H                                                  0801 01077000
*               RU(1)=LCBDFCMD;     /* MOVE 1 BYTE COMMAND INTO RU   */ 01078000
         MVC   RU+13(1,PIUPTR),LCBDFCMD(IEDQLPTR)                  0801 01079000
*               TTHDCF=4;           /* SET DATA COUNT                */ 01080000
         MVC   TTHDCF(2,PIUPTR),@CH00255                           0802 01081000
*             END;                                                 0803 01082000
*         END;                                                     0804 01083000
*       ELSE                        /* NOT SSCP FLOW                 */ 01084000
*         DO;                                                      0805 01085000
         B     @RC00789                                            0805 01086000
@RF00789 DS    0H                                                  0806 01087000
*           IF TRHRUCAT=TRHFMD THEN /* FM DATA                       */ 01088000
         TM    TRHRUCAT+10(PIUPTR),B'01100000'                     0806 01089000
         BNZ   @RF00806                                            0806 01090000
*             TTHDCF=3;             /* SET DATA COUNT                */ 01091000
         MVC   TTHDCF(2,PIUPTR),@CH00073                           0807 01092000
*           ELSE                    /* NOT FM DATA                   */ 01093000
*             DO;                                                  0808 01094000
         B     @RC00806                                            0808 01095000
@RF00806 DS    0H                                                  0809 01096000
*               RU(1)=LCBDFCMD;     /* MOVE 1 BYTE COMMAND INTO RU   */ 01097000
         MVC   RU+13(1,PIUPTR),LCBDFCMD(IEDQLPTR)                  0809 01098000
*               TTHDCF=4;           /* SET DATA COUNT                */ 01099000
         MVC   TTHDCF(2,PIUPTR),@CH00255                           0810 01100000
*             END;                                                 0811 01101000
*         END;                                                     0812 01102000
*     END;                                                         0813 01103000
*   RETURN;                                                        0814 01104000
@EL00009 DS    0H                                                  0814 01105000
@EF00009 DS    0H                                                  0814 01106000
@ER00009 BR    @14                                                 0814 01107000
*   END SETRUDCF;                                                  0815 01108000
         B     @EL00009                                            0815 01109000
*                                                                  0816 01110000
*/********************************************************************/ 01111000
*/*                                                                  */ 01112000
*/* THIS ROUTINE SETS UP SOME INFORMATION FOR GENERATING A RESPONSE. */ 01113000
*/*                                                                  */ 01114000
*/********************************************************************/ 01115000
*                                                                  0816 01116000
*SETRINFO:                                                         0816 01117000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0816 01118000
SETRINFO DS    0H                                                  0817 01119000
*   LCBRHSV=PRF1RH;                 /* SAVE RH OF REQUEST WHICH IS TO   01120000
*                                      BE RESPONDED TO               */ 01121000
         LR    @10,IEDQPPTR                                        0817 01122000
         SL    @10,@CF00044                                        0817 01123000
         MVC   LCBRHSV(3,IEDQLPTR),PRF1RH(@10)                     0817 01124000
*   LCBRSRH=ON;                     /* SET FLAG WHICH SAYS RESPONSE     01125000
*                                      IS GENERATED                  */ 01126000
         OI    LCBRSRH(IEDQLPTR),B'01000000'                       0818 01127000
*   LCBTHSQ=PRF1SQID;               /* SAVE SEQUENCE # OF REQUEST  0819 01128000
*                                      WHICH IS BEING RESPONDED TO   */ 01129000
         LH    @07,PRF1SQID(,@10)                                  0819 01130000
         N     @07,@CF02057                                        0819 01131000
         STH   @07,LCBTHSQ(,IEDQLPTR)                              0819 01132000
*   IF PRF1EXPI=ON THEN             /* EXPIDITED                     */ 01133000
         TM    PRF1EXPI(@10),B'01000000'                           0820 01134000
         BNO   @RF00820                                            0820 01135000
*     LCBEXPI=ON;                   /* YES, SET EXP INDICATOR        */ 01136000
         OI    LCBEXPI(IEDQLPTR),B'10000000'                       0821 01137000
*   RETURN;                                                        0822 01138000
@EL00010 DS    0H                                                  0822 01139000
@EF00010 DS    0H                                                  0822 01140000
@ER00010 BR    @14                                                 0822 01141000
*   END SETRINFO;                                                  0823 01142000
         B     @EL00010                                            0823 01143000
*                                                                  0824 01144000
*/********************************************************************/ 01145000
*/*                                                                  */ 01146000
*/* THIS ROUTINE VALIDATES THE SENSE BYTES(IN LCBLUSNS).             */ 01147000
*/*    INPUT:                                                        */ 01148000
*/*         CMDBYTE - CONTAINS THE DATA FLOW CONTROL COMMAND OR 0(FOR*/ 01149000
*/*                   FM DATA)                                       */ 01150000
*/*         LCBLUSNS- CONTAINS THE 4 BYTES OF SNA SENSE              */ 01151000
*/*                                                                  */ 01152000
*/********************************************************************/ 01153000
*                                                                  0824 01154000
*SNSER:                                                            0824 01155000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                               0824 01156000
SNSER    DS    0H                                                  0825 01157000
*   IF CMDBYTE=CD1CANCL THEN        /* CANCEL COMMAND                */ 01158000
         CLI   CMDBYTE,X'83'                                       0825 01159000
         BNE   @RF00825                                            0825 01160000
*     RC=CANTRESP;                  /* SET 'NOT ALLOWED TO RESPOND'     01161000
*                                      CODE                          */ 01162000
         MVC   RC(4),@CF01939                                      0826 01163000
*   ELSE                            /* NOT CANCEL                    */ 01164000
*     DO;                                                          0827 01165000
         B     @RC00825                                            0827 01166000
@RF00825 DS    0H                                                  0828 01167000
*       SNSPTR=ADDR(LCBLUSNS);      /* ADDRESS OF SENSE              */ 01168000
         LA    SNSPTR,LCBLUSNS(,IEDQLPTR)                          0828 01169000
*       R2=ADDR(SNSCODES);          /* ADDR OF ALLOWABLE MAJOR SENSE    01170000
*                                      CODES                         */ 01171000
         LA    R2,SNSCODES                                         0829 01172000
*       FOUNDSW=OFF;                /* INIT FOUND SWITCH TO OFF      */ 01173000
         NI    FOUNDSW,B'10111111'                                 0830 01174000
*       DO WHILE(R2->BIT8='FF'X&   /* NOT END OF TABLE AND...       */ 01175000
*             FOUNDSW=OFF);         /* MAJOR SENSE CODE NOT FOUND YET*/ 01176000
         B     @DE00831                                            0831 01177000
@DL00831 DS    0H                                                  0832 01178000
*         IF R2->BIT8=SNSMAJ THEN   /* SENSE CODE FOUND IN TABLE     */ 01179000
         CLC   BIT8(1,R2),SNSMAJ(SNSPTR)                           0832 01180000
         BNE   @RF00832                                            0832 01181000
*           FOUNDSW=ON;             /* YES, SET FOUND SWITCH         */ 01182000
         OI    FOUNDSW,B'01000000'                                 0833 01183000
*         ELSE                      /* NOT FOUND                     */ 01184000
*           R2=R2+1;                /* INCREMENT TO NEXT TABLE ENTRY */ 01185000
         B     @RC00832                                            0834 01186000
@RF00832 AL    R2,@CF00060                                         0834 01187000
*       END;                                                       0835 01188000
*                                                                  0835 01189000
@RC00832 DS    0H                                                  0835 01190000
@DE00831 CLI   BIT8(R2),X'FF'                                      0835 01191000
         BE    @DC00831                                            0835 01192000
         TM    FOUNDSW,B'01000000'                                 0835 01193000
         BZ    @DL00831                                            0835 01194000
@DC00831 DS    0H                                                  0836 01195000
*/*                                                                  */ 01196000
*                                                                  0836 01197000
*       IF FOUNDSW=OFF THEN         /* MAJOR SENSE CODE FOUND IN   0836 01198000
*                                      TABLE                         */ 01199000
         TM    FOUNDSW,B'01000000'                                 0836 01200000
         BNZ   @RF00836                                            0836 01201000
*         RC=INVLRESP;              /* NO, SET 'INVALID SENSE' CODE  */ 01202000
         MVC   RC(4),@CF00244                                      0837 01203000
*     END;                                                         0838 01204000
*   RETURN;                                                        0839 01205000
@EL00011 DS    0H                                                  0839 01206000
@EF00011 DS    0H                                                  0839 01207000
@ER00011 BR    @14                                                 0839 01208000
*   END SNSER;                                                     0840 01209000
         B     @EL00011                                            0840 01210000
*                                                                  0841 01211000
*/********************************************************************/ 01212000
*/*                                                                  */ 01213000
*/* THIS ROUTINE TEST FOR CONDITIONAL EXECUTION.  THE 'COUNT='       */ 01214000
*/* OPERAND ON THE IEDRESP MACRO IS USED TO CONTROL EXECUTION.       */ 01215000
*/*                                                                  */ 01216000
*/********************************************************************/ 01217000
*                                                                  0841 01218000
*TESTCOND:                                                         0841 01219000
*   PROC OPTIONS(SAVE(R14));                                       0841 01220000
TESTCOND ST    @14,@SA00012                                        0841 01221000
*   RPARM=PARM;                     /* ADDR OF PARM LIST             */ 01222000
         L     RPARM,PARM                                          0842 01223000
*   IF PLMASKI=ON THEN              /* MASK PRESENT                  */ 01224000
         TM    PLMASKI(RPARM),B'00000001'                          0843 01225000
         BNO   @RF00843                                            0843 01226000
*     RPARM=RPARM-4;                /* NO, ADJUST PARM LIST PTR      */ 01227000
         SL    RPARM,@CF00255                                      0844 01228000
*   PARMFLAG=PLFLAGS;               /* GET FLAG BYTE                 */ 01229000
@RF00843 MVC   PARMFLAG(1),PLFLAGS(RPARM)                          0845 01230000
*   IF PLCOUNT=ON THEN              /* 'COUNT=' SPECIFIED            */ 01231000
         TM    PLCOUNT,B'10000000'                                 0846 01232000
         BNO   @RF00846                                            0846 01233000
*     DO;                           /* YES                           */ 01234000
*       R2=RPARM;                   /* SAVE PARMLIST POINTER         */ 01235000
         LR    R2,RPARM                                            0848 01236000
*       RPARM=LCBTTCIN;             /* TNT OFFSET                    */ 01237000
         LH    RPARM,LCBTTCIN(,IEDQLPTR)                           0849 01238000
         N     RPARM,@CF02057                                      0849 01239000
*       CALL IEDQTNT;               /* GET TERMINAL ENTRY            */ 01240000
         L     @15,AVTRNMPT(,IEDQAPTR)                             0850 01241000
         BALR  @14,@15                                             0850 01242000
*       RTRM=RPARM;                 /* SET TRM ADDRESSABILITY        */ 01243000
         LR    RTRM,RPARM                                          0851 01244000
*       RPARM=R2;                   /* RESTORE PARMLIST POINTER      */ 01245000
         LR    RPARM,R2                                            0852 01246000
*/*                                                                  */ 01247000
*                                                                  0853 01248000
*       STM(R0,RBASE,SAVEREGS);     /* SAVE REGS                     */ 01249000
         STM   R0,RBASE,SAVEREGS                                   0853 01250000
*       R2=ADDR(PLQBJPL);           /* IEDQBJ'S PARM LIST ADDR       */ 01251000
         LA    R2,PLQBJPL(,RPARM)                                  0854 01252000
*       R15=(AVTMSGS+PLQBJNDX)->PTR31;/* ADDRESS OF IEDQBJ           */ 01253000
         L     @10,AVTMSGS-1(,IEDQAPTR)                            0855 01254000
         LA    @10,0(,@10)                                         0855 01255000
         SLR   @07,@07                                             0855 01256000
         IC    @07,PLQBJNDX(,RPARM)                                0855 01257000
         ALR   @10,@07                                             0855 01258000
         L     R15,PTR31(,@10)                                     0855 01259000
*       RPARM=RTRM;                 /* TERMINAL ENTRY                */ 01260000
         LR    RPARM,RTRM                                          0856 01261000
*       GEN(BALR  R14,R15);         /* BALR TO IEDQBJ TO CHECK FOR 0857 01262000
*                                      CONDITIONAL EXECUTION         */ 01263000
         BALR  R14,R15                                                  01264000
*       RC=R15;                     /* SET RETURN CODE... POSSIBLE 0858 01265000
*                                      RETURN CODES ARE: 0-MEANS   0858 01266000
*                                      EXECUTE, 4-MEANS DO NOT     0858 01267000
*                                      EXECUTE, 8-MEANS OPTION FIELD    01268000
*                                      NOT FOUND                     */ 01269000
         ST    R15,RC                                              0858 01270000
*       LM(R0,RBASE,SAVEREGS);      /* RESTORE REGS                  */ 01271000
         LM    R0,RBASE,SAVEREGS                                   0859 01272000
*     END;                                                         0860 01273000
*   RETURN;                                                        0861 01274000
@EL00012 DS    0H                                                  0861 01275000
@EF00012 DS    0H                                                  0861 01276000
@ER00012 L     @14,@SA00012                                        0861 01277000
         BR    @14                                                 0861 01278000
*   END TESTCOND;                                                  0862 01279000
         B     @EL00012                                            0862 01280000
*   END IEDQRS                                                     0863 01281000
*                                                                  0863 01282000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01283000
*/*%INCLUDE SYSLIB  (TAVTD   )                                       */ 01284000
*/*%INCLUDE SYSLIB  (TCD1D   )                                       */ 01285000
*/*%INCLUDE SYSLIB  (TDISPD  )                                       */ 01286000
*/*%INCLUDE SYSLIB  (TLCBD   )                                       */ 01287000
*/*%INCLUDE SYSLIB  (TPIUD   )                                       */ 01288000
*/*%INCLUDE SYSLIB  (TPRFD   )                                       */ 01289000
*/*%INCLUDE SYSLIB  (TPRIOR  )                                       */ 01290000
*/*%INCLUDE SYSLIB  (TRHD    )                                       */ 01291000
*/*%INCLUDE SYSLIB  (TSCBD   )                                       */ 01292000
*/*%INCLUDE SYSLIB  (TSIBD   )                                       */ 01293000
*/*%INCLUDE SYSLIB  (TSNSD   )                                       */ 01294000
*/*%INCLUDE SYSLIB  (TTHD    )                                       */ 01295000
*/*%INCLUDE SYSLIB  (TTRMD   )                                       */ 01296000
*                                                                  0863 01297000
*       ;                                                          0863 01298000
@DATA    DS    0H                                                       01299000
@CH00073 DC    H'3'                                                     01300000
@CH00058 DC    H'6'                                                     01301000
@CH00581 DC    H'7'                                                     01302000
         DS    0F                                                       01303000
@SA00006 DS    1F                                                       01304000
@SA00007 DS    1F                                                       01305000
@SA00003 DS    1F                                                       01306000
@SA00008 DS    1F                                                       01307000
@SA00012 DS    1F                                                       01308000
         DS    0F                                                       01309000
@CF00060 DC    F'1'                                                     01310000
@CF00255 DC    F'4'                                                     01311000
@CH00255 EQU   @CF00255+2                                               01312000
@CF00044 DC    F'8'                                                     01313000
@CH00044 EQU   @CF00044+2                                               01314000
@CF00244 DC    F'12'                                                    01315000
@CF00174 DC    F'16'                                                    01316000
@CF01939 DC    F'20'                                                    01317000
@CF00075 DC    F'24'                                                    01318000
@CF02040 DC    F'76'                                                    01319000
@CF02058 DC    F'-7'                                                    01320000
@CF02057 DC    XL4'0000FFFF'                                            01321000
         DS    0D                                                       01322000
RC       DS    F                                                        01323000
PARM     DS    A                                                        01324000
SAVE13   DS    A                                                        01325000
@CB01934 DC    X'CB8000'                                                01326000
FLGBYTE1 DS    BL1                                                      01327000
         ORG   FLGBYTE1                                                 01328000
EXCPRSP  DS    BL1                                                      01329000
FOUNDSW  EQU   FLGBYTE1+0                                               01330000
@NM00182 EQU   FLGBYTE1+0                                               01331000
         ORG   FLGBYTE1+1                                               01332000
CMDBYTE  DS    CL1                                                      01333000
PARMFLAG DS    BL1                                                      01334000
         ORG   PARMFLAG                                                 01335000
PLCOUNT  DS    BL1                                                      01336000
@NM00183 EQU   PARMFLAG+0                                               01337000
PLSNSI   EQU   PARMFLAG+0                                               01338000
@NM00184 EQU   PARMFLAG+0                                               01339000
         ORG   PARMFLAG+1                                               01340000
QAEPL    DS    CL3                                                      01341000
         ORG   QAEPL                                                    01342000
@NM00185 DC    X'FF04'                                                  01343000
QAEOPNO  DS    CL1                                                      01344000
         ORG   QAEPL+3                                                  01345000
         DS    CL3                                                      01346000
SAVEREGS DS    CL72                                                     01347000
SNSCODES DS    CL6                                                      01348000
         ORG   SNSCODES                                                 01349000
@NM00186 DC    X'40'                                                    01350000
@NM00187 DC    X'20'                                                    01351000
@NM00188 DC    X'10'                                                    01352000
@NM00189 DC    X'08'                                                    01353000
@NM00190 DC    X'00'                                                    01354000
@NM00191 DC    X'FF'                                                    01355000
         ORG   SNSCODES+6                                               01356000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01357000
@01      EQU   01                                                       01358000
@02      EQU   02                                                       01359000
@03      EQU   03                                                       01360000
@04      EQU   04                                                       01361000
@05      EQU   05                                                       01362000
@06      EQU   06                                                       01363000
@07      EQU   07                                                       01364000
@08      EQU   08                                                       01365000
@09      EQU   09                                                       01366000
@10      EQU   10                                                       01367000
@11      EQU   11                                                       01368000
@12      EQU   12                                                       01369000
@13      EQU   13                                                       01370000
@14      EQU   14                                                       01371000
@15      EQU   15                                                       01372000
RHPRF1   EQU   @03                                                      01373000
RHLCB    EQU   @03                                                      01374000
PIUPTR   EQU   @03                                                      01375000
SNSPTR   EQU   @03                                                      01376000
IEDQAPTR EQU   @13                                                      01377000
RDISP    EQU   @11                                                      01378000
IEDQLPTR EQU   @04                                                      01379000
LCBXPTR  EQU   @05                                                      01380000
IEDQPPTR EQU   @06                                                      01381000
IEDQTPTR EQU   @08                                                      01382000
R0       EQU   @00                                                      01383000
RPARM    EQU   @01                                                      01384000
R2       EQU   @02                                                      01385000
RLCB     EQU   @04                                                      01386000
RPRF     EQU   @06                                                      01387000
R8       EQU   @08                                                      01388000
RTRM     EQU   @08                                                      01389000
R9       EQU   @09                                                      01390000
RBASE    EQU   @12                                                      01391000
R13      EQU   @13                                                      01392000
R14      EQU   @14                                                      01393000
R15      EQU   @15                                                      01394000
R10      EQU   @10                                                      01395000
R3       EQU   @03                                                      01396000
R5       EQU   @05                                                      01397000
R7       EQU   @07                                                      01398000
IEDQAVTD EQU   0                                                        01399000
AVTSAVE4 EQU   IEDQAVTD+144                                             01400000
AVTSAVEX EQU   IEDQAVTD+216                                             01401000
AVTREADD EQU   IEDQAVTD+308                                             01402000
AVTBUFSW EQU   IEDQAVTD+312                                             01403000
@NM00004 EQU   IEDQAVTD+316                                             01404000
AVTCKFLG EQU   @NM00004                                                 01405000
AVTBASE  EQU   IEDQAVTD+340                                             01406000
AVTPKF   EQU   AVTBASE                                                  01407000
AVTRNMPT EQU   IEDQAVTD+352                                             01408000
AVTOSECB EQU   IEDQAVTD+420                                             01409000
AVTECB1  EQU   AVTOSECB                                                 01410000
AVTUI    EQU   IEDQAVTD+448                                             01411000
AVTHG02  EQU   IEDQAVTD+456                                             01412000
AVTEA    EQU   IEDQAVTD+476                                             01413000
AVTDISP  EQU   IEDQAVTD+480                                             01414000
AVTHD    EQU   IEDQAVTD+484                                             01415000
AVTSCOPT EQU   AVTHD                                                    01416000
AVTSAVTP EQU   IEDQAVTD+540                                             01417000
AVTSAVTF EQU   AVTSAVTP                                                 01418000
AVTCKPEL EQU   IEDQAVTD+580                                             01419000
AVTCKRMV EQU   AVTCKPEL                                                 01420000
AVTCKELF EQU   IEDQAVTD+608                                             01421000
AVTCKBYT EQU   IEDQAVTD+619                                             01422000
AVTHG01  EQU   IEDQAVTD+620                                             01423000
AVTCKLNK EQU   IEDQAVTD+624                                             01424000
AVTCRELE EQU   IEDQAVTD+636                                             01425000
AVTCCELE EQU   AVTCRELE                                                 01426000
AVTCLRHI EQU   IEDQAVTD+644                                             01427000
AVTADBUF EQU   IEDQAVTD+648                                             01428000
AVTSYSER EQU   IEDQAVTD+656                                             01429000
AVTMSGS  EQU   IEDQAVTD+657                                             01430000
AVTBFREB EQU   IEDQAVTD+708                                             01431000
AVTBFRFG EQU   IEDQAVTD+712                                             01432000
AVTCKPQB EQU   IEDQAVTD+732                                             01433000
AVTCKPTB EQU   AVTCKPQB                                                 01434000
AVTCKPEC EQU   AVTCKPQB+4                                               01435000
AVTCKPCC EQU   AVTCKPEC                                                 01436000
AVTOPCQB EQU   IEDQAVTD+744                                             01437000
AVTOPCOB EQU   AVTOPCQB                                                 01438000
AVTOPCEC EQU   AVTOPCQB+4                                               01439000
AVTOPCCC EQU   AVTOPCEC                                                 01440000
AVTOLTQB EQU   IEDQAVTD+756                                             01441000
AVTCWFL1 EQU   IEDQAVTD+852                                             01442000
AVTCWFL2 EQU   IEDQAVTD+853                                             01443000
AVTSUBT  EQU   IEDQAVTD+876                                             01444000
AVTIOTR  EQU   IEDQAVTD+877                                             01445000
AVTBIT1  EQU   IEDQAVTD+978                                             01446000
AVTBIT2  EQU   IEDQAVTD+979                                             01447000
AVTBIT3  EQU   IEDQAVTD+980                                             01448000
AVTSTEAL EQU   IEDQAVTD+988                                             01449000
AVTBIT4  EQU   IEDQAVTD+1064                                            01450000
@NM00086 EQU   IEDQAVTD+1160                                            01451000
IEDNSVTD EQU   0                                                        01452000
SAVTDIAG EQU   IEDNSVTD                                                 01453000
SAVTDIAF EQU   SAVTDIAG                                                 01454000
SAVTLUSQ EQU   IEDNSVTD+88                                              01455000
SAVTSLCB EQU   IEDNSVTD+104                                             01456000
SAVTDFCO EQU   IEDNSVTD+200                                             01457000
SAVTTCPU EQU   IEDNSVTD+238                                             01458000
SAVTSCPT EQU   SAVTTCPU                                                 01459000
SAVTZELM EQU   IEDNSVTD+270                                             01460000
SAVTRDRV EQU   IEDNSVTD+284                                             01461000
SAVTCKQB EQU   IEDNSVTD+300                                             01462000
SAVTCKTB EQU   SAVTCKQB                                                 01463000
SAVTCKEC EQU   SAVTCKQB+4                                               01464000
SAVTCKCC EQU   SAVTCKEC                                                 01465000
IEDQDISP EQU   0                                                        01466000
DSPCHAIN EQU   12                                                       01467000
DSPPOSTR EQU   28                                                       01468000
IEDQLCB  EQU   0                                                        01469000
LCBRCB   EQU   IEDQLCB                                                  01470000
LCBQCBA  EQU   LCBRCB+1                                                 01471000
LCBLINK  EQU   LCBRCB+5                                                 01472000
LCBTSOB  EQU   IEDQLCB+19                                               01473000
LCBCHAIN EQU   IEDQLCB+20                                               01474000
LCBSCRNN EQU   LCBCHAIN                                                 01475000
LCBTETEN EQU   LCBCHAIN                                                 01476000
LCBINSRC EQU   IEDQLCB+21                                               01477000
LCBLKMDE EQU   LCBINSRC+2                                               01478000
LCBNTXT  EQU   IEDQLCB+24                                               01479000
LCBSTAT4 EQU   LCBNTXT                                                  01480000
LCBPHASE EQU   LCBSTAT4                                                 01481000
LCBSCBDA EQU   IEDQLCB+25                                               01482000
LCBMHA   EQU   IEDQLCB+29                                               01483000
LCBFLAG1 EQU   IEDQLCB+32                                               01484000
LCBIOBSN EQU   IEDQLCB+33                                               01485000
LCBSNS   EQU   LCBIOBSN+1                                               01486000
LCBSENS0 EQU   LCBSNS                                                   01487000
LCBLOSDT EQU   LCBSENS0                                                 01488000
LCBTMOUT EQU   LCBSENS0                                                 01489000
LCBFLAG3 EQU   LCBIOBSN+7                                               01490000
LCBCSW   EQU   LCBIOBSN+8                                               01491000
LCBCSWST EQU   LCBCSW+3                                                 01492000
LCBCSWUS EQU   LCBCSWST                                                 01493000
LCBCSWCS EQU   LCBCSWST+1                                               01494000
LCBSIOCC EQU   LCBIOBSN+15                                              01495000
LCBDCBPT EQU   IEDQLCB+52                                               01496000
LCBRCQCB EQU   IEDQLCB+56                                               01497000
LCBRESTR EQU   LCBRCQCB                                                 01498000
LCBTHSQ  EQU   IEDQLCB+60                                               01499000
LCBINCAM EQU   LCBTHSQ                                                  01500000
LCBERRCT EQU   IEDQLCB+62                                               01501000
LCBLSPCI EQU   IEDQLCB+65                                               01502000
LCBRCBFR EQU   LCBLSPCI                                                 01503000
LCBSTATE EQU   IEDQLCB+70                                               01504000
LCBSTAT1 EQU   LCBSTATE                                                 01505000
LCBSTAT2 EQU   LCBSTATE+1                                               01506000
LCBBEOTN EQU   LCBSTAT2                                                 01507000
LCBSYNC  EQU   LCBSTAT2                                                 01508000
LCBDIAL  EQU   LCBSTAT2                                                 01509000
LCBRESP  EQU   LCBSTAT2                                                 01510000
LCBTSTSW EQU   IEDQLCB+72                                               01511000
LCBERB   EQU   IEDQLCB+76                                               01512000
LCBERBQB EQU   LCBERB+1                                                 01513000
LCBERBPY EQU   IEDQLCB+80                                               01514000
LCBERBLK EQU   IEDQLCB+81                                               01515000
LCBERBST EQU   IEDQLCB+84                                               01516000
LCBPRCPG EQU   LCBERBST                                                 01517000
LCBDLNKN EQU   LCBERBST                                                 01518000
LCBERBCH EQU   IEDQLCB+85                                               01519000
LCBERBCT EQU   IEDQLCB+88                                               01520000
LCBRBCT1 EQU   LCBERBCT                                                 01521000
LCBRBCT2 EQU   LCBERBCT+1                                               01522000
LCBTTCIN EQU   IEDQLCB+90                                               01523000
LCBMSGFM EQU   IEDQLCB+92                                               01524000
LCBSCBA  EQU   IEDQLCB+93                                               01525000
LCBOBRCH EQU   IEDQLCB+96                                               01526000
LCBINVPT EQU   LCBOBRCH+1                                               01527000
LCBBFRW  EQU   LCBINVPT                                                 01528000
LCBTPCD  EQU   IEDQLCB+100                                              01529000
LCBSTAT5 EQU   LCBTPCD                                                  01530000
LCBLUNIT EQU   LCBSTAT5                                                 01531000
LCBSTAT6 EQU   LCBTPCD+4                                                01532000
LCBRTRRO EQU   LCBSTAT6                                                 01533000
LCBRSPSV EQU   LCBTPCD+8                                                01534000
LCBSAVSN EQU   IEDQLCB+112                                              01535000
LCBERCCW EQU   IEDQLCB+120                                              01536000
LCBCPA   EQU   IEDQLCB+144                                              01537000
LCBCCW5  EQU   LCBCPA+32                                                01538000
LCBATTEL EQU   LCBCCW5                                                  01539000
LCBQEBPL EQU   LCBATTEL                                                 01540000
IEDQLCBX EQU   0                                                        01541000
LCBXCON  EQU   IEDQLCBX                                                 01542000
LCBXFLAG EQU   LCBXCON                                                  01543000
LCBXDCT  EQU   LCBXCON+1                                                01544000
LCBXRADR EQU   LCBXCON+4                                                01545000
IEDPIU   EQU   0                                                        01546000
PIUTH    EQU   IEDPIU                                                   01547000
PIURH    EQU   IEDPIU+10                                                01548000
PIURU    EQU   IEDPIU+13                                                01549000
IEDQPRF  EQU   0                                                        01550000
PRFRCB   EQU   IEDQPRF                                                  01551000
PRFKEY   EQU   PRFRCB                                                   01552000
PRFQCBA  EQU   PRFRCB+1                                                 01553000
PRFPRI   EQU   PRFRCB+4                                                 01554000
PRFLINK  EQU   PRFRCB+5                                                 01555000
PRFTIC   EQU   IEDQPRF+8                                                01556000
PRFTICC  EQU   PRFTIC                                                   01557000
PRFNBUNT EQU   IEDQPRF+12                                               01558000
PRFSUNIT EQU   PRFNBUNT                                                 01559000
PRFPLQCB EQU   PRFSUNIT                                                 01560000
PRFPIUO  EQU   PRFPLQCB                                                 01561000
@NM00153 EQU   IEDQPRF+16                                               01562000
PRFSVFFO EQU   @NM00153                                                 01563000
PRFSTAT1 EQU   IEDQPRF+20                                               01564000
PRFEOFN  EQU   PRFSTAT1                                                 01565000
PRFCORE  EQU   IEDQPRF+21                                               01566000
PRFXTRA  EQU   PRFCORE                                                  01567000
PRFSCAN  EQU   IEDQPRF+24                                               01568000
PRFTQBCK EQU   IEDQPRF+26                                               01569000
PRFNTXT  EQU   PRFTQBCK                                                 01570000
PRFEOBOF EQU   PRFNTXT                                                  01571000
PRFCHDR  EQU   IEDQPRF+32                                               01572000
PRFHQBCK EQU   IEDQPRF+35                                               01573000
IEDPF1   EQU   0                                                        01574000
PRF1RH   EQU   IEDPF1                                                   01575000
PRF1FLG1 EQU   IEDPF1+3                                                 01576000
PRF1EXPI EQU   PRF1FLG1                                                 01577000
PRF1WD2  EQU   IEDPF1+4                                                 01578000
PRF1SEQP EQU   PRF1WD2                                                  01579000
PRF1SQID EQU   PRF1SEQP                                                 01580000
PRF1TAG1 EQU   PRF1SQID                                                 01581000
IEDPF2   EQU   0                                                        01582000
PRF2FLG2 EQU   IEDPF2                                                   01583000
PRF2TNTI EQU   PRF2FLG2                                                 01584000
PRF2WD2  EQU   IEDPF2+4                                                 01585000
IEDRH    EQU   0                                                        01586000
TRHBYTE0 EQU   IEDRH                                                    01587000
TRHTYPE  EQU   TRHBYTE0                                                 01588000
TRHRUCAT EQU   TRHBYTE0                                                 01589000
TRHFI    EQU   TRHBYTE0                                                 01590000
TRHSDI   EQU   TRHBYTE0                                                 01591000
TRHBC    EQU   TRHBYTE0                                                 01592000
TRHEC    EQU   TRHBYTE0                                                 01593000
TRHBYTE1 EQU   IEDRH+1                                                  01594000
TRHDR1   EQU   TRHBYTE1                                                 01595000
TRHDR2   EQU   TRHBYTE1                                                 01596000
TRHER    EQU   TRHBYTE1                                                 01597000
TRHBYTE2 EQU   IEDRH+2                                                  01598000
IEDQSCB  EQU   0                                                        01599000
SCBSTATE EQU   IEDQSCB                                                  01600000
SCBSEQIN EQU   SCBSTATE                                                 01601000
SCBRCVCT EQU   IEDQSCB+4                                                01602000
SCBMBHEN EQU   IEDQSCB+5                                                01603000
SCBBKFCT EQU   IEDQSCB+9                                                01604000
SCBEOBSZ EQU   SCBBKFCT+1                                               01605000
SCBSALEV EQU   IEDQSCB+12                                               01606000
SCBQTYPE EQU   SCBSALEV                                                 01607000
SCBERRST EQU   IEDQSCB+16                                               01608000
SCBERR1  EQU   SCBERRST                                                 01609000
SCBHDRRN EQU   SCBERR1                                                  01610000
SCBORIGN EQU   SCBERR1                                                  01611000
SCBNOTRM EQU   SCBERR1                                                  01612000
SCBSEQHN EQU   SCBERR1                                                  01613000
SCBSEQLN EQU   SCBERR1                                                  01614000
SCBCUTFN EQU   SCBERR1                                                  01615000
SCBERR2  EQU   SCBERRST+1                                               01616000
SCBABRTN EQU   SCBERR2                                                  01617000
SCBERR3  EQU   SCBERRST+2                                               01618000
SCBLOSTN EQU   SCBERR3                                                  01619000
SCBTMIDN EQU   SCBERR3                                                  01620000
SCBFORMN EQU   SCBERR3                                                  01621000
SCBATTN  EQU   SCBERR3                                                  01622000
SCBXCEPN EQU   SCBERR3                                                  01623000
SCBERR4  EQU   SCBERRST+3                                               01624000
SCBTXTTN EQU   SCBERR4                                                  01625000
SCBCTLUN EQU   SCBERR4                                                  01626000
SCBCHANN EQU   SCBERR4                                                  01627000
SCBDLPTR EQU   IEDQSCB+22                                               01628000
SCBEOBAC EQU   SCBDLPTR                                                 01629000
SCBCTBAC EQU   SCBEOBAC                                                 01630000
SCBBSCFM EQU   IEDQSCB+24                                               01631000
SCBDATEN EQU   SCBBSCFM                                                 01632000
SCBITBSZ EQU   IEDQSCB+40                                               01633000
SCBCTBSV EQU   SCBITBSZ                                                 01634000
SCBDNSEG EQU   IEDQSCB+41                                               01635000
SCBCLSEG EQU   IEDQSCB+45                                               01636000
SCBITBAC EQU   IEDQSCB+48                                               01637000
SCBCTBFL EQU   SCBITBAC                                                 01638000
SCBBLKCT EQU   SCBCTBFL                                                 01639000
SCBDCSEG EQU   IEDQSCB+49                                               01640000
SCBSTAT1 EQU   IEDQSCB+60                                               01641000
SCBCORE  EQU   IEDQSCB+61                                               01642000
SCBSCAN  EQU   IEDQSCB+64                                               01643000
SCBNTXT  EQU   IEDQSCB+66                                               01644000
SCBCHDR  EQU   IEDQSCB+72                                               01645000
SCBCCSEG EQU   IEDQSCB+75                                               01646000
SCBEND   EQU   IEDQSCB+84                                               01647000
IEDSIBD  EQU   0                                                        01648000
SIBINDEX EQU   IEDSIBD+8                                                01649000
SIBSESSN EQU   IEDSIBD+10                                               01650000
SIBPACIN EQU   IEDSIBD+11                                               01651000
SIBSEQN  EQU   IEDSIBD+12                                               01652000
SIBSTAT1 EQU   IEDSIBD+16                                               01653000
SIBSTAT2 EQU   IEDSIBD+17                                               01654000
SIBBIND  EQU   IEDSIBD+20                                               01655000
SIBBIND1 EQU   SIBBIND                                                  01656000
SIBBIND2 EQU   SIBBIND+1                                                01657000
SIBBIND3 EQU   SIBBIND+2                                                01658000
SIBSTAT0 EQU   IEDSIBD+23                                               01659000
IEDSNSD  EQU   0                                                        01660000
SNSSYSTM EQU   IEDSNSD                                                  01661000
SNSMAJ   EQU   SNSSYSTM                                                 01662000
SNSUSER  EQU   IEDSNSD+2                                                01663000
IEDTH    EQU   0                                                        01664000
TTHBYTE0 EQU   IEDTH                                                    01665000
TTHFTYPE EQU   TTHBYTE0                                                 01666000
TTHBBIU  EQU   TTHBYTE0                                                 01667000
TTHEBIU  EQU   TTHBYTE0                                                 01668000
TTHEFI   EQU   TTHBYTE0                                                 01669000
TTHDAF   EQU   IEDTH+2                                                  01670000
TTHOAF   EQU   IEDTH+4                                                  01671000
TTHSNF   EQU   IEDTH+6                                                  01672000
TTHTAG   EQU   TTHSNF                                                   01673000
TTHTAG1  EQU   TTHTAG                                                   01674000
TTHDCF   EQU   IEDTH+8                                                  01675000
IEDQTRM  EQU   0                                                        01676000
TRMSTATE EQU   IEDQTRM                                                  01677000
TRMLOG   EQU   TRMSTATE                                                 01678000
TRMINSEQ EQU   IEDQTRM+4                                                01679000
TLISTCNT EQU   TRMINSEQ                                                 01680000
TRMOUTSQ EQU   IEDQTRM+6                                                01681000
TLISTEN  EQU   TRMOUTSQ                                                 01682000
TRMDSORG EQU   TLISTEN                                                  01683000
TRMALTD  EQU   IEDQTRM+8                                                01684000
TRMDEVFL EQU   IEDQTRM+10                                               01685000
TRMSTAT  EQU   IEDQTRM+12                                               01686000
IEDNTRM  EQU   0                                                        01687000
TRMBYTE4 EQU   IEDNTRM                                                  01688000
TRMBYTE3 EQU   IEDNTRM+1                                                01689000
TRMBYTE2 EQU   IEDNTRM+2                                                01690000
TRMINPG  EQU   TRMBYTE2                                                 01691000
TRMBYTE1 EQU   IEDNTRM+3                                                01692000
TRMSCPRQ EQU   TRMBYTE1                                                 01693000
TRMBYTE0 EQU   IEDNTRM+6                                                01694000
TRMSIBPT EQU   IEDNTRM+7                                                01695000
IEDQTNT  EQU   0                                                        01696000
IEDQGA02 EQU   0                                                        01697000
IEDQBD   EQU   0                                                        01698000
RU       EQU   0                                                        01699000
PL       EQU   0                                                        01700000
PLINDEX1 EQU   PL                                                       01701000
PLMASKI  EQU   PLINDEX1                                                 01702000
PLQAENDX EQU   PL+8                                                     01703000
PLFLAGS  EQU   PL+9                                                     01704000
PLOPNO   EQU   PL+10                                                    01705000
PLQBJPL  EQU   PL+12                                                    01706000
PLQBJNDX EQU   PLQBJPL                                                  01707000
PLSNS    EQU   PL+20                                                    01708000
CHAR4    EQU   0                                                        01709000
PTR31    EQU   0                                                        01710000
BIT8     EQU   0                                                        01711000
CHAR2    EQU   0                                                        01712000
DSPBYPAS EQU   20                                                       01713000
DSPDISP  EQU   4                                                        01714000
DSPLIFO  EQU   56                                                       01715000
DSPLIFOR EQU   60                                                       01716000
DSPLIST  EQU   8                                                        01717000
DSPPOST  EQU   24                                                       01718000
DSPPRIO  EQU   48                                                       01719000
DSPPRIOR EQU   52                                                       01720000
DSPTRACE EQU   64                                                       01721000
DSPTSTQ  EQU   32                                                       01722000
DSPTSTQR EQU   36                                                       01723000
DSPUNAV  EQU   40                                                       01724000
DSPUNAVR EQU   44                                                       01725000
DSPWAIT  EQU   16                                                       01726000
LCBRSPIN EQU   LCBIOBSN                                                 01727000
LCBRHSV  EQU   LCBRSPIN+2                                               01728000
LCBLUSNS EQU   LCBRSPIN+5                                               01729000
LCBSCPRS EQU   LCBRSPIN+9                                               01730000
LCBDFCMD EQU   LCBSCPRS                                                 01731000
LCBCSWU1 EQU   LCBSCPRS+2                                               01732000
LCBRSPFG EQU   LCBRSPIN+15                                              01733000
LCBEXPI  EQU   LCBRSPFG                                                 01734000
LCBRSRH  EQU   LCBRSPFG                                                 01735000
LCBCOREQ EQU   LCBTPCD                                                  01736000
@NM00133 EQU   LCBCPA+40                                                01737000
LCBQNX   EQU   LCBERCCW                                                 01738000
LCBQNXMN EQU   LCBQNX                                                   01739000
LCBCANCL EQU   LCBSAVSN                                                 01740000
LCBCANFG EQU   LCBCANCL                                                 01741000
LCBCANXT EQU   LCBCANFG                                                 01742000
LCBCANTH EQU   LCBCANCL+1                                               01743000
IEDQSPTR EQU   LCBSCBA                                                  01744000
TRMPRE1  EQU   TRMBYTE4                                                 01745000
TRMNCP1  EQU   TRMBYTE4                                                 01746000
TRMPRE   EQU   TRMBYTE3                                                 01747000
TRMNCP   EQU   TRMBYTE3                                                 01748000
TRMPU    EQU   TRMBYTE3                                                 01749000
TRMLU    EQU   TRMBYTE3                                                 01750000
TRMLINK  EQU   TRMBYTE3                                                 01751000
PRFSHDR  EQU   IEDQPRF+42                                               01752000
SCBRGSAV EQU   SCBEND                                                   01753000
TRMOPT   EQU   IEDQTRM+20                                               01754000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01755000
@NM00181 EQU   TRMLINK                                                  01756000
TRMLSTAT EQU   TRMLINK                                                  01757000
TRMLINT  EQU   TRMLINK                                                  01758000
TRMEPMOD EQU   TRMLINK                                                  01759000
TRMLULOG EQU   TRMLU                                                    01760000
TRMINERR EQU   TRMLU                                                    01761000
TRMLUREQ EQU   TRMLU                                                    01762000
TRMSESRQ EQU   TRMLU                                                    01763000
TRMTDIFF EQU   TRMLU                                                    01764000
TRMLUTM  EQU   TRMLU                                                    01765000
TRMLUIT  EQU   TRMLU                                                    01766000
TRMAUTO  EQU   TRMLU                                                    01767000
TRMPCONT EQU   TRMPU                                                    01768000
@NM00180 EQU   TRMPU                                                    01769000
TRMNCONT EQU   TRMNCP                                                   01770000
TRMQUCKN EQU   TRMNCP                                                   01771000
TRMSLOWN EQU   TRMNCP                                                   01772000
TRMSYGEN EQU   TRMNCP                                                   01773000
TRMNCPCL EQU   TRMNCP                                                   01774000
TRMIPLDM EQU   TRMNCP                                                   01775000
TRMINOUT EQU   TRMPRE                                                   01776000
TRMRDOUT EQU   TRMPRE                                                   01777000
TRMNLOUT EQU   TRMPRE                                                   01778000
TRMWROUT EQU   TRMPRE                                                   01779000
TRMASNXI EQU   TRMPRE                                                   01780000
TRMSTMM  EQU   TRMPRE                                                   01781000
TRMCMODE EQU   TRMPRE                                                   01782000
TRMSTPND EQU   TRMPRE                                                   01783000
@NM00179 EQU   TRMNCP1                                                  01784000
TRMINOP  EQU   TRMNCP1                                                  01785000
TRMLYNCH EQU   TRMPRE1                                                  01786000
TRMSPOUT EQU   TRMPRE1                                                  01787000
TRMERLCK EQU   TRMPRE1                                                  01788000
TRMQNPL  EQU   TRMPRE1                                                  01789000
TRMSPACT EQU   TRMPRE1                                                  01790000
TRMOCNI  EQU   TRMPRE1                                                  01791000
TRMSESSN EQU   TRMPRE1                                                  01792000
TRMCONT  EQU   TRMPRE1                                                  01793000
@NM00141 EQU   LCBCANCL+3                                               01794000
@NM00140 EQU   LCBCANFG                                                 01795000
LCBCANCD EQU   LCBCANFG                                                 01796000
@NM00139 EQU   LCBCANFG                                                 01797000
LCBCANEB EQU   LCBCANFG                                                 01798000
LCBUNADD EQU   LCBQNX+21                                                01799000
LCBUASZE EQU   LCBQNX+20                                                01800000
LCBDSTEA EQU   LCBQNX+16                                                01801000
@NM00138 EQU   LCBQNX+8                                                 01802000
LCBIOSBS EQU   LCBQNX+5                                                 01803000
@NM00137 EQU   LCBQNX+4                                                 01804000
LCBSTSAV EQU   LCBQNX+1                                                 01805000
@NM00136 EQU   LCBQNXMN                                                 01806000
LCBNX509 EQU   LCBQNXMN                                                 01807000
LCBNX162 EQU   LCBQNXMN                                                 01808000
LCBNX142 EQU   LCBQNXMN                                                 01809000
LCBNX064 EQU   LCBQNXMN                                                 01810000
@NM00135 EQU   @NM00133+4                                               01811000
LCBNCPPT EQU   @NM00133+1                                               01812000
@NM00134 EQU   @NM00133                                                 01813000
LCBWRSCH EQU   LCBCOREQ+8                                               01814000
LCBCQLNK EQU   LCBCOREQ+4                                               01815000
LCBCQELE EQU   LCBCOREQ                                                 01816000
LCBPAKCH EQU   LCBRSPIN+16                                              01817000
@NM00132 EQU   LCBRSPFG                                                 01818000
@NM00131 EQU   LCBRSPIN+12                                              01819000
LCBUSUE1 EQU   LCBCSWU1                                                 01820000
@NM00130 EQU   LCBCSWU1                                                 01821000
@NM00129 EQU   LCBSCPRS+1                                               01822000
LCBUSER  EQU   LCBLUSNS+2                                               01823000
LCBSMIN  EQU   LCBLUSNS+1                                               01824000
LCBSMAJ  EQU   LCBLUSNS                                                 01825000
LCBSNS0  EQU   LCBRSPIN+1                                               01826000
@NM00128 EQU   LCBRSPIN                                                 01827000
@NM00193 EQU   PL+11                                                    01828000
PLMASK   EQU   PL+3                                                     01829000
PLINDEX2 EQU   PL+2                                                     01830000
PLLEN    EQU   PL+1                                                     01831000
@NM00192 EQU   PLINDEX1                                                 01832000
TRMSUBST EQU   IEDNTRM+12                                               01833000
TRMTYPE  EQU   IEDNTRM+11                                               01834000
TRMRLMCT EQU   IEDNTRM+10                                               01835000
TRMCOHTG EQU   TRMSIBPT+1                                               01836000
TRMGPCNT EQU   TRMSIBPT                                                 01837000
TRMBUFRD EQU   TRMBYTE0                                                 01838000
TRMSNA   EQU   TRMBYTE0                                                 01839000
TRMGP    EQU   TRMBYTE0                                                 01840000
TRMDIAL  EQU   TRMBYTE0                                                 01841000
@NM00178 EQU   TRMBYTE0                                                 01842000
TRMOUTPT EQU   TRMBYTE0                                                 01843000
TRMINPUT EQU   TRMBYTE0                                                 01844000
TRMUDEF  EQU   TRMBYTE0                                                 01845000
TRMCOHRT EQU   IEDNTRM+4                                                01846000
TRMSTOTE EQU   TRMBYTE1                                                 01847000
TRMCKPRN EQU   TRMBYTE1                                                 01848000
TRMTSATN EQU   TRMBYTE1                                                 01849000
TRMTRACE EQU   TRMBYTE1                                                 01850000
TRMSWBCK EQU   TRMBYTE1                                                 01851000
TRMAUTOC EQU   TRMBYTE1                                                 01852000
TRMINPTP EQU   TRMBYTE1                                                 01853000
TRMWTNEG EQU   TRMSCPRQ                                                 01854000
TRMWRBRK EQU   TRMBYTE2                                                 01855000
TRMNOSND EQU   TRMBYTE2                                                 01856000
TRMPREP  EQU   TRMBYTE2                                                 01857000
TRMGPACT EQU   TRMBYTE2                                                 01858000
TRMANDL  EQU   TRMBYTE2                                                 01859000
TRMCLOSN EQU   TRMINPG                                                  01860000
TRMREMB  EQU   TRMBYTE2                                                 01861000
TRMRSACT EQU   TRMBYTE2                                                 01862000
TRMOPTBL EQU   IEDQTRM+18                                               01863000
TRMOPNO  EQU   IEDQTRM+17                                               01864000
TRMCHCIN EQU   IEDQTRM+16                                               01865000
TRMSENSE EQU   TRMSTAT+3                                                01866000
TRMTEMPR EQU   TRMSTAT+2                                                01867000
TRMSIO   EQU   TRMSTAT                                                  01868000
@NM00177 EQU   TRMDEVFL+1                                               01869000
TRMTPIN  EQU   TRMDEVFL+1                                               01870000
TRMNCPI  EQU   TRMDEVFL+1                                               01871000
TRMRNTRM EQU   TRMDEVFL+1                                               01872000
@NM00176 EQU   TRMDEVFL+1                                               01873000
TRMLMD   EQU   TRMDEVFL+1                                               01874000
TRMCONC  EQU   TRMDEVFL+1                                               01875000
TRMTSOB  EQU   TRMDEVFL                                                 01876000
TRMBFDY  EQU   TRMDEVFL                                                 01877000
TRMTBLK  EQU   TRMDEVFL                                                 01878000
TRMSBLK  EQU   TRMDEVFL                                                 01879000
TRMBLKS  EQU   TRMDEVFL                                                 01880000
TRMADDC  EQU   TRMDEVFL                                                 01881000
TRMDDIG  EQU   TRMDEVFL                                                 01882000
TRMBUFS  EQU   TRMDEVFL                                                 01883000
TRMPRILK EQU   TRMALTD                                                  01884000
TRMLGB   EQU   TRMDSORG                                                 01885000
TRMUTERM EQU   TLISTCNT                                                 01886000
TRMDESTQ EQU   IEDQTRM+1                                                01887000
TRMSCNYN EQU   TRMSTATE                                                 01888000
TRMOPTFN EQU   TRMSTATE                                                 01889000
TRMHELDN EQU   TRMSTATE                                                 01890000
TRMACPTN EQU   TRMSTATE                                                 01891000
TRMPREF  EQU   TRMSTATE                                                 01892000
TRMPROC  EQU   TRMLOG                                                   01893000
TRMLIST  EQU   TRMLOG                                                   01894000
TRMLINE  EQU   TRMSTATE                                                 01895000
TTHTAG2  EQU   TTHTAG+1                                                 01896000
@NM00175 EQU   TTHTAG1                                                  01897000
TTHTAGS  EQU   TTHTAG1                                                  01898000
TTHBYTE1 EQU   IEDTH+1                                                  01899000
@NM00174 EQU   TTHBYTE0                                                 01900000
SNSUSR2  EQU   SNSUSER+1                                                01901000
SNSUSR1  EQU   SNSUSER                                                  01902000
SNSMIN   EQU   SNSSYSTM+1                                               01903000
SIBLUTYP EQU   SIBSTAT0                                                 01904000
SIBCD    EQU   SIBSTAT0                                                 01905000
@NM00173 EQU   SIBBIND3                                                 01906000
SIBCRES  EQU   SIBBIND3                                                 01907000
SIBSPKR  EQU   SIBBIND3                                                 01908000
SIBRECOV EQU   SIBBIND3                                                 01909000
SIBFMODE EQU   SIBBIND3                                                 01910000
SIBALT   EQU   SIBBIND2                                                 01911000
SIBBTERM EQU   SIBBIND2                                                 01912000
SIBBRACK EQU   SIBBIND2                                                 01913000
SIBFMUSE EQU   SIBBIND2                                                 01914000
SIBSEBI  EQU   SIBBIND2                                                 01915000
SIBSCMP  EQU   SIBBIND2                                                 01916000
SIBSEXC  EQU   SIBBIND2                                                 01917000
SIBSDEF  EQU   SIBBIND2                                                 01918000
SIBSRQM  EQU   SIBBIND1                                                 01919000
SIBSCHNG EQU   SIBBIND1                                                 01920000
SIBPEBI  EQU   SIBBIND1                                                 01921000
SIBPCMP  EQU   SIBBIND1                                                 01922000
SIBPEXC  EQU   SIBBIND1                                                 01923000
SIBPDEF  EQU   SIBBIND1                                                 01924000
SIBPRQM  EQU   SIBBIND1                                                 01925000
SIBPCHN  EQU   SIBBIND1                                                 01926000
SIBFMPRO EQU   IEDSIBD+19                                               01927000
SIBTSPRO EQU   IEDSIBD+18                                               01928000
@NM00172 EQU   SIBSTAT2                                                 01929000
SIBDACLU EQU   SIBSTAT2                                                 01930000
SIBRDSCN EQU   SIBSTAT2                                                 01931000
SIBTERM  EQU   SIBSTAT2                                                 01932000
SIBUSS   EQU   SIBSTAT2                                                 01933000
SIBBSTAT EQU   SIBSTAT1                                                 01934000
SIBRTRP  EQU   SIBSTAT1                                                 01935000
SIBFTERM EQU   SIBSTAT1                                                 01936000
SIBRQEND EQU   SIBSTAT1                                                 01937000
SIBRQSHT EQU   SIBSTAT1                                                 01938000
SIBSEQO  EQU   SIBSEQN+2                                                01939000
SIBSEQI  EQU   SIBSEQN                                                  01940000
SIBNCNT  EQU   SIBPACIN                                                 01941000
SIBMCNT  EQU   SIBPACIN                                                 01942000
SIBDSTAT EQU   SIBSESSN                                                 01943000
SIBSSTAT EQU   SIBSESSN                                                 01944000
SIBINBIU EQU   SIBSESSN                                                 01945000
SIBSHUTC EQU   SIBSESSN                                                 01946000
SIBLGOFF EQU   SIBSESSN                                                 01947000
SIBCHAIN EQU   IEDSIBD+4                                                01948000
SIBRUSEG EQU   IEDSIBD                                                  01949000
SCBTRANS EQU   IEDQSCB+81                                               01950000
SCBUNTCT EQU   IEDQSCB+80                                               01951000
SCBEOB   EQU   IEDQSCB+78                                               01952000
SCBNXCPB EQU   SCBCCSEG                                                 01953000
SCBNHDR  EQU   SCBCHDR                                                  01954000
SCBCRCD  EQU   IEDQSCB+69                                               01955000
SCBTQBCK EQU   SCBNTXT                                                  01956000
SCBOSEQ  EQU   SCBSCAN                                                  01957000
SCBXTRA  EQU   SCBCORE                                                  01958000
SCBNOPST EQU   SCBSTAT1                                                 01959000
SCBNIDLE EQU   SCBSTAT1                                                 01960000
SCBCEND  EQU   SCBSTAT1                                                 01961000
SCBCBGN  EQU   SCBSTAT1                                                 01962000
SCBSIZE  EQU   IEDQSCB+58                                               01963000
SCBSRCE  EQU   IEDQSCB+56                                               01964000
SCBDEOB  EQU   IEDQSCB+52                                               01965000
SCBFEFO  EQU   SCBDCSEG                                                 01966000
SCBCTBND EQU   SCBBLKCT                                                 01967000
SCBSCHDR EQU   SCBCLSEG                                                 01968000
SCBHBFNO EQU   IEDQSCB+44                                               01969000
SCBSCSEG EQU   SCBDNSEG                                                 01970000
SCBBCTR  EQU   SCBCTBSV                                                 01971000
SCBCCHDR EQU   IEDQSCB+37                                               01972000
SCBDESTL EQU   IEDQSCB+36                                               01973000
SCBDCHDR EQU   IEDQSCB+33                                               01974000
SCBCPBNO EQU   IEDQSCB+32                                               01975000
SCBMBSSA EQU   IEDQSCB+25                                               01976000
SCBMLMTN EQU   SCBBSCFM                                                 01977000
SCBNOEOT EQU   SCBBSCFM                                                 01978000
@NM00171 EQU   SCBBSCFM                                                 01979000
SCBNPDTR EQU   SCBDATEN                                                 01980000
SCBCNTEN EQU   SCBBSCFM                                                 01981000
SCBRCVTX EQU   SCBBSCFM                                                 01982000
SCBNONTR EQU   SCBBSCFM                                                 01983000
SCBTRNSP EQU   SCBBSCFM                                                 01984000
SCBENDCR EQU   SCBCTBAC+1                                               01985000
SCBCRLEN EQU   SCBCTBAC                                                 01986000
SCBMRFSD EQU   IEDQSCB+20                                               01987000
SCBUNDFN EQU   SCBERR4                                                  01988000
SCBSTERN EQU   SCBCHANN                                                 01989000
SCBCPMEN EQU   SCBCTLUN                                                 01990000
@NM00170 EQU   SCBERR4                                                  01991000
SCBTRMLN EQU   SCBERR4                                                  01992000
SCBCONNN EQU   SCBERR4                                                  01993000
SCBAPERR EQU   SCBTXTTN                                                 01994000
SCBSLCTN EQU   SCBERR4                                                  01995000
SCBPERRN EQU   SCBXCEPN                                                 01996000
SCBTHRSN EQU   SCBATTN                                                  01997000
SCBFIERN EQU   SCBFORMN                                                 01998000
SCBUSERN EQU   SCBERR3                                                  01999000
SCBSATTN EQU   SCBERR3                                                  02000000
SCBTMINN EQU   SCBERR3                                                  02001000
SCBXPD   EQU   SCBTMIDN                                                 02002000
SCBXPI   EQU   SCBLOSTN                                                 02003000
SCBSOHE  EQU   SCBERR2                                                  02004000
SCBFRWDN EQU   SCBERR2                                                  02005000
SCBRRJN  EQU   SCBABRTN                                                 02006000
SCBOLTR  EQU   SCBERR2                                                  02007000
SCBALN   EQU   SCBERR2                                                  02008000
SCBCODER EQU   SCBERR2                                                  02009000
SCBCRMAX EQU   SCBERR2                                                  02010000
SCBCRMIN EQU   SCBERR2                                                  02011000
SCBRVISL EQU   SCBCUTFN                                                 02012000
SCBNOBFN EQU   SCBERR1                                                  02013000
@NM00169 EQU   SCBERR1                                                  02014000
SCBNOVAC EQU   SCBSEQLN                                                 02015000
SCBNOTSO EQU   SCBSEQHN                                                 02016000
SCBRVITX EQU   SCBNOTRM                                                 02017000
SCBHANG  EQU   SCBORIGN                                                 02018000
SCBNOLOG EQU   SCBHDRRN                                                 02019000
SCBMRFPL EQU   IEDQSCB+13                                               02020000
SCBBFMM  EQU   SCBQTYPE                                                 02021000
SCBBBFTM EQU   SCBQTYPE                                                 02022000
SCBNOFF  EQU   SCBQTYPE                                                 02023000
SCBCONC  EQU   SCBQTYPE                                                 02024000
SCBNREUS EQU   SCBQTYPE                                                 02025000
SCBREUS  EQU   SCBQTYPE                                                 02026000
SCBCOREQ EQU   SCBQTYPE                                                 02027000
SCBNORCL EQU   SCBQTYPE                                                 02028000
SCBCTBSZ EQU   SCBEOBSZ                                                 02029000
@NM00168 EQU   SCBBKFCT                                                 02030000
SCBPRI   EQU   IEDQSCB+8                                                02031000
SCBMACR  EQU   SCBMBHEN                                                 02032000
SCBSNDCT EQU   SCBRCVCT                                                 02033000
SCBDESTQ EQU   IEDQSCB+1                                                02034000
SCBCODE  EQU   SCBSTATE                                                 02035000
SCBPRER  EQU   SCBSTATE                                                 02036000
SCBCKPT  EQU   SCBSTATE                                                 02037000
SCBMSGLN EQU   SCBSTATE                                                 02038000
SCBERSDS EQU   SCBSTATE                                                 02039000
SCBLCK1N EQU   SCBSTATE                                                 02040000
SCBMGFMN EQU   SCBSEQIN                                                 02041000
SCBTRANP EQU   SCBSTATE                                                 02042000
@NM00167 EQU   TRHBYTE2                                                 02043000
@NM00166 EQU   TRHBYTE2                                                 02044000
@NM00165 EQU   TRHBYTE2                                                 02045000
TRHCSI   EQU   TRHBYTE2                                                 02046000
@NM00164 EQU   TRHBYTE2                                                 02047000
TRHCDI   EQU   TRHBYTE2                                                 02048000
TRHEB    EQU   TRHBYTE2                                                 02049000
TRHBB    EQU   TRHBYTE2                                                 02050000
TRHPI    EQU   TRHBYTE1                                                 02051000
@NM00163 EQU   TRHBYTE1                                                 02052000
@NM00162 EQU   TRHBYTE1                                                 02053000
@NM00161 EQU   TRHBYTE1                                                 02054000
@NM00160 EQU   TRHBYTE1                                                 02055000
@NM00159 EQU   TRHBYTE0                                                 02056000
PRF2SEQP EQU   PRF2WD2                                                  02057000
@NM00158 EQU   IEDPF2+1                                                 02058000
@NM00157 EQU   PRF2FLG2                                                 02059000
PRF2TERM EQU   PRF2FLG2                                                 02060000
PRF2SMI  EQU   PRF2FLG2                                                 02061000
PRF2FORM EQU   PRF2FLG2                                                 02062000
PRF1RULN EQU   PRF1SEQP+2                                               02063000
PRF1TAG2 EQU   PRF1SQID+1                                               02064000
@NM00156 EQU   PRF1TAG1                                                 02065000
PRF1TAGS EQU   PRF1TAG1                                                 02066000
@NM00155 EQU   PRF1FLG1                                                 02067000
PRF1LOGD EQU   PRF1FLG1                                                 02068000
PRF1USS  EQU   PRF1FLG1                                                 02069000
PRF1FORM EQU   PRF1FLG1                                                 02070000
PRF1FIDI EQU   PRF1FLG1                                                 02071000
PRFDEST  EQU   IEDQPRF+40                                               02072000
PRFISEQ  EQU   IEDQPRF+38                                               02073000
PRFSTXT  EQU   PRFHQBCK                                                 02074000
PRFNHDR  EQU   PRFCHDR                                                  02075000
PRFCRCD  EQU   IEDQPRF+29                                               02076000
PRFSVSEQ EQU   PRFNTXT+1                                                02077000
PRFSVPRI EQU   PRFEOBOF                                                 02078000
PRFISIZE EQU   PRFSCAN+1                                                02079000
@NM00154 EQU   PRFSCAN                                                  02080000
PRFEOB   EQU   PRFXTRA+1                                                02081000
PRFSTSO  EQU   PRFXTRA                                                  02082000
PRFNHDRN EQU   PRFSTAT1                                                 02083000
PRFNLSTN EQU   PRFSTAT1                                                 02084000
PRFLOCK  EQU   PRFEOFN                                                  02085000
PRFDUPLN EQU   PRFSTAT1                                                 02086000
PRFTSMSG EQU   PRFSTAT1                                                 02087000
PRFITCPN EQU   PRFSTAT1                                                 02088000
PRFERMGN EQU   PRFSTAT1                                                 02089000
PRFCNCLN EQU   PRFSTAT1                                                 02090000
PRFSVFLG EQU   @NM00153+3                                               02091000
PRFSIZE  EQU   PRFSVFFO+2                                               02092000
PRFSRCE  EQU   PRFSVFFO                                                 02093000
PRFLCB   EQU   IEDQPRF+13                                               02094000
PRFTI0   EQU   PRFTIC+1                                                 02095000
@NM00152 EQU   PRFTICC                                                  02096000
@NM00151 EQU   PRFTICC                                                  02097000
@NM00150 EQU   PRFTICC                                                  02098000
PRFTICON EQU   PRFTICC                                                  02099000
@NM00149 EQU   PRFTICC                                                  02100000
@NM00148 EQU   PRFTICC                                                  02101000
PRFBFMM  EQU   PRFTICC                                                  02102000
PRFEOMSG EQU   PRFTICC                                                  02103000
PRFCOUNT EQU   PRFLINK+1                                                02104000
@NM00147 EQU   PRFLINK                                                  02105000
PRFFLAGS EQU   PRFPRI                                                   02106000
PRFIOADR EQU   PRFQCBA                                                  02107000
PRFOPCDE EQU   PRFKEY                                                   02108000
LCBERADR EQU   LCBXRADR+1                                               02109000
LCBPCIRC EQU   LCBXRADR                                                 02110000
LCBDCT3  EQU   LCBXDCT+2                                                02111000
LCBDCT2  EQU   LCBXDCT+1                                                02112000
LCBDCT1  EQU   LCBXDCT                                                  02113000
@NM00146 EQU   LCBXFLAG                                                 02114000
LCBERPND EQU   LCBXFLAG                                                 02115000
LCBSRCPF EQU   LCBXFLAG                                                 02116000
LCBGPCTV EQU   LCBXFLAG                                                 02117000
@NM00145 EQU   LCBXFLAG                                                 02118000
@NM00144 EQU   LCBXFLAG                                                 02119000
@NM00143 EQU   LCBXFLAG                                                 02120000
@NM00142 EQU   LCBXFLAG                                                 02121000
LCBCCW10 EQU   LCBCPA+72                                                02122000
LCBCCW9  EQU   LCBCPA+64                                                02123000
LCBCCW8  EQU   LCBCPA+56                                                02124000
LCBCCW7  EQU   LCBCPA+48                                                02125000
LCBCCW6  EQU   LCBCPA+40                                                02126000
LCBCP    EQU   LCBQEBPL+4                                               02127000
LCBIOSB  EQU   LCBQEBPL+1                                               02128000
LCBSIO   EQU   LCBQEBPL                                                 02129000
LCBCCW4  EQU   LCBCPA+24                                                02130000
LCBCCW3  EQU   LCBCPA+16                                                02131000
LCBCCW2  EQU   LCBCPA+8                                                 02132000
LCBCCW1  EQU   LCBCPA                                                   02133000
@NM00127 EQU   LCBERCCW+16                                              02134000
LCBATL05 EQU   LCBERCCW+8                                               02135000
@NM00126 EQU   LCBERCCW                                                 02136000
LCBCSWSV EQU   LCBSAVSN+1                                               02137000
LCBSNSV  EQU   LCBSAVSN                                                 02138000
LCBBFSNS EQU   LCBRSPSV                                                 02139000
LCBWAITC EQU   LCBTPCD+5                                                02140000
LCBINPAK EQU   LCBSTAT6                                                 02141000
LCBMHBID EQU   LCBSTAT6                                                 02142000
LCBHDRPD EQU   LCBSTAT6                                                 02143000
LCBCHN   EQU   LCBSTAT6                                                 02144000
LCBBFRSV EQU   LCBTPCD+1                                                02145000
@NM00125 EQU   LCBSTAT5                                                 02146000
LCBLUS   EQU   LCBSTAT5                                                 02147000
LCBPERM  EQU   LCBSTAT5                                                 02148000
LCBNXCMD EQU   LCBBFRW                                                  02149000
LCBERMSK EQU   LCBOBRCH                                                 02150000
LCBOLT   EQU   LCBMSGFM                                                 02151000
LCBEOT   EQU   LCBMSGFM                                                 02152000
LCBENQ   EQU   LCBMSGFM                                                 02153000
LCBTTD   EQU   LCBMSGFM                                                 02154000
LCBRSTRT EQU   LCBMSGFM                                                 02155000
LCBVSTRT EQU   LCBMSGFM                                                 02156000
LCBACKI  EQU   LCBMSGFM                                                 02157000
LCBNAK   EQU   LCBMSGFM                                                 02158000
@NM00124 EQU   LCBRBCT2                                                 02159000
LCBDCNT  EQU   LCBRBCT2                                                 02160000
LCBCOMPL EQU   LCBDLNKN                                                 02161000
LCBERROR EQU   LCBERBST                                                 02162000
LCBLOGDV EQU   LCBERBST                                                 02163000
LCBINQ   EQU   LCBERBST                                                 02164000
LCBRDERR EQU   LCBERBST                                                 02165000
LCBEOMSG EQU   LCBERBST                                                 02166000
LCBMSG   EQU   LCBERBST                                                 02167000
LCBERBKY EQU   LCBERB                                                   02168000
LCBRECAD EQU   IEDQLCB+73                                               02169000
@NM00123 EQU   LCBTSTSW                                                 02170000
@NM00122 EQU   LCBTSTSW                                                 02171000
@NM00121 EQU   LCBTSTSW                                                 02172000
@NM00120 EQU   LCBTSTSW                                                 02173000
@NM00119 EQU   LCBTSTSW                                                 02174000
@NM00118 EQU   LCBTSTSW                                                 02175000
@NM00117 EQU   LCBTSTSW                                                 02176000
LCBCONCT EQU   LCBTSTSW                                                 02177000
LCBBFRAV EQU   LCBDIAL                                                  02178000
LCBATTN  EQU   LCBSYNC                                                  02179000
LCBNEGRP EQU   LCBSTAT2                                                 02180000
LCBSNDPR EQU   LCBSTAT2                                                 02181000
LCBCONNN EQU   LCBBEOTN                                                 02182000
LCBMSGNN EQU   LCBSTAT2                                                 02183000
LCBTRACE EQU   LCBSTAT2                                                 02184000
LCBSENDN EQU   LCBSTAT1                                                 02185000
LCBRECVN EQU   LCBSTAT1                                                 02186000
LCBFREEN EQU   LCBSTAT1                                                 02187000
LCBCONT  EQU   LCBSTAT1                                                 02188000
LCBINITN EQU   LCBSTAT1                                                 02189000
LCBOCNI  EQU   LCBSTAT1                                                 02190000
LCBOCWTN EQU   LCBSTAT1                                                 02191000
LCBRCLLN EQU   LCBSTAT1                                                 02192000
LCBRECOF EQU   IEDQLCB+68                                               02193000
LCBRDBFR EQU   LCBRCBFR                                                 02194000
LCBUCBX  EQU   IEDQLCB+64                                               02195000
LCBTTBIN EQU   LCBERRCT                                                 02196000
@NM00116 EQU   LCBINCAM                                                 02197000
LCBGETMN EQU   LCBINCAM                                                 02198000
@NM00115 EQU   LCBRESTR+1                                               02199000
LCBCMDSV EQU   LCBRESTR                                                 02200000
LCBPCILK EQU   LCBDCBPT                                                 02201000
LCBSTART EQU   LCBIOBSN+16                                              02202000
LCBAP4OL EQU   LCBSIOCC                                                 02203000
LCBAP3OL EQU   LCBSIOCC                                                 02204000
LCBAP2OL EQU   LCBSIOCC                                                 02205000
LCBAP1OL EQU   LCBSIOCC                                                 02206000
LCBSIOC2 EQU   LCBSIOCC                                                 02207000
LCBSIOC1 EQU   LCBSIOCC                                                 02208000
@NM00114 EQU   LCBSIOCC                                                 02209000
LCBCSWRC EQU   LCBCSW+5                                                 02210000
LCBCSCHC EQU   LCBCSWCS                                                 02211000
LCBCSICC EQU   LCBCSWCS                                                 02212000
LCBCSCCC EQU   LCBCSWCS                                                 02213000
LCBCSCDC EQU   LCBCSWCS                                                 02214000
LCBCSPTC EQU   LCBCSWCS                                                 02215000
LCBCSPGC EQU   LCBCSWCS                                                 02216000
LCBCSIL  EQU   LCBCSWCS                                                 02217000
LCBCSPCI EQU   LCBCSWCS                                                 02218000
LCBUSUE  EQU   LCBCSWUS                                                 02219000
LCBUSUC  EQU   LCBCSWUS                                                 02220000
LCBUSDE  EQU   LCBCSWUS                                                 02221000
LCBUSCE  EQU   LCBCSWUS                                                 02222000
LCBUSBSY EQU   LCBCSWUS                                                 02223000
LCBUSCUE EQU   LCBCSWUS                                                 02224000
LCBUSSM  EQU   LCBCSWUS                                                 02225000
LCBUSAT  EQU   LCBCSWUS                                                 02226000
LCBCSWCA EQU   LCBCSW                                                   02227000
LCBOBR   EQU   LCBFLAG3                                                 02228000
LCBOBRRD EQU   LCBFLAG3                                                 02229000
LCBIOMSG EQU   LCBFLAG3                                                 02230000
LCBSOHC  EQU   LCBFLAG3                                                 02231000
LCBRLAD  EQU   LCBFLAG3                                                 02232000
LCBSOHR  EQU   LCBFLAG3                                                 02233000
@NM00113 EQU   LCBFLAG3                                                 02234000
LCBECBPT EQU   LCBIOBSN+4                                               02235000
LCBECBCC EQU   LCBIOBSN+3                                               02236000
LCBSENS1 EQU   LCBSNS+1                                                 02237000
LCBABORT EQU   LCBTMOUT                                                 02238000
LCBNOTIN EQU   LCBLOSDT                                                 02239000
LCBOVRUN EQU   LCBSENS0                                                 02240000
LCBDATCK EQU   LCBSENS0                                                 02241000
LCBEQUCK EQU   LCBSENS0                                                 02242000
LCBBUSCK EQU   LCBSENS0                                                 02243000
LCBINTRQ EQU   LCBSENS0                                                 02244000
LCBCMDRJ EQU   LCBSENS0                                                 02245000
LCBFLAG2 EQU   LCBIOBSN                                                 02246000
@NM00112 EQU   LCBFLAG1                                                 02247000
LCBUNREL EQU   LCBFLAG1                                                 02248000
LCBEXCPN EQU   LCBFLAG1                                                 02249000
@NM00111 EQU   LCBFLAG1                                                 02250000
LCBERPIN EQU   LCBFLAG1                                                 02251000
@NM00110 EQU   LCBFLAG1                                                 02252000
LCBFSBFR EQU   LCBMHA                                                   02253000
LCBISZE  EQU   IEDQLCB+28                                               02254000
LCBLNENT EQU   LCBSCBDA+1                                               02255000
@NM00109 EQU   LCBSCBDA                                                 02256000
LCBCPGMH EQU   LCBSTAT4                                                 02257000
LCBREAL  EQU   LCBPHASE                                                 02258000
@NM00108 EQU   LCBSTAT4                                                 02259000
LCBACTRQ EQU   LCBSTAT4                                                 02260000
LCBIPLRQ EQU   LCBSTAT4                                                 02261000
LCBDACRQ EQU   LCBSTAT4                                                 02262000
LCBDMPRQ EQU   LCBSTAT4                                                 02263000
@NM00107 EQU   LCBLKMDE                                                 02264000
LCBLOCKI EQU   LCBLKMDE                                                 02265000
LCBLOCKR EQU   LCBLKMDE                                                 02266000
LCBHMFLG EQU   LCBLKMDE                                                 02267000
LCBBDFLG EQU   LCBLKMDE                                                 02268000
@NM00106 EQU   LCBINSRC                                                 02269000
LCBABRTN EQU   LCBCHAIN                                                 02270000
LCBCTLMD EQU   LCBTETEN                                                 02271000
LCBBFRSZ EQU   LCBCHAIN                                                 02272000
LCBUREQN EQU   LCBCHAIN                                                 02273000
LCBNORTY EQU   LCBCHAIN                                                 02274000
LCBERMSG EQU   LCBCHAIN                                                 02275000
LCBEXCP  EQU   LCBCHAIN                                                 02276000
LCBINVRQ EQU   LCBSCRNN                                                 02277000
LCB2741N EQU   LCBTSOB                                                  02278000
LCBINHBN EQU   LCBTSOB                                                  02279000
LCBCIRCD EQU   LCBTSOB                                                  02280000
LCBPREP  EQU   LCBTSOB                                                  02281000
LCBSOPL  EQU   LCBTSOB                                                  02282000
LCBSATRD EQU   LCBTSOB                                                  02283000
LCBTSBUF EQU   LCBTSOB                                                  02284000
LCBWRBRK EQU   LCBTSOB                                                  02285000
LCBTDL   EQU   IEDQLCB+18                                               02286000
LCBEOLTD EQU   IEDQLCB+16                                               02287000
LCBRSLNK EQU   IEDQLCB+13                                               02288000
LCBRSPRI EQU   IEDQLCB+12                                               02289000
LCBSTCBA EQU   IEDQLCB+9                                                02290000
LCBRSKEY EQU   IEDQLCB+8                                                02291000
LCBPRI   EQU   LCBRCB+4                                                 02292000
LCBKEY   EQU   LCBRCB                                                   02293000
SAVTLLCB EQU   IEDNSVTD+316                                             02294000
SAVTBITN EQU   IEDNSVTD+312                                             02295000
@NM00105 EQU   SAVTCKQB+8                                               02296000
@NM00104 EQU   SAVTCKEC+1                                               02297000
@NM00103 EQU   SAVTCKCC                                                 02298000
SAVTCKPO EQU   SAVTCKCC                                                 02299000
SAVTCKWA EQU   SAVTCKCC                                                 02300000
SAVTCKCH EQU   SAVTCKTB+1                                               02301000
SAVTCKVT EQU   SAVTCKTB                                                 02302000
@NM00102 EQU   IEDNSVTD+297                                             02303000
SAVTRDFG EQU   SAVTRDRV+12                                              02304000
@NM00101 EQU   SAVTRDRV+5                                               02305000
SAVTRDPY EQU   SAVTRDRV+4                                               02306000
SAVTRDQB EQU   SAVTRDRV+1                                               02307000
SAVTRDKY EQU   SAVTRDRV                                                 02308000
SAVTNID  EQU   IEDNSVTD+280                                             02309000
SAVTDVAS EQU   IEDNSVTD+276                                             02310000
SAVTPLSZ EQU   IEDNSVTD+274                                             02311000
@NM00100 EQU   IEDNSVTD+273                                             02312000
SAVTSUBL EQU   IEDNSVTD+272                                             02313000
@NM00099 EQU   SAVTZELM+1                                               02314000
SAVTSUBM EQU   SAVTZELM                                                 02315000
SAVTMHDX EQU   IEDNSVTD+268                                             02316000
SAVTNAT1 EQU   IEDNSVTD+266                                             02317000
SAVTSH20 EQU   IEDNSVTD+264                                             02318000
SAVTLCBS EQU   IEDNSVTD+260                                             02319000
SAVTRNMP EQU   IEDNSVTD+256                                             02320000
SAVTTNTX EQU   IEDNSVTD+252                                             02321000
SAVTNAX  EQU   IEDNSVTD+248                                             02322000
SAVTSUBV EQU   IEDNSVTD+247                                             02323000
SAVTSUBA EQU   IEDNSVTD+246                                             02324000
SAVTSIBC EQU   IEDNSVTD+244                                             02325000
SAVTBSM  EQU   IEDNSVTD+240                                             02326000
SAVTRQTG EQU   IEDNSVTD+236                                             02327000
SAVTRQCH EQU   IEDNSVTD+232                                             02328000
SAVTMAND EQU   IEDNSVTD+228                                             02329000
SAVTSPLN EQU   IEDNSVTD+224                                             02330000
SAVTNADL EQU   IEDNSVTD+222                                             02331000
SAVTNATL EQU   IEDNSVTD+220                                             02332000
SAVTMHTB EQU   IEDNSVTD+216                                             02333000
SAVTSSMH EQU   IEDNSVTD+212                                             02334000
SAVTQRS  EQU   IEDNSVTD+208                                             02335000
SAVTRQIN EQU   IEDNSVTD+204                                             02336000
SAVTSAO  EQU   IEDNSVTD+196                                             02337000
SAVTSARI EQU   IEDNSVTD+192                                             02338000
SAVTSAC  EQU   IEDNSVTD+188                                             02339000
SAVTSAI  EQU   IEDNSVTD+184                                             02340000
SAVTCSCI EQU   IEDNSVTD+180                                             02341000
SAVTSSRP EQU   IEDNSVTD+176                                             02342000
SAVTSSRQ EQU   IEDNSVTD+172                                             02343000
SAVTSCLU EQU   IEDNSVTD+168                                             02344000
SAVTXTRQ EQU   IEDNSVTD+164                                             02345000
SAVTMVBF EQU   IEDNSVTD+160                                             02346000
@NM00098 EQU   IEDNSVTD+148                                             02347000
SAVTIPCQ EQU   IEDNSVTD+144                                             02348000
@NM00097 EQU   IEDNSVTD+136                                             02349000
SAVTXFMI EQU   IEDNSVTD+132                                             02350000
@NM00096 EQU   IEDNSVTD+124                                             02351000
SAVTXFMO EQU   IEDNSVTD+120                                             02352000
@NM00095 EQU   IEDNSVTD+116                                             02353000
SAVTSSSR EQU   IEDNSVTD+112                                             02354000
SAVTSCPQ EQU   IEDNSVTD+108                                             02355000
SAVTLUSR EQU   IEDNSVTD+100                                             02356000
@NM00094 EQU   SAVTLUSQ+8                                               02357000
SAVTLUSP EQU   SAVTLUSQ+4                                               02358000
SAVTLUSB EQU   SAVTLUSQ                                                 02359000
@NM00093 EQU   IEDNSVTD+84                                              02360000
SAVTSAT  EQU   IEDNSVTD+80                                              02361000
SAVTNAT  EQU   IEDNSVTD+76                                              02362000
SAVTCLUP EQU   IEDNSVTD+72                                              02363000
SAVTPIUT EQU   IEDNSVTD+68                                              02364000
SAVTRNTA EQU   IEDNSVTD+64                                              02365000
SAVTDNIR EQU   IEDNSVTD+60                                              02366000
SAVTCNIR EQU   IEDNSVTD+56                                              02367000
SAVTFLDH EQU   IEDNSVTD+52                                              02368000
SAVTSRTN EQU   IEDNSVTD+48                                              02369000
SAVTSREQ EQU   IEDNSVTD+44                                              02370000
SAVTFAIL EQU   IEDNSVTD+42                                              02371000
SAVTSUSE EQU   IEDNSVTD+40                                              02372000
SAVTSIB  EQU   IEDNSVTD+36                                              02373000
SAVTPRTN EQU   IEDNSVTD+32                                              02374000
@NM00092 EQU   IEDNSVTD+28                                              02375000
SAVTWH20 EQU   IEDNSVTD+26                                              02376000
SAVTPWT  EQU   IEDNSVTD+24                                              02377000
SAVTPRTQ EQU   IEDNSVTD+20                                              02378000
SAVTPREQ EQU   IEDNSVTD+16                                              02379000
SAVTPH20 EQU   IEDNSVTD+14                                              02380000
SAVTPUSE EQU   IEDNSVTD+12                                              02381000
SAVTPLCB EQU   IEDNSVTD+8                                               02382000
SAVTPOOL EQU   IEDNSVTD+4                                               02383000
SAVTPRMT EQU   SAVTDIAF                                                 02384000
SAVTVIRT EQU   SAVTDIAF                                                 02385000
AVTCPBNO EQU   IEDQAVTD+1172                                            02386000
AVTHRESS EQU   IEDQAVTD+1171                                            02387000
@NM00091 EQU   IEDQAVTD+1170                                            02388000
@NM00090 EQU   IEDQAVTD+1169                                            02389000
@NM00089 EQU   IEDQAVTD+1168                                            02390000
@NM00088 EQU   IEDQAVTD+1165                                            02391000
@NM00087 EQU   IEDQAVTD+1164                                            02392000
AVTHRESE EQU   @NM00086                                                 02393000
AVTRADDR EQU   IEDQAVTD+1156                                            02394000
AVTNADDR EQU   IEDQAVTD+1152                                            02395000
AVTHRESN EQU   IEDQAVTD+1148                                            02396000
AVTVOLRN EQU   IEDQAVTD+1144                                            02397000
AVTTOTNN EQU   IEDQAVTD+1140                                            02398000
AVTTRCYN EQU   IEDQAVTD+1136                                            02399000
AVTRCTRN EQU   IEDQAVTD+1132                                            02400000
AVTNOVON EQU   IEDQAVTD+1128                                            02401000
AVTADEBN EQU   IEDQAVTD+1124                                            02402000
AVTVOLRR EQU   IEDQAVTD+1120                                            02403000
AVTTOTNR EQU   IEDQAVTD+1116                                            02404000
AVTTRCYR EQU   IEDQAVTD+1112                                            02405000
AVTRCTRR EQU   IEDQAVTD+1108                                            02406000
AVTNOVOR EQU   IEDQAVTD+1104                                            02407000
AVTADEBR EQU   IEDQAVTD+1100                                            02408000
AVTLODPT EQU   IEDQAVTD+1096                                            02409000
AVTIOBN  EQU   IEDQAVTD+1092                                            02410000
AVTIOBR  EQU   IEDQAVTD+1088                                            02411000
AVTCPBPT EQU   IEDQAVTD+1084                                            02412000
AVTFCPB  EQU   IEDQAVTD+1080                                            02413000
@NM00085 EQU   IEDQAVTD+1076                                            02414000
AVTINCPQ EQU   IEDQAVTD+1072                                            02415000
@NM00084 EQU   IEDQAVTD+1068                                            02416000
@NM00083 EQU   IEDQAVTD+1065                                            02417000
@NM00082 EQU   AVTBIT4                                                  02418000
@NM00081 EQU   AVTBIT4                                                  02419000
@NM00080 EQU   AVTBIT4                                                  02420000
@NM00079 EQU   AVTBIT4                                                  02421000
@NM00078 EQU   AVTBIT4                                                  02422000
@NM00077 EQU   AVTBIT4                                                  02423000
@NM00076 EQU   AVTBIT4                                                  02424000
AVTRUFTN EQU   AVTBIT4                                                  02425000
@NM00075 EQU   IEDQAVTD+1060                                            02426000
AVTNOBFQ EQU   IEDQAVTD+1056                                            02427000
@NM00074 EQU   IEDQAVTD+1052                                            02428000
AVTDKENQ EQU   IEDQAVTD+1048                                            02429000
@NM00073 EQU   IEDQAVTD+1044                                            02430000
AVTDKAPQ EQU   IEDQAVTD+1040                                            02431000
AVTCOPY  EQU   IEDQAVTD+1036                                            02432000
AVTIA    EQU   IEDQAVTD+1032                                            02433000
AVTFL    EQU   IEDQAVTD+1028                                            02434000
@NM00072 EQU   IEDQAVTD+1024                                            02435000
AVTNCPBQ EQU   IEDQAVTD+1020                                            02436000
AVTTOTNC EQU   IEDQAVTD+1016                                            02437000
AVTCMAX  EQU   IEDQAVTD+1012                                            02438000
AVTCMIN  EQU   IEDQAVTD+1008                                            02439000
AVTHM02  EQU   IEDQAVTD+1004                                            02440000
AVTOPCIN EQU   IEDQAVTD+1002                                            02441000
AVTDCTLN EQU   IEDQAVTD+1000                                            02442000
AVTOPMSK EQU   IEDQAVTD+996                                             02443000
AVTDDFT  EQU   IEDQAVTD+992                                             02444000
AVTOPTN  EQU   IEDQAVTD+984                                             02445000
AVTDSKCT EQU   IEDQAVTD+982                                             02446000
AVTCKRST EQU   IEDQAVTD+981                                             02447000
AVTSTAN  EQU   AVTBIT3                                                  02448000
AVTSTACN EQU   AVTBIT3                                                  02449000
AVTSTAIN EQU   AVTBIT3                                                  02450000
AVTSTAYN EQU   AVTBIT3                                                  02451000
AVTOLTBN EQU   AVTBIT3                                                  02452000
AVTTSAB  EQU   AVTBIT3                                                  02453000
AVTRFULN EQU   AVTBIT3                                                  02454000
AVTRECVN EQU   AVTBIT3                                                  02455000
@NM00071 EQU   AVTBIT2                                                  02456000
@NM00070 EQU   AVTBIT2                                                  02457000
AVTOPEIN EQU   AVTBIT2                                                  02458000
AVTSTRTN EQU   AVTBIT2                                                  02459000
AVTTOPOL EQU   AVTBIT2                                                  02460000
AVTCOPYN EQU   AVTBIT2                                                  02461000
AVTREUSN EQU   AVTBIT2                                                  02462000
AVTEXTSC EQU   AVTBIT2                                                  02463000
AVTDISKN EQU   AVTBIT1                                                  02464000
AVTQUCKN EQU   AVTBIT1                                                  02465000
AVTCLOSN EQU   AVTBIT1                                                  02466000
AVTREADN EQU   AVTBIT1                                                  02467000
AVTDLAYN EQU   AVTBIT1                                                  02468000
AVTAQTAN EQU   AVTBIT1                                                  02469000
AVTTSON  EQU   AVTBIT1                                                  02470000
AVTAPLKN EQU   AVTBIT1                                                  02471000
AVTDUMBR EQU   IEDQAVTD+976                                             02472000
AVTDLQX  EQU   IEDQAVTD+974                                             02473000
AVTINTLV EQU   IEDQAVTD+972                                             02474000
AVTSMCNT EQU   IEDQAVTD+970                                             02475000
AVTAVFCT EQU   IEDQAVTD+968                                             02476000
AVTOPCON EQU   IEDQAVTD+966                                             02477000
AVTOPCNT EQU   IEDQAVTD+964                                             02478000
AVTLNCNT EQU   IEDQAVTD+962                                             02479000
AVTKEYLE EQU   IEDQAVTD+960                                             02480000
AVTHA16  EQU   IEDQAVTD+958                                             02481000
AVTHA7   EQU   IEDQAVTD+956                                             02482000
AVTHA4   EQU   IEDQAVTD+954                                             02483000
AVTHA3   EQU   IEDQAVTD+952                                             02484000
AVTHA2   EQU   IEDQAVTD+950                                             02485000
AVTGETMS EQU   IEDQAVTD+949                                             02486000
@NM00069 EQU   IEDQAVTD+948                                             02487000
AVTGETMD EQU   IEDQAVTD+944                                             02488000
AVTGETMN EQU   IEDQAVTD+940                                             02489000
AVTCWTOT EQU   IEDQAVTD+936                                             02490000
AVTCWINT EQU   IEDQAVTD+884                                             02491000
AVTDTRAP EQU   IEDQAVTD+880                                             02492000
@NM00068 EQU   IEDQAVTD+878                                             02493000
@NM00067 EQU   AVTIOTR                                                  02494000
AVTIOTRH EQU   AVTIOTR                                                  02495000
AVTIOTRE EQU   AVTIOTR                                                  02496000
@NM00066 EQU   AVTSUBT                                                  02497000
AVTSUBPT EQU   AVTSUBT                                                  02498000
AVTSUBON EQU   AVTSUBT                                                  02499000
AVTAFE30 EQU   IEDQAVTD+872                                             02500000
AVTAFE20 EQU   IEDQAVTD+868                                             02501000
AVTAFE10 EQU   IEDQAVTD+864                                             02502000
AVTCWEC2 EQU   IEDQAVTD+860                                             02503000
AVTCWPM2 EQU   IEDQAVTD+856                                             02504000
AVTCWTS2 EQU   IEDQAVTD+855                                             02505000
AVTCWTS1 EQU   IEDQAVTD+854                                             02506000
AVTCWCLD EQU   AVTCWFL2                                                 02507000
AVTCWRAP EQU   AVTCWFL2                                                 02508000
@NM00065 EQU   AVTCWFL2                                                 02509000
@NM00064 EQU   AVTCWFL2                                                 02510000
@NM00063 EQU   AVTCWFL2                                                 02511000
@NM00062 EQU   AVTCWFL2                                                 02512000
@NM00061 EQU   AVTCWFL2                                                 02513000
AVTCWACT EQU   AVTCWFL2                                                 02514000
@NM00060 EQU   AVTCWFL1                                                 02515000
@NM00059 EQU   AVTCWFL1                                                 02516000
@NM00058 EQU   AVTCWFL1                                                 02517000
@NM00057 EQU   AVTCWFL1                                                 02518000
@NM00056 EQU   AVTCWFL1                                                 02519000
@NM00055 EQU   AVTCWFL1                                                 02520000
@NM00054 EQU   AVTCWFL1                                                 02521000
AVTCOMWN EQU   AVTCWFL1                                                 02522000
AVTCWEC1 EQU   IEDQAVTD+848                                             02523000
AVTCWPM1 EQU   IEDQAVTD+844                                             02524000
AVTCAREA EQU   IEDQAVTD+840                                             02525000
AVTFZERO EQU   IEDQAVTD+836                                             02526000
AVTCADDR EQU   IEDQAVTD+832                                             02527000
AVTCOREC EQU   IEDQAVTD+828                                             02528000
@NM00053 EQU   IEDQAVTD+820                                             02529000
AVTCPBCB EQU   IEDQAVTD+816                                             02530000
@NM00052 EQU   IEDQAVTD+808                                             02531000
AVTDSIOB EQU   IEDQAVTD+804                                             02532000
@NM00051 EQU   IEDQAVTD+796                                             02533000
AVTCPRMB EQU   IEDQAVTD+792                                             02534000
@NM00050 EQU   IEDQAVTD+784                                             02535000
AVTCLOSB EQU   IEDQAVTD+780                                             02536000
@NM00049 EQU   IEDQAVTD+772                                             02537000
AVTACTIB EQU   IEDQAVTD+768                                             02538000
@NM00048 EQU   IEDQAVTD+764                                             02539000
AVTOLTEB EQU   IEDQAVTD+760                                             02540000
AVTOLTCH EQU   AVTOLTQB+1                                               02541000
AVTOLTVT EQU   AVTOLTQB                                                 02542000
@NM00047 EQU   AVTOPCQB+8                                               02543000
@NM00046 EQU   AVTOPCEC+1                                               02544000
@NM00045 EQU   AVTOPCCC                                                 02545000
AVTOPCPO EQU   AVTOPCCC                                                 02546000
AVTOPCWA EQU   AVTOPCCC                                                 02547000
AVTOPCCH EQU   AVTOPCOB+1                                               02548000
AVTOPCVT EQU   AVTOPCOB                                                 02549000
@NM00044 EQU   AVTCKPQB+9                                               02550000
AVTCKPTS EQU   AVTCKPQB+8                                               02551000
@NM00043 EQU   AVTCKPEC+1                                               02552000
@NM00042 EQU   AVTCKPCC                                                 02553000
AVTCKPPO EQU   AVTCKPCC                                                 02554000
AVTCKPWA EQU   AVTCKPCC                                                 02555000
AVTCKPCH EQU   AVTCKPTB+1                                               02556000
AVTCKPVT EQU   AVTCKPTB                                                 02557000
@NM00041 EQU   IEDQAVTD+724                                             02558000
AVTBFRTB EQU   IEDQAVTD+720                                             02559000
@NM00040 EQU   IEDQAVTD+716                                             02560000
AVTSELCH EQU   IEDQAVTD+713                                             02561000
AVTBFRTN EQU   AVTBFRFG                                                 02562000
AVTTIMQ  EQU   IEDQAVTD+704                                             02563000
@NM00039 EQU   IEDQAVTD+700                                             02564000
AVTIMQPS EQU   IEDQAVTD+696                                             02565000
AVTINOUT EQU   IEDQAVTD+694                                             02566000
AVTREFTM EQU   IEDQAVTD+692                                             02567000
@NM00038 EQU   IEDQAVTD+680                                             02568000
AVTDELYB EQU   IEDQAVTD+676                                             02569000
AVTOCQPT EQU   IEDQAVTD+672                                             02570000
AVTTSOPT EQU   IEDQAVTD+668                                             02571000
AVTSUPPT EQU   IEDQAVTD+664                                             02572000
AVTCBQCB EQU   IEDQAVTD+660                                             02573000
@NM00037 EQU   AVTSYSER                                                 02574000
@NM00036 EQU   AVTSYSER                                                 02575000
@NM00035 EQU   AVTSYSER                                                 02576000
@NM00034 EQU   AVTSYSER                                                 02577000
@NM00033 EQU   AVTSYSER                                                 02578000
@NM00032 EQU   AVTSYSER                                                 02579000
AVTCMAXN EQU   AVTSYSER                                                 02580000
AVTCMINN EQU   AVTSYSER                                                 02581000
AVT2260L EQU   IEDQAVTD+652                                             02582000
AVTABEPL EQU   AVTADBUF                                                 02583000
AVTHFF   EQU   AVTCLRHI+2                                               02584000
@NM00031 EQU   AVTCLRHI                                                 02585000
AVTCCLNK EQU   AVTCRELE+5                                               02586000
AVTCCPRI EQU   AVTCRELE+4                                               02587000
AVTCCQCB EQU   AVTCCELE+1                                               02588000
AVTCCKEY EQU   AVTCCELE                                                 02589000
AVTDELAD EQU   IEDQAVTD+632                                             02590000
AVTDELEM EQU   IEDQAVTD+628                                             02591000
AVTBSX   EQU   AVTCKLNK                                                 02592000
AVTOPETR EQU   AVTHG01                                                  02593000
@NM00030 EQU   AVTCKBYT                                                 02594000
AVTCKONQ EQU   AVTCKBYT                                                 02595000
@NM00029 EQU   AVTCKBYT                                                 02596000
@NM00028 EQU   AVTCKBYT                                                 02597000
@NM00027 EQU   AVTCKBYT                                                 02598000
@NM00026 EQU   AVTCKBYT                                                 02599000
@NM00025 EQU   AVTCKBYT                                                 02600000
@NM00024 EQU   AVTCKBYT                                                 02601000
AVTOPERT EQU   IEDQAVTD+618                                             02602000
AVTOPXCL EQU   IEDQAVTD+616                                             02603000
AVTOPERL EQU   IEDQAVTD+615                                             02604000
@NM00023 EQU   IEDQAVTD+614                                             02605000
AVTCKTIM EQU   IEDQAVTD+612                                             02606000
AVTCKELV EQU   IEDQAVTD+610                                             02607000
AVTCPRCD EQU   IEDQAVTD+609                                             02608000
AVTWARMN EQU   AVTCKELF                                                 02609000
AVTCRTLN EQU   AVTCKELF                                                 02610000
AVTCPIPN EQU   AVTCKELF                                                 02611000
AVTCCLCN EQU   AVTCKELF                                                 02612000
AVTCINCN EQU   AVTCKELF                                                 02613000
@NM00022 EQU   AVTCKELF                                                 02614000
AVTCMCPN EQU   AVTCKELF                                                 02615000
AVTNQBCK EQU   AVTCKELF                                                 02616000
AVTCKQAD EQU   IEDQAVTD+605                                             02617000
AVTSCBSZ EQU   IEDQAVTD+604                                             02618000
@NM00021 EQU   IEDQAVTD+600                                             02619000
AVTCKELE EQU   IEDQAVTD+596                                             02620000
@NM00020 EQU   AVTCKPEL+8                                               02621000
AVTCKRLK EQU   AVTCKPEL+5                                               02622000
AVTCKRPR EQU   AVTCKPEL+4                                               02623000
AVTCKRMQ EQU   AVTCKRMV+1                                               02624000
AVTCKRKY EQU   AVTCKRMV                                                 02625000
AVTHK    EQU   IEDQAVTD+576                                             02626000
AVTHI    EQU   IEDQAVTD+572                                             02627000
AVTIOT   EQU   IEDQAVTD+568                                             02628000
AVTNX    EQU   IEDQAVTD+564                                             02629000
AVTTONE  EQU   IEDQAVTD+560                                             02630000
AVTA3TL  EQU   IEDQAVTD+556                                             02631000
AVTDMECB EQU   IEDQAVTD+552                                             02632000
AVTABEND EQU   IEDQAVTD+546                                             02633000
AVTPLCBN EQU   IEDQAVTD+544                                             02634000
@NM00019 EQU   AVTSAVTP+1                                               02635000
@NM00018 EQU   AVTSAVTF                                                 02636000
AVTSNA   EQU   AVTSAVTF                                                 02637000
AVTONSNA EQU   AVTSAVTF                                                 02638000
AVTVTMCP EQU   AVTSAVTF                                                 02639000
@NM00017 EQU   IEDQAVTD+536                                             02640000
AVTCMBSS EQU   IEDQAVTD+532                                             02641000
AVTRCV   EQU   IEDQAVTD+528                                             02642000
AVTSEND  EQU   IEDQAVTD+524                                             02643000
AVTCSCH  EQU   IEDQAVTD+520                                             02644000
AVTQ1    EQU   IEDQAVTD+516                                             02645000
AVTE7    EQU   IEDQAVTD+512                                             02646000
AVTHB    EQU   IEDQAVTD+508                                             02647000
AVTR1    EQU   IEDQAVTD+504                                             02648000
AVTBZ    EQU   IEDQAVTD+500                                             02649000
AVTEZ    EQU   IEDQAVTD+496                                             02650000
AVTEC    EQU   IEDQAVTD+492                                             02651000
AVTEW    EQU   IEDQAVTD+488                                             02652000
AVTNDIAL EQU   AVTSCOPT                                                 02653000
AVTN2741 EQU   AVTSCOPT                                                 02654000
AVTCONCO EQU   AVTSCOPT                                                 02655000
AVTCONC  EQU   AVTSCOPT                                                 02656000
AVTCMBUF EQU   AVTSCOPT                                                 02657000
AVTAPDMP EQU   AVTSCOPT                                                 02658000
@NM00016 EQU   AVTSCOPT                                                 02659000
AVTHA    EQU   AVTDISP                                                  02660000
AVTAX    EQU   IEDQAVTD+472                                             02661000
AVTA3    EQU   IEDQAVTD+468                                             02662000
AVTGD    EQU   IEDQAVTD+464                                             02663000
AVTAL    EQU   IEDQAVTD+460                                             02664000
AVTOLTST EQU   AVTHG02                                                  02665000
AVTE8    EQU   IEDQAVTD+452                                             02666000
AVTCOMPT EQU   IEDQAVTD+444                                             02667000
AVTCRSRF EQU   IEDQAVTD+440                                             02668000
@NM00015 EQU   IEDQAVTD+436                                             02669000
AVTKA02  EQU   IEDQAVTD+432                                             02670000
AVTOPTPT EQU   IEDQAVTD+428                                             02671000
AVTPCBPT EQU   IEDQAVTD+424                                             02672000
@NM00014 EQU   AVTECB1                                                  02673000
AVTCOMP  EQU   AVTECB1                                                  02674000
@NM00013 EQU   AVTECB1                                                  02675000
AVTOPECA EQU   IEDQAVTD+416                                             02676000
AVTOLECA EQU   IEDQAVTD+412                                             02677000
AVTCKECA EQU   IEDQAVTD+408                                             02678000
AVTCWECA EQU   IEDQAVTD+404                                             02679000
AVTCWTCB EQU   IEDQAVTD+400                                             02680000
AVTOLTCB EQU   IEDQAVTD+396                                             02681000
AVTOCTCB EQU   IEDQAVTD+392                                             02682000
AVTCKTCB EQU   IEDQAVTD+388                                             02683000
AVTAS    EQU   IEDQAVTD+384                                             02684000
AVTNOLBF EQU   IEDQAVTD+382                                             02685000
AVTNCKPR EQU   IEDQAVTD+381                                             02686000
AVTCIB   EQU   IEDQAVTD+380                                             02687000
AVTSPLPT EQU   IEDQAVTD+376                                             02688000
AVTMVBFR EQU   IEDQAVTD+372                                             02689000
AVTSBTA  EQU   IEDQAVTD+368                                             02690000
AVTRARTN EQU   IEDQAVTD+364                                             02691000
AVTBSCAN EQU   IEDQAVTD+360                                             02692000
AVTRDYA  EQU   IEDQAVTD+356                                             02693000
AVTDISTR EQU   IEDQAVTD+348                                             02694000
AVTPARM3 EQU   IEDQAVTD+344                                             02695000
@NM00012 EQU   AVTPKF                                                   02696000
@NM00011 EQU   AVTPKF                                                   02697000
@NM00010 EQU   AVTPKF                                                   02698000
AVTFTCHF EQU   AVTPKF                                                   02699000
@NM00009 EQU   AVTPKF                                                   02700000
@NM00008 EQU   AVTPKF                                                   02701000
@NM00007 EQU   AVTPKF                                                   02702000
@NM00006 EQU   AVTPKF                                                   02703000
AVTPARM  EQU   IEDQAVTD+336                                             02704000
AVTEXS2A EQU   IEDQAVTD+330                                             02705000
AVTEXA2S EQU   IEDQAVTD+324                                             02706000
AVTOCGET EQU   IEDQAVTD+320                                             02707000
AVTCKAVT EQU   @NM00004+1                                               02708000
@NM00005 EQU   AVTCKFLG                                                 02709000
AVTCKHLT EQU   AVTCKFLG                                                 02710000
AVTCKREQ EQU   AVTCKFLG                                                 02711000
AVTCKENV EQU   AVTCKFLG                                                 02712000
AVTCKNAC EQU   AVTCKFLG                                                 02713000
AVTCKTAC EQU   AVTCKFLG                                                 02714000
AVTBUENT EQU   IEDQAVTD+314                                             02715000
@NM00003 EQU   IEDQAVTD+313                                             02716000
AVTFULLT EQU   AVTBUFSW                                                 02717000
AVTUNCON EQU   AVTBUFSW                                                 02718000
@NM00002 EQU   AVTBUFSW                                                 02719000
AVTBUFTR EQU   AVTREADD                                                 02720000
AVTREADY EQU   IEDQAVTD+304                                             02721000
AVTRACE  EQU   IEDQAVTD+300                                             02722000
AVTTCB   EQU   IEDQAVTD+296                                             02723000
AVTPASWD EQU   IEDQAVTD+288                                             02724000
AVTCTLCH EQU   IEDQAVTD+280                                             02725000
AVTDOUBL EQU   IEDQAVTD+272                                             02726000
AVTDOUBX EQU   IEDQAVTD+264                                             02727000
AVTDPARM EQU   IEDQAVTD+260                                             02728000
AVTCSTCS EQU   IEDQAVTD+256                                             02729000
AVTDLQ   EQU   AVTSAVEX+32                                              02730000
@NM00001 EQU   AVTSAVEX                                                 02731000
AVTSAVE3 EQU   IEDQAVTD+72                                              02732000
AVTSAVE2 EQU   IEDQAVTD                                                 02733000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02734000
@RF00515 EQU   @EL00003                                                 02735000
@RC00520 EQU   @EL00003                                                 02736000
@RC00535 EQU   @EL00003                                                 02737000
@RC00593 EQU   @RC00591                                                 02738000
@RF00644 EQU   @RC00591                                                 02739000
@RC00678 EQU   @EL00006                                                 02740000
@RF00684 EQU   @EL00006                                                 02741000
@RC00694 EQU   @EL00007                                                 02742000
@RC00756 EQU   @EL00009                                                 02743000
@RC00789 EQU   @EL00009                                                 02744000
@RC00806 EQU   @EL00009                                                 02745000
@RF00820 EQU   @EL00010                                                 02746000
@RC00825 EQU   @EL00011                                                 02747000
@RF00836 EQU   @EL00011                                                 02748000
@RF00846 EQU   @EL00012                                                 02749000
@PB00012 EQU   @EL00001                                                 02750000
@RF00597 EQU   @RC00593                                                 02751000
@RF00600 EQU   @RC00593                                                 02752000
@RC00605 EQU   @RC00593                                                 02753000
@RF00624 EQU   @RC00593                                                 02754000
@RC00696 EQU   @RC00694                                                 02755000
@RC00761 EQU   @RC00756                                                 02756000
@RC00778 EQU   @RC00756                                                 02757000
@RC00791 EQU   @RC00789                                                 02758000
@PB00011 EQU   @PB00012                                                 02759000
@RF00607 EQU   @RC00605                                                 02760000
@RF00700 EQU   @RC00696                                                 02761000
@RC00704 EQU   @RC00696                                                 02762000
@RF00711 EQU   @RC00696                                                 02763000
@RC00763 EQU   @RC00761                                                 02764000
@RC00793 EQU   @RC00791                                                 02765000
@PB00010 EQU   @PB00011                                                 02766000
@RC00765 EQU   @RC00763                                                 02767000
@PB00009 EQU   @PB00010                                                 02768000
@PB00008 EQU   @PB00009                                                 02769000
@PB00007 EQU   @PB00008                                                 02770000
@PB00006 EQU   @PB00007                                                 02771000
@PB00005 EQU   @PB00006                                                 02772000
@PB00004 EQU   @PB00005                                                 02773000
@PB00003 EQU   @PB00004                                                 02774000
@PB00002 EQU   @PB00003                                                 02775000
@ENDDATA EQU   *                                                        02776000
         END   IEDQRS,(C'PLS0742',0701,78129)                           02777000
./  ADD  SSI=63630053,NAME=IEDQSBT
         TITLE 'IEDQSBT, OP CTL SET BIT ROUTINE                        *00001000
                        '                                               00002000
IEDQSBT  CSECT ,                                                   0001 00003000
@PROLOG  DS    0H                                                  0002 00004000
*                                                                  0155 00005000
         DC    A(0)                     QCB                             00006000
         DC    A(0)                     QCB                             00007000
         DC    X'06'                    STCB                            00008000
         DC    AL3(*-1)                 STCB ADDRESS                    00009000
         USING *,RBASE                  SET ADDRESSABILITY              00010000
         LR    RBASE,RLINK              SET BASE REGISTER               00011000
IEDQSBT  IEDHJN START,HJN                                               00012000
*/*                  START OF LOGIC                                  */ 00013000
*                                                                  0156 00014000
*   IEDQSBTR=RPARM;                 /* SET BASE FOR TSBT DSECT       */ 00015000
         LR    IEDQSBTR,RPARM                                      0156 00016000
*   IF SBTOI='1'B THEN              /* IF OR FUNCTION REQUESTED      */ 00017000
         TM    SBTOI(IEDQSBTR),B'00100000'                         0157 00018000
         BNO   @RF00157                                            0157 00019000
*     TARGBYTE=TARGBYTE|SBTDATA;    /* OR TARGET WITH DATA           */ 00020000
         L     @10,SBTADDR-1(,IEDQSBTR)                            0158 00021000
         OC    TARGBYTE(1,@10),SBTDATA(IEDQSBTR)                   0158 00022000
*   IF SBTNI='1'B THEN              /* IF AND FUNCTION REQUESTED     */ 00023000
@RF00157 TM    SBTNI(IEDQSBTR),B'00010000'                         0159 00024000
         BNO   @RF00159                                            0159 00025000
*     TARGBYTE=TARGBYTE&SBTDATA;    /* AND TARGET WITH DATA          */ 00026000
         L     @10,SBTADDR-1(,IEDQSBTR)                            0160 00027000
         NC    TARGBYTE(1,@10),SBTDATA(IEDQSBTR)                   0160 00028000
*   IF SBTECBN='1'B THEN            /* IF ECB POST REQUESTED         */ 00029000
@RF00159 TM    SBTECBN(IEDQSBTR),B'10000000'                       0161 00030000
         BNO   @RF00161                                            0161 00031000
*     DO;                                                          0162 00032000
*       RPARM=ADDR(SBTECB);         /* SET REG FOR POST              */ 00033000
         LA    RPARM,SBTECB(,IEDQSBTR)                             0163 00034000
*       GEN REFS(RPARM) NOFLOWS;                                   0164 00035000
         POST  (1)                      POST ECB COMPLETE               00036000
*     END;                                                         0165 00037000
*   IF SBTBFRTN='1'B THEN           /* IF BFR RETURN REQUESTED       */ 00038000
@RF00161 TM    SBTBFRTN(IEDQSBTR),B'01000000'                      0166 00039000
         BNO   @RF00166                                            0166 00040000
*     DO;                                                          0167 00041000
*       SBTQCBA=ADDR(AVTBFRTB);     /* SET QCB TO BUFFER RETURN      */ 00042000
         LA    @10,AVTBFRTB(,IEDQAPTR)                             0168 00043000
         STCM  @10,7,SBTQCBA(IEDQSBTR)                             0168 00044000
*       SBTDATA=1;                  /* SET UNIT COUNT TO ONE         */ 00045000
         MVI   SBTDATA(IEDQSBTR),X'01'                             0169 00046000
*       SBTPRI=PRIBFRTB;            /* SET BUFFER RETURN PRIORITY    */ 00047000
         MVI   SBTPRI(IEDQSBTR),X'E0'                              0170 00048000
*       RPARM=IEDQSBTR;             /* SET BUFFER ADDRESS IN REG1    */ 00049000
         LR    RPARM,IEDQSBTR                                      0171 00050000
*       CALL DSPPOSTR;              /* POST BUFFER TO BFR RETURN     */ 00051000
         LA    @15,DSPPOSTR(,RDISP)                                0172 00052000
         BALR  @14,@15                                             0172 00053000
*     END;                                                         0173 00054000
*   CALL DSPDISP;                   /* EXIT TO DISPATCHER            */ 00055000
@RF00166 LA    @15,DSPDISP(,RDISP)                                 0174 00056000
         BALR  @14,@15                                             0174 00057000
*   END IEDQSBT                                                    0175 00058000
*                                                                  0175 00059000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00060000
*/*%INCLUDE SYSLIB  (TAVTD   )                                       */ 00061000
*/*%INCLUDE SYSLIB  (TDISPD  )                                       */ 00062000
*/*%INCLUDE SYSLIB  (TPRIOR  )                                       */ 00063000
*/*%INCLUDE SYSLIB  (TSBTD   )                                       */ 00064000
*                                                                  0175 00065000
*       ;                                                          0175 00066000
@DATA    DS    0H                                                       00067000
         DS    0F                                                       00068000
         DS    0F                                                       00069000
         DS    0D                                                       00070000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00071000
@01      EQU   01                                                       00072000
@02      EQU   02                                                       00073000
@03      EQU   03                                                       00074000
@04      EQU   04                                                       00075000
@05      EQU   05                                                       00076000
@06      EQU   06                                                       00077000
@07      EQU   07                                                       00078000
@08      EQU   08                                                       00079000
@09      EQU   09                                                       00080000
@10      EQU   10                                                       00081000
@11      EQU   11                                                       00082000
@12      EQU   12                                                       00083000
@13      EQU   13                                                       00084000
@14      EQU   14                                                       00085000
@15      EQU   15                                                       00086000
IEDQAPTR EQU   @13                                                      00087000
RDISP    EQU   @11                                                      00088000
IEDQSBTR EQU   @05                                                      00089000
RPARM    EQU   @01                                                      00090000
RBASE    EQU   @12                                                      00091000
RLINK    EQU   @15                                                      00092000
IEDQAVTD EQU   0                                                        00093000
AVTSAVEX EQU   IEDQAVTD+216                                             00094000
@NM00003 EQU   IEDQAVTD+316                                             00095000
AVTCKFLG EQU   @NM00003                                                 00096000
AVTBASE  EQU   IEDQAVTD+340                                             00097000
AVTPKF   EQU   AVTBASE                                                  00098000
AVTHG02  EQU   IEDQAVTD+456                                             00099000
AVTDISP  EQU   IEDQAVTD+480                                             00100000
AVTHD    EQU   IEDQAVTD+484                                             00101000
AVTSCOPT EQU   AVTHD                                                    00102000
AVTSAVTP EQU   IEDQAVTD+540                                             00103000
AVTSAVTF EQU   AVTSAVTP                                                 00104000
AVTCKPEL EQU   IEDQAVTD+580                                             00105000
AVTCKRMV EQU   AVTCKPEL                                                 00106000
AVTCKELF EQU   IEDQAVTD+608                                             00107000
AVTCKBYT EQU   IEDQAVTD+619                                             00108000
AVTHG01  EQU   IEDQAVTD+620                                             00109000
AVTCKLNK EQU   IEDQAVTD+624                                             00110000
AVTCRELE EQU   IEDQAVTD+636                                             00111000
AVTCCELE EQU   AVTCRELE                                                 00112000
AVTCLRHI EQU   IEDQAVTD+644                                             00113000
AVTADBUF EQU   IEDQAVTD+648                                             00114000
AVTSYSER EQU   IEDQAVTD+656                                             00115000
AVTBFRTB EQU   IEDQAVTD+720                                             00116000
AVTCKPQB EQU   IEDQAVTD+732                                             00117000
AVTCKPTB EQU   AVTCKPQB                                                 00118000
AVTCKPEC EQU   AVTCKPQB+4                                               00119000
AVTCKPCC EQU   AVTCKPEC                                                 00120000
AVTOPCQB EQU   IEDQAVTD+744                                             00121000
AVTOPCOB EQU   AVTOPCQB                                                 00122000
AVTOPCEC EQU   AVTOPCQB+4                                               00123000
AVTOPCCC EQU   AVTOPCEC                                                 00124000
AVTOLTQB EQU   IEDQAVTD+756                                             00125000
AVTCWFL1 EQU   IEDQAVTD+852                                             00126000
AVTCWFL2 EQU   IEDQAVTD+853                                             00127000
AVTSUBT  EQU   IEDQAVTD+876                                             00128000
AVTIOTR  EQU   IEDQAVTD+877                                             00129000
AVTBIT1  EQU   IEDQAVTD+978                                             00130000
AVTBIT2  EQU   IEDQAVTD+979                                             00131000
AVTBIT3  EQU   IEDQAVTD+980                                             00132000
AVTBIT4  EQU   IEDQAVTD+1064                                            00133000
@NM00083 EQU   IEDQAVTD+1160                                            00134000
IEDNSVTD EQU   0                                                        00135000
SAVTDIAG EQU   IEDNSVTD                                                 00136000
SAVTDIAF EQU   SAVTDIAG                                                 00137000
SAVTLUSQ EQU   IEDNSVTD+88                                              00138000
SAVTTCPU EQU   IEDNSVTD+238                                             00139000
SAVTZELM EQU   IEDNSVTD+270                                             00140000
SAVTRDRV EQU   IEDNSVTD+284                                             00141000
SAVTCKQB EQU   IEDNSVTD+300                                             00142000
SAVTCKTB EQU   SAVTCKQB                                                 00143000
SAVTCKEC EQU   SAVTCKQB+4                                               00144000
SAVTCKCC EQU   SAVTCKEC                                                 00145000
IEDQDISP EQU   0                                                        00146000
DSPDISP  EQU   4                                                        00147000
DSPPOSTR EQU   28                                                       00148000
IEDQSBTD EQU   0                                                        00149000
SBTFLAGS EQU   IEDQSBTD                                                 00150000
SBTECBN  EQU   SBTFLAGS                                                 00151000
SBTBFRTN EQU   SBTFLAGS                                                 00152000
SBTOI    EQU   SBTFLAGS                                                 00153000
SBTNI    EQU   SBTFLAGS                                                 00154000
SBTQCBA  EQU   IEDQSBTD+1                                               00155000
SBTPRI   EQU   IEDQSBTD+4                                               00156000
SBTDATA  EQU   IEDQSBTD+12                                              00157000
SBTADDR  EQU   IEDQSBTD+13                                              00158000
SBTECB   EQU   IEDQSBTD+16                                              00159000
TARGBYTE EQU   0                                                        00160000
DSPBYPAS EQU   20                                                       00161000
DSPCHAIN EQU   12                                                       00162000
DSPLIFO  EQU   56                                                       00163000
DSPLIFOR EQU   60                                                       00164000
DSPLIST  EQU   8                                                        00165000
DSPPOST  EQU   24                                                       00166000
DSPPRIO  EQU   48                                                       00167000
DSPPRIOR EQU   52                                                       00168000
DSPTRACE EQU   64                                                       00169000
DSPTSTQ  EQU   32                                                       00170000
DSPTSTQR EQU   36                                                       00171000
DSPUNAV  EQU   40                                                       00172000
DSPUNAVR EQU   44                                                       00173000
DSPWAIT  EQU   16                                                       00174000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00175000
@NM00104 EQU   IEDQSBTD+8                                               00176000
SBTLINK  EQU   IEDQSBTD+5                                               00177000
@NM00103 EQU   SBTFLAGS                                                 00178000
SAVTBITN EQU   IEDNSVTD+312                                             00179000
@NM00102 EQU   SAVTCKQB+8                                               00180000
@NM00101 EQU   SAVTCKEC+1                                               00181000
@NM00100 EQU   SAVTCKCC                                                 00182000
SAVTCKPO EQU   SAVTCKCC                                                 00183000
SAVTCKWA EQU   SAVTCKCC                                                 00184000
SAVTCKCH EQU   SAVTCKTB+1                                               00185000
SAVTCKVT EQU   SAVTCKTB                                                 00186000
@NM00099 EQU   IEDNSVTD+297                                             00187000
SAVTRDFG EQU   SAVTRDRV+12                                              00188000
@NM00098 EQU   SAVTRDRV+5                                               00189000
SAVTRDPY EQU   SAVTRDRV+4                                               00190000
SAVTRDQB EQU   SAVTRDRV+1                                               00191000
SAVTRDKY EQU   SAVTRDRV                                                 00192000
SAVTNID  EQU   IEDNSVTD+280                                             00193000
SAVTDVAS EQU   IEDNSVTD+276                                             00194000
SAVTPLSZ EQU   IEDNSVTD+274                                             00195000
@NM00097 EQU   IEDNSVTD+273                                             00196000
SAVTSUBL EQU   IEDNSVTD+272                                             00197000
@NM00096 EQU   SAVTZELM+1                                               00198000
SAVTSUBM EQU   SAVTZELM                                                 00199000
SAVTMHDX EQU   IEDNSVTD+268                                             00200000
SAVTNAT1 EQU   IEDNSVTD+266                                             00201000
SAVTSH20 EQU   IEDNSVTD+264                                             00202000
SAVTLCBS EQU   IEDNSVTD+260                                             00203000
SAVTRNMP EQU   IEDNSVTD+256                                             00204000
SAVTTNTX EQU   IEDNSVTD+252                                             00205000
SAVTNAX  EQU   IEDNSVTD+248                                             00206000
SAVTSUBV EQU   IEDNSVTD+247                                             00207000
SAVTSUBA EQU   IEDNSVTD+246                                             00208000
SAVTSIBC EQU   IEDNSVTD+244                                             00209000
SAVTBSM  EQU   IEDNSVTD+240                                             00210000
SAVTSCPT EQU   SAVTTCPU                                                 00211000
SAVTRQTG EQU   IEDNSVTD+236                                             00212000
SAVTRQCH EQU   IEDNSVTD+232                                             00213000
SAVTMAND EQU   IEDNSVTD+228                                             00214000
SAVTSPLN EQU   IEDNSVTD+224                                             00215000
SAVTNADL EQU   IEDNSVTD+222                                             00216000
SAVTNATL EQU   IEDNSVTD+220                                             00217000
SAVTMHTB EQU   IEDNSVTD+216                                             00218000
SAVTSSMH EQU   IEDNSVTD+212                                             00219000
SAVTQRS  EQU   IEDNSVTD+208                                             00220000
SAVTRQIN EQU   IEDNSVTD+204                                             00221000
SAVTDFCO EQU   IEDNSVTD+200                                             00222000
SAVTSAO  EQU   IEDNSVTD+196                                             00223000
SAVTSARI EQU   IEDNSVTD+192                                             00224000
SAVTSAC  EQU   IEDNSVTD+188                                             00225000
SAVTSAI  EQU   IEDNSVTD+184                                             00226000
SAVTCSCI EQU   IEDNSVTD+180                                             00227000
SAVTSSRP EQU   IEDNSVTD+176                                             00228000
SAVTSSRQ EQU   IEDNSVTD+172                                             00229000
SAVTSCLU EQU   IEDNSVTD+168                                             00230000
SAVTXTRQ EQU   IEDNSVTD+164                                             00231000
SAVTMVBF EQU   IEDNSVTD+160                                             00232000
@NM00095 EQU   IEDNSVTD+148                                             00233000
SAVTIPCQ EQU   IEDNSVTD+144                                             00234000
@NM00094 EQU   IEDNSVTD+136                                             00235000
SAVTXFMI EQU   IEDNSVTD+132                                             00236000
@NM00093 EQU   IEDNSVTD+124                                             00237000
SAVTXFMO EQU   IEDNSVTD+120                                             00238000
@NM00092 EQU   IEDNSVTD+116                                             00239000
SAVTSSSR EQU   IEDNSVTD+112                                             00240000
SAVTSCPQ EQU   IEDNSVTD+108                                             00241000
SAVTSLCB EQU   IEDNSVTD+104                                             00242000
SAVTLUSR EQU   IEDNSVTD+100                                             00243000
@NM00091 EQU   SAVTLUSQ+8                                               00244000
SAVTLUSP EQU   SAVTLUSQ+4                                               00245000
SAVTLUSB EQU   SAVTLUSQ                                                 00246000
@NM00090 EQU   IEDNSVTD+84                                              00247000
SAVTSAT  EQU   IEDNSVTD+80                                              00248000
SAVTNAT  EQU   IEDNSVTD+76                                              00249000
SAVTCLUP EQU   IEDNSVTD+72                                              00250000
SAVTPIUT EQU   IEDNSVTD+68                                              00251000
SAVTRNTA EQU   IEDNSVTD+64                                              00252000
SAVTDNIR EQU   IEDNSVTD+60                                              00253000
SAVTCNIR EQU   IEDNSVTD+56                                              00254000
SAVTFLDH EQU   IEDNSVTD+52                                              00255000
SAVTSRTN EQU   IEDNSVTD+48                                              00256000
SAVTSREQ EQU   IEDNSVTD+44                                              00257000
SAVTFAIL EQU   IEDNSVTD+42                                              00258000
SAVTSUSE EQU   IEDNSVTD+40                                              00259000
SAVTSIB  EQU   IEDNSVTD+36                                              00260000
SAVTPRTN EQU   IEDNSVTD+32                                              00261000
@NM00089 EQU   IEDNSVTD+28                                              00262000
SAVTWH20 EQU   IEDNSVTD+26                                              00263000
SAVTPWT  EQU   IEDNSVTD+24                                              00264000
SAVTPRTQ EQU   IEDNSVTD+20                                              00265000
SAVTPREQ EQU   IEDNSVTD+16                                              00266000
SAVTPH20 EQU   IEDNSVTD+14                                              00267000
SAVTPUSE EQU   IEDNSVTD+12                                              00268000
SAVTPLCB EQU   IEDNSVTD+8                                               00269000
SAVTPOOL EQU   IEDNSVTD+4                                               00270000
SAVTPRMT EQU   SAVTDIAF                                                 00271000
SAVTVIRT EQU   SAVTDIAF                                                 00272000
AVTCPBNO EQU   IEDQAVTD+1172                                            00273000
AVTHRESS EQU   IEDQAVTD+1171                                            00274000
@NM00088 EQU   IEDQAVTD+1170                                            00275000
@NM00087 EQU   IEDQAVTD+1169                                            00276000
@NM00086 EQU   IEDQAVTD+1168                                            00277000
@NM00085 EQU   IEDQAVTD+1165                                            00278000
@NM00084 EQU   IEDQAVTD+1164                                            00279000
AVTHRESE EQU   @NM00083                                                 00280000
AVTRADDR EQU   IEDQAVTD+1156                                            00281000
AVTNADDR EQU   IEDQAVTD+1152                                            00282000
AVTHRESN EQU   IEDQAVTD+1148                                            00283000
AVTVOLRN EQU   IEDQAVTD+1144                                            00284000
AVTTOTNN EQU   IEDQAVTD+1140                                            00285000
AVTTRCYN EQU   IEDQAVTD+1136                                            00286000
AVTRCTRN EQU   IEDQAVTD+1132                                            00287000
AVTNOVON EQU   IEDQAVTD+1128                                            00288000
AVTADEBN EQU   IEDQAVTD+1124                                            00289000
AVTVOLRR EQU   IEDQAVTD+1120                                            00290000
AVTTOTNR EQU   IEDQAVTD+1116                                            00291000
AVTTRCYR EQU   IEDQAVTD+1112                                            00292000
AVTRCTRR EQU   IEDQAVTD+1108                                            00293000
AVTNOVOR EQU   IEDQAVTD+1104                                            00294000
AVTADEBR EQU   IEDQAVTD+1100                                            00295000
AVTLODPT EQU   IEDQAVTD+1096                                            00296000
AVTIOBN  EQU   IEDQAVTD+1092                                            00297000
AVTIOBR  EQU   IEDQAVTD+1088                                            00298000
AVTCPBPT EQU   IEDQAVTD+1084                                            00299000
AVTFCPB  EQU   IEDQAVTD+1080                                            00300000
@NM00082 EQU   IEDQAVTD+1076                                            00301000
AVTINCPQ EQU   IEDQAVTD+1072                                            00302000
@NM00081 EQU   IEDQAVTD+1068                                            00303000
@NM00080 EQU   IEDQAVTD+1065                                            00304000
@NM00079 EQU   AVTBIT4                                                  00305000
@NM00078 EQU   AVTBIT4                                                  00306000
@NM00077 EQU   AVTBIT4                                                  00307000
@NM00076 EQU   AVTBIT4                                                  00308000
@NM00075 EQU   AVTBIT4                                                  00309000
@NM00074 EQU   AVTBIT4                                                  00310000
@NM00073 EQU   AVTBIT4                                                  00311000
AVTRUFTN EQU   AVTBIT4                                                  00312000
@NM00072 EQU   IEDQAVTD+1060                                            00313000
AVTNOBFQ EQU   IEDQAVTD+1056                                            00314000
@NM00071 EQU   IEDQAVTD+1052                                            00315000
AVTDKENQ EQU   IEDQAVTD+1048                                            00316000
@NM00070 EQU   IEDQAVTD+1044                                            00317000
AVTDKAPQ EQU   IEDQAVTD+1040                                            00318000
AVTCOPY  EQU   IEDQAVTD+1036                                            00319000
AVTIA    EQU   IEDQAVTD+1032                                            00320000
AVTFL    EQU   IEDQAVTD+1028                                            00321000
@NM00069 EQU   IEDQAVTD+1024                                            00322000
AVTNCPBQ EQU   IEDQAVTD+1020                                            00323000
AVTTOTNC EQU   IEDQAVTD+1016                                            00324000
AVTCMAX  EQU   IEDQAVTD+1012                                            00325000
AVTCMIN  EQU   IEDQAVTD+1008                                            00326000
AVTHM02  EQU   IEDQAVTD+1004                                            00327000
AVTOPCIN EQU   IEDQAVTD+1002                                            00328000
AVTDCTLN EQU   IEDQAVTD+1000                                            00329000
AVTOPMSK EQU   IEDQAVTD+996                                             00330000
AVTDDFT  EQU   IEDQAVTD+992                                             00331000
AVTSTEAL EQU   IEDQAVTD+988                                             00332000
AVTOPTN  EQU   IEDQAVTD+984                                             00333000
AVTDSKCT EQU   IEDQAVTD+982                                             00334000
AVTCKRST EQU   IEDQAVTD+981                                             00335000
AVTSTAN  EQU   AVTBIT3                                                  00336000
AVTSTACN EQU   AVTBIT3                                                  00337000
AVTSTAIN EQU   AVTBIT3                                                  00338000
AVTSTAYN EQU   AVTBIT3                                                  00339000
AVTOLTBN EQU   AVTBIT3                                                  00340000
AVTTSAB  EQU   AVTBIT3                                                  00341000
AVTRFULN EQU   AVTBIT3                                                  00342000
AVTRECVN EQU   AVTBIT3                                                  00343000
@NM00068 EQU   AVTBIT2                                                  00344000
@NM00067 EQU   AVTBIT2                                                  00345000
AVTOPEIN EQU   AVTBIT2                                                  00346000
AVTSTRTN EQU   AVTBIT2                                                  00347000
AVTTOPOL EQU   AVTBIT2                                                  00348000
AVTCOPYN EQU   AVTBIT2                                                  00349000
AVTREUSN EQU   AVTBIT2                                                  00350000
AVTEXTSC EQU   AVTBIT2                                                  00351000
AVTDISKN EQU   AVTBIT1                                                  00352000
AVTQUCKN EQU   AVTBIT1                                                  00353000
AVTCLOSN EQU   AVTBIT1                                                  00354000
AVTREADN EQU   AVTBIT1                                                  00355000
AVTDLAYN EQU   AVTBIT1                                                  00356000
AVTAQTAN EQU   AVTBIT1                                                  00357000
AVTTSON  EQU   AVTBIT1                                                  00358000
AVTAPLKN EQU   AVTBIT1                                                  00359000
AVTDUMBR EQU   IEDQAVTD+976                                             00360000
AVTDLQX  EQU   IEDQAVTD+974                                             00361000
AVTINTLV EQU   IEDQAVTD+972                                             00362000
AVTSMCNT EQU   IEDQAVTD+970                                             00363000
AVTAVFCT EQU   IEDQAVTD+968                                             00364000
AVTOPCON EQU   IEDQAVTD+966                                             00365000
AVTOPCNT EQU   IEDQAVTD+964                                             00366000
AVTLNCNT EQU   IEDQAVTD+962                                             00367000
AVTKEYLE EQU   IEDQAVTD+960                                             00368000
AVTHA16  EQU   IEDQAVTD+958                                             00369000
AVTHA7   EQU   IEDQAVTD+956                                             00370000
AVTHA4   EQU   IEDQAVTD+954                                             00371000
AVTHA3   EQU   IEDQAVTD+952                                             00372000
AVTHA2   EQU   IEDQAVTD+950                                             00373000
AVTGETMS EQU   IEDQAVTD+949                                             00374000
@NM00066 EQU   IEDQAVTD+948                                             00375000
AVTGETMD EQU   IEDQAVTD+944                                             00376000
AVTGETMN EQU   IEDQAVTD+940                                             00377000
AVTCWTOT EQU   IEDQAVTD+936                                             00378000
AVTCWINT EQU   IEDQAVTD+884                                             00379000
AVTDTRAP EQU   IEDQAVTD+880                                             00380000
@NM00065 EQU   IEDQAVTD+878                                             00381000
@NM00064 EQU   AVTIOTR                                                  00382000
AVTIOTRH EQU   AVTIOTR                                                  00383000
AVTIOTRE EQU   AVTIOTR                                                  00384000
@NM00063 EQU   AVTSUBT                                                  00385000
AVTSUBPT EQU   AVTSUBT                                                  00386000
AVTSUBON EQU   AVTSUBT                                                  00387000
AVTAFE30 EQU   IEDQAVTD+872                                             00388000
AVTAFE20 EQU   IEDQAVTD+868                                             00389000
AVTAFE10 EQU   IEDQAVTD+864                                             00390000
AVTCWEC2 EQU   IEDQAVTD+860                                             00391000
AVTCWPM2 EQU   IEDQAVTD+856                                             00392000
AVTCWTS2 EQU   IEDQAVTD+855                                             00393000
AVTCWTS1 EQU   IEDQAVTD+854                                             00394000
AVTCWCLD EQU   AVTCWFL2                                                 00395000
AVTCWRAP EQU   AVTCWFL2                                                 00396000
@NM00062 EQU   AVTCWFL2                                                 00397000
@NM00061 EQU   AVTCWFL2                                                 00398000
@NM00060 EQU   AVTCWFL2                                                 00399000
@NM00059 EQU   AVTCWFL2                                                 00400000
@NM00058 EQU   AVTCWFL2                                                 00401000
AVTCWACT EQU   AVTCWFL2                                                 00402000
@NM00057 EQU   AVTCWFL1                                                 00403000
@NM00056 EQU   AVTCWFL1                                                 00404000
@NM00055 EQU   AVTCWFL1                                                 00405000
@NM00054 EQU   AVTCWFL1                                                 00406000
@NM00053 EQU   AVTCWFL1                                                 00407000
@NM00052 EQU   AVTCWFL1                                                 00408000
@NM00051 EQU   AVTCWFL1                                                 00409000
AVTCOMWN EQU   AVTCWFL1                                                 00410000
AVTCWEC1 EQU   IEDQAVTD+848                                             00411000
AVTCWPM1 EQU   IEDQAVTD+844                                             00412000
AVTCAREA EQU   IEDQAVTD+840                                             00413000
AVTFZERO EQU   IEDQAVTD+836                                             00414000
AVTCADDR EQU   IEDQAVTD+832                                             00415000
AVTCOREC EQU   IEDQAVTD+828                                             00416000
@NM00050 EQU   IEDQAVTD+820                                             00417000
AVTCPBCB EQU   IEDQAVTD+816                                             00418000
@NM00049 EQU   IEDQAVTD+808                                             00419000
AVTDSIOB EQU   IEDQAVTD+804                                             00420000
@NM00048 EQU   IEDQAVTD+796                                             00421000
AVTCPRMB EQU   IEDQAVTD+792                                             00422000
@NM00047 EQU   IEDQAVTD+784                                             00423000
AVTCLOSB EQU   IEDQAVTD+780                                             00424000
@NM00046 EQU   IEDQAVTD+772                                             00425000
AVTACTIB EQU   IEDQAVTD+768                                             00426000
@NM00045 EQU   IEDQAVTD+764                                             00427000
AVTOLTEB EQU   IEDQAVTD+760                                             00428000
AVTOLTCH EQU   AVTOLTQB+1                                               00429000
AVTOLTVT EQU   AVTOLTQB                                                 00430000
@NM00044 EQU   AVTOPCQB+8                                               00431000
@NM00043 EQU   AVTOPCEC+1                                               00432000
@NM00042 EQU   AVTOPCCC                                                 00433000
AVTOPCPO EQU   AVTOPCCC                                                 00434000
AVTOPCWA EQU   AVTOPCCC                                                 00435000
AVTOPCCH EQU   AVTOPCOB+1                                               00436000
AVTOPCVT EQU   AVTOPCOB                                                 00437000
@NM00041 EQU   AVTCKPQB+9                                               00438000
AVTCKPTS EQU   AVTCKPQB+8                                               00439000
@NM00040 EQU   AVTCKPEC+1                                               00440000
@NM00039 EQU   AVTCKPCC                                                 00441000
AVTCKPPO EQU   AVTCKPCC                                                 00442000
AVTCKPWA EQU   AVTCKPCC                                                 00443000
AVTCKPCH EQU   AVTCKPTB+1                                               00444000
AVTCKPVT EQU   AVTCKPTB                                                 00445000
@NM00038 EQU   IEDQAVTD+724                                             00446000
@NM00037 EQU   IEDQAVTD+712                                             00447000
AVTBFREB EQU   IEDQAVTD+708                                             00448000
AVTTIMQ  EQU   IEDQAVTD+704                                             00449000
@NM00036 EQU   IEDQAVTD+700                                             00450000
AVTIMQPS EQU   IEDQAVTD+696                                             00451000
AVTINOUT EQU   IEDQAVTD+694                                             00452000
AVTREFTM EQU   IEDQAVTD+692                                             00453000
@NM00035 EQU   IEDQAVTD+680                                             00454000
AVTDELYB EQU   IEDQAVTD+676                                             00455000
AVTOCQPT EQU   IEDQAVTD+672                                             00456000
AVTTSOPT EQU   IEDQAVTD+668                                             00457000
AVTSUPPT EQU   IEDQAVTD+664                                             00458000
AVTCBQCB EQU   IEDQAVTD+660                                             00459000
AVTMSGS  EQU   IEDQAVTD+657                                             00460000
@NM00034 EQU   AVTSYSER                                                 00461000
@NM00033 EQU   AVTSYSER                                                 00462000
@NM00032 EQU   AVTSYSER                                                 00463000
@NM00031 EQU   AVTSYSER                                                 00464000
@NM00030 EQU   AVTSYSER                                                 00465000
@NM00029 EQU   AVTSYSER                                                 00466000
AVTCMAXN EQU   AVTSYSER                                                 00467000
AVTCMINN EQU   AVTSYSER                                                 00468000
AVT2260L EQU   IEDQAVTD+652                                             00469000
AVTABEPL EQU   AVTADBUF                                                 00470000
AVTHFF   EQU   AVTCLRHI+2                                               00471000
@NM00028 EQU   AVTCLRHI                                                 00472000
AVTCCLNK EQU   AVTCRELE+5                                               00473000
AVTCCPRI EQU   AVTCRELE+4                                               00474000
AVTCCQCB EQU   AVTCCELE+1                                               00475000
AVTCCKEY EQU   AVTCCELE                                                 00476000
AVTDELAD EQU   IEDQAVTD+632                                             00477000
AVTDELEM EQU   IEDQAVTD+628                                             00478000
AVTBSX   EQU   AVTCKLNK                                                 00479000
AVTOPETR EQU   AVTHG01                                                  00480000
@NM00027 EQU   AVTCKBYT                                                 00481000
AVTCKONQ EQU   AVTCKBYT                                                 00482000
@NM00026 EQU   AVTCKBYT                                                 00483000
@NM00025 EQU   AVTCKBYT                                                 00484000
@NM00024 EQU   AVTCKBYT                                                 00485000
@NM00023 EQU   AVTCKBYT                                                 00486000
@NM00022 EQU   AVTCKBYT                                                 00487000
@NM00021 EQU   AVTCKBYT                                                 00488000
AVTOPERT EQU   IEDQAVTD+618                                             00489000
AVTOPXCL EQU   IEDQAVTD+616                                             00490000
AVTOPERL EQU   IEDQAVTD+615                                             00491000
@NM00020 EQU   IEDQAVTD+614                                             00492000
AVTCKTIM EQU   IEDQAVTD+612                                             00493000
AVTCKELV EQU   IEDQAVTD+610                                             00494000
AVTCPRCD EQU   IEDQAVTD+609                                             00495000
AVTWARMN EQU   AVTCKELF                                                 00496000
AVTCRTLN EQU   AVTCKELF                                                 00497000
AVTCPIPN EQU   AVTCKELF                                                 00498000
AVTCCLCN EQU   AVTCKELF                                                 00499000
AVTCINCN EQU   AVTCKELF                                                 00500000
@NM00019 EQU   AVTCKELF                                                 00501000
AVTCMCPN EQU   AVTCKELF                                                 00502000
AVTCRDYN EQU   AVTCKELF                                                 00503000
AVTCKQAD EQU   IEDQAVTD+605                                             00504000
AVTSCBSZ EQU   IEDQAVTD+604                                             00505000
@NM00018 EQU   IEDQAVTD+600                                             00506000
AVTCKELE EQU   IEDQAVTD+596                                             00507000
@NM00017 EQU   AVTCKPEL+8                                               00508000
AVTCKRLK EQU   AVTCKPEL+5                                               00509000
AVTCKRPR EQU   AVTCKPEL+4                                               00510000
AVTCKRMQ EQU   AVTCKRMV+1                                               00511000
AVTCKRKY EQU   AVTCKRMV                                                 00512000
AVTHK    EQU   IEDQAVTD+576                                             00513000
AVTHI    EQU   IEDQAVTD+572                                             00514000
AVTIOT   EQU   IEDQAVTD+568                                             00515000
AVTNX    EQU   IEDQAVTD+564                                             00516000
AVTTONE  EQU   IEDQAVTD+560                                             00517000
AVTA3TL  EQU   IEDQAVTD+556                                             00518000
AVTDMECB EQU   IEDQAVTD+552                                             00519000
AVTABEND EQU   IEDQAVTD+546                                             00520000
AVTPLCBN EQU   IEDQAVTD+544                                             00521000
@NM00016 EQU   AVTSAVTP+1                                               00522000
@NM00015 EQU   AVTSAVTF                                                 00523000
AVTSNA   EQU   AVTSAVTF                                                 00524000
AVTONSNA EQU   AVTSAVTF                                                 00525000
AVTVTMCP EQU   AVTSAVTF                                                 00526000
@NM00014 EQU   IEDQAVTD+536                                             00527000
AVTCMBSS EQU   IEDQAVTD+532                                             00528000
AVTRCV   EQU   IEDQAVTD+528                                             00529000
AVTSEND  EQU   IEDQAVTD+524                                             00530000
AVTCSCH  EQU   IEDQAVTD+520                                             00531000
AVTQ1    EQU   IEDQAVTD+516                                             00532000
AVTE7    EQU   IEDQAVTD+512                                             00533000
AVTHB    EQU   IEDQAVTD+508                                             00534000
AVTR1    EQU   IEDQAVTD+504                                             00535000
AVTBZ    EQU   IEDQAVTD+500                                             00536000
AVTEZ    EQU   IEDQAVTD+496                                             00537000
AVTEC    EQU   IEDQAVTD+492                                             00538000
AVTEW    EQU   IEDQAVTD+488                                             00539000
AVTNDIAL EQU   AVTSCOPT                                                 00540000
AVTN2741 EQU   AVTSCOPT                                                 00541000
AVTCONCO EQU   AVTSCOPT                                                 00542000
AVTCONC  EQU   AVTSCOPT                                                 00543000
AVTCMBUF EQU   AVTSCOPT                                                 00544000
AVTAPDMP EQU   AVTSCOPT                                                 00545000
@NM00013 EQU   AVTSCOPT                                                 00546000
AVTHA    EQU   AVTDISP                                                  00547000
AVTEA    EQU   IEDQAVTD+476                                             00548000
AVTAX    EQU   IEDQAVTD+472                                             00549000
AVTA3    EQU   IEDQAVTD+468                                             00550000
AVTGD    EQU   IEDQAVTD+464                                             00551000
AVTAL    EQU   IEDQAVTD+460                                             00552000
AVTOLTST EQU   AVTHG02                                                  00553000
AVTE8    EQU   IEDQAVTD+452                                             00554000
AVTUI    EQU   IEDQAVTD+448                                             00555000
AVTCOMPT EQU   IEDQAVTD+444                                             00556000
AVTCRSRF EQU   IEDQAVTD+440                                             00557000
@NM00012 EQU   IEDQAVTD+436                                             00558000
AVTKA02  EQU   IEDQAVTD+432                                             00559000
AVTOPTPT EQU   IEDQAVTD+428                                             00560000
AVTPCBPT EQU   IEDQAVTD+424                                             00561000
AVTOSECB EQU   IEDQAVTD+420                                             00562000
AVTOPECA EQU   IEDQAVTD+416                                             00563000
AVTOLECA EQU   IEDQAVTD+412                                             00564000
AVTCKECA EQU   IEDQAVTD+408                                             00565000
AVTCWECA EQU   IEDQAVTD+404                                             00566000
AVTCWTCB EQU   IEDQAVTD+400                                             00567000
AVTOLTCB EQU   IEDQAVTD+396                                             00568000
AVTOCTCB EQU   IEDQAVTD+392                                             00569000
AVTCKTCB EQU   IEDQAVTD+388                                             00570000
AVTAS    EQU   IEDQAVTD+384                                             00571000
AVTNOLBF EQU   IEDQAVTD+382                                             00572000
AVTNCKPR EQU   IEDQAVTD+381                                             00573000
AVTCIB   EQU   IEDQAVTD+380                                             00574000
AVTSPLPT EQU   IEDQAVTD+376                                             00575000
AVTMVBFR EQU   IEDQAVTD+372                                             00576000
AVTSBTA  EQU   IEDQAVTD+368                                             00577000
AVTRARTN EQU   IEDQAVTD+364                                             00578000
AVTBSCAN EQU   IEDQAVTD+360                                             00579000
AVTRDYA  EQU   IEDQAVTD+356                                             00580000
AVTRNMPT EQU   IEDQAVTD+352                                             00581000
AVTDISTR EQU   IEDQAVTD+348                                             00582000
AVTPARM3 EQU   IEDQAVTD+344                                             00583000
@NM00011 EQU   AVTPKF                                                   00584000
@NM00010 EQU   AVTPKF                                                   00585000
@NM00009 EQU   AVTPKF                                                   00586000
AVTFTCHF EQU   AVTPKF                                                   00587000
@NM00008 EQU   AVTPKF                                                   00588000
@NM00007 EQU   AVTPKF                                                   00589000
@NM00006 EQU   AVTPKF                                                   00590000
@NM00005 EQU   AVTPKF                                                   00591000
AVTPARM  EQU   IEDQAVTD+336                                             00592000
AVTEXS2A EQU   IEDQAVTD+330                                             00593000
AVTEXA2S EQU   IEDQAVTD+324                                             00594000
AVTOCGET EQU   IEDQAVTD+320                                             00595000
AVTCKAVT EQU   @NM00003+1                                               00596000
@NM00004 EQU   AVTCKFLG                                                 00597000
AVTCKHLT EQU   AVTCKFLG                                                 00598000
AVTCKREQ EQU   AVTCKFLG                                                 00599000
AVTCKENV EQU   AVTCKFLG                                                 00600000
AVTCKNAC EQU   AVTCKFLG                                                 00601000
AVTCKTAC EQU   AVTCKFLG                                                 00602000
@NM00002 EQU   IEDQAVTD+312                                             00603000
AVTREADD EQU   IEDQAVTD+308                                             00604000
AVTREADY EQU   IEDQAVTD+304                                             00605000
AVTRACE  EQU   IEDQAVTD+300                                             00606000
AVTTCB   EQU   IEDQAVTD+296                                             00607000
AVTPASWD EQU   IEDQAVTD+288                                             00608000
AVTCTLCH EQU   IEDQAVTD+280                                             00609000
AVTDOUBL EQU   IEDQAVTD+272                                             00610000
AVTDOUBX EQU   IEDQAVTD+264                                             00611000
AVTDPARM EQU   IEDQAVTD+260                                             00612000
AVTCSTCS EQU   IEDQAVTD+256                                             00613000
AVTDLQ   EQU   AVTSAVEX+32                                              00614000
@NM00001 EQU   AVTSAVEX                                                 00615000
AVTSAVE4 EQU   IEDQAVTD+144                                             00616000
AVTSAVE3 EQU   IEDQAVTD+72                                              00617000
AVTSAVE2 EQU   IEDQAVTD                                                 00618000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00619000
@ENDDATA EQU   *                                                        00620000
         END   IEDQSBT,(C'PLS0443',0701,76363)                          00621000
./  ADD  SSI=63630054,NAME=IEDQTL
TL       TITLE 'D E V I C E  D E P E N D E N T  F L D  L O O K U P'     00500010
IEDQTL   CSECT                                                          00600010
*A-000000-999999                                               @Y17XAPG 00700010
*********************************************************************** 01000010
*                                                                     * 01500010
*   MODULE NAME = IEDQTL                                              * 02000010
*                                                                     * 02500010
*   DESCRIPTIVE NAME =  DEVICE DEPENDENT FIELD LOOK UP ROUTINE        * 03000010
*                                                                     * 03500010
*   COPYRIGHT = NONE                                                  * 04000010
*                                                                     * 04500010
*   STATUS = VERSION 10.0                                             * 05000010
*                                                                     * 05500010
*   FUNCTION = THIS SUBROUTINE IS LINKED TO BE TCAM MODULES WHICH     * 06000010
*              NEED TO FIND THE ADDRESS OF A PARTICULAR DEVICE        * 06500010
*              DEPENDENT FIELD OF A GIVEN TERMINAL ENTRY              * 07000010
*                  A MASK AND TTE ADDRESS IS PASSED TO THE ROUTINE    * 07500010
*              THE MASK DESCRIBES WHICH DEVICE DEPENDENT FIELD SHOULD * 08000010
*              SHOULD BE FOUND.  USING THE INPUTTED MASK AND THE      * 08500010
*              TRMDEVFL FIELD WITHIN THE TTE, THE ROUTINE WILL FIND   * 09000010
*              THE ADDRESS TO THE FIRST DEVICE DEPENDENT FIELD AND    * 09500010
*              SKIP OVER ANY DEVICE DEPENDENT FIELDS THAT LIE BEFORE  * 10000010
*              THE REQUESTED FIELD.                                   * 10500010
*   NOTES =                                                           * 11000010
*                                                                     * 11500010
*      DEPENDENCIES = NONE                                            * 12000010
*                                                                     * 12500010
*      RESTRICTIONS = NONE                                            * 13000010
*                                                                     * 13500010
*      REGISTER CONVENTIONS =  SEE DECLARES                           * 14000010
*                                                                     * 14500010
*      PATCH LABEL = NONE                                             * 15000010
*                                                                     * 15500010
*   MODULE TYPE =                                                     * 16000010
*                                                                     * 16500010
*      PROCESSOR = ASSEMBLER F                                        * 17000010
*                                                                     * 17500010
*      ATTRIBUTES =  REENTRANT                                        * 18000010
*                                                                     * 18500010
*   ENTRY POINT =  IEDQTL                                             * 19000010
*                                                                     * 19500010
*      LINKAGE =  ADDR OF ROUTINE APPEARS IN AVT                      * 20000010
*                                                                     * 20500010
*   INPUT = R0 EQUAL MASK FOR FIELD REQUESTED                         * 21000010
*           R1 EQUAL ADDR TO TTE                                      * 21500010
*   OUTPUT = R15 EQUAL ZERO IF FIELD DOES NOT EXIST                   * 22000010
*                OR    ADDR OF REQUESTED DEV DEP FIELD                * 22500010
*   EXIT-NORMAL = R14                                                 * 23000010
*                                                                     * 23500010
*   EXIT-ERROR =  R14                                                 * 24000010
*                                                                     * 24500010
*   EXTERNAL REFERENCES = NONE                                        * 25000010
*                                                                     * 25500010
*      ROUTINES = NONE                                                * 26000010
*                                                                     * 26500010
*      DATA AREAS = NONE                                              * 27000010
*                                                                     * 27500010
*      CONTROL BLOCKS = TTE                                           * 28000010
*                                                                     * 28500010
*   TABLES = NONE                                                     * 29000010
*                                                                     * 29500010
*   MACROS = NONE                                                     * 30000010
*                                                                     * 30500010
*   CHANGE ACTIVITY =                                                 * 31000010
*   A-000000-999999                                           @Y17XAPF* 31500010
*                                                                     * 32000010
*********************************************************************** 32500010
         EJECT                                                          33000010
DEVLEN   EQU   0                        DISPLACEMENT FOR DEVICE         33500010
*                                       FIELD LENGTH.                   34000010
RBASE    EQU   15                       PROGRAM BASE                    34500010
RDEVFLAD EQU   2                        DEVICE FIELD ADDRESS REG        35000010
RDEVFLD  EQU   1                        DEVICE FIELD SHIFT REGISTER     35500010
RETURN   EQU   14                       RETURN REGISTER                 36000010
RMASK    EQU   0                        INPUT MASK CORRESSPONDING       36500010
RSAVE    EQU   13                       SAVE AREA POINTER               37000010
RWORK    EQU   3                        WORK REGISTER                   37500010
         EJECT                                                          38000010
* SAVE REGS 0-3 AND SET PROGRAM BASE.                                   38500010
         SPACE                                                          39000010
         STM   RMASK,RWORK,12(RSAVE)    SAVE REGS              @YM02912 39500010
         USING IEDQTL,RBASE                                             40000010
IEDQTL   IEDHJN AFTERHJN,HJN                                            40500010
         SPACE                                                          41000010
* LEFT ADJUST INPUT MASK.                                               41500010
         SPACE                                                          42000010
         SLL   RMASK,16                 LEFT ADJUST                     42500010
         SPACE                                                          43000010
* IF REQUESTED FIELD NOT PRESENT....                                    43500010
         SPACE                                                          44000010
         USING IEDQTRM,RDEVFLD          TRMBASE                         44500010
         LH    RWORK,TRMDEVFL           DEVICE FIELD FLAGS              45000010
         SLL   RWORK,16                 LEFT ADJUST                     45500010
         NR    RWORK,RMASK              TURN OFF UNWANTED FIELD BITS    46000010
         XR    RWORK,RMASK              DESIRED FIELD PRESENT?          46500010
         BZ    ELSEDO                   BRANCH YES TO ELSE.             47000010
         SPACE                                                          47500010
* THEN SET RETURN CODE TO SO INDICATE.                                  48000010
         SPACE                                                          48500010
         SLR   RDEVFLAD,RDEVFLAD        RETURN CODE = 0.                49000010
         B     EXIT                     BRANCH AROUND ELSE              49500010
         SPACE                                                          50000010
* ELSE DO: SET FIRST DEVICE FIELD AT TRMOPNO.                           50500010
         SPACE                                                          51000010
ELSEDO   EQU   *                                                        51500010
         LA    RDEVFLAD,TRMOPNO         OPTIONS ADDRESS                 52000010
         SLR   RWORK,RWORK              CLEAR WORK REG FOR LATER USE    52500010
         SPACE                                                          53000010
* IF OPTION FIELDS....                                                  53500010
         SPACE                                                          54000010
         TM    TRMSTATE,TRMOPTFN        OPTION FIELDS?                  54500010
         BZ    NOPTIONS                 BRANCH NO                       55000010
         SPACE                                                          55500010
* THEN ADD LENGTH OF OPTION COUNT BYTE AND TABLE DISPLACEMENT FIELD     56000010
* PLUS THE NUMBER OF OPTION FIELD INDEXES.                              56500010
         SPACE                                                          57000010
         IC    RWORK,TRMOPNO            # OPTION INDEX BYTES.           57500010
         LA    RDEVFLAD,L'TRMOPNO+L'TRMOPTBL(RWORK,RDEVFLAD)            58000010
*                                       COUNT BYTE + TBL DISP FLD +     58500010
*                                       # OPTION FIELD INDEXES.         59000010
         SPACE                                                          59500010
* LEFT ADJUST DEVICE FIELD IN R1 FOR TESTING.                           60000010
         SPACE                                                          60500010
NOPTIONS EQU   *                                                        61000010
         LH    RDEVFLD,TRMDEVFL         DEVICE FIELD                    61500010
         DROP  RDEVFLD                                                  62000010
         SLL   RDEVFLD,16               LEFT ADJUST                     62500010
         SPACE                                                          63000010
* IF THIS IS  THE FIELD WE'RE AFTER....                                63500010
         SPACE                                                          64000010
CHKMSK   EQU   *                                                        64500010
         LTR   RMASK,RMASK              THIS IT?                        65000010
         BM    EXIT                     BRANCH YES                      65500010
         SPACE                                                          66000010
* THEN DO: IF CURRENT FIELD PRESENT....                                 66500010
         SPACE                                                          67000010
         LTR   RDEVFLD,RDEVFLD          PRESENT?                        67500010
         BNM   NOTPRES                  BRANCH NO                       68000010
         SPACE                                                          68500010
* THEN INCREMENT DEVICE FIELD ADDRESS BY CURRENT FIELD LENGTH.          69000010
         SPACE                                                          69500010
         IC    RWORK,DEVLEN(RDEVFLAD)   DEVICE FLD LENGTH               70000010
         LA    RDEVFLAD,1(RWORK,RDEVFLAD)    NEXT FLD ADDR     @PI02911 70500010
         SPACE                                                          71000010
* END THEN DO.                                                          71500010
* ADVANCE TO NEXT DEVICE FIELD POSITION IN MASKS.                       72000010
NOTPRES  EQU   *                                                        72500010
         SPACE                                                          73000010
         SLDL  RMASK,1                  BOTH MASKS SHIFT LEFT 1 TO      73500010
*                                       NEXT FIELD POSITION.            74000010
         SPACE                                                          74500010
* GO BACK TO CHECK NEXT FIELD.                                          75000010
         SPACE                                                          75500010
         B     CHKMSK                                                   76000010
         SPACE                                                          76500010
* END ELSE DO.                                                          77000010
* SET RETURN REG AND RESTORE REGS.                                      77500010
         SPACE                                                          78000010
EXIT     EQU   *                                                        78500010
         LR    RBASE,RDEVFLAD           DEV FLD ADDR OR 0 RETURN        79000010
*                                       CODE IF NOT FOUND.              79500010
         LM    RMASK,RWORK,12(RSAVE)    RESTORE REGS.          @YM02912 80000010
         SPACE                                                          80500010
* RETURN.                                                               81000010
         SPACE                                                          81500010
         BR    RETURN                                                   82000010
         EJECT                                                          82500010
         TTRMD                                                          83000010
         END                                                            83500010
./  ADD  SSI=63630055,NAME=IEDQUI
UI01     TITLE '''IEDQUI'' - USER INTERFACE ROUTINE'                    00500020
IEDQUI   CSECT                                                          01000020
*A895000                                                         A49201 01200010
*********************************************************************** 01500020
*                                                                     * 02000020
*STATUS -- CHANGE LEVEL 0                                             * 02500020
*                                                                     * 03000020
*FUNCTION -- USER INTERFACE IS THE COMMON ROUTINE THROUGH WHICH ALL   * 03500020
*   MESSAGE HANDLER MACRO EXPANSIONS LINK TO FIRST-LEVEL MESSAGE      * 04000020
*   HANDLER ROUTINES.  IT SAVES THE USER'S REGISTERS,  INITIALIZES    * 04500020
*   REGISTER CONTENTS TO COMMONLY NEEDED VALUES,  ACCESSES THE        * 05000020
*   ADDRESS OF THE ROUTINE TO BE LINKED TO AND EXITS TO IT.  USER     * 05500020
*   INTERFACE IS ALSO USED BY CERTAIN FIRST-LEVEL MESSAGE HANDLER     * 06000020
*   ROUTINES TO PROVIDE INITIALIZATION AND LINKAGE TO LOWER LEVEL     * 06500020
*   MESSAGE HANDLER ROUTINES. IT ALSO USED AS THE RETURN INTER-  S22025 06800010
*   FACE WHEN USING THE PLUS FOUR ENTRY. IT RESTORES THE USER'S  S22025 07100010
*   REGISTERS 2 THROUGH 12 AND 14 FROM THE SAVE AREA POINTED TO  S22025 07400010
*   BY REGISTER 13 AND EXITS ON REGISTER 14. THIS MODULE PROVIDES     * 07700010
*   INDEPENDENT REGISTER PROTECTION BETWEEN MESSAGE HANDLER LEVELS.   * 08000020
*                                                                     * 08500020
*   REGISTERS 2 THROUGH 12 AND 14 ARE SAVED IN THE SAVE AREA          * 09000020
*   POINTED TO BY REGISTER 13.                                        * 09500020
*                                                                     * 10000020
*   THE ADDRESS OF THE ADDRESS VECTOR TABLE (AVT) IS ACCESSED FROM    * 10500020
*   THE COMMUNICATION VECTOR TABLE (CVT).  THE ADDRESS OF THE         * 11000020
*   CURRENT BUFFER IS ACCESSED FROM THE AVT (AVTADBUF). THE ADDRESS   * 11500020
*   OF THE LCB IS ACCESSED FROM THE BUFFER PREFIX (PRFLCB). THE       * 12000020
*   ADDRESS OF THE CURRENT SCB IS ACCESSED FROM THE LCB (LCBSCBA).    * 12500020
*                                                                     * 13000020
*   REGISTER 0 IS SET TO A VALUE OF ONE TO INDICATE INITIAL (NON-     * 13500020
*   MULTIPLE BUFFER HEADER) ENTRY.                                    * 14000020
*                                                                     * 14500020
*   THE ADDRESS OF THE MESSAGE HANDLER VCON TABLE IS ACCESSED FROM    * 15000020
*   THE AVT (AVTMSGS).  THE INDEX TO THE ADDRESS OF THE ROUTINE TO    * 15500020
*   BE ENTERED IS ACCESSED FROM THE FIRST BYTE OF THE PARAMETER       * 16000020
*   LIST,  INDEX-BYTE FLAGS ARE CLEARED,  AND THE INDEX IS ADDED TO   * 16500020
*   THE MESSAGE HANDLER VCON TABLE ADDRESS.  THE ADDRESS OF THE       * 17000020
*   ROUTINE TO BE ENTERED IS ACCESSED FROM THE RESULTING LOCATION     * 17500020
*   INTO REGISTER 12.  USER INTERFACE THEN EXITS ON REGISTER 12,      * 18000020
*   WHICH BECOMES THE BASE FOR THE ROUTINE BEING ENTERED.             * 18500020
*                                                                     * 19000020
*ENTRY POINTS --                                                      * 19500020
*                                                                     * 19600010
*       PLUS 0 ENTRY:                                            S22025 19700010
*                                                                     * 19800010
*       'IEDQUI' TO SAVE REGISTERS,  INITIALIZE REGISTERS AND EXIT    * 20000020
*   TO THE ROUTINE SELECTED.  CALLING SEQUENCE FROM THE MESSAGE       * 20500020
*   HANDLER MACRO EXPANSION OR FROM THE FIRST-LEVEL MESSAGE           * 21000020
*   HANDLER ROUTINE IS:                                               * 21500020
*                                                                     * 22000020
*        BAL   1,*+(PARAMETER LIST LENGTH) SET ADDR OF PARAM LIST     * 22500020
*                                                                     * 23000020
*        ********************************                             * 23500020
*        * VCON  * PARAM *               *                            * 24000020
*        * TABLE * LIST  *               *   PARAMETER LIST           * 24500020
*        * INDEX * LNGTH *               *   (GENERATED BY MH         * 25000020
*        *****************  PARAMETER    *   MACRO OR BUILT           * 25500020
*        *                               *   BY MH ROUTINE)           * 26000020
*        *               INFORMATION     *                            * 26500020
*        *                               *                            * 27000020
*        *                                                            * 27500020
*        *                                                            * 28000020
*                                                                     * 28500020
*        L     15,IEDUI                 GET USER INTERFACE ADDRESS    * 29000020
*        BALR  14,15                    EXIT TO USER INTERFACE        * 29500020
*                                                                     * 30000020
*       PLUS 4 ENTRY:                                            S22025 30050010
*                                                                     * 30100010
*       'IEDQUI+4' TO RESTORE THE CALLER'S REGISTERS AND RETURN  S22025 30150010
*   TO THE CALLER. CALLING SEQUENCE IS:                          S22025 30200010
*                                                                S22025 30250010
*       L     R12,AVTUI                 GET USER INTERFACE ROUT  S22025 30300010
*       B     FOUR(R12)                 EXIT TO RETURN TO CALLER S22025 30350010
*                                                                S22025 30400010
*INPUT --                                                             * 30500020
*   PLUS 0 ENTRY:                                                S22025 30600010
*                                                                S22025 30700010
*   REGISTER 1 - THE ADDRESS OF A PARAMETER LIST WHOSE FIRST BYTE     * 31000020
*   CONTAINS THE MH VCON TABLE INDEX TO THE ROUTINE TO BE ENTERED.    * 31500020
*                                                                     * 32000020
*   REGISTER 13 - THE ADDRESS OF THE CALLER'S REGISTER SAVE AREA.     * 32500020
*                                                                     * 33000020
*                                                                S22025 33080010
*   PLUS 4 ENTRY:                                                S22025 33160010
*                                                                S22025 33240010
*   REGISTER 13 -- THE ADDRESS OF THE CALLING ROUTINES SAVE AREA.S22025 33320010
*                                                                S22025 33400010
*OUTPUT --                                                            * 33500020
*                                                                S22025 33600010
*   PLUS 0 ENTRY:                                                S22025 33700010
*                                                                S22025 33800010
*   REGISTER 0 - ENTRY CODE,  VALUE OF ONE.                           * 34000020
*                                                                     * 34500020
*   REGISTER 1 - PARAMETER LIST ADDRESS.                              * 35000020
*                                                                     * 35500020
*   REGISTER 3 - THE ADDRESS OF THE SCB.                              * 36000020
*                                                                     * 36500020
*   REGISTER 4 - THE ADDRESS OF THE LCB.                              * 37000020
*                                                                     * 37500020
*   REGISTER 6 - THE ADDRESS OF THE CURRENT BUFFER.                   * 38000020
*                                                                     * 38500020
*   REGISTER 9 - THE ADDRESS OF THE AVT.                              * 39000020
*                                                                     * 39500020
*   REGISTER 12 - THE ENTRY POINT ADDRESS AND BASE REGISTER FOR       * 40000020
*   THE ROUTINE TO BE ENTERED.                                        * 40500020
*                                                                     * 41000020
*   REGISTER 13 - THE ADDRESS OF THE CALLING ROUTINE'S SAVE AREA.     * 41500020
*                                                                     * 42000020
*   REGISTER 14 - RETURN ADDRESS TO THE CALLING ROUTINE.              * 42500020
*                                                                     * 43000020
*   PLUS 4 ENTRY:                                                S22025 43100010
*                                                                S22025 43200010
*   REGISTERS 2 THROUGH 12 AND 14 -- RESTORED TO VALUES AT ENTRY S22025 43300010
*   FROM MESSAGE HANDLER OR FROM FIRST-LEVEL MH ROUTINES.        S22025 43400010
*EXTERNAL REFERENCES --                                               * 43500020
*   AVT - ADDRESS VECTOR TABLE.                                       * 44000020
*                                                                     * 44500020
*   CVT - COMMUNICATION VECTOR TABLE.                                 * 45000020
*                                                                     * 45500020
*   BUFFER TO BE PROCESSED.                                           * 46000020
*                                                                     * 46500020
*   LCB - LINE CONTROL BLOCK.                                         * 47000020
*                                                                     * 47500020
*   SCB - STATION CONTROL BLOCK FOR THE CURRENT STATION.              * 48000020
*                                                                     * 48500020
*   MESSAGE HANDLER VCON TABLE (AVTMSGS).                             * 49000020
*                                                                     * 49500020
*EXITS, NORMAL --                                                S22025 49800010
*   PLUS 0 ENTRY: EXIT IS MADE TO THE ROUTINE SPECIFIED.         S22025 50100010
*   REGISTER 0 CONTAINS AN ENTRY CODE OF ONE.  REGISTERS 1, 3, 4,     * 50500020
*   6 AND 9 ARE INITIALIZED TO COMMONLY NEEDED VALUES.  REGISTER 12   * 51000020
*   CONTAINS THE ADDRESS OF THE ROUTINE BEING ENTERED.  THE SAVE      * 51500020
*   AREA POINTED TO BY REGISTER 13 CONTAINS THE CALLER'S REGISTERS    * 52000020
*   2 THROUGH 12 AND 14.                                              * 52500020
*                                                                     * 53000020
*   PLUS 4 ENTRY: REGISTERS 2 THROUGH 12 AND 14 CONTAIN THE      S22025 53100010
*   VALUES RESTORED FROM THE SAVE AREA POINTED TO BY THE         S22025 53200010
*   BACKWARD POINTER LOCATED AT FOUR PASSED THE ADDRESS IN R13.  S22025 53300010
*                                                                     * 53400010
*EXITS,  ERROR  -- N/A.                                               * 53500020
*                                                                     * 54000020
*TABLES/WORK AREAS -- N/A.                                            * 54500020
*                                                                     * 55000020
*ATTRIBUTES -- REENTRANT,  REFRESHABLE,  ENABLED,  RESIDENT,          * 55500020
*   PROBLEM PROGRAM MODE.                                             * 56000020
*                                                                     * 56500020
*NOTES -- THE OPERATION OF THIS MODULE DOES NOT DEPEND UPON AN        * 57000020
*   INTERNAL REPRESENTATION OF THE EXTERNAL CHARACTER SET.            * 57500020
*                                                                     * 58000020
*********************************************************************** 58500020
         EJECT                                                          58700010
         SPACE                                                          59000020
********* REGISTER EQUATES *********                                    59500020
         SPACE                                                          60000020
R0       EQU   0                        WORK REGISTER                   60500020
         SPACE                                                          61000020
R1       EQU   1                        PARAMETER LIST ADDRESS          61500020
         SPACE                                                          62000020
R2       EQU   2                        WORK REGISTER                   62500020
         SPACE                                                          63000020
RSCB     EQU   3                        CURRENT SCB ADDRESS             63500020
         SPACE                                                          64000020
RLCB     EQU   4                        LCB ADDRESS                     64500020
         SPACE                                                          65000020
RSCAN    EQU   5                        SCAN POINTER ADDRESS            65500020
         SPACE                                                          66000020
RPREFIX  EQU   6                        BUFFER ADDRESS                  66500020
         SPACE                                                          67000020
RAVT     EQU   9                        AVT ADDRESS                     67500020
         SPACE                                                          68000020
R12      EQU   12                       BASE & BRANCH ADDRESS           68500020
         SPACE                                                          69000020
R13      EQU   13                       SAVE AREA ADDRESS               69500020
         SPACE                                                          70000020
R14      EQU   14                       MH RETURN ADDRESS               70500020
         SPACE                                                          71000020
R15      EQU   15                       LINK ADDRESS                    71500020
         SPACE                                                          72000020
********* OTHER EQUATES *********                                       72500020
         SPACE                                                          73000020
ANDLOW   EQU   X'FC'                    MASK TO CLEAR INDEX FLAGS       73500020
         SPACE                                                          74000020
ONE      EQU   1                        NON-MBH ENTRY CODE              74500020
         SPACE                                                          75000020
CVTOFF   EQU   16                       ADDRESS OF THE CVT              75500020
         SPACE                                                          75600020
         EJECT                                                          76000020
         USING IEDQUI01,R15                                             76500020
         SPACE                                                          76700020
IEDQUI01 EQU   *                                                 S22025 76780010
         B     ENTER                    BRANCH TO SAVE REGISTER  S22025 76860010
IEDQUI02 EQU   *                        +4 ENTRY FOR RETURN      S22025 76940010
         L     R13,4(R13)               ADDR OF PREV SAVE AREA   S22025 77020010
         L     R14,12(R13)              LOAD RETRUN ADDRESS      S22025 77100010
         LM    R2,R12,28(R13)           REST PREV REG CONTENTS   S22025 77180010
         MVI   12(R13),X'FF'            SET BYTE                 S22025 77260010
         BR    R14                      RETURN TO CALLER         S22025 77340010
IEDQUI   IEDHJN ,                       MODULE ID                S22025 77440010
ENTER    EQU   *                                                 S22025 77580010
         STM   R14,R12,12(R13)          STORE CALLERS REGISTERS  S22025 77660010
         L     RAVT,CVTOFF              GET ADDRESS OF CVT       S22025 77740010
         L     RAVT,AVTCVTPT(,RAVT)     FIND POINTER TO AVT      S22025 77820010
         L     RAVT,AVTEZERO(,RAVT)     GET ADDRESS OF AVT       S22025 77900010
         USING IEDQAVTD,RAVT                                     S22025 77980010
         LR    R12,R13                  LOAD CALLERS ADDR IN REG S22025 78060010
         LA    R13,72(R13)              LOAD MY SAVE AREA ADDR   S22025 78140010
         ST    R12,4(R13)               CONTENTS OF REG 13 STOREDS22025 78220010
         ST    R13,8(R12)               ST SAVE ADDR             S22025 78300010
         SPACE                                                          78500020
         SPACE                                                          80600020
         SPACE                                                          81000020
         L     RPREFIX,AVTADBUF         INITIALIZE BUFFER ADDR          81500020
         USING IEDQPRF,RPREFIX                                          82000020
         SPACE                                                          83500020
         L     RLCB,PRFLCB-1            INITIALIZE LCB ADDR             84000020
         USING IEDQLCB,RLCB                                             84500020
         SPACE                                                          85000020
         L     RSCB,LCBSCBA-1           GET ADDRESS OF SCB              85500020
         SPACE                                                          86000020
ROUTADDR EQU   *                                                        86500020
         L     R12,AVTMSGS-1            GET ADDR OF VCON TABLE          87000020
         IC    R15,AVTEZERO(,R1)        GET INDEX TO ROUTINE ADDR       87500020
         LA    R0,ANDLOW                SET UP MASK                     88000020
*** NON-ZERO VALUE IN REGISTER 0 INDICATES ENTRY FROM IEDQUI ***        88500020
         NR    R15,R0                   CLEAR INDEX FLAGS               89000020
         L     R12,AVTEZERO(R12,R15)    GET ROUTINE ADDR                89500020
         SR    R15,R15                  CLEAR REG 15             A49201 89700010
         BR    R12                      EXIT TO ROUTINE                 90000020
         EJECT                                                          90500020
********* DSECTS *********                                              91000020
         SPACE 2                                                        91500020
         TAVTD                                                          92000020
         EJECT                                                          92500020
         TPRFD                                                          93000020
         EJECT                                                          93500020
         TLCBD                                                          94000020
         END                                                            94500020
./  ADD  SSI=71520688,NAME=IEDQWA
         TITLE 'IEDQWA - TOTE RESIDENT MODULE'                          00100022
IEDQWA   CSECT                                                          00200022
*CHANGE ACTIVITY AS FOLLOWS:                                            00230022
*A000000-999999                                                @M02XRUV 00240000
*A612240-612360,619840-619960                                   SA41599 00260022
*D489000-489300                                                 SA41603 00270022
*A496300-496400                                                 SA41603 00280022
*A604500,624900                                                 SA41612 00283022
*C604400,624800                                                 SA41612 00286022
*A474650-474850                                                 SA41613 00289022
*C466800,475200                                                 SA41613 00292022
*D467100,475500,768500-768800                                   SA41613 00295022
*A026600-026800,033030-033450,033700,036560-036920,051700        S22024 00295300
*A054700,063570-063920,078700,093200,137000-145400,170300-170600 S22024 00295600
*A268600-268800,269200-269800,271000,453960-454140,466600-466700 S22024 00295900
*A477300-477552,481000,491120-491300,494100,591000-591990        S22024 00296200
*A593000-593760,612370-612380,619970-619980,615640-615760        S22024 00296500
*A617060-617120,658000,764000,776700,776730-776850,847000        S22024 00296800
*A858000-868000                                                  S22024 00297100
*C007000,009000,026500,041500-042400,046500,051500,069000,076000 S22024 00297400
*C082500,093000,094500-095500,268000,269000,270000,611000,614800 S22024 00297700
*C615600,616000,617000,617600-618150,776300-776600,790400        S22024 00298000
*D189000-191000,588000,621000,782300-790700,749000-757400        S22024 00298300
*D760700-763700,764300-766340,770600,772700-773000               S22024 00298600
*A139730-139760,142130-142160,145700-145800,466720-466780        S05331 00298800
*A476340-476361,476680-477100,587805-587875,588460-588480        S05331 00299000
*A592450-592500,607610-607700,776866-776890,816020-816780        S05331 00299200
*C196000-203000,592200,592360                                    S05331 00299400
*A139000,145820-145960,476131-476138,477100-477848,776891-776898 Y06330 00299605
*C908000                                                         Y06330 00299805
*A139200,593483-593495                                           Y06330 00299905
*A476124-476126                                                 SA64777 00300005
*A466780,476361,477090                                         @YA07679 00305058
*A508200,508500                                                 SA64792 00310005
*D621600-624350,834140-834910                                  @YA06302 00310156
*A462330                                                       @ZA00208 00310256
*D510900,511800-514800                                         @ZA00208 00310356
*C515700                                                       @ZA00208 00310456
*C177000-186000                                                 SA64772 00320054
*A145840-145880,498000,498660-498840,500160-500340              SA64785 00320153
*A145920-145960,495920-496100                                   SA64790 00320253
*A366300,145960                                                @YA08757 00320358
*C618150                                                       @YA11128 00320458
*A611600,620800,769100                                         @YA11128 00320558
*D003500-033450,053000-059000,070000-078700,                   @Y17XAUV 00321200
*D083000-096000,139730-140100,140400-143100,                   @Y17XAUV 00321900
*D145700-187000,235000-559000,587400-592520,                   @Y17XAUV 00322100
*D603800-604200                                                @Y17XAUV 00322300
*D621200-625200,757700-776000,776700-776898                    @Y17XAUV 00322600
*C038000,071500,079500,081500-082000,082000-082500,            @Y17XAUV 00323300
*C123000,126000,139400,200000,220000                           @Y17XAUV 00324000
*C595000,604000,611700                                         @Y17XAUV 00324300
*A003205,052500,067500,068000,077000,082000,                   @Y17XAUV 00324700
*A082500,123000,126000,139700,220000,234000,593740             @Y17XAUV 00325100
*A603600,621000,776600,777200                                  @Y17XAUV 00325500
*C146480                                                       @YM07361 00325800
* A002300,003258,003471,450560,776900                          @XM05672 00325900
* C054940,068080-068120                                        @XM05672 00326000
* D777230-777440                                               @XM05672 00326100
* A616000                                                      @G36XRUV 00326200
* C616200,681000                                               @G36XRUV 00326300
* D680000,682000                                               @G36XRUV 00326400
*                                                                       00326500
         EJECT                                                 @Y17XAUV 00326600
*********************************************************************** 00326800
*                                                              @Y17XAUV 00327500
* MODULE NAME = IEDQWA (TCAM,TELECOMMUNICATION ON-LINE TEST EXECUTOR) * 00328200
*                                                              @Y17XAUV 00328900
* DESCRIPTIVE NAME = TOTE RESIDENT MODULE                      @Y17XAUV 00329600
*                                                              @Y17XAUV 00330300
* COPYRIGHT = NONE                                             @Y17XAUV 00331000
*                                                              @Y17XAUV 00331700
* STATUS = VERSION 10.0                                        @Y17XAUV 00332400
*                                                              @Y17XAUV 00333100
* FUNCTION = IEDQWA PERFORMS THE BASIC RESIDENT FUNCTION       @Y17XAUV 00333800
* OF TOTE. IN ADDITION, IT CONTAINS ASYCHRONOUS TASK EXITS     @Y17XAUV 00334500
* AND SUBROUTINES USED BY THE OTHER TOTE MODULES AND           @Y17XAUV 00335200
* THE OLT MODULES.  EACH OF THESE ACTIVITES IS REPRESENTED     @Y17XAUV 00335900
* AS A SEPARATE ENTRY POINT.                                   @Y17XAUV 00336600
*                                                              @Y17XAUV 00338700
*    ENTRY POINT IEDQWA:                                       @Y17XAUV 00339400
*                                                              @Y17XAUV 00340100
*    THE MODULE IS ENTERED AT IEDQWA FROM THE OPERATING        @Y17XAUV 00340800
*    SYSTEM AS A RESULT OF THE ATTACH MACRO ISSUED BY          @Y17XAUV 00341500
*    THE MCP TASK AT INTRO TIME.  THIS ROUTINE PERFORMS        @Y17XAUV 00342200
*    THE BASIC RESIDENT FUNCTION FOR TOTE.  ON ENTRY IT        @Y17XAUV 00342900
*    PERFORMS CERTAIN INITIALIZATION PROCEDURES.  IT THEN      @Y17XAUV 00343000
*    WAITS ON AN ECB LIST.  ONE OF THESE ECB'S IS PART OF      @Y17XAUV 00343100
*    THE TOTE QCB IN THE TCAM AVT AND IS POSTED BY THE TCAM    @Y17XAUV 00343200
*    MCP TASK WHEN INPUT IS ENQUEUED ON THE TOTE QCB.  THE     @Y17XAUV 00343300
*    OTHER ECB IS IN THE TOTE RESIDENT PARAMETER LIST AND      @Y17XAUV 00343400
*    IS POSTED BY THE OLT SUBTASKS WHEN THEY REQUIRE SERVICE   @Y17XAUV 00343500
*    BY THE TOTE MAIN TASK.  WHEN TOTE IS POSTED, IT FIRST     @Y17XAUV 00343600
*    DETERMINES IF TCAM IS IN SHUTDOWN.  IF SO, ALL OLT        @Y17XAUV 00343700
*    SUBTASKS ARE DETACHED AND IEDQWA RETURNS TO TCAM.  IF     @Y17XAUV 00343800
*    SHUTDOWN IS NOT IN PROGRESS, THEN IEDQWA FULFILLS THE     @Y17XAUV 00343900
*    REQUESTS OF OLT SUBTASKS FOR RESOURCES BY LINKING         @Y17XAUV 00344000
*    TO IEDQWB, THE TOTE RESOURCE MANAGER, AND INITIATES       @Y17XAUV 00344100
*    THE PROCESSING OF INCOMING MESSAGES ENQUEUED ON THE       @Y17XAUV 00344200
*    TOTE QCB BY CALLING IEDQWA1, THE TOTE INPUT DATA          @Y17XAUV 00344300
*    HANDLER.  WHEN ALL WORK IS COMPLETE, IEDQWA RESUMES       @Y17XAUV 00344400
*    THE WAIT.  IF CATESTROPHIC ERRORS WERE DETECTED BY        @Y17XAUV 00344500
*    THE TWO OTHER TOTE MODULES, IEDQWA IS INFORMED BY         @Y17XAUV 00344600
*    RETURN CODE AND EXITS TO TCAM.                            @Y17XAUV 00344700
*                                                              @Y17XAUV 00344800
*    ENTRY POINT: ALLOCBUF                                     @Y17XAUV 00344900
*                                                              @Y17XAUV 00345000
*    THIS ROUTINE IS CALLED BY TOTE MODULES REQUIRING A        @Y17XAUV 00345100
*    TCAM BUFFER. IT TPOSTS AN ERB TO THE BUFFER REQUEST       @Y17XAUV 00345200
*    QCB FOR THE DESIRED NUMBER OF OF BUFFER UNITS.  THESE     @Y17XAUV 00345300
*    ARE RETURNED TO THE REQUESTING TOTE MODULE.               @Y17XAUV 00345400
*                                                              @Y17XAUV 00345500
*    ENTRY POINT: FREEBUF                                      @Y17XAUV 00345600
*                                                              @Y17XAUV 00345700
*    THIS ROUTINE IS CALLED BY TOTE MODULES DESIRING TO        @Y17XAUV 00345800
*    FREE A BUFFER. IT TPOSTS THE BUFFER UNITS BACK TO         @Y17XAUV 00345900
*    THE BUFFER RETURN QCB.                                    @Y17XAUV 00346000
*                                                              @Y17XAUV 00346100
*    ENTRY POINT: POSTWAIT                                     @Y17XAUV 00346200
*                                                              @Y17XAUV 00346300
*    THIS ROUTINE IS CALLED BY TOTE MODULES IN ORDER TO        @Y17XAUV 00346400
*    TPOST AN ELEMENT TO TCAM.  A WAIT MAY BE DONE FOR THE     @Y17XAUV 00346500
*    RETURN OF THE ELEMENT IF THE TOTE MODULE SO REQUESTS.     @Y17XAUV 00346600
*                                                              @Y17XAUV 00347100
*    ENTRY POINT: HIERSCAN                                     @XM05672 00847100
*                                                              @XM05672 01347100
*    THIS ROUTINE SCANS THE HIERARCHY UNDER A SDLC LINK AND    @XM05672 01847100
*    RESETS THE TRMSTOTE BIT.                                  @XM05672 02347100
*                                                              @XM05672 02847100
*    ENTRY POINT: OLTETXR                                             * 03350022
*                                                               S22024* 03370000
*    THIS ROUTINE IS THE END OF TASK EXIT ROUTINE INDICATED ON THE    * 03400022
*    ATTACH MACRO WHICH IS ENTERED WHEN THE OLT ENDS EITHER           * 03450022
*    NORMALLY OR ABNORMALLY. THE CORRECT OLT IS DETACHED BY           * 03500022
*    COMPARING THE TCB ADDRESS IN THE OLTCB TO THE TCB ADDRESS        * 03550022
*    INDICATED IN REGISTER 1.                                         * 03600022
*                                                                     * 03650022
*    ENTRY POINT: STAERT                                        S22024* 03656000
*                                                               S22024* 03662000
*    THIS ROUTINE IS THE STAE EXIT ROUTINE WHICH GETS CONTROL   S22024* 03668000
*    WHEN AN OLTT ABENDS.  IF THE OLTT HAS A CLEANUP ROUTINE    S22024* 03674000
*    SPECIFIED, THE ROOT MODULE IS ENTERED FOR CLEANUP.  OTHER- S22024* 03680000
*    WISE CONTROL IS RETURNED TO ABTERM.                        S22024* 03686000
*                                                               S22024* 03692000
*    ENTRY POINT: SMGR                                                * 03700022
*                                                                     * 03750022
*    THIS IS THE SERVICE MODULE MANAGER ROUTINE. IT IS         @Y17XAUV 03800000
*    ENTERED BY THE OLT WHEN HE REQUESTS A SERVICE OF THE EXECUTOR.   * 03850022
*    THE CANCEL PENDING BIT IS CHECKED FOR THE REQUESTING OLT. IF IT  * 03900022
*    IS ON AND THE OLT HAS A CLEANUP ROUTINE, THEN THE OLT IS         * 03950022
*    BRANCHED TO FOR CLEANUP. IF THE OLT DOES NOT HAVE A CLEANUP      * 04000022
*    ROUTINE, IEDQWF IS BRANCHED TO TO DELETE THE OLT. IF A CANCEL    * 04050022
*    REQUEST IS NOT PENDING FOR THE OLT, IEDQWA NOW DETERMINES IF     * 04100022
*    A START LINE COMMAND SHOULD BE ISSUED.  IF NON-CONCURRENT  S22024* 04150000
*    MODE IS REQUESTED, LINE SHARING IS NOT ACTIVE, THE LINE    S22024* 04180000
*    WAS INITIALLY STOPPED, OR THE TEST DEVICE IS ON A 3705,    S22024* 04210000
*    THEN THE START LINE IS BYPASSED. OTHERWISE THE START LINE  S22024* 04240000
*    COMMAND IS ISSUED. IEDQWA THEN GETS THE NAME OF THE SERVICE      * 04300022
*    MODULE REQUESTED AND PERFORMS A BLDL ON SYS1.LINKLIB TO VERIFY   * 04350022
*    THAT A VALID MODULE HAS BEEN REQUESTED. IF THE NAME IS NOT       * 04400022
*    FOUND, A RETURN CODE OF FOUR INDICATING AN UNSUPPORTED           * 04450022
*    FUNCTION IS SET AND THE OLT IS RETURNED TO. IF THE MODULE IS     * 04500022
*    VALID, IT IS LINKED TO TO PERFORM THE REQUESTED FUNCTION.        * 04550022
*    IF AN I/O OPERATION IS REQUESTED ON A TEST DEVICE, IEDQWN IS     * 04600022
*    CALLED. IF COMMUNICATION WITH THE ON-LINE TEST OPERATOR IS S22024* 04650000
*    REQUESTED IEDQWP OR IEDQWQ IS CALLED. IF AN OLT SUBMODULE IS     * 04700022
*    TO BE LOADED OR DELETED, IEDQWR IS CALLED. IF THE OLT WISHES     * 04750022
*    TO WAIT FOR THE COMPLETION OF AN I/O OPERATION, IEDQWS IS CALLED.* 04800022
*    IF AN ADDITIONAL TEST DEVICE IS REQUIRED IEDQWV IS CALLED. IF    * 04850022
*    DATA CONVERSION IS REQUIRED IEDQWX IS CALLED. IF CONFIGURATION   * 04900022
*    DATA IS REQUESTED, IEDQWY IS CALLED. IF A HALT I/O I REQUESTED,  * 04950022
*    IEDQW44 IS CALLED. IF THE OLT REQUIRES MORE CORE OR WANTS TO     * 05000022
*    FREE CORE, IEDQW42 (ALIAS IEDQW43) IS CALLED. IF A CONTROL UNIT  * 05050022
*    TEST IS DESIRED, IEDQWAJ IS CALLED. IF THE TIME IS DESIRED,      * 05100022
*    IEDQWAB IS CALLED.  IF THE DATE IS DESIRED, IEDQWAA IS     S22024* 05150000
*    CALLED.  AND DETERMINING WHETHER A ROUTINE SHOULD BE       S22024* 05170000
*    RUN IS PROVIDED BY IEDQW47. CONTROL IS THEN RETUNRED TO THE OLT. * 05200022
*                                                                     * 05250022
*    ENTRY POINT: QADDNDX                                      @Y17XAUV 05251000
*                                                              @Y17XAUV 05252000
*    THIS QUEUE HANDLER SUBROUTINE ADDS AN ELEMENT TO THE      @Y17XAUV 05253000
*    THE END OF A QUEUE.                                       @Y17XAUV 05254000
*                                                              @Y17XAUV 05255000
*    ENTRY POINT: QADDAFX                                      @Y17XAUV 05256000
*                                                              @Y17XAUV 05257000
*    THIS QUEUE HANDLER SUBROUTINE INSERTS AN ELEMENT AFTER    @Y17XAUV 05258000
*    A SPECIFIED ELEMENT ON A QUEUE.                           @Y17XAUV 05259000
*                                                              @Y17XAUV 05260000
*    ENTRY POINT: QREMELX                                      @Y17XAUV 05261000
*                                                              @Y17XAUV 05262000
*    THIS QUEUE HANDLER SUBROUTINE REMOVES A SPECIFIED         @Y17XAUV 05263000
*    ELEMENT FROM A QUEUE.                                     @Y17XAUV 05264000
*                                                              @Y17XAUV 05265000
*    ENTRY POINT: QREMFRX                                      @Y17XAUV 05266000
*                                                              @Y17XAUV 05267000
*    THIS QUEUE HANDLER SUBROUTINE REMOVES THE FIRST           @Y17XAUV 05268000
*    ELEMENT OF A QUEUE.                                       @Y17XAUV 05269000
*                                                              @Y17XAUV 05270000
* NOTES = SEE BELOW                                            @Y17XAUV 05271000
*                                                              @Y17XAUV 05272000
*    DEPENDENCIES = EBCDIC CHARACTER CODE.                     @Y17XAUV 05273000
*                                                              @Y17XAUV 05274000
*    RESTRICTIONS = NONE                                       @Y17XAUV 05275000
*                                                              @Y17XAUV 05276000
*    PATCH LABEL = PATCH                                       @Y17XAUV 05277000
*                                                              @Y17XAUV 05278000
* MODULE TYPE = CSECT                                          @Y17XAUV 05279000
*                                                              @Y17XAUV 05280000
*    PROCESSOR = ASMX                                          @Y17XAUV 05281000
*                                                              @Y17XAUV 05282000
*    MODULE SIZE = NO RESTRICTION                              @Y17XAUV 05283000
*                                                              @Y17XAUV 05284000
*    ATTRIBUTES = THE RESIDENT ROUTINE IS SERIALLY             @Y17XAUV 05285000
*    REUSEABLE.  ALL OTHER ROUTINES ARE REENTRANT.  THE        @Y17XAUV 05285200
*    LINKAGE EDITOR ATTIBUTES SHOULD BE SPECIFIED AS           @Y17XAUV 05285400
*    SERIALLY REUSEABLE.                                       @Y17XAUV 05285600
*                                                              @Y17XAUV 05286000
* INPUT = SEE BELOW                                            @Y17XAUV 05287000
*                                                              @Y17XAUV 05288000
*    ENTRY POINT IEDQWA:                                       @Y17XAUV 05289000
*                                                              @Y17XAUV 05290000
*         REGISTER 1 - TCAM AVT ADDRESS                        @Y17XAUV 05291000
*         REGISTER 13 - SAVE AREA ADDRESS                      @Y17XAUV 05292000
*         REGISTER 14 - RETURN ADDRESS                         @Y17XAUV 05293000
*         REGISTER 15 - ENTRY POINT ADDRESS                    @Y17XAUV 05294000
*                                                              @Y17XAUV 05394000
*    ENTRY POINTS ALLOCBUF, FREEBUF, POSTWAIT, AND HIERSCAN:   @XM05672 05494000
*                                                              @Y17XAUV 05594000
*         SEE SUBROUTINE COMMENTS.                             @Y17XAUV 05694000
*                                                                     * 05950022
*    ENTRY POINT OLTETXR:                                             * 06000022
*                                                                     * 06050022
*         REGISTER 1 - TCB ADDRESS OF ENDING SUBTASK                  * 06100022
*         REGISTER 2 - OLTCB ADDRESS                                  * 06150022
*         REGISTER 13 - SAVE AREA ADDRESS                             * 06200022
*         REGISTER 14 - RETURN ADDRESS                                * 06250022
*         REGISTER 15 - ENTRY POINT ADDRESS                           * 06300022
*                                                                     * 06350022
*    ENTRY POINT STAERT:                                        S22024* 06357000
*                                                               S22024* 06364000
*         REGISTER 13 - SAVE AREA ADDRESS                       S22024* 06371000
*         REGISTER 14 - RETURN ADDRESS                          S22024* 06378000
*         REGISTER 15 - ENTRY POINT ADDRESS                     S22024* 06385000
*                                                               S22024* 06392000
*    ENTRY POINT SMGR:                                                * 06400022
*                                                                     * 06450022
*         REGISTER 1 - PARAMETER LIST ADDRESS                         * 06500022
*         REGISTER 2 - OLTCB ADDRESS                                  * 06550022
*         REGISTER 13 - SAVE AREA ADDRESS                             * 06600022
*         REGISTER 14 - RETURN ADDRESS                                * 06650022
*         REGISTER 15 - ENTRY POINT ADDRESS                           * 06700000
*                                                                     * 06750022
*    ENTRY POINTS QADDNDX,QADDAFX,QREMNDX,QREMFRX (QUEUE       @Y17XAUV 06760000
*    HANDLERS) : SEE CODE.                                     @Y17XAUV 06770000
*                                                              @Y17XAUV 06780000
* OUTPUT:                                                             * 06800022
*                                                              @Y17XAUV 06804000
*    FOR THE ALLOCBUF, FREEBUF, POSTWAIT, HIERSCAN, AND        @XM05672 06808000
*    QUEUE HANDLER SUBROUTINES, SEE THE SUBROUTINE COMMENTS.   @XM05672 06812000
*                                                              @Y17XAUV 06816000
*    IEDQWA: (WHEN CALLING IEDQWA1)                            @Y17XAUV 06820000
*                                                              @Y17XAUV 06824000
*         REGISTER 1 - PARAMETER LIST ADDRESS.                 @Y17XAUV 06828000
*         REGISTER 4 - TCAM AVT ADDRESS.                       @Y17XAUV 06832000
*                                                              @Y17XAUV 06836000
*    IEDQWA: (WHEN LINKING TO IEDQWB)                          @Y17XAUV 06840000
*                                                                     * 06850022
*    REGISTER 1 - PARAMETER LIST ADDRESS                        S22024* 06900000
*    REGISTER 2 - OLTCB ADDRESS                                       * 06950022
*                                                                     * 07900022
* EXITS,NORMAL:  BR 14 TO OPERATING SYSTEM.                    @Y17XAUV 07950000
*                                                                     * 08000022
* EXITS,ERROR:  NONE                                                  * 08050022
*                                                                     * 08100022
* EXTERNAL REFERENCES:                                         @Y17XAUV 08150000
*                                                              @Y17XAUV 08154000
*    ROUTINES =                                                @Y17XAUV 08158000
*                                                              @Y17XAUV 08162000
*    IEDQWA1 - TOTE INPUT DATA HANDLER MODULE                  @Y17XAUV 08166000
*    IEDQWN (IEDQW35) - EXIO SERVICE MODULE                    @Y17XAUV 08170000
*    IEDQWP (IEDQW39) - DPRINT SERVICE MODULE                  @Y17XAUV 08174000
*    IEDQWQ (IEDQW37) - CECOM SERVICE MODULE                   @Y17XAUV 08178000
*    IEDQWR (IEDQW28) - PLINK SERVICE MODULE                   @Y17XAUV 08182000
*    IEDQWS(IEDQW36) - WAITIO SERVICE MODULE                   @Y17XAUV 08186000
*    IEDQWV (IEDQW21,IEDQWAC) - GRAB/LETGO SERVICE MODULE      @Y17XAUV 08190000
*    IEDQWX (IEDQW41) - CONVERT SERVICE MODULE                 @Y17XAUV 08194000
*    IEDQWY (IEDQW16) - GETCONFG SERVICE MODULE                @Y17XAUV 08198000
*    IEDQWAA - $DDATE SERVICE MODULE                           @Y17XAUV 08202000
*    IEDQWAB - $DTIME SERVICE MODULE                           @Y17XAUV 08206000
*    IEDQWAJ - $CUTEST SERVICE MODULE                          @Y17XAUV 08210000
*    IEDQW25 - SEND SERVICE MODULE                             @Y17XAUV 08214000
*    IEDQW33 - RECEIVE SERVICE MODULE                          @Y17XAUV 08218000
*    IEDQW42 (IEDQW43) - FREECORE/MORECORE SERVICE MODULE      @Y17XAUV 08222000
*    IEDQW44 - DIO SERVICE MODULE                              @Y17XAUV 08226000
*    IEDQW47 - ROUTINE SERVICE MODULE                          @Y17XAUV 08230000
*                                                              @Y17XAUV 08234000
*    CONTROL BLOCKS =                                          @Y17XAUV 08238000
*                                                              @Y17XAUV 08242000
*    OLTCB,AVT,PRF,TRM,QCB,SCB,LCB,TCB,UCB,TPRIOR,IOBLOCKS     @Y17XAUV 08250000
*                                                              @Y17XAUV 08258000
*    MACROS =                                                  @Y17XAUV 08266000
*                                                              @Y17XAUV 08274000
*    AQCTL,DCB,DELETE,DETACH,FREEMAIN,GETMAIN,LOAD,POST,WAIT   @Y17XAUV 08282000
*                                                              @Y17XAUV 08290000
*********************************************************************** 09650022
         EJECT                                                          11500022
*********************************************************************** 11600022
*                                                                     * 11700022
*              REGISTER EQUATES                                       * 11800022
*                                                                     * 11900022
*********************************************************************** 12000022
         SPACE 2                                                        12100022
R0       EQU   0                  WORK REGISTER                         12200022
R1       EQU   1                  WORK REGISTER                @Y17XAUV 12300000
RPARM    EQU   1                  PARAMETER LIST ADDR          @Y17XAUV 12350000
R2       EQU   2                  ADDRESS OF ELEMENT BEING PROCESSED    12400022
R3       EQU   3                  WORK REGISTER                         12500022
R4       EQU   4                  WORK REGISTER                @Y17XAUV 12600000
RAVT     EQU   4                  AVT BASE                     @Y17XAUV 12650000
R5       EQU   5                  WORK REGISTER                         12700022
R6       EQU   6                  WORK REGISTER                         12800022
R7       EQU   7                  WORK REGISTER                         12900022
R8       EQU   8                  WORK REGISTER                         13000022
R9       EQU   9                  WORK REGISTER                         13100022
R10      EQU   10                 WORK REGISTER                         13200022
R11      EQU   11                 BASE REGISTER                         13300022
R12      EQU   12                 WORK REGISTER                         13400022
R13      EQU   13                 SAVE AREA ADDRESS                     13500022
R14      EQU   14                 RETURN ADDRESS                        13600022
R15      EQU   15                 ENTRY POINT ADDRESS                   13700000
         EJECT                                                          13710000
**************************************************************** S22024 13720000
*                                                              * S22024 13730000
*                       MODULE EQUATES                         * S22024 13740000
*                                                              * S22024 13750000
**************************************************************** S22024 13760000
* EQUATES MOVED FROM THE END OF MODULE                           S22024 13765000
         SPACE 2                                                        13770000
D0       EQU   0                  CONSTANT DISPLACEMENT                 13780000
D1       EQU   1                  CONSTANT DISPLACEMENT                 13790000
D2       EQU   2                  CONSTANT DISPLACEMENT                 13800000
D3       EQU   3                  CONSTANT DISPLACEMENT                 13810000
D4       EQU   4                  CONSTANT DISPLACEMENT                 13820000
D5       EQU   5                  CONSTANT DISPLACEMENT                 13830000
D6       EQU   6                  CONSTANT DISPLACEMENT                 13840000
D7       EQU   7                  CONSTANT DISPLACEMENT                 13850000
D8       EQU   8                  CONSTANT DISPLACEMENT                 13860000
D11      EQU   11                 CONSTANT DISPLACEMENT                 13870000
D12      EQU   12                 CONSTANT DISPLACEMENT                 13880000
D16      EQU   16                 CONSTANT DISPLACEMENT          S22024 13885000
D17      EQU   17                 CONSTANT DISPLACEMENT                 13890000
D18      EQU   18                 CONSTANT DISPLACEMENT                 13900000
D19      EQU   19                 CONSTANT DISPLACEMENT          Y06330 13905005
D1C      EQU   X'1C'              CONSTANT DISPLACEMENT                 13910000
D28      EQU   28                 CONSTANT DISPLACEMENT                 13920000
D2C      EQU   X'2C'              CONSTANT DISPLACEMENT          Y06330 13925005
D30      EQU   30                 CONSTANT DISPLACEMENT                 13930000
D20      EQU   20                 CONSTANT DISPLACEMENT        @Y17XAUV 13940000
D58      EQU   58                 CONSTANT DISPLACEMENT                 13950000
D62      EQU   62                 CONSTANT DISPLACEMENT                 13960000
D72      EQU   72                 CONSTANT DISPLACEMENT 72       S22024 13970000
D255     EQU   255                CONSTANT DISPLACEMENT 255    @Y17XAUV 13970700
D24      EQU   24                 CONSTANT DISPLACEMENT 24     @Y17XAUV 13971000
         SPACE 2                                               @Y17XAUV 13971400
X00      EQU   X'00'              USED TO ZERO A FIELD         @Y17XAUV 13972100
TICCODE  EQU   X'08'              TIC CCW COMMAND CODE         @Y17XAUV 14052100
WAITING  EQU   X'0C'              OLT WAITING FOR MORE CORE             14132100
PROCTRM  EQU   X'10'              TRM TO PROCESS CODE                   14212100
XFF      EQU   X'FF'              USED TO CLEAR FLAG BITS               14320000
BLANK    EQU   X'40'              USED TO CLEAR A FIELD                 14330000
SIXTEEN  EQU   16                 ADDRESS OF CVT                        14340000
ANR      EQU   X'1E'              INDICATION IN LCB OF LOCAL RECEIVE    14350000
*                                   SCHEDULER                           14360000
XF0      EQU   X'F0'              MOVED INTO LOCAL LCB BEFORE RETURNING 14370000
*                                   THE BUFFER                          14380000
START    EQU   X'0C'              INDICATES START OF SVC 102            14390000
*                                   PARAMETER LIST                      14400000
EIGHTY   EQU   X'80'              INDICATES END OF PARM LIST FOR        14410000
*                                   SVC 102                             14420000
OPCKEY   EQU   X'00'              OP CONTROL KEY FIELD           S22024 14440000
OPCPRI   EQU   X'DC'              OP CONTROL PRIORITY            S22024 14460000
OPCRTCD  EQU   X'00'              OP CONTROL RETURN CODE FIELD   S22024 14480000
OPCELNG  EQU   X'18'              OP CONTROL ELEMENT LENGTH      S22024 14500000
LINESTRT EQU   X'40'              VERB CODE FOR START LINE       S22024 14520000
LINESTOP EQU   X'41'              STOP LINE VERB CODE            S22024 14540000
         EJECT                                                 @Y17XAUV 14600000
*********************************************************************** 14602000
*                                                                     * 14604000
*        TOTE INITIALIZATION - TERMINATION                     @Y17XAUV 14606000
*                                                                     * 14608000
*********************************************************************** 14610000
         SPACE 2                                               @Y17XAUV 14612000
         SAVE  (14,12)                                         @Y17XAUV 14614000
         LR    R12,R15            COPY ENTRY PT ADDR           @Y17XAUV 14616000
         USING IEDQWA,R12         SET MODULE BASE REG          @Y17XAUV 14618000
IEDQWA   IEDHJN IEDQWAA,HJN       ID,TIME,DATE                 @Y17XAUV 14620000
         ST    R13,REGSAVE+4      SAVE PTR TO TCAM SAVE AREA   @Y17XAUV 14622000
         LR    R14,R13            COPY                         @Y17XAUV 14624000
         LA    R13,REGSAVE        PTR TO TOTE SAVE AREA        @Y17XAUV 14626000
         ST    R13,D8(R14)        SAVE PTR TO TOTE SAVE AREA   @Y17XAUV 14628000
*                                  IN TCAM'S SAVE AREA         @Y17XAUV 14630000
         SPACE 2                                               @Y17XAUV 14632000
**********                                                     @Y17XAUV 14634000
*        INITIALIZATION                                        @Y17XAUV 14636000
**********                                                     @Y17XAUV 14638000
         LR    RAVT,RPARM         LOAD ADDR OF TCAM AVT        @Y17XAUV 14640000
         USING IEDQAVTD,RAVT                                   @Y17XAUV 14642000
         LA    R5,AVTOLTQB+4      ADDR OF TOTE ECB IN TOTE QCB @Y17XAUV 14644000
         ST    R5,RESTECBS        STORE IN WAIT PARM LIST      @Y17XAUV 14646000
         LA    R5,RESPL           LOAD ADDR OF RESPL           @YM07361 14648000
         ST    R5,AVTCWTOT        STORE IN TCAM AVT            @Y17XAUV 14650000
         LOAD  EP=IEDQWA1         LOAD INPUT DATA HANDLER      @Y17XAUV 14652000
         ST    R0,RESPLA1         COPY ENTRY POINT ADDR        @Y17XAUV 14654000
         SPACE 3                                               @Y17XAUV 14654200
RES005   EQU   *                                               @Y17XAUV 14654400
         WAIT  1,ECBLIST=RESTECBS WAIT FOR TOTE TASK REQUEST   @Y17XAUV 14654600
         XC    AVTOLTQB+D4(D4),AVTOLTQB+D4 CLEAR TOTE AVT ECB  @Y17XAUV 14654800
         XC    RESTECB1(D4),RESTECB1   CLEAR TOTE RESPL        @Y17XAUV 14655000
*                                                                       14655200
RES10A   EQU   *                                                        14656000
         L     R2,RESOBQCB        GET FIRST ELEMENT IN OLT              14756000
*                                   ACTIVE QUEUE                        14856000
         TM    AVTBIT1,AVTCLOSN   IS TCAM CLOSEDOWN IN PROGRESS?        14956000
         BZ    RES02              NO, CONTINUE                          15056000
RES011   EQU   *                                                        15156000
         USING TOTOBPTR,R2        SET UP ADDRESSIBILITY FOR OLTCB       15256000
         CLI   TOTELKEY,QENDKEY   IS OLT ACTIVE QUEUE EMPTY?            15356000
         BE    RESTERM            YES, GO EXIT TO TCAM         @Y17XAUV 15456000
         OI    TOTFLG04,TOTCLOSE  SET CLOSEDOWN IN PROGRES BIT   Y06330 15556000
         DETACH TOTTCBAD          DETACH ACTIVE SUBTASK          S05331 15656000
*                                                                       15756000
         L     R2,TOTELLNK-D1     GET NEXT OLTCB IN QUEUE               15856000
         B     RES011             BRANCH BACK AND EXAMINE NEXT OLTCB    15956000
         DROP  R2                 DROP OLTCB BASE                       16056000
*                                                                       16156000
RES02    EQU   *                                                        16256000
*                                                                     * 16356000
*        TEST OLT ACTIVE QUEUE                                        * 16456000
*                                                                     * 16556000
RES022   EQU   *                                                        16656000
         USING TOTOBPTR,R2        SET UP ADDRESSIBILITY FOR OLTCB       16756000
         CLI   TOTELKEY,QENDKEY   IS OLT ACTIVE QUEUE EMPTY?            16856000
         BE    RES030             YES, GO CHECK TRM QUEUE               16956000
         MVI   RESWBFNC,WAITING   SET CODE FOR OLT WAITING              17056000
         TM    TOTFLG10,TOTOLTED+TOTOLTRS+TOTTNTRQ+TOTOLTWT  TEST       17156000
*                                 DOES SUBTASK NEED RESOURCES?          17256000
         BZ    RES25              NO - CHECK NEXT OLTCB        @Y17XAUV 17356000
         LA    R1,RESPL           RESIDENT PARM LIST           @Y17XAUV 17456000
         LINK  EP=IEDQWB          TOTE RESOURCE MANAGER        @Y17XAUV 17556000
         B     WBRTNL(R15)        BRANCH TO WB RETURN LIST     @Y17XAUV 17656000
WBRTNL   DS    0H                                              @Y17XAUV 17756000
         B     RES10A             RETURN TO QUEUE PROCESSING   @Y17XAUV 17856000
         B     RES005             WAIT ON ECB LIST             @Y17XAUV 17956000
         B     RESTERM            TERMINATE TOTE TASK          @Y17XAUV 18056000
RES25    DS    0H                                              @Y17XAUV 18156000
         L     R2,TOTELLNK-D1     GET NEXT OLTCB IN QUEUE               18256000
         B     RES022             BRANCH BACK AND EXAMINE NEXT OLTCB    18356000
         DROP  R2                 DROP OLTCB BASE                       18456000
*                                                                       18556000
RES030   EQU   *                                                        18656000
*                                                                     * 18756000
*        TEST TRM QUEUE                                               * 18856000
*                                                                     * 18956000
         MVI   RESWBFNC,PROCTRM   SET CODE FOR TRM PROCESSING           19056000
         CLC   AVTOLTQB+1(3),AVTDELAD+1 IS QUEUE EMPTRY        @YM07728 19156000
         BE    RES005             YES, GO WAIT FOR ANOTHER REQUEST      19456000
         SPACE 1                                               @Y17XAUV 19656000
         LA    RPARM,RESPL        PARAMETER                    @Y17XAUV 19756000
         L     R15,RESPLA1        ADDR OF INPUT DATA HANDLER   @Y17XAUV 19856000
         BALR  R14,R15            CALL INPUT DATA HANDLER      @Y17XAUV 19956000
         B     WA1RTNL(R15)       BRANCH TO WA1 RETURN LIST    @Y17XAUV 20056000
WA1RTNL  DS    0H                                              @Y17XAUV 20156000
         B     RES10A             GO CHECK IF OLTCB NEEDS      @Y17XAUV 20256000
*                                  RESOURCES                   @Y17XAUV 20356000
         B     RES005             GO WAIT ON ECB LIST          @Y17XAUV 20456000
         SPACE 1                                               @Y17XAUV 20556000
**********                                                     @Y17XAUV 20656000
*        TERMINATION                                           @Y17XAUV 20756000
**********                                                     @Y17XAUV 20856000
RESTERM  DS    0H                                              @Y17XAUV 20956000
         DELETE EP=IEDQWA1        DELETE INPUT DATA HANDLER    @Y17XAUV 21056000
         L     R13,D4(R13)        LOAD CALLER'S SAVE AREA      @Y17XAUV 21156000
         LM    R14,R12,D12(R13)   RESTORE REGS                 @Y17XAUV 21256000
         BR    14                 RETURN TO CALLER             @Y17XAUV 21356000
         EJECT                                                 @Y17XAUV 21456000
*********************************************************************** 21556000
*                                                                     * 21656000
*        ALLOCATE BUFFER ROUTINE                               @Y17XAUV 21756000
*                                                              @Y17XAUV 21856000
*        INPUT  :  R0 - POINTS TO WORKAREA OF X'34' BYTES.     @Y17XAUV 21956000
*                  R1 - CONTAINS NUMBER OF UNITS TO GET.       @Y17XAUV 22056000
*                  R4 - POINTS TO TCAM AVT.                    @Y17XAUV 22156000
*                  R13,R14,R15 - STANDARD LINKAGE CONVENTIONS. @Y17XAUV 22256000
*                                                              @Y17XAUV 22356000
*        OUTPUT :  R1 - POINTS TO FIRST UNIT IN BUFFER.        @Y17XAUV 22456000
*                                                                     * 22556000
*********************************************************************** 22656000
         SPACE 3                                               @Y17XAUV 22756000
ALLOCBUF DS    0H                                              @Y17XAUV 22856000
         STM   R14,R12,D12(R13)   SAVE REGS                    @Y17XAUV 22956000
         USING ALLOCBUF,R15       TEMPORARY BASE REG           @Y17XAUV 23056000
         L     R12,RESBASE        LOAD MODULE BASE REGISTER    @Y17XAUV 23156000
         DROP  R15                DROP R12 AS BASE             @Y17XAUV 23256000
         USING IEDQAVTD,R4        TCAM AVT BASE                @Y17XAUV 23356000
         USING IEDTTCD,R5         WORK AREA BASE               @Y17XAUV 23456000
         USING IEDQPRF,R6         BUFFER PREFIX BASE           @Y17XAUV 23556000
         USING IEDPF1,R8          NEG BUFFER PREFIX BASE       @Y17XAUV 23656000
         USING IEDQLCB,R11        LCB BASE                     @Y17XAUV 23756000
         LR    R5,R0              COPY WORKAREA ADDR           @Y17XAUV 23856000
*                                                              @Y17XAUV 23956000
*        OBTAIN LCB ADDR. FIELDS USED ARE CONTAINED IN         @Y17XAUV 24056000
*        WORKAREA.                                             @Y17XAUV 24156000
*                                                              @Y17XAUV 24256000
         LA    R11,TTCSTOFF       OFFSET FROM BEGINNING OF LCB @Y17XAUV 24356000
         LCR   R11,R11            MAKE NEGATIVE NUMBER         @Y17XAUV 24456000
         ALR   R11,R5             OBTAIN START OF DUMMY LCB    @Y17XAUV 24556000
*                                                              @Y17XAUV 24656000
*        SET UP ERB FOR BUFFER REQUEST                         @Y17XAUV 24756000
*                                                              @Y17XAUV 24856000
         LA    R6,AVTBFREB        SET BUFFER REQUEST           @Y17XAUV 24956000
         ST    R6,LCBERBQB-D1      QCB IN ERB                  @Y17XAUV 25056000
         MVI   LCBERBPY,PRIINTRQ  SET PRIORITY OF POST         @Y17XAUV 25156000
         XC    LCBERBLK(D7),LCBERBLK CLEAR LINK,STATUS,CHAIN   @Y17XAUV 25256000
         MVI   LCBERBST,D2        APPLICATION PROGRAM STATUS   @Y17XAUV 25356000
         MVI   LCBRBCT1,D1        NUMBER OF BUFFERS IS 1       @Y17XAUV 25456000
         STC   R1,LCBRBCT2        NUMBER OF UNITS              @Y17XAUV 25556000
*                                                              @Y17XAUV 25656000
         LA    R6,TTCQCB          PLACE ADDR OF WORKAREA'S     @Y17XAUV 25756000
         ST    R6,LCBRCQCB         QCB INTO THE LCB            @Y17XAUV 25856000
         XC    LCBSTAT1(D2),LCBSTAT1 CLEAR LCB STATUS FIELDS   @Y17XAUV 25956000
*                                                              @Y17XAUV 26056000
*        POST ERB AND WAIT FOR UNITS                           @Y17XAUV 26156000
*                                                              @Y17XAUV 26256000
         LA    R1,LCBERB          ADDR OF ERB                  @Y17XAUV 26356000
         ICM   R1,D8,ERBCODE      INDICATES ERB REQUEST        @Y17XAUV 26456000
         ST    R14,D0(R13)         SAVE RETURN REG             @Y17XAUV 26556000
         ST    R15,D4(R13)        SAVE ENTRY POINT             @Y17XAUV 26656000
         ST    R12,D8(R13)        SAVE BASE REG                @Y17XAUV 26756000
         LA    R15,POSTWAIT       GET ADDR OF POST WAIT ROUTINE@Y17XAUV 26856000
         L     R0,D20(R13)        RESTORE REGS 0               @Y17XAUV 26956000
         LM    R2,R12,D28(R13)    RESTORE REGS 2 - 12          @Y17XAUV 27056000
         BALR  R14,R15            POST ERB AND WAIT            @Y17XAUV 27156000
*                                                              @Y17XAUV 27256000
         L     R15,D4(R13)        RESTORE ENTRY POINT          @Y17XAUV 27356000
         L     R14,D0(R13)        RESTORE RETURN REG           @Y17XAUV 27456000
         STM   R14,R12,D12(R13)   SAVE REGS AGAIN              @Y17XAUV 27556000
         L     R12,D8(R13)        RESTORE BASE REG             @Y17XAUV 27656000
*                                                              @Y17XAUV 27756000
*        CLEAR EACH BUFFER UNIT EXCEPT FOR UNIT CONTROL AREA   @Y17XAUV 27856000
*                                                              @Y17XAUV 27956000
         LR    R5,R0              WORKAREA ADDRESSIBILITY      @Y17XAUV 28056000
         LR    R6,R1              COPY ADDR OF UNITS           @Y17XAUV 28156000
         SR    R9,R9              CLEAR                        @Y17XA7V 28256000
         TM    AVTSAVTF,AVTVTMCP  IS THERE NCP SUPPORT         @Y17XAUV 28356000
         BNO   NONCP              NO - BRANCH                  @Y17XAUV 28456000
         LA    R9,PRF1LEN         LENGTH OF NEG PREFIX         @Y17XAUV 28556000
         LCR   R9,R9              MAKE A NEG VALUE             @Y17XAUV 28656000
NONCP    DS    0H                                              @Y17XAUV 28756000
         SLR   R7,R7              CLEAR                        @Y17XAUV 28806000
         ICM   R7,D3,AVTKEYLE     GET UNIT SIZE                @Y17XAUV 28856000
         BCTR  R7,R0              DECREMENT FOR EXECUTE        @Y17XAUV 28956000
CLRBUFUT DS    0H                                              @Y17XAUV 29056000
         EX    R7,CLRINSTR        CLEAR UNIT                   @Y17XAUV 29156000
         LTR   R8,R9              DOES UNIT HAVE NEG PREFIX ?  @Y17XAUV 29256000
         BZ    CLRBRNCH           NO - BRANCH                  @Y17XAUV 29356000
         ALR   R8,R6              COPY ADDR OF BUFFER          @Y17XAUV 29456000
         XC    IEDPF1(PRF1LEN),IEDPF1 CLEAR NEG PREFIX         @Y17XAUV 29556000
CLRBRNCH DS    0H                                              @Y17XAUV 29656000
         L     R6,PRFTIC          LOAD TIC FIELD               @Y17XAUV 29756000
         EX    R6,CHKTIC          IS THIS THE LAST UNIT ?      @Y17XAUV 29856000
         BZ    CLRBUFUT           NO - CLEAR NEXT UNIT         @Y17XAUV 29956000
*                                                              @Y17XAUV 30056000
         LM    R14,R12,D12(R13)   RESTORE REGISTERS            @Y17XAUV 30156000
         BR    R14                RETURN                       @Y17XAUV 30256000
         DROP  R4                                              @Y17XAUV 30356000
         DROP  R5                                              @Y17XAUV 30456000
         DROP  R6                                              @Y17XAUV 30556000
         DROP  R8                                              @Y17XAUV 30656000
         DROP  R11                                             @Y17XAUV 30756000
         EJECT                                                 @Y17XAUV 30856000
*********************************************************************** 30956000
*                                                                     * 31056000
*        FREE BUFFER ROUTINE                                   @Y17XAUV 31156000
*                                                              @Y17XAUV 31256000
*        INPUT  :  R0 - POINTS TO WORKAREA OF X'34' BYTES.     @Y17XAUV 31356000
*                  R1 - POINTS TO ONE BUFFER.                  @Y17XAUV 31456000
*                  R4 - POINTS TO TCAM ACT.                    @Y17XAUV 31556000
*                  R13,R14,R15 - STANDARD LINKAGE CONVENTIONS. @Y17XAUV 31656000
*                                                                     * 31756000
*********************************************************************** 31856000
         SPACE 3                                               @Y17XAUV 31956000
FREEBUF  DS    0H                                              @Y17XAUV 32056000
*                                                              @Y17XAUV 32156000
         STM   R14,R12,D12(R13)   SAVE REGS                    @Y17XAUV 32256000
         LR    R5,R0              COPY WORKAREA ADDR           @Y17XAUV 32356000
         USING FREEBUF,R15        TEMPORARY BASE REG           @Y17XAUV 32456000
         L     R12,RESBASE        LOAD MODULE BASE ADDR        @Y17XAUV 32556000
         DROP  R15                DROP TEMPORARY               @Y17XAUV 32656000
         USING IEDQAVTD,R4        TCAM AVT                     @Y17XAUV 32756000
         USING IEDTTCD,R5         WORKAREA BASE                @Y17XAUV 32856000
*                                                              @Y17XAUV 32956000
*        COUNT NUMBER OF UNITS                                 @Y17XAUV 33056000
*                                                              @Y17XAUV 33156000
         USING IEDQPRF,R6         BUFFER PREFIX                @Y17XAUV 33256000
         LR    R6,R1              COPY ADDR OF 1ST UNIT        @Y17XAUV 33356000
         XC    PRFLINK(D3),PRFLINK INSURE CLEAR FOR POSTWAIT   @Y17XAUV 33456000
         SR    R7,R7              CLEAR FOR USE AS COUNTER     @Y17XAUV 33556000
NEXTUNIT DS    0H                                              @Y17XAUV 33656000
         EX    R6,CHKTIC          CHECK FOR INVALID TIC        @Y17XAUV 33756000
         BNZ   ENDBUF             BRANCH IF LAST UNIT          @Y17XAUV 33856000
         MVI   PRFTIC,TICCODE     SET TIC CCW CMND             @Y17XAUV 33956000
         L     R6,PRFTIC          POINT TO NEXT BUFFER UNIT    @Y17XAUV 34056000
         BCT   R7,NEXTUNIT        INCREMENT COUNT AS NEGATIVE  @Y17XAUV 34156000
         DROP  R6                                              @YM07685 34206000
*                                                              @Y17XAUV 34256000
ENDBUF   DS    0H                                              @Y17XAUV 34356000
         LPR   R7,R7              MAKE COUNT NON-NEGATIVE      @Y17XAUV 34456000
*                                                              @Y17XAUV 34556000
*        POST UNITS TO BUFFER RETURN                           @Y17XAUV 34656000
*                                                              @Y17XAUV 34756000
         USING IEDQPRF,R1         BASE ON FIRST UNIT           @Y17XAUV 34856000
         LA    R8,AVTBFRTB        PLACE QCB ADDR IN            @YM08007 34956000
         ST    R8,PRFQCBA-1        BUFFER PREFIX               @Y17XAUV 35056000
         MVI   PRFPRI,PRIBFRTB    SET POST PRIORITY            @Y17XAUV 35156000
         STC   R7,PRFNBUNT        SET NUMBER OF UNITS IN BUF   @Y17XAUV 35256000
         LA    R1,D0(R1)          INDICATE NO WAIT AFTER POST  @Y17XAUV 35356000
         ST    R14,D0(R13)        SAVE RETURN REG              @Y17XAUV 35456000
         ST    R15,D4(R13)        SAVE ENTRY POINT             @Y17XAUV 35556000
         ST    R12,D8(R13)        SAVE BASE REG                @Y17XAUV 35656000
         LA    R15,POSTWAIT       GET ADDR OF POST WAIT ROUTINE@Y17XAUV 35756000
         L     R0,D20(R13)        RESTORE REGS 0               @Y17XAUV 35856000
         LM    R2,R12,D28(R13)    RESTORE REGS 2 - 12          @Y17XAUV 35956000
         BALR  R14,R15            POST ERB AND WAIT            @Y17XAUV 36056000
*                                                              @Y17XAUV 36156000
         L     R15,D4(R13)        RESTORE ENTRY POINT          @Y17XAUV 36256000
         L     R14,D0(R13)        RESTORE RETURN REG           @Y17XAUV 36356000
         BR    R14                RETURN                       @Y17XAUV 36456000
         DROP  R1                                              @Y17XAUV 36556000
         DROP  R4                                              @Y17XAUV 36656000
         DROP  R5                                              @Y17XAUV 36756000
         EJECT                                                 @Y17XAUV 36856000
*********************************************************************** 36956000
*                                                                     * 37056000
*        TOTE POST AND WAIT ROUTINE                            @Y17XAUV 37156000
*                                                              @Y17XAUV 37256000
*        INPUT  :  R0 - POINTS TO WORKAREA OF X'34' BYTES.     @Y17XAUV 37356000
*                  R1 - HIGH ORDER BYTE CONTAINS A CODE:       @Y17XAUV 37456000
*                       X'00' - NO WAIT IS NEEDED              @Y17XAUV 37556000
*                       X'80' - WAIT IS TO BE PERFORMED AND    @Y17XAUV 37656000
*                               GENERAL REQUEST ELEMENT IS     @Y17XAUV 37756000
*                               POINTED TO IN LOWER 3 BYTES    @Y17XAUV 37856000
*                       X'C0' - WAIT AND ERB IS POINTED TO     @Y17XAUV 37956000
*                       X'E0' - POST AND WAIT, NO ELEMENT IS   @Y17XAUV 38056000
*                               RETURNED                       @Y17XAUV 38156000
*                     - LOW ORDER 3 BYTES CONTAIN ELEMENT TO   @Y17XAUV 38256000
*                       BE POSTED.                             @Y17XAUV 38356000
*                  R4 - POINTS TO TCAM ACT.                    @Y17XAUV 38456000
*                  R13,R14,R15 - STANDARD LINKAGE CONVENTIONS. @Y17XAUV 38556000
*                                                              @Y17XAUV 38656000
*        OUTPUT :  R1 - POINTS TO THE ELEMENT BEING RETURNED   @Y17XAUV 38756000
*                       OR BUFFER UNITS IF INPUT WAS AN ERB.   @Y17XAUV 38856000
*                                                                     * 38956000
*********************************************************************** 39056000
         SPACE 3                                               @Y17XAUV 39156000
POSTWAIT DS    0H                                              @Y17XAUV 39256000
         STM   R14,R12,D12(R13)   SAVE REGS                    @Y17XAUV 39356000
         LR    R5,R0              COPY WORKAREA ADDR           @YM07641 39456000
         USING IEDTTCD,R5         WORKAREA BASE                @Y17XAUV 39556000
         USING IEDQAVTD,R4        TCAM AVT                     @Y17XAUV 39656000
         USING IEDQPRF,R6         BUFFER PREFIX BASE           @Y17XAUV 39756000
         USING IEDREQD,R8         GENERAL REQUEST ELEMENT      @Y17XAUV 39856000
         USING IEDQLCB,R11        LINE CONTROL BLOCK           @YM07748 39906000
         USING POSTWAIT,R15       TEMPORARY BASE REG           @Y17XAUV 39956000
         L     R12,RESBASE        LOAD MODULE BASE REG         @Y17XAUV 40056000
         DROP  R15                DROP TEMPORARY BASE REG      @Y17XAUV 40156000
*                                                              @Y17XAUV 40256000
*        SET UP SVC 102 LIST                                   @Y17XAUV 40356000
*                                                              @Y17XAUV 40456000
         LA    R6,D0(R1)          COPY ADDR OF CHAIN OF ELMTS  @Y17XAUV 40556000
         ST    R6,TTCSVCW1        SET PTR TO FIRST IN PARM LIST@Y17XAUV 40656000
GETNEXT  DS    0H                                              @Y17XAUV 40756000
         CLC   PRFLINK(D3),WORD0  IS THIS ELMT LAST IN CHAIN ? @YM07735 40856000
         BZ    LASTUNIT           Y - BRANCH                   @Y17XAUV 40956000
         ICM   R6,D7,PRFLINK      POINT TO NEXT ELEMENT        @Y17XAUV 41056000
         B     GETNEXT                                         @Y17XAUV 41156000
LASTUNIT DS    0H                                              @Y17XAUV 41256000
         ST    R6,TTCLAST         SET PTR TO LAST IN PARM LIST @Y17XAUV 41356000
         MVI   TTCPCODE,TTCCHAIN  SET CODE FOR CHAIN POST      @Y17XAUV 41456000
*                                                              @Y17XAUV 41556000
*        SET UP QCB IF WAIT DESIRED                            @Y17XAUV 41656000
*                                                              @Y17XAUV 41756000
         LTR   R8,R1              COPY AND TEST WAIT BIT       @Y17XAUV 41856000
         BNM   POSTELMT           IF OFF - DON'T SET QCB       @Y17XAUV 41956000
         MVC   TTCQBELC-1(D4),AVTDELAD SET CHAIN PTR WITH DUMMY@Y17XAUV 42056000
         MVI   TTCQBFLG,D2        ATTACHED TASK QCB            @Y17XAUV 42156000
         XC    TTCQBECB(D4),TTCQBECB CLEAR ECB                 @Y17XAUV 42256000
         LA    R6,TTCQCB          LOAD ADDR OF DUMMY QCB       @Y17XAUV 42356000
         ST    R6,TTCQSTCB        POINT QCB TO SELF            @Y17XAUV 42456000
         CLM   R8,D8,CODEREQ      WAS INPUT A REQUEST ELEMT?   @Y17XAUV 42556000
         BNE   POSTELMT           NO - BRANCH                  @Y17XAUV 42656000
         STCM  R6,D7,REQRQCBA     SET AS RETURN QCB ADDR       @YM07770 42756000
*                                                              @Y17XAUV 42856000
*        SET UP SVC 102 PARM LIST AND POST ELEMENT             @Y17XAUV 42956000
*                                                              @Y17XAUV 43056000
POSTELMT DS    0H                                              @Y17XAUV 43156000
         LA    R1,TTCSVCPL        SET POINTER TO PARM LIST     @Y17XAUV 43256000
         AQCTL                    POST ELEMENT                 @Y17XAUV 43356000
*                                                              @Y17XAUV 43456000
         LTR   R8,R8              CHECK WAIT BIT               @Y17XAUV 43556000
         BNM   NOWAIT             BYPASS WAIT IF OFF           @Y17XAUV 43656000
*                                                              @Y17XAUV 43756000
         WAIT  ECB=TTCQBECB       WAIT                         @Y17XAUV 43856000
*                                                              @Y17XAUV 43956000
         CLM   R8,D8,ERBCODE      IS THIS FOR AN ERB ?         @YM07748 43965000
         BNE   NOTERB             NO - BRANCH                  @YM07748 43974000
         LA    R11,TTCSTOFF       OFFSET OF LCBRCQCB           @YM07748 43983000
         LCR   R11,R11            MAKE IT NEGATIVE             @YM07748 43992000
         ALR   R11,R5             START OF DUMMY LCB           @YM07748 44001000
         L     R1,LCBERBCH-1      POINT TO FIRST UNIT OF BUF   @YM07748 44010000
         LA    R1,0(R1)           CLEAR HI ORDER BYTE          @YM07748 44019000
         B     SAVELMPT           GO SAVE REG 1 IN SAVE AREA   @YM07748 44028000
NOTERB   DS    0H                 NOT ERB - QCB CHAIN POINTER  @YM07748 44037000
*                                  POINTS TO ELEMENT           @YM07748 44046000
         L     R1,TTCQBELC-D1     SET WITH ADDR OF ELEMENT     @Y17XAUV 44056000
         LA    R1,D0(R1)          CLEAR HIGH ORDER BYTE        @Y17XAUV 44156000
SAVELMPT DS    0H                                              @YM07748 44206000
         ST    R1,D24(R13)        STORE IN REG 1 SAVE LOCATION @Y17XAUV 44256000
NOWAIT   DS    0H                                              @Y17XAUV 44356000
         LM    R14,R12,D12(R13)   RESTORE REGS                 @Y17XAUV 44456000
         BR    R14                RETURN                       @Y17XAUV 44556000
         DROP  R4                                              @Y17XAUV 44656000
         DROP  R5                                              @Y17XAUV 44756000
         DROP  R6                                              @Y17XAUV 44856000
         DROP  R8                                              @Y17XAUV 44956000
         DROP  R11                                             @YM07748 45006000
         DROP  R12                                             @Y17XAUV 45056000
         EJECT                                                 @XM05672 45057000
***************************************************************@XM05672 45058000
*                                                              @XM05672 45059000
*        HIERARCHY SCAN ROUTINTE:                              @XM05672 45060000
*        THIS ROUTINE SCANS THE HIERARCHY UNDER A GIVEN        @XM05672 45061000
*        RESOURCE AND RESETS THE TOTE BITS.                    @XM05672 45062000
*        PARMS:  R1  = TTCIN OF GIVEN RESOURCE RIGHT JUSTIFIED @XM05672 45063000
*                R4  = AVT ADDRESS                             @XM05672 45064000
*                R13,R14,R15 = STANDARD LINKAGE                @XM05672 45065000
***************************************************************@XM05672 45066000
*                                                              @XM05672 45067000
*        REGSITER CONVENTIONS:                                 @XM05672 45068000
*        R1    = TTE BASE AND PARAMETER REGISTER               @XM05672 45069000
*        R4    = AVT BASE REGISTER                             @XM05672 45070000
*        R5    = LENGTH OF TTE NEGATIVE PREFIX                 @XM05672 45071000
*        R6    = TOP TTCIN                                     @XM05672 45072000
*        R7    = CURRENT TTCIN                                 @XM05672 45073000
*        R12   = BASE REGISTER                                 @XM05672 45074000
*        R13,R14,R15 = STANDARD USAGES                         @XM05672 45075000
*                                                              @XM05672 45076000
HIERSCAN DS    0H                                              @XM05672 45077000
         STM   R14,R12,12(R13)          SAVE REGS              @XM05672 45078000
         USING HIERSCAN,R15             SET TEMPORARY BASE     @XM05672 45079000
         L     R12,RESBASE              SET BASE REG           @XM05672 45080000
         DROP  R15                      DROP TEMPORARY BASE    @XM05672 45081000
         USING IEDQWA,R12               MODULE ADDRESSABILITY  @XM05672 45082000
         USING IEDNTRM,R1               TTE ADDRESSABILTIY     @XM05672 45083000
         USING IEDQAVTD,R4              AVT ADDRESSABILITY     @XM05672 45084000
         SLR   R7,R7                    CLEAR FOR TTCIN HOLD   @XM05672 45085000
         LR    R6,R1                    TOP TTCIN              @XM05672 45086000
         L     R15,AVTRNMPT             CONVERSION ROUTINE     @XM05672 45087000
         BALR  R14,R15                  CONVERT TTCIN TO TTE   @XM05672 45088000
         LA    R5,TRMPRFSZ              LENGTH OF NEG PREFIX   @XM05672 45089000
         SLR   R1,R5                    POINT TO NEG PREFIX    @XM05672 45090000
         BAL   R3,COMSWAP               TURN OFF TOTE FLAG     @XM05672 45091000
         ICM   R7,3,TRMSUBST            CURRENT TTINC=SUBSTRUCT@XM05672 45092000
         LTR   R7,R7                    Q-SUBSTRUCT ZERO       @XM05672 45093000
         BZ    HIEREND                  Y-NO INFERIOR RESOURCES@XM05672 45094000
*        LOOP THROUGH ALL RESOURCES UNDER TOP TTCIN            @XM05672 45095000
TOPLOOP  DS    0H                                              @XM05672 45096000
         CLR   R6,R7                    Q-TOP = CURRENT TTCIN  @XM05672 45097000
         BE    HIEREND                  Y-END OF HIER SCAN     @XM05672 45098000
         LR    R1,R7                    COPY CURRENT TTCIN     @XM05672 45099000
         L     R15,AVTRNMPT             CONVERSION ROUTINE     @XM05672 45100000
         BALR  R14,R15                  CONVERT TO TTE ADDR    @XM05672 45101000
         SLR   R1,R5                    POINT TO NEG PREFIX    @XM05672 45102000
         TM    TRMBYTE1,TRMSTOTE        Q-ALREADY RESET        @XM05672 45103000
         BNZ   CHKSUBST                 N-GO GET SUBSTRUCT     @XM05672 45104000
         ICM   R7,3,TRMCOHRT            CURRENT = COHORT       @XM05672 45105000
         B     TOPLOOP                  GO TO TOP OF LOOP      @XM05672 45106000
CHKSUBST DS    0H                                              @XM05672 45107000
         BAL   R3,COMSWAP               TOFF TOTE FLAG         @XM05672 45108000
         ICM   R7,3,TRMSUBST            GET SUBSTRUCT          @XM05672 45109000
         LTR   R7,R7                    Q-IS SUBSTRUCT ZERO    @XM05672 45110000
         BNZ   TOPLOOP                  N-GO TO TOP OF LOOP    @XM05672 45111000
         ICM   R7,3,TRMCOHRT            CURRENT = COHORT       @XM05672 45112000
         B     TOPLOOP                  GO TO TOP OF LOOP      @XM05672 45113000
HIEREND  DS    0H                                              @XM05672 45114000
         LM    R14,R12,12(R13)          RESTORE REGS           @XM05672 45115000
         BR    R14                      RETURN                 @XM05672 45116000
*                                                              @XM05672 45117000
*        TURN OFF TRMSTOTE BIT USING COMPARE AND SWAP INSTR    @XM05672 45118000
COMSWAP  DS    0H                                              @XM05672 45119000
         L     R10,TRMBYTE2             WORD WITH TRMSTOTE BIT @XM05672 45120000
SWAPLOOP DS    0H                                              @XM05672 45121000
         LR    R11,R10                  COPY WORD              @XM05672 45122000
         N     R11,TOTEOFF              TURN OFF TRMSTOTE      @XM05672 45123000
         CS    R10,R11,TRMBYTE2          AND STORE IN TTE      @XM05672 45124000
         BNE   SWAPLOOP                 BR IF UNSUCCESSFUL     @XM05672 45125000
         BR    R3                       RETURN                 @XM05672 45126000
         DROP  R12                                             @XM05672 45127000
         DROP  R1                                              @XM05672 45128000
         DROP  R4                                              @XM05672 45129000
         USING IEDQWA,R11                                      @Y17XAUV 45156000
         EJECT                                                          56000022
*********************************************************************** 56100022
*                                                                     * 56200022
*        OLT END OF TASK EXIT ROUTINE                                 * 56300022
*                                                                     * 56400022
*********************************************************************** 56500022
         SPACE 2                                                        56600022
OLTETXR  EQU   *                                                        56700022
         STM   R14,R12,D12(R13)   SAVE CALLER'S REGISTERS               56800022
         USING OLTETXR,R15        SET UP BASE REGISTER                  56900022
         L     R11,RESBASE        GET RESIDENT MODULE BASE              57000022
         DROP  R15                DROP BASE REGISTER                    57100022
         USING TCBRBPA,R1         SET UP ADDRESSIBILITY FOR TCB         57200022
         L     R2,RESOBFWD        GET ADDRESS OF FIRST OLTCB IN QUEUE   57300022
ETXR04   EQU   *                                                        57400022
         USING TOTOBPTR,R2        SET UP ADDRESSIBILITY FOR OLTCB       57500022
         CLI   TOTELKEY,QENDKEY   IS IT DUMMY LAST ELEMENT?             57600022
         BE    ETXR08             YES, BRANCH                           57700022
         C     R1,TOTTCBAD        IS THIS THE CORRECT OLTCB?            57800022
         BE    ETXR06             YES, BRANCH                           57900022
         L     R2,TOTELLNK-D1     GET NEXT OLTCB IN QUEUE               58000022
         B     ETXR04             GO EXAMINE NEXT OLTCB                 58100022
ETXR06   EQU   *                                                        58200022
         MVC   TOTCMPCD(D4),TCBCMPA  MOVE TASK COMPLETION CODE TO OLTCB 58300022
         DETACH TOTTCBAD          DETACH SUBTASK                        58400022
         OI    TOTFLG10,TOTOLTED  SET OLT ENDED FLAG                    58500022
         POST  RESTECB1           POST ECB                              58600022
         DROP  R1                 DROP TCB BASE                  S22024 58700000
ETXR08   EQU   *                                                 S22024 58708000
         LM    R14,R12,D12(R13)   RESTORE CALLER'S REGISTERS     S22024 58716000
         BR    R14                RETURN TO CALLER               S22024 58724000
         EJECT                                                          58732000
**************************************************************** S22024 59268000
*                                                              * S22024 59302022
*              OLT STAE EXIT ROUTINE                           * S22024 59304022
*                                                              * S22024 59306022
**************************************************************** S22024 59308022
         SPACE 2                                                        59310022
STAERT   EQU   *                                                 S22024 59312022
         STM   R14,R12,D12(R13)   SAVE CALLER'S REGISTERS        S22024 59314022
         USING STAERT,R15         SET UP BASE                    S22024 59314200
         L     R11,RESBASE        GET RESIDENT MODULE BASE       S22024 59314400
         DROP  R15                DROP BASE REGISTER             S22024 59314600
         LA    R0,D72             GET LENGTH OF SAVE AREA        S22024 59314800
         GETMAIN  R,LV=(0)        GET CORE FOR SAVE AREA         S22024 59315000
         LR    R12,R1             SAVE AREA ADDRESS              S22024 59315200
         ST    R13,D4(R12)        SAVE CALLERS SAVE AREA ADDRESS S22024 59315400
         ST    R12,D8(R13)        SAVE ADDRESS OF STAE SAVE AREA S22024 59315600
         LR    R13,R12            MY SAVE AREA ADDRESS IN REG 13 S22024 59315800
         L     R2,RESOBFWD        GET ADDRESS OF FIRST OLTCB     S22024 59322022
*                                   IN QUEUE                     S22024 59324022
STAERT10 EQU   *                                                 S22024 59326022
         USING TOTOBPTR,R2        SET UP ADDRESSIBILITY FOR OLTCBS22024 59328022
         CLI   TOTELKEY,QENDKEY   IS IT DUMMY LAST ELEMENT?      S22024 59330022
         BE    STAERT30           YES, GO EXIT                   S22024 59332022
         L     R1,SIXTEEN         GET POINTER TO CVT             S22024 59334022
         L     R1,D0(R1)          GET ADDRESS OF TCB POINTERS    S22024 59336022
         L    R1,D4(R1)                GET ACTIVE TCB ADDRESS    S22024 59338000
         C     R1,TOTTCBAD        IS THIS THE CORRECT OLTCB?     S22024 59340022
         BE    STAERT20           YES, BRANCH                    S22024 59342022
         L     R2,TOTELLNK-D1     GET NEXT OLTCB IN QUEUE        S22024 59344022
         B     STAERT10           GO EXAMINE NEXT OLTCB          S22024 59346022
STAERT20 EQU   *                                                 S22024 59348022
         POST  TOTOTECB           POST TOTE SUBTASK ECB          Y06330 59348305
         POST  TOTPRECB           POST PRIMARY DEVICE ECB        Y06330 59348605
         POST  TOTSCECB           POST SECONDARY DEVICE ECB      Y06330 59348905
         TM    $OLTFLGS,$CLEANRT  DOES OLT HAVE A CLEANUP        S22024 59350022
*                                   ROUTINE?                     S22024 59352022
         BNO   STAERT30           NO, RETURN TO ABTERM           S22024 59354022
         OI    $EXECFLG,$CLEANUP  YES, SET SECTION ENTERED FOR   S22024 59356022
*                                   CLEANUP FLAG                 SI2024 59358022
         L     R15,TOTOLTEN       GET OLT ENTRY POINT ADDRESS    S22024 59360000
         L     R15,D12(R15)       GET OLT ACTUAL ENTRY POINT ADDRS22024 59362000
         LA    R1,TOTOLTPL        SET UP PARM LIST ADDRESS       S22024 59364000
         BALR  R14,R15            BRANCH TO OLT                  S22024 59366022
STAERT30 EQU   *                                                 S22024 59368022
         L     R13,D4(R13)             GET CALLERS SAVE AREA     S22024 59369000
         LR    R1,R12             GET ADDRESS OF CORE TO BE FREEDS22024 59369200
         LA    R0,D72             LENGTH OF CORE TO BE FREED     S22024 59369400
         FREEMAIN  R,LV=(0),A=(1)      FREE SAVE AREA            S22024 59369600
         LM    R14,R12,D12(R13)   RESTORE CALLER'S REGISTERS     S22024 59370022
         BR    R14                RETURN TO CALLER               S22024 59372022
         DROP  R2                 DROP OLTCB BASE                S22024 59374022
         DROP  R11                DROP R11 AS MODULE BASE REG  @Y17XAUV 59374600
         USING IEDQWA,R12         RESTORE R12 AS MODULE BASE   @Y17XAUV 59375200
         EJECT                                                          59376022
**************************************************************** S22024 59378022
*                                                                       59400022
*        SERVICE MODULE MANAGER                                @Y17XAUV 59500000
*                                                                       59600022
*********************************************************************** 59700022
*                                                                       59800022
SMGR     EQU   *                                                        59900022
*                                                                       60000022
*        PERFORM INITIALIZATION                                         60100022
*                                                                       60200022
         STM   R14,R12,D12(R13)   SAVE CALLER'S REGISTERS               60300022
         USING TOTOLTCB,R2        SET UP ADDRESSIBILITY FOR OLTCB       60320022
         ST    R14,TOTSMGRT       SAVE CALLER'S RETURN ADDRESS          60340022
*                                   TO BE USED BY THE SERVICE MODULE    60360022
         USING SMGR,R15                                                 60380022
         L     R12,RESBASE        SET UP BASE REGISTER                  60400000
         DROP  R15                                                      60420022
         ST    R1,TOTPARML        SAVE ADDRESS OF PARAMETER     SA41612 60440022
*                                   LIST                        SA41612 60450022
         LA    R5,TOTSAVE3        GET SERVICE MANAGER SAVE AREA         60460022
*                                   ADDRESS                             60480022
         ST    R13,D4(R5)         SAVE ADDRESS OF CALLER'S SAVE AREA    60500022
         ST    R5,D8(R13)         SAVE ADDRESS OF SERVICE MANAGER'S     60520022
*                                   SAVE AREA                           60540022
         LR    R13,R5             PUT SAVE AREA ADDRESS INTO REG 13     60560022
         SPACE 2                                                        60580022
         TM    TOTFLG06,TOTWACAN  IS CANCEL REQUEST PENDING FLAG SET?   60600022
         BZ    XMGR00             NO, BRANCH                            60620022
         NI    TOTFLG06,XFF-TOTWACAN  YES, TURN OFF CANCEL REQUEST      60640022
*                                       PENDING FLAG                    60660022
SMGR002  EQU   *                                                        60680022
         TM    $OLTFLGS,$CLEANRT  DOES OLT HAVE A CLEANUP ROUTINE?      60700022
         BNO   EXIT               NO, BRANCH TO IEDQWF                  60720022
         OI    $EXECFLG,$CLEANUP  YES, SET SECTION ENTERED FOR          60740022
*                                   CLEANUP FLAG                        60760022
         L     R3,TOTOLTEN        GET START OF OLT               S05331 60761000
         USING PSPREF,R3          SET UP BASE FOR SECTION PREFACES05331 60762000
         LH    R14,RTNDISP        GET DISPLACEMENT TO ROUTINE    S05331 60763000
         AR    R14,R3             GET ADDRESS OF ROUTINE         S05331 60764000
         USING SPREF,R14          SET UP BASE FOR RTN PREFACE    S05331 60765000
         TM    #FLAG,#MSGIDRQ     MESSAGE ID PROVIDED?           S05331 60766000
         BZ    NOID               NO, BRANCH                     S05331 60767000
         MVC   $MSGIDAC(D2),MSGID MOVE ID FROM SECTION PREFACE   S05331 60768000
*                                   TO SCT                       S05331 60769000
NOID     EQU   *                                                 S05331 60770000
         LA    R13,TOTSAVE4       GET ADDRESS OF IEDQWF'S SAVE AREA     60780022
         LM    R14,R12,D12(R13)   RESTORE IEDQWF'S REGISTERS            60800022
         BR    R15                BRANCH TO OLT                         60820022
         SPACE 1                                                        60840022
EXIT     EQU   *                                                        60860022
         LA    R13,TOTSAVE4       GET TEST CONTROL SAVE ADDRESS         60880022
         LM    R14,R12,D12(R13)   RESTORE TEST CONTROL REGISTERS        60900022
         LA    R15,D1             SET RETURN CODE TO 1                  60920022
         BR    R14                RETURN TO IEDQWF TO CANCEL TEST       60940022
*                                   FOR TERMINATION                     60960022
         SPACE 1                                                        60980022
XMGR00   EQU   *                                                        61000022
         LR    R5,R1              SAVE PARAMETER LIST ADDRESS           61020022
         USING XMGRPARM,R5        SET UP ADDRESSIBILITY FOR PARM LIST   61040022
*                                                                       61060022
         TM    TOTFLG02,XFF       ARE ANY SERVICE FLAGS SET?            61080022
         BZ    RTN005             NO, BRANCH                     S22024 61100000
SMGR02   EQU   *                                                        61120022
         TM    TOTFLG06,TOTNCMFG  NON-CONCURRENT MODE ASKED?            61140022
         BO    RTN005             YES, BYPASS START LINE                61160022
         L     R8,TOTPARML              GET PARM LIST ADDR     @YA11128 61165058
         CLC   D2(D2,R8),MODRTN         IS THIS A ROUTINE MACRO@Y17XAUV 61170000
         BE    RTN005                   LET QW47 DO STARTLINE  @YA11128 61175058
         TM    $TOTFLG1,$LINESHR  IS LINE SHARING REQUESTED?            61180022
         BZ    RTN005             NO, DO NOT START LINE                 61200022
         USING IOBLOCKS,R7        SET UP ADDRESSIBILITY FOR IOBLOCKS    61220022
         L     R7,TOTSAVE5        GET ADDRESS OF CURRENT        SA41599 61224022
*                                   PRIMARY TEST DEVICE         SA41599 61228022
         TM    D0(R7),TOTTDLST    WAS LINE INITIALLY STOPPED?   SA41599 61232022
         BO    RTN005             YES, DO NOT START LINE        SA41599 61236022
         TM    D0(R7),TOTTDORN    IS TEST DEVICE ON 3705?        S22024 61237000
         BO    RTN005             YES, BYPASS STARTLINE          S22024 61238000
         LA    R7,TOTPRIBK        SET UP TO START PRIMARY LINE          61240022
         BAL   R8,STRTLINE        START PRIMARY LINE                    61260022
         B     RTN004A            SEE IF SECONDARY LINE SHOULD          61280022
*                                   BE STARTED                          61300022
         SPACE 2                                                        61320022
*********************************************************************** 61340022
*                                                                     * 61360022
*        START LINE VIA TCAM'S OP-CONTROL FACILITY                    * 61380022
*                                                                     * 61400022
*********************************************************************** 61420022
STRTLINE EQU   *                                                        61440022
         STM   R6,R12,STRTSAVE    SAVE REGS DURING STARTLINE            61460022
         MVI   TOTOVBCD,LINESTRT  MOVE IN STARTLINE VERB CODE    S22024 61480000
         L     R6,TOTAVTPT        GET ADDRESS OF AVT                    61500022
         USING IEDQAVTD,R6        SET UP ADDRESSIBILITY FOR AVT         61520022
         LA    R10,AVTOPCOB       GET POINTER TO OP CONTROL QCB         61540022
         ST    R10,TOTOKEY        PUT IN PARAMETER LIST          S22024 61560000
         MVI   TOTOKEY,OPCKEY     SET KEY TO ZERO                S22024 61564000
         MVI   TOTOELNG,OPCELNG   SET ELEMENT LENGTH TO X'18'    S22024 61568000
         MVI   TOTOPRI,OPCPRI     SET OP CONTROL PRIORITY OF 'DC'S22024 61572000
         MVI   TOTORTCD,OPCRTCD   ZERO OUT RETURN CODE FIELD     S22024 61576000
         DROP  R6                 DROP AVT BASE                         61580022
         MVC   TOTORLN,OLTTCRLN   MOVE IN RELATIVE LINE NUMBER   S22024 61600000
         SLR   R6,R6              CLEAR                        @G36XRUV 61610000
         ICM   R6,D3,OLTUCBA      GET ADDRESS OF UCB           @G36XRUV 61620000
         LTR   R6,R6              IS THERE A VALID UCB ADDRESS?         61640022
         BZ    RTN005             NO, DON'T TRY TO ISSUE STARTLINE      61660022
         USING UCB,R6             SET UP ADDRESSIBILITY FOR UCB         61680022
         MVI   TOTOLADR,BLANK     MOVE BLANK INTO NAME FIELD     S22024 61700000
         MVC   TOTOLADR+D1(D7),TOTOLADR  BLANK OUT NAME FIELD    SI2024 61706000
         MVC   TOTOLADR(D3),UCBNAME  GET UNIT NAME               S22024 61712000
         DROP  R6                 DROP UCB BASE                         61720022
         LA    R1,TOTOTECB        GET TOTE ECB ADDRESS                  61740022
         ST    R1,TOTOECBA        PUT IT IN PARAMETER LIST       S22024 61760000
         LA    R1,TOTPLIST        GET ADDRESS OF OPERATOR CONTROLS22024 61765000
*                                   PARAMETER LIST               S22024 61770000
         ST    R1,ELEM1           STROE ADDRESS IN 1ST WORD OF   S22024 61775000
*                                   SVC 102 POST LIST            S22024 61780000
         ST    R1,ELEM2           STORE ADDRESS IN 2ND WORD OF   S22024 61785000
*                                   SVC 102 POST LIST            S22024 61790000
         MVI   ELEM1,START        SET SVC 102 ACTION CODE        S22024 61795000
         MVI   ELEM2,EIGHTY       SET END OF LIST INDICATOR      S22024 61800000
         XC    TOTOLINK(D3),TOTOLINK  CLEAR REQUEST ELEMENT      S22024 61805000
*                                       LINK FIELD               S22024 61810000
         LA    R1,ELEM1                 POINT TO SVC POST LIST @YA11128 61815058
         XC    TOTOTECB(D4),TOTOTECB  CLEAR TOTE ECB                    61820022
         AQCTL                    POST ELEMENT TO OPERATOR CONTROL      61840022
         WAIT  ECB=TOTOTECB       WAIT ON OPERATOR CONTROL TO          X61860022
                                    HONOR REQUEST                       61880022
         SPACE 1                                                        61900022
         LM    R6,R12,STRTSAVE    RESTORE REGS FROM STARTLINE           61920022
         BR    R8                 RETURN TO CALLER                      61940022
         SPACE 1                                                        61960022
RTN004A  EQU   *                                                        61980022
         L     R7,TOTGRABP        GET ADDRESS OF CURRENT        SA41599 61984022
*                                   SECONDARY TEST DEVICE       SA41599 61988022
         TM    D0(R7),TOTTDLST    WAS LINE INITIALLY STOPPED?   SA41599 61992022
         BO    RTN005             YES, DO NOT START LINE        SA41599 61996022
         TM    D0(R7),TOTTDORN    IS TEST DEVICE ON 3705?        S22024 61997000
         BO    RTN005             YES, BYPASS STARTLINE          S22024 61998000
         LA    R7,TOTSCIBK        SET UP TO START SECONDARY LINE        62000022
         BAL   R8,STRTLINE        START SECONDARY LINE                  62020022
         DROP  R7                 DROP IOBLOCKS BASE                    62040022
         SPACE 2                                                        62060022
RTN005   EQU   *                                                        62080022
         NI    $TOTFLG1,XFF-$LINESHR    TURN OFF LINE SHARE    @YA11128 62100058
         LA    R8,TOTSERV         ADDR OF SERVICE MOD WORKAREA @Y17XAUV 62100500
         LR    R10,R8             COPY                         @Y17XAUV 62100700
         LA    R9,L'TOTSERV       LENGTH OF WORKAREA           @Y17XAUV 62100900
         SR    R11,R11            MOVE OF 0 AND PAD OF 0       @Y17XAUV 62101100
         MVCL  R8,R10             CLEAR WORKAREA               @Y17XAUV 62101300
         SPACE 1                                               @Y17XAUV 62101500
*        FIND ADDR OF SERVICE ROUTINE IN RESPL AND BALR        @Y17XAUV 62102000
         SPACE 1                                               @Y17XAUV 62102500
         SR    R8,R8              CLEAR LOOP CONTROL REG       @Y17XAUV 62103000
         LA    R9,MODIDTAB        ADDR OF MODULE ID TABLE      @Y17XAUV 62103500
         LA    R10,MODIDEND       ADDR OF END OF TABLE         @Y17XAUV 62104000
         USING MODIDMAP,R9        BASE TABLE ENTRY DSECT       @Y17XAUV 62104500
CHKLOOP  DS    0H                 LOOP UNTIL FIND ID MATCH OR  @Y17XAUV 62105000
*                                  REACH END OF TABLE          @Y17XAUV 62105500
         LTR   R8,R8              TERMINATE LOOP ?             @Y17XAUV 62106000
         BP    EXITOLT            Y - GO RETURN TO OLT         @Y17XAUV 62106500
         CR    R9,R10             END OF TABLE REACHED ?       @Y17XAUV 62107000
         BNE   CHKID              N - CHECK FOR ID MATCH       @Y17XAUV 62107500
         LA    R8,1               SET TO EXIT LOOP             @Y17XAUV 62108000
         B     ENDCHKLP           BRANCH TO END OF LOOP        @Y17XAUV 62108500
CHKID    DS    0H                 CHECK FOR ID MATCH           @Y17XARV 62109000
         CLC   MODID(L'MODID),XMGRCODE                         @Y17XAUV 62109500
*                                 IS ENTRY IN MODULE ID TABLE  @Y17XAUV 62110000
*                                  THE SAME AS ID IN PARM LIST?@Y17XAUV 62110500
         BE    FNDMATCH           Y - GO CALL SERVICE MODULE   @Y17XAUV 62111000
         LA    R9,D3(R9)          INCREMENT MODULE ID TAB      @Y17XAUV 62111500
*                                  ENTRY POINTER               @Y17XAUV 62112000
         B     ENDCHKLP           BRANCH TO END OF LOOP        @Y17XAUV 62112500
FNDMATCH DS    0H                 FOUND MATCH                  @Y17XAUV 62113000
         LA    R8,1               SET TO GET OUT OF LOOP       @Y17XAUV 62113500
         LA    R10,RESPLADR       LOAD ADDR OF SERVICE MODULE  @Y17XAUV 62114000
*                                  ADDR LIST IN RESPL          @Y17XAUV 62114500
         SR    R7,R7              CLEAR AND                    @Y17XAUV 62115000
         IC    R7,MODINDEX         OBTAIN OFFSET INTO ADDR     @Y17XAUV 62115500
*                                  LIST FOR THIS MODULE        @Y17XAUV 62116000
         AR    R10,R7             POINT TO ENTRY IN LIST FOR   @Y17XAUV 62116500
*                                  THIS MODULE                 @Y17XAUV 62117000
         L     R15,D0(R10)        LOAD ENTRY POINT FOR SERVICE @Y17XAUV 62117500
*                                  MODULE                      @Y17XAUV 62118000
         L     R1,TOTPARML        RESIDENT PARAMETER LIST      @Y17XAUV 62118200
         BALR  R14,R15            CALL SERVICE MODULE          @Y17XAUV 62118500
ENDCHKLP DS    0H                 END OF LOOP                  @Y17XAUV 62119000
         B     CHKLOOP            BRANCH TO TOP OF LOOP        @Y17XAUV 62119500
         DROP  R9                                              @Y17XAUV 62319500
         SPACE 1                                                        62540022
EXITOLT  EQU   *                                                        62560022
         L     R13,D4(R13)        GET CALLER'S SAVE AREA ADDRESS        62580022
         L     R14,TOTSMGRT       RESTORE CALLER'S RETURN ADDRESS       62600022
         LM    R2,R12,D28(R13)    RESTORE CALLER'S REGISTERS            62620022
         BR    R14                RETURN TO CALLER                      62640022
         DROP  R2                 DROP OLTCB BASE                       62660022
         EJECT                                                          63800022
*********************************************************************** 63900022
*                                                                     * 64000022
*        TOTE QUEUE HANDLERS                                          * 64100022
*                                                                     * 64200022
*********************************************************************** 64300022
         SPACE 5                                                        64400022
QADDND   EQU   *                                                        64500022
         LA    R15,QADDNDX        SET UP QUEUE HANDLER BASE             64600022
QADDNDX  EQU   *                                                        64700022
*                                                                       64800022
*        ADD ELEMENT TO END OF QUEUE                                    64900022
*             INPUT   REGISTER R2 POINTS TO ELEMENT TO BE ADDED         65000022
*                                                                       65100022
         USING QADDNDX,R15                                              65200022
         USING QEL,R2                                                   65300022
         L     R1,QELQCB-D1       GET QCB ADDRESS                       65400022
         DROP  R2                                                       65500022
QADDE20  EQU   *                                                        65600022
         USING TQCB,R1                                                  65700022
         L     R3,TQCBLINK-D1     GET NEXT ELEMENT ADDRESS              65800022
         LA    R3,D0(R3)          CLEAR HIGH ORDER BYTE          S22024 65850000
         USING QEL,R3                                                   65900022
         LTR   R3,R3              IS LINK FIELD ZERO?                   65920022
         BZ    QADD40             YES, GO ADD NEW ELEMENT               65940022
*                                   TO QUEUE                            65960022
         CLI   QELKEY,QENDKEY     IS IT DUMMY LAST ELEMENT?             66000022
         BE    QADD40             YES, GO ADD NEW ELEMENT               66100022
*                                   TO QUEUE                            66200022
         DROP  R1                                                       66300022
         LA    R1,QELLINK-D1      NO, GET ADDRESS OF LINK FIELD         66400022
         DROP  R3                                                       66500022
         B     QADDE20            BRANCH BACK AND EXAMINE NEXT ELEMENT  66600022
         DROP  R15                                                      66700022
         SPACE 5                                                        66800022
QADDAF   EQU   *                                                        66900022
         LA    R15,QADDAFX        SET UP QUEUE HANDLER BASE             67000022
QADDAFX  EQU   *                                                        67100022
*                                                                       67200022
*        INSERT AFTER SPECIFIED ELEMENT                                 67300022
*                                                                       67400022
         USING QADDAFX,R15                                              67500022
QADD40   EQU   *                                                        67600022
         USING QEL,R2                                                   67700022
         USING TQCB,R1                                                  67800022
         MVC   QELLINK(D3),TQCBLINK  SET NEW ELEMENT LINK FIELD         67900022
         STCM  R2,D7,TQCBLINK     SET PREVIOUS LINK FIELD      @G36XRUV 68100000
         BR    R10                RETURN TO CALLER                      68300022
         DROP  R15                                                      68400022
         SPACE 5                                                        68500022
QREMEL   EQU   *                                                        68600022
         LA    R15,QREMELX        SET UP QUEUE HANDLER BASE             68700022
QREMELX  EQU   *                                                        68800022
*                                                                       68900022
*        REMOVE DESIGNATED ELEMENT FROM QUEUE                           69000022
*             INPUT   REGISTER R2 CONTAINS ELEMENT ADDRESS              69100022
*             OUTPUT  REGISTER R2 CONTAINS ELEMENT ADDRESS              69200022
*                                                                       69300022
         USING QREMELX,R15                                              69400022
         LR    R3,R2              SAVE ELEMENT ADDR FOR COMPARE         69500022
         USING QEL,R3                                                   69600022
         L     R1,QELQCB-D1       GET QCB ADDRESS                       69700022
         DROP  R3                                                       69800022
QREMA20  EQU   *                                                        69900022
         USING TQCB,R1                                                  70000022
         L     R2,TQCBLINK-D1     GET NEXT ELEMENT ADDRESS              70100022
         USING QEL,R2                                                   70200022
         LA    R2,D0(R2)          CLEAR HIGH ORDER                      70300022
         LA    R3,D0(R3)            BYTES FOR COMPARE                   70400022
         CR    R2,R3              IS IT THE CORRECT ELEMENT?            70500022
         BE    QREM40             YES, GO REMOVE IT FROM QUEUE          70600022
         LA    R1,QELLINK-D1      NO, GET ADDRESS OF LINK FIELD         70700022
         B     QREMA20            GO EXAMINE NEXT ELEMENT               70800022
         DROP  R1                                                       70900022
         DROP  R2                                                       71000022
         DROP  R15                                                      71100022
         SPACE 5                                                        71200022
QREMFR   EQU   *                                                        71300022
         LA    R15,QREMFRX        SET UP QUEUE HANDLER BASE             71400022
QREMFRX  EQU   *                                                        71500022
*                                                                       71600022
*        REMOVE FIRST ELEMENT FROM QUEUE                                71700022
*             INPUT   REGISTER R1 CONTAINS QCB ADDRESS                  71800022
*             OUTPUT  REGISTER R2 CONTAINS REMOVED ELEMENT              71900022
*                                                                       72000022
         USING QREMFRX,R15                                              72100022
         USING TQCB,R1                                                  72200022
         L     R2,TQCBLINK-D1     GET NEXT ELEMENT ADDRESS              72300022
         USING QEL,R2                                                   72400022
         CLI   QELKEY,QENDKEY     IS IT DUMMY LAST ELEMENT?             72500022
         BNE   QREM40             NO, REMOVE FROM QUEUE                 72600022
*                                 YES, SET ERROR CODE                   72700022
         DROP  R1                                                       72800022
         DROP  R2                                                       72900022
         SPACE 5                                                        73000022
QREM30   EQU   *                                                        73100022
         LA    R1,QERROR          SET ERROR CODE                        73200022
         BR    R10                RETURN TO CALLER                      73300022
         SPACE 5                                                        73400022
QREM40   EQU   *                                                        73500022
         USING QEL,R2                                                   73600022
         USING TQCB,R1                                                  73700022
         MVC   TQCBLINK(D3),QELLINK REMOVE ELEMENT FROM QUEUE           73800022
         DROP  R1                                                       73900022
         DROP  R2                                                       74000022
         BR    R10                RETURN TO CALLER                      74100022
         DROP  R15                                                      74200022
         EJECT                                                          74300022
RESPL    RESPL DSECT=NO,EQUATES=NO                                      74400022
         EJECT                                                          74600022
REGSAVE  DS    18F                REGISTER SAVE AREA                    74700022
RESBASE  DC    A(IEDQWA)          THIS MODULE BASE ADDRESS              74800022
ELEM1    DS    F                  POINTER TO 1ST ELEMENT         S22024 77630000
ELEM2    DS    F                  POINTER TO 2ND ELEMENT         S22024 77640000
STRTSAVE DS    7F                 SAVE AREA FOR START LINE       S22024 77650000
*                                   ROUTINE                      S22024 77660000
         SPACE                                                          77690022
TOTEOFF  DS    0F                 USED TO COMPARE AND SWAP     @XM05672 77690600
         DC    X'FF'                    TRMSTOTE OFF           @XM05672 77691200
         DC    AL1(255-TRMSTOTE)                               @XM05672 77691800
         DC    X'FFFF'                                         @XM05672 77692400
WORD0    DC    XL4'00000000'      WORD OF ZEROS                @Y17XAUV 77693000
         DS    0H                 ALIGNMENT                    @Y17XAUV 77696000
CHKTIC   TM    INVALTIC,D0        USED TO CHECK FOR INVALID TIC@Y17XAUV 77699000
CLRINSTR XC    D12(D0,R6),D12(R6) CLEAR UNIT                   @Y17XAUV 77702000
INVALTIC DC    XL1'03'            BITS INDICATING INVALID TIC  @Y17XAUV 77705000
ERBCODE  DC    XL1'C0'            ERB CODE FOR POSTWAIT ROUTINE@Y17XAUV 77708000
CODEREQ  DC    XL1'80'            CODE FOR GEN REQEST ELEMENT  @Y17XAUV 77711000
PATCH    DC    CL90' '            MAINTAINANCE AREA                     77720005
         EJECT                                                          77750022
*********************************************************************** 77810000
*                                                                     * 77870000
*        MODULE ID TABLE                                              * 77930000
*                                                                     * 77990000
*********************************************************************** 78050000
MODAB    EQU   RESPLAB-RESPLADR                                @Y17XAUV 78052000
MODAJ    EQU   RESPLAJ-RESPLADR                                @Y17XAUV 78054000
MOD35    EQU   RESPL35-RESPLADR                                @Y17XAUV 78056000
MODAA    EQU   RESPLAA-RESPLADR                                @Y17XAUV 78058000
MOD39    EQU   RESPL39-RESPLADR                                @Y17XAUV 78060000
MODP1    EQU   RESPLP1-RESPLADR                                @Y17XAUV 78062000
MODP2    EQU   RESPLP2-RESPLADR                                @Y17XAUV 78064000
MOD37    EQU   RESPL37-RESPLADR                                @Y17XAUV 78066000
MOD28    EQU   RESPL28-RESPLADR                                @Y17XAUV 78068000
MOD36    EQU   RESPL36-RESPLADR                                @Y17XAUV 78070000
MODAC    EQU   RESPLAC-RESPLADR                                @Y17XAUV 78072000
MOD21    EQU   RESPL21-RESPLADR                                @Y17XAUV 78074000
MOD41    EQU   RESPL41-RESPLADR                                @Y17XAUV 78076000
MOD16    EQU   RESPL16-RESPLADR                                @Y17XAUV 78078000
MOD42    EQU   RESPL42-RESPLADR                                @Y17XAUV 78080000
MOD43    EQU   RESPL43-RESPLADR                                @Y17XAUV 78082000
MOD44    EQU   RESPL44-RESPLADR                                @Y17XAUV 78084000
MOD47    EQU   RESPL47-RESPLADR                                @Y17XAUV 78086000
MODM2    EQU   RESPLM2-RESPLADR                                @Y17XAUV 78088000
MOD25    EQU   RESPL25-RESPLADR                                @Y17XAUV 78090000
MOD33    EQU   RESPL33-RESPLADR                                @Y17XAUV 78092000
MODIDTAB DS    0H                 EACH ENTRY CONTAINS MODULE ID@Y17XAUV 78110000
*                                  AND OFFSET INTO RESPL       @Y17XAUV 78170000
*                                  SERVICE MOD ADDR LIST       @Y17XAUV 78230000
         DC    CL2'AB',AL1(MODAB) DATE ROUTINE                 @Y17XAUV 78290000
         DC    CL2'AJ',AL1(MODAJ) $CUTEST ROUTINE              @Y17XAUV 78350000
         DC    CL2'35',AL1(MOD35) EXIO ROUTINE                 @Y17XAUV 78410000
         DC    CL2'AA',AL1(MODAA) TIME ROUTINE                 @Y17XAUV 78470000
         DC    CL2'39',AL1(MOD39) DPRINT ROUTINE LOAD 1        @Y17XAUV 78530000
         DC    CL2'P1',AL1(MODP1) DPRINT ROUTINE LOAD 2        @Y17XAUV 78590000
         DC    CL2'P2',AL1(MODP2) DPRINT ROUTINE LOAD 3        @Y17XAUV 78650000
         DC    CL2'37',AL1(MOD37) CECOM ROUTINE                @Y17XAUV 78710000
         DC    CL2'28',AL1(MOD28) PLINK ROUTINE                @Y17XAUV 78770000
         DC    CL2'36',AL1(MOD36) WAITIO ROUTINE               @Y17XAUV 78830000
         DC    CL2'AC',AL1(MODAC) $GRAB ROUTINE                @Y17XAUV 78890000
         DC    CL2'21',AL1(MOD21) $LETGO ROUTINE               @Y17XAUV 78950000
         DC    CL2'41',AL1(MOD41) CONVERT ROUTINE              @Y17XAUV 79010000
         DC    CL2'16',AL1(MOD16) GETCONFIG ROUTINE            @Y17XAUV 79070000
         DC    CL2'42',AL1(MOD42) MORECORE ROUTINE             @Y17XAUV 79130000
         DC    CL2'43',AL1(MOD43) FREECORE ROUTINE             @Y17XAUV 79190000
         DC    CL2'44',AL1(MOD44) DIO ROUTINE                  @Y17XAUV 79250000
MODRTN   DC    CL2'47',AL1(MOD47) ROUTINE ROUTINE              @Y17XAUV 79310000
         DC    CL2'M2',AL1(MODM2) TRACE/RETURN CODE ROUTINE    @Y17XAUV 79370000
         DC    CL2'25',AL1(MOD25) SEND ROUTINE                 @Y17XAUV 79430000
         DC    CL2'33',AL1(MOD33) RECEIVE ROUTINE              @Y17XAUV 79490000
MODIDEND EQU   *                                               @Y17XAUV 79550000
         SPACE 2                                               @Y17XAUV 79580000
         SPACE 2                                               @Y17XAUV 79610000
*********************************************************************** 79670000
*                                                                     * 79730000
*        MODULE ID TABLE ENTRY MAP                             @Y17XAUV 79790000
*                                                                     * 79850000
*********************************************************************** 79910000
MODIDMAP DSECT                                                 @Y17XAUV 79970000
MODID    DS    CL2                MODULE ID                    @Y17XAUV 80030000
MODINDEX DS    CL1                INDEX INTO RESPL ADDR LIST   @Y17XAUV 80090000
         EJECT                                                          80150000
TQCB     DSECT                                                          80400022
TQCBKEY  DS    C .           QCB KEY FIELD                              80500022
TQCBLINK DS    AL3 .         QUEUE CONTROL BLOCK LINK FIELD             80600022
         SPACE 5                                                        80700022
QEL      DSECT                                                          80800022
QELKEY   DS    C .           QUEUE ELEMENT KEY                          80900022
QELQCB   DS    AL3 .         ADDRESS OF QCB                             81000022
         DS    C                  UNUSED                                81100022
QELLINK  DS    AL3 .         ELEMENT LINK FIELD                         81200022
QELSIZE  DS    H .           ELEMENT SIZE                               81300022
*                                                                       81400022
QENDKEY  EQU   X'00' .       DUMMY LAST ELEMENT KEY                     81500022
QERROR   EQU   X'FF' .       QUEUE HANDLER ERROR CODE                   81600022
         SPACE 3                                                        81602000
PSPREF   DSECT                    SECTION PREFACE                S05331 81604000
SECTID   DS    CL8                SECTION ID                     S05331 81606000
LEVEL    DS    CL2                LEVEL                          S05331 81608000
RTNDISP  DS    AL2                DISPLACEMENT TO RTN #          S05331 81610000
INST     DS    A                  POINTER TO FIRST EXECUTABLE    S05331 81612000
*                                   INSTRUCTION                  S05331 81614000
MSGID    DS    CL2                OLT COMPONENT ID               S05331 81616000
         SPACE 3                                                        81618000
SPREF    DSECT                    ROUTINE PREFIX                 S05331 81620000
RTN#     DS    CL1                ROUTINE NUMBER                 S05331 81622000
         DS    CL15               SECTION PREFACE FLAGS/DATA     S05331 81624000
#FLAG    DS    CL1                FLAGS                          S05331 81626000
#MSGIDRQ EQU   X'10'              MESSAGE ID PROVIDED            S05331 81628000
         EJECT                                                          81630000
**************************************************************** S05331 81632000
*                                                              * S05331 81634000
*        CONTROL TERMINAL OR ALTERNATE PRINTER DEVICE ENTRY    * S05331 81636000
*                                                              * S05331 81638000
**************************************************************** S05331 81640000
         SPACE 2                                                        81642000
DEVENTRY DSECT                    DEVICE ENTRY DSECT             S05331 81644000
ENTUCB   DS    AL2                UCB ADDRESS                    S05331 81646000
ENTRSID  DS    H                  RESOURCE ID OF DEVICE          S05331 81648000
ENTRLN   DS    C                  RELATIVE LINE NUMBER           S05331 81650000
ENTLCB   DS    AL3                LCB ADDRESS                    S05331 81652000
ENTTNT   DS    F                  TERMINAL NAME TABLE ENTRY      S05331 81654000
*                                   ADDRESS (DUMMY ENTRY)        S05331 81656000
ENTRTNT  DS    F                  TERMINAL NAME TABLE ENTRY      S05331 81658000
*                                   ADDRESS (REAL ENTRY)         S05331 81660000
ENTTLN   DS    H                  LENGTH OF TTE AREA             S05331 81662000
ENTFLAG  DS    C                  FLAGS                          S05331 81664000
ENTASN   EQU   X'80'              DUMMY ENTRY ASSIGNED           S05331 81666000
ENTORN   EQU   X'40'              DEVICE ON A 3705               S05331 81668000
ENTACT   EQU   X'20'              ACTIVATE REQUIRED              S05331 81670000
ENTSTR   EQU   X'10'              START LINE REQUIRED            S05331 81672000
ENTDISC  EQU   X'08'              DISCONNECT SESSION REQUIRED    S05331 81674000
ENTRESET EQU   X'04'              RESET ERROR LOCK REQUIRED      S05331 81676000
ENT1RS   EQU   X'02'              FIRST RESET ERROR LOCK ISSUED  S05331 81678000
         EJECT                                                          81700022
TCBRBPA  DSECT                                                          81800022
         DS    4F                 UNUSED                                81900022
TCBCMPA  DS    F             TASK COMPLETION CODE                       82000022
         DS    2F                 UNUSED                                82100022
         DS    C                  UNUSED                                82200022
TCBFLGSA DS    5C            TCB FLAGS                                  82300022
ABEND    EQU   X'80'                   ABEND CODE                       82400022
         ORG   TCBRBPA+X'71'      RESET INSTRUCTION COUNTER             82500022
TCBFSAA  DS    AL3(0)        ADDRESS OF 1ST PROGRAM SAVE AREA           82600022
         EJECT                                                          82700022
*                                                                       82800022
*        TRANSIENT MANAGER PARAMETERS                                   82900022
*                                                                       83000022
XMGRPARM DSECT                                                          83100022
XMGRIND  DS    CL1                TRANSIENT MANAGER INDICATORS          83200022
XMGRLEV  DS    CL1                MACRO LEVEL                           83300022
XMGRCODE DS    CL2                MODULE CODE                           83400022
         SPACE 5                                                        83407022
         EJECT                                                          83500022
         TAVTD                                                          83600022
         EJECT                                                          83700022
         TPRFD                                                          83800022
         EJECT                                                          83820022
         TTRMD                                                          83830022
         EJECT                                                          83840022
         TQCBD                                                   S99528 83860022
         EJECT                                                          83900022
         OLTCB POINTER=YES                                              84000022
         EJECT                                                          84100022
         TSCBD                                                          84300022
         EJECT                                                          84600022
         TLCBD                                                          84610022
         EJECT                                                          84612000
         TTTCD                                                          84614000
         EJECT                                                          84616000
         TREQD                                                          84618000
         EJECT                                                          84620022
         TTCBD                                                          84630022
         EJECT                                                          84640022
         IOBLOCKS                                                       84650022
         EJECT                                                   S99528 84660022
UCB      DSECT                                                          84680022
         IEFUCBOB                                                       84700022
         CVT                      CVT DSECT                      S22024 84710000
         EJECT                                                   S99528 84720022
         TPRIOR                                                         84800022
         EJECT                                                          85800000
         TTNTD                    TERMNAME TABLE DSECT           Y06330 90800005
         EJECT                                                          93800005
         END                                                            96800005
./  ADD  SSI=63630057,NAME=IEDQWAA
         TITLE 'IEDQWAA  $DDATE SERVICE MODULE OF TCAM/TOTE'            00600010
IEDQWAA  CSECT                                                          01200010
*A000000-999999                                                @Y16X5U0 01300010
*CHANGE ACTIVITY AS FOLLOWS:                                            01500010
*A000000-999999                                                  S22024 01600010
*C120000,198000                                                @Y17XAU2 01650010
*D201000,636000,930000-934000                                  @Y17XAU2 01700010
*A306000,774000                                                @Y17XAUU 01710010
*A630000,990000                                                @Y17XAU2 01720010
*********************************************************************** 01800010
*                                                                     * 02400010
* MODULE NAME = IEDQWAA (TCAM,TOTE)                            @Y17XAUU 03000010
*                                                                     * 03300010
* DESCRIPTIVE NAME = $DDATE SERVICE MODULE                            * 03600010
*                                                                     * 03900010
* COPYRIGHT = NONE                                                    * 04200010
*                                                                     * 04500010
* STATUS = VERSION 10.0                                        @Y17XAUU 04800010
*                                                                     * 05100010
* FUNCTION = THIS MODULE SUPPORTS THE $DDATE MACRO. THE DATE IS       * 05400010
*            RETRIEVED FROM THE SYSTEM AND PASSED TO THE OLT IN THE   * 05700010
*            FORMAT MM/DD/YY.                                         * 06000010
*                                                                     * 06300010
* NOTES = SEE BELOW                                                   * 06600010
*                                                                     * 06900010
*    DEPENDENCIES = NONE                                              * 07200010
*                                                                     * 07500010
*    RESTRICTIONS = NONE                                              * 07800010
*                                                                     * 08100010
*    REGISTER CONVENTIONS = R2 POINTS TO ONLINE TEST CONTROL BLOCK    * 08400010
*                           R4 IS BASE REGISTER                       * 08700010
*                           OTHERS USED AS NEEDED                     * 09000010
*                                                                     * 09300010
*    PATCH LABEL = PATCH A DC STATEMENT                               * 09600010
*                                                                     * 09900010
* MODULE TYPE = PROCEDURE                                      @Y17XAUU 10200010
*                                                                     * 10500010
*    PROCESSOR = ASSEMBLE XF                                   @Y17XAUU 10800010
*                                                                     * 11100010
*    ATTRIBUTES = ENABLED, PROBLEM PROGRAM MODE,                      * 12000010
*                 RESIDENT, RE-ENTRANT                         @Y17XAU2 12100010
*                                                                     * 12300010
* ENTRY POINT = IEDQWAA                                               * 12600010
*                                                                     * 12900010
*    PURPOSE = SEE FUNCTION                                           * 13200010
*                                                                     * 13500010
* INPUT      = R2 IS ADDRESS OF OLTCB                          @Y17XAUU 13800010
*              R1 IS $DDATE PLIST ADDRESS                      @Y17XAUU 13900010
*              R13 IS SAVE AREA ADDRESS                               * 14100010
*              R14 LOADED WITH RETURN ADDRESS                         * 14400010
*              R15 LOADED WITH ENTRY POINT ADDRESS                    * 14700010
*                                                                     * 15000010
* LINKAGE = BALR REG15,REG14 FROM IEDQWA WITH REG 1 POINTING   @Y17XAUU 15300010
*             TO $DDATE PARAMETER LIST.                        @Y17XAUU 15400010
*                                                                     * 15600010
* OUTPUT = DATE IN R0 = MM/D                                          * 15900010
*                  R1 = D/YY                                          * 16200010
*                                                                     * 16500010
* EXIT-NORMAL = REGISTER 15 RETURN CODES RETURNED TO CALLER           * 16800010
*               00 - SUCCESSFUL OPERATION                             * 17100010
*               04 - DATE NOT AVAILABLE                               * 17400010
*                                                                     * 17700010
* EXIT-ERROR = NONE                                                   * 18000010
*                                                                     * 18300010
* EXTERNAL REFERENCES = SEE BELOW                                     * 18600010
*                                                                     * 18900010
*    ROUTINES = THE SYSTEM 'TIME' MACRO IS ISSUED                     * 19200010
*                                                                     * 19500010
*    DATA AREAS = EXTERNAL TO THIS MODULE IN OLTCB SERVICE     @Y17XAU2 19800010
*                 MODULE WORK AREA                             @Y17XAU2 20100010
*                                                                     * 20400010
*    CONTROL BLOCK = ONLINE TEST CONTROL BLOCK (OLTCB)                * 20700010
*                                                                     * 21000010
* TABLES = LEAPTABL - LEAP YEAR TABLE                                 * 21300010
*          NONLPTBL - NON-LEAP YEAR TABLE                             * 21600010
*                                                                     * 21900010
* MACROS = TIME                                                       * 22200010
*                                                                     * 25800010
*********************************************************************** 26400010
         EJECT                                                          26700010
         USING IEDQWAA,BASEREG                                          27000010
         USING TOTOLTCB,R2                                              27600010
         SAVE  (14,12)             SAVE CALLERS REGISTERS               28200010
         LR    BASEREG,R15         LOAD BASE REGISTER                   28800010
*                                                                       29400010
IEDQWAA  IEDHJN DATE0100,HJN                                            30000010
*                                                                       30600010
         LA    R12,TOTSAVE1        PICK UP SAVE AREA ADDRESS   @Y17XAUU 30680010
         ST    R12,EIGHT(R13)      SAVE IT IN CALLERS SAVE AREA@Y17XAUU 30760010
         ST    R13,TOTSAVE1+FOUR   SAVE CALLERS SAVE AREA ADDR @Y17XAUU 30840010
         LR    R13,R12             SET MY SAVE AREA ADDRESS    @Y17XAUU 30920010
         XC    TOTSERV(TEND-TOTOBEND),TOTSERV CLEAR WORK AREA  @Y17XAUU 31000010
         MVC   DATE(EIGHT),DATE1   SET DATE FORMAT IN WORK AREA@Y17XAUU 31080010
         SPACE 4                                                        33600010
         TIME                                                           34200010
         SPACE                                                          34800010
         ST    R1,SAVE             SAVE DATE FROM MACRO                 35400010
         MVO   WORK+SIX(TWO),SAVE+ONE(ONE) GET YEAR                     36000010
         OI    WORK+SEVEN,HEX0F    CREATE A + SIGN                      36600010
         UNPK  DATE+SIX(TWO),WORK+SIX(TWO) UNPACK YEAR (PRINTABLE)      37200010
         CVB   YEAR,WORK           GET YEAR IN BINARY                   37800010
         SR    REMAIN,REMAIN       CLEAR REG FOR DIVIDE                 38400010
         LR    QUOTIENT,YEAR       GET YEAR IN DIVIDE REGISTER          39000010
         LA    DIVISOR,FOUR        DIVIDE BY 4 TO CHK FOR LEAP          39600010
         DR    DIVIDEND,DIVISOR    DIVIDE YEAR                          40200010
         LA    TABLBASE,NOT        ASSUME NOT-LEAP TABL ADR-2           40800010
         LTR   REMAIN,REMAIN       LEAP YEAR?                           41400010
         BNZ   DATE0600            NO, ASSUMPTION CORRECT               42000010
         LA    TABLBASE,LEAPTABL-TWO  YES, USE LEAP-YEAR TABLE          42600010
*                                  ADDRESS MINUS 2                      42900010
DATE0600 EQU   *                                                        43200010
         MVC   WORK+SIX(TWO),SAVE+TWO  GET DAY                          43800010
         CVB   DAYS,WORK           CONVERT TO BINARY                    44400010
         LA    INDEX,TBLENGTH      SET INDEX REG TO TABLE LNGTH         45000010
DATE0700 EQU   *                                                        45600010
         LH    ENTRY,ZERO(INDEX,TABLBASE) GET ENTRY FROM TABLE          46200010
         CR    DAYS,ENTRY          IS THIS THE CORRECT ENTRY?           46800010
         BNH   DATE0900            NO, DECR INDEX & KEEP SEARCHING      47400010
         SR    DAYS,ENTRY          YES, GET DAY IN THIS MONTH           48000010
         CVD   DAYS,WORK           CONVERT  DAY TO PACKED DEC           48600010
         UNPK  DATE+THREE(TWO),WORK+SIX(TWO) UNPACK DAY                 49200010
         OI    DATE+FOUR,HEXF0     MAKE DAY PRINTABLE                   49800010
         SPACE                                                          50400010
         SRL   INDEX,ONE           GET MONTH FROM INDEX REG             51000010
         CVD   MONTH,WORK          CONVERT MONTH TO PACKED DEC          51600010
         UNPK  DATE(TWO),WORK+SIX(TWO) UNPACK MONTH                     52200010
         OI    DATE+ONE,HEXF0      MAKE IT PRINTABLE                    52800010
         L     R0,DATE             PUT DATE - MM/D IN R0                53400010
         L     R1,DATE+FOUR        PUT DATE - D/YY IN R1                54000010
         ST    R0,TOTWKSPC         SAVE R0 IN CASE BRANCH TO 'M2' DONE  54600010
         SR    R15,R15             SET ZERO RETURN CODE IN R15          55200010
         XC    TOTRTCOD,TOTRTCOD   CLEAR RETURN CODE IN OLTCB           55800010
         TM    $OLTFLGS,$TRACE     IS A MACRO TRACE REQUESTED?          56400010
         BO    DATE0800            YES CALL TRACE MODULE                57000010
         L     R13,FOUR(R13)       RESTORE CALLERS SAVE REGISTER        57600010
         L     R14,TWELVE(R13)     RESTORE REGISTER 14                  58200010
         MVC   TWENTY(EIGHT,R13),DATE  PUT DATE IN 'SAVER' REGISTERS    58800010
         LM    R0,R12,TWENTY(R13)  RESTORE CALLERS REGISTERS            59400010
         BR    R14                 RETURN TO CALLER                     60000010
*                                                                       60600010
DATE0800 DS    0H                                                       61200010
         L     R13,FOUR(R13)       RESTORE CALLERS SAVE REGISTER        61800010
         L     R14,TWELVE(R13)     RESTORE REGISTER 14                  62400010
         MVC   TWENTY(EIGHT,R13),DATE  PUT DATE IN 'SAVER' REGISTERS    63000010
         USING RESPL,R5            SETUP ADDRESIBILITY OF RESPL@Y17XAU2 63080010
         L     R5,TOTRESPL         FIND START OF RESPL         @Y17XAU2 63160010
         L     R15,RESPLM2         GET ENTRY TO IEDQWM2        @Y17XAU2 63240010
         LM    R2,R12,DISREG2(R13) RESTORE REGISTERS           @Y17XAUU 63320010
         BR    R15                 GO TO IEDQWM2               @Y17XAU2 63400010
         DROP  R5                                              @Y17XAU2 63480010
         SPACE 2                                                        64800010
DATE0900 EQU   *                                                        65400010
         LA    R8,TWO              DECREMENT VALUE                      66000010
         SR    INDEX,R8            POINT TO NEXT ENTRY DOWN             66600010
         B     DATE0700            GO CHECK OUT THIS ENTRY              67200010
         EJECT                                                          67800010
R0       EQU   0                   REGISTER 0                           68400010
R1       EQU   1                   REGISTER 1                           68900010
R2       EQU   2                   REGISTER 2                           69400010
R3       EQU   3                   REGISTER 3                           69900010
R4       EQU   4                   REGISTER 4                           70400010
R5       EQU   5                   REGISTER 5                           70900010
R6       EQU   6                   REGISTER 6                           71400010
R7       EQU   7                   REGISTER 7                           71900010
R8       EQU   8                   REGISTER 8                           72400010
R9       EQU   9                   REGISTER 9                           72900010
R10      EQU   10                  REGISTER 10                          73400010
R11      EQU   11                  REGISTER 11                          73900010
R12      EQU   12                  REGISTER 12                          74400010
R13      EQU   13                  REGISTER 13                          74900010
R14      EQU   14                  REGISTER 14                          75400010
R15      EQU   15                  REGISTER 15                          75900010
DISREG2  EQU   28                  REG 2 DISPLACEMENT IS SAVE  @Y17XAUU 76400010
REMAIN   EQU   10                  REGISTER 10                          78000010
QUOTIENT EQU   11                  REGISTER CONTAINING QUOTIENT         78600010
DAYS     EQU   10                  REGISTER 10                          79200010
DIVIDEND EQU   10                  REGISTER 10                          79800010
YEAR     EQU   5                   REGISTER 5                           80400010
TABLBASE EQU   5                   REGISTER 5                           81000010
DIVISOR  EQU   6                   REGISTER 6                           81600010
MONTH    EQU   6                   REGISTER 6                           82200010
INDEX    EQU   6                   REGISTER 6                           82800010
ENTRY    EQU   7                   REGISTER 7                           83400010
BASEREG  EQU   4                   BASE REGISTER                        84000010
ZERO     EQU   0                   ZERO                                 84600010
ONE      EQU   1                   ONE                                  85200010
TWO      EQU   2                   TWO                                  85800010
THREE    EQU   3                   THREE                                86400010
FOUR     EQU   4                   FOUR                                 87000010
SIX      EQU   6                   SIX                                  87600010
SEVEN    EQU   7                   SEVEN                                88200010
EIGHT    EQU   8                   EIGHT                                88800010
TWELVE   EQU   12                  TWELVE                               90000010
D16      EQU   16                  CONSTANT DECIMAL 16                  90600010
TWENTY   EQU   20                  TWENTY                               91200010
HEXF0    EQU   X'F0'               TO MAKE LAST CHAR PRINTABLE          91800010
HEX0F    EQU   X'0F'               SET + SIGN BIT                       92200010
         EJECT                                                 @Y17XAU2 92600010
*                                  CALLER                               94200010
LEAPTABL DC    AL2(0,31,60,91,121,152,182,213,244,274,305,335)  LEAP    94600010
*                                  YEAR TABLE                           95000010
NOT      EQU   *-2                 ADDR OF NOT LEAP TBL-2 (BASE)        95500010
LENGTH   EQU   *                   ADDR AT BEG OF TABLE                 96000010
NONLPTBL DC    AL2(0,31,59,90,120,151,181,212,243,273,304,334)  NON-    96600010
*                                  LEAP YEAR TABLE                      96900010
TBLENGTH EQU   *-LENGTH            LENGTH OF TABLE                      97200010
DATE1    DC    C'00/00/00'         FORMAT OF DATE              @Y17XAUU 97500010
PATCH    DC    100X'00'            MAINTENANCE AREA                     97800010
         EJECT                                                          98400010
RESPL    RESPL                                                 @Y17XAU2 98600010
         EJECT                                                 @Y17XAU2 98800010
         OLTCB                                                          99000010
TBEG     DS    0H                                              @Y17XAU2 99070010
WORK     DS    D                   WORK AREA                   @Y17XAU2 99140010
SAVE     DS    F                   SAVE AREA FOR UNPACKING DATE@Y17XAU2 99210010
DATE     DS    CL8                 FORMAT OF DATE RETURNED TO  @Y17XAU2 99280010
*                                  CALLER                      @Y17XAU2 99350010
TEND     DS    0H                                              @Y17XAU2 99420010
         EJECT                                                 @Y17XAU2 99490010
         END                                                            99600010
./  ADD  SSI=63630058,NAME=IEDQWAB
         TITLE 'IEDQWAB  $DTIME SERVICE MODULE OF TCAM/TOTE'            00300022
IEDQWAB  CSECT                                                          00700000
*A000000-999999                                                @Y16X5U0 00800010
*CHANGE ACTIVITY AS FOLLOWS:                                            01000000
*A653000-655000,666000-670000,877000-879000                      S05331 01070010
*C588000-598000,784000,875000                                    S05331 01140010
*D602000                                                         S05331 01210010
*A476000,756000,885000                                         @Y17XAUU 01250010
**************************************************************** S22024 01300000
*                                                              * S22024 01600000
* MODULE NAME: IEDQWAB (TCAM,TOTE)                             @Y17XAUU 02800010
*                                                              * S99528 03500022
* DESCRIPTIVE NAME:                                            * S22024 03600000
*    $DTIME SERVICE MODULE OF TCAM/TOTE                        * S22024 03700000
*                                                              * S22024 03800000
* COPYRIGHT:                                                   * S22024 03900000
*    'NONE'                                                    * S22024 04000000
*                                                              * S22024 04100000
* STATUS: VERSION 10.0                                         @Y17XAUU 04200010
*                                                              * S99528 04900022
* FUNCTIONS:                                                   * S99528 05600022
*              THIS MACRO RETURNS THE TIME OF DAY, IN PACKED   * S99528 06300022
*              DECIMAL, TO THE UNIT TEST IN REGISTER 1.        * S99528 07000022
*                                                              * S99528 07700022
* REGISTER 1 CONTENTS:                                         * S99528 08400022
*                                                              * S99528 09100022
*              BYTE 0  1  2  3                                 * S99528 09800022
*                   HH MM SS TH                                * S99528 10500022
*                                                              * S99528 11200022
*              HH  HOURS, IN 24 HOUR CLOCK SYSTEM              * S99528 11900022
*              MM  MINUTES                                     * S99528 12600022
*              SS  SECONDS                                     * S99528 13300022
*              T   TENTHS OF SECONDS                           * S99528 14000022
*              H   HUNDREDTHS OF SECONDS                       * S99528 14700022
*                                                              * S99528 15400022
* ENTRY POINT: IEDQWAB                                         * S99528 16100022
*                                                              * S99528 16800022
*              IEDQWAB - CALLED WHEN A $DTIME MACRO IS ISSUED  * S99528 17500022
*                        BY A UNIT TEST.                       * S99528 18200022
*                                                              * S99528 18900022
* INPUT:       REG 1 = $DTIME PLIST                            @Y17XAUU 19600010
*              REG 2 = OLTCB ADDRESS                           @Y17XAUU 19700010
*              REG 13 = CALLER SAVE AREA ADDRESS               @Y17XAUU 19800010
*              REG 14 = RETURN ADDRESS                         @Y17XAUU 19900010
*              REG 15 = IEDQWAB ENTRY ADDRESS                  @Y17XAUU 20000010
*                                                              * S99528 20300022
* OUTPUT:      REGISTER 1 CONTAINS THE TIME OF DAY IN PACKED   * S99528 21000022
*              DECIMAL.                                        * S99528 21700022
*                                                              * S99528 22400022
* EXTERNAL ROUTINE:   NONE                                     * S99528 23100022
*                                                              * S99528 23800022
* EXIT POINTS (NORMAL) :                                       * S99528 24500022
*               BR 14 AT 'DTIM002'                             @Y17XAU2 25200010
*                                                              * S99528 25900022
* EXIT POINTS (ERROR) :                                        * S99528 26000022
*    NONE                                                      * S99528 26100022
*                                                              * S99528 26200022
* TABLES/WORK AREAS:  NONE                                     * S99528 26600022
*                                                              * S99528 27300022
* ATTRIBUTES:                                                  * S99528 28000022
*              ENABLED, PROBLEM PROGRAM MODE, RESIDENT,        @Y17XAU2 28700010
*              RE-ENTRANT                                      @Y17XAU2 29000010
*                                                              * S99528 29400022
* NOTES = SEE BELOW                                            @Y17XAUU 29500010
*                                                              * S99528 29700022
*  DEPENDENCIES - EBCDIC CHARACTER CODE                        @Y17XAUU 29740010
*                                                              @Y17XAUU 29780010
*  REGISTERS CONVENTION - SEE REGISTER ASSIGNMENT              @Y17XAUU 29820010
*                                                              @Y17XAUU 29860010
*  PATCH LABEL - PATCH                                         @Y17XAUU 29900010
*                                                              @Y17XAUU 29940010
*  RESTRICTIONS - NONE                                         @Y17XAUU 29980010
*                                                              @Y17XAUU 30020010
* NOTES:       NONE                                            * S99528 30100022
*                                                              * S99528 30800022
**************************************************************** S99528 31500022
         EJECT                                                          33600000
**************************************************************** S22024 33900000
*                                                                S99528 34300022
*        EQUATES TO ALLOW SYMBOLIC NAMING OF GENERAL REGISTERS   S99528 35000022
*                                                                S99528 35700022
*                                                                S99528 36400022
**************************************************************** S22024 36600000
         SPACE 1                                                        36800000
R0       EQU   0                   R                             S99528 37100022
R1       EQU   1                    E                            S99528 37800022
R2       EQU   2                     G                           S99528 38500022
R3       EQU   3                      I                          S99528 39200022
R4       EQU   4                       S                         S99528 39900022
R5       EQU   5                        T                        S99528 40600022
R6       EQU   6                         E                       S99528 41300022
R7       EQU   7                          R                      S99528 42000022
R8       EQU   8                           S                     S99528 42700022
R9       EQU   9                   E                             S99528 43400022
R10      EQU   10                   Q                            S99528 44100022
R11      EQU   11                    U                           S99528 44800022
R12      EQU   12                     A                          S99528 45500022
R13      EQU   13                      T                         S99528 46200022
R14      EQU   14                       E                        S99528 46900022
R15      EQU   15                        D                       S99528 47600022
DISREG2  EQU   28                  DISPLACEMENT TO REG 2       @Y17XAUU 48400010
         EJECT                                                          49300000
         USING IEDQWAB,R4                                        S99528 49700022
         USING TOTOLTCB,R2                                       S22024 50400022
         SAVE  (14,12)            SAVE CALLER'S REGISTERS        S22024 51100022
         LR    R4,R15             LOAD BASE REGISTER             S22024 51400022
IEDQWAB  IEDHJN DTIM000,HJN                                      S99528 51800022
         LA    R12,TOTSAVE1        PICK UP SAVE AREA ADDRESS     S99528 53200022
         ST    R12,OFF8(R13)       SAVE IT IN CALLERS SAVE AREA  S99528 53900022
         ST    R13,TOTSAVE1+OFF4   SAVE CALLERS SAVE REG         S99528 54600022
         LR    R13,R12            SET UP SAVE AREA REG           S99528 55300022
         CLI   1(R1),X'02'         LEVEL 2 MACRO ID ?            S99528 56700022
         BE    DTIM001             YES                           S99528 57400022
*                                                                S99528 58100022
         LA    R15,OFF4           SET RETURN CODE TO 4           S05331 58800010
         B     DTEXIT             BRANCH TO EXIT ROUTINE         S05331 59800010
DTIM001  EQU   *                                                 S99528 60900022
*                                                                S99528 61600022
         TIME  DEC                 GET TIME AND DATE             S99528 62300022
         ST    R0,DTIM003          SAVE TIME                     S99528 63000022
*                                                                S99528 63700022
*                                                                S99528 64400022
         LR    R1,R0               PUT TIME IN REG 1             S99528 64600022
         SR    R15,R15             CLEAR RETURN CODE REGISTER    S99528 64800022
         XC    TOTRTCOD,TOTRTCOD   ZERO RETURN CODE              S99528 65100022
DTEXIT   EQU   *                                                 S05331 65300010
         STC   R15,TOTRTCOD       PUT RETURN CODE IN OLTCB       S05331 65500010
         TM    $OLTFLGS,$TRACE     IS TRACE REQUESTED            S99528 65800022
         BO    DTIM002A            YES GO TO TRACE MODULE        S99528 66500022
         TM    $RETMASK,XFF       ANY RETURN CODES SET BY OLT?   S05331 66600010
         BZ    DTNORM             NO, RETURN TO CALLER           S05331 66700010
         CLI   TOTRTCOD,ZERO      IS RETURN CODE ZERO            S05331 66800010
         BNE   DTIM002A           NO, GO TO IEDQWM2              S05331 66900010
DTNORM   EQU   *                                                 S05331 67000010
         L     R13,OFF4(R13)       RESTORE CALLERS SAVE REG      S99528 67200022
         L     R14,OFF12(R13)      RESTORE R14                   S99528 67900022
         MVC   OFF24(LEN4,R13),DTIM003  PUT TIME IN REG 1        S99528 68600022
*                                        OF CALLER               S99528 69300022
         LM    R0,R12,20(R13)      RESTORE CALLERS REGISTERS     S99528 70000022
DTIM002  BR    R14                 RETURN                        S99528 70700022
*                                                                S99528 71400022
*                                                                S99528 72100022
DTIM002A DS    0H                                                S99528 72800022
         L     R13,OFF4(R13)       RESTORE CALLERS SAVE REG      S99528 73500022
         L     R14,OFF12(R13)      RESTORE R14                   S99528 74200022
         MVC   OFF24(LEN4,R13),DTIM003  PUT TIME IN REG 1        S99528 74900022
*                                        OF CALLER               S99528 75600022
         USING RESPL,R5            SET UP ADDRESSBILTY OF RESPL@Y17XAU2 75700010
         L     R5,TOTRESPL         FIND START OF RESPL         @Y17XAU2 75800010
         L     R15,RESPLM2         GET ENTRY POINT OF IEDQWM2  @Y17XAU2 75900010
         LM    R2,R12,DISREG2(R13) RESTORE REG                 @Y17XAUU 75950010
         BR    R15                 GO TO IEDQWM2               @Y17XAU2 76000010
         DROP  R5                                              @Y17XAU2 76100010
         EJECT                                                   S99528 77000022
PATCH    DC    100C' '             PATCH AREA                    S05331 78400010
         EJECT                                                          79100022
**************************************************************** S99528 79800022
*                                                              * S99528 80500022
*        OFFSETS   AND   EQUATES                               * S99528 81200022
*                                                              * S99528 81900022
*                                                              * S99528 82600022
**************************************************************** S99528 83300022
OFF4     EQU   4                   OFFSET TO POINT TO 2ND WORD   S99528 84000022
OFF8     EQU   8                   OFFSET TO POINT TO 3RD WORD   S99528 84700022
OFF12    EQU   12                  OFFSET TO POINT TO 4TH WORD   S99528 85400022
OFF24    EQU   24                  OFFSET TO POINT TO 6TH WORD   S99528 86100022
LEN4     EQU   4                   LENGTH FOR FULLWORD MOVE      S99528 86800022
XFF      EQU   X'FF'               USED TO COMPARE FOR ANY BITS  S05331 87500010
*                                    ON                          S05331 87700010
ZERO     EQU   0                   CONSTANT VALUE 0              S05331 87900010
         EJECT                                                 @Y17XAU2 87970010
RESPL    RESPL                                                 @Y17XAU2 88040010
         EJECT                                                 @Y17XAU2 88110010
         OLTCB                                                   S22024 88500022
DTIM003  DS    F .                 SAVE AREA                   @Y17XAUU 88700010
         END                                                            88900022
./  ADD  SSI=72000247,NAME=IEDQWAC
         TITLE 'IEDQWV  GRAB - $LETGO SERVICE MODULE'                   00100000
IEDQWV   CSECT                                                          00200000
*A000000-999999                                                @Y16X5U0 00300000
* CHANGE ACTIVITY AS FOLLOWS:                                    S22024 00400000
*A216000                                                         A41584 00500000
*A276000                                                         A41584 00600000
*C444000                                                         A41584 00700000
* A004400,A010000-016000,A136000,A228540-228560,C232000,C244000  S22024 00800000
* A395000-398700,C672400,A676410-676430,C836000                  S22024 00900000
*C675800                                                       @XA06343 01000000
*A228780,228800,269120,396500,397300,652000,696000,696370      @Y17XAUU 01100000
*A752000,755700,821700,836000                                  @Y17XAUU 01200000
*C269720,395100,397200,398600,676410,752100-752200,752315      @Y17XAUU 01300000
*C752321,752333,752350                                         @Y17XAUU 01400000
* A014000,138000,198000,199000,445000,623000,624000,631000,    @G36XRUV 01410010
* A644000,673000                                               @G36XRUV 01420010
* C199000,200000,446000,632000,645000                          @G36XRUV 01430010
* D622000                                                      @G36XRUV 01440010
*   TOTE ALIAS                                                 @OY13283 01445010
*                                                                       01450010
*********************************************************************** 01500000
*                                                                     * 01600000
* DESCRIPTIVE NAME:  GRAB AND $LETGO SERVICE MODULE              S22024 01700000
*                                                                S22024 01800000
* MODULE NAME: IEDQWV (TCAM,TOTE)                              @Y17XAUU 01900000
*                                                                S22024 02000000
* STATUS: VERSION 10.0                                         @Y17XAUU 02100000
*                                                                     * 02200000
* FUNCTIONS:                                                          * 02300000
*                                                                     * 02400000
*       GRAB -                                                        * 02500000
*       THE PURPOSE OF THIS ROUTINE IS TO ASSIGN A SECONDARY          * 02600000
*       DEVICE TO THE UNIT TEST.                                      * 02700000
*                                                                     * 02800000
*       THE GRAB MACRO REQUESTS THAT A SECONDARY DEVICE MEETING       * 02900000
*       SPECIFIED REQUIREMENTS BE ASSIGNED TO THE UNIT TEST.          * 03000000
*                                                              @Y17XAUU 03010000
*       IF THE GRAB REQUEST IS FOR A SNA LU COUNTERFEIT        @Y17XAUU 03020000
*       CONTROL BLOCKS MUST BE SET UP FOR THE TEST DEVICE.     @Y17XAUU 03030000
*       IEDQWB2 IS CALLED TO PROCESS THE COUNTERFEITING OF     @Y17XAUU 03040000
*       TTE, QCB, AND LGB.                                     @Y17XAUU 03050000
*                                                                     * 03100000
*       THE DEVICE ENTRY LIST BUILT FROM THE TEST REQUEST MESSAGE     * 03200000
*       IS SEARCHED TO FIND A DEVICE MEETING THE SPECIFIED REQUIRE-   * 03300000
*       MENTS.  IF A PROPER DEVICE IS FOUND, IT IS ASSIGNED AS        * 03400000
*       A TEST DEVICE TO THE UNIT TEST.                               * 03500000
*                                                                     * 03600000
*       AT THE COMPLETION OF THIS ROUTINE, ONE OF THE FOLLOWING       * 03700000
*       RETURN CODES IS PLACED IN REGISTER 15:                        * 03800000
*                                                                     * 03900000
*       X'00' - NORMAL COMPLETION OF THE GRAB FUNCTION.               * 04000000
*       X'04' - UNSUPPORTED MACRO                              @Y17XAUU 04100000
*       X'08' - NO (MORE) DEVICES IN THE ENTRY LIST MEET              * 04200000
*       THE SPECIFIED REQUIREMENTS.                                   * 04300000
*                                                                     * 04400000
*       X'0C' - DEVICE ENTRY LIST CONTAINS ONLY ONE DEVICE.           * 04500000
*                                                                     * 04600000
*       $LETGO -                                                      * 04700000
*       THE PURPOSE OF THIS ROUTINE IS TO REMOVE A PREVIOUSLY         * 04800000
*       GRABED DEVICE FROM THE DEVICE TABLE                           * 04900000
*                                                                     * 05000000
* ENTRY POINT:                                                        * 05100000
*                                                                     * 05200000
*       IEDQWV - CALLED WHEN A GRAB OR $LETGO MACRO IS ISSUED         * 05300000
*       BY THE UNIT TEST                                              * 05400000
*                                                                     * 05500000
* LINKAGE: BALR R14,R15 FROM IEDQWA                            @Y17XAUU 05600000
*                                                              @Y17XAUU 05700000
* MODULE TYPE: PROCEDURE                                       @Y17XAUU 05800000
*                                                              @Y17XAUU 05900000
* MODULE SIZE: 2K MAXIMUM                                      @Y17XAUU 06000000
*                                                              @Y17XAUU 06100000
* PROCESSOR: ASSEMBLER XF                                      @Y17XAUU 06200000
*                                                              @Y17XAUU 06300000
* MACROS:AQCTL,SAVE,CLOSE,DELETE,LOAD,DEQ,ENQ,IEDHJN,OPEN      @Y17XAUU 06400000
*                                                              @Y17XAUU 06500000
* INPUT:        REGISTERS 01,02,13,14,15 CONTAIN THE FOLLOWING VALUES:* 06600000
*                                                                     * 06700000
*                         01-GRAB PARAMETER LIST ADDRESS              * 06800000
*                         02-OLTCB POINTER                            * 06900000
*                         13-SAVE AREA ADDRESS                        * 07000000
*                         14-RETURN ADDRESS                           * 07100000
*                         15-ENTRY POINT ADDRESS                      * 07200000
*                                                                     * 07300000
*                                                                     * 07400000
* OUTPUT:       REGISTERS 15 CONTAIN THE FOLLOWING VALUES:            * 07500000
*                                                                     * 07600000
*                         15-RETURN CODE:- GRAB                       * 07700000
*                            X'00' - NORMAL COMPLETION                * 07800000
*                            X'04' - UNSUPPORTED MACRO         @Y17XAUU 07900000
*                            X'08' - NO (MORE)DEVICES IN THE ENTRY    * 08000000
*                                    LIST MEET THE SPECIFIED          * 08100000
*                                    REQUIREMENTS                     * 08200000
*                            X'0C' - DEVICE ENTRY LIST CONTAINS ONLY  * 08300000
*                                    ONE DEVICE                       * 08400000
*                                                                     * 08500000
*                         15-RETURN CODE:- $LETGO                     * 08600000
*                            X'00' NORMAL COMPLETION                  * 08700000
*                            X'04' - UNSUPPORTED MACRO         @Y17XAUU 08800000
*                            X'0C' DEVICE NOT PREVIOUSLY GRABED       * 08900000
* EXTERNAL ROUTINE: IEDQTNT - FIND TTE                         @Y17XAUU 09000000
*                    IEDQA1 - FIND TTCIN                       @Y17XAUU 09100000
*                    IEDIAP04 - FIND NETWORK ADDRESS           @Y17XAUU 09200000
*                    IEDQWB2 - COUNTERFEIT SNA LU TEST DEVICE  @Y17XAUU 09250000
*                                                                     * 09300000
* EXIT POINTS:    BR AFTER 'GRB070'   TO IEDQWA                       * 09400000
*                                                                     * 09500000
* TABLES/WORK AREAS:  OLTCB                                           * 09600000
*                                                                     * 09700000
* ATTRIBUTES:                                                         * 09800000
*                                                                     * 09900000
*       ENABLED, PROBLEM PROGRAM MODE, RESIDENT, REENTRANT     @Y17XAUU 10000000
*                                                                     * 10100000
* COPYRIGHT='NONE'                                               S22024 10200000
*                                                              @Y17XAUU 10300000
* NOTE: SEE BELOW                                              @Y17XAUU 10400000
*                                                              @Y17XAUU 10500000
*  DEPENDENCIES: EBCDIC CHARACTER CODE SET                     @Y17XAUU 10600000
*                                                              @Y17XAUU 10700000
*  RESTRICTIONS: NONE                                          @Y17XAUU 10800000
*                                                              @Y17XAUU 10900000
*  REGISTER CONVENTIONS: SEE REGISTERS ASSIGNMENT              @Y17XAUU 11000000
*                                                              @Y17XAUU 11100000
*  PATCH LABEL: PATCH                                          @Y17XAUU 11200000
*                                                                     * 11300000
*********************************************************************** 11400000
*                                                                       11500000
*        EQUATES                                                        11600000
*                                                                       11700000
R0       EQU   0                       REG 0                     S99528 11800000
R1       EQU   1                       REG 1                     S99528 11900000
R2       EQU   2                       REG 2                     S99528 12000000
R3       EQU   3                       REG 3                     S99528 12100000
R4       EQU   4                       REG 4                     S99528 12200000
R5       EQU   5                       REG 5                     S99528 12300000
R6       EQU   6                       REG 6                     S99528 12400000
R7       EQU   7                       REG 7                     S99528 12500000
R8       EQU   8                       REG 8                     S99528 12600000
R9       EQU   9                       REG 9                     S99528 12700000
R10      EQU   10                      REG 10                    S99528 12800000
R11      EQU   11                      REG 11                    S99528 12900000
R12      EQU   12                      REG 12                    S99528 13000000
R13      EQU   13                      REG 13                    S99528 13100000
R14      EQU   14                      REG 14                    S99528 13200000
R15      EQU   15                      REG 15                    S99528 13300000
PURGE    EQU   X'10'              SVC EQUATE FOR PURGE           A41584 13400000
PARMREG0 EQU   R0                      MSG PARM                  S99528 13500000
PARMREG1 EQU   R1                      MSG PARM                  S99528 13600000
ZERO     EQU   0                       ZERO DISPLACEMENT         S99528 13700000
THREE    EQU   3                       THREE                     S99528 13800000
HALF     EQU   3                       HALF WORD               @G36XRUV 13850010
FOUR     EQU   4                       FOUR                      S99528 13900000
FIVE     EQU   5                       FIVE                      S99528 14000000
EIGHT    EQU   8                       EIGHT                     S99528 14100000
D0       EQU   0                  DISPLACEMENT OF 0            @Y17XAUU 14150000
D2       EQU   2                       TWO                       S22024 14200000
D3       EQU   3                  DISPLACEMENT OF 3            @Y17XAUU 14250000
TEN      EQU   10                      TEN                       S99528 14300000
D4       EQU   4                       FOUR                      S22024 14400000
D32      EQU   32                      THIRTY TWO                S22024 14500000
D34      EQU   34                      DISPLACEMENT 34           S99528 14600000
SYMCLASS EQU   X'44'                   CLASS SUPORTED            S22024 14700000
SAMSAMSA EQU   X'55'                   SAME CHANNEL SAME CONTROL S22024 14800000
*                                      UNIT SAME DEVICE          S22024 14900000
NXTDEV   EQU   X'01'                   NEXT DEV IN LIST          S22024 15000000
ADRMSK   EQU   7                       ADDRESS MASK            @Y17XAUU 15100000
RETDAF   EQU   X'10'              DAF RETURNED RET CODE        @Y17XAUU 15150000
DISREG2  EQU   28                 DISPLACEMENT TO REG 2        @Y17XAUU 15200000
ERRCD08  EQU   8                  ERROR RETURN CODE            @Y17XAUU 15250000
ERRCD12  EQU   12                 ERROR RETURN CODE            @Y17XAUU 15300000
D1       EQU   1                  DISPLACEMENT OF 1            @Y17XAUU 15400000
D5       EQU   5                       DISPLACEMENT OF 5       @Y17XAUU 15500000
D8       EQU   8                  DISPLACEMENT OF 8            @Y17XAUU 15600000
X25      EQU   X'25'                   DISPLACEMENT OF X'25'   @Y17XAUU 15700000
XFF      EQU   X'FF'              MASK FIELD                   @Y17XAUU 15750000
ADRMSK7  EQU   7                  ADDRESS MASK                 @Y17XAUU 15770000
         EJECT                                                          15800000
IEDQWAC  EQU   *                                                 S99528 15900000
IEDQW21  EQU   *                                               @Y17XAUU 16000000
         ENTRY IEDQW21,IEDQWAC                                   S99528 16100000
         USING IEDQWV,R15              ADDRESSIBILITY            S99528 16200000
IEDQWV   IEDHJN IEDQWVV,HJN            NAME AND HJN              S99528 16300000
         DROP  R15                                               S99528 16400000
         USING IEDQWV,R4                                                16500000
         USING TOTOLTCB,R2             TOTE CONTROL BLOCK        S22024 16600000
         SAVE  (14,12)                 SAVE REGS                 S99528 16700000
         LR    R4,R15             SET BASE REG.                         16800000
         LA    R15,TOTSAVE1            ADDRESS OF OWN SAVE AREA  S22024 16900000
         ST    R15,8(R13)         PUT ADDR. IN CALLER'S SAVE.           17000000
         ST    R13,4(R15)         SAVE ADDR. OF CALLER'S SAVE AREA.     17100000
         LR    R13,R15            SET R13 TO POINT TO OWN SAVE AREA.    17200000
         SPACE                                                          17300000
         CLI   1(R1),X'02'        CORRECT MACRO LEVEL.                  17400000
         BE    GRB000             YES.                                  17500000
*                                                                       17600000
         LA    R15,FOUR                INCORRECT LEVEL MACRO     S99528 17700000
         B     GRB070                  EXIT                      S99528 17800000
         SPACE                                                          17900000
GRB000   EQU   *                                                 S99528 18000000
         MVC   TOTSERV(END-START),START SET UP WORK AREA       @Y17XAUU 18100000
         MVC   BLDLLIST(BLDLEND-BLDLLIST),QLDLLIST COPY        @Y17XAUU 18130000
*                                      BLDL PLIST              @Y17XAUU 18160000
         LA    R15,JFCBAA              GET JFCB ADDRESS        @Y17XAUU 18200000
         STCM  R15,ADRMSK,JFCBADDR+D1  SAVE IN EXIT PLIST      @Y17XAUU 18300000
         LA    R15,ADDOFUCB            USC ADDRESS             @Y17XAUU 18400000
         STCM  R15,ADRMSK,TOT102+D1    SAVE IN PLIST           @Y17XAUU 18500000
         LA    R15,TOT102LN            GET ADDRESS OF LEN FIELD@Y17XAUU 18600000
         STCM  R15,ADRMSK,TOT102A+D5   ADDRESS OF LENGTH FIELD @Y17XAUU 18700000
         LA    R15,JFCBADDR            GET ADDRESS OF JFCB     @Y17XAUU 18800000
         STCM  R15,ADRMSK,EXCPDCB+X25  PUT IT IN DCB EXLST     @Y17XAUU 18900000
         LA    R15,QNAME               GET QNAME ADDRESS       @Y17XAUU 19000000
         ST    R15,DEQLIST+D4          PUT IN DEQ PLIST        @Y17XAUU 19100000
         LA    R15,RNAME               GET RNAME ADDRESS       @Y17XAUU 19200000
         ST    R15,DEQLIST+D8          PUT IN DEQ PLIST        @Y17XAUU 19300000
         MVC   CDSLINE,NAMEFLD         INIT NAME FIELD         @Y17XAUU 19400000
         EJECT                                                          19450000
         ST    R1,GRABPARM             SAVE PARM POINTER         S99528 19500000
         CLC   2(2,R1),GRABREQ         GRAB REQUEST?           @Y17XAUU 19600000
         BNE   LET002                  NO ASSUME ENTRY FOR LETGO S99528 19700000
         LA    R11,8(R1)               GET FLAG BYTE             S99528 19800000
         SR    R10,R10                 CLEAR                   @G36XRUV 19850010
         ICM   R10,HALF,TOTPRUCB       GET PRIMARY UCB ADDR    @G36XRUV 19900010
         SR    R9,R9                   CLEAR                   @G36XRUV 19950010
         ICM   R9,HALF,TOTSCUCB        GET SECONDARY UCB ADDR  @G36XRUV 20000010
         LA    R9,0(R9)                CLEAR HIGH ORDER BYTE     S99528 20100000
         LTR   R9,R9                   IS PURGE REQUIRED         S99528 20200000
         BZ    GRB0005                 NO BYPASS PURGE           S99528 20300000
         LA    R1,TOTSCDCB             SECENDARY DEC             S99528 20400000
         ST    R1,OPENAREA             STORE IN P LIST           S99528 20500000
         MVI   OPENAREA,X'B0'          OPTION CLOSE              S99528 20600000
         LA    R1,OPENAREA             ADDRESS OF P LIST         S99528 20700000
         CLOSE MF=(E,(1))              CLOSE SECONDARY DCB       S99528 20800000
GRB0005  EQU   *                                                 A41584 20900000
         LA    R1,TOTTDTBL             FIRST ENTRY POINTER       S99528 21000000
         L     R1,4(R1)                GET SECOND ENTRY          S99528 21100000
         LTR   R1,R1                   AT LEAST TWO ENTRIES      S99528 21200000
         BP    GRB001                  YES BRANCH                S99528 21300000
         LA    R15,ERRCD12             SET RETURN CODE         @Y17XAUU 21400000
          B     GRB070                 GET OUT                   S99528 21500000
GRB001   L     R8,TOTGRABP             GET GRAB POINTER          S99528 21600000
GRB002   LA    R8,4(R8)                BUMP GRAB POINTER TO NEXT S99528 21700000
         L     R9,0(R8)                GET TNT ADDRESS           S99528 21800000
         ST    R9,TOTSRTNT             SAVE IT                   S99528 21900000
         LA    R5,TOTTDEND             GET ADDRESS OF END OF TABLS99528 22000000
         CR    R5,R8                   GRAB POINTER PAST END OF  S99528 22100000
         BE    EIGRET                  YES BRANCH                S22024 22200000
         L     R7,0(R8)                GET UCB ADDRESS           S99528 22300000
         LA    R7,0(R7)                CLEAR HI BYTE             S99528 22400000
         LTR   R7,R7                   IS THIS A UCB ADDRESS?    S99528 22500000
         BZ    EIGRET                  NO BRANCH                 S22024 22600000
         ST    R8,TOTGRABP             SAVE GRAB POINTER TO NXT  S22024 22700000
         OI    0(R8),TOTTDGRB          TURN ON GRAB FLAG         S22024 22800000
         CR    R7,R10                  IS GRABED DEVICE PRIMARY  S99528 22900000
         BNE   GRB008                  NO BRANCH                 S99528 23000000
EIGRET   EQU   *                                                 S22024 23100000
         LA    R15,8                   DEVICE NOT FOUND CODE     S99528 23200000
         B     GRB070                  RETURN                    S99528 23300000
MOVECDS  MVC   CDSLINE,0(R7)           MOVE NAME FOR LOAD        S22024 23400000
         EJECT                                                          23450000
QCBFIND  EQU   *                       FIND SECONDARY QCB,RESOU@Y17XAUU 23500000
*                                      CE ID,AND THE LCB         S22024 23600000
         LR    R9,R7                   GET TNT ADDRESS           S22024 23700000
         ST    R9,TRMTNT               SAVE TNT ADDRESS        @Y17XAUU 23750000
         SR    R3,R3                   CLEAR REG                 S22024 23800000
         IC    R3,TOTTTBEL             GET NAME LENGTH           S22024 23900000
         AR    R9,R3                   ADDRESS PTR               S22024 24000000
         MVC   TNTENTRY+D1(D3),D0(R9)  ALLINE ADDRESS          @Y17XAUU 24050000
         BCTR  R3,0                    DECREMENT FOR EX          S22024 24200000
         EX    R3,MOVECDS              MOVE NAME TO CDS          S22024 24300000
         L     R9,TNTENTRY             TTE ADDRESS             @Y17XAUU 24350000
         USING IEDQTRM,R9              TTE                       S22024 24500000
         L     R6,TOTAVTPT             GET AVT ADDRESS         @Y17XAUU 24600000
         USING IEDQAVTD,R6             SET AVT ADDRESSABILITY  @Y17XAUU 24700000
         L     R15,AVTRNMPT            TERM NAME TABLE ADDR    @Y17XAUU 24730000
         ST    R15,TERNMTAB            SAVE IT                 @Y17XAUU 24760000
         L     R15,AVTMSGS-D1          VCON TABLE ADDRESS      @Y17XAUU 24800000
         L     R15,D8(R15)             ADDRESS OF A1 ROUTINE   @Y17XAUU 24900000
         LA    R0,1(R3)                GET NAME LENGTH         @Y17XAUU 25000000
         LA    R1,CDSLINE              GET ADDRESS OF NAME     @Y17XAUU 25100000
         BAL   R14,FOUR(R15)           FIND SEC TD TTCIN       @Y17XAUU 25200000
*                                                              @Y17XAUU 25300000
*        IEDQA1 RETURNS TEST DEVICE TTCIN IN REG 15            @Y17XAUU 25400000
*                                                              @Y17XAUU 25500000
         STH   R15,TOTSCOFF            SAVE SC TD TTCIN        @Y17XAUU 25600000
         LR    R1,R15                  SET UP TO FIND NETWORK  @Y17XAUU 25700000
*                                      ADDRESS                 @Y17XAUU 25800000
         L     R15,AVTSAVTP            GET SAVT ADDRESS        @Y17XAUU 25900000
         L     R15,SAVTTNTX-IEDNSVTD(R15) GET ADDRESS OF TTCIN @Y17XAUU 26000000
*                                      TO NETWORK ADDR CONV RTN@Y17XAUU 26100000
         BALR  R14,R15                 FIND NETWORK ADDRESS    @Y17XAUU 26200000
*                                                              @Y17XAUU 26300000
*        IEDIAP04 RETURNS NETWORK ADDRESS IN REG 15            @Y17XAUU 26400000
*                                                              @Y17XAUU 26500000
         STH   R15,TOTSRSID            SAVE NETWORK ADDRESS    @YM07278 26600000
         DROP  R6                                              @Y17XAUU 26700000
         EJECT                                                          26750000
         L     R9,TRMDESTQ-1           QCB ADDRESS               S22024 26800000
         ST    R9,TRMQCB               SAVE QCB ADDRESS        @Y17XAUU 26850000
         DROP  R9                      TTE                       S22024 26900000
         USING IEDQQCB,R9              QCB                       S22024 27000000
         L     R9,QCBLGBAD-1           LGB ADDRESS               S22024 27100000
         DROP  R9                      QCB                       S22024 27200000
         USING IEDNLGB,R9              LGB                       S22024 27300000
         MVC   NAMESAVE(D8),LGBNAME    SAVE GROUP NAME         @Y17XAUU 27400000
         DROP  R9                      LGB                       S22024 27500000
         L     R1,TNTENTRY             GET TTE ADDRESS         @Y17XAUU 27550000
         BAL   R14,NCPTTE              GET NCP TTE ADDRESS     @Y17XAUU 27700000
*                                                              @Y17XAUU 27800000
*        ON RETURN R1 CONTAINS ADDRESS OF NCP TTE PREFIX       @Y17XAUU 27900000
*                                                              @Y17XAUU 28000000
         USING IEDNTRM,R1              SET TTE ADDRESSABILITY  @Y17XAUU 28100000
         L     R1,TRMDESTQ-D1          GET QCB ADDRESS         @Y17XAUU 28200000
         DROP  R1                                              @Y17XAUU 28300000
         USING IEDQQCB,R1              SET QCB ADDRESSABILITY  @Y17XAUU 28400000
         L     R9,QCBDCBAD-D1          GET 3705 DCB ADDRESS    @Y17XAUU 28500000
         USING IHADCB,R9               DCB                       S22024 28600000
         L     R3,DCBIOBAD             IOB ADDRESS               S22024 28700000
         SR    R6,R6                   CLEAR REG                 S22024 28800000
         IC    R6,DCBEIOBX             LCB SIZE                  S22024 28900000
         AR    R3,R6                   LCB OFFSET FROM DCB       S22024 29000000
         LA    R6,D32                  ADD ADJUSTMENT TO START   S22024 29100000
*                                      OF LCB                    S22024 29200000
         DROP  R9                                              @Y17XAUU 29250000
         SR    R3,R6                   STARTING LCB ADDRESS      S22024 29300000
         STCM  R3,ADRMSK,TOTSCLCB      SAVE RN LCB             @Y17XAUU 29400000
         BAL   R9,DUMMYTNT             CHECK FOR COUNTERFEITING@Y17XAUU 29420000
         LTR   R15,R15                 GOOD RETURN             @Y17XAUU 29440000
         BNZ   MOVEIN1                 ERROR EXIT              @Y17XAUU 29460000
         L     R5,GRABPARM             GET PARM ADDRESS          S22024 29500000
         USING GRABMAP,R5              GRAB PARM                 S22024 29600000
         CLI   $GRABCLS,SYMCLASS       CLASS 44                  S22024 29700000
         BNE   EIGRET                  NO BRANCH                 S22024 29800000
         CLI   $GRABFLG,NXTDEV         REQ FOR NEXT DEV IN LIST  S22024 29900000
         BE    LOADNAME                YES BRANCH                S22024 30000000
         CLI   $GRABFLG,SAMSAMSA       REQ FOR CH,CU,DV          S22024 30100000
         BNE   EIGRET                  NO BRANCH                 S22024 30200000
         CLC   TOTSCLCB,TOTPRLCB       LCB FOR PRI AND SEC SAME  S22024 30300000
         BNE     GRB001                NO BRANCH                 S22024 30400000
         B     LOADNAME                GO LOAD CDS               S22024 30500000
         EJECT                                                          30550000
GRB008   EQU   *                                                 S22024 30600000
         TM    0(R8),TOTTDORN          TEST DEVICE ON RN         S22024 30700000
         BO    QCBFIND                 YES BRANCH              @Y17XAUU 30800000
         TM    0(R8),TOTTDTRM          TERMINAL TEST ON 0X       S22024 30900000
         BO    UCBFIND                 YES BRANCH                S99528 31000000
*        CHECK FOR VALID DEVICE                                         31100000
TNTRET   EQU   *                                                 S99528 31200000
         SPACE                                                          31300000
         TM    0(R11),CLOMIT           WAS CLASS OMITTED         S99528 31400000
         BO    GRB010             BRANCH IF YES.                        31500000
         SPACE                                                          31600000
         CLC   18(1,R7),1(R11)         DOES CLASS COMPARE        S99528 31700000
         BNE   GRB002             BRANCH IF NO - GET NEXT ENTRY.        31800000
         SPACE                                                          31900000
GRB010   TM    0(R11),TYOMIT      WAS TYPE OMITTED ?                    32000000
         BO    GRB015             BRANCH IF YES.                        32100000
         SPACE                                                          32200000
         MVC   CLASS(1),19(R7)         UCB TYPE                  S99528 32300000
         NI    CLASS,X'0F'             CLEAR HI NIBBLE           S99528 32400000
         CLC   CLASS,CLAS02            CLASS 2702                S99528 32500000
         BNE   CLASS1                  NO BR                     S99528 32600000
         MVI   CLASS,X'02'             CLASSS TO 2702            S99528 32700000
         B     COMPCLAS                GO COMPARE CLASS          S99528 32800000
CLASS1   CLC   CLASS,CLAS01            CLASS 2701                S99528 32900000
         BNE   CLA7770                 NO BR                     S99528 33000000
         MVI   CLASS,X'01'             CLASS TO 2701             S99528 33100000
         B     COMPCLAS                GO COMPARE CLASS          S99528 33200000
CLA7770  CLC   CLASS,CLASS77           CLASS 7770                S99528 33300000
         BNE   COMPCLAS                NO BR                     S99528 33400000
         MVI   CLASS,X'04'             CLASS TO 04               S99528 33500000
COMPCLAS CLC   CLASS,2(R11)            DOES TYPE COMPARE         S99528 33600000
         BNE   GRB002             BRANCH IF NO - GET NEXT ENTRY.        33700000
         SPACE                                                          33800000
GRB015   TM    0(R11),DCH+CH      IS ANY CHANNEL OK ?                   33900000
         BZ    GRB025             BRANCH IF YES.                        34000000
         SPACE                                                          34100000
         CLC   4(1,R7),4(R10)     SAME CHANNEL AS PRIMARY ?             34200000
         BE    GRB020             BRANCH IF YES.                        34300000
         SPACE                                                          34400000
         TM    0(R11),DCH         WAS DIFFERENT CHNL REQUESTED ?        34500000
         BO    GRB025             BRANCH IF YES.                        34600000
         B     GRB002             GET NEXT ENTRY.                       34700000
         EJECT                                                          34750000
         SPACE                                                          34800000
GRB020   TM    0(R11),CH          WAS SAME CHNL REQUESTED ?             34900000
         BZ    GRB002             BRANCH IF NO - GET NEXT ENTRY.        35000000
         SPACE                                                          35100000
GRB025   TM    0(R11),DCU+CU      IS ANY CONTROL UNIT OK ?              35200000
         BZ    GRB035             BRANCH IF YES.                        35300000
         SPACE                                                          35400000
         L     R5,0(R7)           GET UCB INFO.                         35500000
         N     R5,GRB080          CLEAR ALL BUT CNTL UNIT BITS.         35600000
         L     R6,0(R10)          GET PRIM DEV UCB INFO.                35700000
         N     R6,GRB080          CLEAR ALL BUT CNTL UNIT BITS.         35800000
         CR    R5,R6              IS IT SAME CNTL UNIT ?                35900000
         BE    GRB030             BRANCH IF YES.                        36000000
         SPACE                                                          36100000
         TM    0(R11),DCU         WAS DIFFERENT CNTL UNIT REQUESTED.    36200000
         BO    GRB035             BRANCH IF YES.                        36300000
         B     GRB002             GET NEXT ENTRY.                       36400000
         SPACE                                                          36500000
GRB030   TM    0(R11),CU          WAS SAME CNTL UNIT REQUESTED ?        36600000
         BZ    GRB002             BRANCH IF NO - GET NEXT ENTRY.        36700000
         SPACE                                                          36800000
GRB035   TM    0(R11),DDV+DV      IS ANY DEVICE OK ?                    36900000
         BZ    GRB045             BRANCH IF YES.                        37000000
         SPACE                                                          37100000
         L     R5,0(R7)           GET UCB INFO.                         37200000
         N     R5,GRB081          CLEAR ALL BUT DEVICE BITS.            37300000
         L     R6,0(R10)          GET PRIM DEV UCB INFO.                37400000
         N     R6,GRB081          CLEAR ALL BUT DEVICE BITS.            37500000
         CR    R5,R6              IS IT THE SAME DEVICE ?               37600000
         BE    GRB040             BRANCH IF YES.                        37700000
         SPACE                                                          37800000
         TM    0(R11),DDV         WAS DIFFERENT DEVICE REQUESTED ?      37900000
         BO    GRB045             BRANCH IF YES.                        38000000
         B     GRB002             GET NEXT ENTRY.                       38100000
         SPACE                                                          38200000
GRB040   TM    0(R11),DV          WAS SAME DEVICE REQUESTED ?           38300000
         BZ    GRB002             BRANCH IF NO - GET NEXT ENTRY.        38400000
         SPACE                                                          38500000
GRB045   L     R11,TOTAVTPT            GET AVT ADDRESS         @Y17XAUU 38600000
         USING IEDQAVTD,R11            AVT ADDRESSIBILITY        S99528 38700000
         L     R11,AVTTCB              GGT TCB  ADDRESS          S99528 38800000
         DROP  R11                                               S99528 38900000
         L     R11,8(R11)              GET FIRST DEB POINTER     S99528 39000000
         USING DEBNMSUB,R11            CLEAR R10                 S99528 39100000
         SR    R10,R10                 GET NUMBER OF EXTENTS     S99528 39200000
NXTDEBNT IC    R10,DEBNMEXT            FROM DEB                  S99528 39300000
         LR    R12,R10                 SAVE                      S99528 39400000
         L     R5,DEBUCBAD             GET UCB ADDRESS           S99528 39500000
UCBCOMP  LA    R5,ZERO(R5)             CLEAR HI BYTE             S99528 39600000
         CR    R5,R7                   SAME UCB                  S99528 39700000
         BE    RLNCOMPT                YES BRANCH                S99528 39800000
         BCTR  R10,0                   DECREMENT EXTENT NUMBER   S99528 39900000
         LTR   R10,R10                 ZERO YET?                 S99528 40000000
         BZ    NEXTDEB                 YES BRANCH                S99528 40100000
         L     R5,DEBUCBAD+4           GET NEXT UCB ADDRESS      S99528 40200000
         B     UCBCOMP                 BRANCH                    S99528 40300000
         EJECT                                                          40350000
NEXTDEB  L     R11,4(R11)              GET ADDRESS OF NEXT DEB   S99528 40400000
         LA    R11,ZERO(R11)           CLEAR HI BYTE             S99528 40500000
         LTR   R11,R11                 ADDRESS HERE              S99528 40600000
         BZ    NOTFOUND                NO BR                     S99528 40700000
         B     NXTDEBNT                BRANCH                    S99528 40800000
RLNCOMPT SR    R12,R10                 COMPUTE RLN               S99528 40900000
         STC   R12,TOTSCRLN            STORE RLN IN TOTSCENT     S99528 41000000
         STH   R5,TOTSCUCB             STORE UCB IN TOTSCENT     S99528 41100000
         STH   R5,ADDOFUCB             STORE UCB ADDRESS         S99528 41200000
         L     R10,DEBDCBAD            GET DCB ADDRESS           S99528 41300000
         USING IHADCB,R10                                        S99528 41400000
         L     R7,DCBIOBAD             GET DUMMY IOB ADDRESS     S99528 41500000
         DROP  R10                                               S99528 41600000
         LA    R6,32                   GET IOB DISPLACEMENT      S99528 41700000
         SR    R7,R6                   POINT TO DUMMY LCB        S99528 41800000
         MH    R12,LCBLENGT            FIND POINTER TO           S99528 41900000
         AR    R7,R12                  RIGHT LCB                 S99528 42000000
         TM    TOTTDTBL,TOTTDTRM       IS ENTRY TNT              S99528 42100000
         BO    NAMEBULD                YES BRANCH                S99528 42200000
         ST    R7,TOTSCQCB             SAVE LCB ADDRESS          S22024 42300000
         USING UCBOB,R5                                          S99528 42400000
         MVC   CDSLINE+FIVE(THREE),UCBNAME  NAME TO LOAD         S99528 42500000
         DROP  R5                                                S99528 42600000
         EJECT                                                          42650000
*        CDS FOR GRABED DEVICE                                          42700000
LOADNAME EQU   *                                                 S99528 42800000
         MVC   BLDLNAM(D8),CDSLINE COPY SYMBOLIC NAME          @Y17XAUU 42801000
         BLDL  0,BLDLLIST         FIND CDS                     @Y17XAUU 42802000
         LTR   R15,R15            RECORD FOUND                 @Y17XAUU 42803000
         BZ    GC040              YES - GO LOAD IT             @Y17XAUU 42804000
         TM    TOTFLG10,TOTTERMS  TERMINAL ENTRY               @Y17XAUU 42805000
         BZ    GCLINK             NO - LINE                    @Y17XAUU 42806000
         SLR   R9,R9              CLEAR REG                    @Y17XAUU 42807000
         SLR   R8,R8              CLEAR REG                    @Y17XAUU 42808000
         IC    R9,TOTTTBEL        NAME LENGTH                  @Y17XAUU 42809000
         ICM   R8,ADRMSK7,TOTTDTBL+D1 TNT ADDRESS              @Y17XAUU 42810000
         AR    R8,R9              ADDRESS OF TTE ADDRESS       @Y17XAUU 42811000
         ICM   R8,ADRMSK7,D0(R8)  TTE ADDRESS                  @Y17XAUU 42812000
         LA    R9,TRMPRFSZ        TTE PREFIX SIZE              @Y17XAUU 42813000
         SLR   R8,R9              TTE PREFIX ADDRESS           @Y17XAUU 42814000
         USING IEDNTRM,R8         TTE PREFIX BASE              @Y17XAUU 42815000
         CLI   TRMTYPE,TRMLUNT    LU ENTRY                     @Y17XAUU 42816000
         BNE   CDSPRES            NO                           @Y17XAUU 42817000
         LH    R9,TRMCHCIN        DCT INDEX                    @Y17XAUU 42818000
         BCTR  R9,R0              ADJUST INDEX                 @Y17XAUU 42819000
         L     R6,TOTAVTPT        GET AVT ADDRESS              @Y17XAUU 42820000
         USING IEDQAVTD,R6        SET AVT ADDRESSABILITY       @Y17XAUU 42821000
         MH    R9,AVTDCTLN        OFFSET TO DCT ENTRY          @Y17XAUU 42822000
         A     R9,AVTCSTCS        DCT ENTRY ADDRESS            @Y17XAUU 42823000
         DROP  R6                                              @Y17XAUU 42824000
         USING IEDDCT,R9          SET DCT ADDRESSABILITY       @Y17XAUU 42825000
         TM    DCTBYTE1,DCT3270   SNA 3270 LU                  @Y17XAUU 42826000
         BO    CDSPRES            YES                          @Y17XAUU 42827000
         DROP  R9                                              @Y17XAUU 42828000
*        BUILD CDS RECORD FOR 3767 OR 3770                     @Y17XAUU 42829000
         L     R1,GRABPARM        GET GRAB PARAMETER           @Y17XAUU 42830000
         USING GRABMAP,R1         SET ADDRESSABILITY           @Y17XAUU 42831000
         SLR   R3,R3              CLEAR REG                    @Y17XAUU 42832000
         IC    R3,$GRABCNT        GET BUFFER SIZE              @Y17XAUU 42833000
         L     R5,$GRABCDS        GET BUFFER ADDRESS           @Y17XAUU 42834000
         LA    R15,0              SET GOOD RETURN CODE         @Y17XAUU 42835000
         BCTR  R3,0               ADJUST BYTES COUNT           @Y17XAUU 42836000
         EX    R3,SNACDS          MOVE CDS TO BUFFER           @Y17XAUU 42837000
         DROP  R1                                              @Y17XAUU 42838000
         USING IEDTCDSD,R5        SET CDS ADDRESSABILTITY      @Y17XAUU 42839000
         MVC   TCDSNAM(D8),CDSLINE  SET SYMBOLIC NAME          @Y17XAUU 42840000
         SLR   R1,R1              CLEAR REG                    @Y17XAUU 42841000
         ICM   R1,3,TOTSCUCB      GET UCB ADDRESS              @Y17XAUU 42842000
         USING UCB,R1             SET UCB ADDRESSABILITY       @Y17XAUU 42843000
         MVC   TCDSUCB+D2(D2),UCBCHA  SET UCB BINARY CUU ADDR  @Y17XAUU 42844000
         DROP  R1                                              @Y17XAUU 42845000
         B     NODELETE           EXIT                         @Y17XAUU 42846000
         SPACE                                                          42847000
GCLINK   DS    0H                 BOUNDARY ALLIGNMENT          @Y17XAUU 42848000
*        CONSTRUCT 3705 LINE CDS                               @Y17XAUU 42849000
         L     R1,GRABPARM        POINT TO GRAB PLIST          @Y17XAUU 42850000
         USING GRABMAP,R1                                      @Y17XAUU 42851000
         L     R5,$GRABCDS        BUFFER ADDRESS               @Y17XAUU 42852000
         SLR   R3,R3              CLEAR REG                    @Y17XAUU 42853000
         IC    R3,$GRABCNT        GET BUFFER SIZE              @Y17XAUU 42854000
         LA    R15,0              SET GOOD RETURN CODE         @Y17XAUU 42855000
         LA    R8,SNALCDS         GET FIXED LINE CDS FORMAT    @Y17XAUU 42856000
         BCTR  R3,0               ADJUST BYTE COUNT            @Y17XAUU 42857000
         EX    R3,SNACDS          MOVE CDS TO BUFFER           @Y17XAUU 42858000
         MVC   TCDSNAM(D8),CDSLINE  SET SYMBOLIC NAME          @Y17XAUU 42859000
         DROP  R1                                              @Y17XAUU 42860000
         SLR   R1,R1              CLEAR REG                    @Y17XAUU 42861000
         ICM   R1,3,TOTSCUCB      GET UCB ADDRESS              @Y17XAUU 42862000
         USING UCB,R1             SET UCB ADDRESSABILITY       @Y17XAUU 42863000
         MVC   TCDSUCB+D2(D2),UCBCHA SET UCB BINARY CUU ADDR   @Y17XAUU 42864000
         DROP  R1                                              @Y17XAUU 42865000
         MVC   TCDSDAF(D2),TOTSRSID SET NETWORK ADDR IN CDS    @Y17XAUU 42866000
         B     NODELETE           EXIT                         @Y17XAUU 42867000
         SPACE                                                          42868000
CDSPRES  DS    0H                 BOUNDARY ALLIGNMENT          @Y17XAUU 42869000
         LA    R15,RETDAF         SET RETURN CODE FOR CDS NOT  @Y17XAUU 42870000
*                                 FOUND AND NETWORK ADDR RETURN@Y17XAUU 42871000
         SLR   R0,R0              CLEAR REG                    @Y17XAUU 42872000
         ICM   R0,3,TOTSRSID      SET UP NETWORK ADDRESS       @Y17XAUU 42873000
         B     NODELETE           EXIT                                  42874000
         SPACE                                                          42875000
         DROP  R8                                              @Y17XAUU 42876000
GC040    DS    0H                 BOUNDARY ALLIGNMENT          @Y17XAUU 42877000
         LOAD  EPLOC=CDSLINE           BRING MEMBER IN CORE      S99528 42900000
         LR    R6,R0                   EP OF CDS                 S99528 43000000
         L     R5,GRABPARM             GET PARM POINTER          S99528 43100000
         L     R7,FOUR(R5)             GET CDSMOVE ADDRESS       S99528 43200000
         L     R5,EIGHT(R5)            POINT TO FLAGS            S99528 43300000
         N     R5,CDSNO                CLEAR ALL BUT NOS BYTES   S99528 43400000
         LTR   R7,R7                   CDS ADDRESS GIVEN         S99528 43500000
         BZ    DDMOVE                  NO BR                     S99528 43600000
         LTR   R5,R5                    NUMBER GIVEN           @XA06343 43700000
         BP    CDSMV                   YES BR                    S99528 43800000
         LA    R5,TEN                  ASSUME DEFULT             S99528 43900000
CDSMV    EX    R5,CDSMOVE              GO MOVE CDS               S99528 44000000
DDMOVE   EQU   *                       FIND DD ENTRY             S99528 44100000
         DELETE EPLOC=CDSLINE          REMOVE CDS                S22024 44200000
NODELETE DS    0H                                              @Y17XAUU 44250000
         ICM   R9,ADRMSK,TOTSCLCB      GET LCB ADDRESS         @Y17XAUU 44300000
         LTR   R9,R9                   IS THTER ONE              S22024 44400000
         BNZ   GOOD00                  YES BRANCH                S22024 44500000
         SR    R9,R9                   CLEAR                   @G36XRUV 44550010
         ICM   R9,HALF,TOTSCUCB        GET UCB ADDRESS         @G36XRUV 44600010
         USING UCB,R9                                            S99528 44700000
         TM    UCBTBYT3,UCB3DISP       GRAGHIC                   S99528 44800000
         BO    GRAPHIC                 YES BRANCH                S99528 44900000
         NI    EXCPDCB+50,X'DF'        NO DEV DEPENDENT          S99528 45000000
         DROP  R9                                                S99528 45100000
GRAPHIC  LA    R9,CVTPTR               GET CVT ADDRESS           S99528 45200000
         L     R9,0(R9)                CVT ADDRESS               S99528 45300000
         L     R9,0(R9)                TCBPOINTERS ADDRESS       S99528 45400000
         L     R9,4(R9)                CURRENT TCB ADDRESS       S99528 45500000
         L     R9,12(R9)               TIOT POINTER              S99528 45600000
         USING TIOT,R9                                           S99528 45700000
         LA    R9,TIOENTRY             POINT TO FIRST ENTRY      S99528 45800000
         DROP  R9                                                S99528 45900000
         USING TIOENTRY,R9                                       S99528 46000000
         EJECT                                                          46050000
GETLENGT SR    R3,R3                   CLEAR REG                 S99528 46100000
         IC    R3,TIOELNGH             DD ENTRY LENGTH           S99528 46200000
         LTR   R3,R3                   ANY LENGTH                S99528 46300000
         BZ    NOTFOUND                NO BRANCH                 S99528 46400000
         LA    R5,POOLSTAR-TIOESTTB    GET LENGTH OF DEVICE ENTRYS99528 46500000
         DROP  R9                                                S99528 46600000
         LR    R6,R3                   SAVE LENGTH               S99528 46700000
         SR    R3,R5                   DD LENGTH -4              S99528 46800000
         AR    R3,R9                   DEVICE                    S99528 46900000
         USING TIOESTTB,R3                                       S99528 47000000
         CLC   TIOEFSRT+1(2),TOTSCUCB  COMPARE UCB ADDRESSES FOR S99528 47100000
         DROP  R3                                                S99528 47200000
         BE    UCBFOUND                BRANCH WHEN FOUND         S99528 47300000
         AR    R9,R6                   BUMP TO NEXT DD ENTRY     S99528 47400000
         B     GETLENGT                BRANCH                    S99528 47500000
NOTFOUND EQU   *                                                 S99528 47600000
          LA    R15,EIGHT              RETURN CODE               S99528 47700000
         B     GRB070                  RETURN                    S99528 47800000
GOOD00   EQU   *                       ZERO                      S22024 47900000
         SR    R15,R15                 RETURN                    S22024 48000000
         B     GRB070                  CODE                      S22024 48100000
UCBFOUND EQU   *                                                 S99528 48200000
         USING TIOENTRY,R9             TIOT ENTRY BASE                  48300000
COMPAREN EQU   *                                                 S99528 48400000
         CLI   TIOEDDNM,X'40'          IS NAME FIELD BLANK?      S99528 48500000
         BNE   MOVEIN                  NO, GO MOVE DDNAME        S99528 48600000
         SR    R9,R6                   SET ENTRY TO PRECEDING ONES99528 48700000
         B     COMPAREN                GO LOOK FOR NAME          S99528 48800000
MOVEIN   EQU   *                                                 S99528 48900000
         MVC   EXCPDCB+40(8),TIOEDDNM  MOVE DDNMME TO DCB        S99528 49000000
         DROP  R9                                                       49100000
         LA    R6,EXCPDCB         GET DCB ADDRESS              @Y17XAUU 49200000
         RDJFCB (R6)                                           @Y17XAUU 49300000
         MVI   JFCBAA+53,X'00'         CLEAR                     S99528 49400000
         MVC   JFCBAA+54(12),JFCBAA+53 UNUSED                    S99528 49500000
         MVI   JFCBAA+67,X'00'         SECTION                   S99528 49600000
         MVC   JFCBAA+68(12),JFCBAA+67 OF                        S99528 49700000
         MVI   JFCBAA+88,X'00'         THE                       S99528 49800000
         MVC   JFCBAA+89(29),JFCBAA+88 JFCB                      S99528 49900000
         MVI   JFCBAA+148,X'00'        FOR                       S99528 50000000
         MVC   JFCBAA+149(25),JFCBAA+148 TOTE                    S99528 50100000
         MVI   JFCBAA+52,X'08'         PREVENT                   S99528 50200000
         MVI   JFCBAA+66,X'02'         REVERSE MERGE             S99528 50300000
         MVC   TOTSCDCB(72),EXCPDCB    MOVE DCB TO OLTCB         S99528 50400000
         LA    R1,TOTSCDCB             DCB ADDRESS               S99528 50500000
         ST    R1,OPENAREA             STORE IN P LIST           S99528 50600000
         MVI   OPENAREA,X'8F'          OPTION OPEN               S99528 50700000
         LA    R1,OPENAREA             ADDRESS OF P LIST         S99528 50800000
         OPEN  MF=(E,(1)),TYPE=J       SECONAARY DCB             S99528 50900000
         EJECT                                                          50950000
         TM    TOTSCDCB+48,X'10'       SUCCESSFUL OPEN?          S99528 51000000
         BNO   MOVEIN1                 BRANCH IF ERROR ON OPEN   S99528 51100000
         L     R3,TOTSCDEB             GET ADDRESS OF DEB        S99528 51200000
         LA    R3,D34(R3)              GET ADDRESS OF UCB IN DEB S99528 51300000
         ST    R3,TOT102A              STORE ADDRESS INTO SVC    S99528 51400000
*                                        102 PARAMETER LIST      S99528 51500000
         LA    R1,TOT102               LOAD ADDRESS OF PARM LIST S99528 51600000
*                                        INTO REG 1              S99528 51700000
         AQCTL                         ISSUE DATA MOVE SVC       S99528 51800000
         B     GRB070                  GOOD EXIT                 S99528 51900000
MOVEIN1  EQU   *                                                 S99528 52000000
         LA    R15,EIGHT               SET BAD RETURN CODE       S99528 52100000
         SPACE                                                          52200000
GRB070   EQU   *                       EXIT                      S99528 52300000
         STC   R15,TOTRTCOD            RETURN CODE TO OLTCB      S99528 52400000
         TM    $OLTFLGS,$TRACE         TRACE OPTION              S99528 52500000
         BO    M2                      YES BR                    S99528 52600000
         TM    $RETMASK,X'FF'          RETURN OPTION             S99528 52700000
         BZ    RETURN                  NO BR                     S99528 52800000
         CLI   TOTRTCOD,0              RETURN CODE ZERO          S99528 52900000
         BNE   M2                      NO BR                     S99528 53000000
RETURN   L     R13,4(R13)              CALLERS SAVE ADDRESS      S99528 53100000
         L     R14,12(R13)        RESTORE R14.                          53200000
         LM    R0,R12,20(R13)     RESTORE R0-R12.                       53300000
         BR    R14                RETURN TO CALLER.                     53400000
M2       EQU   *                       GO TO IEDQWM2             S99528 53500000
         L     R13,4(R13)              RESTORE R13               S99528 53600000
         L     R14,12(R13)             RESTORE R14               S99528 53700000
         USING RESPL,R15               SET RESPL ADDRESSABILITY@Y17XAUU 53800000
         L     R15,TOTRESPL            GET RESPL ADDRESS       @Y17XAUU 53900000
         L     R15,RESPLM2             GET TRACE ROUTINE ADDR  @Y17XAUU 54000000
         LM    R2,R12,DISREG2(R13)     RESTORE REGISTERS       @Y17XAUU 54100000
         BR    R15                     EXIT TO IEDQWM2         @Y17XAUU 54200000
         DROP  R15                                             @Y17XAUU 54300000
         EJECT                                                          54350000
NAMEBULD EQU   *                                                 S99528 54400000
         MVI   CDSLINE,C' '            BLANK OUT                 S99528 54500000
         MVC   CDSLINE+1(7),CDSLINE    EIGHT CHARACTER NAME      S99528 54600000
         L     R12,TRMTNT              GET SAVED TNT ADDRESS   @Y17XAUU 54700000
         L     R9,CDSLINE              GET ADDRESS OF NAME FIELD S99528 54800000
         SR    R3,R3                   CLEAR REG                 S99528 54900000
         IC    R3,TOTTTBEL             GET NAME LRNGTH           S99528 55000000
         BCTR  R3,0                    DECREMENT COUNT FOR EX    S99528 55100000
         EX    R3,NAMEMOVE             GO MOVE NAME              S99528 55200000
         B     LOADNAME                GO LOAD NAME            @Y17XAUU 55230000
         SPACE 2                                                        55260000
NAMEMOVE MVC   0(0,R9),0(R12)          MOVE NAME FROM TERMINAL TAS99528 55400000
         EJECT                                                          55450000
***   THIS CODE FINDS UCB ADDRESS IF GRAB IS FOR A TERMINAL      S99528 55500000
UCBFIND  EQU   *                                                 S99528 55600000
         ST    R7,TRMTNT               SAVE TNT ADDRESS        @Y17XAUU 55700000
         SR    R6,R6                   CLEAR REG                 S99528 55800000
         IC    R6,TOTTTBEL             GET TERMINAL NAME LENGTH  S99528 55900000
         AR    R5,R6                   GET TNT ADDRESS           S99528 56000000
         MVC   TNTENTRY+D1(D3),D0(R6)  ALLINE ADDRESS          @Y17XAUU 56030000
         L     R7,TNTENTRY             GET TTE ADDRESS         @Y17XAUU 56060000
         USING IEDQTRM,R7                                        S99528 56300000
         L     R7,TRMDESTQ-1           GET QCB ADDRESS           S99528 56400000
         DROP  R7                                                S99528 56500000
         USING IEDQQCB,R7                                        S99528 56600000
         SR    R3,R3                   CLEAR REG                 S99528 56700000
         IC    R3,QCBRELLN             GET RLN                   S99528 56800000
         SLL   R3,2                    MULT BY 4                 S99528 56900000
         L     R7,QCBDCBAD-1           GET DCB ADDRESS           S99528 57000000
         DROP  R7                                                S99528 57100000
         USING IHADCB,R7                                         S99528 57200000
         L     R7,DCBDEBAD             GET DBE ADDRESS           S99528 57300000
         DROP  R7                                                S99528 57400000
         USING DEBNMSUB,R7                                       S99528 57500000
         SR    R15,R15                 CLEAR REG                 S99528 57600000
         IC    R15,DEBNMEXT            GET NUMBER OF EXTENTS     S99528 57700000
         SLL   R15,2                   MULT BY 4                 S99528 57800000
         L     R7,DEBUCBAD-4(R3)       GET UCB ADDRESS           S99528 57900000
         B     TNTRET                  BRANCH                    S99528 58000000
         EJECT                                                          58100000
************************************************************** @Y17XAUU 58200000
*        ROUTINE TO FIND NCP TTE ADDRESS. INPUT: REG 1 =     * @Y17XAUU 58300000
*        TERMINAL TTE ADDRESS. OUTPUT: REG 1 = NCP TTE PRFIX * @Y17XAUU 58400000
*        ADDRESS. RETURN TO CALLER VIA REG 14.                 @Y17XAUU 58500000
************************************************************** @Y17XAUU 58600000
NCPTTE   EQU   *                                               @Y17XAUU 58700000
         ST    R14,SAVERET             SAVE RETURN ADDRESS     @Y17XAUU 58800000
         LA    R8,TRMPRFSZ             GET TTE PREFIX SIZE     @Y17XAUU 58900000
         SLR   R1,R8                   POINT TO TTE PREFIX     @Y17XAUU 59000000
         USING IEDNTRM,R1              SET TTE ADDRESSABILITY  @Y17XAUU 59100000
NCPLOOP  EQU   *                                               @Y17XAUU 59200000
         LH    R1,TRMCOHRT             GET COHORT POINTER      @Y17XAUU 59300000
         L     R15,TOTAVTPT            GET AVT ADDRESS         @Y17XAUU 59400000
         USING IEDQAVTD,R15            SET AVT ADDRESSABILITY  @Y17XAUU 59500000
         L     R15,AVTRNMPT            TTCIN TO TTE CONVERSION @Y17XAUU 59600000
*                                      ROUTINE ADDRESS         @Y17XAUU 59700000
         DROP  R15                                             @Y17XAUU 59800000
         BALR  R14,R15                 FIND TTE ADDRESS        @Y17XAUU 59900000
         SLR   R1,R8                   POINT TO TTE PREFIX     @Y17XAUU 60000000
         CLI   TRMTYPE,TRMLNCP         NCP ENTRY               @Y17XAUU 60100000
         BNE   NCPLOOP                 NO - CHECK NEXT ENTRY   @Y17XAUU 60200000
         L     R14,SAVERET             RESTORE RETURN ADDRESS  @Y17XAUU 60300000
         BR    R14                     RETURN TO CALLER        @Y17XAUU 60400000
         DROP  R1                                              @Y17XAUU 60500000
         EJECT                                                          60502000
***************************************************************@Y17XAUU 60504000
*        ROUTINE TO GO TO IEDQWB2 TO CALCULATE THE AMOUNT OF   @Y17XAUU 60506000
*        OF CORE NEEDED TO BUILD DUMMY ENTRIES FOR A SPECIFIED @Y17XAUU 60508000
*        REMOTE TERMINAL. CONTROL IS PASS TO IEDQWB TO ATTAIN  @Y17XAUU 60510000
*        THE ACTUAL CORE.  CONTROL IS THEN RETURNED TO IEDQWB2 @Y17XAUU 60512000
*        TO COPY THE ENTRIES.                                  @Y17XAUU 60514000
***************************************************************@Y17XAUU 60516000
DUMMYTNT EQU   *                                               @Y17XAUU 60518000
         STM   R7,R11,TRMSAVE2    SAVE REGISTERS               @Y17XAUU 60520000
         SLR   R15,R15            CLEAR RETURN CODE REG        @Y17XAUU 60522000
         L     R8,TNTENTRY        GET TTE ADDRESS              @Y17XAUU 60524000
         LA    R7,TRMPRFSZ        GET TTE PREFIX SIZE          @Y17XAUU 60526000
         SLR   R8,R7              POINT TO TTE PREFIX          @Y17XAUU 60528000
         USING IEDNTRM,R8         SET TTE ADDRESSABILITY       @Y17XAUU 60530000
         CLI   TRMTYPE,TRMLUNT    LU ENTRY                     @Y17XAUU 60532000
         BNE   DUMOUT             NO - RETURN TO CALLER        @Y17XAUU 60534000
         MVI   TRMRQFLG,SCREQ     SHOW SEC TD REQUEST          @Y17XAUU 60536000
         LA    R12,KTRM           PASS PARAMETERS              @Y17XAUU 60538000
         XC    TRMFLG01(D1),TRMFLG01 CLEAR CONTROL FLAG        @Y17XAUU 60540000
*                                                              @Y17XAUU 60542000
         LINK  EP=IEDQWB2         CALCULATE CORE               @Y17XAUU 60544000
         LTR   R15,R15            REQUEST SUCCESSFUL           @Y17XAUU 60546000
         BNZ   DUMOUT             NO - ERROR                   @Y17XAUU 60548000
*                                                              @Y17XAUU 60550000
         CLI   TRMRQFLG,ALRDY     COUNTERFEITING COMPLETE      @Y17XAUU 60552000
         BNE   DUM08              NO CONTINUE PROCESSING       @Y17XAUU 60554000
         NI    TOTSCFLG,TOTSCTAS  RESET ASSIGNED FLAG          @Y17XAUU 60556000
         B     DUMOUT             RETURN TO CALLER             @Y17XAUU 60558000
DUM08    EQU   *                                               @Y17XAUU 60560000
         L     R10,TOTRESPL       ADDR OF TOTE RES. CTL BLK    @Y17XAUU 60562000
         USING RESPL,R10                                       @Y17XAUU 60564000
         XC    TOTOTECB(D4),TOTOTECB CLEAR ECB                 @Y17XAUU 60566000
         POST  RESTECB1           POST REQUEST TO IEDQWB       @Y17XAUU 60568000
         WAIT  ECB=TOTOTECB       WAIT FOR REQUEST TO BE HONORE@Y17XAUU 60570000
         DROP  R10                                             @Y17XAUU 60572000
*                                                              @Y17XAUU 60574000
         CLI   TOTWKSPC,XFF       REQUEST SUCCESSFUL           @Y17XAUU 60576000
         BE    DUMOUT             NO - ERROR                   @Y17XAUU 60578000
*                                                              @Y17XAUU 60580000
         OI    TRMFLG01,TRMQWB3   SHOW SECOND PASS             @Y17XAUU 60582000
         LA    R12,KTRM           PASS PARAMETERS              @Y17XAUU 60584000
         LINK  EP=IEDQWB2         COPY ENTRIES                 @Y17XAUU 60586000
*                                                              @Y17XAUU 60588000
         OI    TOTFLG04,X'04' .TOTSCCTF ********************** @YM08057 60589000
DUMOUT   EQU   *                                               @Y17XAUU 60590000
         LM    R7,R11,TRMSAVE2    RESTORE REGISTERS            @Y17XAUU 60592000
         BR    R9                 RETURN                       @Y17XAUU 60594000
         EJECT                                                          60600000
*                                                                       60700000
*        $LETGO ENTRY                                                   60800000
*                                                                       60900000
LET002   EQU   *                                                        61000000
         L     R5,4(R1)                GET UNIT                  S99528 61100000
         L     R5,0(R5)                ADDRESS FROM CDS          S99528 61200000
         STH   R5,UCBNAMES             SAVE UNIT NAME            S99528 61300000
         L     R9,CVTPTR               GET CVT ADDRESS           S99528 61400000
         USING CVT,R9                                            S99528 61500000
         L     R11,CVTILK2             GET ADDR OF UCB ADDR TABLES99528 61600000
*                                      UCB LOOK UP TABLE         S99528 61700000
         DROP  R9                                                S99528 61800000
DISP083  EQU   *                                                 S99528 61900000
         LH    R10,0(R11)              GET FIRST UCB ADDRESS     S99528 62000000
         LTR   R10,R10                 TEST ENTRY                S99528 62100000
         BZ    DISP085                 ZERO ENTRY,GET NEXT       S99528 62300000
         BP    GOODUCB                 NO HI ORDER BITS ON     @G36XRUV 62320010
         N     R10,CLRHALF             CLEAR HIGH ORDER        @G36XRUV 62340010
         CLM   R10,HALF,TABEND         END OF TABLE ?          @G36XRUV 62360010
         BE    ERROR                   YES - END OF TABLE      @G36XRUV 62380010
         USING UCB,R10                                           S99528 62400000
GOODUCB  DS    0H                                              @G36XRUV 62450010
         CLC   UCBCHA(2),UCBNAMES      CORRECT ENTRY?            S99528 62500000
         BE    FOUND                   YES BRANCH                S99528 62600000
DISP085  EQU   *                                                 S99528 62700000
         LA    R11,2(R11)              GET NEXT ENTRY            S99528 62800000
         B     DISP083                 BR -LOOP                  S99528 62900000
FOUND    L     R9,TOTTDEND             GET END OF TABLE          S99528 63000000
         L     R11,TOTTDTBL            GET START OF DEVICE TABLE S99528 63100000
LOOP     DS    0H                                              @G36XRUV 63130010
         SR    R12,R12                 CLEAR                   @G36XRUV 63160010
         ICM   R12,HALF,2(R11)         GET UCB ADDRESS         @G36XRUV 63200010
         CR    R12,R10                 UCB ADDRESSESTHESAME      S99528 63300000
         BE    FOUND2                  YES BRANCH                S99528 63400000
         LA    R11,4(R11)              POINT TO NEXT ENTRY       S99528 63500000
         CR    R9,R11                  ENDOFLIST                 S99528 63600000
         BE    ERROR                   YESBRANCH                 S99528 63700000
         B     LOOP                    BRANCH                    S99528 63800000
FOUND2   EQU   *                                                 S99528 63900000
         TM    0(R11),TOTTDGRB         BEEN PREVIOUSLY GRABED    S99528 64000000
         BO    LET008                  YES BRANCH                S99528 64100000
         LA    R15,X'0C'               SET RETURN CODE           S99528 64200000
         B     GRB070                  RETURN                    S99528 64300000
         EJECT                                                          64350000
LET008   EQU   *                                                 S99528 64400000
         SR    R9,R9                   CLEAR                   @G36XRUV 64450010
         ICM   R9,HALF,TOTSCUCB        SECONDARY UCB ADDRESS   @G36XRUV 64500010
         USING UCB,R9                  UCB                       S99528 64600000
         MVC   RNAME(THREE),UCBNAME    NAME TO DEQ               S99528 64700000
         DROP  R9                      UCB                       S99528 64800000
         DEQ   ,MF=(E,DEQLIST)         DEQ UCB NAME              S99528 64900000
         LA    R1,TOTSCDCB             GET SECONDARY DCB         S99528 65000000
         ST    R1,OPENAREA             STORE IN P LIST           S99528 65100000
         MVI   OPENAREA,X'B0'          OPTION CLOSE              S99528 65200000
         LA    R1,OPENAREA             ADDRESS OF P LIST         S99528 65300000
         CLOSE MF=(E,(1))              CLOSE SECONDARY DCB       S99528 65400000
*                                                                       65500000
LET010   EQU   *                                                        65600000
         SR    R15,R15            SET RETURN CODE TO 0                  65700000
         LR    R8,R11                  SAVE LET GO ENTRY ADDR    S99528 65800000
         LA    R6,TOTTDEND             GET END OF TABLE ADDRESS  S99528 65900000
         LA    R11,4(R11)              SET UP TO                 S99528 66000000
         SR    R6,R11                  DETERMINE                 S99528 66100000
         BCTR  R6,ZERO                 DECREMENT FOR MOVE        S99528 66200000
         EX    R6,MOVE                 GO MOVE                   S99528 66300000
          XC    TOTLETGO(4),TOTLETGO   CLEAR LAST ENTRY          S99528 66400000
         L     R7,TOTGRABP             GET GRAB POINTER          S99528 66500000
         LA    R9,FOUR                 BACK UP POINTER           S99528 66600000
         SR    R7,R9                   BY FOUR                   S99528 66700000
         ST    R7,TOTGRABP             SAVE NEW ADDRESS          S99528 66800000
         B     GRB070             EXIT TO RETURN                        66900000
ERROR    LA    R15,X'0C'               SET RETURN CODE           S99528 67000000
         B     GRB070                  BRANCH                    S99528 67100000
         EJECT                                                          67150000
         DS    0F                                                       67300000
CLRHALF  DS    0F                      CLEAR HALF WORD         @G36XRUV 67302010
         DC    X'0000FFFF'                                     @G36XRUV 67304010
TABEND   DC    X'FFFF'                 END OF UCB TAB COMPARAND@G36XRUV 67306010
QLDLLIST DS    0F                 BLDL P-LIST                  @Y17XAUU 67310000
         DC    XL2'0001'          NUMBER OF LIST ENTRIES       @Y17XAUU 67320000
         DC    XL2'003A'          LENGTH OF EACH ENTRY         @Y17XAUU 67330000
         DC    8XL1'40'           MODULE ID                    @Y17XAUU 67340000
         DC    XL16'0'            ADDITIONAL DIRECTORY INFO    @Y17XAUU 67350000
QORENEED DC    XL3'0'             MAIN STORAGE NEEDED          @Y17XAUU 67360000
         DC    XL31'0'            ADDITIONAL DIRECTORY INFO    @Y17XAUU 67370000
WORKA    DC    X'000F'            USED FOR CONVERSION          @Y17XAUU 67380000
GRB080   DC    X'00F00000'        MASK FOR ISOLATING CNTL UNIT BITS.    67400000
GRB081   DC    X'000F0000'        MASK FOR ISOLATING DEVICE BITS.       67500000
MOVE     MVC   0(0,R8),0(R11)          MOVE REST OF TABLE UP     S99528 67600000
SNACDS   MVC   ZERO(ZERO,R5),ZERO(R8) CDS TO OLT               @Y17XAUU 67610000
SNATCDS  DC    XL4'0',XL2'0',XL4'4420180A',XL2'0',CL8' ',XL4'0'         67620000
*                                       BASIC 3767/3770 CDS    @Y17XAUU 67630000
SNALCDS  DC    XL4'0',XL2'0',XL4'4420240A',XL2'0',CL8' ',X'10',XL3'0',X*67640000
               L4'0',X'E0',XL2'0',XL5'0'                                67650000
*                                 BASIC 3705 LINE CDS          @Y17XAUU 67660000
PATCH    DS    CL50               MAINTENANCE AREA.                     67700000
         SPACE                                                          67800000
DCH      EQU   X'80'              DIFFERENT CHANNEL.                    67900000
CH       EQU   X'40'              SAME CHANNEL.                         68000000
DCU      EQU   X'20'              DIFFERENT CONTROL UNIT.               68100000
CU       EQU   X'10'              SAME CONTROL UNIT.                    68200000
DDV      EQU   X'08'              DIFFERENT DEVICE.                     68300000
DV       EQU   X'04'              SAME DEVICE.                          68400000
CLOMIT   EQU   X'02'              CLASS OMITTED.                        68500000
TYOMIT   EQU   X'01'              TYPE OMITTED.                         68600000
         EJECT                                                          68700000
START    DS    0F                 ***** START OF MODIFIABLE    @Y17XAUU 68800000
* DATA AREA -- DO NOT INSERT RECORD BETWEEN ***                @Y17XAUU 68900000
         DC    X'07'                   EXIT ADDR LIST          @Y17XAUU 69000000
         DC    AL3(0)                  JFCB ADDRESS            @Y17XAUU 69100000
         DC    X'80'                   END                       S99528 69200000
         DC    AL3(0)                  FILLER                    S99528 69300000
*                                                                S99528 69400000
**************************************************************** S99528 69500000
*        PARAMETER LIST FOR DATA MOVE                          * S99528 69600000
**************************************************************** S99528 69700000
         DS    0F                      ALIGNMENT               @Y17XAUU 69800000
         DC    X'08'                   FLAG FOR DATA MOVE        S99528 69900000
         DC    AL3(0)                  DATA ADDRESS            @Y17XAUU 70000000
         DC    X'00'                   FLAGS                   @Y17XAUU 70100000
         DC    AL3(0)                  TARGET ADDRESS            S99528 70200000
         DC    X'80'                   LAST WORD FLAG            S99528 70300000
         DC    AL3(0)                  ADDRESS OF LENGTH FIELD @Y17XAUU 70400000
         DC    H'2'                    LENGTH OF UCB ADDRESS MO@Y17XAUU 70500000
*                                                                S99528 70600000
         DC    H'0'                    ADDRESS OF UCB          @Y17XAUU 70700000
         DCB   DDNAME=DD274E,DSORG=PS,EXLST=*,MACRF=(E),       @Y17XAUUC70800000
               SIOA=AO,CENDA=AP,XENDA=AP                         S99528 70900000
         SPACE                                                          71000000
         DS    0F                                              @Y17XAUU 71100000
         DC    X'A0'                   FLAG BYTE               @Y17XAUU 71200000
         DC    XL3'0'             DEB ADDR                              71300000
         DC    F'0'                    PURGE USE                 S99528 71400000
         DS    0F                 ADDR OF IOB FOR PURGE        @Y17XAUU 71500000
         DC    X'01'                   NUMBER OF BEDS          @Y17XAUU 71600000
         DC    XL3'0'             IOB ADDR                              71700000
         DEQ   (QQAME,RRAME,8,STEP),RET=HAVE,MF=L DEQ PLIST    @Y17XAUU 71800000
QQAME    DC    CL8'SYSZTOTE'           QNAME ADDRESS           @Y17XAUU 71900000
RRAME    DC    CL8' '                  RNAME ADDRESS           @Y17XAUU 72000000
         DC    CL8'G0000000'           BUILD CDS NAME          @Y17XAUU 72100000
         DC    AL4(0)                  PARM SAVE AREA          @Y17XAUU 72200000
END      DS    0C                 *** END OF MODIFIABLE DATA   @Y17XAUU 72300000
***                               AREA TO BE MOVE***           @Y17XAUU 72400000
         EJECT                                                          72500000
LCBLENGT DC    X'0090'                 LCB LENGTH                S99528 72600000
CDSMOVE  MVC   ZERO(ZERO,R7),ZERO(R6)  CDS TO OLT                S99528 72700000
CDSNO    DC    X'000000FF'             MASK # CDS BYTES          S99528 72800000
CLASS    DC    X'00'                   CLASS BYTE                S99528 72900000
CLAS02   DC    X'01'                   2702                      S99528 73000000
CLAS01   DC    X'02'                   2701                      S99528 73100000
CLASS77  DC    X'00'                   7770                      S99528 73200000
NAMEFLD  DC    CL8'G0000000'           INIT NAME FIELD         @Y17XAUU 73300000
GRABREQ  DC    CL2'21'                 GRAB FUNCTION REQ       @Y17XAUU 73400000
         EJECT                                                          73500000
         OLTCB                         TOTE CONTROL BLOCK        S22024 73600000
JFCBADDR DC    X'07'                   EXIT ADDR LIST          @Y17XAUU 73700000
         DC    AL3(0)                  JFCB ADDRESS            @Y17XAUU 73800000
         DC    X'80'                   END                     @Y17XAUU 73900000
         DC    AL3(0)                  FILLER                  @Y17XAUU 74000000
*                                                              @Y17XAUU 74100000
****************************************************           @Y17XAUU 74200000
*        PARAMETER LIST FOR DATA MOVE               *          @Y17XAUU 74300000
****************************************************           @Y17XAUU 74400000
TOT102   DS    0F                      ALIGNMENT               @Y17XAUU 74500000
         DC    X'08'                   FLAG FOR DATA MOVE      @Y17XAUU 74600000
         DC    AL3(0)                  DATA ADDRESS            @Y17XAUU 74700000
TOT102A  DC    X'00'                   FLAGS                   @Y17XAUU 74800000
         DC    AL3(0)                  TARGET ADDRESS          @Y17XAUU 74900000
         DC    X'80'                   LAST WORD FLAG          @Y17XAUU 75000000
         DC    AL3(0)                  ADDRESS OF LENGTH FIELD @Y17XAUU 75100000
TOT102LN DC    H'2'                    LEN OF UCB ADDRESS      @Y17XAUU 75200000
*                                                              @Y17XAUU 75300000
ADDOFUCB DC    H'0'                    ADDRESS OF UCB          @Y17XAUU 75400000
EXCPDCB  DCB   DDNAME=DD274E,DSORG=PS,EXLST=JFCBADDR,MACRF=(E),        C75500000
               SIOA=AO,CENDA=AP,XENDA=AP                       @Y17XAUU 75600000
QVPRGLST DS    0F                                              @Y17XAUU 75700000
QVPURFLG DC    X'A0'                   FLAG BYTE               @Y17XAUU 75800000
         DC    XL3'0'             DEB ADDR                     @Y17XAUU 75900000
         DC    F'0'                    PURGE USE               @Y17XAUU 76000000
QVPRGIOB DS    0F                 ADDR OF IOB FOR PURGE        @Y17XAUU 76100000
QVPDEBNO DC    X'01'                   NUMBER OF BEDS          @Y17XAUU 76200000
         DC    XL3'0'             IOB ADDR                     @Y17XAUU 76300000
DEQLIST  DEQ   (QNAME,RNAME,8,STEP),RET=HAVE,MF=L DEQ PLIST    @Y17XAUU 76400000
QNAME    DC    CL8'SYSZTOTE'           QNAME ADDRESS           @Y17XAUU 76500000
RNAME    DC    CL8' '                  RNAME ADDRESS           @Y17XAUU 76600000
CDSLINE  DC    CL8'G0000000'           BUILD CDS NAME          @Y17XAUU 76700000
GRABPARM DC    AL4(0)                  PARM SAVE AREA          @Y17XAUU 76800000
OPENAREA DS    F                  OPEN CLOSE PARM              @Y17XAUU 76900000
TNTPOINT DS    F                  TNT ADDRESS                  @Y17XAUU 77100000
JFCBAA   DS    44F                JFCB                         @Y17XAUU 77200000
SAVERET  DS    F                  SAVE AREA                    @Y17XAUU 77300000
NAMESAVE DS    CL8                SECONDARY TD NAME            @Y17XAUU 77400000
BLDLLIST DS    0F                 BLDL P-LIST                  @Y17XAUU 77402000
         DC    XL2'0001'          NUMBER OF LIST ENTRIES       @Y17XAUU 77404000
         DC    XL2'003A'          LENGTH OF EACH ENTRY         @Y17XAUU 77406000
BLDLNAM  DC    8XL1'40'           MODULE ID                    @Y17XAUU 77408000
         DC    XL16'0'            ADDITIONAL DIRECTORY INFO    @Y17XAUU 77410000
CORENEED DC    XL3'0'             MAIN STORAGE NEEDED          @Y17XAUU 77412000
         DC    XL31'0'            ADDITIONAL DIRECTORY INFO    @Y17XAUU 77414000
BLDLEND  DS    0C                 END OF BLDL PLIST            @Y17XAUU 77416000
KTRM     DS    0F                 ***DO NOT INSERT BETWEEN *** @Y17XAUU 77418000
TERNMTAB DS    A                  TERMNAME TABLE ADDRESS       @Y17XAUU 77420000
TNTENTRY DS    A                  TERMNAME ENTRY ADDRESS       @Y17XAUU 77422000
TRMQCB   DS    A                  CT/AP QCB ADDRESS            @Y17XAUU 77424000
TRMTNT   DS    A                  CT/AP TNT ADDRESS            @Y17XAUU 77426000
TRMSAVE1 DS    3F                 REGISTERS SAVE AREA          @Y17XAUU 77428000
TRMSAVE2 DS    5F                 REGISTERS SAVE AREA          @Y17XAUU 77430000
TRMSAV1  DS    3F                 REGISTERS SAVE AREA          @Y17XAUU 77432000
REGSAVE  DS    F                  WORK AREA                    @Y17XAUU 77434000
F32      DC    F'32'              VALUE OF 32                  @Y17XAUU 77436000
KPQCB    DS    A                  TRUE P-QCB ADDRESS           @Y17XAUU 77436200
KMQCB    DS    A                  DUMMY M-QCB ADDRESS          @Y17XAUU 77436400
CONCTTE  DS    A                  TRUE CONC TERM TTE ADDRESS   @Y17XAUU 77436600
KDRQ     DS    A                  TRUE DRQ ADDRESS             @Y17XAUU 77436800
KPQCBSZ  DS    H                  P-QCB SIZE                   @Y17XAUU 77437000
KMQCBSZ  DS    H                  M-QCB SIZE                   @Y17XAUU 77437200
KDRQSZ   DS    H                  DRQ SIZE                     @Y17XAUU 77437400
TTETSZ   DS    CL1                CONC TERM TTE SIZE           @Y17XAUU 77437600
TTECSZ   DS    CL1                CONC TTE SIZE                @Y17XAUU 77437800
TRMRQFLG DS    CL1                DUMMY TNT REQUEST FLAG       @Y17XAUU 77438000
CTREQ    EQU   X'80'              CT REQUEST                   @Y17XAUU 77440000
APREQ    EQU   X'40'              AP REQUEST                   @Y17XAUU 77442000
PRREQ    EQU   X'20'              PRIMARY TD REQUEST           @Y17XAUU 77444000
SCREQ    EQU   X'10'              SECONDARY TD REQUEST         @Y17XAUU 77446000
ALRDY    EQU   X'00'              COUNTERFEIT STORAGE ALREADY  @Y17XAUU 77448000
*                                 EXIST FOR THIS REQUEST       @Y17XAUU 77450000
TRMFLG01 DS    CL1                CONTROL FLAG                 @Y17XAUU 77452000
CONC     EQU   X'80'              TERMINAL ATTACHED TO CONC    @Y17XAUU 77454000
TRMSPAS  EQU   X'40'              PROCESS CONC TTE             @Y17XAUU 77456000
TRMQWB3  EQU   X'20'              SECOND PASS FUNCTION         @Y17XAUU 77458000
TRMRNLU  EQU   X'10'              SNA LU ENTRY                 @Y17XAUU 77460000
TRMDELY  EQU   X'08'              QCB IN TIME DELAY QUEUE      @Y17XAUU 77462000
TRM3705  EQU   X'04'              3705 MODE                    @Y17XAUU 77464000
TRMCTEAP EQU   X'02'              CT EQU AP                    @Y17XAUU 77466000
WRKFLG   DS    CL1                WORK AREA                    @Y17XAUU 77468000
KTRMEND  DS    0C                 END OF KTRM DSECT            @Y17XAUU 77470000
************************************************************** @Y17XAUU 77472000
UCBNAMES DS    H                  UCB ADDRESS                  @Y17XAUU 77500000
         EJECT                                                          77600000
GRABMAP  DSECT                                                   S22024 77700000
         DS    XL1                     CONTROL PROMRAM FLAGS     S22024 77800000
         DS    XL1                     MACRO LEVEL               S22024 77900000
         DS    XL2                     MACRO ID                  S22024 78000000
$GRABCDS DS    A                       CDS INFO AREA             S22024 78100000
$GRABFLG DS    XL1                     FLAGS                     S22024 78200000
$GRABCLS DS    XL1                     CLASS                     S22024 78300000
$GRABTYP DS    XL1                     TYPE                      S22024 78400000
$GRABCNT DS    XL1                     NUMBER OF CDS BYTES       S22024 78500000
         TLGBD                         LGB                       S22024 78600000
         EJECT                                                          78700000
         TDEBD                                                          78800000
DCBDSECT DCBD  DSORG=TX                DCB                       S22024 78900000
TIOT     DSECT                                                   S22024 79000000
         IEFTIOT1                      TIOT                      S99528 79100000
         TAVTD                                                   S99528 79200000
         TTRMD                                                   S99528 79300000
         TQCBD                                                   S99528 79400000
         TLCBD                                                   S99528 79500000
CVT      DSECT                                                   S99528 79600000
         CVT                                                     S99528 79700000
         EJECT                                                          79800000
RESPL    RESPL                                                 @Y17XAUU 79900000
         EJECT                                                          80000000
UCB      DSECT                                                   S99528 80100000
         IEFUCBOB                                                S99528 80200000
         EJECT                                                          80220000
         TDCTD                                                 @Y17XAUU 80240000
         EJECT                                                          80260000
         TTCDSD                                                @Y17XAUU 80280000
         END                                                            80300000
./  ADD  SSI=71430877,NAME=IEDQWAJ
         TITLE 'IEDQWAJ  $CUTEST SERVICE MODULE OF TCAM/TOTE'           00100000
IEDQWAJ  CSECT                                                          00200000
*A000000-999999                                                @Y16X5U0 00250000
*CHANGE ACTIVITY AS FOLLOWS:                                            00300000
*C001000,003000,080000,104000,305000,377000,584000               S21903 00400000
*A001300-001600,003500,005200-005800,211430-211460,220700-220800 S21903 00500000
*A226170,305500,536800                                           S21903 00600000
*D218000,389000-395000                                           S21903 00700000
*C136000-137000                                                  S05331 00730000
*D138000                                                         S05331 00760000
*C496000                                                        SA64769 00780000
*A117500,760000,145000,170100,598000,774000                    @Y17XAUU 00782000
*C146000,598600,619090-619900,649200,649400-649800,674000      @Y17XAUU 00784000
* A257000,630000,752000                                        @G36XRUV 00789010
* C257000                                                      @G36XRUV 00794010
**************************************************************** S99528 00800000
*                                                              * S99528 00900000
* MODULE NAME: IEDQWAJ (TCAM,TOTE)                             @Y17XAUU 01200000
*                                                              * S99528 01300000
* DESCRIPTIVE NAME: TOTE $CUTEST SERVICE MODULE                * S21903 01400000
*                                                              * S21903 01500000
* COPYRIGHT:  'NONE'                                           * S21903 01600000
*                                                              * S21903 01700000
* STATUS:                                                      * S99528 01800000
*    VERSION 10.0                                              @Y17XAUU 01900000
*                                                              * S99528 02000000
* FUNCTIONS:                                                   * S99528 02100000
*    THIS MODULE VERIFIES THAT ALL REQUESTED CHANNEL ADDRESSES * S99528 02200000
*    ARE EITHER OFFLINE OR, IF THEY ARE ALLOCATED TO TCAM, THIS* S99528 02300000
*    MODULE WILL ISSUE THE 'STOPLINE' OPERATOR CONTROL COMMAND * S99528 02400000
*    TO HAVE THEM ASSIGNED TO TOTE.                            * S99528 02500000
*                                                              * S99528 02600000
*     IF THE ADDRESS IS OFFLINE OR ONLINE BUT NOT ALLOCATED IT * S99528 02700000
*    WILL BE MARKED FOR ON LINE TEST ONLY BY TURNING ON THE    * S99528 02800000
*    UCBNALOC BIT.                                             * S99528 02900000
*                                                              * S99528 03000000
*    BEFORE MARKING THE DEVICE ALLOCATED TO TCAM AN 'ENQ' MACRO* S99528 03100000
*    IS ISSUED TO INSURE THAT ANOTHER OLT DOES NOT HAVE CONTROL* S99528 03200000
*    OF THIS PARTICULAR DEVICE.                                * S99528 03300000
*                                                              * S99528 03400000
*    THE STATUS OF THESE UNITS  IS STORED IN A SAVE AREA SO    * S99528 03500000
*    THAT WHEN THE TEST OF THE CONTROL UNIT IS COMPLETE THESE  * S99528 03600000
*    UNIT ADDRESSES MAY BE RESTORED TO THE SAME CONDITION THEY * S99528 03700000
*    WERE IN WHEN THEY WERE OBTAINED.                          * S99528 03800000
*                                                              * S99528 03900000
*    A SPECIFIC BIT IS CHECKED AT ENTRY TO ALLOW THIS MODULE   * S99528 04000000
*    TO BE ENTERED TO RESTORE THE CHANNEL UNITS TO THE STATE   * S99528 04100000
*    THEY WERE IN WHEN OBTAINED.                               * S99528 04200000
*                                                              * S99528 04300000
* MODULE TYPE: PROCEDURE                                       @Y17XAUU 04310000
*                                                              @Y17XAUU 04320000
* PROCESSOR: ASSEMBLE XF                                       @Y17XAUU 04330000
*                                                              @Y17XAUU 04340000
* MODULE SIZE: 2K MAXIMUM                                      @Y17XAUU 04350000
*                                                              @Y17XAUU 04360000
* ENTRY POINTS:                                                * S99528 04400000
*                                                              * S99528 04500000
*    IEDQWAJ - CALLED WHEN A $CUTEST MACRO IS ISSUED BY THE    * S99528 04600000
*    UNIT TEST.                                                * S99528 04700000
*                                                              * S99528 04800000
* INPUT:                                                       * S99528 04900000
*                                                              * S99528 05000000
*    REGISTER 01 - $CUTEST PARAMETER LIST ADDRESS              * S99528 05100000
*    REGISTER 02 - OLTCB POINTER                               * S99528 05200000
*    REGISTER 13 - SAVE AREA ADDRESS                           * S99528 05300000
*    REGISTER 14 - RETURN ADDRESS                              * S99528 05400000
*    REGISTER 15 - ENTRY POINT ADDRESS                         * S99528 05500000
*                                                              * S99528 05600000
* OUTPUT:                                                      * S99528 05700000
*                                                              * S99528 05800000
*    REGISTER 15 CONTAINS THE MACRO RETURN CODE                * S99528 05900000
*                                                              * S99528 06000000
*           X'00' SUCCESSFUL COMPLETION                        * S99528 06100000
*           X'08' ONE OR MORE DEVICES DO NOT MEET REQUIREMENTS * S99528 06200000
*           X'0C' PARAMETER ERROR                              * S99528 06300000
*                                                              * S99528 06400000
*                                                              * S99528 06500000
* EXTERNAL ROUTINES:                                           * S99528 06600000
*                                                              * S99528 06700000
*    NONE                                                      * S99528 06800000
*                                                              * S99528 06900000
* EXIT POINTS (NORMAL) :                                       * S99528 07000000
*                                                              * S99528 07100000
*    BR AFTER 'CU007A' TO RETURN TO CALLER                     * S22024 07200000
*    XCTL TO IEDQWM2 AFTER 'CU0007B'                           * S22024 07300000
*                                                              * S99528 07400000
* EXIT POINTS (ERROR) :                                        * S99528 07500000
*    NONE                                                      * S99528 07600000
*                                                              * S99528 07700000
* TABLES/WORK AREAS:                                           * S99528 07800000
*                                                              * S99528 07900000
*    OLTCB, UNIT TEST, GETMAIN AREA                            * S99528 08000000
*                                                              * S99528 08100000
* ATTRIBUTES:                                                  * S99528 08200000
*                                                              * S99528 08300000
*    ENABLED, PROBLEM PROGRAM MODE, RESIDENT,                  @Y17XAU2 08400000
*    RE-ENTRANT                                                @Y17XAU2 08450000
*                                                              * S99528 08500000
* NOTES: SEE BELOW                                             @Y17XAUU 08600000
*                                                              @Y17XAUU 08610000
*  REGISTERS CONVENTION: SEE REGISTER ASSIGNMENT               @Y17XAUU 08620000
*                                                              @Y17XAUU 08630000
*  PATCH LABEL: PATCH                                          @Y17XAUU 08640000
*                                                              @Y17XAUU 08650000
*  RESTRICTIONS: NONE                                          @Y17XAUU 08660000
*                                                              @Y17XAUU 08670000
*  DEPENDENCIES: EBCDIC CHARACTER CODE                         @Y17XAUU 08700000
*                                                              * S99528 08800000
**************************************************************** S99528 09500000
         EJECT                                                          09600000
**************************************************************** S99528 09700000
*        EQUATES TO ALLOW SYMBOLIC NAMING OF REGISTERS         * S99528 09800000
**************************************************************** S99528 09900000
R0       EQU   0                   REGISTER 0                    S22024 10000000
R1       EQU   1                   $CUTEST PARAMETER LIST ADDR   S99528 10100000
R2       EQU   2                   OLTCB POINTER                 S99528 10200000
R3       EQU   3                   WORK REGISTER                 S99528 10300000
R4       EQU   4                   BASE REGISTER                 S99528 10400000
R5       EQU   5                   WORK REGISTER                 S99528 10500000
R6       EQU   6                   WORK REGISTER                 S99528 10600000
R7       EQU   7                   WORK REGISTER                 S99528 10700000
R8       EQU   8                   WORK REGISTER                 S99528 10800000
R9       EQU   9                   WORK REGISTER                 S99528 10900000
R10      EQU   10                  WORK REGISTER                 S99528 11000000
R11      EQU   11                  POINTER TO PROPER SAVE AREA   S99528 11100000
R12      EQU   12                  WORK REGISTER                 S99528 11200000
R13      EQU   13                  SAVE AREA ADDRESS             S99528 11300000
R14      EQU   14                  RETURN ADDRESS                S99528 11400000
R15      EQU   15                  ENTRY POINT ADDRESS           S99528 11500000
PARMREG0 EQU   0                   PARAMETER REGS FOR IEDQMSG    S99528 11600000
PARMREG1 EQU   1                   PARAMETER REGS FOR IEDQMSG    S99528 11700000
ADRMSK7  EQU   7                   ADDRESS MASK BYTE           @Y17XAUU 11750000
DISREG2  EQU   28                  DISPLACEMENT TO REG 2       @Y17XAUU 11760000
         EJECT                                                   S99528 11800000
         USING IEDQWAJ,R4                                        S99528 11900000
         USING TOTOLTCB,R2                                       S21903 12000000
         SAVE  (14,12)                                           S99528 12100000
         LR    R4,R15              LOAD BASE REGISTER            S99528 12200000
IEDQWAJ  IEDHJN CU000,HJN                                        S99528 12300000
         MVC   TBEG1(TEND1-TBEG1),QOTUCBAB                     @Y17XAUU 12310000
         MVC   TBEG2(TEND2-TBEG2),QUENQLST                     @Y17XAUU 12320000
         LA    R5,QNAME            ADDRESS OF MAJOR NAME       @Y17XAUU 12330000
         LA    R6,RNAME            ADDRESS OF MINOR NAME       @Y17XAUU 12340000
         STM   R5,R6,CUENQLST+FSTWORD SET ADDRESSES IN PLIST   @Y17XAUU 12350000
         LA    R5,TOTUCBAB         DATA ADDRESS                @Y17XAUU 12360000
         STCM  R5,ADRMSK7,TOT102+SNDBYTE PUT IN PLIST          @Y17XAUU 12370000
         LA    R5,TOTUCBAC         ADDRESS CONTAINING LENGTH   @Y17XAUU 12380000
         STCM  R5,ADRMSK7,TOT102A+FSTWORD PUT IN PLIST         @Y17XAUU 12390000
         LA    R12,TOTSAVE1        PICK UP SAVE AREA ADDRESS     S99528 12400000
         ST    R12,SNDWORD(R13)    SAVE IT IN CALLERS SAVE AREA  S99528 12500000
         ST    R13,TOTSAVE1+FSTWORD SAVE CALLERS SAVE REG        S99528 12600000
         LR    R13,R12             SET UP SAVE AREA REG          S99528 12700000
*                                                                S99528 12800000
         TM    TOTCUFLG,TOTCUCUP   ARE WE BEING ENTERED TO CLEAN S99528 12900000
*                                  UP AFTER PREVIOUS $CUTEST     S99528 13000000
         BO    CUP000              YES  PROCEED WITH CLEANUP     S99528 13100000
         SR    R15,R15             CLEAR RETURN CODE REGISTER    S99528 13200000
         CLI   SNDBYTE(R1),LEVEL2  LEVEL 2 MACRO ID?             S22024 13300000
         BE    CU001               YES                           S99528 13400000
*                                  NO ISSUE ERROR MESSAGE        S99528 13500000
         LA    R15,RETCODE4       SET RETURN CODE TO 4           S05331 13600000
         B     CU007              BRANCH TO EXIT ROUTINE         S05331 13700000
CU001    DS    0H                                                S99528 13900000
         LR    R6,R1               SAVE PARAMETER POINTER        S99528 14000000
         TM    TOTCUFLG,TOTCUDON   HAS A $CUTEST ALREADY         S99528 14100000
*                                  BEEN ISSUED ?                 S99528 14200000
         BO    CU002C              YES BRANCH AROUND GETMAIN     S99528 14300000
*                                  AND STORING THE GETMAIN ADDR  S99528 14400000
*                                      GETMAIN TO GET SAVE       S99528 14500000
         LA    R5,CUGETSAV         ADDRESS OF RETURNED SPACE   @Y17XAUU 14550000
         GETMAIN EC,LV=256,A=(R5),MF=(E,PLIST) GET CORE        @Y17XAUU 14600000
         LTR   R15,R15             WAS GETMAIN SATISFIED?        S99528 14700000
         BZ    CU002               YES CONTINUE                  S99528 14800000
*                                  NO SET BAD RETURN CODE & EXIT S99528 14900000
CU001A   DS    0H                                                       15000000
         SR    R15,R15             CLEAR RETURN CODE REGISTER    S99528 15100000
         LA    R15,RETCODE8        LOAD RETURN CODE              S99528 15200000
CU007    DS    0H                                                S99528 15300000
         STC   R15,TOTRTCOD        PUT RET CODE IN OLTCB         S99528 15400000
         TM    $OLTFLGS,$TRACE     IS TRACE REQUESTED            S99528 15500000
         BO    CU007B              YES                           S99528 15600000
         TM    TOTRTCOD,HEXFF      IS RETURN CODE NON ZERO       S99528 15700000
         BZ    CU007A              NO DO NOT TEST RETURN CODE    S99528 15800000
*                                  OPTION                        S99528 15900000
         TM    $RETCODE,HEXFF      ANY BITS SET                  S99528 16000000
         BNZ   CU007B              YES BRANCH                    S99528 16100000
CU007A   DS    0H                                                S99528 16200000
*                                                                S99528 16300000
         L     R13,FSTWORD(R13)    GET CALLERS SAVE AREA ADDRESS S22024 16400000
         L     R14,TRDWORD(R13)    RESTORE R14                   S99528 16500000
         LM    R0,R12,FIFWORD(R13) RESTORE CALLERS REGISTERS     S99528 16600000
         BR    R14                 RETURN                        S99528 16700000
CU007B   DS    0H                                                S99528 16800000
         L     R13,FSTWORD(R13)    GET CALLERS SAVE ADDRESS      S99528 16900000
         L     R14,TRDWORD(R13)    GET HIS RETURN ADDRESS        S99528 17000000
         USING RESPL,R5                                        @Y17XAU2 17010000
         L     R5,TOTRESPL                                     @Y17XAU2 17020000
         L     R15,RESPLM2                                     @Y17XAU2 17030000
         LM    R2,R12,DISREG2(R13) RESTORE REGISTERS           @Y17XAUU 17032000
         BR    R15                                             @Y17XAU2 17040000
         DROP  R5                                              @Y17XAU2 17050000
         EJECT                                                          17200000
*                                                                S99528 17300000
CU002    DS    0H                                                S99528 17400000
         L     R5,CUGETSAV         GET START OF AREA             S99528 17500000
         LA    R5,START(R5)        CLEAR HIGH ORDER BYTE         S99528 17600000
         ST    R5,TOTCUSAV         STORE ADDRESS IN OLTCB        S99528 17700000
         XC    START(LEN1,R5),START(R5)  ZERO OUT SAVE AREA      S99528 17800000
*                                                                S99528 17900000
CU002A   DS    0H                                                S99528 18000000
         L     R5,FSTWORD(R6)      GET SAVED POINTER TO EXTENT   S99528 18100000
         MVC   TOTCU#AD(LEN2),FSTWORD(R5) MOVE # OF CONTIGUOUS   S99528 18200000
*                                         ADDRESSES INTO OLTCB   S99528 18300000
         MVC   TOTCURS1(LEN2),SNDWORD(R6) MOVE 'CODE' PARAMETER  S99528 18400000
*                                         OF CUTEST INTO OLTCB   S99528 18500000
         L     R5,START(R5)        GET CU START ADDR IN REG 5    S99528 18600000
         STH   R5,TOTCUCUU         STORE STARTING CUU ADDR IN    S99528 18700000
*                                  OLTCB                         S99528 18800000
         MVC   TOTCURS2(LEN2),TOTCUCUU SAVE CHANNEL NUMBER       S99528 18900000
         XC    TOTCUCUU(LEN2),TOTCUCUU CLEAR CHANNEL NUMBER      S99528 19000000
*                                       FROM WORK AREA           S99528 19100000
         CLI   TOTCURS1,CUCODE0    IS CODE 0 REQUESTED           S99528 19200000
         BE    CU002B              YES CONTINUE PROCESSING       S99528 19300000
         CLI   TOTCURS1,CUCODE1    IS CODE 1 REQUESTED           S99528 19400000
         BE    CU002B              YES CONTINUE PROCESSING       S99528 19500000
         SR    R15,R15             CLEAR RETURN CODE REGISTER    S99528 19600000
         LA    R15,RETCODEC        INVALID PARAMETER LIST        S99528 19700000
         B     CU007               RETURN                        S99528 19800000
*                                                                S99528 19900000
CU002C   DS    0H                                                S99528 20000000
         L     R5,FSTWORD(R6)      GET SAVED POINTER TO EXTENT   S99528 20100000
         CLC   TRDBYTE(LEN2,R5),TOTCURS2 SAME CHANNEL NUMBER     S99528 20200000
*                                        PREVIOUS $CUTESTS?      S99528 20300000
         BE    CU002A              YES CONTINUE                  S99528 20400000
         SR    R15,R15             NO SET UP TO RETURN           S99528 20500000
         LA    R15,RETCODEC        LOAD BAD RETURN CODE          S99528 20600000
         B     CU007               RETURN                        S99528 20700000
*                                                                S99528 20800000
CU002B   DS    0H                                                S99528 20900000
         OI    TOTCUFLG,TOTCUDON   TURN ON $CUTEST ALREADY       S99528 21000000
*                                  DONE FLAG IN OLTCB            S99528 21100000
         SR    R12,R12             CLEAR REGISTER                S99528 21200000
         IC    R12,TOTCU#AD        PUT # OF CONTIGUOUS ADDRESSES S99528 21300000
*                                  IN REGISTER 12                S99528 21400000
         BCT   R12,CU003           DECREMENT REG 12 TO GET       S99528 21500000
CU003    DS    0H                  PROPER AMOUNT FOR PROCESSING  S99528 21600000
*                                                                S99528 21700000
         SR    R11,R11             CLEAR REGISTER                S99528 21800000
         LH    R11,TOTCUCUU        PUT STARTING CUU IN R11       S99528 21900000
         L     R5,TOTCUSAV         GET ADDRESS OF SAVE AREA      S99528 22000000
         AR    R11,R5              CALCULATE OFFSET INTO SAVAREA S99528 22100000
*                                                                S99528 22200000
         AR    R11,R12             GET LAST OF CONTIG. ADDRESSES S99528 22300000
         LA    R12,CURESTOR(R12)   INCREMENT R12 AFTER           S99528 22400000
*                                  CALCULATIONS                  S99528 22500000
*                                                                S99528 22600000
CU006    DS    0H                                                S99528 22700000
         BCT   R12,CU006A          DECREMENT R12 AGAIN           S99528 22800000
CU006A   DS    0H                                                S99528 22900000
         SR    R10,R10             CLEAR R10                     S99528 23000000
         IC    R10,CUCUUSED        SET UP TO TEST IF USED        S99528 23100000
         EX    R10,CUEXTM          TEST BIT                      S99528 23200000
         BO    CU004               ALREADY USED IN A $CUTEST     S99528 23300000
*                                  BYPASS THIS ADDRESS           S99528 23400000
*                                                                S99528 23500000
         B     CU009               FIND OUT IF OFFLINE           S99528 23600000
         EJECT                                                   S99528 23700000
**************************************************************** S99528 23800000
*                                                              * S99528 23900000
*        ROUTINE TO FIND IF UCB IS OFFLINE                     * S99528 24000000
*                                                              * S99528 24100000
**************************************************************** S99528 24200000
CU009    DS    0H                                                S99528 24300000
         L     R8,FORWORD(R0)      PICK UP CVT ADDR              S99528 24400000
         USING CVT,R8                                            S99528 24500000
         L     R9,AVTCVTPT(R8)     PICK UP DISPATCHER ADDRESS    S99528 24600000
         L     R7,CVTILK2          PICK UP 2 BYTE UCB TABLE      S99528 24700000
         ST    R7,CUUCBSAV         SAVE UCB POINTER              S99528 24800000
         DROP  R8                                                S99528 24900000
*                                                                S99528 25000000
         L     R8,CUUCBSAV         PICK UP ADDR OF UCB POINTERS  S99528 25100000
         USING UCB,R7                                            S99528 25200000
CUUCB01  LH    R7,START(R8)        LOAD UCB ADDR                 S99528 25300000
         LA    R8,LEN3(R8)         POINT TO NEXT ENTRY (+2)      S99528 25400000
         LTR   R7,R7               IS R7 EQUAL TO ZERO           S99528 25500000
         BZ    CUUCB01             PADDING- IGNORE IT            S99528 25600000
         BP    GOODUCB             POSITIVE THEN GOOD UCB      @G36XRUV 25700010
         N     R7,CLEARHI          CLEAR HIGH ORDER BYTES      @G36XRUV 25720010
         CLM   R7,THREE,TABLEEND   Q-IS THIS END OF TABLE      @G36XRUV 25740010
         BE    CU010               Y-BRANCH                    @G36XRUV 25760010
GOODUCB  DS    0H                                              @G36XRUV 25780010
         ST    R7,CUUCBADR         SAVE UCB ADDRESS              S99528 25800000
         SR    R10,R10             CLEAR WORK REGISTER           S99528 25900000
         LH    R10,TOTCUCUU        LOAD FIRST CUU INTO REGISTER  S99528 26000000
*                                  CUU = CHAN ADDR IN HEX        S99528 26100000
         AR    R10,R12             ADD TO FIND CUU WE ARE USING  S99528 26200000
         STH   R10,CUCUU           SAVE THIS UCB NAME (HEX)      S99528 26300000
         MVC   CUCUU(LEN2),TOTCURS2 MOVE CHANNEL NUMBER INTO     S99528 26400000
*                                   COMPARE FIELD                S99528 26500000
         CLC   CUCUU(LEN3),UCBCHA     IS THERE A MATCH ?         S99528 26600000
         BNE   CUUCB01                NO: GO LOOK AGAIN          S99528 26700000
         CLI   UCBTBYT3,CUCOMMUN   IS UCB DEVICE TYPE COMMUNICAT S99528 26800000
         BE    CUUCB02             YES OK TO CONTINUE            S99528 26900000
         CLI   UCBTBYT3,CUGRAPH    IS UCB DEVICE TYPE GRAPHICS   S99528 27000000
         BE    CUUCB02             YES OK TO CONTINUE            S99528 27100000
         CLI   UCBTBYT3,CUDUMMY    IS UCBTYPE DUMMY              S21903 27200000
         BE    CUUCB02             YES  OK TO CONTINUE           S21903 27300000
         SR    R15,R15             SET UP TO RETURN              S99528 27400000
         LA    R15,RETCODEC        LOAD BAD RETURN CODE          S99528 27500000
         B     CU007               RETURN                        S99528 27600000
*                                                                S99528 27700000
CUUCB02  DS    0H                                                S99528 27800000
*                                                              * S99528 27900000
*        WE HAVE FOUND THE UCB - NOW IS IT OFFLINE ?           * S99528 28000000
*                                                              * S99528 28100000
         TM    SRTESTAT,SRTEALOC+SRTESYSR+SRTEDADI IS THIS UCB   S99528 28200000
*                                                  ALLOCATED OR  S99528 28300000
*                                                  PRIMARY OR    S99528 28400000
*                                                  SECONDARY     S99528 28500000
*                                                  CONSOLE       S99528 28600000
         BZ    CU010                               NO - NONE     S99528 28700000
*                                                  OF THESE      S99528 28800000
         MVC   CUUCBNAM(LEN4),UCBNAME  SAVE EBCDIC UCB ADDRESS   S99528 28900000
         B     CU011               YES FIND IF ALLOCATED TO TCAM S99528 29000000
CU010    DS    0H                                                S99528 29100000
         TM    TOTCUFLG,TOTCUCUP   ARE WE CLEANING UP?           S99528 29200000
         BO    CU010A              YES                           S99528 29300000
         TM    UCBOB+TUCBNALO,TUCBNALC IS UNALLOCATE BIT ON?     S21903 29400000
         BO    CU001A                  GO SET BAD RETURN CODE    S21903 29500000
         SR    R10,R10             CLEAR REG 10                  S99528 29600000
         IC    R10,CUCUUSED        SET UP TO MARK IT USED        S99528 29700000
*                                  IN A $CUTEST MACRO            S99528 29800000
         EX    R10,CUEXOI          MARK IT USED IN $CUTEST       S99528 29900000
         IC    R10,CUCUOFFL        SET UP TO MARK OFF LINE       S99528 30000000
         EX    R10,CUEXOI          MARK IT OFF LINE              S99528 30100000
         LTR   R7,R7               DID WE FIND UCB OR END OF LISTS99528 30200000
         BC    FSTWORD,CU004       END OF LIST DONT SET BIT      S99528 30300000
         DROP  R7                      DROP UCB BASE             S21903 30400000
*                                                              * S99528 30500000
*        TURN ON UCBNALOC BIT IN THE UCB                       * S99528 30600000
*                                                              * S99528 30700000
         MVC   TOTUCBAB(LEN6),START(R7) MOVE UCB TO WORK AREA    S99528 30800000
         OI    TOTUCBAB+TUCBNALO,TUCBNALC TURN ON UCBNALOC BIT   S99528 30900000
         STH   R7,TOT102A+TUCBONE  STORE UCB ADDRESS IN TARGET   S99528 31000000
*                                  ADDRESS OF SVC 102            S99528 31100000
         LA    R1,TOT102           LOAD R1 TO POINT TO DATA      S99528 31200000
*                                  MOVE PARAMETER LIST           S99528 31300000
         AQCTL                                                   S99528 31400000
         B     CU004               CONTINUE $CUTEST              S99528 31500000
*                                                                S99528 31600000
*                                                              * S99528 31700000
*       TURN OFF UCBNALOC BIT IN THE UCB                       * S99528 31800000
*                                                              * S99528 31900000
CU010A   DS    0H                                                S99528 32000000
         LTR   R7,R7               DID WE FIND UCB OR END OF LISTS99528 32100000
         BC    FSTWORD,CUP008      END OF LIST DONT SET BIT      S99528 32200000
         MVC   TOTUCBAB(LEN6),START(R7) MOVE UCB TO WORK AREA    S99528 32300000
         NI    TOTUCBAB+TUCBNALO,TUCBNALF TURN OFF UCBNALOC BIT  S99528 32400000
         STH   R7,TOT102A+TUCBONE  STORE UCB ADDRESS IN TARGET   S99528 32500000
*                                  ADDRESS OF SVC 102            S99528 32600000
         LA    R1,TOT102           LOAD R1 TO POINT TO DATA      S99528 32700000
*                                  MOVE PARAMETER LIST           S99528 32800000
         AQCTL                                                   S99528 32900000
         B     CUP008              CONTINUE TO CLEANUP           S99528 33000000
         EJECT                                                          33100000
**************************************************************** S99528 33200000
*                                                              * S99528 33300000
*        FOLLOWING CODE FINDS OUT IF UCB IS TCAM'S. UCB ADDR   * S99528 33400000
*        SHOULD BE IN 'CUUCBADR'.                              * S99528 33500000
*                                                                S99528 33600000
**************************************************************** S99528 33700000
CU011    DS    0H                  FIND DD ENTRY                 S99528 33800000
         LA    R9,CVTPTR           CVT POINTER ADDRESS           S99528 33900000
         L     R9,START(R9)        CVT ADDRESS                   S99528 34000000
         L     R9,START(R9)        TCBPOINTERS ADDRESS           S99528 34100000
         L     R9,FSTWORD(R9)      CURRENT TCB ADDRESS           S99528 34200000
         L     R9,TRDWORD(R9)      TIOT ADDRESS                  S99528 34300000
*                                                                S99528 34400000
         USING TIOT,R9                                           S99528 34500000
         LA    R9,TIOENTRY         POINT TO FIRST ENTRY          S99528 34600000
         DROP  R9                                                S99528 34700000
*                                                                S99528 34800000
         USING TIOENTRY,R9                                       S99528 34900000
CU008    SR    R8,R8               CLEAR REG                     S99528 35000000
         IC    R8,TIOELNGH         DD ENTRY LENGTH               S99528 35100000
         LTR   R8,R8               ANY LENGTH                    S99528 35200000
         BZ    CU001A              DOES NOT BELONG TO TCAM       S99528 35300000
*                                  SET BAD RETURN DOCE - RETURN  S22024 35400000
         LA    R5,POOLSTAR-TIOESTTB  GET LGTH OF DEVICE ENTRY    S99528 35500000
         DROP  R9                                                S99528 35600000
         LR    R6,R8               SAVE LENGTH                   S99528 35700000
         SR    R8,R5               DD LENGTH MINUS FOUR          S99528 35800000
         AR    R8,R9               DEVICE                        S99528 35900000
         USING TIOESTTB,R8                                       S99528 36000000
         CLC   TIOEFSRT+SNDBYTE(LEN3),CUUCBADR+TRDBYTE  COMPARE  S99528 36100000
*                                                       UCB ADDR S99528 36200000
         DROP  R8                                                S99528 36300000
         BE    CU012               UCB FOUND IT IS TCAM'S        S99528 36400000
*                                                                S99528 36500000
         AR    R9,R6               BUMP POINTER TO NEXT DD ENTRY S99528 36600000
         B     CU008               LOOP TO SEE IF NEXT IS TCAM'S S99528 36700000
*                                                                S99528 36800000
*                                                                S99528 36900000
CU012    DS    0H                                                S99528 37000000
         MVC   RNAME(LEN4),CUUCBNAM MOVE IN EBCDIC NAME          S99528 37100000
         TM    TOTCUFLG,TOTCUCUP   ARE WE CLEANING UP            S99528 37200000
         BO    CU012B              YES                           S99528 37300000
*                                    BEFORE MARKING IT ALLOCATED S99528 37400000
*                                    TO TCAM ENQ IT TO INSURE    S99528 37500000
*                                    SOME OTHER OLT DOESN'T      S99528 37600000
*                                    HAVE IT                     S99528 37700000
         ENQ   ,MF=(E,CUENQLST)      ENQ ON CHANNEL ARRDESS      S99528 37800000
         LTR   R15,R15               IS THE DEVICE AVAILABLE?    S99528 37900000
         BZ    CU012A                YES - CONTINUE              S99528 38000000
         CLI   FORBYTE(R15),RETCODE8 HAVE WE ALREADY REQUESTED   S99528 38100000
*                                    IT                          S99528 38200000
         BE    CU004               YES CONTINUE WITH $CUTEST BUT S99528 38300000
*                                  DONT SAVE STATUS SINCE        S99528 38400000
*                                  IEDQWC HAS ALREADY SAVED IT   S99528 38500000
*                                                                S99528 38600000
         B     CU001A                MARK BAD RETURN CODE AND    S99528 38700000
*                                    RETURN                      S99528 38800000
CU012B   DS    0H                                                S99528 38900000
         DEQ   ,MF=(E,CUENQLST)    DEQUEUE RESOURCE ENQ'ED       S99528 39000000
*                                                                S99528 39100000
         SR    R10,R10             CLEAR WORK REGISTER           S99528 39200000
         IC    R10,CUCUSTRT        TEST IF LINE STARTED WHEN GOT S99528 39300000
         EX    R10,CUEXTM          TEST LINE STARTED BIT         S99528 39400000
         BO    CU012C              LINE WAS STARTED GO START     S99528 39500000
         B     CUP008              NO CONTINUE RESTORING         S99528 39600000
*                                                                S99528 39700000
CU012C   DS    0H                                                S99528 39800000
         BAL   R3,STARTLIN         GO TO START LINE ROUTINE      S99528 39900000
*                                                                S99528 40000000
         B     CUP008              ALL DONE THIS CUU GET NEXT    S99528 40100000
*                                                                S99528 40200000
         EJECT                                                   S99528 40300000
*                                                                S99528 40400000
CU012A   DS    0H                                                S99528 40500000
         SR    R10,R10             CLEAR REGISTER                S99528 40600000
         IC    R10,CUCUUSED        SET UP TO MARK IT USED        S99528 40700000
*                                  IN A $CUTEST MACRO            S99528 40800000
         EX    R10,CUEXOI          MARK IT USED IN $CUTEST       S99528 40900000
         IC    R10,CUCUTCAM        GET ALLOCATED BIT             S99528 41000000
         EX    R10,CUEXOI          MARK IT ALLOCATED TO TCAM     S99528 41100000
         BAL   R3,STOPLINE         GO ISSUE STOP LINE            S99528 41200000
*                                                                S99528 41300000
*                                                                S99528 41400000
         CLI   TOTORTCD,RETCODE0   WAS REQUEST SUCCESSFUL?       S22024 41500000
         BE    CUSTLN08            YES SET PROPER BITS           S99528 41600000
*                                                                S99528 41700000
         CLI   TOTORTCD,RETCODE4   DID REQUEST FAIL?             S22024 41800000
         BE    CUSTLN02            YES PRINT AND EXIT            S99528 41900000
*                                                                S99528 42000000
         CLI   TOTORTCD,RETCODE8   WAS REQUEST ALREADY DONE?     S22024 42100000
         BE    CUSTLN09            YES SET PROPER BITS           S99528 42200000
         B     CUSTLN02                ACT AS IF OP-CONTROL      S21903 42300000
*                                       REQUEST FAILED           S21903 42400000
*                                                                S99528 42500000
*                                                                S99528 42600000
CUSTLN02 DS    0H                                                S99528 42700000
         B     CU001A              RETURN WITH RETCODE OF 08     S99528 42800000
*                                                                S99528 42900000
CUSTLN08 DS    0H                                                S99528 43000000
         IC    R10,CUCUSTRT        SET UP TO MARK LINE STARTED   S99528 43100000
         EX    R10,CUEXOI          MARK LINE ALREADY SYARTED     S99528 43200000
CUSTLN09 DS    0H                                                S99528 43300000
CU004    DS    0H                                                S99528 43400000
         BCT   R11,CU005           DECREMENT TO NEXT ADDRESS     S99528 43500000
CU005    DS    0H                                                S99528 43600000
         LA    R12,CURESTOR(R12)   INCREMENT R12 TO              S99528 43700000
*                                  ADJUST FOR CALCULATIONS       S99528 43800000
         BCT   R12,CU006           CONTINUE STUDYING STATUS      S99528 43900000
*                                                                S99528 44000000
         SR    R15,R15             SET GOOD RETURN CODE AND      S99528 44100000
         B     CU007               RETURN                        S99528 44200000
         EJECT                                                          44300000
**************************************************************** S99528 44400000
*                                                              * S99528 44500000
*        START LINE  /  STOP LINE  ROUTINE                     * S99528 44600000
*                                                              * S99528 44700000
**************************************************************** S99528 44800000
STARTLIN EQU   *                   START LINE ENTRY              S99528 44900000
         MVI   TOTOVBCD,LINESTRT   MOVE IN START LINE VERB CODE  S22024 45000000
         B     CUSTLN00            CONTINUE PROCESSING           S99528 45100000
STOPLINE EQU   *                   STOP LINE ENTRY               S99528 45200000
         MVI   TOTOVBCD,LINESTOP   MOVE IN STOP LINE VERB CODE   S22024 45300000
*                                                                S99528 45400000
CUSTLN00 STM   R2,R12,CUREGSAV     SAVE REGS ON ENTRY TO         S99528 45500000
*                                  START / STOP LINE ROUTINE     S99528 45600000
         MVI   TOTOLADR,BLANK      MOVE BLANK INTO NAME FIELD    S22024 45700000
         MVC   TOTOLADR+SNDBYTE(D7),TOTOLADR  BLANK OUT FIELD    S22024 45800000
         MVC   TOTOLADR(LEN4),CUUCBNAM  MOVE EBCDIC NAME INTO    S22024 45900000
*                                     OP CONTROLS PARAMETER LIST S99528 46000000
         L     R6,FORWORD(R0)      LOAD ADDRESS OF CUT INTO R1   S99528 46100000
         L     R6,AVTCVTPT(R6)     GET TCAM DISPATCHER ADDRESS   S99528 46200000
         L     R6,START(R6)        GET AVT ADDRESS               S99528 46300000
         USING IEDQAVTD,R6                                       S99528 46400000
         LA    R10,AVTOPCOB        GET POINTER TO OP CNTRL QCB   S99528 46500000
         ST    R10,TOTOKEY         PUT IN PARAMETER LIST         S22024 46600000
         MVI   TOTOKEY,OPCKEY      SET KEY TO ZERO               S22024 46700000
         L     R6,AVTTCB           GET TCAM TCB ADDRESS          S99528 46800000
         DROP  R6                                                S99528 46900000
         L     R6,SNDWORD(R6)      GET DEB CHAIN ADDRESS         S99528 47000000
CUSTLN01 DS    0H                                                S99528 47100000
         LA    R6,START(R6)        CLEAR HIGH ORDER BYTE         S99528 47200000
         LTR   R6,R6               IS THERE ANOTHER DEB ?        S99528 47300000
         BZ    CUSTLN11            NO INDICATE CANNOT STOP LINE  S99528 47400000
         SR    R10,R10             CLEAR LOOP COUNTER            S99528 47500000
*                                                                S99528 47600000
         IC    R10,FORWORD(R6)     INITLZ LOOP COUNTER WITN      S99528 47700000
*                                  NUMBER OF EXTENTS             S99528 47800000
         LA    R5,ETHWORD(R6)      GET UCB CHAIN ADDRESS         S99528 47900000
         L     R11,FSTWORD(R6)     GET NEXT DEB ADDRESS          S99528 48000000
         L     R9,SIXWORD(R6)      GET DCB ADDRESS               S99528 48100000
         USING IHADCB,R9                                         S99528 48200000
         TM    DCBDSORG+SNDBYTE,TCAMDEB IS THIS A TCAM DEB?      S99528 48300000
         BZ    CUSTLN03                 NO: GET NEXT DEB         S99528 48400000
         LA    R7,CURLNINT         INITIALIZE REL. LINE NUMBER   S99528 48500000
*                                                                S99528 48600000
CUSTLN04 DS    0H                                                S99528 48700000
         L     R3,START(R5)        GET UCB ADDRESS               S99528 48800000
         LA    R3,START(R3)        FOR COMPARE INSTRUCTION       S99528 48900000
         L     R8,CUUCBADR         GET ADDRESS SAVED IN UCB      S99528 49000000
*                                  SEARCH ROUTINE                S99528 49100000
         LA    R8,START(R8)        CLEAR HIGH ORDER BYTE         S99528 49200000
         CR    R3,R8               CORRECT UCB FOUND             S99528 49300000
         BE    CUSTLN06                YES, BRANCH               S21903 49400000
         LA    R5,FSTWORD(R5)      NO  BUMP TO NEXT UCB ADDRESS  S99528 49500000
         LA    R7,LEN2(R7)         BUMP RELATIVE LINE NUMBER    SA64769 49600000
         BCT   R10,CUSTLN04        LOOP TILL END OF UCB CHAIN    S99528 49700000
*                                                                S99528 49800000
*                                                                S99528 49900000
*                                                                S99528 50000000
CUSTLN03 DS    0H                                                S99528 50100000
         LR    R6,R11              POINT R6 TO NEXT DEB          S99528 50200000
         B     CUSTLN01            GET NEXT UCB CHAIN            S99528 50300000
*                                                                S99528 50400000
*                                                                S99528 50500000
CUSTLN06 DS    0H                                                S99528 50600000
         SR    R10,R10             CLEAR REG 10                  S99528 50700000
         IC    R10,DCBEXLST        GET LCB LENGTH                S99528 50800000
         LR    R11,R7              GET RELATIVE LINE NUMBER      S99528 50900000
         MR    R10,R10             MULTIPLY RLN BY LCB LENGTH    S99528 51000000
         L     R10,DCBIOBAD        GET DUMMY IOB ADDRESS         S99528 51100000
         LA    R10,START(R10,R11)  GET CORRECT IOB ADDRESS       S99528 51200000
         LA    R11,LCBFLAG1-IEDQLCB  GET OFFSET TO LCB START     S99528 51300000
         SR    R10,R11             SUBTRACT FROM IOB POINTER     S99528 51400000
         USING IEDQLCB,R10                                       S99528 51500000
         CLI   TOTOVBCD,LINESTRT   IS START LINE REQUESTED?      S22024 51600000
         BNE   CUSTLN07            NO                            S99528 51700000
         CLI   LCBCPA,TOTELINE     IS LINE ASSIGNED TO TOTE?     S99528 51800000
         BNE   CUSTLN10            NO  DO NOT START LINE         S99528 51900000
         MVI   LCBCPA,NOTTOTE      CLEAR LINE ASSIGNED TO TOTE   S99528 52000000
*                                                                S99528 52100000
         DROP  R9                                                S99528 52200000
         DROP  R10                                               S99528 52300000
*                                                                S99528 52400000
CUSTLN07 DS    0H                                                S99528 52500000
         STC   R7,TOTORLN          STORE RELATIVE LINE NUMBER IN S22024 52600000
*                                  REQUEST ELEMENT               S99528 52700000
         LA    R1,TOTOTECB         GET TOTE ECB                  S99528 52800000
         ST    R1,TOTOECBA         PUT IN PARAMETER LIST         S22024 52900000
         MVI   TOTOPRI,OPCPRI      SET OPERATOR CONTROL PRIORITY S22024 53000000
         MVI   TOTORTCD,OPCRTCD    CLEAR RETURN CODE FIELD       S22024 53100000
         MVI   TOTOELNG,OPCELNG    MOVE ELEMENT LENGTH INTO LIST S22024 53200000
         XC    TOTOLINK(LEN4),TOTOLINK  CLEAR REQUEST ELEMENT    S22024 53300000
*                                         LINK FIELD             S22024 53400000
         LA    R1,TOTPLIST         GET ADDRESS OF OP CONTROL     S22024 53500000
*                                    PARAMETER LIST              S22024 53600000
         ST    R1,ELEM1            PUT PARM LIST ADDR IN 1ST WORDS22024 53700000
*                                    OF POST LIST                S22024 53800000
         ST    R1,ELEM2            PUT ADDR OF PARM LIST IN 2ND  S22024 53900000
*                                    WORD OF POST LIST           S22024 54000000
         MVI   ELEM1,START102      SVC 102 START FLAG            S22024 54100000
         MVI   ELEM2,LAST102       LAST WORD FLAG BYTE           S22024 54200000
         LA    R1,SLPL             POINT R1 TO SVC 102 POST LIST S22024 54300000
         XC    TOTOTECB(LEN5),TOTOTECB CLEAR TOTE ECB            S99528 54400000
         AQCTL                     POST ELEMENT TO OPERATOR CNTL S99528 54500000
*                                                                S99528 54600000
         WAIT  ECB=TOTOTECB                                      S99528 54700000
*                                                                S99528 54800000
CUSTLN10 DS    0H                                                S99528 54900000
         LM    R2,R12,CUREGSAV     RESTORE REGS ON EXIT FROM     S99528 55000000
*                                  START / STOP LINE ROUTINE     S99528 55100000
         BR    R3                  RETURN TO CALLER              S99528 55200000
CUSTLN11 DS    0H                                                S99528 55300000
         SR    R15,R15                 CLEAR REGISTER            S99528 55400000
         LA    R15,RETCODE4            LOAD RETURN CODE          S99528 55500000
         B     CUSTLN10                RETURN                    S99528 55600000
*                                                                S99528 55700000
         EJECT                                                   S99528 55800000
**************************************************************** S99528 55900000
*                                                              * S99528 56000000
*        WHEN CLEANING UP AFTER AN OLT TOTE WILL ENTER HERE    * S99528 56100000
*        TO RESTORE $CUTEST'ED DEVICES TO THE CONDITION THEY   * S99528 56200000
*        WERE IN WHEN THEY WERE OBTAINED.                      * S99528 56300000
*                                                              * S99528 56400000
**************************************************************** S99528 56500000
*                                                                S99528 56600000
CUP000   DS    0H                                                S99528 56700000
         NI    TOTCUFLG,HEXFF-TOTCUDON  TURN OFF CUTEST HAS BEEN S99528 56800000
*                                       DONE INDICATOR           S99528 56900000
         L     R5,TOTCUSAV         GET SAVED GETMAIN ADDRESS     S99528 56920000
         SR    R12,R12             CLEAR REGISTER                S99528 57100000
         LA    R12,LEN7            INSERT # OF CLEANUP ADDRS     S99528 57200000
         LR    R11,R5              PUT START ADDR IN WORK REG    S99528 57300000
         AR    R11,R12             ADD OFFSET TO END OF SAVE AREAS99528 57400000
*                                                                S99528 57500000
CUP001   DS    0H                                                S99528 57600000
         SR    R10,R10             CLEAR REGISTER                S99528 57700000
         IC    R10,CUCUUSED        SET UP TO TEST IF USED        S99528 57800000
         EX    R10,CUEXTM          TEST BIT                      S99528 57900000
         BZ    CUP008              NOT USED BYPASS THIS ADDR     S99528 58000000
*                                                                S99528 58100000
         XC    TOTCU#AD(LEN2),TOTCU#AD CLEAR # OF ADDRS FOR      S99528 58200000
*                                      CLEAN UP CALCULATIONS     S99528 58300000
         XC    TOTCUCUU(LEN3),TOTCUCUU CLEAR STARTING ADR OFFSET S99528 58400000
*                                      FOR CLEANUP CALCULATIONS  S99528 58500000
         B     CU009               GO CALCULATE UCB ADDRESS      S99528 58600000
*                                  AND CONTINUE RESTORING THIS   S99528 58700000
*                                  ADDRESS                       S99528 58800000
*                                                                S99528 58900000
CUP008   DS    0H                                                S99528 59000000
         BCT   R11,CUP009          DECREMENT TO NEXT BYTE SAVED  S99528 59100000
CUP009   DS    0H                                                S99528 59200000
         BCT   R12,CUP001          CONTINUE RESTORING            S99528 59300000
         L     R5,TOTCUSAV         PUT ADDR OF SAVE AREA IN REG  S99528 59400000
         ST    R5,CUGETSAV         STORE IN MACRO WORD           S99528 59500000
         XC    TOTCUFLG(LEN9),TOTCUFLG  CLEAR CUTEST DATA FROM   S99528 59600000
*                                       OLTCB                    S99528 59700000
*                                                                S99528 59800000
         LA    R5,CUGETSAV         ADDRESS CONTAINING GETMAIN  @Y17XAUU 59820000
*                                  AREA ADDRESS                @Y17XAUU 59840000
         FREEMAIN E,LV=256,A=(R5),MF=(E,PLIST) FREE SAVE AREA  @Y17XAUU 59860000
*                                                                S99528 60000000
         SR    R15,R15             CLEAR RETURN CODE REGISTER    S99528 60100000
         B     CU007A              ALL DONE RETURN               S99528 60200000
*                                                                S99528 60300000
         EJECT                                                          60400000
**************************************************************** S99528 60500000
*                                                              * S99528 60600000
*        CONSTANTS USED AS MASKS IN EXAMINING STATUS FIELD     * S99528 60700000
*                                                              * S99528 60800000
**************************************************************** S99528 60900000
*                                                                S99528 61000000
CUCUUSED DC    XL1'80'      IF ON: SUB-CHANNEL USED IN CUTEST    S99528 61100000
CUCUOFFL DC    XL1'40'      IF ON: OFFLINE TO OS                 S99528 61200000
CUCUTCAM DC    XL1'20'      IF ON: LINE ALLOCATED TO TCAM        S99528 61300000
CUCUSTRT DC    XL1'10'      IF ON: LINE WAS STARTED              S99528 61400000
CUCUNHLD DC    XL1'08'      IF ON: QUEUE WAS NOT HELD            S99528 61500000
CUCUPOLL DC    XL1'04'      IF ON: SPECIFIC POLL WAS ACTIVE      S99528 61600000
         DC    XL1'02'      RESERVED                             S99528 61700000
         DC    XL1'01'      RESERVED                             S99528 61800000
         DS    0F                                              @Y17XAUU 61850000
*                                                                S99528 61900000
QOTUCBAB DS    24C                 UCB COPY AREA COMMON SECTION@Y17XAUU 61909000
QOTUCBAC DC    H'24'               HALFWORD LENGTH FOR SUC 102 @Y17XAU2 61918000
QUCUU    DS    1H                  SAVE AREA FOR UCB NAME (HEX)@Y17XAUU 61927000
QUUCBADR DC    F'0'                ADDRESS OF UCB              @Y17XAUU 61936000
QUUCBNAM DS    3C                  NAME OF UCB IN EBCDIC       @Y17XAUU 61945000
QUUCBWRK DS    F                   UCB LOOK UP WORK AREA       @Y17XAUU 61954000
QUUCBSAV DS    1F                  POINTER TO UCB AREA         @Y17XAUU 61963000
QUREGSAV DS    11F                 REG SAVE AREA DURING START/ @Y17XAUU 61972000
*                                  STOP LINE CALCULATIONS      @Y17XAU2 61981000
QUGETSAV DS    1F                  ADDRESS OF GET MAIN AREA    @Y17XAUU 61990000
PATCH    DC    100C' '             PATCH AREA                   SA64769 63000000
CLEARHI  DC    X'0000FFFF'         USED TO CLEAR HI-ORDER BYTES@G36XRUV 63030010
TABLEEND DC    X'FFFF'             UCB TABLE END INDICATOR     @G36XRUV 63060010
         EJECT                                                          63100000
**************************************************************** S99528 63200000
*                                                              * S99528 63300000
*        THESE INSTRUCTIONS ARE USED BY EXECUTE COMMANDS       * S99528 63400000
*                                                              * S99528 63500000
**************************************************************** S99528 63600000
*                                                                S99528 63700000
CUEXTM   TM    START(R11),X'00'    TEST PROPER BIT               S99528 63800000
*                                                                S99528 63900000
CUEXOI   OI    START(R11),X'00'    SET PROPER BIT                S99528 64000000
*                                                                S99528 64100000
CUEXNI   NI    START(R11),X'00'    CLEAR PROPER BIT              S99528 64200000
*                                                                S99528 64300000
         EJECT                                                          64400000
*************** START OF FIXED AREA ***************************@Y17XAUU 64500000
*                                                              * S99528 64600000
*        MACRO  LISTS  FOR  MULTIPLE  USE                      * S99528 64700000
*                                                              * S99528 64800000
**************************************************************** S99528 64900000
QUENQLST ENQ (QQNAME,QRNAME,E,8,STEP),RET=USE,MF=L             @Y17XAUU 64920000
*                                  ESTABLISH FULLWORD BNDRY    @Y17XAU2 64940000
QQNAME   DC    CL8'SYSZTOTE'       NAME FOR ENQ MACRO          @Y17XAUU 64950000
QRNAME   DC    8CL1' '             RESOURCE TO BE ENQ'ED       @Y17XAU2 64980000
         SPACE 2                                                        65300000
**************************************************************** S99528 66600000
*                                                              * S99528 66700000
*        PARAMETER LIST AREA FOR SVC 102 DATA MOVE             * S99528 66800000
*                                                              * S99528 66900000
**************************************************************** S99528 67000000
*                                                                S99528 67100000
QOT102   DS    0F                  ALIGN ON FULL WORD            S99528 67150000
         DC    X'08'               FLAG FOR DATA MOVE            S99528 67300000
         DC    AL3(0)              DATA ADDRESS                @Y17XAUU 67400000
         DC    X'00'               2ND WORD FLAGS                S99528 67500000
QOT102A  DC    AL3(0)              TARGET ADDRESS (DYNAMIC)      S99528 67550000
         DC    X'80'               LAST WORD FLAG                S99528 67700000
         DC    AL3(0)              ADDRESS CONTAINING LENGTH   @Y17XAUU 67800000
**************** END OF FIXED AREA *************************** @Y17XAUU 67900000
         EJECT                                                          68000000
**************************************************************** S99528 68100000
*                                                              * S99528 68200000
*        EQUATED OFFSETS AND/OR LENGTHS                        * S99528 68300000
*                                                              * S99528 68400000
**************************************************************** S99528 68500000
START    EQU   0                   OFFSET FOR START OF FIELD     S99528 68600000
FSTBYTE  EQU   0                   OFFSET TO 1 ST BYTE OF FIELD  S99528 68700000
SNDBYTE  EQU   1                   OFFSET TO 2 ND BYTE OF FIELD  S99528 68800000
TRDBYTE  EQU   2                   OFFSET TO 3 RD BYTE OF FIELD  S99528 68900000
FORBYTE  EQU   3                   OFFSET TO 4 TH BYTE OF FIELD  S99528 69000000
ZROWORD  EQU   0                   OFFSET TO 1 ST WORD OF FIELD  S99528 69100000
FSTWORD  EQU   4                   OFFSET TO 2 ND WORD OF FIELD  S99528 69200000
SNDWORD  EQU   8                   OFFSET TO 3 RD WORD OF FIELD  S99528 69300000
TRDWORD  EQU   12                  OFFSET TO 4 TH WORD OF FIELD  S99528 69400000
FORWORD  EQU   16                  OFFSET TO 5 TH WORD OF FIELD  S99528 69500000
FIFWORD  EQU   20                  OFFSET TO 6 TH WORD OF FIELD  S99528 69600000
SIXWORD  EQU   24                  OFFSET TO 7 TH WORD OF FIELD  S99528 69700000
SVNWORD  EQU   28                  OFFSET TO 8 TH WORD OF FIELD  S99528 69800000
ETHWORD  EQU   32                  OFFSET TO 9 TH WORD OF FIELD  S99528 69900000
*                                                                S99528 70000000
TCAMDEB  EQU   X'40'               INDICATES DEB IS TCAMS        S99528 70100000
CUCOMMUN EQU   X'40'               UCB DEVICE CLASS = COMMUNICAT S99528 70200000
CUGRAPH  EQU   X'10'               UCB DEVICE CLASS = GRAPHICS   S99528 70300000
CUDUMMY  EQU   X'00'               UCB DEVICE CLASS = DUMMY      S21903 70400000
*                                                                S99528 70500000
LEN1     EQU   256                 LENGTH OF SAVE AREA           S99528 70600000
LEN2     EQU   1                   LENGTH OF # OF CONTIG ADDRS   S99528 70700000
LEN3     EQU   2                   LENGTH FOR COMPARE            S99528 70800000
LEN4     EQU   3                   LENGTH FOR MOVE               S99528 70900000
LEN5     EQU   4                   LENGTH FOR CLEAR              S99528 71000000
LEN6     EQU   24                  LENGTH FOR UCB MOVE           S99528 71100000
LEN7     EQU   X'FF'               # OF ADDRS TO CLEANUP         S99528 71200000
LEN8     EQU   8                   LENGTH TO CLEAR OLTCB OF      S99528 71300000
*                                  $CUTEST INFORMATION           S99528 71400000
LEN9     EQU   12                  LENGTH OF CUTEST CONTROL AREA S99528 71500000
*                                  IN OLTCB                      S99528 71600000
*                                                                S99528 71700000
RETCODE0 EQU   0                   RETURN CODE OF 0              S99528 71800000
RETCODE4 EQU   4                   RETURN CODE OF 4              S99528 71900000
RETCODE8 EQU   8                   RETURN CODE OF 8              S99528 72000000
RETCODEC EQU   12                  RETURN CODE OF X'0C'          S99528 72100000
*                                                                S99528 72200000
CURLNINT EQU   1                   INITIAL RELATIVE LINE NO      S99528 72300000
TOTELINE EQU   X'F1'               LINE IS ASSIGNED TO TOTE      S99528 72400000
NOTTOTE  EQU   X'00'               CLEAR LINE ASSIGNED TO TOTE   S99528 72500000
*                                                                S99528 72600000
CUCODE0  EQU   0            CODE 0 IN $CUTEST PARAMETER LIST     S99528 72700000
CUCODE1  EQU   1            CODE 1 IN $CUTEST PARAMETER LIST     S99528 72800000
CUCODE2  EQU   2            CODE 2 IN $CUTEST PARAMETER LIST     S99528 72900000
*                                                                S99528 73000000
CURESTOR EQU   1                   RESTORE VALUE USED IN OFFSET  S99528 73100000
*                                  CALCULATIONS                  S99528 73200000
*                                                                S99528 73300000
TUCBNALC EQU   X'04'               OR FIELD TO TURN ON UCBNALOC  S99528 73400000
TUCBNALF EQU   X'FB'               AND FIELD TO TURN OFF         S99528 73500000
*                                  UCBNALOC BIT IN UCB           S99528 73600000
TUCBNALO EQU   1                   OFFSET TO UCBNALOC FLAG       S99528 73700000
TUCBONE  EQU   1                   CONSTANT USED TO BUMP REGS    S99528 73800000
HEXFF    EQU   X'FF'               CONSTANT FOR CALCULATIONS     S99528 73900000
LEVEL2   EQU   X'02'               LEVEL 2 MACRO ID              S22024 74000000
OPCKEY   EQU   X'00'               OP CONTROL PARM LIST KEY      S22024 74100000
OPCPRI   EQU   X'DC'               OP CONTROL PRIORITY           S22024 74200000
OPCRTCD  EQU   X'00'               CLEAR OP CONTROL RET CODE FLD S22024 74300000
OPCELNG  EQU   X'18'               LENGTH OF OP CONTROL ELEMENT  S22024 74400000
LINESTRT EQU   X'40'               VERB CODE FOR START LINE      S22024 74500000
LINESTOP EQU   X'41'               VERB CODE FOR STOP LINE       S22024 74600000
TERMSTRT EQU   X'45'               VERB CODE FOR START TERMINAL  S22024 74700000
TERMSTOP EQU   X'47'               VERB CODE FOR STOP TERMINAL   S22024 74800000
START102 EQU   X'0C'               SVC 102 START FLAG            S22024 74900000
LAST102  EQU   X'80'               SVC 102 LAST WORD FLAG BYTE   S22024 75000000
D7       EQU   7                   CONSTANT DISPLACEMENT         S22024 75100000
BLANK    EQU   X'40'               BLANK CHARACTER               S22024 75200000
THREE    EQU   3                   CONSTANT THREE              @G36XRUV 75250010
         EJECT                                                          75300000
UCB      DSECT                                                   S99528 75400000
         IEFUCBOB                                                S99528 75500000
         EJECT                                                          75600000
*                                                                S99528 75700000
CVT      DSECT                                                   S99528 75800000
         CVT                                                     S99528 75900000
         EJECT                                                          76000000
*                                                                S99528 76100000
         TAVTD                                                   S99528 76200000
         EJECT                                                          76300000
*                                                                S99528 76400000
DCBDSECT DCBD  DSORG=TX                                          S99528 76500000
         EJECT                                                          76600000
*                                                                S99528 76700000
         TLCBD                                                   S99528 76800000
         EJECT                                                          76900000
*                                                                S99528 77000000
TIOT     DSECT                                                   S99528 77100000
         IEFTIOT1                                                S99528 77200000
         EJECT                                                          77300000
*                                                                S99528 77400000
         OLTCB                                                   S21903 77500000
PLIST    DC    4F'0'               GETMAIN/FREEMAIN PLIST      @Y17XAUU 77500500
TBEG1    DS    0H                                              @Y17XAU2 77503000
TOTUCBAB DS    24C                 UCB COPY AREA COMMON SECTION@Y17XAU2 77506000
TOTUCBAC DC    H'24'               HALFWORD LENGTH FOR SUC 102 @Y17XAU2 77509000
CUCUU    DS    1H                  SAVE AREA FOR UCB NAME (HEX)@Y17XAU2 77512000
CUUCBADR DC    F'0'         ADDRESS OF UCB                     @Y17XAU2 77515000
CUUCBNAM DS    3C                  NAME OF UCB IN EBCDIC       @Y17XAU2 77518000
CUUCBWRK DS    1F                  WORK AREA FOR UCB LOOKUP    @Y17XAU2 77521000
CUUCBSAV DS    1F                  POINTER TO UCB AREA         @Y17XAU2 77524000
CUREGSAV DS    11F                 REG SAVE AREA DURING START/ @Y17XAU2 77527000
*                                  STOP LINE CALCULATIONS      @Y17XAU2 77530000
CUGETSAV DS    1F                  ADDRESS OF GET MAIN AREA    @Y17XAU2 77533000
TEND1    DS    0H                                              @Y17XAU2 77536000
TBEG2    DS    0H                                              @Y17XAU2 77539000
CUENQLST ENQ   (QNAME,RNAME,E,8,STEP),RET=USE,MF=L             @Y17XAU2 77542000
QNAME    DC    CL8'SYSZTOTE'       NAME FOR ENQ MACRO          @Y17XAU2 77543000
RNAME    DC    8CL1' '             RESOURCE TO BE ENQ'ED       @Y17XAU2 77548000
TOT102   DS    0F                  ALIGN ON FULLWORD           @Y17XAU2 77560000
         DC    X'08'               FLAG FOR DATA MOVE          @Y17XAU2 77563000
         DC    AL3(TOTUCBAB)       DATA ADDRESS                @Y17XAU2 77566000
         DC    X'00'               2ND WORD FLAGS              @Y17XAU2 77569000
TOT102A  DC    AL3(0)              TARGET ADDRESS (DYNAMIC)    @Y17XAU2 77572000
         DC    X'80'               LAST WORD FLAG              @Y17XAU2 77575000
         DC    AL3(TOTUCBAC)       ADDRESS CONTAINING LENGTH   @Y17XAU2 77578000
TEND2    DS    0H                                              @Y17XAU2 77581000
SLPL     DS    0F                 BOUNDARY ALLIGNMENT          @Y17XAUU 77581700
ELEM1    DS    F                  POINTER TO FIRST ELEMENT     @Y17XAUU 77582400
ELEM2    DS    F                  POINTER TO LAST ELEMENT      @Y17XAUU 77583100
         EJECT                                                 @Y17XAU2 77584000
RESPL    RESPL                                                 @Y17XAU2 77587000
         END                                                            77700000
./  ADD  SSI=80890600,NAME=IEDQWA1
         TITLE 'IEDQWA1 - TOTE INPUT DATA HANDLER                      *00001000
                        '                                               00002000
IEDQWA1  CSECT ,                                                01S0001 00003000
@PROLOG  STM   @14,@12,12(@13)                                  01S0001 00004000
         BALR  @12,0                                            01S0001 00005000
@PSTART  LA    @05,4095(,@12)                                   01S0001 00006000
         USING @PSTART,@12                                      01S0001 00007000
         USING @PSTART+4095,@05                                 01S0001 00008000
         ST    @13,@SA00001+4                                   01S0001 00009000
         LA    @14,@SA00001                                     01S0001 00010000
         ST    @14,8(,@13)                                      01S0001 00011000
         LR    @13,@14                                          01S0001 00012000
IEDQWA1  IEDHJN AFTERHJN,HJN                                            00013000
*   BACK13=BACKSAVE;                /* SAVE BACKWARD POINTER TO 02S0512 00014000
*                                      CALLER'S SAVE AREA - SEVERAL     00015000
*                                      ROUTINES CALLED BY IEDQWA1       00016000
*                                      DESTROY THIS IN SAVEAREA 02S0512 00017000
*                                                            @YM07336*/ 00018000
         L     @14,BACKSAVE(,RSAVE)                             02S0512 00019000
         ST    @14,BACK13                                       02S0512 00020000
*   RRESPL=RPARM;                   /* TOTE RESPL BASE               */ 00021000
         LR    RRESPL,RPARM                                     02S0513 00022000
*   FLAGS=''B;                      /* INIT MODULE CONTROL FLAGS     */ 00023000
         MVI   FLAGS,X'00'                                      02S0514 00024000
*   RTNCODE=''B;                    /* INIT MODULE RETURN CODE AS       00025000
*                                      GOOD RETURN                   */ 00026000
         SLR   @14,@14                                          02S0515 00027000
         STC   @14,RTNCODE                                      02S0515 00028000
*                                                               02S0516 00029000
*   /*****************************************************************/ 00030000
*   /*                                                               */ 00031000
*   /* PROCESS: THIS SEGMENT PERFORMS THE MODULE FUNCTION            */ 00032000
*   /*                                                               */ 00033000
*   /*****************************************************************/ 00034000
*                                                               02S0516 00035000
*   GEN REFS(PSALITA,FLC);                                      02S0516 00036000
*                                                          /*@G36XRUV*/ 00037000
*                                          /*                  @G36XRUV 00038000
         MODESET MODE=SUP              SET TO SUPERVISOR MODE  @G36XRUV 00039000
         MODESET EXTKEY=SUPR           SET TO KEY ZERO         @G36XRUV 00040000
SETATSK  DS    0H                                              @G36XRUV 00041000
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,REGS=USE,       @G36XRUVC00042000
               RELATED=ATTACHED-TASKS-IGG019RO(SETATSK)        @G36XRUV 00043000
*   RPREFIX=AVTOLTCH;               /* POINT TO FIRST ELMT OF TOTE      00044000
*                                      QCB                   @YM07728*/ 00045000
         L     RPREFIX,AVTOLTCH-1(,RAVT)                        02S0517 00046000
         LA    RPREFIX,0(,RPREFIX)                              02S0517 00047000
*   AVTOLTCH=RPREFIX->PRFLINK;      /* DEQUEUE FIRST ELEMENT @YM07728*/ 00048000
         MVC   AVTOLTCH(3,RAVT),PRFLINK(RPREFIX)                02S0518 00049000
*   GEN REFS(PSALITA,FLC);                                      02S0519 00050000
*                                   /*                       @G36XRUV*/ 00051000
*                                   /*                         @G36XRUV 00052000
         SETLOCK RELEASE,TYPE=LOCAL,REGS=USE,                  @G36XRUVC00053000
               RELATED=ATTACHED-TASKS-IEDQWA1(SETATSK)         @G36XRUV 00054000
         MODESET EXTKEY=TCAM      SET TO TCAM'S KEY            @G36XRUV 00055000
         MODESET MODE=PROB        SET TO PROBLEM MODE          @G36XRUV 00056000
*   IF PRFPRI=PRITOTCL&PRFPRI=PRIONLT THEN/* IF THIS IS MH INPUT   */ 00057000
         CLI   PRFPRI(RPREFIX),X'E8'                            02S0520 00058000
         BE    @RF00520                                         02S0520 00059000
         CLI   PRFPRI(RPREFIX),X'DC'                            02S0520 00060000
         BE    @RF00520                                         02S0520 00061000
*     DO;                           /* PROCESS MH INPUT TO SET PRFKEY*/ 00062000
*                                                               03S0522 00063000
*       /*************************************************************/ 00064000
*       /*                                                           */ 00065000
*       /* PROCESS.MHPROC: THIS SEGMENT PROCESSES A BUFFER WHICH HAS */ 00066000
*       /* GONE THROUGH MESSAGE HANDLER PROCESSING PRIOR TO BEING    */ 00067000
*       /* POSTED TO TOTE. THE POSSIBLE CONTENTS OF THIS BUFFER      */ 00068000
*       /* INCLUDE SNA TEST REQUEST MESSAGES AND SNA TOTE INPUT      */ 00069000
*       /* (CECOM REPLIES AND TEST DATA) FROM THE INBOUND SIDE OF THE*/ 00070000
*       /* SSCP AND TOTE MH'S RESPECTIVELY, AND THE ERRORMSG ELEMENT */ 00071000
*       /* GENERATED BY THE ERRORMSG EXIT IN THE TOTE MH. RPREFIX    */ 00072000
*       /* POINTS TO THE BUFFER, PRFSCAN CONTAINS THE OFFSET TO THE  */ 00073000
*       /* BEGINNING OF DATA                                         */ 00074000
*       /*                                                           */ 00075000
*       /*************************************************************/ 00076000
*                                                               03S0522 00077000
*       RPARM=PRFSCAN;              /* OBTAIN PRFSCAN        @YM07765*/ 00078000
         LH    RPARM,PRFSCAN(,RPREFIX)                          03S0522 00079000
*       SRL(RPARM,8);               /* SHIFT SCAN TO LOW ORDER BYTE     00080000
*                                                            @YM07765*/ 00081000
         SRL   RPARM,8                                          03S0523 00082000
*       PRFSCAN=RPARM;              /* STORE BACK IN PRFSCAN @YM07765*/ 00083000
         STH   RPARM,PRFSCAN(,RPREFIX)                          03S0524 00084000
*       IF PRFERMGN=ON THEN         /* IF THIS IS ERROR MESSAGE 03S0525 00085000
*                                      ELEMENT                       */ 00086000
         TM    PRFERMGN(RPREFIX),B'01000000'                    03S0525 00087000
         BNO   @RF00525                                         03S0525 00088000
*         IF ERRTEST=ON THEN        /* IF RESOURCE IS SNA TEST DEVICE*/ 00089000
         LA    @14,PRFSUNIT(,RPREFIX)                           03S0526 00090000
         LH    @10,PRFSCAN(,RPREFIX)                            03S0526 00091000
         ALR   @14,@10                                          03S0526 00092000
         TM    ERRTEST(@14),B'01000000'                         03S0526 00093000
         BNO   @RF00526                                         03S0526 00094000
*           PRFKEY=PRFSNAT;         /* SET SNA TEST DATA INDICATOR   */ 00095000
         MVI   PRFKEY(RPREFIX),X'28'                            03S0527 00096000
*         ELSE                      /* ELEMENT FOR CTL TERM OR ALT      00097000
*                                      PRTR                          */ 00098000
*           IF ERRSNA=ON&ERRRQREJ=ON&/* IF SNA DEVICE, REQUEST REJECT*/ 00099000
*               (ERRSNS=SNSIVREQ|ERRSNS=SNSNRSCE|ERRSNS=SNSRCXMT) THEN  00100000
         B     @RC00526                                         03S0528 00101000
@RF00526 LA    @14,PRFSUNIT(,RPREFIX)                           03S0528 00102000
         AH    @14,PRFSCAN(,RPREFIX)                            03S0528 00103000
         TM    ERRSNA(@14),B'10000000'                          03S0528 00104000
         BNO   @RF00528                                         03S0528 00105000
         TM    ERRRQREJ(@14),B'00000100'                        03S0528 00106000
         BNO   @RF00528                                         03S0528 00107000
         CLI   ERRSNS(@14),X'02'                                03S0528 00108000
         BE    @RT00528                                         03S0528 00109000
         CLI   ERRSNS(@14),X'12'                                03S0528 00110000
         BE    @RT00528                                         03S0528 00111000
         CLI   ERRSNS(@14),X'1B'                                03S0528 00112000
         BNE   @RF00528                                         03S0528 00113000
@RT00528 DS    0H                                               03S0529 00114000
*                                   /* IF TEMPORARY ERROR    @YM09016*/ 00115000
*             DO;                   /* NO ACTION NECESSARY - RETURN     00116000
*                                      BUF                           */ 00117000
*               PRFKEY=''B;         /* CLEAR                         */ 00118000
         MVI   PRFKEY(RPREFIX),X'00'                            03S0530 00119000
*               CALL RTNBUF;                                    03S0531 00120000
         BAL   @14,RTNBUF                                       03S0531 00121000
*             END;                  /* END OF TEMPORARY PROBLEM      */ 00122000
*           ELSE                    /* SEVERE ERROR ON OUTPUT TO        00123000
*                                      CT/AP                         */ 00124000
*             DO;                   /* SET PRFKEY AND PRINT MESSAGE  */ 00125000
         B     @RC00528                                         03S0533 00126000
@RF00528 DS    0H                                               03S0534 00127000
*               PRFKEY=PRFDEVFL;    /* SET DEVICE FAILURE INDICATOR  */ 00128000
         MVI   PRFKEY(RPREFIX),X'F0'                            03S0534 00129000
*               CALL DEVFLMSG;      /* PRINT MESSAGE                 */ 00130000
         BAL   @14,DEVFLMSG                                     03S0535 00131000
*             END;                  /* END OF SEVERE CT/AP PROBLEM      00132000
*                                      HDLG                          */ 00133000
*       ELSE                        /* INBOUND DATA FROM SNA DEVICE  */ 00134000
*         DO;                       /* MAY BE CECOM REPLY OR TEST       00135000
*                                      DATA                          */ 00136000
         B     @RC00525                                         03S0537 00137000
@RF00525 DS    0H                                               03S0538 00138000
*           RPARM=PRFSRCE;          /* OBTAIN TTCIN OF RESOURCE AND  */ 00139000
         LH    RPARM,PRFSRCE(,RPREFIX)                          03S0538 00140000
*           CALL IEDQTNT;           /* GET TTE ADDR                  */ 00141000
         L     @15,AVTRNMPT(,RAVT)                              03S0539 00142000
         BALR  @14,@15                                          03S0539 00143000
*           RTRM=RPARM;             /* TTE BASE                      */ 00144000
         LR    RTRM,RPARM                                       03S0540 00145000
*           IF TRMTDIFF=ON&PRFDEST=SAVTSCPT THEN/* IF TEST DATA        00146000
*                                                            @YM08575*/ 00147000
         LR    @14,RTRM                                         03S0541 00148000
         AL    @14,@CF03300                                     03S0541 00149000
         TM    TRMTDIFF-1(@14),B'00010000'                      03S0541 00150000
         BNO   @RF00541                                         03S0541 00151000
         L     @14,AVTSAVTP(,RAVT)                              03S0541 00152000
         LH    @14,SAVTSCPT(,@14)                               03S0541 00153000
         N     @14,@CF03301                                     03S0541 00154000
         CH    @14,PRFDEST(,RPREFIX)                            03S0541 00155000
         BE    @RF00541                                         03S0541 00156000
*             DO;                                               03S0542 00157000
*               PRFKEY=PRFSNAT;     /* INDICATOR                     */ 00158000
         MVI   PRFKEY(RPREFIX),X'28'                            03S0543 00159000
*               IF(PRFSIZE-PRFSCAN)=1&RUBYTE1='00'X THEN/* FORMAT FOR   00160000
*                                      NULL RU                       */ 00161000
         LH    @14,PRFSCAN(,RPREFIX)                            03S0544 00162000
         LH    @10,PRFSIZE(,RPREFIX)                            03S0544 00163000
         SLR   @10,@14                                          03S0544 00164000
         C     @10,@CF00063                                     03S0544 00165000
         BNE   @RF00544                                         03S0544 00166000
         LA    @10,PRFSUNIT(,RPREFIX)                           03S0544 00167000
         ALR   @10,@14                                          03S0544 00168000
         CLI   RUBYTE1(@10),X'00'                               03S0544 00169000
         BNE   @RF00544                                         03S0544 00170000
*                 PRFSIZE=PRFSCAN;  /* SET AS NULL RU FOR RECEIVE MOD*/ 00171000
         STH   @14,PRFSIZE(,RPREFIX)                            03S0545 00172000
*               ELSE                                            03S0546 00173000
*                 ;                                             03S0546 00174000
@RF00544 DS    0H                                               03S0547 00175000
*             END;                                              03S0547 00176000
*           ELSE                    /* MUST BE CECOM REPLY           */ 00177000
*             IF PRFNHDRN=OFF THEN  /* IF THIS IS A HEADER BUFFER    */ 00178000
         B     @RC00541                                         03S0548 00179000
@RF00541 TM    PRFNHDRN(RPREFIX),B'00000001'                    03S0548 00180000
         BNZ   @RF00548                                         03S0548 00181000
*               PRFKEY=PRFSNACE;    /* SET INDICATOR FOR CE REPLY FOR   00182000
*                                      SNA RESOURCE (NO PLCB)        */ 00183000
         MVI   PRFKEY(RPREFIX),X'1C'                            03S0549 00184000
*             ELSE                  /* TEXT BUFFER, ALL CE MSGS ARE  */ 00185000
*               DO;                 /* RESTICTED TO 1 BUFFER, IGNORE */ 00186000
         B     @RC00548                                         03S0550 00187000
@RF00548 DS    0H                                               03S0551 00188000
*                 PRFKEY=''B;       /* CLEAR FOR CALL TO RTNBUF      */ 00189000
         MVI   PRFKEY(RPREFIX),X'00'                            03S0551 00190000
*                 CALL RTNBUF;      /* RETURN BUFFER TO TCAM         */ 00191000
         BAL   @14,RTNBUF                                       03S0552 00192000
*               END;                /* END OF TEXT BUFFER HANDLING   */ 00193000
*         END;                      /* END OF INBOUND SNA DATA  03S0554 00194000
*                                      HANDLING                      */ 00195000
*     END;                          /* END OF MH INPUT PROCESSING    */ 00196000
*   ELSE                            /* NOT INPUT FROM SSCP OR TOTE MH*/ 00197000
*     IF PRFKEY=PRFSRTMH THEN       /* IF FROM STARTMH MODULE        */ 00198000
         B     @RC00520                                         02S0556 00199000
@RF00520 CLI   PRFKEY(RPREFIX),X'04'                            02S0556 00200000
         BNE   @RF00556                                         02S0556 00201000
*       DO;                         /* SET PRFKEY AND SET LCB        */ 00202000
*                                                               03S0558 00203000
*         /***********************************************************/ 00204000
*         /*                                                         */ 00205000
*         /* PROCESS.STARTMH: THIS SEGMENT PROCESSES BUFFERS POSTED  */ 00206000
*         /* TO TOTE FROM THE STARTMH MODULE (IEDQAA). THESE BUFFERS */ 00207000
*         /* CONTAIN CEINPUT FROM START-STOP AND BI-SYNCH TERMINALS. */ 00208000
*         /* ONLY THE FIRST BUFFER OF THE MESSAGE IS ASSUMED TO HAVE */ 00209000
*         /* VALID INPUT, ALL OTHERS ARE RETURNED TO TCAM. PRFKEY IS */ 00210000
*         /* SET IN THE VALID BUFFERS.                               */ 00211000
*         /*                                                         */ 00212000
*         /***********************************************************/ 00213000
*                                                               03S0558 00214000
*         RFY                                                   03S0558 00215000
*           IEDQLCB BASED(PRFLCB);  /* BASE LCB ON BUF PREFIX FIELD  */ 00216000
*         IF PRFNHDRN=OFF THEN      /* IF THIS IS A HEADER BUFFER    */ 00217000
         TM    PRFNHDRN(RPREFIX),B'00000001'                    03S0559 00218000
         BNZ   @RF00559                                         03S0559 00219000
*           DO;                     /* THIS IS A VALID BUFFER        */ 00220000
*             IF PRFNLSTN=OFF THEN  /* IF LAST BUF IN MSG            */ 00221000
         TM    PRFNLSTN(RPREFIX),B'00000010'                    03S0561 00222000
         BNZ   @RF00561                                         03S0561 00223000
*               DO;                 /* TREAT AS HEADER LAST          */ 00224000
*                 IF LCBSYNC=OFF THEN/* IF START STOP DEVICE         */ 00225000
         L     @14,PRFLCB-1(,RPREFIX)                           03S0563 00226000
         TM    LCBSYNC(@14),B'00000100'                         03S0563 00227000
         BNZ   @RF00563                                         03S0563 00228000
*                   PRFKEY=PRFSS;   /* SET PRFKEY                    */ 00229000
         MVI   PRFKEY(RPREFIX),X'08'                            03S0564 00230000
*                 ELSE                                          03S0565 00231000
*                   ;               /* PRFKEY ALREADY SET FOR BSC    */ 00232000
@RF00563 DS    0H                                               03S0566 00233000
*                 LCBOLT=OFF;       /* RESET OLT BIT FOR NEXT I/O    */ 00234000
         L     @14,PRFLCB-1(,RPREFIX)                           03S0566 00235000
         NI    LCBOLT(@14),B'11111110'                          03S0566 00236000
*               END;                /* END OF HEADER LAST PROCESSING */ 00237000
*             ELSE                  /* HEADER,NOT LAST               */ 00238000
*               PRFKEY=PRFMULT;     /* SET MULTIPLE BUFFERED INPUT   */ 00239000
         B     @RC00561                                         03S0568 00240000
@RF00561 MVI   PRFKEY(RPREFIX),X'14'                            03S0568 00241000
*             LCBTSTSW=AVTEFF;      /* RESET                         */ 00242000
@RC00561 L     @14,PRFLCB-1(,RPREFIX)                           03S0569 00243000
         LA    @14,0(,@14)                                      03S0569 00244000
         MVI   LCBTSTSW(@14),X'FF'                              03S0569 00245000
*             LCBNEGRP=ON;          /* NEG RESP POLL                 */ 00246000
         OI    LCBNEGRP(@14),B'00001000'                        03S0570 00247000
*           END;                    /* END HEADER BUFFER HANDLING    */ 00248000
*         ELSE                      /* NOT HEADER BUFFER             */ 00249000
*           IF PRFNLSTN=ON THEN     /* IF NOT LAST BUFFER            */ 00250000
         B     @RC00559                                         03S0572 00251000
@RF00559 TM    PRFNLSTN(RPREFIX),B'00000010'                    03S0572 00252000
         BNO   @RF00572                                         03S0572 00253000
*             DO;                   /* RETURN BUFFER BUT NOT LCB     */ 00254000
*               PRFKEY=''B;         /* CLEAR TO INDICATE NO LCB      */ 00255000
         MVI   PRFKEY(RPREFIX),X'00'                            03S0574 00256000
*               CALL RTNBUF;        /* RETURN BUFFER                 */ 00257000
         BAL   @14,RTNBUF                                       03S0575 00258000
*             END;                  /* END FIRST,LAST BUF HANDLING */ 00259000
*           ELSE                    /* LAST BUFFER IN MESSAGE        */ 00260000
*             DO;                   /* RETURN BUFFER AND LCB TO TCAM */ 00261000
         B     @RC00572                                         03S0577 00262000
@RF00572 DS    0H                                               03S0578 00263000
*               LCBOLT=OFF;         /* RESET OLT INDICATOR           */ 00264000
         L     @14,PRFLCB-1(,RPREFIX)                           03S0578 00265000
         NI    LCBOLT(@14),B'11111110'                          03S0578 00266000
*               CALL RTNBUF;        /* RETURN BUFFER AND LCB         */ 00267000
         BAL   @14,RTNBUF                                       03S0579 00268000
*             END;                  /* END OF LAST BUF HANDLING      */ 00269000
*         RFY                                                   03S0581 00270000
*           IEDQLCB BASED;          /* SET AS ON ENTRY TO SEGMENT    */ 00271000
@RC00572 DS    0H                                               03S0581 00272000
@RC00559 DS    0H                                               03S0582 00273000
*       END;                        /* END OF STARTMH PROCESSING     */ 00274000
*     ELSE                                                      02S0583 00275000
*       ;                           /* PRFKEY ALREADY SET CORRECTLY  */ 00276000
@RF00556 DS    0H                                               02S0584 00277000
*   IF BUFRTFLG=ON THEN                                         02S0584 00278000
@RC00520 TM    BUFRTFLG,B'00001000'                             02S0584 00279000
         BO    @RT00584                                         02S0584 00280000
*     ;                             /* IF BUFFER RETURNED - NO MORE     00281000
*                                      PROCESSING                    */ 00282000
*   ELSE                                                        02S0586 00283000
*     IF PRFKEY<PRFCEIN THEN        /* IF THIS IS CE INPUT           */ 00284000
         CLI   PRFKEY(RPREFIX),X'20'                            02S0586 00285000
         BNL   @RF00586                                         02S0586 00286000
*       DO;                                                     02S0587 00287000
*                                                               03S0588 00288000
*         /***********************************************************/ 00289000
*         /*                                                         */ 00290000
*         /* PROCESS.CEINPUT: THIS SEGMENT PROCESSES SINGLE BUFFERS  */ 00291000
*         /* WITH CE INPUT. IF THE INPUT IS TO BE PASSED TO OTHER    */ 00292000
*         /* TOTE MODULES, PRFSCAN IS UPDATED TO POINT PAST OLT      */ 00293000
*         /* HEADER.                                                 */ 00294000
*         /*                                                         */ 00295000
*         /***********************************************************/ 00296000
*                                                               03S0588 00297000
*         IF PRFKEY=PRFSS|PRFKEY=PRFBSC|PRFKEY=PRFMULT THEN/* IF        00298000
*                                      PRE-SNA                       */ 00299000
         CLI   PRFKEY(RPREFIX),X'08'                            03S0588 00300000
         BE    @RT00588                                         03S0588 00301000
         CLI   PRFKEY(RPREFIX),X'04'                            03S0588 00302000
         BE    @RT00588                                         03S0588 00303000
         CLI   PRFKEY(RPREFIX),X'14'                            03S0588 00304000
         BNE   @RF00588                                         03S0588 00305000
@RT00588 DS    0H                                               03S0589 00306000
*           DO;                     /* RESET ERROR LOCK IF 3705 TERM */ 00307000
*             RPARM=PRFSRCE;        /* TTCIN OF RESOURCE             */ 00308000
         LH    RPARM,PRFSRCE(,RPREFIX)                          03S0590 00309000
*             CALL IEDQTNT;         /* CONVERT TO TTE ADDR           */ 00310000
         L     @15,AVTRNMPT(,RAVT)                              03S0591 00311000
         BALR  @14,@15                                          03S0591 00312000
*             RTRM=RPARM;           /* TTE BASE                      */ 00313000
         LR    RTRM,RPARM                                       03S0592 00314000
*             IF TRMPREF=ON THEN    /* IF 3705 RESOURCE              */ 00315000
         TM    TRMPREF(RTRM),B'00010000'                        03S0593 00316000
         BNO   @RF00593                                         03S0593 00317000
*               TRMERLCK=ON;        /* SET ERROR LOCK IN TTE         */ 00318000
         LR    @14,RTRM                                         03S0594 00319000
         AL    @14,@CF03304                                     03S0594 00320000
         OI    TRMERLCK(@14),B'00000100'                        03S0594 00321000
*             ELSE                                              03S0595 00322000
*               ;                   /* NO ERROR LOCK FOR 270X        */ 00323000
@RF00593 DS    0H                                               03S0596 00324000
*           END;                    /* END OF ERROR LOCK PROCESSING  */ 00325000
*         ELSE                                                  03S0597 00326000
*           ;                                                   03S0597 00327000
@RF00588 DS    0H                                               03S0598 00328000
*                                                               04S0598 00329000
*         /***********************************************************/ 00330000
*         /*                                                         */ 00331000
*         /* PROCESS.CEINPUT.XLATE: THIS SEGMENT TRANSLATES DATA INTO*/ 00332000
*         /* EBCDIC. THE XLATEFLG SET INDICATES THAT THE DATA IS IN  */ 00333000
*         /* EBCDIC.                                                 */ 00334000
*         /*                                                         */ 00335000
*         /***********************************************************/ 00336000
*                                                               04S0598 00337000
*         RFY                                                   04S0598 00338000
*           IEDQLCB BASED(PRFLCB);  /* BASE LCB ON PTR IN BUF PREFIX */ 00339000
*         RFY                                                   04S0599 00340000
*           IHADCB BASED(LCBDCBPT); /* BASE DCB ON PTR IN LCB        */ 00341000
*         IF PRFKEY=PRFSNACE&PRFKEY=PRFSYS&PRFKEY=PRFOPCTL THEN/*    00342000
*                                      IF NOT ALREADY EBCDIC         */ 00343000
         CLI   PRFKEY(RPREFIX),X'1C'                            04S0600 00344000
         BE    @RF00600                                         04S0600 00345000
         CLI   PRFKEY(RPREFIX),X'0C'                            04S0600 00346000
         BE    @RF00600                                         04S0600 00347000
         CLI   PRFKEY(RPREFIX),X'10'                            04S0600 00348000
         BE    @RF00600                                         04S0600 00349000
*           DO;                                                 04S0601 00350000
*             TABLPTR=DCBTRANS;     /* POINTER TO TRANS TABLE        */ 00351000
         L     @14,PRFLCB-1(,RPREFIX)                           04S0602 00352000
         L     @14,LCBDCBPT(,@14)                               04S0602 00353000
         L     TABLPTR,DCBTRANS+31(,@14)                        04S0602 00354000
         LA    TABLPTR,0(,TABLPTR)                              04S0602 00355000
*             IF XLATEWD1=0 THEN   /* IF NOT ALREADY EBCDIC         */ 00356000
         L     @14,XLATEWD1(,TABLPTR)                           04S0603 00357000
         LTR   @14,@14                                          04S0603 00358000
         BZ    @RF00603                                         04S0603 00359000
*               DO;                                             04S0604 00360000
*                 DATAPTR=ADDR(PRFSUNIT)+PRFSCAN;/* POINT TO FIRST      00361000
*                                      DATA BYTE                     */ 00362000
         LA    @14,PRFSUNIT(,RPREFIX)                           04S0605 00363000
         AH    @14,PRFSCAN(,RPREFIX)                            04S0605 00364000
         ST    @14,DATAPTR                                      04S0605 00365000
*                 IF XLATETYP=TABPTS THEN/* IF THIS IS A TABLE OF       00366000
*                                      PTRS                          */ 00367000
         CLI   XLATETYP(TABLPTR),X'80'                          04S0606 00368000
         BNE   @RF00606                                         04S0606 00369000
*                   DO;                                         04S0607 00370000
*                     RFY                                       04S0608 00371000
*                       XTABLE BASED(XTABPT);/* BASE ON POINTER IN      00372000
*                                      TABLE                         */ 00373000
*                     IEDPLMV=''B;  /* SET UP PARAMETER LIST FOR MOVE*/ 00374000
         LA    @07,PARMLSP                                      04S0609 00375000
         XC    IEDPLMV(24,@07),IEDPLMV(@07)                     04S0609 00376000
*                     PLMVSU=RPREFIX;/* BUFFER ADDR                  */ 00377000
         ST    RPREFIX,PLMVSU(,@07)                             04S0610 00378000
*                     PLMVSD=DATAPTR;/* SOURCE DATA                  */ 00379000
         ST    @14,PLMVSD(,@07)                                 04S0611 00380000
*                     PLMVTU=ADDR(WORKAREA);/* TARGET                */ 00381000
         LA    @14,WORKAREA                                     04S0612 00382000
         ST    @14,PLMVTU(,@07)                                 04S0612 00383000
*                     PLMVTD=PLMVTU;/* TARGET                        */ 00384000
         ST    @14,PLMVTD(,@07)                                 04S0613 00385000
*                     PLMVLNTH=5;   /* MOVE 5 BYTES, MAX HDR LENGTH  */ 00386000
         MVC   PLMVLNTH(2,@07),@CH00033                         04S0614 00387000
*                     PLMVTCTG=ON;  /* SET TARGET CONTIGUOUS FLAG    */ 00388000
         OI    PLMVTCTG(@07),B'00100000'                        04S0615 00389000
*                     RPARM=ADDR(PARMLSP);/* ADDR OF PARM LIST       */ 00390000
         LR    RPARM,@07                                        04S0616 00391000
*                     CALL IEDMVBFR;/* MOVE DATA INTO WORKAREA       */ 00392000
         L     @15,AVTMVBFR(,RAVT)                              04S0617 00393000
         BALR  @14,@15                                          04S0617 00394000
*                     DO LOOPCTR=XLATECT TO 1 BY-1 WHILE(XLATEFLG=OFF); 00395000
         L     @14,XLATECT-1(,TABLPTR)                          04S0618 00396000
         LA    @14,0(,@14)                                      04S0618 00397000
         STH   @14,LOOPCTR                                      04S0618 00398000
         B     @DE00618                                         04S0618 00399000
@DL00618 TM    XLATEFLG,B'00010000'                             04S0618 00400000
         BNZ   @DC00618                                         04S0618 00401000
*                                   /* SET TO LOOP THRU TABLE        */ 00402000
*                       WRKAREA1(1:5)=WORKAREA(1:5);/* COPY MAX OLT     00403000
*                                      HEADER LEN            @YM07756*/ 00404000
         MVC   WRKAREA1(5),WORKAREA                             04S0619 00405000
*                       TR(WRKAREA1(1:5),XTABLE);/* TRANSLATE   04S0620 00406000
*                                                            @YM07756*/ 00407000
         L     @14,XTABPT(,TABLPTR)                             04S0620 00408000
         TR    WRKAREA1(5),XTABLE(@14)                          04S0620 00409000
*                       IF WRKAREA1(1:LENGTH(HDRSS))=HDRSS|/* IF        00410000
*                                      START-STOP HEADER             */ 00411000
*                           WRKAREA1(1:LENGTH(HDRBSC))=HDRBSC|/* IF     00412000
*                                      EP BSC HEADER         @YM07756*/ 00413000
*                           WRKAREA1(1:LENGTH(PERSLASH))=PERSLASH THEN  00414000
         CLC   WRKAREA1(5),@CC03076                             04S0621 00415000
         BE    @RT00621                                         04S0621 00416000
         CLC   WRKAREA1(3),HDRBSC                               04S0621 00417000
         BE    @RT00621                                         04S0621 00418000
         CLC   WRKAREA1(2),PERSLASH                             04S0621 00419000
         BNE   @RF00621                                         04S0621 00420000
@RT00621 DS    0H                                               04S0622 00421000
*                                   /* IF NCP BSC HEADER - NO SOH       00422000
*                                      CHARACTER             @YM07756*/ 00423000
*                         DO;       /* VALID XLATE TABLE FOUND       */ 00424000
*                           TABLPTR=XTABPT;/* SET POINTER TO XLATE      00425000
*                                      TABLE                         */ 00426000
         L     TABLPTR,XTABPT(,TABLPTR)                         04S0623 00427000
*                           XLATEFLG=ON;/* SET TRANSLATE FLAG        */ 00428000
         OI    XLATEFLG,B'00010000'                             04S0624 00429000
*                         END;                                  04S0625 00430000
*                       ELSE        /* NOT SUCCESSFUL TRANSLATE      */ 00431000
*                         TABLPTR=TABLPTR+LENGTH(XLATEWD1);/* POINT     00432000
*                                      TO NEXT XLATE TABLE           */ 00433000
         B     @RC00621                                         04S0626 00434000
@RF00621 AL    TABLPTR,@CF00256                                 04S0626 00435000
*                     END;                                      04S0627 00436000
@RC00621 SLR   @14,@14                                          04S0627 00437000
         BCTR  @14,0                                            04S0627 00438000
         AH    @14,LOOPCTR                                      04S0627 00439000
         STH   @14,LOOPCTR                                      04S0627 00440000
@DE00618 LTR   @14,@14                                          04S0627 00441000
         BP    @DL00618                                         04S0627 00442000
@DC00618 DS    0H                                               04S0628 00443000
*                     RFY                                       04S0628 00444000
*                       XTABLE BASED(TABLPTR);/* BASE FOR TRANS TABLE*/ 00445000
*                   END;                                        04S0629 00446000
*                 ELSE                                          04S0630 00447000
*                   DO;                                         04S0630 00448000
         B     @RC00606                                         04S0630 00449000
@RF00606 DS    0H                                               04S0631 00450000
*                     TABLPTR=TABLPTR+LENGTH(XLATEWD1);/* SET TO        00451000
*                                      START OF TABLE                */ 00452000
         AL    TABLPTR,@CF00256                                 04S0631 00453000
*                     XLATEFLG=ON;  /* SET TRANSLATE FLAG ON         */ 00454000
         OI    XLATEFLG,B'00010000'                             04S0632 00455000
*                   END;                                        04S0633 00456000
*                 IF XLATEFLG=ON THEN/* IF TRANSLATED                */ 00457000
@RC00606 TM    XLATEFLG,B'00010000'                             04S0634 00458000
         BNO   @RF00634                                         04S0634 00459000
*                   DO;                                         04S0635 00460000
*                     MSGPTR=RPREFIX;/* SAVE ADDR OF BUFFER          */ 00461000
         LR    MSGPTR,RPREFIX                                   04S0636 00462000
*                     TRANSLEN=AVTKEYLE-PRFSCAN;/* LENGTH OF TRANS      00463000
*                                      FOR 1ST UNIT                  */ 00464000
         LH    @14,AVTKEYLE(,RAVT)                              04S0637 00465000
         SH    @14,PRFSCAN(,RPREFIX)                            04S0637 00466000
         STH   @14,TRANSLEN                                     04S0637 00467000
*                     DO LOOPCTR=PRFNBUNT TO 1 BY-1;/* TRANSLATE ALL    00468000
*                                      UNITS IN BUFFER               */ 00469000
         SLR   @14,@14                                          04S0638 00470000
         IC    @14,PRFNBUNT(,RPREFIX)                           04S0638 00471000
         STH   @14,LOOPCTR                                      04S0638 00472000
         B     @DE00638                                         04S0638 00473000
@DL00638 DS    0H                                               04S0639 00474000
*                       TR(DATASTNG(1:TRANSLEN),XTABLE);/* TRANS UNIT*/ 00475000
         L     @07,DATAPTR                                      04S0639 00476000
         LH    @14,TRANSLEN                                     04S0639 00477000
         BCTR  @14,0                                            04S0639 00478000
         EX    @14,@SB03308                                     04S0639 00479000
*                       RPREFIX=PRFTIC;/* POINT TO NEXT UNIT         */ 00480000
         L     RPREFIX,PRFTIC(,RPREFIX)                         04S0640 00481000
*                       DATAPTR=ADDR(PRFSUNIT);/* START OF DATA      */ 00482000
         LA    @14,PRFSUNIT(,RPREFIX)                           04S0641 00483000
         ST    @14,DATAPTR                                      04S0641 00484000
*                       TRANSLEN=AVTKEYLE;/* LENGTH TO TRANSLATE     */ 00485000
         LH    @14,AVTKEYLE(,RAVT)                              04S0642 00486000
         STH   @14,TRANSLEN                                     04S0642 00487000
*                     END;                                      04S0643 00488000
         LH    @07,LOOPCTR                                      04S0643 00489000
         BCTR  @07,0                                            04S0643 00490000
         LR    @14,@07                                          04S0643 00491000
         STH   @14,LOOPCTR                                      04S0643 00492000
@DE00638 LTR   @14,@14                                          04S0643 00493000
         BP    @DL00638                                         04S0643 00494000
*                     RPREFIX=MSGPTR;/* SET PREFIX BASE BACK TO BEGIN*/ 00495000
         LR    RPREFIX,MSGPTR                                   04S0644 00496000
*                   END;                                        04S0645 00497000
*                 ELSE                                          04S0646 00498000
*                   DO;             /* CAN'T XLATE - PUT ON TRM Q FOR   00499000
*                                      LATER REJECTION               */ 00500000
         B     @RC00634                                         04S0646 00501000
@RF00634 DS    0H                                               04S0647 00502000
*                     RELMT=RPREFIX;/* COPY BUFFER ADDR              */ 00503000
         LR    RELMT,RPREFIX                                    04S0647 00504000
*                     PRFQCBA=ADDR(RESTRMQ);/* SET QCB ADDR          */ 00505000
         LA    @14,RESTRMQ(,RRESPL)                             04S0648 00506000
         STCM  @14,7,PRFQCBA(RPREFIX)                           04S0648 00507000
*                     RFY                                       04S0649 00508000
*                       REG03 RSTD; /* RETURN REG                    */ 00509000
*                     RBRNCH=RESADDND;/* ADDR OF ROUTINE     @YM07334*/ 00510000
         L     RBRNCH,RESADDND(,RRESPL)                         04S0650 00511000
*                     RFY                                       04S0651 00512000
*                       REG10 RSTD; /* RETURN REG            @YM07334*/ 00513000
*                     GEN SETS(REG10,RELMT,RPARM);              04S0652 00514000
*                                   /*CALL QUEUE HANDLER @YM07334*/     00515000
         BALR  REG10,RBRNCH           PLACE ON QUEUE                    00516000
*                     RFY                                       04S0653 00517000
*                       REG10 UNRSTD;/*                      @YM07334*/ 00518000
*                     RFY                                       04S0654 00519000
*                       REG03 UNRSTD;                           04S0654 00520000
*                     RPARM=RRESPL; /* ADDR OF RESIDENT PARM LIST    */ 00521000
         LR    RPARM,RRESPL                                     04S0655 00522000
*                     GEN;                                      04S0656 00523000
*                                   /*LINK TO RESOURCE MANAGER*/        00524000
        LINK  EP=IEDQWB                                                 00525000
*                     RTNCODE=REG15;/* SET RETURN CODE               */ 00526000
         STC   REG15,RTNCODE                                    04S0657 00527000
*                   END;                                        04S0658 00528000
*               END;                                            04S0659 00529000
*             ELSE                                              04S0660 00530000
*               XLATEFLG=ON;        /* SET TRANSLATE FLAG            */ 00531000
         B     @RC00603                                         04S0660 00532000
@RF00603 OI    XLATEFLG,B'00010000'                             04S0660 00533000
*           END;                                                04S0661 00534000
*         ELSE                                                  04S0662 00535000
*           XLATEFLG=ON;            /* SET TRANSLATE FLAG            */ 00536000
         B     @RC00600                                         04S0662 00537000
@RF00600 OI    XLATEFLG,B'00010000'                             04S0662 00538000
*         RFY                                                   04S0663 00539000
*           IEDQLCB BASED;          /* RESTORE AS AT START OF SEGMENT*/ 00540000
@RC00600 DS    0H                                               04S0664 00541000
*         RFY                                                   04S0664 00542000
*           IHADCB BASED;           /* RESTORE AS AT START OF SEGMENT*/ 00543000
*                                   /* INSURE EBCDIC DATA            */ 00544000
*         IF XLATEFLG=ON THEN       /* IF XLATE GOOD OR NOT NEEDED   */ 00545000
         TM    XLATEFLG,B'00010000'                             03S0665 00546000
         BNO   @RF00665                                         03S0665 00547000
*           DO;                                                 03S0666 00548000
*                                                               04S0667 00549000
*             /*******************************************************/ 00550000
*             /*                                                     */ 00551000
*             /* PROCESS.CEINPUT.MOVEMSG: THIS SEGMENT MOVES EITHER  */ 00552000
*             /* THE COMPLETE MESSAGE OR 40 BYTES, WHICH WHICHEVER IS*/ 00553000
*             /* LESS, INTO THE WORKAREA FOR EASIER HANDLING. THE 40 */ 00554000
*             /* BYTES IN AN ARBITRARY VALUE THAT SHOULD EASILY HOLD */ 00555000
*             /* ALL DATA OF INTEREST TO THIS ROUTINE.               */ 00556000
*             /*                                                     */ 00557000
*             /*******************************************************/ 00558000
*                                                               04S0667 00559000
*             WORKAREA=BLANK;       /* BLANK WORKAREA                */ 00560000
         MVI   WORKAREA+1,C' '                                  04S0667 00561000
         MVC   WORKAREA+2(38),WORKAREA+1                        04S0667 00562000
         MVI   WORKAREA,C' '                                    04S0667 00563000
*             IEDPLMV=''B;          /* INIT IEDMVBFR PARM LIST       */ 00564000
         LA    @14,PARMLSP                                      04S0668 00565000
         XC    IEDPLMV(24,@14),IEDPLMV(@14)                     04S0668 00566000
*             PLMVSU=RPREFIX;       /* SOURCE UNIT                   */ 00567000
         ST    RPREFIX,PLMVSU(,@14)                             04S0669 00568000
*             PLMVSD=ADDR(PRFSUNIT)+PRFSCAN;/* SOURCE DATA           */ 00569000
         LA    @10,PRFSUNIT(,RPREFIX)                           04S0670 00570000
         LH    @07,PRFSCAN(,RPREFIX)                            04S0670 00571000
         ALR   @10,@07                                          04S0670 00572000
         ST    @10,PLMVSD(,@14)                                 04S0670 00573000
*             PLMVTU=ADDR(WORKAREA);/* TARGET UNIT                   */ 00574000
         LA    @10,WORKAREA                                     04S0671 00575000
         ST    @10,PLMVTU(,@14)                                 04S0671 00576000
*             PLMVTD=PLMVTU;        /* TARGET DATA                   */ 00577000
         ST    @10,PLMVTD(,@14)                                 04S0672 00578000
*             PLMVTCTG=ON;          /* TARGET CONTIGUOUS FLAG        */ 00579000
         OI    PLMVTCTG(@14),B'00100000'                        04S0673 00580000
*             IF PRFSIZE>(PRFSCAN+40) THEN/* IF MESSAGE SIZE > 40       00581000
*                                                            @YM07414*/ 00582000
         LA    @10,40                                           04S0674 00583000
         ALR   @07,@10                                          04S0674 00584000
         CH    @07,PRFSIZE(,RPREFIX)                            04S0674 00585000
         BNL   @RF00674                                         04S0674 00586000
*               PLMVLNTH=40;        /* LENGTH OF MOVE                */ 00587000
         STH   @10,PLMVLNTH(,@14)                               04S0675 00588000
*             ELSE                                              04S0676 00589000
*               PLMVLNTH=PRFSIZE-PRFSCAN;/* LENGTH OF MOVE = MSG SIZE   00590000
*                                                            @YM07414*/ 00591000
         B     @RC00674                                         04S0676 00592000
@RF00674 LA    @14,PARMLSP                                      04S0676 00593000
         LH    @10,PRFSIZE(,RPREFIX)                            04S0676 00594000
         SH    @10,PRFSCAN(,RPREFIX)                            04S0676 00595000
         STH   @10,PLMVLNTH(,@14)                               04S0676 00596000
*             RPARM=ADDR(PARMLSP);  /* ADDRESS OF PARM LIST          */ 00597000
@RC00674 LA    RPARM,PARMLSP                                    04S0677 00598000
*             CALL IEDMVBFR;        /* MOVE INTO WORKAREA            */ 00599000
         L     @15,AVTMVBFR(,RAVT)                              04S0678 00600000
         BALR  @14,@15                                          04S0678 00601000
*                                   /* MOVE MESSAGE TO WORKAREA FOR     00602000
*                                      EASY HANDLING.SET DATAPTR TO     00603000
*                                      START OF WORKAREA             */ 00604000
*                                                               04S0679 00605000
*             /*******************************************************/ 00606000
*             /*                                                     */ 00607000
*             /* PROCESS.CEINPUT.HDRPASS: THIS SEGMENT BYPASSES THE  */ 00608000
*             /* OLT HEADER AND UPDATES DATAPTR AND PRFSCAN.         */ 00609000
*             /*                                                     */ 00610000
*             /*******************************************************/ 00611000
*                                                               04S0679 00612000
*             DATAPTR=ADDR(WORKAREA);/* INIT DATAPTR                 */ 00613000
         LA    @14,WORKAREA                                     04S0679 00614000
         ST    @14,DATAPTR                                      04S0679 00615000
*             IF DATASTNG(1:LENGTH(HDRSS))=HDRSS THEN/* IF START-STOP   00616000
*                                      HEADER                        */ 00617000
         CLC   DATASTNG(5,@14),@CC03076                         04S0680 00618000
         BNE   @RF00680                                         04S0680 00619000
*               DATAPTR=DATAPTR+LENGTH(HDRSS);/* MOVE PAST HEADER    */ 00620000
         AL    @14,@CF00033                                     04S0681 00621000
         ST    @14,DATAPTR                                      04S0681 00622000
*             ELSE                                              04S0682 00623000
*               IF DATASTNG(1:LENGTH(HDRFOLT))=HDRFOLT THEN/* IF SYS    00624000
*                                      CONSOLE OR OP CTL TERM        */ 00625000
         B     @RC00680                                         04S0682 00626000
@RF00680 L     @14,DATAPTR                                      04S0682 00627000
         CLC   DATASTNG(4,@14),@CC03082                         04S0682 00628000
         BNE   @RF00682                                         04S0682 00629000
*                 DATAPTR=DATAPTR+LENGTH(HDRFOLT);/* MOVE PAST HEADER*/ 00630000
         AL    @14,@CF00256                                     04S0683 00631000
         ST    @14,DATAPTR                                      04S0683 00632000
*               ELSE                                            04S0684 00633000
*                 IF DATASTNG(1:LENGTH(HDRBSC))=HDRBSC THEN/* IF EP     00634000
*                                      BSC HEADER            @YM07756*/ 00635000
         B     @RC00682                                         04S0684 00636000
@RF00682 L     @14,DATAPTR                                      04S0684 00637000
         CLC   DATASTNG(3,@14),HDRBSC                           04S0684 00638000
         BNE   @RF00684                                         04S0684 00639000
*                   DATAPTR=DATAPTR+LENGTH(HDRBSC);/* MOVE PAST 04S0685 00640000
*                                      HEADER                        */ 00641000
         AL    @14,@CF00076                                     04S0685 00642000
         ST    @14,DATAPTR                                      04S0685 00643000
*                 ELSE                                          04S0686 00644000
*                   IF DATASTNG(1:LENGTH(PERSLASH))=PERSLASH THEN/*     00645000
*                                      IF NCP BSC HEADER - NO SOH       00646000
*                                      CHARACTER             @YM07756*/ 00647000
         B     @RC00684                                         04S0686 00648000
@RF00684 L     @14,DATAPTR                                      04S0686 00649000
         CLC   DATASTNG(2,@14),PERSLASH                         04S0686 00650000
         BNE   @RF00686                                         04S0686 00651000
*                     DATAPTR=DATAPTR+LENGTH(PERSLASH);/* MOVE PAST     00652000
*                                      HEADER                        */ 00653000
         AL    @14,@CF00067                                     04S0687 00654000
         ST    @14,DATAPTR                                      04S0687 00655000
*             IF DATABYTE=STXCHAR THEN/* IF STX BSC CHAR             */ 00656000
@RF00686 DS    0H                                               04S0688 00657000
@RC00684 DS    0H                                               04S0688 00658000
@RC00682 DS    0H                                               04S0688 00659000
@RC00680 L     @14,DATAPTR                                      04S0688 00660000
         CLC   DATABYTE(1,@14),STXCHAR                          04S0688 00661000
         BNE   @RF00688                                         04S0688 00662000
*               DO;                                             04S0689 00663000
*                 DATAPTR=DATAPTR+1;/* UPDATE                        */ 00664000
         AL    @14,@CF00063                                     04S0690 00665000
         ST    @14,DATAPTR                                      04S0690 00666000
*                 RPARM=PRFSRCE;    /* TTCIN OF TERM                 */ 00667000
         LH    RPARM,PRFSRCE(,RPREFIX)                          04S0691 00668000
*                 CALL IEDQTNT;     /* CONVERT TO TTE ADDR           */ 00669000
         L     @15,AVTRNMPT(,RAVT)                              04S0692 00670000
         BALR  @14,@15                                          04S0692 00671000
*                 RTRM=RPARM;       /* TTE BASE                      */ 00672000
         LR    RTRM,RPARM                                       04S0693 00673000
*                 IF(AVTCSTCS+((TRMCHCIN-1)*LENGTH(IEDDCT)))->DCT3270=  00674000
*                     ON&TRMPREF=ON THEN/* IF NCP 3270               */ 00675000
         SLR   @14,@14                                          04S0694 00676000
         IC    @14,TRMCHCIN(,RTRM)                              04S0694 00677000
         BCTR  @14,0                                            04S0694 00678000
         MH    @14,@CH00061                                     04S0694 00679000
         AL    @14,AVTCSTCS(,RAVT)                              04S0694 00680000
         TM    DCT3270(@14),B'00000100'                         04S0694 00681000
         BNO   @RF00694                                         04S0694 00682000
         TM    TRMPREF(RTRM),B'00010000'                        04S0694 00683000
         BNO   @RF00694                                         04S0694 00684000
*                   DATAPTR=DATAPTR+1;/* BYPASS ADDRESS CHARACTER    */ 00685000
         LA    @14,1                                            04S0695 00686000
         AL    @14,DATAPTR                                      04S0695 00687000
         ST    @14,DATAPTR                                      04S0695 00688000
*                 ELSE                                          04S0696 00689000
*                   ;                                           04S0696 00690000
@RF00694 DS    0H                                               04S0697 00691000
*               END;                                            04S0697 00692000
*             ELSE                                              04S0698 00693000
*               ;                                               04S0698 00694000
@RF00688 DS    0H                                               04S0699 00695000
*             PRFSCAN=PRFSCAN+(DATAPTR-ADDR(WORKAREA));/* UPDATE PAST   00696000
*                                      HEADER                        */ 00697000
         L     @14,DATAPTR                                      04S0699 00698000
         LA    @10,WORKAREA                                     04S0699 00699000
         LCR   @10,@10                                          04S0699 00700000
         ALR   @10,@14                                          04S0699 00701000
         AH    @10,PRFSCAN(,RPREFIX)                            04S0699 00702000
         STH   @10,PRFSCAN(,RPREFIX)                            04S0699 00703000
*                                   /* UPDATE DATAPTR AND PRFSCAN TO    00704000
*                                      POINT PAST OLT HEADER         */ 00705000
*                                                               04S0700 00706000
*             /*******************************************************/ 00707000
*             /*                                                     */ 00708000
*             /* PROCESS.CEINPUT.CANCLREQ: THIS SEGMENT CHECKS TO SEE*/ 00709000
*             /* IF THE INPUT IS A CANCEL REQUEST. IF SO, IT SETS    */ 00710000
*             /* CANCLFLG AND SETS THE CANCEL FLAGS IN THE OLTCB. ON */ 00711000
*             /* ENTRY DATAPTR POINTS INTO WORKAREA AT THE FIRST BYTE*/ 00712000
*             /* OF DATA PAST THE OLT HEADER.                        */ 00713000
*             /*                                                     */ 00714000
*             /*******************************************************/ 00715000
*                                                               04S0700 00716000
*             RFY                                               04S0700 00717000
*               DATABYTE BASED(REG01);/* BASE ON WORK REG    @YM07358*/ 00718000
*             TR(WORKAREA(1:40),LOWTOUP);/* TRANS FROM LOWER TO UPPER   00719000
*                                      CASE                          */ 00720000
         TR    WORKAREA(40),LOWTOUP                             04S0701 00721000
*             IF DATASTNG(1:LENGTH(CANCLMSG))=CANCLMSG THEN/* IF THIS   00722000
*                                      IS A CANCEL REQUEST           */ 00723000
         CLC   DATASTNG(7,@14),CANCLMSG                         04S0702 00724000
         BNE   @RF00702                                         04S0702 00725000
*               DO;                                             04S0703 00726000
*                 CANCLFLG=ON;      /* SET CANCEL FLAG               */ 00727000
         OI    CANCLFLG,B'00100000'                             04S0704 00728000
*                 CTSRTADR=ADDR(CANLDATA);/* START OF CONTROL TERM      00729000
*                                      FIELD                 @YM07358*/ 00730000
         LA    CTSRTADR,CANLDATA(,@14)                          04S0705 00731000
*                 DO REG01=CTSRTADR TO ADDR(CANLLAST) WHILE(DATABYTE=  00732000
*                       SLASH);     /* LOCATE SLASH          @YM07358*/ 00733000
         LR    REG01,CTSRTADR                                   04S0706 00734000
         B     @DE00706                                         04S0706 00735000
@DL00706 CLI   DATABYTE(REG01),C'/'                             04S0706 00736000
         BE    @DC00706                                         04S0706 00737000
*                 END;                                          04S0707 00738000
*                                                               04S0707 00739000
         AL    REG01,@CF00063                                   04S0707 00740000
@DE00706 L     @14,DATAPTR                                      04S0707 00741000
         LA    @14,CANLLAST(,@14)                               04S0707 00742000
         CR    REG01,@14                                        04S0707 00743000
         BNH   @DL00706                                         04S0707 00744000
@DC00706 DS    0H                                               04S0708 00745000
*/*NOTE:                            ASSUME SLASH LOCATED             */ 00746000
*                                                               04S0708 00747000
*                 CTNAMLEN=REG01-CTSRTADR+1;/* CALC LENGTH OF CONTROL   00748000
*                                      TERM NAME INCLUDING SLASH        00749000
*                                                            @YM07358*/ 00750000
         LR    CTNAMLEN,REG01                                   04S0708 00751000
         SLR   CTNAMLEN,CTSRTADR                                04S0708 00752000
         AL    CTNAMLEN,@CF00063                                04S0708 00753000
*                 OLTCBPTR=RESOBFWD;/* SET OLTCB BASE FROM OLTCB QCB */ 00754000
         L     OLTCBPTR,RESOBFWD(,RRESPL)                       04S0709 00755000
*                 DO WHILE TOTELKEY=QENDKEY;/* SEARCH OLTCB QUEUE   */ 00756000
         B     @DE00710                                         04S0710 00757000
@DL00710 DS    0H                                               04S0711 00758000
*                   IF TOTCTNAM(1:CTNAMLEN)=CANLDATA(1:CTNAMLEN) THEN   00759000
         LR    @14,CTNAMLEN                                     04S0711 00760000
         BCTR  @14,0                                            04S0711 00761000
         L     @10,DATAPTR                                      04S0711 00762000
         EX    @14,@SC03310                                     04S0711 00763000
         BNE   @RF00711                                         04S0711 00764000
*                                   /* IF MATCH              @YM07358*/ 00765000
*                     IF TOTCONFG=ON THEN                       04S0712 00766000
         TM    TOTCONFG(OLTCBPTR),B'01000000'                   04S0712 00767000
         BO    @RT00712                                         04S0712 00768000
*                       ;           /* IF CONFIG RUN , DON'T CANCEL  */ 00769000
*                     ELSE                                      04S0714 00770000
*                       DO;                                     04S0714 00771000
*                         TOTCANCL=ON;/* SET CANCEL FLAG             */ 00772000
*                         TOTWACAN=ON;/* SET CANCEL PENDING          */ 00773000
         OI    TOTCANCL(OLTCBPTR),B'00100100'                   04S0716 00774000
*                       END;                                    04S0717 00775000
*                   ELSE                                        04S0718 00776000
*                     ;             /* NO MATCH              @YM07639*/ 00777000
@RF00711 DS    0H                                               04S0719 00778000
*                   OLTCBPTR=TOTELLNK;/* POINT TO NEXT OLTCB         */ 00779000
@RC00711 L     @14,TOTELLNK-1(,OLTCBPTR)                        04S0719 00780000
         LA    @14,0(,@14)                                      04S0719 00781000
         LR    OLTCBPTR,@14                                     04S0719 00782000
*                 END;                                          04S0720 00783000
@DE00710 CLI   TOTELKEY(OLTCBPTR),X'00'                         04S0720 00784000
         BNE   @DL00710                                         04S0720 00785000
*                 CALL RTNBUF;      /* RETURN BUFFER TO TCAM         */ 00786000
         BAL   @14,RTNBUF                                       04S0721 00787000
*               END;                                            04S0722 00788000
*             ELSE                                              04S0723 00789000
*               ;                   /* NOT CANCEL REQUEST            */ 00790000
@RF00702 DS    0H                                               04S0724 00791000
*             RFY                                               04S0724 00792000
*               DATABYTE BASED(DATAPTR);/* RESTORE AS AT START OF       00793000
*                                      SEGMENT               @YM07358*/ 00794000
*                                   /* CHECK IF CANCEL REQUEST AND IF   00795000
*                                      SO, PROCESS                   */ 00796000
*             IF CANCLFLG=OFF THEN  /* IF NOT CANCEL REQUEST,   03S0725 00797000
*                                      CONTINUE                      */ 00798000
         TM    CANCLFLG,B'00100000'                             03S0725 00799000
         BNZ   @RF00725                                         03S0725 00800000
*               DO;                                             03S0726 00801000
*                                                               04S0727 00802000
*                 /***************************************************/ 00803000
*                 /*                                                 */ 00804000
*                 /* PROCESS.CEINPUT.CEREPLY: THIS SEGMENT CHECKS TO */ 00805000
*                 /* SEE IF THE INPUT IS A REPLY TO A CECOM. IF SO,  */ 00806000
*                 /* IT PLACES THE BUFFER ON THE CECOM REPLY QUEUE,  */ 00807000
*                 /* TOTOLTMQ.                                       */ 00808000
*                 /*                                                 */ 00809000
*                 /***************************************************/ 00810000
*                                                               04S0727 00811000
*                 OLTCBPTR=RESOBFWD;                            04S0727 00812000
         L     OLTCBPTR,RESOBFWD(,RRESPL)                       04S0727 00813000
*                 DO WHILE(TOTELKEY=QENDKEY&REPLYFLG=OFF);/* LOOP      00814000
*                                      WHILE NOT AT END OF QUEUE AND    00815000
*                                      NOT FOUND REPLY               */ 00816000
         B     @DE00728                                         04S0728 00817000
@DL00728 DS    0H                                               04S0729 00818000
*                   IF TOTOLTID=WRKOLTID THEN/* IF MATCH ON ID       */ 00819000
         L     @14,DATAPTR                                      04S0729 00820000
         CLC   TOTOLTID(2,OLTCBPTR),WRKOLTID(@14)               04S0729 00821000
         BNE   @RF00729                                         04S0729 00822000
*                     DO;                                       04S0730 00823000
*                       REPLYFLG=ON;/* SET FLAG                      */ 00824000
         OI    REPLYFLG,B'01000000'                             04S0731 00825000
*                       IF TOTREPEX=ON THEN/* IF REPLY EXPECTED      */ 00826000
         TM    TOTREPEX(OLTCBPTR),B'00000010'                   04S0732 00827000
         BNO   @RF00732                                         04S0732 00828000
*                         DO;       /* ADD REPLY TO QUEUE            */ 00829000
*                           TOTREPEX=OFF;/* RESET            @YM08137*/ 00830000
         NI    TOTREPEX(OLTCBPTR),B'11111101'                   04S0734 00831000
*                           RPARM=ADDR(TOTOLTMQ);/* QUEUE ADDR       */ 00832000
         LA    RPARM,TOTOLTMQ(,OLTCBPTR)                        04S0735 00833000
*                           PRFQCBA=RPARM;/* ADDR OF QCB             */ 00834000
         STCM  RPARM,7,PRFQCBA(RPREFIX)                         04S0736 00835000
*                           RELMT=RPREFIX;/* BUFFER IS ELEMENT TO       00836000
*                                      QUEUE                         */ 00837000
         LR    RELMT,RPREFIX                                    04S0737 00838000
*                           RFY                                 04S0738 00839000
*                             REG03 RSTD;                       04S0738 00840000
*                           RBRNCH=RESADDAF;/* ADDR OF ROUTINE  04S0739 00841000
*                                                            @YM07334*/ 00842000
         L     RBRNCH,RESADDAF(,RRESPL)                         04S0739 00843000
*                           RFY                                 04S0740 00844000
*                             REG10 RSTD;/* RETURN REG       @YM07334*/ 00845000
*                           GEN SETS(REG10,RELMT,RPARM);        04S0741 00846000
*                                   /*CALL QUEUE HANDLER @YM07334*/     00847000
         BALR  REG10,RBRNCH           ADD TO FRONT OF QUEUE             00848000
*                           RFY                                 04S0742 00849000
*                             REG10 UNRSTD;/*                @YM07334*/ 00850000
*                           RFY                                 04S0743 00851000
*                             REG03 UNRSTD;                     04S0743 00852000
*                           GEN REFS(TOTOTECB,OLTCBPTR);        04S0744 00853000
*                                   /*POST ECB*/                        00854000
        POST TOTOTECB(OLTCBPTR)                                         00855000
*                         END;                                  04S0745 00856000
*                       ELSE                                    04S0746 00857000
*                         CALL RTNBUF;/* RETURN BUFFER               */ 00858000
         B     @RC00732                                         04S0746 00859000
@RF00732 BAL   @14,RTNBUF                                       04S0746 00860000
*                     END;                                      04S0747 00861000
*                   ELSE                                        04S0748 00862000
*                     OLTCBPTR=TOTELLNK;/* GET NEXT OLTCB            */ 00863000
         B     @RC00729                                         04S0748 00864000
@RF00729 L     @14,TOTELLNK-1(,OLTCBPTR)                        04S0748 00865000
         LA    @14,0(,@14)                                      04S0748 00866000
         LR    OLTCBPTR,@14                                     04S0748 00867000
*                 END;                                          04S0749 00868000
@RC00729 DS    0H                                               04S0749 00869000
@DE00728 CLI   TOTELKEY(OLTCBPTR),X'00'                         04S0749 00870000
         BE    @DC00728                                         04S0749 00871000
         TM    REPLYFLG,B'01000000'                             04S0749 00872000
         BZ    @DL00728                                         04S0749 00873000
@DC00728 DS    0H                                               04S0750 00874000
*                                   /* CHECK IF REPLY TO CECOM AND IF   00875000
*                                      SO, PLACE ON REPLY QUEUE OF      00876000
*                                      OLTCB                         */ 00877000
*                 IF REPLYFLG=OFF THEN/* IF NOT A CECOM REPLY        */ 00878000
         TM    REPLYFLG,B'01000000'                             03S0750 00879000
         BNZ   @RF00750                                         03S0750 00880000
*                   DO;                                         03S0751 00881000
*                     OLTCBPTR=RESOBFWD;/* SET OLTCB BASE WITH ADDR     00882000
*                                      OF Q                          */ 00883000
         L     OLTCBPTR,RESOBFWD(,RRESPL)                       03S0752 00884000
*                     IF TOTELKEY=QENDKEY|RESBKTOT>=MINICORE THEN/*     00885000
*                                      IF ENOUGH CORE TO START TEST     00886000
*                                                            @ZM47904*/ 00887000
         CLI   TOTELKEY(OLTCBPTR),X'00'                         03S0753 00888000
         BE    @RT00753                                         03S0753 00889000
         LH    @14,RESBKTOT(,RRESPL)                            03S0753 00890000
         C     @14,@CF03106                                     03S0753 00891000
         BL    @RF00753                                         03S0753 00892000
@RT00753 DS    0H                                               03S0754 00893000
*                       DO;                                     03S0754 00894000
*                         PRFQCBA=ADDR(RESTRMQ);/* ADDR OF TRM QUEUE */ 00895000
         LA    @14,RESTRMQ(,RRESPL)                             03S0755 00896000
         STCM  @14,7,PRFQCBA(RPREFIX)                           03S0755 00897000
*                         RELMT=RPREFIX;/* PLACE BUFFER ADDR IN REG2 */ 00898000
         LR    RELMT,RPREFIX                                    03S0756 00899000
*                         RFY                                   03S0757 00900000
*                           REG03 RSTD;                         03S0757 00901000
*                         RBRNCH=RESADDND;/* ADDR OF ROUTINE @YM07334*/ 00902000
         L     RBRNCH,RESADDND(,RRESPL)                         03S0758 00903000
*                         RFY                                   03S0759 00904000
*                           REG10 RSTD;/* RETURN REG         @YM07334*/ 00905000
*                         GEN SETS(REG10,RELMT,RPARM);          03S0760 00906000
*                                   /*CALL QUEUE HANDLER @YM07334*/     00907000
         BALR  REG10,RBRNCH           ADD ELEMENT TO END OF QUEUE       00908000
*                         RFY                                   03S0761 00909000
*                           REG10 UNRSTD;/*                  @YM07334*/ 00910000
*                         RFY                                   03S0762 00911000
*                           REG03 UNRSTD;                       03S0762 00912000
*                         RPARM=RRESPL;/* ADDR OF RESIDENT PARM LIST */ 00913000
         LR    RPARM,RRESPL                                     03S0763 00914000
*                         GEN;                                  03S0764 00915000
*                                   /*LINK TO RESOURCE MANAGER*/        00916000
        LINK  EP=IEDQWB                                                 00917000
*                         RTNCODE=REG15;/* SET RETURN CODE           */ 00918000
         STC   REG15,RTNCODE                                    03S0765 00919000
*                       END;                                    03S0766 00920000
*                     ELSE                                      03S0767 00921000
*                       DO;                                     03S0767 00922000
         B     @RC00753                                         03S0767 00923000
@RF00753 DS    0H                                               03S0768 00924000
*                         CALL REQMSG;/* SEND MSG OT REQUESTING TERM */ 00925000
         BAL   @14,REQMSG                                       03S0768 00926000
*                       END;                                    03S0769 00927000
*                   END;                                        03S0770 00928000
*                 ELSE                                          03S0771 00929000
*                   ;                                           03S0771 00930000
@RF00750 DS    0H                                               03S0772 00931000
*               END;                                            03S0772 00932000
*             ELSE                                              03S0773 00933000
*               ;                                               03S0773 00934000
@RF00725 DS    0H                                               03S0774 00935000
*           END;                                                03S0774 00936000
*         ELSE                                                  03S0775 00937000
*           ;                                                   03S0775 00938000
@RF00665 DS    0H                                               03S0776 00939000
*       END;                                                    02S0776 00940000
*     ELSE                                                      02S0777 00941000
*       IF PRFKEY<PRFTEST THEN      /* IF THIS IS TEST INPUT         */ 00942000
         B     @RC00586                                         02S0777 00943000
@RF00586 CLI   PRFKEY(RPREFIX),X'30'                            02S0777 00944000
         BNL   @RF00777                                         02S0777 00945000
*         DO;                                                   02S0778 00946000
*                                                               03S0779 00947000
*           /*********************************************************/ 00948000
*           /*                                                       */ 00949000
*           /* PROCESS.TESTDATA: THIS SEGMENT PROCESSES TEST DATA. IT*/ 00950000
*           /* SCANS THE OLTCB QUEUE TO MATCH THE INCOMING DATA WITH */ 00951000
*           /* THE TEST.                                             */ 00952000
*           /*                                                       */ 00953000
*           /*********************************************************/ 00954000
*                                                               03S0779 00955000
*           IF PRFKEY=PRFEXTRP THEN /* IF EXEC TEST FME RESP         */ 00956000
         CLI   PRFKEY(RPREFIX),X'24'                            03S0779 00957000
         BNE   @RF00779                                         03S0779 00958000
*             DO;                                               03S0780 00959000
*               PRFSCAN=LOCISIZE&PRFSCAN;/* ISOLATE # OF IDLES IN       00960000
*                                      PRFSCAN                       */ 00961000
         LH    @14,PRFSCAN(,RPREFIX)                            03S0781 00962000
         LH    @10,LOCISIZE                                     03S0781 00963000
         N     @10,@CF03301                                     03S0781 00964000
         NR    @14,@10                                          03S0781 00965000
         STH   @14,PRFSCAN(,RPREFIX)                            03S0781 00966000
*               PRFSCAN=PRFSCAN+AVTHDRSZ;/* SET UP PRFSCAN CORRECTLY */ 00967000
         AL    @14,@CF00452                                     03S0782 00968000
         STH   @14,PRFSCAN(,RPREFIX)                            03S0782 00969000
*               TESTCOMP=PRF1SQID;  /* COMPARE IS DONE ON SEG #      */ 00970000
         LR    @14,RPREFIX                                      03S0783 00971000
         AL    @14,@CF03314                                     03S0783 00972000
         LH    @14,PRF1SQID-4(,@14)                             03S0783 00973000
         N     @14,@CF03301                                     03S0783 00974000
         STH   @14,TESTCOMP                                     03S0783 00975000
*             END;                                              03S0784 00976000
*           ELSE                                                03S0785 00977000
*             DO;                                               03S0785 00978000
         B     @RC00779                                         03S0785 00979000
@RF00779 DS    0H                                               03S0786 00980000
*               IF PRFKEY=PRFRTD THEN/* IF RECORD TEST DATA RU       */ 00981000
         CLI   PRFKEY(RPREFIX),X'20'                            03S0786 00982000
         BNE   @RF00786                                         03S0786 00983000
*                 DO;                                           03S0787 00984000
*                   PRFSCAN=LOCISIZE&PRFSCAN;/* ISOLATE # OF IDLES IN   00985000
*                                      PRFSCAN                       */ 00986000
         LH    @14,PRFSCAN(,RPREFIX)                            03S0788 00987000
         LH    @10,LOCISIZE                                     03S0788 00988000
         N     @10,@CF03301                                     03S0788 00989000
         NR    @14,@10                                          03S0788 00990000
         STH   @14,PRFSCAN(,RPREFIX)                            03S0788 00991000
*                   PRFSCAN=PRFSCAN+AVTHDRSZ;/* SET UP PRFSCAN  03S0789 00992000
*                                      CORRECTLY                     */ 00993000
         AL    @14,@CF00452                                     03S0789 00994000
         STH   @14,PRFSCAN(,RPREFIX)                            03S0789 00995000
*                   IEDPLMV=''B;    /* INIT PARM LIST                */ 00996000
         LA    @10,PARMLSP                                      03S0790 00997000
         XC    IEDPLMV(24,@10),IEDPLMV(@10)                     03S0790 00998000
*                   PLMVSU=RPREFIX; /* SOURCE UNIT                   */ 00999000
         ST    RPREFIX,PLMVSU(,@10)                             03S0791 01000000
*                   PLMVSD=ADDR(PRFSUNIT)+PRFSCAN;/* SOURCE DATA     */ 01001000
         LA    @07,PRFSUNIT(,RPREFIX)                           03S0792 01002000
         ALR   @07,@14                                          03S0792 01003000
         ST    @07,PLMVSD(,@10)                                 03S0792 01004000
*                   PLMVTU=ADDR(WORKAREA);/* TARGET                  */ 01005000
         LA    @14,WORKAREA                                     03S0793 01006000
         ST    @14,PLMVTU(,@10)                                 03S0793 01007000
*                   PLMVTD=PLMVTU;  /* TARGET                        */ 01008000
         ST    @14,PLMVTD(,@10)                                 03S0794 01009000
*                   PLMVLNTH=LENGTH(IEDXRTDD);/* LENGTH OF RECORD       01010000
*                                      TEST DATA RU                  */ 01011000
         MVC   PLMVLNTH(2,@10),@CH01479                         03S0795 01012000
*                   PLMVTCTG=ON;    /* SET TARGET CONTIGUOUS FLAG    */ 01013000
         OI    PLMVTCTG(@10),B'00100000'                        03S0796 01014000
*                   RPARM=ADDR(PARMLSP);/* ADDR OF PARM LIST         */ 01015000
         LR    RPARM,@10                                        03S0797 01016000
*                   CALL IEDMVBFR;  /* MOVE TO WORKAREA              */ 01017000
         L     @15,AVTMVBFR(,RAVT)                              03S0798 01018000
         BALR  @14,@15                                          03S0798 01019000
*                   RPARM=XRTDADDR; /* NETWORK ADDR FROM RU          */ 01020000
         LA    @14,WORKAREA                                     03S0799 01021000
         SLR   RPARM,RPARM                                      03S0799 01022000
         ICM   RPARM,3,XRTDADDR(@14)                            03S0799 01023000
*                   CALL IEDIAP03;  /* CONVERT TO TTCIN              */ 01024000
         L     @10,AVTSAVTP(,RAVT)                              03S0800 01025000
         L     @15,SAVTNAX(,@10)                                03S0800 01026000
         BALR  @14,@15                                          03S0800 01027000
*                   TESTCOMP=REG15; /* COMPARE FOR TEST MATCH        */ 01028000
         STH   REG15,TESTCOMP                                   03S0801 01029000
*                 END;                                          03S0802 01030000
*               ELSE                /* SNA TEST FLOW                 */ 01031000
*                 IF PRFERMGN=ON THEN/* IF ERRORMSG ELMT THEN        */ 01032000
         B     @RC00786                                         03S0803 01033000
@RF00786 TM    PRFERMGN(RPREFIX),B'01000000'                    03S0803 01034000
         BNO   @RF00803                                         03S0803 01035000
*                   DO;             /* FME RESPONSE                  */ 01036000
*                     TESTCOMP=ERRTTCIN;/* COMPARE FOR TEST MATCH    */ 01037000
         LA    @14,PRFSUNIT(,RPREFIX)                           03S0805 01038000
         LH    @10,PRFSCAN(,RPREFIX)                            03S0805 01039000
         ALR   @14,@10                                          03S0805 01040000
         MVC   TESTCOMP(2),ERRTTCIN(@14)                        03S0805 01041000
*                     PRFSCAN=PRFSCAN+LENGTH(ERRTYPE);/* MOVE PAST      01042000
*                                      TYPE FIELD                    */ 01043000
         AL    @10,@CF00063                                     03S0806 01044000
         STH   @10,PRFSCAN(,RPREFIX)                            03S0806 01045000
*                   END;            /* END OF SNA FME PROCESSING     */ 01046000
*                 ELSE              /* BUFFER HAS SNA REQUEST RU     */ 01047000
*                   TESTCOMP=PRFSRCE;/* FM DATA RU - TTCIN IN PREFIX */ 01048000
         B     @RC00803                                         03S0808 01049000
@RF00803 LH    @14,PRFSRCE(,RPREFIX)                            03S0808 01050000
         STH   @14,TESTCOMP                                     03S0808 01051000
*               TTYPEFLG=ON;        /* SET FLAG TO TTCIN IN TESTCOMP */ 01052000
@RC00803 DS    0H                                               03S0809 01053000
@RC00786 OI    TTYPEFLG,B'10000000'                             03S0809 01054000
*             END;                                              03S0810 01055000
*           OLTCBPTR=RESOBFWD;      /* POINT TO FIRST OLTCB ON QUEUE */ 01056000
@RC00779 L     OLTCBPTR,RESOBFWD(,RRESPL)                       03S0811 01057000
*           DO WHILE(TOTELKEY=QENDKEY&FNDTFLG=OFF);/* SCAN UNTIL END   01058000
*                                      OF QUEUE OR MATCH FOUND FOR      01059000
*                                      TESTCOMP                      */ 01060000
         B     @DE00812                                         03S0812 01061000
@DL00812 DS    0H                                               03S0813 01062000
*             IF(TTYPEFLG=ON&(TOTPROFF=TESTCOMP|TOTPCOFF=TESTCOMP))|(   01063000
*                 TTYPEFLG=OFF&TOTPRSEQ=TESTCOMP) THEN/* IF FOR 03S0813 01064000
*                                      PRIMARY DEVICE        @YM08534*/ 01065000
         TM    TTYPEFLG,B'10000000'                             03S0813 01066000
         BNO   @GL00017                                         03S0813 01067000
         CLC   TOTPROFF(2,OLTCBPTR),TESTCOMP                    03S0813 01068000
         BE    @RT00813                                         03S0813 01069000
         CLC   TOTPCOFF(2,OLTCBPTR),TESTCOMP                    03S0813 01070000
         BE    @RT00813                                         03S0813 01071000
@GL00017 TM    TTYPEFLG,B'10000000'                             03S0813 01072000
         BNZ   @RF00813                                         03S0813 01073000
         CLC   TOTPRSEQ(2,OLTCBPTR),TESTCOMP                    03S0813 01074000
         BNE   @RF00813                                         03S0813 01075000
@RT00813 DS    0H                                               03S0814 01076000
*               DO;                                             03S0814 01077000
*                 PRFQCBA=ADDR(TOTPRBUF);/* SET TO POST TO PRIMARY      01078000
*                                      DEVICE QCB                    */ 01079000
         LA    @14,TOTPRBUF(,OLTCBPTR)                          03S0815 01080000
         STCM  @14,7,PRFQCBA(RPREFIX)                           03S0815 01081000
*                 RELMT=RPREFIX;    /* ADDR OF POSTED ELEMENT        */ 01082000
         LR    RELMT,RPREFIX                                    03S0816 01083000
*                 RFY                                           03S0817 01084000
*                   REG03 RSTD;                                 03S0817 01085000
*                 RFY                                           03S0818 01086000
*                   REG10 RSTD;     /*                       @G36XRUV*/ 01087000
*                 REG10=RESADDND;   /* ADDR OF ROUTINE       @G36XRUV*/ 01088000
         L     REG10,RESADDND(,RRESPL)                          03S0819 01089000
*                 GEN SETS(REG10,RELMT,RPARM) REFS(PSALITA,FLC);        01090000
*                                                  /*    @G36XRUV*/     01091000
         MODESET MODE=SUP             SET SUPERVISOR STATE     @G36XRUV 01092000
         MODESET EXTKEY=SUPR          SET KEY ZERO             @G36XRUV 01093000
SETTSTBF DS    0H                     PRIMARY (SECONDARY BELOW)@G36XRUV 01094000
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,REGS=USE,       @G36XRUVC01095000
               RELATED=ATTACHED-TASKS-IEDQWS-IEDQW33(SETTSTBF) @G36XRUV 01096000
         LR    RBRNCH,REG10           COPY ENTRY POINT         @G36XRUV 01097000
         BALR  REG10,RBRNCH           PLACE ON QUEUE           @G36XRUV 01098000
         SETLOCK RELEASE,TYPE=LOCAL,REGS=USE,                  @G36XRUVC01099000
               RELATED=ATTACHED-TASKS-IEDQWA1(SETTSTBF)        @G36XRUV 01100000
         MODESET EXTKEY=TCAM          TCAM'S KEY               @G36XRUV 01101000
         MODESET MODE=PROB            PROBLEM MODE             @G36XRUV 01102000
*                 RFY                                           03S0821 01103000
*                   REG10 UNRSTD;   /*                       @YM07334*/ 01104000
*                 RFY                                           03S0822 01105000
*                   REG03 UNRSTD;                               03S0822 01106000
*                 GEN REFS(TOTPRECB,OLTCBPTR);                  03S0823 01107000
         POST  TOTPRECB(OLTCBPTR)   POST OLT                            01108000
*                 FNDTFLG=ON;       /* FOUND TEST DEVICE MATCH       */ 01109000
         OI    FNDTFLG,B'00000010'                              03S0824 01110000
*               END;                                            03S0825 01111000
*             ELSE                                              03S0826 01112000
*               IF(TTYPEFLG=ON&(TOTSCOFF=TESTCOMP|TOTNCOFF=TESTCOMP))|( 01113000
*                   TTYPEFLG=OFF&TOTSCSEQ=TESTCOMP) THEN/* IF FOR       01114000
*                                      SECONDARY DEV         @YM08534*/ 01115000
         B     @RC00813                                         03S0826 01116000
@RF00813 TM    TTYPEFLG,B'10000000'                             03S0826 01117000
         BNO   @GL00021                                         03S0826 01118000
         CLC   TOTSCOFF(2,OLTCBPTR),TESTCOMP                    03S0826 01119000
         BE    @RT00826                                         03S0826 01120000
         CLC   TOTNCOFF(2,OLTCBPTR),TESTCOMP                    03S0826 01121000
         BE    @RT00826                                         03S0826 01122000
@GL00021 TM    TTYPEFLG,B'10000000'                             03S0826 01123000
         BNZ   @RF00826                                         03S0826 01124000
         CLC   TOTSCSEQ(2,OLTCBPTR),TESTCOMP                    03S0826 01125000
         BNE   @RF00826                                         03S0826 01126000
@RT00826 DS    0H                                               03S0827 01127000
*                 DO;                                           03S0827 01128000
*                   PRFQCBA=ADDR(TOTSCBUF);/* SET TO POST TO    03S0828 01129000
*                                      SECONDARY DEVICE QCB          */ 01130000
         LA    @14,TOTSCBUF(,OLTCBPTR)                          03S0828 01131000
         STCM  @14,7,PRFQCBA(RPREFIX)                           03S0828 01132000
*                   RELMT=RPREFIX;  /* ADDR OF POSTED ELEMENT        */ 01133000
         LR    RELMT,RPREFIX                                    03S0829 01134000
*                   RFY                                         03S0830 01135000
*                     REG03 RSTD;                               03S0830 01136000
*                   RFY                                         03S0831 01137000
*                     REG10 RSTD;   /*                       @G36XRUV*/ 01138000
*                   REG10=RESADDND; /* ADDR OF ROUTINE       @G36XRUV*/ 01139000
         L     REG10,RESADDND(,RRESPL)                          03S0832 01140000
*                   GEN SETS(REG10,RELMT,RPARM) REFS(PSALITA,FLC);      01141000
*                                                  /*    @G36XRUV*/     01142000
         MODESET MODE=SUP             SET SUPERVISOR STATE     @G36XRUV 01143000
         MODESET EXTKEY=SUPR          SET KEY ZERO             @G36XRUV 01144000
         SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,REGS=USE,       @G36XRUVC01145000
               RELATED=ATTACHED-TASKS-IEDQWS-IEDQW33(SETTSTBF) @G36XRUV 01146000
         LR    RBRNCH,REG10           COPY ENTRY POINT         @G36XRUV 01147000
         BALR  REG10,RBRNCH           PLACE ON QUEUE           @G36XRUV 01148000
         SETLOCK RELEASE,TYPE=LOCAL,REGS=USE,                  @G36XRUVC01149000
               RELATED=ATTACHED-TASKS-IEDQWA1(SETTSTBF)        @G36XRUV 01150000
         MODESET EXTKEY=TCAM          TCAM'S KEY               @G36XRUV 01151000
         MODESET MODE=PROB            PROBLEM MODE             @G36XRUV 01152000
*                   RFY                                         03S0834 01153000
*                     REG10 UNRSTD; /*                       @YM07334*/ 01154000
*                   RFY                                         03S0835 01155000
*                     REG03 UNRSTD;                             03S0835 01156000
*                   GEN REFS(TOTSCECB,OLTCBPTR);                03S0836 01157000
         POST  TOTSCECB(OLTCBPTR)   POST OLT                            01158000
*                   FNDTFLG=ON;     /* FOUND TEST DEVICE MATCH       */ 01159000
         OI    FNDTFLG,B'00000010'                              03S0837 01160000
*                 END;                                          03S0838 01161000
*               ELSE                /* NOT FOR THIS OLTCB            */ 01162000
*                 OLTCBPTR=TOTELLNK;/* GET NEXT OLTCB                */ 01163000
         B     @RC00826                                         03S0839 01164000
@RF00826 L     @14,TOTELLNK-1(,OLTCBPTR)                        03S0839 01165000
         LA    @14,0(,@14)                                      03S0839 01166000
         LR    OLTCBPTR,@14                                     03S0839 01167000
*           END;                                                03S0840 01168000
@RC00826 DS    0H                                               03S0840 01169000
@RC00813 DS    0H                                               03S0840 01170000
@DE00812 CLI   TOTELKEY(OLTCBPTR),X'00'                         03S0840 01171000
         BE    @DC00812                                         03S0840 01172000
         TM    FNDTFLG,B'00000010'                              03S0840 01173000
         BZ    @DL00812                                         03S0840 01174000
@DC00812 DS    0H                                               03S0841 01175000
*           IF FNDTFLG=OFF THEN     /* IF TEST DEVICE MATCH NOT FOUND*/ 01176000
         TM    FNDTFLG,B'00000010'                              03S0841 01177000
         BNZ   @RF00841                                         03S0841 01178000
*             DO;                                               03S0842 01179000
*               GEN;                                            03S0843 01180000
         WTO   'IED258I ERROR RESPONSE TO OLTT I/O - RESOURCE ID NOT UNC01181000
               DER TEST.'                                               01182000
*               CALL RTNBUF;        /* RETURN BUFFER TO TCAM         */ 01183000
         BAL   @14,RTNBUF                                       03S0844 01184000
*             END;                                              03S0845 01185000
*           ELSE                                                03S0846 01186000
*             ;                                                 03S0846 01187000
@RF00841 DS    0H                                               03S0847 01188000
*         END;                                                  02S0847 01189000
*       ELSE                                                    02S0848 01190000
*         DO;                       /* INITIATE CLEANUP              */ 01191000
         B     @RC00777                                         02S0848 01192000
@RF00777 DS    0H                                               02S0849 01193000
*                                                               03S0849 01194000
*           /*********************************************************/ 01195000
*           /*                                                       */ 01196000
*           /* PROCESS.CLEANUP: THIS SEGMENT PROCESSES REQUESTS FOR  */ 01197000
*           /* ABNORMAL CLEANUP. RPREFIX POINTS TO AN ELEMENT WHICH  */ 01198000
*           /* MAY BE OF TWO TYPES: 1) AN ERRORMSG ELEMENT POSTED TO */ 01199000
*           /* TOTE FROM THE TOTE MH WHEN AN I/O ERROR IS DETECTED.  */ 01200000
*           /* 2) AN OPERATOR CONTROL SYNCHRONIZATION ELEMENT        */ 01201000
*           /* INDICATING THAT A RESOURCE SUPERIOR TO ONE IN OLT MODE*/ 01202000
*           /* IS BEING DEACTIVATED DUE TO AN OPERATOR COMMAND OR    */ 01203000
*           /* NETWORK MALFUNCTION.                                  */ 01204000
*           /*                                                       */ 01205000
*           /*********************************************************/ 01206000
*                                                               03S0849 01207000
*           RFY                                                 03S0849 01208000
*             RELMT UNRSTD;                                     03S0849 01209000
*           RFY                                                 03S0850 01210000
*             RTRM UNRSTD;                                      03S0850 01211000
*           IF PRFKEY=PRFOPCLN THEN /* IF A OP CTL ELEMENT           */ 01212000
         CLI   PRFKEY(RPREFIX),X'FE'                            03S0851 01213000
         BNE   @RF00851                                         03S0851 01214000
*             TESTCTR=''B;          /* INIT TEST COUNTER             */ 01215000
         SLR   @14,@14                                          03S0852 01216000
         STH   @14,TESTCTR(,RPREFIX)                            03S0852 01217000
*           OLTCBPTR=RESOBFWD;      /* POINT TO FIRST OLTCB          */ 01218000
@RF00851 L     OLTCBPTR,RESOBFWD(,RRESPL)                       03S0853 01219000
*           DO WHILE(TOTELKEY=QENDKEY&CLNUPFLG=OFF);/* LOOP THRU       01220000
*                                      OLTCB Q UNTIL AFFECTED TEST      01221000
*                                      FOUND                 @XM05671*/ 01222000
         B     @DE00854                                         03S0854 01223000
@DL00854 DS    0H                                               03S0855 01224000
*             IF(PRFKEY=PRFOPCLN&   /* IF OP CTL ELMT AND            */ 01225000
*                 (OPTTCIN=TOTCROFF|/* CONTROL TERM                  */ 01226000
*                 OPTTCIN=TOTAROFF| /* ALTERNATE PRINTER             */ 01227000
*                 OPTTCIN=TOTPROFF| /* PRIMARY DEVICE                */ 01228000
*                 OPTTCIN=TOTSROFF))|/* OR SECONDARY DEVICE MATCH    */ 01229000
*                 (PRFKEY=PRFDEVFL& /* OR IF ERRORMSG ELEMENT AND    */ 01230000
*                 (ERRTTCIN=TOTCTOFF|/* CONTROL TERM                 */ 01231000
*                 ERRTTCIN=TOTAPOFF)) THEN/* OR ALTERNATE PRINTER       01232000
*                                      MATCH                         */ 01233000
         CLI   PRFKEY(RPREFIX),X'FE'                            03S0855 01234000
         BNE   @GL00026                                         03S0855 01235000
         CLC   OPTTCIN(2,RPREFIX),TOTCROFF(OLTCBPTR)            03S0855 01236000
         BE    @RT00855                                         03S0855 01237000
         CLC   OPTTCIN(2,RPREFIX),TOTAROFF(OLTCBPTR)            03S0855 01238000
         BE    @RT00855                                         03S0855 01239000
         CLC   OPTTCIN(2,RPREFIX),TOTPROFF(OLTCBPTR)            03S0855 01240000
         BE    @RT00855                                         03S0855 01241000
         CLC   OPTTCIN(2,RPREFIX),TOTSROFF(OLTCBPTR)            03S0855 01242000
         BE    @RT00855                                         03S0855 01243000
@GL00026 CLI   PRFKEY(RPREFIX),X'F0'                            03S0855 01244000
         BNE   @RF00855                                         03S0855 01245000
         LA    @14,PRFSUNIT(,RPREFIX)                           03S0855 01246000
         AH    @14,PRFSCAN(,RPREFIX)                            03S0855 01247000
         CLC   ERRTTCIN(2,@14),TOTCTOFF(OLTCBPTR)               03S0855 01248000
         BE    @RT00855                                         03S0855 01249000
         CLC   ERRTTCIN(2,@14),TOTAPOFF(OLTCBPTR)               03S0855 01250000
         BNE   @RF00855                                         03S0855 01251000
@RT00855 DS    0H                                               03S0856 01252000
*               IF TOTCLNST=ON THEN /* IF CLEANUP STARTED            */ 01253000
         TM    TOTCLNST(OLTCBPTR),B'00000010'                   03S0856 01254000
         BNO   @RF00856                                         03S0856 01255000
*                 IF PRFKEY=PRFOPCLN THEN/* IF OP CTL ELMT           */ 01256000
         CLI   PRFKEY(RPREFIX),X'FE'                            03S0857 01257000
         BNE   @RF00857                                         03S0857 01258000
*                   IF TOTCLNED=OFF THEN/* IF CLEANUP NOT ENDED      */ 01259000
         TM    TOTCLNED(OLTCBPTR),B'00000001'                   03S0858 01260000
         BNZ   @RF00858                                         03S0858 01261000
*                     DO;                                       03S0859 01262000
*                       TESTCTR=TESTCTR+1;/* INCREMENT COUNTER       */ 01263000
         LA    @14,1                                            03S0860 01264000
         AH    @14,TESTCTR(,RPREFIX)                            03S0860 01265000
         STH   @14,TESTCTR(,RPREFIX)                            03S0860 01266000
*                       REQQCBA=ADDR(TOTOPCLN);/* QCB IS OP CTL CLN     01267000
*                                      UP Q                  @XM05671*/ 01268000
         LA    @14,TOTOPCLN(,OLTCBPTR)                          03S0861 01269000
         STCM  @14,7,REQQCBA(RPREFIX)                           03S0861 01270000
*                       RBRNCH=RESADDND;/* ADDR OF Q ADDR ROUTINE       01271000
*                                                            @XM05671*/ 01272000
         L     RBRNCH,RESADDND(,RRESPL)                         03S0862 01273000
*                       RFY                                     03S0863 01274000
*                         RELMT RSTD;/*                      @XM05671*/ 01275000
*                       RFY                                     03S0864 01276000
*                         REG03 RSTD;/*                      @XM05671*/ 01277000
*                       RFY                                     03S0865 01278000
*                         REG10 RSTD;/*                      @XM05671*/ 01279000
*                       RELMT=RPREFIX;/* COPY ADDR OF ELEMENT   03S0866 01280000
*                                                            @XM05671*/ 01281000
         LR    RELMT,RPREFIX                                    03S0866 01282000
*                       GEN SETS(REG03,REG10,RELMT);            03S0867 01283000
*                                   /*                       @XM05671*/ 01284000
         BALR  REG10,RBRNCH                                    @XM05671 01285000
*                       RFY                                     03S0868 01286000
*                         RELMT UNRSTD;/*                    @XM05671*/ 01287000
*                       RFY                                     03S0869 01288000
*                         REG03 UNRSTD;/*                    @XM05671*/ 01289000
*                       RFY                                     03S0870 01290000
*                         REG10 UNRSTD;/*                    @XM05671*/ 01291000
*                       CLNUPFLG=ON;/* SET TO GET OUT OF LOOP   03S0871 01292000
*                                                            @XM05671*/ 01293000
         OI    CLNUPFLG,B'00000100'                             03S0871 01294000
*                     END;                                      03S0872 01295000
*                   ELSE                                        03S0873 01296000
*                     ;             /* IF ENDED, DO NOTHING          */ 01297000
@RF00858 DS    0H                                               03S0874 01298000
*                 ELSE                                          03S0874 01299000
*                   ;               /* IF ERRORMSG ELMT, DO NOTHING  */ 01300000
@RF00857 DS    0H                                               03S0875 01301000
*               ELSE                /* CLEANUP NOT STARTED           */ 01302000
*                 DO;               /* INITIATE CLEANUP              */ 01303000
         B     @RC00856                                         03S0875 01304000
@RF00856 DS    0H                                               03S0876 01305000
*                   IF PRFKEY=PRFDEVFL THEN                     03S0876 01306000
         CLI   PRFKEY(RPREFIX),X'F0'                            03S0876 01307000
         BE    @RT00876                                         03S0876 01308000
*                     ;             /* IF ERRORMSG ELEMENT   @XM05671*/ 01309000
*                   ELSE            /* OP CTL ELEMENT                */ 01310000
*                     DO;           /* SET ELMT FOR IEDQWE2  @YM08564*/ 01311000
*                       TESTCTR=TESTCTR+1;/* 'NO. OF TESTS AFFECTED'    01312000
*                                      COUNTER               @YM08564*/ 01313000
         LA    @14,1                                            03S0879 01314000
         AH    @14,TESTCTR(,RPREFIX)                            03S0879 01315000
         STH   @14,TESTCTR(,RPREFIX)                            03S0879 01316000
*                       REQQCBA=ADDR(TOTOPCLN);/* QCB IS OP CTL CLN     01317000
*                                      UP Q                  @XM05671*/ 01318000
         LA    @14,TOTOPCLN(,OLTCBPTR)                          03S0880 01319000
         STCM  @14,7,REQQCBA(RPREFIX)                           03S0880 01320000
*                       RBRNCH=RESADDND;/* ADDR OF Q ADDR ROUTINE       01321000
*                                                            @XM05671*/ 01322000
         L     RBRNCH,RESADDND(,RRESPL)                         03S0881 01323000
*                       RFY                                     03S0882 01324000
*                         RELMT RSTD;/*                      @XM05671*/ 01325000
*                       RFY                                     03S0883 01326000
*                         REG03 RSTD;/*                      @XM05671*/ 01327000
*                       RFY                                     03S0884 01328000
*                         REG10 RSTD;/*                      @XM05671*/ 01329000
*                       RELMT=RPREFIX;/* COPY ADDR OF ELEMENT   03S0885 01330000
*                                                            @XM05671*/ 01331000
         LR    RELMT,RPREFIX                                    03S0885 01332000
*                       GEN SETS(REG03,REG10,RELMT);            03S0886 01333000
*                                   /*                       @XM05671*/ 01334000
         BALR  REG10,RBRNCH                                    @XM05671 01335000
*                       RFY                                     03S0887 01336000
*                         RELMT UNRSTD;/*                    @XM05671*/ 01337000
*                       RFY                                     03S0888 01338000
*                         REG03 UNRSTD;/*                    @XM05671*/ 01339000
*                       RFY                                     03S0889 01340000
*                         REG10 UNRSTD;/*                    @XM05671*/ 01341000
*                       CLNUPFLG=ON;/* SET TO GET OUT OF LOOP   03S0890 01342000
*                                                            @XM05671*/ 01343000
         OI    CLNUPFLG,B'00000100'                             03S0890 01344000
*                     END;          /*                       @YM08564*/ 01345000
*                   TOTCLNST=ON;    /* SET CLEANUP STARTED FLAG      */ 01346000
@RT00876 L     @14,TOTCLNST(,OLTCBPTR)                          03S0892 01347000
@GL00033 LR    @10,@14                                          03S0892 01348000
         O     @10,@CF03317                                     03S0892 01349000
         CS    @14,@10,TOTCLNST(OLTCBPTR)                       03S0892 01350000
         BNE   @GL00033                                         03S0892 01351000
*                   TOTOLTED=ON;    /* OLT ENDED FLAG                */ 01352000
         OI    TOTOLTED(OLTCBPTR),B'00000100'                   03S0893 01353000
*                   TOTREPEX=OFF;   /* RESET "REPLY EXPECTED"   03S0894 01354000
*                                                            @YM09016*/ 01355000
         NI    TOTREPEX(OLTCBPTR),B'11111101'                   03S0894 01356000
*                   TOTCMPCD(2:3)=ERRCODE;/* SET COMPLETION CODE     */ 01357000
         MVC   TOTCMPCD+1(2,OLTCBPTR),ERRCODE                   03S0895 01358000
*                   DTCHOLT=TOTTCBAD;/* MOVE TCB ADDR IN COMMON AREA */ 01359000
         L     @14,TOTTCBAD(,OLTCBPTR)                          03S0896 01360000
         ST    @14,DTCHOLT                                      03S0896 01361000
*                   IF TOTOTACT=ON THEN/* IF ON-LINE TESTING ACTIVE  */ 01362000
         TM    TOTOTACT(OLTCBPTR),B'00000010'                   03S0897 01363000
         BNO   @RF00897                                         03S0897 01364000
*                     GEN REFS(DTCHOLT);                        03S0898 01365000
*                                   /*DETACH OLT SUBTASK*/              01366000
         DETACH DTCHOLT,STAE=YES                                        01367000
*                   ELSE                                        03S0899 01368000
*                     GEN REFS(DTCHOLT,TOTOTECB);               03S0899 01369000
         B     @RC00897                                         03S0899 01370000
@RF00897 DS    0H                                               03S0899 01371000
*                                   /*POST REPLY ECB AND DETACH*/       01372000
         POST  TOTOTECB(OLTCBPTR)                                       01373000
         DETACH DTCHOLT                                                 01374000
*                 END;              /* END OF CLEANUP INITIATION     */ 01375000
@RC00897 DS    0H                                               03S0901 01376000
*             OLTCBPTR=TOTELLNK;    /* POINT TO NEXT OLTCB   @YM08564*/ 01377000
@RC00856 DS    0H                                               03S0901 01378000
@RF00855 L     @14,TOTELLNK-1(,OLTCBPTR)                        03S0901 01379000
         LA    @14,0(,@14)                                      03S0901 01380000
         LR    OLTCBPTR,@14                                     03S0901 01381000
*           END;                    /* END OF OLTCB LOOP             */ 01382000
@DE00854 CLI   TOTELKEY(OLTCBPTR),X'00'                         03S0902 01383000
         BE    @DC00854                                         03S0902 01384000
         TM    CLNUPFLG,B'00000100'                             03S0902 01385000
         BZ    @DL00854                                         03S0902 01386000
@DC00854 DS    0H                                               03S0903 01387000
*           IF PRFKEY=PRFDEVFL THEN /* IF ERRORMSG ELMT              */ 01388000
         CLI   PRFKEY(RPREFIX),X'F0'                            03S0903 01389000
         BNE   @RF00903                                         03S0903 01390000
*             CALL RTNBUF;          /* RETURN BUFFER                 */ 01391000
         BAL   @14,RTNBUF                                       03S0904 01392000
*           ELSE                    /* OP CTL ELMT                   */ 01393000
*             IF TESTCTR=0 THEN     /* IF ALL OLT'S ENDED            */ 01394000
         B     @RC00903                                         03S0905 01395000
@RF00903 LH    @14,TESTCTR(,RPREFIX)                            03S0905 01396000
         LTR   @14,@14                                          03S0905 01397000
         BNZ   @RF00905                                         03S0905 01398000
*               DO;                 /* POST ELEMENT BACK TO OP CTL   */ 01399000
*                 REQQCBA=REQRQCBA; /* RETURN QCB                    */ 01400000
         MVC   REQQCBA(3,RPREFIX),REQRQCBA(RPREFIX)             03S0907 01401000
*                 REQPRI=REQRPRI;   /* RETURN PRIORITY               */ 01402000
         MVC   REQPRI(1,RPREFIX),REQRPRI(RPREFIX)               03S0908 01403000
*                 REQLINK=''B;      /* CLEAR LINK FIELD FOR POSTWAIT */ 01404000
         SLR   @14,@14                                          03S0909 01405000
         STCM  @14,7,REQLINK(RPREFIX)                           03S0909 01406000
*                 REQRPRI=TICCODE;  /* TIC COMMAND CODE      @YM08564*/ 01407000
         MVI   REQRPRI(RPREFIX),X'08'                           03S0910 01408000
*                 REQRQCBA=INVALTIC;/* INVALID TIC ADDRESS   @YM08564*/ 01409000
         MVC   REQRQCBA(3,RPREFIX),INVALTIC                     03S0911 01410000
*                 RPARM=RPREFIX;    /* POINT TO ELEMENT              */ 01411000
         LR    RPARM,RPREFIX                                    03S0912 01412000
*                 RZERO=ADDR(WA1WRKSP);/* WORKAREA FOR POSTWAIT 03S0913 01413000
*                                      ROUTINE                       */ 01414000
         LA    RZERO,WA1WRKSP                                   03S0913 01415000
*                 CALL POSTWAIT;    /* POST REQ ELMT BACK TO OP CTL  */ 01416000
         L     @15,RESPLRVT(,RRESPL)                            03S0914 01417000
         BALR  @14,@15                                          03S0914 01418000
*               END;                                            03S0915 01419000
*             ELSE                                              03S0916 01420000
*               ;                   /* COUNTER NOT ZERO, DON'T POST  */ 01421000
@RF00905 DS    0H                                               03S0917 01422000
*           RFY                                                 03S0917 01423000
*             RELMT RSTD;                                       03S0917 01424000
@RC00903 DS    0H                                               03S0918 01425000
*           RFY                                                 03S0918 01426000
*             RTRM RSTD;                                        03S0918 01427000
*         END;                                                  02S0919 01428000
*                                                               02S0920 01429000
*   /*****************************************************************/ 01430000
*   /*                                                               */ 01431000
*   /* EPILOGUE: THIS SEGMENT COMPLETES THE TERMINATION OF THE MODULE*/ 01432000
*   /* AND GENERATES THE EXIT LINKAGE TO RETURN TO THE CALLING       */ 01433000
*   /* MODULE, IEDQWA, THE TOTE RESIDENT MODULE. REGISTER 15 IS SET  */ 01434000
*   /* WITH THE RETURN CODE FOR THE PROCESSING OF THE ELEMENT        */ 01435000
*   /* DEQUEUED.                                                     */ 01436000
*   /*                                                               */ 01437000
*   /*****************************************************************/ 01438000
*                                                               02S0920 01439000
*   REG15=RTNCODE;                  /* SET THE RETURN CODE           */ 01440000
@RC00777 DS    0H                                               02S0920 01441000
@RC00586 DS    0H                                               02S0920 01442000
@RT00584 SLR   REG15,REG15                                      02S0920 01443000
         IC    REG15,RTNCODE                                    02S0920 01444000
*   RSAVE=BACK13;                   /* POINT TO CALLER'S SAVE AREA      01445000
*                                                            @YM07336*/ 01446000
         L     RSAVE,BACK13                                     02S0921 01447000
*   GEN;                                                        02S0922 01448000
*                                   /*GENERATE EXIT LINKAGE*/           01449000
         L     14,12(13)                RESTORE RETURN REG              01450000
         LM    0,12,20(13)              RESTORE REGS                    01451000
         BR    14                       RETURN                          01452000
*                                                               02S0923 01453000
*   /*****************************************************************/ 01454000
*   /*                                                               */ 01455000
*   /* RTNBUF: THIS SEGMENT CONTAINS THE GERERAL USE ROUTINE TO      */ 01456000
*   /* RETURN A BUFFER TO TCAM.                                      */ 01457000
*   /*                                                               */ 01458000
*   /*****************************************************************/ 01459000
*                                                               02S0923 01460000
*RTNBUF:                                                        02S0923 01461000
*   PROC OPTIONS(RETREG,SAVE(14));                              02S0923 01462000
RTNBUF   ST    @14,@SA00002                                     02S0923 01463000
*   RFY                                                         02S0924 01464000
*     IEDQLCB BASED(RPARM);                                     02S0924 01465000
*   IF PRFKEY=PRFSS|PRFKEY=PRFBSC THEN/* IF THERE IS STILL AN LCB    */ 01466000
         CLI   PRFKEY(RPREFIX),X'08'                            02S0925 01467000
         BE    @RT00925                                         02S0925 01468000
         CLI   PRFKEY(RPREFIX),X'04'                            02S0925 01469000
         BNE   @RF00925                                         02S0925 01470000
@RT00925 DS    0H                                               02S0926 01471000
*     DO;                           /* POST LCB TO BUFFER DISPOSITION*/ 01472000
*       RPARM=PRFLCB;               /* PICK UP LCB ADDR FROM BUFFER  */ 01473000
         L     RPARM,PRFLCB-1(,RPREFIX)                         02S0927 01474000
         LA    RPARM,0(,RPARM)                                  02S0927 01475000
*       LCBLSPCI=RPREFIX;           /* BUFFER ADDR                   */ 01476000
         STCM  RPREFIX,7,LCBLSPCI(RPARM)                        02S0928 01477000
*       IF LCBRSKEY=ANRKEY THEN     /* IF ANR                        */ 01478000
         CLI   LCBRSKEY(RPARM),X'1E'                            02S0929 01479000
         BNE   @RF00929                                         02S0929 01480000
*         LCBTSTSW=ANRSW;           /* SET SWITCH                    */ 01481000
         MVI   LCBTSTSW(RPARM),X'F0'                            02S0930 01482000
*       ELSE                                                    02S0931 01483000
*         ;                                                     02S0931 01484000
@RF00929 DS    0H                                               02S0932 01485000
*       SCBDESTQ=ADDR(AVTBFRTB);    /* SET SCB WITH ADDR OF BUFF RTN */ 01486000
         L     @14,LCBSCBA-1(,RPARM)                            02S0932 01487000
         LA    @14,0(,@14)                                      02S0932 01488000
         LA    @10,AVTBFRTB(,RAVT)                              02S0932 01489000
         STCM  @10,7,SCBDESTQ(@14)                              02S0932 01490000
*       SCBMACR=ADDR(AVTINOUT);     /* DUMMY IN-OUT PARM LIST        */ 01491000
         LA    @10,AVTINOUT(,RAVT)                              02S0933 01492000
         STCM  @10,7,SCBMACR(@14)                               02S0933 01493000
*       LCBPRI=PRILCB;              /* SET LCB POST PRIORITY         */ 01494000
         MVI   LCBPRI(RPARM),X'E7'                              02S0934 01495000
*       LCBQCBA=AVTMSGS->BDADDR;    /* ADDR OF BUFFER DISP           */ 01496000
         L     @14,AVTMSGS-1(,RAVT)                             02S0935 01497000
         MVC   LCBQCBA(3,RPARM),BDADDR+1(@14)                   02S0935 01498000
*       RZERO=ADDR(WORKAREA);       /* WORKAREA USED BY POSTWAIT     */ 01499000
         LA    RZERO,WORKAREA                                   02S0936 01500000
*       LCBLINK=''B;                /* INDICATES TO POSTWAIT THAT       01501000
*                                      THIS IS A SINGLE ELEMENT POST */ 01502000
         SLR   @14,@14                                          02S0937 01503000
         STCM  @14,7,LCBLINK(RPARM)                             02S0937 01504000
*       CALL POSTWAIT;              /* POST LCB TO BUFFER DISP       */ 01505000
         L     @15,RESPLRVT(,RRESPL)                            02S0938 01506000
         BALR  @14,@15                                          02S0938 01507000
*     END;                                                      02S0939 01508000
*   ELSE                                                        02S0940 01509000
*     DO;                                                       02S0940 01510000
         B     @RC00925                                         02S0940 01511000
@RF00925 DS    0H                                               02S0941 01512000
*       RPARM=RPREFIX;              /* ADDR OF BUFFER                */ 01513000
         LR    RPARM,RPREFIX                                    02S0941 01514000
*       PRFLINK=''B;                                            02S0942 01515000
         SLR   @14,@14                                          02S0942 01516000
         STCM  @14,7,PRFLINK(RPREFIX)                           02S0942 01517000
*       RZERO=ADDR(WORKAREA);       /* WORKAREA USED BY FREEBUF      */ 01518000
         LA    RZERO,WORKAREA                                   02S0943 01519000
*       CALL FREEBUF;               /* POST BUFFER TO BUFFER RETURN  */ 01520000
         L     @15,RESFBUF(,RRESPL)                             02S0944 01521000
         BALR  @14,@15                                          02S0944 01522000
*     END;                                                      02S0945 01523000
*   BUFRTFLG=ON;                    /* SET BUFFER RETURN FLAG   02S0946 01524000
*                                      INDICATING NO FURTHER    02S0946 01525000
*                                      PROCESSING                    */ 01526000
@RC00925 OI    BUFRTFLG,B'00001000'                             02S0946 01527000
*   RFY                                                         02S0947 01528000
*     IEDQLCB BASED;                                            02S0947 01529000
*   END RTNBUF;                                                 02S0948 01530000
@EL00002 DS    0H                                               02S0948 01531000
@EF00002 DS    0H                                               02S0948 01532000
@ER00002 L     @14,@SA00002                                     02S0948 01533000
         BR    @14                                              02S0948 01534000
*                                                               02S0949 01535000
*   /*****************************************************************/ 01536000
*   /*                                                               */ 01537000
*   /* HEXCONV: THIS GENERAL PURPOSE ROUTINE CONVERTS A STRING OF    */ 01538000
*   /* HEXIDECIMAL DIGITS TO THEIR EBCDIC REPRESENTATION .           */ 01539000
*   /*                                                               */ 01540000
*   /*****************************************************************/ 01541000
*                                                               02S0949 01542000
*/* PARAMETERS:                                                      */ 01543000
*/* - CONVNUM = THE NUMBER OF HEXIDECIMAL DIGITS                     */ 01544000
*/* - CONVSRC = THE ADDRESS OF THE START OF THE HEXIDECIMAL DIGITS   */ 01545000
*/* - CONVTRG = THE ADDRESS OF LOCATION TO WHICH THE CONVERTED EBCDIC*/ 01546000
*/*             REPRESENTATIONS ARE TO BE PLACED                     */ 01547000
*/* RESTRICTIONS:                                                    */ 01548000
*/* - THE HEXIDECIMAL DIGITS MUST START ON A BYTE BOUNDRY            */ 01549000
*                                                               02S0949 01550000
*HEXCONV:                                                       02S0949 01551000
*   PROC OPTIONS(NOSAVE,NOSAVEAREA);                            02S0949 01552000
HEXCONV  DS    0H                                               02S0950 01553000
*   RFY                                                         02S0950 01554000
*     RRET RSTD;                                                02S0950 01555000
*   HEXSAV14=RRET;                  /* SAVE RETURN ADDRESS           */ 01556000
         ST    RRET,HEXSAV14                                    02S0951 01557000
*   RFY                                                         02S0952 01558000
*     RRET UNRSTD;                                              02S0952 01559000
*   DO I=1 TO CONVNUM BY 2;                                     02S0953 01560000
         LA    I,1                                              02S0953 01561000
         B     @DE00953                                         02S0953 01562000
@DL00953 DS    0H                                               02S0954 01563000
*     CONVIDX=CONVSRC->BYTENUM;     /* GET FIRST TWO DIGITS          */ 01564000
         L     @14,CONVSRC                                      02S0954 01565000
         SLR   @07,@07                                          02S0954 01566000
         IC    @07,BYTENUM(,@14)                                02S0954 01567000
         STH   @07,CONVIDX                                      02S0954 01568000
*     SRL(CONVIDX,4);               /* ISOLATE FIRST DIGIT           */ 01569000
         LR    @14,@07                                          02S0955 01570000
         SRL   @14,4                                            02S0955 01571000
         STH   @14,CONVIDX                                      02S0955 01572000
*     CONVTRG->DATABYTE=HEXTCHAR(CONVIDX+1);/* MOVE CONVERTED VALUE  */ 01573000
         LH    @14,CONVIDX                                      02S0956 01574000
         N     @14,@CF03301                                     02S0956 01575000
         LA    @07,HEXTCHAR(@14)                                02S0956 01576000
         MVC   DATABYTE(1,CONVTRG),0(@07)                       02S0956 01577000
*     CONVTRG=CONVTRG+1;            /* BUMP TARGET PTR TO NEXT BYTE  */ 01578000
         AL    CONVTRG,@CF00063                                 02S0957 01579000
*     IF I<=CONVNUM-1 THEN          /* IF END NOT IN MIDDLE OF SRC      01580000
*                                      BYTE                          */ 01581000
         LH    @14,CONVNUM                                      02S0958 01582000
         BCTR  @14,0                                            02S0958 01583000
         CR    I,@14                                            02S0958 01584000
         BH    @RF00958                                         02S0958 01585000
*       DO;                         /* CONVERT NEXT DIGIT IN BYTE    */ 01586000
*         CONVIDX=CONVSRC->BYTENUM; /* GET CONTENTS OF BYTE          */ 01587000
         L     @14,CONVSRC                                      02S0960 01588000
         SLR   @07,@07                                          02S0960 01589000
         IC    @07,BYTENUM(,@14)                                02S0960 01590000
         STH   @07,CONVIDX                                      02S0960 01591000
*         CONVIDX=CONVIDX&HIMASK;   /* ISOLATE SECOND DIGIT          */ 01592000
         SLR   @14,@14                                          02S0961 01593000
         ICM   @14,3,HIMASK                                     02S0961 01594000
         NR    @07,@14                                          02S0961 01595000
         STH   @07,CONVIDX                                      02S0961 01596000
*         CONVTRG->DATABYTE=HEXTCHAR(CONVIDX+1);/* PLACE IN TARGET      01597000
*                                      LOCATION                      */ 01598000
         LA    @14,HEXTCHAR(@07)                                02S0962 01599000
         MVC   DATABYTE(1,CONVTRG),0(@14)                       02S0962 01600000
*       END;                                                    02S0963 01601000
*     ELSE                                                      02S0964 01602000
*       ;                           /* END IN MIDDLE OF SOURCE BYTE  */ 01603000
@RF00958 DS    0H                                               02S0965 01604000
*     CONVSRC=CONVSRC+1;            /* POINT TO NEXT SOURCE BYTE     */ 01605000
         LA    @14,1                                            02S0965 01606000
         L     @07,CONVSRC                                      02S0965 01607000
         ALR   @07,@14                                          02S0965 01608000
         ST    @07,CONVSRC                                      02S0965 01609000
*     CONVTRG=CONVTRG+1;            /* POINT TO NEXT TARGET BYTE     */ 01610000
         ALR   CONVTRG,@14                                      02S0966 01611000
*   END;                            /* END OF CONVERSION LOOP        */ 01612000
         AL    I,@CF00067                                       02S0967 01613000
@DE00953 CH    I,CONVNUM                                        02S0967 01614000
         BNH   @DL00953                                         02S0967 01615000
*   RFY                                                         02S0968 01616000
*     RRET RSTD;                                                02S0968 01617000
*   RRET=HEXSAV14;                  /* RESTORE RETURN REG            */ 01618000
         L     RRET,HEXSAV14                                    02S0969 01619000
*   RFY                                                         02S0970 01620000
*     RRET UNRSTD;                                              02S0970 01621000
*   END HEXCONV;                                                02S0971 01622000
@EL00003 DS    0H                                               02S0971 01623000
@EF00003 DS    0H                                               02S0971 01624000
@ER00003 BR    @14                                              02S0971 01625000
*                                                               02S0972 01626000
*   /*****************************************************************/ 01627000
*   /*                                                               */ 01628000
*   /* REQMSG: THIS SUBROUTINE CONTAINS THE CODE TO RETURN THE TOTE  */ 01629000
*   /* BUSY MESSAGE TO THE REQUESTING TERMINAL.                      */ 01630000
*   /*                                                               */ 01631000
*   /*****************************************************************/ 01632000
*                                                               02S0972 01633000
*REQMSG:                                                        02S0972 01634000
*   PROC;                                                       02S0972 01635000
REQMSG   STM   @14,@12,@SA00004                                 02S0972 01636000
*   RFY                                                         02S0973 01637000
*     IEDQQCB BASED(TRMDESTQ);                                  02S0973 01638000
*   RFY                                                         02S0974 01639000
*     IEDQLCB BASED(PRFLCB);                                    02S0974 01640000
*   RFY                                                         02S0975 01641000
*     IEDQSCB BASED(LCBSCBA);                                   02S0975 01642000
*   IF PRFKEY=PRFSYS THEN          /* IF REQUEST NOT FROM SYS  02S0976 01643000
*                                      CONSOLE                       */ 01644000
         CLI   PRFKEY(RPREFIX),X'0C'                            02S0976 01645000
         BE    @RF00976                                         02S0976 01646000
*     DO;                                                       02S0977 01647000
*       RPARM=PRFSRCE;              /* USE SOURCE TTCIN              */ 01648000
         LH    RPARM,PRFSRCE(,RPREFIX)                          02S0978 01649000
*       CALL IEDQTNT;               /* TO CALCULATE TTE ADDRESS      */ 01650000
         L     @15,AVTRNMPT(,RAVT)                              02S0979 01651000
         BALR  @14,@15                                          02S0979 01652000
*       RTRM=RPARM;                 /* TTE BASE                      */ 01653000
         LR    RTRM,RPARM                                       02S0980 01654000
*       RDCT=AVTCSTCS+(TRMCHCIN-1)*LENGTH(IEDDCT);/* ENTRY IN DCT    */ 01655000
         SLR   RDCT,RDCT                                        02S0981 01656000
         IC    RDCT,TRMCHCIN(,RTRM)                             02S0981 01657000
         BCTR  RDCT,0                                           02S0981 01658000
         MH    RDCT,@CH00061                                    02S0981 01659000
         AL    RDCT,AVTCSTCS(,RAVT)                             02S0981 01660000
*     END;                                                      02S0982 01661000
*   ELSE                                                        02S0983 01662000
*     ;                                                         02S0983 01663000
@RF00976 DS    0H                                               02S0984 01664000
*   IF PRFKEY=PRFSYS|               /* IF REQUEST FROM SYS CONSOLE   */ 01665000
*       TRMCONC=ON|                 /* REQ FROM TERM ON CONCENTRATOR */ 01666000
*       (AVTTSON=ON&AVTAQTAN=OFF)|  /* TSO ONLY SYSTEM               */ 01667000
*       (QCBTSSES=ON)|              /* TERM IN TSO SESSION           */ 01668000
*       (QCBREUS=OFF&QCBNREUS=OFF&QCBCORE=OFF)/* NO QUEUES           */ 01669000
*     THEN                          /* CAN'T SEND TO REQUEST TERM    */ 01670000
         CLI   PRFKEY(RPREFIX),X'0C'                            02S0984 01671000
         BE    @RT00984                                         02S0984 01672000
         TM    TRMCONC(RTRM),B'10000000'                        02S0984 01673000
         BO    @RT00984                                         02S0984 01674000
         TM    AVTTSON(RAVT),B'01000000'                        02S0984 01675000
         BNO   @GL00037                                         02S0984 01676000
         TM    AVTAQTAN(RAVT),B'00100000'                       02S0984 01677000
         BZ    @RT00984                                         02S0984 01678000
@GL00037 L     @14,TRMDESTQ-1(,RTRM)                            02S0984 01679000
         LA    @14,0(,@14)                                      02S0984 01680000
         TM    QCBTSSES(@14),B'10000000'                        02S0984 01681000
         BO    @RT00984                                         02S0984 01682000
         TM    QCBREUS(@14),B'01110000'                         02S0984 01683000
         BNZ   @RF00984                                         02S0984 01684000
@RT00984 DS    0H                                               02S0985 01685000
*     DO;                           /* SEND MSG TO SYS CONSOLE       */ 01686000
*       RPARM=ADDR(IED149I);        /* ADDR OF WTO PARM LIST         */ 01687000
         LA    RPARM,IED149I                                    02S0986 01688000
*       SVC(35);                    /* WTO                           */ 01689000
         SVC   35                                               02S0987 01690000
*     END;                                                      02S0988 01691000
*   ELSE                                                        02S0989 01692000
*     DO;                           /* SEND MESSAGE TO REQUEST TERM  */ 01693000
         B     @RC00984                                         02S0989 01694000
@RF00984 DS    0H                                               02S0990 01695000
*                                                               03S0990 01696000
*       /*************************************************************/ 01697000
*       /*                                                           */ 01698000
*       /* REQMSG.REQMSGMV:THIS SEGMENT MOVES THE TOTE BUSY MESSAGE  */ 01699000
*       /* INTO THE BUFFER AND INSERTS ALL NECESSARY LINE CONTROL.   */ 01700000
*       /*                                                           */ 01701000
*       /*************************************************************/ 01702000
*                                                               03S0990 01703000
*       IF TRMPREF=ON THEN          /* IF THIS IS AN NCP DEVICE      */ 01704000
         TM    TRMPREF(RTRM),B'00010000'                        03S0990 01705000
         BNO   @RF00990                                         03S0990 01706000
*         IF TRMSNA=ON&DCTL3270=ON THEN/* IF THIS IS A SNA 3270      */ 01707000
         LR    @14,RTRM                                         03S0991 01708000
         AL    @14,@CF03320                                     03S0991 01709000
         TM    TRMSNA-6(@14),B'00000010'                        03S0991 01710000
         BNO   @RF00991                                         03S0991 01711000
         TM    DCTL3270(RDCT),B'01000000'                       03S0991 01712000
         BNO   @RF00991                                         03S0991 01713000
*           DO;                                                 03S0992 01714000
*             MSGPTR=ADDR(WORKAREA);/* INIT POINTER FOR MSG MOVE     */ 01715000
         LA    MSGPTR,WORKAREA                                  03S0993 01716000
*             MSGAREA(1:LENGTH(S3270))=S3270;/* INSERT WRITE ERASE   */ 01717000
         MVC   MSGAREA(2,MSGPTR),S3270                          03S0994 01718000
*             MSGPTR=MSGPTR+LENGTH(S3270);/* UPDATE POINTER          */ 01719000
         AL    MSGPTR,@CF00067                                  03S0995 01720000
*             MSGAREA(1:LENGTH(MSG149I))=MSG149I;/* MOVE IN TOTE BUSY   01721000
*                                      MESSAGE                       */ 01722000
         MVC   MSGAREA(17,MSGPTR),MSG149I                       03S0996 01723000
*             RMSGLEN=S3270L;       /* LENGTH OF MESSAGE             */ 01724000
         LH    RMSGLEN,S3270L                                   03S0997 01725000
*           END;                    /* END OF SNA 3270 PROCESSING    */ 01726000
*         ELSE                                                  03S0999 01727000
*           DO;                     /* NCP, NON 3270 SNA             */ 01728000
         B     @RC00991                                         03S0999 01729000
@RF00991 DS    0H                                               03S1000 01730000
*             MSGPTR=ADDR(WORKAREA);/* INIT POINTER FOR MOVE         */ 01731000
         LA    MSGPTR,WORKAREA                                  03S1000 01732000
*             MSGAREA(1:LENGTH(MSG149I))=MSG149I;/* MOVE IN TOTE BUSY   01733000
*                                      MSG                           */ 01734000
         MVC   MSGAREA(17,MSGPTR),MSG149I                       03S1001 01735000
*             MSGPTR=MSGPTR+LENGTH(MSG149I);/* UPDATE POINTER        */ 01736000
         AL    MSGPTR,@CF03210                                  03S1002 01737000
*             IF DCT3270=ON THEN    /* IF 3270 DEVICE                */ 01738000
         TM    DCT3270(RDCT),B'00000100'                        03S1003 01739000
         BNO   @RF01003                                         03S1003 01740000
*               MSGAREA(1:1)='';    /* ADD BLANK                     */ 01741000
         MVI   MSGAREA(MSGPTR),C' '                             03S1004 01742000
*             ELSE                                              03S1005 01743000
*               MSGAREA(1:LENGTH(NLCHAR))=NLCHAR;/* NEW LINE    03S1005 01744000
*                                      CHARACTER                     */ 01745000
         B     @RC01003                                         03S1005 01746000
@RF01003 MVC   MSGAREA(1,MSGPTR),NLCHAR                         03S1005 01747000
*             RMSGLEN=NCPL;         /* MSG LENGTH                    */ 01748000
@RC01003 LH    RMSGLEN,NCPL                                     03S1006 01749000
*           END;                    /* END OF NCP PROCESSING         */ 01750000
*       ELSE                        /* EP DEVICE                     */ 01751000
*         IF LCBSYNC=ON|DCTNOIDL=ON THEN/* BSC OR 2260               */ 01752000
         B     @RC00990                                         03S1008 01753000
@RF00990 L     @14,PRFLCB-1(,RPREFIX)                           03S1008 01754000
         TM    LCBSYNC(@14),B'00000100'                         03S1008 01755000
         BO    @RT01008                                         03S1008 01756000
         TM    DCTNOIDL(RDCT),B'00000010'                       03S1008 01757000
         BNO   @RF01008                                         03S1008 01758000
@RT01008 DS    0H                                               03S1009 01759000
*           DO;                                                 03S1009 01760000
*             MSGPTR=ADDR(WORKAREA);/* INIT POINTER                  */ 01761000
         LA    MSGPTR,WORKAREA                                  03S1010 01762000
*             MSGAREA(1:LENGTH(STXCH))=STXCHAR;/* INSERT STX         */ 01763000
         MVC   MSGAREA(1,MSGPTR),STXCHAR                        03S1011 01764000
*             MSGPTR=MSGPTR+LENGTH(STXCH);/* UPDATE POINTER          */ 01765000
         AL    MSGPTR,@CF00063                                  03S1012 01766000
*             MSGAREA(1:LENGTH(MSG149I))=MSG149I;/* MOVE IN MESSAGE  */ 01767000
         MVC   MSGAREA(17,MSGPTR),MSG149I                       03S1013 01768000
*             MSGPTR=MSGPTR+LENGTH(IED149I);/* UPDATE POINTER        */ 01769000
         AL    MSGPTR,@CF03293                                  03S1014 01770000
*             MSGAREA(1:LENGTH(ENDSYNC))=ENDSYNC;/* ADD BSC CHARS AT    01771000
*                                      END                           */ 01772000
         MVC   MSGAREA(3,MSGPTR),ENDSYNC                        03S1015 01773000
*             RMSGLEN=EPBSCL;       /* LENGTH OF MESSAGE             */ 01774000
         LH    RMSGLEN,EPBSCL                                   03S1016 01775000
*           END;                                                03S1017 01776000
*         ELSE                                                  03S1018 01777000
*           DO;                     /* START STOP TERMINAL           */ 01778000
         B     @RC01008                                         03S1018 01779000
@RF01008 DS    0H                                               03S1019 01780000
*             MSGPTR=ADDR(WORKAREA);/* MESSAGE IN WORKAREA           */ 01781000
         LA    MSGPTR,WORKAREA                                  03S1019 01782000
*             MSGAREA(1:LENGTH(MSG149I))=MSG149I;/* MOVE IN MSG      */ 01783000
         MVC   MSGAREA(17,MSGPTR),MSG149I                       03S1020 01784000
*             MSGPTR=MSGPTR+LENGTH(MSG149I);/* UPDATE POINTER        */ 01785000
         AL    MSGPTR,@CF03210                                  03S1021 01786000
*             MSGAREA(1:LENGTH(ENDSS))=ENDSS;/* MOVE IN SS CHARS AT     01787000
*                                      END                           */ 01788000
         MVC   MSGAREA(2,MSGPTR),ENDSS                          03S1022 01789000
*             RMSGLEN=EPSSL;        /* LENGTH OF EP START STOP MSG   */ 01790000
         LH    RMSGLEN,EPSSL                                    03S1023 01791000
*           END;                                                03S1024 01792000
*       IEDPLMV=''B;                /* CLEAR IEDMVBFR PARM LIST      */ 01793000
@RC01008 DS    0H                                               03S1025 01794000
@RC00990 LA    @14,PARMLSP                                      03S1025 01795000
         XC    IEDPLMV(24,@14),IEDPLMV(@14)                     03S1025 01796000
*       IF RMSGLEN>(PRFNBUNT*AVTKEYLE-AVTHDRSZ) THEN/* IF MSG TOO BIG   01797000
*                                      FOR BUF                       */ 01798000
         SLR   @10,@10                                          03S1026 01799000
         IC    @10,PRFNBUNT(,RPREFIX)                           03S1026 01800000
         MH    @10,AVTKEYLE(,RAVT)                              03S1026 01801000
         SL    @10,@CF00452                                     03S1026 01802000
         CR    RMSGLEN,@10                                      03S1026 01803000
         BNH   @RF01026                                         03S1026 01804000
*         PLMVLNTH=PRFNBUNT*AVTKEYLE-AVTHDRSZ;/* TRUNCATE MSG        */ 01805000
         STH   @10,PLMVLNTH(,@14)                               03S1027 01806000
*       ELSE                                                    03S1028 01807000
*         PLMVLNTH=RMSGLEN;         /* PLACE LEN OF MSG IN PARM LIST */ 01808000
         B     @RC01026                                         03S1028 01809000
@RF01026 LA    @14,PARMLSP                                      03S1028 01810000
         STH   RMSGLEN,PLMVLNTH(,@14)                           03S1028 01811000
*       PRFSIZE=PLMVLNTH+AVTHDRSZ;  /* SET SIZE IN PREFIX            */ 01812000
@RC01026 LA    @14,PARMLSP                                      03S1029 01813000
         LA    @10,30                                           03S1029 01814000
         LH    @07,PLMVLNTH(,@14)                               03S1029 01815000
         N     @07,@CF03301                                     03S1029 01816000
         ALR   @10,@07                                          03S1029 01817000
         STH   @10,PRFSIZE(,RPREFIX)                            03S1029 01818000
*       PLMVTU=RPREFIX;             /* TARGET UNIT                   */ 01819000
         ST    RPREFIX,PLMVTU(,@14)                             03S1030 01820000
*       PLMVTD=ADDR(PRFSHDR);       /* TARGET DATA                   */ 01821000
         LA    @10,PRFSHDR(,RPREFIX)                            03S1031 01822000
         ST    @10,PLMVTD(,@14)                                 03S1031 01823000
*       PLMVSU=ADDR(WORKAREA);      /* SOURCE UNIT                   */ 01824000
         LA    @10,WORKAREA                                     03S1032 01825000
         ST    @10,PLMVSU(,@14)                                 03S1032 01826000
*       PLMVSD=PLMVSU;              /* SOURCE DATA                   */ 01827000
         ST    @10,PLMVSD(,@14)                                 03S1033 01828000
*       PLMVSCTG=ON;                /* SOURCE CONTIGUOUS FLAG        */ 01829000
         OI    PLMVSCTG(@14),B'01000000'                        03S1034 01830000
*       RPARM=ADDR(PARMLSP);        /* POINT TO PARM LIST            */ 01831000
         LR    RPARM,@14                                        03S1035 01832000
*       CALL IEDMVBFR;              /* MOVE MESSAGE TO BUFFER        */ 01833000
         L     @15,AVTMVBFR(,RAVT)                              03S1036 01834000
         BALR  @14,@15                                          03S1036 01835000
*                                                               03S1037 01836000
*       /*************************************************************/ 01837000
*       /*                                                           */ 01838000
*       /* REQMSG.REQDEST: THIS SEGMENT SENDS THE MESSAGE TO THE     */ 01839000
*       /* REQUESTING TERMINAL.                                      */ 01840000
*       /*                                                           */ 01841000
*       /*************************************************************/ 01842000
*                                                               03S1037 01843000
*       RFY                                                     03S1037 01844000
*         IEDTTCD BASED(ADDR(WA1WRKSP));/* BASE TTC DSECT            */ 01845000
*       PRFDEST=PRFSRCE;            /* SET DESTINATION IN BUFFER     */ 01846000
         LH    @14,PRFSRCE(,RPREFIX)                            03S1038 01847000
         STH   @14,PRFDEST(,RPREFIX)                            03S1038 01848000
*       PRFLINK=''B;                /* CLEAR LINK FIELD              */ 01849000
         SLR   @14,@14                                          03S1039 01850000
         STCM  @14,7,PRFLINK(RPREFIX)                           03S1039 01851000
*       PRFSTAT1=''B;               /* CLEAR STATUS FLAGS            */ 01852000
         MVI   PRFSTAT1(RPREFIX),X'00'                          03S1040 01853000
*       PRFSCAN=''B;                /* CLEAR SCAN POINTER            */ 01854000
         STH   @14,PRFSCAN(,RPREFIX)                            03S1041 01855000
*       PRFSRCE=''B;                /* CLEAR SOURCE                  */ 01856000
         STH   @14,PRFSRCE(,RPREFIX)                            03S1042 01857000
*       IF PRFKEY=PRFSS|PRFKEY=PRFBSC|PRFKEY=PRFMULT THEN/* IF  03S1043 01858000
*                                      LCB/SCB PRESENT               */ 01859000
         CLI   PRFKEY(RPREFIX),X'08'                            03S1043 01860000
         BE    @RT01043                                         03S1043 01861000
         CLI   PRFKEY(RPREFIX),X'04'                            03S1043 01862000
         BE    @RT01043                                         03S1043 01863000
         CLI   PRFKEY(RPREFIX),X'14'                            03S1043 01864000
         BNE   @RF01043                                         03S1043 01865000
@RT01043 DS    0H                                               03S1044 01866000
*         DO;                                                   03S1044 01867000
*           SCBDESTQ=TRMDESTQ;      /* DESTINATION QUEUE             */ 01868000
         L     @14,PRFLCB-1(,RPREFIX)                           03S1045 01869000
         LA    @14,0(,@14)                                      03S1045 01870000
         L     @10,LCBSCBA-1(,@14)                              03S1045 01871000
         MVC   SCBDESTQ(3,@10),TRMDESTQ(RTRM)                   03S1045 01872000
*           IF PRFKEY=PRFMULT THEN /* IF NOT MULTIPLE BUFFER INPUT  */ 01873000
         CLI   PRFKEY(RPREFIX),X'14'                            03S1046 01874000
         BE    @RF01046                                         03S1046 01875000
*             DO;                   /* POST BUFFER TO BUFFER DISP    */ 01876000
*               PRFPRI=PRIDSPLB;    /* SET PRIORITY                  */ 01877000
         MVI   PRFPRI(RPREFIX),X'DF'                            03S1048 01878000
*               PRFQCBA=AVTMSGS->BDADDR;/* QCB ADDR BUFFER DISP      */ 01879000
         L     @10,AVTMSGS-1(,RAVT)                             03S1049 01880000
         MVC   PRFQCBA(3,RPREFIX),BDADDR+1(@10)                 03S1049 01881000
*               IF LCBRSKEY=ANRKEY THEN/* IF LOCAL 3270              */ 01882000
         CLI   LCBRSKEY(@14),X'1E'                              03S1050 01883000
         BNE   @RF01050                                         03S1050 01884000
*                 LCBTSTSW=ANRSW;   /* SET KEY                       */ 01885000
         MVI   LCBTSTSW(@14),X'F0'                              03S1051 01886000
*               ELSE                                            03S1052 01887000
*                 ;                                             03S1052 01888000
@RF01050 DS    0H                                               03S1053 01889000
*               SCBMACR=ADDR(AVTINOUT);/* DUMMY IN/OUT END           */ 01890000
         L     @14,PRFLCB-1(,RPREFIX)                           03S1053 01891000
         L     @14,LCBSCBA-1(,@14)                              03S1053 01892000
         LA    @10,AVTINOUT(,RAVT)                              03S1053 01893000
         STCM  @10,7,SCBMACR(@14)                               03S1053 01894000
*             END;                  /* END NOT MULT BUF              */ 01895000
*           ELSE                    /* MULTIPLE BUFFERED INPUT       */ 01896000
*             DO;                   /* POST BUFFER TO DEST QUEUE     */ 01897000
         B     @RC01046                                         03S1055 01898000
@RF01046 DS    0H                                               03S1056 01899000
*               PRFQCBA=TRMDESTQ;   /* QCB ADDR                      */ 01900000
         MVC   PRFQCBA(3,RPREFIX),TRMDESTQ(RTRM)                03S1056 01901000
*               PRFPRI=PRIDESTQ;    /* PRIORITY FOR DEST Q POST      */ 01902000
         MVI   PRFPRI(RPREFIX),X'E4'                            03S1057 01903000
*             END;                                              03S1058 01904000
*           RZERO=ADDR(WA1WRKSP);   /* WORKAREA USED BY POSTWAIT RTN */ 01905000
@RC01046 LA    RZERO,WA1WRKSP                                   03S1059 01906000
*           RPARM=RPREFIX;          /* ADDR OF BUFFER TO BE POSTED   */ 01907000
         LR    RPARM,RPREFIX                                    03S1060 01908000
*         END;                                                  03S1061 01909000
*       ELSE                        /* NO LCB/SCB AVAILABLE          */ 01910000
*         IF PRFKEY=PRFOPCTL THEN   /* IF OP CTL TERM REQUEST        */ 01911000
         B     @RC01043                                         03S1062 01912000
@RF01043 CLI   PRFKEY(RPREFIX),X'10'                            03S1062 01913000
         BNE   @RF01062                                         03S1062 01914000
*           DO;                     /* CREATE DUMMY LCB SCB          */ 01915000
*             PRFLCB=ADDR(WA1WRKSP)-(ADDR(LCBRCQCB)-ADDR(IEDQLCB));/*   01916000
*                                      ADDR OF DUMMY LCB             */ 01917000
         LA    @14,WA1WRKSP                                     03S1064 01918000
         LR    @10,@14                                          03S1064 01919000
         SL    @10,@CF00799                                     03S1064 01920000
         STCM  @10,7,PRFLCB(RPREFIX)                            03S1064 01921000
*             LCBSCBA=ADDR(TTCSCB); /* ADDR OF DUMMY SCB             */ 01922000
         LA    @07,40                                           03S1065 01923000
         ALR   @07,@14                                          03S1065 01924000
         LA    @03,TTCSCB(,@07)                                 03S1065 01925000
         STCM  @03,7,LCBSCBA(@10)                               03S1065 01926000
*             SCBSTATE=''B;         /* CLEAR SCB STATE FIELD         */ 01927000
         MVI   SCBSTATE(@03),X'00'                              03S1066 01928000
*             SCBDESTQ=TRMDESTQ;    /* DESTINATION Q                 */ 01929000
         MVC   SCBDESTQ(3,@03),TRMDESTQ(RTRM)                   03S1067 01930000
*             PRFPRI=PRIDESTQ;      /* PRIORITY FOR DEST Q POST      */ 01931000
         MVI   PRFPRI(RPREFIX),X'E4'                            03S1068 01932000
*             PRFQCBA=TRMDESTQ;     /* DEST Q                        */ 01933000
         MVC   PRFQCBA(3,RPREFIX),TRMDESTQ(RTRM)                03S1069 01934000
*             PRFLINK=ADDR(SYNCELMT);/* POINT TO SYNCHRONIZATION        01935000
*                                      ELEMENT TO SERIALIZE USE OF      01936000
*                                      DUMMY LCB                     */ 01937000
         LA    @10,SYNCELMT                                     03S1070 01938000
         STCM  @10,7,PRFLINK(RPREFIX)                           03S1070 01939000
*             SYNCQCB=ADDR(TTCQCB); /* QCB BUILT IN WORKAREA BY 03S1071 01940000
*                                      POSTWAIT                      */ 01941000
         ST    @07,SYNCQCB                                      03S1071 01942000
*             SYNCLINK=''B;         /* CLEAR LINK FIELD FOR POSTWAIT */ 01943000
         SLR   @10,@10                                          03S1072 01944000
         STCM  @10,7,SYNCLINK                                   03S1072 01945000
*             SYNCPRI=PRILNSCL;     /* PRIORITY LESS THAN PRIDESTQ      01946000
*                                                            @OX21052*/ 01947000
         MVI   SYNCPRI,X'E3'                                    03S1073 01948000
*             RZERO=ADDR(WA1WRKSP); /* WORKAREA FOR POSTWAIT         */ 01949000
         LR    RZERO,@14                                        03S1074 01950000
*             RPARM=RPREFIX;        /* POST BUFFER                   */ 01951000
         LR    RPARM,RPREFIX                                    03S1075 01952000
*             RPARM=RPARM|WAITKEY;  /* SET WAIT KEY IN HI ORDER BYTE */ 01953000
         O     RPARM,WAITKEY                                    03S1076 01954000
*           END;                    /* END OF OP CTL REQ TERM POST   */ 01955000
*         ELSE                      /* SNA TERMINAL                  */ 01956000
*           DO;                                                 03S1078 01957000
         B     @RC01062                                         03S1078 01958000
@RF01062 DS    0H                                               03S1079 01959000
*             PRFSRCE=SAVTSCPT;     /* SET TTCIN OF SSCP TERMINAL       01960000
*                                      ENTRY                         */ 01961000
         L     @14,AVTSAVTP(,RAVT)                              03S1079 01962000
         LH    @10,SAVTSCPT(,@14)                               03S1079 01963000
         N     @10,@CF03301                                     03S1079 01964000
         STH   @10,PRFSRCE(,RPREFIX)                            03S1079 01965000
*             PRFQCBA=ADDR(SAVTSCPQ);/* SSCP QCB                     */ 01966000
         LA    @14,SAVTSCPQ(,@14)                               03S1080 01967000
         STCM  @14,7,PRFQCBA(RPREFIX)                           03S1080 01968000
*             PRFPRI=PRIDESTQ;      /* DEST Q PRIORITY POST          */ 01969000
         MVI   PRFPRI(RPREFIX),X'E4'                            03S1081 01970000
*             IEDPF1=''B;           /* CLEAR NEG PREFIX              */ 01971000
         LR    @14,RPREFIX                                      03S1082 01972000
         SL    @14,@CF00047                                     03S1082 01973000
         XC    IEDPF1(8,@14),IEDPF1(@14)                        03S1082 01974000
*             PRF1RH=SSCPRH;        /* SET RH                        */ 01975000
         MVC   PRF1RH(3,@14),@CB03072                           03S1083 01976000
*             PRF1FIDI=ON;          /* FID 1 INDICATOR               */ 01977000
         OI    PRF1FIDI(@14),B'10000000'                        03S1084 01978000
*             PRF1FORM=PRF1PTRI;    /* SEQ NUMBER POINTER FLAG       */ 01979000
         NI    PRF1FORM(@14),B'11011111'                        03S1085 01980000
         OI    PRF1FORM(@14),B'00010000'                        03S1085 01981000
*             PRF1SEQP=ADDR(DATAPTR);/* DUMMY AREA FOR SEQ NUMBER    */ 01982000
         LA    @10,DATAPTR                                      03S1086 01983000
         ST    @10,PRF1SEQP(,@14)                               03S1086 01984000
*             RZERO=ADDR(WA1WRKSP); /* WORKAREA FOR POSTWAIT         */ 01985000
         LA    RZERO,WA1WRKSP                                   03S1087 01986000
*             RPARM=RPREFIX;        /* ADDR OF BUFFER                */ 01987000
         LR    RPARM,RPREFIX                                    03S1088 01988000
*           END;                    /* END SNA TERM PROCESSING       */ 01989000
*       CALL POSTWAIT;              /* POST BUFFER                   */ 01990000
@RC01062 DS    0H                                               03S1090 01991000
@RC01043 L     @15,RESPLRVT(,RRESPL)                            03S1090 01992000
         BALR  @14,@15                                          03S1090 01993000
*     END;                                                      02S1091 01994000
*   END REQMSG;                                                 02S1092 01995000
@EL00004 DS    0H                                               02S1092 01996000
@EF00004 DS    0H                                               02S1092 01997000
@ER00004 LM    @14,@12,@SA00004                                 02S1092 01998000
         BR    @14                                              02S1092 01999000
*                                                               02S1093 02000000
*   /*****************************************************************/ 02001000
*   /*                                                               */ 02002000
*   /* PROCESS.MHPROC.DEVFLMSG: THIS SEGMENT DOES THE PROCESSING     */ 02003000
*   /* NEEDED TO SEND MESSAGE IED244I, 'ERROR XXXXXXXXXX DETECTED    */ 02004000
*   /* ATTEMPTING/DURING I/O TO TERMINAL TERM NAME'                  */ 02005000
*   /*                                                               */ 02006000
*   /*****************************************************************/ 02007000
*                                                               02S1093 02008000
*DEVFLMSG:                                                      02S1093 02009000
*   PROC;                                                       02S1093 02010000
DEVFLMSG STM   @14,@12,@SA00005                                 02S1093 02011000
*   RFY                                                         02S1094 02012000
*     RZERO UNRSTD;                                             02S1094 02013000
*   RFY                                                         02S1095 02014000
*     RPARM UNRSTD;                                             02S1095 02015000
*   RFY                                                         02S1096 02016000
*     RELMT UNRSTD;                                             02S1096 02017000
*   RFY                                                         02S1097 02018000
*     RTRM UNRSTD;                                              02S1097 02019000
*   RFY                                                         02S1098 02020000
*     OLTCBPTR UNRSTD;                                          02S1098 02021000
*   RTNT=AVTRNMPT;                  /* TNT ADDRESS                   */ 02022000
         L     RTNT,AVTRNMPT(,RAVT)                             02S1099 02023000
*   ENTLEN=TNTENLEN+LENGTH(TNTTRMAD);/* LENGTH OF ENTRY              */ 02024000
         SLR   @14,@14                                          02S1100 02025000
         IC    @14,TNTENLEN(,RTNT)                              02S1100 02026000
         LA    @08,3                                            02S1100 02027000
         ALR   @08,@14                                          02S1100 02028000
         STH   @08,ENTLEN                                       02S1100 02029000
*   RFY                                                         02S1101 02030000
*     REG09 RSTD;                                               02S1101 02031000
*   REG09=ERRTTCIN-1;               /* ADJUST TTCIN                  */ 02032000
         LA    @07,PRFSUNIT(,RPREFIX)                           02S1102 02033000
         AH    @07,PRFSCAN(,RPREFIX)                            02S1102 02034000
         SLR   REG09,REG09                                      02S1102 02035000
         ICM   REG09,3,ERRTTCIN(@07)                            02S1102 02036000
         BCTR  REG09,0                                          02S1102 02037000
*   ENTLEN=REG09*ENTLEN;            /* DISPLACEMENT TO ENTRY         */ 02038000
         LR    @01,@08                                          02S1103 02039000
         MR    @00,REG09                                        02S1103 02040000
         STH   @01,ENTLEN                                       02S1103 02041000
*   RFY                                                         02S1104 02042000
*     REG09 UNRSTD;                                             02S1104 02043000
*   PTNTENT=ADDR(TNTFIRST)+ENTLEN;  /* ADDRESS OF TNT ENTRY          */ 02044000
         LA    PTNTENT,82                                       02S1105 02045000
         ALR   PTNTENT,RTNT                                     02S1105 02046000
         ALR   PTNTENT,@01                                      02S1105 02047000
*   NAM244I=''B;                    /* CLEAR TERM NAME FIELD IN PARM    02048000
*                                      LIST                          */ 02049000
         XC    NAM244I(8),NAM244I                               02S1106 02050000
*   NAM244I(1:TNTENLEN)=ENTNAME(1:TNTENLEN);/* MOVE IN TERM NAME     */ 02051000
         BCTR  @14,0                                            02S1107 02052000
         EX    @14,@SM03322                                     02S1107 02053000
*   CONVNUM=LENGTH(RCD244I);        /* LENGTH OF HEX DIGITS IN ERROR    02054000
*                                      RECORD                        */ 02055000
         MVC   CONVNUM(2),@CH01753                              02S1108 02056000
*   CONVSRC=ADDR(ERRRCRD);          /* ERROR RECORD IN ERRORMSG ELMT */ 02057000
         LA    @14,ERRRCRD(,@07)                                02S1109 02058000
         ST    @14,CONVSRC                                      02S1109 02059000
*   CONVTRG=ADDR(RCD244I);          /* ERROR RECORD IN PARM LIST     */ 02060000
         LA    CONVTRG,RCD244I                                  02S1110 02061000
*   CALL HEXCONV;                   /* CONVERT HEX TO EBCDIC HEX AND    02062000
*                                      MOVE                          */ 02063000
         BAL   @14,HEXCONV                                      02S1111 02064000
*   RFY                                                         02S1112 02065000
*     RPARM RSTD;                                               02S1112 02066000
*   RPARM=ADDR(IED244I);            /* POINT TO PARM LIST FOR WTO    */ 02067000
         LA    RPARM,IED244I                                    02S1113 02068000
*   SVC(35);                        /* ISSUE WTO                     */ 02069000
         SVC   35                                               02S1114 02070000
*   RFY                                                         02S1115 02071000
*     RZERO RSTD;                                               02S1115 02072000
*   RFY                                                         02S1116 02073000
*     RELMT RSTD;                                               02S1116 02074000
*   RFY                                                         02S1117 02075000
*     RTRM RSTD;                                                02S1117 02076000
*   RFY                                                         02S1118 02077000
*     OLTCBPTR RSTD;                                            02S1118 02078000
*   END DEVFLMSG;                                               02S1119 02079000
@EL00005 DS    0H                                               02S1119 02080000
@EF00005 DS    0H                                               02S1119 02081000
@ER00005 LM    @14,@12,@SA00005                                 02S1119 02082000
         BR    @14                                              02S1119 02083000
@PB00005 DS    0H                                               02S1119 02084000
*   END IEDQWA1                                                 01S1120 02085000
*                                                               01S1120 02086000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 02087000
*/*%INCLUDE SYSLIB  (TAVTD   )                                       */ 02088000
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */ 02089000
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */ 02090000
*/*%INCLUDE SYSLIB  (TDCTD   )                                       */ 02091000
*/*%INCLUDE SYSLIB  (TCD0D   )                                       */ 02092000
*/*%INCLUDE SYSLIB  (TLCBD   )                                       */ 02093000
*/*%INCLUDE SYSLIB  (OLTCB   )                                       */ 02094000
*/*%INCLUDE SYSLIB  (TPLMVD  )                                       */ 02095000
*/*%INCLUDE SYSLIB  (TPRFD   )                                       */ 02096000
*/*%INCLUDE SYSLIB  (TPRIOR  )                                       */ 02097000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 02098000
*/*%INCLUDE SYSLIB  (TQCBD   )                                       */ 02099000
*/*%INCLUDE SYSLIB  (TREQD   )                                       */ 02100000
*/*%INCLUDE SYSLIB  (RESPL   )                                       */ 02101000
*/*%INCLUDE SYSLIB  (TRHD    )                                       */ 02102000
*/*%INCLUDE SYSLIB  (TSCBD   )                                       */ 02103000
*/*%INCLUDE SYSLIB  (TSNSD   )                                       */ 02104000
*/*%INCLUDE SYSLIB  (TTHD    )                                       */ 02105000
*/*%INCLUDE SYSLIB  (TTNTD   )                                       */ 02106000
*/*%INCLUDE SYSLIB  (TTRMD   )                                       */ 02107000
*/*%INCLUDE SYSLIB  (TTTCD   )                                       */ 02108000
*/*%INCLUDE SYSLIB  (TXRTDD  )                                       */ 02109000
*/*%INCLUDE SYSUT5  (RFY     )                                       */ 02110000
*/*%INCLUDE SYSUT5  (DCL     )                                       */ 02111000
*/*%INCLUDE SYSUT5  (PROLOGUE)                                       */ 02112000
*/*%INCLUDE SYSUT5  (PROCESS )                                       */ 02113000
*/*%INCLUDE SYSUT5  (MHPROC  )                                       */ 02114000
*/*%INCLUDE SYSUT5  (STARTMH )                                       */ 02115000
*/*%INCLUDE SYSUT5  (CEINPUT )                                       */ 02116000
*/*%INCLUDE SYSUT5  (XLATE   )                                       */ 02117000
*/*%INCLUDE SYSUT5  (MOVEMSG )                                       */ 02118000
*/*%INCLUDE SYSUT5  (HDRPASS )                                       */ 02119000
*/*%INCLUDE SYSUT5  (CANCLREQ)                                       */ 02120000
*/*%INCLUDE SYSUT5  (CEREPLY )                                       */ 02121000
*/*%INCLUDE SYSUT5  (TESTDATA)                                       */ 02122000
*/*%INCLUDE SYSUT5  (CLEANUP )                                       */ 02123000
*/*%INCLUDE SYSUT5  (EPILOGUE)                                       */ 02124000
*/*%INCLUDE SYSUT5  (RTNBUF  )                                       */ 02125000
*/*%INCLUDE SYSUT5  (HEXCONV )                                       */ 02126000
*/*%INCLUDE SYSUT5  (REQMSG  )                                       */ 02127000
*/*%INCLUDE SYSUT5  (REQMSGMV)                                       */ 02128000
*/*%INCLUDE SYSUT5  (REQDEST )                                       */ 02129000
*/*%INCLUDE SYSUT5  (DEVFLMSG)                                       */ 02130000
*                                                               01S1120 02131000
*       ;                                                       01S1120 02132000
@DATA    DS    0H                                                       02133000
@CH00061 DC    H'6'                                                     02134000
@CH01479 DC    H'9'                                                     02135000
@CH01753 DC    H'10'                                                    02136000
@SB03308 TR    DATASTNG(0,@07),XTABLE(TABLPTR)                          02137000
@SC03310 CLC   TOTCTNAM(0,OLTCBPTR),CANLDATA(@10)                       02138000
@SM03322 MVC   NAM244I(0),ENTNAME(PTNTENT)                              02139000
         DS    0F                                                       02140000
@SA00001 DS    18F                                                      02141000
@SA00002 DS    1F                                                       02142000
@SA00005 DS    15F                                                      02143000
@SA00004 DS    15F                                                      02144000
         DS    0F                                                       02145000
@CF00063 DC    F'1'                                                     02146000
@CF00067 DC    F'2'                                                     02147000
@CF00076 DC    F'3'                                                     02148000
@CF00256 DC    F'4'                                                     02149000
@CF00033 DC    F'5'                                                     02150000
@CH00033 EQU   @CF00033+2                                               02151000
@CF00047 DC    F'8'                                                     02152000
@CF03106 DC    F'11'                                                    02153000
@CF03210 DC    F'17'                                                    02154000
@CF03293 DC    F'25'                                                    02155000
@CF00799 DC    F'56'                                                    02156000
@CF03304 DC    F'-14'                                                   02157000
@CF03300 DC    F'-13'                                                   02158000
@CF03320 DC    F'-8'                                                    02159000
@CF03314 DC    F'-4'                                                    02160000
@CF03301 DC    XL4'0000FFFF'                                            02161000
@CF00452 DC    XL4'1E'                                                  02162000
@CF03317 DC    BL4'00000010000000000000000000000000'                    02163000
         DS    0D                                                       02164000
DATAPTR  DS    A                                                        02165000
BACK13   DS    A                                                        02166000
DTCHOLT  DS    A                                                        02167000
CONVSRC  DS    A                                                        02168000
HEXSAV14 DS    A                                                        02169000
LOOPCTR  DS    H                                                        02170000
TRANSLEN DS    H                                                        02171000
CONVNUM  DS    H                                                        02172000
CONVIDX  DS    H                                                        02173000
EPSSL    DC    AL2(17+2)                                                02174000
EPBSCL   DC    AL2(1+17+3)                                              02175000
NCPL     DC    AL2(17+1)                                                02176000
S3270L   DC    AL2(2+17)                                                02177000
RTNCODE  DS    FL1                                                      02178000
@CC03076 DC    C'99999'                                                 02179000
@CC03082 DC    C'OLT='                                                  02180000
@CB03072 DC    X'038000'                                                02181000
         DS    CL3                                                      02182000
PARMLSP  DS    CL24                                                     02183000
WA1WRKSP DS    CL80                                                     02184000
PATCH    DC    XL100'0'                                                 02185000
FLAGS    DS    BL1                                                      02186000
         ORG   FLAGS                                                    02187000
TTYPEFLG DS    BL1                                                      02188000
REPLYFLG EQU   FLAGS+0                                                  02189000
CANCLFLG EQU   FLAGS+0                                                  02190000
XLATEFLG EQU   FLAGS+0                                                  02191000
BUFRTFLG EQU   FLAGS+0                                                  02192000
CLNUPFLG EQU   FLAGS+0                                                  02193000
FNDTFLG  EQU   FLAGS+0                                                  02194000
         ORG   FLAGS+1                                                  02195000
         DS    CL3                                                      02196000
WAITKEY  DC    X'E0000000'                                              02197000
HDRBSC   DS    CL3                                                      02198000
         ORG   HDRBSC                                                   02199000
SOHCHAR  DC    X'01'                                                    02200000
PERSLASH DC    CL2'%/'                                                  02201000
         ORG   HDRBSC+3                                                 02202000
ENDSYNC  DS    CL3                                                      02203000
         ORG   ENDSYNC                                                  02204000
SYCHCHAR DC    X'150337'                                                02205000
         ORG   ENDSYNC+3                                                02206000
ENDSS    DS    CL2                                                      02207000
         ORG   ENDSS                                                    02208000
SSCHAR   DC    X'1537'                                                  02209000
         ORG   ENDSS+2                                                  02210000
S3270    DS    CL2                                                      02211000
         ORG   S3270                                                    02212000
S3270CH  DC    X'F5C2'                                                  02213000
         ORG   S3270+2                                                  02214000
LOCISIZE DC    X'00FF'                                                  02215000
INVALTIC DC    X'000002'                                                02216000
STXCH    DS    CL1                                                      02217000
         ORG   STXCH                                                    02218000
STXCHAR  DC    X'02'                                                    02219000
         ORG   STXCH+1                                                  02220000
CANCLMSG DC    CL7'CANCEL/'                                             02221000
NLCHAR   DS    CL1                                                      02222000
         ORG   NLCHAR                                                   02223000
NEWLINE  DC    X'15'                                                    02224000
         ORG   NLCHAR+1                                                 02225000
HIMASK   DC    X'000F'                                                  02226000
ERRCODE  DC    X'0420'                                                  02227000
IED149I  DS    CL25                                                     02228000
         ORG   IED149I                                                  02229000
LEN149I  DC    AL2(21)                                                  02230000
MCS149I  DC    X'8000'                                                  02231000
MSG149I  DC    CL17'IED149I TOTE BUSY'                                  02232000
RTE149I  DC    X'0200'                                                  02233000
DSC149I  DC    X'0040'                                                  02234000
         ORG   IED149I+25                                               02235000
         DS    CL3                                                      02236000
IED244I  DS    CL75                                                     02237000
         ORG   IED244I                                                  02238000
LEN244I  DC    AL2(71)                                                  02239000
MCS244I  DC    X'8000'                                                  02240000
MSG244I  DS    CL67                                                     02241000
         ORG   MSG244I                                                  02242000
@NM00302 DC    CL14'IED244I ERROR '                                     02243000
RCD244I  DS    CL10                                                     02244000
@NM00303 DC    CL21' OCCURRED DURING I/O '                              02245000
@NM00304 DC    CL14'WITH TERMINAL '                                     02246000
NAM244I  DS    CL8                                                      02247000
         ORG   IED244I+71                                               02248000
RTE244I  DC    X'0200'                                                  02249000
DSC244I  DC    X'0040'                                                  02250000
         ORG   IED244I+75                                               02251000
HEXTCHAR DC    CL1'0'                                                   02252000
         DC    CL1'1'                                                   02253000
         DC    CL1'2'                                                   02254000
         DC    CL1'3'                                                   02255000
         DC    CL1'4'                                                   02256000
         DC    CL1'5'                                                   02257000
         DC    CL1'6'                                                   02258000
         DC    CL1'7'                                                   02259000
         DC    CL1'8'                                                   02260000
         DC    CL1'9'                                                   02261000
         DC    CL1'A'                                                   02262000
         DC    CL1'B'                                                   02263000
         DC    CL1'C'                                                   02264000
         DC    CL1'D'                                                   02265000
         DC    CL1'E'                                                   02266000
         DC    CL1'F'                                                   02267000
IEDQWA1  CSECT                                                          02268000
LOWTOUP  DS    0H                                                       02269000
         DC    X'000102030405060708090A0B0C0D0E0F'                      02270000
         DC    X'101112131415161718191A1B1C1D1E1F'                      02271000
         DC    X'202122232425262728292A2B2C2D2E2F'                      02272000
         DC    X'303132333435363738393A3B3C3D3E3F'                      02273000
         DC    X'404142434445464748494A4B4C4D4E4F'                      02274000
         DC    X'505152535455565758595A5B5C5D5E5F'                      02275000
         DC    X'606162636465666768696A6B6C6D6E6F'                      02276000
         DC    X'707172737475767778797A7B7C7D7E7F'                      02277000
         DC    X'80C1C2C3C4C5C6C7C8C98A8B8C8D8E8F'                      02278000
         DC    X'90D1D2D3D4D5D6D7D8D99A9B9C9D9E9F'                      02279000
         DC    X'A0A1E2E3E4E5E6E7E8E9AAABACADAEAF'                      02280000
         DC    X'B0B1B2B3B4B5B6B7B8B9BABBBCBDBEBF'                      02281000
         DC    X'C0C1C2C3C4C5C6C7C8C9CACBCCCDCECF'                      02282000
         DC    X'D0D1D2D3D4D5D6D7D8D9DADBDCDDDEDF'                      02283000
         DC    X'E0E1E2E3E4E5E6E7E8E9EAEBECEDEEEF'                      02284000
         DC    X'F0F1F2F3F4F5F6F7F8F9FAFBFCFDFEFF'                      02285000
IEDQWA1  CSECT                                                          02286000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02287000
@01      EQU   01                                                       02288000
@02      EQU   02                                                       02289000
@03      EQU   03                                                       02290000
@04      EQU   04                                                       02291000
@05      EQU   05                                                       02292000
@06      EQU   06                                                       02293000
@07      EQU   07                                                       02294000
@08      EQU   08                                                       02295000
@09      EQU   09                                                       02296000
@10      EQU   10                                                       02297000
@11      EQU   11                                                       02298000
@12      EQU   12                                                       02299000
@13      EQU   13                                                       02300000
@14      EQU   14                                                       02301000
@15      EQU   15                                                       02302000
I        EQU   @03                                                      02303000
CTNAMLEN EQU   @03                                                      02304000
CONVTRG  EQU   @10                                                      02305000
CTSRTADR EQU   @10                                                      02306000
TABLPTR  EQU   @10                                                      02307000
PTNTENT  EQU   @03                                                      02308000
MSGPTR   EQU   @03                                                      02309000
LCBXPTR  EQU   @05                                                      02310000
OLTCBPTR EQU   @09                                                      02311000
RAVT     EQU   @04                                                      02312000
RDCT     EQU   @09                                                      02313000
RPREFIX  EQU   @06                                                      02314000
RRESPL   EQU   @11                                                      02315000
RTNT     EQU   @15                                                      02316000
RTRM     EQU   @08                                                      02317000
RZERO    EQU   @00                                                      02318000
REG01    EQU   @01                                                      02319000
RPARM    EQU   @01                                                      02320000
RELMT    EQU   @02                                                      02321000
REG03    EQU   @03                                                      02322000
REG05    EQU   @05                                                      02323000
REG09    EQU   @09                                                      02324000
REG10    EQU   @10                                                      02325000
RSAVE    EQU   @13                                                      02326000
RRET     EQU   @14                                                      02327000
REG15    EQU   @15                                                      02328000
RBRNCH   EQU   @15                                                      02329000
RMSGLEN  EQU   @15                                                      02330000
REG00    EQU   @00                                                      02331000
REG02    EQU   @02                                                      02332000
REG04    EQU   @04                                                      02333000
REG06    EQU   @06                                                      02334000
REG07    EQU   @07                                                      02335000
REG08    EQU   @08                                                      02336000
REG11    EQU   @11                                                      02337000
REG12    EQU   @12                                                      02338000
REG13    EQU   @13                                                      02339000
REG14    EQU   @14                                                      02340000
PSA      EQU   0                                                        02341000
FLCRNPSW EQU   PSA                                                      02342000
FLCROPSW EQU   PSA+8                                                    02343000
FLCICCW2 EQU   PSA+16                                                   02344000
PSAEEPSW EQU   PSA+132                                                  02345000
PSAESPSW EQU   PSA+136                                                  02346000
FLCSVILC EQU   PSAESPSW+1                                               02347000
PSAEPPSW EQU   PSA+140                                                  02348000
FLCPIILC EQU   PSAEPPSW+1                                               02349000
FLCPICOD EQU   PSAEPPSW+2                                               02350000
PSAPICOD EQU   FLCPICOD+1                                               02351000
FLCTEA   EQU   PSAEPPSW+4                                               02352000
FLCPER   EQU   PSA+152                                                  02353000
FLCMCLA  EQU   PSA+168                                                  02354000
FLCIOEL  EQU   FLCMCLA+4                                                02355000
FLCIOA   EQU   FLCMCLA+16                                               02356000
FLCFSA   EQU   FLCMCLA+80                                               02357000
PSASUPER EQU   PSA+552                                                  02358000
PSASUP1  EQU   PSASUPER                                                 02359000
PSASUP2  EQU   PSASUPER+1                                               02360000
PSASUP3  EQU   PSASUPER+2                                               02361000
PSASUP4  EQU   PSASUPER+3                                               02362000
PSACLHT  EQU   PSA+640                                                  02363000
PSALKSA  EQU   PSA+696                                                  02364000
PSAHLHI  EQU   PSA+760                                                  02365000
PSALITA  EQU   PSA+764                                                  02366000
PSADSSFL EQU   PSA+836                                                  02367000
PSADSSF1 EQU   PSADSSFL                                                 02368000
PSADSSF3 EQU   PSADSSFL+2                                               02369000
PSADSSF4 EQU   PSADSSFL+3                                               02370000
PSARSVT  EQU   PSA+896                                                  02371000
IEDQAVTD EQU   0                                                        02372000
AVTSAVEX EQU   IEDQAVTD+288                                             02373000
AVTCSTCS EQU   IEDQAVTD+328                                             02374000
AVTREADD EQU   IEDQAVTD+380                                             02375000
AVTBUFSW EQU   IEDQAVTD+384                                             02376000
@NM00004 EQU   IEDQAVTD+388                                             02377000
AVTCKFLG EQU   @NM00004                                                 02378000
AVTBASE  EQU   IEDQAVTD+412                                             02379000
AVTPKF   EQU   AVTBASE                                                  02380000
AVTRNMPT EQU   IEDQAVTD+424                                             02381000
AVTMVBFR EQU   IEDQAVTD+444                                             02382000
AVTOSECB EQU   IEDQAVTD+492                                             02383000
AVTECB1  EQU   AVTOSECB                                                 02384000
AVTHG02  EQU   IEDQAVTD+528                                             02385000
AVTDISP  EQU   IEDQAVTD+552                                             02386000
AVTHD    EQU   IEDQAVTD+556                                             02387000
AVTSCOPT EQU   AVTHD                                                    02388000
AVTSAVTP EQU   IEDQAVTD+612                                             02389000
AVTSAVTF EQU   AVTSAVTP                                                 02390000
AVTCKPEL EQU   IEDQAVTD+652                                             02391000
AVTCKRMV EQU   AVTCKPEL                                                 02392000
AVTCKELF EQU   IEDQAVTD+680                                             02393000
AVTCKBYT EQU   IEDQAVTD+691                                             02394000
AVTHG01  EQU   IEDQAVTD+692                                             02395000
AVTCKLNK EQU   IEDQAVTD+696                                             02396000
AVTCRELE EQU   IEDQAVTD+708                                             02397000
AVTCCELE EQU   AVTCRELE                                                 02398000
AVTCLRHI EQU   IEDQAVTD+716                                             02399000
AVTADBUF EQU   IEDQAVTD+720                                             02400000
AVTSYSER EQU   IEDQAVTD+728                                             02401000
AVTMSGS  EQU   IEDQAVTD+729                                             02402000
AVTINOUT EQU   IEDQAVTD+766                                             02403000
AVTBFRFG EQU   IEDQAVTD+784                                             02404000
AVTBFRTB EQU   IEDQAVTD+792                                             02405000
AVTCKPQB EQU   IEDQAVTD+804                                             02406000
AVTCKPTB EQU   AVTCKPQB                                                 02407000
AVTCKPEC EQU   AVTCKPQB+4                                               02408000
AVTCKPCC EQU   AVTCKPEC                                                 02409000
AVTOPCQB EQU   IEDQAVTD+816                                             02410000
AVTOPCOB EQU   AVTOPCQB                                                 02411000
AVTOPCEC EQU   AVTOPCQB+4                                               02412000
AVTOPCCC EQU   AVTOPCEC                                                 02413000
AVTOLTQB EQU   IEDQAVTD+828                                             02414000
AVTOLTCH EQU   AVTOLTQB+1                                               02415000
AVTCWFL1 EQU   IEDQAVTD+924                                             02416000
AVTCWFL2 EQU   IEDQAVTD+925                                             02417000
AVTSUBT  EQU   IEDQAVTD+948                                             02418000
AVTIOTR  EQU   IEDQAVTD+949                                             02419000
AVTKEYLE EQU   IEDQAVTD+1032                                            02420000
AVTBIT1  EQU   IEDQAVTD+1050                                            02421000
AVTTSON  EQU   AVTBIT1                                                  02422000
AVTAQTAN EQU   AVTBIT1                                                  02423000
AVTBIT2  EQU   IEDQAVTD+1051                                            02424000
AVTBIT3  EQU   IEDQAVTD+1052                                            02425000
AVTDDFT  EQU   IEDQAVTD+1064                                            02426000
AVTBIT4  EQU   IEDQAVTD+1136                                            02427000
@NM00086 EQU   IEDQAVTD+1232                                            02428000
IEDQAPTR EQU   0                                                        02429000
IEDNSVTD EQU   0                                                        02430000
SAVTDIAG EQU   IEDNSVTD                                                 02431000
SAVTDIAF EQU   SAVTDIAG                                                 02432000
SAVTLUSQ EQU   IEDNSVTD+88                                              02433000
SAVTSCPQ EQU   IEDNSVTD+108                                             02434000
SAVTTCPU EQU   IEDNSVTD+238                                             02435000
SAVTSCPT EQU   SAVTTCPU                                                 02436000
SAVTNAX  EQU   IEDNSVTD+248                                             02437000
SAVTZELM EQU   IEDNSVTD+270                                             02438000
SAVTRDRV EQU   IEDNSVTD+284                                             02439000
SAVTCKQB EQU   IEDNSVTD+300                                             02440000
SAVTCKTB EQU   SAVTCKQB                                                 02441000
SAVTCKEC EQU   SAVTCKQB+4                                               02442000
SAVTCKCC EQU   SAVTCKEC                                                 02443000
IHADCB   EQU   0                                                        02444000
DCBPTR   EQU   0                                                        02445000
IHADCS16 EQU   0                                                        02446000
DCBMHA   EQU   IHADCS16                                                 02447000
DCBBUFOU EQU   DCBMHA                                                   02448000
DCBBUFIN EQU   DCBBUFOU                                                 02449000
DCBPCI   EQU   IHADCS16+5                                               02450000
DCBDSORG EQU   IHADCS16+6                                               02451000
DCBDSRG1 EQU   DCBDSORG                                                 02452000
DCBDSRG2 EQU   DCBDSORG+1                                               02453000
IHADCS17 EQU   0                                                        02454000
DCBCLPS  EQU   IHADCS17                                                 02455000
DCBIOBAD EQU   IHADCS17+8                                               02456000
IHADCS18 EQU   0                                                        02457000
DCBTRANA EQU   IHADCS18                                                 02458000
DCBTRANS EQU   DCBTRANA+1                                               02459000
IHADCS19 EQU   0                                                        02460000
DCBLCBAD EQU   IHADCS19                                                 02461000
DCBCPRI  EQU   DCBLCBAD                                                 02462000
DCBEXLST EQU   IHADCS19+4                                               02463000
IHADCS24 EQU   0                                                        02464000
DCBOFLGS EQU   IHADCS24+8                                               02465000
DCBOFLWR EQU   DCBOFLGS                                                 02466000
DCBIFLG  EQU   IHADCS24+9                                               02467000
DCBIBPCT EQU   DCBIFLG                                                  02468000
DCBMACR  EQU   IHADCS24+10                                              02469000
DCBMACR1 EQU   DCBMACR                                                  02470000
DCBMRFE  EQU   DCBMACR1                                                 02471000
DCBMRGET EQU   DCBMRFE                                                  02472000
DCBMRAPG EQU   DCBMACR1                                                 02473000
DCBMRRD  EQU   DCBMRAPG                                                 02474000
DCBMRCI  EQU   DCBMACR1                                                 02475000
DCBMRMVG EQU   DCBMRCI                                                  02476000
DCBMRLCG EQU   DCBMACR1                                                 02477000
DCBMRABC EQU   DCBMACR1                                                 02478000
DCBMRPT1 EQU   DCBMRABC                                                 02479000
DCBMRSBG EQU   DCBMRPT1                                                 02480000
DCBMRCRL EQU   DCBMACR1                                                 02481000
DCBMRCHK EQU   DCBMRCRL                                                 02482000
DCBMRRDX EQU   DCBMRCHK                                                 02483000
DCBMRDMG EQU   DCBMACR1                                                 02484000
DCBMACR2 EQU   DCBMACR+1                                                02485000
DCBMRPUT EQU   DCBMACR2                                                 02486000
DCBMRWRT EQU   DCBMACR2                                                 02487000
DCBMRMVP EQU   DCBMACR2                                                 02488000
DCBMR5WD EQU   DCBMACR2                                                 02489000
DCBMRLDM EQU   DCBMR5WD                                                 02490000
DCBMRLCP EQU   DCBMRLDM                                                 02491000
DCBMR4WD EQU   DCBMACR2                                                 02492000
DCBMRPT2 EQU   DCBMR4WD                                                 02493000
DCBMRTMD EQU   DCBMRPT2                                                 02494000
DCBMR3WD EQU   DCBMACR2                                                 02495000
DCBMRCTL EQU   DCBMR3WD                                                 02496000
DCBMRSTK EQU   DCBMRCTL                                                 02497000
DCBMR1WD EQU   DCBMACR2                                                 02498000
DCBMRSWA EQU   DCBMR1WD                                                 02499000
DCBMRDMD EQU   DCBMRSWA                                                 02500000
IHADCS25 EQU   0                                                        02501000
DCBMACRF EQU   IHADCS25+2                                               02502000
DCBMACF1 EQU   DCBMACRF                                                 02503000
DCBMFFE  EQU   DCBMACF1                                                 02504000
DCBMFGET EQU   DCBMFFE                                                  02505000
DCBMFAPG EQU   DCBMACF1                                                 02506000
DCBMFRD  EQU   DCBMFAPG                                                 02507000
DCBMFCI  EQU   DCBMACF1                                                 02508000
DCBMFMVG EQU   DCBMFCI                                                  02509000
DCBMFLCG EQU   DCBMACF1                                                 02510000
DCBMFABC EQU   DCBMACF1                                                 02511000
DCBMFPT1 EQU   DCBMFABC                                                 02512000
DCBMFSBG EQU   DCBMFPT1                                                 02513000
DCBMFCRL EQU   DCBMACF1                                                 02514000
DCBMFCHK EQU   DCBMFCRL                                                 02515000
DCBMFDMG EQU   DCBMACF1                                                 02516000
DCBMACF2 EQU   DCBMACRF+1                                               02517000
DCBMFPUT EQU   DCBMACF2                                                 02518000
DCBMFWRT EQU   DCBMACF2                                                 02519000
DCBMFMVP EQU   DCBMACF2                                                 02520000
DCBMF5WD EQU   DCBMACF2                                                 02521000
DCBMFLDM EQU   DCBMF5WD                                                 02522000
DCBMFLCP EQU   DCBMFLDM                                                 02523000
DCBMF4WD EQU   DCBMACF2                                                 02524000
DCBMFPT2 EQU   DCBMF4WD                                                 02525000
DCBMFTMD EQU   DCBMFPT2                                                 02526000
DCBMF3WD EQU   DCBMACF2                                                 02527000
DCBMFCTL EQU   DCBMF3WD                                                 02528000
DCBMFSTK EQU   DCBMFCTL                                                 02529000
DCBMF1WD EQU   DCBMACF2                                                 02530000
DCBMFSWA EQU   DCBMF1WD                                                 02531000
DCBMFDMD EQU   DCBMFSWA                                                 02532000
DCBDEBAD EQU   IHADCS25+4                                               02533000
DCBIFLGS EQU   DCBDEBAD                                                 02534000
DCBIFPCT EQU   DCBIFLGS                                                 02535000
IHADCS43 EQU   0                                                        02536000
DCBSCTAB EQU   IHADCS43                                                 02537000
IHADCS2A EQU   0                                                        02538000
DCBRESER EQU   IHADCS2A                                                 02539000
DCBINVLI EQU   IHADCS2A+4                                               02540000
DCBINVCI EQU   DCBINVLI                                                 02541000
IEDDCT   EQU   0                                                        02542000
DCTBYTE1 EQU   IEDDCT+1                                                 02543000
DCT3270  EQU   DCTBYTE1                                                 02544000
DCTBYTE2 EQU   IEDDCT+2                                                 02545000
DCTBYTE3 EQU   IEDDCT+3                                                 02546000
DCTNOIDL EQU   DCTBYTE3                                                 02547000
DCTBYTE4 EQU   IEDDCT+4                                                 02548000
DCTBYTE5 EQU   IEDDCT+5                                                 02549000
DCTL3270 EQU   DCTBYTE5                                                 02550000
IEDQLCB  EQU   0                                                        02551000
LCBRCB   EQU   IEDQLCB                                                  02552000
LCBQCBA  EQU   LCBRCB+1                                                 02553000
LCBPRI   EQU   LCBRCB+4                                                 02554000
LCBLINK  EQU   LCBRCB+5                                                 02555000
LCBRSKEY EQU   IEDQLCB+8                                                02556000
LCBTSOB  EQU   IEDQLCB+19                                               02557000
LCBCHAIN EQU   IEDQLCB+20                                               02558000
LCBSCRNN EQU   LCBCHAIN                                                 02559000
LCBTETEN EQU   LCBCHAIN                                                 02560000
LCBINSRC EQU   IEDQLCB+21                                               02561000
LCBLKMDE EQU   LCBINSRC+2                                               02562000
LCBNTXT  EQU   IEDQLCB+24                                               02563000
LCBSTAT4 EQU   LCBNTXT                                                  02564000
LCBPHASE EQU   LCBSTAT4                                                 02565000
LCBSCBDA EQU   IEDQLCB+25                                               02566000
LCBMHA   EQU   IEDQLCB+29                                               02567000
LCBFLAG1 EQU   IEDQLCB+32                                               02568000
LCBIOBSN EQU   IEDQLCB+33                                               02569000
LCBSNS   EQU   LCBIOBSN+1                                               02570000
LCBSENS0 EQU   LCBSNS                                                   02571000
LCBLOSDT EQU   LCBSENS0                                                 02572000
LCBTMOUT EQU   LCBSENS0                                                 02573000
LCBFLAG3 EQU   LCBIOBSN+7                                               02574000
LCBCSW   EQU   LCBIOBSN+8                                               02575000
LCBCSWST EQU   LCBCSW+3                                                 02576000
LCBCSWUS EQU   LCBCSWST                                                 02577000
LCBCSWCS EQU   LCBCSWST+1                                               02578000
LCBSIOCC EQU   LCBIOBSN+15                                              02579000
LCBDCBPT EQU   IEDQLCB+52                                               02580000
LCBRCQCB EQU   IEDQLCB+56                                               02581000
LCBRESTR EQU   LCBRCQCB                                                 02582000
LCBTHSQ  EQU   IEDQLCB+60                                               02583000
LCBINCAM EQU   LCBTHSQ                                                  02584000
LCBERRCT EQU   IEDQLCB+62                                               02585000
LCBLSPCI EQU   IEDQLCB+65                                               02586000
LCBRCBFR EQU   LCBLSPCI                                                 02587000
LCBSTATE EQU   IEDQLCB+70                                               02588000
LCBSTAT1 EQU   LCBSTATE                                                 02589000
LCBSTAT2 EQU   LCBSTATE+1                                               02590000
LCBBEOTN EQU   LCBSTAT2                                                 02591000
LCBNEGRP EQU   LCBSTAT2                                                 02592000
LCBSYNC  EQU   LCBSTAT2                                                 02593000
LCBDIAL  EQU   LCBSTAT2                                                 02594000
LCBTSTSW EQU   IEDQLCB+72                                               02595000
LCBERB   EQU   IEDQLCB+76                                               02596000
LCBERBST EQU   IEDQLCB+84                                               02597000
LCBDLNKN EQU   LCBERBST                                                 02598000
LCBERBCT EQU   IEDQLCB+88                                               02599000
LCBRBCT2 EQU   LCBERBCT+1                                               02600000
LCBMSGFM EQU   IEDQLCB+92                                               02601000
LCBOLT   EQU   LCBMSGFM                                                 02602000
LCBSCBA  EQU   IEDQLCB+93                                               02603000
LCBOBRCH EQU   IEDQLCB+96                                               02604000
LCBINVPT EQU   LCBOBRCH+1                                               02605000
LCBBFRW  EQU   LCBINVPT                                                 02606000
LCBTPCD  EQU   IEDQLCB+100                                              02607000
LCBSTAT5 EQU   LCBTPCD                                                  02608000
LCBSTAT6 EQU   LCBTPCD+4                                                02609000
LCBRSPSV EQU   LCBTPCD+8                                                02610000
LCBSAVSN EQU   IEDQLCB+112                                              02611000
LCBERCCW EQU   IEDQLCB+120                                              02612000
LCBCPA   EQU   IEDQLCB+144                                              02613000
LCBCCW5  EQU   LCBCPA+32                                                02614000
LCBATTEL EQU   LCBCCW5                                                  02615000
LCBQEBPL EQU   LCBATTEL                                                 02616000
IEDQLPTR EQU   0                                                        02617000
IEDQLCBX EQU   0                                                        02618000
LCBXCON  EQU   IEDQLCBX                                                 02619000
LCBXFLAG EQU   LCBXCON                                                  02620000
LCBXDCT  EQU   LCBXCON+1                                                02621000
LCBXRADR EQU   LCBXCON+4                                                02622000
TOTOLTCB EQU   0                                                        02623000
TOTOBPTR EQU   TOTOLTCB                                                 02624000
TOTELKEY EQU   TOTOBPTR                                                 02625000
TOTELLNK EQU   TOTOBPTR+5                                               02626000
$SCTTBLE EQU   TOTOLTCB+8                                               02627000
$TESTOPT EQU   $SCTTBLE+2                                               02628000
$ERROPT  EQU   $SCTTBLE+3                                               02629000
$PDEVFLG EQU   $SCTTBLE+10                                              02630000
$CDSFLGS EQU   $SCTTBLE+11                                              02631000
$EXECFLG EQU   $SCTTBLE+33                                              02632000
$OLTFLGS EQU   $SCTTBLE+36                                              02633000
$TOTFLG1 EQU   $SCTTBLE+38                                              02634000
TOTSAVE5 EQU   TOTOLTCB+416                                             02635000
TOTSRENT EQU   TOTOLTCB+584                                             02636000
TOTSROFF EQU   TOTSRENT                                                 02637000
TOTCTENT EQU   TOTOLTCB+592                                             02638000
TOTCTOFF EQU   TOTCTENT+2                                               02639000
TOTCROFF EQU   TOTCTENT+4                                               02640000
TOTCTFLG EQU   TOTCTENT+22                                              02641000
TOTCTNAM EQU   TOTCTENT+31                                              02642000
TOTCTDFL EQU   TOTOLTCB+632                                             02643000
TOTCUTST EQU   TOTOLTCB+636                                             02644000
TOTCUFLG EQU   TOTCUTST                                                 02645000
TOTPLIST EQU   TOTOLTCB+672                                             02646000
TOTOECBA EQU   TOTPLIST+12                                              02647000
TOTOFLG  EQU   TOTOECBA                                                 02648000
TOTOPCLN EQU   TOTOLTCB+736                                             02649000
TOTAPENT EQU   TOTOLTCB+744                                             02650000
TOTAPOFF EQU   TOTAPENT+2                                               02651000
TOTAROFF EQU   TOTAPENT+4                                               02652000
TOTAPFLG EQU   TOTAPENT+22                                              02653000
TOTAPDFL EQU   TOTOLTCB+775                                             02654000
TOTOLTMQ EQU   TOTOLTCB+808                                             02655000
TOTOTECB EQU   TOTOLTCB+812                                             02656000
TOTTCBAD EQU   TOTOLTCB+820                                             02657000
TOTCMPCD EQU   TOTOLTCB+824                                             02658000
TOTOLTPL EQU   TOTOLTCB+828                                             02659000
TOTWTORP EQU   TOTOLTCB+840                                             02660000
TOTWTOPL EQU   TOTOLTCB+848                                             02661000
TOTOLTID EQU   TOTOLTCB+1016                                            02662000
TOTPLNKQ EQU   TOTOLTCB+1020                                            02663000
TOTFLG01 EQU   TOTOLTCB+1192                                            02664000
TOTCONFG EQU   TOTFLG01                                                 02665000
TOTCLNST EQU   TOTFLG01                                                 02666000
TOTCLNED EQU   TOTFLG01                                                 02667000
TOTFLG02 EQU   TOTOLTCB+1193                                            02668000
TOTFLG03 EQU   TOTOLTCB+1194                                            02669000
TOTREPEX EQU   TOTFLG03                                                 02670000
TOTFLG04 EQU   TOTOLTCB+1195                                            02671000
TOTFLG05 EQU   TOTOLTCB+1196                                            02672000
TOTFLG06 EQU   TOTOLTCB+1197                                            02673000
TOTWACAN EQU   TOTFLG06                                                 02674000
TOTCANCL EQU   TOTFLG06                                                 02675000
TOTOTACT EQU   TOTFLG06                                                 02676000
TOTFLG07 EQU   TOTOLTCB+1198                                            02677000
TOTFLG08 EQU   TOTOLTCB+1199                                            02678000
TOTFLG09 EQU   TOTOLTCB+1200                                            02679000
TOTFLG10 EQU   TOTOLTCB+1201                                            02680000
TOTOLTED EQU   TOTFLG10                                                 02681000
TOTPRECB EQU   TOTOLTCB+1324                                            02682000
TOTPRIBK EQU   TOTPRECB                                                 02683000
TOTPRENT EQU   TOTOLTCB+1328                                            02684000
TOTPCOFF EQU   TOTPRENT+2                                               02685000
TOTPROFF EQU   TOTPRENT+4                                               02686000
TOTPRFLG EQU   TOTPRENT+22                                              02687000
TOTPRBUF EQU   TOTPRENT+32                                              02688000
TOTPRSN  EQU   TOTOLTCB+1372                                            02689000
TOTPRSEQ EQU   TOTPRSN+2                                                02690000
TOTPRDCB EQU   TOTOLTCB+1424                                            02691000
TOTSCECB EQU   TOTOLTCB+1496                                            02692000
TOTSCENT EQU   TOTOLTCB+1500                                            02693000
TOTNCOFF EQU   TOTSCENT+2                                               02694000
TOTSCOFF EQU   TOTSCENT+4                                               02695000
TOTSCFLG EQU   TOTSCENT+22                                              02696000
TOTSCBUF EQU   TOTSCENT+32                                              02697000
TOTSCSN  EQU   TOTOLTCB+1544                                            02698000
TOTSCSEQ EQU   TOTSCSN+2                                                02699000
TOTSCDCB EQU   TOTOLTCB+1596                                            02700000
TOTCROLT EQU   TOTOLTCB+1668                                            02701000
TOTTDTBL EQU   TOTOLTCB+1756                                            02702000
@NM00218 EQU   TOTTDTBL                                                 02703000
IEDPLMV  EQU   0                                                        02704000
PLMVTU   EQU   IEDPLMV                                                  02705000
PLMVTD   EQU   IEDPLMV+4                                                02706000
PLMVSU   EQU   IEDPLMV+8                                                02707000
PLMVSD   EQU   IEDPLMV+12                                               02708000
PLMVLNTH EQU   IEDPLMV+16                                               02709000
PLMVFLG1 EQU   IEDPLMV+18                                               02710000
PLMVSCTG EQU   PLMVFLG1                                                 02711000
PLMVTCTG EQU   PLMVFLG1                                                 02712000
IEDPLMVP EQU   0                                                        02713000
IEDQPRF  EQU   0                                                        02714000
PRFRCB   EQU   IEDQPRF                                                  02715000
PRFKEY   EQU   PRFRCB                                                   02716000
PRFQCBA  EQU   PRFRCB+1                                                 02717000
PRFPRI   EQU   PRFRCB+4                                                 02718000
PRFLINK  EQU   PRFRCB+5                                                 02719000
PRFTIC   EQU   IEDQPRF+8                                                02720000
PRFTICC  EQU   PRFTIC                                                   02721000
PRFNBUNT EQU   IEDQPRF+12                                               02722000
PRFSUNIT EQU   PRFNBUNT                                                 02723000
PRFPLQCB EQU   PRFSUNIT                                                 02724000
PRFLCB   EQU   IEDQPRF+13                                               02725000
@NM00229 EQU   IEDQPRF+16                                               02726000
PRFSVFFO EQU   @NM00229                                                 02727000
PRFSRCE  EQU   PRFSVFFO                                                 02728000
PRFSIZE  EQU   PRFSVFFO+2                                               02729000
PRFSTAT1 EQU   IEDQPRF+20                                               02730000
PRFERMGN EQU   PRFSTAT1                                                 02731000
PRFEOFN  EQU   PRFSTAT1                                                 02732000
PRFNLSTN EQU   PRFSTAT1                                                 02733000
PRFNHDRN EQU   PRFSTAT1                                                 02734000
PRFCORE  EQU   IEDQPRF+21                                               02735000
PRFXTRA  EQU   PRFCORE                                                  02736000
PRFSCAN  EQU   IEDQPRF+24                                               02737000
PRFTQBCK EQU   IEDQPRF+26                                               02738000
PRFNTXT  EQU   PRFTQBCK                                                 02739000
PRFEOBOF EQU   PRFNTXT                                                  02740000
PRFCHDR  EQU   IEDQPRF+32                                               02741000
PRFHQBCK EQU   IEDQPRF+35                                               02742000
PRFDEST  EQU   IEDQPRF+40                                               02743000
IEDQPPTR EQU   0                                                        02744000
IEDPF1   EQU   0                                                        02745000
PRF1RH   EQU   IEDPF1                                                   02746000
PRF1FLG1 EQU   IEDPF1+3                                                 02747000
PRF1FIDI EQU   PRF1FLG1                                                 02748000
PRF1FORM EQU   PRF1FLG1                                                 02749000
PRF1WD2  EQU   IEDPF1+4                                                 02750000
PRF1SEQP EQU   PRF1WD2                                                  02751000
PRF1SQID EQU   PRF1SEQP                                                 02752000
PRF1TAG1 EQU   PRF1SQID                                                 02753000
IEDPF2   EQU   0                                                        02754000
PRF2FLG2 EQU   IEDPF2                                                   02755000
PRF2WD2  EQU   IEDPF2+4                                                 02756000
IEDQQCB  EQU   0                                                        02757000
QCBDSFLG EQU   IEDQQCB                                                  02758000
QCBCORE  EQU   QCBDSFLG                                                 02759000
QCBDISK  EQU   QCBDSFLG                                                 02760000
QCBNREUS EQU   QCBDISK                                                  02761000
QCBREUS  EQU   QCBDISK                                                  02762000
QCBELCHN EQU   IEDQQCB+1                                                02763000
QCBEOLDT EQU   IEDQQCB+16                                               02764000
QCBBYTE1 EQU   QCBEOLDT+1                                               02765000
QCBLKRLN EQU   IEDQQCB+18                                               02766000
QCBRETCT EQU   QCBLKRLN                                                 02767000
QCBSTAT  EQU   IEDQQCB+19                                               02768000
QCBINSRC EQU   IEDQQCB+21                                               02769000
@NM00263 EQU   QCBINSRC                                                 02770000
QCBTSOF2 EQU   @NM00263+1                                               02771000
QCBTSOF1 EQU   @NM00263+2                                               02772000
QCBINTVL EQU   IEDQQCB+24                                               02773000
QCBPREN  EQU   IEDQQCB+28                                               02774000
QCBLKRRN EQU   QCBPREN+1                                                02775000
QCBDCBAD EQU   IEDQQCB+33                                               02776000
QCBFLAG  EQU   IEDQQCB+36                                               02777000
QCBTSSES EQU   QCBFLAG                                                  02778000
IEDQQPTR EQU   0                                                        02779000
IEDQPQCB EQU   0                                                        02780000
QCBFHDLZ EQU   IEDQPQCB+3                                               02781000
QCBPFEFO EQU   QCBFHDLZ+1                                               02782000
QCBFHDTZ EQU   IEDQPQCB+6                                               02783000
QCBINTLF EQU   IEDQPQCB+12                                              02784000
IEDNQCB  EQU   0                                                        02785000
QCBSTAT1 EQU   IEDNQCB+4                                                02786000
QCBPLCBA EQU   IEDNQCB+5                                                02787000
IEDREQD  EQU   0                                                        02788000
REQQCBA  EQU   IEDREQD+1                                                02789000
REQPRI   EQU   IEDREQD+4                                                02790000
REQLINK  EQU   IEDREQD+5                                                02791000
REQRPRI  EQU   IEDREQD+8                                                02792000
REQRQCBA EQU   IEDREQD+9                                                02793000
REQROUTE EQU   IEDREQD+12                                               02794000
REQRCDS  EQU   IEDREQD+14                                               02795000
REQDATA  EQU   IEDREQD+16                                               02796000
IEDRESPL EQU   0                                                        02797000
RESOBQCB EQU   IEDRESPL+12                                              02798000
RESOBFWD EQU   RESOBQCB                                                 02799000
RESBKTOT EQU   IEDRESPL+24                                              02800000
RESFLAGS EQU   IEDRESPL+49                                              02801000
RESTRMQ  EQU   IEDRESPL+52                                              02802000
RESQHBL  EQU   IEDRESPL+60                                              02803000
RESREMFR EQU   RESQHBL                                                  02804000
RESREMEL EQU   RESQHBL+4                                                02805000
RESADDND EQU   RESQHBL+8                                                02806000
RESADDAF EQU   RESQHBL+12                                               02807000
RESPLRVT EQU   IEDRESPL+76                                              02808000
RESABUF  EQU   IEDRESPL+80                                              02809000
RESFBUF  EQU   IEDRESPL+84                                              02810000
RESPLADR EQU   IEDRESPL+96                                              02811000
RESPLAC  EQU   RESPLADR+44                                              02812000
RESPL42  EQU   RESPLADR+56                                              02813000
IEDRH    EQU   0                                                        02814000
TRHBYTE0 EQU   IEDRH                                                    02815000
TRHBYTE1 EQU   IEDRH+1                                                  02816000
TRHBYTE2 EQU   IEDRH+2                                                  02817000
IEDQSCB  EQU   0                                                        02818000
SCBSTATE EQU   IEDQSCB                                                  02819000
SCBSEQIN EQU   SCBSTATE                                                 02820000
SCBDESTQ EQU   IEDQSCB+1                                                02821000
SCBRCVCT EQU   IEDQSCB+4                                                02822000
SCBMBHEN EQU   IEDQSCB+5                                                02823000
SCBMACR  EQU   SCBMBHEN                                                 02824000
SCBBKFCT EQU   IEDQSCB+9                                                02825000
SCBEOBSZ EQU   SCBBKFCT+1                                               02826000
SCBSALEV EQU   IEDQSCB+12                                               02827000
SCBQTYPE EQU   SCBSALEV                                                 02828000
SCBERRST EQU   IEDQSCB+16                                               02829000
SCBERR1  EQU   SCBERRST                                                 02830000
SCBHDRRN EQU   SCBERR1                                                  02831000
SCBORIGN EQU   SCBERR1                                                  02832000
SCBNOTRM EQU   SCBERR1                                                  02833000
SCBSEQHN EQU   SCBERR1                                                  02834000
SCBSEQLN EQU   SCBERR1                                                  02835000
SCBCUTFN EQU   SCBERR1                                                  02836000
SCBERR2  EQU   SCBERRST+1                                               02837000
SCBABRTN EQU   SCBERR2                                                  02838000
SCBERR3  EQU   SCBERRST+2                                               02839000
SCBLOSTN EQU   SCBERR3                                                  02840000
SCBTMIDN EQU   SCBERR3                                                  02841000
SCBFORMN EQU   SCBERR3                                                  02842000
SCBATTN  EQU   SCBERR3                                                  02843000
SCBXCEPN EQU   SCBERR3                                                  02844000
SCBERR4  EQU   SCBERRST+3                                               02845000
SCBTXTTN EQU   SCBERR4                                                  02846000
SCBCTLUN EQU   SCBERR4                                                  02847000
SCBCHANN EQU   SCBERR4                                                  02848000
SCBDLPTR EQU   IEDQSCB+22                                               02849000
SCBEOBAC EQU   SCBDLPTR                                                 02850000
SCBCTBAC EQU   SCBEOBAC                                                 02851000
SCBBSCFM EQU   IEDQSCB+24                                               02852000
SCBDATEN EQU   SCBBSCFM                                                 02853000
SCBITBSZ EQU   IEDQSCB+40                                               02854000
SCBCTBSV EQU   SCBITBSZ                                                 02855000
SCBDNSEG EQU   IEDQSCB+41                                               02856000
SCBCLSEG EQU   IEDQSCB+45                                               02857000
SCBITBAC EQU   IEDQSCB+48                                               02858000
SCBCTBFL EQU   SCBITBAC                                                 02859000
SCBBLKCT EQU   SCBCTBFL                                                 02860000
SCBDCSEG EQU   IEDQSCB+49                                               02861000
SCBSTAT1 EQU   IEDQSCB+60                                               02862000
SCBCORE  EQU   IEDQSCB+61                                               02863000
SCBSCAN  EQU   IEDQSCB+64                                               02864000
SCBNTXT  EQU   IEDQSCB+66                                               02865000
SCBCHDR  EQU   IEDQSCB+72                                               02866000
SCBCCSEG EQU   IEDQSCB+75                                               02867000
SCBEND   EQU   IEDQSCB+84                                               02868000
IEDQSPTR EQU   0                                                        02869000
IEDSNSD  EQU   0                                                        02870000
SNSSYSTM EQU   IEDSNSD                                                  02871000
SNSUSER  EQU   IEDSNSD+2                                                02872000
SNSPTR   EQU   0                                                        02873000
IEDTH    EQU   0                                                        02874000
TTHBYTE0 EQU   IEDTH                                                    02875000
TTHSNF   EQU   IEDTH+6                                                  02876000
TTHTAG   EQU   TTHSNF                                                   02877000
TTHTAG1  EQU   TTHTAG                                                   02878000
IEDQTNTD EQU   0                                                        02879000
IEDQTCDE EQU   IEDQTNTD                                                 02880000
TNTENLEN EQU   IEDQTNTD+40                                              02881000
IEDQTDCE EQU   IEDQTNTD+46                                              02882000
IEDQNPTR EQU   0                                                        02883000
TNTFIRST EQU   0                                                        02884000
IEDTNTA  EQU   0                                                        02885000
TNTTRMAD EQU   IEDTNTA                                                  02886000
IEDQTRM  EQU   0                                                        02887000
TRMSTATE EQU   IEDQTRM                                                  02888000
TRMLOG   EQU   TRMSTATE                                                 02889000
TRMPREF  EQU   TRMSTATE                                                 02890000
TRMDESTQ EQU   IEDQTRM+1                                                02891000
TRMINSEQ EQU   IEDQTRM+4                                                02892000
TLISTCNT EQU   TRMINSEQ                                                 02893000
TRMOUTSQ EQU   IEDQTRM+6                                                02894000
TLISTEN  EQU   TRMOUTSQ                                                 02895000
TRMDSORG EQU   TLISTEN                                                  02896000
TRMALTD  EQU   IEDQTRM+8                                                02897000
TRMDEVFL EQU   IEDQTRM+10                                               02898000
TRMCONC  EQU   TRMDEVFL+1                                               02899000
TRMSTAT  EQU   IEDQTRM+12                                               02900000
TRMCHCIN EQU   IEDQTRM+16                                               02901000
IEDQTPTR EQU   0                                                        02902000
IEDNTRM  EQU   0                                                        02903000
TRMBYTE4 EQU   IEDNTRM                                                  02904000
TRMBYTE3 EQU   IEDNTRM+1                                                02905000
TRMBYTE2 EQU   IEDNTRM+2                                                02906000
TRMINPG  EQU   TRMBYTE2                                                 02907000
TRMBYTE1 EQU   IEDNTRM+3                                                02908000
TRMSCPRQ EQU   TRMBYTE1                                                 02909000
TRMBYTE0 EQU   IEDNTRM+6                                                02910000
TRMSNA   EQU   TRMBYTE0                                                 02911000
TRMSIBPT EQU   IEDNTRM+7                                                02912000
IEDTTCD  EQU   0                                                        02913000
IEDTTCP  EQU   0                                                        02914000
IEDTTCPL EQU   0                                                        02915000
TTCSVCPL EQU   IEDTTCPL                                                 02916000
TTCSVCW1 EQU   TTCSVCPL                                                 02917000
TTCSVCW2 EQU   TTCSVCPL+4                                               02918000
IEDTTCFD EQU   0                                                        02919000
IEDTTCQB EQU   0                                                        02920000
TTCQCB   EQU   IEDTTCQB                                                 02921000
TTCSCB   EQU   IEDTTCQB+12                                              02922000
IEDXRTDD EQU   0                                                        02923000
XRTDCODE EQU   IEDXRTDD                                                 02924000
XRTDADDR EQU   IEDXRTDD+3                                               02925000
XRTDPBDU EQU   IEDXRTDD+5                                               02926000
XRTDEND  EQU   IEDXRTDD+9                                               02927000
IEDXRTDP EQU   0                                                        02928000
FREEBUF  EQU   0                                                        02929000
IEDIAP03 EQU   0                                                        02930000
IEDQTNT  EQU   0                                                        02931000
IEDMVBFR EQU   0                                                        02932000
POSTWAIT EQU   0                                                        02933000
XLATE    EQU   0                                                        02934000
XLATEWD1 EQU   XLATE                                                    02935000
XLATETYP EQU   XLATEWD1                                                 02936000
XLATECT  EQU   XLATEWD1+1                                               02937000
XTABPT   EQU   XLATE+4                                                  02938000
XTABLE   EQU   0                                                        02939000
DATABYTE EQU   0                                                        02940000
DATASTNG EQU   0                                                        02941000
REGSAVE  EQU   0                                                        02942000
BACKSAVE EQU   REGSAVE+4                                                02943000
BDADDR   EQU   0                                                        02944000
ERRELMT  EQU   0                                                        02945000
ERRTYPE  EQU   ERRELMT                                                  02946000
ERRTTCIN EQU   ERRELMT+1                                                02947000
ERRFLAGS EQU   ERRELMT+3                                                02948000
ERRSNA   EQU   ERRFLAGS                                                 02949000
ERRTEST  EQU   ERRFLAGS                                                 02950000
ERRDATA  EQU   ERRELMT+4                                                02951000
RUBYTE1  EQU   0                                                        02952000
ENTNAME  EQU   0                                                        02953000
MSGAREA  EQU   0                                                        02954000
BYTENUM  EQU   0                                                        02955000
ALLOCBUF EQU   0                                                        02956000
IEDQTL   EQU   0                                                        02957000
QADDAFX  EQU   0                                                        02958000
QADDNDX  EQU   0                                                        02959000
QCBLDCB  EQU   0                                                        02960000
QREMELX  EQU   0                                                        02961000
QREMFRX  EQU   0                                                        02962000
TNTCODE  EQU   0                                                        02963000
TNTDCODE EQU   0                                                        02964000
LCBRSPIN EQU   LCBIOBSN                                                 02965000
LCBLUSNS EQU   LCBRSPIN+5                                               02966000
LCBSCPRS EQU   LCBRSPIN+9                                               02967000
LCBCSWU1 EQU   LCBSCPRS+2                                               02968000
LCBRSPFG EQU   LCBRSPIN+15                                              02969000
LCBCOREQ EQU   LCBTPCD                                                  02970000
@NM00152 EQU   LCBCPA+40                                                02971000
LCBQNX   EQU   LCBERCCW                                                 02972000
LCBQNXMN EQU   LCBQNX                                                   02973000
LCBCANCL EQU   LCBSAVSN                                                 02974000
LCBCANFG EQU   LCBCANCL                                                 02975000
PRFSHDR  EQU   IEDQPRF+42                                               02976000
FLC      EQU   PSA                                                      02977000
PSARSVTE EQU   PSARSVT                                                  02978000
REQLDATA EQU   REQDATA                                                  02979000
REQSDATA EQU   REQDATA                                                  02980000
TRMPRE1  EQU   TRMBYTE4                                                 02981000
TRMERLCK EQU   TRMPRE1                                                  02982000
TRMNCP1  EQU   TRMBYTE4                                                 02983000
TRMPRE   EQU   TRMBYTE3                                                 02984000
TRMNCP   EQU   TRMBYTE3                                                 02985000
TRMPU    EQU   TRMBYTE3                                                 02986000
TRMLU    EQU   TRMBYTE3                                                 02987000
TRMTDIFF EQU   TRMLU                                                    02988000
TRMLINK  EQU   TRMBYTE3                                                 02989000
WORKAREA EQU   WA1WRKSP                                                 02990000
ENTLEN   EQU   CONVIDX                                                  02991000
TESTCOMP EQU   TRANSLEN                                                 02992000
WRKAREA1 EQU   WA1WRKSP+43                                              02993000
CANLDATA EQU   DATASTNG+7                                               02994000
CANLNAM  EQU   CANLDATA                                                 02995000
CANLLAST EQU   CANLNAM+7                                                02996000
WRKOLTID EQU   DATASTNG                                                 02997000
SYNCELMT EQU   PARMLSP                                                  02998000
SYNCQCB  EQU   SYNCELMT                                                 02999000
SYNCPRI  EQU   SYNCELMT+4                                               03000000
SYNCLINK EQU   SYNCELMT+5                                               03001000
ERRRCRD  EQU   ERRDATA                                                  03002000
ERRBYTES EQU   ERRRCRD                                                  03003000
ERRBYTE2 EQU   ERRBYTES+1                                               03004000
ERRRQREJ EQU   ERRBYTE2                                                 03005000
ERRSNS   EQU   ERRRCRD+4                                                03006000
ERRSNAT  EQU   ERRDATA                                                  03007000
ERRSENSE EQU   ERRSNAT+3                                                03008000
OPCLNDAT EQU   REQDATA                                                  03009000
OPTTCIN  EQU   OPCLNDAT                                                 03010000
TESTCTR  EQU   OPCLNDAT+8                                               03011000
HDRLEN   EQU   TRANSLEN                                                 03012000
HLDTOTPT EQU   TABLPTR                                                  03013000
SCBRGSAV EQU   SCBEND                                                   03014000
TRMOPT   EQU   IEDQTRM+20                                               03015000
XRTDTEXT EQU   XRTDEND                                                  03016000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    03017000
@NM00301 EQU   OPCLNDAT+2                                               03018000
ERRUSER  EQU   ERRSENSE+2                                               03019000
ERRMIN   EQU   ERRSENSE+1                                               03020000
ERRMAJ   EQU   ERRSENSE                                                 03021000
ERRRH    EQU   ERRSNAT                                                  03022000
ERRBYTE4 EQU   ERRBYTES+3                                               03023000
ERRBYTE3 EQU   ERRBYTES+2                                               03024000
@NM00300 EQU   ERRBYTE2                                                 03025000
@NM00299 EQU   ERRBYTE2                                                 03026000
ERRBYTE1 EQU   ERRBYTES                                                 03027000
CANLEND  EQU   CANLDATA+8                                               03028000
CANLFST7 EQU   CANLNAM                                                  03029000
@NM00293 EQU   TRMLINK                                                  03030000
TRMLSTAT EQU   TRMLINK                                                  03031000
TRMLINT  EQU   TRMLINK                                                  03032000
TRMEPMOD EQU   TRMLINK                                                  03033000
TRMLULOG EQU   TRMLU                                                    03034000
TRMINERR EQU   TRMLU                                                    03035000
TRMLUREQ EQU   TRMLU                                                    03036000
TRMSESRQ EQU   TRMLU                                                    03037000
TRMLUTM  EQU   TRMLU                                                    03038000
TRMLUIT  EQU   TRMLU                                                    03039000
TRMAUTO  EQU   TRMLU                                                    03040000
TRMPCONT EQU   TRMPU                                                    03041000
@NM00292 EQU   TRMPU                                                    03042000
TRMNCONT EQU   TRMNCP                                                   03043000
TRMQUCKN EQU   TRMNCP                                                   03044000
TRMSLOWN EQU   TRMNCP                                                   03045000
TRMSYGEN EQU   TRMNCP                                                   03046000
TRMNCPCL EQU   TRMNCP                                                   03047000
TRMIPLDM EQU   TRMNCP                                                   03048000
TRMINOUT EQU   TRMPRE                                                   03049000
TRMRDOUT EQU   TRMPRE                                                   03050000
TRMNLOUT EQU   TRMPRE                                                   03051000
TRMWROUT EQU   TRMPRE                                                   03052000
TRMASNXI EQU   TRMPRE                                                   03053000
TRMSTMM  EQU   TRMPRE                                                   03054000
TRMCMODE EQU   TRMPRE                                                   03055000
TRMSTPND EQU   TRMPRE                                                   03056000
@NM00291 EQU   TRMNCP1                                                  03057000
TRMINOP  EQU   TRMNCP1                                                  03058000
TRMLYNCH EQU   TRMPRE1                                                  03059000
TRMSPOUT EQU   TRMPRE1                                                  03060000
TRMQNPL  EQU   TRMPRE1                                                  03061000
TRMSPACT EQU   TRMPRE1                                                  03062000
TRMOCNI  EQU   TRMPRE1                                                  03063000
TRMSESSN EQU   TRMPRE1                                                  03064000
TRMCONT  EQU   TRMPRE1                                                  03065000
REQSTNT  EQU   REQSDATA+4                                               03066000
REQSTTE  EQU   REQSDATA                                                 03067000
REQLTNT  EQU   REQLDATA                                                 03068000
PSARSAV  EQU   PSARSVTE+60                                              03069000
PSARSTK  EQU   PSARSVTE+56                                              03070000
PSAESAV3 EQU   PSARSVTE+52                                              03071000
PSAESTK3 EQU   PSARSVTE+48                                              03072000
PSAESAV2 EQU   PSARSVTE+44                                              03073000
PSAESTK2 EQU   PSARSVTE+40                                              03074000
PSAESAV1 EQU   PSARSVTE+36                                              03075000
PSAESTK1 EQU   PSARSVTE+32                                              03076000
PSAPSAV  EQU   PSARSVTE+28                                              03077000
PSAPSTK  EQU   PSARSVTE+24                                              03078000
PSAMSAV  EQU   PSARSVTE+20                                              03079000
PSAMSTK  EQU   PSARSVTE+16                                              03080000
PSASSAV  EQU   PSARSVTE+12                                              03081000
PSASSTK  EQU   PSARSVTE+8                                               03082000
PSANSTK  EQU   PSARSVTE+4                                               03083000
PSACSTK  EQU   PSARSVTE                                                 03084000
@NM00160 EQU   LCBCANCL+3                                               03085000
LCBCANTH EQU   LCBCANCL+1                                               03086000
@NM00159 EQU   LCBCANFG                                                 03087000
LCBCANCD EQU   LCBCANFG                                                 03088000
@NM00158 EQU   LCBCANFG                                                 03089000
LCBCANEB EQU   LCBCANFG                                                 03090000
LCBCANXT EQU   LCBCANFG                                                 03091000
LCBUNADD EQU   LCBQNX+21                                                03092000
LCBUASZE EQU   LCBQNX+20                                                03093000
LCBDSTEA EQU   LCBQNX+16                                                03094000
@NM00157 EQU   LCBQNX+8                                                 03095000
LCBIOSBS EQU   LCBQNX+5                                                 03096000
@NM00156 EQU   LCBQNX+4                                                 03097000
LCBSTSAV EQU   LCBQNX+1                                                 03098000
@NM00155 EQU   LCBQNXMN                                                 03099000
LCBNX509 EQU   LCBQNXMN                                                 03100000
LCBNX162 EQU   LCBQNXMN                                                 03101000
LCBNX142 EQU   LCBQNXMN                                                 03102000
LCBNX064 EQU   LCBQNXMN                                                 03103000
@NM00154 EQU   @NM00152+4                                               03104000
LCBNCPPT EQU   @NM00152+1                                               03105000
@NM00153 EQU   @NM00152                                                 03106000
LCBWRSCH EQU   LCBCOREQ+8                                               03107000
LCBCQLNK EQU   LCBCOREQ+4                                               03108000
LCBCQELE EQU   LCBCOREQ                                                 03109000
LCBPAKCH EQU   LCBRSPIN+16                                              03110000
@NM00151 EQU   LCBRSPFG                                                 03111000
LCBRSRH  EQU   LCBRSPFG                                                 03112000
LCBEXPI  EQU   LCBRSPFG                                                 03113000
@NM00150 EQU   LCBRSPIN+12                                              03114000
LCBUSUE1 EQU   LCBCSWU1                                                 03115000
@NM00149 EQU   LCBCSWU1                                                 03116000
@NM00148 EQU   LCBSCPRS+1                                               03117000
LCBDFCMD EQU   LCBSCPRS                                                 03118000
LCBUSER  EQU   LCBLUSNS+2                                               03119000
LCBSMIN  EQU   LCBLUSNS+1                                               03120000
LCBSMAJ  EQU   LCBLUSNS                                                 03121000
LCBRHSV  EQU   LCBRSPIN+2                                               03122000
LCBSNS0  EQU   LCBRSPIN+1                                               03123000
@NM00147 EQU   LCBRSPIN                                                 03124000
@NM00298 EQU   REGSAVE+8                                                03125000
@NM00297 EQU   REGSAVE                                                  03126000
XRTDEXTR EQU   XRTDPBDU+3                                               03127000
XRTDSYSR EQU   XRTDPBDU+2                                               03128000
XRTDMODF EQU   XRTDPBDU+1                                               03129000
XRTDCMD0 EQU   XRTDPBDU                                                 03130000
XRTDREQ  EQU   XRTDCODE+2                                               03131000
XRTDMAIN EQU   XRTDCODE+1                                               03132000
XRTDNETS EQU   XRTDCODE                                                 03133000
TTCQSTCB EQU   TTCQCB+8                                                 03134000
TTCQBECB EQU   TTCQCB+4                                                 03135000
TTCQBELC EQU   TTCQCB+1                                                 03136000
TTCQBFLG EQU   TTCQCB                                                   03137000
@NM00296 EQU   IEDTTCFD                                                 03138000
@NM00295 EQU   IEDTTCPL+8                                               03139000
TTCLAST  EQU   TTCSVCW2                                                 03140000
TTCFIRST EQU   TTCSVCW1+1                                               03141000
TTCPCODE EQU   TTCSVCW1                                                 03142000
@NM00294 EQU   IEDTTCD                                                  03143000
TRMSUBST EQU   IEDNTRM+12                                               03144000
TRMTYPE  EQU   IEDNTRM+11                                               03145000
TRMRLMCT EQU   IEDNTRM+10                                               03146000
TRMCOHTG EQU   TRMSIBPT+1                                               03147000
TRMGPCNT EQU   TRMSIBPT                                                 03148000
TRMBUFRD EQU   TRMBYTE0                                                 03149000
TRMGP    EQU   TRMBYTE0                                                 03150000
TRMDIAL  EQU   TRMBYTE0                                                 03151000
@NM00290 EQU   TRMBYTE0                                                 03152000
TRMOUTPT EQU   TRMBYTE0                                                 03153000
TRMINPUT EQU   TRMBYTE0                                                 03154000
TRMUDEF  EQU   TRMBYTE0                                                 03155000
TRMCOHRT EQU   IEDNTRM+4                                                03156000
TRMSTOTE EQU   TRMBYTE1                                                 03157000
TRMCKPRN EQU   TRMBYTE1                                                 03158000
TRMTSATN EQU   TRMBYTE1                                                 03159000
TRMTRACE EQU   TRMBYTE1                                                 03160000
TRMSWBCK EQU   TRMBYTE1                                                 03161000
TRMAUTOC EQU   TRMBYTE1                                                 03162000
TRMINPTP EQU   TRMBYTE1                                                 03163000
TRMWTNEG EQU   TRMSCPRQ                                                 03164000
TRMWRBRK EQU   TRMBYTE2                                                 03165000
TRMNOSND EQU   TRMBYTE2                                                 03166000
TRMPREP  EQU   TRMBYTE2                                                 03167000
TRMGPACT EQU   TRMBYTE2                                                 03168000
TRMANDL  EQU   TRMBYTE2                                                 03169000
TRMCLOSN EQU   TRMINPG                                                  03170000
TRMREMB  EQU   TRMBYTE2                                                 03171000
TRMRSACT EQU   TRMBYTE2                                                 03172000
TRMOPTBL EQU   IEDQTRM+18                                               03173000
TRMOPNO  EQU   IEDQTRM+17                                               03174000
TRMSENSE EQU   TRMSTAT+3                                                03175000
TRMTEMPR EQU   TRMSTAT+2                                                03176000
TRMSIO   EQU   TRMSTAT                                                  03177000
@NM00289 EQU   TRMDEVFL+1                                               03178000
TRMTPIN  EQU   TRMDEVFL+1                                               03179000
TRMNCPI  EQU   TRMDEVFL+1                                               03180000
TRMRNTRM EQU   TRMDEVFL+1                                               03181000
@NM00288 EQU   TRMDEVFL+1                                               03182000
TRMLMD   EQU   TRMDEVFL+1                                               03183000
TRMTSOB  EQU   TRMDEVFL                                                 03184000
TRMBFDY  EQU   TRMDEVFL                                                 03185000
TRMTBLK  EQU   TRMDEVFL                                                 03186000
TRMSBLK  EQU   TRMDEVFL                                                 03187000
TRMBLKS  EQU   TRMDEVFL                                                 03188000
TRMADDC  EQU   TRMDEVFL                                                 03189000
TRMDDIG  EQU   TRMDEVFL                                                 03190000
TRMBUFS  EQU   TRMDEVFL                                                 03191000
TRMPRILK EQU   TRMALTD                                                  03192000
TRMLGB   EQU   TRMDSORG                                                 03193000
TRMUTERM EQU   TLISTCNT                                                 03194000
TRMSCNYN EQU   TRMSTATE                                                 03195000
TRMOPTFN EQU   TRMSTATE                                                 03196000
TRMHELDN EQU   TRMSTATE                                                 03197000
TRMACPTN EQU   TRMSTATE                                                 03198000
TRMPROC  EQU   TRMLOG                                                   03199000
TRMLIST  EQU   TRMLOG                                                   03200000
TRMLINE  EQU   TRMSTATE                                                 03201000
TNTLEN   EQU   IEDQTNTD+44                                              03202000
TNTMIDEN EQU   IEDQTNTD+41                                              03203000
TNTSRCHX EQU   IEDQTNTD+38                                              03204000
TTHDCF   EQU   IEDTH+8                                                  03205000
TTHTAG2  EQU   TTHTAG+1                                                 03206000
@NM00287 EQU   TTHTAG1                                                  03207000
TTHTAGS  EQU   TTHTAG1                                                  03208000
TTHOAF   EQU   IEDTH+4                                                  03209000
TTHDAF   EQU   IEDTH+2                                                  03210000
TTHBYTE1 EQU   IEDTH+1                                                  03211000
TTHEFI   EQU   TTHBYTE0                                                 03212000
@NM00286 EQU   TTHBYTE0                                                 03213000
TTHEBIU  EQU   TTHBYTE0                                                 03214000
TTHBBIU  EQU   TTHBYTE0                                                 03215000
TTHFTYPE EQU   TTHBYTE0                                                 03216000
SNSUSR2  EQU   SNSUSER+1                                                03217000
SNSUSR1  EQU   SNSUSER                                                  03218000
SNSMIN   EQU   SNSSYSTM+1                                               03219000
SNSMAJ   EQU   SNSSYSTM                                                 03220000
SCBTRANS EQU   IEDQSCB+81                                               03221000
SCBUNTCT EQU   IEDQSCB+80                                               03222000
SCBEOB   EQU   IEDQSCB+78                                               03223000
SCBNXCPB EQU   SCBCCSEG                                                 03224000
SCBNHDR  EQU   SCBCHDR                                                  03225000
SCBCRCD  EQU   IEDQSCB+69                                               03226000
SCBTQBCK EQU   SCBNTXT                                                  03227000
SCBOSEQ  EQU   SCBSCAN                                                  03228000
SCBXTRA  EQU   SCBCORE                                                  03229000
SCBNOPST EQU   SCBSTAT1                                                 03230000
SCBNIDLE EQU   SCBSTAT1                                                 03231000
SCBCEND  EQU   SCBSTAT1                                                 03232000
SCBCBGN  EQU   SCBSTAT1                                                 03233000
SCBSIZE  EQU   IEDQSCB+58                                               03234000
SCBSRCE  EQU   IEDQSCB+56                                               03235000
SCBDEOB  EQU   IEDQSCB+52                                               03236000
SCBFEFO  EQU   SCBDCSEG                                                 03237000
SCBCTBND EQU   SCBBLKCT                                                 03238000
SCBSCHDR EQU   SCBCLSEG                                                 03239000
SCBHBFNO EQU   IEDQSCB+44                                               03240000
SCBSCSEG EQU   SCBDNSEG                                                 03241000
SCBBCTR  EQU   SCBCTBSV                                                 03242000
SCBCCHDR EQU   IEDQSCB+37                                               03243000
SCBDESTL EQU   IEDQSCB+36                                               03244000
SCBDCHDR EQU   IEDQSCB+33                                               03245000
SCBCPBNO EQU   IEDQSCB+32                                               03246000
SCBMBSSA EQU   IEDQSCB+25                                               03247000
SCBMLMTN EQU   SCBBSCFM                                                 03248000
SCBNOEOT EQU   SCBBSCFM                                                 03249000
@NM00285 EQU   SCBBSCFM                                                 03250000
SCBNPDTR EQU   SCBDATEN                                                 03251000
SCBCNTEN EQU   SCBBSCFM                                                 03252000
SCBRCVTX EQU   SCBBSCFM                                                 03253000
SCBNONTR EQU   SCBBSCFM                                                 03254000
SCBTRNSP EQU   SCBBSCFM                                                 03255000
SCBENDCR EQU   SCBCTBAC+1                                               03256000
SCBCRLEN EQU   SCBCTBAC                                                 03257000
SCBMRFSD EQU   IEDQSCB+20                                               03258000
SCBUNDFN EQU   SCBERR4                                                  03259000
SCBSTERN EQU   SCBCHANN                                                 03260000
SCBCPMEN EQU   SCBCTLUN                                                 03261000
@NM00284 EQU   SCBERR4                                                  03262000
SCBTRMLN EQU   SCBERR4                                                  03263000
SCBCONNN EQU   SCBERR4                                                  03264000
SCBAPERR EQU   SCBTXTTN                                                 03265000
SCBSLCTN EQU   SCBERR4                                                  03266000
SCBPERRN EQU   SCBXCEPN                                                 03267000
SCBTHRSN EQU   SCBATTN                                                  03268000
SCBFIERN EQU   SCBFORMN                                                 03269000
SCBUSERN EQU   SCBERR3                                                  03270000
SCBSATTN EQU   SCBERR3                                                  03271000
SCBTMINN EQU   SCBERR3                                                  03272000
SCBXPD   EQU   SCBTMIDN                                                 03273000
SCBXPI   EQU   SCBLOSTN                                                 03274000
SCBSOHE  EQU   SCBERR2                                                  03275000
SCBFRWDN EQU   SCBERR2                                                  03276000
SCBRRJN  EQU   SCBABRTN                                                 03277000
SCBOLTR  EQU   SCBERR2                                                  03278000
SCBALN   EQU   SCBERR2                                                  03279000
SCBCODER EQU   SCBERR2                                                  03280000
SCBCRMAX EQU   SCBERR2                                                  03281000
SCBCRMIN EQU   SCBERR2                                                  03282000
SCBRVISL EQU   SCBCUTFN                                                 03283000
SCBNOBFN EQU   SCBERR1                                                  03284000
@NM00283 EQU   SCBERR1                                                  03285000
SCBNOVAC EQU   SCBSEQLN                                                 03286000
SCBNOTSO EQU   SCBSEQHN                                                 03287000
SCBRVITX EQU   SCBNOTRM                                                 03288000
SCBHANG  EQU   SCBORIGN                                                 03289000
SCBNOLOG EQU   SCBHDRRN                                                 03290000
SCBMRFPL EQU   IEDQSCB+13                                               03291000
SCBBFMM  EQU   SCBQTYPE                                                 03292000
SCBBBFTM EQU   SCBQTYPE                                                 03293000
SCBNOFF  EQU   SCBQTYPE                                                 03294000
SCBCONC  EQU   SCBQTYPE                                                 03295000
SCBNREUS EQU   SCBQTYPE                                                 03296000
SCBREUS  EQU   SCBQTYPE                                                 03297000
SCBCOREQ EQU   SCBQTYPE                                                 03298000
SCBNORCL EQU   SCBQTYPE                                                 03299000
SCBCTBSZ EQU   SCBEOBSZ                                                 03300000
@NM00282 EQU   SCBBKFCT                                                 03301000
SCBPRI   EQU   IEDQSCB+8                                                03302000
SCBSNDCT EQU   SCBRCVCT                                                 03303000
SCBCODE  EQU   SCBSTATE                                                 03304000
SCBPRER  EQU   SCBSTATE                                                 03305000
SCBCKPT  EQU   SCBSTATE                                                 03306000
SCBMSGLN EQU   SCBSTATE                                                 03307000
SCBERSDS EQU   SCBSTATE                                                 03308000
SCBLCK1N EQU   SCBSTATE                                                 03309000
SCBMGFMN EQU   SCBSEQIN                                                 03310000
SCBTRANP EQU   SCBSTATE                                                 03311000
@NM00281 EQU   TRHBYTE2                                                 03312000
@NM00280 EQU   TRHBYTE2                                                 03313000
@NM00279 EQU   TRHBYTE2                                                 03314000
TRHCSI   EQU   TRHBYTE2                                                 03315000
@NM00278 EQU   TRHBYTE2                                                 03316000
TRHCDI   EQU   TRHBYTE2                                                 03317000
TRHEB    EQU   TRHBYTE2                                                 03318000
TRHBB    EQU   TRHBYTE2                                                 03319000
TRHPI    EQU   TRHBYTE1                                                 03320000
@NM00277 EQU   TRHBYTE1                                                 03321000
@NM00276 EQU   TRHBYTE1                                                 03322000
@NM00275 EQU   TRHBYTE1                                                 03323000
TRHER    EQU   TRHBYTE1                                                 03324000
TRHDR2   EQU   TRHBYTE1                                                 03325000
@NM00274 EQU   TRHBYTE1                                                 03326000
TRHDR1   EQU   TRHBYTE1                                                 03327000
TRHEC    EQU   TRHBYTE0                                                 03328000
TRHBC    EQU   TRHBYTE0                                                 03329000
TRHSDI   EQU   TRHBYTE0                                                 03330000
TRHFI    EQU   TRHBYTE0                                                 03331000
@NM00273 EQU   TRHBYTE0                                                 03332000
TRHRUCAT EQU   TRHBYTE0                                                 03333000
TRHTYPE  EQU   TRHBYTE0                                                 03334000
RESAPDCB EQU   IEDRESPL+180                                             03335000
RESTLIB  EQU   IEDRESPL+176                                             03336000
RESPL33  EQU   RESPLADR+76                                              03337000
RESPL25  EQU   RESPLADR+72                                              03338000
RESPLM2  EQU   RESPLADR+68                                              03339000
RESPL47  EQU   RESPLADR+64                                              03340000
RESPL44  EQU   RESPLADR+60                                              03341000
RESPL43  EQU   RESPL42                                                  03342000
RESPL16  EQU   RESPLADR+52                                              03343000
RESPL41  EQU   RESPLADR+48                                              03344000
RESPL21  EQU   RESPLAC                                                  03345000
RESPL36  EQU   RESPLADR+40                                              03346000
RESPL28  EQU   RESPLADR+36                                              03347000
RESPL37  EQU   RESPLADR+32                                              03348000
RESPLP2  EQU   RESPLADR+28                                              03349000
RESPLP1  EQU   RESPLADR+24                                              03350000
RESPL39  EQU   RESPLADR+20                                              03351000
RESPLAA  EQU   RESPLADR+16                                              03352000
RESPL35  EQU   RESPLADR+12                                              03353000
RESPLAJ  EQU   RESPLADR+8                                               03354000
RESPLAB  EQU   RESPLADR+4                                               03355000
RESPLWO  EQU   RESPLADR                                                 03356000
RESTOTMH EQU   IEDRESPL+92                                              03357000
RESMHNAT EQU   IEDRESPL+90                                              03358000
RESMHSRC EQU   IEDRESPL+88                                              03359000
RESTNTPT EQU   IEDRESPL+57                                              03360000
@NM00272 EQU   IEDRESPL+56                                              03361000
@NM00271 EQU   IEDRESPL+50                                              03362000
@NM00270 EQU   RESFLAGS                                                 03363000
RESFIRST EQU   RESFLAGS                                                 03364000
RESINIT  EQU   RESFLAGS                                                 03365000
RESWBFNC EQU   IEDRESPL+48                                              03366000
RESSMGRA EQU   IEDRESPL+44                                              03367000
RESSTAEA EQU   IEDRESPL+40                                              03368000
RESETXRA EQU   IEDRESPL+36                                              03369000
RESDMTTE EQU   IEDRESPL+33                                              03370000
RESTNTCT EQU   IEDRESPL+32                                              03371000
RESEFQCB EQU   IEDRESPL+28                                              03372000
RESBKAVL EQU   IEDRESPL+26                                              03373000
RESTTLST EQU   IEDRESPL+20                                              03374000
RESOBBKW EQU   RESOBQCB+4                                               03375000
RESTECB1 EQU   IEDRESPL+8                                               03376000
@NM00269 EQU   IEDRESPL+5                                               03377000
@NM00268 EQU   IEDRESPL+4                                               03378000
RESTECBS EQU   IEDRESPL                                                 03379000
REQRCD2  EQU   REQRCDS+1                                                03380000
REQRCD1  EQU   REQRCDS                                                  03381000
REQSWTCH EQU   REQROUTE+1                                               03382000
REQFLAG  EQU   REQROUTE                                                 03383000
REQTYPE  EQU   IEDREQD                                                  03384000
QCBTTCIN EQU   QCBPLCBA+1                                               03385000
@NM00267 EQU   QCBPLCBA                                                 03386000
@NM00266 EQU   QCBSTAT1                                                 03387000
QCBFLUSH EQU   QCBSTAT1                                                 03388000
QCBNDXRQ EQU   QCBSTAT1                                                 03389000
QCBESIG  EQU   QCBSTAT1                                                 03390000
QCBRCVRQ EQU   QCBSTAT1                                                 03391000
QCBSNDRQ EQU   QCBSTAT1                                                 03392000
QCBWAITC EQU   QCBSTAT1                                                 03393000
QCBPLCBN EQU   QCBSTAT1                                                 03394000
QCBCHAIN EQU   IEDNQCB                                                  03395000
QCBPQBCK EQU   IEDQPQCB+25                                              03396000
QCBPRIPQ EQU   IEDQPQCB+24                                              03397000
QCBCFHDR EQU   IEDQPQCB+21                                              03398000
QCBLFEFO EQU   IEDQPQCB+18                                              03399000
QCBFFEFO EQU   IEDQPQCB+15                                              03400000
QCBPREVF EQU   QCBINTLF                                                 03401000
QCBINTFF EQU   IEDQPQCB+9                                               03402000
QCBDATSQ EQU   QCBFHDTZ+1                                               03403000
@NM00265 EQU   QCBFHDTZ                                                 03404000
@NM00264 EQU   QCBPFEFO                                                 03405000
QCBDATFL EQU   QCBFHDLZ                                                 03406000
QCBDNHDR EQU   IEDQPQCB                                                 03407000
QCBQBACK EQU   IEDQQCB+37                                               03408000
QCBCKPT  EQU   QCBFLAG                                                  03409000
QCBPROC  EQU   QCBFLAG                                                  03410000
QCBSDFFO EQU   QCBFLAG                                                  03411000
QCBTERMQ EQU   QCBFLAG                                                  03412000
QCBRSRV  EQU   QCBFLAG                                                  03413000
QCBREAD  EQU   QCBFLAG                                                  03414000
QCBNOBRK EQU   QCBFLAG                                                  03415000
QCBLGBAD EQU   QCBDCBAD                                                 03416000
QCBRELLN EQU   IEDQQCB+32                                               03417000
QCBTJID  EQU   QCBLKRRN+1                                               03418000
QCBCARCT EQU   QCBLKRRN                                                 03419000
QCBPRLVL EQU   QCBPREN                                                  03420000
QCBMSGCT EQU   IEDQQCB+26                                               03421000
QCBEXTO  EQU   QCBINTVL                                                 03422000
QCBDISC  EQU   QCBTSOF1                                                 03423000
QCBDELAY EQU   QCBTSOF1                                                 03424000
QCBPARTO EQU   QCBTSOF1                                                 03425000
QCBSATRD EQU   QCBTSOF1                                                 03426000
QCBNOBUF EQU   QCBTSOF1                                                 03427000
QCBTPUT  EQU   QCBTSOF1                                                 03428000
QCBTGET  EQU   QCBTSOF1                                                 03429000
QCBWRBRK EQU   QCBTSOF1                                                 03430000
QCBSATLC EQU   QCBTSOF2                                                 03431000
QCBSATTI EQU   QCBTSOF2                                                 03432000
QCBSATCH EQU   QCBTSOF2                                                 03433000
QCBSIMRD EQU   QCBTSOF2                                                 03434000
QCBDSSMI EQU   QCBTSOF2                                                 03435000
QCBPOSTO EQU   QCBTSOF2                                                 03436000
QCBBUFQ  EQU   QCBTSOF2                                                 03437000
QCBINHBN EQU   QCBTSOF2                                                 03438000
QCBSATCT EQU   @NM00263                                                 03439000
QCBSCBOF EQU   IEDQQCB+20                                               03440000
QCBTIME  EQU   QCBSTAT                                                  03441000
QCBCLOCK EQU   QCBSTAT                                                  03442000
QCBSCHDL EQU   QCBSTAT                                                  03443000
QCBSMODE EQU   QCBSTAT                                                  03444000
QCBSEND  EQU   QCBSTAT                                                  03445000
QCBBUFRD EQU   QCBSTAT                                                  03446000
QCBTRMHO EQU   QCBSTAT                                                  03447000
QCBEOM   EQU   QCBSTAT                                                  03448000
QCBHUCT  EQU   QCBRETCT                                                 03449000
QCBIEND  EQU   QCBRETCT                                                 03450000
QCBEND   EQU   QCBRETCT                                                 03451000
QCBNL    EQU   QCBRETCT                                                 03452000
QCBLOGCT EQU   QCBRETCT                                                 03453000
@NM00262 EQU   QCBBYTE1                                                 03454000
QCBRITRM EQU   QCBBYTE1                                                 03455000
@NM00261 EQU   QCBEOLDT                                                 03456000
QCBSLINK EQU   IEDQQCB+13                                               03457000
QCBSTPRI EQU   IEDQQCB+12                                               03458000
QCBSTCHN EQU   IEDQQCB+9                                                03459000
QCBSTVTO EQU   IEDQQCB+8                                                03460000
QCBLINK  EQU   IEDQQCB+5                                                03461000
QCBPRI   EQU   IEDQQCB+4                                                03462000
QCBCNTEN EQU   QCBELCHN+2                                               03463000
@NM00260 EQU   QCBELCHN+2                                               03464000
@NM00259 EQU   QCBELCHN                                                 03465000
QCBHELD  EQU   QCBDSFLG                                                 03466000
QCBFQCB  EQU   QCBDSFLG                                                 03467000
QCBDRQQ  EQU   QCBDSFLG                                                 03468000
QCBALTMH EQU   QCBDSFLG                                                 03469000
QCBTSQ   EQU   QCBDSFLG                                                 03470000
PRF2SEQP EQU   PRF2WD2                                                  03471000
@NM00234 EQU   IEDPF2+1                                                 03472000
@NM00233 EQU   PRF2FLG2                                                 03473000
PRF2TERM EQU   PRF2FLG2                                                 03474000
PRF2SMI  EQU   PRF2FLG2                                                 03475000
PRF2FORM EQU   PRF2FLG2                                                 03476000
PRF2TNTI EQU   PRF2FLG2                                                 03477000
PRF1RULN EQU   PRF1SEQP+2                                               03478000
PRF1TAG2 EQU   PRF1SQID+1                                               03479000
@NM00232 EQU   PRF1TAG1                                                 03480000
PRF1TAGS EQU   PRF1TAG1                                                 03481000
@NM00231 EQU   PRF1FLG1                                                 03482000
PRF1LOGD EQU   PRF1FLG1                                                 03483000
PRF1USS  EQU   PRF1FLG1                                                 03484000
PRF1EXPI EQU   PRF1FLG1                                                 03485000
PRFISEQ  EQU   IEDQPRF+38                                               03486000
PRFSTXT  EQU   PRFHQBCK                                                 03487000
PRFNHDR  EQU   PRFCHDR                                                  03488000
PRFCRCD  EQU   IEDQPRF+29                                               03489000
PRFSVSEQ EQU   PRFNTXT+1                                                03490000
PRFSVPRI EQU   PRFEOBOF                                                 03491000
PRFISIZE EQU   PRFSCAN+1                                                03492000
@NM00230 EQU   PRFSCAN                                                  03493000
PRFEOB   EQU   PRFXTRA+1                                                03494000
PRFSTSO  EQU   PRFXTRA                                                  03495000
PRFLOCK  EQU   PRFEOFN                                                  03496000
PRFDUPLN EQU   PRFSTAT1                                                 03497000
PRFTSMSG EQU   PRFSTAT1                                                 03498000
PRFITCPN EQU   PRFSTAT1                                                 03499000
PRFCNCLN EQU   PRFSTAT1                                                 03500000
PRFSVFLG EQU   @NM00229+3                                               03501000
PRFPIUO  EQU   PRFPLQCB                                                 03502000
PRFTI0   EQU   PRFTIC+1                                                 03503000
@NM00228 EQU   PRFTICC                                                  03504000
@NM00227 EQU   PRFTICC                                                  03505000
@NM00226 EQU   PRFTICC                                                  03506000
PRFTICON EQU   PRFTICC                                                  03507000
@NM00225 EQU   PRFTICC                                                  03508000
@NM00224 EQU   PRFTICC                                                  03509000
PRFBFMM  EQU   PRFTICC                                                  03510000
PRFEOMSG EQU   PRFTICC                                                  03511000
PRFCOUNT EQU   PRFLINK+1                                                03512000
@NM00223 EQU   PRFLINK                                                  03513000
PRFFLAGS EQU   PRFPRI                                                   03514000
PRFIOADR EQU   PRFQCBA                                                  03515000
PRFOPCDE EQU   PRFKEY                                                   03516000
PLMVUNCA EQU   IEDPLMV+20                                               03517000
PLMVFLG2 EQU   IEDPLMV+19                                               03518000
@NM00222 EQU   PLMVFLG1                                                 03519000
PLMVUNCF EQU   PLMVFLG1                                                 03520000
TOTOBEND EQU   TOTOLTCB+2108                                            03521000
TOTSERV  EQU   TOTOLTCB+2104                                            03522000
@NM00221 EQU   TOTOLTCB+2052                                            03523000
TOTWOWRK EQU   TOTOLTCB+1912                                            03524000
TOTWAWRK EQU   TOTOLTCB+1832                                            03525000
TOTOLTEN EQU   TOTOLTCB+1828                                            03526000
TOTAPNAM EQU   TOTOLTCB+1820                                            03527000
TOTGRABP EQU   TOTOLTCB+1816                                            03528000
TOTWAITI EQU   TOTOLTCB+1808                                            03529000
@NM00220 EQU   TOTOLTCB+1806                                            03530000
TOTTLCNT EQU   TOTOLTCB+1804                                            03531000
TOTECBPT EQU   TOTOLTCB+1800                                            03532000
TOTWECBA EQU   TOTOLTCB+1796                                            03533000
TOTTDEND EQU   TOTOLTCB+1796                                            03534000
@NM00219 EQU   TOTTDTBL+1                                               03535000
TOTTSWPM EQU   @NM00218                                                 03536000
TOTTDIAC EQU   @NM00218                                                 03537000
TOTTDTHD EQU   @NM00218                                                 03538000
TOTTDLST EQU   @NM00218                                                 03539000
TOTTDORN EQU   @NM00218                                                 03540000
TOTTDGRB EQU   @NM00218                                                 03541000
TOTTDLIN EQU   @NM00218                                                 03542000
TOTTDTRM EQU   @NM00218                                                 03543000
@NM00217 EQU   TOTOLTCB+1718                                            03544000
TOTCONND EQU   TOTOLTCB+1718                                            03545000
TOTCONAP EQU   TOTOLTCB+1717                                            03546000
TOTCONCT EQU   TOTOLTCB+1716                                            03547000
TOTCONTB EQU   TOTOLTCB+1706                                            03548000
TOTOLTTE EQU   TOTOLTCB+1706                                            03549000
TOTOLTTB EQU   TOTOLTCB+1676                                            03550000
TOTTRMND EQU   TOTCROLT                                                 03551000
TOTSCDEB EQU   TOTSCDCB+44                                              03552000
@NM00216 EQU   TOTSCDCB                                                 03553000
TOTSCIOB EQU   TOTOLTCB+1552                                            03554000
TOTSTECB EQU   TOTOLTCB+1548                                            03555000
@NM00215 EQU   TOTSCSN                                                  03556000
@NM00214 EQU   TOTOLTCB+1543                                            03557000
TOTSFLGS EQU   TOTOLTCB+1542                                            03558000
TOTSDTCT EQU   TOTOLTCB+1540                                            03559000
TOTSDTBF EQU   TOTOLTCB+1536                                            03560000
TOTSCCCW EQU   TOTSCENT+28                                              03561000
TOTSCQCB EQU   TOTSCENT+24                                              03562000
@NM00213 EQU   TOTSCENT+23                                              03563000
@NM00212 EQU   TOTSCFLG                                                 03564000
TOTSEXNM EQU   TOTSCFLG                                                 03565000
TOTSCFME EQU   TOTSCFLG                                                 03566000
TOTSCEX  EQU   TOTSCFLG                                                 03567000
TOTSUNRD EQU   TOTSCFLG                                                 03568000
TOTSPRSC EQU   TOTSCFLG                                                 03569000
TOTSCLU  EQU   TOTSCFLG                                                 03570000
TOTSCTAS EQU   TOTSCFLG                                                 03571000
TOTSCLEN EQU   TOTSCENT+20                                              03572000
TOTSRTNT EQU   TOTSCENT+16                                              03573000
TOTSDTNT EQU   TOTSCENT+12                                              03574000
TOTSCLCB EQU   TOTSCENT+9                                               03575000
TOTSCRLN EQU   TOTSCENT+8                                               03576000
TOTSRSID EQU   TOTSCENT+6                                               03577000
TOTSCUCB EQU   TOTSCENT                                                 03578000
TOTSCIBK EQU   TOTSCECB                                                 03579000
TOTPRDEB EQU   TOTPRDCB+44                                              03580000
@NM00211 EQU   TOTPRDCB                                                 03581000
TOTPRIOB EQU   TOTOLTCB+1380                                            03582000
TOTPTECB EQU   TOTOLTCB+1376                                            03583000
@NM00210 EQU   TOTPRSN                                                  03584000
@NM00209 EQU   TOTOLTCB+1371                                            03585000
TOTPFLGS EQU   TOTOLTCB+1370                                            03586000
TOTPDTCT EQU   TOTOLTCB+1368                                            03587000
TOTPDTBF EQU   TOTOLTCB+1364                                            03588000
TOTPRCCW EQU   TOTPRENT+28                                              03589000
TOTPRQCB EQU   TOTPRENT+24                                              03590000
@NM00208 EQU   TOTPRENT+23                                              03591000
@NM00207 EQU   TOTPRFLG                                                 03592000
TOTPEXNM EQU   TOTPRFLG                                                 03593000
TOTPRFME EQU   TOTPRFLG                                                 03594000
TOTPREX  EQU   TOTPRFLG                                                 03595000
TOTPUNRD EQU   TOTPRFLG                                                 03596000
TOTPPRSC EQU   TOTPRFLG                                                 03597000
TOTPRLU  EQU   TOTPRFLG                                                 03598000
TOTPRTAS EQU   TOTPRFLG                                                 03599000
TOTPRLEN EQU   TOTPRENT+20                                              03600000
TOTTNTPR EQU   TOTPRENT+16                                              03601000
TOTPDTNT EQU   TOTPRENT+12                                              03602000
TOTPRLCB EQU   TOTPRENT+9                                               03603000
TOTPRRLN EQU   TOTPRENT+8                                               03604000
TOTPRSID EQU   TOTPRENT+6                                               03605000
TOTPRUCB EQU   TOTPRENT                                                 03606000
TOTTRMBF EQU   TOTPRIBK                                                 03607000
TOTPASS  EQU   TOTOLTCB+1260                                            03608000
TOTEXT   EQU   TOTOLTCB+1204                                            03609000
@NM00206 EQU   TOTOLTCB+1203                                            03610000
TOTTTBEL EQU   TOTOLTCB+1202                                            03611000
TOTOLTRS EQU   TOTFLG10                                                 03612000
TOTOLTWT EQU   TOTFLG10                                                 03613000
TOTTNTRQ EQU   TOTFLG10                                                 03614000
@NM00205 EQU   TOTFLG10                                                 03615000
@NM00204 EQU   TOTFLG10                                                 03616000
@NM00203 EQU   TOTFLG10                                                 03617000
TOTTERMS EQU   TOTFLG10                                                 03618000
TOTMACFT EQU   TOTFLG09                                                 03619000
TOTPRECT EQU   TOTFLG09                                                 03620000
TOTLNCON EQU   TOTFLG09                                                 03621000
TOTNOBRK EQU   TOTFLG09                                                 03622000
TOTAPTRM EQU   TOTFLG09                                                 03623000
TOTCTCON EQU   TOTFLG09                                                 03624000
TOTAPOUT EQU   TOTFLG09                                                 03625000
TOTAPCON EQU   TOTFLG09                                                 03626000
@NM00202 EQU   TOTFLG08                                                 03627000
TOTFMCTL EQU   TOTFLG08                                                 03628000
TOTMSSRC EQU   TOTFLG07                                                 03629000
TOTMSPRT EQU   TOTFLG07                                                 03630000
TOTMSREP EQU   TOTFLG07                                                 03631000
TOTMSCEC EQU   TOTFLG07                                                 03632000
@NM00201 EQU   TOTFLG07                                                 03633000
@NM00200 EQU   TOTFLG07                                                 03634000
TOTSECEX EQU   TOTFLG07                                                 03635000
TOTPRIEX EQU   TOTFLG07                                                 03636000
TOTNPERR EQU   TOTFLG06                                                 03637000
TOTABEND EQU   TOTFLG06                                                 03638000
TOTNCMFG EQU   TOTFLG06                                                 03639000
TOTCBOPN EQU   TOTFLG06                                                 03640000
TOTOTERM EQU   TOTFLG06                                                 03641000
TOTNDMSG EQU   TOTFLG05                                                 03642000
TOTEXIOF EQU   TOTFLG05                                                 03643000
TOTTMOUT EQU   TOTFLG05                                                 03644000
TOTSRCON EQU   TOTFLG05                                                 03645000
TOTSRCE  EQU   TOTFLG05                                                 03646000
TOTREPLY EQU   TOTFLG05                                                 03647000
TOTCECOM EQU   TOTFLG05                                                 03648000
TOTPRINT EQU   TOTFLG05                                                 03649000
TOTTTSWT EQU   TOTFLG04                                                 03650000
@NM00199 EQU   TOTFLG04                                                 03651000
@NM00198 EQU   TOTFLG04                                                 03652000
TOTSCCTF EQU   TOTFLG04                                                 03653000
TOTPRCTF EQU   TOTFLG04                                                 03654000
TOTCLOSE EQU   TOTFLG04                                                 03655000
TOTDTCHD EQU   TOTFLG04                                                 03656000
TOTNUMDV EQU   TOTFLG04                                                 03657000
@NM00197 EQU   TOTFLG03                                                 03658000
TOTTSINC EQU   TOTFLG03                                                 03659000
TOTIMNCP EQU   TOTFLG03                                                 03660000
TOTOPTER EQU   TOTFLG03                                                 03661000
TOTTSTER EQU   TOTFLG03                                                 03662000
TOTTDFER EQU   TOTFLG03                                                 03663000
TOTAPOER EQU   TOTFLG03                                                 03664000
TOTDEVRN EQU   TOTFLG02                                                 03665000
TOTCONCU EQU   TOTFLG02                                                 03666000
TOTCONMD EQU   TOTFLG02                                                 03667000
TOTCHKSZ EQU   TOTFLG02                                                 03668000
TOTOLTRQ EQU   TOTFLG02                                                 03669000
TOTDEV0X EQU   TOTFLG02                                                 03670000
TOTTSST  EQU   TOTFLG02                                                 03671000
TOTTTSPE EQU   TOTFLG02                                                 03672000
TOTPRMPT EQU   TOTFLG01                                                 03673000
TOTAPTST EQU   TOTFLG01                                                 03674000
TOTEXIT  EQU   TOTFLG01                                                 03675000
TOTIPLCU EQU   TOTFLG01                                                 03676000
TOTFINAL EQU   TOTFLG01                                                 03677000
TOTRESPL EQU   TOTOLTCB+1188                                            03678000
TOTSTAE  EQU   TOTOLTCB+1184                                            03679000
TOTAVTPT EQU   TOTOLTCB+1180                                            03680000
@NM00196 EQU   TOTOLTCB+1160                                            03681000
TOTWKEND EQU   TOTOLTCB+1160                                            03682000
TOTWKSPC EQU   TOTOLTCB+1032                                            03683000
@NM00195 EQU   TOTOLTCB+1028                                            03684000
TOTPLBKW EQU   TOTPLNKQ+4                                               03685000
TOTPLFWD EQU   TOTPLNKQ                                                 03686000
@NM00194 EQU   TOTOLTCB+1019                                            03687000
TOTRTCOD EQU   TOTOLTCB+1018                                            03688000
TOTINBUF EQU   TOTWTOPL+88                                              03689000
TOTOTBUF EQU   TOTWTOPL+4                                               03690000
@NM00193 EQU   TOTWTOPL+2                                               03691000
TOTOTCNT EQU   TOTWTOPL+1                                               03692000
@NM00192 EQU   TOTWTOPL                                                 03693000
TOTINECB EQU   TOTWTORP+4                                               03694000
TOTINADR EQU   TOTWTORP+1                                               03695000
TOTINCNT EQU   TOTWTORP                                                 03696000
TOT#TBLE EQU   TOTOLTPL+8                                               03697000
@NM00191 EQU   TOTOLTPL                                                 03698000
TOTRESSV EQU   TOTOLTCB+816                                             03699000
TOTPARML EQU   TOTOLTCB+804                                             03700000
TOTPDECB EQU   TOTOLTCB+784                                             03701000
TOTAPDCB EQU   TOTOLTCB+780                                             03702000
@NM00190 EQU   TOTOLTCB+776                                             03703000
@NM00189 EQU   TOTAPDFL                                                 03704000
TOTAPIAC EQU   TOTAPDFL                                                 03705000
TOTAPHD  EQU   TOTAPDFL                                                 03706000
TOTAPLST EQU   TOTAPDFL                                                 03707000
TOTAPGP  EQU   TOTAPDFL                                                 03708000
@NM00188 EQU   TOTAPDFL                                                 03709000
TOTAPLIN EQU   TOTAPDFL                                                 03710000
TOTAPTER EQU   TOTAPDFL                                                 03711000
TOTAPRNL EQU   TOTAPENT+23                                              03712000
TOTAPEND EQU   TOTAPENT+23                                              03713000
TOTAPSWD EQU   TOTAPFLG                                                 03714000
@NM00187 EQU   TOTAPFLG                                                 03715000
TOTAPORN EQU   TOTAPFLG                                                 03716000
TOTAPASN EQU   TOTAPFLG                                                 03717000
TOTAPTLN EQU   TOTAPENT+20                                              03718000
TOTARTNT EQU   TOTAPENT+16                                              03719000
TOTAPTNT EQU   TOTAPENT+12                                              03720000
TOTAPLCB EQU   TOTAPENT+9                                               03721000
TOTAPRLN EQU   TOTAPENT+8                                               03722000
TOTARSID EQU   TOTAPENT+6                                               03723000
TOTAPUCB EQU   TOTAPENT                                                 03724000
TOTUSCOR EQU   TOTOLTCB+740                                             03725000
@NM00186 EQU   TOTOLTCB+698                                             03726000
TOTOALTT EQU   TOTOLTCB+696                                             03727000
TOTOLADR EQU   TOTPLIST+16                                              03728000
@NM00185 EQU   TOTOECBA+1                                               03729000
@NM00184 EQU   TOTOFLG                                                  03730000
TOTOATTC EQU   TOTOFLG                                                  03731000
TOTORTCD EQU   TOTPLIST+11                                              03732000
TOTORLN  EQU   TOTPLIST+10                                              03733000
TOTOELNG EQU   TOTPLIST+9                                               03734000
TOTOVBCD EQU   TOTPLIST+8                                               03735000
TOTOLINK EQU   TOTPLIST+5                                               03736000
TOTOPRI  EQU   TOTPLIST+4                                               03737000
TOTOQCBA EQU   TOTPLIST+1                                               03738000
TOTOKEY  EQU   TOTPLIST                                                 03739000
TOTWOOPC EQU   TOTOLTCB+648                                             03740000
TOTCURS4 EQU   TOTCUTST+11                                              03741000
TOTCURS3 EQU   TOTCUTST+10                                              03742000
TOTCURS2 EQU   TOTCUTST+9                                               03743000
TOTCURS1 EQU   TOTCUTST+8                                               03744000
TOTCUSAV EQU   TOTCUTST+4                                               03745000
TOTCUCUU EQU   TOTCUTST+2                                               03746000
TOTCU#AD EQU   TOTCUTST+1                                               03747000
@NM00183 EQU   TOTCUFLG                                                 03748000
TOTCUCUP EQU   TOTCUFLG                                                 03749000
TOTCUDON EQU   TOTCUFLG                                                 03750000
@NM00182 EQU   TOTOLTCB+633                                             03751000
@NM00181 EQU   TOTCTDFL                                                 03752000
TOTCTIAC EQU   TOTCTDFL                                                 03753000
TOTCTHD  EQU   TOTCTDFL                                                 03754000
TOTCTLST EQU   TOTCTDFL                                                 03755000
TOTCTGP  EQU   TOTCTDFL                                                 03756000
@NM00180 EQU   TOTCTDFL                                                 03757000
TOTCTLIN EQU   TOTCTDFL                                                 03758000
TOTCTTRM EQU   TOTCTDFL                                                 03759000
TOTCTRNL EQU   TOTCTENT+23                                              03760000
TOTCTEND EQU   TOTCTENT+23                                              03761000
TOTCTSWD EQU   TOTCTFLG                                                 03762000
@NM00179 EQU   TOTCTFLG                                                 03763000
TOTCTORN EQU   TOTCTFLG                                                 03764000
TOTCTASN EQU   TOTCTFLG                                                 03765000
TOTCTTLN EQU   TOTCTENT+20                                              03766000
TOTCRTNT EQU   TOTCTENT+16                                              03767000
TOTCTTNT EQU   TOTCTENT+12                                              03768000
TOTCTLCB EQU   TOTCTENT+9                                               03769000
TOTCTRLN EQU   TOTCTENT+8                                               03770000
TOTCRSID EQU   TOTCTENT+6                                               03771000
TOTCTUCB EQU   TOTCTENT                                                 03772000
TOTSRLCB EQU   TOTSRENT+4                                               03773000
@NM00178 EQU   TOTSRENT+2                                               03774000
TOTMMSPC EQU   TOTOLTCB+580                                             03775000
TOTBKRQD EQU   TOTOLTCB+578                                             03776000
TOTBKASN EQU   TOTOLTCB+576                                             03777000
TOTSVEND EQU   TOTOLTCB+576                                             03778000
TOTWOSV4 EQU   TOTOLTCB+572                                             03779000
TOTWOSV3 EQU   TOTOLTCB+568                                             03780000
TOTWOSV2 EQU   TOTOLTCB+564                                             03781000
TOTWOSV1 EQU   TOTOLTCB+560                                             03782000
TOTSAVE6 EQU   TOTOLTCB+488                                             03783000
@NM00177 EQU   TOTSAVE5+68                                              03784000
TOTOLTEP EQU   TOTSAVE5+64                                              03785000
@NM00176 EQU   TOTSAVE5+48                                              03786000
TOTOLTPT EQU   TOTSAVE5+44                                              03787000
@NM00175 EQU   TOTSAVE5                                                 03788000
TOTSAVE4 EQU   TOTOLTCB+344                                             03789000
TOTSAVE3 EQU   TOTOLTCB+272                                             03790000
TOTSAVE2 EQU   TOTOLTCB+200                                             03791000
TOTSAVE1 EQU   TOTOLTCB+128                                             03792000
TOTSMGRT EQU   TOTOLTCB+124                                             03793000
@NM00174 EQU   $SCTTBLE+92                                              03794000
$EXT     EQU   $SCTTBLE+88                                              03795000
$PASS    EQU   $SCTTBLE+84                                              03796000
$TABLE   EQU   $SCTTBLE+80                                              03797000
$MSGIDAC EQU   $SCTTBLE+78                                              03798000
@NM00173 EQU   $SCTTBLE+72                                              03799000
@NM00172 EQU   $SCTTBLE+71                                              03800000
$RETMASK EQU   $SCTTBLE+70                                              03801000
$R249255 EQU   $SCTTBLE+69                                              03802000
$R241248 EQU   $SCTTBLE+68                                              03803000
$R233240 EQU   $SCTTBLE+67                                              03804000
$R225232 EQU   $SCTTBLE+66                                              03805000
$R217224 EQU   $SCTTBLE+65                                              03806000
$R209216 EQU   $SCTTBLE+64                                              03807000
$R201208 EQU   $SCTTBLE+63                                              03808000
$R193200 EQU   $SCTTBLE+62                                              03809000
$R185192 EQU   $SCTTBLE+61                                              03810000
$R177184 EQU   $SCTTBLE+60                                              03811000
$R169176 EQU   $SCTTBLE+59                                              03812000
$R161168 EQU   $SCTTBLE+58                                              03813000
$R153160 EQU   $SCTTBLE+57                                              03814000
$R145152 EQU   $SCTTBLE+56                                              03815000
$R137144 EQU   $SCTTBLE+55                                              03816000
$R129136 EQU   $SCTTBLE+54                                              03817000
$R121128 EQU   $SCTTBLE+53                                              03818000
$R113120 EQU   $SCTTBLE+52                                              03819000
$R105112 EQU   $SCTTBLE+51                                              03820000
$R097104 EQU   $SCTTBLE+50                                              03821000
$R089096 EQU   $SCTTBLE+49                                              03822000
$R081088 EQU   $SCTTBLE+48                                              03823000
$R073080 EQU   $SCTTBLE+47                                              03824000
$R065072 EQU   $SCTTBLE+46                                              03825000
$R057064 EQU   $SCTTBLE+45                                              03826000
$R049056 EQU   $SCTTBLE+44                                              03827000
$R041048 EQU   $SCTTBLE+43                                              03828000
$R033040 EQU   $SCTTBLE+42                                              03829000
$R025032 EQU   $SCTTBLE+41                                              03830000
$R017024 EQU   $SCTTBLE+40                                              03831000
$TOTFLG2 EQU   $SCTTBLE+39                                              03832000
@NM00171 EQU   $TOTFLG1                                                 03833000
$CTEQTT  EQU   $TOTFLG1                                                 03834000
$TERMSEC EQU   $TOTFLG1                                                 03835000
$TDATBLK EQU   $TOTFLG1                                                 03836000
$LINESHR EQU   $TOTFLG1                                                 03837000
@NM00170 EQU   $SCTTBLE+37                                              03838000
@NM00169 EQU   $OLTFLGS                                                 03839000
$LASTSEC EQU   $OLTFLGS                                                 03840000
$TRACE   EQU   $OLTFLGS                                                 03841000
$RETCODE EQU   $OLTFLGS                                                 03842000
$CONTCB  EQU   $OLTFLGS                                                 03843000
$RETAIN  EQU   $OLTFLGS                                                 03844000
$CLEANRT EQU   $OLTFLGS                                                 03845000
$MANINTV EQU   $OLTFLGS                                                 03846000
$OLTSIZE EQU   $SCTTBLE+34                                              03847000
$QSCTMOD EQU   $EXECFLG                                                 03848000
$CTRLMOD EQU   $EXECFLG                                                 03849000
$CLEANUP EQU   $EXECFLG                                                 03850000
$LSTPDEV EQU   $EXECFLG                                                 03851000
$ERRCNT  EQU   $EXECFLG                                                 03852000
$RTNSLCT EQU   $EXECFLG                                                 03853000
$MULTDEV EQU   $EXECFLG                                                 03854000
$CECCMIN EQU   $EXECFLG                                                 03855000
$RMSKCNT EQU   $SCTTBLE+32                                              03856000
$CDS8T19 EQU   $SCTTBLE+20                                              03857000
$PDEVDSC EQU   $SCTTBLE+16                                              03858000
$PDEVADR EQU   $SCTTBLE+12                                              03859000
$COMMCN  EQU   $CDSFLGS                                                 03860000
$CUSTSYM EQU   $CDSFLGS                                                 03861000
$TWOCHSW EQU   $CDSFLGS                                                 03862000
$SYMNAME EQU   $CDSFLGS                                                 03863000
$EXTINTC EQU   $CDSFLGS                                                 03864000
$CEVOL   EQU   $CDSFLGS                                                 03865000
$SHARED  EQU   $CDSFLGS                                                 03866000
$FPM     EQU   $CDSFLGS                                                 03867000
$LASTSUB EQU   $PDEVFLG                                                 03868000
$PATHDEF EQU   $PDEVFLG                                                 03869000
$TERMNDX EQU   $PDEVFLG                                                 03870000
@NM00168 EQU   $PDEVFLG                                                 03871000
$LASTDEV EQU   $PDEVFLG                                                 03872000
$TSSSYS1 EQU   $PDEVFLG                                                 03873000
$EXFILPT EQU   $PDEVFLG                                                 03874000
$FPMOLD  EQU   $PDEVFLG                                                 03875000
$TSSSYM  EQU   $SCTTBLE+8                                               03876000
$SPARE1  EQU   $SCTTBLE+7                                               03877000
$DRIVER  EQU   $SCTTBLE+6                                               03878000
$RT0916  EQU   $SCTTBLE+5                                               03879000
$RT0108  EQU   $SCTTBLE+4                                               03880000
$LOOPTST EQU   $ERROPT                                                  03881000
$LOOPERR EQU   $ERROPT                                                  03882000
$NERRPRT EQU   $ERROPT                                                  03883000
$NOCNTRL EQU   $ERROPT                                                  03884000
$ALTPRNT EQU   $ERROPT                                                  03885000
$CATERR  EQU   $ERROPT                                                  03886000
$ASTERIK EQU   $ERROPT                                                  03887000
$TESTERR EQU   $ERROPT                                                  03888000
$FSTCOMM EQU   $TESTOPT                                                 03889000
$INDEFLP EQU   $TESTOPT                                                 03890000
$NOPRT   EQU   $TESTOPT                                                 03891000
@NM00167 EQU   $TESTOPT                                                 03892000
$ERRLPCT EQU   $SCTTBLE                                                 03893000
@NM00166 EQU   TOTOBPTR+4                                               03894000
TOTELQCB EQU   TOTOBPTR+1                                               03895000
LCBERADR EQU   LCBXRADR+1                                               03896000
LCBPCIRC EQU   LCBXRADR                                                 03897000
LCBDCT3  EQU   LCBXDCT+2                                                03898000
LCBDCT2  EQU   LCBXDCT+1                                                03899000
LCBDCT1  EQU   LCBXDCT                                                  03900000
@NM00165 EQU   LCBXFLAG                                                 03901000
LCBERPND EQU   LCBXFLAG                                                 03902000
LCBSRCPF EQU   LCBXFLAG                                                 03903000
LCBGPCTV EQU   LCBXFLAG                                                 03904000
@NM00164 EQU   LCBXFLAG                                                 03905000
@NM00163 EQU   LCBXFLAG                                                 03906000
@NM00162 EQU   LCBXFLAG                                                 03907000
@NM00161 EQU   LCBXFLAG                                                 03908000
LCBCCW10 EQU   LCBCPA+72                                                03909000
LCBCCW9  EQU   LCBCPA+64                                                03910000
LCBCCW8  EQU   LCBCPA+56                                                03911000
LCBCCW7  EQU   LCBCPA+48                                                03912000
LCBCCW6  EQU   LCBCPA+40                                                03913000
LCBCP    EQU   LCBQEBPL+4                                               03914000
LCBIOSB  EQU   LCBQEBPL+1                                               03915000
LCBSIO   EQU   LCBQEBPL                                                 03916000
LCBCCW4  EQU   LCBCPA+24                                                03917000
LCBCCW3  EQU   LCBCPA+16                                                03918000
LCBCCW2  EQU   LCBCPA+8                                                 03919000
LCBCCW1  EQU   LCBCPA                                                   03920000
@NM00146 EQU   LCBERCCW+16                                              03921000
LCBATL05 EQU   LCBERCCW+8                                               03922000
@NM00145 EQU   LCBERCCW                                                 03923000
LCBCSWSV EQU   LCBSAVSN+1                                               03924000
LCBSNSV  EQU   LCBSAVSN                                                 03925000
LCBBFSNS EQU   LCBRSPSV                                                 03926000
LCBWAITC EQU   LCBTPCD+5                                                03927000
LCBINPAK EQU   LCBSTAT6                                                 03928000
LCBMHBID EQU   LCBSTAT6                                                 03929000
LCBRTRRO EQU   LCBSTAT6                                                 03930000
LCBHDRPD EQU   LCBSTAT6                                                 03931000
LCBCHN   EQU   LCBSTAT6                                                 03932000
LCBBFRSV EQU   LCBTPCD+1                                                03933000
@NM00144 EQU   LCBSTAT5                                                 03934000
LCBLUS   EQU   LCBSTAT5                                                 03935000
LCBLUNIT EQU   LCBSTAT5                                                 03936000
LCBPERM  EQU   LCBSTAT5                                                 03937000
LCBNXCMD EQU   LCBBFRW                                                  03938000
LCBERMSK EQU   LCBOBRCH                                                 03939000
LCBEOT   EQU   LCBMSGFM                                                 03940000
LCBENQ   EQU   LCBMSGFM                                                 03941000
LCBTTD   EQU   LCBMSGFM                                                 03942000
LCBRSTRT EQU   LCBMSGFM                                                 03943000
LCBVSTRT EQU   LCBMSGFM                                                 03944000
LCBACKI  EQU   LCBMSGFM                                                 03945000
LCBNAK   EQU   LCBMSGFM                                                 03946000
LCBTTCIN EQU   IEDQLCB+90                                               03947000
@NM00143 EQU   LCBRBCT2                                                 03948000
LCBDCNT  EQU   LCBRBCT2                                                 03949000
LCBRBCT1 EQU   LCBERBCT                                                 03950000
LCBERBCH EQU   IEDQLCB+85                                               03951000
LCBCOMPL EQU   LCBDLNKN                                                 03952000
LCBPRCPG EQU   LCBERBST                                                 03953000
LCBERROR EQU   LCBERBST                                                 03954000
LCBLOGDV EQU   LCBERBST                                                 03955000
LCBINQ   EQU   LCBERBST                                                 03956000
LCBRDERR EQU   LCBERBST                                                 03957000
LCBEOMSG EQU   LCBERBST                                                 03958000
LCBMSG   EQU   LCBERBST                                                 03959000
LCBERBLK EQU   IEDQLCB+81                                               03960000
LCBERBPY EQU   IEDQLCB+80                                               03961000
LCBERBQB EQU   LCBERB+1                                                 03962000
LCBERBKY EQU   LCBERB                                                   03963000
LCBRECAD EQU   IEDQLCB+73                                               03964000
@NM00142 EQU   LCBTSTSW                                                 03965000
@NM00141 EQU   LCBTSTSW                                                 03966000
@NM00140 EQU   LCBTSTSW                                                 03967000
@NM00139 EQU   LCBTSTSW                                                 03968000
@NM00138 EQU   LCBTSTSW                                                 03969000
@NM00137 EQU   LCBTSTSW                                                 03970000
@NM00136 EQU   LCBTSTSW                                                 03971000
LCBCONCT EQU   LCBTSTSW                                                 03972000
LCBRESP  EQU   LCBSTAT2                                                 03973000
LCBBFRAV EQU   LCBDIAL                                                  03974000
LCBATTN  EQU   LCBSYNC                                                  03975000
LCBSNDPR EQU   LCBSTAT2                                                 03976000
LCBCONNN EQU   LCBBEOTN                                                 03977000
LCBMSGNN EQU   LCBSTAT2                                                 03978000
LCBTRACE EQU   LCBSTAT2                                                 03979000
LCBSENDN EQU   LCBSTAT1                                                 03980000
LCBRECVN EQU   LCBSTAT1                                                 03981000
LCBFREEN EQU   LCBSTAT1                                                 03982000
LCBCONT  EQU   LCBSTAT1                                                 03983000
LCBINITN EQU   LCBSTAT1                                                 03984000
LCBOCNI  EQU   LCBSTAT1                                                 03985000
LCBOCWTN EQU   LCBSTAT1                                                 03986000
LCBRCLLN EQU   LCBSTAT1                                                 03987000
LCBRECOF EQU   IEDQLCB+68                                               03988000
LCBRDBFR EQU   LCBRCBFR                                                 03989000
LCBUCBX  EQU   IEDQLCB+64                                               03990000
LCBTTBIN EQU   LCBERRCT                                                 03991000
@NM00135 EQU   LCBINCAM                                                 03992000
LCBGETMN EQU   LCBINCAM                                                 03993000
@NM00134 EQU   LCBRESTR+1                                               03994000
LCBCMDSV EQU   LCBRESTR                                                 03995000
LCBPCILK EQU   LCBDCBPT                                                 03996000
LCBSTART EQU   LCBIOBSN+16                                              03997000
LCBAP4OL EQU   LCBSIOCC                                                 03998000
LCBAP3OL EQU   LCBSIOCC                                                 03999000
LCBAP2OL EQU   LCBSIOCC                                                 04000000
LCBAP1OL EQU   LCBSIOCC                                                 04001000
LCBSIOC2 EQU   LCBSIOCC                                                 04002000
LCBSIOC1 EQU   LCBSIOCC                                                 04003000
@NM00133 EQU   LCBSIOCC                                                 04004000
LCBCSWRC EQU   LCBCSW+5                                                 04005000
LCBCSCHC EQU   LCBCSWCS                                                 04006000
LCBCSICC EQU   LCBCSWCS                                                 04007000
LCBCSCCC EQU   LCBCSWCS                                                 04008000
LCBCSCDC EQU   LCBCSWCS                                                 04009000
LCBCSPTC EQU   LCBCSWCS                                                 04010000
LCBCSPGC EQU   LCBCSWCS                                                 04011000
LCBCSIL  EQU   LCBCSWCS                                                 04012000
LCBCSPCI EQU   LCBCSWCS                                                 04013000
LCBUSUE  EQU   LCBCSWUS                                                 04014000
LCBUSUC  EQU   LCBCSWUS                                                 04015000
LCBUSDE  EQU   LCBCSWUS                                                 04016000
LCBUSCE  EQU   LCBCSWUS                                                 04017000
LCBUSBSY EQU   LCBCSWUS                                                 04018000
LCBUSCUE EQU   LCBCSWUS                                                 04019000
LCBUSSM  EQU   LCBCSWUS                                                 04020000
LCBUSAT  EQU   LCBCSWUS                                                 04021000
LCBCSWCA EQU   LCBCSW                                                   04022000
LCBOBR   EQU   LCBFLAG3                                                 04023000
LCBOBRRD EQU   LCBFLAG3                                                 04024000
LCBIOMSG EQU   LCBFLAG3                                                 04025000
LCBSOHC  EQU   LCBFLAG3                                                 04026000
LCBRLAD  EQU   LCBFLAG3                                                 04027000
LCBSOHR  EQU   LCBFLAG3                                                 04028000
@NM00132 EQU   LCBFLAG3                                                 04029000
LCBECBPT EQU   LCBIOBSN+4                                               04030000
LCBECBCC EQU   LCBIOBSN+3                                               04031000
LCBSENS1 EQU   LCBSNS+1                                                 04032000
LCBABORT EQU   LCBTMOUT                                                 04033000
LCBNOTIN EQU   LCBLOSDT                                                 04034000
LCBOVRUN EQU   LCBSENS0                                                 04035000
LCBDATCK EQU   LCBSENS0                                                 04036000
LCBEQUCK EQU   LCBSENS0                                                 04037000
LCBBUSCK EQU   LCBSENS0                                                 04038000
LCBINTRQ EQU   LCBSENS0                                                 04039000
LCBCMDRJ EQU   LCBSENS0                                                 04040000
LCBFLAG2 EQU   LCBIOBSN                                                 04041000
@NM00131 EQU   LCBFLAG1                                                 04042000
LCBUNREL EQU   LCBFLAG1                                                 04043000
LCBEXCPN EQU   LCBFLAG1                                                 04044000
@NM00130 EQU   LCBFLAG1                                                 04045000
LCBERPIN EQU   LCBFLAG1                                                 04046000
@NM00129 EQU   LCBFLAG1                                                 04047000
LCBFSBFR EQU   LCBMHA                                                   04048000
LCBISZE  EQU   IEDQLCB+28                                               04049000
LCBLNENT EQU   LCBSCBDA+1                                               04050000
@NM00128 EQU   LCBSCBDA                                                 04051000
LCBCPGMH EQU   LCBSTAT4                                                 04052000
LCBREAL  EQU   LCBPHASE                                                 04053000
@NM00127 EQU   LCBSTAT4                                                 04054000
LCBACTRQ EQU   LCBSTAT4                                                 04055000
LCBIPLRQ EQU   LCBSTAT4                                                 04056000
LCBDACRQ EQU   LCBSTAT4                                                 04057000
LCBDMPRQ EQU   LCBSTAT4                                                 04058000
@NM00126 EQU   LCBLKMDE                                                 04059000
LCBLOCKI EQU   LCBLKMDE                                                 04060000
LCBLOCKR EQU   LCBLKMDE                                                 04061000
LCBHMFLG EQU   LCBLKMDE                                                 04062000
LCBBDFLG EQU   LCBLKMDE                                                 04063000
@NM00125 EQU   LCBINSRC                                                 04064000
LCBABRTN EQU   LCBCHAIN                                                 04065000
LCBCTLMD EQU   LCBTETEN                                                 04066000
LCBBFRSZ EQU   LCBCHAIN                                                 04067000
LCBUREQN EQU   LCBCHAIN                                                 04068000
LCBNORTY EQU   LCBCHAIN                                                 04069000
LCBERMSG EQU   LCBCHAIN                                                 04070000
LCBEXCP  EQU   LCBCHAIN                                                 04071000
LCBINVRQ EQU   LCBSCRNN                                                 04072000
LCB2741N EQU   LCBTSOB                                                  04073000
LCBINHBN EQU   LCBTSOB                                                  04074000
LCBCIRCD EQU   LCBTSOB                                                  04075000
LCBPREP  EQU   LCBTSOB                                                  04076000
LCBSOPL  EQU   LCBTSOB                                                  04077000
LCBSATRD EQU   LCBTSOB                                                  04078000
LCBTSBUF EQU   LCBTSOB                                                  04079000
LCBWRBRK EQU   LCBTSOB                                                  04080000
LCBTDL   EQU   IEDQLCB+18                                               04081000
LCBEOLTD EQU   IEDQLCB+16                                               04082000
LCBRSLNK EQU   IEDQLCB+13                                               04083000
LCBRSPRI EQU   IEDQLCB+12                                               04084000
LCBSTCBA EQU   IEDQLCB+9                                                04085000
LCBKEY   EQU   LCBRCB                                                   04086000
@NM00124 EQU   DCTBYTE5                                                 04087000
DCTSCS   EQU   DCTBYTE5                                                 04088000
DCTTSPRF EQU   DCTBYTE4                                                 04089000
DCTFMPRF EQU   DCTBYTE4                                                 04090000
DCT2760  EQU   DCTBYTE3                                                 04091000
DCTCONTN EQU   DCTBYTE3                                                 04092000
DCTBUFF  EQU   DCTBYTE3                                                 04093000
DCTCHECK EQU   DCTBYTE3                                                 04094000
DCTENCTL EQU   DCTBYTE3                                                 04095000
DCTWTTA  EQU   DCTBYTE3                                                 04096000
DCT1050  EQU   DCTBYTE3                                                 04097000
DCTAUDIO EQU   DCTBYTE2                                                 04098000
DCTLOCAL EQU   DCTBYTE2                                                 04099000
DCTCONT  EQU   DCTBYTE2                                                 04100000
DCTXMIT  EQU   DCTBYTE2                                                 04101000
DCTSTCTL EQU   DCTBYTE2                                                 04102000
DCTTWX   EQU   DCTBYTE2                                                 04103000
DCTBRDST EQU   DCTBYTE2                                                 04104000
DCTBISYN EQU   DCTBYTE2                                                 04105000
DCTUMASK EQU   DCTBYTE1                                                 04106000
DCTSADEV EQU   DCTBYTE1                                                 04107000
DCT2741  EQU   DCTBYTE1                                                 04108000
DCT5041  EQU   DCTBYTE1                                                 04109000
DCTATTEN EQU   DCTBYTE1                                                 04110000
DCTBREAK EQU   DCTBYTE1                                                 04111000
DCTINHIB EQU   DCTBYTE1                                                 04112000
DCTBYTE0 EQU   IEDDCT                                                   04113000
DCBINVLA EQU   DCBINVLI+1                                               04114000
@NM00123 EQU   DCBINVCI                                                 04115000
DCBINVB2 EQU   DCBINVCI                                                 04116000
@NM00122 EQU   DCBINVCI                                                 04117000
DCBINVB1 EQU   DCBINVCI                                                 04118000
@NM00121 EQU   DCBINVCI                                                 04119000
@NM00120 EQU   DCBRESER+2                                               04120000
DCBRESB2 EQU   DCBRESER+1                                               04121000
DCBRESB1 EQU   DCBRESER                                                 04122000
DCBBUFSI EQU   IHADCS43+6                                               04123000
DCBUNTCT EQU   IHADCS43+5                                               04124000
DCBILCT  EQU   IHADCS43+4                                               04125000
DCBSCTAD EQU   DCBSCTAB+1                                               04126000
@NM00119 EQU   DCBSCTAB                                                 04127000
DCBDEBA  EQU   DCBDEBAD+1                                               04128000
@NM00118 EQU   DCBIFLGS                                                 04129000
DCBIFIOE EQU   DCBIFLGS                                                 04130000
DCBCH12  EQU   DCBIFPCT                                                 04131000
DCBCH9   EQU   DCBIFPCT                                                 04132000
DCBIFEC  EQU   DCBIFLGS                                                 04133000
DCBMFSTI EQU   DCBMFDMD                                                 04134000
DCBMFAWR EQU   DCBMFSTK                                                 04135000
DCBMFUIP EQU   DCBMFTMD                                                 04136000
DCBMFIDW EQU   DCBMFLCP                                                 04137000
DCBMFWRK EQU   DCBMFMVP                                                 04138000
DCBMFRDQ EQU   DCBMFWRT                                                 04139000
DCBMFGTQ EQU   DCBMFPUT                                                 04140000
DCBMFSTL EQU   DCBMACF2                                                 04141000
DCBMFCK  EQU   DCBMFDMG                                                 04142000
DCBMFRDX EQU   DCBMFCHK                                                 04143000
DCBMFDBF EQU   DCBMFSBG                                                 04144000
DCBMFRDI EQU   DCBMFLCG                                                 04145000
DCBMFRDK EQU   DCBMFMVG                                                 04146000
DCBMFWRQ EQU   DCBMFRD                                                  04147000
DCBMFPTQ EQU   DCBMFGET                                                 04148000
DCBMFECP EQU   DCBMACF1                                                 04149000
DCBTIOT  EQU   IHADCS25                                                 04150000
DCBMRSTI EQU   DCBMRDMD                                                 04151000
DCBMRAWR EQU   DCBMRSTK                                                 04152000
DCBMRUIP EQU   DCBMRTMD                                                 04153000
DCBMRIDW EQU   DCBMRLCP                                                 04154000
DCBMRWRK EQU   DCBMRMVP                                                 04155000
DCBMRRDQ EQU   DCBMRWRT                                                 04156000
DCBMRGTQ EQU   DCBMRPUT                                                 04157000
DCBMRSTL EQU   DCBMACR2                                                 04158000
DCBMRCK  EQU   DCBMRDMG                                                 04159000
DCBPGFXA EQU   DCBMRRDX                                                 04160000
DCBMRDBF EQU   DCBMRSBG                                                 04161000
DCBMRRDI EQU   DCBMRLCG                                                 04162000
DCBMRRDK EQU   DCBMRMVG                                                 04163000
DCBMRWRQ EQU   DCBMRRD                                                  04164000
DCBMRPTQ EQU   DCBMRGET                                                 04165000
DCBMRECP EQU   DCBMACR1                                                 04166000
@NM00117 EQU   DCBIFLG                                                  04167000
DCBIBIOE EQU   DCBIFLG                                                  04168000
DCBICH12 EQU   DCBIBPCT                                                 04169000
DCBICH9  EQU   DCBIBPCT                                                 04170000
DCBIBEC  EQU   DCBIFLG                                                  04171000
DCBOFIOF EQU   DCBOFLGS                                                 04172000
DCBOFUEX EQU   DCBOFLGS                                                 04173000
DCBOFTM  EQU   DCBOFLGS                                                 04174000
DCBOFPPC EQU   DCBOFLGS                                                 04175000
DCBOFOPN EQU   DCBOFLGS                                                 04176000
DCBOFEOV EQU   DCBOFLGS                                                 04177000
DCBOFLRB EQU   DCBOFLGS                                                 04178000
DCBOFIOD EQU   DCBOFLWR                                                 04179000
DCBDDNAM EQU   IHADCS24                                                 04180000
DCBEXLSA EQU   DCBEXLST+1                                               04181000
DCBEIOBX EQU   DCBEXLST                                                 04182000
DCBLCBA  EQU   DCBLCBAD+1                                               04183000
DCBCPS   EQU   DCBCPRI                                                  04184000
DCBCPE   EQU   DCBCPRI                                                  04185000
DCBCPR   EQU   DCBCPRI                                                  04186000
@NM00116 EQU   DCBCPRI                                                  04187000
@NM00115 EQU   DCBTRANA                                                 04188000
DCBIOBAA EQU   DCBIOBAD+1                                               04189000
DCBDEVTP EQU   DCBIOBAD                                                 04190000
@NM00114 EQU   IHADCS17+7                                               04191000
@NM00113 EQU   IHADCS17+6                                               04192000
@NM00112 EQU   IHADCS17+5                                               04193000
DCBINTVL EQU   IHADCS17+4                                               04194000
DCBCLPSA EQU   DCBCLPS+1                                                04195000
DCBBUFRQ EQU   DCBCLPS                                                  04196000
DCBBUFMA EQU   IHADCS16+8                                               04197000
@NM00111 EQU   DCBDSRG2                                                 04198000
DCBDSGTR EQU   DCBDSRG2                                                 04199000
DCBACBM  EQU   DCBDSRG2                                                 04200000
@NM00110 EQU   DCBDSRG2                                                 04201000
DCBDSGTQ EQU   DCBDSRG2                                                 04202000
DCBDSGTX EQU   DCBDSRG2                                                 04203000
DCBDSGGS EQU   DCBDSRG2                                                 04204000
DCBDSGU  EQU   DCBDSRG1                                                 04205000
DCBDSGPO EQU   DCBDSRG1                                                 04206000
@NM00109 EQU   DCBDSRG1                                                 04207000
@NM00108 EQU   DCBDSRG1                                                 04208000
DCBDSGCX EQU   DCBDSRG1                                                 04209000
DCBDSGDA EQU   DCBDSRG1                                                 04210000
DCBDSGPS EQU   DCBDSRG1                                                 04211000
DCBDSGIS EQU   DCBDSRG1                                                 04212000
DCBPCIR2 EQU   DCBPCI                                                   04213000
DCBPCIR1 EQU   DCBPCI                                                   04214000
DCBPCIN2 EQU   DCBPCI                                                   04215000
DCBPCIN1 EQU   DCBPCI                                                   04216000
DCBPCIA2 EQU   DCBPCI                                                   04217000
DCBPCIA1 EQU   DCBPCI                                                   04218000
DCBPCIX2 EQU   DCBPCI                                                   04219000
DCBPCIX1 EQU   DCBPCI                                                   04220000
@NM00107 EQU   IHADCS16+4                                               04221000
DCBMH    EQU   DCBMHA+1                                                 04222000
DCBBFOUT EQU   DCBBUFIN                                                 04223000
DCBBFIN  EQU   DCBBUFIN                                                 04224000
@NM00106 EQU   IHADCB                                                   04225000
SAVTLLCB EQU   IEDNSVTD+316                                             04226000
SAVTBITN EQU   IEDNSVTD+312                                             04227000
@NM00105 EQU   SAVTCKQB+8                                               04228000
@NM00104 EQU   SAVTCKEC+1                                               04229000
@NM00103 EQU   SAVTCKCC                                                 04230000
SAVTCKPO EQU   SAVTCKCC                                                 04231000
SAVTCKWA EQU   SAVTCKCC                                                 04232000
SAVTCKCH EQU   SAVTCKTB+1                                               04233000
SAVTCKVT EQU   SAVTCKTB                                                 04234000
@NM00102 EQU   IEDNSVTD+297                                             04235000
SAVTRDFG EQU   SAVTRDRV+12                                              04236000
@NM00101 EQU   SAVTRDRV+5                                               04237000
SAVTRDPY EQU   SAVTRDRV+4                                               04238000
SAVTRDQB EQU   SAVTRDRV+1                                               04239000
SAVTRDKY EQU   SAVTRDRV                                                 04240000
SAVTNID  EQU   IEDNSVTD+280                                             04241000
SAVTDVAS EQU   IEDNSVTD+276                                             04242000
SAVTPLSZ EQU   IEDNSVTD+274                                             04243000
@NM00100 EQU   IEDNSVTD+273                                             04244000
SAVTSUBL EQU   IEDNSVTD+272                                             04245000
@NM00099 EQU   SAVTZELM+1                                               04246000
SAVTSUBM EQU   SAVTZELM                                                 04247000
SAVTMHDX EQU   IEDNSVTD+268                                             04248000
SAVTNAT1 EQU   IEDNSVTD+266                                             04249000
SAVTSH20 EQU   IEDNSVTD+264                                             04250000
SAVTLCBS EQU   IEDNSVTD+260                                             04251000
SAVTRNMP EQU   IEDNSVTD+256                                             04252000
SAVTTNTX EQU   IEDNSVTD+252                                             04253000
SAVTSUBV EQU   IEDNSVTD+247                                             04254000
SAVTSUBA EQU   IEDNSVTD+246                                             04255000
SAVTSIBC EQU   IEDNSVTD+244                                             04256000
SAVTBSM  EQU   IEDNSVTD+240                                             04257000
SAVTRQTG EQU   IEDNSVTD+236                                             04258000
SAVTRQCH EQU   IEDNSVTD+232                                             04259000
SAVTMAND EQU   IEDNSVTD+228                                             04260000
SAVTSPLN EQU   IEDNSVTD+224                                             04261000
SAVTNADL EQU   IEDNSVTD+222                                             04262000
SAVTNATL EQU   IEDNSVTD+220                                             04263000
SAVTMHTB EQU   IEDNSVTD+216                                             04264000
SAVTSSMH EQU   IEDNSVTD+212                                             04265000
SAVTQRS  EQU   IEDNSVTD+208                                             04266000
SAVTRQIN EQU   IEDNSVTD+204                                             04267000
SAVTDFCO EQU   IEDNSVTD+200                                             04268000
SAVTSAO  EQU   IEDNSVTD+196                                             04269000
SAVTSARI EQU   IEDNSVTD+192                                             04270000
SAVTSAC  EQU   IEDNSVTD+188                                             04271000
SAVTSAI  EQU   IEDNSVTD+184                                             04272000
SAVTCSCI EQU   IEDNSVTD+180                                             04273000
SAVTSSRP EQU   IEDNSVTD+176                                             04274000
SAVTSSRQ EQU   IEDNSVTD+172                                             04275000
SAVTSCLU EQU   IEDNSVTD+168                                             04276000
SAVTXTRQ EQU   IEDNSVTD+164                                             04277000
SAVTMVBF EQU   IEDNSVTD+160                                             04278000
@NM00098 EQU   IEDNSVTD+148                                             04279000
SAVTIPCQ EQU   IEDNSVTD+144                                             04280000
@NM00097 EQU   IEDNSVTD+136                                             04281000
SAVTXFMI EQU   IEDNSVTD+132                                             04282000
@NM00096 EQU   IEDNSVTD+124                                             04283000
SAVTXFMO EQU   IEDNSVTD+120                                             04284000
@NM00095 EQU   IEDNSVTD+116                                             04285000
SAVTSSSR EQU   IEDNSVTD+112                                             04286000
SAVTSLCB EQU   IEDNSVTD+104                                             04287000
SAVTLUSR EQU   IEDNSVTD+100                                             04288000
@NM00094 EQU   SAVTLUSQ+8                                               04289000
SAVTLUSP EQU   SAVTLUSQ+4                                               04290000
SAVTLUSB EQU   SAVTLUSQ                                                 04291000
@NM00093 EQU   IEDNSVTD+84                                              04292000
SAVTSAT  EQU   IEDNSVTD+80                                              04293000
SAVTNAT  EQU   IEDNSVTD+76                                              04294000
SAVTCLUP EQU   IEDNSVTD+72                                              04295000
SAVTPIUT EQU   IEDNSVTD+68                                              04296000
SAVTRNTA EQU   IEDNSVTD+64                                              04297000
SAVTDNIR EQU   IEDNSVTD+60                                              04298000
SAVTCNIR EQU   IEDNSVTD+56                                              04299000
SAVTFLDH EQU   IEDNSVTD+52                                              04300000
SAVTSRTN EQU   IEDNSVTD+48                                              04301000
SAVTSREQ EQU   IEDNSVTD+44                                              04302000
SAVTFAIL EQU   IEDNSVTD+42                                              04303000
SAVTSUSE EQU   IEDNSVTD+40                                              04304000
SAVTSIB  EQU   IEDNSVTD+36                                              04305000
SAVTPRTN EQU   IEDNSVTD+32                                              04306000
@NM00092 EQU   IEDNSVTD+28                                              04307000
SAVTWH20 EQU   IEDNSVTD+26                                              04308000
SAVTPWT  EQU   IEDNSVTD+24                                              04309000
SAVTPRTQ EQU   IEDNSVTD+20                                              04310000
SAVTPREQ EQU   IEDNSVTD+16                                              04311000
SAVTPH20 EQU   IEDNSVTD+14                                              04312000
SAVTPUSE EQU   IEDNSVTD+12                                              04313000
SAVTPLCB EQU   IEDNSVTD+8                                               04314000
SAVTPOOL EQU   IEDNSVTD+4                                               04315000
SAVTPRMT EQU   SAVTDIAF                                                 04316000
SAVTVIRT EQU   SAVTDIAF                                                 04317000
AVTCPBNO EQU   IEDQAVTD+1244                                            04318000
AVTHRESS EQU   IEDQAVTD+1243                                            04319000
@NM00091 EQU   IEDQAVTD+1242                                            04320000
@NM00090 EQU   IEDQAVTD+1241                                            04321000
@NM00089 EQU   IEDQAVTD+1240                                            04322000
@NM00088 EQU   IEDQAVTD+1237                                            04323000
@NM00087 EQU   IEDQAVTD+1236                                            04324000
AVTHRESE EQU   @NM00086                                                 04325000
AVTRADDR EQU   IEDQAVTD+1228                                            04326000
AVTNADDR EQU   IEDQAVTD+1224                                            04327000
AVTHRESN EQU   IEDQAVTD+1220                                            04328000
AVTVOLRN EQU   IEDQAVTD+1216                                            04329000
AVTTOTNN EQU   IEDQAVTD+1212                                            04330000
AVTTRCYN EQU   IEDQAVTD+1208                                            04331000
AVTRCTRN EQU   IEDQAVTD+1204                                            04332000
AVTNOVON EQU   IEDQAVTD+1200                                            04333000
AVTADEBN EQU   IEDQAVTD+1196                                            04334000
AVTVOLRR EQU   IEDQAVTD+1192                                            04335000
AVTTOTNR EQU   IEDQAVTD+1188                                            04336000
AVTTRCYR EQU   IEDQAVTD+1184                                            04337000
AVTRCTRR EQU   IEDQAVTD+1180                                            04338000
AVTNOVOR EQU   IEDQAVTD+1176                                            04339000
AVTADEBR EQU   IEDQAVTD+1172                                            04340000
AVTLODPT EQU   IEDQAVTD+1168                                            04341000
AVTIOBN  EQU   IEDQAVTD+1164                                            04342000
AVTIOBR  EQU   IEDQAVTD+1160                                            04343000
AVTCPBPT EQU   IEDQAVTD+1156                                            04344000
AVTFCPB  EQU   IEDQAVTD+1152                                            04345000
@NM00085 EQU   IEDQAVTD+1148                                            04346000
AVTINCPQ EQU   IEDQAVTD+1144                                            04347000
@NM00084 EQU   IEDQAVTD+1140                                            04348000
@NM00083 EQU   IEDQAVTD+1137                                            04349000
@NM00082 EQU   AVTBIT4                                                  04350000
@NM00081 EQU   AVTBIT4                                                  04351000
@NM00080 EQU   AVTBIT4                                                  04352000
@NM00079 EQU   AVTBIT4                                                  04353000
@NM00078 EQU   AVTBIT4                                                  04354000
@NM00077 EQU   AVTBIT4                                                  04355000
@NM00076 EQU   AVTBIT4                                                  04356000
AVTRUFTN EQU   AVTBIT4                                                  04357000
@NM00075 EQU   IEDQAVTD+1132                                            04358000
AVTNOBFQ EQU   IEDQAVTD+1128                                            04359000
@NM00074 EQU   IEDQAVTD+1124                                            04360000
AVTDKENQ EQU   IEDQAVTD+1120                                            04361000
@NM00073 EQU   IEDQAVTD+1116                                            04362000
AVTDKAPQ EQU   IEDQAVTD+1112                                            04363000
AVTCOPY  EQU   IEDQAVTD+1108                                            04364000
AVTIA    EQU   IEDQAVTD+1104                                            04365000
AVTFL    EQU   IEDQAVTD+1100                                            04366000
@NM00072 EQU   IEDQAVTD+1096                                            04367000
AVTNCPBQ EQU   IEDQAVTD+1092                                            04368000
AVTTOTNC EQU   IEDQAVTD+1088                                            04369000
AVTCMAX  EQU   IEDQAVTD+1084                                            04370000
AVTCMIN  EQU   IEDQAVTD+1080                                            04371000
AVTHM02  EQU   IEDQAVTD+1076                                            04372000
AVTOPCIN EQU   IEDQAVTD+1074                                            04373000
AVTDCTLN EQU   IEDQAVTD+1072                                            04374000
AVTOPMSK EQU   IEDQAVTD+1068                                            04375000
AVTSTEAL EQU   IEDQAVTD+1060                                            04376000
AVTOPTN  EQU   IEDQAVTD+1056                                            04377000
AVTDSKCT EQU   IEDQAVTD+1054                                            04378000
AVTCKRST EQU   IEDQAVTD+1053                                            04379000
AVTSTAN  EQU   AVTBIT3                                                  04380000
AVTSTACN EQU   AVTBIT3                                                  04381000
AVTSTAIN EQU   AVTBIT3                                                  04382000
AVTSTAYN EQU   AVTBIT3                                                  04383000
AVTOLTBN EQU   AVTBIT3                                                  04384000
AVTTSAB  EQU   AVTBIT3                                                  04385000
AVTRFULN EQU   AVTBIT3                                                  04386000
AVTRECVN EQU   AVTBIT3                                                  04387000
@NM00071 EQU   AVTBIT2                                                  04388000
@NM00070 EQU   AVTBIT2                                                  04389000
AVTOPEIN EQU   AVTBIT2                                                  04390000
AVTSTRTN EQU   AVTBIT2                                                  04391000
AVTTOPOL EQU   AVTBIT2                                                  04392000
AVTCOPYN EQU   AVTBIT2                                                  04393000
AVTREUSN EQU   AVTBIT2                                                  04394000
AVTEXTSC EQU   AVTBIT2                                                  04395000
AVTDISKN EQU   AVTBIT1                                                  04396000
AVTQUCKN EQU   AVTBIT1                                                  04397000
AVTCLOSN EQU   AVTBIT1                                                  04398000
AVTREADN EQU   AVTBIT1                                                  04399000
AVTDLAYN EQU   AVTBIT1                                                  04400000
AVTAPLKN EQU   AVTBIT1                                                  04401000
AVTDUMBR EQU   IEDQAVTD+1048                                            04402000
AVTDLQX  EQU   IEDQAVTD+1046                                            04403000
AVTINTLV EQU   IEDQAVTD+1044                                            04404000
AVTSMCNT EQU   IEDQAVTD+1042                                            04405000
AVTAVFCT EQU   IEDQAVTD+1040                                            04406000
AVTOPCON EQU   IEDQAVTD+1038                                            04407000
AVTOPCNT EQU   IEDQAVTD+1036                                            04408000
AVTLNCNT EQU   IEDQAVTD+1034                                            04409000
AVTHA16  EQU   IEDQAVTD+1030                                            04410000
AVTHA7   EQU   IEDQAVTD+1028                                            04411000
AVTHA4   EQU   IEDQAVTD+1026                                            04412000
AVTHA3   EQU   IEDQAVTD+1024                                            04413000
AVTHA2   EQU   IEDQAVTD+1022                                            04414000
AVTGETMS EQU   IEDQAVTD+1021                                            04415000
@NM00069 EQU   IEDQAVTD+1020                                            04416000
AVTGETMD EQU   IEDQAVTD+1016                                            04417000
AVTGETMN EQU   IEDQAVTD+1012                                            04418000
AVTCWTOT EQU   IEDQAVTD+1008                                            04419000
AVTCWINT EQU   IEDQAVTD+956                                             04420000
AVTDTRAP EQU   IEDQAVTD+952                                             04421000
@NM00068 EQU   IEDQAVTD+950                                             04422000
@NM00067 EQU   AVTIOTR                                                  04423000
AVTIOTRH EQU   AVTIOTR                                                  04424000
AVTIOTRE EQU   AVTIOTR                                                  04425000
@NM00066 EQU   AVTSUBT                                                  04426000
AVTSUBPT EQU   AVTSUBT                                                  04427000
AVTSUBON EQU   AVTSUBT                                                  04428000
AVTAFE30 EQU   IEDQAVTD+944                                             04429000
AVTAFE20 EQU   IEDQAVTD+940                                             04430000
AVTAFE10 EQU   IEDQAVTD+936                                             04431000
AVTCWEC2 EQU   IEDQAVTD+932                                             04432000
AVTCWPM2 EQU   IEDQAVTD+928                                             04433000
AVTCWTS2 EQU   IEDQAVTD+927                                             04434000
AVTCWTS1 EQU   IEDQAVTD+926                                             04435000
AVTCWCLD EQU   AVTCWFL2                                                 04436000
AVTCWRAP EQU   AVTCWFL2                                                 04437000
@NM00065 EQU   AVTCWFL2                                                 04438000
@NM00064 EQU   AVTCWFL2                                                 04439000
@NM00063 EQU   AVTCWFL2                                                 04440000
@NM00062 EQU   AVTCWFL2                                                 04441000
@NM00061 EQU   AVTCWFL2                                                 04442000
AVTCWACT EQU   AVTCWFL2                                                 04443000
@NM00060 EQU   AVTCWFL1                                                 04444000
@NM00059 EQU   AVTCWFL1                                                 04445000
@NM00058 EQU   AVTCWFL1                                                 04446000
@NM00057 EQU   AVTCWFL1                                                 04447000
@NM00056 EQU   AVTCWFL1                                                 04448000
@NM00055 EQU   AVTCWFL1                                                 04449000
@NM00054 EQU   AVTCWFL1                                                 04450000
AVTCOMWN EQU   AVTCWFL1                                                 04451000
AVTCWEC1 EQU   IEDQAVTD+920                                             04452000
AVTCWPM1 EQU   IEDQAVTD+916                                             04453000
AVTCAREA EQU   IEDQAVTD+912                                             04454000
AVTFZERO EQU   IEDQAVTD+908                                             04455000
AVTCADDR EQU   IEDQAVTD+904                                             04456000
AVTCOREC EQU   IEDQAVTD+900                                             04457000
@NM00053 EQU   IEDQAVTD+892                                             04458000
AVTCPBCB EQU   IEDQAVTD+888                                             04459000
@NM00052 EQU   IEDQAVTD+880                                             04460000
AVTDSIOB EQU   IEDQAVTD+876                                             04461000
@NM00051 EQU   IEDQAVTD+868                                             04462000
AVTCPRMB EQU   IEDQAVTD+864                                             04463000
@NM00050 EQU   IEDQAVTD+856                                             04464000
AVTCLOSB EQU   IEDQAVTD+852                                             04465000
@NM00049 EQU   IEDQAVTD+844                                             04466000
AVTACTIB EQU   IEDQAVTD+840                                             04467000
@NM00048 EQU   IEDQAVTD+836                                             04468000
AVTOLTEB EQU   IEDQAVTD+832                                             04469000
AVTOLTVT EQU   AVTOLTQB                                                 04470000
@NM00047 EQU   AVTOPCQB+8                                               04471000
@NM00046 EQU   AVTOPCEC+1                                               04472000
@NM00045 EQU   AVTOPCCC                                                 04473000
AVTOPCPO EQU   AVTOPCCC                                                 04474000
AVTOPCWA EQU   AVTOPCCC                                                 04475000
AVTOPCCH EQU   AVTOPCOB+1                                               04476000
AVTOPCVT EQU   AVTOPCOB                                                 04477000
@NM00044 EQU   AVTCKPQB+9                                               04478000
AVTCKPTS EQU   AVTCKPQB+8                                               04479000
@NM00043 EQU   AVTCKPEC+1                                               04480000
@NM00042 EQU   AVTCKPCC                                                 04481000
AVTCKPPO EQU   AVTCKPCC                                                 04482000
AVTCKPWA EQU   AVTCKPCC                                                 04483000
AVTCKPCH EQU   AVTCKPTB+1                                               04484000
AVTCKPVT EQU   AVTCKPTB                                                 04485000
@NM00041 EQU   IEDQAVTD+796                                             04486000
@NM00040 EQU   IEDQAVTD+788                                             04487000
AVTSELCH EQU   IEDQAVTD+785                                             04488000
AVTBFRTN EQU   AVTBFRFG                                                 04489000
AVTBFREB EQU   IEDQAVTD+780                                             04490000
AVTTIMQ  EQU   IEDQAVTD+776                                             04491000
@NM00039 EQU   IEDQAVTD+772                                             04492000
AVTIMQPS EQU   IEDQAVTD+768                                             04493000
AVTREFTM EQU   IEDQAVTD+764                                             04494000
@NM00038 EQU   IEDQAVTD+752                                             04495000
AVTDELYB EQU   IEDQAVTD+748                                             04496000
AVTOCQPT EQU   IEDQAVTD+744                                             04497000
AVTTSOPT EQU   IEDQAVTD+740                                             04498000
AVTSUPPT EQU   IEDQAVTD+736                                             04499000
AVTCBQCB EQU   IEDQAVTD+732                                             04500000
@NM00037 EQU   AVTSYSER                                                 04501000
@NM00036 EQU   AVTSYSER                                                 04502000
@NM00035 EQU   AVTSYSER                                                 04503000
@NM00034 EQU   AVTSYSER                                                 04504000
@NM00033 EQU   AVTSYSER                                                 04505000
@NM00032 EQU   AVTSYSER                                                 04506000
AVTCMAXN EQU   AVTSYSER                                                 04507000
AVTCMINN EQU   AVTSYSER                                                 04508000
AVT2260L EQU   IEDQAVTD+724                                             04509000
AVTABEPL EQU   AVTADBUF                                                 04510000
AVTHFF   EQU   AVTCLRHI+2                                               04511000
@NM00031 EQU   AVTCLRHI                                                 04512000
AVTCCLNK EQU   AVTCRELE+5                                               04513000
AVTCCPRI EQU   AVTCRELE+4                                               04514000
AVTCCQCB EQU   AVTCCELE+1                                               04515000
AVTCCKEY EQU   AVTCCELE                                                 04516000
AVTDELAD EQU   IEDQAVTD+704                                             04517000
AVTDELEM EQU   IEDQAVTD+700                                             04518000
AVTBSX   EQU   AVTCKLNK                                                 04519000
AVTOPETR EQU   AVTHG01                                                  04520000
@NM00030 EQU   AVTCKBYT                                                 04521000
AVTCKONQ EQU   AVTCKBYT                                                 04522000
@NM00029 EQU   AVTCKBYT                                                 04523000
@NM00028 EQU   AVTCKBYT                                                 04524000
@NM00027 EQU   AVTCKBYT                                                 04525000
@NM00026 EQU   AVTCKBYT                                                 04526000
@NM00025 EQU   AVTCKBYT                                                 04527000
@NM00024 EQU   AVTCKBYT                                                 04528000
AVTOPERT EQU   IEDQAVTD+690                                             04529000
AVTOPXCL EQU   IEDQAVTD+688                                             04530000
AVTOPERL EQU   IEDQAVTD+687                                             04531000
@NM00023 EQU   IEDQAVTD+686                                             04532000
AVTCKTIM EQU   IEDQAVTD+684                                             04533000
AVTCKELV EQU   IEDQAVTD+682                                             04534000
AVTCPRCD EQU   IEDQAVTD+681                                             04535000
AVTWARMN EQU   AVTCKELF                                                 04536000
AVTCRTLN EQU   AVTCKELF                                                 04537000
AVTCPIPN EQU   AVTCKELF                                                 04538000
AVTCCLCN EQU   AVTCKELF                                                 04539000
AVTCINCN EQU   AVTCKELF                                                 04540000
@NM00022 EQU   AVTCKELF                                                 04541000
AVTCMCPN EQU   AVTCKELF                                                 04542000
AVTNQBCK EQU   AVTCKELF                                                 04543000
AVTCKQAD EQU   IEDQAVTD+677                                             04544000
AVTSCBSZ EQU   IEDQAVTD+676                                             04545000
@NM00021 EQU   IEDQAVTD+672                                             04546000
AVTCKELE EQU   IEDQAVTD+668                                             04547000
@NM00020 EQU   AVTCKPEL+8                                               04548000
AVTCKRLK EQU   AVTCKPEL+5                                               04549000
AVTCKRPR EQU   AVTCKPEL+4                                               04550000
AVTCKRMQ EQU   AVTCKRMV+1                                               04551000
AVTCKRKY EQU   AVTCKRMV                                                 04552000
AVTHK    EQU   IEDQAVTD+648                                             04553000
AVTHI    EQU   IEDQAVTD+644                                             04554000
AVTIOT   EQU   IEDQAVTD+640                                             04555000
AVTNX    EQU   IEDQAVTD+636                                             04556000
AVTTONE  EQU   IEDQAVTD+632                                             04557000
AVTA3TL  EQU   IEDQAVTD+628                                             04558000
AVTDMECB EQU   IEDQAVTD+624                                             04559000
AVTABEND EQU   IEDQAVTD+618                                             04560000
AVTPLCBN EQU   IEDQAVTD+616                                             04561000
@NM00019 EQU   AVTSAVTP+1                                               04562000
@NM00018 EQU   AVTSAVTF                                                 04563000
AVTSNA   EQU   AVTSAVTF                                                 04564000
AVTONSNA EQU   AVTSAVTF                                                 04565000
AVTVTMCP EQU   AVTSAVTF                                                 04566000
@NM00017 EQU   IEDQAVTD+608                                             04567000
AVTCMBSS EQU   IEDQAVTD+604                                             04568000
AVTRCV   EQU   IEDQAVTD+600                                             04569000
AVTSEND  EQU   IEDQAVTD+596                                             04570000
AVTCSCH  EQU   IEDQAVTD+592                                             04571000
AVTQ1    EQU   IEDQAVTD+588                                             04572000
AVTE7    EQU   IEDQAVTD+584                                             04573000
AVTHB    EQU   IEDQAVTD+580                                             04574000
AVTR1    EQU   IEDQAVTD+576                                             04575000
AVTBZ    EQU   IEDQAVTD+572                                             04576000
AVTEZ    EQU   IEDQAVTD+568                                             04577000
AVTEC    EQU   IEDQAVTD+564                                             04578000
AVTEW    EQU   IEDQAVTD+560                                             04579000
AVTNDIAL EQU   AVTSCOPT                                                 04580000
AVTN2741 EQU   AVTSCOPT                                                 04581000
AVTCONCO EQU   AVTSCOPT                                                 04582000
AVTCONC  EQU   AVTSCOPT                                                 04583000
AVTCMBUF EQU   AVTSCOPT                                                 04584000
AVTAPDMP EQU   AVTSCOPT                                                 04585000
@NM00016 EQU   AVTSCOPT                                                 04586000
AVTHA    EQU   AVTDISP                                                  04587000
AVTEA    EQU   IEDQAVTD+548                                             04588000
AVTAX    EQU   IEDQAVTD+544                                             04589000
AVTA3    EQU   IEDQAVTD+540                                             04590000
AVTGD    EQU   IEDQAVTD+536                                             04591000
AVTAL    EQU   IEDQAVTD+532                                             04592000
AVTOLTST EQU   AVTHG02                                                  04593000
AVTE8    EQU   IEDQAVTD+524                                             04594000
AVTUI    EQU   IEDQAVTD+520                                             04595000
AVTCOMPT EQU   IEDQAVTD+516                                             04596000
AVTCRSRF EQU   IEDQAVTD+512                                             04597000
@NM00015 EQU   IEDQAVTD+508                                             04598000
AVTKA02  EQU   IEDQAVTD+504                                             04599000
AVTOPTPT EQU   IEDQAVTD+500                                             04600000
AVTPCBPT EQU   IEDQAVTD+496                                             04601000
@NM00014 EQU   AVTECB1                                                  04602000
AVTCOMP  EQU   AVTECB1                                                  04603000
@NM00013 EQU   AVTECB1                                                  04604000
AVTOPECA EQU   IEDQAVTD+488                                             04605000
AVTOLECA EQU   IEDQAVTD+484                                             04606000
AVTCKECA EQU   IEDQAVTD+480                                             04607000
AVTCWECA EQU   IEDQAVTD+476                                             04608000
AVTCWTCB EQU   IEDQAVTD+472                                             04609000
AVTOLTCB EQU   IEDQAVTD+468                                             04610000
AVTOCTCB EQU   IEDQAVTD+464                                             04611000
AVTCKTCB EQU   IEDQAVTD+460                                             04612000
AVTAS    EQU   IEDQAVTD+456                                             04613000
AVTNOLBF EQU   IEDQAVTD+454                                             04614000
AVTNCKPR EQU   IEDQAVTD+453                                             04615000
AVTCIB   EQU   IEDQAVTD+452                                             04616000
AVTSPLPT EQU   IEDQAVTD+448                                             04617000
AVTSBTA  EQU   IEDQAVTD+440                                             04618000
AVTRARTN EQU   IEDQAVTD+436                                             04619000
AVTBSCAN EQU   IEDQAVTD+432                                             04620000
AVTRDYA  EQU   IEDQAVTD+428                                             04621000
AVTDISTR EQU   IEDQAVTD+420                                             04622000
AVTPARM3 EQU   IEDQAVTD+416                                             04623000
@NM00012 EQU   AVTPKF                                                   04624000
@NM00011 EQU   AVTPKF                                                   04625000
@NM00010 EQU   AVTPKF                                                   04626000
AVTFTCHF EQU   AVTPKF                                                   04627000
@NM00009 EQU   AVTPKF                                                   04628000
@NM00008 EQU   AVTPKF                                                   04629000
@NM00007 EQU   AVTPKF                                                   04630000
@NM00006 EQU   AVTPKF                                                   04631000
AVTPARM  EQU   IEDQAVTD+408                                             04632000
AVTEXS2A EQU   IEDQAVTD+402                                             04633000
AVTEXA2S EQU   IEDQAVTD+396                                             04634000
AVTOCGET EQU   IEDQAVTD+392                                             04635000
AVTCKAVT EQU   @NM00004+1                                               04636000
@NM00005 EQU   AVTCKFLG                                                 04637000
AVTCKHLT EQU   AVTCKFLG                                                 04638000
AVTCKREQ EQU   AVTCKFLG                                                 04639000
AVTCKENV EQU   AVTCKFLG                                                 04640000
AVTCKNAC EQU   AVTCKFLG                                                 04641000
AVTCKTAC EQU   AVTCKFLG                                                 04642000
AVTBUENT EQU   IEDQAVTD+386                                             04643000
@NM00003 EQU   IEDQAVTD+385                                             04644000
AVTFULLT EQU   AVTBUFSW                                                 04645000
AVTUNCON EQU   AVTBUFSW                                                 04646000
@NM00002 EQU   AVTBUFSW                                                 04647000
AVTBUFTR EQU   AVTREADD                                                 04648000
AVTREADY EQU   IEDQAVTD+376                                             04649000
AVTRACE  EQU   IEDQAVTD+372                                             04650000
AVTTCB   EQU   IEDQAVTD+368                                             04651000
AVTPASWD EQU   IEDQAVTD+360                                             04652000
AVTCTLCH EQU   IEDQAVTD+352                                             04653000
AVTDOUBL EQU   IEDQAVTD+344                                             04654000
AVTDOUBX EQU   IEDQAVTD+336                                             04655000
AVTDPARM EQU   IEDQAVTD+332                                             04656000
AVTDLQ   EQU   AVTSAVEX+32                                              04657000
@NM00001 EQU   AVTSAVEX                                                 04658000
AVTSAVE4 EQU   IEDQAVTD+216                                             04659000
AVTSAVE3 EQU   IEDQAVTD+144                                             04660000
AVTSAVE2 EQU   IEDQAVTD+72                                              04661000
AVTSAVE1 EQU   IEDQAVTD                                                 04662000
@NM00258 EQU   PSA+3668                                                 04663000
PSASTAK  EQU   PSA+3072                                                 04664000
@NM00257 EQU   PSA+1040                                                 04665000
PSAUSEND EQU   PSA+1040                                                 04666000
PSAWTCOD EQU   PSA+1036                                                 04667000
PSAATCVT EQU   PSA+1032                                                 04668000
PSAPCPSW EQU   PSA+1024                                                 04669000
PSAPIR2  EQU   PSA+1020                                                 04670000
PSARV059 EQU   PSA+1018                                                 04671000
PSASVC13 EQU   PSA+1016                                                 04672000
PSALSFCC EQU   PSA+1012                                                 04673000
PSASFACC EQU   PSA+1008                                                 04674000
PSASTOP  EQU   PSA+992                                                  04675000
PSASTART EQU   PSA+976                                                  04676000
PSARSPSW EQU   PSA+968                                                  04677000
PSASRPSW EQU   PSA+960                                                  04678000
PSARV045 EQU   PSA+892                                                  04679000
PSARV044 EQU   PSA+888                                                  04680000
PSARV043 EQU   PSA+884                                                  04681000
PSARV042 EQU   PSA+880                                                  04682000
PSARV041 EQU   PSA+876                                                  04683000
PSARV040 EQU   PSA+872                                                  04684000
PSARV025 EQU   PSA+868                                                  04685000
PSADSSED EQU   PSA+868                                                  04686000
PSADSSPR EQU   PSA+864                                                  04687000
PSADSSFW EQU   PSA+860                                                  04688000
PSADSS14 EQU   PSA+856                                                  04689000
PSADSSPP EQU   PSA+848                                                  04690000
PSADSSRP EQU   PSA+840                                                  04691000
PSADSS05 EQU   PSADSSF4                                                 04692000
PSADSS10 EQU   PSADSSF4                                                 04693000
PSADSSVE EQU   PSADSSF4                                                 04694000
PSADSSDE EQU   PSADSSF4                                                 04695000
PSADSSC0 EQU   PSADSSF4                                                 04696000
PSADSSIE EQU   PSADSSF4                                                 04697000
PSADSS12 EQU   PSADSSF4                                                 04698000
PSADSSRC EQU   PSADSSF4                                                 04699000
PSARV057 EQU   PSADSSF3                                                 04700000
PSARV056 EQU   PSADSSF3                                                 04701000
PSARV055 EQU   PSADSSF3                                                 04702000
PSADSSMC EQU   PSADSSF3                                                 04703000
PSADSSRW EQU   PSADSSF3                                                 04704000
PSADSSNM EQU   PSADSSF3                                                 04705000
PSADSSES EQU   PSADSSF3                                                 04706000
PSADSSGP EQU   PSADSSF3                                                 04707000
PSADSSF2 EQU   PSADSSFL+1                                               04708000
PSADSSPI EQU   PSADSSF1                                                 04709000
PSADSSOI EQU   PSADSSF1                                                 04710000
PSADSSSP EQU   PSADSSF1                                                 04711000
PSADSSTP EQU   PSADSSF1                                                 04712000
PSADSSDW EQU   PSADSSF1                                                 04713000
PSADSSDD EQU   PSADSSF1                                                 04714000
PSADSSDM EQU   PSADSSF1                                                 04715000
PSADSSMV EQU   PSADSSF1                                                 04716000
PSADSSTS EQU   PSA+816                                                  04717000
PSADSSWK EQU   PSA+812                                                  04718000
PSADSSR3 EQU   PSA+808                                                  04719000
PSADSSR2 EQU   PSA+804                                                  04720000
PSADSSRS EQU   PSA+800                                                  04721000
PSASTOR  EQU   PSA+796                                                  04722000
PSACPUSA EQU   PSA+794                                                  04723000
PSAVSTAP EQU   PSA+792                                                  04724000
PSAWKVAP EQU   PSA+788                                                  04725000
PSAWKRAP EQU   PSA+784                                                  04726000
PSAMCHIC EQU   PSA+783                                                  04727000
PSARV061 EQU   PSA+782                                                  04728000
PSASYMSK EQU   PSA+781                                                  04729000
PSAMCHFL EQU   PSA+780                                                  04730000
PSACR0   EQU   PSA+776                                                  04731000
PSAPSWSV EQU   PSA+768                                                  04732000
PSACLHS  EQU   PSAHLHI                                                  04733000
PSALKR15 EQU   PSALKSA+60                                               04734000
PSALKR14 EQU   PSALKSA+56                                               04735000
PSALKR13 EQU   PSALKSA+52                                               04736000
PSALKR12 EQU   PSALKSA+48                                               04737000
PSALKR11 EQU   PSALKSA+44                                               04738000
PSALKR10 EQU   PSALKSA+40                                               04739000
PSALKR9  EQU   PSALKSA+36                                               04740000
PSALKR8  EQU   PSALKSA+32                                               04741000
PSALKR7  EQU   PSALKSA+28                                               04742000
PSALKR6  EQU   PSALKSA+24                                               04743000
PSALKR5  EQU   PSALKSA+20                                               04744000
PSALKR4  EQU   PSALKSA+16                                               04745000
PSALKR3  EQU   PSALKSA+12                                               04746000
PSALKR2  EQU   PSALKSA+8                                                04747000
PSALKR1  EQU   PSALKSA+4                                                04748000
PSALKR0  EQU   PSALKSA                                                  04749000
PSARV023 EQU   PSACLHT+52                                               04750000
PSALOCAL EQU   PSACLHT+48                                               04751000
PSACMSL  EQU   PSACLHT+44                                               04752000
PSAOPTL  EQU   PSACLHT+40                                               04753000
PSATPACL EQU   PSACLHT+36                                               04754000
PSATPDNL EQU   PSACLHT+32                                               04755000
PSATPNCL EQU   PSACLHT+28                                               04756000
PSAIOSLL EQU   PSACLHT+24                                               04757000
PSAIOSUL EQU   PSACLHT+20                                               04758000
PSAIOSCL EQU   PSACLHT+16                                               04759000
PSAIOSSL EQU   PSACLHT+12                                               04760000
PSASALCL EQU   PSACLHT+8                                                04761000
PSAASML  EQU   PSACLHT+4                                                04762000
PSADISPL EQU   PSACLHT                                                  04763000
PSASRSA  EQU   PSA+636                                                  04764000
PSARV050 EQU   PSA+634                                                  04765000
PSADSSGO EQU   PSA+633                                                  04766000
PSARECUR EQU   PSA+632                                                  04767000
PSAHLHIS EQU   PSA+628                                                  04768000
PSAIPCSA EQU   PSA+624                                                  04769000
@NM00256 EQU   PSA+621                                                  04770000
PSAIPCDM EQU   PSA+620                                                  04771000
PSAIPCD  EQU   PSA+616                                                  04772000
@NM00255 EQU   PSA+613                                                  04773000
PSAIPCRM EQU   PSA+612                                                  04774000
PSAIPCR  EQU   PSA+608                                                  04775000
PSAMCHEX EQU   PSA+600                                                  04776000
PSAMPSW  EQU   PSA+592                                                  04777000
PSAEXPS2 EQU   PSA+584                                                  04778000
PSAEXPS1 EQU   PSA+576                                                  04779000
PSAPIREG EQU   PSA+572                                                  04780000
PSARSREG EQU   PSA+568                                                  04781000
PSAGPREG EQU   PSA+556                                                  04782000
PSARV022 EQU   PSASUP4                                                  04783000
PSARV021 EQU   PSASUP4                                                  04784000
PSARV020 EQU   PSASUP4                                                  04785000
PSARV019 EQU   PSASUP4                                                  04786000
PSARV018 EQU   PSASUP4                                                  04787000
PSARV017 EQU   PSASUP4                                                  04788000
PSARV016 EQU   PSASUP4                                                  04789000
PSARV015 EQU   PSASUP4                                                  04790000
PSARV014 EQU   PSASUP3                                                  04791000
PSARV013 EQU   PSASUP3                                                  04792000
PSARV012 EQU   PSASUP3                                                  04793000
PSARV011 EQU   PSASUP3                                                  04794000
PSASPR   EQU   PSASUP3                                                  04795000
PSAPSREG EQU   PSASUP3                                                  04796000
PSAPI2   EQU   PSASUP3                                                  04797000
PSAIOSUP EQU   PSASUP3                                                  04798000
PSALCR   EQU   PSASUP2                                                  04799000
PSARTM   EQU   PSASUP2                                                  04800000
PSAACR   EQU   PSASUP2                                                  04801000
PSAIPCE2 EQU   PSASUP2                                                  04802000
PSAIPCES EQU   PSASUP2                                                  04803000
PSAIPCEC EQU   PSASUP2                                                  04804000
PSAGTF   EQU   PSASUP2                                                  04805000
PSAIPCRI EQU   PSASUP2                                                  04806000
PSAIPCRP EQU   PSASUP1                                                  04807000
PSAIPCDR EQU   PSASUP1                                                  04808000
PSADISP  EQU   PSASUP1                                                  04809000
PSALOCK  EQU   PSASUP1                                                  04810000
PSAPI    EQU   PSASUP1                                                  04811000
PSAEXT   EQU   PSASUP1                                                  04812000
PSASVC   EQU   PSASUP1                                                  04813000
PSAIO    EQU   PSASUP1                                                  04814000
PSAAOLD  EQU   PSA+548                                                  04815000
PSAANEW  EQU   PSA+544                                                  04816000
PSATOLD  EQU   PSA+540                                                  04817000
PSATNEW  EQU   PSA+536                                                  04818000
PSALCCAR EQU   PSA+532                                                  04819000
PSALCCAV EQU   PSA+528                                                  04820000
PSAPCCAR EQU   PSA+524                                                  04821000
PSAPCCAV EQU   PSA+520                                                  04822000
PSACPULA EQU   PSA+518                                                  04823000
PSACPUPA EQU   PSA+516                                                  04824000
PSAPSA   EQU   PSA+512                                                  04825000
FLCHDEND EQU   PSA+512                                                  04826000
FLCCRSAV EQU   FLCMCLA+280                                              04827000
FLCGRSAV EQU   FLCMCLA+216                                              04828000
FLCFPSAV EQU   FLCMCLA+184                                              04829000
FLCFLA   EQU   FLCMCLA+88                                               04830000
FLCRGNCD EQU   FLCMCLA+84                                               04831000
FLCFSAA  EQU   FLCFSA+1                                                 04832000
@NM00254 EQU   FLCFSA                                                   04833000
@NM00253 EQU   FLCMCLA+72                                               04834000
FLCMCIC  EQU   FLCMCLA+64                                               04835000
@NM00252 EQU   FLCMCLA+20                                               04836000
FLCIOAA  EQU   FLCIOA+1                                                 04837000
@NM00251 EQU   FLCIOA                                                   04838000
@NM00250 EQU   FLCMCLA+15                                               04839000
@NM00249 EQU   FLCMCLA+14                                               04840000
@NM00248 EQU   FLCMCLA+12                                               04841000
FLCLCL   EQU   FLCMCLA+8                                                04842000
FLCIOELA EQU   FLCIOEL+1                                                04843000
@NM00247 EQU   FLCIOEL                                                  04844000
FLCCHNID EQU   FLCMCLA                                                  04845000
@NM00246 EQU   PSA+160                                                  04846000
FLCMTRCD EQU   PSA+157                                                  04847000
@NM00245 EQU   PSA+156                                                  04848000
FLCPERA  EQU   FLCPER+1                                                 04849000
@NM00244 EQU   FLCPER                                                   04850000
@NM00243 EQU   PSA+151                                                  04851000
FLCPERCD EQU   PSA+150                                                  04852000
FLCMCNUM EQU   PSA+149                                                  04853000
@NM00242 EQU   PSA+148                                                  04854000
FLCTEAA  EQU   FLCTEA+1                                                 04855000
@NM00241 EQU   FLCTEA                                                   04856000
PSAPIPC  EQU   PSAPICOD                                                 04857000
PSAPIMC  EQU   PSAPICOD                                                 04858000
PSAPIPER EQU   PSAPICOD                                                 04859000
PSARV049 EQU   FLCPICOD                                                 04860000
FLCPILCB EQU   FLCPIILC                                                 04861000
@NM00240 EQU   FLCPIILC                                                 04862000
@NM00239 EQU   PSAEPPSW                                                 04863000
FLCSVCN  EQU   PSAESPSW+2                                               04864000
FLCSILCB EQU   FLCSVILC                                                 04865000
@NM00238 EQU   FLCSVILC                                                 04866000
@NM00237 EQU   PSAESPSW                                                 04867000
FLCEICOD EQU   PSAEEPSW+2                                               04868000
PSASPAD  EQU   PSAEEPSW                                                 04869000
@NM00236 EQU   PSA+128                                                  04870000
FLCINPSW EQU   PSA+120                                                  04871000
FLCMNPSW EQU   PSA+112                                                  04872000
FLCPNPSW EQU   PSA+104                                                  04873000
FLCSNPSW EQU   PSA+96                                                   04874000
FLCENPSW EQU   PSA+88                                                   04875000
FLCTRACE EQU   PSA+84                                                   04876000
FLCTIMER EQU   PSA+80                                                   04877000
FLCCVT2  EQU   PSA+76                                                   04878000
FLCCAW   EQU   PSA+72                                                   04879000
FLCCSW   EQU   PSA+64                                                   04880000
FLCIOPSW EQU   PSA+56                                                   04881000
FLCMOPSW EQU   PSA+48                                                   04882000
FLCPOPSW EQU   PSA+40                                                   04883000
FLCSOPSW EQU   PSA+32                                                   04884000
FLCEOPSW EQU   PSA+24                                                   04885000
@NM00235 EQU   FLCICCW2+4                                               04886000
FLCCVT   EQU   FLCICCW2                                                 04887000
FLCICCW1 EQU   FLCROPSW                                                 04888000
FLCIPPSW EQU   FLCRNPSW                                                 04889000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      04890000
@RC00525 EQU   @RC00520                                                 04891000
@RC00548 EQU   @RC00520                                                 04892000
@RC00541 EQU   @RC00520                                                 04893000
@RC00603 EQU   @RC00600                                                 04894000
@RT00712 EQU   @RC00711                                                 04895000
@RC00732 EQU   @RC00729                                                 04896000
@RC00665 EQU   @RC00586                                                 04897000
@RC00991 EQU   @RC00990                                                 04898000
@RC00984 EQU   @EL00004                                                 04899000
@PB00004 EQU   @PB00005                                                 04900000
@RC00528 EQU   @RC00525                                                 04901000
@RC00526 EQU   @RC00525                                                 04902000
@RC00634 EQU   @RC00603                                                 04903000
@RC00725 EQU   @RC00665                                                 04904000
@PB00003 EQU   @PB00004                                                 04905000
@RC00750 EQU   @RC00725                                                 04906000
@PB00002 EQU   @PB00003                                                 04907000
@RC00753 EQU   @RC00750                                                 04908000
@ENDDATA EQU   *                                                        04909000
         END   IEDQWA1,(C'PLS2209',0701,78089)                          04910000
./  ADD  SSI=71540565,NAME=IEDQWB
         TITLE 'IEDQWB - TOTE RESOURCE MANAGEMENT MODULE'               00060000
IEDQWB   CSECT                                                          00120000
*A000000-999999                                                @Y16X5U0 00180000
*** THIS MODULE IS RESEQUENCED AS OF TCAM 10.0                 @Y17XAUU 00240000
* CHANGE ACTIVITY AS FOLLOWS:                                           00300000
*A169200,357300,677700,760500,855900                             X02004 00360000
*D354600                                                         X02004 00420000
*D326222-326330,775610-775760                                   SA41597 00480000
*A770000,886000                                                  A41582 00540000
*C070000-072000,700030-700050,773500                             A41582 00600000
*A106990-107030,688460-688640,775330-775340                      S21903 00660000
*C700054,700056-700058                                           S21903 00720000
*D326222-326330,775610-775820                                    S21903 00780000
*C000000-999999                                                  S22024 00840000
*C841500-842400                                                  S05331 00900000
*D760600-761000                                                @YA10453 00960000
*A129600,664200,833400                                         @YA10453 01020000
*A152100,237600,242100,308700,836100938700                     @Y17XAUU 01080000
*C678600,675000,834020,334800,340200,602100,606600             @Y17XAUU 01140000
*D351650-351700,643500,841500                                  @Y17XAUU 01200000
* A012000,038400,129500,305400                                 @XM05671 01210010
* D212400-214800                                               @XM05672 01220010
*                                                                       01230010
         EJECT                                                          01260000
*********************************************************************** 01320000
*                                                                     * 01380000
* MODULE NAME:  IEDQWB (TCAM,TOTE)                             @Y17XAUU 01440000
*                                                                     * 01500000
* DESCRIPTIVE NAME:  TOTE RESOURCE MANAGEMENT MODULE                  * 01560000
*                                                                     * 01620000
* COPYRIGHT:  'NONE'                                                  * 01680000
*                                                                     * 01740000
* STATUS:  VERSION 10.0                                        @Y17XAUU 01800000
*                                                                     * 01860000
* FUNCTIONS:                                                          * 01920000
*                                                                     * 01980000
*    IEDQWB PERFORMS ONE OF THE FOLLOWING FUNCTIONS REQUESTED BY      * 02040000
*    MODULE IEDQWA:                                                   * 02100000
*                                                                     * 02160000
*    FUNCTION 1 - ON THE FIRST PASS, IEDQWB DETERMINES THE CORE       * 02220000
*                 AVAILABLE TO TOTE.  IT GETS THE NUMBER OF DUMMY     * 02280000
*                 ENTRIES REQUESTED ON THE OLTERM= OPERAND OF THE     * 02340000
*                 TTABLE MACRO AND INITIALIZES THE DUMMY TERMNAME     * 02400000
*                 TABLE ENTRIES AND THE EXTENDED AREA FOR THE TERMINAL* 02460000
*                 ENTRIES (TTE'S) AND QUEUE CONTROL BLOCKS (QCB'S).   * 02520000
*                 IT ALSO LOADS THE ACCESS MANAGER ROUTINE     @Y17XAUU 02580000
*                 IEDQWO AND ALL SERVICE ROUTINES (IEDQWAA,    @Y17XAUU 02640000
*                 IEDQWAB,IEDQWAJ,IEDQWM2,IEDQW35,IEDQW39,     @Y17XAUU 02700000
*                 IEDQWP1,IEDQWP2,IEDQW37,IEDQW28,IEDQW36,     @Y17XAUU 02760000
*                 IEDQWAC,IEDQW41,IEDQW42,IEDQW44,IEDQW47,     @Y17XAUU 02820000
*                 IEDQW16,IEDQW25, AND IEDQW33). IT CHECKS TO  @Y17XAUU 02880000
*                 SEE IF THE TOTE MH (IEDTOTMH) HAS BEEN       @Y17XAUU 02940000
*                 SYSGEN'ED WITH THE MCP. IF THE TOTE MH IS    @Y17XAUU 03000000
*                 PRESENT, ITS ADDRESS IS SAVED IN THE RESPL   @Y17XAUU 03060000
*                 CONTROL BLOCK.                               @Y17XAUU 03120000
*                                                                     * 03180000
*    FUNCTION 2 - THIS FUNCTION CLEANS UP WHEN A TCAM CLOSEDOWN HAS   * 03240000
*                 BEEN ISSUED.  IT FREEMAINS ANY CORE GOTTEN BY TOTE, * 03300000
*                 DETACHES THE OLT, AND DELETES THE ACCESS MANAGER    * 03360000
*                 MODULE IEDQWO AND AND THE SERVICE ROUTINES.  @Y17XAUU 03420000
*                                                                     * 03480000
*    FUNCTION 3 - THIS FUNCTION IS THE END OF SUBTASK (I.E. OLT) CLEAN* 03540000
*                 UP ROUTINE.  IT FREES ANY DUMMY ENTRIES THAT WERE   * 03600000
*                 USED AND FREEMAINS THE OLTCB.  IT MANAGES THE CORE  * 03660000
*                 IN THE EXTENDED AREA (N X 184 BYTES WHERE N IS THE  * 03720000
*                 VALUE SPECIFIED ON OLTERM= OPERAND OF THE TTABLE    * 03780000
*                 MACRO) TO MINIMIZE FRAGMENTATION OF THE AREA.       * 03840000
*                 IF CLEANUP WAS INITIATED BY OPERATOR CONTROL @XM05671 03850010
*                 (VIA POST OF OP CTL CLEANUP ELEMENT), THE    @XM05671 03860010
*                 COUNT OF 'TESTS AFFECTED' CONTAINED IN THE   @XM05671 03870010
*                 ELEMENT IS DECREMENTED. IF ZERO, OP CTL IS   @XM05671 03880010
*                 REDRIVEN BY POSTING THE ELEMENT TO AVTOPCOB. @XM05671 03890010
*                                                                     * 03900000
*    FUNCTION 4 - THIS FUNCTION ALLOCATES DUMMY TNT ENTRIES, QCB'S,   * 03960000
*                 LGB'S AND TTE'S FOR THE CONTROL TERMINAL, ALT@Y17XAUU 03970000
*                 PRINTER, PRIMARY TEST DEVICE OR SECONDARY TEST      * 04080000
*                 DEVICE WHEN REQUESTED.  IT ASSIGNS THE MAIN STORAGE * 04140000
*                 TO THE OLT AND DISPATCHES THE OLT.                  * 04200000
*                                                                     * 04260000
*    FUNCTION 5 - THIS FUNCTION INITIALIZES THE OLTCB FOR A NEWLY     * 04320000
*                 RECEIVED TRM BY ALLOCATING THE CORE REQUIRED,       * 04380000
*                 CLEARING THE CORE AND SETTING UP THE REQUIRED       * 04440000
*                 CONTROL FIELDS.                                     * 04500000
*                                                                     * 04560000
*    FUNCTION 6 - THIS FUNCTION PERFORMS CLEANUP WHEN AN OLT          * 04620000
*                 ABNORMALLY TERMINATES.  IT INFORMS THE SYSTEM       * 04680000
*                 CONSOLE OPERATOR OF THE OLT ABENDING AND THE        * 04740000
*                 COMPLETION CODE.                                    * 04800000
*                                                                     * 04860000
* ENTRY POINT:                                                        * 04920000
*                                                                     * 04980000
*    IEDQWB                                                    @Y17XAUU 05040000
*                                                                     * 05100000
* INPUT:  REGISTERS 00,02,04,13,14,15 CONTAIN THE FOLLOWING VALUES:   * 05160000
*                                                                     * 05220000
*                 00 - PARAMETER REGISTER                             * 05280000
*                 01 - RESPL ADDRESS                           @Y17XAUU 05290000
*                 02 - BUFFER ADDRESS                          @Y17XAUU 05340000
*                 04 - AVT ADDRESS                                    * 05400000
*                 13 - SAVE AREA ADDRESS                              * 05460000
*                 14 - RETURN ADDRESS                                 * 05520000
*                 15 - ENTRY POINT ADDRESS                            * 05580000
*                                                                     * 05640000
* OUTPUT: REGISTERS 01 AND 15 CONTAIN THE FOLLOWING VALUES:           * 05700000
*                                                                     * 05760000
*                 01 - PARAMETER LIST ADDRESS                         * 05820000
*                 15 - RETURN CODE                                    * 05880000
*                                                                     * 05940000
* EXTERNAL REFERENCES:  NONE                                          * 06000000
*                                                                     * 06060000
* EXITS,NORMAL:  RETURNS TO IEDQWA WITH ONE OF THE FOLLOWING          * 06120000
*                RETURN CODES SET IN REGISTER 15:                     * 06180000
*                                                                     * 06240000
*                    0 - CONTINUE QUEUE SCAN                          * 06300000
*                    4 - WAIT FOR NEXT REQUEST FROM TCAM              * 06360000
*                    8 - RETURN TO TCAM                               * 06420000
*                                                                     * 06480000
* EXITS,ERROR: NONE                                                   * 06540000
*                                                                     * 06600000
* MODULE TYPE: PROCEDURE                                       @Y17XAUU 06660000
*                                                              @Y17XAUU 06720000
* PROCESSOR: ASSEMBLER XF                                      @Y17XAUU 06780000
*                                                              @Y17XAUU 06840000
* MODULE SIZE: SEE ASSEMBLE LISTING                            @Y17XAUU 06900000
*                                                              @Y17XAUU 06960000
* MACROS: LOAD                                                 @Y17XAUU 07020000
*         DELETE                                               @Y17XAUU 07080000
*         IEDHJN                                               @Y17XAUU 07140000
*         SAVE                                                 @Y17XAUU 07200000
*         OPEN                                                 @Y17XAUU 07260000
*         STIMER                                               @Y17XAUU 07320000
*         WAIT                                                 @Y17XAUU 07380000
*         TTIMER                                               @Y17XAUU 07440000
*         DETACH                                               @Y17XAUU 07500000
*         ATTACH                                               @Y17XAUU 07560000
*         FREEMAIN                                             @Y17XAUU 07620000
*         GETMAIN                                              @Y17XAUU 07680000
*         POST                                                 @Y17XAUU 07800000
*         WTO                                                  @Y17XAUU 07860000
*         TOPCTL                                               @Y17XAUU 07920000
*                                                              @Y17XAUU 07980000
* NOTES: SEE BELOW                                             @Y17XAUU 08040000
*                                                              @Y17XAUU 08100000
*  DEPENDENCIES: EBCDIC CHARACTER CODE.                        @Y17XAUU 08160000
*                                                              @Y17XAUU 08220000
*  RESTRICTIONS: NONE                                          @Y17XAUU 08280000
*                                                              @Y17XAUU 08340000
*  REGISTER CONVENTIONS: SEE REGISTERS ASSIGNMENT              @Y17XAUU 08400000
*                                                              @Y17XAUU 08460000
*  PATCH: PATCH                                                @Y17XAUU 08520000
*                                                              @Y17XAUU 08580000
* PURPOSE: SEE FUNCTION                                        @Y17XAUU 08640000
*                                                              @Y17XAUU 08700000
* TABLES/WORK AREAS:                                                  * 08760000
*                                                                     * 08820000
*    AVT, CVT, OLTCB, RESPL, TNT, PRF, DCB, LCB, REQ, UCB, SAT,       * 08880000
*    NAT, RVT                                                  @Y17XAUU 08890000
*                                                                     * 08940000
* ATTRIBUTES:                                                         * 08990000
*                                                                     * 09040000
*    ENABLED, PROBLEM PROGRAM MODE, TRANSIENT                         * 09090000
*                                                                     * 09140000
*********************************************************************** 09240000
         EJECT                                                          09290000
*********************************************************************** 09340000
*                                                                       09390000
*        REGISTER EQUATES                                               09440000
*                                                                       09540000
*********************************************************************** 09590000
         SPACE 2                                                        09640000
R0       EQU   0                  WORK REGISTER                         09690000
R1       EQU   1                  PARAMETER LIST ADDRESS                09740000
R2       EQU   2                  WORK REGISTER                         09840000
R3       EQU   3                  WORK REGISTER                         09890000
R4       EQU   4                  ADDRESS OF AVT                        09940000
R5       EQU   5                  WORK REGISTER                         09990000
R6       EQU   6                  WORK REGISTER                         10040000
R7       EQU   7                  WORK REGISTER                         10140000
R8       EQU   8                  WORK REGISTER                         10190000
R9       EQU   9                  WORK REGISTER                         10240000
R10      EQU   10                 WORK REGISTER                         10290000
R11      EQU   11                 BASE REGISTER                         10340000
R12      EQU   12                 ADDRESS OF RESIDENT PARAMETER LIST    10440000
R13      EQU   13                 REGISTER SAVE AREA ADDRESS            10490000
R14      EQU   14                 RETURN ADDRESS                        10540000
R15      EQU   15                 RETURN CODE REGISTER                  10590000
*                                                                       10640000
         SPACE 3                                                        10740000
**************************************************************** S22024 10790000
*        MODULE EQUATES                                        * S22024 10840000
**************************************************************** S22024 10890000
         SPACE 2                                                        10940000
D0       EQU   0                  CONSTANT VALUE                 S22024 11040000
D1       EQU   1                  CONSTANT VALUE                 S22024 11090000
D2       EQU   2                  CONSTANT VALUE                 S22024 11140000
D3       EQU   3                  CONSTANT VALUE                 S22024 11190000
HWRD     EQU   3                  TO PICKUP HALFWORD           @Y17XAUU 11240000
MULTIPLY EQU   3                  TO MULTIPLY BY 8             @Y17XAUU 11340000
D4       EQU   4                  CONSTANT VALUE                 S22024 11390000
D5       EQU   5                  CONSTANT VALUE                 S22024 11440000
D6       EQU   6                  CONSTANT VALUE                 S22024 11490000
D7       EQU   7                  CONSTANT VALUE                 S22024 11540000
D8       EQU   8                  CONSTANT VALUE                 S22024 11640000
D9       EQU   9                  CONSTANT VALUE                 S22024 11690000
D10      EQU   10                 CONSTANT VALUE                 S22024 11740000
D12      EQU   12                 CONSTANT VALUE                 S22024 11790000
D20      EQU   20                 CONSTANT VALUE                 S22024 11840000
D21      EQU   21                 CONSTANT VALUE                 S22024 11940000
D24      EQU   24                 CONSTANT VALUE                 S22024 11990000
D28      EQU   28                 CONSTANT VALUE               @YA10453 12040000
D64      EQU   64                 CONSTANT VALUE                 S22024 12090000
D80      EQU   80                 CONSTANT VALUE                 S22024 12140000
D256     EQU   256                LENGTH FOR CLEARING OLTCB      S22024 12240000
XF0      EQU   X'F0'              USED WHEN UNPACKING A NUMBER   S22024 12290000
XFF      EQU   X'FF'              USED IN TURNING OFF FLAGS             12350000
BLANK    EQU   C' '               BLANK CHARACTER                S22024 12410000
ZEROEQ   EQU   0                  THE CONSTANT 0                 S22024 12470000
THREEEQU EQU   3                  CONSTANT VALUE 3               S22024 12530000
TNTADRLN EQU   3                  LENGTH OF ADDRESS IN TERMINAL  S22024 12590000
*                                   NAME TABLE ENTRY             S22024 12650000
OLTCBKEY EQU   X'D6'              OLTCB QUEUE ELEMENT KEY        S22024 12710000
EXAFQKEY EQU   X'C5'              KEY FOR EXTENDED AREA FREE     S22024 12770000
*                                   QUEUE ELEMENTS               S22024 12830000
TIMEEND  EQU   X'80'              TIMER COMPLETION FLAG          S22024 12890000
SUBTRNSZ EQU   8                  MINIMUM OLT SIZE (8K)        @YM07420 12950000
TESTCTR  EQU   8                  OFFSET OF 'AFFECTED TESTS'   @XM05671 12970010
*                                  CT. IN REQDATA PORTION OF OP@XM05671 12990010
*                                  CTL ELMT (GEN REQUEST ELMT) @XM05671 13010010
TICCODE  EQU   X'08'              TIC CHANNEL COMMAND CODE     @XM05671 13030010
OPENFLAG EQU   X'8F'              OPEN FLAG                      S21903 13080000
SUCCESS  EQU   X'10'              INDICATION OF SUCCESSFUL OPEN  S21903 13140000
*                                                                S22024 13200000
*        RETURN CODES                                            S22024 13260000
*                                                                S22024 13320000
CONTINUE EQU   0                  DIRECT IEDQWA TO CONTINUE THE  S22024 13380000
*                                   QUEUE SCAN                   S22024 13440000
GOWAIT   EQU   4                  DIRECT IEDQWA TO WAIT          S22024 13500000
TCAMRET  EQU   8                  DIRECT IEDQWA TO RETURN TO TCAMS22024 13560000
OLTFLG   EQU   X'80'              DCB OPEN FLAG (INPUT ONLY)   @Y17XAUU 13620000
ADRMSK   EQU   7                  ADDRESS MASK                 @Y17XAUU 13680000
MSKHI    EQU   X'08'              MASK FIELD                   @Y17XAUU 13740000
         SPACE 2                                                        13800000
         EJECT                                                          13860000
*                                                                       13920000
*        SATISFY SYSTEM LINKAGE CONVENTIONS                             13980000
*                                                                       14040000
         SAVE  (14,12)                                                  14100000
         USING IEDQAVTD,R4        SET UP ADDRESSIBILITY FOR AVT         14160000
         LR    R11,R15            GET ENTRY POINT ADDRESS               14220000
         USING IEDQWB,R11         ESTABLISH BASE REGISTER               14280000
IEDQWB   IEDHJN IEDQWBB,HJN       MODULE ID AND HJN                     14340000
         ST    R13,REGSAVE+D4     SAVE POINTER TO TCAM REG SAVE AREA    14400000
         LR    R12,R13            PUT SAVE AREA POINTER INTO REG 12     14460000
         LA    R13,REGSAVE        GET ADDRESS OF OWN SAVE AREA          14520000
         ST    R13,D8(R12)        STORE SAVE AREA ADDRESS IN TCAM       14580000
*                                   SAVE AREA                           14640000
         LR    R12,R1             GET ADDRESS OF RESIDENT PARAMETER     14700000
*                                   LIST                                14760000
         USING RESPL,R12          SET UP ADDRESSIBILITY FOR RESIDENT    14820000
*                                   PARAMETER LIST (RESPL)              14880000
         ST    R2,ELADDR               SAVE BUFFER ADDRESS       X02004 14940000
         EJECT                                                          15000000
*********************************************************************** 15060000
*                                                                     * 15120000
*        FUNCTION 1 - TOTE INITILIZATION                              * 15180000
*                                                                     * 15240000
*********************************************************************** 15300000
FUNCT1   EQU   *                                                        15360000
         TM    RESFLAGS,RESINIT   IS THIS THE FIRST PASS?               15420000
         BO    FUN140             NO, BRANCH                            15480000
         OI    RESFLAGS,RESINIT   YES, TURN OFF FIRST TIME SWITCH       15540000
         SR    R7,R7              CLEAR REGISTER 7                      15600000
         IC    R7,AVTOLTST        GET OLT TRANSIENT AREA SIZE OPTION    15660000
*                                   FROM THE AVT                        15720000
         SH    R7,RESSIZE         SUBTRACT TOTE RESIDENT REQUIREMENT    15780000
         STH   R7,RESBKTOT        STORE RESULT IN BLOCKS TOTAL          15840000
*                                                                       15900000
*        INITIALIZE DUMMY TNT ENTRIES                                   15960000
*                                                                       16020000
         L     R5,AVTRNMPT        GET TERMINAL NAME TABLE ADDR          16080000
         USING IEDQTNTD,R5        SET UP ADDRESSIBILITY FOR TERMNAME    16140000
*                                   TABLE                               16200000
         LH    R7,TNTLEN          GET NUMBER OF TABLE ENTRIES           16260000
         LR    R8,R7                DUPLICATE IT                        16320000
         SR    R9,R9              GET                                   16380000
         IC    R9,TNTENLEN          LENGTH                              16440000
         LA    R9,D3(R9)            OF ENTRY                            16500000
         MR    R6,R9              GET ADDRESS OF TOTE DUMMY             16560000
         LA    R3,TNTFIRST(R7)      TNT FIELD                           16620000
         DROP  R5                                                       16680000
         USING DEXT,R3                                                  16740000
         MVC   RESTNTCT(D4),DEXTCNT SAVE TOTE TNT ENTRY COUNT           16800000
*                                     AND ADDRESS OF EXTENDED AREA      16860000
         ST    R3,RESTNTPT-D1     SAVE ADDRESS OF TOTE TNT FIELD        16920000
         SR    R7,R7              GET NUMBER OF TOTE                    16980000
         IC    R7,RESTNTCT        TNT ENTRIES                           17040000
         LR    R5,R7              DUPLICATE IT                          17100000
         LTR   R7,R7              IS THE NUMBER ZERO?                   17160000
         BZ    FUN120             YES, NO DUMMY TNT ENTRIES SPECIFIED   17220000
*                                   SO BRANCH AROUND SET UP             17280000
         MVI   DEXT,BLANK         FILL TOTE TNT AREA                    17340000
         MVC   DEXT+D1(D3),DEXT     WITH BLANKS                         17400000
         LR    R6,R3              SET INITIAL VALUE FOR TNT             17460000
         SH    R6,TNTEADLN          ENTRY ADDRESS POINTER               17520000
FUN110   EQU   *                                                        17580000
         AR    R6,R9              GET POINTER TO NEXT TNT               17640000
*                                   ENTRY ADDRESS FIELD                 17700000
         LA    R8,D1(R8)          GET TNT OFFSET FOR THIS ENTRY         17760000
         STH   R8,WBWORK01+D4     STORE OFFSET FOR MVC INSTRUCTION      17820000
         MVC   D0(D2,R6),WBWORK01+D4  MOVE OFFSET INTO TNT ENTRY        17880000
*                                       ADDRESS FIELD                   17940000
         BCT   R7,FUN110          LOOP TIL ALL TOTE TNT ENTRY           18000000
*                                   OFFSETS ARE SAVED                   18060000
         SR    R6,R9              CALCULATE ADDRESS                     18120000
         LA    R6,D3(R6)            OF LAST TOTE TNT ENTRY              18180000
         ST    R6,RESTTLST          AND SAVE IN RESIDENT                18240000
*                                   CONTROL BLOCK                       18300000
         DROP  R3                                                       18360000
*                                                                       18420000
*        INITIALIZE EXTENDED AREA FOR QCBS AND TTES                     18480000
*                                                                       18540000
*                                                                       18600000
*        REGISTER R5 CONTAINS NUMBER OF TOTE TNT ENTRIES                18660000
*                                                                       18720000
         L     R2,RESDMTTE-D1     GET EXTENDED AREA ADDRESS             18780000
         USING QEL,R2                                                   18840000
         LA    R3,RESEFQCB        PUT EXTENDED AREA FREE QCB            18900000
         ST    R3,QELQCB-D1         ADDRESS IN ELEMENT                  18960000
         MVI   QELKEY,EXAFQKEY         AND SET KEY                      19020000
         LA    R7,DEXTLFTR        GET EXTENDED AREA LENGTH FACTOR       19080000
         MR    R6,R5              CALCULATE LENGTH OF EXTENDED          19140000
         STH   R7,QELSIZE           AREA AND SAVE IT                    19200000
         L     R15,RESADDND       GET QUEUE HANDLER ADDRESS             19260000
         BALR  R10,R15              AND ADD ELEMENT TO END              19320000
*                                   OF QUEUE                            19380000
         DROP  R2                                                       19440000
FUN120   EQU   *                                                        19500000
         TM    AVTSAVTF,AVTVTMCP  3705 ENVIRONMENT             @Y17XAUU 19560000
         BZ    MHEXIT             NO - BYPASS TOTE MH CHECK    @Y17XAUU 19620000
         L     R10,AVTSAVTP       GET SAVT ADDRESS             @Y17XAUU 19680000
         LA    R10,D0(R10)        CLEAR FLAG BYTE              @Y17XAUU 19740000
         USING IEDNSVTD,R10       ESTABLISH ADDRESSABILITY     @Y17XAUU 19800000
         LH    R7,SAVTMHDX        GET INDEX OF FIRST MH ENTRY  @Y17XAUU 19860000
         L     R15,SAVTTNTX       GET TTCIN TO NETWORK ADDRESS @Y17XAUU 19920000
*                                 CONVERSION ROUTINE ADDRESS   @Y17XAUU 19980000
         L     R10,SAVTMHTB       GET MH TABLE ADDRESS         @Y17XAUU 20040000
         DROP  R10                                             @Y17XAUU 20100000
         USING IEDMHTD,R10        ESTABLISH ADDRESSABILITY     @Y17XAUU 20160000
MHLOOP   DS    0H                 CHECK FOR TOTE MH GEN'ED     @Y17XAUU 20220000
         CLI   MHTABEND,MHFLGE    END OF TABLE                 @Y17XAUU 20280000
         BE    MHEXIT             YES - TOTE MH NOT GEN'ED     @Y17XAUU 20340000
         CLC   MHNAME,TOTEMH      TOTE MH ENTRY                @Y17XAUU 20400000
         BE    MHFOUND            YES                          @Y17XAUU 20460000
         LA    R7,D1(R7)          INCREMENT TTCIN OFFSET       @Y17XAUU 20520000
         LA    R1,MHTABLEN        MH TABLE ENTRY LENGTH        @Y17XAUU 20580000
         AR    R10,R1             POINT TO NEXT ENTRY          @Y17XAUU 20640000
         B     MHLOOP             CHECK NEXT ENTRY             @Y17XAUU 20700000
MHFOUND  DS    0H                 TOTE MH HAS BEEN GEN'ED      @Y17XAUU 20760000
         MVC   RESTOTMH(D4),MHENTRY SAVE TOTE MH ADDRESS       @Y17XAUU 20820000
         STH   R7,RESMHSRC        SAVE TOTE MH TTCIN           @Y17XAUU 20880000
         LR    R1,R7              SET UP TO FIND NETWORK ADDR  @Y17XAUU 20940000
         BALR  R14,R15            CALL IEDIAP04                @Y17XAUU 21000000
         STH   R15,RESMHNAT       SAVE TOTE MH NETWORK ADDRESS @YM07278 21060000
MHEXIT   DS    0H                 END OF TOTE MH CHECK         @Y17XAUU 21120000
         DROP  R10                                             @Y17XAUU 21180000
         LA    R1,RESAPDCB        GET ADDRESS OF DIAGMSG DCB     S21903 21540000
         ST    R1,WBWORK01        PUT IN PARM LIST               S21903 21600000
         MVI   WBWORK01,OPENFLAG  SET FLAG                       S21903 21660000
         LA    R1,WBWORK01        POINT TO PARM LIST             S21903 21720000
         OPEN  MF=(E,(1))         OPEN SYSOUT DCB                S21903 21780000
         LA    R6,RESPLADR        RESIDENT MOD ADDRESS LIST    @Y17XAUU 21840000
         LA    R7,LOADLIST        RESIDENT MOD ID LIST         @Y17XAUU 21900000
*                                                            * @Y17XAUU 21960000
*        THE ENTRIES IN THE RESIDENT MODULE ADDRESS LIST MUST* @Y17XAUU 22020000
*        BE DEFINED IN THE SAME ORDER AS THE RESIDENT MODULE * @Y17XAUU 22080000
*        ID LIST.                                            * @Y17XAUU 22140000
*                                                            * @Y17XAUU 22200000
LOADRES  DS    0H                 LOAD RESIDENT MODULES        @Y17XAUU 22260000
         CLC   D0(D2,R7),ENDLIST  END OF LOAD LIST             @Y17XAUU 22320000
         BE    LOADEND            YES - EXIT                   @Y17XAUU 22380000
         MVC   MODID(D2),D0(R7)   MOVE MOD ID TO LOAD NAME     @Y17XAUU 22440000
         LOAD  EPLOC=MODNAME      LOAD THE MODULE              @Y17XAUU 22500000
         ST    R0,D0(R6)          SAVE MODULE ADDRESS          @Y17XAUU 22560000
         LA    R6,D4(R6)          NEXT ADDRESS SLOT            @Y17XAUU 22620000
         LA    R7,D2(R7)          NEXT MOD ID                  @Y17XAUU 22680000
         B     LOADRES            LOAD NEXT MODULE             @Y17XAUU 22740000
LOADEND  DS    0H                 END OF LOADING               @Y17XAUU 22800000
FUN140   EQU   *                                                        22860000
         SR    R15,R15            CLEAR REG 15                          22920000
         IC    R15,RESWBFNC       GET FUNCTION CODE                     22980000
         B     RESB01(R15)          AND GO PERFORM IT                   23040000
RESB01   EQU   *                                                        23100000
         B     FUNCT1             TOTE INITILIZATION                    23160000
         B     FUNCT2             ISSUE FREEMAINS, DELETES AND          23220000
*                                   INFORMS CE OF CLOSEDOWN             23280000
         B     FUNCT3             SUBTASK ENDED CLEAN UP                23340000
         B     FUNCT4             HONORS TNT REQUEST, ASSIGN MAIN       23400000
*                                   STORAGE, AND DISPATCH OLT           23460000
         B     FUNCT5             SET UP OLTCB FOR NEW OLT REQUEST      23520000
         B     FUNCT6             OLT ABEND CLEAN UP ROUTINE            23580000
         SPACE 2                                                        23640000
RETURN2  EQU   *                                                        23700000
         LA    R15,GOWAIT         DIRECT IEDQWA TO ENTER                23760000
*                                   WAIT STATE                          23820000
         B     RETURN1              & RETURN                            23880000
RETURN   EQU   *                                                        23940000
         LA    R15,CONTINUE       DIRECT IEDQWA TO                      24000000
*                                   CONTINUE QUEUE SCAN                 24060000
RETURN1  EQU   *                                                        24120000
         L     R13,D4(R13)        GET CALLER'S SAVE AREA POINTER        24180000
         L     R14,D12(R13)       RESTORE REGISTER 14                   24240000
         LM    R0,R12,D20(R13)    RESTORE REMAINING REGS EXCEPT 15      24300000
         BR    R14                    RETURN TO CALLER                  24360000
         EJECT                                                          24420000
*********************************************************************** 24480000
*                                                                     * 24540000
*        FUNCTION 2 - ISSUE FREEMAINS,DELETES AND INFORM CE OF        * 24600000
*                     CLOSEDOWN                                       * 24660000
*                                                                     * 24720000
*********************************************************************** 24780000
FUNCT2   EQU   *                                                        24840000
         L     R5,RESOBQCB        GET 1ST OLTCB QUEUE ELEMENT           24900000
FUN201   EQU   *                                                        24960000
         USING TOTOBPTR,R5        SET UP ADDRESSIBILITY FOR OLTCB       25020000
         CLI   TOTELKEY,QENDKEY   IS THIS THE END OF OLTCB QUEUE?       25080000
         BE    FUN202             YES, BRANCH                           25140000
         TM    TOTFLG10,TOTOLTED  IS OLT REQUEST SATISFIED?             25200000
         BO    FUN2015            YES, BRANCH                           25260000
         L     R5,TOTELLNK-D1     GET NEXT QUEUE ELEMENT                25320000
         DROP  R5                                                       25380000
         B     FUN201             BRANCH BACK AND EXAMINE NEXT ELEMENT  25440000
FUN2015  EQU   *                                                        25500000
         LR    R2,R5              PUT OLTCB ADDRESS INTO REGISTER 2     25560000
         BAL   R9,OLTTERM         GO TERMINATE REQUEST                  25620000
         B     FUNCT2             GET NEXT QUEUE ELEMENT                25680000
FUN202   EQU   *                                                        25740000
         L     R1,RESOBQCB        GET 1ST OLTCB QUEUE ELEMENT           25800000
         USING TOTOBPTR,R1        SET UP ADDRESSIBILITY FOR OLTCB       25860000
         CLI   TOTELKEY,QENDKEY   IS OLTCB QUEUE EMPTY?                 25920000
         BE    FUN203             YES, BRANCH                           25980000
         DROP  R1                                                       26040000
         STIMER REAL,TIMEREND,DINTVL=SECS10  SET 10 SECOND TIMER        26100000
         WAIT  ECB=RESTECB1       WAIT FOR OLT COMPLETIONS              26160000
         XC    RESTECB1(D4),RESTECB1  CLEAR TOTE ECB                    26220000
         TTIMER CANCEL            CANCEL TIMER                          26280000
         TM    WBFLAGS,TIMEEND    DID TIMER TIME OUT?                   26340000
         BZ    FUNCT2             NO, GO BACK AND GET 1ST OLTCB         26400000
         L     R5,RESOBQCB        GET 1ST OLTCB QUEUE ELEMENT           26460000
FUN2022  EQU   *                                                        26520000
         USING TOTOBPTR,R5        SET UP ADDRESSIBILITY FOR OLTCB       26580000
         CLI   TOTELKEY,QENDKEY   IS THIS END OF OLTCB QUEUE?           26640000
         BE    FUN203             YES, BYPASS SUBTASK DETACH            26700000
         CLC   TOTTCBAD+D1(D3),ZERO HAS THE ATTACH BEEN PERFORMED?      26760000
         BE    FUN203             NO, BYPASS SUBTASK DETACH             26820000
         OI    TOTFLG04,TOTDTCHD  SET TASK ALREADY DETACHED FLAG        26880000
         DETACH TOTTCBAD          DETACH SUBTASK                        26940000
         L     R5,TOTELLNK-D1     GET NEXT QUEUE ELEMENT                27000000
         DROP  R5                                                       27060000
         B     FUN2022            GO BACK AND EXAMINE NEXT ELEMENT      27120000
FUN203   EQU   *                                                        27180000
         LA    R7,RESPLADR        RESIDENT MOD ID LIST         @Y17XAUU 27240000
DELLIST  DS    0H                 DELETE RESIDENT MODULES      @Y17XAUU 27300000
         CLC   D0(D2,R7),ENDLIST  END OF DELETE LIST           @Y17XAUU 27360000
         BE    DELEND             YES - EXIT                   @Y17XAUU 27420000
         MVC   MODID(D2),D0(R7)   MOVE MOD ID TO DELETE NAME   @Y17XAUU 27480000
         DELETE EPLOC=MODNAME     DELETE THE MODULE            @Y17XAUU 27540000
         LA    R7,D2(R7)          NEXT MOD ID                  @Y17XAUU 27600000
         B     DELLIST            DELETE NEXT MODULE           @Y17XAUU 27660000
DELEND   DS    0H                 END OF DELETING              @Y17XAUU 27720000
         LA    R15,TCAMRET        DIRECT IEDQWA TO RETURN TO TCAM       27780000
         B     RETURN1            RETURN TO IEDQWA                      27840000
         EJECT                                                          27900000
*********************************************************************** 27960000
*                                                                     * 28020000
*        FUNCTION 3 - END OF SUBTASK CLEAN UP ROUTINE                 * 28080000
*                                                                     * 28140000
*********************************************************************** 28200000
FUNCT3   EQU   *                                                        28260000
         USING TOTOBPTR,R2        SET UP ADDRESSIBILITY FOR OLTCB       28320000
         NI    TOTFLG10,XFF-TOTOLTED  CLEAR SUBTASK ENDED FLAG          28380000
         CLC   TOTCMPCD+D1(D3),ZERO   DID THE SUBTASK ABEND?            28440000
         BNE   FUNCT6             YES, GO TO OLT ABEND CLEANUP ROUTINE  28500000
FUN33    EQU   *                                                        28560000
         BAL   R9,OLTTERM         GO TERMINATE REQUEST                  28620000
         B     RETURN             RETURN TO IEDQWA                      28680000
         SPACE 5                                                        28740000
OLTTERM  EQU   *                                                        28800000
         LR    R6,R2              SAVE OLTCB ADDRESS IN R6              28860000
         DROP  R2                                                       28920000
         USING TOTOBPTR,R6        SET UP ADDRESSIBILITY FOR OLTCB       28980000
         MVI   RQQTYPE,D0         SHOW CLEANUP REQUEST         @Y17XAUU 29040000
         LA    R7,TOTCTENT        GET C.T. ENTRY ADDRESS                29100000
         BAL   R14,TERMLUS        IF LU TERM SESSION           @Y17XAUU 29120000
*        IF CT ENTRY NOT ASSIGNED RETURN IS 8(REG14)           @Y17XAUU 29140000
         BAL   R14,RVTNAT         RVT/NAT PROCESSING           @Y17XAUU 29160000
         BAL   R8,FREETNT           AND GO FREE TNT ENTRY               29200000
*                                   AND EXTENDED AREA                   29280000
         LA    R7,TOTAPENT        GET A.P. ENTRY ADDRESS                29320000
         BAL   R14,TERMLUS        IF LU TERM SESSION           @Y17XAUU 29360000
*        IF AP ENTRY NOT ASSIGNED RETURN IS 8(REG14)           @Y17XAUU 29380000
         BAL   R14,RVTNAT         RVT/NAT PROCESSING           @Y17XAUU 29400000
         BAL   R8,FREETNT           AND GO FREE TNT ENTRY               29460000
*                                   AND EXTENDED AREA                   29520000
         LA    R7,TOTPRENT        GET PRIMARY DEVICE ENTRY ADDR         29760000
         TM    TOTFLG04,TOTPRCTF  PRIMARY ENTRY ASSIGNED?      @YM08057 29763000
         BZ    CHKSCDEV           ENTRY NOT ASSIGNED           @YM08057 29766000
         BAL   R14,TERMLUS        IF LU TERM SESSION           @Y17XAUU 29780000
*        IF PRIMARY TD IS NOT ASSIGNED RETURN IS 8(REG14)      @Y17XAUU 29800000
         BAL   R14,RVTNAT         RVT/NAT PROCESSING           @Y17XAUU 29820000
         BAL   R8,FREETNT           AND GO FREE TNT ENTRY               29860000
*                                   AND EXTENDED AREA                   29940000
CHKSCDEV EQU   *                                               @YM08057 30040000
         LA    R7,TOTSCENT        GET SECONDARY DEVICE                  30240000
*                                   ENTRY ADDRESS                       30300000
         TM    TOTFLG04,TOTSCCTF  SECONDARY ENTRY ASSIGNED?    @YM08057 30306000
         BZ    CHKTDEND           NO - CONTINUE                @YM08057 30312000
         BAL   14,TERMLUS         IF LU TERM SESSION           @Y17XAUU 30320000
*        IF SECONDARY TD IS NOT ASSIGNED RETURN IS 8(REG14)    @Y17XAUU 30340000
         BAL   R14,RVTNAT         RVT/NAT PROCESSING           @Y17XAUU 30360000
         BAL   R8,FREETNT           AND GO FREE TNT ENTRY               30400000
*                                   AND EXTENDED AREA                   30480000
CHKTDEND EQU   *                                               @YM08057 30540000
         OI    TOTFLG01,TOTCLNED  SET "CLEANUP ENDED" FLAG     @XM05671 30541010
*                                                              @XM05671 30542010
*        CHECK IF CLEANUP WAS INITIATED BY OPERATOR CONTROL.   @XM05671 30543010
*        IF SO, DECREMENT 'TESTS AFFECTED' COUNT. IF COUNT     @XM05671 30544010
*        IS ZERO, POST OPERATOR CONTROL ELEMENT TO AVTOPCOB    @XM05671 30545010
*        TO REDRIVE OPERATOR CONTROL.                          @XM05671 30546010
*                                                              @XM05671 30547010
         L     R2,TOTOPCLN        ADDR OF FIRST ELMT (IF ANY)  @XM05671 30548010
CHKOPCTL DS    0H                 START OF ELEMENT LOOP        @XM05671 30549010
         LTR   R2,R2              Q-OP CLT ELMT PRESENT        @XM05671 30550010
         BZ    BLKCHK             N-GET OUT OF LOOP            @XM05671 30551010
         USING IEDREQD,R2         GENERAL REQUEST ELEMENT DSECT@XM05671 30552010
         SR    R8,R8              CLEAR                        @XM05671 30553010
         ICM   R8,7,REQLINK       SAVE LINK ADDR               @XM05671 30554010
         LH    R7,REQDATA+TESTCTR 'TESTS AFFECTED' COUNTER     @XM05671 30555010
         BCTR  R7,R0              DECREMENT                    @XM05671 30556010
         STH   R7,REQDATA+TESTCTR STORE BACK IN ELMT           @XM05671 30557010
         LTR   R7,R7              Q-LAST TEST AFFECTED         @XM05671 30558010
         BNZ   CHKOPEND           N-SEE IF ANY MORE ELEMENTS   @XM05671 30559010
         L     R15,TOTRESPL       ADDR OF RESIDENT P LIST      @XM05671 30560010
         L     R15,RESREMEL-RESPL(R15) CALL SUBROUTINE TO      @XM05671 30561010
         BALR  R10,R15            REMOVE THIS ELMT FROM Q      @XM05671 30562010
         MVC   REQQCBA(D3),REQRQCBA MOVE IN RETURN QCB ADDR    @XM05671 30563010
         MVC   REQPRI(D1),REQRPRI RETURN POST PRIORITY         @XM05671 30564010
         MVI   REQRPRI,TICCODE    SET TIC CHANNEL CMD CODE     @XM05671 30565010
         MVC   REQRQCBA(D3),INVTIC+D1 SET INVALID TIC ADDR     @XM05671 30566010
         XC    REQLINK(D3),REQLINK CLEAR LINK FIELD            @XM05671 30567010
         LA    R0,TOTWAWRK        ADDR OF WORK AREA FOR SUBRT  @XM05671 30568010
         LA    R1,0(R2)           ELMT ADDR, HI BYTE INDICATES @XM05671 30569010
*                                  NO WAIT TO BE PERFORMED     @XM05671 30570010
         L     R4,TOTAVTPT        ADDR TCAM AVT                @XM05671 30571010
         L     R15,RESPLRVT       ADDR OF POSTWAIT ROUTINE     @XM05671 30572010
         BALR  R14,R15            POST ELMT TO OP CTL          @XM05671 30573010
CHKOPEND DS    0H                 END OF LOOP                  @XM05671 30574010
         LR    R2,R8              SET BASE WITH LINK ADDRESS   @XM05671 30575010
         B     CHKOPCTL           GO TO TOP OF LOOP            @XM05671 30576010
         DROP  R2                                              @XM05671 30577010
*                                                              @XM05671 30578010
BLKCHK   DS    0H                                              @XM05671 30579010
         LR    R2,R6              RESTORE OLTCB ADDRESS                 30600000
         DROP  R6                                                       30650000
         USING TOTOBPTR,R2        SET UP ADDRESSIBILITY FOR OLTCB       30700000
         SR    R3,R3              CLEAR REGISTER 3                      30750000
         LH    R3,RESBKTOT        GET CORE AVAILABLE PARAMETER          30800000
         L     R7,TOTUSCOR        GET TOTAL BYTES OF CORE IN USE S22024 30900000
         SR    R6,R6              CLEAR REGISTER 6               S22024 30950000
         D     R6,K1024           GET NUMBER OF 1K BLOCKS        S22024 31000000
         LTR   R6,R6              WAS THERE A REMAINDER?         S22024 31050000
         BZ    NOADD              NO, NO UPDATE REQUIRED         S22024 31100000
         LA    R6,D1              SET R6 TO ONE                  S22024 31200000
         AR    R7,R6              ADD ONE TO TOTAL 1K BLOCKS     S22024 31250000
NOADD    EQU   *                                                 S22024 31300000
         LA    R6,D8              GET MAXIMUM OLT SIZE (DEFAULT) S22024 31350000
         CR    R7,R6              WAS MORE THAN DEFAULT USED?    S22024 31400000
         BNH   REST1              NO, RESTORE TOTAL BLOCKS USED  S22024 31500000
         AR    R3,R7              ADD USED CORE TO TOTAL BLOCKS  S22024 31550000
         B     REST2              BRANCH AROUND DEFAULT UPDATE   S22024 31600000
REST1    EQU   *                                                 S22024 31650000
         AH    R3,TOTBKASN        ADD THE CORE ASSIGNED TO ENDED OLT    31700000
REST2    EQU   *                                                 S22024 31800000
         AH    R3,OLTCBSZ         ADD THE CORE ASSIGNED TO ENDED OLTCB  31850000
         STC   R3,RESBKTOT+D1     STORE NEW CORE AVAILABLE PARAMETER    31900000
         L     R15,RESREMEL       GET QUEUE HANDLER ADDRESS AND         31950000
         BALR  R10,R15              GO REMOVE ELEMENT FROM QUEUE        32000000
QPULLRET EQU   *                                                        32100000
*        DELETE PAGE FREEING OF OLTCB -- NOT NEEDED IN MVS     @ZM46680 32120010
         LR    R1,R2              SET UP R1 FOR FREEMAIN                32600000
         LA    R0,L'TOTSERV+(TOTOBEND-TOTOBPTR) GET OLTCB LEN  @Y17XAUU 32700000
         FREEMAIN R,LV=(0),A=(1)     ADR IS IN R1 -- FREE OLTCB CORE    32750000
         BR    R9                 RETURN TO CALLER                      32800000
         EJECT                                                          32850000
FREETNT  EQU   *                                                        32900000
*                                                                       33000000
*         REGISTER R6 POINTS TO OLTCB                                   33050000
*         REGISTER R7 POINTS TO DEVICE ENTRY                            33100000
*         REGISTER R8 IS LINK REGISTER                                  33150000
*         REGISTER R9 IS RESERVED LINKAGE REGISTER                      33200000
*                                                                       33300000
         USING TOTOBPTR,R6                                              33350000
         USING ENT,R7                                                   33400000
*                                                                       33450000
*        FREE TOTE TERMINAL NAME TABLE ENTRY                            33500000
*                                                                       33600000
         TM    ENTFLAG1,ENTTTASN  WAS TOTE TNT ENTRY ASSIGNED?          33650000
         BZ    D0(R8)             NO, RETURN                            33700000
         L     R3,ENTTNTAD        GET TNT ENTRY ADDRESS                 33750000
         SR    R5,R5              GET TNT ENTRY                         33800000
         IC    R5,TOTTTBEL          NAME FIELD LENGTH                   33900000
         LA    R5,D0(R3,R5)       GET ADDR OF TTE ADDR FIELD            33950000
         MVC   WBWORK01+D1(TNTADRLN),D0(R5)  SAVE TOTE TTE POINTER      34000000
         MVC   D0(D2,R5),ENTTTOFF SAVE TNT ENTRY OFFSET IN              34050000
*                                   TTE ADDRESS FIELD                   34100000
         USING DUMTNTE,R3                                               34150000
         NI    DTNTFLGS,XFF-DTNTASSN  FREE TNT ENTRY                    34200000
         DROP  R3                                                       34250000
*                                                                       34300000
*        SET UP EXTENDED AREA BLOCK TO FREE IT                          34350000
*                                                                       34400000
         L     R2,WBWORK01        GET EXTENDED AREA ADDRESS             34450000
         LA    R5,IEDQTRM-IEDTRM  SET TTE PREFIX SIZE          @YM09003 34500000
         SLR   R2,R5              POINT TO START OF EXTENDED A @YM09003 34550000
         LA    R2,D0(R2)          CLEAR HIGH ORDER BYTE                 34620000
*                                   FOR COMPARE                         34680000
         USING QEL,R2                                                   34740000
         MVC   QELSIZE(D2),ENTEABLN  MOVE SIZE INTO EXTENDED AREA       34800000
*                                      BLOCK                            34860000
         LA    R5,RESEFQCB        GET QCB ADDRESS                       34920000
         ST    R5,QELQCB-D1         AND SAVE IN EXTENDED AREA           34980000
*                                   BLOCK                               35040000
         MVI   QELKEY,EXAFQKEY    SET KEY IN EXTENDED AREA BLOCK        35100000
         DROP  R2                                                       35160000
         DROP  R7                                                       35220000
*                                                                       35280000
*        FIND CORRECT LOCATION IN QUEUE TO ADD FREED BLOCK              35340000
*                                                                       35400000
*        REGISTER R2 POINTS TO EXTENDED AREA BLOCK TO BE FREED          35460000
*        REGISTER R6 POINTS TO OLTCB                                    35520000
*        REGISTER R8 IS RESERVED LINK REGISTER                          35580000
*        REGISTER R9 IS RESERVED LINK REGISTER                          35640000
*                                                                       35700000
         SR    R7,R7              SET INDICATOR FOR NO PREVIOUS         35760000
*                                   BLOCK                               35820000
         LA    R1,RESEFQCB        GET ADDRESS OF QCB                    35880000
FTNT020  EQU   *                                                        35940000
         USING TQCB,R1                                                  36000000
         L     R3,TQCBLINK-D1     GET ADDRESS OF NEXT ELEMENT           36060000
*                                   IN QUEUE                            36120000
         LA    R3,D0(R3)          CLEAR HIGH ORDER BYTE                 36180000
*                                   FOR COMPARE                         36240000
         USING QEL,R3                                                   36300000
         CLI   QELKEY,QENDKEY     IS THIS END OF QUEUE?                 36360000
         BE    FTNT030            YES, BRANCH                           36420000
         CR    R2,R3              IS THIS CORRECT LOCATION IN           36480000
*                                   QUEUE FOR INSERT?                   36540000
         BL    FTNT030            YES, BRANCH                           36600000
         LR    R7,R3              NO, SAVE ADDRESS OF ELEMENT EXAMINED  36660000
         LA    R1,QELLINK-D1      GET ADDRESS OF NEXT QUEUE ELEMENT     36720000
         B     FTNT020            BRANCH BACK AND TRY AGAIN             36780000
         DROP  R1                                                       36840000
         DROP  R3                                                       36900000
FTNT030  EQU   *                                                        36960000
*                                                                       37020000
*        MERGE NEW ELEMENT WITH PREVIOUS ELEMENT                        37080000
*             IF THEY ARE CONTIGUOUS                                    37140000
*                                                                       37200000
*        REGISTER R2 POINTS TO NEW ELEMENT                              37260000
*        REGISTER R3 POINTS TO NEXT ELEMENT                             37320000
*        REGISTER R7 POINTS TO PREVIOUS ELEMENT                         37380000
*                                                                       37440000
         LTR   R7,R7              WAS THERE A PREVIOUS ELEMENT?         37500000
         BZ    FTNT040            NO, BRANCH                            37560000
         USING QEL,R7                                                   37620000
         LR    R5,R7              GET ADDRESS OF END                    37680000
         AH    R5,QELSIZE           OF PREVIOUS ELEMENT                 37740000
         CR    R2,R5              IS NEW ELEMENT CONTIGUOUS TO          37800000
*                                   PREVIOUS ONE?                       37860000
         BNE   FTNT040            NO, BRANCH                            37920000
         LH    R5,QELSIZE         CALCULATE SIZE                        37980000
         DROP  R7                                                       38040000
         USING QEL,R2                                                   38100000
         AH    R5,QELSIZE           OF MERGED BLOCK                     38160000
         DROP  R2                                                       38220000
         USING QEL,R7                                                   38280000
         STH   R5,QELSIZE           AND STORE IN SIZE FIELD             38340000
         DROP  R7                                                       38400000
         LR    R2,R7              POINT R2 TO MERGED BLOCK              38460000
         B     FTNT050            GO CHECK IF MERGED BLOCK IS           38520000
*                                   CONTIGUOUS TO NEXT ONE              38580000
FTNT040  EQU   *                                                        38640000
*                                                                       38700000
*        REGISTER R1 POINTS TO PREVIOUS LINK FIELD                      38760000
*                                                                       38820000
         LR    R7,R3              SAVE CONTENTS OF REGISTER R3          38880000
         L     R15,RESADDAF       GET QUEUE HANDLER ADDRESS AND         38940000
         BALR  R10,R15              ADD FREED BLOCK TO QUEUE            39000000
         LR    R3,R7              RESTORE REGISTER R3                   39060000
FTNT050  EQU   *                                                        39120000
*                                                                       39180000
*        MERGE FREED BLOCK WITH NEXT ONE IF THEY ARE CONTIGUOUS         39240000
*                                                                       39300000
*        REGISTER R2 POINTS TO FREED ELEMENT                            39360000
*        REGISTER R3 POINTS TO NEXT ELEMENT                             39420000
*        REGISTER R6 POINTS TO OLTCB                                    39480000
*                                                                       39540000
         USING QEL,R3                                                   39600000
         CLI   QELKEY,QENDKEY     IS FREED ELEMENT AT END OF QUEUE?     39660000
         BE    D0(R8)             YES, RETURN                           39720000
         DROP  R3                                                       39780000
         LR    R5,R2              CALCULATE END OF                      39840000
         USING QEL,R5                                                   39900000
         AH    R2,QELSIZE           FREED BLOCK                         39960000
         CR    R2,R3              IS FREED BLOCK CONTIGUOUS TO          40020000
*                                   NEXT BLOCK?                         40080000
         BNE   D0(R8)             NO, RETURN                            40140000
         L     R15,RESREMEL       GET QUEUE HANDLER ADDRESS             40200000
         BALR  R10,R15              AND REMOVE NEXT ELEMENT             40260000
*                                   FROM QUEUE                          40320000
         LH    R7,QELSIZE         CALCULATE SIZE                        40380000
         DROP  R5                                                       40440000
         USING QEL,R3                                                   40500000
         AH    R7,QELSIZE           OF MERGED BLOCK                     40560000
         DROP  R3                                                       40620000
         USING QEL,R5                                                   40680000
         STH   R7,QELSIZE         STORE SIZE OF MERGED BLOCK            40740000
*                                   IN SIZE FIELD                       40800000
         DROP  R5                                                       40860000
         BR    R8                 RETURN TO CALLER                      40920000
         DROP  R6                                                       40980000
         EJECT                                                          41040000
*********************************************************************** 41100000
*        FUNCTION 4 - SERVICE TNT REQUEST, ASSIGN MAIN STORAGE TO     * 41160000
*                     SUBTASK, AND DISPATCH OLT                       * 41220000
*                                                                     * 41280000
*********************************************************************** 41340000
FUNCT4   EQU   *                                                        41400000
         USING TOTOBPTR,R2        SET UP ADDRESSIBILITY FOR OLTCB       41460000
         TM    TOTFLG10,TOTOLTED  IS OLT SUBTASK ENDED?                 41520000
         BO    FUNCT3             YES, GO CLEAN UP                      41580000
         TM    TOTFLG10,TOTTNTRQ  IS REQUEST FOR TNT ENTRIES?           41640000
         BZ    FUN420             NO, BYPASS TNT SERVICE ROUTINE        41700000
*                                                                       41760000
*        SERVICE TNT ENTRY REQUEST                                      41820000
*                                                                       41880000
         LR    R5,R2              SAVE REQUESTING OLTCB ADDR            41940000
         DROP  R2                                                       42000000
         USING TOTOBPTR,R5                                              42060000
         CLI   RESTNTCT,ZEROEQ    WERE ANY TNT ENTRIES ALLOCATED?       42120000
         BE    FUN4192            NO, GO TO ERROR RETURN                42180000
         LA    R6,RQTNT           GET ADDR OF FIRST REQUEST             42240000
*                                   ELEMENT ENTRY                       42300000
         USING RQTNTENT,R6                                              42360000
         TM    RQTNTTYP,RQTYPANY  IS ANY TERMINAL SPECIFIED IN          42420000
*                                   REQUEST ELEMENT ENTRY?              42480000
         BZ    FUN4192            NO, GO TO ERROR RETURN                42540000
         LA    R7,EXAMINSZ        IS SIZE OF REQUESTED EXTENDED         42600000
         CH    R7,RQTNTLNT          AREA BLOCK SUFFICIENT?              42660000
         BH    FUN4192            NO, GO TO ERROR RETURN                42720000
FUN410   EQU   *                                                        42780000
         L     R7,RESTNTPT-D1     GET ADDRESS OF FIRST TOTE             42840000
*                                   TNT ENTRY                           42900000
FUN411   EQU   *                                                        42960000
         USING DUMTNTE,R7                                               43020000
         LA    R7,D0(R7)          CLEAR HIGH ORDER BYTE FOR COMPARE     43080000
         TM    DTNTFLGS,DTNTASSN  IS ENTRY ALREADY ASSIGNED?            43140000
         BZ    FUN412             NO, BRANCH                            43200000
         C     R7,RESTTLST        IS IT THE LAST ENTRY?                 43260000
         BE    FUN4192            YES, GO TO ERROR RETURN               43320000
         L     R8,AVTRNMPT        GET TERMINAL NAME TABLE ADDR          43380000
         USING IEDQTNTD,R8                                              43440000
         SR    R9,R9              GET LENGTH OF NAME FIELD              43500000
         IC    R9,TNTENLEN          IN TERMINAL NAME TABLE ENTRY        43560000
         DROP  R8                                                       43620000
         LA    R7,TNTADRLN(R9,R7) GET ADDR OF NEXT ENTRY                43680000
         B     FUN411               AND TRY IT                          43740000
FUN412   EQU   *                                                        43800000
         ST    R7,WBWORK01        SAVE ASSIGNED TNT                     43860000
*                                   ENTRY POINTER                       43920000
*                                                                       43980000
*        REGISTER R6 CONTAINS THE ADDRESS OF THE CURRENT REQUEST        44040000
*             ELEMENT ENTRY                                             44100000
*                                                                       44160000
*                                                                       44220000
*        GET EXTENDED AREA BLOCK                                        44280000
*                                                                       44340000
         LH    R7,RQTNTLNT        GET REQUESTED EXTENDED AREA           44400000
*                                   BLOCK LENGTH                        44460000
         TM    RQTNTLNT+D1,THREEEQU  IS LENGTH INTEGRAL MULTIPLE        44520000
*                                      OF FOUR?                         44580000
         BZ    FUN4142            YES, BRANCH                           44640000
         SRL   R7,D2              NO, ROUND UP                          44700000
         LA    R7,D1(R7)            TO INTEGRAL MULTIPLE                44760000
         SLL   R7,D2                OF FOUR                             44820000
FUN4142  EQU   *                                                        44880000
         LA    R1,RESEFQCB        GET EXTENDED AREA FREE                44940000
*                                   QUEUE POINTER                       45000000
FUN4143  EQU   *                                                        45060000
         USING TQCB,R1                                                  45120000
         L     R2,TQCBLINK-D1     GET NEXT QUEUE ELEMENT                45180000
         USING QEL,R2                                                   45240000
         CLI   QELKEY,QENDKEY     WAS THERE ANOTHER ELEMENT?            45300000
         BE    FUN4192            NO, GO TO ERROR RETURN                45360000
         CH    R7,QELSIZE         IS IT LARGE ENOUGH?                   45420000
         BNH   FUN4144            YES, BRANCH                           45480000
         LA    R1,QELLINK-D1      NO, GET NEXT ELEMENT IN QUEUE         45540000
         B     FUN4143            BRANCH BACK AND EXAMINE THE NEXT      45600000
*                                   ELEMENT                             45660000
         DROP  R2                                                       45720000
FUN4144  EQU   *                                                        45780000
         USING QEL,R2                                                   45840000
         L     R15,RESREMEL       GET QUEUE HANDLER ADDRESS AND         45900000
         BALR  R10,R15              AND REMOVE ELEMENT                  45960000
*                                   FROM QUEUE                          46020000
         LA    R8,EXAMINSZ(R7)    ADD MINIMUM EXTENDED                  46080000
*                                   AREA BLOCK SIZE                     46140000
*                                   TO REQUIRED SIZE                    46200000
         LH    R9,QELSIZE         GET SIZE OF FREE BLOCK                46260000
         SR    R9,R8              IS ENOUGH OF THE BLOCK LEFT TO        46320000
*                                   FORM ANOTHER FREE BLOCK?            46380000
         BM    FUN4146            NO, BRANCH                            46440000
*                                 YES, CONTINUE                         46500000
         LR    R8,R2              SAVE ADDRESS OF ELEMENT               46560000
         AR    R2,R7              GET ADDRESS OF NEW ELEMENT            46620000
         LA    R9,EXAMINSZ(R9)    GET SIZE OF NEW ELEMENT               46680000
         STH   R9,QELSIZE         SAVE SIZE OF NEW ELEMENT              46740000
         LA    R9,RESEFQCB        PUT QCB ADDRESS                       46800000
         ST    R9,QELQCB-D1         IN NEW ELEMENT                      46860000
         MVI   QELKEY,EXAFQKEY    SAVE KEY IN NEW ELEMENT               46920000
         L     R15,RESADDAF       GET QUEUE HANDLER ADDRESS AND         46980000
         BALR  R10,R15              ADD ELEMENT TO QUEUE                47040000
         LR    R2,R8              RESTORE ASSIGNED ELEMENT ADDR         47100000
         B     FUN4158            BRANCH                                47160000
FUN4146  EQU   *                                                        47220000
         LH    R7,QELSIZE         GET ASSIGNED BLOCK SIZE               47280000
FUN4158  EQU   *                                                        47340000
         LR    R0,R7              PUT BLOCK SIZE IN REGISTER R0         47400000
         BAL   R10,BLKCLEAR         AND GO CLEAR IT TO ZEROS            47460000
         L     R8,AVTRNMPT        GET TNT ADDR                          47520000
         USING IEDQTNTD,R8                                              47580000
         SR    R9,R9              GET ENTRY NAME                        47640000
         IC    R9,TNTENLEN          LENGTH                              47700000
         DROP  R8                                                       47760000
         L     R8,WBWORK01        GET TNT ENTRY ADDRESS                 47820000
         USING DUMTNTE,R8                                               47880000
         LA    R9,D0(R9,R8)       GET POINTER TO ADDRESS FIELD          47940000
*                                   OF ASSIGNED TNT ENTRY               48000000
         MVC   WBWORK01+D4(D2),D0(R9)  ALLIGN TNT ENTRY OFFSET          48060000
         LH    R10,WBWORK01+D4           AND LOAD INTO REGISTER 10      48120000
         ST    R2,WBWORK01        MOVE ADDR OF EXTENDED AREA            48180000
         MVC   D0(TNTADRLN,R9),WBWORK01+D1  BLOCK INTO TNT ENTRY        48240000
         LA    R7,TOTCTENT        GET ADDRESS OF C.T. PARMS    @Y17XAUU 48300000
         TM    RQTNTTYP,RQTNTCT   IS REQUEST FOR CONTROL TERMINAL?      48360000
         BO    FUN4170            YES, BRANCH                           48420000
         LA    R7,TOTAPENT        GET ADDRESS OF A.P. PARMS    @Y17XAUU 48480000
         TM    RQTNTTYP,RQTNTAP   IS REQUEST FOR ALTERNATE PRINTER?     48540000
         BO    FUN4170            YES, BRANCH                           48600000
         TM    RQTNTTYP,RQTNTPR   IS REQUEST FOR PRIMARY TEST DEVICE?   48660000
         BZ    FUN4160            NO, THEN IT IS A REQUEST FOR          48720000
*                                   A SECONDARY ENTRY                   48780000
         LA    R7,TOTPRENT        GET ADDRESS OF PRIMARY PARMS @Y17XAUU 48840000
         OI    TOTPRFLG,TOTPRTAS  SET PRIMARY TNT ENTRY        @Y17XAUU 48900000
*                                   ASSIGNED FLAG                       48960000
         B     FUN4170            GO ASSIGN ENTRY                       49020000
FUN4160  EQU   *                                                        49080000
         LA    R7,TOTSCENT        GET ADDRESS OF SECONDARY PARM@Y17XAUU 49140000
         OI    TOTSCFLG,TOTSCTAS  SET SECONDARY TNT ENTRY      @Y17XAUU 49200000
*                                   ASSIGNED FLAG                       49260000
FUN4170  EQU   *                                                        49320000
         USING ENT,R7                                          @YM07418 49380000
         ST    R8,ENTTNTAD        SAVE ADDRESS OF TNT ENTRY             49440000
         MVC   ENTEABLN(D2),RQTNTLNT SAVE LEN OF ASSIGNED      @YM09003 49500000
*                                   EXTENDED AREA BLOCK                 49560000
         STH   R10,ENTTTOFF       SAVE TNT ENTRY OFFSET                 49620000
         OI    ENTFLAG1,ENTTTASN  SET ASSIGNED FLAG IN                  49680000
*                                   DEVICE ENTRY                        49740000
         OI    DTNTFLGS,DTNTASSN  SET ASSIGNED FLAGS IN TNT             49800000
*                                   ENTRY                               49860000
         MVI   RQQTYPE,COUNTER    SET COUNTERFEIT REQUEST      @Y17XAUU 49920000
         LR    R6,R5              SET OLTCB BASE               @Y17XAUU 49980000
         BAL   R14,RVTNAT         CHECK RVT/NAT COUNTERFEITING @Y17XAUU 50040000
         DROP  R7                                              @YM07418 50100000
         DROP  R2                                                       50160000
         TM    RQTNTFGS,RQTNTLST  IS THIS THE LAST ENTRY?               50220000
         BO    FUN4194            YES, BRANCH                           50280000
         LA    R6,RQTENLEN(R6)    GET NEXT REQUEST ELEMENT FIELD        50340000
         DROP  R6                                                       50400000
         B     FUN410             LOOP IF MORE ENTRIES                  50460000
FUN4192  EQU   *                                                        50520000
         MVI   RQTNT,RQTNTERR     SET ERROR RETURN CODE                 50580000
FUN4194  EQU   *                                                        50640000
         NI    TOTFLG10,XFF-TOTTNTRQ  CLEAR TNT REQUEST FLAG            50700000
         DROP  R5                                                       50760000
         DROP  R8                                                       50820000
         LR    R2,R5              RESTORE CURRENT ENTRY POINTER         50880000
         B     FUN480             RETURN                                50940000
*                                                                       51000000
*        ASSIGN MAIN STORAGE TO SUBTASK                                 51060000
*                                                                       51120000
FUN420   EQU   *                                                        51180000
         USING TOTOBPTR,R2        SET UP ADDRESSIBILITY FOR OLTCB       51240000
         LH    R3,RESBKTOT        GET CORE AVAILABLE PARAMETER          51300000
         AH    R3,TOTBKASN        UPDATE WITH CORE ASSIGNED PARAMETER   51360000
         STH   R3,RESBKTOT        STORE IN CORE AVAILABLE FIELD         51420000
         XC    TOTBKASN(D2),TOTBKASN  CLEAR CORE BLOCKS ASSIGNED PARM   51480000
         SH    R3,TOTBKRQD        SUBTRACT AMOUNT REQUIRED              51540000
         BM    RETURN2            BRANCH IF NOT ENOUGH CORE             51600000
         STH   R3,RESBKTOT        UPDATE CORE AVAILABLE PARM            51660000
         LH    R3,TOTBKRQD        GET NO. OF BLOCKS REQUIRED            51720000
         STH   R3,TOTBKASN        ASSIGN REQUIRED CORE TO OLT -         51780000
         SLL   R3,D10             CONVERT TO NUMBER OF BYTES            51840000
         ST    R3,TOTMMSPC        SAVE RESULT IN OLTCB                  51900000
         NI    TOTFLG10,XFF-TOTOLTWT  CLEAR OLT WAITING FOR CORE FLAG   51960000
*                                                                       52020000
*        DISPATCH OLT                                                   52080000
*                                                                       52140000
         LA    R1,TOTOLTPL        GET PARAMETERS FOR TRM ANALYSIS       52200000
         LA    R3,TOTOLTCB        GET ADDRESS OF OLTCB AND SCT   S22024 52260000
         ST    R3,TOTOLTPL        PUT SCT ADDRESS IN OLTCB       S22024 52320000
*                                                                       52380000
         TM    TOTFLG10,TOTOLTRS  IS OLT RESTART REQUESTED?             52440000
         BZ    RES052             NO, BRANCH AROUND POST                52500000
         NI    TOTFLG10,XFF-TOTOLTRS  CLEAR OLT RESTART FLAG            52560000
FUN480   EQU   *                                                        52620000
         POST  TOTOTECB           POST OLT TO INDICATE ADDITIONAL      X52680000
                                    CORE ASSIGNED                       52740000
         B     RETURN             RETURN TO CALLER                      52800000
RES052   EQU   *                                                        52860000
         LA    R2,TOTOLTCB        SET UP OLTCB ADDR FOR SUBTASK  S22024 52920000
         USING TOTOLTCB,R2        SET UP ADDRESSIBILITY FOR OLTCBS22024 52980000
         MVC   ATTLIST+D21(D3),RESETXRA+D1  MOVE EXIT ADDR TO ATTACH    53040000
*                                          PARAMETER LIST               53100000
         ATTACH SF=(E,ATTLIST)    ATTACH IEDQWB1- TRM ANALYSIS MODULE   53160000
         LTR   R15,R15                  DID ATTACH COMPLETE?   @YA10453 53220000
         BNZ   FREECORE                   NO, MOD NOT ATTACHED @YA10453 53280000
         MVC   CNAME+D5(D2),CHARB1  RESTORE ATTACH MODULE NAME          53340000
         ST    R1,TOTTCBAD        SAVE TCB ADDRESS                      53400000
         B     RETURN             RETURN TO CALLER                      53460000
         DROP  R2                                                       53520000
         EJECT                                                          53580000
*********************************************************************** 53640000
*                                                                     * 53700000
*        FUNCTION 5 - INITILIZE THE OLTCB                             * 53760000
*                                                                     * 53820000
*********************************************************************** 53880000
FUNCT5   EQU   *                                                        53940000
         LA    R0,L'TOTSERV+(TOTOBEND-TOTOBPTR) GET OLTCB LEN  @Y17XAUU 54000000
         GETMAIN R,LV=(0)            GET CORE FOR OLTCB                 54060000
         LR    R2,R1              SAVE ADDRESS OF OLTCB                 54120000
         USING TOTOBPTR,R2                                              54180000
*        DELETE PAGE FIXING OF OLTCB -- NOT NEEDED IN MVS      @ZM46680 54210010
         LA    R0,L'TOTSERV+(TOTOBEND-TOTOBPTR) GET OLTCB LEN  @Y17XAUU 55080000
         BAL   R10,BLKCLEAR       CLEAR OLTCB                           55140000
         LA    R15,RESOBQCB       PUT ADDRESS OF OLTCB QCB              55200000
         ST    R15,TOTELQCB-D1      IN OLTCB                            55260000
         MVI   TOTELKEY,OLTCBKEY  SET OLTCB ELEMENT KEY                 55320000
         ST    R4,TOTAVTPT     SAVE AVT ADDRESS                         55380000
         LH    R10,RESBKTOT       GET TOTAL CORE BLOCKS AVAILABLE       55440000
         SH    R10,OLTCBSZ        SUBTRACT OLTCB SIZE                   55500000
         STH   R10,RESBKTOT       UPDATE TOTAL BLOCKS AVAILABLE PARM    55560000
*                                                                       55620000
*        GET IDENTIFICATION FOR NEW OLT                                 55680000
*                                                                       55740000
         LA    R5,D1              INITIALIZE I.D. REGISTER              55800000
RES0762  EQU   *                                                        55860000
         L     R7,RESOBQCB        GET FIRST OLTCB QUEUE ELEMENT         55920000
RES0764  EQU   *                                                        55980000
         CVD   R5,WBWORK01        CONVERT NEW I.D. TO DECIMAL           56040000
         UNPK  TOTOLTID(D2),WBWORK01(D8)  UNPACK NEW I.D.               56100000
         OI    TOTOLTID+D1,XF0    SET SIGN OF ID TO F                   56160000
         DROP  R2                                                       56220000
         USING TOTOBPTR,R7        SET UP ADDRESSIBILITY FOR OLTCB       56280000
         CLI   TOTELKEY,QENDKEY   IS THIS THE END OF QUEUE?             56340000
         BE    RES0768            YES, BRANCH                           56400000
         CLI   TOTOLTID,D0        HAS ID BEEN ASSIGNED?                 56460000
         BE    RES0766            NO, BRANCH                            56520000
         DROP  R7                                                       56580000
         USING TOTOBPTR,R2        SET UP ADDRESSIBILITY FOR OLTCB       56640000
         CLC   TOTOLTID(D2),TOTOLTID-TOTOBPTR(R7)  ARE SUBTASK I.D.S    56700000
*                                                    EQUAL?             56760000
         BNE   RES0766            NO, BRANCH                            56820000
         LA    R5,D1(R5)          YES, GET NEXT HIGHER I.D.             56880000
         B     RES0762            GO SEE IF IT IS ALREADY ASSIGNED      56940000
RES0766  EQU   *                                                        57000000
         DROP  R2                                                       57060000
         USING TOTOBPTR,R7                                              57120000
         L     R7,TOTELLNK-D1     GET NEXT QUEUE ELEMENT                57180000
         DROP  R7                                                       57240000
         B     RES0764            SEE IF IT HAS NEW I.D.                57300000
RES0768  EQU   *                                                        57360000
         USING TOTOBPTR,R2        SET UP ADDRESSIBILITY FOR OLTCB       57420000
         L     R15,RESADDND       GET QUEUE HANDLER ADDRESS AND         57480000
         BALR  R10,R15              ADD OLTCB TO END OF QUEUE           57540000
*                                                                       57600000
         MVI   TOTBKRQD+D1,SUBTRNSZ  PUT SUBTASK TRANSIENT AREA         57660000
*                                      SIZE DEFAULT IN OLTCB            57720000
         OI    TOTFLG10,TOTOLTWT  SET OLT WAITING FOR CORE FLAG         57780000
         LA    R7,RES#TBLE        SET UP PARAMETER LIST                 57840000
         ST    R7,TOT#TBLE          FOR OLT'S                           57900000
         LA    R1,RESPL           GET ADDRESS OF TOTE RESIDENT PARMS    57960000
         ST    R1,TOTRESPL          AND STORE IN OLTCB                  58020000
         LA    R7,TOTOLTMQ        GET ADDRESS OF OLT MESSAGE QCB        58080000
         L     R9,RESTRMQ         GET FIRST TRM QUEUE ELEMENT           58140000
         USING IEDQPRF,R9                                               58200000
         LA    R8,PRFSUNIT        GET START OF UNIT                     58260000
         AH    R8,PRFSCAN           ADD DISPLACEMENT FROM               58320000
*                                   SCAN POINTER                        58380000
         OC    D0(D8,R8),UPPER    CONVERT NAME TO UPPER CASE            58440000
         MVC   TOTCTNAM(D9),D0(R8)  MOVE CONTROL TERMINAL NAME INTO     58500000
*                                     THE OLTCB                         58560000
         LA    R5,RES#TBLE        GET BRANCH TABLE ADDRESS              58620000
         ST    R5,$TABLE            AND STORE IN SCT                    58680000
         MVC   TOTSTAE(D4),RESSTAEA  MOVE STAE EXIT ROUTINE      S22024 58740000
*                                         ADDRESS INTO OLTCB     S22024 58800000
         L     R15,AVTRNMPT       GET TERMNAME TABLE ADDRESS            58860000
         USING IEDQTNTD,R15       SET UP ADDRESSIBILITY FOR TERMNAME    58920000
*                                   TABLE                               58980000
         MVC   TOTTTBEL(D1),TNTENLEN  PICK UP MAX. LENGTH OF NAME FIELD 59040000
         TM    RESAPOPN,SUCCESS   SUCCESSFUL OPEN OF DIAGMSG     S21903 59100000
*                                   DCB?                         S21903 59160000
         BNO   FUN575             NO, DON'T DAVE ADDRESS OF DCB  S21903 59220000
         LA    R8,RESAPDCB        GET DCB ADDRESS                S21903 59280000
         ST    R8,TOTAPDCB        SAVE DCB ADDRESS IN OLTCB      S21903 59340000
         DROP  R15                                                      59400000
         DROP  R9                                                       59460000
         DROP  R2                                                       59520000
FUN575   EQU   *                                                        59580000
         LA    R1,RESTRMQ         REMOVE FIRST ELEMENT                  59640000
         L     R15,RESREMFR         FROM TOTE                           59700000
         BALR  R10,R15              TRM QUEUE                           59760000
         LTR   R1,R1              WAS QUEUE EMPTY?                      59820000
         BNP   FUN59              YES, BRANCH                           59880000
         USING IEDQPRF,R2         SET UP ADDRESSABILITY FOR BUFFER      59940000
*                                   PREFIX                              60000000
         IC    R8,PRFKEY          SAVE PREFIX KEY                       60060000
         ST    R7,PRFQCBA-D1      PUT OLT MESSAGE QCB ADDRESS           60120000
*                                   IN ELEMENT                          60180000
         STC   R8,PRFKEY          RESTORE PREFIX KEY                    60240000
         L     R15,RESADDND       GET QUEUE HANDLER ADDRESS AND         60300000
         BALR  R10,R15              ADD ELEMENT TO END OF OLT           60360000
*                                   MESSAGE QUEUE                       60420000
FUN59    EQU   *                                                        60480000
         B     RETURN             RETURN TO CALLER                      60540000
         DROP  R2                                                       60600000
         EJECT                                                          60660000
*********************************************************************** 60720000
*                                                                     * 60780000
*        FUNCTION 6 - OLT ABEND CLEANUP ROUTINE                       * 60840000
*                                                                     * 60900000
*********************************************************************** 60960000
*                                                                A41582 61020000
FUNCT6   EQU   *                                                 A41582 61080000
         USING TOTOBPTR,R2                                              61140000
         L     R7,TOTCMPCD        GET ABEND CODE                        61200000
         SLL   R7,D8              ELIMINATE HIGH ORDER BYTE      A41582 61260000
         LA    R10,D6             GET COUNT FOR CONVERT          A41582 61320000
         LA    R9,ABCODE          GET ADDRESS IN MESSAGE         A41582 61380000
FUN605   EQU   *                                                 A41582 61440000
         SR    R6,R6              CLEAR WORK REGISTER            A41582 61500000
         SLDL  R6,D4              GET NEXT HEX CHARACTER         A41582 61560000
         IC    R6,CNVTBL(R6)      CONVERT TO EBCDIC              A41582 61620000
         STC   R6,D0(R9)          SAVE IN MESSAGE                A41582 61680000
         LA    R9,D1(R9)          GET MESSAGE ADDR FOR NEXT CHAR A41582 61740000
         BCT   R10,FUN605         LOOP TILL ALL CHARACTERS       A41582 61800000
*                                   CONVERTED                    A41582 61860000
         MVC   ABID(D2),TOTOLTID  MOVE OLT I.D. TO ABEND MESSAGE        61920000
         CNOP  0,4                                               A41582 61980000
ABMSG    WTO   'IED284I OLT    ABEND       ',ROUTCDE=10,DESC=7          62040000
ABID     EQU   ABMSG+20           OLT ID NUMBER                  S21903 62100000
ABCODE   EQU   ABMSG+29           OLT ABEND CODE                 S21903 62160000
         TM    TOTFLG06,TOTABEND  DID SUBTASK PREVIOUSLY ABEND?         62220000
         BO    FUN33              YES,GO CLEAN UP SUBTASK               62280000
         OI    TOTFLG06,TOTABEND+TOTOTERM  NO SET ABEND FLAG            62340000
         XC    TOTCMPCD(D4),TOTCMPCD  CLEAR SUBTASK COMPLETION          62400000
*                                       CODE IN OLTCB                   62460000
         MVC   CNAME+D5(D2),CHARE SET ATTACH MODULE NAME                62520000
*                                   TO IEDQWE                           62580000
         B     RES052             GO TO IEDQWE TO CLEAN UP              62640000
         DROP  R2                                                       62700000
         EJECT                                                          62760000
*********************************************************************** 62820000
*                                                                     * 62880000
*                  TIMER COMPLETION ROUTINE                           * 62940000
*                                                                     * 63000000
*********************************************************************** 63060000
TIMEREND EQU   *                                                        63120000
         USING TIMEREND,R15                                             63180000
         STM   R14,R12,D12(R13)   SAVE REGISTERS                        63240000
         OI    WBFLAGS,TIMEEND    SET TIMER CONPLETION FLAG             63300000
         L     R10,REGSAVE+D4     GET RESIDENT MODULE SAVE AREA         63360000
         L     R10,D24(R10)       GET ADDRESS OF RESIDENT PARAMETERS    63420000
         USING RESPL,R10                                                63480000
         POST  RESTECB1           POST WAIT COMPLETE             S22024 63540000
         DROP  R10                                                      63600000
         DROP  R15                                                      63660000
         LM    R14,R12,D12(R13)   RESTORE REGISTERS                     63720000
         BR    R14                RETURN                                63780000
         EJECT                                                          63840000
*********************************************************************** 63900000
*                                                                     * 63960000
*        CLEAR BLOCK OF MAIN STORAGE                                  * 64020000
*             REGISTER R0 CONTAINS LENGTH OF BLOCK TO CLEAR           * 64080000
*             REGISTER R2 CONTAINS BLOCK ADDRESS                      * 64140000
*                                                                     * 64200000
*********************************************************************** 64260000
BLKCLEAR EQU   *                                                        64320000
         LR    R14,R0             BACKUP COUNT REGISTER                 64370000
         LR    R15,R2             BACKUP POINTER REGISTER               64420000
         LA    R1,D256            GET LENGTH FOR EXECUTE                64470000
CLR010   EQU   *                                                        64520000
         CR    R14,R1             IS REMAINDER 256 BYTES OR LONGER?     64620000
         BH    CLR020             YES, CLEAR 256 BYTES                  64670000
         LR    R1,R14             NO, CLEAR REMAINDER                   64720000
CLR020   EQU   *                                                        64770000
         BCTR  R1,D0              DECREMENT COUNT FOR EXECUTE           64820000
         EX    R1,CLR099          CLEAR NEXT SEGMENT                    64920000
         LA    R1,D1(R1)          RESTORE COUNT                         64970000
         CR    R14,R1             IS CLEAR COMPLETED?                   65020000
         BNH   D0(R10)            YES, RETURN TO CALLER                 65070000
         SR    R14,R1             NO, UPDATE REMAINDER                  65120000
         AR    R15,R1             GET NEXT SEGMENT ADDRESS              65220000
         B     CLR010             GO CLEAR NEXT SEGMENT                 65270000
*                                                                       65320000
CLR099   XC    D0(D0,R15),D0(R15) CLEAR FOR EXECUTE INSTRUCTION         65370000
         EJECT                                                          65420000
*********************************************************************** 65520000
*                                                                     * 65570000
*   NOT ENOUGH CORE FOR ATTACH MACRO TO BRING IN ANOTHER      @YA10453* 65620000
*     MODULE OR NOT ENOUGH FIXED CORE FOR OPERATOR CONTROL    @YA10453* 65670000
*     REQUEST, THEREFORE THE TRM CANNOT BE HONORED AT THIS    @YA10453* 65720000
*     TIME.                                                   @YA10453* 65820000
*                                                                     * 65870000
*********************************************************************** 65920000
FREECORE EQU   *                                               @YA10453 65970000
         LH    R10,RESBKTOT             GET TOTAL CORE BLCKS   @YA10453 66020000
         AH    R10,OLTCBSZ              ADD OLTCB SIZE         @YA10453 66120000
         STH   R10,RESBKTOT             UPDATE TOTAL BLOCKS    @YA10453 66170000
*                                         AVAILABLE PARM       @YA10453 66220000
         L     R15,RESREMEL             GET ADDR TO REMOVE     @YA10453 66270000
*                                         ELEM. FROM QUEUE     @YA10453 66320000
         BALR  R10,R15                  TAKE OLTCB OFF QUEUE   @YA10453 66420000
         MVC   FREE1+D28(D8),CNAME      MOVE IN MODNAME THAT   @YA10453 66470000
*                                         ATTACH FAILED ON     @YA10453 66520000
         MVC   CNAME+D5(D2),CHARB1      RESTORE ATTACH MODNAME @YA10453 66570000
FREE1    WTO   'IED330I OLT MODULE          CANNOT BE LOADED',         *66620000
               ROUTCDE=10,DESC=7                               @YA10453 66720000
         B     FREECOR2                 GO FREE OLTCB CORE     @YA10453 66770000
         SPACE                                                          66820000
NOFIXCOR EQU   *                                               @YA10453 66870000
         WTO   'IED276I OLT REQUEST REJECTED, UNABLE TO GET FIXED CORE *66920000
               FOR OPERATOR CONTROL REQUEST',ROUTCDE=10,DESC=7 @YA10453 67020000
         SPACE                                                          67070000
FREECOR2 EQU   *                                                        67120000
         LR    R1,R2                    SET UP R1 FOR FREEMAIN @YA10453 67170000
         LA    R0,L'TOTSERV+(TOTOBEND-TOTOBPTR) GET OLTCB LEN  @Y17XAUU 67220000
         FREEMAIN  R,LV=(0),A=(1)       FREE OLTCB CORE        @YA10453 67320000
         LA    R15,TCAMRET              DIRECT IEDQWA TO RTN   @YA10453 67370000
         B     RETURN1                  RETURN TO IEDQWA       @YA10453 67420000
         EJECT                                                          67470000
RVTNAT   DS    0H                 ROUTINE TO COUNTERFEIT OR    @Y17XAUU 67520000
*                                 CLEAN UP RVT AND NAT ENTRIES @Y17XAUU 67620000
*                                                              @Y17XAUU 67670000
*        IF 3705 MODE, SET UP TO COUNTERFEIT RVT AND           @Y17XAUU 67720000
*        NAT ENTRIES                                           @Y17XAUU 67770000
*                                                              @Y17XAUU 67820000
         USING TOTOBPTR,R6        SET OLTCB ADDRESSABILITY     @Y17XAUU 67920000
         USING ENT,R7             SET ADDRESSABILITY           @Y17XAUU 67970000
         ST    R14,RETSAVE        SAVE RETURN ADDRESS          @Y17XAUU 68020000
         L     R1,ENTTNTRL        GET TNT ADDRESS              @Y17XAUU 68070000
         SLR   R4,R4              CLEAR REG                    @Y17XAUU 68120000
         IC    R4,TOTTTBEL        GET MAX NAME LENGTH          @Y17XAUU 68170000
         AR    R1,R4              POINT TO TTE ADDRESS         @Y17XAUU 68220000
         ICM   R1,ADRMSK,D0(R1)   GET TTE ADDRESS              @Y17XAUU 68270000
         USING IEDQTRM,R1         SET TTE ADDRESSABILITY       @Y17XAUU 68320000
         TM    TRMSTATE,TRMPREF   3705 RESOURCE                @Y17XAUU 68370000
         BZ    FUNRVTE            NO                           @Y17XAUU 68420000
         DROP  R1                                              @Y17XAUU 68470000
         LA    R0,TOTWAWRK        POINT TO QWA WORK AREA       @Y17XAUU 68520000
         LA    R1,D1              REQUEST ONE BUFFER           @Y17XAUU 68570000
         L     R4,TOTAVTPT        GET AVT ADDRESS              @Y17XAUU 68620000
         L     R15,RESABUF        ADDRESS OF BUFFER REQ RTN    @Y17XAUU 68670000
         LA    R13,REGSAVE2       SET SAVE AREA FOR ALLOCBUF   @YM07351 68720000
         BALR  R14,R15            GO REQUEST A BUFFER          @Y17XAUU 68880000
         LA    R13,REGSAVE        RESTORE MY SAVE AREA ADDR    @YM07351 68910000
         SPACE                                                          68940000
*        SET UP BUFFER TO SEND TO POST/WAIT ROUTINE IN QWA     @Y17XAUU 68990000
         USING IEDREQD,R1         SET REQ ADDRESSABILITY       @Y17XAUU 69040000
         XC    IEDREQD(REQLEN),IEDREQD CLEAR BASIC PORTION     @Y17XAUU 69090000
*                                 OF REQUEST ELEMENT           @Y17XAUU 69140000
         LA    R15,QWBSYNCH       GET SYNCH QCB ADDRESS        @YM07770 69190000
         STCM  R15,ADRMSK,REQQCBA PUT IT IN ELEMENT            @Y17XAUU 69300000
         MVI   REQPRI,PRISSOLT    SET POST PRIORITY            @Y17XAUU 69340000
         MVI   REQRPRI,PRISSOLT   SET RETURN PRIORITY          @Y17XAUU 69380000
         ST    R7,REQDATA         SAVE DEVICE ENTRY CONTROL    @Y17XAUU 69420000
*                                 AREA ADDRESS                 @Y17XAUU 69470000
         CLI   RQQTYPE,D0         CLEAN UP REQUEST             @Y17XAUU 69520000
         BNE   RES00              NO                           @Y17XAUU 69570000
         MVI   REQDATA,D0         SHOW CLEANUP REQUEST         @Y17XAUU 69620000
         B     RES05              CONTINUE                     @Y17XAUU 69720000
RES00    EQU   *                                               @Y17XAUU 69770000
         MVI   REQDATA,XFF        INDICATE COUNTERFEIT REQ     @Y17XAUU 69820000
         SPACE                                                          69870000
RES05    EQU   *                                               @Y17XAUU 69920000
*        SET UP TO PASS ELEMENT TO POST/WAIT ROUTINE IN QWA    @Y17XAUU 70020000
         LA    R0,TOTWAWRK        POINT TO QWA WORK AREA       @Y17XAUU 70070000
         LA    R4,TOTAVTPT        GET AVT ADDRESS              @Y17XAUU 70120000
*        REG 1 ALREADY POINTS TO REQUEST ELEMENT               @Y17XAUU 70170000
         ICM   R1,MSKHI,WAIT      SET WAIT FLAG                @Y17XAUU 70220000
         L     R15,RESPLRVT       ADDRESS OF POST/WAIT ROUTINE @Y17XAUU 70270000
         LA    R13,REGSAVE2       SET UP SAVE AREA ADDRESS     @Y17XAUU 70320000
         BALR  R14,R15            GO TO POST THE ELEMENT       @Y17XAUU 70380000
         LA    13,REGSAVE         RESTORE MY SAVE AREA ADDRESS @Y17XAUU 70410000
*        ON RETURN REG 1 POINT TO REQUEST ELEMENT              @Y17XAUU 70440000
         MVC   REQRPRI(D4),INVTIC  SET INVALID TIC             @Y17XAUU 70490000
         LA    R0,TOTWAWRK        POINT TO QWA WORK AREA       @Y17XAUU 70540000
         L     R4,TOTAVTPT        GET AVT ADDRESS              @Y17XAUU 70590000
         L     R15,RESFBUF        FREE BUFFER ROUTINE ADDR     @Y17XAUU 70640000
         LA    R13,REGSAVE2       SET SAVE AREA FOR FREEBUF    @YM07351 70690000
         BALR  R14,R15            FREE THE BUFFER UNIT         @Y17XAUU 70740000
         LA    R13,REGSAVE        RESTORE MY SAVE AREA ADDR    @YM07351 70770000
FUNRVTE  EQU   *                                               @Y17XAUU 70800000
         L     R14,RETSAVE        RESTORE RETURN ADDRESS       @Y17XAUU 70860000
         BR    R14                RETURN TO CALLER             @Y17XAUU 70920000
         DROP  R1                                              @Y17XAUU 70980000
         DROP  R6                                              @Y17XAUU 71040000
         DROP  R7                                              @Y17XAUU 71100000
         EJECT                                                          71100800
TERMLUS  DS    0H                 BOUNDARY ALLIGNMENT          @Y17XAUU 71101600
************************************************************** @Y17XAUU 71102400
*                                                            * @Y17XAUU 71103200
*        IF SNA LU ENTRY AND ASSIGNED, BUILD REQUEST ELEMENT * @Y17XAUU 71104000
*        AND POST TO LUS TO TERMINATE LU-LU SESSION.         * @Y17XAUU 71104800
*        INPUT - R6 = OLTCB NEG. PREFIX ADDRESS              * @Y17XAUU 71105600
*                R7 = ENTRY CONTROL AREA ADDRESS             * @Y17XAUU 71106400
*                R14 = RETURN ADDRESS                        * @Y17XAUU 71107200
*        IF ENTRY IS NOT ASSIGNED RETURN IS 8(R14)           * @Y17XAUU 71108000
*                                                            * @Y17XAUU 71108800
************************************************************** @Y17XAUU 71109600
         ST    R14,RETSAVE3       SAVE RETURN ADDRESS          @Y17XAUU 71110400
         USING TOTOBPTR,R6        SET OLTCB ADDRESSABILITY     @Y17XAUU 71111200
         USING ENT,R7             SET DEV ENTRY ADDRESSABILITY @Y17XAUU 71112000
         TM    ENTFLAG1,ENTTTASN  WAS ENTRY ASSIGNED           @Y17XAUU 71112800
         BZ    D8(R14)            NO - RETURN TO CALLER        @Y17XAUU 71113600
         SLR   R1,R1              CLEAR REG                    @Y17XAUU 71114400
         IC    R1,TOTTTBEL        GET NAME LENGTH              @Y17XAUU 71115200
         L     R8,ENTTNTAD        COUNTERFEIT TNT ADDRESS      @Y17XAUU 71116000
         ALR   R8,R1              POINT TO TTE ADDRESS         @Y17XAUU 71116800
         ICM   R8,ADRMSK,D0(R8)   GET TTE ADDRESS              @Y17XAUU 71117600
         LA    R1,TRMPRFSZ        GET TTE PREFIX SIZE          @Y17XAUU 71118400
         SLR   R8,R1              POINT TO TTE PREFIX          @Y17XAUU 71119200
         USING IEDNTRM,R8         SET TTE ADDRESSABILITY       @Y17XAUU 71120000
         TM    TRMSTATE,TRMPREF   3705 RESOURCE                @Y17XAUU 71120800
         BZ    D4(R14)            NO - RETURN TO CALLER        @YM09003 71121600
         CLI   TRMTYPE,TRMLUNT    LU ENTRY                     @Y17XAUU 71122400
         BNE   D0(R14)            NO - RETURN TO CALLER        @YM09003 71123200
         SPACE                                                          71124000
*        SET UP TO REQUEST A BUFFER                            @Y17XAUU 71124800
         LA    R0,TOTWAWRK        POINT TO QWA WORK AREA       @Y17XAUU 71125600
         LA    R1,D1              REQUEST ONE BUFFER           @Y17XAUU 71126400
         L     R4,TOTAVTPT        PASS AVT ADDRESS             @Y17XAUU 71127200
         USING IEDQAVTD,R4        SET AVT ADDRESSABILITY       @Y17XAUU 71128000
         LA    R13,REGSAVE2       SET UP SAVE AREA ADDRESS     @Y17XAUU 71128800
         L     R15,RESABUF        ADDRESS OF BUF REQ RTN       @Y17XAUU 71129600
         BALR  R14,R15            GO REQUEST A BUFFER          @Y17XAUU 71130400
         LA    R13,REGSAVE        RESTORE MY SAVE AREA ADDRESS @Y17XAUU 71131200
         SPACE                                                          71132000
*        SET UP TO BUILD TERMINATE LU-LU SESSION ELEMENT       @Y17XAUU 71132800
         USING IEDREQD,R1         SET REQ ELEM ADDRESSABILITY  @Y17XAUU 71133600
         XC    IEDREQD(REQLEN),IEDREQD CLEAR BASIC PORTION     @Y17XAUU 71134400
         MVI   REQTYPE,REQLTRM    SET REQUEST TYPE             @Y17XAUU 71135200
         MVI   REQPRI,PRILUSR     SET LUS POST PRIORITY        @Y17XAUU 71136000
         MVC   REQLTNT(D2),ENTTTOFF COUNTERFEIT TTCIN          @Y17XAUU 71137000
         L     R15,AVTSAVTP       GET SAVT ADDRESS             @Y17XAUU 71138000
         USING IEDNSVTD,R15       SET SAVT ADDRESSABILITY      @Y17XAUU 71139000
         MVI   REQRPRI,PRISSOLT   SET RETURN PRIORITY          @Y17XAUU 71140000
         LA    R14,SAVTLUSQ       GET LUS QCB ADDRESS          @Y17XAUU 71140600
         DROP  R15                                             @YM08407 71141200
         STCM  R14,ADRMSK,REQQCBA PUT IN ELEMENT               @Y17XAUU 71141800
         SPACE                                                          71142400
*        SET UP TO POST ELEMENT                                @Y17XAUU 71143000
         LA    R0,TOTWAWRK        POINT TO QWA WORK AREA       @Y17XAUU 71143600
         ICM   R1,MSKHI,WAIT      SET WAIT FLAG                @Y17XAUU 71144200
         LA    R13,REGSAVE2       SET UP SAVE AREA ADDRESS     @Y17XAUU 71144800
         L     R15,RESPLRVT       ADDRESS OF POST/WAIT ROUTINE @Y17XAUU 71145400
         BALR  R14,R15            GO POST THE ELEMENT          @Y17XAUU 71146000
         LA    R13,REGSAVE        RESTORE MY SAVE AREA ADDRESS @Y17XAUU 71146600
         L     R14,RETSAVE3       RESTORE RETURN ADDRESS       @Y17XAUU 71147200
         USING IEDNSVTD,R15                                    @YM08407 71147800
         L     R15,AVTSAVTP       GET SAVT ADDRESS             @YM08407 71148400
         MVC   SCPT(D2),SAVTSCPT  SET SSCP TTCIN               @YM08407 71149000
         DROP  R15                                             @YM08407 71149600
TERMLOOP DS    0H                 BOUNDARY ALLIGNMENT          @YM08407 71150200
         SLR   R15,R15            CLEAR REG                    @YM08407 71150800
         ICM   R15,ADRMSK,TRMSIBPT SET SIB ADDRESS             @YM08407 71151400
         BZ    D0(R14)            NO SIB - RETURN TO CALLER    @YM08407 71152000
         USING IEDSIBD,R15        SET SIB ADDRESSABILITY       @YM08407 71152600
         CLC   SIBINDEX(D2),SCPT  LU-LU SESSION ENDED          @YM08407 71153200
         BE    D0(R14)            YES - RETURN TO CALLER       @YM08407 71153800
         DROP  R15                                             @YM08407 71154400
         STIMER WAIT,DINTVL=SEC05 WAIT 5 SECONDS               @YM08407 71155000
         B     TERMLOOP           CHECK AGAIN                  @YM08407 71155600
         DROP  R4                                              @Y17XAUU 71156200
         DROP  R7                                              @Y17XAUU 71156800
         DROP  R8                                              @Y17XAUU 71157400
         DROP  R6                                              @Y17XAUU 71158000
         DROP  R1                                              @Y17XAUU 71158600
         EJECT                                                          71160000
         DS    0F                                              @Y17XAUU 71210000
*        ROUTINE TO COUNTERFEIT OR CLEANUP TOTE                @Y17XAUU 71260000
*        RVT AND NAT ENTRIES                                   @Y17XAUU 71310000
*        INPUT- R1 = REQ ELEMENT                               @Y17XAUU 71360000
*               R3 = STCB ADDRESS                              @Y17XAUU 71460000
*               R7 = QCB ADDRESS                               @Y17XAUU 71510000
*               R11= DISPATCHER ADDRESS                        @Y17XAUU 71560000
*               R15= ENTRY POINT ADDRESS                       @Y17XAUU 71610000
*               R13= AVTSAVE2 ADDRESS                          @Y17XAUU 71660000
         ORG   *-8                                             @Y17XAUU 71710000
QWBSYNCH EQU   *                                               @Y17XAUU 71760000
         ORG                                                            71820000
         DC    AL1(DSPMCPL4),AL3(*-1)                          @Y17XAUU 71870000
         DROP  R11                        RELEASE              @Y17XAUU 71920000
         USING *,R12                      EST. ADDRESSABILITY  @Y17XAUU 71970000
         USING IEDQDISP,R11               EST. ADDRESSABILITY  @Y17XAUU 72020000
         USING AVTSAVE2,R13               EST. ADDRESSABILITY  @Y17XAUU 72120000
         USING IEDREQD,R10                EST. ADDRESSABILTY   @Y17XAUU 72170000
         USING ENT,R9                     EST. ADDRESSABILTY   @Y17XAUU 72220000
         LR    R12,R15            SET BASE REG                 @Y17XAUU 72260000
         LR    R10,R1             GET REQUEST ELEM ADDR        @Y17XAUU 72300000
         L     R9,REQDATA         ADDR OF DEV CONTRL INFO      @Y17XAUU 72350000
         LA    R9,AVTEZERO(R9)    CLEAR HIGH ORDER BYTE        @Y17XAUU 72400000
         LH    R1,ENTTROFF        GET REAL TTCIN               @Y17XAUU 72450000
         L     R8,AVTSAVTP        GET SEC AVT ADDR             @Y17XAUU 72500000
         LA    R8,AVTEZERO(R8)    CLEAR HIGH ORDER BYTE        @Y17XAUU 72600000
         USING IEDNSVTD,R8        EST. ADDRESSABILTY           @Y17XAUU 72650000
         L     R15,SAVTTNTX       GET ADDR OF NAT CONVERS RTN  @Y17XAUU 72700000
         BALR  R14,R15            CALL IEDIAP04                @Y17XAUU 72750000
         STCM  R15,HWRD,SUBA      SAVE NETWORK ADDR            @Y17XAUU 72800000
         STCM  R15,HWRD,ELEM      SAVE NETWORK ADDR            @Y17XAUU 72900000
*        SEPARATE NETWORK ADDRESS INTO SUBAREA AND ELEMENT     @Y17XAUU 72950000
         SLR   R5,R5              CLEAR                        @Y17XAUU 73000000
         IC    R5,SAVTSUBL        GET SUBAREA VALUE LENGTH     @Y17XAUU 73050000
         SLL   R15,AVTEZERO(R5)  SHIFT OUT SUBAREA'S ADDRESS   @Y17XAUU 73100000
        STCM  R15,HWRD,ELEM      SAVE THE RESULT               @Y17XAUU 73200000
        SLR   R15,R15            CLEAR REG                     @Y17XAUU 73250000
        ICM   R15,HWRD,ELEM      GET INTERMEDIATE RESULT       @Y17XAUU 73300000
        SRL   R15,AVTEZERO(R5)   ADJUST ELEMENT ADDRESS        @Y17XAUU 73350000
        STCM  R15,HWRD,ELEM      SAVE ELEMENT ADDRESS          @Y17XAUU 73400000
        LCR   R5,R5              NEGATE SUBAREA LENGTH         @Y17XAUU 73500000
        AL    R5,NABITLEN        GET ELEMENT BIT LENGTH        @Y17XAUU 73550000
        SLR   R15,R15            CLEAR                         @Y17XAUU 73600000
        ICM   R15,HWRD,SUBA      GET NETWORK ADDRESS           @Y17XAUU 73650000
        SRL   R15,AVTEZERO(R5)   SHIFT OUT ELEMENT ADDRESS     @Y17XAUU 73700000
        SPACE                                                           73800000
*       COUNTERFEIT RVT ENTRY                                  @Y17XAUU 73850000
        L     R6,SAVTSAT         GET SAT ADDRESS               @Y17XAUU 73900000
        USING IEDSATD,R6         EST. ADDRESSABILITY           @Y17XAUU 73950000
        BCTR  R15,R0             DECREMENT SUBAREA VALUE LEN   @Y17XAUU 74000000
        SLA   R15,MULTIPLY       GET OFFSET INTO SAT TABLE     @Y17XAUU 74100000
        ALR   R6,R15             POINT TO SAT ENTRY            @Y17XAUU 74150000
        L     R6,SATRNRVT        GET RVT ADDRESS               @Y17XAUU 74200000
        DROP  R6                 RELEASE                       @Y17XAUU 74250000
        USING IEDRVTD,R6         SET RVT ADDRESSABILITY        @Y17XAUU 74300000
         SLR   R15,R15            CLEAR                        @Y17XAUU 74400000
         ICM   R15,HWRD,ELEM      GET ELEMENT ADDRESS          @Y17XAUU 74450000
         ALR   R15,R15            MULTIPLY BY TWO              @Y17XAUU 74500000
         ALR   R6,R15             GET OFFSET INTO RVT          @Y17XAUU 74550000
         CLI   REQDATA,COUNTER    COUNTERFEIT REQUEST          @Y17XAUU 74600000
         BNE   QWBSYN20           NO DO NO COUNTERFEITING      @Y17XAUU 74700000
         MVC   RVTINDEX(D2),ENTTTOFF INSERT COUNTERFEIT TTCIN  @Y17XAUU 74750000
         DROP  R6                 RELEASE                      @Y17XAUU 74800000
         L     R6,SAVTNAT         GET NAT ADDRESS              @Y17XAUU 74850000
         USING IEDNATD,R6         SET NAT ADDRESSABILITY       @Y17XAUU 74900000
         SLR   R15,R15            CLEAR                        @Y17XAUU 75000000
         ICM   R15,HWRD,ENTTTOFF  GET COUNTERFEIT TTCIN        @Y17XAUU 75050000
         BCTR  R15,R0             DECREMENT                    @Y17XAUU 75100000
         ALR   R15,R15            GET OFFSET INTO RVT          @Y17XAUU 75150000
         ALR   R6,R15             POINT TO NAT ENTRY           @Y17XAUU 75200000
         MVC   NATODAF(D2),SUBA   GET NETWORK ADDRESS          @Y17XAUU 75300000
         B     SYNPOST            EXIT                         @Y17XAUU 75350000
         DROP  R6                 RELEASE                      @Y17XAUU 75400000
QWBSYN20 EQU   *                                                        75450000
         USING IEDRVTD,R6         GET RVT ADDR                 @Y17XAUU 75500000
         MVC   RVTINDEX(D2),ENTTROFF RESTORE REAL RVT ENTRY    @Y17XAUU 75600000
         DROP  R6                 RELEASE                      @Y17XAUU 75650000
SYNPOST  EQU   *                                                        75700000
         MVC   REQQCBA(D3),REQRQCBA GET RETURN QCB ADDRESS     @Y17XAUU 75750000
         MVC   REQPRI(D1),REQRPRI SET RETURN PRIORITY          @Y17XAUU 75800000
         XC    REQLINK(D3),REQLINK CLEAR LINK FIELD            @Y17XAUU 75850000
         LR    R1,R10             RESTORE ELEMENT ADDRESS      @Y17XAUU 75900000
         BAL   R14,DSPPOST        RETURN TO DISPATCHER         @Y17XAUX 75950000
         DROP  R10                RELEASE                      @Y17XAUU 76000000
         DROP  R12                RELEASE                      @Y17XAUU 76050000
         EJECT                                                          76100000
WBWORK01 DC    D'0'               WORK AREA                             76150000
SEC05    DC    X'F0F0F0F0F0F5F0F0' 5 SECOND WAIT               @YM08407 76200000
RETSAVE  DS    F                  SAVE AREA FOR RETURN ADDR    @Y17XAUU 76320000
PATCH    DC    CL100' '           MAINTENANCE AREA                      76370000
TOTEMH   DC    CL8'IEDTOTMH'      COMPARAND FOR TOTE MH        @Y17XAUU 76420000
LOADLIST DS    0H                 ID OF TOTE RESIDENT MODULES  @Y17XAUU 76470000
         DC    CL2'O'             I/O MANAGER                  @Y17XAUU 76520000
         DC    CL2'AB'            DATE ROUTINE                 @Y17XAUU 76620000
         DC    CL2'AJ'            $CUTEST ROUTINE              @Y17XAUU 76670000
         DC    CL2'35'            EXIO ROUTINE                 @Y17XAUU 76720000
         DC    CL2'AA'            TIME ROUTINE                 @Y17XAUU 76770000
         DC    CL2'39'            DPRINT ROUTINE - LOAD 1      @Y17XAUU 76820000
         DC    CL2'P1'            DPRINT ROUTINE - LOAD 2      @Y17XAUU 76920000
         DC    CL2'P2'            DPRINT ROUTINE - LOAD 3      @Y17XAUU 76970000
         DC    CL2'37'            CECOM ROUTINE                @Y17XAUU 77020000
         DC    CL2'28'            PLINK ROUTINE                @Y17XAUU 77070000
         DC    CL2'36'            WAITIO ROUTINE               @Y17XAUU 77120000
         DC    CL2'AC'            GRAB/$LETGO ROUTINE          @Y17XAUU 77220000
         DC    CL2'41'            CONVERT ROUTINE              @Y17XAUU 77270000
         DC    CL2'16'            GETCONFIG ROUTINE            @Y17XAUU 77320000
         DC    CL2'42'            MORECORE/FREECORE ROUTINE    @Y17XAUU 77370000
         DC    CL2'44'            HALT I/O ROUTINE             @Y17XAUU 77420000
         DC    CL2'47'            ROUTINE ROUTINE              @Y17XAUU 77490000
         DC    CL2'M2'            TRACE ROUTINE                @Y17XAUU 77560000
         DC    CL2'25'            SEND ROUTINE                 @Y17XAUU 77630000
         DC    CL2'33'            RECEIVE ROUTINE              @Y17XAUU 77700000
ENDLIST  DC    XL2'0'             END OF LIST INDICATOR        @Y17XAUU 77750000
MODNAME  DS    0CL8               LOAD MODULE NAME             @Y17XAUU 77800000
         DC    C'IEDQW'           MODULE PREFIX                @Y17XAUU 77850000
MODID    DC    CL3' '             MODULE ID                    @Y17XAUU 77900000
ATTLIST  ATTACH EPLOC=CNAME,SF=L  CONTROL PROGRAM PARAMETER LIST        78000000
*                                   USED IN EXECUTE FORM OF ATTACH      78050000
CNAME    DC    CL8'IEDQWB1'       MODULE NAME USED IN ATTACH MACRO      78100000
SECS10   DS    0D                                                       78150000
         DC    C'00001000'        TEN SECOND TIMER INTERVAL      A41582 78200000
RESSIZE  DC    H'45'              SIZE OF TOTE RESIDENT CODE   @Y17XAUU 78300000
*                                 IEDQWA - 2K                  @Y17XAUU 78350000
*                                 IEDQWA1 - 4K                 @Y17XAUU 78400000
*                                 IEDQWO - 3K                  @Y17XAUU 78450000
*                                 SERVICE ROUTINES - 36K       @Y17XAUU 78500000
*                                 ***TOTAL*** - 45K            @Y17XAUU 78600000
TNTEADLN DC    H'3'               LENGTH OF TNT ENTRY ADDRESS           78650000
*                                   FIELD                               78700000
REGSAVE  DS    18F                REGISTER SAVE AREA                    78730000
RETSAVE3 DS    F                  REG SAVE AREA                @Y17XAUU 78760000
REGSAVE2 DS    18F                SECOND SAVE AREA FOR IEDQWB  @YM07351 78790000
WBFLAGS  DC    XL1'00'            IEDQWB FLAG BYTE                      78840000
*                                                                       78890000
CNVTBL   DC    CL16'0123456789ABCDEF'  TRANSLATE TABLE                  78940000
ZERO     DC    XL3'0'             ZERO FIELD FOR COMPARE                78990000
OLTCBSZ  DC    H'3'               SIZE OF OLTCB IN BLOCKS      @Y17XAUU 79040000
NONAME   DC    CL8'0'             INDICATES NO NAME FOR CONCENTRATOR    79140000
UPPER    DC    CL8' '             USED TO CONVERT CONTROL TERMINAL      79190000
*                                   NAME TO UPPER CASE                  79240000
CHARB1   DC    CL2'B1'            USED IN ATTACH MACRO WHEN IEDQWB1     79290000
*                                   IS THE MODULE DESIRED               79340000
CHARE    DC    CL2'E '            USED IN ATTACH MACRO WHEN IEDQWE IS   79440000
*                                   THE MODULE DESIRED                  79490000
ELADDR   DC    F'0'                    ADDRESS OF BUFFER         X02004 79540000
FIX      EQU   X'02'                   PAGE FIX CODE             X02004 79590000
FREE     EQU   X'01'                   PAGE FREE CODE            X02004 79640000
*                                       BUFFER AND LCB           X02004 79740000
RQQTYPE  DC    X'00'              FLAG BYTE FOR COUNTERFEITING @Y17XAUU 79790000
COUNTER  EQU   X'FF'              COUNTERFEIT REQUEST          @Y17XAUU 79840000
NABITLEN DC    F'16'              NUMBER OF BITS IN NET ADDR   @Y17XAUU 79890000
INVTIC   DC    X'08000002'        INVALID TIC                  @Y17XAUU 79940000
K1024    DC    F'1024'            BYTE VALUE OF 1 K              S22024 79990000
ELEM     DS    H                  TO SAVE NETWORK ADDR(ELEMENT)@Y17XAUU 80040000
SUBA     DS    H                  TO SAVE NETWORK ADDR(SUBAREA)@Y17XAUU 80090000
SCPT     DS    H                  SSCP TTCIN SAVE AREA         @YM08407 80140000
WAIT     DC    X'80'              WAIT FOR POST COMPLETE FLAG  @Y17XAUU 80220000
         EJECT                                                          80270000
RESPL    RESPL                                                   S22024 80320000
         EJECT                                                          80370000
DUMTNTE  DSECT                                                          80420000
DTNTFLGS DS    BL1                TOTE TNT ENTRY FLAGS                  80520000
*                                                                       80570000
DTNTASSN EQU   X'80'              ENTRY ASSIGNED TO OLT                 80620000
         SPACE 5                                                        80670000
DEXT     DSECT                                                          80720000
DEXTCNT  DS    XL1                NUMBER OF TNT ENTRIES                 80820000
DEXTPTR  DS    AL3(0)             POINTER TO TOTE TTE QCB AREA          80870000
*                                                                       80920000
DEXTLFTR EQU   210                FACTOR FOR DETERMINING LENGTH@Y17XAUU 80980000
*                                   OF TOTE TTE/QCB/LGB AREA            81040000
         SPACE 5                                                        81120000
QEL      DSECT                                                          81180000
QELKEY   DS    C .           QUEUE ELEMENT KEY                          81240000
QELQCB   DS    AL3 .         ADDRESS OF QCB                             81300000
         DS    C                  UNUSED                                81360000
QELLINK  DS    AL3 .         ELEMENT LINK FIELD                         81420000
QELSIZE  DS    H .           ELEMENT SIZE                               81480000
*                                                                       81540000
QENDKEY  EQU   X'00' .       DUMMY LAST ELEMENT KEY                     81600000
*                                                                       81660000
EXAMINSZ EQU   12            MINIMUM EXTENDED AREA BLOCK SIZE           81720000
         SPACE 5                                                        81780000
TQCB     DSECT                                                          81840000
TQCBKEY  DS    C             QCB KEY FIELD                              81900000
TQCBLINK DS    AL3           QCB LINK FIELD                             81960000
         SPACE 5                                                        82020000
ENT      DSECT                                                          82080000
*                                                                       82140000
ENTUCBAD DS    AL2 .         UCB ADDRESS                                82200000
ENTTTOFF DS    H .           TNT ENTRY OFFSET (DUMMY)          @Y17XAUU 82260000
ENTTROFF DS    H .           TNT ENTRY OFFSET (REAL)           @Y17XAUU 82320000
ENTRSID  DS    H .           NETWORK ADDRESS                   @Y17XAUU 82380000
ENTRLN   DS    C .           RELATIVE LINE NUMBER                       82440000
ENTLCBAD DS    AL3 .         LINE CONTROL BLOCK ADDRESS                 82500000
ENTTNTAD DS    A .           TERMINAL NAME TABLE ENTRY ADDRESS          82560000
ENTTNTRL DS    A .                ADDRESS OF REAL TNT ENTRY             82620000
ENTEABLN DS    H .           EXTENDED AREA BLOCK LENGTH                 82680000
ENTFLAG1 DS    BL1 .         DEVICE FLAGS                               82740000
*                                                                       82800000
ENTTTASN EQU   X'80' .            TNT ENTRY ASSIGNED FLAG               82860000
ENTCONCN DS    CL8                NAME OF CONCENTRATOR ENTRY            82920000
*                                                                       82980000
         EJECT                                                          83040000
         TAVTD                                                          83100000
         EJECT                                                          83160000
         TDISPD                                                         83220000
         EJECT                                                          83280000
         TNATD                                                          83340000
         EJECT                                                          83400000
         TPRFD                                                          83460000
         EJECT                                                          83520000
         TRVTD                                                          83580000
         EJECT                                                          83640000
         TSATD                                                          83700000
         EJECT                                                          83760000
         TTNTD                                                          83820000
         EJECT                                                          83880000
         OLTCB POINTER=YES                                              83940000
         EJECT                                                          84000000
         TTRMD                                                          84060000
         EJECT                                                          84120000
         SPACE 5                                                        84180000
RQTNT    EQU   TOTWKSPC                                                 84240000
RQTNTERR EQU   X'FF'              ERROR RETURN CODE                     84300000
*                                                                       84360000
RQTNTENT DSECT                                                          84420000
*                                                                       84480000
RQTNTFGS DS    BL1           TNT REQUEST FLAGS                          84540000
*                                                                       84600000
RQTNTLST EQU   X'80' .            LAST ENTRY FLAG                       84660000
*                                                                       84720000
RQTNTTYP DS    BL1           TNT REQUEST ENTRY TYPE FIELD               84780000
*                                                                       84840000
RQTNTCT  EQU   X'80'                CONTROL TERMINAL ENTRY              84900000
RQTNTAP  EQU   X'40'                ALTERNATE PRINTER ENTRY             84960000
RQTNTPR  EQU   X'20'                PRIMARY TEST DEVICE ENTRY           85020000
RQTNTSC  EQU   X'10'                SECONDARY TEST DEVICE ENTRY         85080000
RQTYPANY EQU   RQTNTCT+RQTNTAP+RQTNTPR+RQTNTSC                          85140000
*                                                                       85200000
RQTNTLNT DS    H             TNT REQUEST BLOCK LENGTH                   85260000
*                                                                       85320000
RQTENLEN EQU   4                  LENGTH OF REQUEST                     85380000
*                                   ELEMENT ENTRY                       85440000
         SPACE 5                                                        85500000
CBSLPL   EQU   TOTWKSPC+4    PARAMETER LIST FOR TCAM POST               85560000
CBRQELE  EQU   TOTWKSPC+12   OPERATOR CONTROL REQUEST ELEMENT           85620000
CBRQKEY  EQU   CBRQELE            ELEMENT KEY                           85680000
CBRQQCBA EQU   CBRQELE+1          OPERATOR CONTROL QCB ADDRESS          85740000
CBRQPRI  EQU   CBRQELE+4          ELEMENT PRIORTY                       85800000
CBRQLINK EQU   CBRQELE+5          ELEMENT LINK FIELD                    85860000
CBRQVBCD EQU   CBRQELE+8          REQUEST VERB CODE                     85920000
CBRQELNG EQU   CBRQELE+9          ELEMENT LENGTH                        85980000
CBRQRLN  EQU   CBRQELE+10         RELATIVE LINE NUMBER                  86040000
CBRQRTCD EQU   CBRQELE+11         RETURN CODE                           86100000
CBRQECBA EQU   CBRQELE+12         ADDRESS OF ECB TO POST                86160000
*                                   SERVICE COMPLETE                    86220000
CBRQLADR EQU   CBRQELE+16         RESOURCE NAME                         86280000
         EJECT                                                          86340000
DCBDSECT DCBD  DSORG=TQ                                                 86400000
         EJECT                                                          86450000
         TLCBD                                                          86500000
         EJECT                                                 @Y17XAUU 86550000
         TMHTABD                                               @Y17XAUU 86600000
         EJECT                                                          86700000
         TDEBD                                                          86750000
         EJECT                                                          86800000
         TPRIOR                                                @Y17XAUU 86850000
         EJECT                                                          86900000
         TREQD                                                 @Y17XAUU 87000000
         EJECT                                                          87050000
         TSIBD                                                 @YM08407 87070000
         EJECT                                                          87090000
UCB      DSECT                                                          87120000
         IEFUCBOB                                                       87180000
         EJECT                                                          87240000
         END                                                            87300000
./  ADD  SSI=80800098,NAME=IEDQWB1
         TITLE 'IEDQWB1 TRM ANALYSIS BUFFER ANALYZER'                   00200022
IEDQWB1  CSECT                                                          00400022
*A000000-999999                                                @Y16X5U0 00410000
* CHANGE ACTIVITY AS FOLLOWS:                                    S22024 00450000
*A211000,249500-249800,538070-539750,730570,731820              SA41592 00500022
*A680600                                                        SA59008 00550022
*A246000,520000                                                 SA41604 00570022
*A249400,280000,681910                                          SA41614 00580022
*A004500,010200-011600,231000,281070,624000-625600,637000        S22024 00582000
*A681247,681526-681528,681707,730570,730810,731820-731900        S22024 00584000
*C016000,280100-280140,280160-280180,280200-280240               S22024 00586000
*C681495-681499,681501-681503,681505-681507,681585,681720        S22024 00588000
*C681812,696000-697600,730630,730840,731680                      S22024 00590000
*D280350-280400,474000-486000,681395,681645-681655,730120-730300 S22024 00592000
*C280260-280280,280300-280340,644000,646000,681420,681425        S22024 00594000
*C686200                                                         S05331 00597000
*A681291-681292,681387-681389                                    S05331 00598000
*A442000                                                       @XA06325 00598158
*D358000-370000,378000,440000                                  @XA06325 00598258
*C280220-280280,396000-416000,444000                           @XA06325 00598358
*C681470-681495                                                @YA07679 00598858
*A731740                                                       @YA07679 00599358
*C681478                                                       @YA10430 00599458
*A249800,338000,340000,489000,496000,624400,687200,730480      @Y17XAUU 00599500
*A731760                                                       @Y17XAUU 00599600
*D280800-280900,731740                                         @Y17XAUU 00599700
*D312000-336000,350000-352000                                  @OY20346 00599882
         SPACE                                                          00600022
****************************************************************        00800022
*                                                              *        01000022
* MODULE NAME = IEDQWB1 (TCAM,TOTE)                            @Y17XAUU 01060000
*                                                              * S22024 01080000
* DESCRIPTIVE NAME = TRM ANALYSIS BUFFER ANALYZER              * S22024 01100000
*                                                              * S22024 01120000
* COPYRIGHT = NONE                                             * S22024 01140000
*                                                              * S22024 01160000
* STATUS --                                                    *        01200022
*                                                              *        01400022
*    VERSION 10.0                                              @Y17XAUU 01600000
*                                                              *        01800022
* FUNCTIONS --                                                 *        02000022
*                                                              *        02200022
*    THE PURPOSE OF THIS MODULE IS TO OBTAIN THE TRM FROM      *        02400022
*    THE TCAM BUFFER AND RETURN THE BUFFER BACK TO TCAM.       *        02600022
*                                                              *        02800022
*    IF THE TRM WAS ENTERED FROM THE SYSTEM CONSOLE, THE       *        03000022
*    BUFFER IS POSTED TO TCAM.                                 *        03200022
*                                                              *        03400022
*    IF THE TRM WAS ENTERED FROM A REMOTE TERMINAL, THE        *        03600022
*    LCB OR BUFFER IS POSTED TO TCAM.                          @Y17XAUU 03800000
*                                                              @Y17XAUU 03800300
* PURPOSE -- SEE FUNCTION                                      @Y17XAUU 03800600
*                                                              @Y17XAUU 03800900
* LINKAGE -- ATTACHED BY IEDQWB OR XCTL'ED TO BY IEDQWC.       @Y17XAUU 03801200
*                                                              @Y17XAUU 03801500
* MACROS -- IEDHJN                                             @Y17XAUU 03801800
*           XCTL                                               @Y17XAUU 03802100
*           SAVE                                               @Y17XAUU 03802400
*           AQCTL                                              @Y17XAUU 03802700
*           WTO                                                @Y17XAUU 03803000
*           LINK                                               @Y17XAUU 03803300
*           IEDQMSG                                            @Y17XAUU 03803600
*           TCONV                                              @Y17XAUU 03803900
*           BLDL                                               @Y17XAUU 03804200
*           LOAD                                               @Y17XAUU 03804500
*           DELETE                                             @Y17XAUU 03804800
*           WTOR                                               @Y17XAUU 03805100
*           STIMER                                             @Y17XAUU 03805400
*           WAIT                                               @Y17XAUU 03805700
*           TTIMER                                             @Y17XAUU 03806000
*           POST                                               @Y17XAUU 03806300
*           ENQ                                                @Y17XAUU 03806600
*                                                              *        04000022
* ENTRY POINTS                                                 *        04200022
*                                                              *        04400022
*    IEDQWB1                                                   @Y17XAUU 04600000
*                                                              *        04800022
* INPUT --                                                     *        05000022
*                                                              *        05200022
*    REGISTERS 02,13,14,15 CONTAIN THE FOLLOWING VALUES:       *        05400022
*                                                              *        05600022
*    02 - OLTCB POINTER                                        *        05800022
*    13 - SAVE AREA ADDRESS                                    *        06000022
*    14 - RETURN ADDRESS                                       *        06200022
*    15 - ENTRY POINT ADDRESS                                  *        06400022
*                                                              *        06600022
* OUTPUT --                                                    *        06800022
*                                                              *        07000022
*    REGISTERS 0 AND 1 CONTAIN PARAMETERS FOR IEDQWC           *        07200022
*                                                              *        07400022
* EXTERNAL REFERENCES --                                       *        07600022
*                                                              *        07800022
*    NONE                                                      *        08000022
*                                                              *        08200022
* EXITS,NORMAL                                                 *        08400022
*                                                              *        08600022
*    XCTL TO IEDQWH (NUMERICAL ANALYSIS MODULE) IF TRM WAS     *        08800022
*    ENTERED FROM A NUMERIC-ONLY TERMINAL.                     *        09000022
*                                                              *        09200022
*    XCTL TO IEDQWC (TRM ANALYSIS MODULE I) NORMALLY.          *        09400022
*                                                              *        09600022
* EXITS,ERROR --                                               *        09800022
*                                                              *        10000022
*    NONE                                                      *        10200022
*                                                              *        10400022
* TABLES/WORK AREAS --                                         *        10600022
*                                                              *        10800022
*    CVT, AVT, OLTCB, LCB, SCB                                 *        11000022
*                                                              *        11200022
* ATTRIBUTES --                                                *        11400022
*                                                              *        11600022
*    ENABLED, PROBLEM PROGRAM MODE, TRANSIENT                  *        11800022
*                                                              *        12000022
* NOTES -- SEE BELOW                                           @Y17XAUU 12200000
*                                                              @Y17XAUU 12202000
*  DEPENDENCIES -- EBCDIC CHARACTER CODE                       @Y17XAUU 12204000
*                                                              @Y17XAUU 12206000
*  RESTRICTION -- NONE                                         @Y17XAUU 12208000
*                                                              @Y17XAUU 12210000
*  REGISTER CONVENTIONS - SEE REGISTER ASSIGNMENT              @Y17XAUU 12212000
*                                                              @Y17XAUU 12214000
*  PATCH LABEL -- PATCH                                        @Y17XAUU 12216000
*                                                              *        12600022
****************************************************************        12800022
         EJECT                                                          13000022
*                                                              *        13200022
*        E Q U A T E S                                         *        13400022
*                                                              *        13600022
R0       EQU   0                  REG 0                                 13800022
R1       EQU   1                  REG 1                                 14000022
R2       EQU   2                  REG 2                                 14200022
R3       EQU   3                  REG 3                                 14400022
R4       EQU   4                  REG 4                                 14600022
R5       EQU   5                  REG 5                                 14800022
R6       EQU   6                  REG 6                                 15000022
R7       EQU   7                  REG 7                                 15200022
R8       EQU   8                  REG 8                                 15400022
R9       EQU   9                  REG 9                                 15600022
R10      EQU   10                 REG 10                                15800022
R11      EQU   11                 REG 11                                16000022
R12      EQU   12                 REG 12                                16200022
R13      EQU   13                 REG 13                                16400022
R14      EQU   14                 REG 14                                16600022
R15      EQU   15                 REG 15                                16800022
         SPACE                                                          17000022
D0       EQU   0                  DISP OF 0                             17200022
D1       EQU   1                  DISP OF 1                             17400022
D2       EQU   2                  DISP OF 2                             17600022
D3       EQU   3                  DISP OF 3                             17800022
D4       EQU   4                  DISP OF 4                             18000022
D5       EQU   5                  DISP OF 5                             18200022
D6       EQU   6                  DISP OF 6                             18400022
D7       EQU   7                  DISP OF 7                             18600022
D8       EQU   8                  DISP OF 8                             18800022
D9       EQU   9                  DISP OF 9                             19000022
D10      EQU   10                 DISP OF 10                            19200022
D11      EQU   11                 DISP OF 11                            19400022
D12      EQU   12                 DISP OF 12                            19600022
D13      EQU   13                 DISP OF 13                            19800022
D14      EQU   14                 DISP OF 14                            20000022
D15      EQU   15                 DISP OF 15                            20200022
D16      EQU   16                 DISP OF 16                            20400022
D17      EQU   17                 DISP OF 17                            20600022
D18      EQU   18                 DISP OF 18                            20800022
D19      EQU   19                 DISP OF 19                            21000022
D20      EQU   20                 DISP OF 20                            21200022
D24      EQU   24                 DISP OF 24                            21400022
D28      EQU   28                 DISP OF 28                            21600022
D32      EQU   32                 DISP OF 32                            21800022
D36      EQU   36                 DISP OF 36                            22000022
D40      EQU   40                 DISP OF 40                            22200022
D80      EQU   80                 DISP OF 80                            22400022
         SPACE                                                          22600022
XF0      EQU   X'F0'              LCB MASK FOR ANR LOCAL                22800022
ANR      EQU   X'1E'              REQ TERMINAL EQU ANR LOCAL            23000022
LGBA     EQU   X'80'              LGB MAP                        S22024 23100000
BTURSP   EQU   X'18'              OLTT BTU                       S22024 23150000
MULBUF   EQU   X'14'              MULTIPLE BUFFER PREFIX         S22024 23170000
TRMCONS  EQU   X'0C'              REQ TERMINAL EQU SYSCON               23200000
TRMSCCT  EQU   X'10'              REQ TERMINAL EQU SEC. SYSCON          23400022
TRMPRI   EQU   X'E7'              LCB PRIORITY FLAG                     23600022
XBLANK   EQU   X'61'              A SLASH CHAR                          23800022
ECBCODE  EQU   0                  ECB CODE                              24000022
TRMAX    EQU   72                 MAXIMUM TRM LENGTH                    24200022
NUMEN    EQU   X'80'              NUMERIC TRM ENTRY                     24400022
TPOSTE   EQU   X'80'              END OF LIST FLAG                      24600022
TPOSTA   EQU   X'0C'              FIRST ELEMENT FLAG            SA41604 24700022
POSTLCB  EQU   X'0C'              POST LCB FLAG                         24800022
CAP      EQU   X'40'              FACTOR FOR CAPITALIZATION             24820022
YES      EQU   X'E8'              CHAR 'Y'                              24840022
PARMREG0 EQU   0                  PARAMETER REG 0                       24860022
PARMREG1 EQU   1                  PARAMETER REG 1                       24880022
RESDP    EQU   X'20'              DEVICE PROTECTED                      24900022
CDSLEN   EQU   255                CDS BUFFER LENGTH                     24920022
D64      EQU   64                 DISP /F 64                            24940022
XFF      EQU   X'FF'              MASK SETTING                  SA41614 24950022
TRMTERM  EQU   X'10'              PRFKEY SETTING FROM OPERATOR  SA41592 24960022
*                                   CONTROL TERMINAL            SA41592 24980022
LUTYPE   EQU   X'1C'              SOURCE IS AN LU              @Y17XAUU 24985000
         EJECT                                                          25000022
         USING IEDQWB1,R15                                              25200022
IEDQWB1  IEDHJN STARB1,HJN                                              25400022
         DROP  R15                                                      25600022
         SPACE                                                          25800022
         SAVE  (14,12)            SAVE CALLER'S REGISTERS               26000022
         SPACE                                                          26200022
         LR    R6,R15             SET BASE REG                          26400022
         USING IEDQWB1,R6                                               26600022
         USING TOTOLTCB,R2                                              26800022
         SPACE                                                          27000022
         LA    R3,TOTSAVE4        GET MY SAVE AREA ADDR                 27200022
         ST    R3,D8(R13)         STORE IN CALLER'S SAVE AREA           27400022
         ST    R13,D4(R3)         SAVE CALLER'S SAVE ADDR               27600022
         ST    R13,TOTRESSV       SAVE MOTHER TASK SAVE AREA ADDR       27800022
         LR    R13,R3             SET REG 13 TO SAVE AREA               28000022
         SPACE                                                          28001022
         TM    TOTFLG04,TOTNUMDV  NUMERIC ENTRY                 SA41614 28002022
         BO    NUMERIC            YES                           SA41614 28003022
         SPACE                                                          28005022
**************************************************************** S22024 28010000
*                                                              * S22024 28012000
*        SECOND PASS CHECK. EXIT IS TO 'DEVPRT'.               * S22024 28014000
*                                                              * S22024 28016000
**************************************************************** S22024 28018000
         SPACE                                                          28020000
         TM    TOTFLG01,TOTPRMPT+TOTCONFG PROMPT OR CONFIG REQ @XA06325 28022058
         BNZ   DEVPRT                   BRANCH IF YES          @XA06325 28026058
         TM    TOTFLG02,TOTOLTRQ  ON-LINE TEST REQUEST           S22024 28030000
         BO    DEVPRT             YES- CHECK FOR DEVICE PROTECT  S22024 28032000
*                                 ELSE ASSUME ENTRY IS FROM QWB  S22024 28034000
         SPACE                                                          28045022
*********************************************************************** 28050022
*                                                                     * 28055022
*        INITIALIZATION OF THE OLTCB                                  * 28060022
*                                                                     * 28065022
*********************************************************************** 28070022
         SPACE 1                                                        28075022
         LA    R5,TOTINBUF        GET TOTE INPUT BUFFER ADDRESS         28095022
         ST    R5,TOTINADR-D1       AND STORE IN WTOR PARM LIST         28100022
         MVI   TOTINCNT,D80       SET TOTE INPUT COUNT TO 80            28105022
         MVI   $DRIVER,$TOTE           SET TOTE ID               S22024 28107000
         LA    R5,TOTOTECB        GET TOTE SUBTASK ECB ADDRESS          28110022
         ST    R5,TOTINECB          AND STORE IN WTOR PARM LIST         28115022
         ST    R5,TOTECBPT        SAVE ECB ADDRESS                      28120022
         MVI   TOTECBPT,D80       SET HI ORDER FLAG                     28125022
         OI    TOTFLG06,TOTNPERR  SET NO PERMANENT ERROR FLAG           28130022
         OI    TOTFLG08,D3        SET DRPINT DEFAULT LEVEL              28135022
         LA    R5,TOTPASS         GET ADDRESS OF PASSON DATA BUFFER     28140022
         ST    R5,$PASS           PUT IT IN OLT SCT                     28145022
         XC    D0(D64,R5),D0(R5)  CLEAR PASSON DATA BUFFER              28150022
         LA    R5,TOTEXT          GET ADDRESS OF EXTERNAL DATA BUFFER   28155022
         ST    R5,$EXT            PUT IT IN OLT SCT                     28160022
         ST    R2,TOTOLTPL        STORE OLTCB ADDRESS                   28165022
         LA    R5,TOTPLNKQ        GET ADDRESS OF PLINK MODULE QUEUE     28170022
         ST    R5,TOTPLFWD        PUT IT IN FORWARD POINTER             28175022
         ST    R5,TOTPLBKW        PUT IT IN BACKWARD POINTER            28180022
         SPACE 2                                                        28185022
         SPACE 2                                                        28200022
****************************************************************        28400022
*                                                              *        28600022
*        ROUTINE TO GET AND FIND SHADE OF TRM                  *        28800022
*                                                              *        29000022
****************************************************************        29200022
         SPACE                                                          29400022
         L     R12,TOTAVTPT       AVT ADDR                              29600022
         USING IEDQAVTD,R12                                             29800022
         MVI   TOTOTECB,ECBCODE   CLEAR ECB CODE                        30000022
         L     R11,TOTOLTMQ       GET ADDRESS OF TCAM BUFFER            30200022
         SPACE                                                          30400022
         LR    R5,R11             SAVE ADDR OF HEADER BUFFER            30600022
         USING IEDQPRF,R5                                               30800022
         ST    R5,WORK5           SAVE HEADER ADDRESS                   31000022
RES0715  EQU   *                                                        33800022
         MVC   TOTSRLCB(D4),PRFLCB-D1 SAVE SOURCE LCB ADDRESS  @Y17XAUU 33820000
         MVC   TOTSROFF(D2),PRFSRCE SAVE INDEX TO TERMNAME TAB @Y17XAUU 33840000
         MVC   TRMSRCE(D2),PRFSRCE SAVE INDEX TO TERMNAME TABLE         34000022
         CLI   PRFKEY,TRMCONS     REQ TERMINAL EQU SYSCON      @Y17XAUU 34020000
         BE    RES0717            YES                          @Y17XAUU 34040000
         SPACE                                                          35400022
RES0717  EQU   *                                                        35600022
         MVC   TRMKEY(D1),PRFKEY  SAVE REQUEST TERMINAL FLAG            37200022
         LH    R1,AVTKEYLE        GET UNIT LENGTH                       37400022
         SR    R15,R15            INITIALIZE REG                        37600022
         LR    R10,R5             SAVE BUFFER ADDR                      38000022
         LA    R3,TOTTRMBF        POINT TO TRM BUFFER                   38200022
         LA    R14,PRFSUNIT       GET START OF 1ST UNIT THIS BUFFER     38400022
         SH    R1,PRFSCAN         SUBTRACT RESERVE CHAR                 38600022
         AH    R14,PRFSCAN        BUMP R14 PAST RESERVE CHAR            38800000
         IC    R15,PRFNBUNT       GET NUMBER OF UNITS                   39000022
         SPACE                                                          39200022
RES080   EQU   *                                                        39400022
         LH    R9,PRFSIZE         GET DATA SIZE FROM BUFFER    @XA06325 39600058
         SH    R9,PRFSCAN         GET LENGTH OF TRM DATA       @XA06325 39700058
         LA    R8,TRMAX           SET MAXIMUM TRM BUFFER SIZE  @XA06325 39800058
         CR    R8,R9              WAS MORE THAN MAX ENTERED?   @XA06325 39900058
         BNL   RES082A            NO, BRANCH                   @XA06325 40000058
         LR    R9,R8              TRUNCATE TRM TO MAX SIZE     @XA06325 40100058
RES082A  EQU   *                                               @XA06325 40200058
         CR    R1,R9              IS ALL TRM DATA IN THIS UNIT @XA06325 40300058
         BL    RES082             NO, BRANCH                   @XA06325 40400058
         BCTR  R9,R0              DECREMENT COUNT FOR EXECUTE  @XA06325 40500058
         EX    R9,TRMMOVE         MOVE DATA                    @XA06325 40600058
         B     RES089             EXIT                         @XA06325 40700058
         SPACE                                                          41800022
RES082   EQU   *                                                        42000022
         BCTR  R1,R0              DECREMENT COUNT FOR EXECUTE           42200022
         EX    R1,TRMMOVE         MOVE BUFFER UNIT                      42400022
         LA    R3,D1(R1,R3)       POINT TO NEW BUFFER LOCATION          42600022
         BCT   R15,RES088         ANY MORE UNITS IN THIS BUFFER         42800022
         B     RES089             NO - EXIT                             43000022
         SPACE                                                          43200022
RES088   EQU   *                                                        43400022
         L     R14,PRFTIC         GET ADDRESS OF NEXT UNIT              43600022
         LR    R5,R14             SAVE IT                               43800022
         SR    R9,R1              DETERMINE NUMBER OF DATA     @XA06325 44000058
*                                   BYTES LEFT TO BE MOVED     @XA06325 44070058
         LH    R1,AVTKEYLE        GET UNIT LENGTH              @XA06325 44140058
         CR    R1,R9              IS REMAINDER OF TRM IN THIS  @XA06325 44210058
*                                   UNIT?                      @XA06325 44280058
         BL    RES082             NO, MOVE ENTIRE UNIT         @XA06325 44350058
         LR    R1,R9              YES, MOVE DATA THAT REMAINS  @XA06325 44420058
         B     RES082A            BRANCH TO MOVE DATA          @XA06325 44490058
         SPACE                                                          44600022
RES089   EQU   *                                                        44800022
         CLC   TOTTRMBF(D2),NUMER NUMERIC ENTRY                         45000022
         BNE   RES089A            NO                                    45200022
         OI    NUMFLG,NUMEN       SHOW NUMERIC ENTRY                    45400022
         DROP  R5                                                       45600022
         SPACE                                                          45800022
RES089A  EQU   *                                                        46000022
         L     R10,WORK5          GET HEADER ADDR                       46200022
         USING IEDQPRF,R10                                              46400022
         SPACE                                                          46600022
*                                                              *        46800022
*        PREPARE TO POST BUFFER TO TCAM                        *        47000022
*                                                              *        47200022
         CLI   TRMKEY,BTURSP      OLTT BTU RESPONSE              S22024 47700000
         BE    RES089B1           YES - ERROR BUFFER             S22024 48200000
         CLI   TRMKEY,TRMTERM     IS REQUEST FROM A SECONDARY   SA41592 48700000
*                                   OPERATOR CONTROL TERMINAL?  SA41592 48800022
         BE    RES089B1           YES, GO FREE BUFFER           SA41592 48900022
         CLI   TRMKEY,LUTYPE      SOURCE IS AN LU              @Y17XAUU 48930000
         BE    RES089B1           YES - POST BUFFER ONLY       @Y17XAUU 48960000
         CLI   TRMKEY,MULBUF      MULTIPLE BUFFERS               S22024 49000000
         BE    RES089B1           YES - POST BUFFER ONLY         S22024 49100000
         SPACE                                                          49200022
         CLI   TRMKEY,TRMCONS     TRM ENTERED FROM SYSCON      @Y17XAUU 49260000
         BNE   RES089D            NO                                    49600022
         OI    TOTFLG05,TOTSRCON  SET TRM ENTERED FROM SYSTEM  @Y17XAUU 49620000
*                                 CONSOLE FLAG                 @Y17XAUU 49640000
         SPACE                                                          49800022
*                                                              *        50000022
*        TRM ENTERED FROM SYSCON                               *        50200022
*                                                              *        50400022
RES089B  EQU   *                                                        50600022
RES089B1 EQU   *                                                SA41592 50900022
         LA    R7,AVTBFRTB        GET ADDR OF BUFFER RETURN QCB         51000022
         ST    R7,PRFKEY          PUT IT IN BUFFER BEING RETURNED       51200022
         MVI   PRFPRI,PRIBFRTB    PUT IN PRIORITY                       51400022
         ST    R10,TPOSTPAR+D4    SET UP POST                           51600022
         MVC   TPOSTPAR+D1(D3),TPOSTPAR+D5 ELEMENT                      51800022
         MVI   TPOSTPAR+D4,TPOSTE SHOW LAST BUFFER                      52000022
         MVI   TPOSTPAR,TPOSTA    SET FLAG                      SA41604 52100022
         LA    R1,TPOSTPAR        POINT TO PARAMETER LIST               52200022
*                                                                       52400022
         AQCTL                                                          52600022
         B     RESEXIT            EXIT                                  52800022
         SPACE 2                                                        53000022
RES089D  EQU   *                                                        53200022
*                                                              *        53400022
*        TRM ENTERED FROM REMOTE TERMINAL                      *        53600022
*                                                              *        53800022
         L     R7,PRFLCB-D1       GET REQ LINE LCB ADDR                 54000022
         ST    R7,REQLCB          SAVE IT                               54200022
         USING IEDQLCB,R7                                               54400022
         MVC   LCBLSPCI(D3),TOTOLTMQ+D1 PUT IN BUFFER ADDR              54600022
         MVI   LCBPRI,TRMPRI      SET PRIORITY                          54800022
         L     R8,LCBSCBA-D1      GET SCB ADDR                          55000022
         LA    R8,D0(R8)          CLEAR HIGH ORDER BYTE                 55200022
         USING IEDQSCB,R8                                               55400022
         LA    R4,AVTBFRTB        GET ADDR OF BFR RETURN QCB            55600022
         ST    R4,WORK2           SAVE IN WORK AREA                     55800022
         MVC   SCBDESTQ(D3),WORK2+D1 PUT IT IN SCB                      56000022
         L     R4,SCBMACR-D1      GET ADDR OF BFR HDR ENTRY             56200022
         LA    R4,D0(R4)          CLEAR HI ORDER BYTE                   56400022
         LA    R3,AVTINOUT        INEND/OUTEND PLIST ADDR               56800022
         ST    R3,DPARM           SAVE IT IN WORK AREA                  56850022
         MVC   SCBMACR(D3),DPARM+D1  PUT IN SCB                         56900022
         DROP  R8                                                       56950022
         L     R8,AVTMSGS-D1      GET VCON TABLE ADDR                   57000022
         LA    R8,D0(R8)          CLEAR HI ORDER BYTE                   57200022
         L     R8,D0(R8)          GET BD QCB ADDRESS                    57400022
         ST    R8,WORK2           SAVE IT                               57600022
         CLI   LCBRSKEY,ANR       REQ TERM = ANR LOCAL                  57800022
         BNE   RES089I            NO                                    58600022
         MVI   LCBTSTSW,XF0       SET LCB FLAG FOR ANR LOCAL            58800022
         SPACE                                                          59400022
RES089I  EQU   *                                                        59600022
         MVC   LCBQCBA(D3),WORK2+D1 PUT QCB ADDR FOR BD IN LCB          59700022
         ST    R7,TPOSTPAR        PUT LCB ADDR IN PLIST                 59800022
         ST    R7,TPOSTPAR+D4     PUT LCB ADDR IN PLIST                 60000022
         MVI   TPOSTPAR,POSTLCB   SET FLAG                              60200022
         MVI   TPOSTPAR+D4,TPOSTE SHOW LAST ELEMENT                     60400022
         LA    R1,TPOSTPAR        GET ADDRESS OF ELEMENT                60600022
         DROP  R7                                                       60800022
*                                                                       61000022
         AQCTL                    TPOST BUFFER TO BD                    61200022
         SPACE                                                          61400022
         L     R3,REQLCB          GET REQ LINE LCB ADDR                 61600022
         USING IEDQLCB,R3                                               61800022
         L     R9,LCBDCBPT        GET DCB ADDR                          62200022
         USING IHADCB,R9                                                62400022
         TM    DCBDSORG,LGBA      LGB VS. DCB                    S22024 62420000
         BZ    RES090             NO                             S22024 62440000
         LH    R1,TOTSROFF        GET SOURCE TTCIN             @Y17XAUU 62440500
         L     R15,AVTRNMPT       TTCIN TO TTE CONVERSION      @Y17XAUU 62441000
*                                 ROUTINE ADDRESS              @Y17XAUU 62441500
         BALR  R14,R15            GET SOURCE TTE ADDRESS       @Y17XAUU 62442000
         BAL   R14,NCPTTE         GET NCP TTE ADDRESS          @Y17XAUU 62442500
*                                                              @Y17XAUU 62443000
*        ON RETURN R1 CONTAINS ADDRESS OF NCP TTE PREFIX       @Y17XAUU 62443500
*                                                              @Y17XAUU 62444000
         USING IEDNTRM,R1         SET TTE ADDRESSABILITY       @Y17XAUU 62444500
         L     R1,TRMDESTQ-D1     GET QCB ADDRESS              @Y17XAUU 62445000
         DROP  R1                                              @Y17XAUU 62445500
         USING IEDQQCB,R1                                      @Y17XAUU 62446000
         L     R9,QCBDCBAD-D1     GET 3705 DCB ADDRESS         @Y17XAUU 62446500
         DROP  R1                                              @Y17XAUU 62447000
RES090   EQU   *                                                 S22024 62560000
         SR    R15,R15            CLEAR REG                             62800022
         IC    R15,LCBUCBX        GET RLN                               63000022
         DROP  R3                                                       63200022
         LA    R14,D1(R15)        ADJUST RLN                            63400022
         L     R8,DCBDEBAD        PICK UP DEB ADDR                      63600022
         DROP  R9                                                S22024 63700000
         SLL   R15,D2             SET DISPLACEMENT                      63800022
         L     R8,D32(R15,R8)     PICK UP UCB ADDR FOR RQ LINE          64000022
         LA    R8,D0(R8)          CLEAR HI ORDER BYTE                   64200022
         STH   R8,TOTCTUCB        SAVE RQ UCB ADDR               S22024 64400000
         STC   R14,TOTCTRLN       SAVE RLN                       S22024 64600000
         EJECT                                                          64800022
RESEXIT  EQU   *                                                        64900022
         LA    R4,TOTTRMBF        SET TO XLATE TO UPPER CASE            65000022
         LA    R7,D9              SET LOOP COUNT                        65200022
RESTRAN  EQU   *                                                        65400022
         OC    D0(D8,R4),ORFLD    XLATE 8 BYTES                         65600022
         LA    R4,D8(R4)          POINT TO NEXT FIELD                   65800022
         BCT   R7,RESTRAN         XLATE NEXT FIELD                      66000022
         SPACE 4                                                        66200022
*                                                              *        66400022
*                                                              *        66600022
*        SET UP PARAMETERS TO PASS TO IEDQWC                   *        66800022
*                                                              *        67000022
*                                                              *        67200022
         XC    PLIST(D4),PLIST    CLEAR PARAMETER FIELD                 67400022
         MVC   PLIST(D1),NUMFLG   GET FLAG BYTE                         67600022
         MVC   PLIST+D2(D2),TRMSRCE GET INDEX TO TERMNAME TABLE         67800022
         L     R1,PLIST                                                 68000022
         L     R13,D4(R13)        RESTORE CALLER'S SAVE                 68060022
         LM    R14,R0,D12(R13)    RESTORE REG                   SA59008 68090022
         XCTL  (2,12),EP=IEDQWC   GO TO IEDQWC                          68120022
         EJECT                                                          68120522
****************************************************************        68121022
*        ROUTINE TO LOAD CDS RECORDS FOR CONTROL TERMINAL AND  *        68121522
*        ALTERNATE PRINTER TO DETERMINE IF THE DEVICE PROTECT  *        68122022
*        FEATURE IS SET. IF THE OPTION IS SET THE SYSTEM       *        68122522
*        OPERATOR WILL BE REQUESTED TO GIVE AUTHORIZATION      *        68123022
*        FOR USE OF TERMINALS.                                 *        68123522
****************************************************************        68124022
DEVPRT   EQU   *                                                        68124522
         TM    $ERROPT,$ALTPRNT   AP OPTION SET                         68125022
         BZ    DEVCT              NO - CHECK CT                         68125522
         TM    TOTFLG09,TOTAPCON+TOTAPOUT AP EQU SYSTEM DEVICE          68126022
         BNZ   DEVCT              YES - CHECK CT                        68126522
         SPACE                                                          68127022
         MVC   READNAME(D8),TOTAPNAM GET AP SYMBOLIC NAME               68127522
         BAL   R5,CDSCHK          LOAD CDS                              68128022
         SPACE                                                          68128522
DEVCT    EQU   *                                                        68129022
         MVI   READNAME,CAP       BLANK OUT NAME FIELD           S05331 68129100
         MVC   READNAME+D1(D7),READNAME  IN BLDL LIST            S05331 68129200
         TM    TOTFLG09,TOTCTCON  CT EQU SYSTEM CONSOLE                 68129522
         BO    RESEND             YES - EXIT                            68130022
         LA    R4,TOTCTNAM        CT NAME                               68130522
         LA    R7,D0              INIT COUNTER                          68131022
DEVCT4   EQU   *                                                        68131522
         CLI   D0(R4),XBLANK      END OF CT NAME                        68132022
         BE    DEVCT12            YES                                   68132522
         LA    R7,D1(R7)          INCREMENT COUNTER                     68133022
         LA    R4,D1(R4)          NEXT CHAR                             68133522
         B     DEVCT4             CHECK NEXT CHAR                       68134022
DEVCT12  EQU   *                                                        68134522
         BCTR  R7,R0              DECREMENT COUNT FOR EXECUTE           68135022
         EX    R7,CTNAME          MOVE CT NAME TO BLDL PLIST            68135522
         BAL   R5,CDSCHK          LOAD CDS                              68136022
         SPACE                                                          68136522
****************************************************************        68137022
*        EXIT TO APPROPRIATE MODULE                            *        68137522
****************************************************************        68138022
RESEND   EQU   *                                                        68138522
         MVI   READNAME,CAP       BLANK OUT NAME FIELD           S05331 68138700
         MVC   READNAME+D1(D7),READNAME  IN BLDL LIST            S05331 68138900
         BAL   R5,OLTACT          SEND OLT ACTIVE MSG            S22024 68139200
         L     R13,D4(R13)        CALLER'S SAVE AREA                    68140022
         LM    R14,R0,D12(R13)    RESTORE REGS                          68140522
         TM    TOTFLG01,TOTCONFG  CONFIGURATOR REQUEST                  68141022
         BO    RESCON             YES - EXIT                            68141522
         BAL   R3,CDSENQ          ENQ CDS DATA SETS              S22024 68141700
         TM    TOTFLG01,TOTPRMPT  PROMPT REQUEST                 S22024 68142000
         BO    RESPROM            YES - EXIT                     S22024 68142500
         SPACE                                                          68143022
         XCTL  (2,12),EP=IEDQWC1  CONTINUE TRM PROCESSING               68143522
         SPACE                                                          68144022
RESCON   EQU   *                                                        68144522
         XCTL  (2,12),EP=IEDQWI   GO TO CONFIGURATOR                    68145022
         SPACE                                                          68145522
RESPROM  EQU   *                                                        68146058
         XCTL  (2,12),EP=IEDQWJ         GO TO PROMPTER                  68146158
         EJECT                                                          68146258
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *@YA07679 68146358
*                                                             *@YA07679 68146458
*              SEND ON-LINE TESTING ACTIVE MESSAGE            *@YA07679 68146558
*                                                             *@YA07679 68146658
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *@YA07679 68146758
OLTACT   EQU   *                                               @YA07679 68146858
         IEDQMSG MSGID=002,FUNCT=CEC   ISSUE THE MESSAGE       @YA07679 68149258
         MVC   TRMCTID(D2),TOTOLTID                                     68149700
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 68149900
         ST    R2,TMID+16                                               68150100
         TCONV FROM=TMID+16,TO=TMID+8,COUNT=4,TYPE=HE                   68150300
         MVC   TMID+16(4),TMID+21                                       68150500
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * 68150700
         SPACE                                                          68151022
         IEDQMSG FUNCT=CEC,OTBUF=TMID,OTCNT=TMIDE-TMID                  68151522
         SPACE                                                          68152022
         BR    R5                 RETURN                                68152522
#EXIT    L     R15,$TABLE                                               68152600
         L     R15,28(R15)                                              68152700
         BR    R15                                                      68152800
         EJECT                                                          68153022
****************************************************************        68153522
*        GET AND EVALUATE CDS RECORD FOR AP/CT.                *        68154022
*        CHECK FOR DEVICE PROTECT FEATURE.                     *        68154522
****************************************************************        68155022
CDSCHK   EQU   *                                                        68155522
         BLDL  0,BLDLLIST         BUILD DIRECTOY ENTRY POINT LIST       68156022
         SPACE                                                          68156522
         LTR   R15,R15            WAS BUILD SUCCESSFUL                  68157022
         BZ    CDSLOAD            YES                                   68157522
         CH    R15,H4             RECORD FOUND                          68158022
         BE    D0(R5)             NO - EXIT                      S22024 68158500
****************************************************************        68159022
*        ASSUME I/O ERROR                                      *        68159522
****************************************************************        68160022
         IEDQMSG MSGID=041,FUNCT=CEC,LINK=YES                           68160522
         SPACE                                                          68161022
CDSERR   EQU   *                                                        68161522
         L     R13,D4(R13)        CALLER'S SAVE AREA                    68162022
         OI    TOTFLG06,TOTOTERM  SET TERMINATE FLAG             S22024 68162500
         LM    R14,R1,D12(R13)    RESTORE REGISTERS 14-1         S22024 68163000
         XCTL  (2,12),EP=IEDQWE   TERMINATE TRM                  S22024 68163500
         SPACE                                                          68164022
         SPACE                                                          68166022
CDSLOAD  EQU   *                                                        68166522
         LOAD  DE=READNAME        LOAD THE ENTRY                        68167022
         SPACE                                                          68167522
         LR    R8,R0              ENTRY POINT ADDR                      68168022
         MVC   CDSBFR(CDSLEN),D0(R8) SAVE ENTRY                         68168522
         DELETE DE=READNAME       DELETE THE ENTRY                      68169022
         SPACE                                                          68169522
         TM    CDSBFR+D10,RESDP   DEVICE PROTECTED                      68170022
         BZ    D0(R5)             NO - RETURN                           68170522
CDSDVP   EQU   *                                                 S22024 68170700
         MVC   DEVNAM(D8),READNAME PUT NAME IN MSG                      68171022
         MVC   MSG+D16(D8),READNAME MOVE NAME TO MSG                    68171522
         WTO   'IED213D CAN ON LINE TEST USE PROTECTED DEVICE',        *68172000
               ROUTCDE=10,DESC=7                                        68172522
         SPACE                                                          68173022
         XC    ECB(D4),ECB        CLEAR ECB                             68173522
         SPACE                                                          68174022
MSG      WTOR  '          (YES OR NO)',ANSWER,3,                       *68174522
               ECB,ROUTCDE=(8,10),DESC=2                                68175022
         SPACE                                                          68175522
         STIMER REAL,NOANS,DINTVL=TIMOUT SET TIMER FOR TIMEOUT          68176022
         SPACE                                                          68176522
         WAIT  ECB=ECB            WAIT FOR REPLY                        68177022
         SPACE                                                          68177522
         TTIMER CANCEL            CANCEL TIMER                          68178022
         SPACE                                                          68178522
         OI    ANSWER,CAP         XLATE RESPONSE TO CAP                 68179022
         CLI   ANSWER,YES         ANSWER YES                            68179522
         BE    D0(R5)             YES - RETURN                          68180022
         SPACE                                                          68180522
         MVC   REJMSG+D8(REJECTE-REJECTA),REJECTA MSG TO PLIST   S22024 68181200
REJMSG   WTO   '                                                       *68181300
                               ',ROUTCDE=10,DESC=7               S22024 68181400
         SPACE                                                          68181522
         B     CDSERR             EXIT                                  68182022
         EJECT                                                          68182522
****************************************************************        68183022
*        TIMER COMPLETION ROUTINE FOR WTOR                     *        68183522
****************************************************************        68184022
NOANS    EQU   *                                                        68184522
         STM   R14,R12,D12(R13)   SAVE CALLER'S REGS                    68185022
         LR    R4,R15             SET BASE                              68185522
         USING NOANS,R4                                                 68186022
         LA    R12,TRMSAV2        GET MY SAVE AREA ADDR                 68186522
         ST    R13,D4(R12)        SAVE HIS SAVE AREA ADDR               68187022
         ST    R12,D8(R13)        SAVE MY SAVE AREA ADDR                68187522
         LR    R13,R12            SET SAVE AREA POINTER                 68188022
         SPACE                                                          68188522
         POST  ECB                POST WTOR ECB                         68189022
         L     R13,D4(R13)        GET CALLER'S SAVE AREA ADDR           68189522
         LM    R14,R12,D12(R13)   RESTORE REGS                          68190022
         BR    R14                RETURN                                68190522
         DROP  R4                                                       68191022
         SPACE                                                          68192022
NUMERIC  EQU   *                                                SA41614 68193022
         NI    TOTFLG04,XFF-TOTNUMDV CLEAR NUMERIC ENTRY FLAG   SA41614 68194022
         BAL   R5,OLTACT          SEND ACTIVE MSG               SA41614 68195022
         L     R13,D4(R13)        RESTORE SAVE REG              SA41614 68196022
         LM    R14,R0,D12(R13)    RESTORE REG 14-0              SA41614 68197022
         XCTL  (2,12),EP=IEDQWH   EXIT TO NUMERIC HANDLER       SA41614 68198022
         EJECT                                                          68200022
**************************************************************** S22024 68400000
*        ENQUEUE CDS DATA SETS SHARED                          * S22024 68420000
**************************************************************** S22024 68440000
CDSENQ   DS    0H                 BOUNDARY ALLIGNMENT            S22024 68460000
         ENQ   ,MF=(E,ENQLIST)    REQUEST USE OF RESOURCE        S22024 68480000
         LTR   R15,R15            WAS IT ASSIGNED                S22024 68500000
         BZ    CDSENQE            YES                            S22024 68520000
         CLI   D3(R15),D8         WAS IT PREVIOUSLY ASSIGNED     S22024 68540000
         BE    CDSENQE            YES                            S22024 68560000
         SPACE                                                          68580000
         IEDQMSG MSGID=109,FUNCT=CEC CDS DATA SET IN             S05331 68600000
*                                 UNSHAREABLE STATE              S05331 68620000
         LA    R13,TOTSAVE4       MY SAVE AREA ADDR              S22024 68640000
         SPACE                                                          68645000
         B     CDSERR             CLEANUP EXIT                   S22024 68650000
CDSENQE  DS    0H                 BOUNDARY ALLIGNMENT            S22024 68680000
         LM    R14,R1,D12(R13)    RESTORE CALLER REG             S22024 68700000
         BR    R3                 RETURN                         S22024 68720000
         EJECT                                                          68720600
************************************************************** @Y17XAUU 68721200
*        ROUTINE TO FIND NCP TTE ADDRESS. INPUT: REG 1 =     * @Y17XAUU 68723000
*        TERMINAL TTE ADDRESS. OUTPUT: REG 1 = NCP TTE PREFIX* @Y17XAUU 68723600
*        ADDRESS. RETURN TO CALLER VIA REG 14 .        .       @Y17XAUU 68724200
************************************************************** @Y17XAUU 68726000
NCPTTE   EQU   *                                               @Y17XAUU 68726600
         ST    R14,TRMSAVE2       SAVE RETURN ADDRESS          @Y17XAUU 68727200
         L     R14,AVTRNMPT       TTCIN TO TTE CONVERSION      @Y17XAUU 68729000
*                                 ROUTINE ADDRESS              @Y17XAUU 68729600
         LA    R8,TRMPRFSZ        GET TTE PREFIX SIZE          @Y17XAUU 68730200
         SLR   R1,R8              POINT TO TTE PREFIX          @Y17XAUU 68732000
         USING IEDNTRM,R1         SET TTE ADDRESSABILITY       @Y17XAUU 68732600
NCPLOOP  EQU   *                                               @Y17XAUU 68733200
         LH    R1,TRMCOHRT        GET COHORT POINTER           @Y17XAUU 68735000
         L     R15,AVTRNMPT       TTCIN TO TTE CONVERSION      @Y17XAUU 68735600
*                                 ROUTINE ADDRESS              @Y17XAUU 68735900
         BALR  R14,R15            FIND TTE ADDRESS             @Y17XAUU 68736200
         SLR   R1,R8              POINT TO TTE PREFIX          @Y17XAUU 68738000
         CLI   TRMTYPE,TRMLNCP    NCP ENTRY                    @Y17XAUU 68738600
         BNE   NCPLOOP            NO - CHECK NEXT ENTRY        @Y17XAUU 68740000
         L     R14,TRMSAVE2       RESTORE RETURN ADDRESS       @Y17XAUU 68743000
         BR    R14                RETURN TO CALLER             @Y17XAUU 68746000
         DROP   R1                                             @Y17XAUU 68749000
         EJECT                                                          68752000
**************************************************************** S22024 68755000
*        C O N S T A N T S                                     * S22024 68780000
**************************************************************** S22024 68800000
PLIST    DS    F                  PLACE FOR IEDQWC PARAMETERS           69000022
REQLCB   DS    F                  REQUEST LINE LCB                      69200022
*                                                                       69400022
TPOSTPAR DS    0F                 TPOST PARMLIST                 S22024 69600000
         DC    X'0C'              FIRST ELEMENT FLAG             S22024 69640000
         DC    AL3(0)             FIRST ELEMENT                  S22024 69680000
         DC    X'80'              LAST ELEMENT FLAG              S22024 69720000
         DC    AL3(0)             LAST ELEMENT                   S22024 69760000
WORK2    DS    F                  WORK AREA                             69800022
WORK5    DS    F                  WORK AREA                             70000022
*                                                                       70200022
PATCH    DC    100XL1'40'         PATCH AREA                            70400022
*                                                                       70600022
TRMSRCE  DS    H                  INDEX TO TERMNAME TABLE               70800022
TRMTST   DC    H'72'              TRM BUFFER LENGTH                     71000022
X0100    DC    X'0100'            MASK SETTING FOR SCB                  71200022
ORFLD    DC    8XL1'40'           BLANK FIELD                           71400022
NUMER    DC    2CL1'9'            NUMERIC TRM PREFIX                    71600022
*                                                                       71800022
THREE    DC    X'03'              VALUE OF 3                            72000022
NUMFLG   DC    X'00'              PROGRAM FLAG                          72200022
TRMKEY   DC    X'00'              PROGRAM FLAG                          72400022
*                                                                       72600022
ENQLIST  ENQ   (QNAME,RNAME,S,8,STEP),RET=USE,MF=L ENQ PLIST     S22024 72640000
         SPACE                                                          72680000
QNAME    DC    CL8'CDSLIB'        MAJOR NAME                     S22024 72720000
RNAME    DC    CL8'OLT2LIB'       MINOR NAME                     S22024 72760000
ENDTEST  TM    THREE,D0           TEST FOR LAST BUFFER UNIT             72800022
TRMMOVE  MVC   D0(D0,R3),D0(R14)  MOVE TRM TO BUFFER                    73000022
DPARM    DS    F                  WORK AREA                             73006022
         SPACE                                                          73036022
ECB      DC    F'0'               ECB                                   73042022
TRMSAV2  DS    18F                TIMER RTN SAVE AREA                   73048022
TRMSAVE2 DS    F                  REGISTER SAVE AREA           @Y17XAUU 73049000
H4       DC    H'4'               VALUE OF 4                            73054022
         DS    0F                  ALIGN ON FULLWORD             S22024 73057000
*                                 THE FOLLOWING MESSAGE GIVES    S22024 73060000
*                                 THE ID OF THE OLT RUNNING      S22024 73061000
TMID     DC    C'IED335I                   ***CONTROL TERMINAL ID IS' * 73062000
         DC    X'40'              BLANK CHAR                     S22024 73063000
TRMCTID  DC    CL5'XX***'         MESSAGE TO PRINT CT ID                73066022
TMIDE    DS    0C                 END OF MESSAGE                        73072022
ANSWER   DS    CL3                RESPONSE BUFFER                       73078022
REJECTA  DC    C'IED345I '        MSG ID                         S22024 73081000
*                                 THE FOLLOWING MESSAGE REJECTS  S22024 73084000
*                                 THE OLT REQUEST                S22024 73086000
REJECT   DC    C'TRM REJECTED - OLT CAN NOT USE PROTECTED DEVICE' MSG   73088000
SPACE    DC    X'40'              SPACE                                 73090022
DEVNAM   DC    8XL1'40'           DEVICE NAME                           73096022
REJECTE  DS    0C                 END OF MESSAGE                        73102022
TIMOUT   DC    X'F0F0F0F3F0F0F0F0' TIMER FOR WTOR                       73108022
*                                                                       73114022
BLDLLIST DS    0F                 BLDL PARAMETER LIST                   73120022
         DC    XL2'0001'          NUMBER OF LIST ENTRIES                73126022
         DC    XL2'003A'          LENGTH OF EACH ENTRY                  73132022
READNAME DC    8XL1'40'           TERMINAL NAME                         73138022
         DC    XL16'0'            ADDITIONAL DIRECTORY INFO             73144022
CORNEED  DC    XL3'0'             MAIN STORAGE NEEDED FOR ENTRY         73150022
         DC    XL31'0'            ADDITIONAL DIRECTORY INFO             73156022
CDSBFR   DS    CL256              CDS BUFFER                            73162022
CTNAME   MVC   READNAME(D0),TOTCTNAM MOVE CONTROL TERM NAME      S22024 73168000
ADDRESS  DC    F'0'               ADDRESS OF TERMINAL ENTRY    @YA07679 73176058
TERNMTAB DS    A                  SAVE AREA                    @Y17XAUU 73176500
         EJECT                                                          73178058
         TTRMD                                                 @YA07679 73180058
         EJECT                                                          73182000
         TLGBD                                                   S22024 73190000
         EJECT                                                          73200022
         OLTCB                                                          73400022
         EJECT                                                          73600022
         TQCBD                                                          73800022
         EJECT                                                          74000022
         TSCBD                                                          74200022
         EJECT                                                          74400022
         TLCBD                                                          74600022
         EJECT                                                          74800022
RESPL    RESPL                                                          75000022
         EJECT                                                          75200022
         TAVTD                                                          75400022
         EJECT                                                          75600022
         TPRFD                                                          75800022
         EJECT                                                          76000022
         TPRIOR                                                         76200022
         EJECT                                                          76400022
DCBDSECT DCBD  DSORG=TX                                                 76600022
         END                                                            76800022
./  ADD  SSI=72800219,NAME=IEDQWB2
         TITLE 'IEDQWB2 - TOTE DUMMY TNT PROCESSOR'                     00100000
IEDQWB2  CSECT                                                          00200000
*A000000-999999                                                @Y16X5U0 00220000
* CHANGE ACTIVITY AS FOLLOWS:                                    S22024 00250000
*A428500          MOVE 425650 AFTER 428500                     @YA10965 00250158
*A169800,192000,204000,210400,210600,216400,285400,315000      @Y17XAUU 00257100
*A348400,382000,383000,391500,411200,411500,422400,425500      @Y17XAUU 00264100
*A431400,443400,498000,504000,593000,621000,695000,726500      @Y17XAUU 00271100
*A757000,761000,763000                                         @Y17XAUU 00278100
*C182500-182600,205000,608000-611000,670000,672000,            @Y17XAUU 00285100
*C756000-757000                                                @Y17XAUU 00292100
* A002921,210770,672000                                        @G36XRUV 00293110
* C210770                                                      @G36XRUV 00294110
*                                                                       00295110
         SPACE 2                                                        00300000
         USING IEDQWB2,R15                                              00400000
IEDQWB2  IEDHJN STARB2,HJN                                              00500000
         SPACE 2                                                        00600000
****************************************************************        00700000
*                                                              *        00800000
* MODULE NAME = IEDQWB2 (TCAM,TOTE)                            @Y17XAUU 00830000
*                                                              * S22024 00840000
* DESCRIPTIVE NAME = TOTE DUMMY TNT PROCESSOR                  @Y17XAUU 00845000
*                                                              * S22024 00860000
* COPYRIGHT = NONE                                             * S22024 00870000
*                                                              * S22024 00880000
* STATUS --                                                    *        00900000
*                                                              *        01000000
*    VERSION 10.0                                              @Y17XAUU 01100000
*                                                              *        01200000
* FUNCTION --                                                  *        01300000
*                                                              *        01400000
*    THE PURPOSE OF THIS ROUTINE IS TO BUILD DUMMY TNT ENTRIES *        01500000
*    FOR REMOTE TERMINALS SERVING AS CONTROL TERMINALS OR AS   *        01600000
*    ALTERNATE PRINTERS OR AS SNA TEST LU'S.                   @Y17XAUU 01700000
*                                                              *        01800000
*    THIS ROUTINE HAS TWO ENTRY POINTS. IEDQWB2 IS THE FIRST   *        01900000
*    ENTRY POINT. DURING THE FIRST PASS THE AMOUNT OF CORE     *        02000000
*    NEEDED BY TOTE TO BUILD DUMMY ENTRIES FOR A SINGLE REMOTE *        02100000
*    STATION IS CALCULATED. AT THIS POINT CONTROL IS RETURNED  *        02200000
*    TO THE CALLING PROGRAM TO REQUEST THE CORE. (IEDQWB2      *        02300000
*    BUILDS THE REQUEST ELEMENT FOR THE CORE NEEDED IN THE     *        02400000
*    OLTCB.) THE CALLING PROGRAM THEN ISSUES A POST TO IEDQWB  *        02500000
*    FOR THE CORE.                                             *        02600000
*                                                              *        02700000
*    IF THE REQUEST TO IEDQWB IS HONORED SUCCESSFULLY, CONTROL *        02800000
*    IS RETURNED TO THIS MODULE AT THE SECOND ENTRY POINT,     *        02900000
*    IEDQWB3. DURING THE SECOND PASS THE REAL ENTRIES FOR      *        03000000
*    THE SPECIFIED REMOTE TERMINALS ARE COPIED INTO THE AREA   *        03100000
*    OBTAINED BY IEDQWB. THE INITIAL STATUS OF REMOTE TERMINAL *        03200000
*    AND LINE ARE SAVED IN THE OLTCB.                          *        03300000
*                                                              *        03400000
* ENTRY POINTS --                                              *        03500000
*                                                              *        03600000
*    IEDQWB2 - TO CALCULATE THE AMOUNT OF CORE NEEDED TO BUILD *        03700000
*    DUMMY ENTRIES FOR A SPECIFIED REMOTE TERMINAL.            *        03800000
*                                                              *        03900000
*    IEDQWB3 - TO COPY THE REAL ENTRIES INTO THE DUMMY AREA    *        04000000
*    AND TO SET THE INITIAL STATUS FLAGS FOR THE TERMINALS.    *        04100000
*                                                              *        04200000
* PURPOSE -- SEE FUNCTION                                      @Y17XAUU 04207000
*                                                              @Y17XAUU 04214000
* MODULE TYPE = PROCEDURE                                      @Y17XAUU 04221000
*                                                              @Y17XAUU 04228000
* MODULE SIZE = 4K MAXIMUM                                     @Y17XAUU 04235000
*                                                              @Y17XAUU 04242000
* PROCESSOR = ASSEMBLER XF                                     @Y17XAUU 04249000
*                                                              @Y17XAUU 04256000
* LINKAGE = LINKED TO FROM IEDQWC,IEDQWJ2,IEDQWE,IEDQWV        @Y17XAUU 04263000
*                                                              @Y17XAUU 04270000
* MACROS = IEDHJN,AQCTL,SAVE,WAIT                              @Y17XAUU 04277000
*                                                              @Y17XAUU 04284000
* INPUT --                                                     *        04300000
*                                                              *        04400000
*    REGISTERS 02,12,13,14,15 CONTAIN THE FOLLOWING VALUES:    *        04500000
*                                                              *        04600000
*    02 - OLTCB POINTER                                        *        04700000
*    12 - BASE FOR PARAMETER LIST PASSED                       *        04800000
*    13 - SAVE AREA ADDRESS                                    *        04900000
*    14 - RETURN ADDRESS                                       *        05000000
*    15 - ENTRY POINT ADDRESS                                  *        05100000
*                                                              *        05200000
* OUTPUT --                                                    *        05300000
*                                                              *        05400000
*    REGISTER 15 CONTAIN A RETURN CODE:                        *        05500000
*                                                              *        05600000
*    X'00' - OPERATION COMPLETED SUCCESSFULLY                  *        05700000
*    X'04' - ERROR IN BUILDING DUMMY ENTRIES                   *        05800000
*                                                              *        05900000
* EXTERNAL REFERENCES --                                       *        06000000
*                                                              *        06100000
*    NONE                                                      *        06200000
*                                                              *        06300000
* EXITS,NORMAL --                                              *        06400000
*                                                              *        06500000
*    BRANCH REGISTER 14 TO CALLING PROGRAM WITH A ZERO RETURN  *        06600000
*    CODE.                                                     *        06700000
*                                                              *        06800000
* EXITS,ERROR --                                               *        06900000
*                                                              *        07000000
*    BRANCH REGISTER 14 TO CALLING PROGRAM WITH A FOUR RETURN  *        07100000
*    CODE.                                                     *        07200000
*                                                              *        07300000
* TABLES/WORK AREAS --                                         *        07400000
*                                                              *        07500000
*    OLTCB,AVT,TNT,TTE,QCB,DRQ,QCBE,PARAMETER LIST             *        07600000
*    LGB                                                       @Y17XAUU 07650000
*                                                              *        07700000
* ATTRIBUTES --                                                *        07800000
*                                                              *        07900000
*    ENABLED,PROBLEM PROGRAM MODE,TRANSIENT                    *        08000000
*                                                              *        08100000
* NOTES -- SEE BELOW                                           @Y17XAUU 08200000
*                                                              @Y17XAUU 08210000
*  DEPENDENCIES = EBCDIC CHARACTER CODE                        @Y17XAUU 08220000
*                                                              @Y17XAUU 08230000
*  REGISTERS CONVENTION = SEE REGISTERS ASSIGNMENT             @Y17XAUU 08240000
*                                                              @Y17XAUU 08250000
*  RESTRICTIONS = NONE                                         @Y17XAUU 08260000
*                                                              @Y17XAUU 08270000
*  PATCH LABEL = PATCH                                         @Y17XAUU 08280000
*                                                              *        08300000
*                                                              *        08500000
****************************************************************        08600000
         EJECT                                                          08700000
*********************************************************************** 08800000
*                                                                     * 08900000
*        EQUATES                                                      * 09000000
*                                                                     * 09100000
*********************************************************************** 09200000
         SPACE 2                                                        09300000
R0       EQU   0                  REG 0                                 09400000
R1       EQU   1                  REG 1                                 09500000
R2       EQU   2                  OLTCB POINTER/SCT POINTER             09600000
R3       EQU   3                  REG 3                                 09700000
R4       EQU   4                  REG 4                                 09800000
RAVT     EQU   4                  AVT BASE                     @Y17XAUU 09850000
R5       EQU   5                  REG 5                                 09900000
R6       EQU   6                  BASE REG                              10000000
R7       EQU   7                  REG 7                                 10100000
RSAVT    EQU   7                  SAVT BASE                    @Y17XAUU 10150000
R8       EQU   8                  REG 8                                 10200000
R9       EQU   9                  REG 9                                 10300000
R10      EQU   10                 REG 10                                10400000
R11      EQU   11                 REG 11                                10500000
R12      EQU   12                 REG 12                                10600000
R13      EQU   13                 SAVE AREA POINTER                     10700000
R14      EQU   14                 RETURN ADDR                           10800000
RSIB     EQU   14                 SIB BASE                     @Y17XAUU 10850000
R15      EQU   15                 ENTRY POINT ADDR                      10900000
         SPACE 2                                                        11000000
XFF      EQU   X'FF'              MASK SETTING                          11100000
XF0      EQU   X'F0'              LCB MASK FOR ANR LOCAL                11200000
ANR      EQU   X'1E'              REQ TERM = ANR LO                     11300000
ACTVBCD  EQU   X'46'              OP CONTROL ACTIVATE CMMD              11400000
ACTRTCD  EQU   X'08'              INVITATION LIST ACTIVE RT CD          11500000
INACT    EQU   X'48'              INACTIVATE VERB CODE                  11530000
INACTRC  EQU   X'08'              TERMINAL ALREADY INACT RC             11560000
D0       EQU   0                  DISP OF 0                             11600000
D1       EQU   1                  DISP OF 1                             11700000
D2       EQU   2                  DISP OF 2                             11800000
D3       EQU   3                  DISP OF 3                             11900000
D4       EQU   4                  DISP OF 4                             12000000
D5       EQU   5                  DISP OF 5                             12100000
D6       EQU   6                  DISP OF 6                             12200000
D7       EQU   7                  DISP OF 7                             12300000
D8       EQU   8                  DISP OF 8                             12400000
D9       EQU   9                  DISP OF 9                             12500000
D10      EQU   10                 DISP OF 10                            12600000
D11      EQU   11                 DISP OF 11                            12700000
D12      EQU   12                 DISP OF 12                            12800000
D13      EQU   13                 DISP OF 13                            12900000
D14      EQU   14                 DISP OF 14                            13000000
D15      EQU   15                 DISP OF 15                            13100000
D16      EQU   16                 DISP OF 16                            13200000
D20      EQU   20                 DISP OF 20                            13300000
D22      EQU   22                 DISP OF 22                            13350000
D24      EQU   24                 DISP OF 24                            13400000
D28      EQU   28                 DISP OF 28                            13500000
D32      EQU   32                 DISP OF 32                            13600000
ACVT     EQU   16                 POINTER TO CVT ADDRESS                13700000
PRETERM  EQU   X'52'              DISP TO 1ST ENTRY IN TABLE            13800000
TRMAX    EQU   72                 TRM BUFFER LENGTH                     13900000
SLASH    EQU   X'61'              A / CHAR                              14000000
COMMA    EQU   X'6B'              A , CHAR                              14100000
D17      EQU   17                 DISP OF 17                            14200000
D18      EQU   18                 DISP OF 18                            14300000
X40      EQU   X'40'              A BLANK CHAR                          14400000
XE0      EQU   X'E0'              QCB MASK SETTING                      14500000
DEFLEV   EQU   X'03'              DPRINT DEFAULT LEVEL                  14600000
PARMREG0 EQU   0                  REG 0                                 14700000
PARMREG1 EQU   1                  REG 1                                 14800000
D72      EQU   72                 LENGTH OF TRM BUFFER                  14900000
XBLANK   EQU   X'61'              A SLASH CHAR                          15000000
TWO      EQU   2                  DISP OF TWO                           15100000
FOUR     EQU   4                  DISP OF FOUR                          15200000
TRMSCCT  EQU   X'10'              SECONDARY SYSTEM CONSOLE ENTRY ?      15300000
XFO      EQU   X'F0'              NUMERIC TESTER                        15400000
X52      EQU   X'52'              1060 CT FLAG                          15500000
X18      EQU   X'18'              DISP OF 24                            15600000
X24      EQU   X'24'              DISP OF 36                            15700000
X1C      EQU   X'1C'              DISP OF 28                            15800000
X10      EQU   X'10'              DCB OPEN FLAG                         15900000
X80      EQU   X'80'              LAST DUMMY ENTRY RQ FLAG              16000000
X14      EQU   X'14'              DISP OF 20                            16100000
X07      EQU   X'07'              LINE STOPPED FLAG                     16200000
HOLD     EQU   X'88'              'HOLD' OPERATOR CONTROL VERB CODE     16300000
RELEASE  EQU   X'87'              RELEASE VERB CODE            @Y17XAUU 16350000
UCB1060  EQU   X'52'              UCB SETTING FOR 1060 TERMINAL         16400000
ZERO     EQU   X'00'              CONSTANT VALUE                        16500000
PROMPTFL EQU   X'01'              PROMPTER RQ FLAG                      16600000
CONFIGFL EQU   X'02'              INDICATES CONFIGURATOR REQUEST        16700000
TRMMAX   EQU   256                MAXIMUM LENGTH OF TRM                 16800000
ERRCD4   EQU   X'04'              ERROR RETURN CODE                     16900000
ERRCD8   EQU   8                  LU ERROR RETURN CODE         @XM05678 16920010
HELDN    EQU   X'04'              HOLD MODE                             16950000
SHFTBIT  EQU   128                BIT TESTER                            16960000
RQINIT   EQU   X'0C'              START OF LIST                         16970000
RQEND    EQU   X'80'              END OF LIST                           16980000
LGBSZ    EQU   X'40'              LGB SIZE                     @Y17XAUU 16985000
MAXRUSIZ EQU   256                MAXIMUM RU SIZE              @YM08523 16986000
ADRMSK3  EQU   3                  ADDRESS MASK                 @YM08410 16987000
ADRMSK7  EQU   7                  ADDRESS MASK                 @Y17XAUU 16990000
ADRMSKF  EQU   15                 ADDRESS MASK                 @Y17XAUU 16995000
         EJECT                                                          17000000
         SAVE  (14,12)                                                  17100000
         SPACE                                                          17200000
         DROP  R15                                                      17300000
         LR    R6,R15                   LOAD BASE                       17400000
         USING KTRM,R12                                                 17500000
         USING TOTOLTCB,R2                                              17600000
         USING IEDQWB2,R6                                               17700000
         SPACE 2                                                        17800000
         LA    R3,QWB2SAVE        MY SAVE AREA                          17900000
         ST    R3,D8(R13)         STORE IN CALLER'S SAVE AREA           18000000
         ST    R13,D4(R3)         SAVE MY SAVE AREA ADDR                18100000
         LR    R13,R3                   SET R13 TO SAVE AREA            18200000
         SPACE                                                          18210000
         L     R5,TOTAVTPT        AVT ADDRESS                           18220000
         USING IEDQAVTD,R5                                              18230000
         LA    R7,AVTOPCOB        OP CONTROL QCB ADDRESS                18240000
         ST    R7,TOTOQCBA-D1     PUT IN P-LIST                @Y17XAUU 18250000
         MVI   TOTOKEY,D0         SET KEY FIELD                @Y17XAUU 18260000
         DROP  R5                                                       18270000
         SPACE 2                                                        18300000
         TM    TRMFLG01,TRMQWB3   SECOND PASS                           18400000
         BO    IEDQWB3            YES - BRANCH                          18500000
         SPACE 2                                                        18600000
****************************************************************        18700000
*        ROUTINE TO CALCULATE THE AMOUNT OF CORE NEEDED TO     *        18800000
*        COPY DUMMY ENTRIES FOR A REMOTE TERMINAL.             *        18900000
****************************************************************        19000000
DUMMYTNT EQU   *                                                        19100000
*        SET REQUEST ELEMENT FLAGS                                      19200000
         LA    R5,TOTWKSPC        ADDRESS OF WORK AREA         @Y17XAUU 19201000
         USING RQTNTENT,R5        SET REQUEST ELEMENT BASE     @Y17XAUU 19202000
         TM    TRMRQFLG,CTREQ     CT REQUEST                   @Y17XAUU 19203000
         BZ    DUMAPCHK           NO - CHECK AP REQUEST        @Y17XAUU 19204000
         MVI   RQTNTTYP,RQTNTCT   SET CT FLAG IN REQ ELEMENT   @Y17XAUU 19205000
         B     DUMRQGO            COMPLETE REQ ELEMENT SET UP  @Y17XAUU 19206000
         SPACE                                                          19207000
DUMAPCHK EQU   *                                               @Y17XAUU 19208000
         TM    TRMRQFLG,APREQ     AP REQUEST                   @Y17XAUU 19209000
         BZ    DUMPRCHK           NO - CHECK PRI TD REQUEST    @Y17XAUU 19210000
         TM    TOTFLG09,TOTCTCON  CT EQU SYSCON                @Y17XAUU 19211000
         BO    DUMAPBD            YES - GO SET AP REQUEST      @Y17XAUU 19212000
         CLC   TOTCRTNT+D1(D3),TOTARTNT+D1 CT EQU AP           @YM08562 19212500
         BNE   DUMAPBD            NO - GO SET AP REQUEST       @Y17XAUU 19214000
         OI    TRMFLG01,TRMCTEAP  SHOW CT EQU AP               @Y17XAUU 19215000
         B     DUMHR              RETURN TO CALLER             @Y17XAUU 19216000
DUMAPBD  EQU   *                                               @Y17XAUU 19217000
         MVI   RQTNTTYP,RQTNTAP   SET AP FLAG IN REQ ELEMENT   @Y17XAUU 19218000
         B     DUMRQGO            COMPLETE REQ ELEMENT SET UP  @Y17XAUU 19219000
         SPACE                                                          19220000
DUMPRCHK EQU   *                                               @Y17XAUU 19221000
         TM    TRMRQFLG,PRREQ     PRIMARY TD REQUEST           @Y17XAUU 19222000
         BZ    DUMSCCHK           NO - CHECK SEC TD REQUEST    @Y17XAUU 19223000
         TM    TOTFLG09,TOTCTCON  CT EQU SYSCON                @Y17XAUU 19224000
         BO    DUMPRAP            YES - CHECK AP               @Y17XAUU 19225000
         CLC   TOTCRTNT+D1(D3),TOTTNTPR+D1 CT EQU PRIMARY TD   @YM08562 19225500
         BNE   DUMPRAP            NO - CHECK AP                @Y17XAUU 19227000
         MVC   TOTPRENT(TOTCTEND-TOTCTENT),TOTCTENT SET UP     @Y17XAUU 19228000
*                                 PRIMARY TEST DEVICE FIELDS   @Y17XAUU 19229000
         MVI   TRMRQFLG,ALRDY     INDICATE COUNTERFEITING      @Y17XAUU 19230000
*                                 COMPLETE                     @Y17XAUU 19231000
         B     DUMHR              RETURN TO CALLER             @Y17XAUU 19232000
         SPACE                                                          19233000
DUMPRAP  EQU   *                                               @Y17XAUU 19234000
         TM    TOTFLG09,TOTAPCON+TOTAPOUT AP EQU SYSCON/SYSOUT @Y17XAUU 19235000
         BNZ   DUMPRBD            YES - GO SET PRI TD REQ      @Y17XAUU 19236000
         TM    TOTFLG09,TOTCTCON+TOTPRECT CT EQU SYSCON AND AP          19236200
*                                 DEFAULTED                    @YM08474 19236400
         BO    DUMPRBD            YES - GO SET PRI TD REQ      @YM08474 19236600
         CLC   TOTARTNT+D1(D3),TOTTNTPR+D1 AP EQU PRIMARY TD   @YM08562 19236800
         BNE   DUMPRBD            NO - GO SET PRI TD REQ       @Y17XAUU 19238000
         MVC   TOTPRENT(TOTAPEND-TOTAPENT),TOTAPENT SET UP     @Y17XAUU 19239000
*                                 PRIMARY TEST DEVICE FIELDS   @Y17XAUU 19240000
         MVI   TRMRQFLG,ALRDY     INDICATE COUNTERFEITING      @Y17XAUU 19241000
*                                 COMPLETE(APPLIES TO QWE/QWV) @Y17XAUU 19242000
         B     DUMHR              RETURN TO CALLER             @Y17XAUU 19243000
DUMPRBD  EQU   *                                               @Y17XAUU 19244000
         MVI   RQTNTTYP,RQTNTPR   SET PRI TD FLAG IN REQUEST   @Y17XAUU 19245000
*                                 ELEMENT                      @Y17XAUU 19246000
         B     DUMRQGO            COMPLETE REQ ELEMENT SET UP  @Y17XAUU 19247000
         SPACE                                                          19248000
DUMSCCHK EQU   *                                               @Y17XAUU 19249000
         TM    TRMRQFLG,SCREQ     SECONDARY TD REQUEST         @Y17XAUU 19250000
         BZ    DUMHR              NO - RETURN TO CALLER        @Y17XAUU 19251000
         TM    TOTFLG09,TOTCTCON  CT EQU SYSCON                @Y17XAUU 19252000
         BO    DUMSCAP            YES - CHECK AP               @Y17XAUU 19253000
         CLC   TOTCRTNT+D1(D3),TOTSRTNT+D1 CT EQU SECONDARY TD @YM08562 19253500
         BNE   DUMSCAP            NO - CHECK AP                @Y17XAUU 19255000
         MVC   TOTSCENT(TOTCTEND-TOTCTENT),TOTCTENT SET UP     @Y17XAUU 19256000
*                                 SECONDARY TEST DEVICE FIELDS @Y17XAUU 19257000
         MVI   TRMRQFLG,ALRDY     INDICATE COUNTERFEITING      @Y17XAUU 19258000
*                                 COMPLETE                     @Y17XAUU 19259000
         B     DUMHR              RETURN TO CALLER             @Y17XAUU 19260000
DUMSCAP  EQU   *                                               @Y17XAUU 19261000
         TM    TOTFLG09,TOTAPCON+TOTAPOUT AP EQU SYSCON/SYSOUT @Y17XAUU 19262000
         BNZ   DUMSCBD            YES - GO SET SEC TD REQ      @Y17XAUU 19263000
         CLC   TOTARTNT+D1(D3),TOTSRTNT+D1 AP EQU SECONDARY TD @YM08562 19263500
         BNE   DUMSCBD            NO - GO SET SEC TD REQ       @Y17XAUU 19265000
         MVC   TOTSCENT(TOTAPEND-TOTAPENT),TOTAPENT SET UP     @Y17XAUU 19266000
*                                 SECONDARY TEST DEVICE FIELDS @Y17XAUU 19267000
         MVI   TRMRQFLG,ALRDY     INDICATE COUNTERFEITING      @Y17XAUU 19268000
*                                 COMPLETE                     @Y17XAUU 19269000
         B     DUMHR              RETURN TO CALLER             @Y17XAUU 19270000
DUMSCBD  EQU   *                                               @Y17XAUU 19271000
         MVI   RQTNTTYP,RQTNTSC   SET SEC TD FLAG IN REQUEST   @Y17XAUU 19272000
*                                 ELEMENT                      @Y17XAUU 19273000
         SPACE                                                          19274000
DUMRQGO  EQU   *                                               @Y17XAUU 19275000
         MVI   RQTNTFGS,RQTNTLST  INDICATE LAST ENTRY          @Y17XAUU 19276000
         DROP  R5                                              @Y17XAUU 19277000
         SPACE                                                          19278000
         OI    TOTFLG10,TOTTNTRQ+TOTOLTRS  SET REQUEST/RESTART FLAGS    20200000
*                                                                       20300000
         L     R11,TNTENTRY       GET TTE ADDRESS                       20400000
         LA    R8,TRMPRFSZ        GET TTE PREFIX SIZE          @Y17XAUU 20430000
         SLR   R11,R8             POINT TO TTE PREFIX          @Y17XAUU 20460000
         USING IEDNTRM,R11        SET TTE ADDRESSABILITY       @Y17XAUU 20500000
         L     R8,TRMDESTQ-D1     GET QCB ADDRESS                       20600000
         LA    R8,D0(R8)          CLEAR HI-ORDER BYTE                   20700000
         ST    R8,TRMQCB          SAVE IT                               20800000
         USING IEDQQCB,R8                                               20900000
         TM    TRMSTATE,TRMPREF   3705 RESOURCE                @Y17XAUU 20950000
         BZ    DUM2A              NO                                    21040000
         L     R1,TOTRESPL        GET RESIDENT CONTROL BLK ADDR@Y17XAUU 21042000
         USING RESPL,R1           SET RESPL ADDRESSABILITY     @Y17XAUU 21044000
         L     R1,RESTOTMH        GET TOTE MH ADDRESS          @Y17XAUU 21046000
         DROP  R1                                              @Y17XAUU 21048000
         LTR   R1,R1              WAS MH GEN'ED                @Y17XAUU 21050000
         BZ    DUMFAIL            NO - TERMINATE REQUEST       @Y17XAUU 21052000
         OI    TRMFLG01,TRM3705   YES - SHOW IT                         21060000
         CLI   TRMTYPE,TRMLUNT    LU ENTRY                     @Y17XAUU 21060500
         BNE   DUM2A              NO                           @Y17XAUU 21061000
         OI    TRMFLG01,TRMRNLU   SET LU FLAG                  @Y17XAUU 21061500
************************************************************** @Y17XAUU 21062000
*        VERIFY THAT LU IS IN A STATE WHERE BY TOTE          * @Y17XAUU 21062500
*        CAN USE THE DEVICE:                                 * @Y17XAUU 21063000
*        (1) AN SSCP-LU SESSION EXISTS AND                   * @Y17XAUU 21063500
*        (2) NO LU-LU SESSION EXISTS                         * @Y17XAUU 21064000
************************************************************** @Y17XAUU 21064500
         SLR   R1,R1              CLEAR REG                    @Y17XAUU 21064600
         IC    R1,TOTTTBEL        GET NAME LENGTH              @Y17XAUU 21064700
         BCTR  R1,R0              ADJUST LENGTH                @Y17XAUU 21064800
         L     R7,TRMTNT          GET TNT ADDRESS              @Y17XAUU 21064900
         EX    R1,TNTNAME         COPY SYMBOLIC NAME           @Y17XAUU 21065000
         MVI   TOTOVBCD,HOLD      SET HOLD VERB CODE           @Y17XAUU 21065200
         MVC   TOTOLADR(D8),WORK1 SET RESOURCE NAME            @Y17XAUU 21065500
         MVC   TOTORLN(D1),QCBRELLN SET RLN                    @Y17XAUU 21066000
         BAL   R14,OPCREQ         ISSUE HOLD TERMINAL          @Y17XAUU 21066500
         CLI   TOTORTCD,ERRCD4    ERROR RETURN                 @Y17XAUU 21067000
         BE    DUMER1             YES - TERMINATE REQUEST      @XM05678 21067210
         SLR   RSIB,RSIB          CLEAR REG                    @Y17XAUU 21068000
         ICM   RSIB,ADRMSK7,TRMSIBPT SIB CHAIN POINTER         @Y17XAUU 21068500
         BZ    DUMER0             ERROR - NO SSCP-LU SESSION   @XM05678 21068710
         USING IEDSIBD,RSIB       SET SIB ADDRESSABILITY       @Y17XAUU 21069500
         L     RAVT,TOTAVTPT      GET AVT ADDRESS              @Y17XAUU 21070000
         USING IEDQAVTD,RAVT      SET AVT ADDRESSABILITY       @Y17XAUU 21070500
         ICM   RSAVT,ADRMSKF,AVTSAVTP GET SAVT ADDRESS         @Y17XAUU 21071000
         LA    RSAVT,D0(RSAVT)    CLEAR FLAG FIELD             @Y17XAUU 21071500
         USING IEDNSVTD,RSAVT     SET SAVT ADDRESSABILITY      @Y17XAUU 21072000
         CLC   SIBINDEX,SAVTSCPT  IF TTCIN EQU SSCP TTCIN THEN @Y17XAUU 21072500
*                                 ONLY AN SSCP-LU SESSION      @Y17XAUU 21073000
*                                 EXIST                        @Y17XAUU 21073500
         BE    DUM2A              YES - CONTINUE PROCESSING    @Y17XAUU 21074000
         DROP  RSAVT                                           @Y17XAUU 21074500
DUMER0   EQU   *                                               @XM05678 21074710
         MVI   TOTOVBCD,RELEASE   SET RELEASE VERB CODE        @Y17XAUU 21075000
         MVC   TOTOLADR(D8),WORK1 SET RESOURCE NAME            @Y17XAUU 21075500
         MVC   TOTORLN(D1),QCBRELLN SET RLN                    @Y17XAUU 21076000
         BAL   R14,OPCREQ         RELEASE RESOURCE             @Y17XAUU 21076500
DUMER1   EQU   *                                               @XM05678 21076710
         L     R14,TRMBYTE2       WORD CONTAINS TRMSTOTE FLAG  @G36XRUV 21077010
CSLOOP1  DS    0H                                              @G36XRUV 21077310
         LR    R15,R14            COPY                         @G36XRUV 21077610
         N     R15,OFFSTOTE       TURN OFF TOTE BIT IN REG     @G36XRUV 21077910
         CS    R14,R15,TRMBYTE2   RESET TRMSTOTE IN TTE        @G36XRUV 21078210
         BNZ   CSLOOP1            IF WORD ALTERED, TRY AGAIN   @G36XRUV 21078510
         L     R13,D4(R13)        RESTORE CALLERS SAVE AREA @  @XM05678 21078810
         LM    R14,R12,D12(R13)   RESTORE CALLERS REG          @XM05678 21079110
         LA    R15,ERRCD8         SET ERROR RETURN CODE        @XM05678 21079410
         BR    R14                RETURN TO CALLER             @XM05678 21079710
DUM2A    EQU   *                                                        21080000
         TM    QCBTSOF1,QCBDELAY  QCB IN DELAY QUEUE                    21100000
         BZ    DUM2B              NO - CONTINUE                  S22024 21200000
         OI    TRMFLG01,TRMDELY   SHOW QCB ON TIME DELAY QUEUE   S22024 21300000
DUM2B    EQU   *                                                 S22024 21400000
*        FIND LENGTH OF QCB                                             21500000
         LA    R9,QCBMSIZE        GET M-QCB SIZE                        21600000
         TM    TRMFLG01,TRM3705   3705 MODE                             21620000
         BZ    DUM2C              NO                                    21640000
         LA    R9,QCBPRFSZ(R9)    ADD ON QCB PREFIX SIZE       @Y17XAUU 21650000
DUM2C    EQU   *                                                        21680000
         LA    R10,QCBPSIZE       GET P-QCB SIZE                        21700000
*        FIND LEVEL ZERO PRIORITY QCB                                   21800000
         LA    R3,QCBMEND         POINT TO FIRST P-QCB                  21900000
DUM2D    EQU   *                                                        22000000
         CLI   D24(R3),D0         LEVEL ZERO ?                          22100000
         BE    DUM2H              YES                                   22200000
         AR    R3,R10             POINT TO NEXT P-QCB                   22300000
         B     DUM2D              MAKE ANOTHER CHECK                    22400000
DUM2H    EQU   *                                                        22500000
         ST    R3,KPQCB           SAVE ADDR OF P-QCB                    22600000
         STH   R10,KPQCBSZ        SAVE SIZE OF P-QCB                    22700000
         AR    R10,R9             GET TOTAL QCB SIZE                    22800000
         STH   R10,REGSAVE        SAVE QCB LENGTH                       22900000
         STH   R9,KMQCBSZ         SAVE SIZE OF MASTER QCB               23000000
         TM    TRMDEVFL+D1,TRMCONC CONC OR TERMINAL ATTACHED            23100000
         BZ    DUM2K              NO - CONTINUE NORMAL PROCESSING       23200000
         TM    QCBDSFLG,QCBDRQQ   TERMINAL A CONC                       23300000
         BO    DUMFAIL            YES - TERMINATE TRM                   23400000
*                                                                       23500000
*        TERMINAL IS ATTACHED TO A CONCENTRATOR                         23600000
*                                                                       23700000
         OI    TRMFLG01,CONC      SHOW TERMINAL ATTACHED TO CONC        23800000
         LH    R3,KPQCBSZ         GET LEVEL 0 P-QCB SIZE                23900000
         A     R3,KPQCB           POINT TO QCB EXTENSION                24000000
         ST    R3,KEXT            SAVE EXTENSION ADDR                   24100000
         USING IEDQQCBE,R3                                              24200000
         TM    QCBEFLG,XE0        PROCESS REQUEST                       24300000
         BZ    DUM2J              YES                                   24400000
         B     DUMFAIL            NO - TERMINATE TRM                    24500000
DUM2J    EQU   *                                                        24600000
         SR    R9,R9              CLEAR REG                             24700000
         IC    R9,QCBELGTH        LENGTH OF QCB EXTENSION               24800000
         SPACE                                                          24900000
         SR    R4,R4              CLEAR REG                             25000000
         LR    R5,R9              GET QCB EXT LENGTH                    25100000
         D     R4,K4              DIVIDE TOTAL QCB EXT LEN BY 4         25200000
         SLL   R5,D2              RESTORE INTEGRAL PART                 25300000
         LTR   R4,R4              REMAINDER                             25400000
         BZ    DUM2J4             NO                                    25500000
         A     R5,K4              INSURE F-WORD BOUNDARY                25600000
         SPACE                                                          25700000
DUM2J4   EQU   *                                                        25800000
         STH   R5,KQCBESZ         SAVE QCBE LEN                         25900000
         LR    R9,R5              SAVE VALUE                            26000000
         AH    R9,KPQCBSZ         P-QCB + QCBE                          26100000
         STH   R9,KPQCBSZ         SAVE COUNT                            26200000
         LA    R9,QCBMSIZE        GET M-QCB LENGTH                      26300000
         STH   R9,KMQCBSZ         SAVE IT                               26400000
         AH    R9,KPQCBSZ         M-QCB + P-QCB+ QCBE                   26500000
         STH   R9,REGSAVE         SAVE TOTAL                            26600000
         L     R9,QCBECONC-D1     GET ADDR OF CONC TERMINAL ENTRY       26700000
         LA    R9,D0(R9)          CLEAR FLAG BYTE                       26800000
         ST    R9,CONCTTE         SAVE TERMINAL ENTRY ADDR              26900000
         DROP  R3                                                       27000000
         DROP  R11                                                      27100000
         USING IEDQTRM,R9                                               27200000
         L     R3,TRMDESTQ-D1     GET ADDR OF DRQ                       27300000
         LA    R3,D0(R3)          CLEAR FLAG BYTE                       27400000
         ST    R3,KDRQ            SAVE DRQ ADDR                         27500000
         LA    R3,QCBMSIZE        GET SIZE OF DRQ                       27600000
         STH   R3,KDRQSZ          SAVE IT                               27700000
         AH    R3,REGSAVE         M-QCB + P-QCB + QCBE + DRQ            27800000
         LR    R10,R3             SAVE TOTAL                            27900000
DUM2K    EQU   *                                                        28000000
         DROP  R8                                                       28100000
         TM    TRMFLG01,CONC      TERMINAL ATTACHED TO CONC             28200000
         BZ    DUM2N              NO                                    28300000
         OI    TRMFLG01,TRMSPAS   SET SECOND PASS FLAG                  28400000
         LA    R14,TRMOPNO-IEDQTRM INIT TTE COUNT FOR CONC TERM@Y17XAUU 28500000
         TM    TRMFLG01,TRM3705   3705 MODE                             28520000
         BZ    DUM2L              NO                                    28540000
         LA    R14,TRMPRFSZ(R14) ADD ON TTE PREFIX SIZE        @Y17XAUU 28550000
DUM2L    EQU   *                                                        28580000
         LR    R15,R14            INIT TTE COUNT FOR CONC               28600000
         SPACE                                                          28700000
         DROP  R9                                                       28800000
         USING IEDQTRM,R11                                              28900000
DUM2N    EQU   *                                                        29000000
*        FIND LENGTH OF TTE                                             29100000
         L     R11,TNTENTRY       RESET TTE BASE               @YM07726 29120000
         LA    R0,D2              SET DEV DEP FIELDS TO CHECK           29150000
         LA    R8,TRMOPNO-IEDQTRM SIZE OF BASIC PORTION OF TTE @Y17XAUU 29300000
         LA    R9,TRMOPNO         POINT TO OPTION FIELD COUNT           29400000
         TM    TRMSTATE,TRMOPTFN  OPTION FIELDS PRESENT?                29500000
         BZ    DUMNOPT            NO                                    29600000
         SR    R7,R7              CLEAR REG 7                           29700000
         IC    R7,TRMOPNO         GET OPTION FIELD COUNT                29800000
         AR    R8,R7              ADD OPTION COUNT                      29900000
         TM    TRMFLG01,CONC      CONC TERMINAL                         30000000
         BZ    DUMOP8             NO                                    30100000
         TM    TRMFLG01,TRMSPAS   TERMINAL CHECK                        30200000
         BZ    DUMOP4             NO - CONC CHECK                       30300000
         LA    R14,D3(R7,R14)     GET OPTION COUNT FOR CONC TERMINAL    30400000
         B     DUMOP8             BYPASS CONC                           30500000
DUMOP4   EQU   *                                                        30600000
         LA    R15,D3(R7,R15)     OPTION COUNT FOR CONC                 30700000
DUMOP8   EQU   *                                                        30800000
         LA    R10,D3(R8,R10)     ADD OPTION FIELDS LENGTH              30900000
         AR    R9,R7                                                    31000000
         LA    R9,D3(R9)          POINT TO DEVICE DEPENENT FIELD        31100000
DUMNOPT  EQU   *   EVALUATE DEVICE DEPENDENT FIELD                      31200000
         TM    TRMSTATE,TRMOPTFN  OPTION FIELDS PRESENT?                31300000
         BO    DUMNOPT1           YES                                   31400000
         AR    R10,R8             KEEP RUNNING TOTAL                    31500000
DUMNOPT1 EQU   *                                                        31600000
         LA    R3,D8              SET NUMBER OF BITS TO TEST            31700000
         SR    R5,R5              CLEAR REG 5                           31800000
         LA    R4,SHFTBIT         SET INITIAL BIT TO TEST               31900000
DUMTEST  EQU   *                                                        32000000
         EX    R4,DUMDEV          IS THIS BIT SET?                      32100000
         BZ    DUMSHIFT           NO                                    32200000
         IC    R5,D0(R9)          CORE NEEDED FOR THIS ENTRY            32300000
         LA    R5,D1(R5)          TOTAL CORE                            32400000
         TM    TRMFLG01,CONC      CONC TERMINAL                         32500000
         BZ    DUMD8              NO                                    32600000
         TM    TRMFLG01,TRMSPAS   TERMINAL CHECK                        32700000
         BZ    DUMD4              NO - CONC CHECK                       32800000
         AR    R14,R5             TTE COUNT FOR CONC TERMINAL           32900000
         B     DUMD8              EXIT                                  33000000
DUMD4    EQU   *                                                        33100000
         AR    R15,R5             TTE COUNT FOR CONC                    33200000
DUMD8    EQU   *                                                        33300000
         AR    R10,R5             KEEP RUNNING TOTAL                    33400000
         AR    R9,R5              POINT TO NEXT ENTRY                   33500000
DUMSHIFT EQU   *                                                        33600000
         SRL   R4,1               ADJUST TO TEST NEXT BIT               33700000
         BCT   R3,DUMTEST         TEST NEXT BIT                         33800000
         LA    R11,D1(R11)        GET ADDRESS OF NEXT BYTE TO TEST      33900000
         BCT   R0,DUMNOPT1        GO EXAMINE NEXT BYTE                  34000000
         TM    TRMFLG01,CONC      TERMINAL ATTACHED TO CONC             34100000
         BZ    DUMSH4             NO                                    34200000
         TM    TRMFLG01,TRMSPAS   SECOND PASS COMPLETE                  34300000
         BZ    DUMSH4             EXIT                                  34400000
         NI    TRMFLG01,XFF-TRMSPAS TURN OFF SECOND PASS FLAG           34500000
         L     R11,CONCTTE        POINT TO CONC TERMINAL ENTRY          34600000
         B     DUM2N              GET SIZE OF CONC TTE                  34700000
DUMSH4   EQU   *                                                        34800000
         TM    TRMFLG01,TRM3705   3705 MODE                             34820000
         BZ    DUMSH6             NO                                    34840000
         LA    R10,IEDQTRM-IEDTRM(R10) ADD ON TTE PREFIX SIZE  @Y17XAUU 34850000
DUMSH6   EQU   *                                                        34880000
         SR    R4,R4              CLEAR REG 4                           35000000
         LR    R5,R10             COPY TOTAL CORE NEEDED                35100000
         D     R4,K4              DIVIDE TOTAL CORE BY 4                35200000
         SLL   R5,D2              RESTORE INTEGRAL PART OF TOTAL        35300000
         LTR   R4,R4              A  REMAINDER?                         35400000
         BZ    DUMREQ             NO                                    35500000
         A     R5,K4              INSURE F-WORD BOUNDARY FOR QCB        35600000
DUMREQ   EQU   *                                                        35700000
         LR    R10,R5             SAVE TOTAL CORE                       35800000
         TM    TRMFLG01,CONC      CONC                                  35900000
         BZ    DUMR12             NO                                    36000000
         SPACE                                                          36100000
         SR    R4,R4              CLEAR REG                             36200000
         LR    R5,R14             GET CONC TERM TTE LEN                 36300000
         D     R4,K4              DIVIDE BY 4                           36400000
         SLL   R5,D2              RESTORE INTEGRAL PART                 36500000
         LTR   R4,R4              REMAINDER                             36600000
         BZ    DUMR4              NO                                    36700000
         A     R5,K4              INSURE F-WORD BOUNDARY                36800000
DUMR4    EQU   *                                                        36900000
         STC   R5,TTETSZ          SAVE CONC TERM TTE LEN                37000000
         SPACE                                                          37100000
         SR    R4,R4              CLEAR REG                             37200000
         LR    R5,R15             GET CONC TTE LEN                      37300000
         D     R4,K4              DIVIDE BY 4                           37400000
         SLL   R5,D2              RESTORE INTEGRAL PART                 37500000
         LTR   R4,R4              REMAINDER                             37600000
         BZ    DUMR8              NO                                    37700000
         A     R5,K4              INSURE F-WORD BOUNDARY                37800000
DUMR8    EQU   *                                                        37900000
         STC   R5,TTECSZ          SAVE CONC TTE SIZE                    38000000
         A     R10,K12            SET UP FOR BOUNDARY ALIGNMENT         38100000
DUMR12   EQU   *                                                        38200000
         TM    TRMFLG01,TRM3705   3705 MODE                    @Y17XAUU 38220000
         BZ    DUMR14             NO                           @Y17XAUU 38240000
         LA    R10,LGBSZ(R10)     ADD LGB SIZE TO TOTAL        @Y17XAUU 38260000
DUMR14   EQU   *                                               @Y17XAUU 38280000
         STH   R10,REGSAVE+D2     SAVE TOTAL CORE NEEDED                38300000
         LA    R1,TOTWKSPC        ADDRESS OF WORK AREA         @Y17XAUU 38320000
         USING RQTNTENT,R1        SET REQUEST ELEMENT BASE     @Y17XAUU 38340000
         STH   R10,RQTNTLNT       SET REQUEST LENGTH           @Y17XAUU 38360000
         DROP  R1                                              @Y17XAUU 38380000
         TM    TRMFLG01,TRM3705   3705 MODE                    @Y17XAUU 38410000
         BZ    DUMHR              NO - EXIT                    @Y17XAUU 38440000
         LA    R1,LGBSZ           GET LGB SIZE                 @Y17XAUU 38470000
         SLR   R10,R1             TTE/QCB SIZE                 @Y17XAUU 38500000
         STH   R10,REGSAVE+D2     SAVE LENGTH                  @Y17XAUU 38530000
         B     DUMHR              RETURN                                38600000
         EJECT                                                          38600500
OPCREQ   EQU   *                                               @Y17XAUU 38601000
         XC    TOTOLINK(D3),TOTOLINK CLEAR LINK FIELD          @Y17XAUU 38601500
         XC    TOTOTECB(D4),TOTOTECB CLEAR ECB                 @Y17XAUU 38602000
         MVI   TOTOPRI,PRISSOLT   SET POST PRIORITY            @Y17XAUU 38602500
         MVI   TOTOELNG,X18       SET ELEMENT LENGTH           @Y17XAUU 38602700
         XC    TOTORTCD,TOTORTCD  ZERO RETURN CODE FIELD       @Y17XAUU 38603000
         LA    R1,TOTOTECB        GET ECB ADDRESS              @Y17XAUU 38603500
         ST    R1,TOTOECBA        SET IT IN PLIST              @Y17XAUU 38604000
         LA    R1,TOTPLIST        GET PLIST ADDRESS            @Y17XAUU 38604500
         ST    R1,TRMSLPL         SAVE IN POST PLIST           @Y17XAUU 38605000
         ST    R1,TRMSLPL+D4      SAVE IN POST PLIST           @Y17XAUU 38605500
         MVI   TRMSLPL,RQINIT     SET REQUEST TYPE             @Y17XAUU 38606000
         MVI   TRMSLPL+D4,RQEND   SHOW END OF LIST             @Y17XAUU 38606500
         LA    R1,TRMSLPL         POINT TO POST PLIST          @Y17XAUU 38607000
         AQCTL                    POST REQUEST                 @Y17XAUU 38607500
         WAIT  ECB=TOTOTECB       WAIT FOR COMPLETION          @Y17XAUU 38608000
         BR    R14                RETURN TO CALLER             @Y17XAUU 38608500
         EJECT                                                          38700000
****************************************************************        38800000
*        ROUTINE TO COPY DUMMY ENTRIES FOR A REMOTE TERMINAL.  *        38900000
****************************************************************        39000000
IEDQWB3  EQU   *                                                        39100000
         NI    TRMFLG01,XFF-TRMQWB3 CLEAR SECOND PASS FLAG              39150000
         TM    TRMRQFLG,CTREQ     CT REQUEST                   @Y17XAUU 39152000
         BZ    DUM360             NO                           @Y17XAUU 39154000
         L     R3,TOTCTTNT        CT DUMMY TNT ADDRESS         @Y17XAUU 39156000
         LA    R4,TOTCTENT        CT DEVICE ENTRY ADDRESS      @Y17XAUU 39157000
         B     DUM390             CONTINUE                     @Y17XAUU 39158000
DUM360   EQU   *                                               @Y17XAUU 39160000
         TM    TRMRQFLG,APREQ     AP REQUEST                   @Y17XAUU 39162000
         BZ    DUM370             NO                           @Y17XAUU 39164000
         L     R3,TOTAPTNT        AP DUMMY TNT ADDRESS         @Y17XAUU 39166000
         LA    R4,TOTAPENT        AP DEVICE ENTRY ADDRESS      @Y17XAUU 39167000
         B     DUM390             CONTAINS                     @Y17XAUU 39168000
DUM370   EQU   *                                               @Y17XAUU 39170000
         TM    TRMRQFLG,PRREQ     PRIMARY TD REQUEST           @Y17XAUU 39172000
         BZ    DUM380             NO                           @Y17XAUU 39174000
         L     R3,TOTPDTNT        PRIMARY TD DUMMY TNT ADDRESS @Y17XAUU 39176000
         LA    R4,TOTPRENT        PRI TD DEVICE ENTRY ADDRESS  @Y17XAUU 39177000
         B     DUM390             CONTINUE                     @Y17XAUU 39178000
DUM380   EQU   *                                               @Y17XAUU 39180000
         L     R3,TOTSDTNT        SECOND TD DUMMY TNT ADDRESS  @Y17XAUU 39182000
         LA    R4,TOTSCENT        SEC TD DEVICE ENTRY ADDRESS  @Y17XAUU 39183000
DUM390   EQU   *                                               @Y17XAUU 39184000
         ST    R4,DEVENT          SAVE DEVICE ENTRY ADDRESS    @Y17XAUU 39484000
         SR    R4,R4              CLEAR REG 4                           39900000
         L     R10,TERNMTAB       GET TERM NAME TABLE POINTER           40000000
         USING IEDQTNTD,R10                                             40100000
         IC    R4,TNTENLEN        GET MAX. NAME LENGTH                  40200000
         DROP  R10                                                      40300000
         BCTR  R4,D0              DECREMENT FOR EXECUTE                 40400000
         L     R7,TRMTNT          POINT TO TRUE TNT                     40500000
         EX    R4,DUMNAME         MOVE NAME TO DUMMY TNT                40600000
         EX    R4,TNTNAME         NAME TO WORK AREA                     40650000
         LA    R5,D1(R4)          RESTORE MAX. NAME LENGTH              40700000
         AR    R5,R3              POINT TO TTE POINTER                  40800000
         LR    R3,R5              SAVE TTE POINTER ADDR                 40850000
         MVC   TRMSAV1+D1(D3),D0(R5)  GET TTE POINTER                   40900000
         MVI   TRMSAV1,D0         ZERO HI-ORDER BYTE                    41000000
         L     R5,TRMSAV1         PUT IT IN REG 5                       41100000
         TM    TRMFLG01,TRM3705   3705 MODE                             41110000
         BZ    DUM4E              NO                                    41120000
         LA    R5,IEDQTRM-IEDTRM(R5) POINT PASS TTE PREFIX     @Y17XAUU 41125000
         ST    R5,TRMSAV1         PUT IN WORK AREA                      41140000
         MVC   D0(D3,R3),TRMSAV1+D1 REPLACE TTE ADDR IN TNT             41150000
         LA    R1,IEDQTRM-IEDTRM  TTE PREFIX SIZE              @Y17XAUU 41153000
         SLR   R5,R1              TTE PREFIX ADDRESS           @Y17XAUU 41156000
DUM4E    EQU   *                                                        41170000
         TM    TRMFLG01,CONC      CONC TERMINAL                         41200000
         BZ    DUMS4              NO                                    41300000
         SR    R3,R3              CLEAR REG                             41400000
         IC    R3,TTETSZ          LENGTH OF CONC TERMINAL TTE ENTRY     41500000
         B     DUMS8              CONTINUE PROCESSING                   41600000
DUMS4    EQU   *                                                        41700000
         LH    R3,REGSAVE+D2      GET TOTAL CORE NEEDED                 41800000
         SH    R3,REGSAVE         GET TTE SIZE                          41900000
DUMS8    EQU   *                                                        42000000
         BCTR  R3,D0              DECREMENT FOR EXECUTE                 42100000
         L     R7,TNTENTRY        POINT TO TRUE TTE                     42200000
         TM    TRMFLG01,TRM3705   3705 MODE                             42220000
         BZ    DUMS10             NO                                    42240000
         LA    R1,IEDQTRM-IEDTRM  TTE PREFIX SIZE              @Y17XAUU 42246000
         SLR   R7,R1              TTE PREFIX ADDRESS           @Y17XAUU 42252000
DUMS10   EQU   *                                                        42280000
         EX    R3,DUMTTE          COPY TTE                              42300000
         LR    R10,R5             SAVE DUMMY TTE POINTER                42400000
         LA    R5,D1(R3,R5)       POINT TO PLACE FOR QCB                42500000
         TM    TRMFLG01,TRM3705   3705 MODE                             42510000
         BZ    DUMS12             NO                                    42520000
         LA    R7,IEDQTRM-IEDTRM(R7) PT PASS TTE PREFIX (R)    @Y17XAUU 42521000
         LA    R10,IEDQTRM-IEDTRM(R10) PT PASS TTE PREFIX (D)  @Y17XAUU 42522000
         NI    TRMDEVFL-IEDQTRM(R10),XFF-TRMBUFS NO BUF SIZE   @YM08410 42522300
*                                  SPECIFIED FOR COUNTERFEIT   @YM08410 42522600
         LA    R5,QCBPRFSZ(R5)    POINT PASS PL FOR QCB PREFIX @Y17XAUU 42523000
         ST    R5,D0(R10)         PUT QCB ADDRESS IN TTE                42550000
         MVC   D0(D1,R10),D0(R7)  MOVE IN FLAG BYTE                     42560000
         LA    R1,QCBPRFSZ        QCB PREFIX SIZE              @Y17XAUU 42563000
         SLR   R5,R1              POINT TO QCB PREFIX          @Y17XAUU 42566000
         B     DUMS13             BRANCH                                42575000
DUMS12   EQU   *                                                        42580000
         ST    R5,D0(R10)         PUT QCB ADDRESS IN TTE                42600000
         MVC   D0(D1,R10),D0(R7)  MOVE IN FLAG BYTE                     42700000
*                                                                       42800000
DUMS13   EQU   *                                                        42850000
         NI    D0(R10),XFF-HELDN        TURN OFF HOLD FLAG     @YA10965 42870058
         LH    R3,KMQCBSZ         GET M-QCB LENGTH                      42900000
         BCTR  R3,D0              DECREMENT FOR EX                      43000000
         L     R7,TRMQCB          POINT TO TRUE M-QCB                   43100000
         TM    TRMFLG01,TRM3705   3705 MODE                             43120000
         BZ    DUMS15             NO                                    43140000
         LA    R1,QCBPRFSZ        QCB PREFIX SIZE              @Y17XAUU 43146000
         SLR   R7,R1              POINT TO QCB PREFIX          @Y17XAUU 43152000
DUMS15   EQU   *                                                        43180000
         EX    R3,DUMQCB          COPY M-QCB                            43200000
         TM    TRMFLG01,CONC      CONC TERMINAL                         43300000
         BZ    DUMHD              NO                                    43400000
         LA    R14,QCBMSIZE       GET M-QCB LENGTH                      43500000
         LA    R15,QCBPSIZE       GET P-QCB LENGTH                      43600000
         AR    R14,R15            OFFSET TO EXTENSION                   43700000
         STH   R14,D24(R5)        PUT IN DUMMY M-QCB                    43800000
         AR    R14,R5             GET ADDR OF PLACE FOR DUMMY EXT       43900000
         ST    R14,DUMEXTA        SAVE IT                               44000000
DUMHD    EQU   *                                                        44100000
         TM    TRMFLG01,TRM3705   3705 MODE                             44120000
         BZ    DUMHD2             NO                                    44140000
         LA    R1,QCBPRFSZ        QCB PREFIX SIZE              @Y17XAUU 44143000
         SLR   R3,R1              ADJUST COUNT                 @Y17XAUU 44146000
         LA    R5,QCBPRFSZ(R5)    POINT PASS QCB PREFIX        @Y17XAUU 44150000
DUMHD2   EQU   *                                                        44180000
         ST    R5,KMQCB           SAVE DUMMY M-QCB ADDR                 44200000
         LA    R5,D1(R3,R5)       POINT TO PLACE FOR P-QCB              44300000
         TM    TRMFLG01,TRM3705   3705 MODE                             44320000
         BZ    DUMHD4             NO                                    44340000
DUMHD4   EQU   *                                                        44380000
         LH    R3,KPQCBSZ         GET SIZE OF P-QCB                     44400000
         BCTR  R3,D0              DECREMENT FOR EX                      44500000
         L     R4,KPQCB           GET ADDR OF TRUE P-QCB                44600000
         EX    R3,DUMPQCB         COPY P-QCB                            44700000
         TM    TRMFLG01,CONC      CONC TERMINAL                         44800000
         BZ    DUMHJ              NO                                    44900000
         LA    R5,D1(R3,R5)       PLACE FOR DUMMY CONC TTE              45000000
         ST    R5,KCTTE           SAVE IT                               45100000
         SR    R3,R3              CLEAR REG                             45200000
         IC    R3,TTECSZ          GET LENGTH OF CONC TTE                45300000
         BCTR  R3,R0              DECREMENT FOR EX                      45400000
         L     R7,CONCTTE         REAL CONC TTE ADDR                    45500000
         EX    R3,DUMCTTE         COPY DUMMY CONC TTE                   45600000
         L     R14,DUMEXTA        DUMMY EXTENSION ADDR                  45700000
         USING IEDQQCBE,R14                                             45800000
         MVC   QCBECONC(D3),KCTTE+D1 PUT DUMMY CONC TTE ADDR IN EXT     45900000
         XC    QCBEFLG(D1),QCBEFLG  CLEAR FLAG BYTE IN EXTENSION        46000000
         DROP  R14                                                      46100000
         SPACE                                                          46200000
         LA    R5,D1(R3,R5)       PLACE FOR DRQ                         46300000
         L     R7,KDRQ            REAL DRQ                              46400000
         LH    R3,KDRQSZ          SIZE OF DRQ                           46500000
         BCTR  R3,R0              DECREMENT FOR EX                      46600000
         EX    R3,DUMDRQ          COPE IT                               46700000
         L     R14,KCTTE          ADDR OF DUMMY CONC TTE                46800000
         ST    R5,DKDRQ           SAVE DUMMY DRQ ADDR                   46900000
         MVC   D1(D3,R14),DKDRQ+D1 PUT DRQ ADDR IN CONC TTE             47000000
         USING IEDQDRQ,R5                                               47100000
         NI    DRQFLAG1,XFF-DRQHELD TURN OFF STOP SENDING BIT           47200000
         NI    DRQSTAT,XFF-DRQTRMHO TURN OFF HELD BIT                   47300000
         L     R1,TOTAVTPT        GET ADDRESS OF AVT                    47400000
         USING IEDQAVTD,R1        SET UP ADDRESSIBILITY FOR AVT         47500000
         MVC   DRQELCHN(D3),AVTDELAD+D1 PUT DUMMY LAST ELEMENT          47600000
*                                         ADDRESS INTO DATA READY       47700000
*                                         QUEUE                         47800000
         DROP  R1                 DROP AVT BASE                         47900000
*                                                                       48000000
*        SET UP HM POINTER IN DRQ                                       48100000
*                                                                       48200000
         LR    R4,R7              ADDR OF REAL DRQ                      48300000
         L     R3,D8(R4)          GET STCB CHAIN ADDR                   48400000
         LA    R3,D0(R3)          CLEAR HI ORDER BYTE                   48500000
         LA    R15,D8(R4)         GET ADDR OF 3RD WORD                  48600000
         CR    R3,R15             3RD WORD POINT TO SELF                48700000
         BE    DUMHG              YES - HM PTR IS 4TH WORD              48800000
         ST    R3,DRQSTPRI        PUT IN 4TH WORD                       48900000
         MVC   DRQSTPRI(D1),D12(R4) PUT FLAG BYTE IN                    49000000
DUMHG    EQU   *                                                        49100000
         LA    R3,DRQSTVTO        3RD WORD                              49200000
         ST    R3,DRQSTVTO        PUT IT IN ITSELF                      49300000
         MVC   DRQSTVTO(D1),D8(R4) SET INDEX                            49400000
         XC    DRQCURQ(D3),DRQCURQ CLEAR CURRENT QCB POINTER            49500000
         MVC   DRQSCBOF(D1),D20(R4) MOVE IN FLAG BYTE                   49600000
DUMHJ    EQU   *                                                        49650000
         L     R7,TRMQCB          RESTORE TRUE M-QCB                    49700000
         DROP  R5                                                       49800000
         SPACE                                                          49900000
*                                                              @Y17XAUU 49908000
*        COPY LGB IF 3705 RESOURCE                             @Y17XAUU 49916000
*                                                              @Y17XAUU 49924000
         TM    TRMFLG01,TRM3705   3705 MODE                    @Y17XAUU 49932000
         BZ    DUMHJ2             NO - NO LGB TO COPY          @Y17XAUU 49940000
         LA    R10,D1(R3,R5)      PLACE FOR DUMMY LGB          @Y17XAUU 49948000
         USING IEDQQCB,R7         SET REAL QCB ADDRESSABILITY  @Y17XAUU 49949000
         L     R8,QCBLGBAD-D1     GET REAL LGB ADDRESS         @Y17XAUU 49950000
         DROP  R7                                              @Y17XAUU 49951000
         LA    R3,LGBSZ           GET LGB SIZE                 @Y17XAUU 49952000
         BCTR  R3,D0              DECREMENT FOR EX             @Y17XAUU 49953000
         EX    R3,LGBMOVE         COPY LGB                     @Y17XAUU 49954000
         L     R5,KMQCB           RESTORE DUMMY M-QCB ADDRESS  @Y17XAUU 49956000
         USING IEDNQCB,R5         SET QCB ADDRESSABILITY       @Y17XAUU 49964000
         LA    R1,QCBPRFSZ        GET QCB PREFIX SIZE          @Y17XAUU 49965000
         SLR   R5,R1              POINT TO QCB PREFIX          @Y17XAUU 49966000
         L     R8,DEVENT          GET DEVICE ENTRY ADDRESS     @Y17XAUU 49967000
         MVC   QCBTTCIN(D2),D2(R8) SET DUMMY TTCIN IN QCB      @Y17XAUU 49968000
         STCM  R10,ADRMSK7,QCBLGBAD SET DUMMY LGB ADDRESS IN   @Y17XAUU 49969000
*                                 DUMMY QCB                    @Y17XAUU 49980000
         DROP  R5                                              @Y17XAUU 50012000
         USING IEDNLGB,R10        SET LGB ADDRESSABILITY       @Y17XAUU 50020000
         L     R5,TOTRESPL        RESIDENT CONTROL BLOCK ADDR  @Y17XAUU 50028000
         USING RESPL,R5           SET RESPL ADDRESSABILITY     @Y17XAUU 50036000
         L     R5,RESTOTMH        GET TOTE MH ADDRESS          @Y17XAUU 50044000
         STCM  R5,ADRMSK7,LGBMHA  SET MH ADDRESS IN LGB        @Y17XAUU 50052000
         LA    R5,MAXRUSIZ        SET MAXIMUM RU SIZE          @YM08523 50054000
         CLM   R5,ADRMSK3,LGBBUFSI IS RU SIZE GT BUF SIZE      @YM09025 50054600
         BNH   DUMHJ2             NO - BRANCH                  @YM09025 50055200
         STCM  R5,ADRMSK3,LGBBUFSI IN COUNTERFEIT              @YM08410 50056000
         DROP  R5                                              @Y17XAUU 50060000
         DROP  R10                                             @Y17XAUU 50068000
DUMHJ2   EQU   *                                               @Y17XAUU 50076000
         L     R5,KMQCB           RESTORE DUMMY M-QCB ADDRESS  @Y17XAUU 50084000
*                                                                       50200000
         USING IEDQQCB,R5                                               50300000
         BAL   R3,DUMQMGR         EVALUATE QUEUE METHOD                 50400000
         TM    TRMFLG01,TRMRNLU   LU ENTRY                     @Y17XAUU 50407000
         BO    DUMHJ4             YES - BYPASS HOLD            @Y17XAUU 50414000
         MVI   TOTOVBCD,HOLD      SET HOLD VERB CODE           @Y17XAUU 50421000
         MVC   TOTOLADR(D8),WORK1 SET RESOURCE NAME            @Y17XAUU 50428000
         MVC   TOTORLN(D1),QCBRELLN SET RLN                    @Y17XAUU 50435000
         BAL   R14,OPCREQ         ISSUE HOLD TERMINAL          @Y17XAUU 50442000
DUMHJ4   DS    0H                 RETURN AFTER BRANCH                   50450000
         TM    TRMFLG01,TRMDELY   QCB IN TIME DELAY QUEUE        S22024 50500000
         BZ    DUMHK              NO - CONTINUE                  S22024 50600000
         NI    QCBTSOF1,XFF-QCBDELAY YES - TURN IT OFF           S22024 50700000
DUMHK    EQU   *                                                 S22024 50800000
         XC    QCBMSGCT(D2),QCBMSGCT  CLEAR COUNT OF MSG IN QUEUE       50900000
         NI    QCBSTAT,XFF-QCBTRMHO  TURN OFF HOLD BIT IF ON            51000000
         L     R3,QCBSTVTO        GET STCB CHAIN ADDRESS                51100000
         LA    R3,D0(R3)          CLEAR HI-ORDER BYTE                   51200000
         LA    R4,D8(R7)          GET ADDRESS OF 3RD WORD               51300000
         CR    R3,R4              3RD WORD POINT TO SELF                51400000
         BE    DUMHM              YES - HM POINTER IS 4TH WORD          51500000
         ST    R3,QCBSTPRI        PUT HM IN 4TH WORD OF DUMMY           51600000
         MVC   QCBSTPRI(D1),D12(R7)  PUT FLAG BYTE IN DUMMY             51700000
DUMHM    EQU   *                                                        51800000
         LA    R3,QCBSTVTO        GET ADDR OF 3RD WORD IN DUMMY         51900000
         ST    R3,QCBSTVTO        PUT IT IN ITSELF                      52000000
         MVC   QCBSTVTO(D1),D8(R7) SET INDEX IN DUMMY QCB               52100000
         ST    R5,QCBSCBOF        PUT DUMMY QCB ADDR IN CHAIN           52200000
         MVC   QCBSCBOF(D1),X14(R7)  MOVE IN FLAG BYTE                  52300000
         NI    QCBFLAG,XFF-QCBSDFFO  TURN OFF CURRENTLY SENDING FEFO    52600000
*                                      FLAG                             52700000
         NI    QCBDSFLG,XFF-QCBHELD  TURN OFF HELD BIT                  52800000
         XC    QCBDATFL(D22),QCBDATFL CLEAR PQCB                        52900000
         SPACE                                                          53300000
DUMHR    EQU   *                                                        57200000
         L     R13,D4(R13)        CALLLER'S SAVE AREA ADDRESS           57300000
         LM    R14,R12,D12(R13)   CALLER'S REGISTERS                    57400000
         SR    R15,R15            CLEAR RETURN CODE REGISTER            57500000
         BR    R14                RETURN                                57600000
         SPACE 2                                                        57700000
DUMFAIL  EQU   *                                                        57800000
         SPACE                                                          58100000
         L     R13,D4(R13)        RESTORE CALLERS SAVE AREA ADDRESS     58300000
         LM    R14,R12,D12(R13)   RESTORE CALLER'S REG                  58400000
         LA    R15,ERRCD4         ERROR RETURN CODE                     58500000
         BR    R14                RETURN                                58600000
         SPACE                                                          58700000
         DROP  R11                                                      58800000
         EJECT                                                          58900000
DUMQMGR  EQU   *                                                        59000000
         STM   R10,R12,WORK4      SAVE CALLER'S REG                     59100000
         USING IEDQQCB,R5                                               59200000
*                                                                       59300000
         TM    TRMFLG01,TRMRNLU   LU ENTRY                     @Y17XAUU 59320000
         BNZ   DDD4               YES - BYPASS STATUS CHECK    @Y17XAUU 59340000
         TM    TRMRQFLG,CTREQ     CT REQUEST                   @Y17XAUU 59360000
         BO    DDD1               YES                          @Y17XAUU 59500000
         LA    R10,TOTAPDFL       AP INIT STATUS FLAGS                  59600000
         LA    R1,TOTAPOFF        @ AP COUNTERFEIT TTCIN       @YM08136 59650000
         B     DDD2               EXIT                                  59700000
DDD1     EQU   *                                                        59800000
         LA    R10,TOTCTDFL       CT INIT STATUS FLAGS                  59900000
         LA    R1,TOTCTOFF        @ CT COUNTERFEIT TTCIN       @YM08136 59950000
DDD2     EQU   *                                                        60000000
         TM    TRMFLG01,TRM3705   NCP PRE SNA ENTRY            @YM08136 60010000
         BZ    DDD20              NO - BYPASS ALT TTCIN SETUP  @YM08136 60020000
         OI    TOTOFLG,TOTOATC    USE ALTERNATE TTCIN          @YM08136 60030000
         MVC   TOTOALTT(D2),D0(R1) SET UP ALTERNATE TTCIN      @YM08136 60040000
DDD20    EQU   *                                               @YM08136 60050000
         TM    QCBSTAT,QCBTRMHO   TERMINAL INIT HELD ?                  60100000
         BZ    DDD3               NO                                    60200000
         OI    D0(R10),X40        SHOW INT STATE                        60300000
DDD3     EQU   *                                                        60400000
*        DETERMINE IF INVITATION LIST INIT. INACTIVE                    60600000
         LA    R1,TOTOTECB        GET ECB ADDR                          60700000
         STCM  R1,7,TOTOECBA+1    PUT IT IN P-LIST             @YM08136 60800000
         MVC   TOTORLN(D1),QCBRELLN  PUT IN RLN                @Y17XAUU 60880000
         MVI   TOTOVBCD,INACT     INACTIVATE VERB CODE         @Y17XAUU 60960000
         MVI   TOTOELNG,X18       SET ELEMENT LENGTH           @Y17XAUU 61000000
         XC    TOTOLINK(D3),TOTOLINK  CLEAR LINK FIELD         @Y17XAUU 61040000
         MVI   TOTOPRI,PRISSOLT   SET POST PRIORITY            @Y17XAUU 61120000
         XC    TOTOTECB(D4),TOTOTECB  CLEAR ECB                         61200000
         MVC   TOTOLADR(D8),WORK1 PUT IN TERMINAL NAME         @Y17XAUU 61300000
         LA    R1,TOTPLIST        ADDR OF ELEMENT                       61410000
         ST    R1,TRMSLPL         PUT IN PLIST                          61420000
         ST    R1,TRMSLPL+D4      PUT IN PLIST                          61430000
         MVI   TRMSLPL,RQINIT     SET INITIAL ELEMENT FLAG              61440000
         MVI   TRMSLPL+D4,RQEND   SET LAST ELEMENT FLAG                 61450000
         LA    R1,TRMSLPL         ADDR OF PLIST                         61460000
         AQCTL                    ISSUE ACTIVATE REQUEST                61500000
         WAIT  ECB=TOTOTECB                                             61600000
         CLI   TOTORTCD,INACTRC   INIT INACTIVE                         61700000
         BNE   DDD4               NO - INIT ACTIVE                      61800000
DDD3E    EQU   *                                                        61900000
         OI    D0(R10),TOTAPIAC   SHOW THAT LIST INACTIVE               62000000
DDD4     EQU   *                                                        62100000
         L     R9,TOTAVTPT        GET AVT ADDRESS              @Y17XAUU 62110000
         USING IEDQAVTD,R9                                              62200000
         TM    QCBDSFLG,QCBREUS   REUSABLE DISK ?                       62300000
         BZ    DUMQM1             NO                                    62400000
         MVC   QCBDNHDR(D3),AVTRADDR+D1  PUT R-DISK Q ADDR IN QCB       62500000
         L     R8,AVTRADDR        GET R-DISK Q ADDR                     62600000
         LA    R8,D4(R8)          INCREMENT BY FOUR                     62700000
         ST    R8,AVTRADDR        REPLACE IT                            62800000
         LM    R10,R12,WORK4      RESTORE REG.                          62900000
         BR    R3                 RETURN                                63000000
*                                                                       63100000
DUMQM1   EQU   *                                                        63200000
*                                                                       63300000
         TM    QCBDSFLG,QCBNREUS  NONREUSABLE DISK ?                    63400000
         BZ    D0(R3)             NO - RETURN                  @Y17XAUU 63500000
         MVC   QCBDNHDR(D3),AVTNADDR+D1  PUT NR-DISK Q ADDR IN QCB      63600000
         L     R8,AVTNADDR        GET NR-DISK ADDRESS                   63700000
         LA    R8,D4(R8)          INCREMENT BY FOUR                     63800000
         ST    R8,AVTNADDR        PUT IT BACK IN AVT                    63900000
         LM    R10,R12,WORK4      RESTORE REG                           64000000
         BR    R3                 RETURN                                64100000
         DROP  R9                                                       64200000
         DROP  R5                                                       64300000
         EJECT                                                          64400000
QWB2SAVE DS    18F                IEDQWB2 SAVW AREA                     65400000
TRMSLPL  DS    0F                 PARAMETER LIST FOR START/STOP LINE    66800000
         DC    X'0C'              START OF LIST INDICATOR               66900000
         DC    AL3(0)             ADDRESS OF REQUEST ELEMENT   @Y17XAUU 67000000
         DC    X'80'              END OF LIST INDICATOR                 67100000
         DC    AL3(0)             ADDRESS OF REQUEST ELEMENT   @Y17XAUU 67200000
OFFSTOTE DS    0F                 RESETS TRMSTOTE W/ C&S       @G36XRUV 67220010
         DC    XL1'FF'                                         @G36XRUV 67240010
         DC    AL1(255-TRMSTOTE)                               @G36XRUV 67260010
         DC    XL2'FFFF'                                       @G36XRUV 67280010
         SPACE                                                          67300000
WORK1    DC    8XL1'40'           PLACE FOR CT/AP/TD NAME      @Y17XAUU 69300000
WORK4    DS    3F                 WORK AREA                             69500000
DEVENT   DS    A                  DEVICE ENTRY ADDRESS         @Y17XAUU 69500500
DUMEXTA  DS    A                  DUMMY QCBE ADDRESS           @Y17XAUU 69501000
K1       DC    F'1'               VALUE OF 1                   @Y17XAUU 69504000
K4       DC    F'4'               VALUE OF 4                   @Y17XAUU 69505000
K12      DC    F'12'              VALUE OF 12                  @Y17XAUU 69506000
KEXT     DS    A                  TRUE QCBE ADDRESS            @Y17XAUU 69507000
DCTTETA  DS    A                  DUMMY CONC TERM TTE ADDRESS  @Y17XAUU 69510000
DKDRQ    DS    A                  DUMMY DRQ ADDRESS            @Y17XAUU 69511000
KCTTE    DS    A                  DUMMY CONC TTE ADDRESS       @Y17XAUU 69512000
KQCBESZ  DS    H                  QCBE SIZE                    @Y17XAUU 69513000
         SPACE                                                          69519000
DUMNAME  MVC   D0(D1,R3),D0(R7)   COPY TERMINAL NAME           @Y17XAUU 69520000
DUMTTE   MVC   D0(D1,R5),D0(R7)   COPY TTE                     @Y17XAUU 69521000
DUMQCB   MVC   D0(D1,R5),D0(R7)   COPY M-QCB                   @Y17XAUU 69522000
DUMDEV   TM    TRMDEVFL-IEDQTRM(R11),D0 TEST DEV DEP FIELDS    @Y17XAUU 69523000
DUMPQCB  MVC   D0(D1,R5),D0(R4)   COPY P-QCB                   @Y17XAUU 69524000
DUMCTTE  MVC   D0(D0,R5),D0(R7)   COPY CONC TTE                @Y17XAUU 69525000
DUMDRQ   MVC   D0(D0,R5),D0(R7)   COPY DRQ                     @Y17XAUU 69526000
CTTENAME MVC   D0(D0,R14),D0(R7)  SYMBOLIC NAME OF CONC        @Y17XAUU 69527000
         SPACE                                                          69528000
TNTNAME  MVC   WORK1(D0),D0(R7)   COPY TERMINAL NAME                    72650000
LGBMOVE  MVC   D0(D0,R10),D0(R8)  COPY LGB                     @Y17XAUU 72660000
         DC    20F'0'                   TEMP PATCH AREA                 72670058
         EJECT                                                          72700000
KTRM     DSECT                                                          72800000
TERNMTAB DS    A                  TERMNAME TABLE ADDRESS                72900000
TNTENTRY DS    A                  TERMNAME ENTRY ADDRESS                73000000
TRMQCB   DS    A                  CT/AP QCB ADDRESS                     73100000
TRMTNT   DS    A                  CT/AP TNT ADDRESS                     73200000
TRMSAVE1 DS    3F                 REGISTERS SAVE AREA                   73300000
TRMSAVE2 DS    5F                 REGISTERS SAVE AREA                   73400000
TRMSAV1  DS    3F                 REGISTERS SAVE AREA                   73500000
REGSAVE  DS    F                  WORK AREA                             73600000
F32      DC    F'32'              VALUE OF 32                           74000000
KPQCB    DS    A                  TRUE P-QCB ADDRESS           @Y17XAUU 74100000
KMQCB    DS    A                  DUMMY M-QCB ADDRESS          @Y17XAUU 74200000
CONCTTE  DS    A                  TRUE CONC TERM TTE ADDRESS   @Y17XAUU 74300000
KDRQ     DS    A                  TRUE DRQ ADDRESS             @Y17XAUU 74400000
KPQCBSZ  DS    H                  P-QCB SIZE                   @Y17XAUU 74500000
KMQCBSZ  DS    H                  M-QCB SIZE                   @Y17XAUU 74600000
KDRQSZ   DS    H                  DRQ SIZE                     @Y17XAUU 74700000
TTETSZ   DS    CL1                CONC TERM TTE SIZE           @Y17XAUU 74800000
TTECSZ   DS    CL1                CONC TTE SIZE                @Y17XAUU 74900000
TRMRQFLG DS    CL1                DUMMY TNT REQUEST FLAG                75500000
CTREQ    EQU   X'80'              CT REQUEST                   @Y17XAUU 75600000
APREQ    EQU   X'40'              AP REQUEST                   @Y17XAUU 75630000
PRREQ    EQU   X'20'              PRIMARY TD REQUEST           @Y17XAUU 75660000
SCREQ    EQU   X'10'              SECONDARY TD REQUEST         @Y17XAUU 75690000
ALRDY    EQU   X'00'              COUNTERFEIT STORAGE ALREADY  @Y17XAUU 75720000
*                                 EXIST FOR THIS REQUEST       @Y17XAUU 75750000
TRMFLG01 DS    CL1                CONTROL FLAG                          75800000
CONC     EQU   X'80'              TERMINAL ATTACHED TO CONC             75900000
TRMSPAS  EQU   X'40'              PROCESS CONC TTE                      76000000
TRMQWB3  EQU   X'20'              SECOND PASS FUNCTION                  76100000
TRMRNLU  EQU   X'10'              SNA LU ENTRY                 @Y17XAUU 76150000
TRMDELY  EQU   X'08'              QCB IN TIME DELAY QUEUE               76200000
TRM3705  EQU   X'04'              3705 MODE                             76250000
TRMCTEAP EQU   X'02'              CT EQU AP                             76270000
WRKFLG   DS    CL1                WORK AREA                             76300000
KTRMEND  DS    0C                 END OF KTRM DSECT            @Y17XAUU 76330000
************************************************************** @Y17XAUU 76360000
         EJECT                                                          77600000
         TLGBD                                                   S22024 77700000
         EJECT                                                          77800000
         TQCBED                                                         77900000
         EJECT                                                          78000000
         TDRQD                                                          78100000
         EJECT                                                          78200000
         EJECT                                                          78300000
         TPRIOR                                                         78400000
         EJECT                                                          78500000
         TQCBD                                                          78600000
         EJECT                                                          78700000
DCBDSECT DCBD  DSORG=TX                                                 78800000
         EJECT                                                          78900000
         TSCBD                                                          79000000
         EJECT                                                          79100000
         TPRFD                                                          79200000
         EJECT                                                          79300000
         TLCBD                                                          79400000
         EJECT                                                          79500000
CVT      DSECT                                                          79600000
         CVT                                                            79700000
         EJECT                                                          79800000
UCB      DSECT                                                          79900000
         IEFUCBOB                                                       80000000
         EJECT                                                          80100000
         TAVTD                                                          80200000
         EJECT                                                          80300000
         TTRMD                                                          80400000
         EJECT                                                          80500000
         TDEBD                                                          80600000
         EJECT                                                          80700000
         TTNTD                                                          80800000
         EJECT                                                          80900000
         OLTCB                                                          81000000
         EJECT                                                          81007000
RQTNTERR EQU   X'FF'              ERROR RETURN CODE            @Y17XAUU 81014000
RQTNTENT DSECT                                                 @Y17XAUU 81021000
RQTNTFGS DS    BL1                TNT REQUEST FLAGS            @Y17XAUU 81028000
RQTNTLST EQU   X'80'              LAST ENTRY FLAG              @Y17XAUU 81035000
RQTNTTYP DS    BL1                TNT REQ ENTRY TYPE FIELD     @Y17XAUU 81042000
RQTNTCT  EQU   X'80'              CONTROL TERMINAL ENTRY       @Y17XAUU 81049000
RQTNTAP  EQU   X'40'              ALTERNATE PRINTER ENTRY      @Y17XAUU 81056000
RQTNTPR  EQU   X'20'              PRIMARY TEST DEVICE ENTRY    @Y17XAUU 81063000
RQTNTSC  EQU   X'10'              SECONDARY TEST DEVICE ENTRY  @Y17XAUU 81070000
RQTYPANY EQU   RQTNTCT+RQTNTAP+RQTNTPR+RQTNTSC ANY ENTRY FLAG  @Y17XAUU 81077000
RQTNTLNT DS    H                  TNT REQUEST BLOCK LENGTH     @Y17XAUU 81084000
RQTENLEN EQU   4                  TNT REQUEST ELEMENT LENGTH   @Y17XAUU 81091000
         EJECT                                                          81400000
RESPL    RESPL                                                          81500000
         EJECT                                                          81530000
         TSIBD                                                 @Y17XAUU 81560000
         END                                                            81700000
./  ADD  SSI=73110085,NAME=IEDQWC
         TITLE 'IEDQWC TRM ANALYSIS MODULE 1'                           00070000
IEDQWC   CSECT                                                          00140000
*A000000-999999                                                @Y16X5U0 00150000
* CHANGE ACTIVITY AS FOLLOWS:                                           00210000
*C840880                                                         S21903 00280000
*D834100-834600,836860-836880                                   SA51078 00350000
*C836820-836840                                                 SA51078 00420000
*A837000                                                        SA41597 00490000
*C836100                                                        SA41597 00560000
*D837440-837520                                                 SA41597 00630000
*A088860,813600                                                 SA41607 00700000
*A440600                                                        SA41606 00770000
*C824000                                                        SA41611 00840000
*D104200-104400,358560-363560                                   SA41614 00910000
*A151400-151600,580380,580425-580620,580780-581400              SA61759 00930000
*C477800                                                       @SA70654 00930156
*A147200-147400,379470-379960,394300-394500,408850-409450        S05331 00936000
*A410900-411200,690240-690800,766520-767020                      S05331 00942000
*C645400                                                         S05331 00950000
*A233100,409150,891600,466200,467600,469000,477400,581300      @Y17XAUU 00955000
*A597100,617400,646100,654500,657300,666400,690280,703500      @Y17XAUU 00960000
*A707000,710500,713300,723800                                  @Y17XAUU 00965000
*C166600                                                       @Y17XAUU 00970000
*D184100,795200-796600,798000-807100,816200-822500             @Y17XAUU 00975000
* A073500,237300,285900,402500,439600,770700,766640,766720     @G36XRUV 00976000
* C073500,237300,285900,403200,439600,766660,766740            @G36XRUV 00977000
*A321300                                                       @OZ27338 00977182
*C329000-329700                                                @OZ27338 00977282
*                                                                       00978000
         SPACE 2                                                        00980000
         USING IEDQWC,R15                                               01050000
IEDQWC   IEDHJN STARC,HJN                                               01120000
         SPACE 2                                                        01190000
****************************************************************        01260000
*                                                              *        01330000
* MODULE NAME = IEDQWC (TCAM,TOTE)                             @Y17XAUU 01540000
*                                                              *        01610000
* DESCRIPTIVE NAME = TRM ANALYSIS MODULE 1                     *        01680000
*                                                              *        01750000
* COPYRIGHT = NONE                                             *        01820000
*                                                              *        01890000
* STATUS --                                                    *        01960000
*                                                              *        02030000
*    VERSION 10.0                                              @Y17XAUU 02100000
*                                                              *        02170000
* FUNCTIONS --                                                 *        02240000
*                                                              *        02310000
*    THE PURPOSE OF THIS MODULE IS TO ANALYZE TRM'S AND TURN   *        02380000
*    OVER CONTROL TO THE APPROPRIATE MODULE FOR FURTHER        *        02450000
*    PROCESSING.                                               *        02520000
*                                                              *        02590000
*    THE TRM IS OBTAINED FROM THE OLTCB CONTROL BLOCK.         @Y17XAUU 02660000
*                                                              *        02800000
*    THE CONTROL TERMINAL ENTRY OF THE TRM IS ANALYZED. IF     *        02870000
*    THERE IS AN ERROR IN THE CONTROL TERMINAL ENTRY, THE      *        02940000
*    SOURCE IS NOTIFIED OF THE ERROR CONDITION AND THE         @Y17XAUU 02950000
*    SYSTEM OPERATOR IS INFORMED THAT A TRM WAS RECEIVED BUT   *        03010000
*    IGNORED BECAUSE OF AN ERROR. IF AN ERROR IS DETECTED IN   *        03080000
*    THE AP OPTION ON THE OPTION FIELD, AN ERROR BIT IS SET    *        03150000
*    FOR IEDQWC2 TO INTERROGATE. CONTROL IS THEN PASSED TO THE *        03220000
*    NEXT TRM ANALYSIS MODULE, IEDQWC1.                        *        03290000
*                                                              *        03360000
*    IF THE CONTROL TERMINAL OR ALTERNATE PRINTER IS A REMOTE  *        03430000
*    TERMINAL, A DUMMY QCB AND TTE IS SET UP FOR EACH. IF      *        03500000
*    ENOUGH IS UNAVAILABLE FOR THE ENTRIES, THE SYSTEM OPERATOR*        03570000
*    AND THE SOURCE ARE NOTIFIED AND THE TRM REJECTED.         @Y17XAUU 03640000
*                                                              *        03710000
*    IF ENTRY IS FROM A NUMERIC ONLY DEVICE, THE CONTROL       *        03780000
*    FIELD IS SET UP. THE CONTROL TERMINAL DEFAULTS TO THE     *        03850000
*    REQUEST TERMINAL. CONTROL IS PASSED TO THE NUMERIC TRM    *        03920000
*    ANALYSIS MODULE TO READ IN THE REMAINDED OF THE TRM.      *        03990000
*    UPON RETURN TO IEDQWC, THE TRM THAT WAS BUILT IS ANALYZED *        04060000
*    NORMALLY BY IEDQWC.                                       *        04130000
*                                                              *        04200000
*    THE OPTION FIELD OF THE TRM IS CHECKED FOR THE AP OPTION. *        04690000
*    IF THE AP OPTION IS SPECIFIED, THIS MODULE VERIFIES THE   *        04760000
*    NAME OF THE ALTERNATE PRINTER TO BE SYSCON, SYSOUT, OR A  *        04830000
*    VALID OPERAND TCAM TERMINAL.                              *        04900000
*                                                              *        04970000
* ENTRY POINTS --                                              *        05040000
*                                                              *        05110000
*    IEDQWC                                                    @Y17XAUU 05180000
*                                                              *        05460000
* LINKAGE -- XCTL'ED FROM IEDQWB1                              @Y17XAUU 05460100
*                                                              @Y17XAUU 05460200
* MACROS -- AQCTL                                              @Y17XAUU 05460300
*           DEQ                                                @Y17XAUU 05460400
*           ENQ                                                @Y17XAUU 05460500
*           IEDHJN                                             @Y17XAUU 05460600
*           IEDQMSG                                            @Y17XAUU 05460700
*           LINK                                               @Y17XAUU 05460800
*           POST                                               @Y17XAUU 05460900
*           SAVE                                               @Y17XAUU 05461000
*           WAIT                                               @Y17XAUU 05461100
*           WTO                                                @Y17XAUU 05461200
*           XCTL                                               @Y17XAUU 05461300
*                                                              @Y17XAUU 05461400
* PURPOSE -- SEE FUNCTION                                      @Y17XAUU 05461500
*                                                              @Y17XAUU 05461600
* MODULE SIZE -- 4K MAXIMUM                                    @Y17XAUU 05461700
*                                                              @Y17XAUU 05461800
* MODULE TYPE -- PROCEDURE                                     @Y17XAUU 05461900
*                                                              @Y17XAUU 05462000
* PROCESSOR -- ASSEMBLER XF                                    @Y17XAUU 05462100
*                                                              @Y17XAUU 05462200
* INPUT --                                                     *        05530000
*                                                              *        05600000
*    REGISTER 02,13,14,15 CONTAIN THE FOLLOWING VALUES:        *        05670000
*                                                              *        05740000
*    02 - OLTCB POINTER                                        *        05810000
*    13 - SAVE AREA ADDRESS                                    *        05880000
*    14 - RETURN ADDRESS                                       *        05950000
*    15 - ENTRY POINT ADDRESS                                  *        06020000
*                                                              *        06090000
* OUTPUT --                                                    *        06160000
*                                                              *        06230000
*    NONE                                                      *        06300000
*                                                              *        06370000
* EXTERNAL REFERENCES --                                       *        06440000
*                                                              *        06510000
*    IEDQWB - RESOURCE MANAGER                                 *        06580000
*    AVTUI  - TCAM BINARY SEARCH ROUTINE                       *        06650000
*    IEDQCA - TCAM OPERATOR CONTROL MODULE                     *        06720000
*    IEDQWK - TOTE MESSAGE MODULE                              *        06790000
*                                                              *        06860000
* EXITS,NORMAL --                                              *        06930000
*                                                              *        07000000
*    XCTL TO IEDQWB1 ON CONFIGURATOR,PROMPT AND NORMAL TRM     @G36XRUV 07350000
*    REQUESTS.                                                 @G36XRUV 07360000
*    XCTL TO IEDQWH WHEN TRM IS ENTERED FROM NUMERIC-ONLY      @G36XRUV 07370000
*    DEVICES.                                                  @G36XRUV 07380000
*    XCTL TO IEDQWF1 ON DEALLOCATION REQUESTS.                 @G36XRUV 07390000
*                                                              *        07420000
* EXITS,ERROR --                                               *        07490000
*    XCTL TO IEDQWB1 (AP ERROR)                                @Y17XAUU 07492000
*    XCTL TO IEDQWE (CT ERROR)                                          07494000
*    RETURN TO IEDQWA (CT ERROR)                               @Y17XAUU 07496000
*                                                              *        07560000
* TABLES/WORK AREA --                                          *        07910000
*                                                              *        07980000
*    CVT,AVT,TERMNAME TABLE,TERMINAL TABLE,OLTCB,LCB,DCB,SCB,  *        08050000
*    TCB,IEDQWC WORK AREA,DEB                                  *        08120000
*                                                              *        08190000
* ATTRIBUTES -- --                                             *        08260000
*                                                              *        08330000
*    ENABLED, PROBLEM PROGRAM MODE, TRANSIENT                  *        08400000
*                                                              *        08470000
* NOTE --                                                      *        08540000
*                                                              *        08610000
*  DEPENDENCIES -- EBCDIC CHARACTER CODE                       @Y17XAUU 08611000
*                                                              @Y17XAUU 08612000
*  RESTRICTIONS -- NONE                                        @Y17XAUU 08613000
*                                                              @Y17XAUU 08614000
*  REGISTER CONVENTIONS -- SEE REGISTER ASSIGNMENT             @Y17XAUU 08615000
*                                                              @Y17XAUU 08616000
*  PATCH LABEL -- PATCH                                                 08617000
*                                                              *        08750000
****************************************************************        08820000
         EJECT                                                          08890000
*********************************************************************** 08960000
*                                                                     * 09030000
*        EQUATES                                                      * 09100000
*                                                                     * 09170000
*********************************************************************** 09240000
         SPACE 2                                                        09310000
R0       EQU   0                  REG 0                                 09380000
R1       EQU   1                  REG 1                                 09450000
R2       EQU   2                  OLTCB POINTER/SCT POINTER             09520000
R3       EQU   3                  REG 3                                 09590000
R4       EQU   4                  REG 4                                 09660000
R5       EQU   5                  REG 5                                 09730000
R6       EQU   6                  BASE REG                              09800000
R7       EQU   7                  REG 7                                 09870000
R8       EQU   8                  REG 8                                 09940000
R9       EQU   9                  REG 9                                 10010000
R10      EQU   10                 REG 10                                10080000
R11      EQU   11                 REG 11                                10150000
R12      EQU   12                 REG 12                                10220000
R13      EQU   13                 SAVE AREA POINTER                     10290000
R14      EQU   14                 RETURN ADDR                           10360000
R15      EQU   15                 ENTRY POINT ADDR                      10430000
         SPACE 2                                                        10500000
XFF      EQU   X'FF'              MASK SETTING                          10570000
XF0      EQU   X'F0'              LCB MASK FOR ANR LOCAL                10640000
ANR      EQU   X'1E'              REQ TERM = ANR LO                     10710000
ACTVBCD  EQU   X'46'              OP CONTROL ACTIVATE CMMD              10780000
ACTRTCD  EQU   X'08'              INVITATION LIST ACTIVE RT CD          10850000
HELDN    EQU   X'04'              HOLD MODE                     SA41607 10920000
D0       EQU   0                  DISP OF 0                             10990000
D1       EQU   1                  DISP OF 1                             11060000
D2       EQU   2                  DISP OF 2                             11130000
D3       EQU   3                  DISP OF 3                             11200000
D4       EQU   4                  DISP OF 4                             11270000
D5       EQU   5                  DISP OF 5                             11340000
D6       EQU   6                  DISP OF 6                             11410000
D7       EQU   7                  DISP OF 7                             11480000
D8       EQU   8                  DISP OF 8                             11550000
D9       EQU   9                  DISP OF 9                             11620000
D10      EQU   10                 DISP OF 10                            11690000
D11      EQU   11                 DISP OF 11                            11760000
D12      EQU   12                 DISP OF 12                            11830000
D13      EQU   13                 DISP OF 13                            11900000
D14      EQU   14                 DISP OF 14                            11970000
D15      EQU   15                 DISP OF 15                            12040000
D16      EQU   16                 DISP OF 16                            12110000
D20      EQU   20                 DISP OF 20                            12180000
D22      EQU   22                 DISP OF 22                            12250000
D24      EQU   24                 DISP OF 24                            12320000
D28      EQU   28                 DISP OF 28                            12390000
D32      EQU   32                 DISP OF 32                            12460000
ACVT     EQU   16                 POINTER TO CVT ADDRESS                12530000
PRETERM  EQU   X'52'              DISP TO 1ST ENTRY IN TABLE            12600000
TRMAX    EQU   72                 TRM BUFFER LENGTH                     12670000
SLASH    EQU   X'61'              A / CHAR                              12740000
COMMA    EQU   X'6B'              A , CHAR                              12810000
D17      EQU   17                 DISP OF 17                            12880000
D18      EQU   18                 DISP OF 18                            12950000
D19      EQU   25                 DISP OF 25                     S22024 13020000
DCBNIDLE EQU   X'02'              3705 ACTIVE                    S22024 13090000
X40      EQU   X'40'              A BLANK CHAR                          13160000
RNTERM   EQU   X'E0'              RN TERMINAL (IF OFF)           S22024 13230000
XE0      EQU   X'E0'              QCB MASK SETTING                      13300000
RNLINE   EQU   X'80'              RN LINE CHECK                  S22024 13370000
TCAMDEB  EQU   X'44'              DEB BELONGS TO TCAM FLAG       S22024 13440000
DEFLEV   EQU   X'03'              DPRINT DEFAULT LEVEL                  13510000
PARMREG0 EQU   0                  REG 0                                 13580000
PARMREG1 EQU   1                  REG 1                                 13650000
RQINIT   EQU   X'0C'              START OF LIST                  S22024 13670000
RQEND    EQU   X'80'              END OF LIST                    S22024 13690000
D72      EQU   72                 LENGTH OF TRM BUFFER                  13720000
XBLANK   EQU   X'61'              A SLASH CHAR                          13790000
TWO      EQU   2                  DISP OF TWO                           13860000
FOUR     EQU   4                  DISP OF FOUR                          13930000
TRMSCCT  EQU   X'10'              SECONDARY SYSTEM CONSOLE ENTRY ?      14000000
PROMPTFL EQU   X'01'              PROMPTER RQ FLAG                      14070000
XFO      EQU   X'F0'              NUMERIC TESTER                        14140000
X52      EQU   X'52'              1060 CT FLAG                          14210000
X18      EQU   X'18'              DISP OF 24                            14280000
X24      EQU   X'24'              DISP OF 36                            14350000
X1C      EQU   X'1C'              DISP OF 28                            14420000
X10      EQU   X'10'              DCB OPEN FLAG                         14490000
X80      EQU   X'80'              LAST DUMMY ENTRY RQ FLAG              14560000
X14      EQU   X'14'              DISP OF 20                            14630000
X07      EQU   X'07'              LINE STOPPED FLAG                     14700000
DEQFLG   EQU   X'01'              DEQ REQUEST FLAG               S05331 14720000
ENQFLG   EQU   X'83'              ENQ REQUEST FLAG               S05331 14740000
HOLD     EQU   X'88'              'HOLD' OPERATOR CONTROL VERB CODE     14770000
UCB1060  EQU   X'52'              UCB SETTING FOR 1060 TERMINAL         14840000
ZERO     EQU   X'00'              CONSTANT VALUE                        14910000
CONFIGFL EQU   X'02'              INDICATES CONFIGURATOR REQUEST        14980000
TRMMAX   EQU   256                MAXIMUM LENGTH OF TRM                 15050000
LGBA     EQU   X'80'              LGB MAP                        S22024 15120000
X60      EQU   X'60'              MASK FIELD                    SA61759 15140000
TSONLY   EQU   X'40'              TSO ONLY SYSTEM CHECK         SA61759 15160000
         EJECT                                                          15190000
*********************************************************************** 15260000
*                                                                     * 15330000
*        PERFORM INITIALIZATION                                       * 15400000
*                                                                     * 15470000
*********************************************************************** 15540000
         SPACE 1                                                        15610000
         SPACE 2                                                        15680000
         SAVE  (14,12)                                                  15750000
         SPACE                                                          15820000
         DROP  R15                                                      15890000
         LR    R6,R15                   LOAD BASE                       15960000
         USING TOTOLTCB,R2                                              16030000
         USING IEDQWC,R6                                                16100000
         LA    R3,TOTSAVE4        GET MY SAVE AREA ADDR                 16170000
         ST    R3,D8(R13)         STORE IN CALLER'S SAVE AREA           16240000
         ST    R13,D4(R3)         SAVE MY SAVE AREA ADDR                16310000
         ST    R13,TOTRESSV       SAVE MOTHER TASK SAVE AREA ADDR       16380000
         LR    R13,R3                   SET R13 TO SAVE AREA            16450000
         SPACE 2                                                        16520000
         L     R10,TOTAVTPT       GET AVT ADDR                          16590000
         USING IEDQAVTD,R10                                    @Y17XAUU 16660000
         OI    $OLTFLGS,$RETCODE  SHOW RETURN CODE FTN SUPPORTED S22024 16900000
TRM000   EQU   *                                                        16940000
*                                                                       17010000
*        SAVE PARAMETER PASSED BY IEDQWB1                               17080000
*                                                                       17150000
         STH   R1,TRMSRCE         INDEX TO TERMNAME TABLE               17220000
         SRL   R1,D24             ADJUST TO GET FLAG BYTE               17290000
         STC   R1,NUMFLG          SAVE NUMERIC ENTRY FLAG BYTE          17360000
         SPACE                                                          17430000
         MVC   TRMWRK(D72),TOTTRMBF MOVE TRM TO WORK AREA               17500000
         SPACE                                                          17570000
         TM    NUMFLG,NUMEN       NUMERIC ENTRY                         17640000
         BO    TRMNUH             YES PROCESS                           17710000
         SPACE                                                          17780000
TRMCHK6  EQU   *                                                        17850000
         LA    R4,TRMWRK          PICK UP WORK AREA ADDRESS             17920000
         L     R3,AVTRNMPT        PICK UP ADDRESS OF TERMNAME TABLE     18480000
         ST    R3,TERNMTAB        SAVE IT                               18550000
         B     TRMCHK8            GO CONTINUE TRM PROCESSING            18620000
         SPACE                                                          18690000
         EJECT                                                          18760000
*********************************************************************** 18830000
*                                                                     * 18900000
*        PRE-PROCESSOR FOR NUMERIC ENTRY                              * 18970000
*                                                                     * 19040000
*********************************************************************** 19110000
         SPACE 2                                                        19180000
TRMNUH   EQU   *                                                        19250000
         SR    R4,R4              CLEAR REG 4                           19320000
         IC    R4,TOTTTBEL        GET MAX. NAME LENGTH                  19390000
         LA    R4,D3(R4)          ADJUST FOR ONE ENTRY                  19460000
         LH    R3,TRMSRCE         GET RELATIVE POS. OF TERM IN TT       19530000
         BCTR  R3,R0              DECREMENT BY 1                        19600000
         STH   R3,TRMSRCE         SAVE IT                               19670000
         MH    R4,TRMSRCE         GET DISP TO ENTRY                     19740000
         L     R5,AVTRNMPT        GET ADDR OF TERMNAME TABLE            19880000
         LA    R5,PRETERM(R5)     POINT PASS PREFIX                     19950000
         AR    R4,R5              POINT TO SYMBOLIC NAME OF RQ TER.     20020000
         SR    R5,R5              CLEAR REG 5                           20090000
         IC    R5,TOTTTBEL        GET MAX. NAME LENGTH                  20160000
         BCTR  R5,R0              DECREMENT BY ONE                      20230000
         EX    R5,EXMSYM          MOVE NAME TO WORK AREA                20300000
TRMNUH1  EQU   *                                                        20370000
         LA    R1,WORK1           POINT NAME                            20440000
         MVC   TOTCTNAM(D8),WORK1 SAVE CT NAME IN OLTCB                 20510000
         MVI   TOTCTNAM+D8,XBLANK SHOW END                              20580000
         LA    R10,D0             INIT COUNTER                          20650000
         SR    R3,R3              CLEAR REG 3                           20720000
         IC    R3,TOTTTBEL        GET MAX. NAME LENGTH                  20790000
         LA    R3,D1(R3)          INCREMENT BY 1                        20860000
TRMNUH3  EQU   *                                                        20930000
         CLI   D0(R1),X40         END OF NAME                           21000000
         BE    TRMNUH7            YES                                   21070000
         BCT   R3,TRMNUH5         SET UP TO CHECK NEXT CHAR             21140000
         B     TRMNUH7            BRANCH TO PUT NAME LENGTH INTO        21210000
*                                   PARAMETER LIST                      21280000
TRMNUH5  EQU   *                                                        21350000
         LA    R1,D1(R1)          POINT TO NEXT CHAR                    21420000
         LA    R10,D1(R10)        INCREMENT NAME COUNTER                21490000
         B     TRMNUH3            CHECK NEXT CHAR                       21560000
TRMNUH7  EQU   *                                                        21630000
         STC   R10,LENGTH         PUT NAME LENGTH IN P - LIST           21700000
         LA    R5,TRMWRK          POINT TO TRM                          21770000
         OI    TOTFLG09,TOTPRECT  SET CT EQUALS PRINTER FLAG            21840000
         B     TRMCK14A           EXIT TO VERIFY NAME                   21910000
EXMSYM   MVC   WORK1(D0),D0(R4)   MOVE RQ TERMINAL TO WORK AREA         21980000
         DROP  R10                                                      22050000
         EJECT                                                          22260000
*********************************************************************** 22330000
*                                                                     * 22400000
*        CONTINUE NORMAL TRM PROCESSING                               * 22470000
*                                                                     * 22540000
*********************************************************************** 22610000
         SPACE 1                                                        22680000
         SPACE 2                                                        22750000
TRMCHK8  EQU   *                                                        22820000
         LA    R5,TRMWRK          POINT TO TRM                          22890000
         OI    TOTFLG09,TOTPRECT  SET C.T. EQUALS PRINTER FLAG          22960000
TRMCHK11 EQU   *                                                        23030000
         MVC   WORK1(D9),D0(R5)   MOVE CONTROL TERM TO WORK AREA        23100000
         CLC   WORK1(D7),SYSCONL  CONTROL TERM. EQU SYSTEM CON          23170000
         BNE   TRM11A             NO, BRANCH                            23240000
         OI    TOTFLG09,TOTCTCON+TOTPRECT  TURN ON CONT TERM FLAG       23310000
         LA    R10,D7(R5)         POINT TO TEST DEVICE FIELD   @Y17XAUU 23310100
         LA    R3,TRMMAX          GET MAX TRM LENGTH ALLOWED   @Y17XAUU 23310200
TOTE1    DS    0H                 FIND END OF TEST DEV FIELD   @Y17XAUU 23310300
         CLI   D0(R10),SLASH      END REACHED                  @Y17XAUU 23310400
         BE    TOTE11             YES                          @Y17XAUU 23310500
         LA    R10,D1(R10)        BUMP TO NEXT FIELD           @Y17XAUU 23310600
         BCT   R3,TOTE1           CONTINUE SEARCH              @Y17XAUU 23310700
         B     TRMCK85            NO SLASH EQU ERROR           @Y17XAUU 23310800
TOTE11   DS    0H                 CHECK FOR DEALLOCATION REQ   @Y17XAUU 23310900
         CLC   D0(D7,R10),TOTE    DEALLOCATION TRM             @Y17XAUU 23311000
         BNE   TRMCK85            NO - CONTINUE                @Y17XAUU 23311100
         C     R3,TRMMAX          TEST DEVICE FIELD OMITTED    @Y17XAUU 23311200
         BE    TRMCK85            YES - ERROR                  @Y17XAUU 23311300
         L     R13,D4(R13)        RESTORE                      @Y17XAUU 23311400
         LM    R14,R0,D12(R13)    REGISTERS                    @Y17XAUU 23311500
         XCTL  (2,12),EP=IEDQWF1  PROCESS DEALLOCATION REQUEST @Y17XAUU 23311600
TRMCK85  DS    0H                                              @Y17XAUU 23311700
         LA    R10,D6             SET COUNTER REG FOR SYSCON            23380000
         MVC   WORK1+D6(D2),BLANK PAD WORK1 WITH BLANKS                 23450000
         LA    R5,D1(R5,R10)      BUMP POINTER TO NEXT FIELD            23520000
         B     TRM045             BRANCH                                23590000
TRM11CA  EQU   *                                                        23660000
         L     R3,TOTFLG01        WORD CONTAINING TOTCONFG     @G36XRUV 23730000
CSLOOP1  DS    0H                                              @G36XRUV 23740000
         LR    R4,R3              COPY                         @G36XRUV 23750000
         O     R4,SETCONFG        SET CONFIG BIT IN REG        @G36XRUV 23760000
         CS    R3,R4,TOTFLG01     SET TOTCONFG                 @G36XRUV 23770000
         BNZ   CSLOOP1            BR IF BYTE HAS CHANGED       @G36XRUV 23780000
****************************************************************        23800000
*        EXIT TO IEDQWB1 TO CHECK FOR DEVICE PROTECT FEATURE   *        23870000
*        AND SEND ON LINE TESTING ACTIVE MESSAGE               *        23940000
****************************************************************        24010000
TRMEND   EQU   *                                                        24080000
         TM    TOTFLG01,TOTCONFG+TOTPRMPT PROMPT OR CONFIG       S22024 24150000
         NI    TOTFLG04,XFF-TOTNUMDV CLEAR NUMERIC ENTRY FLAG   SA41614 24220000
         BNZ   TRMEND1            YES - ONE IS SET               S22024 24290000
         OI    TOTFLG02,TOTOLTRQ  SHOW ON-LINE TEST REQUEST      S22024 24360000
TRMEND1  EQU   *                                                 S22024 24430000
         L     R13,D4(R13)        PICK UP CALLERS SAVE AREA ADDRESS     24500000
         LM    R14,R0,D12(R13)    RESTORE REGS                          24570000
         XCTL  (2,12),EP=IEDQWB1  CONTINUE TRM PROCESSING               24640000
TRM11A   EQU   *                                                        24710000
         LA    R1,WORK1           FIND LENGTH OF CONTROL TERMINAL       24780000
         LA    R10,D0               IF IT IS LESS                       24850000
         LA    R3,D9                THAN 8 CHARACTERS                   24920000
TRMCHK12 EQU   *                                                        24990000
         CLI   D0(R1),SLASH       END OF FIELD?                         25060000
         BE    TRMCHK14                 YES BRANCH                      25130000
         BCT   R3,TRMCHK13              GREATER THAN 8?                 25200000
         B     TRMERROR                 YES GO TO ERROR ROUTINE         25270000
TRMCHK13 EQU   *                                                        25340000
         LA    R1,D1(R1)          NO BUMP POINTER                       25410000
         LA    R10,D1(R10)        BUMP COUNTER                          25480000
         B     TRMCHK12                 GO LOOK AGAIN                   25550000
TRMCHK14 EQU   *                                                        25620000
         STC   R10,LENGTH         SAVE LENGTH                           25690000
         LA    R9,D8              SET UP TO PAD WORK1 WITH BLANKS       25760000
         CR    R10,R9                  ALREADY 8 CHARS                  25830000
         BE    TRMCK14A           YES                                   25900000
         SR    R9,R10                  GET NUMBER OF POSITIONS TO FILL  25970000
         LA    R1,WORK1                GET WORK1 ADDRESS                26040000
         BCTR  R9,D0              DECREMENT FOR MOVE                    26110000
         AR    R1,R10                  POINT PAST NAME                  26180000
         EX    R9,BLMOVE               MOVE IN BLANKS                   26250000
TRMCK14A EQU   *                                                        26320000
         MVC   RNAME(D8),WORK1    MOVE CT NAME TO ENQ LIST              26390000
         BAL   R9,NAMESRCH              GO COMPARE                      26460000
         B     TRMFIND                  TERM NAME FOUND                 26530000
         B     TRMERROR                 NO BRANCH TO ERROR ROUTINE      26600000
BLMOVE   MVC   D0(D0,R1),BLANK    GENERAL BLANK MOVE                    26670000
TRMFIND  EQU   *                                                        26740000
         MVC   TOTCROFF(D2),TRMTTCIN SAVE CT REAL TTCIN        @Y17XAUU 26770000
         MVC   WORK3(D8),WORK1    SAVE CONTROL TERMINAL NAME            26810000
         MVC   TRMCTSAV(D8),WORK1 SAVE IT AGAIN                         26880000
         MVI   TRMRQFLG,CTREQ     SHOW C.T.REQUEST             @Y17XAUU 26950000
         SPACE                                                          27020000
         BAL   R9,DEVCHK          VERIFY CTL TERMINAL EQU DEVICE S22024 27090000
         MVC   TOTCRTNT(D4),TRMTNT SAVE REAL CT TNT ADDR         S22024 27160000
         BAL   R9,UCBFIND         GO FIND UCB ADDR               S22024 27230000
*                                                                S22024 27300000
*        ERROR RETURN IS D0(R9); GOOD RETURN IS TO D4(R9)        S22024 27370000
*                                                                S22024 27440000
         B     NOOPEN             ERROR EXIT                     S22024 27510000
         STH   R8,TOTCTUCB        CT UCB ADDR TO OLTCB           S22024 27580000
         SPACE                                                          27650000
         BAL   R9,DUMMYTNT        REQUEST DUMMY TNT                     27720000
         MVC   TRMNAME(D8),WORK1  MOVE FOR READ COMPARE                 27790000
         BAL   R9,LCBSCAN         FIND CT LCB ADDRESS                   27860000
         ST    R11,TOTCTLCB-D1    PUT LCB ADDRESS IN OLTCB              27930000
         MVC   TOTCTRLN(D1),TRMRLN  PUT RLN OF CT IN OLTCB              28000000
         LA    R5,D1(R10,R5)      POINT TO NEXT FIELD            S22024 28070000
TRM045   EQU   *                                                        28140000
         CLC   D0(D9,R5),PROMPT   PROMPT REQUEST?                       28210000
         BE    TRM050             YES                            S22024 28280000
         CLC   D0(D9,R5),CONFIG   IS CONFIG REQUESTED?                  28350000
         BNE   TRM11E                    NO                             28420000
         OI    SSFLG,CONFIGFL     YES, SET CONFIG INDICATOR             28490000
         B     TRM15Y                      AND BRANCH                   28560000
TRM050   DS    0H                 BOUNDARY ALLIGNMENT            S22024 28570000
         OI    SSFLG,PROMPTFL     SHOW PROMPT REQUEST            S22024 28580000
         L     R7,TOTFLG01        CONTAINS TOTPRMPT            @G36XRUV 28590000
CSLOOP2  DS    0H                                              @G36XRUV 28591000
         LR    R8,R7              COPY                         @G36XRUV 28592000
         O     R8,SETPRMPT        SET PROMPT FLAG IN REG       @G36XRUV 28593000
         CS    R7,R8,TOTFLG01     SET TOTPRMPT                 @G36XRUV 28594000
         BNZ   CSLOOP2            BR OF BYTE HAS CHANGED       @G36XRUV 28595000
         B     TRM15Y             ENQUEUE CT                     S22024 28600000
         EJECT                                                          28630000
*********************************************************************** 28700000
*                                                                     * 28770000
*        ROUTINE TO EVALUATE ALTERNATE PRINTER OPTION                 * 28840000
*                                                                     * 28910000
*********************************************************************** 28980000
         SPACE 1                                                        29050000
TRM11E   EQU   *                                                        29120000
         TM    NUMFLG,NUMEN       NUMERIC ENTRY ?                       29190000
         BO    TRM15Y             YES                                   29260000
TRM12    EQU   *                                                        29330000
         CLI   D0(R5),X40         BLANK CHAR                    SA41606 29400000
         BNE   TRM12A             NO                            SA41606 29470000
         OI    TOTFLG03,TOTTDFER  SET TEST DEV ERROR FLAG       SA41606 29540000
         B     TRMPROMT           GO TO PROMPTER                SA41606 29610000
TRM12A   EQU   *                                                SA41606 29680000
         CLC   D0(D2,R5),SLASH2   TWO SLASHES ?                         29750000
         BNE   TRM14              NO                                    29820000
TRM12D   DS    0H                 BOUNDARY ALLIGNMENT            S22024 29850000
         OI    TOTFLG03,TOTTDFER  SET TEST DEVICE ERROR FLAG            29890000
         B     TRMPROMT           GO TO PROMPTER                        29960000
TRM14    EQU   *                                                        30030000
         LR    R1,R5              SET UP TO FIND OPTIONS FIELD          30100000
         LA    R3,TRMMAX          SET TRM LENGTH MAXIMUM                30170000
         LA    R10,D2             SET COUNTER TO 2                      30240000
TRM15B   EQU   *                                                        30310000
         CLI   D0(R1),SLASH       END OF FIELD?                         30380000
         BE    TRM15A             YES, BRANCH                           30450000
         LA    R1,D1(R1)          BUMP POINTER                          30520000
         BCT   R3,TRM15B          GO EXAMINE NEXT BYTE                  30590000
         CL    R10,F2             ERROR IN TD FIELD              S22024 30660000
         BE    TRM12D             YES - EXIT                     S22024 30670000
         OI    TOTFLG03,TOTTSTER  ASSUME ERROR IN TEST FIELD     S22024 30680000
         B     TRMPROMT           GO TO PROMPTER                 S22024 30690000
TRM15A   EQU   *                                                        30730000
         LA    R1,D1(R1)          BUMP POINTER                          30800000
         BCT   R10,TRM15B         LOOK FOR END OF NEXT FIELD            30870000
TRM15E   EQU   *                                                        30940000
         CLI   D0(R1),SLASH       END OF OPTION FIELD?                  31010000
         BE    TRM15Y             YES - EXIT                            31080000
TRM15EA  EQU   *                                                        31150000
         CLC   D0(D3,R1),NAP      NAP OPTION SPECIFIED?                 31220000
         BNE   TRM15EB            NO, CHECK FOR AP                      31290000
         NI    $ERROPT,XFF-$ALTPRNT  TURN OFF AP OPTION                 31360000
         OI    TOTFLG09,TOTPRECT  SET NO ALTERNATE PRINTER FLAG         31430000
         LA    R1,D2(R1)          POINT PAST NA                         31500000
         B     TRM15F             GO CHECK NEXT FIELD                   31570000
TRM15EB  EQU   *                                                        31640000
         CLC   D0(D2,R1),AP       AP OPTION?                            31710000
         BNE   TRM15F             NO                                    31780000
         OI    $ERROPT,$ALTPRNT    SET AP OPTION                        31850000
         NI    TOTFLG09,XFF-TOTPRECT TURN OFF NO ALT PRNT FLAG          31920000
         B     TRM15D             BRANCH TO GET NEXT OPTION             31990000
TRM15F   EQU   *                                                        32060000
         LA    R1,D1(R1)          BUMP POINTER                          32130000
         BCT   R3,TRM15FB               LOOP IF NOT AT END     @OZ27338 32150082
         B     APCOM                    TRM TOO LONG           @OZ27338 32170082
TRM15FB  EQU   *                                                        32200000
         CLI   D0(R1),COMMA       OPTION DELIMITER ?                    32270000
         BE    TRM15FA                 YES BRANCH                       32340000
         CLI   D0(R1),SLASH       END OF FIELD ?                        32410000
         BNE   TRM15F             NO                                    32480000
         TM    $ERROPT,$ALTPRNT   HAS A TERMINAL BEEN ENTERED FOR AP?   32550000
         BZ    TRM15Y             NO                                    32620000
         B     TRM15H1            YES                                   32690000
TRM15FA  EQU   *                                                        32760000
         LA    R1,D1(R1)          BUMP POINTER PAST COMMA               32830000
         BCT   R3,TRM15EA               GO LOOK AT NEXT OPTION @OZ27338 32900082
         B     APCOM              OPTION ERROR                          33040000
TRM15D   EQU   *                                                        33110000
         LA    R1,D2(R1)          POINT PAST AP                         33180000
         LA    R10,D0             SET UP LENGTH COUNTER                 33250000
         LR    R4,R1              SAVE R1                               33320000
         LA    R3,D9              SET ERROR COUNTER                     33390000
TRM15G   EQU   *                                                        33460000
         CLI   D0(R1),COMMA       END OF AP OPTION ?                    33530000
         BE    TRM15H                  YES BRANCH                       33600000
         CLI   D0(R1),SLASH       END OF FIELD ?                        33670000
         BE    TRM15H                  YES BRANCH                       33740000
         LA    R10,D1(R10)        BUMP COUNTER BY 1                     33810000
         LA    R1,D1(R1)          BUMP POINTER                          33880000
         BCT   R3,TRM15G          LOOP UNTIL END OF AP FIELD            33950000
         B     APCOM              A.P. NAME TOO LONG                    34020000
APMOVE   MVC   WORK1(D0),D0(R4)   GENERAL MOVE                          34090000
TRM15H   EQU   *                                                        34160000
         LTR   R10,R10            IS NAME FIELD PRESENT?                34230000
         BZ    APCOM                NO: GO TO PROMPTER                  34300000
         STC   R10,LENGTH         SAVE LENGTH OF OPTION                 34370000
         BCTR  R10,D0             DECREMENT COUNTER                     34440000
         MVC   WORK1(D8),BLANK    FILL BUFFER WITH BLANKS               34510000
         EX    R10,APMOVE               MOVE NAME TO WORK AREA          34580000
         CLI   D0(R1),SLASH       END OF OPTION FIELD ?                 34650000
         BE    TRM15H1            YES                                   34720000
         B     TRM15FB            NO                                    34790000
TRM15H1  EQU   *                                                        34860000
         CLC   WORK1(D6),SYSCON   SYSTEM CONSOLE ?                      34930000
         BNE   TRM15H2                   NO                             35000000
         OI    TOTFLG09,TOTAPCON  SET ALT PRINTER EQU SYSCON   @YM0     35030000
         OI    TOTFLG09,TOTPRECT  ASSUME PRINTER EQU CT                 35070000
         TM    TOTFLG09,TOTCTCON  CT EQU SYSTEM CONSOLE ?               35140000
         BO    TRM15Y                    YES                            35210000
         NI    TOTFLG09,XFF-TOTPRECT CLEAR PRINTER EQU CT FLAG          35280000
         B    TRM15Y                  YES BRANCH                        35420000
TRM15H2  EQU   *                                                        35490000
         CLC   WORK1(D6),SYSOUT   SYSTEM OUTPUT DEVICE ?                35560000
         BNE   TRM15HA                   NO                             35630000
         NI    TOTFLG09,XFF-TOTPRECT CLEAR PRINTER EQU CT FLAG          35700000
         OI    TOTFLG09,TOTAPOUT  SET PRINTER EQU SYSOUT                35770000
         B     TRM15Y                  YES BRANCH                       35840000
TRM15HA  EQU   *                                                        35910000
         MVC   RNAME(D8),WORK1    MOVE AP NAME TO ENQ LIST              35980000
         MVC   TOTAPNAM(D8),WORK1 MOVE AP NAME TO OLTCB                 36050000
         BAL   R9,NAMESRCH             GO FIND ENTRY IN TERMNAME TABLE  36120000
         B     TRM15I                  BRANCH AROUND ERROR RETURN       36190000
         B     APCOM              ERROR                                 36260000
TRM15I   EQU   *                                                        36330000
         MVC   TOTAROFF(D2),TRMTTCIN SAVE AP REAL TTCIN        @Y17XAUU 36360000
         MVI   TRMRQFLG,APREQ     SHOW A.P. REQUEST            @Y17XAUU 36400000
         BAL   R9,DEVCHK          VERIFY AP EQU A TERMINAL       S22024 36470000
         MVC   TOTARTNT(D4),TRMTNT SAVE REAL AP TNT ADDR         S22024 36540000
         BAL   R9,UCBFIND         GO FIND UCB ADDR               S22024 36610000
         B     APNOER             ERROR EXIT                     S22024 36680000
         STH   R8,TOTAPUCB        AP UCB ADDR TO OLTCB           S22024 36750000
         BAL   R9,DUMMYTNT        REQUEST DUMMY TNT                     36820000
         TM    TRMFLG01,TRMCTEAP  CT EQU AP                      S22024 36890000
         BZ    TRM15I2            NO - PROCESS AP                S22024 36960000
         OI    TOTFLG09,TOTPRECT  SET CT EQU AP FLAG             S22024 37030000
         B     TRM15Y             BYPASS AP SETUP                S22024 37100000
TRM15I2  EQU   *                                                 S22024 37170000
         MVC   TRMNAME(D8),WORK1  MOVE FOR READ COMPARE                 37240000
         BAL   R9,LCBSCAN         GET AP LCB ADDR                       37310000
         ST    R11,TOTAPLCB-D1    PUT IT IN OLTCB                       37380000
         MVC   TOTAPRLN(D1),TRMRLN PUT RLN FOR AP IN OLTCB       S22024 37450000
         USING UCB,R8                                                   37520000
TRMAPENQ EQU   *                                                        37590000
         ENQ   ,MF=(E,ENQLIST)         REQUEST RESOURCE                 37660000
         LTR   R15,R15                 WAS IT ASSIGNED                  37730000
         BZ    TRM15I4                   YES                            37800000
         CLI   D3(R15),D8         WAS IT ALREADY ASSIGNED?              37870000
         BE    TRM15I4                   YES                            37940000
         TM    RNAME,XF0          ENQ FAIL ON UCB NAME           S05331 37947000
         BNO   TRMAPX             NO - BYPASS TERMINAL NAME DEQ  S05331 37954000
*        DEQ AP TERMINAL NAME                                    S05331 37961000
         MVI   ENQLIST+D2,DEQFLG  SET DEQ FLAG                   S05331 37968000
         MVC   RNAME(D8),TOTAPNAM AP NAME TO PLIST               S05331 37975000
         XC    TOTAPNAM(D8),TOTAPNAM CLEAR AP NAME FIELD         S05331 37982000
         DEQ   ,MF=(E,ENQLIST)    DEQ AP NAME                    S05331 37989000
TRMAPX   DS    0H                 BOUNDARY ALLIGNMENT            S05331 37996000
         WTO   'IED128I ALTERNATE PRINTER REQUESTED BY OLT ALREADY IN U*38010000
               SE',ROUTCDE=10,DESC=7                                    38080000
         B     APCOM              SHOW AP ERROR                         38150000
TRM15I4  EQU   *                                                        38220000
         TM    RNAME,XFO          HAS UCBNAME BEEN ENQ?                 38290000
         BO    TRM15I4A           YES - EXIT                            38360000
         MVC   RNAME(D8),BLANK    BLANK AP NAME FIELD            S22024 38430000
         MVC   RNAME(D3),UCBNAME  MOVE AP UCBNAME TO ENQ LIST           38500000
         B     TRMAPENQ           GO REQUEST RESOURCE                   38570000
TRM15I4A EQU   *                                                        38640000
         NI    TRMFLG04,XFF-CTRSID CLEAR CT FLAG                 S22024 38710000
         OI    TRMFLG04,APRSID    SHOW AP REQUEST                S22024 38780000
         BAL   R9,RNLINET         CHECK FOR RN TERM FOR L ENQ    S22024 38850000
         SPACE                                                          38920000
         SPACE                                                          38990000
         SPACE                                                          39060000
         OI    TOTFLG09,TOTPRECT  SET PRINTER EQU CT                    39130000
         CLC   TRMCTSAV(D8),TOTAPNAM CT = AP ?                          39200000
         BE    TRM15Y             YES                            S22024 39270000
         NI    TOTFLG09,XFF-TOTPRECT NO - SET                           39340000
         OI    TOTFLG09,TOTAPTRM  SET PRINTER EQU TERMINAL FLAG         39410000
         EJECT                                                          39480000
*********************************************************************** 39550000
*                                                                     * 39620000
*        FIND IF TRM WAS ENTERED FROM CONTROL TERMINAL                * 39690000
*                                                                     * 39760000
*********************************************************************** 39830000
         SPACE 1                                                        39900000
TRM15Y   EQU   *                                                        39970000
         TM    TOTFLG04,TOTNUMDV  RETURN FROM NUMERIC HANDLER ?         40040000
         BO    TRM080             YES                                   40110000
         TM    TOTFLG09,TOTCTCON  CT EQU SYSTEM CONSOLE ?               40180000
         BO    TRM080             YES - BRANCH                   S22024 40250000
         SLR   R8,R8              CLEAR                        @G36XRUV 40280000
         ICM   R8,3,TOTCTUCB      GET CT UCB ADDR              @G36XRUV 40320000
         USING UCB,R8                                                   40390000
         MVC   RNAME(D8),WORK3    GET CT NAME                           40460000
TRMCTENQ EQU   *                                                        40530000
         ENQ   ,MF=(E,ENQLIST)         REQUEST USE OF RESOURCE          40600000
         LTR   R15,R15                 WAS IT ASSIGNED?                 40670000
         BZ    TRM15Y4                   YES                            40740000
         CLI   D3(R15),D8         WAS IT PREVIOUSLY ASSIGNED?           40810000
         BE    TRM15Y4                   YES                            40880000
         L     R11,TOTCRTNT       CT TNT ADDR                    S05331 40885000
         SR    R7,R7              CLEAR REG                      S05331 40890000
         IC    R7,TOTTTBEL        MAXIMUM NAME LENGTH            S05331 40895000
         AR    R11,R7             POINT TO TTE ADDR              S05331 40900000
         MVC   TNTENTRY+D1(D3),D0(R11) CT TTE ADDR               S05331 40905000
         L     R7,TNTENTRY        CT TTE ADDR                    S05331 40910000
         USING IEDNTRM,R7                                        S05331 40915000
         LA    R1,TRMPRFSZ        TTE PREFIX SIZE              @Y17XAUU 40915200
         SLR   R7,R1              GET ADDRESS OF TTE PREFIX    @Y17XAUU 40915400
         TM    TRMSTATE,TRMPREF   3705 MODE                    @Y17XAUU 40915600
         BZ    TRMCTX             NO                             S05331 40930000
         OI    TOTCTFLG,TOTCTORN  CT ON 3705                     S05331 40935000
         DROP  R7                                                S05331 40940000
TRMCTX   DS    0H                 BOUNDARY ALLIGNMENT            S05331 40945000
         WTO   'IED133I C.T. REQUESTED BY OLT ASSIGNED TO ANOTHER OLT',*40950000
               ROUTCDE=10,DESC=7                                        41020000
         TM    TOTFLG05,TOTSRCON  TRM ENTERED FROM SYSCON      @Y17XAUU 41022000
         BO    TRMCTXE            YES - EXIT                   @Y17XAUU 41024000
         IEDQMSG MSGID=053,FUNCT=SRC    WRITE MSG TO SOURCE    @Y17XAUU 41026000
TRMCTXE  DS    0H                                              @Y17XAUU 41028000
         OI    TOTFLG06,TOTOTERM  SET TERMINATE FLAG             S05331 41090000
         L     R13,D4(R13)        CALLER'S SAVE AREA             S05331 41100000
         LM    R14,R1,D12(R13)    RESTORE REG 14-1               S05331 41110000
         XCTL  (2,12),EP=IEDQWE2  TERMINATE TRM                  S05331 41120000
TRM15Y4  EQU   *                                                        41160000
         TM    RNAME,XFO          HAS UCBNAME BEEN ENQ?                 41230000
         BO    TRM15Y4A           YES - EXIT                            41300000
         MVI   RNAME,X40          BLANK RNAME                           41370000
         MVC   RNAME+D1(D7),RNAME   FIELD                               41440000
         MVC   RNAME(D3),UCBNAME  MOVE CT UCBNAME TO ENQ LIST           41510000
         B     TRMCTENQ           GO REQUEST RESOURCE                   41580000
TRM15Y4A EQU   *                                                        41650000
         NI    TRMFLG04,XFF-APRSID CLEAR AP FLAG                 S22024 41720000
         OI    TRMFLG04,CTRSID    SHOW CT REQUEST                S22024 41790000
         L     R11,TOTCRTNT       CT TNT ADDR                    S22024 41860000
         SR    R7,R7              CLEAR REG                      S22024 41930000
         IC    R7,TOTTTBEL        MAX NAME LENGTH                S22024 42000000
         AR    R11,R7             POINT TO TTE ADDR              S22024 42070000
         MVC   TNTENTRY+D1(D3),D0(R11) CT TTE ADDR               S22024 42140000
         L     R7,TNTENTRY        TTE ADDR                       S22024 42210000
         USING IEDQTRM,R7                                        S22024 42280000
         L     R7,TRMDESTQ-D1     CT QCB ADDR                    S22024 42350000
         LA    R7,D0(R7)          CLEAR FLAG BYTE                S22024 42420000
         ST    R7,TRMQCB          SAVE IT                        S22024 42490000
         DROP  R7                                                S22024 42560000
         BAL   R9,RNLINET         CHECK FOR RN TERM FOR L ENQ    S22024 42630000
         TM    TOTFLG09,TOTCTCON  CONTROL TERM = SYSCON ?               42700000
         BO    TRM080             YES                                   42770000
         MVC   WORK1(D3),UCBNAME  MOVE LINE ADDRESS TO WORK AREA        42840000
         DROP  R8                                                       42910000
         BAL   R9,CTSTOP          VERIFY UCB NAME                       42980000
TRM080   EQU   *                                                        43610000
         TM    SSFLG,PROMPTFL+CONFIGFL PROMPT OR CONFIG REQUESTED       43680000
         BZ    TRM090                    NO                             43750000
         TM    TOTFLG09,TOTCTCON  CT EQU SYSTEM CONSOLE                 43820000
         BO    TRM090                    YES                            43890000
         SLR   R8,R8              CLEAR                        @G36XRUV 43960000
         ICM   R8,3,TOTCTUCB      GET CONTROL TERM UCB ADDR    @G36XRUV 43990000
         USING UCB,R8                                                   44030000
         CLI   UCBTBYT1,X52       1060?                                 44100000
         DROP  R8                                                       44170000
         BNE   TRM090                    NO                             44240000
         IEDQMSG MSGID=097,FUNCT=CEC,LINK=YES                           44310000
TRM085   EQU   *                                                 S22024 44380000
         OI    TOTFLG06,TOTOTERM  SET TERMINATE FLAG                    44450000
         L     R13,D4(R13)        GET CALLER'S SAVE AREA ADDR           44520000
         LM    R14,R1,D12(R13)    RESTORE REGISTERS 14-1                44590000
         XCTL  (2,12),EP=IEDQWE   TERMINATE TRM                         44660000
TRM090   EQU   *                                                        44730000
         OI    TOTFLG05,TOTNDMSG  TURN ON ENDED MESSAGE FLAG            44800000
         TM    SSFLG,PROMPTFL     RETURN TO PROMPT LOAD?                44870000
         BO    TRMPT                   YES BRANCH                       44940000
         TM    SSFLG,CONFIGFL     RETURN TO CONFIG LOAD?                45010000
         BO    TRM11CA                 YES BRANCH                       45080000
         TM    NUMFLG,NUMEN       NUMERIC ENTRY ?                       45150000
         BO    TRM091             YES                                   45220000
         B     TRMEND             EXIT TO IEDQWB1                       45290000
TRM091   EQU   *                                                        45360000
         OI    TOTFLG04,TOTNUMDV  SET NUMERIC ENTRY FLAG        SA41614 45430000
         L     R13,D4(R13)        RESTORE SAVE REG              SA41614 45500000
         LM    R14,R1,D12(R13)    RESTORE REG 14-1              SA41614 45570000
         XCTL  (2,12),EP=IEDQWB1  EXIT TO IEDQWB1               SA41614 45640000
         EJECT                                                          45710000
         OI    TOTFLG05,TOTNDMSG  SET FLAG TO SEND TERMINATE FLAG       45780000
         SPACE                                                          45850000
**************************************************************** S22024 45920000
*                                                              * S22024 45990000
*        ROUTINE TO VERIFY THAT THE SYMBOLIC NAME ENTERED      * S22024 46060000
*        AS THE CONTROL TERMINAL OR ALTERNATE PRINTER IS A     * S22024 46130000
*        DEVICE AS OPPOSED TO A SUB CHANNEL HUNG OFF THE       * S22024 46200000
*        RN.                                                   * S22024 46270000
*                                                              * S22024 46340000
**************************************************************** S22024 46410000
DEVCHK   EQU   *                                                 S22024 46480000
         STM   R7,R11,TRMSAVE2    SAVE REGISTERS 7-11            S22024 46550000
         L     R11,TNTENTRY       GET TTE ADDR                   S22024 46620000
         LA    R7,TRMPRFSZ        TTE PREFIX SIZE              @Y17XAUU 46626000
         SLR   R11,R7             GET ADDRESS OF TTE PREFIX    @Y17XAUU 46632000
         USING IEDNTRM,R11                                       S22024 46760000
         TM    TRMSTATE,TRMPROC   VERIFY NOT PROCESS ENTRY     @Y17XAUU 46762000
         BO    DEVCHKE            BR IF YES                    @Y17XAUU 46764000
         TM    TRMSTATE,TRMPREF   3705 MODE                    @Y17XAUU 46766000
         BZ    DEVCHKE            NO - RETURN                    S22024 46900000
         CLI   TRMTYPE,TRMPUNT    PU ENTRY                     @Y17XAUU 46901000
         BE    DEVCHK8            YES - ERROR                  @Y17XAUU 46902000
         CLI   TRMTYPE,TRMLNCP    NCP ENTRY                    @Y17XAUU 46903000
         BE    DEVCHK8            YES - ERROR                  @Y17XAUU 46904000
         CLI   TRMTYPE,TRMSSCP    SSCP ENTRY                   @Y17XAUU 46905000
         BE    DEVCHK8            YES - ERROR                  @Y17XAUU 46906000
         TM    TRMSTATE,RNTERM    TERMINAL ATTACHED TO RN        S22024 46970000
         BZ    DEVCHKE            YES                            S22024 47040000
*                                                              * S22024 47110000
*        AN INVALID ENTRY HAS BEEN MADE IN THE AP/CT FIELD.    * S22024 47180000
*        IF CT ERROR NOTIFY SYSTEM OPERATOR VIA A 'WTO'.       * S22024 47250000
*        IF AP ERROR SET ERROR FLAG AND CONTINUE PROCESSING.   * S22024 47320000
*                                                              * S22024 47390000
DEVCHK8  DS    0H                 BOUNDARY ALLIGNMENT            S22024 47420000
         CLI   TRMRQFLG,CTREQ     CONTROL TERMINAL ERROR       @Y17XAUU 47460000
         BNE   APCOM              NO - ASSUME AP ERROR           S22024 47530000
         B     TRMERROR           TERMINATE REQUEST              S22024 47600000
         SPACE                                                          47670000
DEVCHKE  EQU   *                                                 S22024 47740000
         TM    TRMSTATE,TRMPREF   3705 MODE                    @Y17XAUU 47742000
         BO    DEVCHKED           YES - BYPASS CHECK             S22024 47760000
         TM    TRMSTATE,XE0       TERMINAL ENTRY                 S22024 47770000
         BZ    DEVCHKED                 YES, VALID TERMINAL    @SA70654 47780056
         MVC   WRKFLG(D1),TRMSTATE      GET FLAG BYTE          @SA70654 47782056
         NI    WRKFLG,XE0               CLEAR UNWANTED FLAGS   @SA70654 47784056
         CLI   WRKFLG,RNLINE            270X DIAL TERMINAL     @SA70654 47786056
         BZ    DEVCHK8                  NO, ERROR              @SA70654 47788056
DEVCHKED DS    0H                 BOUNDARY ALLIGNMENT            22     47790000
         LM    R7,R11,TRMSAVE2    RESTORE REGISTERS              S22024 47810000
         BR    R9                 RETURN                         S22024 47880000
         DROP  R11                                               S22024 47950000
         SPACE 3                                                        48020000
APCOM    EQU   *                                                        48090000
         OI    TOTFLG03,TOTAPOER  YES - SHOW OPTION ERROR               48160000
         B     TRMPROMT           GO TO PROMPTER                 S22024 48230000
         SPACE                                                          48300000
APNOER   EQU   *                                                        49630000
         TM    TRMFLG01,TRMINACV  3705 INACTIVE                  S22024 49700000
         BO    APNOER4            YES                            S22024 49770000
         OI    TOTFLG03,TOTAPOER  SHOW AP OPTION ERROR                  49840000
         NI    $ERROPT,XFF-$ALTPRNT CLEAR AP OPTION FLAG                49910000
         IEDQMSG MSGID=004,FUNCT=CEC  AP LINE NOT OPENED                49980000
         B     TRMPROMT           GOT TO PROMPTER                S22024 50050000
         SPACE                                                          50120000
APNOER4  EQU   *                                                 S22024 50190000
         OI    TOTFLG03,TOTAPOER  SHOW AP ERROR                  S22024 50260000
         OI    TOTFLG09,TOTPRECT  CT EQU AP                      S22024 50330000
         IEDQMSG MSGID=010,FUNCT=CEC 3705 INACTIVE MSG           S22024 50400000
         B     TRMPROMT           GO TO PROMPTER                 S22024 50470000
         EJECT                                                          50540000
TRMERROR EQU   *                                                        50610000
         WTO   'IED127I OLT REQUEST REJECTED, CONTROL TERMINAL UNIDENTI*50680000
               FIED',ROUTCDE=10,DESC=7                                  50750000
         TM    TOTFLG05,TOTSRCON  TRM ENTERED FROM SYSCON      @Y17XAUU 50752000
         BO    TRMERR2            YES - EXIT                   @Y17XAUU 50754000
         IEDQMSG MSGID=077,FUNCT=SRC    WRITE MSG TO SOURCE    @Y17XAUU 50756000
TRMERR2  EQU   *                                                        50820000
         NI    TOTFLG06,XFF-TOTOTERM  CLEAR SECTION RESTART FLAG        50890000
         OI    TOTFLG06,TOTOTERM  SET TERMINATE FLAG                    50960000
         L     R13,D4(R13)        PICK UP CALLERS SAVE AREA ADDRESS     51030000
         LM    R14,R12,D12(R13)   RESTORE CALLER'S REGISTERS            51100000
         SR    R15,R15            CLEAR RETURN CODE REG                 51170000
         BR    R14                RETURN TO MOTHER                      51240000
TRMPROMT EQU   *                                                        51310000
         OI    SSFLG,PROMPTFL     TURN ON PROMPT FLAG                   51380000
         B     TRM15Y             GO SEE IF I HAVE TO ENQUEUE           51450000
TRMPT    EQU   *                                                        51520000
         B     TRMEND             EXIT TO IEDQWB1                       51660000
*                                                                       51730000
         SPACE 2                                                        51800000
         SPACE                                                          51870000
         EJECT                                                          51940000
CTSTOP   EQU   *                                                        52010000
*                                                                       52080000
*        R8    HAS UCB ADDR IN IT                                       52150000
*                                                                       52220000
         ST    R11,REGSAVE        SAVE REGISTER 11                      52290000
         L     R1,TOTAVTPT        GET AVT ADDR                          52360000
         USING IEDQAVTD,R1                                              52430000
         L     R1,AVTTCB               GET ADDR OF TCB                  52500000
         DROP  R1                                                       52570000
         L     R1,D8(R1)          GET DEB CHAIN ADDRESS                 52640000
AGAIN    EQU   *                                                        52710000
         SR    R3,R3              CLEAR REGISTER 3                      52780000
         IC    R3,D16(R1)         GET NUMBER OF EXTENTS                 52850000
         LA    R5,D32(R1)         GET UCB CHAIN ADDRESS                 52920000
         L     R4,X18(R1)         GET DCB ADDRESS                       52990000
         MVC   MULT+D3(D1),X24(R4)  GET LCB LENGTH                      53060000
         L     R12,D4(R1)         GET NEXT DEB                          53130000
         USING IHADCB,R4                                                53200000
         TM    DCBDSORG+D1,TCAMDEB TCAM DEB                      S22024 53270000
         BZ    HERE1              NO, BRANCH                            53340000
         DROP  R4                                                       53410000
         LA    R7,D1              SET UP COUNTER                        53480000
HERE     EQU   *                                                        53550000
         L     R10,D0(R5)         GET UCB ADDRESS                       53620000
         LA    R10,D0(R10)          FROM CHAIN                          53690000
         LA    R8,D0(R8)          GET UCB ADDRESS THAT WAS PASSED       53760000
*                                   TO THE SUBROUTINE                   53830000
         CR    R8,R10             UCB ADDRESSES MATCH?                  53900000
         BE    THERE              YES, BRANCH                           53970000
         LA    R5,D4(R5)          GET NEXT UCB ADDRESS                  54040000
         LA    R7,D1(R7)          BUMP LINE COUNTER                     54110000
         BCT   R3,HERE            CHECK NEXT UCB ADDR                   54180000
HERE1    EQU   *                                                        54250000
         LR    R1,R12                  SET R1 TO NEXT DEB               54320000
         B     AGAIN              EVALUATE NEXT DEB EXTENT              54390000
THERE    EQU   *                                                        54460000
         LR    R11,R7                   SET UP MULTIPLICAND             54600000
         SR    R10,R10            CLEAR REGISTER 10                     54670000
         M     R10,MULT                 MULT BY LINE NO.                54740000
         L     R7,X1C(R4)         PICK UP IOB ADDRESS                   54810000
         L     R11,REGSAVE             RESTORE R11                      54880000
         BR    R9                      RETURN                           54950000
         EJECT                                                          55020000
**************************************************************** S22024 55090000
*                                                              * S22024 55160000
*        ROUTINE TO SEARCH TERMINAL NAME TABLE TO VERIFY THAT  * S22024 55230000
*        SYMBOLIC ENTRY FOR CONTROL TERMINAL OR ALTERNATE      * S22024 55300000
*        PRINTER IS VALID.                                     * S22024 55370000
*                                                              * S22024 55440000
**************************************************************** S22024 55510000
*                                                                       55580000
NAMESRCH EQU   *                                                        55650000
         SPACE                                                          55720000
         L     R14,TOTAVTPT       GET AVT ADDR                          55790000
         USING IEDQAVTD,R14                                             55860000
         L     R15,AVTRNMPT       GET ADDRESS OF TERMNAME TABLE         55930000
         ST    R15,TERNMTAB       SAVE IT                               56000000
         MVC   PAREMLST(D1),AVTBSX  GET OFFSET TO BINARY SEARCH ADDRESS 56070000
         L     R15,AVTMSGS-D1     VCON TABLE ADDRESS                    56140000
         L     R15,D8(R15)        LOAD ADDRESS OF A1 ROUTINE            56210000
         DROP  R14                                                      56280000
         LA    R1,PAREMLST              SET R1                          56350000
         LH    R0,TWO(R1)         LOAD CHAR STRING LEN                  56420000
         L     R1,FOUR(R1)        LOAD ADDR OF CHARS                    56490000
         BAL   R14,FOUR(R15)      BRANCH TO SCAN ROUTINE                56560000
         LTR   R15,R15            WAS NAME FOUND IN TABLE?              56630000
         BZ    D4(R9)             NAME NOT FOUND - ERROR                56700000
         SPACE                                                          56770000
         STM   R7,R9,TRMSAV1      SAVE REG 7-9                          56840000
         L     R8,TERNMTAB        SET START OF TABLE                    56910000
         USING IEDQTNTD,R8                                              56980000
         LA    R7,TNTFIRST        POINT TO FIRST ENTRY IN TABLE         57050000
         SR    R9,R9              CLEAR REG 9                           57120000
         IC    R9,TNTENLEN        GET MAX. LENGTH OF NAME FIELD         57190000
         LA    R9,D3(R9)          GET LENGTH OF 1 ENTRY                 57260000
         DROP  R8                                                       57330000
         BCTR  R15,D0             DECREMENT ENTRY REL. POSITION         57400000
         MR    R8,R15             GET DISPLACEMENT TO ENTRY DESIRED     57470000
         AR    R7,R9              GET DESIRED TNT ADDRESS               57540000
         ST    R7,TRMTNT          SAVE IT                               57610000
         LA    R1,D1(R15)         RESTORE ENTRY REL. POSITION           57680000
         STH   R1,TRMTTCIN        SAVE TTCIN                   @Y17XAUU 57690000
         LM    R7,R9,TRMSAV1      RESTORE REG 7-9                       57750000
         SPACE                                                          57820000
         L     R15,TERNMTAB       GET ADDRESS OF TERMNAME TABLE         57890000
         BALR  R14,R15            GO FIND TTE ADDRESS                   57960000
         ST    R1,TNTENTRY        SAVE TERMINAL ENTRY ADDRESS           58030000
         USING IEDQTRM,R1                                       SA61759 58038000
         TM    TRMDSORG,TRMLGB    LGB RATHER THAN A TTE          S22024 58040000
         BO    D4(R9)             YES - ERROR - NOT A TERMINAL   S22024 58042000
         L     R14,TOTAVTPT       GET AVT ADDRESS               SA61759 58042500
         USING IEDQAVTD,R14                                     SA61759 58043000
         MVC   WRKFLG(D1),AVTBIT1 GET ENVIRONMENTAL FLAG        SA61759 58043500
         NI    WRKFLG,X60         CLEAR UNWANTED BITS           SA61759 58044000
         CLI   WRKFLG,TSONLY      TSO ONLY SYSTEM               SA61759 58044500
         BE    TRMTSO             YES - TERMINATE TRM           SA61759 58045000
         DROP  R14                                              SA61759 58045500
         L     R1,TRMDESTQ-D1     DEST. QCB ADDR                SA61759 58046000
         DROP  R1                                               SA61759 58054000
         USING IEDQQCB,R1                                       SA61759 58062000
         TM    QCBFLAG,QCBTSSES   TSO TERMINAL                   S22024 58070000
         BO    TRMTSO             YES - TERMINATE TRM           SA61759 58078000
         TM    QCBDSFLG,QCBREUS+QCBNREUS+QCBCORE  ARE THERE     SA61759 58080000
*                                 ANY QUEUES USED               SA61759 58082000
         BZ    TRMTSO             NO - TERMINATE                SA61759 58084000
         DROP  R1                                               SA61759 58086000
         BR    R9                 RETURN TO CALLER                      58100000
TRMTSO   DS    0H                 BOUNDARY ALLIGNMENT           SA61759 58110000
         WTO   'IED216I TRM CANCELLED - TOTE CANNOT USE TSO DEVICE',ROU*58120000
               TCDE=10,DESC=7     TSO DEVICE REJECT MSG         SA61759 58130000
         TM    TOTFLG05,TOTSRCON  TRM ENTERED FROM SYSCON      @Y17XAUU 58130500
         BO    TRM085             YES - EXIT                   @Y17XAUU 58131000
         IEDQMSG MSGID=078,FUNCT=SRC    WRITE MSG TO SOURCE    @Y17XAUU 58131500
         B     TRM085             EXIT TO CLEANUP               SA61759 58140000
         EJECT                                                          58170000
*                                                                       58240000
*                                                                       58310000
*        ROUTINE TO FIND UCB ADDR AFTER ENTRY IN TERMINAL TABLE HAS     58380000
*         BEEN FOUND                                                    58450000
*                                                                       58520000
*                                                                       58590000
UCBFIND  EQU   *                                                        58660000
         L     R8,TNTENTRY        GET TERMINAL ENTRY ADDRESS            58730000
         USING IEDQTRM,R8                                               58800000
         L     R8,TRMDESTQ-D1     GET QCB ADDRESS                       58870000
         DROP  R8                                                       58940000
         USING IEDQQCB,R8                                               59010000
         SR    R7,R7              CLEAR REGISTER 7                      59080000
         IC    R7,QCBRELLN        GET RELATIVE LINE NUMBER              59150000
         STC   R7,TRMRLN          SAVE CT RLN                           59220000
         SLL   R7,D2              MULTIPLY BY 4                         59290000
         L     R8,QCBDCBAD-D1     GET DCB ADDRESS                       59360000
         DROP  R8                                                       59430000
         USING IHADCB,R8                                                59500000
         TM    DCBDSORG,LGBA      LGB VS. DCB                    S22024 59570000
         BZ    UCB0X              NO                             S22024 59640000
         DROP  R8                                                S22024 59710000
         L     R1,TNTENTRY        GET TERMINAL ENTRY ADDRESS   @Y17XAUU 59710300
         BAL   R14,NCPTTE         GET NCP TTE ADDRESS          @Y17XAUU 59710600
*                                                              @Y17XAUU 59710900
*        ON RETURN R1 CONTAINS ADDRESS OF NCP TTE PREFIX       @Y17XAUU 59711200
*                                                              @Y17XAUU 59711500
         USING IEDNTRM,R1         ESTABLISH ADDRESSABILITY     @Y17XAUU 59711800
         TM    TRMBYTE2,TRMRSACT  3705 ACTIVE                  @Y17XAUU 59712100
         BZ    UCB08              NO - ERROR                   @Y17XAUU 59712400
         TM    TRMBYTE2,TRMINPG   ACT/DEACT IN PROGRESS        @Y17XAUU 59712700
         BO    UCB08              YES - ERROR                  @Y17XAUU 59713000
         L     R1,TRMDESTQ-D1     GET NCP QCB ADDRESS          @Y17XAUU 59713300
         DROP  R1                                              @Y17XAUU 59713600
         USING IEDQQCB,R1         ESTABLISH ADDRESSABILITY     @Y17XAUU 59713900
         L     R8,QCBDCBAD-D1     GET DCB ADDRESS              @Y17XAUU 59714200
         DROP  R1                                              @Y17XAUU 59714500
         LA    R7,D4              SHOW RLN EQU 1                 S22024 60020000
UCB0X    EQU   *                                                 S22024 60060000
         USING IHADCB,R8                                         S22024 60200000
         TM    DCBOFLGS,X10       IS DCB OPEN?                          60270000
         BZ    D0(R9)             NO, BRANCH                            60340000
         L     R8,DCBDEBAD        GET DEB ADDRESS                       60410000
         DROP  R8                                                       60480000
         USING DEBNMSUB,R8                                              60550000
         SR    R15,R15            CLEAR REGISTER 15                     60620000
         IC    R15,DEBNMEXT       GET NUMBER OF EXTENTS                 60690000
         SLL   R15,D2             MULTIPLY BY 4                         60760000
UCB04    EQU   *                                                 S22024 61040000
         CR    R15,R7             IS DESIRED LINE OPENED?               61110000
         BL    D0(R9)             NO                                    61180000
         L     R8,DEBUCBAD-D4(R7) GET UCB ADDRESS                       61250000
         USING UCB,R8                                                   61320000
         MVC   WORK1(D3),UCBNAME  MOVE UCB ID IN EBCDIC                 61390000
         DROP  R8                                                       61460000
         B     D4(R9)             RETURN                                61530000
UCB08    EQU   *                                                 S22024 61600000
         OI    TRMFLG01,TRMINACV  SET 3705 INACTIVE FLAG         S22024 61670000
         B     D0(R9)             ERROR RETURN                   S22024 61740000
         EJECT                                                          61740500
*                                                             *@Y17XAUU 61741000
*        ROUTINE TO FIND NCP TTE ADDRESS. INPUT: REG 1 =      *@Y17XAUU 61741500
*        TERMINAL TTE ADDRESS. OUTPUT: REG 1 = NCP TTE ADDRESS*@Y17XAUU 61742000
*        RETURN TO CALLER VIA REG 14.                         *@Y17XAUU 61742500
*                                                             *@Y17XAUU 61743000
NCPTTE   DS    0H                 BOUNDARY ALLIGHMENT          @Y17XAUU 61743500
         ST    R14,TRMSAVE3       SAVE RETURN ADDRESS          @YM08072 61744000
         LA    R8,TRMPRFSZ        GET TTE PREFIX SIZE          @Y17XAUU 61744600
         SLR   R1,R8              POINT TO TTE PREFIX          @Y17XAUU 61745200
         USING IEDNTRM,R1         ESTABLISH ADDRESSABILITY     @Y17XAUU 61746000
NCPLOOP  DS    0H                 FIND NCP TTE                 @Y17XAUU 61746500
         LH    R1,TRMCOHRT        GET COHORT POINTER           @Y17XAUU 61747000
         LTR   R1,R1              ENTRY IN HIERARCHY           @YM07415 61747100
         BZR   R9                 NO - ERROR RETURN            @YM07415 61747200
         L     R15,TERNMTAB       TTCIN TO TTE CONVERSION      @Y17XAUU 61747500
*                                 ROUTINE ADDRESS              @Y17XAUU 61748000
         BALR R14,R15             FIND TTE ADDRESS             @Y17XAUU 61749000
         SLR   R1,R8              POINT TO TTE PREFIX          @Y17XAUU 61750000
         CLI   TRMTYPE,TRMLNCP    NCP ENTRY                    @Y17XAUU 61750600
         BNE   NCPLOOP            NO - CHECK NEXT ENTRY        @Y17XAUU 61751200
         L     R14,TRMSAVE3       RESTORE RETURN ADDRESS       @YM08072 61752000
         BR    R14                RETURN TO CALLER             @Y17XAUU 61752600
         DROP  R1                                              @Y17XAUU 61753200
         EJECT                                                          61810000
**************************************************************** S22024 61880000
*        ROUTINE TO GO TO IEDQWB2 TO CALCULATE THE AMOUNT OF   * S22024 61950000
*        OF CORE NEEDED TO BUILD DUMMY ENTRIES FOR A SPECIFIED * S22024 62020000
*        REMOTE TERMINAL. CONTROL IS PASS TO IEDQWB TO ATTAIN  * S22024 62090000
*        THE ACTUAL CORE.  CONTROL IS THEN RETURNED TO IEDQWB2 * S22024 62160000
*        TO COPY THE ENTRIES.                                  * S22024 62230000
**************************************************************** S22024 62300000
DUMMYTNT EQU   *                                                 S22024 62370000
         STM   R7,R11,TRMSAVE2    SAVE REGISTERS                 S22024 62440000
         LA    R12,KTRM           PASS PARAMETERS                S22024 62510000
         XC    TRMFLG01(D1),TRMFLG01 CLEAR CONTROL FLAG          S22024 62580000
*                                                                S22024 62650000
         LINK  EP=IEDQWB2         CALCULATE CORE                 S22024 62720000
         CL    R15,ERRCD8         SNA LU REJECT                @XM05678 62740000
         BE    DUMFAILU           YES-WRITE ERROR MESSAGE      @XM05678 62760000
         LTR   R15,R15            REQUEST SUCCESSFUL             S22024 62790000
         BNZ   DUMFAIL            NO - ERROR                     S22024 62860000
         TM    TRMFLG01,TRMCTEAP  CT EQU AP                      S22024 62930000
         BO    DUMOUT             RETURN                         S22024 63000000
*                                                                S22024 63070000
         L     R10,TOTRESPL       ADDR OF TOTE RES. CTL BLK      S22024 63140000
         USING RESPL,R10                                         S22024 63210000
         XC    TOTOTECB(D4),TOTOTECB CLEAR ECB                   S22024 63280000
         POST  RESTECB1           POST REQUEST TO IEDQWB         S22024 63350000
         WAIT  ECB=TOTOTECB       WAIT FOR REQUEST TO BE HONORED S22024 63420000
*                                                                S22024 63490000
         CLI   TOTWKSPC,XFF       REQUEST SUCCESSFUL             S22024 63560000
         BE    DUMFAIL            NO - ERROR                     S22024 63630000
*                                                                S22024 63700000
         OI    TRMFLG01,TRMQWB3   SHOW SECOND PASS               S22024 63770000
         LA    R12,KTRM           PASS PARAMETERS                S22024 63840000
         LINK  EP=IEDQWB2         COPY ENTRIES                   S22024 63910000
         LTR   R15,R15            REQUEST SUCCESSFUL             S22024 63980000
         BNZ   DUMFAIL            NO - ERROR                     S22024 64050000
*                                                                S22024 64120000
DUMOUT   EQU   *                                                 S22024 64190000
         LM    R7,R11,TRMSAVE2    RESTORE REGISTERS              S22024 64260000
         BR    R9                 RETURN                         S22024 64330000
         SPACE                                                          64337000
DUMFAILU EQU   *                                               @XM05678 64344000
         WTO   'IED586I OLT REQUEST REJECTED, SNA LU NOT IN SSCP-LU SES*64351000
               SION ONLY',ROUTCDE=10,DESC=7                    @XM05678 64358000
         TM    TOTFLG05,TOTSRCON  TRM ENTERED FROM SYSCON      @XM05678 64365000
         BO    DUMEND             YES - EXIT                   @XM05678 64372000
         IEDQMSG MSGID=093,FUNCT=SRC                           @XM05678 64379000
         B     DUMEND             TERMINATE TRM                @XM05678 64386000
         SPACE 2                                                        64400000
DUMFAIL  EQU   *                                                        64470000
         WTO   'IED215I OLT REQUEST REJECTED, UNABLE TO ALLOCATE RESOUR*64540000
               CES FOR CT/AP',ROUTCDE=10,DESC=7                         64610000
         TM    TOTFLG05,TOTSRCON  TRM ENTERED FROM SYSCON      @Y17XAUU 64612000
         BO    DUMEND             YES - EXIT                   @Y17XAUU 64614000
         IEDQMSG MSGID=080,FUNCT=SRC    WRITE MSG TO SOURCE    @Y17XAUU 64616000
         SPACE                                                          64680000
DUMEND   EQU   *                                                        64750000
         L     R13,D4(R13)        RESTORE CALLERS SAVE AREA ADDRESS     64820000
         LM    R14,R12,12(R13)    RESTORE CALLER'S REG                  64890000
         SR    R15,R15            CLEAR REG                             64960000
         BR    R14                RETURN                                65030000
         SPACE                                                          65100000
         EJECT                                                          65170000
NOOPEN   EQU   *                                                        65240000
         TM    TRMFLG01,TRMINACV  3705 INACTIVE                  S22024 65310000
         BZ    NOOP2              NO                             S22024 65380000
         WTO   'IED217I 3705 NOT ACTIVE',ROUTCDE=10,DESC=7       S22024 65450000
         TM    TOTFLG05,TOTSRCON  TRM ENTERED FROM SYSCON      @Y17XAUU 65452000
         BO    TRMERR2            YES - EXIT                   @Y17XAUU 65454000
         IEDQMSG MSGID=086,FUNCT=SRC    WRITE MSG TO SOURCE    @Y17XAUU 65456000
         B     TRMERR2            EXIT                           S22024 65520000
NOOP2    EQU   *                                                 S22024 65590000
         WTO   'IED130I OLT REQUEST REJECTED, CONTROL TERMINAL NOT OPEN*65660000
               ED',ROUTCDE=10,DESC=7                                    65730000
         TM    TOTFLG05,TOTSRCON  TRM ENTERED FROM SYSCON      @Y17XAUU 65732000
         BO    TRMERR2            YES - EXIT                   @Y17XAUU 65734000
         IEDQMSG MSGID=092,FUNCT=SRC    WRITE MSG TO SOURCE    @Y17XAUU 65736000
         B     TRMERR2            BR TO SET UP FOR TERMINATION          65800000
         SPACE 4                                                        65870000
LCBSCAN  EQU   *                                                        65940000
         STM   R10,R12,TRMSAVE1   SAVE REG 10-12                        66010000
         STM   R5,R9,TRMSAVE2     SAVE REG 5-9                          66080000
         L     R5,TRMQCB          GET CT QCB ADDRESS                    66150000
         USING IEDQQCB,R5                                               66220000
         LA    R5,D0(R5)          CLEAR HI ORDER BYTE                   66290000
         L     R9,QCBDCBAD-D1     GET DCB ADDRESS                       66360000
         USING IHADCB,R9                                                66430000
         TM    DCBDSORG,LGBA      LGB VS DCB                     S22024 66500000
         BZ    LCB0X              NO                             S22024 66570000
         DROP  R9                                                S22024 66640000
         L     R1,TNTENTRY        GET TERMINAL TTE ADDRESS     @Y17XAUU 66641000
         BAL   R14,NCPTTE         FIND NCP TTE ADDRESS         @Y17XAUU 66642000
         USING IEDNTRM,R1         ESTABLISH ADDRESSABILITY     @Y17XAUU 66643000
         L     R5,TRMDESTQ-D1     GET QCB ADDRESS              @Y17XAUU 66644000
         DROP  R1                                              @Y17XAUU 66645000
         L     R9,QCBDCBAD-D1     GET DCB ADDRESS              @Y17XAUU 66646000
         USING IHADCB,R9                                         S22024 66920000
LCB0X    EQU   *                                                 S22024 66990000
         L     R7,DCBDEBAD        GET DEB ADDR                          67060000
         USING DEBNMSUB,R7                                              67130000
         SR    R8,R8              CLEAR REG 8                           67200000
         IC    R8,DEBNMEXT        GET DEB NUMBER OF EXTENTS             67270000
         DROP  R7                                                       67340000
         SR    R7,R7              CLEAR REG 7                           67410000
         IC    R7,QCBRELLN        GET QCB'S STARTING RLN                67480000
         TM    TRMFLG01,TRM3705   3705 MODE                      S22024 67550000
         BZ    LCB04              NO                             S22024 67620000
         LA    R7,D1              SET RLN EQU 1                  S22024 67690000
LCB04    EQU   *                                                 S22024 67760000
         DROP  R5                                                       67830000
         LR    R5,R7              COPY RLN FOR NEXT TEST                67900000
         BCTR  R5,D0              GET RLN MINUS 1                       67970000
         SR    R8,R5              GET COUNT OF LCB'S TO SCAN            68040000
         SR    R12,R12            CLEAR REG 12                          68110000
         IC    R12,DCBEIOBX       GET LCB SIZE                          68180000
         LR    R11,R7             SAVE QCB'S STARTING RLN               68250000
         MR    R10,R12            GET STARTING LCB OFFSET               68320000
         AL    R11,DCBIOBAD       POINT TO IOB OF LCB                   68390000
         DROP  R9                                                       68460000
         S     R11,F32            ADJUST TO START OF LCB                68530000
         CLI   TRMRQFLG,CTREQ     C.T.REQUEST?                 @Y17XAUU 68600000
         BE    LCBSS4             YES                                   68670000
         LA    R5,TOTAPDFL        AP INIT STATUS FLAGS                  68740000
         B     LCBSS8             BRANCH TO TEST LINE STATUS            68810000
LCBSS4   EQU   *                                                        68880000
         LA    R5,TOTCTDFL        CT INIT STATUS FLAGS                  68950000
LCBSS8   EQU   *                                                        69020000
         TM    TRMFLG01,TRM3705   3705 MODE?                     S05331 69024000
         BZ    MODE0X             NO, BRANCH                     S05331 69028000
         L     R8,TNTENTRY        GET TERMINAL TTE ADDRESS     @Y17XAUU 69029000
         LA    R1,TRMPRFSZ        GET TTE PREFIX SIZE          @Y17XAUU 69030000
         SR    R8,R1              POINT TO TTE PREFIX          @Y17XAUU 69031000
         USING IEDNTRM,R8         ESTABLISH ADDRESSABILITY     @Y17XAUU 69031200
LINELOOP DS    0H                 FIND LINE TTE                @Y17XAUU 69033200
         LH    R1,TRMCOHRT        GET COHORT POINTER           @Y17XAUU 69035200
         L     R15,TERNMTAB       TTCIN TO TTE CONVERSION      @Y17XAUU 69037200
*                                 ROUTINE ADDRESS              @Y17XAUU 69039200
         BALR  R14,R15            FIND TTE ADDRESS             @Y17XAUU 69041200
         LR    R8,R1              GET TTE ADDRESS              @Y17XAUU 69043200
         LA    R1,TRMPRFSZ        GET TTE PREFIX SIZE          @Y17XAUU 69045200
         SR    R8,R1              POINT TO TTE PREFIX          @Y17XAUU 69047200
         CLI   TRMTYPE,TRMNSDLC   PRE SNA LINE ENTRY           @Y17XAUU 69049200
         BE    LINEFND            YES                          @Y17XAUU 69051200
         CLI   TRMTYPE,TRMSDLC    SNA LINE ENTRY               @Y17XAUU 69053200
         BNE   LINELOOP           CHECK NEXT ENTRY             @Y17XAUU 69055200
LINEFND  DS    0H                 LINE ENTRY FOUND             @Y17XAUU 69057200
         TM    TRMLINK,TRMLACTV   LINE STOPPED                 @Y17XAUU 69059200
         BO    LCBSSC             NO                           @Y17XAUU 69061200
         OI    D0(R5),TOTCTLST    SHOW LINE INITIALLY STOPPED    S05331 69068000
         B     LCBSSC             BRANCH                         S05331 69072000
         DROP  R8                 DROP QCB BASE                  S05331 69076000
MODE0X   EQU   *                                                 S05331 69080000
         USING IEDQLCB,R11                                              69090000
         TM    LCBSTAT1,X07       LINE STOPPED?                         69160000
         BNZ   LCBSSC             NO                                    69230000
         OI    D0(R5),TOTCTLST    SHOW CT INIT. STOPPED                 69300000
LCBSSC   EQU   *                                                        69370000
         DROP  R11                                                      69440000
         LM    R5,R9,TRMSAVE2     RESTORE REG 5-9                       69510000
         L     R10,TRMSAVE1       RESTORE REG 10                        69580000
         L     R12,TRMSAVE1+8     RESTORE REG 12                        69650000
         BR    R9                 RETURN TO CALLER                      69720000
         EJECT                                                          69790000
**************************************************************** S22024 69860000
*        ROUTINE TO FIND THE SYMBOLIC NAME OF THE RN LINE      * S22024 69930000
*        FOR THE TERMINAL ATTACHED TO THE RN.                  * S22024 70000000
**************************************************************** S22024 70070000
RNLINET  EQU   *                                                 S22024 70140000
         STM   R7,R11,TRMSAVE2    SAVE CALLER'S REG              S22024 70210000
         L     R11,TNTENTRY       TTE ADDR                       S22024 70280000
         USING IEDNTRM,R11                                       S22024 70350000
         LA    R7,TRMPRFSZ        TTE PREFIX SIZE              @Y17XAUU 70355000
         SLR   R11,R7             TTE PREFIX ADDRESS           @Y17XAUU 70360000
         TM    TRMSTATE,TRMPREF   3705 RESOURCE                @Y17XAUU 70365000
         BZ    RNLINEND           NO                             S22024 70560000
         TM    TRMSTATE,XE0       RN TERMINAL                    S22024 70630000
         BNZ   RNLINEND           NO                             S22024 70700000
         LH    R7,TRMTTCIN        GET TERMINAL TTCIN                    70710000
         TM    TRMFLG04,CTRSID    CT REQUEST                     S22024 70840000
         BZ    RN02               NO - ASSUME AP                 S22024 70910000
         OI    TOTCTFLG,TOTCTORN  CT ON 3705                     S22024 70980000
         STH   R7,TOTCROFF        CT REAL TTCIN                @Y17XAUU 71050000
         LA    R7,TOTCRSID        ADDRESS OF CT NETWORK ADDR   @Y17XAUU 71080000
         B     RN03               EXIT                           S22024 71120000
RN02     EQU   *                                                 S22024 71190000
         OI    TOTAPFLG,TOTAPORN  AP ON 3705                     S22024 71260000
         STH   R7,TOTAROFF        AP REAL TTCIN                @Y17XAUU 71330000
         LA    R7,TOTARSID        ADDRESS OF AP NETWORK ADDR   @Y17XAUU 71360000
RN03     EQU   *                                                 S22024 71400000
         L     R4,TOTAVTPT        GET AVT ADDRESS              @Y17XAUU 71410000
         USING IEDQAVTD,R4        SET AVT ADDRESSABILITY       @Y17XAUU 71420000
         L     R4,AVTSAVTP        GET SAVT ADDRESS             @Y17XAUU 71430000
         DROP  R4                                              @Y17XAUU 71440000
         USING IEDNSVTD,R4        SET SAVT ADDRESSABILITY      @Y17XAUU 71450000
         L     R15,SAVTTNTX       TTCIN TO NETWORK ADDR RTN    @Y17XAUU 71470000
         DROP  R4                                              @Y17XAUU 71480000
         LH    R1,TRMTTCIN        GET TERMINAL TTCIN           @Y17XAUU 71490000
         BALR  R14,R15            CALL CONVERSION ROUTINE      @Y17XAUU 71500000
         STH   R15,D0(R7)         SAVE NETWORK ADDRESS         @YM07278 71510000
         L     R10,TRMQCB         GET QCB ADDR                   S22024 71540000
         USING IEDQQCB,R10                                       S22024 71610000
         L     R10,QCBLGBAD-D1    LGB ADDR                       S22024 71680000
         LA    R10,D0(R10)        CLEAR HIGH ORDER BYTE          S22024 71750000
         DROP  R10                                               S22024 71820000
         USING IEDNLGB,R10                                       S22024 71890000
         TM    TRMFLG04,CTRSID    CT REQUEST                     S22024 71960000
         BZ    RN03F              NO                             S22024 72030000
         MVC   TOTCTRNL(D8),LGBNAME SAVE CT LINE GROUP NAME      S22024 72100000
         B     CHKTTE             EXIT                         @Y17XAUU 72170000
RN03F    EQU   *                                                 S22024 72240000
         MVC   TOTAPRNL(D8),LGBNAME SAVE AP LINE GROUP NAME             72310000
         DROP  R10                                             @Y17XAUU 72313000
CHKTTE   DS    0H                 FIND LINE ENTRY              @Y17XAUU 72316000
         LH    R1,TRMCOHRT        GET TTCIN OF NEXT ENTRY      @Y17XAUU 72319000
         LR    R9,R1              SAVE TTCIN                   @Y17XAUU 72322000
         L     R15,TERNMTAB       TTCIN TO TTE CONVERSION RTN  @Y17XAUU 72325000
         BALR  R14,R15            FIND TTE ADDRESS             @Y17XAUU 72328000
         LR    R11,R1             SET TTE BASE                 @Y17XAUU 72331000
         LA    R1,TRMPRFSZ        GET TTE PREFIX SIZE          @Y17XAUU 72332000
         SLR   R11,R1             POINT TO TTE PREFIX          @Y17XAUU 72333000
         CLI   TRMTYPE,TRMNSDLC   NON SNA LINE                 @Y17XAUU 72334000
         BE    LINETTE            YES - LINE TTE FOUND         @Y17XAUU 72337000
         CLI   TRMTYPE,TRMSDLC    SNA LINE                     @Y17XAUU 72340000
         BE    LINETTE            YES - LINE TTE FOUND         @Y17XAUU 72343000
         B     CHKTTE             CHECK NEXT ENTRY             @Y17XAUU 72346000
LINETTE  DS    0H                 FIND LINE SYMBOLIC NAME      @Y17XAUU 72349000
         BCTR  R9,R0              DECREMENT FOR MULTIPLY       @Y17XAUU 72352000
         L     R1,TERNMTAB        SET TNT BASE                 @Y17XAUU 72355000
         USING IEDQTNTD,R1        ESTABLISH ADDRESSABILITY     @Y17XAUU 72358000
         SR    R8,R8              CLEAR REGISTER               @Y17XAUU 72361000
         IC    R8,TNTENLEN        LENGTH OF NAME               @Y17XAUU 72364000
         LA    R8,D3(R8)          TOTAL LEN OF A TNT ENTRY     @Y17XAUU 72367000
         MR    R8,R8              OFFSET TO TNT ENTRY          @Y17XAUU 72370000
         LA    R10,TNTFIRST(R9)   LINE TNT ADDRESS             @Y17XAUU 72373000
         DROP  R1                                              @Y17XAUU 72376000
         SPACE                                                          75950000
*                                                                S22024 76020000
*        ENQUEUE THE RN LINE SHARED                              S22024 76090000
*                                                                S22024 76160000
RN0C     EQU   *                                                        76230000
         SR    R9,R9              CLEAR REG                      S22024 76300000
         IC    R9,TOTTTBEL        MAX NAME LENGTH                S22024 76370000
         BCTR  R9,R0              DECREMENT FOR EXECUTE          S22024 76440000
         EX    R9,RNENQ           MOVE RN LINE NAME TO ENQ LIST  S22024 76510000
         SPACE                                                          76580000
         ENQ   ,MF=(E,ENQLIST)    ENQ RN LINE                    S22024 76650000
         LTR   R15,R15            WAS IT ASSIGNED                S05331 76652000
         BZ    RNLINEND           YES                            S05331 76654000
         CLI   D3(R15),D8         WAS IT PREVIOUSLY ASSIGNED     S05331 76656000
         BE    RNLINEND           YES                            S05331 76658000
*        DEQ TERMINAL NAME AND UCB - ERROR EXIT                  S05331 76660000
         TM    TRMFLG04,CTRSID    CT REQUEST                     S05331 76662000
         BZ    RN10               NO - ASSUME AP                 S05331 76664000
         SR    R8,R8              CLEAR                        @G36XRUV 76665000
         ICM   R8,3,TOTCTUCB      GET CT UCB ADDR              @G36XRUV 76666000
         LA    R7,WORK3           ADDR OF CT NAME                S05331 76668000
         B     RN14               CONTINUE PROCESSING            S05331 76670000
RN10     DS    0H                 BOUNDARY ALLIGNMENT            S05331 76672000
         SR    R8,R8              CLEAR                        @G36XRUV 76673000
         ICM   R8,3,TOTAPUCB      GET AP UCB ADDR              @G36XRUV 76674000
         LA    R7,TOTAPNAM        ADDR OF AP NAME                S05331 76676000
RN14     DS    0H                 BOUNDARY ALLIGNMENT            S05331 76678000
         USING UCB,R8                                            S05331 76680000
         MVI   ENQLIST+D2,DEQFLG  SET DEQ FLAG                   S05331 76682000
         MVC   RNAME(D8),D0(R7)   GET TERMINAL NAME              S05331 76684000
         DEQ   ,MF=(E,ENQLIST)    DEQ IT                         S05331 76686000
         MVI   RNAME,X40          BLANK NAME                     S05331 76688000
         MVC   RNAME+D1(D7),RNAME   FIELD                        S05331 76690000
         MVC   RNAME(D3),UCBNAME  GET UCB NAME                   S05331 76692000
         DEQ   ,MF=(E,ENQLIST)    DEQ IT                         S05331 76694000
         MVI   ENQLIST+D2,ENQFLG  RESTORE ENQ FLAG               S05331 76696000
         TM    TRMFLG04,CTRSID    CT REQUEST                     S05331 76698000
         BO    TRMCTX             YES - TERMINATE TRM            S05331 76700000
         B     APCOM              SHOW AP ERROR                  S05331 76702000
         SPACE                                                          76720000
RNLINEND EQU   *                                                 S22024 76790000
         LM    R7,R11,TRMSAVE2    RESTORE REG                    S22024 76860000
         BR    R9                 RETURN                         S22024 76930000
RNENQ    MVC   RNAME(D0),D0(R10)  MOVE RN LINE NAME TO ENQ LIST         77000000
         EJECT                                                          77070000
SETCONFG DS    0F                 USED TO SET TOTCONFG W/ C&S  @G36XRUV 77170000
         DC    AL1(TOTCONFG)                                   @G36XRUV 77270000
         DC    AL3(0)                                          @G36XRUV 77370000
SETPRMPT DS    0F                 USED TO SET TOTPRMPT W/ C&S  @G36XRUV 77470000
         DC    AL1(TOTPRMPT)                                   @G36XRUV 77570000
         DC    AL3(0)                                          @G36XRUV 77670000
TRMSAVE3 DS    A                        REGISTER SAVE AREA     @YM08072 77770000
ERRCD8   DC    F'8'               ERROR RETURN CODE            @XM05678 78070000
TRMCTSAV DC    8XL1'40'           CT NAME SAVE AREA              S22024 78540000
F2       DC    F'2'               VALUE OF 2                     S22024 78570000
OFFSET   DS    H                  3705 LINE TNT OFFSET           S22024 78610000
TRMTTCIN DC    H'0'               TTCIN SAVE AREA              @Y17XAUU 78620000
TMRQLADR DC    8CL1' '                  SYMBOLIC NAME FIELD             78630000
PATCH    DC    100XL1'0'          IEDQWC PATCH AREA            @Y17XAUU 78680000
         SPACE 2                                                        78750000
**************************************************************** S22024 78820000
KTRM     DS    0F                 P-LIST PASSED TO QWB2          S22024 78890000
TERNMTAB DS    A                  TERMNAME TABLE ADDRESS         S22024 78960000
TNTENTRY DS    A                  TERMNAME ENTRY ADDRESS         S22024 79030000
TRMQCB   DS    A                  CT/AP QCB ADDRESS              S22024 79100000
TRMTNT   DS    A                  CT/AP TNT ADDRESS              S22024 79170000
TRMSAVE1 DS    3F                 REGISTERS SAVE AREA            S22024 79240000
TRMSAVE2 DS    5F                 REGISTERS SAVE AREA            S22024 79310000
TRMSAV1  DS    3F                 REGISTERS SAVE AREA            S22024 79380000
REGSAVE  DS    F                  WORK AREA                      S22024 79450000
F32      DC    F'32'              VALUE OF 32                    S22024 79730000
KPQCB    DS    A                  TRUE P-QCB ADDRESS           @YM08027 79830000
KMQCB    DS    A                  DUMMY M-QCB ADDRESS          @YM08027 79930000
CONCTTE  DS    A                  TRUE CONC TERM TTE ADDRESS   @YM08027 80030000
KDRQ     DS    A                  TRUE DRQ ADDRESS             @YM08027 80130000
KPQCBSZ  DS    H                  P-QCB SIZE                   @YM08027 80230000
KMQCBSZ  DS    H                  M-QCB SIZE                   @YM08027 80330000
KDRQSZ   DS    H                  DRQ SIZE                     @YM08027 80430000
TTETSZ   DS    CL1                CONC TERM TTE SIZE           @YM08027 80530000
TTECSZ   DS    CL1                CONC TTE SIZE                @YM08027 80630000
TRMRQFLG DC    X'00'              DUMMY TNT REQUEST FLAG         S22024 80780000
CTREQ    EQU   X'80'              CT REQUEST                   @Y17XAUU 80790000
APREQ    EQU   X'40'              AP REQUEST                   @Y17XAUU 80800000
PRREQ    EQU   X'20'              PRIMARY TEST DEVICE REQUEST  @Y17XAUU 80810000
SCREQ    EQU   X'10'              SECONDARY TEST DEV REQUEST   @Y17XAUU 80820000
TRMFLG01 DS    CL1                CONTROL FLAG                   S22024 80990000
CONC     EQU   X'80'              TERMINAL ATTACHED TO CONC      S22024 81060000
TRMSPAS  EQU   X'40'              PROCESS CONC TTE               S22024 81130000
TRMQWB3  EQU   X'20'              SECOND PASS FUNCTION           S22024 81200000
TRMDELY  EQU   X'08'              QCB IN TIME DELAY QUEUE        S22024 81270000
TRM3705  EQU   X'04'              3705 MODE                      S22024 81340000
TRMCTEAP EQU   X'02'              CT EQU AP                      S22024 81410000
TRMINACV EQU   X'01'              3705 INACTIVE                  S22024 81480000
WRKFLG   DS    CL1                WORK AREA                      S22024 81550000
**************************************************************** S22024 82320000
         SPACE                                                          82460000
MULT     DC    F'0'               WORK AREA                    @Y17XAUU 82490000
WORK1    DC    8X'0'              PLACE FOR CT/AP NAME                  82880000
WORK3    DS    CL8                SAVE AREA FOR CTL TERM. NAME          82950000
WORK4    DS    3F                 WORK AREA                             83020000
F8       DC    F'8'               VALUE OF 8                     S22024 83090000
TRMSRCE  DS    H                  INDEX TO TERMINAME TABLE ENTRY        83160000
TRMNAME  DC    8C' '              PLACE FOR CT/AP NAME                  83230000
TRMFLG   DC    X'00'              TRM FLAGS                             83300000
NUMFLG   DC    X'00'              CONTROL FLAG                          83370000
NUMEN    EQU   X'80'              NUMERIC ENTRY                         83440000
         DS    0F                 USED FOR ALLIGNMENT                   83510000
PAREMLST DS    0CL8               BINARY SEARCH PARM-LIST               83580000
         DS    CL1                OFFSET TO BINARY SEARCH ADDRESS       83650000
         DC    X'00'              FLAG BYTE 1                           83720000
         DC    X'00'              FLAG BYTE 2                           83790000
LENGTH   DS    CL1                LENGTH OF TERMINAL NAME               83860000
         DC    A(WORK1)           ADDRESS OF TERMINAL NAME              83930000
SSFLG    DC    X'00'              CONTROL BYTE                          84000000
         DS    0H                 USED FOR ALLIGNMENT                   84070000
BLANK    DC    8X'40'             OR FIELD                              84140000
*                                                                       84210000
*                                                                       84280000
ENQLIST  ENQ   (QNAME,RNAME,S,8,STEP),RET=USE,MF=L  ENQUEUE PARAMETER  *84350000
                                                      LIST FOR CT/AP    84420000
QNAME    DC    CL8'SYSZTOTE'      MAJOR ELEMENT                @Y17XAUU 84430000
RNAME    DC    8CL1' '            RESOURCE NAME FOR ENQUEUE             84560000
TRMRLN   DS    CL1                CT/AP RLN                             84630000
SLASH2   DC    CL3'///'           THREE SLASHES                         84700000
SYSOUT   DC    C'SYSOUT'          COMPARE FIELD                         84770000
SYSCON   DC    C'SYSCON'          COMPARE FIELD                         84840000
SYSCONL  DC    C'SYSCON/'         CT EQU SYSTEM CONSOLE                 84910000
CONFIG   DC    C'//CONFIG/'       CONFIG COMPARE FIELD                  84980000
PROMPT   DC    C'//PROMPT/'       PROMPT COMPARE FIELD                  85050000
TOTE     DC    C'/TOTE//'         DEALLOCATION REQUEST         @Y17XAUU 85060000
TRMFLG04 DC    X'00'              FLAG BYTE                      S22024 85120000
CTRSID   EQU   X'80'              CT RSID INDICATOR              S22024 85190000
APRSID   EQU   X'40'              AP RSID INDICATOR              S22024 85260000
NAP      DC    C'NAP'             NO ALTERNATE PRINTER COMPARE FIELD    85330000
AP       DC    C'AP'              ALTERNATE PRINTER COMPARE FIELD       85400000
         EJECT                                                          85470000
         TLGBD                                                   S22024 85540000
         EJECT                                                          85610000
         TQCBED                                                         85680000
         EJECT                                                          85750000
         TDRQD                                                          85820000
         EJECT                                                          85960000
         TPRIOR                                                         86030000
         EJECT                                                          86100000
         TQCBD                                                          86170000
         EJECT                                                          86240000
DCBDSECT DCBD  DSORG=TX                                                 86310000
         EJECT                                                          86380000
         TSCBD                                                          86450000
         EJECT                                                          86520000
         TPRFD                                                          86590000
         EJECT                                                          86660000
         TLCBD                                                          86730000
         EJECT                                                          86800000
CVT      DSECT                                                          86870000
         CVT                                                            86940000
         EJECT                                                          87010000
UCB      DSECT                                                          87080000
         IEFUCBOB                                                       87150000
         EJECT                                                          87220000
         TAVTD                                                          87290000
         EJECT                                                          87360000
         TTRMD                                                          87430000
         EJECT                                                          87500000
         TDEBD                                                          87570000
         EJECT                                                          87640000
         TTNTD                                                          87710000
         EJECT                                                          87780000
         OLTCB                                                          87850000
ECB      EQU   TOTOTECB                                                 87920000
TRMWRK   EQU   TOTTRMBF+72                                              87990000
DUMMY    EQU   TOTWKSPC                                                 88060000
         EJECT                                                          88130000
RESPL    RESPL                                                          88200000
         SPACE 2                                                        88270000
         END                                                            88340000
./  ADD  SSI=71440706,NAME=IEDQWC1
         TITLE 'IEDQWC1 TRM ANALYSIS MODULE 2'                          00080000
IEDQWC1  CSECT                                                          00240000
*A000000-999999                                                @Y16X5U0 00260000
* CHANGE ACTIVITY AS FOLLOWS:                                           00320000
*D129000,556400-556600                                           S21903 00400000
*A552500                                                        SA41597 00480000
*A158000                                                        SA41614 00560000
*C000000,999999                                                  S22024 00600000
*C264000,357600-373600,397600,403200,408800-412000             @YA12402 00600158
*D272800-273600,278400-280000,283200,319200-350400,405600      @YA12402 00600258
*D416000                                                       @YA12402 00600358
*A297600,356000,400800,401600,424000                           @YA12402 00600458
*C802400-806400                                                @OY12987 00602400
*D812900-813300                                                @OY12987 00604400
*D502000                                                       @OY12987 00606400
*A191200,466400,472000,500000,532800,622400,688800,801600      @Y17XAUU 00609400
*A803200,832800                                                @Y17XAUU 00618400
*C812900,813600,824000                                         @Y17XAUU 00627400
* A006274,139200,424330,424570,424450,880000                   @G36XRUV 00629410
* C424360                                                      @G36XRUV 00631410
* D424600-424750,424420,424480                                 @G36XRUV 00633410
*                                                                       00635410
****************************************************************        00640000
*                                                              *        00720000
* MODULE NAME = IEDQWC1 (TCAM,TOTE)                            @Y17XAUU 00740000
*                                                              *        01040000
* DESCRIPTIVE NAME = TRM ANALYSIS MODULE 2                     *        01120000
*                                                              *        01200000
* COPYRIGHT = NONE                                             *        01280000
*                                                              *        01360000
* STATUS --                                                    *        01440000
*                                                              *        01520000
*    VERSION 10.0                                              @Y17XAUU 01600000
*                                                              *        01680000
*                                                              *        01760000
* FUNCTIONS --                                                 *        01840000
*                                                              *        01920000
*    THE PURPOSE OF THIS MODULE IS TO ANALYZE THE TEST DEVICE  *        02000000
*    FIELD OF THE TEST REQUEST MESSAGE (TRM).                  *        02080000
*                                                              *        02160000
*    CONTROL IS PASSED FROM IEDQWC WITH TRM IN THE OLTCB.      *        02240000
*    THE TEST DEVICE FIELD IS CHECKED FOR VALID SYMBOLIC       *        02320000
*    NAMES OR LINE ADDRESSES (CUU).                            *        02400000
*                                                              *        02480000
*    IF THE ENTRY IS VALID THE UCB OR TNT OF THE ENTRY IS      *        02560000
*    SAVED IN THE OLTCB. IF ANY ENTRY IS INVALID, THE TRM      *        02640000
*    PROMPTER (IEDQWJ) IS CALLED.                              *        02720000
*                                                              *        02800000
* PURPOSE -- SEE FUNCTION                                      @Y17XAUU 02820000
*                                                              *        02880000
* ENTRY POINTS --                                              *        02960000
*                                                              *        03040000
*    IEDQWC1                                                   @Y17XAUU 03120000
*                                                              *        03200000
* LINKAGE -- CALLED BY IEDQWB1 AND IEDQWH TO PROCESS           @Y17XAUU 03200600
*             TEST DEVICE FIELD OF TRM.                        @Y17XAUU 03201200
*                                                              @Y17XAUU 03201800
* MODULE SIZE -- MAXIMUM 4K                                    @Y17XAUU 03202400
*                                                              @Y17XAUU 03203000
* MODULE TYPE -- PROCEDURE                                     @Y17XAUU 03203600
*                                                              @Y17XAUU 03204200
* PROCESSOR -- ASSEMBLER XF                                    @Y17XAUU 03204800
*                                                              @Y17XAUU 03205400
* MACROS -- AQCTL,IEDHJN,IEDQMSG,LINK,SAVE,WAIT,WTO,XCTL       @Y17XAUU 03206000
*                                                              *        03280000
* INPUT --                                                     *        03360000
*                                                              *        03440000
*    REGISTERS 02,13,14,15 CONTAINS THE FOLLOWING VALUES:      *        03520000
*                                                              *        03600000
*    02 - OLTCB POINTER                                        *        03680000
*    13 - SAVE AREA ADDRESS                                    *        03760000
*    14 - RETURN ADDRESS                                       *        03840000
*    15 - ENTRY POINT ADDRESS                                  *        03920000
*                                                              *        04000000
*                                                              *        04080000
* OUTPUT --                                                    *        04160000
*                                                              *        04240000
*    SAME AS INPUT                                             @Y17XAUU 04320000
*                                                              *        04400000
*                                                              *        04480000
* EXTERNAL REFERENCES --                                       *        04560000
*                                                              *        04640000
*    IEDQWK - MESSAGE MODULE                                   *        04720000
*    IEDQCA - OPERATOR CONTROL STOPLINE ROUTINE                *        04800000
*    AVTUI  - TCAM BINARY SEARCH ROUTINE                       *        04880000
*                                                              *        04960000
*                                                              *        05040000
* EXITS,NORMAL --                                              *        05120000
*                                                              *        05200000
*    XCTL TO IEDQWC2                                           *        05280000
*                                                              *        05360000
*                                                              *        05440000
* EXITS,ERROR --                                               *        05520000
*                                                              *        05600000
*    XCTL TO IEDQWJ                                            *        05680000
*                                                              *        05760000
*                                                              *        05840000
* TABLES/WORK AREAS --                                         *        05920000
*                                                              *        06000000
*    CVT, AVT, TERMNAME TABLE, TERMINAL TABLE, OLTCB,          *        06080000
*    LCB, QCB, DCB, SCB, TCB                                   *        06160000
*                                                              *        06240000
*                                                              *        06320000
* ATTRIBUTES --                                                *        06400000
*                                                              *        06480000
*    ENABLED, PROBLEM PROGRAM MODE, TRANSIENT                  *        06560000
*                                                              *        06640000
*                                                              *        06720000
* NOTES -- SEE BELOW                                           @Y17XAUU 06800000
*                                                              *        06880000
*  DEPENDENCIES -- EBCDIC CODE CHARACTER SET                   @Y17XAUU 06881000
*                                                              @Y17XAUU 06882000
*  RESTRICTIONS -- NONE                                        @Y17XAUU 06883000
*                                                              @Y17XAUU 06884000
*  REGISTER CONVENTIONS -- SEE REGISTERS ASSIGNMENT            @Y17XAUU 06885000
*                                                              @Y17XAUU 06886000
*  PATCH LABEL -- PATCH                                        @Y17XAUU 06887000
*                                                              *        07040000
****************************************************************        07120000
         EJECT                                                          07200000
*                                                                       07280000
*        EQUATES                                                        07360000
*                                                                       07440000
R0       EQU   0                  REG 0                                 07520000
R1       EQU   1                  REG 1                                 07600000
R2       EQU   2                  REG 2                                 07680000
R3       EQU   3                  REG 3                                 07760000
R4       EQU   4                  REG 4                                 07840000
R5       EQU   5                  REG 5                                 07920000
R6       EQU   6                  REG 6                                 08000000
R7       EQU   7                  REG 7                                 08080000
R8       EQU   8                  REG 8                                 08160000
R9       EQU   9                  REG 9                                 08240000
R10      EQU   10                 REG 10                                08320000
R11      EQU   11                 REG 11                                08400000
R12      EQU   12                 REG 12                                08480000
R13      EQU   13                 REG 13                                08560000
R14      EQU   14                 REG 14                                08640000
R15      EQU   15                 REG 15                                08720000
         SPACE                                                          08800000
INACT    EQU   X'48'              INACTIVATE VERB CODE           S22024 08880000
INACTRC  EQU   X'08'              TERM ALREADY INACTIVE RC       S22024 08960000
D19      EQU   25                 DISP OF 25                     S22024 09040000
DCBNIDLE EQU   X'02'              3705 ACTIVE                    S22024 09120000
         SPACE                                                          09200000
         SPACE                                                          09280000
SPACE    EQU   X'40'              A BLANK CHAR                          09360000
TWO      EQU   2                  DISP OF TWO                           09440000
FOUR     EQU   4                  DISP OF FOUR                          09520000
PARMREG0 EQU   0                  PARMETER REG 0                        09600000
PARMREG1 EQU   1                  PARMETER REG 1                        09680000
ZERO     EQU   0                  VALUE OF ZERO                         09760000
ONE      EQU   1                  VALUE OF ONE                          09840000
EIGHT    EQU   8                  VALUE OF EIGHT                        09920000
TWELVE   EQU   12                 VALUE OF TWELVE                       10000000
SLASH    EQU   X'61'              A SLASH CHAR                          10080000
COMMA    EQU   X'6B'              A COMMA CHAR                          10160000
SWITCHS  EQU   X'90'              SWITCHED START/STOP                   10240000
SWITCHB  EQU   X'96'              SWITCHED BI-SYNC                      10320000
MORE     EQU   X'80'              MORE ENTRIES FLAG                     10400000
NCMOFF   EQU   X'F7'              TURN OFF                              10480000
END      EQU   X'7F'              NO MORE ENTRIES FLAG                  10560000
SYM      EQU   X'40'              SYMBOLIC TEST DEVICE FLAG             10640000
NOSYM    EQU   X'BF'              TURN OFF SYMBOLIC FLAG                10720000
INCLUS   EQU   X'20'              INCLUSIVE TD FLAG                     10800000
NOINC    EQU   X'DF'              TURN OFF INCLUSIVE FLAG               10880000
ADDONE   EQU   X'10'              ADD ONE FLAG                          10960000
ADDOFF   EQU   X'EF'              TURN OFF ADD ONE FLAG                 11040000
ALLOFF   EQU   X'00'              MASK OFF ALL BIT                      11120000
NCM      EQU   X'08'              NON-CONCURRENT MORE FLAG              11200000
ADRMSK   EQU   7                  ADDRESS MASK                 @YM08136 11240000
LGBA     EQU   X'80'              LGB MAP                        S22024 11280000
RQINIT   EQU   X'0C'              START OF LIST                  S22024 11300000
RQEND    EQU   X'80'              END OF LIST                    S22024 11320000
D0       EQU   0                  DISP OF 0                             11360000
D1       EQU   1                  DISP OF 1                             11440000
D2       EQU   2                  DISP OF 2                             11520000
D3       EQU   3                  DISP OF 3                             11600000
D4       EQU   4                  DISP OF 4                             11680000
D5       EQU   5                  DISP OF 5                             11760000
D6       EQU   6                  DISP OF 6                             11840000
D7       EQU   7                  DISP OF 7                             11920000
D8       EQU   8                  DISP OF 8                             12000000
D9       EQU   9                  DISP OF 9                             12080000
D10      EQU   10                 DISP OF 10                            12160000
D11      EQU   11                 DISP OF 11                            12240000
D12      EQU   12                 DISP OF 12                            12320000
D16      EQU   16                 DISP OF 16                            12400000
D20      EQU   20                 DISP OF 20                            12480000
D24      EQU   24                 DISP OF 24                            12560000
D28      EQU   28                 DISP OF 28                            12640000
D32      EQU   32                 DISP OF 32                            12720000
ACTRTCD  EQU   X'08'              INV. LIST INIT ACTIVE                 12800000
TERMACTV EQU   X'46'              OP CONTROL ACTIVATE VERB CODE         12880000
D40      EQU   40                 DISP OF 40                            12960000
ACVT     EQU   16                 ADDR OF CVT ADDR                      13040000
TRMLEN   EQU   72                 TRM BUFFER SIZE                       13120000
FPAS     EQU   0                  1ST PASS FLAG                         13200000
NUMER    EQU   X'F0'              NUMERIC FLAG                          13280000
KF       EQU   X'C6'              CHAR F                                13360000
F9       EQU   X'F9'              CHAR 9                                13440000
F0       EQU   X'F0'              CHAR 0                                13520000
XC0      EQU   X'C0'              COMPARAND                             13600000
NEG      EQU   4                  NEGATIVE TEST                         13680000
DASH#    EQU   X'60'              HYPHEN CHAR                           13760000
D13      EQU   13                 DISP OF 13                            13840000
X0F      EQU   X'0F'              MASK BYTE                             13920000
XF0      EQU   X'F0'              MASK BYTE                    @G36XRUV 13940010
X09      EQU   X'09'              USED TO TEST FOR 3270 LOCAL  @G36XRUV 13960010
DCBOPEN  EQU   X'10'              DCB OPEN FLAG                         14000000
TCAMDEB  EQU   X'44'              DEB BELONGS TO TCAM FLAG       S22024 14080000
TERM     EQU   X'80'              TERMINAL TEST DEV                     14160000
XFF      EQU   X'FF'              MASK ALL BITS                  S22024 14240000
XE0      EQU   X'E0'              MASK SETTING                   S22024 14320000
X80      EQU   X'80'              MASK SETTING                   S22024 14400000
TCU3705  EQU   X'05'              3705 CHECK                     S22024 14480000
LINE     EQU   X'01'              LINE TEST                      S22024 14560000
RNTERM   EQU   X'08'              RN TERMINAL                    S22024 14640000
RNLINE   EQU   X'04'              RN LINE                        S22024 14720000
RNCHAN   EQU   X'02'              RN SUBCHAN                     S22024 14800000
*                                                                S22024 14880000
         USING IEDQWC1,R15                                       S22024 14960000
IEDQWC1  IEDHJN STARC1,HJN                                              15040000
         DROP  R15                                                      15120000
         SPACE 2                                                        15200000
         SAVE  (14,12)            SAVE CALLER'S REG                     15280000
         SPACE                                                          15360000
         LR    R6,R15                   LOAD BASE                       15440000
         USING IEDQWC1,R6                                               15520000
         USING TOTOLTCB,R2                                              15600000
         LA    R3,TOTSAVE4        GET MY SAVE AREA ADDR                 15680000
         ST    R3,D8(R13)         STORE IN CALLER'S SAVE AREA           15760000
         ST    R13,D4(R3)         SAVE CALLER'S                         15840000
         LR    R13,R3                   SET R13 TO SAVE AREA            15920000
         XC    TOTTDTBL(D40),TOTTDTBL CLEAR TEST DEV TABLE              16000000
         L     R8,ACVT(R0)        CVT ADDR                              16080000
         USING CVT,R8                                                   16160000
         L     R9,AVTCVTPT(R8)            PICK UP DISPATCHER ADDR       16240000
         L     R7,CVTILK2              PICK UP 2 BYTE UCB TABLE         16320000
         ST    R7,UCBSAVE                                               16400000
         DROP  R8                                                       16480000
         L     R8,D0(R9)          AVT ADDR                              16560000
         USING IEDQAVTD,R8                                              16640000
         L     R7,AVTRNMPT             PICK UP ADDR OF TERMNAME TABLE   16720000
         ST    R7,TERNMTAB             SAVE IT                          16800000
         USING IEDQTNTD,R7                                              16880000
         IC    R9,TNTENLEN             PICK UP LENGTH OF ENTRY NAME     16960000
         STC   R9,TERNMLEN             SAVE IT                          17040000
         DROP  R7                                                       17120000
         MVC   PAREMLST(D1),AVTBSX SET UP FOR BIN. SRCH                 17200000
         L     R9,AVTMSGS-D1      VCON TABLE ADDR                       17280000
         L     R9,D8(R9)          ADDR OF A1 ROUTINE                    17360000
         ST    R9,AVTUISV                                               17440000
         LA    R9,AVTOPCOB             PICK UP ADDR OF OP CON QCB       17520000
         ST    R9,OCQCB                SAVE IT                          17600000
         DROP R8                                                        17680000
         SR    R5,R5              CLEAR REG 5                           17760000
         LA    R5,TRMLEN          GET TRM BFR LENGTH                    17840000
         BCTR  R5,R0              LENGTH MINUS ONE                      17920000
         LA    R3,TOTTRMBF        POINT TO TRM BUFFER                   18000000
         EX    R5,MOVE            MOVE TRM TO WORK AREA                 18080000
         LA    R10,TRMWRK               FIND TEST DEVICE FIELD          18160000
         TM    TOTFLG04,TOTNUMDV  NUMERIC TRM ENTRY             SA41614 18240000
         BZ    FLDFIND            NO                            SA41614 18320000
         LA    R9,D9              SET LIMIT                     SA41614 18400000
         OI    TOTFLG09,TOTPRECT  SET CT EQU AP FLAG            SA41614 18480000
TRMRTNH  EQU   *                                                SA41614 18560000
         CLI   D0(R10),SLASH      CHAR A '/'                    SA41614 18640000
         BE    TRMRTNH6           YES                           SA41614 18720000
         LA    R10,D1(R10)        CHECK NEXT CHAR               SA41614 18800000
         BCT   R9,TRMRTNH         CHECK NEXT CHAR               SA41614 18880000
*        ERROR EXIT - NO ENDING SLASH                           SA41614 18960000
         WTO   'IED127I OLT REQUEST REJECTED, CONTROL TERMINAL UNIDENTI*19040000
               FIED',ROUTCDE=10,DESC=7                          SA41614 19120000
         TM    TOTFLG05,TOTSRCON  TRM ENTERED FROM SYSCON      @Y17XAUU 19125000
         BO    GETOUT             YES                          @Y17XAUU 19130000
         IEDQMSG MSGID=077,FUNCT=SRC  SEND MSG TO SOURCE       @Y17XAUU 19135000
         B     GETOUT             EXIT TO IEDQWE                SA41614 19200000
TRMRTNH6 EQU   *                                                SA41614 19280000
         LA    R10,TRMWRK         ADDR OF TRM WORK AREA         SA41614 19360000
FLDFIND  EQU   *                                                        19440000
         CLI   D0(R10),SLASH      END OF CT FIELD                       19520000
         BE    TDFLD01                 YES BRANCH                       19600000
         LA    R10,D1(R10)        NO BUMP POINTER                       19680000
         B     FLDFIND            CHECK AGAIN                           19760000
TDFLD01  EQU   *                                                        19840000
         NI    TDFLG,XFF-RNTERM-RNLINE CLEAR INTERMEDIATE FLAG   S22024 19880000
         BAL   R9,TYPECHK         DETERMINE TYPE OF TEST         S22024 19920000
TDFLD    EQU   *                                                        20160000
         LA    R10,D1(R10)        BUMP PASS DELIMITER                   20240000
         TM    TDFLG,RNCHAN       RN SUBCHAN TEST                S22024 20320000
         BO    NUMDEV             YES                            S22024 20400000
         TM    TDFLG,RNTERM+RNLINE+SYM SYMBOLIC ENTRY            S22024 20480000
         BM    TDFLD1             YES                            S22024 20560000
         B     NUMDEV             NO - ASSUME LINE ENTRY         S22024 20640000
TDFLD1   EQU   *                                                        20720000
         MVC   WORK1(D9),D0(R10)  FIND LEN OF TEST DEV ENTRY            20800000
         LA    R7,D9              LOOP COUNT                            20880000
         LA    R4,D0              COUNTER                               20960000
         LA    R3,WORK1                                                 21040000
TDCHK    CLI   D0(R3),SLASH       END OF FIELD ?                        21120000
         BE    TDOK                    YES BRANCH                       21200000
         CLI   D0(R3),COMMA       END OF NAME ?                         21280000
         BE    TDOK1                   YES BRANCH                       21360000
         LA    R3,D1(R3)          BUMP POINTER                          21440000
         LA    R4,D1(R4)          INCREMENT COUNTER                     21520000
         BCT   R7,TDCHK                GO LOOK AGAIN                    21600000
         B     TDERR                   ERROR, NAME TOO LONG             21680000
MOVE     MVC   TRMWRK(D0),D0(R3)  MOVE TRM TO WORK AREA                 21760000
TDERR    EQU   *                                                        21840000
         OI    TOTFLG03,TOTTDFER  SHOW ERROR IN TEST DEVICE FIELD       21920000
         L     R13,D4(R13)        CALLER'S SAVE AREA ADDR               22000000
         LM    R14,R1,D12(R13)    RESTORE CALLER'S REG                  22080000
         XCTL  (2,12),EP=IEDQWJ                                         22160000
TDOK1    EQU   *                                                        22240000
         OI    TDFLG,MORE              TURN ON MORE ENTRIES FLAG        22320000
         LA    R7,D1              INITIALIZE COUNTER                    22400000
         A     R7,NUMBER                                                22480000
         ST    R7,NUMBER               ADD 1 TO NUMBER OF DEVICES       22560000
         B     TDOK5              CONTINUE PROCESSING                   22640000
TDOK     EQU   *                                                        22720000
         NI    TDFLG,END               TURN OFF MORE ENTRIES FLAG       22800000
TDOK5    EQU   *                       TURN ON SYMBOLIC FLAG            22880000
         LA    R7,D10             SET COMPARAND                  S22024 22960000
         C     R7,NUMBER               MORE THAN NINE DEVICES?          23040000
         BNL   TDOK2                   NO BRANCH                        23120000
         B     TDTLON             TOOO MANY TD ENTRIES           S22024 23200000
TDOK2    EQU   *                                                        23280000
         STC   R4,LENGTH                                                23360000
         LA    R9,D8              MAX NAME LENGTH                       23440000
         CR    R9,R4                   ALREADY HAVE 8 CHARS?            23520000
         BE    TDOK22                  YES BRANCH                       23600000
         SR    R9,R4                   GET NUMBER OF POSITIONS TO FILL  23680000
         LA    R1,WORK1                GET WORK AREA ADDRESS            23760000
         BCTR  R9,R0              DECREMENT FOR MOVE                    23840000
         AR    R1,R4                   POINT PAST NAME                  23920000
         EX    R9,BLMOVE          BLANK NAME WORK AREA                  24000000
TDOK22   EQU   *                                                        24080000
         ST    R10,REGSAVE              SAVE R2                         24160000
         LR    R10,R4                                                   24240000
         BAL   R9,NAMESRCH        VERIFY TEST TERMINAL NAME             24320000
         B     TDOK3                   BRANCH AROUND ERROR RETURN       24400000
         B     TDERR                   NAME NOT IN TABLE                24480000
BLMOVE   MVC   D0(D0,R1),BLANK    BLANK NAME WORK AREA                  24560000
TDOK3    EQU   *                                                        24640000
         L     R10,REGSAVE              RESTORE R2                      24720000
TDOK3A   EQU   *                                                        24800000
         TM    TDFLG,RNTERM+RNLINE+SYM NEED UCB                  S22024 24880000
         BZ    TDOK6              NO - BRANCH                    S22024 24960000
         BAL   R9,UCBFIND         FIND CUU FOR DEVICE                   25040000
         USING UCB,R8                                                   25120000
         CLI   UCBTBYT3,UCB3COMM       IS TERMINAL COMMUNICATION DEV?   25200000
         BNE   TRM1094                   NO                             25280000
         TM    UCBTBYT2,SWITCHS   SWITCHED/START STOP                   25360000
         BNZ   TRM1092                   YES                            25440000
         MVN   WORKAREA(1),UCBTBYT1    IS TERMINAL                      25520000
         MVZ   WORKAREA(D1),UCBTBYT4 SWITCHED TD                        25600000
         XI    WORKAREA,SWITCHB   BI-SYNC                               25680000
         BNZ   TRM1094                     NO                           25760000
TRM1092  EQU   *                                                        25840000
         OI    TOTFLG04,TOTTTSWT  SET SWITCHED TEST DEVICE FLAG         25920000
         OI    TOTFLG06,TOTNCMFG  SET NCM FLAG                          26000000
TRM1094  EQU   *                                                        26080000
         DROP  R8                                                       26160000
TDOK6    EQU   *                                                        26240000
         BAL   R9,PLUG                 GO PLUG LINE NO. IN OLTCB        26320000
TDOK7    EQU   *                                               @YA12402 26400058
         TM    TDFLG,INCLUS             INCLUSIVE?             @YA12402 26420058
         BO    TDOK9                    YES                    @YA12402 26440058
         TM    TDFLG,MORE               ANY MORE TO DO         @YA12402 26460058
         BO    TDOK4                   YES BRANCH                       26480000
TRM1099  EQU   *                                                        26560000
         BAL   R11,LINECHK        VERIFY THAT LINE IS OPENED            26640000
         BAL   R3,TERMSTAT        CHECK INIT STATUS OF TEST DEVICES     26720000
         L     R13,D4(R13)        CALLER'S SAVE AREA                    26800000
         LM    R14,R1,D12(R13)    CALLER'S REG                          26880000
         XCTL  (2,12),EP=IEDQWC2                                        26960000
TDOK4    EQU   *                                                        27040000
         TM    TDFLG,RNTERM+RNLINE+SYM SYMBOLICE                 S22024 27120000
         BM    TDOK8              YES - EXIT                     S22024 27200000
         B     TDFLD01            PROCESS NEXT ENTRY             S22024 27440000
TDOK8    EQU   *                                                        27520000
         LA    R10,D0(R4,R10)     POINT TO NEXT ENTRY                   27600000
         B     TDFLD01            PROCESS NEXT ENTRY             S22024 27680000
TDOK9    EQU   *                                                        27760000
*                                                                       28080000
*              ROUTINE TO CHANGE CUU TO NEXT ONE IN ORDER               28160000
*                                                                       28240000
         SR    R3,R3                                                    28400000
         IC    R3,WORK1+D2        LAST DIGIT                            28480000
         LA    R4,KF              HEX 15                                28560000
         CR    R3,R4                   FIND IF 0-9 OR A-F               28640000
         BL    BUMP1                   A-E                              28720000
         BE    BUMP2                   F?                               28800000
         LA    R4,F9              HEX 9                                 28880000
         CR    R3,R4                   9?                               28960000
         BE    BUMP3                   YES                              29040000
BUMP1    EQU   *                                                        29120000
         LA    R3,D1(R3)          ADD 1 TO DIGIT                        29200000
BUMP1A   EQU   *                                                        29280000
         STC   R3,WORK1+D2        CHANGE CUU                            29360000
         CLC   WORK3,WORK1                                              29440000
         BE    TURNOFF                 LAST DEVICE INCLUSIVE            29520000
         B     TURNOFF1           CONTINUE PROCESSING                   29600000
TURNOFF  NI    TDFLG,NOINC             TURN OFF INCLUSIVE FLG           29680000
TURNOFF1 EQU   *                                                        29760000
         BAL   R9,UCBLOOK               GO FIND UCB ADDR       @YA12402 29800058
         LA    R7,D1              SET INCREMENT                         29840000
         A     R7,NUMBER               ADD ONE TO NUMBER                29920000
         ST    R7,NUMBER               STORE IT                         30000000
         LA    R7,D10             SET COMPARAND                  S22024 30080000
         C     R7,NUMBER               GT THAN 9 DEVICES?               30160000
         BNL   TDOK6                   NO BRANCH                        30240000
         B     TDTLON             TOO MANY TD ENTRIES            S22024 30320000
BUMP2    EQU   *                                                        30400000
         IC    R3,WORK1+D1        PICK UP SECOND DIGIT                  30480000
         CR    R3,R4                                                    30560000
         BL    BUMP2A                  A-E?                             30640000
         BE    TDERR                   F TOO LARGE A NUMBER             30720000
         LA    R4,F9              SET COMPARAND                         30800000
         CR    R3,R4                   9?                               30880000
         BE    BUMP2C                  YES                              30960000
BUMP2A   EQU   *                                                        31040000
         LA    R3,D1(R3)          ADD TO SECOND DIGIT                   31120000
         STC   R3,WORK1+D1        SAVE                                  31200000
         LA    R3,F0              CHANGE LAST DIGIT TO F0               31280000
         B     BUMP1A             MAKE NEXT CHECK                       31360000
BUMP2C   EQU   *                                                        31440000
         LA    R3,XC0             SET COMPARAND                         31520000
         B     BUMP2A             MAKE NEXT CHECK                       31600000
BUMP3    EQU   *                                                        31680000
         LA    R3,XC0             SET COMPARAND                         31760000
         B     BUMP1              GO INCREMENT NUMBER                   31840000
         EJECT                                                          35120000
*                                                                       35200000
*                                                                       35280000
*              ROUTINE TO HANDLE TEST DEVICE ENTERED AS CUU             35360000
*                                                                       35440000
*                                                                       35520000
NUMDEV   EQU   *                                                        35600000
         CLI   D0(R10),NUMER            IS FIRST CHAR ZERO     @YA12402 35608058
         BNE   DIGIT3                   NO                     @YA12402 35616058
         TM    D3(R10),XC0              IS 4TH CHAR ALPHANUM   @YA12402 35624058
         BNO   DIGIT3                   NO                     @YA12402 35632058
         SPACE 1                                               @YA12402 35640058
         LA    R10,D1(R10)              ADJUST FOR LEADING ZERO@YA12402 35648058
         SPACE 1                                               @YA12402 35656058
DIGIT3   EQU   *                                               @YA12402 35664058
         MVC   WORK1(D3),D0(R10)  MOVE CUU TO WORK AREA                 35680000
         BAL   R9,UCBLOOK               GO FIND UCB ADDR       @YA12402 35760058
UCBEND1  EQU   *                                                 S22024 37440000
         CLI   D3(R10),SLASH      END OF FIELD                          37520000
         BE    UCBEND3                 YES BRANCH                       37600000
         CLI   D3(R10),COMMA      ANOTHER ENTRY                         37680000
         BE    UCBEND4                 YES BRANCH                       37760000
         CLI   D3(R10),DASH#      INCLUSIVE DEVICE                      37840000
         BE    UCBEND5                 YES BRANCH                       37920000
         B     TDERR                   NO DELIMITER                     38000000
UCBEND3  EQU   *                                                        38080000
         NI    TDFLG,END               TURN OFF MORE ENTRIES FLAG       38160000
         LA    R7,D9              SET COMPARAND                  S22024 38240000
         C     R7,NUMBER               MORE THAN 9 DEVICES?             38320000
         BNL   TDOK6              NO - CONTINUE PROCESSING              38400000
UCBEND4  EQU   *                                                        38480000
         OI    TDFLG,MORE              TURN ON MORE FLAG                38560000
         LA    R10,D3(R10)        BUMP PASS CUU                         38640000
         LA    R7,D1              ADD ONE TO COUNTER                    38720000
         A     R7,NUMBER                                                38800000
         ST    R7,NUMBER                                                38880000
         LA    R7,D10             SET COMPARAND                  S22024 38960000
         C     R7,NUMBER                                                39040000
         BL    TDTLON             ERROR - TOO MANY TD ENTRIES    S22024 39120000
         B     TDOK3A             NO BRANCH                      S22024 39200000
UCBEND5  EQU   *                                                        39280000
         LR    R4,R10                                                   39360000
         LA    R10,D4(R10)        POINT PAST DASH                       39440000
         LA    R3,D5              SET LOOP COUNT                        39520000
         LA    R7,D0              INIT COUNTER                          39600000
DASH     CLI   D0(R10),COMMA      END OF ENTRY ?                        39680000
         BE    DASH1A                   YES                    @YA12402 39760058
         CLI   D0(R10),SLASH      END OF FIELD ?                        39840000
         BE    DASH2                   YES BRANCH                       39920000
         LA    R10,D1(R10)        BUMP POINTER                          40000000
         LA    R7,D1(R7)          INCREMENT COUNTER                     40080000
         BCT   R3,DASH                  CHECK CHAR AGAIN       @YA12402 40120058
         B     TDERR                   ERROR TOO MANY DIGITS AFTER DAS  40160000
DASH1A   EQU   *                                               @YA12402 40180058
         OI    TDFLG,MORE               MORE TO DO             @YA12402 40200058
DASH1    EQU   *                                                        40240000
         C     R7,F4                    4 DIGITS?              @YA12402 40320058
         BE    DASH3                   YES BRANCH                       40400000
         C     R7,K3              3 DIGITS                              40480000
         BE    DASH10                  YES BRANCH                       40640000
         B     TDERR                   WRONG NUMBER OF DIGITS           40720000
DASH3    EQU   *                                                        40800000
         LA    R4,D1(R4)                ADJUST FOR LEADING ZERO@YA12402 40880058
DASH10   EQU   *                                                        41280000
         OI    TDFLG,INCLUS            TURN ON INCLUSIVE FLAG           41360000
         MVC   WORK3(D3),D4(R4)   MOVE END CUU TO SAVE                  41440000
DASH11   EQU   *                                                        41520000
         LA    R7,D1              ADD ONE TO NUMBER                     41680000
         A     R7,NUMBER                                                41760000
         ST    R7,NUMBER                                                41840000
         LA    R7,D10             SET COMPARAND                  S22024 41920000
         C     R7,NUMBER               MORE THAN 9 DEVICES?             42000000
         BNL   TDOK6              NO                                    42080000
         B     TDERR                   TOO MANY DECVICES                42160000
DASH2    EQU   *                                                        42240000
         NI    TDFLG,ALLOFF            TURN OFF ALL THE FLAGS           42320000
         B     DASH1              CHECK NEXT NUMBER                     42400000
         EJECT                                                          42403058
*                                                              @YA12402 42406058
*                                                              @YA12402 42409058
*    ROUTINE TO LOOK UP UCB ENTRY,                             @YA12402 42412058
*     GIVEN THE CUU                                            @YA12402 42415058
*                                                              @YA12402 42418058
*                                                              @YA12402 42421058
UCBLOOK  EQU   *                                               @YA12402 42424058
         L     R8,UCBSAVE               GET ADDR OF UCB PTRS   @YA12402 42427058
         USING UCB,R7                                          @YA12402 42430058
UCBLOOK1 EQU   *                                               @YA12402 42433058
         SLR   R7,R7                    CLEAR                  @G36XRUV 42434010
         ICM   R7,3,D0(R8)              LOAD UCB ADDR          @G36XRUV 42436010
         LA    R8,D2(R8)                POINT TO NEXT ENTRY    @YA12402 42439058
         BZ    UCBLOOK1                 PADDING IGNORE         @YA12402 42445058
         CLM   R7,3,ENDTABLE            AT END OF UCB TABLE    @G36XRUV 42446010
         BE    TDERR                    Y-ERROR                @G36XRUV 42447010
         ST    R7,WORK4                 SAVE UCB ADDR          @YA12402 42451058
         CLC   WORK1(D3),UCBNAME        MATCH?                 @YA12402 42454058
         BNE   UCBLOOK1                 NO GO LOOK AGAIN       @YA12402 42457058
*********************************************************************** 42457110
*        THE FOLLOWING CODE IS MVS UNIQUE. IT CHECKS FOR 3270  @G36XRUV 42457210
*        LOCAL AND 3705 USING THE UCB. IF THE DEVICE IS EITHER,@G36XRUV 42457310
*        IT IS AN ERROR. NOTE: THE MEANINGS OF THE UCB BITS MAY@G36XRUV 42457410
*        CHANGE IN THE FUTURE NECESSITATING CHANGES TO THIS    @G36XRUV 42457510
*        CODE.                                                 @G36XRUV 42457610
*********************************************************************** 42457710
         MVC   WORK2(D1),UCBTBYT4       MOVE TYPE TO WORK AREA @G36XRUV 42457810
         TM    UCBDVCLS,UCB3DISP        Q-GRAPHICS DEVICE      @G36XRUV 42457910
         BNO   NCPCHK                   N-CHECK FOR NCP        @G36XRUV 42458010
         TM    WORK2,XF0                Q-ANY HI BITS ON       @G36XRUV 42458110
         BNZ   NCPCHK                   N-NOT 3270             @G36XRUV 42458210
         CLI   WORK2,X09                Q-IN 3270 RANGE        @G36XRUV 42458310
         BL    NCPCHK                   N-CHECK FOR NCP        @G36XRUV 42458410
         B     GETOUT1                  3270 LOCAL - ERROR     @G36XRUV 42458510
NCPCHK   DS    0H                                              @G36XRUV 42458610
         NI    WORK2,X0F                CLEAR HI BITS          @G36XRUV 42458710
         CLI   WORK2,TCU3705            3705?                  @G36XRUV 42458810
         BNER  R9                       RETURN                 @G36XRUV 42458910
         B     GETOUT1                  3705 - ERROR           @G36XRUV 42459010
         EJECT                                                          42480000
*              ROUTINE TO SEARCH TERMNAME TABLE. R3 HAS ADDR OF         42560000
*              START OF TABLE. WORK1 HAS NAME IN IT. R2 HAS LENGTH      42640000
*                                                                       42720000
NAMESRCH EQU   *                                                        42800000
         LA    R1,PAREMLST              SET R1                          42880000
         L     R15,AVTUISV                                              42960000
         LH    R0,TWO(R1)         LOAD CHAR STRING LEN                  43040000
         L     R1,FOUR(R1)        LOAD ADDR OF CHARS                    43120000
         BAL   R14,FOUR(R15)      BRANCH TO SCAN ROUTINE                43200000
         LTR   R15,R15                                                  43280000
         BZ    D4(R9)             NAME NOT FOUND                        43360000
         SPACE                                                          43440000
         STM   R7,R9,TRMSAV1      SAVE REG 7-9                          43520000
         L     R8,TERNMTAB        SET START OF TABLE                    43600000
         USING IEDQTNTD,R8                                              43680000
         LA    R7,TNTFIRST        POINT TO FIRST ENTRY OF TABLE         43760000
         SR    R9,R9              CLEAR REG 9                           43840000
         IC    R9,TNTENLEN        GET MAX. LENGTH OF NAME FIELD         43920000
         LA    R9,D3(R9)          LENGTH OF 1 ENTRY                     44000000
         DROP  R8                                                       44080000
         BCTR  R15,R0             DECREMENT REL POSITION COUNT          44160000
         MR    R8,R15             GET DISPLACEMENT TO ENTRY DESIRED     44240000
         AR    R7,R9              GET DESIRED TNT ADDRESS               44320000
         ST    R7,TRMTNT          SAVE IT                               44400000
         LA    R1,D1(R15)         RESTORE REL POSITION COUNT            44480000
         LM    R7,R9,TRMSAV1      RESTORE REG                           44560000
         L     R15,TERNMTAB                                             44640000
         BALR  R14,R15            GET TTE ADDR                          44720000
         ST    R1,TNTENTRY                                              44800000
         USING IEDQTRM,R1                                        S22024 44808000
         TM    TRMDSORG,TRMLGB    LGB RATHER THAN A TTE          S22024 44810000
         BO    D4(R9)             YES - ERROR - NOT A TERMINAL   S22024 44812000
         L     R1,TRMDESTQ-D1     DEST. QCB ADDR                 S22024 44816000
         DROP  R1                                                S22024 44824000
         USING IEDQQCB,R1                                        S22024 44832000
         LA    R1,D0(R1)          CLEAR HI ORDER BYTE            S22024 44840000
         TM    QCBFLAG,QCBTSSES   TSO TERMINAL                  SA61759 44848000
         BO    TRMTSO             YES - ERROR EXIT               S22024 44856000
         DROP R1                                                 S22024 44864000
         BR    R9                 RETURN TO CALLER                      44880000
         SPACE                                                          44890000
TRMTSO   DS    0H                 BOUNDARY ALLIGNMENT            S22024 44900000
         IEDQMSG MSGID=011,FUNCT=CEC TSO TEST DEVICE             S22024 44910000
         B     GETOUT             TERMINATE TRM                  S22024 44920000
         EJECT                                                          44960000
*                                                                       45040000
*                                                                       45120000
*        ROUTINE TO FIND UCB ADDR AFTER ENTRY IN TERMINAL TABLE HAS     45200000
*        BEEN FOUND                                                     45280000
*                                                                       45360000
*                                                                       45440000
UCBFIND  EQU   *                                                        45520000
         L     R8,TNTENTRY                                              45600000
         USING IEDQTRM,R8                                               45680000
         L     R8,TRMDESTQ-D1     GET QCB ADDR                          45760000
         DROP  R8                                                       45840000
         USING IEDQQCB,R8                                               45920000
         SR    R7,R7                   GET RELATIVE                     46000000
         IC    R7,QCBRELLN          RELATIVE LINE NUMBER                46080000
         SLL   R7,2                    MULT BY 4                        46160000
         L     R8,QCBDCBAD-1      GET DCB ADDRESS                       46240000
         DROP  R8                                                       46320000
         USING IHADCB,R8                                                46400000
         TM    DCBDSORG,LGBA      LGB VS. DCB                    S22024 46480000
         BZ    UCB0X              NO                             S22024 46560000
         DROP  R8                                                S22024 46640000
         L     R1,TNTENTRY        GET TERMINAL TTE ADDRESS     @Y17XAUU 46641000
         BAL   R14,NCPTTE         GET NCP TTE ADDRESS          @Y17XAUU 46642000
*                                                              @Y17XAUU 46643000
*        ON RETURN R1 CONTAINS ADDRESS OF NCP TTE PREFIX       @Y17XAUU 46644000
*                                                              @Y17XAUU 46645000
         USING IEDNTRM,R1         ESTABLISH ADDRESSABILITY     @Y17XAUU 46646000
         LA    R7,D4              SHOW RLN EQU 1                 S22024 46880000
         TM    TRMBYTE2,TRMRSACT  3705 ACTIVE                  @Y17XAUU 46886000
         BO    UCB0X1             YES - CONTINUE               @Y17XAUU 46892000
UCBNACT  EQU   *                                               @Y17XAUU 46992000
         IEDQMSG MSGID=010,FUNCT=CEC MSG                         S22024 47120000
         B     TDERR              ERROR EXIT                     S22024 47200000
UCB0X1   EQU   *                                               @Y17XAUU 47201000
         L     R1,TRMDESTQ-D1     GET 3705 QCB ADDRESS         @Y17XAUU 47202000
         DROP  R1                                              @Y17XAUU 47203000
         USING IEDQQCB,R1         ESTABLISH ADDRESSABILITY     @Y17XAUU 47204000
         L     R8,QCBDCBAD-D1     GET 3705 DCB ADDRESS         @Y17XAUU 47205000
         DROP  R1                                              @Y17XAUU 47206000
UCB0X    EQU   *                                                 S22024 47280000
         USING IHADCB,R8                                         S22024 47440000
         TM    DCBOFLGS,DCBOPEN   DCB OPEN                              47520000
         BZ    NOOPEN                  NO BRANCH                        47600000
         L     R8,DCBDEBAD        GET DEB ADDRESS                       47680000
         DROP  R8                                                       47760000
         USING DEBNMSUB,R8                                              47840000
         SR    R15,R15                                                  47920000
         IC    R15,DEBNMEXT       GET NUMBER OF EXTENTS                 48000000
         SLL   R15,2                MULTIPLY BY 4                       48080000
         CR    R15,R7             IS DESIRED LINE OPENED?               48160000
         BL    NOOPEN               NO                                  48240000
         L     R8,DEBUCBAD-D4(R7) UCB ADDR                              48320000
         USING UCB,R8                                                   48400000
         MVC   WORK1(D3),UCBNAME  MOVE UCB ID IN EBCDIC                 48800000
         MVC   WORK2(D2),UCBCHA   MOVE UCB ID IN HEX                    48880000
         DROP  R8                                                       48960000
         MVI   WORK2+D2,D0        CLEAR HI ORDER BYTE                   49040000
         NI    WORK2,X0F          MASK OFF UNWANTED BITS                49120000
         BR    R9                      RETURN                           49200000
NOOPEN   EQU   *                                                        49280000
         MVC   CEOUT2(D8),WORK1   PUT TERMINAL NAME IN MSG              49360000
         SPACE                                                          49440000
*                                                                       49520000
*        TEST LINE NOT OPEN                                             49600000
*                                                                       49680000
         SPACE                                                          49760000
         IEDQMSG OTBUF=CEOUT2A,OTCNT=CEOUT2E-CEOUT2A,FUNCT=CEC,LINK=YES 49840000
         SPACE                                                          49920000
         B     TDERR              GO TO PROMPTER                        50000000
         EJECT                                                          50001000
************************************************************** @Y17XAUU 50002000
*        ROUTINE TO FIND NCP TTE ADDRESS. INPUT: REG1 =      * @Y17XAUU 50003000
*        TERMINAL TTE ADDRESS. OUTPUT: REG 1 = NCP TTE PREFIX* @Y17XAUU 50004000
*        ADDRESS. RETURN TO CALLER VIA REG 14.               * @Y17XAUU 50005000
************************************************************** @Y17XAUU 50006000
NCPTTE   EQU   *                                               @Y17XAUU 50007000
         ST    R14,TRMSAVE2       SAVE RETURN ADDRESS          @Y17XAUU 50008000
         LA    R8,TRMPRFSZ        GET TTE PREFIX SIZE          @Y17XAUU 50009000
         SLR   R1,R8              POINT TO TTE PREFIX          @Y17XAUU 50010000
         USING IEDNTRM,R1         ESTABLISH ADDRESSABILITY     @Y17XAUU 50011000
NCPLOOP  EQU   *                                               @Y17XAUU 50012000
         LH    R1,TRMCOHRT        GET COHORT POINTER           @Y17XAUU 50013000
         LTR   R1,R1              ENTRY IN HIERARCHY           @YM07415 50013300
         BZ    UCBNACT            NO - ERROR RETURN            @YM07415 50013600
         L     R15,TERNMTAB       TTCIN TO TTE CONVERSION      @Y17XAUU 50014000
*                                 ROUTINE ADDRESS              @Y17XAUU 50015000
         BALR  14,R15             FIND TTE ADDRESS             @Y17XAUU 50016000
         SLR   R1,R8              POINT TO TTE PREFIX          @Y17XAUU 50017000
         CLI   TRMTYPE,TRMLNCP    NCP ENTRY                    @Y17XAUU 50018000
         BNE   NCPLOOP            NO - CHECK NEXT ENTRY        @Y17XAUU 50019000
         L     R14,TRMSAVE2       RESTORE RETURN ADDRESS       @Y17XAUU 50020000
         BR    R14                RETURN TO CALLER             @Y17XAUU 50021000
         DROP  R1                                              @Y17XAUU 50022000
         EJECT                                                          50080000
GETOUT1  DS    0H                                              @G36XRUV 50100010
         IEDQMSG MSGID=094,FUNCT=CEC                           @G36XRUV 50120010
GETOUT   EQU   *                                                        50160000
         OI    TOTFLG06,TOTOTERM  SET TERMINATE FLAG                    50240000
         L     R13,D4(R13)        CALLER'S SAVE AREA                    50320000
         LM    R14,R1,D12(R13)    CALLER'S REG                          50400000
         XCTL  (2,12),EP=IEDQWE                                         50480000
NOOPEN2  EQU   *                                                        50560000
         L     R9,REGSAVE              RESTORE RETURN REG               50640000
         BR    R9                      RETURN                           50720000
         SPACE 4                                                        50800000
**************************************************************** S22024 50880000
**************************************************************** S22024 50960000
*        ERROR EXIT - MORE THAN 10 TEST DEVICES                * S22024 51040000
TDTLON   EQU   *                                                 S22024 51120000
         IEDQMSG MSGID=000,FUNCT=CEC MORE THAN 10 TEST DEVICES   S22024 51200000
         B     TDERR              EXIT TO PROMPTER               S22024 51280000
         EJECT                                                          51360000
*                                                                       51440000
*        FIND LCB ADDR FOR LINE ENTRY IN TEST DEVICE TABLE.             51520000
*        THE UCB NAME IS PASSED TO THIS ROUTINE.                        51600000
*        THE LCB ADDRESS IS RETURN TO THE CALLER.                       51680000
*                                                                       51760000
LCBFIND  EQU   *                                                        51840000
         STM   R1,R12,REGSAVE     SAVE CALLER'S REG                     51920000
NOUCBAD  EQU   *                                                        52000000
         L     R1,ACVT(R0)        CVT ADDR                              52080000
         L     R1,AVTCVTPT(R1)         GET TCAM DISP ADDR               52160000
         L     R1,D0(R1)          AVT ADDR                              52240000
         USING IEDQAVTD,R1                                              52320000
         L     R1,AVTTCB               GET TCB ADDR                     52400000
         DROP  R1                                                       52480000
         L     R1,D8(R1)          DEB CHAIN ADDR                        52560000
AGAIN    DS    0H                 ALLIGN ON HALFWORD BOUNDARY    S22024 52640000
         SR    R3,R3              CLEAR REG                      S22024 52720000
         IC    R3,D16(R1)         NUMBER OF EXTENTS                     52800000
         LA    R5,D32(R1)         UCB CHAIN ADDR                        52880000
         L     R4,D24(R1)         DCB ADDR                              52960000
         USING IHADCB,R4                                         S22024 53040000
         TM    DCBDSORG,LGBA      LGB VS. DCB                    S22024 53120000
         BZ    HERE0              NO                             S22024 53200000
         DROP  R4                                                S22024 53280000
         L     R1,TNTENTRY        GET TERMINAL TTE ADDRESS     @Y17XAUU 53280800
         BAL   R14,NCPTTE         FIND NCP TTE ADDRESS         @Y17XAUU 53281600
         USING IEDNTRM,R1         ESTABLISH ADDRESSABILITY     @Y17XAUU 53282400
         L     R7,TRMDESTQ-D1     GET QCB ADDRESS              @Y17XAUU 53283200
         DROP  R1                                              @Y17XAUU 53284000
         USING IEDQQCB,R7         ESTABLISH ADDRESSABILITY     @Y17XAUU 53284800
         L     R4,QCBDCBAD-D1     GET NCP DCB ADDRESS          @Y17XAUU 53285600
         DROP  R7                                              @Y17XAUU 53286400
         USING IHADCB,R4                                         S22024 53600000
HERE0    EQU   *                                                 S22024 53680000
         L     R12,D4(R1)         NEXT DEB ADDR                         53760000
         TM    DCBDSORG+D1,TCAMDEB TCAM DEB                             53840000
         BZ    HERE1                   NO BRANCH                        53920000
         MVC   LCBLEN(D1),DCBEIOBX GET LCB SIZE                         54000000
         LA    R8,D1              COUNTER                               54080000
HERE     EQU   *                                                        54160000
         L     R9,D0(R5)          UCB ADDR                              54240000
         CLC   WORK1(D3),D13(R9)  CUU MATCH                             54320000
         BE    THERE                   YES BRANCH                       54400000
         LA    R8,D1(R8)          BUMP COUNTER                          54480000
         LA    R5,D4(R5)          BUMP UCB ADDR PTR                     54560000
         BCT   R3,HERE                 GO LOOK AGAIN                    54640000
HERE1    EQU   *                                                        54720000
         LA    R12,D0(R12)        CLR HI ORDER BYTE                     54800000
         LTR   R12,R12                 ANY MORE DEBS?                   54880000
         BZ    BADRET                  NO BRANCH                        54960000
         LR    R1,R12                  SET R1 TO NEXT DEB               55040000
         B     AGAIN                   GO LOOK AT NEXT DEB              55120000
BADRET   EQU   *                                                        55200000
         LM    R1,R12,REGSAVE     RESTORE REG                           55280000
         B     D4(R9)             RETURN                                55360000
THERE    EQU   *                                                        55440000
         USING UCB,R9                                            S22024 55520000
         MVC   RNWORK(D1),UCBTBYT4 TCU TYPE BYTE                 S22024 55600000
         NI    RNWORK,X0F         CLEAR UNWANTED BITS            S22024 55680000
         CLI   RNWORK,TCU3705     3705 TCU                       S22024 55760000
         BNE   THERE2             NO                             S22024 55840000
         LA    R8,D1              SET RLN EQU 1                  S22024 55920000
         DROP  R9                                                S22024 56000000
THERE2   EQU   *                                                 S22024 56080000
         STC   R8,RLN                  STORE THE REL LIN NO.            56160000
         STC   R8,MULT+D3         SET UP MULTIPLIER                     56240000
         L     R8,DCBIOBAD            PICK UP LCB IOB ADDR              56320000
         SR    R10,R10                                                  56400000
         SR    R11,R11                                                  56480000
         IC    R11,LCBLEN               SET R3 TO SIZE OF LCB           56560000
         M     R10,MULT                 MULTIPLY                        56640000
         LA    R8,D0(R11,R8)      IOB OF DESIRED LCB                    56720000
         S     R8,K32             ADJUST TO START OF LCB                56800000
         ST    R8,WORK1           SAVE UCB ADDR                         56880000
         LM    R1,R12,REGSAVE     RESTORE REG                           56960000
         BR    R9                      RETURN                           57040000
         DROP  R4                                                       57120000
         EJECT                                                          57200000
*                                                                       57280000
*        ROUTINE TO DETERMINE INITIAL STATUS OF                         57360000
*        TERMINAL TEST DEVICES                                          57440000
*                                                                       57520000
TERMSTAT EQU   *                                                        57600000
         TM    TOTFLG10,TOTTERMS  TERMINAL TEST ?                       57680000
         BZ    LINESTAT           NO - LINE TEST                        57760000
         LA    R12,TOTTDTBL       POINT TO TEST DEVICE TABLE            57840000
         LA    R11,TOTTDEND       POINT TO END OF TABLE                 57920000
STAT2    EQU   *                                                        58000000
         CR    R12,R11            END OF TABLE ?                        58080000
         BE    ZERO(R3)           YES - RETURN                          58160000
         L     R7,D0(R12)         GET TNT ADDR                          58240000
         LA    R7,D0(R7)          CLEAR HI ORDER BYTE                   58320000
         LTR   R7,R7              LAST ENTRY ?                          58400000
         BZ    ZERO(R3)           YES - RETURN                          58480000
         ST    R7,TDTNT           SAVE TD TNT ADDRESS          @YM08136 58520000
         MVI   RQLADR,SPACE       BLANK NAME FIELD                      58560000
         MVC   RQLADR+D1(D7),RQLADR  IN REQUEST ELEMENT                 58640000
         SR    R10,R10            CLEAR REG                             58720000
         IC    R10,TOTTTBEL       GET MAX NAME LENG9H                   58800000
         LR    R9,R10             SAVE LENGTH                           58880000
         BCTR  R9,R0              DECREMENT FOR EX                      58960000
         EX    R9,RQMOVE          MOVE NAME TO REQ ELEMENT              59040000
         AR    R7,R10             POINT TO TTE ADDR                     59120000
         MVC   TTEADDR+D1(D3),D0(R7) ALLIGN ADDR                        59200000
         L     R8,TTEADDR         GET TTE ADDR                          59280000
         LA    R1,TRMPRFSZ        GET TTE PREFIX SIZE          @Y17XAUU 59300000
         SLR   R8,R1              POINT TO TTE PREFIX          @Y17XAUU 59320000
         USING IEDNTRM,R8                                      @Y17XAUU 59360000
         CLI   TRMTYPE,TRMLUNT    LU ENTRY                     @Y17XAUU 59380000
         BE    STAT16             YES - BYPASS INIT STATUS     @Y17XAUU 59400000
         L     R8,TRMDESTQ-D1     GET QCB ADDR                          59440000
         DROP  R8                                                       59520000
         USING IEDQQCB,R8                                               59600000
         MVC   RQRLN(D1),QCBRELLN SAVE RLN IN OP CONTROL PLIST          59680000
         TM    QCBSTAT,QCBTRMHO   TERMINAL INITIALLY HELD ?             59760000
         BZ    STAT6              NO                                    59840000
         OI    D0(R12),TOTTDTHD   SHOW INIT HELD                        59920000
STAT6    EQU   *                                                        60000000
         L     R9,TOTAVTPT        GET AVT ADDR                          60080000
         TM    TOTFLG04,TOTTTSWT  TEST DEVICE SWITCHED ?                60160000
         BO    STAT12             YES - TERMINAL ACTIVE          S22024 60240000
*                                                                       60243000
*        IF THE TEST ENTRY IS AN NCP PRE SNA RESOURCE AND      @YM08136 60246000
*        EQUAL TO THE CONTROL TERMINAL OR ALTERNATE PRINTER    @YM08136 60249000
*        BYPASS ISSUING AN INACTIVATE FOR THE RESOURCE.        @YM08136 60252000
*                                                                       60255000
         SLR   R1,R1              CLEAR REGISTER               @YM08136 60258000
         ICM   R1,ADRMSK,TOTCRTNT+D1 GET CT TNT ADDRESS        @YM08136 60261000
         BZ    CHKAP              CHECK AP IF CT NOT TERMINAL  @YM08136 60264000
         CL    R1,TDTNT           CT EQU TD                    @YM08136 60267000
         BE    CHKTYPE            YES - CHECK FOR PRE SNA TERM @YM08136 60270000
CHKAP    EQU   *                                               @YM08136 60273000
         SLR   R1,R1              CLEAR REG                    @YM08136 60276000
         ICM   R1,ADRMSK,TOTARTNT+D1 GET AP TNT ADDRESS        @YM08136 60279000
         BZ    CHKEND             GO - INACTIVATE RESOURCE     @YM08136 60282000
         CL    R1,TDTNT           AP EQU TD                    @YM08136 60285000
         BNE   CHKEND             NO - GO INACTIVATE RESOURCE  @YM08136 60288000
CHKTYPE  EQU   *                                               @YM08136 60291000
         L     R1,TTEADDR         GET TTE ADDRESS              @YM08136 60294000
         LA    R15,TRMPRFSZ       GET TTE PREFIX SIZE          @YM08136 60297000
         SLR   R1,R15             POINT TO TTE PREFIX          @YM08136 60300000
         USING IEDNTRM,R1         SET TTE ADDRESSABILITY       @YM08136 60303000
         CLI   TRMTYPE,TRMPSNA    NCP PRE SNA TERMINAL         @YM08136 60306000
         BE    STAT12             YES - PROCESS NEXT TD ENTRY  @YM08136 60309000
CHKEND   EQU   *                                               @YM08136 60312000
         LA    R1,TOTOTECB        GET ECB ADDR                          60320000
         ST    R1,RQECBA          PUT IN REQ ELEMENT                    60400000
         L     R5,TOTAVTPT        GET AVT ADDR                          60480000
         USING IEDQAVTD,R5                                              60560000
         LA    R14,AVTOPCOB       GET OP CONTROL QCB ADDR               60640000
         DROP  R5                                                       60720000
         ST    R14,RQQCBA-D1      PUT IN QCB ADDR                       60800000
         MVI   RQVBCD,INACT       INACTIVATE VERB CODE           S22024 60880000
         XC    RQLINK(D3),RQLINK  CLEAR LINK FIELD                      60960000
         XC    TOTOTECB(D4),TOTOTECB CLEAR ECB                          61040000
         MVC   TOTPLIST(RQND-RQELE),RQELE ELEMENT TO OLTCB       S22024 61120000
         LA    R1,TOTPLIST        ADDR OF ELEMENT                S22024 61130000
         ST    R1,TRMSLPL         PUT IN PLIST                   S22024 61140000
         ST    R1,TRMSLPL+D4      PUT IN PLIST                   S22024 61150000
         MVI   TRMSLPL,RQINIT     SET INITIAL ELEMENT FLAG       S22024 61160000
         MVI   TRMSLPL+D4,RQEND   SET LAST ELEMENT FLAG          S22024 61170000
         LA    R1,TRMSLPL         ADDR OF PLIST                  S22024 61180000
*                                                                       61200000
         AQCTL                    ISSUE ACTIVATE COMMAND                61280000
         WAIT  ECB=TOTOTECB                                             61360000
*                                                                       61440000
         MVC   RQRTCD(D1),TOTORTCD RETURN CODE                   S22024 61480000
         CLI   RQRTCD,INACTRC     INIT INACTIVE                  S22024 61520000
         BNE   STAT12             NO - ACTIVE                    S22024 61600000
STAT10   EQU   *                                                        61680000
         OI    D0(R12),TOTTDIAC   SHOW THAT LIST INACTIVE               61760000
STAT12   EQU   *                  FIND LCB ADDR                         61840000
         L     R9,QCBDCBAD-D1     GET DCB ADDR                          61920000
         USING IHADCB,R9                                                62000000
         TM    DCBDSORG,LGBA      LGB VS. DCB                    S22024 62080000
         BZ    STAT13             NO                             S22024 62160000
         DROP  R9                                                S22024 62240000
         L     R1,TNTENTRY        GET TERMINAL TTE ADDRESS     @Y17XAUU 62240800
         BAL   R14,NCPTTE         FIND NCP TTE ADDRESS         @Y17XAUU 62241600
         USING IEDNTRM,R1         ESTABLISH ADDRESSABILITY     @Y17XAUU 62242400
         L     R9,TRMDESTQ-D1     GET QCB ADDRESS              @Y17XAUU 62243200
         USING IEDQQCB,R9         ESTABLISH ADDRESSABILITY     @Y17XAUU 62244000
         L     R9,QCBDCBAD-D1     GET 3705 DCB ADDRESS         @Y17XAUU 62244800
         DROP  R1                                              @Y17XAUU 62245600
         DROP  R9                                              @Y17XAUU 62246400
         USING IHADCB,R9                                         S22024 62560000
STAT13   EQU   *                                                 S22024 62640000
         L     R7,DCBDEBAD        GET DEB ADDR                          62720000
         USING DEBNMSUB,R7                                              62800000
         SR    R15,R15            CLEAR REG                             62880000
         IC    R15,DEBNMEXT       GET DEB NUMBER OF EXTENTS             62960000
         DROP  R7                                                       63040000
         SR    R7,R7              CLEAR REG                             63120000
         IC    R7,QCBRELLN        GET RLN                        S22024 63200000
         TM    D0(R12),TOTTDORN   TD ON 3705                     S22024 63280000
         BZ    STAT14             NO                             S22024 63360000
         L     R5,TTEADDR         GET TTE ADDR                   S22024 63440000
         LA    R1,TRMPRFSZ        GET TTE PREFIX SIZE          @Y17XAUU 63440200
         SLR   R5,R1              POINT TO TTE PREFIX          @Y17XAUU 63440400
         USING IEDNTRM,R5         ESTABLISH ADDRESSABILITY     @Y17XAUU 63440600
LINELOOP EQU   *                                               @Y17XAUU 63440800
         LH    R1,TRMCOHRT        GET COHORT POINTER           @Y17XAUU 63441000
         L     R15,TERNMTAB       TTCIN TO TTE CONVERSION      @Y17XAUU 63441200
*                                 ROUTINE ADDRESS              @Y17XAUU 63441400
         BALR  R14,R15            FIND TTE ADDRESS             @Y17XAUU 63441600
         LR    R5,R1              GET TTE ADDRESS              @Y17XAUU 63441800
         LA    R1,TRMPRFSZ        GET TTE PREFIX SIZE          @Y17XAUU 63442000
         SLR   R5,R1              POINT TO TTE PREFIX          @Y17XAUU 63442200
         CLI   TRMTYPE,TRMNSDLC   PRE SNA LINE ENTRY           @Y17XAUU 63442400
         BE    LINEFND            YES                          @Y17XAUU 63442600
         CLI   TRMTYPE,TRMSDLC    SNA LINE ENTRY               @Y17XAUU 63442800
         BNE   LINELOOP           CHECK NEXT ENTRY             @Y17XAUU 63443000
LINEFND  EQU   *                                               @Y17XAUU 63443200
         TM    TRMBYTE2,TRMRSACT  LINE STOPPED                 @Y17XAUU 63443400
         BO    STAT16             NO                           @Y17XAUU 63443600
         OI    D0(R12),TOTTDLST   YES - SHOW LINE STOPPED        S22024 63760000
         DROP  R5                                                S22024 63840000
         B     STAT16             EXIT                           S22024 63920000
STAT14   EQU   *                                                 S22024 64000000
         LR    R5,R7              COPY RLN                       S22024 64080000
         BCTR  R5,R0              DECREMENT BY 1                        64160000
         SR    R15,R5             GET COUNT OF LCB'S TO SCAN            64240000
         SR    R14,R14            CLEAR REG                             64320000
         IC    R14,DCBEIOBX       GET LCB SIZE                          64400000
         LR    R5,R7              GET RLN                               64480000
         MR    R4,R14             GET STARTING LCB OFFSET               64560000
         AL    R5,DCBIOBAD        POINT TO IOB OF LCB                   64640000
         DROP R9                                                        64720000
         S     R5,K32             ADJUST TO START OF LCB                64800000
         USING IEDQLCB,R5                                               64880000
         TM    LCBSTAT1,LCBFREEN+LCBRECVN+LCBSENDN  LINE STOPPED ?      64960000
         BNZ   STAT16             NO                                    65040000
         OI    D0(R12),TOTTDLST   YES - SHOW LINE STOPPED               65120000
         DROP  R5                                                       65200000
*                                                                       65280000
STAT16   EQU   *                                                        65360000
         LA    R12,D4(R12)        POINT TO NEXT ENTRY                   65440000
         B     STAT2              PROCESS NEXT ENTRY                    65520000
         DROP  R8                                                       65600000
         EJECT                                                          65680000
*                                                                       65760000
*        SET INITIAL STATUS BITS FOR LINE TEST DEVICE                   65840000
*                                                                       65920000
LINESTAT EQU   *                                                        66000000
         LA    R12,TOTTDTBL       POINT TO TEST DEVICE TABLE            66080000
         LA    R11,TOTTDEND       POINT TO END OF TABLE                 66160000
STAT20   EQU   *                                                        66240000
         CR    R12,R11            END OF TABLE                          66320000
         BE    ZERO(R3)           YES - RETURN                          66400000
         L     R7,D0(R12)         GET UCB ADDR                          66480000
         LA    R7,D0(R7)          CLEAR HI ORDER BYTE                   66560000
         LTR   R7,R7              LAST ENTRY                            66640000
         BZ    ZERO(R3)           YES - RETURN                          66720000
         TM    D0(R12),TOTTDORN   TD ON 3705                     S22024 66800000
         BO    STAT40             YES                            S22024 66880000
         SPACE                                                          66960000
         USING UCBOB,R7                                                 67040000
         MVC   WORK1(D3),UCBNAME  GET UCB NAME                          67120000
         DROP  R7                                                       67200000
         BAL   R9,LCBFIND         GET LCB ADDR                          67280000
         B     STAT24             LCB FOUND                             67360000
         B     STAT28             BYPASS LCB CHECK                      67440000
STAT24   EQU   *                                                        67520000
         L     R8,WORK1           GET LCB ADDR                          67600000
         LA    R8,D0(R8)          CLEAR HI ORDER BYTE                   67680000
         USING IEDQLCB,R8                                               67760000
         TM    LCBSTAT1,LCBFREEN+LCBRECVN+LCBSENDN LINE STOPPED         67840000
         BNZ   STAT28             NO                                    67920000
         OI    D0(R12),TOTTDLST   YES - SHOW LINE STOPPED               68000000
         DROP  R8                                                       68080000
STAT28   EQU   *                                                        68160000
         LA    R12,D4(R12)        POINT TO NEXT ENTRY                   68240000
         B     STAT20             CHECK NEXT ENTRY               S22024 68320000
         SPACE 2                                                        68400000
STAT40   EQU   *                                                 S22024 68480000
         SR    R10,R10            CLEAR REG                      S22024 68560000
         IC    R10,TOTTTBEL       MAX NAME LENGTH                S22024 68640000
         AR    R7,R10             POINT TO TTE ADDR              S22024 68720000
         MVC   TTEADDR+D1(D3),D0(R7) ALLIGN ADDR                 S22024 68800000
         L     R8,TTEADDR         TTE ADDR                       S22024 68880000
         LA    R1,TRMPRFSZ        GET TTE PREFIX SIZE          @Y17XAUU 68880800
         SLR   R8,R1              POINT TO TTE PREFIX          @Y17XAUU 68881600
         USING IEDNTRM,R8         ESTABLISH ADDRESSABILITY     @Y17XAUU 68882400
         TM    TRMLINK,TRMLACTV   LINE STOPPED                 @Y17XAUU 68883200
         BO    STAT28             NO - EXIT                      S22024 69120000
         OI    D0(R12),TOTTDLST   YES - SHOW LINE STOPPED        S22024 69200000
         DROP  R8                                                S22024 69280000
         B     STAT28             CHECK NEXT ENTRY               S22024 69360000
         EJECT                                                          69440000
PLUG     EQU   *                                                 S22024 69520000
*        SET UP TEST DEVICE TABLE                                       69600000
         LA    R7,TOTTDTBL        POINT TO TEST DEVICE TABLE            69680000
         LA    R8,TOTTDTBL+D40    END OF TD TABLE                       69760000
PLUG001  EQU   *                                                        69840000
         CR    R7,R8              TABLE FILLED?                         69920000
         BE    TDTLON             ERROR - MORE THAN TEN ENTRIES  S22024 70000000
         L     R12,D0(R7)         GET NEXT ENTRY                        70080000
         LTR   R12,R12            VACANT SPACE IN TABLE?                70160000
         BZ    PLUG002            YES                                   70240000
         LA    R7,D4(R7)          NO - POINT TO NEXT SLOT               70320000
         B     PLUG001            CHECK NEXT ENTRY                      70400000
PLUG002  EQU   *                                                 S22024 70480000
         TM    TDFLG,SYM+RNTERM   TERMINAL TEST                  S22024 70560000
         BZ    PLUG008            NO                             S22024 70640000
         MVI   TRMTNT,TOTTDTRM    YES - SHOW TERMINAL TEST       S22024 70720000
         TM    TDFLG,RNTERM       TERMINAL ON RN                 S22024 70800000
         BZ    PLUG003            NO                             S22024 70880000
         OI    TRMTNT,TOTTDORN    YES - SHOW RN TERMINAL         S22024 70960000
PLUG003  EQU   *                                                 S22024 71040000
         MVC   D0(D4,R7),TRMTNT   TNT ADDR TO TD TABLE           S22024 71120000
         OI    TOTFLG10,TOTTERMS  SHOW TERMINAL TEST             S22024 71200000
         B     PLUGEND            EXIT                           S22024 71280000
PLUG008  EQU   *                  LINE ENTRY                     S22024 71360000
         LA    R14,TOTTDTBL       POINT TO TD TABLE              S22024 71400000
         TM    TDFLG,RNLINE       RN LINE TEST                   S22024 71440000
         BO    PLUG018            YES                            S22024 71520000
         MVI   WORK4,TOTTDLIN     SHOW LINE TEST                 S22024 71600000
         MVC   D0(D4,R7),WORK4    UCB ADDR TO TD TABLE           S22024 71680000
         CR    R14,R7             FIRST ENTRY                    S22024 71690000
         BE    PLUG010            YES - BYPASS MIXED CHECK       S22024 71700000
         LR    R14,R7             GET CURRENT SETTING            S22024 71710000
         S     R14,F4             LAST ENTRY ADDR                S22024 71720000
         CLI   D0(R14),TOTTDLIN   CUU TEST                       S22024 71730000
         BNE   TDERR              NO - ERROR                     S22024 71740000
PLUG010  DS    0H                 BOUNDARY ALLIGNMENT            S22024 71750000
         OI    TOTFLG06,TOTNCMFG  SET NON-CONCURRENT MODE FLAG   S22024 71760000
         B     PLUGEND            EXIT                           S22024 71840000
PLUG018  EQU   *                  RN SUB LINE                    S22024 71920000
         MVI   TRMTNT,TOTTDLIN    SHOW LINE TEST                 S22024 72000000
         OI    TRMTNT,TOTTDORN    SHOW RN LINE                   S22024 72080000
         CR    R14,R7             FIRST ENTRY                    S22024 72090000
         BE    PLUG024            YES - BYPASS MIXED CHECK       S22024 72100000
         LR    R14,R7             GET CURRENT SETTING            S22024 72110000
         S     R14,F4             LAST ENTRY ADDR                S22024 72120000
         TM    D0(R14),TOTTDORN   RN LINE TEST                   S22024 72130000
         BZ    TDERR              NO - ERROR                     S22024 72140000
PLUG024  DS    0H                 BOUNDARY ALLIGNMENT            S22024 72150000
         MVC   D0(D4,R7),TRMTNT   TNT ADDR TO TD TABLE           S22024 72160000
PLUGEND  EQU   *                                                 S22024 72240000
         BR    R9                 RETURN                         S22024 72400000
         EJECT                                                          72420000
*                                                                       72560000
LINECHK  EQU   *                                                        72640000
*                                                                       72720000
         LA    R4,TOTTDTBL        TEST DEVICE TABLE                     72800000
         LA    R7,TOTTDEND        END OF TABLE                          72880000
ALLTEST  EQU   *                                                        72960000
         CR    R4,R7              ALL ENTRIES PROCESSED                 73040000
         BE    ZERO(R11)          YES - EXIT                     S22024 73120000
         TM    D0(R4),TOTTDLIN+TOTTDORN RN LINE TEST             S22024 73200000
         BO    D0(R11)            YES - BYPASS CHECK             S22024 73280000
         TM    D0(R4),TOTTDLIN    270X LINE TEST                 S22024 73360000
         BZ    D0(R11)            NO - RETURN                    S22024 73440000
         L     R8,ZERO(R4)        GET ADDR FROM TABLE            S22024 73520000
         LA    R8,ZERO(R8)        CLEAR HI ORDER BYTE                   73600000
         STH   R8,KUCB            SAVE UCB ADDR                         73680000
         LTR   R8,R8              IS THERE AN ADDRESS                   73760000
         BZ    ZERO(R11)          NO - RETURN                           73840000
         LA    R9,CVTPTR          POINTER TO CVT                        73920000
         L     R9,ZERO(R9)        CVT ADDR                              74000000
         L     R9,ZERO(R9)        TCB ADDR                              74080000
         L     R9,FOUR(R9)        CURRENT TCB ADDR                      74160000
         L     R9,TWELVE(R9)      TIOT ADDR                             74240000
         USING TIOT,R9                                                  74320000
         LA    R9,TIOENTRY        FIRST ENTRY                           74400000
         DROP  R9                                                       74480000
         USING TIOENTRY,R9                                              74560000
GETLENGT EQU   *                                                        74640000
         SR    R3,R3              CLEAR REG 3                           74720000
         IC    R3,TIOELNGH        DD ENTRY LENGTH                       74800000
         LTR   R3,R3              ANY LENGTH ?                          74880000
         BZ    NOTFOUND           NO - ERROR                            74960000
         LA    R5,POOLSTAR-TIOESTTB DEV ENTRY LENGTH                    75040000
         DROP  R9                                                       75120000
         LR    R10,R3             SAVE LENGTH                           75200000
         SR    R3,R5              DD LENGTH - 4                         75280000
         AR    R3,R9              DEVICE                                75360000
         USING TIOESTTB,R3                                              75440000
         CLC   TIOEFSRT+ONE(TWO),KUCB ENTRY FOUND ?                     75520000
         DROP  R3                                                       75600000
         BE    FOUND              ENTRY FOUND                           75680000
         AR    R9,R10             POINT TO NEXT ENTRY                   75760000
         B     GETLENGT           CONTINUE LOOKING                      75840000
FOUND    EQU   *                                                        75920000
         LA    R4,FOUR(R4)        POINT TO NEXT LINE                    76000000
         B     ALLTEST            CHECK NEXT ENTRY                      76080000
NOTFOUND EQU   *                                                        76160000
*                                                                       76240000
*        DD CARD OMITTED                                                76320000
*                                                                       76400000
         IEDQMSG MSGID=052,FUNCT=CEC                                    76480000
         B     TDERR              GO TO PROMPTER                 S22024 76560000
         EJECT                                                          76640000
**************************************************************** S22024 76720000
*                                                              * S22024 76800000
*        ROUTINE TO DETERMINE THE TYPE OF TEST TO BE RUN --    * S22024 76880000
*        LINE OR TERMINAL. REG 10 PLUS ONE POINTS TO TD FIELD. * S22024 76960000
*                                                              * S22024 77040000
**************************************************************** S22024 77120000
TYPECHK  EQU   *                                                 S22024 77200000
         STM   R7,R11,SAVE        SAVE CALLER'S REG              S22024 77280000
         LA    R7,D0              ZERO TTE ADDR                  S22024 77360000
         TM    D1(R10),NUMER      LINE TEST                      S22024 77440000
         BO    TYPELINE           YES                            S22024 77520000
*                                                                S22024 77600000
*        FIND LENGTH OF TEST DEVICE ENTRY                        S22024 77680000
*                                                                S22024 77760000
         MVC   WORK2(D9),D1(R10)  MOVE ENTRY TO WORK AREA        S22024 77840000
         LA    R7,D9              LOOP COUNT                     S22024 77920000
         LA    R8,D0              COUNTER                        S22024 78000000
         LA    R9,WORK2           WORK AREA                      S22024 78080000
TYPELP   EQU   *                                                 S22024 78160000
         CLI   D0(R9),SLASH       END OF FIELD                   S22024 78240000
         BE    TYPEFD             YES                            S22024 78320000
         CLI   D0(R9),COMMA       END OF ENTRY                   S22024 78400000
         BE    TYPEFD             YES                            S22024 78480000
         LA    R9,D1(R9)          NEXT CHAR                      S22024 78560000
         LA    R8,D1(R8)          INCREMENT COUNTER              S22024 78640000
         BCT   R7,TYPELP          NEXT TEST                      S22024 78720000
         B     TDERR              ERROR - NAME TOO LONG          S22024 78800000
         SPACE                                                          78880000
TYPEFD   EQU   *                                                 S22024 78960000
         LTR   R8,R8              TD FIELD EMPTY                 S22024 79040000
         BZ    TDERR              YES - ERROR                    S22024 79120000
         STC   R8,LENGTH          LENGTH OF ENTRY TO PLIST       S22024 79200000
*        AN INVALID ENTRY HAS BEEN MADE IN TEST DEVICE FIELD   * S22024 79280000
         BCTR  R8,R0              LENGTH MINUS 1                 S22024 79360000
         MVC   WORK1(D8),BLANK    BLANK NAME FIELD               S22024 79440000
         EX    R8,TDEVICE         NAME TO PLIST                  S22024 79520000
         SPACE                                                          79600000
         BAL   R9,NAMESRCH        VERIFY SYMBOLIC NAME           S22024 79680000
         B     TYPRN              NORMAL RETURN                  S22024 79760000
         B     TDERR              ERROR RETURN                   S22024 79840000
         SPACE                                                          79920000
TYPRN    EQU   *                                                        80000000
         L     R7,TNTENTRY        TTE ADDR                       S22024 80080000
         USING IEDNTRM,R7                                        S22024 80160000
         LA    R9,TRMPRFSZ        GET TTE PREFIX SIZE          @Y17XAUU 80166000
         SLR   R7,R9              POINT TO TTE PREFIX          @Y17XAUU 80172000
         TM    TRMSTATE,TRMPREF   3705 MODE                    @Y17XAUU 80240000
         BZ    TYPETERM           NO                             S22024 80320000
         CLI   TRMTYPE,TRMPUNT    PU ENTRY                     @Y17XAUU 80320800
         BE    TDERR              YES - ERROR                  @Y17XAUU 80321600
         CLI   TRMTYPE,TRMLNCP    NCP ENTRY                    @Y17XAUU 80322400
         BE    TDERR              YES - ERROR                  @Y17XAUU 80323200
         CLI   TRMTYPE,TRMSSCP    SSCP ENTRY                   @Y17XAUU 80324000
         BE    TDERR              YES - ERROR                  @Y17ZAUU 80324800
         CLI   TRMTYPE,TRMSDLC    SNA LINE ENTRY               @Y17XAUU 80325600
         BE    TYPELINE           YES - PROCESS                @Y17XAUU 80326400
         CLI   TRMTYPE,TRMNSDLC   PRE SNA LINE ENTRY           @Y17XAUU 80327200
         BE    TYPELINE           YES - PROCESS                @Y17XAUU 80640000
         TM    TRMSTATE,XE0       RN TERMINAL                    S22024 80720000
         BZ    TYPETERM           YES                            S22024 80800000
         B     TDERR              ERROR EXIT                     S22024 80880000
         SPACE                                                          80960000
TYPETERM EQU   *                                                 S22024 81040000
         OI    TDFLG,SYM          SHOW TERMINAL TEST             S22024 81120000
         TM    TDFLG,LINE         LINE FLAG SET                  S22024 81200000
         BO    TDERR              YES - ERROR                    S22024 81280000
         TM    TRMSTATE,TRMPREF   3705 MODE                    @Y17XAUU 81360000
         BZ    TERM4              BRANCH                         S22024 81440000
         OI    TDFLG,RNTERM       YES - SET FLAG                 S22024 81520000
TERM4    EQU   *                                                 S22024 81600000
         LM    R7,R11,SAVE        RESTORE REG                    S22024 81680000
         BR    R9                 RETURN                         S22024 81760000
         SPACE                                                          81840000
TYPELINE EQU   *                                                 S22024 81920000
         OI    TDFLG,LINE         SHOW LINE TEST                 S22024 82000000
         TM    TDFLG,SYM          TERMINAL FLAG SET              S22024 82080000
         BO    TDERR              YES - ERROR                    S22024 82160000
         LTR   R7,R7              TTE ADDR PRESENT               S22024 82240000
         BZ    TERM4              NO - EXIT                    @Y17XAUU 82260000
         TM    TRMSTATE,TRMPREF   3705 MODE                    @Y17XAUU 82400000
         BZ    TERM8              NO                                    82480000
         OI    TDFLG,RNLINE       YES - SET FLAG                 S22024 82560000
TERM8    EQU   *                                                 S22024 82640000
         B     TERM4              RETURN                         S22024 82720000
         DROP  R7                                                S22024 82800000
TDEVICE  MVC   WORK1(D0),WORK2    GET DEVICE ENTRY               S22024 82880000
         EJECT                                                          82960000
UCBSAVE  DS    A                  UCB SAVE AREA                  S22024 83040000
SAVE     DS    5F                 SAVE AREA                      S22024 83120000
TRMTNT   DS    A                  TNT SAVE AREA                         83200000
TRMSAV1  DS    3F                 REG SAVE AREA                         83280000
TRMSAVE2 DS    F                  REG SAVE AREA                @Y17XAUU 83300000
TERNMTAB DS    A                  TERMNAME TABLE ADDR                   83360000
TNTENTRY DS    A                  TTE ADDR FOR TEST TERMINAL            83440000
WORK4    DS    F                  WORK AREA                             83520000
AVTUISV  DS    A                  ADDRESS OF BINARY SEARCH ROUTINE      83600000
WORKAREA DS    F                  WORKAREA                              83680000
TDTNT    DS    A                  SAVE AREA FOR TD TNT ADDRESS @YM08136 83720000
KUCB     DS    H                  TEST UCB ADDR SAVE AREA               83760000
         DS    0D                 BOUNDARY ALLINGMENT                   83840000
NUMBER   DC    X'0000000000000000' COUNT SAVE AREA                      83920000
NUMB     EQU   NUMBER+D3          LAST DIGIT OF COUNT                   84000000
WORK1    DS    3F                 WORK AREA                             84080000
TRMWRK   DS    CL72               TRM WORK AREA                         84160000
LCBLEN   DS    CL1                LENGTH OF LCB                         84240000
TDFLG    DC    X'00'              PROGRAM FLAG BYTE                     84320000
WORK3    DS    CL3                WORK AREA                             84400000
NO       DS    CL1                WORK AREA                             84480000
TERNMLEN DS    CL1                MAXIMUM LENGTH OF TD NAME             84560000
WORK2    DS    2D                 WORK AREA                      S22024 84640000
         SPACE                                                          84720000
PAREMLST DS    0CL8               BINARY SEARCH P-LIST                  84800000
         DS    CL1                OFFSET TO BIN. SEARCH ADDR            84880000
         DC    X'00'              FLAG BYTE                             84960000
         DC    X'00'              FLAG BYTE                             85040000
LENGTH   DS    CL1                LENGTH OF NAME                        85120000
         DC    A(WORK1)           ADDRESS OF NAME                       85200000
         SPACE                                                          85280000
         DS    0F                 BOUNDARY ALLIGNMENT                   85360000
RE       DS    0CL8               OP CONTROL P-LIST                     85440000
OCQCB    DS    F                  ADDR OF OF CONTROL QCB                85520000
         DC    X'DC'              FLAG BYTE                             85600000
         DC    XL3'00'            LINK FIELD                            85680000
VERBCODE DS    CL1                OP CONTROL COMMAND                    85760000
RELEN    DC    X'18'              P-LIST LENGTH                         85840000
RLN      DS    CL1                REL. LINE NUMBER                      85920000
RETCODE  DC    X'00'              RETURN CODE                           86000000
         DC    A(ECB)             ECB ADDR                              86080000
ADDR     DC    CL8' '             BLANK AREA                            86160000
         SPACE                                                          86240000
ECB      DS    2F                 ECB                                   86320000
         SPACE                                                          86400000
REPAREM  DC    X'0C'              FLAG BYTE                             86480000
         DC    AL3(RE)            FIRST ELEMENT                         86560000
         DC    X'80'              FLAG BYTE                             86640000
         DC    AL3(RE)            LAST ELEMENT                          86720000
CEOUT2A  DC    C'IED332I '        MSG ID                         S22024 86800000
         SPACE                                                          86880000
CEOUT2   DC    C'XXXXXXXX NOT OPENED' MSG - TEST LINE NOT OPENED        86960000
CEOUT2E  DS    0C                 END OF MSG                            87040000
REGSAVE  DS    12F                REG SAVE AREA                         87120000
K1       DC    F'1'               VALUE OF 1                            87200000
F4       DC    F'4'               VALUE OF 4                     S22024 87240000
K3       DC    F'3'               VALUE OF 3                            87280000
LCBST1AD DS    A                  LCB STATUS BYTE SAVE                  87360000
MULT     DC    8XL1'0'            WORK AREA                             87440000
TRMSLPL  DS    0F                 PARAMETER LIST FOR ACT. TERMINAL      87520000
         DC    X'0C'              FLAG BYTE                             87600000
         DC    AL3(RQELE)         FIRST REQ ELEMENT                     87680000
         DC    X'80'              FLAG BYTE                             87760000
         DC    AL3(RQELE)         LAST REQ ELEMENT                      87840000
         SPACE                                                          87920000
BLANK    DC    8X'40'             BLANK AREA                            88000000
ENDTABLE DC    X'FFFF'            END OF UCB TABLE             @G36XRUV 88040010
RNWORK   DS    C                  WORK AREA                      S22024 88080000
         SPACE                                                          88160000
*********************************************************************** 88240000
*                                                                     * 88320000
*        PARAMETER LIST FOR OPERATOR CONTROL COMMANDS                 * 88400000
*                                                                     * 88480000
*********************************************************************** 88560000
         SPACE                                                          88640000
RQELE    DS    0F                 OP CONTROL P-LIST                     88720000
RQKEY    DC    X'00'              KEY                                   88800000
RQQCBA   DC    X'000000'          QCB ADDR                              88880000
RQPRI    DC    X'DC'              PRIORITY                              88960000
RQLINK   DC    X'000000'          LINK FIELD                            89040000
RQVBCD   DC    X'00'              VERB CODE                             89120000
RQELNG   DC    X'18'              LENGTH CONSTANT                       89200000
RQRLN    DC    X'00'              RELATIVE LINE NUMBER                  89280000
RQRTCD   DC    X'00'              RETURN CODE                           89360000
RQECBA   DC    AL4(0)             ECB ADDR                              89440000
RQLADR   DC    8X'40'             LINE ADDR OR TERMINAL NAME            89520000
RQND     DS    0C                 END OF ELEMENT                 S22024 89560000
*                                                                       89600000
         SPACE                                                          89680000
TTEADDR  DC    F'0'               WORK AREA TO ALLIGN TTE ADDR          89760000
K32      DC    F'32'              VALUE OF 30                           89840000
RQMOVE   MVC   RQLADR(D1),D0(R7)  MOVE NAME TO REQUEST ELEMENT          89920000
PATCH    DC    CL200' '           IEDQWC1 PATCH AREA                    90000000
         EJECT                                                          90020000
         TLGBD                                                   S22024 90160000
         EJECT                                                          90240000
TIOT     DSECT                                                          90320000
         IEFTIOT1                                                       90400000
         EJECT                                                          90480000
         EJECT                                                          90560000
         TQCBD                                                          90640000
         EJECT                                                          90720000
         DCBD  DSORG=TX                                                 90800000
         EJECT                                                          90880000
         EJECT                                                          90960000
         TPRFD                                                          91040000
         EJECT                                                          91120000
         TLCBD                                                          91200000
         EJECT                                                          91280000
CVT      DSECT                                                          91360000
         CVT                                                            91440000
         EJECT                                                          91520000
UCB      DSECT                                                          91600000
         IEFUCBOB                                                       91680000
         EJECT                                                          91760000
         TAVTD                                                          91840000
         EJECT                                                          91920000
         TDEBD                                                          92000000
         EJECT                                                          92080000
         TTNTD                                                          92160000
         EJECT                                                          92240000
         TTRMD                                                          92320000
         EJECT                                                          92400000
         OLTCB                                                          92480000
         EJECT                                                          92560000
RESPL    RESPL                                                 @Y17XAUU 92580000
         END                                                            92640000
./  ADD  SSI=63630066,NAME=IEDQWC2
         TITLE 'IEDQWC2 TRM ANALYSIS MODULE 3'                          00200020
IEDQWC2  CSECT                                                          00300022
* CHANGE ACTIVITY AS FOLLOWS:                                           00330022
*A836000                                                        SA41597 00360022
*A139200-139400,150800-151400,424900-425160,431280-432000        S22024 00365000
*A432490,432910-432960,730010-730040,743000,770460-771120        S22024 00370000
*A833100-833700,836700,856393-856396,884060-885740               S22024 00375000
*A908550,909106-909107,909195                                    S22024 00380000
*C004000,009000,712000-725000,744000                             S22024 00385000
*C813000,814000-815000,820000,832000,854040-854060               S22024 00390000
*D670000,726000,731350,735700,737700,812100-812500               S22024 00395000
**************************************************************** S22024 00400022
*                                                              *        00600022
* TITLE = TRM ANALYSIS MODULE 3                                *        00610022
*                                                              *        00620022
* MODULE NAME = IEDQWC2                                        *        00630022
*                                                              *        00640022
* DESCRIPTIVE NAME = TRM ANALYSIS MODULE 3                     *        00650022
*                                                              *        00660022
* COPYRIGHT = NONE                                             *        00670022
*                                                              *        00680022
* STATUS --                                                    *        00700022
*                                                              *        00800022
*    CHANGE LEVEL 2                                            * S22024 00900022
*                                                              *        01000022
*                                                              *        01100022
* FUNCTIONS --                                                 *        01200022
*                                                              *        01300022
*    THE PURPOSE OF THIS MODULE IS TO VERIFY THE TEST AND      *        01400022
*    OPTION FIELDS OF THE TEST REQUEST MESSAGE (TRM).          *        01500022
*                                                              *        01600022
*    THE TEST FIELD IS VERIFIED FOR VALID SYNTAX. IF AN        *        01700022
*    ERROR IS FOUND, CONTROL IS PASSED TO THE PROMPTER         *        01800022
*    MODULE (IEDQWJ).                                          *        01900022
*                                                              *        02000022
*    THE OPTION FIELD IS VERIFIED FOR VALID SYNTAX AND         *        02100022
*    REQUESTED OPTIONS ARE SET IN THE OLTCB. IF AN ERROR       *        02200022
*    IS FOUND IN THE OPTION FIELD, CONTROL IS PASSED TO        *        02300022
*    THE PROMPTER MODULE (IEDQWJ).                             *        02400022
*                                                              *        02500022
*    THIS MODULE ALSO CHECKS THE OPTION FIELD TO SEE IF        *        02600022
*    NCM WAS SPECIFIED. IF NCM WAS SPECIFIED THE MODULE        *        02700022
*    ASKS THE SYSTEM OPERATOR FOR PERMISSION TO USE THE        *        02800022
*    LINE(S) IN NCM MODE. IF PERMISSION IS NOT GRANTED, THE    *        02900022
*    CONTROL TERMINAL IS NOTIFIED AND THE TRM REJECTED.        *        03000022
*                                                              *        03100022
*                                                              *        03200022
* ENTRY POINTS --                                              *        03300022
*                                                              *        03400022
*    IEDQWC2 - CALLED BY IEDQWC1 TO ANALYZE THE TEST AND       *        03500022
*    OPTION FIELDS.                                            *        03600022
*                                                              *        03700022
*                                                              *        03800022
* INPUT --                                                     *        03900022
*                                                              *        04000022
*    REGISTERS 02,13,14,15 CONTAIN THE FOLLOWING VALUES:       *        04100022
*                                                              *        04200022
*    02 - OLTCB POINTER                                        *        04300022
*    13 - CALLER'S SAVE AREA ADDRESS                           *        04400022
*    14 - RETURN ADDRESS                                       *        04500022
*    15 - ENTRY POINT ADDRESS                                           04600022
*                                                              *        04700022
*                                                              *        04800022
* OUTPUT --                                                    *        04900022
*                                                              *        05000022
*    NONE                                                      *        05100022
*                                                              *        05200022
*                                                              *        05300022
* EXTERNAL REFERENCES --                                       *        05400022
*                                                              *        05500022
*    LINK TO IEDQWK (MESSAGE MODULE)                           *        05600022
*                                                              *        05700022
*                                                              *        05800022
* EXITS,NORMAL --                                              *        05900022
*                                                              *        06000022
*    XCTL TO IEDQWE (TEST CONTROL MODULE) WHENEVER             *        06100022
*    NCM IS REJECTED                                           *        06200022
*                                                              *        06300022
*                                                              *        06400022
* EXITS,ERROR --                                               *        06500022
*                                                              *        06600022
*    XCTL TO IEDQWJ (PROMPTER MODULE)                          *        06700022
*                                                              *        06800022
*                                                              *        06900022
* TABLES/WORK AREAS --                                         *        07000022
*                                                              *        07100022
*    UCB,DEB,DCB,QCB,OLTCB                                     *        07200022
*                                                              *        07300022
*                                                              *        07400022
* ATTRIBUTES --                                                *        07500022
*                                                              *        07600022
*    ENABLED, PROBLEM PROGRAM MODE, TRANSIENT                  *        07700022
*                                                              *        07800022
*                                                              *        07900022
* NOTES --                                                     *        08000022
*                                                              *        08100022
*    NONE                                                      *        08200022
*                                                              *        08300022
*********************************************************************** 08400020
         EJECT                                                          09400020
*                                                                       10300022
*              INITIALIZATION                                           11200020
*                                                                       11400020
*                                                                       11600020
D0       EQU   0                  DISP OF 0                             11608022
D1       EQU   1                  DISP OF 1                             11616022
D2       EQU   2                  DISP OF 2                             11624022
D3       EQU   3                  DISP OF 3                             11632022
D4       EQU   4                  DISP OF 4                             11640022
D8       EQU   8                  DISP OF 8                             11648022
D12      EQU   12                 DISP OF 12                            11656022
D16      EQU   16                 DISP OF 16                            11664022
D17      EQU   17                 DISP OF 17                            11672022
D20      EQU   20                 DISP OF 20                            11680022
D24      EQU   24                 DISP OF 24                            11688022
D40      EQU   40                 DISP OF 40                     S22024 11689000
TRMEND   EQU   72                 MAXIMUM LENGTH OF TRM                 11690022
BLANK    EQU   X'40'              A BLANK                               11692022
RTNSFLG  EQU   X'80'              END OF TEST FIELD                     11696022
RTNDFLG  EQU   X'40'              INCLUSIVE ROUTINES                    11704022
RTNCFLG  EQU   X'20'              SEPARATE ROUTINE ENTRY                11712022
RTNNFLG  EQU   X'10'              SECOND PASS FLAG                      11720022
RTNIFLG  EQU   X'08'              INCLUSIVE RTN LOOP FLAG               11728022
SLASH    EQU   X'61'              SLASH                                 11736022
COMMA    EQU   X'6B'              COMMA                                 11744022
DASH     EQU   X'60'              DASH                                  11752022
F0       EQU   X'F0'              EBCDIC 0                              11760022
F9       EQU   X'F9'              EBCDIC 9                              11768022
INCLUS   EQU   X'80'              INCLUSIVE ROUTINES                    11776022
PARMREG0 EQU   0                  REG 0                                 11900022
PARMREG1 EQU   1                  REG 1                                 12000022
R0       EQU   0                  REG 0                                 12100022
R1       EQU   1                  REG 1                                 12200022
R2       EQU   2                  REG 2                                 12300022
R3       EQU   3                  REG 3                                 12400022
R4       EQU   4                  REG 4                                 12500022
R5       EQU   5                  REG 5                                 12600022
R6       EQU   6                  REG 6                                 12700022
R7       EQU   7                  REG 7                                 12800022
R8       EQU   8                  REG 8                                 12900022
R9       EQU   9                  REG 9                                 13000022
R10      EQU   10                 REG 10                                13100022
R11      EQU   11                 REG 11                                13200022
R12      EQU   12                 REG 12                                13300022
R13      EQU   13                 REG 13                                13400022
R14      EQU   14                 REG 14                                13500022
R15      EQU   15                 REG 15                                13600022
XFF      EQU   X'FF'              MASK FIELD                            13700022
EQUAL    EQU   X'7E'              = CHAR                                13800022
END      EQU   X'80'              CONTROL BIT                           13900022
LEV0     EQU   X'F0'              EP OPTION LEVEL 0              S22024 13920022
LEV3     EQU   X'F3'              EP OPTION LEVEL 3              S22024 13940022
D7       EQU   7                  DISP OF 7                             13970022
D29      EQU   29                 DISP OF 29                            14040022
D33      EQU   33                 DISP OF 33                            14110022
D5       EQU   5                  DISP OF 5                             14180022
D9       EQU   9                  DISP OF 9                             14250022
TRMLEN   EQU   72                 TRM BUFFER SIZE                       14320022
OLTPRFX  EQU   C'T'               TEST SECTION PREFIX (DEFAULT)         14390022
KA       EQU   C'A'               CHAR A                                14460022
KZ       EQU   C'Z'               CHAR Z                                14530022
X0F      EQU   X'0F'              MASK FIELD                            14600022
TLDF     EQU   X'02'              TL DEFAULT COUNT                      14670022
ELDF     EQU   X'02'              EL DEFAULT COUNT                      14740022
F5       EQU   X'F5'              VALUE OF 5                            14810022
EXTLEN   EQU   54                 EXT BFR SIZE                          14880022
TDMAX    EQU   11                 MAX + 1 TEST DEVICE COUNT      S22024 14950010
YES      EQU   X'E8'              CHAR Y                                15020022
TYPE1CA  EQU   X'15'              UCB ID 3705 TYPE 1 CA          S22024 15080022
TYPE2CA  EQU   X'25'              UCB ID OF 3705 TYPE 2 CA       S22024 15140022
         SPACE 2                                                        15200020
         USING IEDQWC2,R15                                              15280022
         USING TOTOLTCB,R2                                              15360022
IEDQWC2  IEDHJN STARC2,HJN                                              15440022
         DROP  R15                                                      15520022
         SPACE                                                          15600022
         SAVE  (14,12)            SAVE CALLER'S REG.                    15680022
         LR    R6,R15                   LOAD BASE                       15800020
         USING IEDQWC2,R6                                               16000020
         LA    R3,TOTSAVE4        GET MY SAVE AREA ADDR                 16200022
         ST    R3,D8(R13)         SAVE IN CALLER'S SAVE                 16400022
         ST    R13,D4(R3)         SAVE CALLER'S                         16600022
         LR    R13,R3                   SET R13 TO SAVE AREA            16800020
         SPACE                                                          17060022
         MVI   TOTCROLT,BLANK     BLANK CURRENT                         17080022
         MVC   TOTCROLT+D1(D7),TOTCROLT OLT DEVICE FIELD                17090022
         MVI   TOTOLTTB,BLANK     BLANK OLT                             17100022
         MVC   TOTOLTTB+D1(D29),TOTOLTTB SUFFIX TABLE                   17110022
*                                                                       17200020
*                                                                       17400020
*              FIND THE TESTS FIELD                                     17600020
*                                                                       17800020
*                                                                       18000020
         LA    R3,TOTTRMBF        POINT TO TRM BUFFER                   18700022
         MVC   TRMWRK(TRMLEN),D0(R3) TRM TO WORK AREA                   19400022
         LA    R1,TRMWRK               SET UP POINTER                   19600020
         LA    R5,TRMWRK+TRMEND   POINT TO END OF TRM BUFFER            19700022
         LA    R10,D2             SET UP COUNTER                        19800022
FLDHUNT  EQU   *                                                        19900022
         CLI   D0(R1),SLASH       END OF FIELD                          20000022
         BE    FLDFIND                 YES BRANCH                       20200020
         LA    R1,D1(R1)          BUMP POINTER                          20400022
         CR    R1,R5              END OF BUFFER ?                       20460022
         BE    TEST1              YES - ERROR                           20520022
         B     FLDHUNT                 GO LOOK AGAIN                    20600020
FLDFIND  EQU   *                                                        20800022
         LA    R1,D1(R1)          BUMP PASS SLASH                       20900022
         BCT   R10,FLDHUNT        CHECK FOR SLASH AGAIN                 21000022
TESFLD   EQU   *                                                        21200020
*                                      R1 HAS ADDR OF TEST FIELD        21400020
         SR    R10,R10            CLEAR REG 10                          21460022
         LA    R10,TRMLEN         LENGTH OF TRM                         21520022
         MVI   TOTCROLT,OLTPRFX   INIT TEST PREFIX                      21560022
         CLI   D0(R1),KA          CHECK FOR ALPHA PREFIX                21600022
         BL    TEST1              BR LOW - ERROR                        21640022
         CLI   D0(R1),KZ          CHECK ALPHA RANGE                     21700022
         BH    TEST0              BR HIGH - CHECK FOR NUMERIC           21760022
         MVC   TOTCROLT(D1),D0(R1) PUT ALPHA IN OLT TABLE               21820022
         LA    R1,D1(R1)          INCREMENT POINTER                     21880022
TEST0    EQU   *                                                        21940022
         MVC   WORK1(D4),D0(R1)   MOVE TEST TO WORK AREA                22000022
         NC    WORK1(D4),KF0      CLEAR LOW ORDER 4 BYTES               22200022
         CLC   WORK1(D4),KF0      ALL NUMERIC?                          22400022
         BNE   TEST1                   NO BRANCH                        22600020
TEST2    EQU   *                                                        22800020
         MVC   TOTCROLT+D1(D4),D0(R1) MOVE IN NUMERIC ID                22900022
         LA    R1,D4(R1)          BUMP PASS DEVICE TYPE                 22950022
         SPACE                                                          23008022
         SR    R4,R4              CLEAR REG 4                           23016022
         LR    R5,R1              POINT TO TEST SUFFIX IN TRM           23024022
         LA    R12,TOTOLTTB       POINT TO START OF OLT SUFFIX TABLE    23084022
         SPACE                                                          23152022
TEST2E   EQU   *                                                        23160022
         CLI   D0(R1),KA          VALUE LESS THAN A                     23164022
         BL    TEST1              ERROR - NOT AN ALPHA                  23168022
         CLI   D0(R1),KZ          VALUE GREATER THAN Z                  23172022
         BH    TEST1              ERROR - NOT AN ALPHA                  23176022
         SPACE                                                          23184022
         BAL   R9,ALPCHK               CHECK FOR VALID ALPHA FIELD      23200020
         CLI   D0(R1),COMMA       COMMA DELIMITER                       23400022
         BNE   TEST4                     NO                             23600020
         TM    D1(R1),F0          YES - NEXT FIELD NUMERIC              23800022
         BNO   TEST4                       NO                           24000020
         LA    R9,NUMCHK               SET UP FOR RETURN                24200020
NUMCHK   EQU   *                       CHECK VALIDITY OF FIELD          24400020
         LA    R1,D1(R1)          BUMP PASS DELIMITER                   24600022
         SR    R10,R10                 CLEAR COUNTER                    24800020
NUMCHK1  EQU   *                                                        25000020
         CLI   D0(R1),F0          CHAR LESS THAN ZERO                   25400022
         BL    TEST1              YES - ERROR                           25800022
         CLI   D0(R1),F9          CHAR GREATER THAN NINE ?              26200022
         BH    TEST1              YES - ERROR                           26600022
         B     RTNCHK             VERIFY ROUTINE NUMBER*                27000022
TEST4    EQU   *                                                        27800020
         LA    R1,D1(R1)          BUMP PASS DELIMITER                   28000022
         LR    R5,R1              POINT TO ALPHA SUFFIX                 28100022
         BAL   R9,ALPCHK               CHECK FOR VALID ALPHA FIELD      28200020
         B     TEST4                   CONTINUE IN LOOP                 28400020
ALPCHK   EQU   *                                                        28600020
         SR    R10,R10                 CLEAR COUNTER                    28800020
ALPCHK1  EQU   *                                                        29000020
         CLI   D0(R1),SLASH       END OF TEST FIELD                     29200022
         BE    TEST6                     YES                            29400020
         CLI   D0(R1),COMMA       COMMA DELIMITER                       29600022
         BE    TEST7                     YES                            29800020
         CLI   D0(R1),DASH        HYPHEN DELIMITER                      30000022
         BE    TEST7                     YES                            30200020
         CLI   D0(R1),KA          CHAR A OR GREATER                     30400022
         BL    TEST1                     NO                             30600020
         CLI   D0(R1),KZ          CHAR Z OR LESS                        30800022
         BH    TEST1                     NO                             31000020
         LA    R10,D1(R10)        BUMP COUNTER                          31200022
         LA    R1,D1(R1)          BUMP CHAR POINTER                     31400022
         B     ALPCHK1                 CONTINUE IN LOOP                 31600020
TEST6    EQU   *                                                        31800020
         LA    R9,OPTCHK               GET EXIT ADDRESS                 32000020
TEST7    EQU   *                                                        32200020
         CH    R10,H1             ONE OR LESS CHAR                      32400022
         BL    TEST1                     NO                             32600020
         CH    R10,H3             THREE OF LESS CHAR                    32800022
         BH    TEST1                     NO                             33000020
         BCTR  R10,R0             DECREMENT FOR EX                      33001022
         EX    R10,ALPSUFX        MOVE CHAR TO SUFFIX TABLE             33002022
         LA    R12,D3(R12)        NEXT SLOT IN SUFFIX TABLE             33003022
         CLI   D0(R1),DASH        INCLUSIVE TEST                        33007022
         BNE   TEST7A             NO                                    33012022
         OI    TOTFLG03,TOTTSINC  TURN ON INCLUSIVE FLAG                33018022
         LA    R1,D1(R1)          POINT PASS DELIMITER                  33021022
         LR    R5,R1              POINT TO ALPHA SUFFIX                 33022022
         SR    R11,R11            CLEAR REG 11                          33024022
         LA    R12,TOTOLTTB       POINT TO START OF SECTION ID TABLE    33030022
TESTAA   EQU   *                                                        33036022
         MVC   WORK(D1),D0(R1)    GET NEXT FIELD                        33042022
         CLI   WORK,KA            CHECK FOR INCLUSIVE ALPHA             33051022
         BL    TEST1              BR LOW - ERROR                        33060022
         CLI   WORK,KZ            CHECK LIMIT                           33066022
         BH    TEST1              BR HIGH - ERROR                       33072022
         LA    R7,TOTOLTTB+D33    END OF TABLE                          33078022
         SPACE                                                          33079022
TESTA1   EQU   *                                                        33080022
         CR    R12,R7             END OF TABLE?                         33081022
         BE    TEST1              YES                                   33082022
         CLC   D0(D3,R12),BLK3                                          33083022
         BE    ALPCHK             YES                                   33084022
         LA    R12,D3(R12)        POINT TO NEXT SLOT                    33085022
         B     TESTA1             CHECK NEXT SLOT                       33086022
         SPACE                                                          33086322
ALPSUFX  MVC   D0(D1,R12),D0(R5)  SECT SUFFIX TO TABLE                  33086622
         SPACE                                                          33087022
TEST7A   EQU   *                                                        33192022
         BR    R9                      EXIT                             33200020
TEST1    EQU   *                                                        33400020
         OI    TOTFLG03,TOTTSTER  SET TEST ID ERROR FLAG                33600022
TEST1A   EQU   *                                                        33800022
         L     R13,D4(R13)        CALLER'S SAVE                         34000022
         LM    R14,R1,D12(R13)    CALLER'S REG                          34200022
         XCTL  (2,12),EP=IEDQWJ   ERROR EXIT                            34400022
*                                                                       34600020
*                                                                       34800020
*        CHECK OPTIONS FIELD FOR VALID OPTIONS AND TURN ON              35000020
*        OPTION BITS IN OLTCB.  R1 HAS ADDR OF SLASH                    35200020
*        PRECEEDING THE OPTION FIELD                                    35400020
*                                                                       35600020
*                                                                       35800020
OPTCHK   EQU   *                                                        36000020
         TM    TOTFLG03,TOTTSINC  INCLUSIVE TEST SECTIONS ?             36010022
         BZ    OPTCHK0            NO - CONTINUE                         36020022
         CLC   TOTOLTTB(D3),TOTOLTTB+D3 A GRT/EQ B ?                    36030022
         BNL   TEST1              YES - ERROR                           36040022
OPTCHK0  EQU   *                                                        36050022
         TM    TOTFLG03,TOTAPOER   AP OPTION ERROR ?                    36060022
         BO    OPTERR             YES                                   36120022
         LA    R1,D1(R1)          POINT PASS SLASH                      36200022
         CLI   D0(R1),SLASH       END OF FIELD                          36400022
         BE    OPTEND                  YES BRANCH                       36600020
OPTCHK1  EQU   *                                                        36800022
         CLC   D0(D2,R1),TL       TEST LOOP?                            36900022
         BE    TLOPT              YES BRANCH                            37000022
         CLC   D0(D3,R1),NTL      NO TEST LOOP?                         37100022
         BE    NTLOPT             YES BRANCH                            37200022
         CLC   D0(D2,R1),EL       ERROR LOOP?                           37300022
         BE    ELOPT              YES BRANCH                            37400022
         CLC   D0(D3,R1),NEL      NO ERROR LOOP?                        37500022
         BE    NELOPT             YES BRANCH                            37600022
         CLC   D0(D2,R1),CP       CONTROL PRINT?                        37700022
         BE    CPOPT              YES BRANCH                            37800022
         CLC   D0(D3,R1),NCP      NO CONTROL PRINT?                     37900022
         BE    NCPOPT             YES BRANCH                            38000022
         CLC   D0(D3,R1),NMI      NO MANUAL INTERVENTION?               38100022
         BE    NMIOPT             YES BRANCH                            38200022
         CLC   D0(D2,R1),MI       MANUAL INTERVENTION?                  38300022
         BE    MIOPT              YES BRANCH                            38400022
         CLC   D0(D2,R1),AP       ALTERNATE PRINTER?                    38500022
         BE    APOPT              YES BRANCH                            38600022
         CLC   D0(D3,R1),NAP      NO ALTERNATE PRINTER?                 38700022
         BE    NAPOPT             YES BRANCH                            38800022
         CLC   D0(D2,R1),EP       ERROR PRINT?                          38900022
         BE    EPOPT              YES BRANCH                            39000022
         CLC   D0(D3,R1),NEP      NO ERROR PRINT?                       39100022
         BE    NEPOPT             YES BRANCH                            39200022
         CLC   D0(D2,R1),CM       CONCURRENT MODE?                      39300022
         BE    CMOPT              YES BRANCH                            39400022
         CLC   D0(D3,R1),NCM      NON-CONCURRENT MODE?                  39500022
         BE    NCMOPT             YES BRANCH                            39600022
         CLC   D0(D3,R1),EXT      EXTERNAL DATA?                        39700022
         BE    EXTOPT             YES BRANCH                            39800022
         CLC   D0(D2,R1),BK       BREAK OPTION                   S22024 39820010
         BE    BKOPT              YES BRANCH                     S22024 39840010
         CLC   D0(D3,R1),NBK      NO BREAK OPTION                S22024 39860010
         BE    NBKOPT             YES BRANCH                     S22024 39880010
         CLC   D0(D2,R1),TR       TRACE?                                39900022
         BE    TROPT              YES BRANCH                            40000022
         CLC   D0(D3,R1),NTR      NO TRACE?                             40100022
         BE    NTROPT             YES                                   42480022
         CLC   D0(D2,R1),NP       NO PRINT OPTION                S22024 42490022
         BE    NPOPT              YES                            S22024 42500022
         CLC   D0(D3,R1),TTP      TEST PRIMARY PATH              S22024 42504000
         BE    TTPOPT             YES                            S22024 42508000
         CLC   D0(D3,R1),TAP      TEST ALTERNATE PATH            S22024 42512000
         BE    TAPOPT             YES                            S22024 42516000
*                                                                       42520022
*        OPTION FIELD IN ERROR                                          42600020
*                                                                       42800020
OPTERR   EQU   *                                                        43000022
         OI    TOTFLG03,TOTOPTER  SET OPTION ERROR BIT                  43060022
         B     TEST1A             EXIT TO PROMPTER                      43120022
         SPACE                                                          43128000
TTPOPT   DS    0H                 BOUNDARY ALLIGNMENT            S22024 43136000
         NI    $TOTFLG1,XFF-$TERMSEC TEST PRIMARY PATH           S22024 43144000
         LA    R1,D3(R1)          POINT PASS OPTION              S22024 43152000
         B     SLCHK              CHECK NEXT ENTRY               S22024 43160000
         SPACE                                                          43168000
TAPOPT   DS    0H                 BOUNDARY ALLIGNMENT            S22024 43176000
         OI    $TOTFLG1,$TERMSEC  TEST ALTERNATE PATH            S22024 43184000
         LA    R1,D3(R1)          POINT PASS OPTION              S22024 43192000
         B     SLCHK              CHECK NEXT ENTRY               S22024 43200000
         SPACE                                                          43200810
BKOPT    DS    0H                 BOUNDARY ALLINMENT             S22024 43201610
         NI    TOTFLG09,XFF-TOTNOBRK CLEAR NO BREAK FLAG         S22024 43202410
         LA    R1,D2(R1)          POINT PASS OPTION              S22024 43203210
         B     SLCHK              CHECK NEXT ENTRY               S22024 43204010
         SPACE                                                          43204810
NBKOPT   DS    0H                 BOUNDARY ALLIGNMENT            S22024 43205610
         OI    TOTFLG06,TOTNCMFG  SHOW NON CONCURRENT MODE       S22024 43206010
         OI    TOTFLG09,TOTNOBRK  SET NO BREAK FLAG              S22024 43206410
         LA    R1,D3(R1)          POINT PASS OPTION              S22024 43207210
         B     SLCHK              CHECK NEXT OPTION              S22024 43208010
         SPACE                                                          43209022
TROPT    EQU   *                                                        43218022
         OI    $OLTFLGS,$TRACE    TURN ON TRACE BIT                     43227022
         LA    R1,D2(R1)          POINT PASS OPTION                     43236022
         B     SLCHK              CHECK NEXT ENTRY                      43245022
         EJECT                                                          43249022
         SPACE                                                          43254022
NTROPT   EQU   *                                                        43263022
         NI    $OLTFLGS,XFF-$TRACE TURN OFF TRACE OPT                   43272022
         LA    R1,D3(R1)          POINT PASS OPTION                     43281022
         B     SLCHK              CHECK NEXT ENTRY                      43290022
         SPACE 2                                                        43291022
NPOPT    EQU   *                                                 S22024 43292022
         OI    TOTFLG03,TOTIMNCP  SHOW NCP OPTION                S22024 43293022
         OI    $ERROPT,$NERRPRT   SHOW NEP OPTION                S22024 43294022
         LA    R1,D2(R1)          POINT PASS OPTION              S22024 43295022
         B     SLCHK              CHECK NEXT ENTRY               S22024 43296022
         SPACE 2                                                        43300022
TLOPT    EQU   *                                                        43400020
         OI    $ERROPT,$LOOPTST   TURN ON TL FLAG                       43600022
         LA    R10,D0             SET COUNTER                           43800022
         LA    R1,2(R1)                POINT PAST TL                    44000020
         LR    R3,R1                   SAVE POINTER                     44200020
TLOPT3   EQU   *                                                        44400022
         CLI   D0(R1),COMMA       END OF ENTRY                          44500022
         BE    TLOPT1                  YES BRANCH                       44600020
         CLI   D0(R1),SLASH       END OF FIELD                          44800022
         BE    TLOPT2                  YES BRANCH                       45000020
         LA    R1,D1(R1)          BUMP POINTER                          45200022
         LA    R10,D1(R10)        BUMP COUNTER                          45400022
         B     TLOPT3                  GO LOOK AGAIN                    45600020
TLOPT1   EQU   *                                                        45800020
TLOPT1A  LTR   R10,R10                   ANY NUMBERS GIVEN?             46000020
         BZ    TLOPT4                  NO BRANCH                        46200020
         CLI   D0(R3),F0          1ST NUMERIC ZERO                      46400022
         BNE   TRM202                    NO                             46600020
         TM    D1(R3),F0          YES - IS LOOP COUNT ZERO              46800022
         BNO   OPTERR                      YES: ERROR                   47000020
TRM202   EQU   *                                                        47200020
         XC    WORK1,WORK1                                              47400020
         XC    WORK2,WORK2             CLEAR WORK AREAS                 47600020
         BCTR  R10,R0             DECREMENT COUNT                       47800022
         LA    R7,D3              SET COMPARAND                         48000022
         CR    R10,R7                   MORE THAN 4 DIGITS?             48200020
         BH    OPTERR                  YES BRANCH                       48400020
         EX    R10,MOVE                MOVE NUMERICS TO WORKAREA        48600020
         EX    R10,AND                 CLEAR NUMERICS                   48800020
         EX    R10,COMPARE             ALL VALID NUMERICS?              49000020
         BNE   OPTERR                    NO                             49200020
         LA    R7,D7              SET COUNT                             49400022
         SR    R7,R10                   SUBTRACT NO. OF DIGITS          49600020
         LA    R8,WORK2(R7)            SET UP REG FOR MOVE              49800020
         EX    R10,MOVETL              MOVE LOOP COUNT TO WORK AREA     50000020
         PACK  WORK1+D5(D3),WORK2+D4(D4) PACK NUMBER                    50200022
         OI    WORK1+D7,X0F       MAKE SURE NUMBER IS +                 50400022
         SR    R10,R10                                                  50600020
         CVB   R10,WORK1                                                50800020
         STH   R10,TOTTLCNT       PUT TL COUNT IN OLTCB                 51000022
TLOPT5   TM    TRMFLG,END              END OF FIELD?                    51200020
         BO    OPTEND                  YES BRANCH                       51400020
         LA    R1,D1(R1)          POINT PASS DELIMITER                  51600022
         B     OPTCHK1            GO EXAMINE THE NEXT OPTION FIELD      51800022
TLOPT2   EQU   *                                                        52000020
         OI    TRMFLG,END              TURN ON END FLAG                 52200020
         B     TLOPT1A            GO SEE IF TEST LOOP COUNT SPECIFIED   52400022
TLOPT4   EQU   *                                                        52600020
         LA    R10,TLDF                                                 52700022
         STH   R10,TOTTLCNT       PUT TL DEFAULT COUNT IN OLTCB         52800022
         B     TLOPT5             CHECK FOR NEXT OPTION                 52900022
         SPACE 2                                                        53100022
NTLOPT   EQU   *                                                        53200020
         NI    $ERROPT,X'FF'-$LOOPTST  TURN OFF TL FLAG                 53300022
         LA    R1,D3(R1)          POINT PAST OPTION                     53400022
         B     SLCHK              GO CHECK FOR NEXT OPTION FIELD        53600022
         SPACE 2                                                        53700022
MOVETL   MVC   D0(D0,R8),D0(R3)   MOVE TL OPTION COUNT                  53800022
MOVE     MVC   TOTWKSPC(D0),D0(R3) MOVE TL OPT COUNT                    53900022
AND      NC    TOTWKSPC(D0),MASK0 MASK OUT UNWANTED BIT                 54000022
COMPARE  CLC   TOTWKSPC(D0),MASK0 NUMERIC                               54100022
         SPACE 2                                                        54500022
NELOPT   EQU   *                                                        54560022
         NI    $ERROPT,XFF-$LOOPERR TURN OFF ERROR LOOP FLAG            54620022
         LA    R1,D3(R1)          POINT PASS OPTION                     54680022
         B     SLCHK              CHECK FOR NEXT OPTION                 54740022
NCMOPT   EQU   *                                                        54800020
         OI    TOTFLG06,TOTNCMFG  SET NON-CONCURRENT MODE FLAG          55000022
         LA    R1,D3(R1)          POINT PASS NCM                        55100022
         B     SLCHK              CHECK NEXT OPTION                     55200022
         SPACE                                                          55300022
NAPOPT   EQU   *                                                        55360022
         NI    $ERROPT,XFF-$ALTPRNT TURN OFF AP OPTION FLAG             55420022
         LA    R1,3(R1)                 POINT PASS NAP                  55480022
         SPACE 2                                                        55540022
SLCHK    EQU   *                                                        55600020
         CLI   D0(R1),SLASH       END OF FIELD                          55800022
         BE    OPTEND                  YES BRANCH                       56000020
         CLI   D0(R1),COMMA       END OF ENTRY                          56200022
         BNE   OPTERR                  OPTION FIELD ERROR               56400020
         LA    R1,D1(R1)          POINT PASS COMMA                      56600022
         B     OPTCHK1            CHECK NEXT OPTION                     56800022
         SPACE 2                                                        56900022
ELOPT    EQU   *                                                        57000020
         OI    $ERROPT,$LOOPERR   TURN ON LOOP ON ERROR FLAG            57200022
         LA    R10,D0             FIND IF NUMBER GIVEN                  57400022
         LA    R1,D2(R1)          POINT PASS EL                         57600022
         LR    R3,R1                   SAVE POINTER                     57800020
ELOPT3   EQU   *                                                        58000022
         CLI   D0(R1),COMMA       END OF ENTRY                          58100022
         BE    ELOPT1                  YES BRANCH                       58200020
         CLI   D0(R1),SLASH       END OF FIELD                          58400022
         BE    ELOPT2                  YES BRANCH                       58600020
         LA    R10,D1(R10)        BUMP COUNTER                          58800022
         LA    R1,D1(R1)          BUMP POINTER                          59000022
         B     ELOPT3                  GO LOOK AGAIN                    59200020
ELOPT1   EQU   *                                                        59400020
ELOPT1A  LTR   R10,R10                   ANY NUMBERS GIVEN?             59600020
         BZ    ELOPT4                  NO BRANCH                        59800020
         CLI   D0(R3),F0          1ST NUMERIC ZERO                      60000022
         BNE   TRM204                    NO                             60200020
         TM    D1(R3),F0          YES - AND SECOND                      60400022
         BNO   OPTERR                      LOOP COUNT IS 0              60600020
TRM204   EQU   *                                                        60800020
         XC    WORK1,WORK1                                              61000020
         XC    WORK2,WORK2             CLEAR WORK AREAS                 61200020
         BCTR  R10,R0             DECREMENT COUNT BY ONE                61400022
         LA    R7,D3              SET COMPARAND                         61600022
         CR    R10,R7                   GT 4?                           61800020
         BH    OPTERR                  YES BRANCH                       62000020
         EX    R10,MOVE                MOVE LOOP COUNT TO WORKAREA      62200020
         EX    R10,AND                 CLEAR NUMERICS                   62400020
         EX    R10,COMPARE             ALL VALID NUMERICS?              62600020
         BNE   OPTERR                    NO: GO TO PROMPTER             62800020
         LA    R7,D7              SET COUNT                             63000022
         SR    R7,R10                   SUBTRACT NO OF DIGITS           63200020
         LA    R8,WORK2(R7)            SET UP REG FOR MOVE              63400020
         EX    R10,MOVETL              MOVE LOOP COUNT TO WORK AREA     63600020
         PACK  WORK1+D5(D3),WORK2+D4(D4) PACK THE NUMBER                63800022
         OI    WORK1+D7,X0F       MAKE SURE NUMBER IS +                 64000022
         SR    R10,R10                                                  64200020
         CVB   R10,WORK1                CONVERT NUMBER                  64400020
         STH   R10,$ERRLPCT       SET LOOP ON ERROR COUNT               64600022
ELOPT5   TM    TRMFLG,END              END OF FIELD                     64800020
         BO    OPTEND                  YES BRANCH                       65000020
         LA    R1,D1(R1)          BUMP PAST DELIMITER                   65200022
         B     OPTCHK1            GO CHECK FOR NEXT OPTION              65400022
ELOPT2   EQU   *                                                        65600020
         OI    TRMFLG,END                                               65800020
         B     ELOPT1A                 TURN ON END FLAG AND BRANCH      66000020
ELOPT4   EQU   *                                                        66200020
         LA    R10,ELDF           SET EL DEFAULT COUNT                  66300022
         STH   R10,$ERRLPCT       SET LOOP ON ERROR COUNT (DEFAULT)     66400022
         B     ELOPT5             CHECK FOR NEXT OPTION                 66500022
         SPACE 2                                                        66700022
         SPACE                                                          66800022
NCPOPT   EQU   *                                                        66900022
         LA    R1,D3(R1)          BUMP POINTER                          67030022
         OI    TOTFLG03,TOTIMNCP  SET NCP INTERMEDIATE FLAG             67060022
         SPACE 2                                                        67120022
         B     SLCHK              CHECK FO NEXT OPTION                  67200022
NEPOPT   EQU   *                                                        67400020
         OI    $ERROPT,$NERRPRT   TURN ON NEP FLAG                      67600022
         LA    R1,D3(R1)          POINT PASS NEP                        67700022
         B     SLCHK              CHECK FOR NEXT OPTION                 67800022
         SPACE 2                                                        67900022
APOPT    EQU   *                                                        68000020
         LA    R1,D2(R1)          BUMP POINTER                          68400022
         LA    R9,D9              SET COUNTER                           68500022
APOPT1   EQU   *                                                        68600022
         CLI   D0(R1),SLASH       END OF FIELD                          68700022
         BE    OPTEND                  YES BRANCH                       68800020
         CLI   D0(R1),COMMA       END OF ENTRY                          69000022
         BE    APOPT2                  YES BRANCH                       69200020
         LA    R1,D1(R1)          BUMP POINTER                          69400022
         BCT   R5,APOPT1          CHECK FOR END OF AP NAME              69500022
         B     OPTERR             ERROR                                 69600022
         SPACE 2                                                        69700022
APOPT2   EQU   *                                                        69800022
         LA    R1,D1(R1)          BUMP POINTER                          69900022
         B     OPTCHK1            CHECK NEXT OPTION                     70000022
         SPACE 2                                                        70100022
CPOPT    EQU   *                                                        70200020
         NI    TOTFLG03,XFF-TOTIMNCP TURN OFF NCP INTERMED. FLG         70300022
         LA    R1,D2(R1)          BUMP POINTER                          70400022
         B     SLCHK              CHECK FOR NEXT OPTION                 70600022
         SPACE 2                                                        70700022
EPOPT    EQU   *                                                        70800020
         LA    R1,2(R1)                BUMP POINTER PAST EP             71000020
         CLI   D0(R1),COMMA       DELIMITER                      S22024 71200022
         BE    EPOPT4             YES                            S22024 71300022
         CLI   D0(R1),SLASH       DELIMITER                      S22024 71400022
         BE    EPOPT4             YES                            S22024 71500022
         SPACE                                                          71600022
         CLI   D0(R1),LEV0        LEVEL LESS THAN 0              S22024 71700022
         BL    OPTERR             YES - ERROR                    S22024 71800022
         CLI   D0(R1),LEV3        LEVEL GREATER THAN 3           S22024 71900022
         BH    OPTERR             YES - ERROR                    S22024 72000022
         SPACE                                                          72100022
         MVC   WORK1(D1),D0(R1)   LEVEL VALUE TO WORK AREA       S22024 72200022
EPOPT2   EQU   *                                                 S22024 72300022
         NI    WORK1,X0F          CLEAR UNWANTED BITS            S22024 72400022
         MVC   TOTFLG08(D1),WORK1 SET EP LEVEL FOR DPRINT        S22024 72500022
         LA    R1,D1(R1)          BUMP POINTER                          72800022
         B     SLCHK                   YES GO LOOK FOR NEXT OPTION      73000020
         SPACE                                                          73001022
EPOPT4   EQU   *                                                 S22024 73002022
         MVI   WORK1,LEV3         SET DEFAULT LEVEL              S22024 73003022
         B     EPOPT2             SET VALUE IN OLTCB             S22024 73004022
         SPACE 2                                                        73009022
CMOPT    EQU   *                                                        73018022
         NI    TOTFLG06,XFF-TOTNCMFG SHOW CONCURRENT MODE               73027022
         LA    R1,2(R1)           POINT PASS CM                         73036022
         B     SLCHK              CHECK FOR NEXT OPTION                 73045022
         SPACE 2                                                        73054022
EXTOPT   EQU   *                                                        73063022
         SR    R5,R5              INITIALIZE DATA COUNTER               73072022
         CLI   D3(R1),EQUAL       = CHAR DELIMITER                      73081022
         BNE   OPTERR             NO, ERRROR                            73090022
         LA    R15,EXTLEN         DATA COUNT LENGTH                     73099022
         LA    R4,D4(R1)          POINT TO DATA FIELD                   73108022
EXTOPT1  EQU   *                                                        73117022
         CLI   D0(R4),SLASH       / CHAR DELIMITER                      73144022
         BE    EXTOPT2            YES                                   73153022
         LA    R5,D1(R5)          INCREMENT CHAR COUNTER                73162022
         LA    R4,D1(R4)          POINT TO NEXT CHAR                    73171022
         CR    R5,R15             MAXIMUM NO. OF CHAR ?                 73180022
         BH    OPTERR             TOO MANY CHAR                         73189022
         B     EXTOPT1            CHECK NEXT CHAR                       73198022
         SPACE 2                                                        73216022
EXTOPT2  EQU   *                                                        73225022
         LTR   R5,R5                                                    73228022
         BZ    OPTERR             ERROR                                 73231022
         STC   R5,TOTEXT          MAKE COUNT FIRST CHAR. OF BUFFER      73232022
         BCTR  R5,R0              DECREMENT FOR MOVE                    73234022
         EX    R5,MOVEXT          MOVE EXT DATA TO BFR                  73243022
         LA    R1,D5(R5,R1)       POINT TO DELIMITER                    73252022
         B     SLCHK              CHECK NEXT OPTION                     73261022
         SPACE 2                                                        73270022
NMIOPT   EQU   *                                                        73279022
         NI    $OLTFLGS,XFF-$MANINTV SHOW NO MI                         73288022
         LA    R1,D3(R1)          POINT PASS NMI                        73297022
         B     SLCHK              CHECK NEXT OPTION                     73306022
         SPACE 2                                                        73315022
MIOPT    EQU   *                                                        73324022
         OI    $OLTFLGS,$MANINTV  SHOW MI                               73333022
         LA    R1,D2(R1)          POINT PASS MI                         73342022
         B     SLCHK              CHECK NEXT OPTION                     73351022
         SPACE 2                                                        73360022
         SPACE 2                                                        73369022
OPTEND   EQU   *                                                        73400020
         TM    TOTFLG06,TOTNCMFG  IS NCM REQUESTED?                     73870022
         BZ    TRM259                    NO                             74200020
         BAL   R9,RNCHK           DETERMINE IF TD ON 3705        S22024 74300022
         LA    R7,NCMMSG2         GET START OF DEVICE FLD OF MSG S22024 74400022
         LA    R9,TDMAX           MAX TEST DEV COUNT                    74600022
         LA    R8,TOTTDTBL        GET START OF TEST DEVICE FIELD        74800022
         TM    TOTFLG10,TOTTERMS  TERMINAL TEST ?                       74820022
         BO    TRMTNCM            YES - BRANCH                          74840022
         MVC   WORK3(D4),D0(R8)   UCB ADDR                              74860022
         MVI   WORK3,D0           CLEAR FLAG                            74930022
         B     TRM2506A           GET NEXT ENTRY                        75000022
TRM2506  EQU   *                                                        75200020
         MVC   WORK3(D4),D0(R8)   SAVE ENTRY                            75300022
         CLC   D0(D4,R8),K0       ANY MORE ENTRIES                      75400022
         BE    TRM2508                   NO                             75600020
         MVI   D0(R7),COMMA       SET DELIMITER                         75800022
         LA    R7,D1(R7)          BUMP PASS COMMA                       76000022
         TM    TOTFLG10,TOTTERMS  TERMINAL TEST ?                       76060022
         BO    TRMTNCM            YES - BRANCH                          76120022
TRM2506A EQU   *                                                        76200020
         BCT   R9,TRM2507              END OF TABLE?                    76400020
         B     TRM2508                   YES                            76600020
TRM2507  EQU   *                                                        76800020
         L     R12,WORK3          GET UCB ADDR                          76880022
         USING UCB,R12                                                  76960022
         MVC   D0(D3,R7),UCBNAME  UCB EBCDIC NAME                       77040022
         TM    TOTFLG10,TOTTERMS   IS THIS A TERMINAL TEST       S22024 77046022
         BO    TRM25072            YES BYPASS THIS MIX TEST      S22024 77052022
*                                  NO TEST FOR MIXED 270X / 3705 S22024 77058022
         CLI   UCBTBYT4,TYPE1CA    3704/5 TYPE 1 CA              S22024 77064022
         BE    TRM25071            YES SET PROPER BIT            S22024 77070022
         CLI   UCBTBYT4,TYPE2CA    3704/5 TYPE 2 CA              S22024 77076022
         BE    TRM25071            YES SET PROPER BIT            S22024 77082022
         OI    TOTFLG02,TOTDEV0X   CHANNEL TEST ON 2701,2,3      S22024 77088022
         B     TRM25072            CONTINUE CHECKING TCU'S       S22024 77094022
TRM25071 DS    0H                  ALIGN ON HALFWORD             S22024 77100022
         OI    TOTFLG02,TOTDEVRN   CHANNEL TEST ON 3704,5        S22024 77106022
TRM25072 DS    0H                  ALIGN ON HALFWORD             S22024 77112022
         DROP  R12                                                      77120022
         LA    R7,D3(R7)          BUMP TO NEXT FIELD                    77200022
         LA    R8,D4(R8)          POINT TO NEXT UCB ADDR                77400022
         B     TRM2506                 GO GET NEXT ENTRY                77600020
TRM2508  EQU   *                                                        77800020
         TM    TOTFLG02,TOTDEV0X+TOTDEVRN ARE BOTH TCU BITS ON   S22024 81210022
         BO    TRM25042                    YES PRINT ERROR       S22024 81220022
         TM    TOTFLG02,TOTDEVRN   IS TEST FOR 3704/3705         S22024 81230022
         BO    TRM25043            YES ASK FOR PERMISSION        S22024 81240022
*                                  NO  ASK TO USE 270X LINES     S22024 81250022
         WTO   'IED224D CAN OLT HAVE EXCLUSIVE USE OF CONTROL UNIT ON A*81300000
               DDRESS(ES) ',ROUTCDE=10,DESC=7                    S22024 81400000
TRM25041 DS    0H                  ALIGN ON HALFWORD             S22024 81500022
         XC    ECB(4),ECB              CLEAR ECB FOR WTOR               81600020
WTORNCM  WTOR  '                                                     ',*81800022
               ANSWER,3,ECB,ROUTCDE=(8,10),DESC=2                S22024 82000022
         STIMER REAL,NOANS,DINTVL=TIMOUT    SET TIMER FOR TIMEOUT       82200020
         WAIT  ECB=ECB                 WAIT FOR REPLY                   82400020
         TTIMER CANCEL                 CANCEL TIMER                     82600020
         OI    ANSWER,BLANK       XLATE ANS TO CAP                      82800022
         CLI   ANSWER,YES         YES                                   82900022
         BE    TRM259                    YES                            83100020
         IEDQMSG MSGID=051,FUNCT=CEC,LINK=YES NCM REJECTED       S22024 83200022
         B     GETOUT             EXIT                                  83300022
TRM25042 DS    0H                  ALIGN ON HALFWORD             S22024 83310022
         IEDQMSG MSGID=001,FUNCT=CEC   INVALID MIX OF TCU TYPES  S22024 83320022
         B     GETOUT              CLEAN UP AND RETURN           S22024 83330022
TRM25043 DS    0H                  ALIGN ON HALFWORD                    83340022
         WTO   'IED235D CAN OLT HAVE EXCLUSIVE USE OF 3705 ON ADDRESS(E*83350000
               S) ',ROUTCDE=10,DESC=7                            S22024 83360000
         B     TRM25041            PRINT REST OF MESSAGE         S22024 83370022
TRM259   EQU   *                                                        83400020
         L     R13,D4(R13)        CALLER'S SAVE AREA ADDR               83600022
         TM    TOTFLG02,TOTCONMD  TD ON CONC                    SA41597 83630022
         BZ    PMT260             NO                            SA41597 83660022
         LM    R14,R1,D12(R13)    CALLER'S REG                  SA41597 83670000
         XCTL  (2,12),EP=IEDQWEC  YES - EXIT TO IEDQWC          SA41597 83690022
         SPACE                                                          83720022
PMT260   EQU   *                                                SA41597 83750022
         LM    R14,R1,D12(R13)    CALLER'S REG                          83800022
         XCTL  (2,12),EP=IEDQWD   NORMAL EXIT                           84000022
         EJECT                                                          84400020
GETOUT   EQU   *                                                        84600020
         XC    TOTTDTBL(D40),TOTTDTBL CLEAR TD TABLE                    84700000
         OI    TOTFLG06,TOTOTERM  SET TERMINATE FLAG                    84800022
         L     R13,D4(R13)        CALLER'S SAVE AREA ADDR               85000022
         LM    R14,R1,D12(R13)    CALLER'S REG                          85200022
         XCTL  (2,12),EP=IEDQWE        GO TO IEDQWE                     85400020
NCMMSG2  EQU   WTORNCM+16         STARTING ADDR FOR CUU ADDR IN  S22024 85404000
*                                   MESSAGE                      S22024 85406000
         EJECT                                                          85408022
TRMTNCM  EQU   *   R8 POINTS TO TEST ENTRY                              85412022
         STM   R7,R12,TRMSAVE1    SAVE WORK REG                         85416022
         L     R9,TRMNCMCT        GET  ENTRY COUNTER                    85420022
         LA    R9,D1(R9)          INCREMENT BY ONE                      85424022
         CL    R9,TRMTEN          END OF TABLE ?                        85428022
         BH    TRMNCM1            YES                                   85432022
         ST    R9,TRMNCMCT       SAVE COUNTER                           85436022
         L     R12,D0(R8)         GET TNT ADDR                          85440022
         LA    R12,D0(R12)         CLEAR HIGH ORDER BYTE                85444022
         LTR   R12,R12            LAST ENTRY ?                          85448022
         BZ    TRMNCM1            YES - BRANCH                          85452022
         SR    R10,R10            CLEAR REG                             85456022
         IC    R10,TOTTTBEL       GET NAME LENGTH                       85460022
         AR    R12,R10            GET ADDR OF TTE ADDR                  85464022
         MVC   TTEADDR+D1(D3),D0(R12)   ALLIGN ADDRESS                  85468022
         L     R11,TTEADDR        GET TTE ADDR                          85472022
         USING IEDQTRM,R11                                              85476022
         L     R11,TRMDESTQ-D1    GET QCB ADDR                          85480022
         DROP  R11                                                      85484022
         USING IEDQQCB,R11                                              85488022
         SR    R7,R7              CLEAR REG                             85492022
         IC    R7,QCBRELLN        GET RLN                               85496022
         SLL   R7,D2              MULT BY 4                             85500022
         L     R11,QCBDCBAD-D1    GET DCB ADDR                          85504022
         DROP  R11                                                      85508022
         USING IHADCB,R11                                               85512022
         L     R11,DCBDEBAD       GET DEB ADDR                          85516022
         DROP  R11                                                      85520022
         USING DEBNMSUB,R11                                             85524022
         SR    R15,R15            CLEAR REG                             85528022
         IC    R15,DEBNMEXT       GET # OF EXTENTS                      85532022
         SLL   R15,D2             MULT BY 4                             85536022
         L     R11,DEBUCBAD-D4(R7)  GET UCB ADDR                        85540022
         ST    R11,WORK3          SAVE IT                               85544022
         LM    R7,R12,TRMSAVE1    RESTORE CALLER'S REG                  85548022
         B     TRM2507            RETURN                                85552022
TRMNCM1  EQU   *                                                        85556022
         BCTR  R7,R0              DECREMENT COUNT BY 1                  85560022
         MVI   D0(R7),BLANK       BLANK OUT CHARACTER                   85564022
         LM    R7,R12,TRMSAVE1    RESTORE CALLER'S REG                  85568022
         B     TRM2508            RETURN                                85572022
         EJECT                                                          85601022
RTNCHK   EQU   *                  SET ROUTINE MASKS IN SCT              85602022
         TM    TOTFLG03,TOTTSINC  INCLUSIVE TEST ?                      85602322
         BO    TEST1              YES - ERROR                           85602622
*                                                                       85603022
         OI    $EXECFLG,$RTNSLCT  SHOW THAT ROUTINES SELECTED           85604022
         STM   R7,R12,SAVAREA     SAVE REGISTERS                        85605022
RTN2     EQU   *                                                        85606022
         TM    RTNFLG,RTNSFLG     END OF TEST FIELD ?                   85607022
         BO    RTNEND             YES                                   85608022
         XC    RTNFLG,RTNFLG      CLEAR FLAG BYTE                       85609022
         LR    R7,R1              POINT TO FIRST DIGIT                  85610022
RTN3     EQU   *                                                        85611022
         LA    R8,D0              INIT. DIGIT COUNTER                   85612022
RTN4     EQU   *                                                        85613022
         CLI   D0(R7),SLASH       SLASH DELIMITER ?                     85614022
         BE    RTNSLH             YES                                   85615022
         CLI   D0(R7),DASH        INCLUSIVE TEST ?                      85616022
         BE    RTNDSH             YES                                   85617022
         CLI   D0(R7),COMMA       COMMA DELIMITER ?                     85618022
         BE    RTNCMA             YES                                   85619022
         CLI   D0(R7),F0          DIGIT LESS THAN 0 ?                   85620022
         BL    TEST1              YES - ERROR                           85621022
         CLI   D0(R7),F9          DIGIT GREATER THAN 9 ?                85622022
         BH    TEST1              YES - ERROR                           85623022
         LA    R7,D1(R7)          POINT TO NEXT CHAR                    85624022
         LA    R8,D1(R8)          INCREMENT CHAR COUNTER                85625022
         B     RTN4               CHECK NEXT CHAR                       85626022
RTNSLH   EQU   *                                                        85627022
         OI    RTNFLG,RTNSFLG     SHOW END OF TEST FIELD                85628022
         B     RTN6               EXIT                                  85629022
RTNDSH   EQU   *                                                        85630022
         TM    RTNFLG,RTNDFLG     INCLUSIVE ROUTINES ?                  85631022
         BO    RTN6               YES                                   85632022
         OI    RTNFLG,RTNDFLG     SHOW INCLUSIVE ROUTINES               85633022
         B     RTN6               EXIT                                  85634022
RTNCMA   EQU   *                                                        85635022
         OI    RTNFLG,RTNCFLG     SHOW SEPARATE ENTRIES                 85636022
RTN6     EQU   *                                                        85637022
         LTR   R8,R8              ANY DIGITS ?                          85638022
         BZ    TEST1              NO - ERROR                            85639022
         CL    R8,K3              THREE DIGITS OR LESS           S22024 85639322
         BH    TEST1              NO - ERROR                     S22024 85639622
         CL    R8,K3              NUMBER OF DIGITS = 3           S22024 85640010
         BNE   RTN8               NO - BYPASS MAXIMUM CHECK      S22024 85640310
         SR    R7,R8              POINT TO FIRST DIGIT           S22024 85640610
         CLC   D0(D3,R7),RTNMAX   RTN NUMBER > MAXIMUM           S22024 85640910
         BH    TEST1              YES - RTN # TOO LARGE          S22024 85641210
         AR    R7,R8              RESET POINTER                  S22024 85641510
RTN8     DS    0H                 BOUNDARY ALLIGNMENT            S22024 85641810
         BCTR  R8,R0              DECREMENT COUNT FOR EX         S22024 85642110
         EX    R8,PACK            PACK THE NUMBER                S22024 85642410
         CVB   R9,DEC             CONVERT IT TO BINARY           S22024 85642710
         TM    RTNFLG,RTNNFLG     INCLUSIVE SECOND TEST          S22024 85643010
         BO    RTN12              YES                                   85644022
         ST    R9,DIG1            SAVE NUMBER                           85645022
         TM    RTNFLG,RTNDFLG     INCLUSIVE ROUTINES ?                  85646022
         BZ    RTN15              NO                                    85647022
         OI    RTNFLG,RTNNFLG     YES - SET SECOND PASS FLAG            85648022
         LA    R1,D1(R7)          POINT PASS DELIMITER                  85649022
         LR    R7,R1              SAVE POINTER                          85650022
         B     RTN3               GO FIND UPPER LIMIT                   85651022
RTN12    EQU   *                                                        85652022
         ST    R9,DIG2            SAVE UPPER LIMIT                      85653022
         CLC   DIG1(D4),K256      NUMBER GREATER THAN MAX. ?            85654022
         BH    TEST1              YES - ERROR                           85655022
         CLC   DIG2,K256          NUMBER GREATER THAN MAX. ?            85656022
         BH    TEST1              YES - ERROR                           85657022
         CLC   DIG1(D4),DIG2      1ST NUMBER GRT/EQ TO 2ND NUMBER ?     85658022
         BNL   TEST1              YES - ERROR                           85659022
RTN15    EQU   *                  SET ROUTINE MASK BITS                 85660022
         L     R9,DIG1            GET ROUTINE NUMBER                    85661022
         CL    R9,K0              RTN NUMBER EQU ZERO                   85662022
         BE    TEST1              YES - ERROR                           85663022
         CLC   DIG1(D4),K16       SET MASK BETWEEN 1 AND 16             85664022
         BH    RTN24              NO - CHECK NEXT FIELDS                85665022
*        SET MASK FOR ROUTINES 1-16                                     85666022
         LA    R12,$RT0108        POINT TO RTN MASK FIELD               85667022
         LA    R11,TESET          POINT TO SET MASK TABLE               85668022
RTN17    EQU   *                                                        85669022
         S     R9,K8              DECREMENT BY 8                        85670022
         BNP   RTN19              IF RESULT NEG. , EXIT                 85671022
         LA    R12,D1(R12)        POINT TO SECOND BYTE                  85672022
         B     RTN19A             GO SET MASK                           85673022
RTN19    EQU   *                                                        85674022
         L     R9,DIG1            GET RTN NUMBER                        85675022
RTN19A   EQU   *                                                        85676022
         BCTR  R9,R0              DECREMENT FOR MOVE                    85677022
RTN20    EQU   *                                                        85678022
         AR    R9,R11             POINT TO MASK SETTING                 85679022
         OC    D0(D1,R12),D0(R9)  SET MASK                              85680022
RTN21    EQU   *                                                        85681022
         TM    RTNFLG,RTNIFLG     INCLUSIVE LOOP ?                      85682022
         BO    RTN22            YES                                     85683022
         LA    R7,D1(R7)          POINT PASS DELIMITER                  85684022
         LR    R1,R7              RESET TRM PTR                         85685022
RTN22    EQU   *                                                        85686022
         TM    RTNFLG,RTNDFLG     INCLUSIVE ROUTINES                    85687022
         BZ    RTN2               NO CONTINUE                           85688022
         OI    RTNFLG,RTNIFLG     SET INCLUSIVE LOOP FLAG               85689022
         CLC   DIG1(D4),DIG2      END OF INCLUSIVE SET ?                85690022
         BE    RTN2               YES CONTINUE                          85691022
         L     R9,DIG1            GET FIRST NUMBER                      85692022
         LA    R9,D1(R9)          INCREMENT BY 1                        85693022
         ST    R9,DIG1            REPLACE NUMBER                        85694022
         B     RTN15              EVALUATE THIS ROUTINE NUMBER          85695022
RTN24    EQU   *                  SET MASK FOR ROUTINES 17-256          85696022
         L     R9,DIG1            GET FIRST NUMBER                      85697022
         LA    R12,$R025032       POINT TO SECOND MASK FIELD            85698022
         LA    R8,D24             INIT COMPARAND                        85699022
         LA    R11,TESET          POINT TO SET MASK TABLE               85700022
RTN28    EQU   *                                                        85701022
         CR    R9,R8              IS FLAG IN PRIOR BYTE ?               85702022
         BNH   RTN32              YES - EXIT                            85703022
         LA    R8,D8(R8)          INCREMENT COMPARAND                   85704022
         LA    R12,D1(R12)        POINT TO NEXT MASK BYTE               85705022
         B     RTN28              CHECK NEXT BYTE                       85706022
RTN32    EQU   *                  MASK FIELD FOUNT                      85707022
         BCTR  R12,R0             ADJUST TO CORRECT BYTE                85708022
         LA    R9,D8(R9)          ADJUST RTN NUMBER                     85709022
         SR    R9,R8              ADJUST INDEX INTO MASK TABLE          85710022
         BCTR  R9,R0              DECREMENT FOR INDEX INTO MASK TABLE   85711022
         B     RTN20              GO SET MASK                           85712022
RTNEND   EQU   *                                                        85713022
         BCTR  R1,R0              ADJUST TRM POINTER                    85714022
         LM    R7,R12,SAVAREA     RESTORE REG.                          85715022
         B     OPTCHK             CHECK OPTION FIELD                    85716022
         EJECT                                                          85800020
NOANS    EQU   *                                                        86000020
         STM   R14,R12,D12(R13)   SAVE CALLER'S REG                     86200022
         LR    R4,R15                  GET MY BASE                      86400020
         USING NOANS,R4                                                 86600020
         LA    R12,TRMSAV2             GET MY SAVE                      86800020
         ST    R13,D4(R12)        SAVE HIS SAVE ADDR                    87000022
         ST    R12,D8(R13)        SAVE MY SAVE ADDR                     87200022
         LR    R13,R12                 SET SAVE POINTER                 87400020
         POST  ECB                     POST WTOR ECB                    87600020
         L     R13,D4(R13)        GET CALLER'S SAVE                     87800022
         LM    R14,R12,D12(R13)   RESTORE CALLER'S REG                  88000022
         BR    R14                     RETURN TO CALLER                 88200020
         DROP  R4                                                       88400020
         SPACE 2                                                        88406022
**************************************************************** S22024 88412022
*        ROUTINE TO DETERMINE IF TEST DEVICE IS ON A 3705.     * S22024 88418022
*        IF SO , THE NCM OPTION IS TURN OFF.                   * S22024 88424022
**************************************************************** S22024 88430022
RNCHK    EQU   *                                                 S22024 88436022
         STM   R7,R9,TRMSAVE1     SAVE REGISTERS                 S22024 88442022
         LA    R7,TOTTDTBL        POINT TO TEST DEVICE TABLE     S22024 88448022
         LA    R8,TOTTDEND        END OF TABLE                   S22024 88454022
RNCHK2   EQU   *                  S22024                                88460022
         CR    R7,R8              END OF TABLE                   S22024 88466022
         BE    RNCHKE             YES - EXIT (NO 3705 TD)        S22024 88472022
         L     R9,D0(R7)          GET TD ENTRY                   S22024 88478022
         LTR   R9,R9              ANY MORE ENTRIES               S22024 88484022
         BZ    RNCHKE             NO - EXIT (NO 3705 TD)         S22024 88490022
         SPACE                                                          88496022
         TM    D0(R7),TOTTDORN    TD ON 3705                     S22024 88502022
         BO    RNCHKNCM           YES                            S22024 88508022
         LA    R7,D4(R7)          POINT TO NEXT ENTRY            S22024 88514022
         B     RNCHK2             CHECK IT                       S22024 88520022
         SPACE                                                          88526022
RNCHKE   EQU   *                                                 S22024 88532022
         LM    R7,R9,TRMSAVE1     RESTORE REGISTERS              S22024 88538022
         BR    R9                 RETURN                         S22024 88544022
         SPACE                                                          88550022
RNCHKNCM EQU   *                  S22024                                88556022
         NI    TOTFLG06,XFF-TOTNCMFG SET CM                      S22024 88562022
         IEDQMSG MSGID=008,FUNCT=CEC NCM REJECTED                S22024 88568022
         B     TRM259             EXIT                           S22024 88574022
         EJECT                                                          88600020
WORK1    DS    D                  WORK AREA                             88800022
WORK2    DS    D                  WORK AREA                             88900022
WORK3    DS    F                  WORK AREA                             89000022
SAVAREA  DS    18F                SAVE AREA                             89100022
THREE    DC    F'3'               VALUE OF 3                            89200022
WORK     DC    F'0'               WORK AREA                             89300022
TRMFLG   DC    X'00'              CONTROL FLAG                          89400022
TRMWRK   DS    CL72               TRM BUFFER WORK AREA                  89500022
TRMSAV2  DC    18F'0'             TIMER COMPLETE SAVE AREA              90000022
TRMNCMCT DC    F'0'               TEST ENTRY COUNTER SAVE               90030022
TRMSAVE1 DS    5F                 SAVE AREA                             90060022
TRMTEN   DC    F'10'              VALUE OF TEN                          90090022
TTEADDR  DC    F'0'               WORK AREA                             90120022
NOUCB    DC    H'0'               COMPARE OPERAND                       90150022
         DS    0D                                                       90200020
TIMOUT   DC    X'F0F0F0F3F0F0F0F0' TIMER FOR TIMEOUT                    90400022
ANSWER   DC    CL3' '             REPLY BUFFER                          90500022
ECB      DC    F'0'               ECB WORD                              90600022
DEC      DC    D'0'               WORK AREA                             90810022
DIG1     DC    F'0'               WORK AREA                             90820022
DIG2     DC    F'0'               WORK AREA                             90830022
K0       DC    F'0'               VALUE OF ZERO                         90840022
K1       DC    F'1'               VALUE OF 1                            90850022
K3       DC    F'3'               VALUE OF 3                            90855022
K8       DC    F'8'               VALUE OF 8                            90860022
K16      DC    F'16'              VALUE OF 16                           90870022
K248     DC    F'248'             VALUE OF 248                          90880022
K256     DC    F'256'             VALUE OF 256                          90890022
H1       DC    H'1'               VALUE OF 1                            90892022
H3       DC    H'3'               VALUE OF 3                            90894022
MASK0    DC    4XL1'F0'           AND/COMPARAND FIELD                   90896022
BLK3     DC    3XL1'40'           COMPARAND FIELD                       90898022
RTNFLG   DC    X'00'              ROUTINE CONTROL FLAG                  90900022
TESET    DC    X'8040201008040201' SET RTN MASK TABLE                   90910022
KF0      DC    4CL1'0'            MASK FIEDL                            90910522
TTP      DC    C'TPP'             TEST PRIMARY PATH              S22024 90910600
TAP      DC    C'TAP'             TEST ALTERNATE PATH            S22024 90910700
TL       DC    C'TL'              TEST LOOP                             90911022
NTL      DC    C'NTL'             NO TEST LOOP                          90911522
EL       DC    C'EL'              ERROR LOOP                            90912022
NEL      DC    C'NEL'             NO ERROR LOOP                         90912522
CP       DC    C'CP'              CONTROL PRINT                         90913022
NCP      DC    C'NCP'             NO CONTROL PRINT                      90913522
NMI      DC    C'NMI'             NO MANUAL INPUT                       90914022
MI       DC    C'MI'              MANUAL INPUT                          90914522
AP       DC    C'AP'              ALTERNATE PRINTER                     90915022
NAP      DC    C'NAP'             NO ALTERNATE PRINTER                  90915522
EP       DC    C'EP'              ERROR PRINT                           90916022
NEP      DC    C'NEP'             NO ERROR PRINT                        90916522
CM       DC    C'CM'              CONCURRENT MODE                       90917022
NCM      DC    C'NCM'             NON-CONCURRENT MODE                   90917522
EXT      DC    C'EXT'             EXTERNAL DATA                         90918022
TR       DC    C'TR'              TRACE FUNCTION                        90918522
NTR      DC    C'NTR'             NO TRACE FUNCTION                     90919022
NBK      DC    C'NBK'             NO BREAK OPTION                S22024 90919110
BK       DC    C'BK'              BREAK OPTION                   S22024 90919210
RTNMAX   DC    C'255'             MAXIMUM VALID RTN NUMBER       S22024 90919310
NP       DC    C'NP'              NO PRINT                              90919522
PACK     PACK  DEC(8),D0(D0,R1)   CONVERT FROM ZONE TO DEC              90920022
MOVEXT   MVC   TOTEXT+D1(D1),D4(R1) MOVE EXT DATA TO OLTCB              90960022
PATCH    DC    CL200' '           MAINTENANCE AREA                      91000022
         EJECT                                                          91202022
         TQCBD                                                          91204022
         EJECT                                                          91206022
         DCBD  DSORG=TX                                                 91208022
         EJECT                                                          91210022
         TTRMD                                                          91212022
         EJECT                                                          91214022
         TDEBD                                                          91216022
         EJECT                                                          91220022
         OLTCB                                                          91240022
         EJECT                                                          91260022
         TPRFD                                                          91280022
         EJECT                                                          91300022
UCB      DSECT                                                          91320022
         IEFUCBOB                                                       91340022
         SPACE 2                                                        91360022
         END                                                            91400020
./  ADD  SSI=72210229,NAME=IEDQWD
         TITLE 'IEDQWD - TOTE DISPATCHER MODULE'                        00070000
IEDQWD   CSECT                                                          00140000
*A000000-999999                                                @Y16X5U0 00210000
*CHANGE ACTIVITY AS FOLLOWS:                                            00280000
*A378450-378650,405250-405650,669420-669480                     SA41599 00350000
*D203850-323850                                                  S21903 00420000
*A203850-263850                                                  S21903 00490000
*C000000-999999                                                  S22024 00560000
*A269080-269880                                                  S05331 00630000
*C817000                                                         S05331 00700000
*D309000                                                         S05331 00770000
*A122300-122600,804200-804800,821700-821900,822070-823890        Y06330 00840000
*A878020-878120                                                  Y06330 00910000
*822000-823000                                                   Y06330 00980000
*D653000                                                        SA64791 01050000
*A705000,746000                                                 SA64791 01120000
*A431300-431600,833200-833800,881300-881600                    @SA69637 01190000
*D882000                                                       @ZA06159 01260000
*C742000-745000,736000-737000                                  @ZA06159 01330000
*A170000                                                       @ZA06159 01400000
*A701000,441000,705000                                         @OY12959 01470000
*A427000,431000,569000,615000,697000,820000,861000             @Y17XAUU 01540000
*C702000,8220000                                               @Y17XAUU 01610000
* A016100,800800,820400                                        @G36XRUV 01620010
* C800800                                                      @G36XRUV 01630010
*                                                                       01640010
*********************************************************************** 01680000
*                                                                     * 01750000
* MODULE NAME:  IEDQWD (TCAM,TOTE)                             @Y17XAUU 01820000
*                                                                     * 01890000
* DESCRIPTIVE NAME:  TOTE DISPATCHER                                  * 01960000
*                                                                     * 02030000
* COPYRIGHT:  'NONE'                                                  * 02100000
*                                                                     * 02170000
* STATUS:  VERSION 10.0                                        @Y17XAUU 02240000
*                                                                     * 02310000
* FUNCTION:                                                           * 02380000
*                                                                     * 02450000
*    THE PURPOSE OF THIS MODULE IS TO:                                * 02520000
*                                                                     * 02590000
*        1. SET THE NO CONTROL PRINT FLAG IN THE SCT IF 'NCP' IS      * 02660000
*           SPECIFIED IN THE TRM.                                     * 02730000
*        2. VERIFY THAT THE SYSOUT DCB IS OPEN IF 'APSYSOUT' IS       * 02800000
*           SPECIFIED IN THE TRM.                                     * 02870000
*        3. VERIFY THAT THE TEST DEVICE IS SUPPORTED - I.E. UCB       * 02940000
*           INDICATES COMMUNICATION OR GRAPHIC DEVICE                 * 03010000
*        4. EXCLUSIVELY ENQ ON TEST DEVICE TO PROTECT OTHER OLTS      * 03080000
*           FROM USING SAME DEVICES.  IF TEST DEVICE IS A REMOTE      * 03150000
*           DEVICE (I.E. SYMBOLIC NAME), A 'SHARE' ENQ IS ISSUED FOR  * 03220000
*           ITS UCB.                                                  * 03290000
*        5. VERIFY THAT TEST DEVICE IS CONFIGURED.  IF CDS INDICATES  * 03360000
*           THAT THE DEVICE IS SWITCHABLE OR SHAREABLE, THE SYSTEM    * 03430000
*           CONSOLE OPERATOR IS ASKED TO INSURE THAT THE CONTROL UNIT * 03500000
*           IS CONNECTED TO THE PROPER CPU.  IF CDS INDICATES THAT    * 03570000
*           DEVICE IS PROTECTED, THE SYSTEM CONSOLE OPERATOR IS       * 03640000
*           ASKED FOR PERMISSION TO TEST THE DEVICE.                  * 03710000
*        6. STOPS ALL TEST DEVICES TO PREVENT THEIR USE BY TCAM.      * 03780000
*                                                                     * 03850000
*    THE TRM IS CANCELLED IF:                                         * 03920000
*        1. DIAGMSG OPEN FAILS - MESSAGE IED236I                      * 03990000
*        2. DEVICE IS NOT SUPPORTED - MESSAGE IED212I                 * 04060000
*        3. EXCLUSIVE ENQ FAILS FOR TEST DEVICE - MESSAGE IED231I     * 04130000
*        4. I/O ERROR OCCURRED ON LOADING CONFIGURATION DATA - MESSAGE* 04200000
*           IED228I                                                   * 04270000
*        5. CONFIGURATION DATA SET CANNOT BE OPENED - MESSAGE IED230I * 04340000
*        6. NO CONFIGURATION DATA ('FIND' FAILED) - MESSAGE IED229I   * 04410000
*        7. CONTROL UNIT NOT CONNECTED TO PROPER CPU - MESSAGE IED226I* 04480000
*        8. SYSTEM OPERATOR WILL NOT ALLOW TEST ON PROTECTED DEVICE - * 04550000
*           MESSAGE IED329I                                           * 04620000
*        9. OPERATOR CONTROL RETURNS A BAD RETURN CODE TO STOP        * 04690000
*           LINE, STOP TERMINAL OR DEACTIVATE 3705 COMMAND - MESSAGE  * 04760000
*           IED221I                                                   * 04830000
*                                                                     * 04900000
* ENTRY POINT:  IEDQWD                                                * 04970000
*                                                              @Y17XAUU 05040000
* PURPOSE: SEE FUNCTION                                        @Y17XAUU 05110000
*                                                              @Y17XAUU 05180000
* MODULE TYPE: PROCEDURE                                       @Y17XAUU 05250000
*                                                              @Y17XAUU 05320000
* MODULE SIZE: 4K MAXIMUM                                      @Y17XAUU 05390000
*                                                              @Y17XAUU 05460000
* PROCESSOR: ASSEMBLER XF                                      @Y17XAUU 05530000
*                                                                     * 05600000
* EXTERNAL ROUTINES: IEDQTNT - FIND TTE ADDRESS                @Y17XAUU 05670000
*                                                              @Y17XAUU 05740000
* INPUT:        REGISTERS 02,13,14,15 CONTAIN THE FOLLOWING VALUES:   * 05810000
*                                                                     * 05880000
*                         02-OLTCB POINTER                            * 05950000
*                         13-SAVE AREA ADDRESS                        * 06020000
*                         14-RETURN ADDRESS                           * 06090000
*                         15-ENTRY POINT ADDRESS                      * 06160000
*                                                                     * 06230000
* MACROS: AQCTL                                                @Y17XAUU 06300000
*         CLOSE                                                @Y17XAUU 06370000
*         DELETE                                               @Y17XAUU 06440000
*         ENQ                                                  @Y17XAUU 06510000
*         FIND                                                 @Y17XAUU 06580000
*         IEDHJN                                               @Y17XAUU 06650000
*         IEDQMSG                                              @Y17XAUU 06720000
*         LINK                                                 @Y17XAUU 06790000
*         LOAD                                                 @Y17XAUU 06860000
*         OPEN                                                 @Y17XAUU 06930000
*         WAIT                                                 @Y17XAUU 07000000
*         WTO                                                  @Y17XAUU 07070000
*         WTOR                                                 @Y17XAUU 07140000
*         XCTL                                                 @Y17XAUU 07210000
*                                                              @Y17XAUU 07280000
* EXIT POINTS:  XCTL AFTER 'DISPEXIT' TO IEDQWE                       * 07350000
*                                                                     * 07420000
* TABLES/WORK AREAS:                                                  * 07490000
*                                                                     * 07560000
*    OLTCB,UCB,DEB,DCB,QCB,CDS,CVT,LCB,TTE,TNT,AVT                    * 07630000
*                                                                     * 07700000
* ATTRIBUTES:                                                         * 07770000
*                                                                     * 07840000
*       ENABLED, PROBLEM PROGRAM MODE, TRANSIENT.                     * 07910000
*                                                                     * 07980000
* NOTES: SEE BELOW                                             @Y17XAUU 08050000
*                                                              @Y17XAUU 08120000
*  DEPENDENCIES: EBCDIC CHARACTER CODE                         @Y17XAUU 08190000
*                                                              @Y17XAUU 08260000
*  RESTRICTIONS: NONE                                          @Y17XAUU 08330000
*                                                              @Y17XAUU 08400000
*  REGISTER CONVENTIONS: SEE REGISTERS ASSIGNMENT              @Y17XAUU 08470000
*                                                              @Y17XAUU 08540000
*  PATCH LABEL: PATCH                                          @Y17XAUU 08610000
*                                                                     * 08680000
*********************************************************************** 08750000
         EJECT                                                          08820000
*********************************************************************** 08890000
*********************************************************************** 08960000
*                                                                       09030000
*                                                                       09100000
*        REGISTER EQUATES                                               09170000
*                                                                       09240000
*********************************************************************** 09310000
*********************************************************************** 09380000
R0       EQU   0                       REG 0                     S99528 09450000
R1       EQU   1                       REG 1                     S99528 09520000
R2       EQU   2                       REG 2                     S99528 09590000
R3       EQU   3                       REG 3                     S99528 09660000
R4       EQU   4                       REG 4                     S99528 09730000
R5       EQU   5                       REG 5                     S99528 09800000
R6       EQU   6                       REG 6                     S99528 09870000
R7       EQU   7                       REG 7                     S99528 09940000
R8       EQU   8                       REG 8                     S99528 10010000
R9       EQU   9                       REG 9                     S99528 10080000
RSIB     EQU   9                  SIB BASE                     @Y17XAUU 10150000
R10      EQU   10                      REG 10                    S99528 10220000
R11      EQU   11                      REG 11                    S99528 10290000
R12      EQU   12                      REG 12                    S99528 10360000
R13      EQU   13                      REG 13                    S99528 10430000
R14      EQU   14                      REG 14                    S99528 10500000
R15      EQU   15                      REG 15                    S99528 10570000
PARMREG0 EQU   R0                      MSG PARM                  S99528 10640000
PARMREG1 EQU   R1                      MSG PARM                  S99528 10710000
Y        EQU   X'E8'                   YES                       S99528 10780000
TPCLASS  EQU   X'40'              TP DEVICE CLASS                       10850000
GRAPHIC  EQU   X'10'              DISPLAY DEVICE CLASS                  10920000
TYPE2260 EQU   X'03'              2260 DEVICE TYPE                      10990000
ANR      EQU   X'09'                   3270                      S99528 11060000
ANRP     EQU   X'0A'                   3284                      S99528 11130000
ANRPP    EQU   X'0B'                   3286                      S99528 11200000
DEVTBEND EQU   C' '                    BLANK                     S99528 11270000
XFF      EQU   X'FF'              MASK BYTE                    @Y17XAUU 11340000
ADRMSK   EQU   7                       ADDRESS MASK            @Y17XAUU 11410000
RELEASE  EQU   X'87'              RELEASE TERMINAL VERB CODE   @Y17XAUU 11480000
LINESTOP EQU   X'41' .       STOP LINE VERB CODE                        11550000
TERMSTRT EQU   X'45' .       START TERMINAL VERB CODE                   11620000
TERMSTOP EQU   X'47' .       STOP TERMINAL VERB CODE                    11690000
TERMNACT EQU   X'48'                   INACTIVATE TERMINAL VERB  S22024 11760000
*                                        CODE                    S22024 11830000
DEACT    EQU   X'54'                   DEACTIVATE VERB CODE      S22024 11900000
TERMHOLD EQU   X'88'                   HOLD TERMINAL VERB CODE   S22024 11970000
SWPRI    EQU   X'50'                   SWITCH TO PRIMARY         Y06330 12040000
SWBCK    EQU   X'51'                   SWITCH TO BACKUP          Y06330 12110000
LGB      EQU   X'80'                   DSORG BIT SETTING FOR LGB S22024 12180000
D0       EQU   0                       CONSTANT ZERO             S22024 12250000
D1       EQU   1                       DISP ONE                  S22024 12320000
D2       EQU   2                       DISPLACEMENT 2            S22024 12390000
D3       EQU   3                       DISP THREE                S22024 12460000
D4       EQU   4                       DISP FOUR                 S22024 12530000
D5       EQU   5                       DISPLACEMENT 5            S22024 12600000
D6       EQU   6                       DISPLACEMENT 6            S22024 12670000
D7       EQU   7                       DISPLACEMENT 7            S22024 12740000
D8       EQU   8                       DISPLACEMENT 8            S22024 12810000
D9       EQU   9                       CONSTANT DISPLACEMENT     S22024 12880000
D12      EQU   12                      DISPLACEMENT 12           S22024 12950000
D13      EQU   13                      DISPLACEMENT 13                  13020000
D16      EQU   16                      DISPLACEMENT 16           S22024 13090000
D18      EQU   18                      DISPLACEMENT 18           S22024 13160000
D19      EQU   19                      DISPLACEMENT 19           S22024 13230000
D24      EQU   24                      DISPLACEMENT 24           S22024 13300000
D32      EQU   32                      DISPLACEMENT 32           S22024 13370000
D40      EQU   40                      CONSTANT DISPLACEMENT 40  S22024 13440000
D41      EQU   41                      CONSTANT DISPLACEMENT 41  S22024 13510000
D42      EQU   42                      CONSTANT DISPLACEMENT 42  S22024 13580000
TCUCLASS EQU   X'40'                   CLASS BYTE IN CDS FOR TCU S22024 13650000
D48      EQU   48                      CONSTANT DISPLACEMENT     S22024 13720000
X0F      EQU   X'0F'                   USED TO CLEAR BITS        S22024 13790000
XF0      EQU   X'F0'                   USED TO CLEAR BITS        S22024 13860000
MAINONLY EQU   X'40'                   BIT SETTING IN QCB        S22024 13930000
*                                        INDICATING MAIN         S22024 14000000
*                                        STORAGE QUEUEING ONLY   S22024 14070000
XE0      EQU   X'E0'                   USED TO CLEAR BITS        S22024 14140000
OPEN     EQU   X'10'                   BIT SETTING IN DCB IF OPENS22024 14210000
GOOD     EQU   X'00'                   GOOD RETURN CODE FROM     S22024 14280000
*                                      OPERATOR CONTROL          S22024 14350000
ALREADY  EQU   X'08'                   RETURN CODE FROM OP CNTRL S22024 14420000
*                                        INDICATING REQUEST      S22024 14490000
*                                        ALREADY DONE            S22024 14560000
X20      EQU   X'20'              USED TO FIND LCB               S22024 14630000
X44      EQU   X'44'                   BIT SETTING IN CDS        S22024 14700000
*                                        INDICATING SHARED OF    S22024 14770000
*                                        SWITCHABLE DEVICE       S22024 14840000
X80      EQU   X'80'                   BIT SETTING IN TERMINAL   S22024 14910000
*                                        ENTRY INDICATING LINE   S22024 14980000
*                                        ENTRY                   S22024 15050000
BLANK    EQU   X'40'                   BLANK CHARACTER           S22024 15120000
RN3705   EQU   X'05'                   BIT INDICATING 3705 UCB   S22024 15190000
RNUCB    EQU   X'80'                   BIT SETTING INDICATING    S22024 15260000
*                                        3705 UCB TEST           S22024 15330000
OPCKEY   EQU   X'00'                   OP CONTROL KEY FIELD      S22024 15400000
OPCPRI   EQU   X'DC'                   OP CONTROL PRIORITY       S22024 15470000
OPCRTCD  EQU   X'00'                   OP CONTROL RETURN CODE    S22024 15540000
OPCELNG  EQU   X'18'                   OP CONTROL ELEMENT LENGTH S22024 15610000
START102 EQU   X'0C'                   ACTION CODE FOR SVC 102   S22024 15680000
LAST102  EQU   X'80'                   LAST ELEMENT IN LIST      S22024 15750000
DISKQ    EQU   X'30'                    MASK FOR DISK QUEUES   @ZA06159 15820000
         EJECT                                                          15890000
*********************************************************************** 15960000
*********************************************************************** 16030000
*                                                                     * 16100000
*       SATISFY SYSTEM LINKAGE CONVENTIONS                            * 16170000
*                                                                     * 16240000
*********************************************************************** 16310000
*********************************************************************** 16380000
         USING TOTOLTCB,R2             TOTE CONTROL BLOCK        S22024 16450000
         USING IEDQWD,R4                                                16520000
         STM   R14,R12,D12(R13)        SAVE CALLER'S REGISTERS   S22024 16590000
         LR    R4,R15             SET UP BASE                           16660000
         ST    R13,TOTSAVE4+D4         POINT TO CALLERS SAVE     S22024 16730000
         LR    R12,R13                 SAVE CALLERS SAVE         S99528 16800000
         LA    R13,TOTSAVE4            POINT TO MY SAVE AREA     S22024 16870000
         ST    R13,D8(R12)             SAVE POINTER TO           S22024 16940000
*                                        DISPATCHERS SAVE AREA   S22024 17010000
IEDQWD   IEDHJN IEDQWDD,HJN                                             17080000
         EJECT                                                          17150000
*********************************************************************** 17220000
*********************************************************************** 17290000
*                                                                     * 17360000
*****          CLEAR TEST DEVICE ENTRIES IN OLTCB          ******S99528 17430000
*                                                                     * 17500000
*********************************************************************** 17570000
*********************************************************************** 17640000
         XC    TOTPRIBK(TOTSCIBK-TOTPRIBK),TOTPRIBK  CLEAR       S22024 17710000
*                                                      PRIMARY   S22024 17780000
*                                                      FIELD     S22024 17850000
         XC    TOTSCIBK(TOTTRMND-TOTSCIBK),TOTSCIBK  CLEAR       S22024 17920000
*                                                      SECONDARY S22024 17990000
*                                                      FIELD     S22024 18060000
         L     R14,TOTAVTPT            GET AVT ADDRESS         @Y17XAUU 18130000
         USING IEDQAVTD,R14            SET AVT ADDRESSABILITY  @Y17XAUU 18200000
         L     R1,AVTRNMPT             GET TTE CONVERSION RTNA @Y17XAUU 18270000
         ST    R1,TERNMTAB             SAVE IT                 @Y17XAUU 18340000
         LA    R1,AVTOPCOB             GET OPCONTROL QCB ADDR  @Y17XAUU 18410000
         STCM  R1,ADRMSK,TOTOQCBA      SAVE IT IN POST PLIST   @Y17XAUU 18480000
         DROP  R14                                             @Y17XAUU 18550000
         EJECT                                                          18620000
*********************************************************************** 18690000
*********************************************************************** 18760000
*                                                                       18830000
**             SET NO CONTROL PRINT FLAG IF REQUIRED                    18900000
*                                                                       18970000
*********************************************************************** 19040000
*********************************************************************** 19110000
DISP005  EQU   *                                                        19180000
         TM    TOTFLG03,TOTIMNCP       WAS NCP IN TRM                   19250000
         BZ    SYSOUT                  NO BRANCH                 S99528 19320000
         OI    $ERROPT,$NOCNTRL        SET NCP FLAG                     19390000
SYSOUT   EQU   *                                                 S22024 19460000
         TM    TOTFLG09,TOTAPOUT       APSYSOUT REQUESTED?       S22024 19530000
         BZ    DISP19B                 NO BRANCH                 S99528 19600000
         L     R1,TOTAPDCB             GET AP DCB                S21903 19670000
         LTR   R1,R1                   IS THERE ONE              S21903 19740000
         BNZ   DISP19B                 YES BRANCH                S21903 19810000
         IEDQMSG MSGID=050,FUNCT=CEC   AP NOT OPEN MSG           S99528 19880000
         B     CANCELL                 GO CANCEL TRM             S99528 19950000
         EJECT                                                          20020000
*********************************************************************** 20090000
*********************************************************************** 20160000
*                                                                       20230000
*        DATA PROTECTION CHECKS                                         20300000
*                                                                       20370000
*********************************************************************** 20440000
*********************************************************************** 20510000
DISP19B  EQU   *                                                        20580000
         LA    R5,TOTTDTBL             DEVICE TABLE ADDR         S99528 20650000
         MVC   SAVENT(D4),TOTTDTBL     SAVE TEST DEVICE ENTRY  @Y17XAUU 20720000
UCBADDR  EQU   *                                                 S22024 20790000
         TM    D0(R5),TOTTDORN         IS TEST ENTRY ON 3705?    S22024 20860000
         BO    TNTENTRY                YES, BRANCH               S22024 20930000
         TM    D0(R5),TOTTDTRM         IS TEST ENTRY A TERMINAL? S22024 21000000
         BO    TNTENTRY                YES, BRANCH               S22024 21070000
         L     R6,D0(R5)               GET UCB ADDRESS           S22024 21140000
         LTR   R6,R6                   LAST ENTRY?               S22024 21210000
         BZ    EXIT                    YES, BRANCH TO EXIT       S22024 21280000
         CLI   D18(R6),TPCLASS         IS IT TP DEVICE?          S22024 21350000
         BNE   TESTGR                  NO, GO TEST FOR GRAPHICS  S22024 21420000
         MVC   TOTWKSPC(D1),D19(R6)    GET CONTROL UNIT FIELD    S22024 21490000
*                                        FROM UCB                S22024 21560000
         NI    TOTWKSPC,X0F            CLEAR HIGH ORDER NIBBLE   S22024 21630000
         CLI   TOTWKSPC,RN3705         IS THIS A 3705 UCB?       S22024 21700000
         BNE   DISP22                  NO, 270X UCB - OK FOR TESTS22024 21770000
         OI    RNFLAG,RNUCB            SET BIT INDICATING RN UCB S22024 21840000
         B     DISP22                  OK FOR TEST, BRANCH       S22024 21910000
TESTGR   EQU   *                                                 S22024 21980000
         CLI   D18(R6),GRAPHIC         IS IT GRAPHIC DEVICE?     S22024 22050000
         BNE   DISP21                  NO: DEVICE NOT TESTABLE          22120000
         CLI   D19(R6),TYPE2260        IS IT 2260?               S22024 22190000
         BE    DISP22                  YES:OK FOR TEST                  22260000
         CLI   D19(R6),ANR             ANR (3270)?               S22024 22330000
         BE    DISP22                  YES BR                    S99528 22400000
         CLI   D19(R6),ANRP            ANR PRINTER (3284)?       S22024 22470000
         BE    DISP22                  YES BR                    S99528 22540000
         CLI   D19(R6),ANRPP           ANR PRINTER (3286)?       S22024 22610000
         BE    DISP22                  YES BR                    S99528 22680000
         SPACE 2                                                        22750000
*                                                                S22024 22820000
*        ISSUE DEVICE NOT SUPPORTED MESSAGE                      S22024 22890000
*                                                                S22024 22960000
         SPACE 2                                                        23030000
DISP21   EQU   *                                                        23100000
         IEDQMSG MSGID=007,FUNCT=CEC,LINK=YES  NOT SUPPORTED     S22024 23170000
         SPACE 2                                                        23240000
CANCELL  EQU   *                                                 S22024 23310000
         TM    D0(R5),TOTTDORN+TOTTDTRM  IS TEST DEVICE ON A 3705S05331 23380000
         BNZ   CANCELL1                YES, BRANCH               S05331 23450000
         L     R6,D0(R5)               GET UCB ADDRESS           S05331 23520000
         USING UCB,R6                  SET UP BASE FOR UCB       S05331 23590000
         MVC   TOTWKSPC(D1),UCBTBYT4   GET UCB TYPE FIELD        S05331 23660000
         NI    TOTWKSPC,X0F            CLEAR HIGH ORDER NIBBLE   S05331 23730000
         CLI   TOTWKSPC,RN3705         IS THIS A 3705 UCB?       S05331 23800000
         BNE   CANCELL1                NO, BYPASS CLEAR CODE     S05331 23870000
         OI    D0(R5),TOTTNIPL         SET FLAG SAYING NO IPL    S05331 23940000
         DROP  R6                      DROP UCB BASE             S05331 24010000
CANCELL1 EQU   *                                                 S05331 24080000
         OI    TOTFLG06,TOTOTERM+TOTCANCL    SET CANCEL AND      S22024 24150000
*                                              TERMINATE BITS    S22024 24220000
         OI    TOTFLG06,TOTCBOPN       SET CANCEL BEFOR OPEN     S99528 24290000
         B     EXIT                    BRANCH TO EXIT ROUTINE    S22024 24360000
         EJECT                                                          24430000
DISP22   EQU   *                                                        24500000
         USING UCB,R6                  UCB                       S99528 24570000
         MVC   RNAME(D3),UCBNAME       MOVE NAME TO PARM LIST    S22024 24640000
         DROP  R6                      UCB                       S99528 24710000
ENQ1     EQU   *                                                 S22024 24780000
         ENQ   ,MF=(E,ENQLIST)         REQUEST EXCLUSIVE USE     S22024 24850000
         LTR   R15,R15                 HAS DEVICE BEEN ASSIGNED  S22024 24920000
*                                        TO TOTE?                S22024 24990000
         BZ    DISP234                 YES BRANCH                S99528 25060000
         CLI   D3(R15),ALREADY         RETURN CODE 8?            S22024 25130000
         BE    DISP234                 OK BRANCH                 S99528 25200000
         SPACE 2                                                        25270000
***      REENTER TRM LATER: RESOURCE IN UNSHAREABLE STATE               25340000
***                                                                     25410000
         SPACE 2                                                        25480000
BUSY     EQU   *                                                 S22024 25550000
         IEDQMSG MSGID=044,FUNCT=CEC   ISSUE ERROR MESSAGE       S22024 25620000
         B     CANCELL                 BRANCH                    S99528 25690000
         EJECT                                                          25760000
**************************************************************** S22024 25830000
*                                                              * S22024 25900000
*        THE FOLLOWING CODE OPENS THE CORRECT CONFIGURATION    * S22024 25970000
*        DATA SET AND VERIFIES THAT THE TEST DEVICE IS         * S22024 26040000
*        CONFIGURED.  TESTS ARE MADE TO VERIFY THAT THE DEVICE * S22024 26110000
*        IS CONNECTED TO THE PROPER CPU IF IT IS SWITCHABLE    * S22024 26180000
*        AND TO GET PERMISSION TO TEST A PROTECTED DEVICE.     * S22024 26250000
*                                                              * S22024 26320000
**************************************************************** S22024 26390000
         SPACE 2                                                        26460000
DISP234  EQU   *                                                 S99528 26530000
         TM    D0(R5),TOTTDORN         IS TEST ENTRY ON 3705?    S22024 26600000
         BO    TERMNAME                YES, BRANCH               S22024 26670000
         TM    D0(R5),TOTTDTRM         IS TEST ENTRY A TERMINAL? S22024 26740000
         BO    TERMNAME                YES, BRANCH               S22024 26810000
         MVC   CDSNAME+D5(D3),RNAME    MOVE MEMBER NAME FOR LINE S22024 26880000
         B     MEMBFIND                BRANCH                    S99528 26950000
TERMNAME EQU   *                                                 S22024 27020000
         MVC   CDSNAME,RNAME           SYMBOLIC NAME FOR LINE    S22024 27090000
*                                        OR TERMINAL             S22024 27160000
MEMBFIND EQU   *                                                 S22024 27230000
         MVI   RNAME,BLANK             BLANK OUT                 S22024 27300000
         MVC   RNAME+D1(D7),RNAME        NAME                    S22024 27370000
         OPEN  OLT                     OPEN DATA SET CONTAINING  S22024 27440000
*                                        CONFIGURATION DATA      S22024 27510000
         TM    OLT+X'30',X'10'         OPEN OK                   S99528 27580000
         BZ    CANOTOPN                NO BRANCH                 S99528 27650000
         FIND  OLT,CDSNAME,D           SEE IF MEMBER EXIST       S99528 27720000
         LTR   R15,R15                 FIND SUCCESSFUL           S99528 27790000
         BZ    NOWLOAD                 YES BRANCH                S99528 27860000
         LA    R11,4                   CK RETURN CODE            S99528 27930000
         CR    R11,R15                 RETURN CODE EQ 4          S99528 28000000
         BE    NONAMEMG                YES BRANCH                S99528 28070000
***                                                                     28140000
***      I/O ERROR LOADING CONFIGURATION DATA                           28210000
***                                                                     28280000
         IEDQMSG MSGID=041,FUNCT=CEC                             S99528 28350000
         B     CANCELL                 GO STOP TOTE                     28420000
CANOTOPN EQU   *                  MESSAGE                        S99528 28490000
***                                                                     28560000
***      CONFIGURATION DATA SET CANNOT BE OPENED                        28630000
***                                                                     28700000
         IEDQMSG MSGID=043,FUNCT=CEC                                    28770000
         B     CANCELL            CANCEL TRM                     S99528 28840000
NONAMEMG EQU   *                                                        28910000
         TM    SAVENT,TOTTDORN               3705 RESOURCE     @Y17XAUU 28980000
         BZ    NONACON                 NO - ISSUE ERROR MSG    @Y17XAUU 29050000
         L     R1,SAVENT               GET TEST DEVICE ENTRY   @Y17XAUU 29120000
         LA    R1,D0(R1)               CLEAR FLAG BYTE         @Y17XAUU 29190000
         SLR   R14,R14                 CLEAR REG               @Y17XAUU 29260000
         IC    R14,TOTTTBEL            GET LEN OF NAME         @Y17XAUU 29330000
         AR    R1,R14                  POINT TO TTE ADDRESS    @Y17XAUU 29400000
         ICM   R1,ADRMSK,D0(R1)        GET TTE ADDRESS         @Y17XAUU 29470000
         LA    R14,TRMPRFSZ            GET TTE PREFIX SIZE     @Y17XAUU 29540000
         SLR   R1,R14                  POINT TO TTE PREFIX     @Y17XAUU 29610000
         USING IEDNTRM,R1              TTE ADDRESSABILITY      @Y17XAUU 29680000
         CLI   TRMTYPE,TRMLUNT         LU ENTRY                @Y17XAUU 29750000
         BNE   NONAM04                 YES - CHECK NEXT ENTRY  @Y17XAUU 29820000
         L     R15,TOTAVTPT            GET AVT ADDRESS         @Y17XAUU 29890000
         USING IEDQAVTD,R15            SET AVT ADDRESSABILITY  @Y17XAUU 29960000
         SLR   R11,R11                 CLEAR REGISTER          @Y17XAUU 30030000
         IC    R11,TRMCHCIN            GET INDEX INTO DCT      @Y17XAUU 30100000
         BCTR  R11,R0                  ADJUST INDEX            @Y17XAUU 30170000
         MH    R11,AVTDCTLN            TRUE OFFSET INTO DCT    @Y17XAUU 30240000
         AL    R11,AVTCSTCS            POINT TO CORRECT ENTRY  @Y17XAUU 30310000
         USING IEDDCT,R11              SET DCT ADDRESSABILITY  @Y17XAUU 30380000
         TM    DCTBYTE5,DCTL3270       3270 LU                 @ZM47850 30450010
         BO    NONACON                 YES - SEND ERROR MSG    @Y17XAUU 30520000
         B     TRMNOTRJ                BYPASS ERROR MSG        @YM08563 30550000
         DROP  R11                                             @Y17XAUU 30590000
         DROP  R15                                             @Y17XAUU 30660000
NONAM04  DS    0H                      BOUNDARY ALLIGNMENT     @Y17XAUU 30730000
         CLI   TRMTYPE,TRMSDLC         SDLC LINK               @Y17XAUU 30800000
         BE    TRMNOTRJ                YES - CHECK NEXT ENTRY  @Y17XAUU 30870000
         CLI   TRMTYPE,TRMNSDLC        NON-SDLC LINK           @Y17XAUU 30890000
         BE    TRMNOTRJ                YES - CHECK NEXT ENTRY  @Y17XAUU 30910000
         DROP  R1                                              @Y17XAUU 30940000
NONACON  DS    0H                      BOUNDARY ALLIGNMENT     @Y17XAUU 31010000
***                                                                     31080000
***      TRM REJECTED: NO CONFIGURATION DATA                            31150000
***                                                                     31220000
         IEDQMSG MSGID=042,FUNCT=CEC                             S99528 31290000
         B     CANCELL                 CANCEL TRM                S99528 31360000
NOWLOAD  EQU   *                                                 S99528 31430000
         LOAD  EPLOC=CDSNAME           CDS TO CORE             @YM08389 31460000
         LR    R11,R0                  GET CDS ADDRESS           S99528 31570000
         XC    TOTOTECB,TOTOTECB       CLEAR ECB                 S99528 31640000
         B     DEVPROT                 GO CHECK FOR DEV PROTECT  S99528 31710000
SWABLE   EQU   *                                                 S99528 31780000
         TM    D9(R11),X44             IS CONTROL UNIT SWITCHABLES22024 31850000
*                                        AND/OR SHARED?          S22024 31920000
         BZ    MSGNOTND                NO BRANCH                 S99528 31990000
         XC    TOTOTECB,TOTOTECB       CLEAR ECB                 S99528 32060000
         XC    ANSWER,ANSWER           CLEAR ANSWER              S99528 32130000
         CLI   D6(R11),TCUCLASS        IS THIS A TCU CDS?        S22024 32200000
         BNE   MOVENAME                NO, MOVE ENTIRE CDS NAME  S22024 32270000
*                                        INTO MESSAGE            S22024 32340000
         SPACE 2                                                        32410000
***                                                                     32480000
***      MESSAGE-WTO TO ASK OPERATOR TO INSURE DEVICE IS HOOKED TO THIS 32550000
***                                                                     32620000
         SPACE 2                                                        32690000
         MVI   A270XSW+D40,BLANK       BLANK OUT NAME            S22024 32760000
         MVC   A270XSW+D41(D7),A270XSW+D40  FIELD IN MESSAGE     S22024 32830000
         MVC   A270XSW+D40(D3),CDSNAME+D5   MOVE NAME INTO MSG   S22024 32900000
         B     SWABLEQ                 GO ASK THE QUESTION       S22024 32970000
MOVENAME EQU   *                                                 S22024 33040000
         MVC   A270XSW+D40(D8),CDSNAME   MOVE NAME INTO MESSAGE  S22024 33110000
SWABLEQ  EQU   *                                                 S22024 33180000
         WTOR  ,ANSWER,3,TOTOTECB,MF=(E,A270XSW)                 S99528 33250000
         DELETE EPLOC=CDSNAME          DELETE CDS                S99528 33320000
         WAIT  ECB=TOTOTECB            WAIT FOR ANSWER           S99528 33390000
         OI    ANSWER,BLANK            MAKE REPLY UPPER CASE     S22024 33460000
         CLI   ANSWER,Y                ANSWER YES                S99528 33530000
         BE    TRMNOTRJ                YES BR                    S99528 33600000
         SPACE 2                                                        33670000
***                                                              S22024 33740000
***      TRM REJECTED: C.U. NOT CONNECTED TO PROPER CPU                 33810000
***                                                              S22024 33880000
         SPACE 2                                                        33950000
         IEDQMSG MSGID=039,FUNCT=CEC                             S99528 34020000
         B     CANCELL                 BRANCH                    S99528 34090000
DEVPROT  EQU   *                                                 S99528 34160000
         TM    10(R11),X'20'           DEVICE PROTECTED?         S99528 34230000
         BO    PROTECT                 YES, BRANCH               S99528 34300000
         B     SWABLE                  NO, BRANCH                S99528 34370000
PROTECT  EQU   *                                                 S99528 34440000
         CLI   D6(R11),TCUCLASS        IS THIS A TCU CDS?        S22024 34510000
         BNE   MOVEALL                 NO, MOVE IN ENTIRE CDS    S22024 34580000
*                                        NAME                    S22024 34650000
         MVI   PROTDEV+D41,BLANK       BLANK OUT NAME FIELD      S22024 34720000
         MVC   PROTDEV+D42(D7),PROTDEV+D41  IN MESSAGE           S22024 34790000
         MVC   PROTDEV+D41(D3),CDSNAME+D5  MOVE IN CUU NAME      S22024 34860000
*                                            WITHOUT PREFIX      S22024 34930000
         B     PROTECTQ                GO ASK QUESTION           S22024 35000000
MOVEALL  EQU   *                                                 S22024 35070000
         MVC   PROTDEV+41(8),CDSNAME   MOVE NAME INTO MESSAGE    S99528 35140000
PROTECTQ EQU   *                                                 S22024 35210000
         WTOR  ,ANSWER,3,TOTOTECB,MF=(E,PROTDEV)                 S99528 35280000
         WAIT  ECB=TOTOTECB            WAIT FOR ANSWER           S99528 35350000
         OI    ANSWER,X'40'            MAKE REPLY UPPER CASE     S99528 35420000
         CLI   ANSWER,Y                'YES' REPLY?              S99528 35490000
         BE    SWABLE                  IF SO BRANCH              S99528 35560000
         MVC   DEVPRONA,CDSNAME        MOVE NAME TO MESSAGE      S99528 35630000
         IEDQMSG FUNCT=(CEC,PRT),OTBUF=PROTMSG,OTCNT=64,               C35700000
               PREG0=R0,PREG1=R1,RET=CANCELL                     S99528 35770000
MSGNOTND EQU   *                                                 S99528 35840000
         DELETE EPLOC=CDSNAME          DELETE CDS                S99528 35910000
TRMNOTRJ EQU   *                                                 S22024 35980000
         L     R6,D0(R5)               GET TEST DEVICE ENTRY     S22024 36050000
         BAL   R12,STOPDEV             GO STOP TEST DEVICE       S22024 36120000
         TM    D0(R5),TOTTDORN         IS TEST ENTRY ON 3705?    S22024 36190000
         BO    UCBLOOK                 YES, GO FIND 3705 UCB     S22024 36260000
         TM    D0(R5),TOTTDTRM         IS TEST ENTRY A TERMINAL? S22024 36330000
         BO    UCBLOOK                 YES, GO FIND UCB FOR LINE S22024 36400000
         LA    R5,4(R5)                GET NEXT UCB              S99528 36470000
         LA    R7,TOTTDEND             GET ADDRESS OF END OF     S22024 36540000
*                                        TABLE                   S22024 36610000
         CR    R5,R7                   END OF TABLE              S99528 36680000
         BNE   UCBADDR                 NO GO GET NEXT ENTRY      S22024 36750000
         B     EXIT                    YES, BRANCH TO EXIT       S22024 36820000
         EJECT                                                          36890000
**************************************************************** S22024 36960000
*                                                              * S22024 37030000
*        THIS SECTION OF CODE PROCESSES A TEST ENTRY THAT IS   * S22024 37100000
*        A SYMBOLIC ENTRY - I.E. A TERMINAL ON A 270X OR A     * S22024 37170000
*        LINE OR TERMINAL ON A 3705.                           * S22024 37240000
*                                                              * S22024 37310000
**************************************************************** S22024 37380000
         SPACE 2                                                        37450000
TNTENTRY EQU   *                                                 S22024 37520000
         L     R6,D0(R5)               GET ADDRESS OF TNT        S22024 37590000
         LTR   R6,R6                   LAST ENTRY IN TABLE?      S22024 37660000
         BZ    EXIT                    YES, BRANCH TO EXIT       S22024 37730000
         TM    D0(R5),TOTTDLIN         IS TEST DEVICE A LINE?    S22024 37800000
         BO    ENQONE                  YES, BYPASS LINE ENQ      S22024 37870000
         TM    D0(R5),TOTTDORN         IS TERMINAL ON A 3705?    S22024 37940000
         BNO   ENQONE                  NO, BYPASS SEARCH FOR     S22024 38010000
*                                        LINE NAME               S22024 38080000
         SR    R3,R3                   CLEAR REGISTER 3          S22024 38150000
         IC    R3,TOTTTBEL             GET MAXIMUM NAME LENGTH   S22024 38220000
         LR    R11,R6                  SAVE TNT ADDRESS          S22024 38290000
         AR    R11,R3                  GET ADDR OF TTE ADDR      S22024 38360000
         MVC   TTEADDR+D1(D3),D0(R11)  MOVE TERMINAL ENTRY ADDR  S22024 38430000
         L     R8,TTEADDR              LOAD TERMINAL ENTRY ADDR  S22024 38500000
         LA    R9,TRMPRFSZ             GET TTE PREFIX SIZE     @Y17XAUU 38570000
         SLR   R8,R9                   POINT TO TTE PREFIX     @Y17XAUU 38640000
         USING IEDNTRM,R8              SET TTE ADDRESSABILITY  @Y17XAUU 38710000
         TM    TRMBYTE2,TRMGPACT       GEN POLL ACTIVE         @Y17XAUU 38780000
         BO    IED278I                 YES BRANCH              @SA69637 38850000
         L     R12,TOTAVTPT            GET AVT ADDRESS         @Y17XAUU 38920000
         USING IEDQAVTD,R12            SET AVT ADDRESSABILITY  @Y17XAUU 38990000
LINELOOP EQU   *                                               @Y17XAUU 39060000
         LH    R1,TRMCOHRT             GET COHORT POINTER      @Y17XAUU 39130000
         STH   R1,OFFSET               SAVE IT                 @Y17XAUU 39200000
         L     15,AVTRNMPT             TTCIN TO TTE CONVERSION @Y17XAUU 39270000
*                                      ROUTINE ADDRESS         @Y17XAUU 39340000
         BALR  R14,R15                 GET TTE ADDRESS         @Y17XAUU 39410000
         LR    R8,R1                   ET TTE ADDRESS          @Y17XAUU 39480000
         LA    R1,TRMPRFSZ             GET TTE PREFIX SIZE     @Y17XAUU 39550000
         SLR   R8,R1                   POINT TO TTE PREFIX     @Y17XAUU 39620000
         CLI   TRMTYPE,TRMNSDLC        PRE SNA LINE ENTRY      @Y17XAUU 39690000
         BE    LINEFND                 YES                     @Y17XAUU 39760000
         CLI   TRMTYPE,TRMSDLC         SNA LINE ENTRY          @Y17XAUU 39830000
         BNE   LINELOOP                NO - CHECK NEXT ENTRY   @Y17XAUU 39900000
LINEFND  EQU   *                                               @Y17XAUU 39970000
         L     R1,AVTRNMPT             GET TERMNAME TABLE ADDR @Y17XAUU 40040000
         DROP  R12                                             @Y17XAUU 40110000
         USING IEDQTNTD,R1             SET TNT ADDRESSABILITY  @Y17XAUU 40180000
         LA    R1,TNTFIRST             GET ADDRESS OF FIRST    @Y17XAUU 40250000
*                                      ENTRY                   @Y17XAUU 40320000
         DROP  R1                                              @Y17XAUU 40390000
         LA    R7,D3                   GET LEN OF TTE ADDRESS  @Y17XAUU 40460000
         AR    R7,R3                   GET LEN ON TNT ENTRY    @Y17XAUU 40530000
         LH    R11,OFFSET              GET LINE TTCIN          @Y17XAUU 40600000
         BCTR  R11,R0                  ADJUST OFFSET           @Y17XAUU 40670000
         MR    R10,R7                  GET OFFSET TO LINE TNT  @Y17XAUU 40740000
         AR    R1,R11                  GET LINE TNT ADDRESS    @Y17XAUU 40810000
         LR    R6,R1                   COPY TNT ADDRESS        @Y17XAUU 40880000
         BCTR  R3,R0                   DECREMENT COUNT BY 1      S22024 40950000
         CLI   TRMTYPE,TRMSDLC         SNA LINK                @Y17XAUU 41020000
         BNE   LN004                   NO - SET ENQ PLIST      @Y17XAUU 41090000
         LA    R1,ENQLIST1             ENQ SHARED ON SNA LINK  @Y17XAUU 41160000
         B     LN008                   ENQ LINE                @Y17XAUU 41230000
LN004    DS    0H                      BOUNDARY ALLIGNMENT     @Y17XAUU 41300000
         LA    R1,ENQLIST              ENQ EXCLU ON PRE SNA    @Y17XAUU 41370000
*                                      LINK                    @Y17XAUU 41440000
LN008    DS    0H                      BOUNDARY ALLIGNMENT     @Y17XAUU 41510000
         LA    R8,TNTNAME              GET TNT POINTER           S22024 41580000
         EX    R3,TNTMOVE              MOVE NAME                 S22024 41650000
         MVC   RNAME(D8),TNTNAME       MOVE NAME INTO ENQ LIST   S22024 41720000
         ENQ   ,MF=(E,(1))             ENQ 3705 COMM LINE      @Y17XAUU 41790000
         MVI   RNAME,BLANK             BLANK OUT                 S22024 41860000
         MVC   RNAME+D1(D7),RNAME        NAME FIELD              S22024 41930000
         LTR   R15,R15                 ASSIGNED OK?              S22024 42000000
         BZ    ENQONE                  YES, CONTINUE             S22024 42070000
         CLI   D3(R15),ALREADY         ALREADY DONE BY TASK      S22024 42140000
         BNE   BUSY                    NO, BAD RETURN, BUSY      S22024 42210000
ENQONE   EQU   *                                                 S22024 42280000
         SR    R3,R3                   CLEAR REG                 S99528 42350000
         IC    R3,TOTTTBEL             GET NAME LENGTH           S99528 42420000
         TM    OLT+D48,OPEN            IS CDS DCB ALREADY OPEN?  S22024 42490000
         BO    NOMOVE                  BRANCH AROUND MOVE OF NAMES22024 42560000
         MVC   OLT+40(8),CDSLIB        NEW NAME DD               S99528 42630000
NOMOVE   EQU   *                                                 S22024 42700000
         BCTR  R3,0                    DECREMENT FOR EX          S99528 42770000
TNTADDR  L     R6,0(R5)                GET TNT ADDR              S99528 42840000
         LA    R8,TNTNAME              TNT POINTER               S99528 42910000
         EX    R3,TNTMOVE              MOVE NAME                 S99528 42980000
         MVC   RNAME(8),TNTNAME        MOVE NAME TO DCB          S99528 43050000
         B     ENQ1                    BRANCH                    S99528 43120000
         EJECT                                                          43190000
**************************************************************** S22024 43260000
*                                                              * S22024 43330000
*        THIS ROUTINE FINDS THE UCB FOR A GIVEN TERMNAME TABLE * S22024 43400000
*        ENTRY.                                                * S22024 43470000
*                                                              * S22024 43540000
**************************************************************** S22024 43610000
         SPACE 2                                                        43680000
UCBLOOK  EQU   *                                                 S22024 43750000
         LR    R9,R6                   SAVE POINTER              S22024 43820000
         SR    R10,R10                 CLEAR REG                 S99528 43890000
         IC    R10,TOTTTBEL            GET NAME LENGTH           S99528 43960000
         AR    R9,R10                  TTE ADDRESS               S99528 44030000
         MVC   TTEADDR+1(3),0(R9)      ALLINE ADDRESS            S99528 44100000
         L     R8,TTEADDR              GET TTE ADDRESS           S99528 44170000
         USING IEDQTRM,R8              TTE                       S99528 44240000
         L     R9,TRMDESTQ-D1          GET QCB ADDR              S22024 44310000
         USING IEDQQCB,R9              SET UP ADDRESSIBILITY FOR S22024 44380000
*                                        QCB                     S22024 44450000
         SR    R7,R7                   CLEAR REGISTER 7          S22024 44520000
         TM    TRMSTATE,TRMPREF        IS THIS A 3705 TERMINAL?@Y17XAUU 44590000
         BZ    GETRLN                  NO, GO GET RLN FROM QCB   S22024 44660000
         LA    R7,D1                   SET RLN TO 1 FOR 3705     S22024 44730000
         B     MULTRLN                 GO MULTIPLY RLN BY 4      S22024 44800000
GETRLN   EQU   *                                                 S22024 44870000
         IC    R7,QCBRELLN             GET RLN                   S22024 44940000
MULTRLN  EQU   *                                                 S22024 45010000
         SLL   R7,2                    MULT BY 4                 S99528 45080000
         L     R8,QCBDCBAD-1           GET DCB ADDRESS           S99528 45150000
         DROP  R8                      DROP TERMINAL ENTRY BASE  S22024 45220000
         DROP  R9                      DROP QCB BASE             S22024 45290000
         USING IHADCB,R8               DCB                       S99528 45360000
         TM    DCBDSORG,LGB            IS THIS A LGB?            S22024 45430000
         BZ    DCBFIND                 NO, A DCB, BRANCH         S22024 45500000
         DROP  R8                      DROP DCB BASE             S22024 45570000
         L     1,TTEADDR               GET TTE ADDRESS         @Y17XAUU 46620000
         L     R12,TOTAVTPT            GET AVT ADDRESS         @Y17XAUU 46690000
         USING IEDQAVTD,R12            SET AVT ADDRESSABILITY  @Y17XAUU 46760000
         BAL   R14,NCPTTE              GET NCP TTE ADDRESS     @Y17XAUU 46830000
*                                                              @Y17XAUU 46900000
*        ON RETURN R1 CONTAINS ADDRESS OF NCP TTE PREFIX       @Y17XAUU 46970000
*                                                              @Y17XAUU 47040000
         USING IEDNTRM,R1              SET TTE ADDRESSABILITY  @Y17XAUU 47110000
         L     R1,TRMDESTQ-D1          GET QCB ADDRESS         @Y17XAUU 47180000
         DROP  R1                                              @Y17XAUU 47250000
         USING IEDQQCB,R1              SET QCB ADDRESSABILITY  @Y17XAUU 47320000
         L     R8,QCBDCBAD-D1          GET 3705 DCB ADDRESS    @Y17XAUU 47390000
         DROP  R1                                              @Y17XAUU 47460000
DCBFIND  EQU   *                                                 S22024 48440000
         USING IHADCB,R8               SET UP BASE REG FOR DCB   S22024 48510000
         TM    DCBOFLGS,X'10'          DCB OPEN                  S99528 48580000
         BZ    NOLINEOP                NO, BRANCH                S22024 48650000
         ST    R8,DCBADDS              SAVE DCB ADDRESS          S99528 48720000
         L     R8,DCBDEBAD             GET DEB ADDRESS           S99528 48790000
         DROP  R8                      DCB                       S99528 48860000
         USING DEBNMSUB,R8             DEB                       S99528 48930000
         SR    R15,R15                 CLEAR REG                 S99528 49000000
         IC    R15,DEBNMEXT            GET # OF EXTENTS          S99528 49070000
         ST    R15,NOOFEXTS            SAVE NUMBER               S99528 49140000
         SLL   R15,2                   MULT BY 4                 S99528 49210000
         CR    R15,R7                  LINE OPEN                 S99528 49280000
         BL    NOLINEOP                NO, BRANCH                S22024 49350000
         L     R8,DEBUCBAD-4(R7)       GET UCB ADDRESS           S99528 49420000
         USING UCB,R8                  UCB                       S99528 49490000
         MVC   RNAME(3),UCBNAME        MOVE NAME TO P-LIST       S99528 49560000
         DROP  R8                      UCB                       S99528 49630000
         ENQ   ,MF=(E,ENQLIST1)        UCB NAME                  S99528 49700000
         MVI   RNAME,X'40'             BLANK OUT                 S99528 49770000
         MVC   RNAME+1(7),RNAME        NAME                      S99528 49840000
         LTR   R15,R15                 ASSIGNED OK               S99528 49910000
         BZ    BUMPPTR                 YES BRANCH                S99528 49980000
         CLI   3(R15),X'08'            ALREADY DONE BY TASK      S99528 50050000
         BE    BUMPPTR                 OK BRANCH                 S99528 50120000
         B     BUSY                    BRANCH                    S99528 50190000
BUMPPTR  EQU   *                                                 S99528 50260000
         LA    R5,4(R5)                BUMP DEV TABLE PTR        S99528 50330000
         LA    R7,TOTTDEND             END OF TABLE ADDRESS      S99528 50400000
         CR    R5,R7                   END OF TABLE              S99528 50470000
         BNE   TNTENTRY                NO, GO GET NEXT ENTRY     S22024 50540000
         B     EXIT                    GET OUT                   S22024 50610000
*                                                                S22024 50680000
*        TRM REJECTED - SIZE OF DATA TO BE TRANSFERRED IS        S22024 50750000
*        GREATER THAN MAXIMUM DATA SIZE THE 3705 CAN HANDLE      S22024 50820000
*                                                                S22024 50890000
DATAERR  EQU   *                                                 S22024 50960000
         IEDQMSG MSGID=013,FUNCT=CEC,RET=CANCELL,PREG0=R0,PREG1=R1      51030000
*                                                                S22024 51100000
*        TRM REJECTED - TEST LINE NOT OPEN                       S22024 51170000
*                                                                S22024 51240000
NOLINEOP EQU   *                                                 S22024 51310000
         IEDQMSG MSGID=038,FUNCT=CEC,RET=CANCELL,PREG0=R0,PREG1=R1      51380000
         EJECT                                                          51450000
*********************************************************************** 51520000
*                                                                     * 51590000
*       EXIT ROUTINE                                                  * 51660000
*                                                                     * 51730000
*********************************************************************** 51800000
         SPACE 2                                                        51870000
EXIT     EQU   *                                                 S22024 51940000
         TM    OLT+X'30',X'10'         DCB OPEN                  S99528 52010000
         BZ    DISPEXIT                NO BRANCH                 S99528 52080000
         CLOSE OLT                     LOT2LIB OR CDSLIB         S99528 52150000
DISPEXIT EQU   *                                                        52220000
         L     R13,4(R13)           TRANSFER CONTROL                    52290000
         L     R14,12(R13)          TO TEST CONTROL                     52360000
         XCTL  (2,12),EP=IEDQWE     MODULE                              52430000
         EJECT                                                          52500000
************************************************************** @Y17XAUU 52570000
*        ROUTINE TO FIND NCP TTE ADDRESS. INPUT: REG 1 =     * @Y17XAUU 52640000
*        TERMINAL TTE ADDRESS. OUTPUT: REG 1 = NCP TTE       * @Y17XAUU 52710000
*        ADDRESS. RETURN TO CALLER VIA REG 14.               * @Y17XAUU 52780000
************************************************************** @Y17XAUU 52850000
NCPTTE   EQU   *                                               @Y17XAUU 52920000
         ST    R14,TRMSAVE2            SAVE RETURN ADDRESS     @Y17XAUU 52990000
         LR    R8,R1                   GET TERMINAL TTE ADDRESS@Y17XAUU 53060000
         LA    R1,TRMPRFSZ             GET TTE PREFIX SIZE     @Y17XAUU 53130000
         SLR   R8,R1                   POINT TO TTE PREFIX     @Y17XAUU 53200000
         USING IEDNTRM,R8              SET TTE ADDRESSABILITY  @Y17XAUU 53270000
NCPLOOP  EQU   *                                               @Y17XAUU 53340000
         LH    R1,TRMCOHRT             GET COHORT POINTER      @Y17XAUU 53410000
         L     15,AVTRNMPT             TTCIN TO TTE CONVERSION @Y17XAUU 53480000
*                                      ROUTINE ADDRESS         @Y17XAUU 53550000
         BALR  R14,R15                 FIND TTE ADDRESS        @Y17XAUU 53620000
         LR    R8,R1                   GET TTE ADDRESS         @Y17XAUU 53690000
         LA    R1,TRMPRFSZ             GET TTE PREFIX SIZE     @Y17XAUU 53760000
         SLR   R8,R1                   POINT TO TTE PREFIX     @Y17XAUU 53830000
         CLI   TRMTYPE,TRMLNCP         NCP ENTRY               @Y17XAUU 53900000
         BNE   NCPLOOP                 NO - CHK NEXT ENTRY     @Y17XAUU 53970000
         LR    R1,R8                   SAVE NCP TTE ADDRESS    @Y17XAUU 54040000
         L     R14,TRMSAVE2            STORE RETURN ADDRESS    @Y17XAUU 54110000
         BR    R14                     RETURN TO CALLER        @Y17XAUU 54180000
         DROP  R8                                              @Y17XAUU 54250000
         DROP  R12                RELEASE AVT BASE             @YM07721 54260000
         EJECT                                                          54320000
**************************************************************** S22024 54390000
*                                                              * S22024 54460000
*        THIS ROUTINE STOPS THE TEST DEVICE.  IF THE DEVICE IS * S22024 54530000
*        A TERMINAL, A 'STOP TERMINAL' OPERATOR CONTROL COMMAND* S22024 54600000
*        IS ISSUED.  IF THE DEVICE IS A 3705, A 'DEACTIVATE'   * S22024 54670000
*        COMMAND IS ISSUED.  IF THE DEVICE IS A LINE, A 'STOP  * S22024 54740000
*        LINE' COMMAND IS ISSUED.                              * S22024 54810000
*                                                              * S22024 54880000
**************************************************************** S22024 54950000
         SPACE 2                                                        55020000
STOPDEV  EQU   *                                                 S22024 55090000
         STM   R5,R6,WORKAREA          SAVE REGISTERS            S22024 55160000
         L     R3,TOTAVTPT             GET ADDRESS OF AVT        S22024 55230000
         USING IEDQAVTD,R3             SET UP ADDRESSIBILITY     S22024 55300000
*                                        FOR AVT                 S22024 55370000
         LA    R1,AVTOPCOB             GET OPERATOR CONTROL      S22024 55440000
*                                        QCB ADDRESS             S22024 55510000
         ST    R1,TOTOKEY              PUT ADDRESS INTO ELEMENT  S22024 55580000
         MVI   TOTOPRI,OPCPRI          SET OP CONTROL PRIORITY   S22024 55650000
         MVI   TOTOKEY,OPCKEY          SET KEY FIELD TO ZERO     S22024 55720000
         MVI   TOTOELNG,OPCELNG        SET ELEMENT LENGTH        S22024 55790000
         XC    TOTOLINK,TOTOLINK       CLEAR LINK FIELD          S22024 55860000
         MVI   TOTORTCD,OPCRTCD        ZERO OUT RETURN CODE FLD  S22024 55930000
         MVI   TOTOLADR,BLANK          MOVE BLANK INTO NAME FLD  S22024 56000000
         MVC   TOTOLADR+D1(D7),TOTOLADR  BLANK OUT FIELD         S22024 56070000
         XC    TOTOTECB,TOTOTECB       CLEAR ECB                 S22024 56140000
         LA    R1,TOTOTECB             GET ECB ADDRESS           S22024 56210000
         ST    R1,TOTOECBA             PUT ECB ADDRESS INTO      S2024 56280000
*                                        ELEMENT                 S22024 56350000
         TM    D0(R5),TOTTDORN         IS TEST DEVICE ON 3705?   S22024 56420000
         BO    RNDEVICE                YES, BRANCH AROUND DEB    S22024 56490000
*                                        SEARCH                  S22024 56560000
         TM    D0(R5),TOTTDTRM         IS TEST DEVICE TERMINAL?  S22024 56630000
         BO    RNDEVICE                BRANCH TO STOP TERMINAL   S22024 56700000
         MVC   TOTOLADR(D3),D13(R6)    MOVE UCB NAME INTO OP     S22024 56770000
*                                        CONTROL ELEMENT         S22024 56840000
         L     R1,AVTTCB               GET TCAM TCB ADDRESS      S22024 56910000
         L     R1,D8(R1)               GET DEB CHAIN ADDRESS     S22024 56980000
         USING DEBNMSUB,R1             SET UP ADDRESSIBILITY FOR S22024 57050000
*                                        DEB                     S22024 57120000
STOPDEV1 EQU   *                                                 S22024 57190000
         LA    R1,D0(R1)               CLEAR HIGH ORDER BYTE     S22024 57260000
         SR    R10,R10                 CLEAR LOOP COUNTER        S22024 57330000
         IC    R10,DEBNMEXT            INITIALIZE LOOP COUNTER   S22024 57400000
*                                        TO NUMBER OF EXTENTS    S22024 57470000
         LA    R8,DEBUCBAD             GET UCB CHAIN ADDRESS     S22024 57540000
         L     R11,DEBDEBAD            GET ADDRESS OF NEXT DEB   S22024 57610000
         L     R9,DEBDCBAD             GET DCB ADDRESS           S22024 57680000
         DROP  R1                      DROP DEB BASE REGISTER    S22024 57750000
         USING IHADCB,R9               SET UP ADDRESSIBILITY FOR S22024 57820000
*                                        DCB                     S22024 57890000
         TM    DCBDSORG+D1,X44         IS THIS A TCAM DEB?       S22024 57960000
         BZ    STOPDEV3                NO: GET NEXT DEB          S22024 58030000
         LA    R7,D1                   INITIALIZE RELATIVE LINE  S22024 58100000
         DROP  R9                      DROP DCB BASE             S22024 58170000
*                                        NUMBER COUNTER TO ONE   S22024 58240000
STOPDEV2 EQU   *                                                 S22024 58310000
         L     R9,D0(R8)               GET UCB ADDRESS           S22024 58380000
         LA    R9,D0(R9)               CLEAR HIGH ORDER BYTE     S22024 58450000
         LA    R6,D0(R6)               CLEAR HIGH ORDER BYTE FOR S22024 58520000
*                                        COMPARE                 S22024 58590000
         CR    R6,R9                   CORRECT UCB FOUND?        S22024 58660000
         BE    STOPDEV4                YES, END OF SEARCH        S2024 58730000
         LA    R7,D1(R7)               BUMP RELATIVE LINE NUMBER S22024 58800000
         LA    R8,D4(R8)               GET NEXT UCB ADDRESS      S22024 58870000
         BCT   R10,STOPDEV2            LOOP TILL END OF UCB CHAINS22024 58940000
STOPDEV3 EQU   *                                                 S22024 59010000
         LR    R1,R11                  POINT R1 TO NEXT DEB      S22024 59080000
         LA    R11,D0(R11)             CLEAR HIGH BYTE           S22024 59150000
         LTR   R11,R11                 IS THTER ANOTHER          S22024 59220000
         BZ    D0(R12)                 NO BRANCH                 S22024 59290000
         B     STOPDEV1                GET NEXT UCB CHAIN        S22024 59360000
STOPDEV4 EQU   *                                                 S22024 59430000
         LM    R5,R6,WORKAREA          RESTORE REGISTERS 5 & 6   S22024 59500000
         STC   R10,TOTORLN             PUT RELATIVE LINE NUMBER  S22024 59570000
*                                        INTO OP CONTROL ELEMENT S22024 59640000
         TM    RNFLAG,RNUCB            IS THIS AN RN UCB TEST?   S22024 59710000
         BNO   STOPLINE                NO, GO ISSUE STOP LINE    S22024 59780000
*                                        COMMAND                 S22024 59850000
         MVI   TOTOVBCD,DEACT          MOVE DEACTIVATE VERB CODE S22024 59920000
*                                        INTO OP CONTROL ELEMENT S22024 59990000
         B     POSTELEM                GO POST ELEMENT           S22024 60060000
STOPTERM EQU   *                                                 S22024 60130000
         L     R8,TTEADDR              GET TTE ADDRESS           S22024 60200000
         LA    R10,TRMPRFSZ            GET TTE PREFIX SIZE     @Y17XAUU 60270000
         SLR   R8,R10                  GET TTE PREFIX ADDRESS  @Y17XAUU 60340000
         USING IEDNTRM,R8              SET TTE ADDRESSABILITY  @Y17XAUU 60410000
         L     R10,TRMDESTQ-D1         GET QCB ADDRESS         @OY12959 60480000
         USING IEDQQCB,R10             SET QCB ADDRESSABILITY  @OY12959 60550000
         MVC   TOTWKSPC(D1),QCBDSFLG   GET QCB FLAG BYTE       @OY12959 60620000
         DROP  R10                                             @OY12959 60690000
         TM    TRMSTATE,TRMPREF        TEST DEVICE ON A 3705   @Y17XAUU 60760000
         BNO   NOT3705                 NO, GO FIND LCB           S22024 60830000
         TM    TRMBYTE0,TRMINPUT       TERM CAPABLE OF INPUT   @OY12959 60900000
         BZ    HOLDTERM                NO - OUTPUT ONLY        @OY12959 60970000
         TM    TRMBYTE0,TRMDIAL        IS TERMINAL DIAL?       @Y17XAUU 61040000
         BNO   STOPBOTH                NO, GO ISSUE STOP TERM    S22024 61110000
*                                        COMMAND                 S22024 61180000
HOLDTERM EQU   *                                                 S22024 61250000
         TM    TOTWKSPC,DISKQ          DISK QUEUE              @OY12959 61320000
         BZ    D0(R12)                 NO - MAIN STORAGE       @OY12959 61390000
         CLC   AVTAS(D4),AVTFZERO      IS HOLD IN THE SYSTEM?   SA64791 61460000
         BE    D0(R12)                 NO, DO NOT ISSUE HOLD    SA64791 61530000
         MVI   TOTOVBCD,TERMHOLD       SET VERB CODE TO HOLD     S22024 61600000
*                                        TERMINAL                S22024 61670000
         B     POSTELEM                GO POST ELEMENT TO OP     S22024 61740000
*                                        CONTROL                 S22024 61810000
NOT3705  EQU   *                                                 S22024 61880000
         L     R10,TRMDESTQ-D1         GET QCB ADDRESS           S22024 61950000
         USING IEDQQCB,R10             SET UP ADDRESSIBILITY FOR S22024 62020000
*                                        QCB                     S22024 62090000
         DROP  R8                      DROP TTE BASE             S22024 62160000
         MVC   TOTWKSPC(D1),QCBDSFLG   GET QCB FLAG BYTE         S22024 62230000
         NI    TOTWKSPC,XF0            CLEAR LOW ORDER NIBBLE    S22024 62300000
         L     R7,QCBDCBAD-D1          GET DCB ADDRESS           S22024 62370000
         USING IHADCB,R7               SET UP ADDRESSIBILITY FOR S22024 62440000
*                                      DCB                       S22024 62510000
         SR    R9,R9                   CLEAR REGISTER 9          S22024 62580000
         IC    R9,QCBRELLN             GET RELATIVE LINE NUMBER  S22024 62650000
         DROP  R10                     DROP QCB BASE             S22024 62720000
         SR    R10,R10                 CLEAR REGISTER 10         S22024 62790000
         IC    R10,DCBEIOBX            GET LCB SIZE FROM DCB     S22024 62860000
         MR    R8,R10                  GET STARTING LCB OFFSET   S22024 62930000
         AL    R9,DCBIOBAD             GET STARTING ADDRESS OF   S22024 63000000
*                                        LCB                     S22024 63070000
         LA    R10,X20                 GET DECREMENT FOR LCB     S22024 63140000
*                                      START                     S22024 63210000
         SR    R9,R10                  GET ADDRESS OF LCB        S22024 63280000
         USING IEDQLCB,R9              SET UP ADDRESSIBILITY FOR S22024 63350000
*                                        LCB                     S22024 63420000
         TM    LCBSTAT2,LCBDIAL        IS THIS A DIAL LCB?       S22024 63490000
         BNO   CHKMO                   NO, GO SEE IF MAIN STORAGES22024 63560000
*                                        ONLY QUEUING            S22024 63630000
         TM    TOTWKSPC,DISKQ           DISK QUEUES?           @ZA06159 63700000
         BNZ   HOLDTERM                 GO ISSUE HOLD CMD      @ZA06159 63770000
         B     D0(R12)                 TERMINAL IS DIAL AND WITH S22024 63840000
*                                        MO QUEUING SO NO OP     S22024 63910000
*                                        CONTROL COMMAND ISSUED  S22024 63980000
CHKMO    EQU   *                                                 S22024 64050000
         L     R8,DCBDEBAD             GET DEB ADDRESS         @OY12959 64120000
         CLI   DEBOPATB-DEBNMSUB(R8),D3 OUTPUT ONLY            @OY12959 64190000
         BE    HOLDTERM                YES                     @OY12959 64260000
         TM    TOTWKSPC,DISKQ           DISK QUEUES?           @ZA06159 64330000
         BZ    INACT                    ONLY INACTIVATE TERM   @ZA06159 64400000
STOPBOTH EQU   *                                                 S22024 64470000
         CLC   AVTAS(D4),AVTFZERO      IS HOLD IN THE SYSTEM?   SA64791 64540000
         BE    INACT                   NO, DO NOT ISSUE HOLD    SA64791 64610000
         DROP  R3                      DROP AVT BASE REGISTER   SA64791 64680000
         MVI   TOTOVBCD,TERMSTOP       GET STOP TERMINAL VERB    S22024 64750000
*                                        CODE (V OFFTP,B)        S22024 64820000
         B     POSTELEM                GO POST ELEMENT TO OP     S22024 64890000
*                                        CONTROL                 S22024 64960000
INACT    EQU   *                                                 S22024 65030000
         MVI   TOTOVBCD,TERMNACT       GET INACTIVATE VERB CODE  S22024 65100000
*                                        (V OFFTP,E)             S22024 65170000
         B     POSTELEM                GO POST ELEMENT TO OP     S22024 65240000
*                                        CONTROL                        65310000
         DROP  R9                      DROP LCB BASE             S22024 65380000
         DROP  R7                      DROP DCB BASE             S22024 65450000
RNDEVICE EQU   *                                                 S22024 65520000
         LR    R9,R6                   SAVE TNT ADDRESS          S22024 65590000
         SR    R10,R10                 CLEAR REGISTER 10         SI2024 65660000
         IC    R10,TOTTTBEL            GET MAXIMUM NAME LENGTH   S22024 65730000
         BCTR  R10,R0                  DECREMENT COUNT BY 1      S22024 65800000
         EX    R10,SYMMOVE             GO MOVE NAME INTO P-LIST  S22024 65870000
         LA    R10,D1(R10)             RESTORE LENGTH OF NAME    S22024 65940000
         AR    R9,R10                  GET TERMINAL ENTRY ADDR   S22024 66010000
         MVC   TTEADDR+D1(D3),D0(R9)  SAVE TTE ADDRESS           S22024 66080000
         L     R8,TTEADDR              GET TTE ADDRESS           S22024 66150000
         LR    R10,R8                  COPY TTE ADDRESS        @Y17XAUU 66220000
         USING IEDQTRM,R8              SET UP ADDRESSIBILITY FOR S22024 66290000
*                                        TERMINAL ENTRY          S22024 66360000
         L     R8,TRMDESTQ-D1          GET QCB ADDRESS           S22024 66430000
         DROP  R8                      DROP TTE BASE             S22024 66500000
         USING IEDQQCB,R8              SET UP ADDRESSIBLITY FOR  S22024 66570000
*                                      QCB                       S22024 66640000
         MVC   TOTORLN(D1),QCBRELLN    GET RELATIVE LINE NUMBER  S22024 66710000
         TM    D0(R5),TOTTDTRM         IS DEVICE A TERMINAL?     S22024 66780000
         BO    BACKUP                  YES, BYPASS INACTIVATE- @YM08136 66800000
*                                      ALREADY DONE BY QWC1/QWJ         66820000
STOPLINE EQU   *                                                 S22024 66920000
         MVI   TOTOVBCD,LINESTOP       MOVE STOP LINE VERB CODE  S22024 66990000
*                                      INTO ELEMENT              S22024 67060000
         TM    D0(R5),TOTTDORN         IS DEVICE ON A 3705?      S22024 67130000
         BNO   POSTELEM                NO, DO NOT GET GROUP NAME S22024 67200000
         LA    R1,TRMPRFSZ             GET TTE PREFIX SIZE     @XM05679 67207010
         SLR   R10,R1                  POINT TO TTE PREFIX     @XM05679 67214010
         USING IEDNTRM,R10             SET TTE ADDRESSABILITY  @XM05679 67221010
         CLI   TRMTYPE,TRMNSDLC        NON SDLC LINK           @XM05679 67228010
         BE    POSTE                   YES                     @XM05679 67235010
         MVI   TOTOVBCD,TERMHOLD       SET HOLD TERM VERB CODE @XM05679 67242010
         B     POSTELEM                GO ISSUE COMMAND        @XM05679 67249010
POSTE    EQU   *                                               @XM05679 67256010
         L     R8,QCBLGBAD-D1          GET LGB ADDRESS TO GET    S22024 67270000
         DROP  R8                      LINE GROUP NAME           S22024 67340000
         USING IEDNLGB,R8              FOR STOP LINE ON 3705     S22024 67410000
         MVC   TOTOLADR(D8),LGBNAME    GROUP NAME TO PLIST     @Y17XAUU 67440000
         DROP  R8                                              @Y17XAUU 68110000
POSTELEM EQU   *                                                 S22024 68180000
         LA    R1,TOTPLIST             GET ADDRESS OF OP CONTROL S22024 68250000
*                                        PARAMETER LIST          S22024 68320000
         ST    R1,ELEM1                STORE ADDRESS IN 1ST WORD S22024 68390000
*                                        OF SVC 102 POST LIST    S22024 68460000
         ST    R1,ELEM2                STORE ADDRESS INTO 2ND    S22024 68530000
*                                        WORD OF SVC 102 POSTLISTS22024 68600000
         MVI   ELEM1,START102          MOVE IN ACTION CODE       S22024 68670000
         MVI   ELEM2,LAST102           MOVE IN LAST ELEMENT      S22024 68740000
*                                        INDICATOR               S22024 68810000
         LA    R1,SLPL                 GET ADDRESS OF OPERATOR   S22024 68880000
*                                        CONTROL PARAMETER LIST  S22024 68950000
         TM    TOTFLG04,TOTCLOSE       TCAM CLOSE DOWN IN        S22024 69020000
*                                        PROGRESS?               S22024 69090000
         BO    EXIT                    YES, BRANCH TO EXIT       S2024 69160000
         AQCTL                         ISSUE OP CONTROL COMMAND  S22024 69230000
         WAIT  ECB=TOTOTECB            WAIT FOR FUNCTION         S22024 69300000
         LM    R5,R6,WORKAREA          RESTORE REGISTERS 5 & 6   S22024 69370000
         CLI   TOTOVBCD,SWPRI          SW TO PRIMARY             Y06330 69440000
         BE    SWCHECK                 YES BRANCH                Y06330 69510000
         CLI   TOTOVBCD,SWBCK          SW REQUEST                Y06330 69580000
         BE    SWCHECK                 YES BRANCH                Y06330 69650000
         CLI   TOTORTCD,GOOD           WAS REQUEST SUCCESSFUL?   S22024 69720000
         BE    BACKUP                  YES, GO SEE IF DEVICE IS  S22024 69790000
*                                        IN BACKUP MODE          S22024 69860000
         CLI   TOTORTCD,ALREADY        ALREADY STOPPED?          S22024 69930000
         BE    BACKUP                  YES, GO SEE IF DEVICE IS  S22024 70000000
*                                        IN BACKUP MODE          S22024 70070000
         CLI   TRMTYPE,TRMSDLC         SDLC LINK               @Y17XAUU 70140000
         BNE   STOPERR                 NO - WRITE ERROR MSG    @Y17XAUU 70210000
         MVI   TOTOVBCD,RELEASE        SET RELEASE TERM VERB CD@Y17XAUU 70280000
         XC    TOTORTCD,TOTORTCD       CLEAR RETURN CODE       @Y17XAUU 70350000
         XC    TOTOLINK(D3),TOTOLINK   CLEAR LINK FIELD        @Y17XAUU 70420000
         XC    TOTOTECB(D4),TOTOTECB   CLEAR ECB               @Y17XAUU 70490000
         LA    R1,TOTOTECB             GET ECB ADDRESS         @Y17XAUU 70560000
         ST    R1,TOTOECBA             PUT ECB ADDRESS IN PLIST@Y17XAUU 70630000
         LA    R1,SLPL                 GET PLIST ADDRESS       @Y17XAUU 70700000
         AQCTL                         RELEASE THE TERMINALS   @Y17XAUU 70770000
*                                      ON THE SDLC LINK        @Y17XAUU 70840000
         WAIT  ECB=TOTOTECB            WAIT FOR COMPLETION     @Y17XAUU 70910000
         DROP  R10                                             @YM07444 70980000
STOPERR  DS    0H                      BOUNDARY ALLIGNMENT     @Y17XAUU 71050000
         SPACE 2                                                        71120000
***                                                              S22024 71190000
***      SEND STOP DEVICE FAILED MESSAGE                         S22024 71260000
***                                                              S22024 71330000
         MVC   DEVSTOP,TOTOLADR        MOVE NAME INTO MESSAGE    S22024 71400000
         IEDQMSG FUNCT=CEC,OTBUF=STOPFAIL,OTCNT=55,PREG0=R0,PREG1=R1,  *71470000
               RET=CANCELL1                                             71540000
         SPACE 1                                                        71610000
BACKUP   EQU   *                                                 S22024 71680000
         L     R8,TTEADDR              GET TTE ADDRESS           S22024 71750000
         LA    R1,TRMPRFSZ             GET TTE PREFIX SIZE     @Y17XAUU 71820000
         SLR   R8,R1                   POINT TO TTE PREFIX     @Y17XAUU 71890000
         USING IEDNTRM,R8              SET TTE ADDRESSABILITY  @Y17XAUU 71960000
         TM    TRMSTATE,TRMPREF        3705 RESOURCE           @Y17XAUU 72030000
         BNO   D0(R12)                 NO, RETURN TO CALLER      S22024 72100000
         CLI   TRMTYPE,TRMSDLC         SDLC LINK TEST          @Y17XAUU 72170000
         BE    LUCHK                   YES - SCAN LU'S         @Y17XAUU 72240000
         TM    $TOTFLG1,$TERMSEC       TRM REQUEST TEST IN       Y06330 72310000
*                                        BACKUP MODE (IE.TAP)    Y06330 72380000
         BO    IED272I                 YES, GO ISSUE ERROR MSG   Y06330 72450000
         TM    TRMBYTE1,TRMSWBCK       IS TERMINAL IN SWITCHED @Y17XAUU 72520000
*                                        BACKUP MODE?            Y06330 72590000
         BZ    D0(R12)                 NO, NO COMMAND NEEDED     Y06330 72660000
         MVI   TOTOVBCD,SWPRI          MOVE SWITCH TO PRIMARY    Y06330 72730000
*                                        VERB CODE IN P-LIST     Y06330 72800000
         DROP  R8                                              @Y17XAUU 72870000
CLRFIELD EQU   *                                                 Y06330 72940000
         MVI   TOTOKEY,OPCKEY          CLEAR KEY                 Y06330 73010000
         MVI   TOTORTCD,OPCRTCD        CLEAR RT CODE             Y06330 73080000
         XC    TOTOTECB,TOTOTECB       CLEAR ECB                 Y06330 73150000
         XC    TOTOLINK,TOTOLINK       CLEAR LINK FIELD          Y06330 73220000
         OI    D0(R5),TOTTSWPM         INITIAL STATUS IS BACKUP  Y06330 73290000
         B     POSTELEM                GO TO OP CONTROL          Y06330 73360000
SWCHECK  EQU   *                                                 Y06330 73430000
         CLI   TOTORTCD,GOOD           REQUEST SUCESSFUL         Y06330 73500000
         BE    D0(R12)                 YES RETURN                Y06330 73570000
         MVC   TERMINAL(D8),TOTOLADR   NAME TO MSG               Y06330 73640000
         CLI   TOTOVBCD,SWPRI          VERB SW TO PRIMARY        Y06330 73710000
         BNE   IED240I                 NO BRANCH                 Y06330 73780000
         MVC   BACKUPP(D7),PRIMARY     PROCESS MSG               Y06330 73850000
IED240I  EQU   *                                                 Y06330 73920000
         IEDQMSG FUNCT=CEC,OTBUF=BCKUPFAL,OTCNT=52,PREG0=R0,PREG1=R1,  C73990000
               RET=CANCELL             CAN NOT MAKE SW REQUEST   Y06330 74060000
         SPACE 2                                                        74130000
***      ISSUE MESSAGE SAYING BACKUP TEST NOT YET SUPPORTED      Y06330 74200000
***      ISSUE MESSAGE SAYING BACKUP TEST NOT YT                        74270000
IED272I  EQU   *                                                 Y06330 74340000
         IEDQMSG MSGID=014,FUNCT=CEC,PREG0=R0,                   Y06330*74410000
               PREG1=R1,RET=CANCELL                              Y06330 74480000
         BO    NOTRM                   YES, CANCEL TRM           S22024 74550000
         B     D0(R12)                 NO, RETURN TO CALLER      S22024 74620000
*                                                                S22024 74690000
*        TEST DEVICE IN SWITCHED BACKUP MODE - TRM CANCELLED     S22024 74760000
*                                                                S22024 74830000
NOTRM    EQU   *                                                 S22024 74900000
         IEDQMSG MSGID=012,FUNCT=CEC,RET=CANCELL,PREG0=R0,PREG1=R1      74970000
SYMMOVE  MVC   TOTOLADR(D0),D0(R9)     MOVE SYMBOLIC NAME TO     S22024 75040000
*                                        OPERATOR CONTROL PARM   S22024 75110000
*                                        LIST                    S22024 75180000
IED278I  EQU   *                       IED278I                 @SA69637 75250000
***      IED278I TRM CANCELLED - TEST DEVICE IS BEING GEN POLLEDSA69637 75320000
         IEDQMSG FUNCT=CEC,OTBUF=GPOLLREJ,OTCNT=59,PREG0=R0,           C75390000
               PREG1=R1,RET=CANCELL    REJ TRM                 @SA69637 75460000
         EJECT                                                          75530000
LUCHK    DS    0H                      BOUNDARY ALLIGNMENT     @Y17XAUU 75600000
************************************************************** @Y17XAUU 75670000
*                                                            * @Y17XAUU 75740000
*        VERIFY ALL LU'S ON THE SDLC LINK ARE NOT IN SESSION * @Y17XAUU 75810000
*        IF ANY ARE IN SESSION TERMINATE TRM PROCESSING AND  * @Y17XAUU 75880000
*        TURN OFF TRMSTOTE FLAG IN EACH LU TTE AND LINE TTE. * @Y17XAUU 75950000
*        ISSUE RELEASE FOR SDLC LINK.                        * @Y17XAUU 76020000
*                                                            * @Y17XAUU 76090000
************************************************************** @Y17XAUU 76160000
         L     R14,TOTAVTPT            GET AVT ADDRESS         @Y17XAUU 76230000
         USING IEDQAVTD,R14            SET AVT ADDRESSABILITY  @Y17XAUU 76300000
         L     R14,AVTSAVTP            GET SAVT ADDRESS        @Y17XAUU 76370000
         DROP  R14                                             @Y17XAUU 76440000
         USING IEDNSVTD,R14            SET SAVT ADDRESSABILITY @Y17XAUU 76510000
         MVC   SSCPTCIN(D2),SAVTSCPT   SAVE SSCT TTCIN         @Y17XAUU 76580000
         DROP  R14                                             @Y17XAUU 76650000
         SPACE                                                          76720000
         L     R1,TTEADDR              GET LINE TTE ADDRESS    @Y17XAUU 76790000
         LA    R8,TRMPRFSZ             GET TTE PREFIX SIZE     @Y17XAUU 76860000
         SLR   R1,R8                   POINT TO TTE PREFIX     @Y17XAUU 76930000
         USING IEDNTRM,R1              SET TTE ADDRESSABILITY  @Y17XAUU 77000000
         LH    R1,TRMSUBST             GET SUBSTRUCT POINTER   @Y17XAUU 77070000
         LTR   R1,R1                   ANY TERMINALS ON LINE   @Y17XAUU 77140000
         BZ    LUSTOP                  GO ISSUE STOPLINE       @Y17XAUU 77210000
         SPACE                                                          77280000
LULOOP   DS    0H                      BOUNDARY ALLIGNMENT     @Y17XAUU 77350000
         L     R15,TERNMTAB            GET TTE CONVERSION RTNA @Y17XAUU 77420000
         BALR  R14,R15                 GO FIND TTE ADDRESS     @Y17XAUU 77490000
         SLR   R1,R8                   POINT TO TTE PREFIX     @Y17XAUU 77560000
         CLI   TRMTYPE,TRMSDLC         END OF CHAIN            @Y17XAUU 77630000
         BE    LUSTOP                  YES - GO ISSUE STOPLINE @Y17XAUU 77700000
         ICM   RSIB,ADRMSK,TRMSIBPT    GET SIB ADDRESS         @Y17XAUU 77770000
         BZ    LURL08                  NO SESSION ACTIVE       @Y17XAUU 77840000
         USING IEDSIBD,RSIB            SET SIB ADDRESSABILITY  @Y17XAUU 77910000
         CLC   SSCPTCIN(D2),SIBINDEX   SSCP-LU SESSION ONLY    @Y17XAUU 77980000
         BNE   LURLSE                  NO - ERROR PROCESSING   @Y17XAUU 78050000
LURL08   DS    0H                      BOUNDARY ALLIGNMENT     @Y17XAUU 78120000
         LH    R1,TRMCOHRT             GET COHORT POINTER      @Y17XAUU 78190000
         B     LULOOP                  CHECK NEXT ENTRY        @Y17XAUU 78260000
LUSTOP   DS    0H                      BOUNDARY ALLIGNMENT     @Y17XAUU 78330000
         MVI   TOTOVBCD,LINESTOP       SET STOPLINE VERB CODE  @Y17XAUU 78400000
         XC    TOTORTCD(D1),TOTORTCD   CLEAR RETURN CODE       @Y17XAUU 78470000
         XC    TOTOLINK(D3),TOTOLINK   CLEAR LINK FIELD        @Y17XAUU 78540000
         XC    TOTOTECB(D4),TOTOTECB   CLEAR ECB               @Y17XAUU 78610000
*                                                              @ZM46755 78617010
*        SET LGBNAME IN PARM LIST                              @ZM46755 78624010
         L     R8,TRMDESTQ-D1          QCB ADDR                @ZM46755 78631010
         USING IEDQQCB,R8                                      @ZM46755 78638010
         L     R8,QCBLGBAD-D1          LGB ADDR                @ZM46755 78645010
         DROP  R8                                              @ZM46755 78652010
         USING IEDNLGB,R8                                      @ZM46755 78659010
         MVC   TOTOLADR(D8),LGBNAME    GROUP NAME TO PLIST     @ZM46755 78666010
         DROP  R8                                              @ZM46755 78673010
         LA    R1,SLPL                 POINT TO PLIST          @Y17XAUU 78680000
         AQCTL                         ISSUE STOPLINE          @Y17XAUU 78750000
         WAIT  ECB=TOTOTECB            WAIT FOR COMPLETION     @Y17XAUU 78820000
         CLI   TOTORTCD,GOOD           GOOD RETURN             @ZM46755 78850010
         BE    D0(R12)                 YES, CHECK NEXT ENTRY   @ZM46755 78890010
         SPACE                                                          78960000
LURLSE   DS    0H                      BOUNDARY ALLIGNMENT     @Y17XAUU 79030000
         MVC   DEVSTOP,TOTOLADR        MOVE NAME TO MESSAGE    @Y17XAUU 79100000
*        STOP FAILED FOR TEST DEVICE                           @Y17XAUU 79170000
         IEDQMSG FUNCT=CEC,OTBUF=STOPFAIL,OTCNT=55             @Y17XAUU 79240000
         L     R1,TTEADDR              GET LINE TTE ADDRESS    @Y17XAUU 79310000
         LA    R8,TRMPRFSZ             GET TTE PREFIX SIZE     @Y17XAUU 79380000
         SLR   R1,R8                   POINT TO TTE PREFIX     @Y17XAUU 79450000
         USING IEDNTRM,R1              SET TTE ADDRESSABILITY  @Y17XAUU 79520000
         LH    R1,TRMSUBST             GET SUBSTRUCT POINTER   @Y17XAUU 79590000
         LTR   R1,R1                   ANY TERMINALS ON LINE   @Y17XAUU 79660000
         BZ    LURLSEND                NO - ISSUE RELEASE      @Y17XAUU 79730000
LULOOP1  DS    0H                      BOUNDARY ALLIGNMENT     @Y17XAUU 79800000
         L     R15,TERNMTAB            GET TTE CONVERSION RTNA @Y17XAUU 79870000
         BALR  R14,R15                 GO FIND TTE ADDRESS     @Y17XAUU 79940000
         SLR   R1,R8                   POINT TO TTE PREFIX     @Y17XAUU 80010000
         L     R14,TRMBYTE2            WORD CONTAINS TRMSTOTE  @G36XRUV 80080010
CSLOOP1  DS    0H                                              @G36XRUV 80090010
         LR    R15,R14                 COPY                    @G36XRUV 80100010
         N     R15,OFFSTOTE            TURN OF TOTE BIT IN REG @G36XRUV 80110010
         CS    R14,R15,TRMBYTE2        RESET TRMSTOTE          @G36XRUV 80120010
         BNZ   CSLOOP1                 BR IF WORD ALTERED      @G36XRUV 80130010
         CLI   TRMTYPE,TRMSDLC         END OF CHAIN            @Y17XAUU 80150000
         BE    LURLSEND                YES - ISSUE RELEASE     @Y17XAUU 80220000
         LH    R1,TRMCOHRT             GET COHORT POINTER      @Y17XAUU 80290000
         B     LULOOP1                 CHECK NEXT ENTRY        @Y17XAUU 80360000
         DROP  R1                                              @Y17XAUU 80430000
LURLSEND DS    0H                      BOUNDARY ALLIGNMENT     @Y17XAUU 80500000
         MVI   TOTOVBCD,RELEASE        SET RELEASE VERB CODE   @Y17XAUU 80570000
         XC    TOTORTCD(D1),TOTORTCD   CLEAR RETURN CODE       @Y17XAUU 80640000
         XC    TOTOLINK(D3),TOTOLINK   CLEAR LINK FIELD        @Y17XAUU 80710000
         XC    TOTOTECB(D4),TOTOTECB   CLEAR ECB FOR WAIT      @Y17XAUU 80780000
         LA    R1,SLPL                 POINT TO PLIST          @Y17XAUU 80850000
         AQCTL                         POST REQUEST            @Y17XAUU 80920000
         WAIT  ECB=TOTOTECB            WAIT FOR COMPLETION     @Y17XAUU 80990000
         SPACE                                                          81060000
         B     CANCELL1                CANCEL TRM              @Y17XAUU 81130000
         EJECT                                                          81200000
         DS    0F                                                       81270000
TERNMTAB DS    A                       SAVE AREA               @Y17XAUU 81340000
EIGHTSAV DC    AL4(0)                  SAVE REG EIGHT            S99528 81410000
ENQLIST  ENQ   (QNAME,RNAME,E,8,STEP),RET=USE,MF=L                      81480000
ENQLIST1 ENQ   (QNAME,RNAME,S,8,STEP),RET=USE,MF=L                      81550000
QNAME    DC    CL8'SYSZTOTE'           MAJOR NAME              @Y17XAUU 81620000
RNAME    DC    8CL1' '                 MINOR NAME                S99528 81690000
***                                                                     81760000
***                                    PL FOR SVC 102                   81830000
SLPL     DS    0F                                                S99528 81900000
ELEM1    DS    F                       POINTER TO 1ST ELEMENT    S22024 81970000
ELEM2    DS    F                       POINTER TO LAST ELEMENT   S22024 82040000
OFFSTOTE DS    0F                      TURNS OFF TRMSTOTE W/C&S@G36XRUV 82050010
         DC    XL1'FF'                                         @G36XRUV 82060010
         DC    AL1(255-TRMSTOTE)                               @G36XRUV 82070010
         DC    XL2'FFFF'                                       @G36XRUV 82080010
         DS    0D                                                S99528 82110000
CDSNAME  DC    CL8'G0000000'           CDSNAME                   S99528 82180000
DCBADDS  DC    A(0)                    DCB SAVE AREA             S99528 82250000
NOOFEXTS DC    A(0)                    NUMBER EXTENTS SAVE AREA  S99528 82320000
RESTORE  DC    X'00'                   FLAG                      S99528 82390000
NFIVESIX EQU   X'80'                   DO NOT RESTORE            S99528 82460000
CLEARFLG EQU   X'00'                   CLEAR                     S99528 82530000
OLT      DCB   DDNAME=OLTLIB,DSORG=PO,MACRF=(R,W),LRECL=256,RECFM=U,   X82600000
               BLKSIZE=256                                       S99528 82670000
         DS    0F                                                S99528 82740000
CDSLIB   DC    CL8'CDSLIB  '           DDNAME                    S99528 82810000
TNTNAME  DC    CL8'        '           TNT NAME                  S99528 82880000
TNTMOVE  MVC   0(0,R8),0(R6)           MOVE TNT NAME             S99528 82950000
         DS    0F                                                S99528 83020000
TTEADDR  DC    A(0)                    TTE ADDRESS               S99528 83090000
TRMSAVE2 DS    F                       REGISTER SAVE AREA      @Y17XAUU 83160000
RNFLAG   DC    X'00'                   FLAG BYTE                 S22024 83230000
SSCPTCIN DS    H                       SSCP TTCIN SAVE AREA    @Y17XAUU 83300000
ONE      DC    H'1'                    CONSTANT 1                S22024 83370000
OFFSET   DS    H                       TERMNAME TABLE OFFSET     S22024 83440000
RSIDSAVE DS    H                       RSID SAVE AREA            S22024 83510000
WORKAREA DS    2F                      REGISTER SAVE AREA        S22024 83580000
A270XSW  WTOR  'IED148D IS C. U. FOR DEVICE XXXXXXXX CONNECTED ONLY TO *83650000
               THIS SYSTEM?',ANSWER,3,,MF=L  DEVICE SWITCHED OR  S22024 83720000
*                                              SHARED MESSAGE    S22024 83790000
ANSWER   DC    X'000000'               YES OR NO                 S99528 83860000
PROTDEV  WTOR  'IED328D CAN PROTECTED DEVICE          BE TESTED?',     *83930000
               ANSWER,3,,MF=L                                    S99528 84000000
PROTMSG  DC    CL64'IED329I SYSTEM OPERATOR WILL NOT ALLOW TEST ON PROT*84070000
               ECTED DEVICE '          MESSAGE                   S22024 84140000
DEVPRONA DC    CL8'        '           NAME FOR MESSAGE                 84210000
*  MESSAGE ISSUED WHEN BAD RETURN CODE RECEIVED FROM OP CONTROL  S22024 84280000
STOPFAIL DC    CL47'IED221I TRM CANCELLED - STOP FAILED FOR DEVICE '    84350000
DEVSTOP  DC    CL8'        '           NAME FOR MESSAGE          S22024 84420000
BCKUPFAL EQU   *                                                 Y06330 84490000
         DC    C'IED240I TERMINAL'     MESSAGE                   Y06330 84560000
TERMINAL DC    C'XXXXXXXX'             TERMINAL NAME             Y06330 84630000
         DC    C'CANNOT BE SWITCHED TO'  MESSAGE                 Y06330 84700000
BACKUPP  DC    C'BACK UP'              MESSAGE                   Y06330 84770000
PRIMARY  DC    C'PRIMARY'              MESSAGE                   Y06330 84840000
SAVENT   DS    F                  TNT ADDRESS SAVE AREA        @Y17XAUU 84910000
BTUSIZE  DC    H'14'                   SIZE OF BTU               S22024 84980000
HDRSIZE  DC    H'31'                   SIZE OF HEADER PAD        S22024 85050000
DATASIZE DC    H'512'                  MAXIMUM DATA SIZE         S22024 85120000
OLTTCBSZ DC    H'23'                   SIZE OF OLTTCB            S22024 85190000
INITSTAT DS    F                       TEST DEVICE TABLE ENTRY  SA41599 85260000
*                                        SAVE AREA (INITIAL     SA41599 85330000
*                                        STATUS IN FIRST BYTE)  SA41599 85400000
GPOLLREJ DC    C'IED278I TRM CANCELLED - TEST DEVICE IS BEING GENERAL PC85470000
               OLLED'                  MESSAGE                 @SA69637 85540000
         EJECT                                                          85610000
         TDCTD                                                 @Y17XAUU 85680000
         EJECT                                                          85750000
         OLTCB                         TOTE CONTROL BLOCK        S22024 85820000
         EJECT                                                          85890000
         TLGBD                         LINE GROUP CONTROL BLOCK  S22024 85960000
*                                                                       86030000
DCHBNAME EQU   7                                                        86100000
         EJECT                                                          86170000
UCB      DSECT                                                          86240000
         IEFUCBOB                                                       86310000
         EJECT                                                          86380000
         TAVTD                                                          86450000
         EJECT                                                          86520000
         TTNTD                                                          86590000
         EJECT                                                          86660000
         TTRMD                                                          86730000
         EJECT                                                          86800000
         TPRFD                                                          86870000
         EJECT                                                          86940000
         TLCBD                                                          87010000
         EJECT                                                          87080000
DCBDSECT DCBD  DSORG=TX                                                 87150000
         EJECT                                                          87220000
CVT      DSECT                                                          87290000
         CVT                                                            87360000
         EJECT                                                          87430000
         TQCBD                                                          87500000
         EJECT                                                          87570000
         TDEBD                                                          87640000
         EJECT                                                          87710000
         TSIBD                                                 @Y17XAUU 87780000
         END                                                            87850000
./  ADD  SSI=72000245,NAME=IEDQWE
         TITLE 'IEDQWE - TOTE TEST CONTROL MODULE'                      00090000
IEDQWE   CSECT                                                          00180000
*A000000-999999                                                @Y16X5U0 00270000
*  TOTE ALIAS                                                  @OY13283 00310010
*** THIS MODULE IS RESEQUENCED AS OF TCAM 10.0                 @Y17XAUU 00360000
* CHANGE ACTIVITY AS FOLLOWS:                                   SA41597 00450000
* C011000-011500,C018500,A018700,C035800-035890,                SA41597 00540000
* C039300,A039400,A482100-482400                                SA41597 00630000
* A074500-075500,A453960-453990,A474935-474938                  SA41597 00720000
* A073700-074300,C086000,C097800,C104000,A116700-116750,         S22024 00810000
* A118130-118160,C120000,C134400,C137000,C149000,C153600,C154600 S22024 00900000
* C157000,A161000-163000,C192000,C194400,C195100,A195860-195920  S22024 00990000
* C197200,C202000,C211000,C215000,C219000-219500,C227000         S22024 01080000
* C235100,A237700-238000,C243340,C243700,A283660-283720,C296000  S22024 01170000
* C299550,C300000-301000,C303000,C308000,A327000-335000          S22024 01260000
* C339000,C345000,C348000,A352000-412660,C503000,C506000-508000  S22024 01350000
* D584000-589381,A589650,C589765,C589790,C589810,A589963-589966  S22024 01440000
*A073800,076200,344100-344800,351200-351800,382300-409600        S05331 01530000
*C139000,155200,285000,290400-291000,295200                    @YA12242 01620000
*D144000                                                       @YA12242 01710000
*A062500,412120,412440,412660,589580,589755                    @Y17XAUU 01800000
*C505000                                                       @Y17XAUU 01890000
*D351200-351600,382900-409300                                  @Y17XAUU 01980000
* A283500,378000,378400,850000                                 @G36XRUV 02010010
* C284400,378400                                               @G36XRUV 02040010
*********************************************************************** 02070000
*                                                              @Y17XAUU 02160000
* DESCRIPTIVE NAME: 'OLT TEST CONTROL MODULE'                   SA41597 02250000
*                                                              @Y17XAUU 02340000
* MODULE NAME:  IEDQWE (TCAM,TOTE)                             @Y17XAUU 02430000
*                                                                     * 02520000
* STATUS:  VERSION 10.0                                        @Y17XAUU 02610000
*                                                                     * 02700000
* ENTRY POINT:                                                        * 02790000
*                                                                     * 02880000
*       IEDQWE CALLED BY THE TOTE DISPATCHER MODULE IEDQWD            * 02970000
*       IEDQWE1 ON RETURN FROM IEDQWF.                                * 03060000
*                                                                     * 03150000
* FUNCTIONS:                                                          * 03240000
*       THE PURPOSE OF THIS MODULE IS TO SCHEDULE THE OLT'S REQUESTED * 03330000
*       IN THE TRM AND TO CLEAN UP AFTER THE EXECUTION OF EACH.       * 03420000
*                                                                     * 03510000
*       IF THE SECTION-TERMINATE FLAG IS SET, REQUIRED CLEANUP IS     * 03600000
*       DONE AND IMMEDIATE RETURN IS MADE TO THE TOTE RESIDENT        * 03690000
*        MODULE, UNLESS ANY TEST DEVICE IS ON A CONCENTRATOR    SA41597 03780000
*        THEN EXIT IS TO IEDQWEC.                               SA41597 03870000
*                                                                     * 03960000
*       REGISTER POINTERS ARE INITIALIZED FOR SECTION, UCB AND DEVICE * 04050000
*       TABLES.  THE SIZE OF THE OLT ROOT MODULE IS OBTAINED BY       * 04140000
*       BLDL MACRO.  IF BLDL WAS UNSUCCESSFUL, A MESSAGE IS           * 04230000
*       SENT TO THE CONTROL TERMINAL AND A CHECK MADE FOR ANOTHER     * 04320000
*       MODULE REQUESTED.  IF SUCCESSFUL, MODULE SIZE IS CHECKED      * 04410000
*       AGAINST AVAILABLE CORE.  IF TOTAL CORE IS INSUFFICIENT, A     * 04500000
*       MESSAGE IS SENT TO CONTROL TERMINAL AND A CHECK MADE          * 04590000
*       FOR ANOTHER MODULE REQUESTED.  IF ALLOCATED CORE IS           * 04680000
*       INSUFFICIENT, IEDQWA IS POSTED FOR THE ASSIGNMENT OF          * 04770000
*       ADDITIONAL CORE.                                              * 04860000
*                                                                     * 04950000
*       IF CORE IS SUFFICIENT, A SECTION START MESSAGE IS SENT TO     * 05040000
*       CONTROL TERMINAL AND THE MODULE XCTL'S TO IEDQWF.             * 05130000
*       UPON RETURN FROM IEDQWF A TERMINATE MESSAGE IS SENT           * 05220000
*       TO CONTROL TERMINAL AND A CHECK IS MADE FOR ANOTHER MODULE    * 05310000
*       REQUESTED.                                                    * 05400000
*                                                                     * 05490000
*       WHEN ANOTHER OLT MODULE IS REQUESTED IT WILL BE EXECUTED      * 05580000
*       AS DESCRIBED ABOVE.  IF A NEW MODULE IS NOT REQUIRED, A CHECK * 05670000
*       IS MADE FOR ANOTHER DEVICE REQUIRED.  IF A DEVICE IS REQUIRED,* 05760000
*       TABLES AND POINTERS ARE UPDATED AND THE OLT MODULE IS         * 05850000
*       EXECUTED AGAIN.                                               * 05940000
*                                                                     * 06030000
*       WHEN AN OLT IS FINISHED WITH ALL REQUESTED DEVICES, A CHECK   * 06120000
*       IS MADE FOR TEST LOOP REQUESTED.  IF YES, THE LOOP COUNT IS   * 06210000
*       DECREMENTED AND THE OLT MODULE IS RE-EXECUTED UNTIL THE       * 06300000
*       COUNT IS EXHAUSTED.                                           * 06390000
*                                                                     * 06480000
*       WHEN THE TEST REQUEST IS SATISFIED ANY STILL LOADED MODULES   * 06570000
*       ARE DELETED.  IF THE TEST DEVICES ARE TERMINALS A START       * 06660000
*       TERMINAL REQUEST IS POSTED TO OPERATOR CONTROL FOR EACH.      * 06750000
*       IF THEY ARE TCU'S A START LINE REQUEST IS POSTED FOR EACH.    * 06840000
*       FINALLY RETURN IS MADE TO IEDQWA.                             * 06930000
*                                                              @Y17XAUU 07020000
* PURPOSE: SEE FUNCTION                                        @Y17XAUU 07110000
*                                                              @Y17XAUU 07200000
* MODULE TYPE: PROCEDURE                                       @Y17XAUU 07290000
*                                                              @Y17XAUU 07380000
* PROCESSOR: ASSEMBLER XF                                      @Y17XAUU 07470000
*                                                              @Y17XAUU 07560000
* MODULE SIZE: 4K                                              @Y17XAUU 07650000
*                                                              @Y17XAUU 07740000
* LINKAGE: XCTL'ED FROM IEDQWD AND IEDQWF                      @Y17XAUU 07830000
*                                                              @Y17XAUU 07920000
* MACROS: AQCTL                                                @Y17XAUU 08010000
*         BLDL                                                 @Y17XAUU 08100000
*         CLOSE                                                @Y17XAUU 08190000
*         DELETE                                               @Y17XAUU 08280000
*         IEDHJN                                               @Y17XAUU 08370000
*         IEDQMSG                                              @Y17XAUU 08460000
*         LINK                                                 @Y17XAUU 08550000
*         LOAD                                                 @Y17XAUU 08640000
*         OPEN                                                 @Y17XAUU 08730000
*         POST                                                 @Y17XAUU 08820000
*         SAVE                                                 @Y17XAUU 08910000
*         WAIT                                                 @Y17XAUU 09000000
*         XCTL                                                 @Y17XAUU 09090000
*                                                                     * 09180000
* INPUT:        REGISTER 02,13,14,15 CONTAIN THE FOLLOWING VALUES:    * 09270000
*                                                                     * 09360000
*                         02-OLTCB POINTER                            * 09450000
*                         13-SAVE AREA ADDRESS                        * 09540000
*                         14-RETURN ADDRESS                           * 09630000
*                         15-ENTRY POINT ADDRESS                      * 09720000
*                                                                     * 09810000
*                                                                     * 09900000
* COPYRIGHT: 'NONE'                                             SA41597 09990000
*                                                                     * 10080000
*                                                                     * 10170000
* EXTERNAL ROUTINES:                                                  * 10260000
*                                                                     * 10350000
*       IEDQWK - TOTE MESSAGE MODULE                                  * 10440000
*       IGC00059                                                      * 10530000
*       IEDQCA - TCAM STARTLINE                                       * 10620000
*       IEDQCA - TCAM STOP LINE                                       * 10710000
*                                                                     * 10800000
* EXIT POINTS:  XCTL AFTER 'TCNTL06'  TO IEDQWF                       * 10890000
*                 BR AFTER 'RETURN4'  TO IEDQWA                       * 10980000
*                                                                     * 11070000
* TABLES/WORK AREAS:                                                  * 11160000
*                                                                     * 11250000
*       OLTCB, UCB                                                    * 11340000
*                                                                     * 11430000
* ATTRIBUTES:                                                         * 11520000
*                                                                     * 11610000
*       ENABLED, PROBLEM PROGRAM MODE, TRANSIENT.                     * 11700000
*                                                              @Y17XAUU 11790000
* NOTES: SEE BELOW                                             @Y17XAUU 11880000
*                                                              @Y17XAUU 11970000
*  DEPENDENCIES: EBCDIC CHARACTER CODE                         @Y17XAUU 12060000
*                                                              @Y17XAUU 12150000
*  RESTRICTION: NONE                                           @Y17XAUU 12240000
*                                                              @Y17XAUU 12330000
*  REGISTER CONVENTIONS: SEE REGISTERS ASSIGNMENT              @Y17XAUU 12420000
*                                                              @Y17XAUU 12510000
*  PATCH LABEL: PATCH                                          @Y17XAUU 12600000
*                                                              @Y17XAUU 12690000
*********************************************************************** 12780000
         EJECT                                                          12870000
*                                                                       12960000
*        REGISTER EQUATES                                               13050000
*                                                                       13140000
R0       EQU   0                       REG 0                     S99528 13230000
PARMREG0 EQU   0                       PARAMETER REGISTER      @XM05678 13260010
PARMREG1 EQU   1                       PARAMETER REGISTER      @XM05678 13290010
R1       EQU   1                       REG 1                     S99528 13320000
R2       EQU   2                       REG 2                     S99528 13410000
R3       EQU   3                       REG 3                     S99528 13500000
R4       EQU   4                       REG 4                     S99528 13590000
R5       EQU   5                       REG 5                     S99528 13680000
R6       EQU   6                       REG 6                     S99528 13770000
R7       EQU   7                       REG 7                     S99528 13860000
R8       EQU   8                       REG 8                     S99528 13950000
R9       EQU   9                       REG 9                     S99528 14040000
R10      EQU   10                      REG 10                    S99528 14130000
R11      EQU   11                      REG 11                    S99528 14220000
R12      EQU   12                      REG 12                    S99528 14310000
R13      EQU   13                      REG 13                    S99528 14400000
R14      EQU   14                      REG 14                    S99528 14490000
R15      EQU   15                      REG 15                    S99528 14580000
DISREG2  EQU   16                      DISPLACEMENT TO REG2    @Y17XAUU 14670000
D0       EQU   0                       DISPLACEMENT OF 0       @Y17XAUU 14700000
D3       EQU   3                       DISPLACEMENT OF 3       @Y17XAUU 14730000
JFCBTSDM EQU   X'08'                   DISP                      S99528 14760000
JFCBLTYP EQU   X'02'                   TYPE                      S99528 14850000
ZERO     EQU   0                       ZERO                      S99528 14940000
ONE      EQU   1                       ONE                       S99528 15030000
TWO      EQU   2                       TWO                       S99528 15120000
THREE    EQU   3                       THREE                     S99528 15210000
FOUR     EQU   4                       FOUR                      S99528 15300000
FIVE     EQU   5                       FIVE                      S99528 15390000
SIX      EQU   6                       SIX                       S99528 15480000
SEVEN    EQU   7                       SEVEN                     S99528 15570000
EIGHT    EQU   8                       EIGHT                     S99528 15660000
NINE     EQU   9                       NINE                      S99528 15750000
TENN     EQU   10                      TEN                       S99528 15840000
ONEONE   EQU   11                      ELEVEN                    S99528 15930000
D34      EQU   34                      DISPLACEMENT 34           S99528 16020000
DEVTBEND EQU   X'00'                   TEST DEVICE TABLE END CODES99528 16110000
DEC58    EQU   58                      FIFTY EIGHT               S99528 16200000
SECTBEND EQU   X'40'                   SECTION TABLE END CODE    S99528 16290000
STRTCODE EQU   X'40'                   START CODE                S99528 16380000
STOPCODE EQU   X'41'                   START LINE                S99528 16470000
LINESTRT EQU   X'40'                   STOP LINE                 S99528 16560000
LINESTOP EQU   X'41'                   VERB CODE                 S99528 16650000
TERMSTRT EQU   X'45'                   VERB CODE START TERM      S99528 16740000
TERMSTOP EQU   X'47'                   TERMINAL CODE STOP        S99528 16830000
HOLDTERM EQU   X'88'                   HOLD TERMINAL VERB CODE   S99528 16920000
ACTIVETM EQU   X'46'                   ACTIVATE TERM VERB CODE   S99528 17010000
REALTERM EQU   X'87'                   RELEASE TERM VERB CODE    S99528 17100000
INACTERM EQU   X'48'                   INACTIVATE VERB CODE      S99528 17190000
BLANK    EQU   X'40'                   INCLUSIVE DLIM            S99528 17280000
D1       EQU   1                       ONE                       S22024 17370000
D2       EQU   2                       TWO                       S22024 17460000
D8       EQU   8                       EIGHT                     S22024 17550000
D4       EQU   4                       FOUR                      S22024 17640000
D12      EQU   12                      CONSTANT DISPLACEMENT     S05331 17730000
D32      EQU   32                      LCB ADJUSTMENT            S22024 17820000
D62      EQU   62                      DISP 62                   S22024 17910000
D64      EQU   64                      DISP 64                   S22024 18000000
TOTEIND  EQU   X'00'                   CLEAR TOTE INDICATOR     SA41597 18090000
*                                      IN THE LCB               SA41597 18180000
XFF      EQU   X'FF'                   USED TO CLEAR BITS        S05331 18270000
ADRMSK   EQU   7                             ADDRESS MASK      @Y17XAUU 18360000
BCDSLEN  EQU   20                      CDS LEN TO MOVE TO OLTCB@Y17XAUU 18400000
*                                                                       18450000
         EJECT                                                          18540000
         SAVE  (14,12)                 SAVE REGS                 S99528 18630000
         USING TOTOLTCB,R2             TOTE CONTROL BLOCK        S22024 18720000
*                                                                       18810000
*        SATISFY LINKAGE CONVENTIONS                                    18900000
*                                                                       18990000
         LR    R4,R15                  ESTABLISH BASE REG        S99528 19080000
         USING IEDQWE,R4               IEDQWE                    S99528 19170000
         ST    R13,TOTSAVE4+FOUR       SAVE CALLERS SAVE ADDR    S99528 19260000
         LR    R12,R13                 SAVE IT HERE TOO          S99528 19350000
         LA    R13,TOTSAVE4            MY SAVE AREA ADDRESS      S99528 19440000
         ST    R13,EIGHT(R12)          MY SAVE TO HIS            S99528 19530000
IEDQWE   IEDHJN IEDQWEE,HJN            NAME AND HJN              S99528 19620000
         TM    TOTFLG06,TOTOTERM+TOTCANCL  CANCELOR TERMINATE    S99528 19710000
         BNZ   TCNTL07                 YES BRANCH                S99528 19800000
         LA    R11,TOTOLTTB            SECTION ID TABLE ADDRESS  S99528 19890000
         ST    R11,TOTSAVE5+D4         SAVE ADDRESS              S22024 19980000
         LA    R11,TOTTDTBL            RESTORE FIRST DEV ENTRY   S99528 20070000
         ST    R11,TOTGRABP            GRAB POINTER              S99528 20160000
         ST    R11,TOTSAVE5            CURRENT DEVICE            S22024 20250000
TCNTL004 EQU   *                                                        20340000
*                                                                       20430000
*        INITIALIZE TABLES & POINTERS                                   20520000
*                                                                       20610000
*                                                                       20700000
TCNTL01  EQU   *                                                        20790000
***                                                                     20880000
***                                                                     20970000
***     FIND UCB FOR FIRST TEST DEVICE                                  21060000
**AFTER UCB FOUND BAL TO FIND DDNAME AND OPEN                           21150000
         L     R8,TOTTDTBL             GET TNT OR UCB            S99528 21240000
         ST    R8,SAVEENT              SAVE STATUS               S22024 21330000
         TM    SAVEENT,TOTTDORN        TEST DEVICE ON RN         S22024 21420000
         BZ    NORNTST                 NO BRANCH                 S22024 21510000
         BAL   R12,QCBFIND             GO FIND QCB AND LCB       S22024 21600000
         BAL   R9,DUMMYTNT             CHECK FOR COUNTERFEITING@Y17XAUU 21640000
         B     PRIENT                  GET FIRST SECTION ID      S22024 21690000
NORNTST  LA    R8,0(R8)                CLEAR HI BYTE             S22024 21780000
NEXTDEV  EQU   *                                                 S22024 21870000
         TM    SAVEENT,TOTTDLIN        LINES TESTED              S22024 21960000
         BO    STORE                   YES BRANCH                S99528 22050000
         BAL   R12,UCBFIND             FIND UCB FOR TERMINALS    S99528 22140000
STORE    STH   R8,ADDOFUCB             SAVE UCB ADDRESS          S99528 22230000
         BAL   R12,DDMOVE              GO FIND DDNAME IN TIOT    S99528 22320000
**                                     TO MOVE TO DCB AND OPEN   S99528 22410000
**       SET UP FIRST PRIMARY DEVICE ENTRY IN TOTPRENT           S99528 22500000
FSTPRI   MVC   TOTPRUCB,ADDOFUCB       MOVE UCB ADD TO TOTPRENT  S99528 22590000
         TM    SAVEENT,TOTTDLIN        LINES TESTED              S22024 22680000
         BZ    PRIENT                  NO BRANCH                 S99528 22770000
         B     FSTSECID                SET UP FIRST SECTION ID   S99528 22860000
PRIENT   EQU   *                                                 S99528 22950000
         L     R8,0(R11)               GET REAL TNT POINTER      S99528 23040000
         ST    R8,TOTTNTPR             SAVE IN TOTPRENT          S99528 23130000
         TM    SAVEENT,TOTTDORN        TEST DEVICE ON RN         S22024 23220000
         BO    FSTSECID                YES BRANCH                S22024 23310000
***    BAL TO ROUTINE TO FIND PLN AND LCB ADDRESS   GIVEN TNT ADD99528 23400000
         BAL   R12,RLNLCB              LCB AND RLN INTO TOTPRENT S99528 23490000
FSTSECID EQU   *                                                 S99528 23580000
         MVC   TOTCRALP(3),TOTOLTTB    GET FIRST OLT ID          S99528 23670000
         LA    R6,TOTOLTTB             UPDATE OLT ID             S99528 23760000
          ST    R6,TOTOLTPT             TABLE POINTER            S99528 23850000
         TM    TOTFLG03,TOTTSINC       INCLUSIVE ID ENTRY        S99528 23940000
         BZ    TCNT01A                 NO BRANCH                 S99528 24030000
         MVI   TOTCRFLG,TOTFTTIM       TURN ON FST PASS FLAG     S99528 24120000
TCNT01A  EQU   *                                                        24210000
         NI    $ERROPT,X'FF'-$TESTERR-$ASTERIK RESET ERR FLGS    S22024 24300000
*        GET SIZE OF OLT ROOT MODULE                                    24390000
*             & UPDATE CORE AVAILABLE TO SUB-MODULES                    24480000
*                                                                       24570000
         XC    TCNTBLDL(62),TCNTBLDL   CLEAR PARM LIST FOR BLDL         24660000
         MVI   TCNTBECT,ONE            SET ENTRY COUNT TO ONE           24750000
         MVI   TCNTBELN,DEC58          SET ENTRY LENGTH TO 58           24840000
         MVC   TCNTMDNM(8),TOTCROLT    MOVE IN MODULE NAME              24930000
         BLDL  0,TCNTBLDL              ISSUE BLDL                       25020000
         LTR   R15,R15                WAS IT SUCCESSFUL?                25110000
         BZ    TCNTL04                  YES                             25200000
TCNTL02  EQU   *                                                        25290000
******                                                                  25380000
******                                                                  25470000
******   IED330I   OLT MODULE XXXXXX NOT LOADABLE                S22024 25560000
******                                                                  25650000
         MVC   NOTLOAD+ONEONE(EIGHT),TOTCROLT  OLT NAME          S99528 25740000
         IEDQMSG OTBUF=NOTLOADD,OTCNT=40,PREG0=R0,PREG1=R1,      S22024C25830000
               FUNCT=(CEC,PRT),RET=TCNT490                     @YA12242 25920000
****  BRANCH TO AREA TO FIND THE NEXT OLT ID                            26010000
TCNTL04  EQU   *                                                        26100000
         L     R7,TCNTMDSZ        GET OLT SCHEDULER SIZE                26190000
         SRL   R7,8                 MODULE SIZE                         26280000
         L     R8,TOTMMSPC             TOTAL CORE AVAIL TO OLT   S22024 26370000
         SR    R8,R7                  IS THERE ENOUGH CORE?             26460000
         BNM   TCNT043                  YES                             26550000
         BAL   R12,TCNTL30              NO: GO GET MORE ASSIGNED        26640000
         B     TCNTL04            ENOUGH CORE WAS AVAILABLE, CONTINUE   26730000
************                                                            26820000
************                                                            26910000
*********   IED331I  NOT ENOUGH CORE FOR SECTION XXX             S22024 27000000
*********                                                               27090000
         MVC   NOCORE+29(8),TOTCROLT   OLT ID                    S99528 27180000
         IEDQMSG OTBUF=NOCOREE,OTCNT=45,PREG0=R0,PREG1=R1,       S22024C27270000
               FUNCT=(CEC,PRT),RET=TCNT490                     @YA12242 27360000
TCNT043  EQU   *                                                        27450000
         ST    R8,TOTMMSPC             UPDATE CORE AVAILABLE     S22024 27540000
         A     R7,TOTUSCOR        ADD SIZE TO USED CORE          Y06330 27630000
         ST    R7,TOTUSCOR             SAVE SIZE OF ROOT MODULE  S22024 27720000
*                                        IN CORE IN USE FIELD    S22024 27810000
         AR    R8,R7                ADD SIZE OF DELETED OLT             27900000
         LR    R11,R8             MOVE IT TO WORK REG                   27990000
         SRL   R11,2              GET AVAIL CORE IN WORDS               28080000
         STH   R11,$OLTSIZE            STORE IN SCT              S22024 28170000
         TM    SAVEENT,TOTTDTRM+TOTTDORN IS ENTRY TNT            S22024 28260000
         BNZ   NAMEBULD                YES BRANCH                S22024 28350000
         SR    R5,R5                   CLEAR                   @G36XRUV 28390010
         ICM   R5,3,TOTPRUCB           GET UCB ADDRESS         @G36XRUV 28440010
         USING UCBOB,R5                                          S99528 28530000
         MVC   CDSLINE+5(3),UCBNAME    GET LINE ADDRESS          S99528 28620000
         DROP  R5                                                S99528 28710000
LOADNAME EQU   *                                                 S99528 28800000
         LOAD  EPLOC=CDSLINE           BRING MEMBER IN CORE      S99528 28890000
         LR    R6,R0                   EP OF CDS                 S99528 28980000
         MVC   $PDEVADR(20),0(R6)      CDS TO SCT                S99528 29070000
         B     DELETE                  GO TO DELETE CDS          S99528 29160000
NAMEBULD EQU   *                                                 S99528 29250000
         MVI   CDSLINE,C' '            BLANK OUT                 S99528 29340000
         MVC   CDSLINE+1(7),CDSLINE    EIGHT CHARACTER NAME      S99528 29430000
         L     R12,TOTTNTPR            GET SAVED TNT ADDRESS     S99528 29520000
         LA    R9,CDSLINE              GET ADDRESS OF NAME FIELD S99528 29610000
         SR    R3,R3                   CLEAR REG                 S99528 29700000
         IC    R3,TOTTTBEL             GET NAME LRNGTH           S99528 29790000
         BCTR  R3,0                    DECREMENT COUNT FOR EX    S99528 29880000
         EX    R3,NAMEMOV              GO MOVE NAME              S99528 29970000
         L     R8,TNTENTRY        GET TTE ADDRESS              @Y17XAUU 29972000
         LA    R1,TRMPRFSZ        GET TTE PREFIX SIZE          @Y17XAUU 29974000
         SLR   R8,R1              POINT TO TTE PREFIX          @Y17XAUU 29976000
         USING IEDNTRM,R8         SET TTE ADDRESSABILITY       @Y17XAUU 29978000
         TM    TRMSTATE,TRMPREF   3705 RESOURCE                @Y17XAUU 29980000
         BZ    LOADNAME           NO - LOAD CDS                @Y17XAUU 29982000
         CLI   TRMTYPE,TRMNSDLC   PRE SNA LINK                 @XM05808 29982610
         BE    BLDLCDS            YES - CHECK FOR CDS IN DS    @XM05808 29983310
         CLI   TRMTYPE,TRMSDLC    SNA LINK                     @Y17XAUU 29984000
         BE    BLDLCDS            YES -CHECK FOR CDS IN DS     @Y17XAUU 29986000
         CLI   TRMTYPE,TRMLUNT    LU ENTRY                     @Y17XAUU 29988000
         BNE   LOADNAME           NO - LOAD CDS                @Y17XAUU 29990000
BLDLCDS  DS    0H                 BOUNDARY ALLIGNMENT          @Y17XAUU 29992000
         MVC   READNAME(D8),CDSLINE COPY NAME TO BLDL PLIST    @Y17XAUU 29993000
         BLDL  0,BLDLLIST         FIND CDS ENTRY               @Y17XAUU 29996000
         LTR   R15,R15            ENTRY FOUND                  @Y17XAUU 29998000
         BZ    LOADNAME           YES - LOAD CDS               @Y17XAUU 30000000
         DROP  R8                                              @Y17XAUU 30002000
*        CONSTRUCT CDS FOR 3767/3770 OR FOR A 3705 LINE        @Y17XAUU 30004000
         LA    R6,$PDEVADR        POINT TO PLACE TO            @Y17XAUU 30006000
*                                 BUILD CDS RECORD             @Y17XAUU 30008000
         USING IEDTCDSD,R6        SET CDS REC ADDRESSABILITY   @Y17XAUU 30010000
         XC    $PDEVADR(BCDSLEN),$PDEVADR CLEAR CDS AREA       @Y17XAUU 30012000
         MVI   TCDSCLS,TCDSCL37   SET CLASS FIELD              @Y17XAUU 30014000
         MVI   TCDSTYP,TCDSTY37   SET TYPE FIELD               @Y17XAUU 30016000
         MVI   TCDSFLG2,TCDSSEC   SET FLAG FIELD               @Y17XAUU 30018000
         MVC   TCDSNAM(D8),CDSLINE COPY SYMBOLIC NAME          @Y17XAUU 30020000
         MVI   TCDSCNT,TCDSSNA    SET CDS LENGTH 3767/3770     @Y17XAUU 30022000
         L     R8,NCPDCB          GET 3705 DCB ADDRESS         @XM05808 30022110
         USING IHADCB,R8          SET DCB ADDRESSABILITY       @XM05808 30022810
         L     R8,DCBDEBAD        GET DEB ADDRESS              @XM05808 30023510
         DROP  R8                                              @XM05808 30024210
         USING DEBNMSUB,R8        SET DEB ADDRESSABILITY       @XM05808 30024910
         SLR   R15,R15            CLEAR REGISTER               @XM05808 30025610
         IC    R15,DEBNMEXT       GET NUMBER OF EXTENTS        @XM05808 30026310
         SLL   R15,4              MULT BY FOUR                 @XM05808 30027010
         LA    R3,4               SET OFFSET TO UCB ADDRESS    @XM05808 30027710
         L     R8,DEBUCBAD-4(R3)  GET UCB ADDRESS              @XM05808 30028410
         DROP  R8                                              @XM05808 30029110
         USING UCB,R8             SET UCB ADDRESSABILITY       @Y17XAUU 30030000
         MVC   TCDSUCB+D2(D2),UCBCHA  SET 3705 UCB CUU         @Y17XAUU 30032000
         DROP  R8                                              @Y17XAUU 30034000
         L     R8,TNTENTRY        GET TTE ADDRESS              @Y17XAUU 30036000
         LA    R1,TRMPRFSZ        GET TTE PREFIX SIZE          @Y17XAUU 30038000
         SLR   R8,R1              POINT TO TTE PREFIX          @Y17XAUU 30040000
         USING IEDNTRM,R8         SET TTE ADDRESSABILITY       @Y17XAUU 30042000
         CLI   TRMTYPE,TRMLUNT    LU ENTRY                     @Y17XAUU 30044000
         BE    NODELETE           CONTINUE PROCESSING          @Y17XAUU 30046000
         MVI   TCDSCNT,TCDSLINK   SET LINE CDS BYTE COUNT      @Y17XAUU 30048000
         B     NODELETE           CONTINUE PROCESSING          @Y17XAUU 30050000
         DROP  R6                                              @Y17XAUU 30052000
         DROP  R8                                              @YM07769 30092000
NAMEMOV  MVC   0(0,R9),0(R12)          MOVE NAME FROM TERMINAL   S99528 30150000
DELETE   DELETE EPLOC=CDSLINE          DELETE CDS                S99528 30240000
*        SET BIT IN SCT TO INDICATE IF THE CONTROL TERMINAL      S22024 30330000
*        AND TEST TERMINAL ARE ON THE SAME COMM LINE             S22024 30420000
NODELETE DS    0H                 BOUNDARY ALLIGNMENT          @Y17XAUU 30460000
         NI    $TOTFLG1,XFF-$CTEQTT    RESET CT ON TEST LINE   @Y17XAUU 30510000
*                                      FLAG                    @Y17XAUU 30600000
         TM    TOTCTFLG,TOTCTORN       CT ON A RN                S22024 30690000
         BZ    CTNOTRN                 NO BRANCH                 S22024 30780000
         TM    SAVEENT,TOTTDORN        TEST DEV ON RN            S22024 30870000
         BZ    STRTMSG                 NO BRANCH                 S22024 30960000
         CLC   NAMESAVE(D8),TOTCTRNL   GROUP NAMES THE SAME      S22024 31050000
         BNE   STRTMSG                 NO BRANCH                 S22024 31140000
         CLC   TOTCTRLN(D1),TOTPRRLN   RLNS THE SAME             S22024 31230000
         BNE   STRTMSG                 NO BRANCH                 S22024 31320000
         L     R1,TNTENTRY             GET TTE ADDRESS         @Y17XAUU 31328000
         LA    R14,TRMPRFSZ            GET TTE PREFIX SIZE     @Y17XAUU 31336000
         SLR   R1,R14                  POINT TO TTE PREFIX     @Y17XAUU 31344000
         USING IEDNTRM,R1              SET ADDRESSABILITY      @Y17XAUU 31352000
         CLI   TRMTYPE,TRMLUNT         LU ENTRY                @Y17XAUU 31360000
         BNE   CTTTSAME                NO                      @Y17XAUU 31368000
         DROP  R1                                              @Y17XAUU 31376000
         CLC   TOTCRTNT+D1(D3),TOTTNTPR+D1 LU CT EQU TD        @Y17XAUU 31384000
         BNE   STRTMSG                 NO - BYPASS SETTING CT  @Y17XAUU 31392000
*                                      EQU TD FLAG             @Y17XAUU 31400000
         NI    $OLTFLGS,XFF-$TRACE     INSURE TRACE OPT OFF    @XM05673 31405010
CTTTSAME EQU   *                                                 S22024 31410000
         OI    $TOTFLG1,$CTEQTT        CT AND TEST DEV SAME LINE S22024 31500000
         B     STRTMSG                 BRANCH                    S22024 31590000
CTNOTRN  EQU   *                                                 S22024 31680000
         TM    SAVEENT,TOTTDORN        TEST DEV ON RN            S22024 31770000
         BO    STRTMSG                 YES BRANCH                S22024 31860000
         CLC   TOTCTUCB(D2),TOTPRUCB   UCBS THE SEME             S22024 31950000
         BE    CTTTSAME                YES BRANCH                S22024 32040000
STRTMSG  EQU   *                                                 S22024 32130000
         NI    TOTFLG01,XFF-TOTAPTST   RESET AP ON TEST LINE   @Y17XAUU 32220000
*                                      FLAG                    @Y17XAUU 32310000
         TM    TOTFLG09,TOTPRECT       CT EQU TD               @Y17XAUU 32340000
         BO    STRTMSG1                YES - BYPASS CHECK      @Y17XAUU 32370000
         TM    TOTAPFLG,TOTAPORN       AP ON 3705              @Y17XAUU 32400000
         BZ    STRTMSG1                NO - SEND MESSAGE       @Y17XAUU 32490000
         TM    SAVEENT,TOTTDORN        TEST DEVICE ON 3705     @Y17XAUU 32580000
         BZ    STRTMSG1                NO - SEND MESSAGE       @Y17XAUU 32670000
         CLC   NAMESAVE(D8),TOTAPRNL   SAME GROUP              @Y17XAUU 32760000
         BNE   STRTMSG1                NO - SEND MESSAGE       @Y17XAUU 32850000
         CLC   TOTAPRLN(D1),TOTPRRLN   AP ON TEST DEVICE LINE  @Y17XAUU 32940000
         BNE   STRTMSG1                NO - SEND MESSAGE       @Y17XAUU 33030000
         USING IEDNTRM,R1              SET ADDRESSABILITY      @Y17XAUU 33040000
         CLI   TRMTYPE,TRMLUNT         LU ENTRY                @Y17XAUU 33050000
         BNE   APTTSAME                NO                      @Y17XAUU 33060000
         DROP  R1                                              @Y17XAUU 33070000
         CLC   TOTARTNT+D1(D3),TOTTNTPR+D1 LU AP = TD          @Y17XAUU 33080000
         BNE   STRTMSG1                NO - BYPASS SETTING AP  @Y17XAUU 33090000
*                                      EQU TD FLAG             @Y17XAUU 33100000
         NI    $OLTFLGS,XFF-$TRACE     INSURE TRACE OPT OFF    @XM05673 33105010
APTTSAME DS    0H                      BOUNDARY ALLIGNMENT     @Y17XAUU 33110000
         OI    TOTFLG01,TOTAPTST       SHOW AP ON TEST LINE    @Y17XAUU 33120000
STRTMSG1 EQU   *                                               @Y17XAUU 33210000
*                                                                       33300000
*        SEND SECTION START MESSAGE                                     33390000
*                                                                       33480000
         TM    $ERROPT,$NOCNTRL        NO CONTROL PRINT          S22024 33570000
         BO    TCNTL06              YES: SKIP MESSAGE                   33660000
********                                                                33750000
********                                                                33840000
********   IED333I  S XXXX  UNIT  XXXX                           S22024 33930000
********                                                                34020000
         XC    UNIT,UNIT               CLEAR NAME                S99528 34110000
         MVC   TERMIAT,STARTID         START ID TO MSG           S22024 34200000
         MVI   TERMIATE+1,S            START                     S99528 34290000
         MVC   TERMIATE+3(8),TOTCROLT  SEC ID                    S99528 34380000
         TM    SAVEENT,TOTTDLIN        LINES TESTED              S22024 34470000
         BZ    NAMEFIND                NO BRANCH                 S99528 34560000
         TM    SAVEENT,TOTTDORN        LINE ON RN                S22024 34650000
         BO    NAMEFIND                YES BRANCH                S22024 34740000
         L     R1,TOTPRUCB             GET UCB                   S99528 34830000
         SRL   R1,16                   ADDRESS                   S99528 34920000
         USING UCB,R1                                            S99528 35010000
         MVC   UNIT+5(3),UCBNAME       MOVE NAME                 S99528 35100000
         DROP R1                                                 S99528 35190000
MSGCOMP  MVC   TERMIATE+18(8),UNIT     FILL IN UNIT              S99528 35280000
         OI    TOTFLG05,TOTCECOM       TURN ON CECOM FLAG        S99528 35370000
         NI    TOTFLG05,X'FF'-TOTREPLY TURN OFF REPLY FLAG       S99528 35460000
         TM    TOTFLG09,TOTAPTRM       AP EQUAL CONTROL TERMINAL S99528 35550000
         BO    STARTMSG                GO TO PRINT START MSG     S99528 35640000
         OI    TOTFLG05,TOTPRINT       TURN ON PRINT FLAG        S99528 35730000
STARTMSG EQU   *                                                 S99528 35820000
         IEDQMSG OTBUF=TERMIAT,OTCNT=34,FUNCT=(CEC,PRT),         S22024C35910000
               PREG0=R0,PREG1=R1,RET=TCNTL06                     S99528 36000000
NAMEFIND L     R1,TOTTNTPR             GET NAME ADDRESS          S99528 36090000
         SR    R15,R15                 CLEAR REG                 S99528 36180000
         IC    R15,TOTTTBEL            NAME LENGTH               S99528 36270000
         BCTR  R15,0                   DECREMENT COUNT           S99528 36360000
         EX    R15,NAMEMOVE            GO MOVE NAME              S99528 36450000
         B     MSGCOMP                 BRANCH                    S99528 36540000
TCNTL06  EQU   *                                                        36630000
*                                                                       36720000
         OI    TOTFLG02,TOTCHKSZ  INDICATE SIZE CHECK OF                36810000
*                                   OLT IS REQUIRED                     36900000
         OI    TOTFLG06,TOTOTACT       SET OLT ACTIVE FLG        S22024 36990000
         L     R13,4(R13)         GET CALLER'S SAVE                     37080000
         L     R14,12(R13)        GET RETURN ADDRESS                    37170000
         XCTL  (2,12),EP=IEDQWF   GO TO TEST CONTROL SUB-MODULE         37260000
         EJECT                                                          37350000
IEDQWE1  EQU   *                                                        37440000
         ENTRY IEDQWE1                                                  37530000
         DROP  R4                                                       37620000
         USING IEDQWE1,R15                                              37710000
         STM   R14,R12,12(R13)    SAVE CALLER'S REGISTERS               37800000
         L     R5,TOTFLG01             CONTAINS TOTCLNST       @G36XRUV 37810010
CSLOOP1  DS    0H                                              @G36XRUV 37820010
         LR    R6,R5                   COPY                    @G36XRUV 37830010
         O     R6,SETCLNST             SET CLEANUP START IN REG@G36XRUV 37840010
         CS    R5,R6,TOTFLG01          SET TOTCLNST            @G36XRUV 37850010
         BNZ   CSLOOP1                 BR IF WORD ALTERED      @G36XRUV 37860010
         NI    TOTFLG06,X'FF'-TOTOTACT CLEAR OLT ACTIVE FLAG     S22024 37890000
         L     R4,=A(IEDQWE)      GET BASE ADDRESS                      37980000
         DROP  R15                                                      38070000
         USING IEDQWE,R4                                                38160000
         LA    R12,TOTSAVE4            GET MY SAVE ADDRESS       S22024 38250000
         ST    R12,8(R13)         SAVE IT IN CALLER'S SAVE              38340000
         ST    R13,4(R12)         SAVE POINTER TO CALLER'S SAVE         38430000
         LR    R13,R12                                                  38520000
         L     R11,TOTSAVE5            CURRENT PRIMARY DEVICE PTRS22024 38610000
         L     R6,ZERO(R11)            SAVE ENTRY                S22024 38700000
         ST    R6,SAVEENT              TO WORK WITH              S22024 38790000
         L     R6,TOTSAVE5+D4          CURREST SECTION ID        S22024 38880000
*                                                                       38970000
*                                                                       39060000
*        SEND SECTION TERMINATE MESSAGE                                 39150000
*                                                                       39240000
         TM    $ERROPT,$NOCNTRL        NO CONTROL PRINT FLG SET  S22024 39330000
         BO    TCNTL07              YES: SKIP MESSAGE                   39420000
*                                                                       39510000
         TM    $ERROPT,$ASTERIK        ASTERIK PRINT NEEDED      S99528 39600000
         BZ    TMOVE                   NO BRANCH                 S99528 39690000
         MVI   TERMIATE,ASTRICK        ASTERICK TO MSG           S99528 39780000
TMOVE    MVI   TERMIATE+1,TEE          MOVE T TO MSG             S99528 39870000
         MVC   TERMIAT,TERMID          TERMINATE ID TO MSG       S22024 39960000
         MVC   TERMIATE+3(8),TOTCROLT  SEC ID                    S99528 40050000
         TM    SAVEENT,TOTTDLIN        LINES TESTED              S22024 40140000
         BZ    NAMEFIN                 NO BRANCH                 S99528 40230000
         TM    SAVEENT,TOTTDORN        LINE ON RN                S22024 40320000
         BO    NAMEFIN                 YES BRANCH                S22024 40410000
         L     R1,TOTPRUCB             GET UCB                   S99528 40500000
         SRL   R1,16                   ADDRESS                   S99528 40590000
         USING UCB,R1                                            S99528 40680000
         MVC   UNIT+5(3),UCBNAME       MOVE NAME                 S99528 40770000
         DROP R1                                                 S99528 40860000
MSGCOM   MVC   TERMIATE+18(8),UNIT     FILL IN UNIT              S99528 40950000
         OI    TOTFLG05,TOTCECOM       TURN ON CECOM FLAG        S99528 41040000
         NI    TOTFLG05,X'FF'-TOTREPLY TURN OFF REPLY FLAG       S99528 41130000
         TM    TOTFLG09,TOTAPTRM       AP EQUAL CONTROL TERMINAL S99528 41220000
         BO    STOPMSG                 GO TO PRINT STOP MSG      S99528 41310000
         OI    TOTFLG05,TOTPRINT       TURN ON PRINT FLAG        S99528 41400000
****                                                                    41490000
****   IED334I  (*) T  XXX   UNIT   XXX                          S22024 41580000
****                                                                    41670000
STOPMSG  EQU   *                                                 S99528 41760000
         IEDQMSG OTBUF=TERMIAT,OTCNT=34,FUNCT=(CEC,PRT),         S22024C41850000
               PREG0=R0,PREG1=R1,RET=TCNTL07                     S99528 41940000
NAMEFIN  L     R1,TOTTNTPR             GET NAME ADDRESS          S99528 42030000
         SR    R15,R15                 CLEAR REG                 S99528 42120000
         IC    R15,TOTTTBEL            NAME LENGTH               S99528 42210000
         BCTR  R15,0                   DECREMENT COUNT           S99528 42300000
         EX    R15,NAMEMOVE            GO MOVE NAME              S99528 42390000
         B     MSGCOM                  BRANCH                    S99528 42480000
*                                                                       42570000
TCNTL07  EQU   *                                                        42660000
         MVI   TERMIATE,BLANK          CLEAR ASTRIC              S99528 42750000
*                                                                       42840000
*        DELETE ANY OLT SUBMODULES THAT ARE STILL LOADED                42930000
*                                                                       43020000
         TM    TOTFLG06,TOTABEND  OLT ABEND                      S22024 43110000
         BO    TCNT490            YES - BYPASS QCB CHECK         S22024 43200000
         LA    R8,TOTPLNKQ        GET ADDR OF PLINK QCB                 43290000
TCNTL13  EQU   *                                                        43380000
         L     R9,TOTPLBKW              GET LAST PLINK Q ELEM  @YA12242 43470000
         LA    R9,0(R9)           CLEAR HIGH ORDER BYTE                 43560000
         CR    R8,R9            Q  IS ELEMENT THE QCB                   43650000
         BE    TCNT487              YES  END OF QUEUE                   43740000
         USING PLNKPREF,R9                                              43830000
         LH    R10,PLNKMPTR       GET DISPLACEMENT TO                   43920000
*                                   PLINK PARAMETERS                    44010000
         AR    R10,R9             GET ADDR OF QUEUE POINTERS            44100000
         USING PLNKQPTR,R10                                             44190000
         L     R10,PLNKQBKD             GET NEXT ELEM          @YA12242 44280000
         ST    R10,TOTPLBKW             SAVE NEXT POINTER      @YA12242 44370000
         DELETE EPLOC=PLNKNAME    DELETE MODULE                         44460000
         DROP  R10                                                      44550000
         LR    R9,R10             GET NEXT QUEUE ELEMENT                44640000
         DROP  R9                                                       44730000
         B     TCNTL13            GO TRY NEXT ELEMENT                   44820000
TCNT487  EQU   *                                                        44910000
         ST    R8,TOTPLFWD              UPDATE QCB             @YA12242 45000000
TCNT490  EQU   *                                                        45090000
         TM    TOTFLG06,TOTOTERM+TOTCANCL CANCEL OR TERMINATE    S22024 45180000
         BNZ   TCNTL11A                    YES                          45270000
         TM    TOTFLG03,TOTTSINC       INCLUSIVE ID ENTRY        S99528 45360000
         BO    INCHTST                 YES BRANCH                S99528 45450000
         CLI   3(R6),SECTBEND          ANY MORE SECTIONS         S99528 45540000
         BE    TCNT56               NO                                  45630000
         LA    R8,TOTOLTTE        GET END OF OLT TABLE                  45720000
         LA    R6,3(R6)           GET NEXT TABLE ENTRY                  45810000
         CR    R8,R6           Q  IS IT END OF TABLE                    45900000
         BE    TCNT56               YES                                 45990000
         MVC   TOTCRALP(3),0(R6)  UPDATE CURRENT OLT I.D.               46080000
         ST    R6,TOTSAVE5+D4          SAVE SECTION ID           S22024 46170000
         LA    R1,TOTTDTBL             START OF DEVICE TABLE     S99528 46260000
         LA    R7,R10                  SET LOOP COUNT            S99528 46350000
TEN      NI    0(R1),X'FF'-TOTTDGRB    CLEAR GRAB FLAG           S99528 46440000
         LA    R1,4(R1)                BUMP TO NEXT DEVICE       S99528 46530000
         BCT   R7,TEN                  RESET ALL GRABED FLAGS    S99528 46620000
         B     TCNT01A                 GO EXECUTE NEXT OLT       S99528 46710000
TCNT56   EQU   *                                                        46800000
         TM    TOTPRDCB+X'30',X'10'    PRIMARY DCB OPEN          S99528 46890000
         BZ    RESTPTR                 NO BRANCH                 S99528 46980000
         LA    R1,TOTPRDCB             TEST DCB                  S99528 47070000
         ST    R1,TOTWKSPC             STORE IN P LIST           S99528 47160000
         MVI   TOTWKSPC,X'B0'          OPTION CLOSE              S99528 47250000
         LA    R1,TOTWKSPC             ADDRESS OF P LIST         S99528 47340000
         CLOSE MF=(E,(1))              CLOSE TEST DCB            S99528 47430000
RESTPTR  LA    R6,TOTOLTTB             RESTORE SECT POINTER      S22024 47520000
         ST    R6,TOTSAVE5+D4          FIRST SECTION             S22024 47610000
*                                                                       47700000
         TM    TOTFLG06,TOTCANCL+TOTOTERM  CANCEL                S99528 47790000
         BO    TCNTL11A                YES BRANCH                S99528 47880000
         TM    $EXECFLG,$LSTPDEV       IS FINAL FLAG SET         S22024 47970000
         BO    TCNTL09              YES: SKIP REMAINING DEVICES         48060000
NXTDEV   LA    R11,4(R11)              UPDATE CURRENT            S99528 48150000
*                                         DEVICE POINTER                48240000
         CLI   0(R11),DEVTBEND         ANY MORE DEVICES          S99528 48330000
         BE    TCNTL09                NO                                48420000
         TM    0(R11),TOTTDGRB         DEV BEEN GRABED           S99528 48510000
         BO    NXTDEV                  YES DO NOT ASSIGN         S99528 48600000
         LA    R8,TOTTDEND        GET TABLE END ADDRESS                 48690000
         CR    R8,R11                  ARE THERE ANY MORE ENTRIESS99528 48780000
         BE    TCNTL09              NO                                  48870000
         ST    R11,TOTSAVE5            UPDATE DEV ADDR POINTER   S22024 48960000
*********************************************************************** 49050000
*********************************************************************** 49140000
**                                                                   ** 49230000
**       UPDATE PRIMARY DEVICE ENTRY AND MOVE                        ** 49320000
**            PRIMARY INFORMATION TO SCT                             ** 49410000
**                                                                   ** 49500000
*********************************************************************** 49590000
*********************************************************************** 49680000
         L     R8,0(R11)               GET NEXT ENTRY            S99528 49770000
         ST    R8,SAVEENT              SAVE NEXT ENTRY BEING     S22024 49860000
         ST    R8,TOTTNTPR             SAVE TNT POINTER          S22024 49950000
*                                      PROCESSED                 S22024 50040000
         TM    0(R11),TOTTDORN         TEST DEVICE ON RN         S22024 50130000
         BZ    NEXTDEV                 NO BRANCH                 S22024 50220000
         BAL   R12,QCBFIND             GO FIND QCB               S22024 50310000
         B     FSTSECID                GET FIRST SECTION ID      S22024 50400000
*                                                                       50490000
*        CHECK FOR TEST LOOP                                            50580000
*                                                                       50670000
TCNTL09  EQU   *                                                        50760000
         TM    $ERROPT,$LOOPTST        TEST LOOP REQUEST         S22024 50850000
         BZ    TCNTL11A             NO                                  50940000
         LH    R11,TOTTLCNT            YES DECREMENT COUNT       S22024 51030000
         BCT   R11,TCNTL11             EX OLT AGAIN              S99528 51120000
         B     TCNTL11A                GO END OLT                S99528 51210000
TCNTL11  EQU   *                                                        51300000
         STH   R11,TOTTLCNT            STORE NEW LOOP COUNT      S22024 51390000
         B     IEDQWEE                 GO TO RE RUN TEST         S99528 51480000
TCNTL11A EQU   *                                                        51570000
*                                                                       51660000
*        SEND ON-LINE TESTING ENDED MESSAGE                             51750000
*                                                                       51840000
         TM    TOTFLG01,TOTIPLCU       IS FORCED CLEANUP IN      S05331 51930000
*                                        PROGRESS?               S05331 52020000
         BO    EXITE2                  YES, BYPASS WAIT FOR LAST Y06330 52110000
*                                        MESSAGE RESPONSE        S05331 52200000
NOCLEAN  EQU   *                                                 S05331 52290000
         TM    TOTFLG05,TOTNDMSG       END OF MESSAGE REQUEST    S22024 52380000
         BZ    TCNTL11C             NO                                  52470000
         TM    TOTFLG06,TOTCANCL       CANCELL FLAG SET          S22024 52560000
         BZ    TCNTL11B                NO BRANCH                 S99528 52650000
**********                                                              52740000
**********                                                              52830000
**********   ON-LINE TESTING CANCELLED                                  52920000
*******                                                                 53010000
         IEDQMSG   MSGID=20,PREG0=R0,PREG1=R1,FUNCT=CEC,               X53100000
               RET=TCNTL11C                                             53190000
TCNTL11B EQU   *                                                        53280000
*******                                                                 53370000
*******                                                                 53460000
*******   ON-LINE TESTING ENDED                                         53550000
*******                                                                 53640000
         IEDQMSG   MSGID=16,PREG0=R0,PREG1=R1,FUNCT=CEC                 53730000
TCNTL11C EQU   *                                                        53820000
EXITE2   EQU   *                                                 S05331 53910000
         L     R13,4(R13)              GET CALLERS SAVE          S22024 54000000
         L     R14,D12(R13)            GET RETURN ADDRESS        S05331 54090000
         XCTL  (2,12),EP=IEDQWE2       GO TO CLEANUP MODULE      S22024 54180000
         EJECT                                                          54270000
QCBFIND  EQU   *                       FIND PRIMARY QCB AND      S22024 54360000
*                                      THE RN LCB ADDRESS        S22024 54450000
         LR    R9,R8                   GET TNT ADDRESS           S22024 54540000
         ST    R9,TRMTNT               SAVE TNT ADDRESS        @Y17XAUU 54580000
         ST    R9,TOTTNTPR             SAVE TNT ADDRESS        @YM08563 54600000
         SR    R3,R3                   CLEAR REG                 S22024 54630000
         IC    R3,TOTTTBEL             GET NAME LENGTH           S22024 54720000
         AR    R9,R3                   TTE ADDRESS               S22024 54810000
         BCTR  R3,R0                   DECREMENT NAME LEN      @Y17XAUU 54900000
         EX    R3,MOVENAME             MOVE NAME TO P-LIST     @Y17XAUU 54990000
         L     R6,TOTAVTPT             GET AVT ADDRESS         @Y17XAUU 55080000
         USING IEDQAVTD,R6             SET AVT ADDRESSABILITY  @Y17XAUU 55170000
         L     R15,AVTRNMPT            GET TERM NAME TAB ADDR  @Y17XAUU 55200000
         ST    R15,TERNMTAB            SAME IT                 @Y17XAUU 55230000
         L     R15,AVTMSGS-D1          VCON TABLE ADDRESS      @Y17XAUU 55260000
         L     R15,D8(R15)             ADDRESS OF A1 ROUTINE   @Y17XAUU 55350000
         LA    R0,1(R3)                GET NAME LENGTH         @Y17XAUU 55440000
         LA    R1,PRINAME              GET ADDRESS OF NAME     @Y17XAUU 55530000
         BAL   R14,FOUR(R15)           FIND PRI TD TTCIN       @Y17XAUU 55620000
*                                                              @Y17XAUU 55710000
*        IEDQA1 RETURNS TEST DEVICE TTCIN IN REG 15            @Y17XAUU 55800000
*                                                              @Y17XAUU 55890000
         STH   R15,TOTPROFF            SAVE PR TD TTCIN        @Y17XAUU 55980000
         LR    R1,R15                  SET UP TO FIND NETWORK  @Y17XAUU 56070000
*                                      ADDRESS                 @Y17XAUU 56160000
         L     R15,AVTSAVTP            GET SAVT ADDRESS        @Y17XAUU 56250000
         L     R15,SAVTTNTX-IEDNSVTD(R15) GET ADDRESS OF TTCIN @Y17XAUU 56340000
*                                      TO NETWORK ADDR CONV RTN@Y17XAUU 56430000
         BALR  R14,R15                 FIND NETWORK ADDRESS    @Y17XAUU 56520000
*                                                              @Y17XAUU 56610000
*        IEDIAP04 RETURNS NETWORK ADDRESS IN REG 1             @Y17XAUU 56700000
*                                                              @Y17XAUU 56790000
         STH   R15,TOTPRSID            SAVE NETWORK ADDRESS    @YM07278 56880000
         DROP  R6                                              @Y17XAUU 56970000
         MVC   TNTENTRY+D1(D3),D0(R9)  ALLINE ADDRESS          @Y17XAUU 57060000
         L     R9,TNTENTRY             TTE ADDRESS             @Y17XAUU 57150000
         USING IEDQTRM,R9              TTE                       S22024 57240000
         L     R9,TRMDESTQ-1           QCB ADDRESS               S22024 57330000
         ST    R9,TRMQCB               SAVE QCB ADDRESS        @Y17XAUU 57370000
         DROP  R9                      TTE                       S22024 57420000
         USING IEDQQCB,R9              QCB                       S22024 57510000
         MVC   TOTPRRLN(D1),QCBRELLN   SAVE PRI RLN              S22024 57600000
         L     R9,QCBLGBAD-1           LGB ADDRESS               S22024 57690000
         DROP  R9                      QCB                       S22024 57780000
         USING IEDNLGB,R9              LGB                       S22024 57870000
         MVC   NAMESAVE(D8),LGBNAME    SAVE GROUP NAME           S22024 57960000
         DROP  R9                      LGB                       S22024 58050000
         L     R1,TNTENTRY             GET TTE ADDRESS         @Y17XAUU 58140000
         BAL   R14,NCPTTE              GET NCP TTE ADDRESS     @Y17XAUU 58230000
*                                                              @Y17XAUU 58320000
*        ON RETURN R1 CONTAINS ADDRESS OF NCP TTE PREFIX       @Y17XAUU 58410000
*                                                              @Y17XAUU 58500000
         USING IEDNTRM,R1              SET TTE ADDRESSABILITY  @Y17XAUU 58590000
         L     R1,TRMDESTQ-D1          GET QCB ADDRESS         @Y17XAUU 58680000
         DROP  R1                                              @Y17XAUU 58770000
         USING IEDQQCB,R1              SET QCB ADDRESSABILITY  @Y17XAUU 58860000
         L     R9,QCBDCBAD-D1          GET 3705 DCB ADDRESS    @Y17XAUU 58950000
         ST    R9,NCPDCB               SAVE 3705 DCB ADDRESS   @XM05808 58990010
         DROP  R1                                              @Y17XAUU 59040000
         USING IHADCB,R9               DCB                       S22024 59130000
         L     R3,DCBIOBAD             IOB ADDRESS               S22024 59220000
         SR    R6,R6                   CLEAR REG                 S22024 59310000
         IC    R6,DCBEIOBX             LCB SIZE                  S22024 59400000
         AR    R3,R6                   LCB OFFSET FROM DCB       S22024 59490000
         LA    R6,D32                  ADDTESTMENT TO START      S22024 59580000
*                                      OF LCB                    S22024 59670000
         SR    R3,R6                   STARTING LCB ADDRESS      S22024 59760000
         STCM  R3,ADRMSK,TOTPRLCB      SAVE RN LCB               S22024 59850000
         DROP  R9                      DCB                       S22024 59940000
         BR    R12                     RETURN                    S22024 60030000
         EJECT                                                          60120000
************************************************************** @Y17XAUU 60210000
*        ROUTINE TO FIND NCP TTE ADDRESS. INPUT: REG 1 =     * @Y17XAUU 60300000
*        TERMINAL TTE ADDRESS. OUTPUT: REG 1 = NCP TTE       * @Y17XAUU 60390000
*        ADDRESS. RETURN TO CALLER VIA REG 14.                 @Y17XAUU 60480000
************************************************************** @Y17XAUU 60570000
NCPTTE   EQU   *                                               @Y17XAUU 60660000
         STM   R14,R12,TRMSAVE3        SAVE CALLER'S REGS      @Y17XAUU 60750000
         LA    R8,TRMPRFSZ             GET TTE PREFIX SIZE     @Y17XAUU 60840000
         SLR   R1,R8                   POINT TO TTE PREFIX     @Y17XAUU 60930000
         USING IEDNTRM,R1              SET TTE ADDRESSABILITY  @Y17XAUU 61020000
NCPLOOP  EQU   *                                               @Y17XAUU 61110000
         LH    R1,TRMCOHRT             GET COHORT POINTER      @Y17XAUU 61200000
         L     R15,TOTAVTPT            GET AVT ADDRESS         @Y17XAUU 61290000
         USING IEDQAVTD,R15            SET AVT ADDRESSABILITY  @Y17XAUU 61380000
         L     R15,AVTRNMPT            TTCIN TO TTE CONVERSION @Y17XAUU 61470000
*                                      ROUTINE ADDRESS         @Y17XAUU 61560000
         DROP  R15                                             @Y17XAUU 61650000
         BALR  R14,R15                 FIND TTE ADDRESS        @Y17XAUU 61740000
         SLR   R1,R8                   POINT TO TTE PREFIX     @Y17XAUU 61830000
         CLI   TRMTYPE,TRMLNCP         NCP ENTRY               @Y17XAUU 61920000
         BNE   NCPLOOP                 NO - CHECK NEXT ENTRY   @Y17XAUU 62010000
         LM    R14,R0,TRMSAVE3         RESTORE REG 14-0        @Y17XAUU 62100000
         LM    R2,R12,TRMSAVE3+DISREG2 RESTORE REG 2-12        @Y17XAUU 62190000
         BR    R14                     RETURN TO CALLER        @Y17XAUU 62280000
         DROP  R1                                              @Y17XAUU 62370000
         EJECT                                                          77040000
****************************************************************@Y17XAU 77090000
*        ROUTINE TO GO TO IEDQWB2 TO CALCULATE THE AMOUNT OF   *@Y17XAU 77140000
*        OF CORE NEEDED TO BUILD DUMMY ENTRIES FOR A SPECIFIED *@Y17XAU 77190000
*        REMOTE TERMINAL. CONTROL IS PASS TO IEDQWB TO ATTAIN  *@Y17XAU 77240000
*        THE ACTUAL CORE.  CONTROL IS THEN RETURNED TO IEDQWB2 *@Y17XAU 77290000
*        TO COPY THE ENTRIES.                                  *@Y17XAU 77340000
****************************************************************@Y17XAU 77390000
DUMMYTNT EQU   *                                               @Y17XAUU 77440000
         STM   R7,R11,TRMSAVE2    SAVE REGISTERS               @Y17XAUU 77490000
         L     R8,TNTENTRY        GET TTE ADDRESS              @Y17XAUU 77540000
         LA    R7,TRMPRFSZ        GET TTE PREFIX SIZE          @Y17XAUU 77590000
         SLR   R8,R7              POINT TO TTE PREFIX          @Y17XAUU 77640000
         USING IEDNTRM,R8         SET TTE ADDRESSABILITY       @Y17XAUU 77690000
         CLI   TRMTYPE,TRMLUNT    LU ENTRY                     @Y17XAUU 77740000
         BNE   DUMOUT             RETURN TO CALLER             @Y17XAUU 77790000
         DROP  R8                                              @Y17XAUU 77840000
         MVI   TRMRQFLG,PRREQ     SHOW PRI TD REQUEST          @Y17XAUU 77940000
         LA    R12,KTRM           PASS PARAMETERS              @Y17XAUU 78010000
         XC    TRMFLG01(D1),TRMFLG01 CLEAR CONTROL FLAG        @Y17XAUU 78080000
*                                                              @Y17XAUU 78150000
         LINK  EP=IEDQWB2         CALCULATE CORE               @Y17XAUU 78220000
         CL    R15,ERRCD8         SNA LU REJECT                @XM05678 78240010
         BE    DUMFAILU           YES - WRITE ERROR MESSAGE    @XM05678 78260010
         LTR   R15,R15            REQUEST SUCCESSFUL           @Y17XAUU 78290000
         BNZ   DUMFAIL            NO - ERROR                   @Y17XAUU 78360000
         CLI   TRMRQFLG,ALRDY     COUNTERFEITING COMPLETE      @Y17XAUU 78430000
         BE    DUMOUT             YES - RETURN TO CALLER       @Y17XAUU 78500000
*                                                              @Y17XAUU 78750000
         L     R10,TOTRESPL       ADDR OF TOTE RES. CTL BLK    @Y17XAUU 78810000
         USING RESPL,R10                                       @Y17XAUU 78870000
         XC    TOTOTECB(D4),TOTOTECB CLEAR ECB                 @Y17XAUU 78930000
         POST  RESTECB1           POST REQUEST TO IEDQWB       @Y17XAUU 78990000
         WAIT  ECB=TOTOTECB       WAIT FOR REQUEST TO BE HONORED@Y17XAU 79050000
*                                                              @Y17XAUU 79110000
         CLI   TOTWKSPC,XFF       REQUEST SUCCESSFUL           @Y17XAUU 79170000
         BE    DUMFAIL            NO - ERROR                   @Y17XAUU 79230000
*                                                              @Y17XAUU 79290000
         OI    TRMFLG01,TRMQWB3   SHOW SECOND PASS             @Y17XAUU 79350000
         LA    R12,KTRM           PASS PARAMETERS              @Y17XAUU 79410000
         LINK  EP=IEDQWB2         COPY ENTRIES                 @Y17XAUU 79470000
         LTR   R15,R15            REQUEST SUCCESSFUL           @Y17XAUU 79530000
         BNZ   DUMFAIL            NO - ERROR                   @Y17XAUU 79590000
         OI    TOTFLG04,X'08' .TOTPRCTF *********************  @YM08057 79760000
*                                                              @Y17XAUU 79800000
DUMOUT   EQU   *                                               @Y17XAUU 79870000
         LM    R7,R11,TRMSAVE2    RESTORE REGISTERS            @Y17XAUU 79940000
         BR    R9                 RETURN                       @Y17XAUU 80010000
         SPACE                                                          80020010
DUMFAILU EQU   *                                               @XM05678 80030010
         IEDQMSG MSGID=093,FUNCT=CEC ERROR,LU NOT IN SSCP LU SESSION    80040010
*                                 ONLY                         @XM05678 80050010
         OI    TOTFLG06,TOTOTERM  SET TERMINATE FLAG           @XM05678 80060010
         B     TCNTL11B           EXIT TO CLEAN UP             @XM05678 80070010
         SPACE 2                                               @Y17XAUU 80080000
DUMFAIL  EQU   *                                               @Y17XAUU 80150000
         WTO   'IED215I OLT REQUEST REJECTED, UNABLE TO ALLOCATE RESOUR*80220000
               CES FOR CT/AP/TD',ROUTCDE=10,DESC=7             @Y17XAUU 80290000
         OI    TOTFLG06,TOTOTERM  SET TERMINATE FLAG           @Y17XAUU 80360000
         B     TCNTL11B           EXIT TO CLEANUP              @Y17XAUU 80430000
         EJECT                                                 @Y17XAUU 80820000
TCNTL30  EQU   *                                               @Y17XAUU 80820400
         LR    R14,R7             DIVIDE CORE                  @Y17XAUU 80820800
         SR    R15,R15              REQUIRED BY                @Y17XAUU 80821200
         SRDL  R14,10               X'400'                     @Y17XAUU 80821600
         LTR   R15,R15            IS THERE A REMAINDER?        @Y17XAUU 80822000
         BZ    TCNTL32              NO                         @Y17XAUU 80822400
         LA    R14,1(R14)           YES: ROUND UP TO EVEN MULT @Y17XAUU 80822800
TCNTL32  EQU   *                                               @Y17XAUU 80823200
         LR    R7,R14             SAVE BLOCK REQUIREMENT       @Y17XAUU 80823600
         LA    R8,EIGHT           GET MINIMUM BLOCK COUNT ALREADYS22024 80824000
*                                   ASSIGNED                   @Y17XAUU 80824400
         SR    R7,R8              SUBTRACT AMOUNT ALREADY      @Y17XAUU 80824800
*                                   ASSIGNED FROM REQUIRED     @Y17XAUU 80825200
*                                   AMOUNT                     @Y17XAUU 80825600
         L     R10,TOTRESPL       GET ADDRESS OF RESIDENT      @Y17XAUU 80826000
*                                   PARAMETER LIST             @Y17XAUU 80826400
         USING RESPL,R10                                       @Y17XAUU 80826800
         CH    R7,RESBKTOT        DOES TOTE HAVE ENOUGH CORE?  @Y17XAUU 80827200
         BH    FOUR(R12)          NO: SEND NOT ENOUGH CORE     @Y17XAUU 80827600
*                                   MESSAGE                    @Y17XAUU 80828000
         LA    R8,THREE           GET TRANSIENT AREA REQUIREMENT@Y17XAU 80828400
         AR    R14,R8             GET TOTAL NUMBER OF BLOCKS   @Y17XAUU 80828800
*                                   REQUIRED                   @Y17XAUU 80829200
         STH   R14,TOTBKRQD       PUT NEW CORE BLOCK REQUIREMENT@Y17XAU 80829600
*                                   INTO OLTCB                 @Y17XAUU 80830000
*                                   IN OLTCB                   @Y17XAUU 80830400
         OI    TOTFLG10,TOTOLTWT+TOTOLTRS  SET RESTART FLAGE   @Y17XAUU 80830800
*                                 SET OLT WAITING FOR CORE FLAG@Y17XAUU 80831200
         POST  RESTECB1           REQUEST OLT CORE             @Y17XAUU 80831600
         XC    TOTOTECB(D4),TOTOTECB   CLEAR ECB               @Y17XAUU 80832000
         WAIT  1,ECB=TOTOTECB          WAIT FOR CORE ASSIGNMENT@Y17XAUU 80832400
         L     R8,TOTMMSPC             CORE AVAILABLE TO OLT   @Y17XAUU 80832800
         DROP  R10                                             @Y17XAUU 80833200
         BR    R12                     RETURN TO CK CORE AVAIL @Y17XAUU 80833600
         EJECT                                                 @Y17XAUU 80834000
*****************************************************************S99528 80834400
*****************************************************************S99528 80834800
*                                                              @Y17XAUU 80835200
*        INCLUSIVE OLT ID ROUTINE                              @Y17XAUU 80835600
*                                                              @Y17XAUU 80836000
*****************************************************************S99528 80836400
*****************************************************************S99528 80836800
INCHTST  EQU   *                       INCLUSIVE ROUTINE       @Y17XAUU 80837200
         CLI   TOTSECBL,BLANK          SECOND CHAR BLANK       @Y17XAUU 80837600
         BE    TWOBLNK                 YES BRANCH     A        @Y17XAUU 80838000
         CLI   TOTONECU,BLANK          FIRST CHAR BLANK        @Y17XAUU 80838400
         BE    ONEBLNK                 YES BRANCH    AA        @Y17XAUU 80838800
**   ENTRY LOOKS LIKE  AAA-AAZ                                 @Y17XAUU 80839200
         TM    TOTCRFLG,TOTFTTIM       FIRST TIME THRU         @Y17XAUU 80839600
         BZ    NOTFST                  NO BRANCH               @Y17XAUU 80840000
         LA    R3,ALPHTABL             GET ALPHBET ADDRESS     @Y17XAUU 80840400
FINDTID  CLC   0(1,R3),TOTONECU        FIND TEST ID            @Y17XAUU 80840800
         LA    R3,1(R3)                BUMP ALPHBET ADDRESS    @Y17XAUU 80841200
         BE    SAVEONEA                GO SAVE BUMPED ADDRESS  @Y17XAUU 80841600
         B     FINDTID                 KEEP SEARCHING          @Y17XAUU 80842000
SAVEONEA LR    R1,R4                   GET BASE ADDRESS        @Y17XAUU 80842400
         SR    R3,R1                   COMPUTE OFFSET          @Y17XAUU 80842800
         ST    R3,TOTSAADR             SAVE OFFSET             @Y17XAUU 80843200
         L     R5,TOTSAADR             GET SAVED ADDRESS       @Y17XAUU 80843600
         AR    R5,R4                   COMPUTE ADDRESS         @Y17XAUU 80844000
MOVEID   MVC   TOTONELT(1),0(R5)       MOVE TO CURRENT OLT ID  @Y17XAUU 80844400
         MVI   TOTCRFLG,TOTCLRFG       CLEAR FIRST TIME FLAG   @Y17XAUU 80844800
         CLC   0(1,R5),TOTONEND        RUN ALL TEST ASK FOR    @Y17XAUU 80845200
         BH    TCNT56                  YES BRANCH              @Y17XAUU 80845600
         B     TCNT01A                 NO BRANCH               @Y17XAUU 80846000
NOTFST   L     R3,TOTSAADR             GET SAVED ADDRESS       @Y17XAUU 80846400
         LA    R3,1(R3)                BUMP ADDRESS            @Y17XAUU 80846800
         AR    R3,R4                   RESTORE ADDRESS         @Y17XAUU 80847200
        B      SAVEONEA                BRANCH                  @Y17XAUU 80847600
ONEBLNK  TM    TOTCRFLG,TOTFTTIM       FIRST TIME THRU         @Y17XAUU 80848000
         BZ    NOTFST1                 NO BRANCH               @Y17XAUU 80848400
         LA    R3,ALPHTABL             GET ALPHBET ADDRESS     @Y17XAUU 80848800
FINDID1  CLC   0(1,R3),TOTSECBL        FIND TEST ID            @Y17XAUU 80849200
         LA    R3,1(R3)                BUMP ALPHBET ADDRESS    @Y17XAUU 80849600
         BE    SAVEONEB                GO SAVE BUMPED ADDRESS  @Y17XAUU 80850000
         B     FINDID1                 KEEP SEARCHING          @Y17XAUU 80850400
SAVEONEB LR    R1,R4                   GET BASE ADDRESS        @Y17XAUU 80850800
         SR    R3,R1                   COMPUTE OFFSET          @Y17XAUU 80851200
         ST    R3,TOTSAADR             SAVE OFFSET             @Y17XAUU 80851600
         L     R5,TOTSAADR             GET SAVED ADDRESS       @Y17XAUU 80852000
         AR    R5,R4                   COMPUTE ADDRESS         @Y17XAUU 80852400
MOVEID1  MVC   TOTCRTOO(1),0(R5)       MOVE TO CURRENT OLT ID  @Y17XAUU 80852800
         MVI   TOTCRFLG,TOTCLRFG       CLEAR FIRST TIME FLAG   @Y17XAUU 80853200
         CLC   0(1,R5),TOTSECBK        RUN ALL TEST ASK FOR    @Y17XAUU 80853600
         BH    TCNT56                  YES BRANCH              @Y17XAUU 80854000
         B     TCNT01A                 NO  BRANCH              @Y17XAUU 80854400
NOTFST1  L     R3,TOTSAADR             GET SAVED ADDRESS       @Y17XAUU 80854800
         LA    R3,1(R3)                BUMP ADDRESS            @Y17XAUU 80855200
         AR    R3,R4                   RESTORE ADDRESS         @Y17XAUU 80855600
         B     SAVEONEB                BRANCH                  @Y17XAUU 80856000
TWOBLNK  TM    TOTCRFLG,TOTFTTIM       FIRST TIME THRU         @Y17XAUU 80856400
         BZ    NOTFST2                 NO BRANCH               @Y17XAUU 80856800
         LA    R3,ALPHTABL             GET ALPHBET ADDRESS     @Y17XAUU 80857200
FINDID2  CLC   0(1,R3),TOTOLTTB        FIND TEST ID            @Y17XAUU 80857600
         LA    R3,1(R3)                BUMP ALPHBET ADDRESS    @Y17XAUU 80858000
         BE    SAVEONEC                GO SAVE BUMPED ADDRESS  @Y17XAUU 80858400
         B     FINDID2                 KEEP SEARCHING          @Y17XAUU 80858800
SAVEONEC LR    R1,R4                   GET BASE ADDRESS        @Y17XAUU 80859200
         SR    R3,R1                   COMPUTE OFFSET          @Y17XAUU 80859600
         ST    R3,TOTSAADR             SAVE OFFSET             @Y17XAUU 80860000
         L     R5,TOTSAADR             GET SAVED ADDRESS       @Y17XAUU 80860400
         AR    R5,R4                   COMPUTE ADDRESS         @Y17XAUU 80860800
MOVEID2  MVC   TOTCRALP(1),0(R5)       MOVE TO CURRENT OLT ID  @Y17XAUU 80861200
         MVI   TOTCRFLG,TOTCLRFG       CLEAR FIRST TIME FLAG   @Y17XAUU 80861600
         CLC   0(1,R5),TOTCRSEC        RUN ALL TEST ASK FOR    @Y17XAUU 80862000
         BH    TCNT56                  YES BRANCH              @Y17XAUU 80862400
         B     TCNT01A                 NO BRANCH               @Y17XAUU 80862800
NOTFST2  L     R3,TOTSAADR             GET SAVED ADDRESS       @Y17XAUU 80863200
         LA    R3,1(R3)                BUMP ADDRESS            @Y17XAUU 80863600
         AR    R3,R4                   RESTORE ADDRESS         @Y17XAUU 80864000
         B     SAVEONEC                BRANCH                  @Y17XAUU 80864400
         EJECT                                                 @Y17XAUU 80864800
         IEDQMSG LINK=YES,PREG0=R0                             @Y17XAUU 80865200
         EJECT                                                 @Y17XAUU 80865600
*********************************************************************** 80866000
*********************************************************************** 80866400
*                                                              @Y17XAUU 80866800
*       FIND UCB ROUTINE FOR TNT ENTRIES                       @Y17XAUU 80867200
*                                                              @Y17XAUU 80867600
*********************************************************************** 80868000
*********************************************************************** 80868400
UCBFIND  EQU   *                                               @Y17XAUU 80868800
         ST    R5,UCB5SAVE             SAVE REG                @Y17XAUU 80869200
         ST    R3,UCB3SAVE             SAVE REG                @Y17XAUU 80869600
         SR    R5,R5                   CLEZA REG               @Y17XAUU 80870000
         IC    R5,TOTTTBEL             GET TERMINAL NAME LENGTH@Y17XAUU 80870400
         AR    R5,R8                   GET TTE ADDRESS         @Y17XAUU 80870800
         MVC   TNTENTRY+D1(D3),D0(R5)  ALLINE ADDRESS          @Y17XAUU 80871200
         L     R8,TNTENTRY             GET TTE ADDR            @Y17XAUU 80871600
         USING IEDQTRM,R8                                      @Y17XAUU 80872000
         L     R8,TRMDESTQ-1           GET QCB ADDR            @Y17XAUU 80872400
         DROP  R8                                              @Y17XAUU 80872800
         USING IEDQQCB,R8                                      @Y17XAUU 80873200
         SR    R3,R3                   CLEAR REG               @Y17XAUU 80873600
         IC    R3,QCBRELLN             GET RLN                 @Y17XAUU 80874000
         SLL   R3,2                    MULT BY 4               @Y17XAUU 80874400
         L     R8,QCBDCBAD-1           GET DCB ADDR            @Y17XAUU 80874800
         DROP  R8                                              @Y17XAUU 80875200
         USING IHADCB,R8                                       @Y17XAUU 80875600
         L     R8,DCBDEBAD             GET DEB ADDR            @Y17XAUU 80876000
         DROP  R8                                              @Y17XAUU 80876400
         USING DEBNMSUB,R8                                     @Y17XAUU 80876800
         SR    R15,R15                 CLEAR REG               @Y17XAUU 80877200
         IC    R15,DEBNMEXT            GET # OF EXTENTS        @Y17XAUU 80877600
         SLL   R15,2                   MULT BY 4               @Y17XAUU 80878000
         L     R8,DEBUCBAD-4(R3)       GET UCB ADDR            @Y17XAUU 80878400
         L     R5,UCB5SAVE             RETURN REG              @Y17XAUU 80878800
         L     R3,UCB3SAVE             RESTORE REG             @Y17XAUU 80879200
         B     0(R12)                  BRANCH RETURN           @Y17XAUU 80879600
         EJECT                                                 @Y17XAUU 80880000
DDMOVE   EQU   *                       OPEN PRI DCBS           @Y17XAUU 80880400
GRAPHIC  LA    R9,CVTPTR               GET POINTER TO CVT      @Y17XAUU 80880800
         L     R9,0(R9)                CVT ADDRESS             @Y17XAUU 80881200
         L     R9,0(R9)                TCBPOINTERS ADDRESS     @Y17XAUU 80881600
         L     R9,4(R9)                CURRENT TCB ADDRESS     @Y17XAUU 80882000
         L     R9,12(R9)               TIOT ADDRESS            @Y17XAUU 80882400
         USING TIOT,R9                                         @Y17XAUU 80882800
         LA    R9,TIOENTRY             POINT TO FIRST ENTRY    @Y17XAUU 80883200
         DROP  R9                                              @Y17XAUU 80883600
         USING TIOENTRY,R9                                     @Y17XAUU 80884000
GETLENGT SR    R3,R3                   CLEAR REG               @Y17XAUU 80884400
         IC    R3,TIOELNGH             DD ENTRY LENGTH         @Y17XAUU 80884800
         LTR   R3,R3                   ANY LENGTH              @Y17XAUU 80885200
         BZ    NOTFOUND                NO BRANCH               @Y17XAUU 80885600
         LA    R5,POOLSTAR-TIOESTTB    GET LENGTH OF DEVICE ENTRYS99528 80886000
         DROP  R9                                              @Y17XAUU 80886400
         LR    R6,R3                   SAVE LENGTH             @Y17XAUU 80886800
         SR    R3,R5                   DD LENGTH -4            @Y17XAUU 80887200
         AR    R3,R9                   DEVICE                  @Y17XAUU 80887600
         USING TIOESTTB,R3                                     @Y17XAUU 80888000
         CLC   TIOEFSRT+1(2),ADDOFUCB  COMPARE UCB ADDRESSES FOR        80888400
         DROP  R3                                              @Y17XAUU 80888800
         BE    UCBFOUND                BR WHEN FOUND           @Y17XAUU 80889200
         AR    R9,R6                   BUMP TO NEXT DD ENTRY   @Y17XAUU 80889600
         B     GETLENGT                BRANCH                  @Y17XAUU 80890000
NOTFOUND EQU   *                                               @Y17XAUU 80890400
         B     NOTFOUND                BRANCH                  @Y17XAUU 80890800
UCBFOUND EQU   *                                               @Y17XAUU 80891200
         USING TIOENTRY,R9             TIOT ENTRY BASE         @Y17XAUU 80891600
COMPAREN EQU   *                                               @Y17XAUU 80892000
         CLI   TIOEDDNM,X'40'          IS NAME FIELD BLANK?    @Y17XAUU 80892400
         BNE   MOVEIN                  NO, GO MOVE DDNAME      @Y17XAUU 80892800
         SR    R9,R6                   SET ENTRY TO PRECEDING ONES99528 80893200
         B     COMPAREN                GO LOOK FOR NAME        @Y17XAUU 80893600
MOVEIN   EQU   *                                               @Y17XAUU 80933600
         MVC   EXCPDCB+40(8),TIOEDDNM  MOVE DDNMME TO DCB      @Y17XAUU 80973600
         DROP  R9                                              @Y17XAUU 81013600
         RDJFCB EXCPDCB                                        @Y17XAUU 81053600
         MVI   JFCBAA+53,X'00'         THIS                    @Y17XAUU 81093600
         MVC   JFCBAA+54(12),JFCBAA+53 SECTION                 @Y17XAUU 81133600
         MVI   JFCBAA+67,X'00'         OF CODE                 @Y17XAUU 81173600
         MVC   JFCBAA+68(12),JFCBAA+67 CLEARS                  @Y17XAUU 81213600
         MVI   JFCBAA+88,X'00'         UNUSED                  @Y17XAUU 81253600
         MVC   JFCBAA+89(29),JFCBAA+88 PARTS                   @Y17XAUU 81293600
         MVI   JFCBAA+148,X'00'        OF THE                  @Y17XAUU 81333600
         MVC   JFCBAA+149(25),JFCBAA+148  JFCB                 @Y17XAUU 81373600
         MVI   JFCBAA+52,X'08'         PREVENT REVERSE         @Y17XAUU 81413600
         MVI   JFCBAA+66,X'02'         MERGE AT CLOSE          @Y17XAUU 81453600
         MVC   TOTPRDCB(72),EXCPDCB    MOVE DCB TO OLTCB       @Y17XAUU 81493600
         LA    R1,TOTPRDCB             TEST DCB                @Y17XAUU 81533600
         ST    R1,TOTWKSPC             PUT IN P LIST           @Y17XAUU 81573600
         MVI   TOTWKSPC,X'8F'          OPTION OPEN             @Y17XAUU 81613600
         LA    R1,TOTWKSPC             ADDRESS OF P LIST       @Y17XAUU 81653600
         OPEN  MF=(E,(1)),TYPE=J       OPEN PRIMARY DCB        @Y17XAUU 81693600
         TM    TOTPRDCB+48,X'10'       SUCCESSFUL OPEN?        @Y17XAUU 81733600
         BNO   MOVEIN1                 BRANCH IF ERROR IN OPEN @Y17XAUU 81773600
         L     R3,TOTPRDEB             GET ADDRESS OF DEB      @Y17XAUU 81813600
         LA    R3,D34(R3)              GET ADDRESS OF UCB IN DEB        81853600
         ST    R3,TOT102A              SAVE UCB ADDRESS IN SVC @Y17XAUU 81893600
*                                        102 PARM LIST FOR DATA@Y17XAUU 81933600
*                                        MOVE                  @Y17XAUU 81973600
         LA    R1,TOT102               LOAD ADDRESS OF PARM LIST        82013600
*                                        INTO REG 1            @Y17XAUU 82053600
         AQCTL                         ISSUE DATA MOVE SVC     @Y17XAUU 82093600
         B     0(R12)                  RETURN TO CALLER        @Y17XAUU 82133600
MOVEIN1  EQU   *                                               @Y17XAUU 82173600
         IEDQMSG MSGID=003,FUNCT=CEC,PREG0=R0,PREG1=R1 ERROR MSG        82213600
         OI    TOTFLG06,TOTCANCL       SET CANCEL BIT IN OLTCB @Y17XAUU 82253600
         B     TCNTL11A                GO CANCEL TRM           @Y17XAUU 82293600
**                                                             @Y17XAUU 82333600
RLNLCB   EQU   *                                               @Y17XAUU 82373600
*    IOBBASE ADDRESS PLUS IOBDCB INDEX TIMES RLN MINUS THE     @Y17XAUU 82413600
*        IOB DISPLACEMENT IN THE LCB EQUALS THE LCB ADDRESS    @Y17XAUU 82453600
         L     R8,TNTENTRY             GET TTE ADDRESS         @Y17XAUU 82620000
         USING IEDQTRM,R8              TTE BASE                @Y17XAUU 82710000
         L     R8,TRMDESTQ-1           GET QCB ADDRESS         @Y17XAUU 82800000
         DROP  R8                                              @Y17XAUU 82890000
         USING IEDQQCB,R8              QCB BASE                @Y17XAUU 82980000
         SR    R7,R7                   CLEAR REG               @Y17XAUU 83070000
         IC    R7,QCBRELLN             GET RLN                 @Y17XAUU 83160000
         L     R8,QCBDCBAD-1           GET DCB ADDRESS         @Y17XAUU 83250000
         DROP  R8                                              @Y17XAUU 83340000
         USING IHADCB,R8               DCB BASE                @Y17XAUU 83430000
         SR    R6,R6                   CLEAR REG               @Y17XAUU 83520000
         IC    R6,DCBEIOBX             GET INDEX               @Y17XAUU 83610000
         LR    R9,R7                   SAVE RLN                @Y17XAUU 83700000
         LA    R5,LCBFLAG1-IEDQLCB     GET IOB DISPLACEMENT    @Y17XAUU 83790000
         L     R8,DCBIOBAD             GET IOBBASE ADDRESS     @Y17XAUU 83880000
         DROP  R8                                              @Y17XAUU 83970000
         MR    R6,R7                   RLN TIMES INDEX         @Y17XAUU 84060000
         AR    R6,R8                   RESULTS PLUS BASE       @Y17XAUU 84150000
         SR    R6,R5                   GET LCB ADDRESS         @Y17XAUU 84240000
         ST    R7,TOTPRRLN             PUT RLN AND LCB         @Y17XAUU 84330000
         STC   R9,TOTPRRLN             IN TOTPRENT             @Y17XAUU 84420000
         B     0(R12)                  RETURN                  @Y17XAUU 84510000
         EJECT                                                 @Y17XAUU 84600000
         DS    0F                                              @Y17XAUU 84690000
CDSLINE  DC    CL8'G0000000'           CDS NAME                @Y17XAUU 84780000
DEVADBUF DS    0F                                              @Y17XAUU 84870000
         DC    4CL1'0'                 DEVICE ADDRESS BUFFER   @Y17XAUU 84960000
NCPDCB   DS    F                       3705 DCB ADDR SAVE AREA @XM05808 85000010
SETCLNST DS    0F                      SETS TOTCLNST W/ C&S    @G36XRUV 85010010
         DC    AL1(TOTCLNST)                                   @G36XRUV 85020010
         DC    AL3(0)                                          @G36XRUV 85030010
****************************************************************        85050000
*        PARAMETER LIST FOR DATA MOVE SVC                      *        85140000
****************************************************************        85230000
*                                                              @Y17XAUU 85320000
TOT102   DS    0F                      ALIGNMENT               @Y17XAUU 85410000
         DC    X'08'                   FLAG FOR DATA MOVE      @Y17XAUU 85500000
         DC    AL3(ADDOFUCB)           DATA ADDRESS            @Y17XAUU 85590000
TOT102A  DC    X'00'                   FLAGS                   @Y17XAUU 85680000
         DC    AL3(0)                  TARGET ADDRESS          @Y17XAUU 85770000
         DC    X'80'                   LAST WORD FLAG          @Y17XAUU 85860000
         DC    AL3(TOT102LN)           ADDRESS OF LENGTH FIELD @Y17XAUU 85950000
TOT102LN DC    H'2'                    LENGTH OF UCB ADDRESS MOVES99528 86040000
ADDOFUCB DC    AL3(0)                  UCB ADDRESS             @Y17XAUU 86130000
JFCBAA  DC     CL176'0'                JFCB                    @Y17XAUU 86220000
         DS    0F                      EXIT LIST               @Y17XAUU 86310000
JFCBADDR DC    X'07'                   KEY FOR JFCB            @Y17XAUU 86400000
         DC    AL3(JFCBAA)             ADDRESS OF THE JFCB     @Y17XAUU 86490000
         DC    X'80'                   END OF LIST             @Y17XAUU 86580000
         DC    AL3(0)                  ZEROS                   @Y17XAUU 86670000
MOVENAME MVC   PRINAME(0),0(R8)     MOVE NAME TO PLIST         @Y17XAUU 86760000
PRINAME  DC    CL8' '                  PRIMARY TEST DEVICE NAME@Y17XAUU 86850000
         DS    0F                      BOUNDARY ALLIGNMENT     @Y17XAUU 86940000
TTEADDR  DC    A(0)                    TTE ADDRESS             @Y17XAUU 87030000
EXCPDCB  DCB   DDNAME=DD274E,DSORG=PS,EXLST=JFCBADDR,MACRF=(E),        C87070000
               SIOA=AO,CENDA=AP,XENDA=AP   GRAPHIC APPENDAGES  @Y17XAUU 87210000
EXCP     OPEN  (EXCPDCB,),MF=L                                 @Y17XAUU 87300000
SAVEENT  DC    A(0)                    STATUS SAVE AREA        @Y17XAUU 87390000
***                                                            @Y17XAUU 87480000
***      MESSAGES                                              @Y17XAUU 87570000
***                                                            @Y17XAUU 87660000
UNIT     DC    CL8'        '           NNIT NAME               @Y17XAUU 87750000
UCB5SAVE DC    A(0)                    REG 5 SAVE              @Y17XAUU 87840000
UCB3SAVE DC    A(0)                    REG 3 SEVE              @Y17XAUU 87930000
TRMSAVE3 DS    15F                     SAVE AREA               @Y17XAUU 88020000
ERRCD8   DC    F'8'                    ERROR RETURN CODE       @XM05678 88060010
NAMEMOVE MVC   UNIT(ZERO),ZERO(R1) MOVE NAME                   @Y17XAUU 88110000
TERMIAT  DC    CL8'        '           START TERM MSG ID       @Y17XAUU 88190000
TERMIATE DC    CL26'            UNIT          '  START TERM MSG@Y17XAUU 88270000
NOCOREE  DC    CL8'IED331I '           MESSAGE ID              @Y17XAUU 88350000
NOCORE   DC    CL37'NOT ENOUGH CORE FOR SECTION          ' MSG @Y17XAUU 88430000
NOTLOADD DC    CL8'IED330I '           MESSAGE ID              @Y17XAUU 88510000
NOTLOAD  DC    CL32'OLT MODULE          NOT LOADABLE'    MSG   @Y17XAUU 88590000
ASTRICK  EQU   X'5C'                   ASTERICK                @Y17XAUU 88670000
TEE      EQU   X'E3'                   T                       @Y17XAUU 88750000
S        EQU   X'E2'                   S                       @Y17XAUU 88830000
INITSTAT DC    X'00'                   INITAL STATUS BYTE      @Y17XAUU 88910000
APSTIME  DC    X'00'                   AP STIMER FLAG          @Y17XAUU 88990000
APSTIMER EQU   X'80'                   STIMER FOR AP           @Y17XAUU 89070000
ALPHTABL DC    CL26'ABCDEFGHIJKLMNOPQRSTUVWXYZ'     TABLE      @Y17XAUU 89150000
ENDALTAB DC    X'EA'                   PAST ALPHBET            @Y17XAUU 89230000
STARTID  DC    CL8'IED333I '           START ID                @Y17XAUU 89310000
TERMID   DC    CL8'IED334I '           TERM ID                 @Y17XAUU 89390000
         DS    0D                      DOUBLE WORD ALLINE      @Y17XAUU 89470000
NAMESAVE DC    CL8' '                  TEST DEV GROUP NAME     @Y17XAUU 89550000
PATCH    DC    CL100' '                PATCH AREA              @Y17XAUU 89630000
BLDLLIST DS    0F                 BLDL P-LIST                  @Y17XAUU 89822000
         DC    XL2'0001'          NUMBER OF LIST ENTRIES       @Y17XAUU 89824000
         DC    XL2'003A'          LENGTH OF EACH ENTRY         @Y17XAUU 89826000
READNAME DC    8XL1'40'           MODULE ID                    @Y17XAUU 89828000
         DC    XL16'0'            ADDITIONAL DIRECTORY INFO    @Y17XAUU 89830000
BLDLNAM  DC    XL3'0'             MAIN STORAGE NEEDED          @Y17XAUU 89832000
         DC    XL31'0'            ADDITIONAL DIRECTORY INFO    @Y17XAUU 89834000
WORKA    DC    X'000F'            USED FOR CONVERSION          @Y17XAUU 89836000
         EJECT                                                 @Y17XAUU 89838000
KTRM     DS    0F                 *** DO NOT INSERT BETWEEN *'S@Y17XAUU 89840000
TERNMTAB DS    A                  TERMNAME TABLE ADDRESS       @Y17XAUU 89842000
TNTENTRY DS    A                  TERMNAME ENTRY ADDRESS       @Y17XAUU 89843000
TRMQCB   DS    A                  CT/AP QCB ADDRESS            @Y17XAUU 89844000
TRMTNT   DS    A                  CT/AP TNT ADDRESS            @Y17XAUU 89845000
TRMSAVE1 DS    3F                 REGISTERS SAVE AREA          @Y17XAUU 89846000
TRMSAVE2 DS    5F                 REGISTERS SAVE AREA          @Y17XAUU 89847000
TRMSAV1  DS    3F                 REGISTERS SAVE AREA          @Y17XAUU 89848000
REGSAVE  DS    F                  WORK AREA                    @Y17XAUU 89849000
F32      DC    F'32'              VALUE OF 32                  @Y17XAUU 89850000
KPQCB    DS    A                  TRUE P-QCB ADDRESS           @Y17XAUU 89858200
KMQCB    DS    A                  DUMMY M-QCB ADDRESS          @Y17XAUU 89858400
CONCTTE  DS    A                  TRUE CONC TERM TTE ADDRESS   @Y17XAUU 89858600
KDRQ     DS    A                  TRUE DRQ ADDRESS             @Y17XAUU 89858800
KPQCBSZ  DS    H                  P-QCB SIZE                   @Y17XAUU 89859000
KMQCBSZ  DS    H                  M-QCB SIZE                   @Y17XAUU 89859200
KDRQSZ   DS    H                  DRQ SIZE                     @Y17XAUU 89859400
TTETSZ   DS    CL1                CONC TERM TTE SIZE           @Y17XAUU 89859600
TTECSZ   DS    CL1                CONC TTE SIZE                @Y17XAUU 89859800
TRMRQFLG DS    CL1                DUMMY TNT REQUEST FLAG       @Y17XAUU 89860000
CTREQ    EQU   X'80'              CT REQUEST                   @Y17XAUU 89862000
APREQ    EQU   X'40'              AP REQUEST                   @Y17XAUU 89864000
PRREQ    EQU   X'20'              PRIMARY TD REQUEST           @Y17XAUU 89866000
SCREQ    EQU   X'10'              SECONDARY TD REQUEST         @Y17XAUU 89868000
ALRDY    EQU   X'00'              COUNTERFEIT STORAGE ALREADY  @Y17XAUU 89870000
*                                 EXIST FOR THIS REQUEST       @Y17XAUU 89872000
TRMFLG01 DS    CL1                CONTROL FLAG                 @Y17XAUU 89874000
CONC     EQU   X'80'              TERMINAL ATTACHED TO CONC    @Y17XAUU 89876000
TRMSPAS  EQU   X'40'              PROCESS CONC TTE             @Y17XAUU 89878000
TRMQWB3  EQU   X'20'              SECOND PASS FUNCTION         @Y17XAUU 89880000
TRMRNLU  EQU   X'10'              SNA LU ENTRY                 @Y17XAUU 89882000
TRMDELY  EQU   X'08'              QCB IN TIME DELAY QUEUE      @Y17XAUU 89884000
TRM3705  EQU   X'04'              3705 MODE                    @Y17XAUU 89886000
TRMCTEAP EQU   X'02'              CT EQU AP                    @Y17XAUU 89888000
WRKFLG   DS    CL1                WORK AREA                    @Y17XAUU 89890000
KTRMEND  DS    0C                 END OF KTRM DSECT            @Y17XAUU 89892000
************************************************************** @Y17XAUU 89894000
         EJECT                                                 @Y17XAUU 90090000
         TLCBD                                                 @Y17XAUU 90170000
         EJECT                                                 @Y17XAUU 90250000
UCB      DSECT LIST=YES                                        @Y17XAUU 90330000
         IEFUCBOB                                              @Y17XAUU 90410000
         EJECT                                                 @Y17XAUU 90490000
RESPL    RESPL EQUATES=YES                                     @Y17XAUU 90570000
         EJECT                                                 @Y17XAUU 90650000
         OLTCB                         OLTCB CONTROL BLOCK     @Y17XAUU 90730000
         EJECT                                                 @Y17XAUU 90810000
         TLGBD                         LGB                     @Y17XAUU 90890000
TCNTBLDL EQU   TOTWKSPC                                        @Y17XAUU 90970000
TCNTBECT EQU   TCNTBLDL+1                                      @Y17XAUU 91050000
TCNTBELN EQU   TCNTBLDL+3                                      @Y17XAUU 91130000
TCNTMDNM EQU   TCNTBLDL+4                                      @Y17XAUU 91210000
TCNTMDSZ EQU   TCNTBLDL+28                                     @Y17XAUU 91290000
TEMPSAVE EQU   TOTWKSPC+8              WORK AREA               @Y17XAUU 91370000
         EJECT                                                 @Y17XAUU 91450000
         TDEBD                                                 @Y17XAUU 91530000
         EJECT                                                 @Y17XAUU 91610000
PLNKPREF DSECT                                                 @Y17XAUU 91690000
PLNKNAME DS    CL8                     OLT NAME                @Y17XAUU 91770000
         ORG   PLNKPREF+10             TO POINTER              @Y17XAUU 91850000
PLNKMPTR DS    CL2                     POINTER                 @Y17XAUU 91930000
         SPACE 5                                               @Y17XAUU 92010000
PLNKQPTR DSECT                                                 @Y17XAUU 92090000
PLNKQFWD DS    F                       FORWARD POINTER         @Y17XAUU 92170000
PLNKQBKD DS    F                       BACK POINTER            @Y17XAUU 92250000
         EJECT                                                 @Y17XAUU 92330000
DCBDSECT DCBD  DSORG=TX                                        @Y17XAUU 92410000
          TQCBD                                                @Y17XAUU 92490000
CVT      DSECT                                                 @Y17XAUU 92570000
         CVT                                                   @Y17XAUU 92650000
TIOT     DSECT                                                 @Y17XAUU 92730000
         IEFTIOT1                                              @Y17XAUU 92810000
         EJECT                                                 @Y17XAUU 92890000
         TTRMD                                                 @Y17XAUU 92970000
         EJECT                                                 @Y17XAUU 93050000
         TAVTD                                                 @Y17XAUU 93130000
         EJECT                                                 @Y17XAUU 93210000
         TTCDSD                                                @Y17XAUU 93570000
         END                                                            93600000
./  ADD  SSI=63630069,NAME=IEDQWEC
         TITLE ' IEDQWEC  TOTE CONCENTRATOR MODULE'                     00200022
IEDQWEC  CSECT                                                   S22024 00400010
* CHANGE ACTIVITY AS FOLLOWS:                                           00600022
* A000000-999999                                                SA41597 00800022
* A170600-171200,A210200-211400,C318000,C352000,C364000,C378000  S22024 00840010
* C398000,C402000,C406000,C410000,C426000,C430000,C434000        S22024 00880010
* C438000,C446000,C450000,C454000,C458000,C508000,C514000,C520000S22024 00920010
* C526000,C530000,C602000,C606000,A614000,C686000,C690000,C704000S22024 00960010
****************************************************************        01000022
* DESCRIPTIVE NAME:  TOTE CONCENTRATOR MODULE                  *        01200022
*                                                              *        01400022
* TITLE: IEDQWEC - TOTE CONCENTRATOR MODULE                             01600022
*                                                                       01800022
* MODULE NAME: IEDQWEC                                         *        02000022
*                                                              *        02200022
* STATUS:      CHANGE LEVEL 0                                  *        02400022
*                                                              *        02600022
* ENTRY POINT: IEDQWEC CALLED BY IEDQWCZ OR IEDQWJZ FOR        *        02800022
*                      INITIAL SET UP                          *        03000022
*              IEDQWEC CALLED BY IEDQWE FOR CLEAN UP           *        03200022
*                                                              *        03400022
* FUNCTIONS:   THE PURPOSE OF THIS MODULE IS TO CHECK EACH     *        03600022
*              TEST DEVICE TO SEE IF IT IS ON A CONCENTRATOR.  *        03800022
*              IF THE TEST DEVICE IS ON A CONCENTRATOR         *        04000022
*              RECORD THE ORIGINAL STATUS OF THE CONCENTRATOR. *        04200022
*                                                              *        04400022
*              WHEN ENTERED FOR CLEAN UP - RESTORE THE         *        04600022
*              CONCENTRATOR TO THE ORIGINAL STATUS.            *        04800022
*                                                              *        05000022
* INPUT:  REGISTER 02,13,14,15 CONTAIN THE FOLLOWING VALUES:   *        05200022
*                                                              *        05400022
*               02-OLTCB POINTER                               *        05600022
*               13-SAVE AREA ADDRESS                           *        05800022
*               14-RETURN ADDRESS                              *        06000022
*               15-ENTRY POINT ADDRESS                         *        06200022
*                                                              *        06400022
* OUTPUT: REG 02-OLTCB                                         *        06600022
*                                                              *        06800022
* EXTERNAL ROUTINES: IEDQWK - TOTE MESSAGE MODULE              *        07000022
*                                                              *        07200022
* EXIT POINTS: XCTL TO IEDQWD AFTER INITIAL SET UP             *        07400022
*              BRANCH RETURN TO IEDQWA -TOTE MOTHER TASK       *        07600022
*               AFTER CLEAN UP.                                *        07800022
*                                                              *        08000022
* TABLES/WORK AREAS:                                           *        08200022
*                                                              *        08400022
*       OLTCB,TNT,TTE,QCB                                      *        08600022
*                                                              *        08800022
* ATTRIBUTES:                                                  *        09000022
*                                                              *        09200022
*       ENABLED,PROBLEM PROGRAM MODE,TRANSIENT                 *        09400022
*                                                              *        09600022
* COPYRIGHT='NONE'                                             *        09800022
*                                                              *        10000022
****************************************************************        10200022
         EJECT                                                          10400022
****************************************************************        10600022
*                                                              *        10800022
*        REGISTER EQUATES AND EQUATES                          *        11000022
*                                                              *        11200022
****************************************************************        11400022
R0       EQU   0                        REG 0                           11600022
R1       EQU   1                        REG 1                           11800022
R2       EQU   2                        REG 2                           12000022
R3       EQU   3                        REG 3                           12200022
R4       EQU   4                        REG 4                           12400022
R5       EQU   5                        REG 5                           12600022
R6       EQU   6                        REG 6                           12800022
R7       EQU   7                        REG 7                           13000022
R8       EQU   8                        REG 8                           13200022
R9       EQU   9                        REG 9                           13400022
R10      EQU   10                       REG 10                          13600022
R11      EQU   11                       REG 11                          13800022
R12      EQU   12                       REG 12                          14000022
R13      EQU   13                       REG 13                          14200022
R14      EQU   14                       REG 14                          14400022
R15      EQU   15                       REG 15                          14600022
D0       EQU   0                        DISPLACEMENT 0                  14800022
D1       EQU   1                        DISPLACEMENT 1                  15000022
D4       EQU   4                        DISPLACEMENT 4                  15200022
D8       EQU   8                        DISPLACEMENT 8                  15400022
D12      EQU   12                       TWELVE                          15600022
STRTTERM EQU   X'45'                    START TERMINAL VERB CODE        15800022
STOPTERM EQU   X'47'                    STOP TERMINAL CODE              16000022
HOLDTERM EQU   X'88'                    HOLD TERMINAL CODE              16200022
ACTVTERM EQU   X'46'                    ACTIVATE TERMINAL CODE          16400022
REALTERM EQU   X'87'                    REALEASE TERMINAL CODE          16600022
INACTERM EQU   X'48'                    INACTIVATE TERMINAL CODE        16800022
X40      EQU   X'40'                    BLANK                           17000022
X0C      EQU   X'0C'                   START FLAG                S22024 17060010
X80      EQU   X'80'                   END FLAG                  S22024 17120010
D7       EQU   7                        SEVEN                           17200022
D3       EQU   3                        THREE                           17400022
D2       EQU   2                        TWO                             17600022
RT0      EQU   X'00'                    RETURN CODE ZERO                17800022
RT8      EQU   X'08'                    RETURN CODE EIGHT               18000022
         EJECT                                                          18200022
****************************************************************        18400022
*                                                              *        18600022
*        STANDARD LINKAGE                                      *        18800022
*                                                              *        19000022
****************************************************************        19200022
         SAVE  (14,12)                  SAVE REGS                       19400022
         USING TOTOLTCB,R2              TOTE CONTROL BLOCK              19600022
         LR    R4,R15                   ESTABLISH BASE REG              19800022
         USING IEDQWEC,R4               IEDQWEC                         20000022
         ST    R13,TOTSAVE4+D4          SAVE CALLERS SAVE ADDR          20200022
         LR    R12,R13                  MY SAVE                         20400022
         LA    R13,TOTSAVE4             AREA ADDRESS                    20600022
         ST    R13,D8(R12)              IN CALLERS SAVE AREA            20800022
IEDQWEC  IEDHJN IEDQWECC,HJN            NAME AND HJN                    21000022
         MVI   TOTOLADR,X40            BLANK OUT                 S22024 21020010
         MVC   TOTOLADR+D1(D7),TOTOLADR  NAME                    S22024 21040010
         LA    R1,TOTPLIST             P LIST ADDR               S22024 21060010
         ST    R1,CBSLPL               TO SVC 102 FIRST          S22024 21080010
         ST    R1,CBSLPL+D4            AND LAST                  S22024 21100010
         MVI   CBSLPL,X0C              START                     S22024 21120010
         MVI   CBSLPL+D4,X80           END FLAGS                 S22024 21140010
         EJECT                                                          21200022
         LA    R3,TOTTDTBL              TEST DEV TABLE ADDR             21400022
         LA    R5,TOTTDEND              END OF TABLE ADDRESS            21600022
         LA    R11,TOTCONTB             ADDRESS OF CONCENTRATOR         21800022
         TM    TOTTDTBL,TOTTDLIN        TEST DEVICES LINES              22000022
         BO    CONTROLC                 YES BRANCH                      22200022
*                                       INITIAL STATUS TABLE            22400022
LOOP     EQU   *                                                        22600022
         CR    R3,R5                    ALL ENTRIES PROCESSED           22800022
         BE    CONTROLC                 CKECK CONTROL TERM              23000022
         L     R8,D0(R3)                GET TNT ENTRY                   23200022
         LA    R8,D0(R8)                CLEAR HI BYTE                   23400022
         LTR   R8,R8                    ANY ADDRESS                     23600022
         BZ    CONTROLC                 CKECK CONTROL TERM              23800022
CTAP     EQU   *                                                        24000022
         BAL   R12,TNTALINE             GO GET TTE ADDRESS              24200022
         USING IEDQTRM,R6               TTE                             24400022
         TM    TRMDEVFL+D1,TRMCONC      TERMINAL ON A CONC              24600022
         BZ    BUMPCONC                 NO BRANCH                       24800022
         L     R6,TRMDESTQ-D1           GET QCB ADDRESS                 25000022
         DROP  R6                       TTE                             25200022
         USING IEDQQCB,R6               QCB                             25400022
         LH    R7,QCBEXTO               OFFSET TO EXTENSION             25600022
         DROP  R6                       QCB                             25800022
         AR    R6,R7                    GET ADDR OF                     26000022
         USING IEDQQCBE,R6              QCBE                            26200022
         L     R6,QCBECONC-D1           ADDR OF CONC TTE                26400022
         DROP  R6                       QCBE                            26600022
         LA    R6,0(R6)                 CLEAR HI BYTE                   26800022
*                                       CHECK TO SEE IF THIS            27000022
*                                       CONCENTRATOR ENTRY HAS          27200022
*                                       ALREADY BEEN PROCESSED          27400022
         LA    R9,CONTTES               SAVE AREA FOR TTES              27600022
CONC1    EQU   *                                                        27800022
         L     R7,D0(R9)                GET TTE                         28000022
         LTR   R7,R7                    IS THERE ONE                    28200022
         BNZ   CONC2                    YES BRANCH                      28400022
         ST    R6,D0(R9)                SAVE CURRENT TTE                28600022
         ST    R6,CONTTE                SAVE TTE                        28800022
         B     CONC3                    CONTINUE                        29000022
CONC2    EQU   *                                                        29200022
         CLC   D0(D4,R7),D0(R6)         HAS CURRENT TTE ALREADY         29400022
*                                       BEEN PROCESSED                  29600022
         BE    BUMPCONC                 YES BRANCH                      29800022
         LA    R9,D4(R9)                BUMP SAVE POINTER               30000022
         B     CONC1                    LOOK AGAIN                      30200022
*                                       THIS ROUTINE FINDS THE          30400022
*                                       NAME OF THE CONC FROM           30600022
*                                       THE TTE                         30800022
CONC3    EQU   *                                                        31000022
         L     R7,TOTAVTPT              GET AVT POINTER                 31200022
         USING IEDQAVTD,R7              AVT                             31400022
         LA    R1,AVTOPCOB              GET OP CONTROL QCB              31600022
         ST    R1,TOTOKEY              PUT IN P-LIST             S22024 31800010
         L     R7,AVTRNMPT              GET TNT TABLE ADDRESS           32000022
         USING IEDQTNTD,R7              TNT TABLE                       32200022
         LH    R1,TNTLEN                GET NUMBER OF ENTRIES           32400022
         LA    R7,TNTFIRST              GET FIRST ENTRY ADDRESS         32600022
         DROP  R7                       TNT TABLE                       32800022
         SR    R9,R9                    CLEAR REG                       33000022
         IC    R9,TOTTTBEL              GET NAME LENGTH                 33200022
         LA    R10,D3(R9)               LENGTH OF ONE ENTRY             33400022
         AR    R7,R9                    FIRST TTE ADDRESS               33600022
CONC4    EQU   *                                                        33800022
         CLC   D0(D3,R7),CONTTE+D1      CONC ENTRY FOUND                34000022
         BE    CONC5                    YES BRANCH                      34200022
         AR    R7,R10                   NEXT TTE ADDRESS                34400022
         BCT   R1,CONC4                 CHECK NEXT ENTRY                34600022
*                                                                       34800022
*                                                                       35000022
BAD      B     BSTOP                   SEND MESSAGE              S22024 35200010
CONC5    EQU   *                                                        35400022
         SR    R7,R9                    POINT TO NAME                   35600022
         BCTR  R9,R0                    DECREMENT FOR EX                35800022
         EX    R9,NAMEMOVE              NAME TO P-LIST                  36000022
         LA    R1,TOTOTECB              GET TOTE ECB ADDRESS            36200022
         ST    R1,TOTOECBA             PUT IN P-LIST             S22024 36400010
         USING IEDQTRM,R6               TTE                             36600022
         L     R6,TRMDESTQ-D1           GET QCB                         36800022
         DROP  R6                       TTE                             37000022
         USING IEDQQCB,R6               QCB                             37200022
         SR    R1,R1                    CLEAR REG                       37400022
         IC    R1,QCBRELLN              GET RLN                         37600022
         STC   R1,TOTORLN              RLN TO P-LIST             S22024 37800010
         TM    TOTFLG02,TOTCONCU        ENTRY FOR CLEAN UP              38000022
         BO    CONCLUP                  YES BRANCH                      38200022
****************************************************************        38400022
*                                                                       38600022
*       RECORD ORIGINAL STATUS OF CONCENTRATOR                          38800022
*                                                                       39000022
****************************************************************        39200022
         TM    QCBSTAT,QCBTRMHO         CONC INITIALLY HELD             39400022
         BZ    CONCNOTH                 NO BRANCH                       39600022
         MVI   TOTOVBCD,INACTERM       VERB TO INACTIVATE        S22024 39800010
         BAL   R12,CONCOPC              GO INACTIVATE CONC              40000022
         CLI   TOTORTCD,RT0            OK                        S22024 40200010
         BE    CONCSPT                  YES BRANCH                      40400022
         CLI   TOTORTCD,RT8            CONC ALREADY INACTIVE     S22024 40600010
         BE    CONCARIA                 YES BRANCH                      40800022
BAD1     B     BSTOP                   SEND MESSAGE              S22024 41000010
CONCARIA EQU   *                        THEREFOR CONC STOPPED           41200022
         OI    D0(R11),TOTCSTOP         SET STOPPED BIT                 41400022
         B     BUMPCONC                 CONTINUE THRU DEVICES           41600022
CONCSPT  EQU   *                        THEREFOR CONC HELD              41800022
         OI    D0(R11),TOTCHELD         SET HELD BIT                    42000022
         B     BUMPCONC                 CONTINUE THRU DEVICES           42200022
CONCNOTH EQU   *                        NOT HELD                        42400022
         MVI   TOTOVBCD,INACTERM       VERB TO INACTIVATE        S22024 42600010
         BAL   R12,CONCOPC              GO INACTIVATE                   42800022
         CLI   TOTORTCD,RT0            OK                        S22024 43000010
         BE    CONCSTPP                 YES BRANCH                      43200022
         CLI   TOTORTCD,RT8            ALREADY INACTIVE          S22024 43400010
         BE    CONCINAC                 YES BRANCH                      43600022
BAD2     B     BSTOP                   SEND MESSAGE              S22024 43800010
CONCINAC EQU   *                        THEREFOR INACTIVE               44000022
         OI    0(R11),TOTCINAC          SET INACTIVE BIT                44200022
CONCSTPP EQU   *                                                        44400022
         MVI   TOTOVBCD,STOPTERM       VER TO STOP               S22024 44600010
         BAL   R12,CONCOPC              GO STOP CONC                    44800022
         CLI   TOTORTCD,RT0            OK                        S22024 45000010
         BE    BUMPCONC                 YES BRANCH                      45200022
         CLI   TOTORTCD,RT8            OK                        S22024 45400010
         BE    BUMPCONC                 YES BRANCH                      45600022
BAD3     B     BSTOP                   SEND MESSAGE              S22024 45800010
BUMPCONC EQU   *                        BUMP ALL POINTERS               46000022
         LA    R11,D1(R11)              INIT STATUS TABLE PTR           46200022
         TM    CONCFLGS,CONCCTAP        ONLY CONTROL TERM BEEN          46400022
*                                       CHECKED                         46600022
         BM    APCONCCK                 YES BRANCH                      46800022
         TM    CONCFLGS,CONCAPCK        AP BEEN CHECKED                 47000022
         BO    EXIT                     YES BRANCH                      47200022
         LA    R3,D4(R3)                TEST DEVICE PTR                 47400022
         B     LOOP                     CHECK ALL ENTRIES               47600022
         EJECT                                                          47800022
****************************************************************        48000022
*                                                              *        48200022
*       IF ENTRY FOR CLEAN UP THIS SECTION RETURNS THE         *        48400022
*       CONCENTRATORS TO THEIR ORIGINAL STATUS                 *        48600022
*                                                              *        48800022
****************************************************************        49000022
CONCLUP  EQU   *                                                        49200022
         TM    D0(R11),TOTCSTOP         CONC INIT STOPPED               49400022
         BO    BUMPCONC                 YES BRANCH NOTHING              49600022
*                                       NEED BE DONE                    49800022
         TM    D0(R11),TOTCSTRT         CONC INIT STARTED               50000022
         BZ    STCONC                   YES BRANCH                      50200022
         TM    D0(R11),TOTCHELD         CONC INIT HELD                  50400022
         BO    CAVTCONC                 YES BRANCH                      50600022
         MVI   TOTOVBCD,REALTERM       VERB TO REALEASE          S22024 50800010
         B     ORIGCONC                 BRANCH                          51000022
CAVTCONC EQU   *                                                        51200022
         MVI   TOTOVBCD,ACTVTERM       VERB TO ACTIVATE          S22024 51400010
         B     ORIGCONC                 BRANCH                          51600022
STCONC   EQU   *                                                        51800022
         MVI   TOTOVBCD,STRTTERM       VERB TO START             S22024 52000010
ORIGCONC EQU   *                                                        52200022
         BAL   R12,CONCOPC              GO RETURN CONC                  52400022
         CLI   TOTORTCD,RT0            OK                        S22024 52600010
         BE    BUMPCONC                 YES BRANCH                      52800022
         CLI   TOTORTCD,RT8            OK                        S22024 53000010
         BE    BUMPCONC                 YES BRANCH                      53200022
*                                                                       53400022
*       CAN NOT RETURN CONCENTRATOR TO ORIGINAL STATUS                  53600022
*                                                                       53800022
BSTOP    EQU   *                                                        54000022
         WTO   'IED154I TOTE CANNOT RETURN DEVICE          TO ORIGINAL C54200022
               STATUS',ROUTCDE=10,DESC=7                                54400022
MESSAGE  EQU   BSTOP+43                 CONC NAME                       54600022
         B     BUMPCONC                 CONTINUE                        54800022
EXIT     EQU   *                        EXIT ROUTINE                    55000022
         L     R13,D4(R13)              GET CALLERS SAVE ADDR           55200022
         TM    TOTFLG02,TOTCONCU        ENTRY FOR CLEAN UP              55400022
         BO    CLUPEXIT                 YES BRANCH                      55600022
         OI    TOTFLG02,TOTCONCU        CLEAN UP REQUIRED               55800022
         XCTL  (2,12),EP=IEDQWD         GO TO IEDQWD                    56000022
CLUPEXIT EQU   *                                                        56200022
*                                                                       56400022
*       RETURN TO RESIDENT MODULE                                       56600022
*                                                                       56800022
         LM    R14,R12,D12(R13)         RESTORE REGS                    57000022
         SR    R15,R15                  GOOD RETURN                     57200022
         BR    R14                      GO TO IEDQWA                    57400022
TNTALINE EQU   *                        THIS ROUTINE ALINES             57600022
*                                       THE TTE ADDRESS                 57800022
         LR    R9,R8                    SAVE TNT POINTER                58000022
         SR    R10,R10                  CLEAR REG                       58200022
         IC    R10,TOTTTBEL             GET NAME LENGTH                 58400022
         AR    R9,R10                   POINT TO TTE ADDRESS            58600022
         MVC   TTEADDR+D1(D3),D0(R9)    ALLINE ADDRESS                  58800022
         L     R6,TTEADDR               GET TTE ADDRESS                 59000022
         BR    R12                      RETURN                          59200022
*                                                                       59400022
*       OP CONTROL INTERFACE ROUTINE                                    59600022
*                                                                       59800022
CONCOPC  EQU   *                                                        60000022
         XC    TOTOLINK(D3),TOTOLINK   CLEAR LINK FIELD          S22024 60200010
         XC    TOTOTECB,TOTOTECB        CLEAR ECB                       60400022
         MVI   TOTORTCD,D0             CLEAR RETURN CODE         S22024 60600010
         LA    R1,CBSLPL                GET P-LIST ADDRESS              60800022
         AQCTL                          POST ELE TO OP CONTROL          61000022
         WAIT  ECB=TOTOTECB             WAIT FOR COMPLETION             61200022
         MVC   MESSAGE(D8),TOTOLADR    MOVE NAME TO MESSAGE      S22024 61400010
         BR    R12                      RETURN                          61600022
CONTROLC EQU   *                                                        61800022
         OI    CONCFLGS,CONCCTCK        CKECK MADE FOR CT               62000022
         L     R8,TOTCRTNT              GET CONTROL TERM ENTRY          62200022
         LA    R8,D0(R8)                ZERO HI BYTE                    62400022
         LTR   R8,R8                    IS THERE ONE                    62600022
         BZ    APCONCCK                 NO BRANCH                       62800022
         B     CTAP                     GO CHECK CONRROL TERM           63000022
APCONCCK EQU   *                                                        63200022
         OI    CONCFLGS,CONCAPCK        INDICATE AP CHECK               63400022
         L     R8,TOTARTNT              GET AP ENTRY                    63600022
         LA    R8,D0(R8)                ZERO HI BYTE                    63800022
         LTR   R8,R8                    IS THERE ONE                    64000022
         BZ    EXIT                     NO BRANCH                       64200022
         B     CTAP                     GO CHECK AP                     64400022
         EJECT                                                          64600022
*       PARAMETER LIST FOR SVC 102                                      67800022
*                                                                       68000022
CBSLPL   DS    0F                       ALLINE                          68200022
         DC    X'0C'                    START                           68400022
         DC    AL3(0)                  FIRST                     S22024 68600010
         DC    X'80'                    FLAG END                        68800022
         DC    AL3(0)                  LAST                      S22024 69000010
*                                                                       69200022
*                                                                       69400022
TTEADDR  DC    A(0)                     TTE ADDRESS                     69600022
CONTTES  DC    40X'0'                   SAVE AREA FOR 10 CONC           69800022
*                                       TTES                            70000022
CONTTE   DC    A(0)                     CURRENT TTE SAVE                70200022
NAMEMOVE MVC   TOTOLADR(D0),D0(R7)     NAME TO P-LIST            S22024 70400010
CONCFLGS DC    AL1(0)                   PATH FLAGS                      70600022
CONCCTCK EQU   X'80'                    CONTROL TERM CHECK              70800022
CONCAPCK EQU   X'40'                    AP TERM CHECK                   71000022
CONCCTAP EQU   X'C0'                    CT AND AP CHECK                 71200022
PATCH    DS    CL100                    PATCH AREA                      71400022
         EJECT                                                          71600022
         TTNTD                          TNT                             71800022
         EJECT                                                          72000022
         TTRMD                          TTE                             72200022
         EJECT                                                          72400022
         TAVTD                          AVT                             72600022
         EJECT                                                          72800022
         TLCBD                          LCB                             73000022
         EJECT                                                          73200022
         CVT                            CVT                             73400022
         EJECT                                                          73600022
         TQCBD                          QCB                             73800022
         TQCBED                         QCBE                            74000022
         EJECT                                                          74200022
         OLTCB                          OLTCB                           74400022
         END                                                            74600022
./  ADD  SSI=81290397,NAME=IEDQWE2
         TITLE 'IEDQWE2  TOTE CLEAN UP MODULE     '              S22024 00090000
IEDQWE2  CSECT                                                   S22024 00180000
*A000000-999999                                                @Y16X5U0 00185000
* CHANGE ACTIVITY AS FOLLOWS:                                    S22024 00210000
* A000000-999999                                                 S22024 00240000
*A301200,340600,321360-322020,420020-420220,424300,506240-506640 S05331 00250000
*A510700,569170-569190,569540-569560,625800-626100,863005-863025 S05331 00255000
*D299700,702900-708300                                           S05331 00260000
*A105600-105900,175700-176100,255650-256350                      Y06330 00262005
*C300300,301000,305500,420000,506200,862600                      S05331 00265000
*C521100                                                       @SA74550 00267058
*A125100,204600,285300,420040,506280,569040,569460,733500      @Y17XAUU 00267600
*A760500,844200                                                @Y17XAUU 00268200
*C569190,569560,672300-673200,675000,791100                    @Y17XAUU 00268800
*D762300-784800                                                @Y17XAUU 00269400
* A002694,175600,365400,387900,395820,420084,420100,447240,    @XM05672 00269500
* A458100,506352,506400,863025                                 @XM05672 00269600
* C395820,447240                                               @XM05672 00269700
* D120600-121500,122420-123020,175610-175640,366300,531700     @XM05672 00269800
* A420220,436500,472500,506640,545400,548100                   @G36XRUV 00269900
* C420300,437400,473400,506700,546300,549000                   @G36XRUV 00289900
*A108000,620100,651600,834300                                  @OY20578 00290082
* A164700,196200                                               @OY20828 00290182
* C166500                                                      @OY20828 00290282
*                                                                       00309900
*********************************************************************** 00329900
*                                                               S22024* 00360000
*                                                               S22024* 00400000
* MODULE NAME:                                                  S22024* 00410000
*                                                               S22024* 00420000
*    IEDQWE2 (TCAM,TOTE)                                       @Y17XAUU 00430000
*                                                               S22024* 00440000
* DESCRIPTIVE NAME:                                             S22024* 00450000
*                                                               S22024* 00460000
*    TOTE CLEANUP MODULE                                        S22024* 00470000
*                                                               S22024* 00480000
* COPYRIGHT:                                                    S22024* 00490000
*                                                               S22024* 00500000
*    'NONE'                                                     S22024* 00510000
*                                                               S22024* 00520000
* STATUS:                                                       S22024* 00530000
*                                                               S22024* 00540000
*    VERSION 10.0                                              @Y17XAUU 00550000
*                                                                     * 00720000
* ENTRY POINT:                                                        * 00810000
*                                                                     * 00900000
*    IEDQWE2                                                   @Y17XAUU 00990000
*                                                              @Y17XAUU 00991000
* LINKAGE: XCTL'ED FROM IEDQWE                                 @Y17XAUU 00992000
*                                                              @Y17XAUU 00993000
* PURPOSE: SEE FUNCTION                                        @Y17XAUU 00994000
*                                                               S22024* 01030000
* FUNCTIONS:                                                          * 01080000
*                                                                     * 01170000
*    THE PURPOSE OF THIS MODULE IS TO:                          S22024* 01260000
*    1. GO TO IEDQWAJ FOR $CUTEST CLEANUP IF THE OLT HAS ISSUED S22024* 01320000
*        $CUTEST DURNING HIS RUN                                S22024* 01380000
*    2. IF THE CONTORL TERMINAL OR ALTERNATE PRINTER IS ON A    S22024* 01440000
*        270X WAIT UNTIL TCAM HAS SENT ALL MESSAGES SHIPPED BY  S22024* 01500000
*        TOTE                                                   S22024* 01560000
*    3. RESTORE ALL DEVICES USED BY TOTE ( CONTROL TERMINAL,    S22024* 01620000
*        ALTERNATE PRINTER, AND ALL TEST DEVICES) TO THEIR      S22024* 01680000
*        ORIGINAL STATUS IN THE EYES OF TCAM                    S22024* 01740000
*    4. DEQ ALL DEVICES USED BY TOTE                            S22024* 01800000
*    5. CLOSE THE PRIMARY AND SECONDARY DCB'S IF LEFT OPEN      S22024* 01860000
*    6. INSURE ALL DEVICES USED BY TOTE ARE RETURNED TO TCAM    S22024* 01920000
*    7. IF ANY OF THE DEVICES USED BY TOTE IS ON A CONCENTRATOR S22024* 01980000
*        XCTL   TO IEDQWEC FOR CONCENTRATOR CLEANUP OTHERWISE   S22024* 02040000
*        RETURN TO TOTE'S RESIDENT MODULE IEDQWA                S22024* 02100000
*                                                                     * 02260000
* INPUT:                                                              * 02360000
*                                                                     * 02460000
*    REGISTER 02,13,14,15 CONTAIN THE FOLLOWING VALUES:               * 02560000
*          02 - OLTCB POINTER                                         * 02660000
*          13 - SAVE AREA ADDRESS                                     * 02760000
*          14 - RETURN ADDRESS                                        * 02860000
*          15 - ENTRY POINT ADDRESS                                   * 02960000
*                                                                     * 03060000
* EXTERNAL ROUTINES:                                                  * 03240000
*                                                                     * 03330000
*       IEDQWK - TOTE MESSAGE MODULE                                  * 03420000
*       IEDQWAJ - $CUTEST MODULE                                S22024* 03460000
*                                                                     * 03510000
* EXIT POINTS:                                                        * 03600000
*                                                                     * 03630000
*    RETURN TO IEDQWA                                                 * 03660000
*    XCTL TO IEDQWEC - CONCENTRATOR MODULE                      S22024* 03670000
*                                                                     * 03690000
* TABLES/WORK AREAS:                                                  * 03780000
*                                                                     * 03870000
*       OLTCB, UCB                                                    * 03960000
*                                                                     * 04050000
* ATTRIBUTES:                                                         * 04140000
*                                                                     * 04230000
*       ENABLED, PROBLEM PROGRAM MODE, TRANSIENT.                     * 04320000
*                                                              @Y17XAUU 04320100
* MODULE TYPE: PROCEDURE                                       @Y17XAUU 04320200
*                                                              @Y17XAUU 04320300
* MODULE SIZE: 4K MAXIMUM                                      @Y17XAUU 04320400
*                                                              @Y17XAUU 04320500
* PROCESSOR: ASSEMBLER XF                                      @Y17XAUU 04320600
*                                                              @Y17XAUU 04320700
* MACROS - SAVE                                                @Y17XAUU 04320800
*          AQCTL                                               @Y17XAUU 04320900
*          IEDHJN                                              @Y17XAUU 04321000
*          XCTL                                                @Y17XAUU 04321100
*          WAIT                                                @Y17XAUU 04321200
*                                                              @Y17XAUU 04321300
* NOTES: SEE BELOW                                             @Y17XAUU 04321400
*                                                              @Y17XAUU 04321500
*  DEPENDENCIES: EBCDIC CHARACTER CODE                         @Y17XAUU 04321600
*                                                              @Y17XAUU 04321700
*  RESTRICTIONS: NONE                                          @Y17XAUU 04321800
*                                                              @Y17XAUU 04321900
*  REGISTER CONVENTIONS: SEE REGISTER ASSIGNMENT               @Y17XAUU 04322000
*                                                              @Y17XAUU 04322100
*  PATCH LABEL: PATCH                                          @Y17XAUU 04322200
*********************************************************************** 04410000
         EJECT                                                          04430000
*                                                                       04500000
*        REGISTER EQUATES                                               04590000
*                                                                       04680000
R0       EQU   0                       REG 0                     S99528 04770000
R1       EQU   1                       REG 1                     S99528 04860000
R2       EQU   2                       REG 2                     S99528 04950000
R3       EQU   3                       REG 3                     S99528 05040000
R4       EQU   4                       REG 4                     S99528 05130000
R5       EQU   5                       REG 5                     S99528 05220000
R6       EQU   6                       REG 6                     S99528 05310000
R7       EQU   7                       REG 7                     S99528 05400000
R8       EQU   8                       REG 8                     S99528 05490000
R9       EQU   9                       REG 9                     S99528 05580000
R10      EQU   10                      REG 10                    S99528 05670000
R11      EQU   11                      REG 11                    S99528 05760000
R12      EQU   12                      REG 12                    S99528 05850000
R13      EQU   13                      REG 13                    S99528 05940000
R14      EQU   14                      REG 14                    S99528 06030000
R15      EQU   15                      REG 15                    S99528 06120000
JFCBTSDM EQU   X'08'                   DISP                      S99528 06210000
JFCBLTYP EQU   X'02'                   TYPE                      S99528 06300000
ZERO     EQU   0                       ZERO                      S99528 06390000
ONE      EQU   1                       ONE                       S99528 06480000
TWO      EQU   2                       TWO                       S99528 06570000
THREE    EQU   3                       THREE                     S99528 06660000
FOUR     EQU   4                       FOUR                      S99528 06750000
FIVE     EQU   5                       FIVE                      S99528 06840000
SIX      EQU   6                       SIX                       S99528 06930000
SEVEN    EQU   7                       SEVEN                     S99528 07020000
EIGHT    EQU   8                       EIGHT                     S99528 07110000
NINE     EQU   9                       NINE                      S99528 07200000
TENN     EQU   10                      TEN                       S99528 07290000
ONEONE   EQU   11                      ELEVEN                    S99528 07380000
D0       EQU   0                       DISPLACEMENT              S22024 07470000
D1       EQU   1                       DISPLACEMENT              S22024 07560000
D2       EQU   2                       DISPLACEMENT              S22024 07650000
D3       EQU   3                       DISPLACEMENT              S22024 07740000
D4       EQU   4                       DISPLACEMENT              S22024 07830000
D5       EQU   5                       DISPLACEMENT              S22024 07920000
D6       EQU   6                       DISPLACEMENT              S22024 08010000
D7       EQU   7                       DISPLACEMENT              S22024 08100000
D8       EQU   8                       DISPLACEMENT              S22024 08190000
D9       EQU   9                       DISPLACEMENT              S22024 08280000
D10      EQU   10                      DISPLACEMENT              S22024 08370000
D13      EQU   13                      DISPLACEMENT              S22024 08390000
D16      EQU   16                      DISPLACEMENT              S22024 08410000
D32      EQU   32                      DISPLACEMENT              S22024 08460000
D34      EQU   34                      DISPLACEMENT 34           S99528 08550000
DEVTBEND EQU   X'00'                   TEST DEVICE TABLE END CODES99528 08640000
X40      EQU   X'40'                   BLANK                     S22024 08730000
X80      EQU   X'80'                   LINE ENTRY OR LGB TEST    S22024 08820000
X00      EQU   X'00'                   OK RETURN                 S22024 08840000
XF1      EQU   X'F1'                   TOTE RESOURCE             S22024 08845000
XDC      EQU   X'DC'                   PRIORITY                  S22024 08850000
X18      EQU   X'18'                   LENGTH OF ELEMENT         S22024 08855000
X08      EQU   X'08'                   ALREADY DONE RETURN       S22024 08860000
X0C      EQU   X'0C'                   FLAG START                S22024 08880000
XE0      EQU   X'E0'                   CLEAR EQU                 S22024 08910000
ZEROZ    EQU   X'00'                   CLEAR FIELD               S22024 09000000
X0F      EQU   X'0F'                   CLEAR FOR UCB TYPE        S22024 09090000
IPL3705  EQU   X'52'                   IPL VERB                  S22024 09180000
ACT3705  EQU   X'53'                   ACTIVATE VERB             S22024 09270000
DACT3705 EQU   X'54'                   DEACTIVATE VERB           S22024 09360000
RNUCBTST EQU   X'05'                   3705 UCB                  S22024 09450000
DEC58    EQU   58                      FIFTY EIGHT               S99528 09540000
SECTBEND EQU   X'40'                   SECTION TABLE END CODE    S99528 09630000
STRTCODE EQU   X'40'                   START CODE                S99528 09720000
STOPCODE EQU   X'41'                   START LINE                S99528 09810000
LINESTRT EQU   X'40'                   STOP LINE                 S99528 09900000
LINESTOP EQU   X'41'                   VERB CODE                 S99528 09990000
TERMSTRT EQU   X'45'                   VERB CODE START TERM      S99528 10080000
TERMSTOP EQU   X'47'                   TERMINAL CODE STOP        S99528 10170000
HOLDTERM EQU   X'88'                   HOLD TERMINAL VERB CODE   S99528 10260000
ACTIVETM EQU   X'46'                   ACTIVATE TERM VERB CODE   S99528 10350000
REALTERM EQU   X'87'                   RELEASE TERM VERB CODE    S99528 10440000
INACTERM EQU   X'48'                   INACTIVATE VERB CODE      S99528 10530000
SWPRI    EQU   X'50'                   SWITCH TO PRIMARY         Y06330 10560005
SWBCK    EQU   X'51'                   SWITCH TO BACKUP          Y06330 10590005
BLANK    EQU   X'40'                   INCLUSIVE DLIM            S99528 10620000
X44      EQU   X'44'                   DEB CK                    S22024 10710000
UCBNALBT EQU   X'04'                   UCB UNALLOCATE BIT        S22024 10740000
UCBNALOF EQU   X'FB'                   TURN OFF UNALLOCATE BIT   S22024 10770000
XFF      EQU   X'FF'                   CLEAN UP ELEMENT          S22024 10780000
X20      EQU   X'20'                   PRIORITY OF CLEANUP       S22024 10790000
ADRMSK   EQU   7                       ADDRESS MASK            @YM08136 10795000
*                                                                       10800000
HALFWORD EQU   3                       HALFWORD MASK           @OY20578 10840082
         EJECT                                                          10890000
         SAVE  (14,12)                 SAVE REGS                 S99528 10980000
         USING TOTOLTCB,R2             OLTCB                     S22024 11070000
*                                                                       11160000
*        SATISFY LINKAGE CONVENTIONS                                    11250000
*                                                                       11340000
         LR    R4,R15                  ESTABLISH BASE REG        S99528 11430000
         USING IEDQWE2,R4              IEDQWE2                          11520000
         ST    R13,TOTSAVE4+FOUR       SAVE CALLERS SAVE ADDR    S99528 11610000
         LR    R12,R13                 SAVE IT HERE TOO          S99528 11700000
         LA    R13,TOTSAVE4            MY SAVE AREA ADDRESS      S99528 11790000
         ST    R13,EIGHT(R12)          MY SAVE TO HIS            S99528 11880000
IEDQWE2  IEDHJN IEDQWEE,HJN            NAME AND HJN                     11970000
*        HOUSEKEEP FOR TERMINATION                                      12240000
         SPACE 2                                                        12304000
TCNT11E  EQU   *                                               @YM08158 12306000
         TM    TOTCUFLG,TOTCUDON       CU TEST BEEN ISSUED       S99528 12330000
         BZ    TCNT172                 BO BRANCH                 S99528 12420000
         OI    TOTCUFLG,TOTCUCUP       CLEAN UP NEEDED FLAG      S99528 12510000
         LA    R8,TOTSERV              ADDR OF  QWAJ WORK AREA @Y17XAUU 12511000
         LR    R10,R8             SET IT AGAIN                 @Y17XAUU 12512000
         LA    R9,L'TOTSERV            LENGTH OF WORKAREA      @Y17XAUU 12513000
         SLR   R11,R11                 SET COUNT REG           @Y17XAUU 12514000
         MVCL  R8,R10                 CLEAR WORK AREA          @Y17XAUU 12515000
         L     R5,TOTRESPL             GET RESPL ADDRESS       @Y17XAUU 12516000
         USING RESPL,R5                SET RESPL ADDRESSABILITY@Y17XAUU 12517000
         L     R15,RESPLAJ             $CUTEST ROUTINE ADDRESS @Y17XAUU 12518000
         BALR  R14,R15                 DO CUTEST CLEANUP       @Y17XAUU 12519000
TCNT172  EQU   *                                                        12690000
         L     R8,TOTAVTPT             GET ADDRESS OF AVT        S22024 12690400
         USING IEDQAVTD,R8             SET UP BASE FOR AVT       S22024 12690800
         LA    R7,AVTOPCOB             GET POINTER TO OP CONTROL S22024 12691200
*                                        QCB                     S22024 12691600
         ST    R7,TOTOKEY              PUT ADDR IN PARM LIST     S22024 12692000
         MVI   TOTOKEY,X00             ZERO OUT KEY FIELD        S22024 12692400
         MVI   TOTOPRI,XDC             PRIORITY OF ELEMENT       S22024 12693000
         MVI   TOTOELNG,X18            LENGTH OF ELEMENT         S22024 12696000
         LA    R8,TOTPLIST             GET OP CONTROL P-LIST     S22024 12700000
         ST    R8,CBSLPL               ADDRESS AND STORE IN      S22024 12710000
         ST    R8,CBSLPL+D4            ELEMENT TWICE             S22024 12720000
         MVI   CBSLPL,X0C              START FLAG                S22024 12730000
         MVI   CBSLPL+D4,X80           END FLAG                  S22024 12740000
         MVI   TOTOLADR,C' '           BLANK OUT                 S22024 12750000
         MVC   TOTOLADR+D1(D7),TOTOLADR   NAME                   S22024 12760000
         L     R8,TOTCTTNT             GET DUMMY TNT ENTRY       S99528 12780000
         LTR   R8,R8                   IS THERE ONE              S99528 12870000
         BZ    APTEST                  NO BRANCH                 S99528 12960000
         LA    R7,TOTCTENT-4           GET IOBLOCKS DESECT       S99528 13050000
         BAL   R12,STCTAP              START LINE                S99528 13140000
         BAL   R7,TNTALINE             GET TNT ADDRESS           S99528 13230000
         USING IEDQQCB,R6              QCB ADDRESSIBILITY        S99528 13320000
CTWAIT   L     R8,EIGHT(R6)            THIRD WORD OF             S99528 13410000
         LA    R8,ZERO(R8)             QCB POINT                 S99528 13500000
         LA    R7,EIGHT(R6)            TO IT SELF                S99528 13590000
         CR    R7,R8                   IF SO                     S99528 13680000
         BE    APTEST                  BRANCH                    S99528 13770000
         NI    QCBDSFLG,X'FF'-QCBHELD  TURN OFF QCBHELD IF ON    S99528 13950000
         STIMER WAIT,DINTVL=SECS00     WAIT 11 SECS              S99528 14040000
         B     CTWAIT                  BRANCH                    S99528 14130000
APTEST   L     R8,TOTAPTNT             GET DUMMY TNT ADDTESS     S99528 14220000
         LTR   R8,R8                   IS THERE ONE              S99528 14310000
         BZ    TCNT1722                NO BRANCH                 S99528 14400000
         LA    R7,TOTAPENT-4           GET IOBLOCKS DESECT       S99528 14490000
         OI    APSTIME,APSTIMER        SET AP STIMER             S99528 14580000
         BAL   R12,STCTAP              START LINE                S99528 14670000
         BAL   R7,TNTALINE             GET TNT ADDRESS           S99528 14760000
APWAIT   L     R8,EIGHT(R6)            THIRD WORD OF             S99528 14850000
         LA    R8,ZERO(R8)             QCB POINT                 S99528 14940000
         LA    R7,EIGHT(R6)            TO IT SELF                S99528 15030000
         CR    R7,R8                   IF SO                     S99528 15120000
         BE    TCNT1722                BRANCH                    S99528 15210000
         NI    QCBDSFLG,X'FF'-QCBHELD  TURN OFF QCBHELD IF ON    S99528 15300000
         STIMER WAIT,DINTVL=SECS00     WAIT 11 SECS              S99528 15480000
         B     APWAIT                  BRANCH                           15570000
         DROP  R6                                                       15660000
         EJECT                                                          15750000
*        START TEST DEVICES                                             15840000
*   RESTOR TEST DEVICES TO ORGINAL STATUS AND DEQ                       15930000
*                                                                       16020000
**                                                                      16110000
***                                                                     16200000
*                                                                       16290000
TCNT1722 EQU   *                                                 S99528 16380000
         LA    R3,TOTTDTBL             GET TEST DEVICE TABLE ADDRS99528 16470000
ALLENTY  DS    0H                      BOUNDARY ALLIGNMENT     @OY20828 16510082
         LA    R12,TOTTDEND            GE T END OF TABLE ADDRT   S99528 16560000
         CR    R3,R12                  ALL ENTRIES PROCESSED?  @OY20828 16650082
         BE    TCNT179                 YES BRANCH                S99528 16740000
         L     R8,0(R3)                GET ADDRESS FROM TABLE    S99528 16830000
         LR    R1,R8                   RERPARE TO SAEE           S99528 16920000
         SRL   R1,24                   HIGH ORDER BYTE           S99528 17010000
         STC   R1,INITSTAT             BYTE                      S99528 17100000
         LA    R8,0(R8)                CLEAR HI BYTE             S99528 17190000
         LTR   R8,R8                   ANY ADDRESS               S99528 17280000
         BZ    TCNT179                 NO BRANCH                 S99528 17370000
         TM    INITSTAT,TOTTDLIN       UCBS IN TABLE             S99528 17460000
         BO    LINETEST                YES BRANCH                S99528 17550000
         SLR   R1,R1                   CLEAR REGISTER          @YM08136 17551000
         IC    R1,TOTTTBEL             GET MAXIMUM NAME LEN    @YM08136 17552000
         LA    R6,D0(R1,R8)            POINT TO TTE ADDRESS    @YM08136 17553000
         ICM   R6,ADRMSK,D0(R6)        GET TTE ADDRESS         @YM08136 17554000
         ST    R6,TTEADDR              SAVE TTE ADDRESS        @YM09003 17555000
         LA    R1,TRMPRFSZ             GET TTE PREFIX SIZE     @YM08136 17556000
         SLR   R6,R1                   POINT TO TTE PREFIX     @YM08136 17557000
         USING IEDNTRM,R6              SET TTE ADDRESSABILITY  @YM08136 17558000
         TM    TRMSTATE,TRMPREF        NCP RESOURCE            @YM08136 17559000
         BZ    TCNT1724                NO - CONTINUE           @YM08136 17560000
         CLI   TRMTYPE,TRMSDLC         Q-TD SNA LINE           @XM05672 17560100
         BNE   NOTSNALI                N-PROCESS NONSNA LINE   @XM05672 17560200
*        CONVERT LINE NAME TO TTCIN                            @XM05672 17560300
         USING IEDQAVTD,R8                                     @XM05672 17560400
         L     R8,TOTAVTPT             AVT ADDRESSABILITY      @XM05672 17560500
         SLR   R0,R0                   CLEAR REG 0             @XM05672 17560600
         IC    R0,TOTTTBEL             LENGTH OF NAME          @XM05672 17560700
         L     R1,0(R3)                ADDRESS OF TNT ENTRY    @XM05672 17560800
         LA    R1,0(R1)                CLEAR HI BYTE           @XM05672 17560900
         L     R15,AVTMSGS-1           CONVERT                 @XM05672 17561000
         L     R15,8(R15)               NAME TO                @XM05672 17561100
         BAL   R14,4(R15)               TTCIN                  @XM05672 17561200
         DROP  R8                      DROP AVT ADDRESSABILITY @XM05672 17561300
*        TURN OFF TRMSTOTE IN LINE ENTRY AND IN ALL INFERIOR   @XM05672 17561400
*        ENTRIES.                                              @XM05672 17561500
         LR    R1,R15                  COPY TTCIN              @XM05672 17561600
         USING RESPL,R8                RESPL BASE              @XM05672 17561700
         L     R8,TOTRESPL             RESPL ADDRESSABILITY    @XM05672 17561800
         L     R15,RESTLIB             ADDR OF HIER. SCAN RTN. @XM05672 17561900
         BALR  R14,R15                 TURN OFF BITS           @XM05672 17562000
         DROP  R8                      AVT ADDRESSABILITY      @XM05672 17562100
         B     SNARLSE                 GO RELEASE QUEUES       @XM05672 17562200
NOTSNALI DS    0H                                              @XM05672 17562300
         NI    TRMBYTE1,XFF-TRMSTOTE   RESET TOTE FLAG         @YM08136 17562400
         CLI   TRMTYPE,TRMLUNT         SNA LU ENTRY            @YM08136 17562500
         BNE   TCNT1724                N-BYPASS LU PROCESSING  @XM05672 17562600
         TM    INITSTAT,TOTTDTHD       Q-INITIALLY HELD        @XM05672 17562700
         BO    LUTDEND                 Y-BRANCH                @XM05672 17562800
SNARLSE  DS    0H                                              @XM05672 17562900
         MVI   TOTOVBCD,REALTERM       N-SET TO RELEASE LINE   @XM05672 17563000
         BAL   R12,STARTERM            GO RELEASE              @XM05672 17563100
         CLI   TOTORTCD,X00            Q-RELEASED              @XM05672 17563200
         BE    LUTDEND                 Y-BRANCH                @XM05672 17563300
         CLI   TOTORTCD,X08            Q-ALREADY RELEASED      @XM05672 17563400
         BE    LUTDEND                 Y-BRANCH                @XM05672 17563500
         BAL   R12,BSTOP               N-PRINT MESSAGE         @XM05672 17563600
LUTDEND  DS    0H                      END OF LU PROCESSING    @XM05672 17563700
         B     CONTE3                  GO CHECK FOR NEXT TD    @XM05672 17563800
         DROP  R6                                              @YM08136 17564000
TCNT1724 EQU   *                                               @YM08136 17565000
         TM    INITSTAT,TOTTSWPM       HAS TOTE SWITCHED DEVICE  Y06330 17570005
         BO    SWSTRET                 YES BRANCH                Y06330 17590005
SWRETURN EQU   *                                                 Y06330 17610005
         TM    INITSTAT,TOTTDTHD       TERM ORIG HELD            S99528 17820000
         BO    STOPTERM                YES BRANCH                S99528 17910000
CONTE1 EQU  *                                                    S99528 18630000
         MVI   TOTOVBCD,REALTERM       VERB TO REALSE TERMINAL   S22024 18720000
         BAL   R12,STARTERM            GO REALSSE TERMINAL       S99528 18810000
         CLI   TOTORTCD,X00            OK                        S22024 18900000
         BE    CONTE2                  GOOD RETURN               S99528 18990000
         CLI   TOTORTCD,X08            ALREADY DONE              S22024 19080000
         BE    CONTE2                  YES BR                    S99528 19170000
         BAL   R12,BSTOP               GO SEND MSG               S99528 19260000
CONTE2 EQU  *                                                    S99528 19350000
LINETEST EQU   *                                                 S99528 19440000
         SLR   R1,R1                   CLEAR REGISTER          @YM09003 19450000
         IC    R1,TOTTTBEL             GET MAXIMUM NAME LENGTH @YM09003 19460000
         LA    R6,D0(R1,R8)            POINT TO TTE ADDRESS    @YM09003 19470000
         ICM   R6,ADRMSK,D0(R6)        GET TTE ADDRESS         @YM09003 19480000
         ST    R6,TTEADDR              SAVE TTE ADDRESS        @YM09003 19490000
         XC    TOTORTCD,TOTORTCD       CLEAR RETURN CODE FIELD @YM09003 19500000
         TM    INITSTAT,TOTTDLIN       TEST DEVICE A LINE        S22024 19530000
         BO    UCBTAB                  YES BRANCH                S99528 19620000
         TM    INITSTAT,TOTTDTRM+TOTTDORN 3705 TERMINAL TEST   @OY20828 19630082
         BO    CONTE3                  YES PROCESS NEXT ENTRY  @OY20828 19640082
         TM    INITSTAT,TOTTDORN       TEST DEVICE ON RN         S22024 19650000
         BO    UCBTAB                  YES BRANCH                S22024 19680000
         BAL   R12,UCBFIND             LOCATE UCB                S99528 19710000
UCBTAB   BAL   R12,LISTART             START LINE                S99528 19800000
         CLI   TOTORTCD,X00            OK                        S22024 19890000
         BE    CONTE3                  GOOD RETURN               S99528 19980000
         CLI   TOTORTCD,X08            ALREADY DONE              S22024 20070000
         BE    CONTE3                  YES BR                    S99528 20160000
         BAL   R12,BSTOP               GO SEND MSG               S99528 20250000
CONTE3 EQU  *                                                    S99528 20340000
RESTLP   LA    R3,4(R3)                BUMP TABLE POINTER        S99528 20430000
         TM    INITSTAT,TOTTDORN       TEST DEV ON RN            S22024 20440000
         BZ    NOTRNIN                 NO BRANCH                 S22024 20450000
         L     R6,TTEADDR              GET TTE ADDRESS           S22024 20460000
         LA    R1,TRMPRFSZ             GET TTE PREFIX SIZE     @Y17XAUU 20460400
         SLR   R6,R1                   ADDRESS OF TTE PREFIX   @Y17XAUU 20460800
         USING IEDNTRM,R6              SET TTE ADDRESSABILITY  @Y17XAUU 20461200
         NI    TRMBYTE1,XFF-TRMSTOTE   RESET TOTE FLAG         @Y17XAUU 20461600
         DROP  R6                      TTE                       S22024 20490000
NOTRNIN  EQU   *                                                 S22024 20500000
         B     ALLENTY                 GO PROCESS NEXT ENTRY     S99528 20520000
*                                                                     * 21690000
*              ACTIVATE TERMINAL                                      * 21780000
*                                                                     * 21870000
ACTIVTRM EQU   *                                                 S99528 21960000
         MVI   TOTOVBCD,ACTIVETM       VERB TO ACTIVATE TERMINAL S22024 22050000
         BAL   R12,STARTERM            GO ACTIVATE TERMINAL      S99528 22140000
         CLI   TOTORTCD,X00            OK                        S22024 22230000
         BE    CONTE5                  GOOD RETURN               S99528 22320000
         CLI   TOTORTCD,X08            ALREADY DONE              S22024 22410000
         BE    CONTE5                  YES BR                    S99528 22500000
         BAL   R12,BSTOP               GO SEND MSG               S99528 22590000
*                                                                     * 22680000
*              HOLD TERMINAL                                          * 22770000
*                                                                     * 22860000
CONTE5 EQU  *                                                    S99528 22950000
         MVI   TOTOVBCD,HOLDTERM       VERB TO HOLD TERMINAL     S22024 23040000
         BAL   R12,STARTERM            GO HOLD TERM              S99528 23130000
         CLI   TOTORTCD,X00            OK                        S22024 23220000
         BE    CONTE6                  GOOD RETURN               S99528 23310000
         CLI   TOTORTCD,X08            ALREADY DONE              S22024 23400000
         BE    CONTE6                  YES BR                    S99528 23490000
         BAL   R12,BSTOP               GO SEND MSG               S99528 23580000
CONTE6 EQU  *                                                    S99528 23670000
         B     LINETEST                GO START LINE             S99528 23760000
STOPTERM EQU   *                                                 S99528 23850000
         MVI   TOTOVBCD,TERMSTOP       VERB TO STOP TERMINAL     S22024 23940000
         BAL   R12,STARTERM            GO STOP TERMINAL          S99528 24030000
         CLI   TOTORTCD,X00            OK                        S22024 24120000
         BE    CONTE7                  GOOD RETURN               S99528 24210000
         CLI   TOTORTCD,X08            ALREADY DONE              S22024 24300000
         BE    CONTE7                  YES BR                    S99528 24390000
         BAL   R12,BSTOP               GO SEND MSG               S99528 24480000
CONTE7 EQU  *                                                    S99528 24570000
         B     LINETEST                GO START LINE             S99528 24660000
*****                                                              **** 24750000
*****          TOTE CANNOT RETURN TEST DEVICES TO ORIGINAL STATUS  **** 24840000
*****                                                              **** 24930000
BSTOP    WTO   'IED154I TOTE CANNOT RETURN DEVICE          TO ORIGINAL C25020000
               STATUS',ROUTCDE=10,DESC=7                         S99528 25110000
BSTOPNAM EQU   BSTOP+42                NAME IN MSG               S22024 25200000
         MVI   TOTORTCD,DEVTBEND       CLEAR RETURN CODE         S22024 25290000
         MVI   BSTOPNAM,BLANK          CLEAR                     S99528 25380000
         MVC   BSTOPNAM+ONE(SEVEN),BSTOPNAM  NAME IN MSG         S99528 25470000
         BR    R12                     RETURN                    S99528 25560000
SWSTRET  EQU   *                                                 Y06330 25565005
         LR    R9,R8                   SAVE TNT POINTER          Y06330 25570005
         SR    R10,R10                 CLEAR REG                 Y06330 25575005
         IC    R10,TOTTTBEL            NAME LENGTH               Y06330 25580005
         AR    R9,R10                  GET TTE ADDRESS           Y06330 25585005
         MVC   TTEADDR+D1(D3),D0(R9)   ALLINE ADDRESS            Y06330 25590005
         L     R6,TTEADDR              GET TTE ADDRESS           Y06330 25595005
         USING IEDQTRM,R6              TTE                       Y06330 25600005
         MVI   TOTOVBCD,SWBCK          SWITCH TO BACKUP          Y06330 25605005
         BAL   R12,STARTERM            GO SWITCH                 Y06330 25610005
         CLI   TOTORTCD,X00            OK                        Y06330 25615005
         BE    SWRETURN                YES BRANCH                Y06330 25620005
         BAL   R12,BSTOP               GO SEND MESSAGE           Y06330 25625005
         B     SWRETURN                CONTINUE                  Y06330 25630005
         DROP  R6                      TTE                       Y06330 25635005
         EJECT                                                          25650000
***      DEQ TEST DEVICES   ********                                    25740000
***                          *******                                    25830000
TNTMOVE  MVC   RNAME(0),0(R6)          MOVE NAME TO DEQ          S99528 25920000
TNTMOVEE MVC   0(0,R8),0(R1)           MOVE NAME TO DEQ          S22024 25960000
TNTENTRY EQU   *                       TNT ONLY                  S99528 26010000
         LR    R8,R6                   R8 TO TNT ADDRESS                26100000
         BAL   R12,UCBFIND             GO FIND UCB                      26190000
         USING UCB,R8                                                   26280000
         MVC   RNAME(3),UCBNAME                                         26370000
         DROP  R8                                                       26460000
         DEQ   ,MF=(E,DEQLIST)                                          26550000
         MVI   RNAME,X'40'                                              26640000
         MVC   RNAME+1(7),RNAME                                         26730000
         SR    R3,R3                   CLEAR REG                 S99528 26820000
         IC    R3,TOTTTBEL             GET NAME LENGTH           S99528 26910000
         BCTR  R3,0                    DECREMENT LENGTH OOR EX   S99528 27000000
         EX    R3,TNTMOVE              GO TO MOVE NAME           S99528 27090000
         B     DEQNAME                 GO DEQ                    S99528 27180000
RNTEMDQ  EQU   *                       THIS ROUTINE FINDS THE    S22024 27270000
*                                      LINE NAME DOR A TRRMINAL  S22024 27360000
         LR    R9,R6                   GET TNT ADDRESS           S22024 27450000
         BAL   R12,TERMRNDQ            DEQ LINE FOR TERMINAL     S22024 27540000
         B     NXTENT                  GO GET NEXT ENTRY         S22024 27630000
TERMRNDQ EQU   *                                                 S22024 27720000
         STM   R5,R7,DEQSAVE           SAVE REGS 5,6,7           S22024 27810000
         SR    R3,R3                   CLEAR REG                 S22024 27900000
         IC    R3,TOTTTBEL             GET NAME LENGTH           S22024 27990000
         AR    R9,R3                   TTE ADDRESS               S22024 28080000
         MVC   TTEADDR+D1(D3),D0(R9)   ALLINE ADDRESS            S22024 28170000
         L     R9,TTEADDR              TTE ADDRESS               S22024 28260000
         LA    R1,TRMPRFSZ             GET TTE PREFIX SIZE     @Y17XAUU 28350000
         SR    R9,R1                   GET NTRM                  S22024 28440000
         USING IEDNTRM,R9              TTE                       S22024 28530000
CHKTTE   EQU   *                                               @Y17XAUU 28530200
         LH    R1,TRMCOHRT             GET COHORT POINTER      @Y17XAUU 28530400
         L     R10,TOTAVTPT            GET AVT ADDRESS         @Y17XAUU 28530600
         USING IEDQAVTD,R10            SET AVT ADDRESSABILITY  @Y17XAUU 28530800
         L     R15,AVTRNMPT            TTCIN TO TTE CONVERSION @Y17XAUU 28531000
         STH   R1,OFFSET               SAVE COHORT POINTER     @Y17XAUU 28531200
         BALR  R14,R15                 GET NEXT TTE ENTRY      @Y17XAUU 28531400
         LA    R14,TRMPRFSZ            GET PREFIX SIZE         @Y17XAUU 28531600
         SLR   R1,R14                  POINT TO TTE PREFIX     @Y17XAUU 28531800
         LR    R9,R1                   SET TTE BASE            @Y17XAUU 28532000
         CLI   TRMTYPE,TRMNSDLC        PRE SNA LINE ENTRY      @Y17XAUU 28532200
         BE    LINETTE                 YES                     @Y17XAUU 28532400
         CLI   TRMTYPE,TRMSDLC         SNA LINE ENTRY          @Y17XAUU 28532600
         BNE   CHKTTE                  CHECK NEXT ENTRY        @Y17XAUU 28532800
         DROP  R9                                              @Y17XAUU 28533000
LINETTE  EQU   *                                               @Y17XAUU 28533200
         AR    R1,R14                  RESET TTE BASE          @Y17XAUU 28533400
         DROP  R10                                             @Y17XAUU 28533600
         TM    RNFLAG,APFLAG           IS THIS A SEARCH FOR AP   S05331 32136000
*                                        LINE TTE                S05331 32142000
         BNO   CHKCT                   NO, GO CHECK CT           S05331 32148000
         ST    R1,APLTTE               SAVE TTE ADDRESS          S05331 32154000
         B     D0(R6)                  BRANCH BACK TO CALLER     S05331 32160000
CHKCT    EQU   *                                                 S05331 32166000
         TM    RNFLAG,CTFLAG           IS THIS A SEARCH FOR CT   S05331 32172000
*                                        LINE TTE ADDRESS        S05331 32178000
         BNO   CONTINUE                NO, CONTINUE              S05331 32184000
         ST    R1,CTLTTE               STORE CT LINE TTE ADDR    S05331 32190000
         B     D0(R6)                  RETURN TO CALLER          S05331 32196000
CONTINUE EQU   *                                                 S05331 32202000
         L     R14,TOTAVTPT            GET AVT ADDRESS           S22024 32220000
         USING IEDQAVTD,R14            AVT                       S22024 32310000
         L     R1,AVTRNMPT             GET TERMNAME TABLE ADDR   S22024 32400000
         DROP  R14                     AVT                       S22024 32490000
         USING IEDQTNTD,R1             TNT                       S22024 32580000
         LA    R1,TNTFIRST             FIRST ENTRY ADDR          S22024 32670000
         DROP  R1                      TNT                       S22024 32760000
         LA    R7,D3                   LENGTH OF TTE ADDRESS     S22024 32850000
         SR    R3,R3                   CLEAR REG                 S22024 32880000
         IC    R3,TOTTTBEL             GET NAME LENGTH           S22024 32910000
         AR    R7,R3                   LENGTH OF TNT ENTRY       S22024 32940000
         LH    R11,OFFSET              GET TNT OFFSET            S22024 33030000
         LA    R14,D1                  SUBTRACT ONE              S22024 33060000
         SR    R11,R14                 TO GET RIGHT OFFSET       S22024 33090000
         MR    R10,R7                  OFFSET TO ACTUAL ENTRY    S22024 33120000
         AR    R1,R11                  TNT ADDR OF LINE          S22024 33210000
         BCTR  R3,0                    DECREMENT BY 1            S22024 33300000
         LA    R8,TNTNAME              GET TNT POINTER           S22024 33390000
         EX    R3,TNTMOVEE             MOVE NAME                 S22024 33480000
         MVC   RNAME(D8),TNTNAME       NAME TO DEQ               S22024 33570000
         DEQ   ,MF=(E,DEQLIST)         DEQ                       S22024 33660000
         MVI   RNAME,X40               CLEAR DEQ                 S22024 33750000
         MVC   RNAME+D1(D7),RNAME      PARM                      S22024 33840000
         LM    R5,R7,DEQSAVE           RESTORE REGS              S22024 33930000
         BR    R12                     GO DEQ NEXT ENTRY         S22024 34020000
TCNT179  EQU   *                                                        34110000
         TM    TOTFLG01,TOTCONFG       CLEANUP FOR CONFIG        S99528 34200000
         BO    TCNT21                  YES BRANCH                S99528 34290000
         LA    R5,TOTTDTBL             DEVICE TABLE ADDRESS      S99528 34380000
         LA    R7,TOTTDEND             END OF TABLE ADDRESS      S99528 34470000
LOOPP    L     R6,0(R5)                GET UCB OR TNT            S99528 34560000
       LTR     R6,R6                   IS THERE ONE              S99528 34650000
         BZ    TCNT211                 NO BRANCH                 S99528 34740000
         LR    R1,R6                   SAVE                      S22024 34760000
         SRL   R1,24                   INITIAL                   S22024 34780000
         STC   R1,INITSTAT             STATUS                    S22024 34800000
         TM    0(R5),TOTTDORN          TEST DEVICE ON 3705       S22024 34830000
         BO    TNTENTRY                YES BRANCH                S22024 34920000
         TM    0(R5),TOTTDLIN          TEST FOR 0X LINES         S22024 35010000
         BZ    TNTENTRY                NO BRANCH                 S99528 35100000
         USING UCB,R6                  UCB BASE                  S99528 35190000
         MVC   RNAME(3),UCBNAME        MOVE NAME TO P-LIST       S99528 35280000
         DROP  R6                      DROP                      S99528 35370000
DEQNAME  DEQ   ,MF=(E,DEQLIST)         DEQ                       S99528 35460000
         MVI   RNAME,X'40'                                              35550000
         MVC   RNAME+1(7),RNAME                                         35640000
         TM    0(R5),TOTTDORN          TEST DEVICE ON 3705       S22024 35730000
         BZ    NXTENT                  NO BRANCH                 S22024 35820000
         TM    0(R5),TOTTDLIN          TEST DEVICE 3705 LINE    -S22024 35910000
         BZ    RNTEMDQ                 NO BRANCH                 S22024 36000000
NXTENT   EQU   *                                                 S22024 36090000
         LA    R5,4(R5)                GET NEXT ENTRS            S22024 36180000
         CR    R5,R7                   END OF TABLE              S99528 36270000
         BNE   LOOPP                   NO BRANCH                 S99528 36360000
TCNT211  TM    TOTPRDCB+X'30',X'10'    DCB OPEN                  S99528 36450000
         BZ    SECDCBT                 NO BRANCH                 S99528 36540000
         L     R1,TOTPRDEB             GET PRIMARY DEB         @XM05672 36550000
         LA    R1,0(R1)                CLEAR HI BYTE           @XM05672 36560000
         LTR   R1,R1                   Q-IS THERE ONE          @XM05672 36570000
         BZ    SECDCBT                 N-CHECK SECONDARY       @XM05672 36580000
         LA    R1,TOTPRDCB             TEST DCB                  S99528 36720000
         ST    R1,TOTWKSPC             STORE IN P LIST           S99528 36810000
         MVI   TOTWKSPC,X'B0'          OPTION CLOSE              S99528 36900000
         LA    R1,TOTWKSPC             ADDRESS OF P LIST         S99528 36990000
         CLOSE MF=(E,(1))              CLOSE TEST DCB            S99528 37080000
****   CLOSE GRABED DCBS IF ANY        ***********                      37170000
*****                                  ***********                      37260000
SECDCBT  TM    TOTSCDCB+X'30',X'10'    SECOND DCB OPEN           S99528 37350000
         BZ    TCNT21                  NO BRANCH                 S99528 37440000
         L     R1,TOTSCDEB             EET SECONDARY BED         S99528 37530000
         LTR   R1,R1                   IS THERE ONE              S99528 37620000
         BZ    TCNT21                  NO BRANCH                 S99528 37710000
         LA    R1,TOTSCDCB             SECENDARY DEC             S99528 37800000
         ST    R1,TOTWKSPC             STORE IN P LIST           S99528 37890000
         MVI   TOTWKSPC,X'B0'          OPTION CLOSE              S99528 37980000
         LA    R1,TOTWKSPC             ADDRESS OF P LIST         S99528 38070000
         CLOSE MF=(E,(1))              CLOSE SECONDARY DCB       S99528 38160000
TCNT21   EQU   *                                                        38250000
         TM    TOTFLG09,TOTPRECT       WAS AP SELECTED           S99528 38340000
         BO    CTSYSCO                 NO BRANCH                 S99528 38430000
         TM    TOTFLG09,TOTAPTRM       IS AP TERMINAL            S99528 38520000
         BO    APORGST                 YES BRANCH                S99528 38610000
         B     CTSYSCO                 BRANCH                    S99528 38700000
APHOLD   EQU   *                                                 S22024 38790000
         TM    LUFLAGS,APLUNT     Q-IS AP AN LU                @XM05672 38800000
         BO    ON                 Y-BRANCH                     @XM05672 38810000
         MVI   TOTOVBCD,HOLDTERM       VERB TO HOLD TERMINAL     S22024 38830000
         B     HOLDREL                 GO HOLD                   S99528 38880000
INACTLST EQU   *                                                 S22024 38970000
         MVI   TOTOVBCD,INACTERM       VERB TO INACTIVATE        S22024 39010000
         B     INACACTI                GO INACTIVE               S99528 39060000
STOPAP   EQU   *                                                 S22024 39150000
         MVI   TOTOVBCD,LINESTOP       VERB TO STOP LINE         S22024 39190000
         B     STARSTOP                STOP                      S99528 39240000
APORGST  EQU   *                       AP ORGINAL STATUS         S99528 39330000
**   TEST FLAGS IN TOTAPDFL TO DETERMINE ORIGINAL STATUS OF      S99528 39420000
**   AP IF IT IS A TERMINAL-- RETURN TO ORGINAL STATUS           S99528 39510000
         L     R6,TOTARTNT             GET AP TNT ADDRESS      @YM08136 39516000
         SLR   R1,R1                   CLEAR REGISTER          @YM08136 39522000
         IC    R1,TOTTTBEL             GET MAXIMUM NAME LENGTH @YM08136 39528000
         AR    R6,R1                   POINT TO TTE PREFIX     @YM08136 39534000
         ICM   R6,ADRMSK,D0(R6)        GET TTE ADDRESS         @YM08136 39540000
         LA    R1,TRMPRFSZ             GET TTE PREFIX SIZE     @YM08136 39546000
         SLR   R6,R1                   POINT TO TTE PREFIX     @YM08136 39552000
         USING IEDNTRM,R6              SET TTE PREFIX ADDRESS  @YM08136 39558000
         TM    TRMSTATE,TRMPREF        NCP RESOURCE            @YM08136 39564000
         BZ    APCHKE                  NO - CONTINUE           @YM08136 39570000
         CLI   TRMTYPE,TRMLUNT         SNA LU ENTRY            @YM08136 39576000
         BNE   APCHKE                  N-BYPASS FLAG SETTING   @XM05672 39582000
         OI    LUFLAGS,APLUNT          AP IS LUNT FLAG         @XM05672 39585000
APCHKE   EQU   *                                               @YM08136 39588000
         DROP  R6                                              @YM08136 39594000
         SR    R7,R7                   CLEAR REG                 S99528 39600000
         IC    R7,TOTAPRLN             GET RLN                   S99528 39690000
         STC   R7,TOTORLN              PUT IN P-LIST             S22024 39780000
         MVC   TOTOLADR(D8),TOTAPNAM   NAME TO P-LIST            S22024 39870000
         MVC   BSTOPNAM(EIGHT),TOTAPNAM MANE TO MSG              S99528 39960000
         TM    TOTAPDFL,TOTAPHD        INIT HELD                 S99528 40050000
         BO    APHOLD                  YES BR                    S99528 40140000
         MVI   TOTOVBCD,REALTERM       VERB TO REALEASE TERMINAL        40230000
HOLDREL  BAL   R12,ORIGTERM            OP CONTROL                S99528 40320000
         CLI   TOTORTCD,X00            OK                        S22024 40410000
         BE    ON                      OK BR                     S99528 40500000
         CLI   TOTORTCD,X08            ALREADY DONE              S22024 40590000
         BE    ON                      OK BR                     S99528 40680000
         BAL   R12,BSTOP               MSG TO SYSCON             S99528 40770000
ON       EQU   *                       CONTINUE                  S99528 40860000
         MVI   BSTOPNAM,X40            CLEAR OUT                 S22024 40890000
         MVC   BSTOPNAM+D1(D7),BSTOPNAM  NAME IN MSG             S22024 40920000
INACACTI EQU   *                                                 S22024 41170000
         MVC   TOTOLADR(D8),TOTAPNAM   NAME TO P-LIST            S22024 41220000
         MVC   BSTOPNAM(EIGHT),TOTAPNAM  NAME TO MSG             S99528 41310000
ON1      EQU   *                       CONTINUE                  S99528 41940000
         TM    TOTAPFLG,TOTAPORN       AP ON 3705                S22024 41970000
         BNO   LINEAP                  NO, BRANCH                S05331 42000000
         MVC   TRMSAVE(D2),TOTARSID    GET RESOURCE ID OF AP     S05331 42002000
         OI    RNFLAG,APFLAG           SET AP ON 3705 FLAG       S05331 42004000
         L     R9,TOTARTNT             AP TNT ADDRESS          @Y17XAUU 42004200
         SLR   R3,R3                   CLEAR REG               @Y17XAUU 42005000
         IC    R3,TOTTTBEL             GET NAME LENGTH         @Y17XAUU 42005200
         AR    R9,R3                   POINT TO TTE ADDRESS    @Y17XAUU 42005600
         MVC   TTEADDR+D1(D3),D0(R9)   ALLIGN ADDRESS          @Y17XAUU 42006300
         L     R9,TTEADDR              GET TTE ADDRESS         @Y17XAUU 42007000
         LA    R3,TRMPRFSZ             GET TTE PREFIX SIZE     @Y17XAUU 42007700
         SLR   R9,R3                   ADDRESS OF TTE PREFIX   @Y17XAUU 42008400
         USING IEDNTRM,R9              TTE ADDRESSABILITY      @XM05672 42008500
         NI    TRMBYTE1,XFF-TRMSTOTE   TURN OFF TOTE BIT       @XM05672 42008600
         DROP  R9                                              @XM05672 42008700
         BAL   R6,CHKTTE               GET AP LINE TTE ADDRESS @Y17XAUU 42009100
         NI    RNFLAG,XFF-APFLAG       TURN OFF AP FLAG          S05331 42010000
         TM    LUFLAGS,APLUNT     Q-IS AP AN LU                @XM05672 42010600
         BO    ON2                Y-BRANCH AROUND STARTLINE    @XM05672 42011200
         MVC   TOTOLADR(EIGHT),TOTAPRNL  MOVE AP GROUP NAME INTO S05331 42012000
*                                          OP CONTROL PARM LIST  S05331 42014000
         MVC   BSTOPNAM(EIGHT),TOTAPRNL  MOVE GROUP NAME INTO MSGS05331 42016000
         MVC   TOTORLN(1),TOTAPRLN     MOVE RLN INTO PARM LIST   S05331 42018000
         B     CKLINEAP                GO CHECK INITIAL STATUS   S05331 42020000
LINEAP   EQU   *                                                 S05331 42022000
         SR    R6,R6                   CLEAR                   @G36XRUV 42026000
         ICM   R6,THREE,TOTAPUCB       UCB ADDRESS             @G36XRUV 42030000
         USING UCB,R6                  UCB                       S99528 42120000
         MVC   TOTOLADR(D3),UCBNAME    UCB TO P-LIST             S22024 42210000
         MVC   BSTOPNAM(THREE),UCBNAME UCB TO MSG                S99528 42300000
         DROP  R6                      UCB                       S99528 42390000
CKLINEAP EQU   *                                                 S05331 42430000
         TM    TOTAPDFL,TOTAPLST       AP LINE INIT STOPPED      S22024 42480000
         BO    STOPAP                  YES BR                    S99528 42570000
         MVI   TOTOVBCD,LINESTRT       VERB TO START LINE        S22024 42660000
STARSTOP BAL   R12,ORIGTERM            OP CONTROL                S99528 42750000
         CLI   TOTORTCD,X00            OK                        S22024 42840000
         BE    ON2                     OK BR                     S99528 42930000
         CLI   TOTORTCD,X08            ALREADY DONE              S22024 43020000
         BE    ON2                     OK BR                     S99528 43110000
         BAL   R12,BSTOP               MSG TO SYSCON             S99528 43200000
ON2      EQU   *                       CONTINUE                  S99528 43290000
         MVC    RNAME(EIGHT),TOTAPNAM  DEQ AP TERM               S99528 43380000
         DEQ   ,MF=(E,DEQLIST)         DEQ                       S99528 43470000
         MVI   RNAME,X'40'             BLANK OUT                 S99528 43560000
         MVC   RNAME+1(7),RNAME        R NAME                    S99528 43650000
         SR    R5,R5                   CLEAR                   @G36XRUV 43690000
         ICM   R5,THREE,TOTAPUCB       GET AP UCB ADDRESS      @G36XRUV 43740000
         USING UCB,R5                  UCB ADDRESSIBILITY        S99528 43830000
         MVC   RNAME(3),UCBNAME        UCB NAME TO DEQ           S99528 43920000
         DEQ   ,MF=(E,DEQLIST)         DEQ                       S99528 44010000
         MVI   RNAME,X'40'             BLANK OUT                 S99528 44100000
         MVC   RNAME+1(7),RNAME        R NAME                    S99528 44190000
         TM    TOTAPFLG,TOTAPORN       AP ON A 3705              S22024 44280000
         BO    RNAPDQ                  YES BRANCH                S22024 44370000
CTSYSCO  EQU   *                       CONTROL TERMINAL TO ORG STS99528 44460000
         TM    TOTFLG09,TOTCTCON       CONTROL TERMINAL = SYSCON S99528 44550000
         BO    UNALLOCK                YES BRANCH                S22024 44640000
         L     R3,TOTCRTNT             SEE IF A REAL ENTRY       S22024 44660000
         LTR   R3,R3                   EXIST IF NOT              S22024 44680000
         BZ    UNALLOCK                BRANCH                    S22024 44700000
         L     R6,TOTCRTNT             GET CT TNT ADDRESS      @YM08136 44702000
         SLR   R1,R1                   CLEAR REGISTER          @YM08136 44704000
         IC    R1,TOTTTBEL             GET MAXIMUM NAME LENGTH @YM08136 44706000
         AR    R6,R1                   POINT TO TTE ADDRESS    @YM08136 44708000
         ICM   R6,ADRMSK,D0(R6)        GET TTE ADDRESS         @YM08136 44710000
         LA    R1,TRMPRFSZ             GET TTE PREFIX SIZE     @YM08136 44712000
         SLR   R6,R1                   POINT TO TTE PREFIX     @YM08136 44714000
         USING IEDNTRM,R6              SET TTE ADDRESSABILITY  @YM08136 44716000
         TM    TRMSTATE,TRMPREF        NCP RESOURCE            @YM08136 44718000
         BZ    CTCKE                   NO - CONTINUE           @YM08136 44720000
         CLI   TRMTYPE,TRMLUNT         SNA LU ENTRY            @YM08136 44722000
         BNE   CTCKE                   N-BYPASS FLAG SETIING   @XM05672 44724000
         OI    LUFLAGS,CTLUNT          CONTROL TERM IS LU      @XM05672 44725000
         DROP  R6                                              @YM08136 44726000
CTCKE    EQU   *                                               @YM08136 44728000
*   RETURN CONTROL TO ORGINAL STATUS                             S99528 44730000
         LA    R1,TOTCTNAM             POINT TO TERM NAME        S99528 44820000
         SR    R3,R3                   CLEAR REG                 S99528 44910000
LOP      CLI   0(R1),X'61'             SLASH                     S99528 45000000
         BE    MOVE                    YES BR                    S99528 45090000
         LA    R3,1(R3)                BUMP CNTER                S99528 45180000
         LA    R1,1(R1)                BUMP CNTER                S99528 45270000
         B     LOP                     TRY AGAINM                S99528 45360000
RNAPDQ   EQU   *                                                 S22024 45450000
         L    R9,TOTARTNT              GET ALT PRT TNT ADDRESS   S22024 45540000
         BAL   R12,TERMRNDQ            GO DEQ LINE FOR AP        S22024 45630000
         B     CTSYSCO                 CHECK CONTROL TERM        S22024 45720000
CTHOLD   EQU   *                                                 S22024 45810000
         TM    LUFLAGS,CTLUNT          Q-IS CTL TERM LUNT      @XM05672 45820000
         BO    ON3                     Y-ALREADY HELD          @XM05672 45830000
         MVI   TOTOVBCD,HOLDTERM       HOLD TERMINAL             S22024 45850000
         B     RELHOLD                 GO HOLD                   S99528 45900000
LSTINACT EQU   *                                                 S22024 45990000
         MVI   TOTOVBCD,INACTERM       INACTIVATE TERM           S22024 46030000
         B     ACTIINAC                GO INACTIVE               S99528 46080000
STOPCT   EQU   *                                                 S22024 46170000
         MVI   TOTOVBCD,LINESTOP       STOP LINE                 S22024 46210000
         B     STOPSTAR                STOP                      S99528 46260000
RNCTDQ   EQU   *                                                 S22024 46350000
         L     R9,TOTCRTNT             GET CT TNT ADDRESS        S22024 46440000
         BAL   R12,TERMRNDQ            GO DEQ TERM - LINE        S22024 46530000
         B     APDQRT                  CONTINUE                  S22024 46620000
MOVE     EQU   *                                               @YM08136 46640000
         SLR   R3,R3                   CLEAR REGISTER          @YM08136 46660000
         IC    R3,TOTTTBEL             GET MAXIMUM NAME LENGTH @YM08136 46680000
         BCTR  R3,0                    DECREMENT FOR EX        @YM08136 46710000
         L     R1,TOTCRTNT             GET CT TNT ADDRESSAME   @YM08136 46800000
         EX    R3,CTNAME               GO MOCE NAME              S99528 46890000
         MVC   TOTCTNAM(EIGHT),RNAME   CT NAME SAVE              S99528 46980000
         MVC   TOTOLADR(EIGHT),TOTCTNAM  MOVE CT NAME INTO P-LISTS05331 47020000
         DEQ   ,MF=(E,DEQLIST)         DEQ                       S99528 47070000
         MVI   RNAME,X'40'             BLANK OUT                 S99528 47160000
         MVC   RNAME+1(7),RNAME        R NAME                    S99528 47250000
         SR    R5,R5                   CLEAR                   @G36XRUV 47290000
         ICM   R5,THREE,TOTCTUCB       GET CT UCB ADDRESS      @G36XRUV 47340000
         USING UCB,R5                  UCB ADDRESSIBILITY        S99528 47430000
         MVC   RNAME(3),UCBNAME        UCB NAME TO DEQ           S99528 47520000
         DEQ   ,MF=(E,DEQLIST)         DEQ                       S99528 47610000
         MVI   RNAME,X'40'             BLANK OUT                 S99528 47700000
         MVC   RNAME+1(7),RNAME        R NAME                    S99528 47790000
         DROP  R5                                                S99528 47880000
         TM    TOTCTFLG,TOTCTORN       CT ON A 3705              S22024 47970000
         BO    RNCTDQ                  YES BRANCH                S22024 48060000
APDQRT   EQU   *                                                 S22024 48150000
         SR    R7,R7                   CLEAR REG                 S22024 48240000
         IC    R7,TOTCTRLN             GET RLN                   S99528 48330000
         STC   R7,TOTORLN              RLN TO P-LIST             S22024 48420000
         MVC   BSTOPNAM(EIGHT),TOTCTNAM MANE TO MSG              S99528 48600000
         TM    TOTCTDFL,TOTAPHD        INIT HELD                 S99528 48690000
         BO    CTHOLD                  YES BR                    S99528 48780000
         MVI   TOTOVBCD,REALTERM       REALEASE TERMINAL         S22024 48870000
RELHOLD  BAL   R12,ORIGTERM            OP CONTROL                S99528 48960000
         CLI   TOTORTCD,X00            OK                        S22024 49050000
         BE    ON3                     OK BR                     S99528 49140000
         CLI   TOTORTCD,X08            ALREADY DONE              S22024 49230000
         BE    ON3                     OK BR                     S99528 49320000
         BAL   R12,BSTOP               MSG TO SYSCON             S99528 49410000
ON3      EQU   *                       CONTINUE                  S99528 49500000
         MVI   BSTOPNAM,X40            CLEAR OUT                 S22024 49530000
         MVC   BSTOPNAM+D1(D7),BSTOPNAM  NAME IN MSG             S22024 49560000
ACTIINAC EQU   *                                                 S22024 49810000
         MVC   TOTOLADR(D8),TOTCTNAM   NAME TO P-LIST            S22024 49860000
         MVC   BSTOPNAM(EIGHT),TOTCTNAM  NAME TO MSG             S99528 49950000
ON4      EQU   *                       CONTINUE                  S99528 50580000
         MVI   BSTOPNAM,X40            CLEAR OUT                 S22024 50590000
         MVC   BSTOPNAM+D1(D7),BSTOPNAM  NAME IN MSG             S22024 50600000
         TM    TOTCTFLG,TOTCTORN       CT ON 3705                S22024 50610000
         BNO   LINECT                  NO, BRANCH                S05331 50620000
         MVC   TRMSAVE(D2),TOTCRSID    GET RESOURCE ID OF CT     S05331 50624000
         OI    RNFLAG,CTFLAG           SET CT ON 3705 FLAG       S05331 50628000
         L     R9,TOTCRTNT             CT TNT ADDRESS          @Y17XAUU 50628400
         SLR   R3,R3                   CLEAR REG               @Y17XAUU 50630000
         IC    R3,TOTTTBEL             GET NAME LENGTH         @Y17XAUU 50630400
         AR    R9,R3                   POINT TO TTE ADDRESS    @Y17XAUU 50631200
         MVC   TTEADDR+D1(D3),D0(R9)   ALLIGN ADDRESS          @Y17XAUU 50632200
         L     R9,TTEADDR              GET TTE ADDRESS         @Y17XAUU 50633200
         LA    R3,TRMPRFSZ             GET TTE PREFIX SIZE     @Y17XAUU 50634200
         SLR   R9,R3                   POINT TO TTE PREFIX     @Y17XAUU 50635200
         USING IEDNTRM,R9              TTE ADDRESSABILITY      @XM05672 50635400
         NI    TRMBYTE1,XFF-TRMSTOTE   TURN OFF TOTE BIT       @XM05672 50635600
         DROP  R9                                              @XM05672 50635800
         BAL   R6,CHKTTE               GET CT LINE TTE ADDRESS @Y17XAUU 50636200
         NI    RNFLAG,XFF-CTFLAG       TURN OFF CT FLAG          S05331 50640000
         TM    LUFLAGS,CTLUNT           Q-IS CTL TERM LUNT     @XM05672 50641000
         BO    ON5                      Y-LINE ALREADY STARTED @XM05672 50642000
         MVC   TOTOLADR(EIGHT),TOTCTRNL  MOVE CT GROUP NAME INTO S05331 50644000
*                                          OP CONTROL PARM LIST  S05331 50648000
         MVC   BSTOPNAM(EIGHT),TOTCTRNL  MOVE GROUP NAME INTO MSGS05331 50652000
         MVC   TOTORLN(1),TOTCTRLN     MOVE RLN INTO PARM LIST   S05331 50656000
         B     CKLINECT                GO CHECK LINE STATUS      S05331 50660000
LINECT   EQU   *                                                 S05331 50664000
         SR    R6,R6                   CLEAR                   @G36XRUV 50667000
         ICM   R6,THREE,TOTCTUCB       UCB ADDRESS             @G36XRUV 50670000
         USING UCB,R6                  UCB                       S99528 50760000
         MVC   TOTOLADR(D3),UCBNAME    UCB TO P-LIST             S22024 50850000
         MVC   BSTOPNAM(THREE),UCBNAME UCB TO MSG                S99528 50940000
         DROP  R6                      UCB                       S99528 51030000
CKLINECT EQU   *                                                 S05331 51070000
         TM    TOTCTDFL,TOTCTLST       LINE INITALLY STOPPED     S22024 51120000
         BO    STOPCT                  YES BR                    S99528 51210000
         MVI   TOTOVBCD,LINESTRT       START LINE                S22024 51300000
STOPSTAR BAL   R12,ORIGTERM            OP CONTROL                S99528 51390000
         CLI   TOTORTCD,X00            OK                        S22024 51480000
         BE    ON5                     OK BR                     S99528 51570000
         CLI   TOTORTCD,X08            ALREADY DONE              S22024 51660000
         BE    ON5                     OK BR                     S99528 51750000
         BAL   R12,BSTOP               MSG TO SYSCON             S99528 51840000
ON5      EQU   *                       CONTINUE                  S99528 51930000
         B     UNALLOCK                BRANCH                    S22024 52020000
ORIGTERM EQU   *                                               @SA74550 52110058
         XC    TOTORTCD,TOTORTCD       CLEAR RETURN CODE FIELD @YM09003 52120000
         LA    R1,TOTOTECB              GET THE TOTE ECB ADDR  @SA74550 52130058
         ST    R1,TOTOECBA              PUT IN PARM LIST       @SA74550 52150058
         LA    R1,CBSLPL                GET PARM LIST ADDR     @SA74550 52170058
         XC    TOTOLINK(D3),TOTOLINK   CLEAR LINK FIELD          S22024 52200000
         XC    TOTOTECB,TOTOTECB       CLEAR ECB                 S99528 52290000
         AQCTL                         POST ELEMENT              S99528 52380000
         WAIT  ECB=TOTOTECB            WAIT FOR COMLLEATION      S99528 52470000
         MVI   TOTOLADR,C' '           CLEAR NAME                S22024 52560000
         MVC   TOTOLADR+D1(D7),TOTOLADR IN P-LIST                S22024 52650000
         BR    R12                     RETURN                    S99528 52740000
RETURN4  EQU   *                                                        52830000
*                                                                       52920000
*        RETURN TO RESIDENT MODULE                                      53010000
*                                                                       53100000
         MVC   QNAME,QNAMEE            MAJOR TO LIST             S22024 53100100
         MVC   RNAME(8),RNAMEE         MINOR TO LIST             S22024 53100200
         DEQ   ,MF=(E,DEQLIST)         CONFIG LIBS               S22024 53100300
         SPACE 2                                                        53100500
RETURN3  EQU   *                                                 S22024 53108400
         TM    TOTFLG02,TOTCONCU       CONC CLEANUP REQUIRED     S22024 53110000
         BZ    RETURN                  NO BRANCH                 S22024 53120000
         L     R14,12(R13)             GET RETURN ADDRESS        S22024 53130000
         XCTL  (2,12),EP=IEDQWEC       GO TO CONC CLEANUP MODULE S22024 53140000
RETURN   EQU   *                                                 S22024 53150000
         L     R13,4(R13)              RESTORE SAVE POINTER      S99528 53190000
         LM    R14,R12,12(R13)         RESTORE REGS              S99528 53280000
         SR    R15,R15            SET GOOD RETURN CODE                  53370000
         BR    R14                     RETERN TO IEDQWA          S99528 53460000
*                                      THIS ROUTINE INSURES THAT S22024 53463000
*                                      ALL UCB UNALLOCATE BITS   S22024 53466000
*                                      ARE TURNED OFF            S22024 53469000
UNALLOCK EQU   *                                                 S22024 53472000
*        INSURE TOTE DOESNOT LEAVE THE CONTROL TERM OR ALT       S22024 53472100
*        PRINTER LISE RESORRCE ASSIGNED TO TOTE                  S22024 53472200
         TM    TOTCTFLG,TOTCTORN       CT ON RN                  S22024 53472300
         BO    CTSTOTE                 YES BRANCH                S22024 53472400
         L     R6,TOTCTRLN             GET LCB ADDRESS           S22024 53472500
         LTR   R6,R6                   IS THTER ONE              S22024 53472600
         BZ    APCHECK                 NO BRANCK                 S22024 53472700
         USING IEDQLCB,R6              LCB                       S22024 53472800
         CLI   LCBCPA,XF1              TOTE OWN RESOURCE         S22024 53472900
         BNE   APCHECK                 NO BRANCH                 S22024 53473000
         MVI   LCBCPA,X00              GIVE RESIURCE TO TCAM     S22024 53473100
APCHECK  EQU   *                                                 S22024 53473200
         TM    TOTAPFLG,TOTAPORN       AP ON RN                  S22024 53473300
         BO    APSTOTE                 YES BRANCH                S22024 53473400
         L     R6,TOTAPRLN             GET AP LCB ADDRESS        S22024 53473500
         LTR   R6,R6                   IS THTER ONE              S22024 53473600
         BZ    UNALLBIT                NO BRANCH                 S22024 53473700
         CLI   LCBCPA,XF1              TOE OWN RESOURCE          S22024 53473800
         BNE   UNALLBIT                NO BRANCH                 S22024 53473900
         MVI   LCBCPA,X00              GIVE RESOURCE TO TCAM     S22024 53474000
UNALLBIT EQU   *                                                 S22024 53474100
         DROP  R6                      LCB                       S22024 53474200
         TM    TOTTDTBL,TOTTDLIN       TEST DEV A LINE           S22024 53475000
         BZ    RETURN4                 NO BRANCH                 S22024 53478000
         TM    TOTTDTBL,TOTTDORN       TEST DEV ON RN            S22024 53481000
         BO    RETURN4                 YES BRANCH                S22024 53484000
         LA    R3,TOTTDTBL             TEST DEV TABLE ADDR       S22024 53487000
         LA    R5,TOTTDEND             END ADDRESS               S22024 53490000
UNALLALL EQU   *                                                 S22024 53493000
         CR    R3,R5                   ALL ENTRIES PROCESSED     S22024 53496000
         BE    RETURN4                 YES BRANCH                S22024 53499000
         L     R8,D0(R3)               GET UCB ADDRESS           S22024 53502000
         LA    R8,D0(R8)               CLEAR HIGH BYTE           S22024 53505000
         LTR   R8,R8                   ENTRY ZERO                S22024 53508000
         BZ    RETURN4                 YES BRANCH                S22024 53511000
         TM    D0(R8),UCBNALBT         UCB UNALLOCATE BIT ON     S22024 53514000
         BZ    BMPUNLL                 NO BRANCH                 S22024 53517000
         MVC   UCBWORK(D4),D0(R8)      MOVE UCB TO WORK AREA     S22024 53520000
         NI    UCBWORK+D1,UCBNALOF     TURN OFF UNALLOCATE BIT   S22024 53523000
         ST    R8,TOT102A              TARGET ADDRESS TO P LIST  S22024 53526000
         LA    R1,TOT102               POINT TO P LIST           S22024 53529000
         AQCTL                         MOVE DATA                 S22024 53532000
BMPUNLL  EQU   *                                                 S22024 53535000
         LA    R3,D4(R3)               DUMP TEST DEV PTR         S22024 53538000
         B     UNALLALL                CONTINUE THRU TABLE       S22024 53541000
         EJECT                                                          53550000
         IEDQMSG LINK=YES,PREG0=R0                                      53640000
*                                                                     * 53730000
*        CONTROL TERMINAL AND ALTERNATE PRINTER ORIGINAL STATUS       * 53820000
*                                                                     * 53910000
STCTAP   EQU   *                       START CONTROL TERM AND AP S99528 54000000
         MVI   TOTOVBCD,LINESTRT       VERB TO START LINE        S22024 54090000
         L     R1,TOTAVTPT             GET AVT POINTER   DE      S99528 54180000
         USING IEDQAVTD,R1             AVT ADDRESSIBILITY        S99528 54270000
         LA    R1,AVTOPCOB             GET OP CONTROL QCB        S99528 54360000
         ST    R1,TOTOKEY              PUT IN P-LIST             S22024 54450000
         DROP  R1                                                       54540000
         SR    R1,R1                   CLEAR                   @G36XRUV 54580000
         ICM   R1,THREE,TOTCTUCB       GET UCB ADDRESS         @G36XRUV 54630000
         TM    APSTIME,APSTIMER        STIM FOR AP               S99528 54720000
         BZ    STARTUCB                NO BRANCH                 S99528 54810000
         SR    R1,R1                   CLEAR                   @G36XRUV 54850000
         ICM   R1,THREE,TOTAPUCB       GET AP UCB              @G36XRUV 54900000
         USING UCB,R1                  UCB ADDRESSIBILITY        S99528 54990000
STARTUCB EQU   *                                                 S99528 55080000
         LTR   R1,R1              IS A VALID UCB ADDRESS PRESENT?S99528 55170000
         BZ    0(R12)             NO, RETURN                     S99528 55260000
         MVC   TOTOLADR(D3),UCBNAME    PUT UCB INTO P-LIST       S22024 55350000
         DROP  R1                                                S99528 55440000
         SR    R1,R1                   CLEAR REG                 S99528 55530000
         IC    R1,TOTCTRLN             GET RLN                   S99528 55620000
         TM    APSTIME,APSTIMER        STIMER FOR AP             S99528 55710000
         BZ    STARTRLN                NO BRANCH                 S99528 55800000
         IC    R1,TOTAPRLN             GET AP RLN                S99528 55890000
STARTRLN EQU   *                                                 S22024 55980000
         XC    TOTORTCD,TOTORTCD       CLEAR RETURN CODE FIELD @YM09003 56000000
         STC   R1,TOTORLN              RLN TO P-LIST             S22024 56020000
         LA    R1,TOTOTECB             GET ECB ADDRESS           S99528 56070000
         ST    R1,TOTOECBA             PUT IN P-LIST             S22024 56160000
         LA    R1,CBSLPL               SVC 102 P-LIST            S22024 56250000
         XC    TOTOLINK(D3),TOTOLINK   CLEAR LINK FIELD          S22024 56340000
         XC    TOTOTECB(4),TOTOTECB    CLEAR ECB                 S99528 56430000
         AQCTL                         GO TO OP CONTOOL          S99528 56520000
         WAIT  ECB=TOTOTECB            WAIT FOR START LINE       S99528 56610000
         MVI   TOTOLADR,C' '           BLANK OUT                 S22024 56700000
         MVC   TOTOLADR+D1(D7),TOTOLADR NAME IN P-LIST           S22024 56790000
         B     0(R12)                  RETURN                    S99528 56880000
CTSTOTE  EQU   *                                                 S22024 56886000
         L     R8,TOTCRTNT             GET TNT ADDRESS           S22024 56892000
         BAL   R7,TNTALINE             GO ALLINE ADDRESS         S22024 56898000
         L     R6,TTEADDR              GET TTE ADDRESS           S22024 56904000
         LA    R7,TRMPRFSZ             GET TTE PREFIX SIZE     @Y17XAUU 56904200
         SLR   R6,R7                   ADDRESS OF TTE PREFIX   @Y17XAUU 56904400
         USING IEDNTRM,R6              SET TTE ADDRESSABILITY  @Y17XAUU 56904600
         NI    TRMBYTE1,XFF-TRMSTOTE   RESET TOTE FLAG         @Y17XAUU 56904800
         L     R6,CTLTTE               GET CONTROL TERMINAL LINE S05331 56917000
*                                        TTE ADDRESS             S05331 56918000
         NI    TRMBYTE1,XFF-TRMSTOTE   RESET TOTE FLAG         @Y17XAUU 56919000
         B     APCHECK                 BRANCH                    S22024 56922000
APSTOTE  EQU   *                                                 S22024 56928000
         L     R8,TOTARTNT             GET TNT ADDRESS           S22024 56934000
         BAL   R7,TNTALINE             ALLINT TTE ADDRESS        S22024 56940000
         L     R6,TTEADDR              GET AP TTE ADDRESS        S22024 56946000
         LA    R7,TRMPRFSZ             GET TTE PREFIX SIZE     @Y17XAUU 56946600
         SLR   R6,R7                   POINT TO TTE PREFIX     @Y17XAUU 56947200
         NI    TRMBYTE1,XFF-TRMSTOTE   RESET TOTE FLAG         @Y17XAUU 56952000
         L     R6,APLTTE               GET ADDRESS OF AP LINE TTES05331 56954000
         NI    TRMBYTE1,XFF-TRMSTOTE   RESET TOTE FLAG         @Y17XAUU 56956000
         B     UNALLBIT                BRANCH                    S22024 56958000
         DROP  R6                      TTE                       S22024 56964000
         EJECT                                                          56970000
*                                                                       57060000
*        START LINE ROUTINE                                             57150000
*                                                                       57240000
LISTART  EQU   *                                                 S22024 57330000
         MVI   TOTOVBCD,LINESTRT       VERB CODE TO START LINE   S22024 57370000
         TM    INITSTAT,TOTTDORN       TEST LIEN ON RN           S22024 57420000
         BO    LINERNST                YES BRANCH                S22024 57510000
         MVC   TOTOLADR(D3),D13(R8)    NAME TO REQ ELE           S22024 57600000
         MVC   BSTOPNAM(3),13(R8)      UCB NAME TO MSG           S99528 57690000
         L     R1,TOTAVTPT             GET AVT ADDRESS           S99528 57780000
         USING IEDQAVTD,R1             AVT ADDRESSIBILITY        S99528 57870000
         LA    R10,AVTOPCOB            GET OPERATOR CONTROL QCB  S99528 57960000
         ST    R10,TOTOKEY             PUT IN P-LIST             S22024 58050000
         L     R1,AVTTCB               GET TCAM TCB ADDRESS      S99528 58140000
         DROP  R1                      REALEASE R1               S99528 58230000
         L     R1,8(R1)                GET DEB CHAIN ADDRESS     S99528 58320000
STLINE01 EQU   *                                                 S99528 58410000
         LA    R1,0(R1)                CLEAR HIGH BYTE           S99528 58500000
         LTR   R1,R1                   ZERO                      S99528 58590000
         BZ    ERROR                   YES BRANCH                S99528 58680000
         SR    R10,R10                 CLEAR LOOP COUNTER AND    S99528 58770000
         IC    R10,16(R1)              INITIALIZE IT TO NUMBER EXS99528 58860000
         LA    R5,32(R1)               GET UCB CHAIN ADDRESS     S99528 58950000
         L     R11,4(R1)               GET NEXT BEB ADDRESS      S99528 59040000
         L     R9,24(R1)               GET DCB ADDRESS           S99528 59130000
         USING IHADCB,R9               DCB ADDRESSIBILITY        S99528 59220000
         TM    DCBDSORG+D1,X44         TCAM DEB                  S22024 59310000
         BZ    STLIN024                NO GET NEXT DEB           S99528 59400000
         LA    R7,1                    INITIALIZE RLN COUNTER           59490000
STLINE02 EQU   *                                                 S99528 59580000
         L     R6,0(R5)                GET UCB ADDDRESS          S99528 59670000
         LA    R6,0(R6)                FOR COMPARE               S99528 59760000
         LA    R8,0(R8)                CLEAR HIGH BYTE           S99528 59850000
         CR    R8,R6                   CORRECT UCB FOUND         S99528 59940000
         BE    STLINE03                YES BRANCH                S99528 60030000
         LA    R5,4(R5)                GET NEXT UCB ADDRESS      S99528 60120000
         LA    R7,1(R7)                BUMP RLN                  S99528 60210000
         BCT   R10,STLINE02            LOOP TILL END OF UCB CH   S99528 60300000
STLIN024 EQU   *                                                 S99528 60390000
         LR    R1,R11                  POINT R1 TO NEXT DEB      S99528 60480000
         B     STLINE01                GET NEXT UCB CHAIN        S99528 60570000
ERROR    EQU   *                                                 S99528 60660000
         OI    TOTFLG06,TOTCANCL+TOTOTERM CANCEL TRM             S99528 60750000
**********     TEST DEVICE DOES NOT BELONG TO TCAM      *********S99528 60840000
         IEDQMSG MSGID=045,PREG0=R0,PREG1=R1,FUNCT=CEC,          S99528C60930000
               RET=TCNT179                                       S99528 61020000
STLINE03 EQU   *                                                 S99528 61110000
         SR    R10,R10                 CLEAR REG                 S99528 61200000
         IC    R10,DCBEXLST            GET LCB LENGTH            S99528 61290000
         LR    R11,R7                  GET RLN                   S99528 61380000
         MR    R10,R10                 RLN TIMES LCB LENGTH      S99528 61470000
         L     R10,DCBIOBAD            GET DUMMY IOB ADDRESS     S99528 61560000
         LA    R10,0(R10,R11)          GET IOB ADDRESS           S99528 61650000
         LA    R11,LCBFLAG1-IEDQLCB    GET OFFSET TO LCB START   S99528 61740000
         SR    R10,R11                 SUBTRACT FROM IOB ADDR    S99528 61830000
         USING IEDQLCB,R10             LCB ADDRESSABILITY        S99528 61920000
         MVI   LCBCPA,X'00'            CLEAR TOTE INDICATOR      S99528 62010000
         MVC   NCPTTCIN(D2),LCBTTCIN   SAVE NCP TTCIN OFFSET   @OY20578 62040082
*                                      FOR 3705 TEST           @OY20578 62070082
         USING UCBOB,R6                UCB                       S22024 62100000
         MVC   X3705(D1),UCBTBYT4      CONTROL UNIT TYPE         S22024 62190000
         NI    X3705,X0F               CLEAR UNWANTED BITS       S22024 62280000
         CLI   X3705,RNUCBTST          IS CONTROL UNIT 3705      S22024 62370000
         DROP  R6                      UCB                       S22024 62460000
         BNE   NO3705                  NO BRANCH                 S22024 62550000
         TM    INITSTAT,TOTTNIPL       IS IPL REQUIRED FOR 3705? S05331 62580000
         BO    CLEARNM                 NO, BYPASS IPL            S05331 62610000
         MVI   TOTOVBCD,IPL3705        IPL VERB                  S22024 62640000
         B     IPL37RN                 BRANCH                    S22024 62730000
NO3705   EQU   *                                                 S22024 62820000
         TM    INITSTAT,TOTTDLST       LINE ORIG STARTED         S22024 62910000
         BO    CLEARNM                 NO BRANCH                 S22024 63000000
         DROP  R9                                                S99528 63090000
         DROP  R10                                               S99528 63180000
IPL37RN  EQU   *                                                 S22024 63270000
         STC   R7,TOTORLN              RLN TO REQ ELE            S22024 63360000
RNLINRT  EQU   *                                                 S22024 63450000
         XC    TOTORTCD,TOTORTCD       CLEAR RETURN CODE FIELD @YM09003 63490000
         LA    R1,TOTOTECB             GET TOTE ECB              S99528 63540000
         ST    R1,TOTOECBA             PUT IN P-LIST             S22024 63630000
         LA    R1,CBSLPL               POINT R1 TO P-LIST        S99528 63720000
         XC    TOTOLINK(D3),TOTOLINK   CLEAR LINK FIELD          S22024 63810000
         XC    TOTOTECB(4),TOTOTECB    CLEAR TOTE ECB            S99528 63900000
         AQCTL                         POST ELEMENT TO OP CONTROLS99528 63990000
         WAIT  ECB=TOTOTECB            WAIT FOR COMPLETION       S99528 64080000
         CLI   X3705,RNUCBTST          3705 TEST                 S22024 64170000
         BNE   CLEARNM                 NO BRANCH                 S22024 64260000
         MVI   X3705,ZEROZ             CLEAR CONTROL TYPE        S22024 64350000
         MVI   TOTOVBCD,ACT3705        VERB TO ACTIVATE          S22024 64440000
*                                      3705                      S22024 64530000
         B     NO3705                  BRANCH                    S22024 64620000
CLEARNME EQU   *                                                 S22024 64630000
         MVI   TOTOLADR,C' '           BLANK OUT                 S22024 64640000
         MVC   TOTOLADR+D1(D7),TOTOLADR  NAME                    S22024 64650000
         BR    R12                     RETURN                    S22024 64660000
CLEARNM  EQU   *                                                 S22024 64710000
         MVI   TOTOLADR,C' '           BLANK OUT                 S22024 64770000
         MVC   TOTOLADR+D1(D7),TOTOLADR  NAME                    S22024 64830000
LINERNST EQU   *                       STOP LINE FOR RN TEST     S22024 64890000
*                                      DEVICES                   S22024 64980000
         TM    INITSTAT,TOTTDLIN+TOTTDORN TEST DEVICE 3705 LINE  S22024 65070000
         BO    SRTRNLIN                YES BRANCH                S22024 65160000
         SLR   R1,R1                   CLEAR PARM REG          @OY20578 65166082
         ICM   R1,HALFWORD,NCPTTCIN    GET NCP TTCIN           @OY20578 65172082
         L     R15,TOTAVTPT            GET AVT ADDRESS         @OY20578 65178082
         USING IEDQAVTD,R15            SET AVT ADDRESSSABILITY @OY20578 65184082
         L     R15,AVTRNMPT            ADDRESS OF TNT CODE     @OY20578 65190082
         DROP  R15                                             @OY20578 65196082
         BALR  R14,R15                 GET TTE ADDRESS         @OY20578 65202082
*        TTE ADDRESS IS RETURN IN REGISTER 1                   @OY20578 65208082
         LA    R15,TRMPRFSZ            TTE PREFIX SIZE         @OY20578 65214082
         SLR   R1,R15                  POINT TO TTE PREFIX     @OY20578 65220082
         USING IEDNTRM,R1              ADDR TO NEG PREFIX      @OY20578 65226082
         NI    TRMBYTE1,X'FF'-TRMSTOTE TURN OFF TOTE FLAG      @OY20578 65232082
         DROP  R1                                              @OY20578 65238082
         B     0(R12)                  RETURN                    S99528 65250000
*                                      TEST DEVICE IS A LINE     S22024 65340000
*                                      TEST ON A 3705            S22024 65430000
RNAMEPLT MVC   TOTOLADR(D0),D0(R8)     NAME TO P-LIST            S22024 65520000
RNAMEMSG MVC   BSTOPNAM(0),0(R8)       NAME TO MESSAGE           S22024 65610000
SRTRNLIN EQU   *                                                 S22024 65700000
         SR    R1,R1                   CLEAR REG                 S22024 65790000
         IC    R1,TOTTTBEL             GET NAME LENGTH           S22024 65880000
         BCTR  R1,D0                   DECREMENT FOR EX          S22024 65970000
         EX    R1,RNAMEMSG             LINE NAME TO MESSAGE      S22024 66150000
         L     R7,TOTAVTPT             GET AVT ADDRESS           S22024 66240000
         USING IEDQAVTD,R7             AVT                       S22024 66330000
         LA    R7,AVTOPCOB             GET ADDR OF OP CONTROL QCBS22024 66420000
         ST    R7,TOTOKEY              PUT IN P-LIST             S22024 66510000
         DROP  R7                      AVT                       S22024 66600000
         BAL   R7,TNTALINE             GET QCB ADDRESS           S22024 66690000
         SR    R7,R8                   CLEAR REG                 S22024 66780000
         USING IEDQQCB,R6              QCB                       S22024 66870000
         IC    R7,QCBRELLN             GET RLN FOR LINE          S22024 66960000
         STC   R7,TOTORLN              RLN TO P-LIST             S22024 67050000
         L     R7,QCBLGBAD-D1          GET LGB ADDRESS           S22024 67060000
         USING IEDNLGB,R7              LGB                       S22024 67070000
         MVC   TOTOLADR(D8),LGBNAME    GROUP NAME TO ELE         S22024 67080000
         DROP  R7                      LGB                       S22024 67090000
         L     R7,TTEADDR              GET TTE ADDRESS           S22024 67140000
         LA    R1,TRMPRFSZ             GET TTE PREFIX SIZE     @Y17XAUU 67230000
         SR    R7,R1                   POINT TO TTE PREFIX     @Y17XAUU 67320000
         USING IEDNTRM,R7              TTE                       S22024 67410000
         NI    TRMBYTE1,X'FF'-TRMSTOTE RESET TOTE FLAG         @Y17XAUU 67500000
         DROP  R7                      TTE                       S22024 67590000
         TM    INITSTAT,TOTTDLST       LINE ORIG ATARTED         S22024 67680000
         BO    CLEARNME                NO BRANCH                 S22024 67770000
         OI    INITSTAT,TOTTDLST       SET ORIG STOPPED          S22024 67810000
         B     RNLINRT                 GO START LINE             S22024 67860000
STARTERM EQU   *                                                 S99528 67950000
         XC    TOTORTCD,TOTORTCD       CLEAR RETURN CODE FIELD @YM      67990000
         BAL   R7,TNTALINE             GET QCB ADDRESS           S99528 68040000
         USING IEDQQCB,R6                                        S99528 68130000
         SR    R7,R7                   CLEAR REG                 S99528 68220000
         IC    R7,QCBRELLN             GET RLN                   S99528 68310000
         DROP  R6                                              @Y17XAUU 68350000
         STC   R7,TOTORLN              PUT IN P-LIST             S22024 68400000
         BCTR  R10,0                   DECREMENT FOR EX          S99528 68490000
         EX    R10,SYMMOVE             GO MAVE SYMBLLIC NAME     S99528 68580000
         EX    R10,MSGMOVE             MOVE NAME TO MSG          S99528 68670000
         XC    TOTOLINK(D3),TOTOLINK   CLEAR LINK FIELD          S22024 68760000
         XC    TOTOTECB,TOTOTECB       CLEAR ECB                 S99528 68850000
         LA    R1,TOTOTECB             GET ECB ADDRESS           S99528 68940000
         ST    R1,TOTOECBA             PUT IN P-LIST             S22024 69030000
         L     R1,TOTAVTPT             GET AVT ADDRESS           S99528 69120000
         USING IEDQAVTD,R1             AVT ADDRESSIBILITY        S99528 69210000
         LA    R1,AVTOPCOB             GET OP CONTROL QCB        S99528 69300000
         DROP  R1                                                S99528 69390000
         ST    R1,TOTOKEY              PUT IN P-LIST             S22024 69480000
         LA    R1,CBSLPL               GET P-LIST ADDR           S99528 69570000
         AQCTL                         POST ELEMENT TO OP CONRROLS99528 69660000
         WAIT  ECB=TOTOTECB            WAIT FOR COMPLEATION      S99528 69750000
         MVI   TOTOLADR,C' '           BLANK OUT                 S22024 69840000
         MVC   TOTOLADR+D1(D7),TOTOLADR                                 69900000
         MVC   TOTOLADR+D1(D7),TOTOLADR  NAME                    S22024 69960000
         B     0(R12)                  RETURN                    S99528 70020000
SYMMOVE  MVC   TOTOLADR(D0),D0(R8)     SYMBOLIC NAME TO P-LIST   S22024 70110000
MSGMOVE  MVC   BSTOPNAM(0),0(R8)       NAME TO MSG               S99528 70200000
         EJECT                                                          70920000
*********************************************************************** 71010000
*********************************************************************** 71100000
*                                                                     * 71190000
*       FIND UCB ROUTINE FOR TNT ENTRIES                              * 71280000
*                                                                     * 71370000
*********************************************************************** 71460000
*********************************************************************** 71550000
UCBFIND  EQU   *                                                 S99528 71640000
         ST    R5,UCB5SAVE             SAVE REG                         71730000
         ST    R3,UCB3SAVE             SAVE REG                  S99528 71820000
         SR    R5,R5                   CLEZA REG                 S99528 71910000
         IC    R5,TOTTTBEL             GET TERMINAL NAME LENGTH  S99528 72000000
         AR    R5,R8                   GET TTE ADDRESS           S99528 72090000
         MVC   TTEADDR+1(3),0(R5)      ALLINE ADDRESS            S99528 72180000
         L     R8,TTEADDR              GET TTE ADDR              S99528 72270000
         USING IEDQTRM,R8                                        S99528 72360000
         L     R8,TRMDESTQ-1           GET QCB ADDR              S99528 72450000
         DROP  R8                                                S99528 72540000
         USING IEDQQCB,R8                                        S99528 72630000
         TM    INITSTAT,TOTTDORN       TEST DEVICE ON RN         S22024 72640000
         BZ    TDNRN1                  NO BRANCH                 S22024 72650000
         LA    R3,D4                   FOURCE RLN TO ONE         S22024 72660000
         B     TDNRN2                  BRANCH                    S22024 72670000
TDNRN1   EQU   *                                                 S22024 72680000
         SR    R3,R3                   CLEAR REG                 S99528 72720000
         IC    R3,QCBRELLN             GET RLN                   S99528 72810000
         SLL   R3,2                    MULT BY 4                 S99528 72900000
TDNRN2   EQU   *                                                 S22024 72940000
         L     R8,QCBDCBAD-1           GET DCB ADDR              S99528 72990000
         DROP  R8                                                S99528 73080000
         USING IHADCB,R8                                         S99528 73170000
         TM    DCBDSORG,X80            DCB OR LGB                S22024 73260000
         BZ    GETDEB                  BRANCH IF DCB             S22024 73350000
         L     R1,TTEADDR              GET TTE ADDRESS         @Y17XAUU 73350500
         BAL   R14,NCPTTE              GET NCP TTE ADDRESS     @Y17XAUU 73351000
*                                                              @Y17XAUU 73351500
*        ON RETURN R1 CONTAINS ADDRESS OF NCP TTE PREFIX       @Y17XAUU 73352000
*                                                              @Y17XAUU 73352500
         USING IEDNTRM,R1              SET TTE ADDRESSABILITY  @Y17XAUU 73353000
         L     R1,TRMDESTQ-D1          GET QCB ADDRESS         @Y17XAUU 73353500
         DROP  R1                                              @Y17XAUU 73354000
         USING IEDQQCB,R1              SET QCB ADDRESSABILITY  @Y17XAUU 73354500
         L     R8,QCBDCBAD-D1          GET 3705 DCB ADDRESS    @Y17XAUU 73355000
         DROP  R1                                              @Y17XAUU 73355500
GETDEB   EQU   *                       GET DEB ADDRESS           S22024 73890000
         L     R8,DCBDEBAD             GET DEB ADDR              S99528 73980000
         DROP  R8                                                S99528 74070000
         USING DEBNMSUB,R8                                       S99528 74160000
         SR    R15,R15                 CLEAR REG                 S99528 74250000
         IC    R15,DEBNMEXT            GET # OF EXTENTS          S99528 74340000
         SLL   R15,2                   MULT BY 4                 S99528 74430000
         L     R8,DEBUCBAD-4(R3)       GET UCB ADDR              S99528 74520000
         L     R5,UCB5SAVE             RETURN REG                       74610000
         L     R3,UCB3SAVE             RESTORE REG               S99528 74700000
         B     0(R12)                  BRANCH RETURN             S99528 74790000
*                                                                     * 74880000
*              ALLINE TNT ADDRESS                                     * 74970000
*                                                                     * 75060000
TNTALINE EQU   *                       FIND QCB                  S99528 75150000
         LR    R9,R8                   SAVE TNT POINTER          S99528 75240000
         SR    R10,R10                 CLEAR REG                 S99528 75330000
         IC    R10,TOTTTBEL            GET NAME LENGTH           S99528 75420000
         AR    R9,R10                  POINT TO TTE ADDRESS      S99528 75510000
         MVC   TTEADDR+1(3),0(R9)      ALLINE ADDRESS            S99528 75600000
         L     R6,TTEADDR              GET TTE ADDRESS           S99528 75690000
         USING IEDQTRM,R6                                        S99528 75780000
         L     R6,TRMDESTQ-1           GET QCB ADDRESS           S99528 75870000
         DROP  R6                                                S99528 75960000
         B     0(R7)                   RETURN                    S99528 76050000
         EJECT                                                          76050100
************************************************************** @Y17XAUU 76050200
*        ROUTINE TO FIND NCP TTE ADDRESS. INPUT: REG 1 =     * @Y17XAUU 76050300
*        ENTRY TTE ADDRESS. OUTPUT: REG 1 = NCP TTE PREFIX   * @Y17XAUU 76050400
*        ADDRESS. RETURN TO CALLER VIA REG 14.               * @Y17XAUU 76050500
************************************************************** @Y17XAUU 76050600
NCPTTE   EQU   *                                               @Y17XAUU 76050700
         ST    R14,TRMSAVE2            SAVE RETURN ADDRESS     @Y17XAUU 76050800
         LA    R8,TRMPRFSZ             GET TTE PREFIX SIZE     @Y17XAUU 76050900
         SLR   R1,R8                   POINT TO TTE PREFIX     @Y17XAUU 76051000
         USING IEDNTRM,R1              SET TTE ADDRESSABILITY  @Y17XAUU 76051100
NCPLOOP  EQU   *                                               @Y17XAUU 76051200
         LH    R1,TRMCOHRT             GET COHORT POINTER      @Y17XAUU 76051300
         L     R15,TOTAVTPT            GET AVT ADDRESS         @Y17XAUU 76051400
         USING IEDQAVTD,R15            SET AVT ADDRESSABILITY  @Y17XAUU 76051500
         L     R15,AVTRNMPT            TTCIN TO TTE CONVERSION @Y17XAUU 76051600
*                                      ROUTINE ADDRESS         @Y17XAUU 76051700
         DROP  R15                                             @Y17XAUU 76051800
         BALR  R14,R15                 FIND TTE ADDRESS        @Y17XAUU 76051900
         SLR   R1,R8                   POINT TO TTE PREFIX     @Y17XAUU 76052000
         CLI   TRMTYPE,TRMLNCP         NCP ENTRY               @Y17XAUU 76052100
         BNE   NCPLOOP                 NO - CHECK NEXT ENTRY   @Y17XAUU 76052200
         L     R14,TRMSAVE2            RESTORE RETURN ADDRESS  @Y17XAUU 76052300
         BR    R14                     RETURN TO CALLER        @Y17XAUU 76052400
         DROP  R1                                              @Y17XAUU 76052500
         EJECT                                                          76140000
         DS    0F                                                S99528 78660000
CDSLINE  DC    CL8'G0000000'           CDS NAME                  S99528 78750000
DEVADBUF DS    0F                                                       78840000
         DC    4CL1'0'                 DEVICE ADDRESS BUFFER     S99528 78930000
DEQLIST  DEQ   (QNAME,RNAME,8,STEP),RET=HAVE,MF=L                       79020000
QNAME    DC    CL8'SYSZTOTE'           MAJOR ELEMENT           @Y17XAUU 79110000
RNAME    DC    8CL1' '                 MINOR ELEMENT             S99528 79200000
*                                                                       79290000
*       PARAMETER LIST FOR SVC PURGE                                  * 79380000
CBPRGLST DS    0F                                                S99528 79470000
CBPRGDEB EQU   CBPRGLST                BEDADDRESS                S99528 79560000
CBPURFLG DC    A(0)                    FLAGS                     S99528 79650000
         DC    A(0)                    PURGE PARM                S99528 79740000
CBPRGIOB DS    0F                      UOB ADDRESS               S99528 79830000
CBPDEBNO DC    A(0)                    DEB ADDRESS               S99528 79920000
*                                                                S99528 81090000
*       PARAMETER LIST FOR SVC 102                                    * 82260000
CBSLPL   DS    0F                                                S99528 82350000
         DC    X'0C'                   START                     S99528 82440000
         DC    AL3(0)                  ADDR OF FIRST             S22024 82530000
         DC    X'80'                   FLAG END                  S99528 82620000
         DC    AL3(0)                  ADDR OF FIRST             S22024 82710000
ADDOFUCB DC    AL3(0)                  UCB ADDRESS               S99528 82800000
JFCBAA  DC     CL176'0'                JFCB                      S99528 82890000
         DS    0F                      EXIT LIST                 S99528 82980000
JFCBADDR DC    X'07'                   KEY FOR JFCB              S99528 83070000
         DC    AL3(JFCBAA)             ADDRESS OF THE JFCB       S99528 83160000
         DC    X'80'                   END OF LIST               S99528 83250000
         DC    AL3(0)                  ZEROS                     S99528 83340000
TTEADDR  DC    AL4(0)                  TTE ADDRESS               S99528 83430000
NCPTTCIN DC    H'0'                    NCP TTCIN               @OY20578 83470082
EXCPDCB  DCB   DDNAME=DD274E,DSORG=PS,EXLST=JFCBADDR,MACRF=(E),        C83520000
               SIOA=AO,CENDA=AP,XENDA=AP   GRAPHIC APPENDAGES    S99528 83610000
EXCP     OPEN  (EXCPDCB,),MF=L                                   S99528 83700000
EXCPP    CLOSE EXCPDCB,MF=L                                      S99528 83790000
***                                                                     83880000
***      MESSAGES                                                       83970000
***                                                                     84060000
UNIT     DC    CL8'        '           NNIT NAME                 S99528 84150000
UCB5SAVE DC    A(0)                    REG 5 SAVE                S99528 84240000
UCB3SAVE DC    A(0)                    REG 3 SEVE                S99528 84330000
         DS    0F                      ALLINE                    S22024 84420000
INVTIC   DC    X'08000002'             INVALID TIC             @YM08158 84430000
TRMSAVE2 DS    F                       REG SAVE AREA           @Y17XAUU 84440000
ONEE     DC    H'1'                    ONE                       S22024 84510000
OFFSET   DC    H'0'                    OFFSET OF TNT             S22024 84600000
TNTNAME  DC    CL8'        '           TNT NAME SAVE AREA        S22024 84690000
DEQSAVE  DS    3F                      SAVE REGS K 6 7           S22024 84780000
NAMEMOVE MVC   UNIT(ZERO),ZERO(R1) MOVE NAME                            84870000
CTNAME   MVC   RNAME,0(R1)             NAME TO DEQ               S99528 84960000
TERMIATE DC    CL26'            UNIT          '  START TERM MSG  S99528 85050000
NOCORE   DC    CL37'NOT ENOUGH CORE FOR SECTION          ' MSG   S99528 85140000
NOTLOAD  DC    CL32'OLT MODULE          NOT LOADABLE'    MSG     S99528 85230000
ASTRICK  EQU   X'5C'                   ASTERICK                  S99528 85320000
TEE      EQU   X'E3'                   T                         S99528 85410000
S        EQU   X'E2'                   S                         S99528 85500000
INITSTAT DC    X'00'                   INITAL STATUS BYTE        S99528 85590000
APSTIME  DC    X'00'                   AP STIMER FLAG            S99528 85680000
APSTIMER EQU   X'80'                   STIMER FOR AP             S99528 85770000
ALPHTABL DC    CL26'ABCDEFGHIJKLMNOPQRSTUVWXYZ'     TABLE        S99528 85860000
ENDALTAB DC    X'EA'                   PAST ALPHBET              S99528 85950000
         DS    0D                      DOUBLE WORD ALLINE        S99528 86040000
SECS00   DC    X'F0F0F0F0F1F1F1C1'     WAIT TIME                 S99528 86130000
X3705    DC    AL1(0)                  CONTROL UNIT TYPE SAVE    S22024 86220000
TRMSAVE  DC    H'0'                    RSID SAVE AREA            S05331 86260000
*                                                                S22024 86263000
*        PARZMETER LIST FOR SVC 102 DATA MOVE                    S22024 86266000
*                                                                S22024 86269000
         DS    0F                      ALLINE                    S22024 86272000
TOT102   DC    X'08'                   FLAG FOR DATA MOVE        S22024 86275000
         DC    AL3(UCBWORK)            DATA ADDRESS              S22024 86278000
TOT102A  DC    X'00'                   ZERO                      S22024 86281000
         DC    AL3(0)                  TARGET ADDRESS            S22024 86284000
         DC    X'80'                   LAST WORD FLAG            S22024 86287000
         DC    AL3(LENGADDR)           LENGTH ADDRESS            S22024 86290000
UCBWORK  DC    AL4(0)                  WORKAREA                  S22024 86293000
LENGADDR DC    H'04'                   LENGTH OF DATA            S22024 86296000
QNAMEE   DC    CL8'CDSLIB  '           MAJOR NAME                S22024 86298000
RNAMEE   DC    CL8'OLT2LIB '           MINOR NAME                S22024 86300000
RNFLAG   DC    X'00'                   FLAG BYTE FOR 3705        S05331 86300500
CTFLAG   EQU   X'80'                   CT ON 3705                S05331 86301000
APFLAG   EQU   X'40'                   AP ON 3705                S05331 86301500
CTLTTE   DS    F                       ADDR OF TTE FOR CT LINE   S05331 86302000
APLTTE   DS    F                       ADDR OF TTE FOR AP LINE   S05331 86302500
LUFLAGS  DC    X'00'                  LU FLAGS                 @XM05672 86302600
APLUNT   EQU   X'80'                  ALT. PRINTER IS LU       @XM05672 86302700
CTLUNT   EQU   X'40'                  CONTROL TERM IS LU       @XM05672 86302800
PATCH    DC    CL100' '                PATCH AREA                S22024 86303000
WEEND    EQU   *                                                        86310000
         EJECT                                                          86400000
         TLCBD                                                          86490000
         EJECT                                                          86580000
UCB      DSECT                                                          86670000
         IEFUCBOB                                                       86760000
         EJECT                                                          86850000
         EJECT                                                          86940000
RESPL    RESPL EQUATES=YES                                              87030000
         EJECT                                                          87120000
         OLTCB                         OLTCB                     S22024 87210000
TCNTBLDL EQU   TOTWKSPC                                                 87300000
TCNTBECT EQU   TCNTBLDL+1                                               87390000
TCNTBELN EQU   TCNTBLDL+3                                               87480000
TCNTMDNM EQU   TCNTBLDL+4                                               87570000
TCNTMDSZ EQU   TCNTBLDL+28                                              87660000
         EJECT                                                          87750000
         TDEBD                                                          87840000
         EJECT                                                          87930000
PLNKPREF DSECT                                                          88020000
PLNKNAME DS    CL8                     OLT NAME                  S99528 88110000
         ORG   PLNKPREF+10             TO POINTER                S99528 88200000
PLNKMPTR DS    CL2                     POINTER                   S99528 88290000
         SPACE 5                                                        88380000
PLNKQPTR DSECT                                                          88470000
PLNKQFWD DS    F                       FORWARD POINTER           S99528 88560000
PLNKQBKD DS    F                       BACK POINTER              S99528 88650000
         EJECT                                                          88740000
DCBDSECT DCBD  DSORG=TX                                          S99528 88830000
          TQCBD                                                  S99528 88920000
         EJECT                                                          89010000
CVT      DSECT                                                   S99528 89100000
         CVT                                                     S99528 89190000
TIOT     DSECT                                                   S99528 89280000
         IEFTIOT1                                                S99528 89370000
         EJECT                                                          89460000
         TTRMD                                                          89550000
         TPRFD                         BUFFER PREFIX             S22024 89590000
         EJECT                                                          89640000
         TLGBD                         LGB                       S22024 89730000
         TTNTD                         TTE                       S22024 89820000
         TAVTD                                                          89910000
         EJECT                                                          89930000
         TREQD                                                          89950000
         SPACE 4                                                        89970000
         END                                                            90000000
./  ADD  SSI=63630390,NAME=IEDQWF
         TITLE ' IEDQWF - TEST CONTROL MODULE 11'                       00050022
IEDQWF   CSECT                                                   S22024 00100000
*CHANGE ACTIVITY AS FOLLOWS:                                            00130000
*C470000-475000                                                 SA41596 00160000
*A470500-474500,560600-568400                                    S05331 00170010
*C555000                                                         S05331 00180010
*************************************************************** S22024* 00190000
*                                                               S22024* 00220000
* TITLE:  'IEDQWF - TEST CONTROL MODULE FOR TCAM/TOTE'          S22024* 00250000
*                                                                     * 00300020
* MODULE NAME:  IEDQWF                                                * 00400020
*                                                                     * 00500020
* DESCRIPTIVE NAME:  TEST CONTROL MODULE FOR TCAM/TOTE          S22024* 00520000
*                                                               S22024* 00540000
* COPYRIGHT:  'NONE'                                            S22024* 00560000
*                                                               S22024* 00580000
* STATUS:  CHANGE LEVEL 5                                       S05331* 00600010
*                                                                     * 00700020
* FUNCTION:                                                           * 00800020
*                                                                     * 00900020
*       TO FREE THE CORE REQUIRED BY IEDQWE DURING OLT EXECUTION      * 01000020
*       AND TO PASS CONTROL TO THE OLT ROOT MODULE AND RECEIVE        * 01100020
*       CONTROL BACK FROM IT.                                         * 01200020
*                                                                     * 01300020
*       ENTRY POINT:                                                  * 01400020
*                                                                     * 01500020
*       IEDQWF - CALLED BY OLT TEST CONTROL MODULE I - (IEDQWE).      * 01600020
*                                                                     * 01700020
* INPUT:        REGISTERS 02,13,14,15 CONTAIN THE FOLLOWING VALUES:   * 01800020
*                                                                     * 01900020
*                         02-OLTCB POINTER                            * 02000020
*                         13-SAVE AREA ADDRESS                        * 02100020
*                         14-RETURN ADDRESS                           * 02200020
*                         15-ENTRY POINT ADDRESS                      * 02300020
*                                                                     * 02400020
*                                                                     * 02500020
* EXTERNAL ROUTINES:                                                  * 03400020
*                                                                     * 03500020
*       DEVICE TESTS (OLT'S)                                          * 03600020
*                                                                     * 03700020
* EXIT POINT:  XCTL TO IEDQWE1                                          03800022
*                                                                     * 03900020
* TABLES/WORK AREA:  OLTCB                                            * 04000020
*                                                                     * 04100020
* ATTRIBUTES:                                                         * 04200020
*                                                                     * 04300020
*       ENABLED, PROBLEM PROGRAM MODE, TRANSIENT.                     * 04400020
*********************************************************************** 04500020
         EJECT                                                          05200022
*                                                                       06000020
*        REGISTER EQUATES                                               07000020
*                                                                       08000020
R0       EQU   0                       REGISTER 0                S99528 08800022
R1       EQU   1                       REGISTER 1                S99528 09600022
R2       EQU   2                       REGISTER 2                S99528 10400022
R3       EQU   3                       REGISTER 3                S99528 11200022
R4       EQU   4                       REGISTER 4                S99528 12000022
R5       EQU   5                       REGISTER 5                S99528 12800022
R6       EQU   6                       REGISTER 6                S99528 13600022
R7       EQU   7                       REGISTER 7                S99528 14400022
R8       EQU   8                       REGISTER 8                S99528 15200022
R9       EQU   9                       REGISTER 9                S99528 16000022
R10      EQU   10                      REGISTER 10               S99528 16800022
R11      EQU   11                      REGISTER 11               S99528 17600022
R12      EQU   12                      REGISTER 12               S99528 18400022
R13      EQU   13                      REGISTER 13               S99528 19200022
R14      EQU   14                      REGISTER 14               S99528 20000022
R15      EQU   15                      REGISTER 15               S99528 20800022
TWELVE   EQU   12                      DISPLACEMENT              S99528 21600022
EIGHT    EQU   8                       DISPLACEMENT              S99528 22400022
FOUR     EQU   4                       DISPLACEMENT              S99528 23200022
D16      EQU   X'10'              CONSTANT DISPLACEMENT          S22024 24100022
         EJECT                                                          25000020
IEDQWF   CSECT                                                          26000020
*C470000-475000                                                 SA41596 26500000
         USING IEDQWF,R15                                               27000020
IEDQWF   IEDHJN IEDQWFF,HJN            NAME AND HJN              S99528 30000022
         DROP  R15                                                      33000020
         USING TOTOLTCB,R2             OLTCB ADDRESSIBILITY      S99528 34000022
         USING IEDQWF,R4                                                35000020
         STM   R14,R12,TWELVE(R13)     SAVE CALLERS REGS         S99528 36000022
         LR    R4,R15             SET UP BASE                           37000020
         LA    R12,TOTSAVE4            GET MY SAVE ADDRESS       S99528 38000022
         ST    R12,EIGHT(R13)          ADD MY SAVE               S99528 39000022
         ST    R13,FOUR(R12)           TO SAVE CHAIN                    40000022
         LR    R13,R12                                                  41000020
*                                                                       42000020
         ST    R2,TOTOLTPL             SET UP SCT POINTER        S99528 42500022
*                                                                       43000022
         L     R5,TOTSTAE         GET ADDRESS OF STAE EXIT       S22024 43060022
*                                   ROUTINE                      S22024 43120022
         STAE  (5),XCTL=YES,PURGE=NONE,ASYNCH=YES                S22024 43180000
         L     R3,TOTTCBAD        GET ACTIVE TCB ADDRESS         S22024 43240022
         CLC   D16(FOUR,R3),ZERO  IS COMPLETION CODE IN TCB ZERO?S22024 43300022
         BE    LOADOLT            YES, GO LOAD OLT                      43360022
         B     EXIT               NO, ABEND, EXIT TO IEDQWE1     S22024 43420022
*        LOAD OLT SCHEDULAR                                      S99528 43500022
*                                                                       44000022
LOADOLT  EQU   *                                                 S22024 44200022
         LOAD  EPLOC=TOTCROLT          LOAD OLT                  S99528 44500022
*                                                                       45000022
*        BRANCH TO OLT SCHEDULER                                        45500022
*                                                                       46000022
         LR    R15,R0                  SET UP ENTRY ADDRESS      S99528 46500022
         ST    R15,TOTOLTEN       SAVE OLT EP                   SA41596 47000000
         USING PSPREF,R15         SET UP BASE FOR SECT. PREFACE  S05331 47050010
         LH    R14,RTNDISP        GET DISPLACEMENT TO ROUTINE    S05331 47100010
